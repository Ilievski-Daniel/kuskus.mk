/*
 Microsoft Corporation. All rights reserved.
*/
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1462:function(D,M,d){d.d(M,"c",function(){return G});d.d(M,"b",function(){return F});d.d(M,"s",function(){return N});d.d(M,"q",function(){return L});d.d(M,"p",function(){return I});d.d(M,"g",function(){return R});d.d(M,"d",function(){return C});d.d(M,"o",function(){return P});d.d(M,"n",function(){return W});d.d(M,"a",function(){return X});d.d(M,"e",function(){return V});d.d(M,"i",function(){return Y});d.d(M,
"m",function(){return ca});d.d(M,"r",function(){return fa});d.d(M,"j",function(){return sa});d.d(M,"k",function(){return ia});d.d(M,"h",function(){return ea});d.d(M,"u",function(){return da});d.d(M,"t",function(){return ja});d.d(M,"f",function(){return Sa});d.d(M,"l",function(){return ka});D=d(22);var m=d(59),f=d(103),a=d(128);M=d(425);var l=d(45),r=d(11),w=d(449),v=d(5),u=d(8),z=d(1471),B=d(1555);const G=new M.a,F=`.ParaWrappingDiv .${l.a.czd}`,K=D.a.instance.Ye("Box4.CommentParagraphMapping"),N=
[Box4Intl.Box4Strings.l_HK_Bold,Box4Intl.Box4Strings.l_HK_Bold_Mac,Box4Intl.Box4Strings.l_HK_Italic,Box4Intl.Box4Strings.l_HK_Italic_Mac,Box4Intl.Box4Strings.l_HK_Underline,Box4Intl.Box4Strings.l_HK_Underline_Mac];let H=void 0;const J=()=>{if(void 0===H){let ha;try{ha=CSS.supports("selector(:not(* *))")}catch(Ca){ha=!1}ha||u.ULS.sendTraceTag(526263553,324,15,"Cannot use complex CSS selector in CommentHelpers, falling back to less performant alternative");H=ha}return H},L=ha=>!!ha&&!!ha.Rf,I=(ha,Ca,
Pa,Xa)=>{if(!ha||!ha.objectId)return!1;const qa=Pa.Eb(m.a.Of(ha.objectId)),Ea=z.a.d3b(qa,!0),Ia=z.a.d3b(qa,!1);if(!Ea||!Ia||Ea===Ia&&Ea!==Ca||!r.ParagraphReader.QNc(Ca,Ea,Ia))return!1;ha=!0;var na=!1;Ea===Ca&&(na=z.a.Z9(qa,Pa,!0),ha=ha&&!!na&&na.Ob.cp<=Xa,na=!!na&&na.Ob.cp===Xa);Ca===Ia&&(Ca=z.a.Z9(qa,Pa,!1),ha=ha&&!!Ca&&Ca.Ob.cp>Xa,na=na&&!!Ca&&Ca.Ob.cp===Xa);return ha||na},R=ha=>{if(!ha)return null;ha=f.a.Eb(ha,l.a.LAc);return null!==ha&&void 0!==ha?ha:[]},C=ha=>ha?f.a.Eb(ha,l.a.Gud):null,P=(ha,
Ca)=>{if(!ha)return-1;for(let Pa=0;Pa<ha.length;Pa++)if(ha[Pa].Q$b.equals(Ca))return Pa;return-1},W=(ha,Ca)=>{if(!ha)return-1;for(let Pa=0;Pa<ha.length;Pa++)if(ha[Pa].g8h.equals(Ca))return Pa;return-1},X=ha=>`Comment Object Id: ${ha.objectId}`,V=(ha=!1)=>Sa(document.getElementById(a.AppFrame.fFa),ha),Y=()=>ua()?Array.from(document.getElementById(a.AppFrame.fFa).querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart")):[],ca=(ha,Ca=!1)=>{if(ha.Tj){for(let Pa of ha.Ag.Hi)if(ka(Pa,
Ca))return!0;return!1}return ka(ha.htmlElement,Ca)},fa=ha=>!!ha&&!!ha.ia(v.a.hL,null),sa=()=>{const ha=new Set,Ca=Y();for(let Pa=0;Pa<Ca.length;Pa++)R(Ca[Pa]).forEach(Xa=>{ha.add(Xa.toString())});return ha},ia=(ha,Ca)=>Ca?Ga(ha,!0,Ca):ya(ha,!0),ea=(ha,Ca)=>Ca?Ga(ha,!1,Ca):ya(ha,!1),da=(ha,Ca)=>{ta(ha,Ca,!0)},ja=(ha,Ca)=>{ta(ha,Ca,!1)},Ga=(ha,Ca,Pa)=>{var Xa,qa;const Ea=ha.id.toString();return Ca?w.a.isEnabled?null!==(Xa=K.value.UYb.get(Ea))&&void 0!==Xa?Xa:Pa:ha.ia(v.a.tPa,Pa):w.a.isEnabled?null!==
(qa=K.value.RYb.get(Ea))&&void 0!==qa?qa:Pa:ha.ia(v.a.csa,Pa)},ya=(ha,Ca)=>{const Pa=ha.id.toString();return Ca?w.a.isEnabled?K.value.UYb.get(Pa):ha.getValue(v.a.tPa):w.a.isEnabled?K.value.RYb.get(Pa):ha.getValue(v.a.csa)},ta=(ha,Ca,Pa)=>{const Xa=ha.id.toString();w.a.isEnabled?ha.B5b||(Pa?K.value.UYb:K.value.RYb).set(Xa,Ca):ha.setValue(Pa?v.a.tPa:v.a.csa,Ca)},ua=()=>0===B.a.Oi||2===B.a.Oi,Sa=(ha,Ca)=>{if(Ca&&ua()){if(J())return Array.from(ha.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart)"));
Ca=ha.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart");const Pa=Ca.length;if(0<Pa){ha=ha.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart");const Xa=[];let qa=0;for(let Ea=0,Ia=ha.length;Ea<Ia;Ea++){const na=ha[Ea];qa<Pa&&Ca[qa]===na?++qa:Xa.push(na)}return Xa}}return Array.from(ha.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart"))},ka=(ha,Ca)=>{if(Ca&&ua()){if(J())return!!ha.querySelector(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart)");
Ca=ha.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart").length;if(0<Ca)return Ca!==ha.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart").length}return!!ha.querySelector(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart")}},1466:function(D,M,d){d.d(M,"f",function(){return B});d.d(M,"e",function(){return G});d.d(M,"d",function(){return F});d.d(M,"g",function(){return K});d.d(M,"h",
function(){return N});d.d(M,"a",function(){return H});d.d(M,"j",function(){return J});d.d(M,"i",function(){return L});d.d(M,"c",function(){return I});d.d(M,"b",function(){return R});var m=d(48),f=d(8),a=d(1474);d.n(a);D=[{role:2,roleType:a.RoleType.Title},{role:3,roleType:a.RoleType.Subtitle},{role:4,roleType:a.RoleType.Heading1},{role:5,roleType:a.RoleType.Heading2},{role:6,roleType:a.RoleType.Heading3},{role:7,roleType:a.RoleType.Heading4},{role:8,roleType:a.RoleType.Heading5},{role:9,roleType:a.RoleType.Heading6},
{role:10,roleType:a.RoleType.Heading7},{role:11,roleType:a.RoleType.Heading8},{role:12,roleType:a.RoleType.Heading9},{role:15,roleType:a.RoleType.ListItem},{role:13,roleType:a.RoleType.BodyText},{role:14,roleType:a.RoleType.Caption}];M=[{role:1,OF:{default:"Unknown",xI:null}},{role:2,OF:{default:"Title",xI:Box4Intl.Box4Strings.L_StyleWordTitle}},{role:3,OF:{default:"Subtitle",xI:Box4Intl.Box4Strings.L_StyleWordSubtitle}},{role:4,OF:{default:"Heading1",xI:Box4Intl.Box4Strings.L_StyleWordHeading1}},
{role:5,OF:{default:"Heading2",xI:Box4Intl.Box4Strings.L_StyleWordHeading2}},{role:6,OF:{default:"Heading3",xI:Box4Intl.Box4Strings.L_StyleWordHeading3}},{role:7,OF:{default:"Heading4",xI:Box4Intl.Box4Strings.L_StyleWordHeading4}},{role:8,OF:{default:"Heading5",xI:Box4Intl.Box4Strings.L_StyleWordHeading5}},{role:9,OF:{default:"Heading6",xI:Box4Intl.Box4Strings.L_StyleWordHeading6}},{role:10,OF:{default:"Heading7",xI:Box4Intl.Box4Strings.L_StyleWordHeading17}},{role:11,OF:{default:"Heading8",xI:Box4Intl.Box4Strings.L_StyleWordHeading8}},
{role:12,OF:{default:"Heading9",xI:Box4Intl.Box4Strings.L_StyleWordHeading9}},{role:13,OF:{default:"BodyText",xI:Box4Intl.Box4Strings.L_StyleWordNormal}},{role:14,OF:{default:"Caption",xI:Box4Intl.Box4Strings.L_StyleWordCaption}},{role:15,OF:{default:"ListItem",xI:null}},{role:16,OF:{default:"SubtleEmphasis",xI:Box4Intl.Box4Strings.L_StyleWordSubtleEmphasis}},{role:17,OF:{default:"Emphasis",xI:Box4Intl.Box4Strings.L_StyleWordEmphasis}},{role:18,OF:{default:"IntenseEmphasis",xI:Box4Intl.Box4Strings.L_StyleWordIntenseEmphasis}},
{role:19,OF:{default:"Strong",xI:Box4Intl.Box4Strings.L_StyleWordStrong}},{role:20,OF:{default:"Quote",xI:Box4Intl.Box4Strings.L_StyleWordQuote}},{role:21,OF:{default:"IntenseQuote",xI:Box4Intl.Box4Strings.L_StyleWordIntenseQuote}},{role:22,OF:{default:"SubtleReference",xI:Box4Intl.Box4Strings.L_StyleWordSubtleReference}},{role:23,OF:{default:"IntenseReference",xI:Box4Intl.Box4Strings.L_StyleWordIntenseReference}},{role:24,OF:{default:"BookTitle",xI:Box4Intl.Box4Strings.L_StyleWordBookTitle}},{role:25,
OF:{default:"NoSpacing",xI:Box4Intl.Box4Strings.L_StyleWordNoSpacing}}];const l=new Map(M.map(C=>[C.OF.default,C.role])),r=new Map(M.map(C=>[C.role,C.OF.default])),w=new Map(M.map(C=>[C.role,C.OF.xI])),v=new Map(D.map(C=>[C.roleType,C.role])),u=new Map(D.map(C=>[C.role,C.roleType])),z=(C,P,W)=>C.has(P)?C.get(P):W,B=C=>z(l,C,1),G=C=>z(v,C,1),F=C=>z(u,C,a.RoleType.Unknown),K=C=>z(r,C,"Unknown"),N=C=>z(w,C,null),H=C=>{switch(C){case 4:return 0;case 5:return 1;case 6:return 2;case 7:return 3;case 8:return 4;
case 9:return 5;case 10:return 6;case 11:return 7;case 12:return 8;default:return 9}},J=C=>{switch(C){case 13:return"Normal";case 1:return"Unknown";case 4:return"Heading 1";case 5:return"Heading 2";case 2:return"Title";case 15:return"List Paragraph";case 3:return"Subtitle";case 14:return"Caption";case 6:return"Heading 3";case 7:return"Heading 4";case 8:return"Heading 5";case 9:return"Heading 6";case 10:return"Heading 7";case 11:return"Heading 8";case 12:return"Heading 9";case 16:return"Subtle Emphasis";
case 17:return"Emphasis";case 18:return"Intense Emphasis";case 19:return"Strong";case 20:return"Quote";case 21:return"Intense Quote";case 22:return"Subtle Reference";case 23:return"Intense Reference";case 24:return"Book Title";case 25:return"No Spacing";default:return"Unknown"}},L=C=>{switch(C){case 13:return m.StyleReader.wordStyleIdNormal;case 4:return m.StyleReader.wordStyleIdHeading1;case 5:return m.StyleReader.wordStyleIdHeading2;case 2:return m.StyleReader.g4a;case 15:return m.StyleReader.wordStyleIdListParagraph;
case 3:return m.StyleReader.whc;case 6:return m.StyleReader.wordStyleIdHeading3;case 7:return m.StyleReader.$3a;case 8:return m.StyleReader.a4a;case 9:return m.StyleReader.b4a;case 10:return m.StyleReader.lmb;case 11:return m.StyleReader.mmb;case 12:return m.StyleReader.c4a;case 16:return m.StyleReader.f4a;case 17:return m.StyleReader.sQa;case 18:return m.StyleReader.d4a;case 19:return m.StyleReader.$9f;case 20:return m.StyleReader.jMb;case 21:return m.StyleReader.e4a;case 22:return m.StyleReader.a$f;
case 23:return m.StyleReader.Z9f;case 24:return m.StyleReader.Y9f;case 25:return m.StyleReader.nmb;case 14:return m.StyleReader.Ckj;default:return f.ULS.shipAssertTag(571867614,3016,!1,K(C)),"Unknown"}},I=C=>{switch(C){case 18:case 21:case 23:return!0;default:return!1}},R=C=>4<=C&&12>=C},1467:function(D,M,d){var m=this&&this.xO||(Object.create?function(a,l,r,w){void 0===w&&(w=r);var v=Object.getOwnPropertyDescriptor(l,r);if(!v||("get"in v?!l.kH:v.writable||v.configurable))v={enumerable:!0,get:function(){return l[r]}};
Object.defineProperty(a,w,v)}:function(a,l,r,w){void 0===w&&(w=r);a[w]=l[r]}),f=this&&this.__exportStar||function(a,l){for(var r in a)"default"===r||Object.prototype.hasOwnProperty.call(l,r)||m(l,a,r)};Object.defineProperty(M,"__esModule",{value:!0});f(d(1749),M);f(d(1750),M);D.exports.ErrorCode||Object.defineProperty(D.exports,"ErrorCode",{enumerable:!0,get:function(){return D.exports.ErrorCode}});D.exports.FormattingSuggestionType||Object.defineProperty(D.exports,"FormattingSuggestionType",{enumerable:!0,
get:function(){return D.exports.FormattingSuggestionType}});D.exports.FormattingSuggestionsAnnotation||Object.defineProperty(D.exports,"FormattingSuggestionsAnnotation",{enumerable:!0,get:function(){return D.exports.FormattingSuggestionsAnnotation}});D.exports.FormattingSuggestionsSummaryAnnotation||Object.defineProperty(D.exports,"FormattingSuggestionsSummaryAnnotation",{enumerable:!0,get:function(){return D.exports.FormattingSuggestionsSummaryAnnotation}})},1468:function(D,M,d){d.d(M,"a",function(){return l});
D=d(0);var m=d(2),f=d(1728),a=d(16);class l{static tPh(){return l.W7j+"_"+f.a.rKc+"_"+a.a.TV(m.AFrameworkApplication.userName)+"_"}static $Jh(r){return r+"_"+f.a.rKc+"_"+a.a.TV(m.AFrameworkApplication.userName)+"_"}static HVh(){return l.c7m+"_"+f.a.rKc+"_"+a.a.TV(m.AFrameworkApplication.userName)+"_"}}l.Rqa="ack0";l.WUa="ack1";l.oqd="ack2";l.W7j="ack3";l.Mxc="ack4";l.w9g="ack7";l.puf="ack8";l.y2i="ack9";l.eRe="ack10";l.x2i="ack13";l.U7j="DdaMethod";l.T7j="ControlId";l.qqd="OsfcontrolId";l.pOe="SecurityOrigin";
l.FWb="ak0";l.$7j="ak1";l.A9g="ak2";l.Nxc="ak4";l.u9g="Office.AutoShowTaskpaneWithDocument";l.x9g="value";l.Z7j="errorCode";l.FYk="OsfControl";l.GYk="RibbonUpdaterData";l.s$d="AddinShared";l.c7m="__OSF_PRIVATECATALOG_ADDINIDS";Object(D.a)(l,"AddinConstantsString",null,[])},1471:function(D,M,d){D=d(0);var m=d(22),f=d(67),a=d(59),l=d(2),r=d(709),w=d(121),v=d(205),u=d(609),z=d(9),B=d(6),G=d(287),F=d(11),K=d(382),N=d(1140),H=d(93),J=d(76),L=d(1692),I=d(1737),R=d(1738),C=d(17),P=d(5),W=d(585),X=d(8),V=
d(120),Y=d(229),ca=d(82),fa=d(1607);class sa extends Sys.EventArgs{constructor(ua,Sa){super();this.graphNode=ua;this.Ayk=Sa}}Object(D.a)(sa,"OnCopyCommentEventArgs",Sys.EventArgs,[]);class ia extends Sys.EventArgs{constructor(ua,Sa){super();this.graphNode=ua;this.Awk=Sa}}Object(D.a)(ia,"OnPasteCommentEventArgs",Sys.EventArgs,[]);var ea=d(1172),da=d(1462),ja=d(1526);class Ga extends Sys.EventArgs{constructor(ua){super();this.commentNode=ua}}Object(D.a)(Ga,"OnDeleteEventArgs",Sys.EventArgs,[]);class ya extends Sys.EventArgs{constructor(ua){super();
this.commentNode=ua}}Object(D.a)(ya,"OnPasteEventArgs",Sys.EventArgs,[]);d.d(M,"a",function(){return ta});class ta{static get characterPropertiesEditor(){return null!=ta.Efg?ta.Efg:ta.Efg=m.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get fe(){return null!=ta.ehg?ta.ehg:ta.ehg=new f.a}static get cza(){return ja.a.instance}static get Qi(){return z.App.xa.jb.Zc.Ad}static get Pb(){return null!=ta.eig?ta.eig:ta.eig=m.a.instance.Pa("Box4.IFeatureHelper")}static isComment(ua){return 40===
ua.Se}static NMd(ua){return 40===ua.type}static dof(ua){return!!ua&&39===ua.Se}static AEf(ua,Sa){Sa.property===C.a.rf&&(ta.kCb=!1)}static EEf(ua,Sa){Sa&&!ua.Oc&&ta.Dwh(ua)}static Dwh(ua){const Sa=ua.Ob.paragraph.Nc;ua=Sa.Eb(ua.Oj);ta.AEc();ua&&ua.anchor&&ta.deleteComment(ua,Sa)}static MZe(ua){const Sa=new B.GraphIterator;Sa.set(ua.Bi());ta.cza.Z_a(Sa);return Sa}static deleteComment(ua,Sa){ua&&(ta.AEc(),ta.Sxd(ua,Sa),ua.anchor&&(ta.fe.raiseEvent(ta.CSc,new Ga(ua)),Sa=ua.ia(P.a.ZD,0),X.ULS.sendTraceTag(592188697,
327,15,"Comment deleted by canvas anchor removal. DurableId:{0}",Sa),ta.kxg.add(Sa.toString()),Sa=new B.GraphIterator,Sa.set(ua),Sa.Bb(39),Sa.Fg()))}static o$l(ua){return ta.kxg.contains(ua)}static Sxd(ua,Sa){ta.AEc();const ka=ta.Z9(ua,Sa,!0);ua=ta.Z9(ua,Sa,!1);ta.bjb(ka);ta.bjb(ua);ka&&ua&&ka.Ob===ua.Ob&&X.ULS.sendTraceTag(50619292,327,10,"comment start and end range objects belonged to same chp")}static bjb(ua){if(ua&&ua.Ob.Ff){ua.Ob.Ff.remove(ua);const Sa=ua.Ob.paragraph;0<=ua.Fe&&ua.Fe<Sa.wordRunProperties.length&&
(ua.Ob.cp||1!==Sa.wordRunProperties.length||(Sa.wordRunProperties.xZ(0,4),Sa.wordRunProperties.Fq.Z(1,G.CharacterPropertiesEditor.wQ),Sa.wordRunProperties.Zs.Z(1,G.CharacterPropertiesEditor.QT)),Sa.wordRunProperties.removeAt(ua.Fe,4));Sa.qn()}}static CNm(ua,Sa){if(Sa){var ka=Sa.paragraph;ua=Sa.cpBegin;var ha=Sa.cpEnd;if(ka&&F.ParagraphReader.oc(ka)&&(ka=ka.qa)){Sa.xo[ta.Oud]||(Sa.xo[ta.Oud]=[]);Sa=Sa.xo[ta.Oud];for(let Pa=0;Pa<ka.length;Pa++){const Xa=ka.J(Pa).Ff;if(!Xa)continue;const qa=Xa.length;
var Ca=ka.J(Pa).cp;if(Ca<ua||Ca>ha)for(Ca=0;Ca<qa;Ca++)Sa.push(Xa.J(Ca))}}}}static VMm(ua,Sa){if(Sa&&(ua=Sa.xo[ta.Oud]))for(Sa=0;Sa<ua.length;Sa++)ta.Dwh(ua[Sa])}static Z9(ua,Sa,ka){if(!ua)return null;const ha=ka?da.k(ua,a.a.nil):da.h(ua,a.a.nil);Sa=Sa.Eb(ha);return Sa?ta.zsa(Sa,ua.id,ka):(ka||X.ULS.sendTraceTag(4531344,327,100,"Comment anchor missing!"),null)}static zsa(ua,Sa,ka){for(let ha=0;ha<ua.qa.length;ha++){const Ca=ua.qa.J(ha);if(Ca.Ff)for(let Pa=0;Pa<Ca.Ff.length;Pa++)if(Ca.Ff.J(Pa).Oj.equals(Sa)&&
ka===Ca.Ff.J(Pa).Oc)return Ca.Ff.J(Pa)}return null}static d3b(ua,Sa){if(!ua)return null;Sa=Sa?da.k(ua,a.a.nil):da.h(ua,a.a.nil);return ua.Nc.Eb(Sa)}static QGc(ua,Sa,ka,ha=null){const Ca=!ha;for(let Pa=0;Pa<ua.qa.length;Pa++){const Xa=ua.qa.J(Pa);if(Xa.cp>=Sa&&Xa.Ff)for(let qa=0;qa<Xa.Ff.length;qa++){const Ea=Xa.Ff.J(qa).Oj.toString();if(Xa.Ff.J(qa).Oc===ka&&(Ca||ha.contains(Ea)))return Xa.Ff.J(qa)}}return null}static Uul(ua,Sa,ka,ha){for(let Ca=0;Ca<ua.qa.length;Ca++){const Pa=ua.qa.J(Ca);if(Pa.cp>
Sa)break;if(Pa.cp===Sa&&Pa.Ff)for(let Xa=Pa.Ff.length-1;0<=Xa;Xa--){const qa=Pa.Ff.J(Xa).Oj.toString();if(Pa.Ff.J(Xa).Oc===ka&&ha.contains(qa))return Pa.Ff.J(Xa)}}return null}static cWb(ua,Sa,ka,ha){let Ca=null;for(let Pa=0;Pa<ua.qa.length;Pa++){let Xa=ua.qa.J(Pa);if(Xa.cp>=ka){Xa.cp>ka||!Xa.formatting?(Ca=ta.characterPropertiesEditor.GX(ua,Pa,ka,Ca),Xa=ua.qa.J(Pa)):Ca=Xa.formatting;Xa.Ff||(Xa.Ff=new K.a(Xa));ta.tpd(Sa,Xa.Ff,Ca.Aj,ha);break}Xa.formatting&&(Ca=Xa.formatting)}}static tpd(ua,Sa,ka,ha){ka=
Sa.Ob.paragraph;const Ca=new N.a(Sa.Ob,null,ua,ha);for(let Pa=0;Pa<Sa.length;Pa++)if(Sa.J(Pa).Oj===ua&&Sa.J(Pa).Oc===ha){X.ULS.sendTraceTag(589616028,327,10,"CommentRangeObject {0} already exists with isStart value {1} in commentRangeObjects",ua,ha);break}Sa.add(Ca);ka.qn();Ca.Fe?ka.wordRunProperties.xZ(Ca.Fe-1,4):ka.wordRunProperties.bta(Ca.Fe,4);ka.wordRunProperties.Fq.Z(Ca.Fe,G.CharacterPropertiesEditor.wQ);ka.wordRunProperties.Zs.Z(Ca.Fe,G.CharacterPropertiesEditor.QT);return Ca}static AEc(){if(!ta.kCb){var ua=
new B.GraphIterator;ua.set(z.App.xa.jb.Zc);ta.cza.Z_a(ua);if(ua.Rb(1))for(;ua.wf(1););ta.kCb=!0}}static w7k(ua){const Sa=new B.GraphIterator;Sa.set(z.App.xa.jb.Zc);ta.cza.Z_a(Sa);if(39!==Sa.Se)return!1;let ka;if(ka=Sa.Rb(1)){if(ka.id.equals(ua))return!0;for(;ka=Sa.wf(1);)if(ka.id.equals(ua))return!0}return!1}static s0a(ua,Sa){ta.MWc(Sa)}static MWc(ua){ta.sQf(F.ParagraphReader.uzb(ua));let Sa=null;var ka=new B.GraphIterator;ka.set(ua);if(ka.qo()&&(ka=H.a.Ir(ka,ka.origin),ka.moveNext()))for(;ka.moveNext();)if(F.ParagraphReader.wh(ka.iterator)){Sa=
ka.iterator.currentNode;break}if(Sa){ua=F.ParagraphReader.uzb(ua);for(let ha of ua)ha.Oc&&(ua=ha.Ob.paragraph.Nc.Eb(ha.Oj))&&(ta.bjb(ha),ta.cWb(Sa,ua.id,0,!0),da.u(ua,Sa.id))}}static sQf(ua){for(let Sa of ua)if(!Sa.Oc){ua=Sa.Ob.paragraph.Nc;const ka=ua.Eb(Sa.Oj);ta.deleteComment(ka,ua)}}static gGd(ua,Sa){const ka=[];if(!ua)return X.ULS.shipAssertTag(594908762,327,!1,"Trying to highlight null node."),ka;if(!ua.isConnected)return X.ULS.shipAssertTag(51467871,327,!1,"Trying to highlight disconnected node."),
ka;const ha=ta.Z9(ua,ta.Qi,!0);ua=ta.Z9(ua,ta.Qi,!1);if(!ha||!ua)return X.ULS.shipAssertTag(51467872,327,!1,"Missing comment achor."),ka;let Ca=!1,Pa=ha.Ob.paragraph;for(;Pa&&(!Sa||!Sa(Pa,Pa===ha.Ob.paragraph));){Pa===ha.Ob.paragraph&&(Ca=!0);Ca&&ka.push(Pa);if(Pa===ua.Ob.paragraph)break;Pa=F.ParagraphReader.Vg(Pa,!1)}return ka}static BEf(ua,Sa){Sa.xo.Comments||(Sa.xo.Comments={});ta.IVd(Sa.operation,Sa.cAi,Sa.original,Sa.clone,Sa.xo.Comments,!0)}static DEf(ua,Sa){Sa.xo.Comments||(Sa.xo.Comments=
{});ta.IVd(Sa.operation,Sa.cAi,Sa.original,Sa.clone,Sa.xo.Comments,!1)}static wOm(ua,Sa){Sa.xo.Comments||(Sa.xo.Comments={});ua=Sa.xo.Comments;if((Sa=Object.keys(ua))&&0<Sa.length)for(let ka=0;ka<Sa.length;ka++){const ha=ua[Sa[ka].toString()];ha&&(ha.Oj=null,ta.bjb(ha))}}static IVd(ua,Sa,ka,ha,Ca,Pa){const Xa=ka.Nc;var qa=F.ParagraphReader.uzb(ha);qa.sort((ab,zb)=>ab.Ob.cp<zb.Ob.cp||ab.Ob.cp===zb.Ob.cp&&ab.Oc?-1:ab.Ob.cp===zb.Ob.cp&&ab.Oc===zb.Oc?0:1);const Ea=new ca.a,Ia=new Y.a,na=ta.Pb.isFeatureEnabled(125);
for(let ab of qa)if(Object(V.a)(ea.PageView,J.InteractiveViewManager.instance.xd)){var Na=Xa.Eb(ab.Oj);if(Na&&Na.isConnected)if(ab.Oc)Ca[ab.Oj.toString()]=ab;else{var Oa=Na.ia(P.a.ZD,0);qa=Pa?ta.GUc(Na,ha,ua,Sa):ta.KUc(Na,ha,ua,Sa);if(Pa)na&&(Oa=B.GraphIterator.$a(ha),Oa.Bb(25)&&Oa.kd(25)&&fa.a.fe.raiseEvent(fa.a.Vui,new sa(Oa.currentNode,qa.getValue(P.a.ZD))));else{if(na){var Ra=qa.ia(P.a.ZD,0);Oa&&Ra&&(Ia.xb(Oa)?Ia.J(Oa)!==Ra&&X.ULS.sendTraceTag(589616029,327,10,"Failed to add Key {0}, Value {1} to clonedDurableIdMapping, since Key {0}, Value {2} already exists. This could affect copy/paste of tasks.",
Oa,Ra,Ia.J(Oa)):Ia.add(Oa,Ra))}qa.setValue(P.a.nfb,!0);Na.ia(P.a.JWe,null)||(Oa=Na.ia(P.a.CJa,null))&&qa.setValue(P.a.JWe,Oa);qa.setValue(P.a.CJa,l.AFrameworkApplication.userSessionId)}Oa=ab.Oj.toString();Ra=Ca[Oa];ab.Oj=qa.id;if(!Pa){ab.wt=null;Na=Na.getValue(P.a.zG);const zb=qa.getValue(P.a.zG);Ca[Na]=zb;if(Na=qa.ia(P.a.hL,null))Ea.xb(Na)||Ea.add(Na,[]),Ea.J(Na).push(qa)}da.t(qa,ha.id);ha.id||X.ULS.shipAssertTag(5564305,327,!1,"Comment node has no end anchor!");Ra?(Ra.Oj=qa.id,Pa||(Ra.wt=null),
da.u(qa,Ra.Ob.paragraph.id),delete Ca[Oa]):(ta.cWb(ha,qa.id,ab.Ob.cp,!0),da.u(qa,ha.id))}else X.ULS.sendTraceTag(592188835,327,10,String.format("Node is null or not connected, IsNodeChildOfCommentContent:{0}, IsNull:{1}",ta.w7k(ab.Oj),!Na)),ab.Oj=null,ta.bjb(ab)}else ab.Oj=null,ta.bjb(ab);if(!Pa){for(let ab of Ea){ua=ab.key;Sa=ab.value;for(let zb of Sa)zb.setValue(P.a.hL,Ca[ua])}0<Ia.count&&na&&(ka=B.GraphIterator.$a(ka),ka.Bb(25)&&ka.kd(25)&&fa.a.fe.raiseEvent(fa.a.pxi,new ia(ka.currentNode,Ia)))}ha.gk()}static A5e(ua,
Sa){if(ua.Bb(25)&&ua.kd(25)&&!ua.Zp(16)){const ka=B.GraphIterator.$a(Sa);ka.Bb(39);ka.kd(39);Sa=W.a(ka.currentNode,Sa.Bi().Nc,!0);ua.Sf(Sa,16)}}static EYe(ua,Sa){var ka=Sa.Bi().Ad;ka=W.a(ua,ka,!0);Sa=B.GraphIterator.$a(Sa);ta.A5e(Sa,ua);Sa.Rb(16);Sa.d1(ka,1,ua.id);return ka}static GUc(ua,Sa,ka,ha){ta.AEc();Sa=ta.EYe(ua,Sa);Sa.B5b=!0;ta.O2k(ua,Sa,ka,ha);return Sa}static O2k(ua,Sa,ka,ha){ua=new L.a(B.GraphIterator.$a(ua),B.GraphIterator.$a(Sa),{});ua.zJb=!0;ka=new r.a(ka,ha,new I.a(ua,null));ka.ah=
!0;ka.ll("ExecuteInternalCommentCopy");ka.run()}static KUc(ua,Sa,ka,ha){ta.AEc();var Ca=Sa.Bi().Ad;Sa=B.GraphIterator.$a(Sa);Sa.Bb(7);Sa.kd(7);Sa.Rb(16);Ca=W.a(ua,Ca,!0);Ca.lh(P.a.zG,w.a.create().toString());Ca.lh(P.a.commentId,v.a.JF());let Pa=!1;ta.dhi(Ca.Og(P.a.ZD))?Pa=!0:Ca.lh(P.a.ZD,ta.acf());Sa.Sf(Ca,1);ta.P2k(ua,Ca,ka,ha);Sa.Ci(Ca);Sa.dE(1);Sa.Tcb(2);Sa.Rb(2);Ca.setValue(P.a.zG,Sa.currentNode.Og(P.a.Mc).toString());ta.fe.raiseEvent(ta.rTm,new ya(Ca));Pa&&this.ivh.add(Ca.id.toString());return Ca}static P2k(ua,
Sa,ka,ha){ua=new R.a(B.GraphIterator.$a(ua),B.GraphIterator.$a(Sa),null,null);ka=new r.a(ka,ha,ua);ka.ah=!0;ka.ll("ExecuteInternalCommentPaste");ka.run()}static acf(){const ua=v.a.lbc(1,this.moi);return ta.dhi(ua)?ua:ta.acf()}static dhi(ua){if(!ua)return!1;if(z.App.xa){const Sa=new B.GraphIterator;Sa.set(z.App.xa.jb.Zc);ta.cza.Z_a(Sa);let ka=Sa.Wd();for(;ka;){if(ka.Og(P.a.ZD)===ua)return!1;ka=Sa.xj()}}return!0}static UNe(ua){ta.fe.addHandler(ta.CSc,ua)}}ta.rTm="OnPaste";ta.CSc="OnDelete";ta.Oud="CommentRangesToTrimOutsideSelection";
ta.kxg=new u.a;ta.kCb=!1;ta.moi=2147483646;ta.ivh=new Set;Object(D.a)(ta,"CommentEditor",null,[])},1474:function(D,M,d){var m=this&&this.xO||(Object.create?function(a,l,r,w){void 0===w&&(w=r);var v=Object.getOwnPropertyDescriptor(l,r);if(!v||("get"in v?!l.kH:v.writable||v.configurable))v={enumerable:!0,get:function(){return l[r]}};Object.defineProperty(a,w,v)}:function(a,l,r,w){void 0===w&&(w=r);a[w]=l[r]}),f=this&&this.__exportStar||function(a,l){for(var r in a)"default"===r||Object.prototype.hasOwnProperty.call(l,
r)||m(l,a,r)};Object.defineProperty(M,"__esModule",{value:!0});f(d(1729),M);f(d(1730),M);D.exports.DocumentRoleDetectionAnnotation||Object.defineProperty(D.exports,"DocumentRoleDetectionAnnotation",{enumerable:!0,get:function(){return D.exports.DocumentRoleDetectionAnnotation}});D.exports.RoleDetectionAnnotation||Object.defineProperty(D.exports,"RoleDetectionAnnotation",{enumerable:!0,get:function(){return D.exports.RoleDetectionAnnotation}});D.exports.RoleDetectionCustomMetadata||Object.defineProperty(D.exports,
"RoleDetectionCustomMetadata",{enumerable:!0,get:function(){return D.exports.RoleDetectionCustomMetadata}});D.exports.RoleDetectionSettings||Object.defineProperty(D.exports,"RoleDetectionSettings",{enumerable:!0,get:function(){return D.exports.RoleDetectionSettings}});D.exports.RoleType||Object.defineProperty(D.exports,"RoleType",{enumerable:!0,get:function(){return D.exports.RoleType}})},1477:function(D,M,d){d.d(M,"a",function(){return f});D=d(0);var m=d(8);class f{constructor(){this.ltb=this.kKf=
this.En=null;this.EBa=()=>{var a;return null===(a=this.ltb)||void 0===a?void 0:a.pnf()};this.kSm=(a,l)=>{l&&l.appMode?this.EBa():m.ULS.sendTraceTag(558999755,337,15,"MandatoryLabellingModeEventListener is called with invalid inputs.")}}get KUi(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}get WKf(){return 1}get d4b(){return null}$zc(){return!1}vbc(){}Kln(a){this.ltb||(this.ltb=a)}EKi(){this.kKf.execute(a=>{a.x8g(this.kSm)})}V5b(){return{returnValue:!1,type:null,data:null}}Wab(){return null}pJh(a,
l,r){let w=0;r=a.length<r?a.length:r;for(let v=0;v<r;v++)if(a[v]===l)return w=v,{returnValue:!0,CPe:w};m.ULS.sendTraceTag(588908620,341,15,"Didn't find suggestion inside suggestion group. Null suggestion: {0}",!l);return{returnValue:!1,CPe:w}}K5b(){return!1}}Object(D.a)(f,"ContextualIntentDefinitionProvider",null,[322,323])},1480:function(D,M,d){d.d(M,"a",function(){return l});D=d(0);var m=d(8),f=d(2),a=d(35);class l{static ska(){if(0>l.Kqd){l.Kqd=0;try{const r=f.AFrameworkApplication.K.lb("OAuthManagerServiceSettings");
void 0!==r&&null!==r&&""!==r&&(l.appSettings=a.b(r),l.Kqd=l.appSettings._Version);m.ULS.sendTraceTag(572298006,3E3,100,"AppSettings: {0}",r)}catch(r){m.ULS.sendTraceTag(572298007,3E3,15,"AppSettings failed to load: {0}",r.message)}}}static Pzd(){if(0>l.Txb){f.AFrameworkApplication.K.EZa&&(l.Txb=0);try{const r=f.AFrameworkApplication.K.lb("OAuthManagerDocumentSettings");void 0!==r&&null!==r&&""!==r&&(l.docSettings=a.b(r),l.Txb=l.docSettings._Version);m.ULS.sendTraceTag(572298008,3E3,100,"DocSettings: {0}",
r)}catch(r){m.ULS.sendTraceTag(572298009,3E3,15,"DocSettings failed to load: {0}",r.message)}}}static get clientVersion(){return 7}static get appVersion(){l.ska();return l.Kqd}static get mXk(){l.Pzd();return l.Txb}static get pPe(){l.ska();return l.appSettings.AppMapping}static get authority(){l.ska();return l.appSettings.Authority}static get enableConsoleLogging(){l.ska();return l.appSettings.EnableConsoleLogging}static get JEk(){l.ska();return 7<=l.appVersion?l.appSettings.CorePFTData:{["IsEnabled"]:!0,
["Application"]:"e03a13ee-9730-4cae-8525-47559c8cf18a",["Endpoint"]:""}}static get vKc(){l.ska();if(4<=l.appVersion){if(!l.uGg&&l.appSettings.HostPageSupportsAuth&&(f.AFrameworkApplication.K.$("IsO365ConsumerHost")||f.AFrameworkApplication.K.$("IsO365CommercialHost")))try{const r=f.AFrameworkApplication.IGb.toLowerCase(),w=l.appSettings.GetAuthTokenFromParentOriginList;if(void 0!==w&&null!==w)for(const v of w)if((new RegExp("^"+v+"/?$")).test(r)){l.tGg=!0;break}}catch(r){m.ULS.sendTraceTag(570729249,
3E3,15,"Failed to validate origin: {0}",r.message)}l.uGg=!0;return l.tGg}return f.AFrameworkApplication.K.$("UiHostSupportsAuthToken")}static get isEnabled(){l.ska();return l.appSettings.IsEnabled}static get YGm(){l.ska();return l.appSettings.MockTokenForAutomation}static get zMf(){l.ska();return l.appSettings.PromiseTimeoutInMs}static get sPn(){l.ska();return l.appSettings.SharedAuthFilePath}static get tPn(){l.ska();return l.appSettings.SharedAuthOrigin}static get e9i(){l.ska();return l.appSettings.TeamsSDXEnabledSSOList}static get uoo(){l.ska();
return l.appSettings.WacFrameTeamsElectronSSO}static get MLm(){l.Pzd();return 3<=l.Txb?l.docSettings.OAuthLoginHint:null}static get Lwf(){l.Pzd();return 4<=l.Txb?l.docSettings.LokiAlternateAuthToken:null}static get ySd(){l.Pzd();return 4<=l.Txb?l.docSettings.LokiAlternateAuthTokenTTL:-1}}l.Kqd=-1;l.appSettings=null;l.Txb=-1;l.docSettings=null;l.tGg=!1;l.uGg=!1;Object(D.a)(l,"OAuthManagerSettings",null,[])},1481:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m extends Sys.EventArgs{constructor(f){super();
this.data=f}}Object(D.a)(m,"DesignerEventArgs",Sys.EventArgs,[])},1483:function(D,M,d){d.d(M,"a",function(){return w});D=d(0);var m=d(5),f=d(308),a=d(1151),l=d(1046),r=d(8);class w{constructor(v,u,z,B){this.Tom=v;this.k5l=u;this.j5l=z;this.ZCi=B}hac(v,u,z,B,G){v?(v=this.$Bc(v,u,z),null!==v&&(B=this.UYe(B,v,G),this.j5l.setState(this.Tom.value,B))):r.ULS.shipAssertTag(543499408,3016,!1,"No ParagraphNode")}$Bc(v,u,z){return 0>z?(r.ULS.sendTraceTag(539018900,389,10,"Attempted to create a ParagraphRange descriptor with negative length"),
null):f.a.iCc(v.ia(m.a.Mc,-1),v.ia(m.a.mj,-1),u,z,u,z,v)}UYe(v,u,z){return Object.assign(new l.a,{annotationType:v,contentDescriptor:u,state:z})}tMd(v,u,z,B,G){if(v){var F=v.ia(m.a.Mc,-1),K=v.ia(m.a.mj,-1);-1===F||-1===K?G(null):(v=this.$Bc(v,u,z),null===v?G(0):this.k5l.WSc(v,B,N=>{G(N)}))}else r.ULS.shipAssertTag(543499409,3016,!1,"No ParagraphNode")}VCi(v,u=null){v&&(u=a.a.XGk(v,u),this.ZCi.n7g({jkb:u,settingType:v})||r.ULS.shipAssertTag(521416710,3016,!1,"Persist Designer suppression setting failed"))}yfi(v){return new Promise(u=>
{this.ZCi.UUh(v,z=>{(null===z||void 0===z?0:z.jkb)?u(z.jkb):u(null)})})}}w.KMf="WordDesignerPullQuotesAnnotation";w.Hvh="WordDesignerDefaultAnnotation";w.N1f="WordDesignerSuggestedImageAnnotation";w.N9i="WordDesignerThemeImageAnnotation";w.y1f="WordDesignerStylizedTitleAnnotation";w.QAc="WordDesignerComplexDecoratorAnnotationType";w.uxh="DesignerPaneSuppressionSetting";w.xxh="DesignerTemplatesSetting";Object(D.a)(w,"PersistenceHelperImpl",null,[1056])},1484:function(D,M,d){d.d(M,"a",function(){return f});
D=d(0);M=d(556);var m=d(111);class f extends M.a{constructor(){super();this.H_=Object.assign(new m.a,{T_:f.getTypeName(),B_:f.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(D.a)(f,"DeleteOperation",M.a,[])},1485:function(D,M,d){d.d(M,"a",function(){return m});const m={rnh:"CommentDeepLinkNavigationFailed",DWe:"CommentDataLoss",Hud:"CommentExperienceDegraded",h7e:"CommentsFeatureUsage",MWe:"CommentThreadInProgress",
Pud:"CommentReplyInProgress",unh:"CommentEditInProgress",Fud:"CommentDeepLink",pnh:"CommentCommit",Kud:"CommentLoad"}},1486:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f,a,l,r,w=null,v=null,u=null,z=0,B=0){this.N2=this.Afc=this.VCa=this.yQ=null;this.IG=z;this.u1d=f;this.LNa=a;this.g3a=l;r&&(this.yQ=r);null!=w&&(this.VCa=w);null!=v&&(this.Afc=v);u&&(this.N2=u);this.shapeId=B}}Object(D.a)(m,"AnchorData",null,[])},1489:function(D,M,d){function m(N){return 1===(null===N||
void 0===N?void 0:N.Hq)||3===(null===N||void 0===N?void 0:N.Hq)}D=d(0);var f=d(37),a=d(57),l=d(36),r=d(8),w=d(1566),v;(function(N){N[N.initial=0]="initial";N[N.eoo=.1]="viewingOriginal";N[N.Rck=.5]="applying";N[N.applied=1]="applied";N[N.accepted=2]="accepted";N[N.rejected=3]="rejected";N[N.IGo=4]="roleChanged";N[N.XCo=5]="invalidated"})(v||(v={}));Object(D.b)("ReviewIntentState",v);var u=d(136);d.d(M,"d",function(){return B});d.d(M,"e",function(){return m});d.d(M,"b",function(){return G});d.d(M,
"c",function(){return F});d.d(M,"a",function(){return K});class z{constructor(N,H,J=null,L,I=!0){this.id=N;this.Hq=H;this.dH=J;this.ze=L;this.F9l=I;this.Lbi=!1;this.kii=f.a.lf()}u2h(){return!1}Rgb(N){var H=this.oCa,J=v;a:switch(N){case v.eoo:var L=v.rejected;break a;case v.Rck:L=v.applied;break a;default:L=N}H.call(this,J[L]);this.tSd(N)}tSd(N){1===N&&this.dH&&this.ze&&(this.F9l?(this.ze.l7l()&&this.dH.execute(H=>{H.logActivity(u.a.Prj,null)}),2===this.Hq&&this.ze.Ajm()?this.dH.execute(H=>{H.logActivity(u.a.dsj,
null)}):1===this.Hq&&this.ze.yfm()?this.dH.execute(H=>{H.logActivity(u.a.Zrj,null)}):0===this.Hq&&this.ze.Jbm()&&this.dH.execute(H=>{H.logActivity(u.a.Trj,null)})):4===this.Hq&&this.ze.y$l()&&this.dH.execute(H=>{H.logActivity(u.a.Rrj,null)}))}oSd(){6E4>f.a.lf()-this.kii?this.oCa("removed"):r.ULS.sendTraceTag(539109067,3016,50,"ID: {0}, Type: {1}, State: {2}",this.id,this.Hq,"removedButKept")}Xvm(){this.Lbi||(this.oCa("hovered"),this.Lbi=!0)}oCa(N){this.kii=f.a.lf();r.ULS.sendTraceTag(540357460,3016,
50,"ID: {0}; Type: {1}, State: {2};",this.id,this.Hq,N);a.a(u.a.CSk,!0,void 0,[Object.assign(new l.a,{name:"suggestionType",int64:this.Hq}),Object.assign(new l.a,{name:"ID",string:this.id.toString()}),Object.assign(new l.a,{name:"State",string:N})])}}Object(D.a)(z,"DesignerSuggestion",null,[]);class B extends z{constructor(N,H=1,J=null,L,I=!1,R=0,C=""){super(N,H,J,L,I);this.b1a=R;this.YUc=C}}Object(D.a)(B,"PullQuoteSuggestion",z,[]);class G extends z{constructor(N,H,J,L=null,I){super(N,2,L,I);this.dQ=
H;this.baseUrl=J;this.selectedIndex=0;this.Vec=u.a.n0l}KZl(){r.ULS.shipAssertTag(527708514,3016,this.Vec===u.a.CLm,`${this.Vec}`);this.Vec=Math.min(this.dQ.length,u.a.nTd)}u2h(){return this.Vec<Math.min(this.dQ.length,u.a.nTd)}Qzb(N){return N>=this.dQ.length?(r.ULS.shipAssertTag(527708515,3016,!1),null):this.baseUrl+this.dQ[N].imageId}ihf(N){return N>=this.dQ.length?(r.ULS.shipAssertTag(527708544,3016,!1),null):this.baseUrl+this.dQ[N].thumbnailId}tW(N){return N>=this.dQ.length?(r.ULS.shipAssertTag(527708545,
3016,!1),null):this.dQ[N].altText?this.dQ[N].altText:this.dQ[N].category===w.SuggestionCategory.AbstractImage?WordEditorIntl.WordEditorStrings.L_DesignerImageSuggestionAbstractImageAltText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage}Xsl(N){var H;return N>=this.dQ.length?(r.ULS.shipAssertTag(527210446,3016,!1),0):null!==(H=this.dQ[N].score)&&void 0!==H?H:0}}Object(D.a)(G,"ImageSuggestion",z,[]);class F extends z{constructor(N,H=null,J,L,I=null){super(N,0,H,J,L);this.metadata=I;this.zpi=
!1}Rgb(N){this.zpi||(this.zpi=!0,this.metadata&&a.a(u.a.kFk,!0,0,this.metadata.concat([Object.assign(new l.a,{name:"ID",string:this.id.toString()})])));super.Rgb(N)}}Object(D.a)(F,"InconsistencySuggestion",z,[]);class K extends z{constructor(N,H=null,J,L=!1,I){super(N,4,H,J,L);this.l1m=I}Rgb(N){this.K1n=N;super.Rgb(N)}}Object(D.a)(K,"DesignerPasteSuggestion",z,[])},1490:function(D,M,d){d.d(M,"a",function(){return G});D=d(0);var m=d(16),f=d(127),a=d(9),l=d(541),r=d(49),w=d(19),v=d(24),u=d(247),z=d(11),
B=d(20);class G{constructor(F,K,N,H,J){this.qBb=F;this.tYa=K;this.Rqb=N;this.nia=H;this.Vd=J;this.nNg=0;this.G6a=null;this.nSj=!1;this.WMg=!0;this.PHg=null;this.BRc=this.hed=!0;this.eJg=!1;this.jsc=F?F.innerText:z.ParagraphReader.text(K)}get GB(){throw Error.notImplemented("The inherit class should have the default value.");}set GB(F){}get e8b(){return this.nNg}D_i(F){this.nNg=F}get kb(){return this.G6a}set kb(F){this.G6a=F}get CF(){return this.Rqb}get PZ(){return this.nia}get ebi(){return this.eJg}get Tgi(){return!1}get tua(){return this.jsc}get mTn(){return!0}invoke(){this.eJg=
!0;if(this.qBb&&this.qBb.parentNode&&!this.GB){var F=this.qBb.innerText;if(this.BRc&&m.a.substring(this.jsc,this.Rqb,this.nia)!==m.a.substring(F,this.Rqb,this.nia))return 0;this.Rxb(this.qBb);this.D_i(this.qBb.innerText.length-F.length);return 1}this.hed||f.a.instance.Yb("MatchTextIsNotTheSame",{["Reason"]:"MatchTextIsNotTheSame"});if(!this.WMg)return f.a.instance.Yb("AbortedAction",{["Reason"]:this.PHg}),0;var K=z.ParagraphReader.text(this.tYa);F=K.length;var N=this.jsc.length,H=m.a.substring(this.jsc,
this.Rqb,this.nia).trimEnd();K=m.a.substring(K,this.Rqb,this.nia).trimEnd();this.mTn&&H===K&&this.nia>N&&(this.nia=N);if(this.BRc&&H!==K)if(N=H.replace(RegExp('"',"g"),""),N===m.a.substr(K,0,N.length))this.nia-=2;else return 0;if(B.a.instance.J(4)&&a.App.rd.Kp&&l.CoauthLockEditor.getInstance().s2a(G.Zf.K1b(this.tYa)))return 0;N=new r.GraphTransaction(15);N.Db(this.tYa);N.zl=this.commandId;this.lka(this.tYa);this.D_i(z.ParagraphReader.textLength(this.tYa)-F);this.G6a&&!this.nSj&&w.SelectionEditor.Km(this.G6a)&&
(K=this.G6a.Qa,F=K.cpBegin,H=K.cpEnd,K=K.node,K===this.tYa&&this.e8b&&(F>=this.nia&&(F+=this.e8b),H>=this.nia&&(H+=this.e8b),this.G6a=v.SelectionFactory.wN(K,F,H)));N.dispose();return 2}xij(){this.hed=this.xkh()}Rxb(){}xkh(){var F=z.ParagraphReader.text(this.tYa);const K=m.a.substring(this.jsc,this.Rqb,this.nia).trimEnd();F=m.a.substring(F,this.Rqb,this.nia).trimEnd();return K===F}static get Zf(){return u.a.instance}}Object(D.a)(G,"AAutoCorrectAction",null,[627])},1491:function(D,M,d){d.d(M,"a",function(){return a});
D=d(0);var m=d(33),f=d(8);class a{constructor(l){this.Ox=l}static create(l){if(!l)return f.ULS.shipAssertTag(575930373,3016,!1),null;l=m.a.create(l);return new a(l)}}Object(D.a)(a,"ShowReviewArgs",null,[])},1496:function(D,M,d){d.d(M,"c",function(){return a});d.d(M,"a",function(){return l});d.d(M,"b",function(){return r});D=d(0);var m=d(1483);class f{constructor(w,v,u){this.suggestion=w;this.Hq=v;this.paragraphNode=u}get role(){switch(this.Hq){case 1:case 3:return 27;case 2:return 28;default:return 1}}}
Object(D.a)(f,"AddEnhancementActionData",null,[]);class a extends f{constructor(w,v,u,z,B,G=1){super(w,G,v);this.b1a=u;this.YUc=z;this.callback=B}}Object(D.a)(a,"AddPullQuoteActionData",f,[]);class l extends f{constructor(w,v,u=0){super(w,2,v);this.tla=u}}Object(D.a)(l,"AddCoverPhotoActionData",f,[]);class r{constructor(w,v,u,z,B){this.suggestion=w;this.paragraphNode=v;this.U4b=u;this.WLc=z;this.grd=B}get annotationType(){switch(this.suggestion.Hq){case 1:case 3:return m.a.KMf;case 2:return m.a.N1f;
default:return m.a.Hvh}}}Object(D.a)(r,"AddDesignerSuggestionActionData",null,[])},1497:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f,a,l,r=!1,w=!1,v=!1,u=!1,z=null){this.Ox=f;this.source=a;this.DMa=l;this.kja=r;this.wec=w;this.HDh=v;this.ZJa=u;this.An=z}}Object(D.a)(m,"ContextualIntentInvocationParameters",null,[])},1499:function(D,M,d){D=d(0);var m=d(8),f=d(43),a=d(2),l=d(124),r=d(98),w=d(7),v=d(68),u=d(57),z=d(102);d(159);class B{constructor(){this.secondActionButtonProps=
this.firstActionButtonProps=this.messageTitle=this.message=null;this.isMultiline=!1;this.messageBarType=0;this.closeable=!1;this.messageBarIconProps=this.linkProps=this.dismissButtonAriaLabel=this.onDismiss=null}}Object(D.a)(B,"MessageBarProps",null,[]);var G=d(1379),F=d(190),K=d(1008),N=d(29),H=d(140),J=d(121),L=d(13);d.d(M,"a",function(){return I});class I{constructor(R,C,P){this._message=this._title=null;this.wte=this.RNb=!1;this.fhe=0;this.axa="";this._image=0;this.CM=this.h0=this.LFa=this._link=
this.Dqb=this.ujc=this.tjc=this.sjc=this.rjc=this.zV=this.vha=this.zIa=this.Y6a=null;this.wNb=this.vNb=!1;this.Xug=this.Ihe="";this.Ghe=!1;this.Yug=this.Mhe="";this.Khe=!1;this.Lhe=this.Hhe=null;this.FRb=!1;this.xwe=this.Eqb="";this.Cqb=null;this.Soc=this.SHg=!1;this.RVa=this.Kja=this.ula=this.sY=this.mP=null;this.errorCode=0;this.C$g=this.visible=!1;this.title=R;this.message=C;this.Ala=P;this.id=0;this.image=1;this.mOd=!0;this.Hdh=5}get htmlElement(){return this.sY}get mOd(){return this.wte}set mOd(R){this.wte=
R}get Hdh(){return this.fhe}set Hdh(R){this.fhe=R}get title(){return this._title}set title(R){this._title!==R&&(this._title=R,this.zIa&&(this.zIa.innerText=this._title))}get message(){return this._message}set message(R){this._message!==R&&(this._message=R,this.vha&&(this.vha.innerText=this._message))}get image(){return this._image}set image(R){this._image=R;4!==this._image&&(this.ula="")}get imageAltText(){return this.axa}set imageAltText(R){this.axa=R}get closeable(){return this.RNb}set closeable(R){this.RNb!==
R&&(this.RNb=R,this.LFa&&(this.LFa.style.display=this.RNb?"table-cell":"none"))}get lIi(){return a.AFrameworkApplication.K.$("ReactBusinessBarIsEnabled")}get Omo(){return a.AFrameworkApplication.K.$("Fluent2StyleIsEnabled")}addButton(R,C,P,W=!1){this.Ihe=R;this.Hhe=C;this.vNb=!0;this.Xug=P;this.Ghe=W}E7g(R,C){this.Mhe=R;this.Lhe=C;this.wNb=!0;this.Yug="";this.Khe=!1}I1j(R){this.Eqb=Box4Intl.Box4Strings.l_BusinessBarODTDocumentDetailsLink;this.xwe=R;this.FRb=!0}Ipd(R,C){this.Eqb=R;this.Cqb=C;this.FRb=
!0}LKk(){var R=H.a.Lka(a.AFrameworkApplication.K.lb("VNextStyleOptOutCookieName"),!1);R=this.Omo&&!R;this.sY=document.createElement("div");this.htmlElement.className=String.format("{0} {1} {2}",I.Vug,I.jQj,R?I.$Xj:"");this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.RVa&&null!==this.RVa&&(this.htmlElement.id=this.RVa);R=()=>{F.UISurfaces.cxl().then(C=>{this.mP.Brf||(C.initializeMessageBarInStore(),this.mP.Brf=!0);const P=Object.assign(new B,{message:this._message,messageTitle:this._title,
isMultiline:this.wte,messageBarType:this.fhe});if(this.RNb){P.closeable=!0;var W=this._message+". "+CommonUIStrings.l_DialogClose;this._title&&(W=this._title+". "+W);P.dismissButtonAriaLabel=W;P.onDismiss=()=>{this.fWe(this)}}4===this._image&&(P.messageBarIconProps={["iconName"]:this.ula});this.FRb&&(P.linkProps={["type"]:"AppLinkProps",["text"]:this.Eqb,["handler"]:{["href"]:this.xwe,["target"]:"_blank"}},this.Cqb&&(W=Object(f.a)(this,this.sSm,"onMessageBarLinkClicked"),P.linkProps.handler=W));this.vNb&&
(P.firstActionButtonProps=new G.a(this.Ihe,()=>{this.umk(this)}));this.wNb&&(P.secondActionButtonProps=new G.a(this.Mhe,()=>{this.Amk(this)}));C.createNewMessageBarWithCallback?C.createNewMessageBarWithCallback(this.htmlElement,P,()=>{a.AFrameworkApplication.ua.YRc()}):C.createNewMessageBar(this.htmlElement,P);return null}).catch(()=>{m.ULS.sendTraceTag(595096981,324,10,"Failed to load React Message Bar API");return null})};l.a.get_instance().isCompleted(7)?R():l.a.get_instance().sl(7,R);this.Ala&&
(a.AFrameworkApplication.ua.Zy.mb(w.a.click,this.htmlElement,Object(f.a)(this,this.onClick,"onClick")),a.AFrameworkApplication.ua.$y.jE(w.a.Bh,this.htmlElement,Object(f.a)(this,this.fEf,"onBodyKeyUp"),this),this.SHg&&!this.Soc&&(a.AFrameworkApplication.ua.Cva.mb(this.htmlElement,Object(f.a)(this,this.onClick,"onClick"),null),this.Soc=!0));return this.htmlElement}createElement(){a.AFrameworkApplication.eaa("Microsoft.Office.Web.SessionSettings.IWacWordReactBusinessBarSettings");if(this.lIi)return this.LKk();
this.sY=document.createElement("div");this.htmlElement.className=I.Vug;this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.RVa&&null!==this.RVa&&(this.htmlElement.id=this.RVa);this.Y6a=null;if(0!==this._image){this.Y6a=document.createElement("span");this.Y6a.className="WACBusinessBarIcon";this.htmlElement.appendChild(this.Y6a);var R=null;let C=null;switch(this._image){case 2:R=I.RAj;C=CommonUIStrings.l_DialogError;break;case 1:R=I.BYj;C=CommonUIStrings.l_DialogWarning;break;case 3:R=
I.Opb;C=CommonUIStrings.l_DialogInfo;break;case 4:R=this.ula,C=this.axa}this.Y6a.title=C;this.Y6a.setAttribute(N.a.Ah,N.a.CQe);this.Y6a.appendChild(r.createClusteredImage(24,24,R,I.tFj,!0,""))}R=J.a.create().toString();this.zV=document.createElement("div");this.zV.id="BBTitleAndBody"+R;this.zV.className=I.fwj;this.zV.tabIndex=0;this._title&&(this.zIa=document.createElement("p"),this.zIa.innerText=this._title,this.zIa.className=I.gwj+" UIFontBold",this.zIa.id="BBTitle"+R,this.zIa.setAttribute("UNSELECTABLE",
"on"),this.zV.setAttribute(N.a.dda,this.zIa.id),this.zV.appendChild(this.zIa));this.vha=document.createElement("p");this.vha.className=I.Zvj;this.vha.innerText=this._message;this.vha.id="BBBody"+R;this.vha.setAttribute("UNSELECTABLE","on");this.vha.style.width="100%";this.zV.setAttribute(N.a.o1,this.vha.id);this.vNb&&this.j6g(this.vha,this.Xug);this.wNb&&this.j6g(this.vha,this.Yug);this.zV.appendChild(this.vha);R=document.createElement("div");R.setAttribute(N.a.Ah,N.a.vQe);R.appendChild(this.zV);
this.htmlElement.appendChild(R);this.vNb&&(this.sjc=document.createElement("span"),this.rjc=document.createElement("button"),this.cWa(this.sjc,this.rjc,this.Ihe,Object(f.a)(this,this.Ggh,"buttonOneClickHandler")));this.wNb&&(this.ujc=document.createElement("span"),this.tjc=document.createElement("button"),this.cWa(this.ujc,this.tjc,this.Mhe,Object(f.a)(this,this.Igh,"buttonTwoClickHandler")));this.FRb&&(this.Dqb=document.createElement("span"),this.Dqb.className=I.ewj,this._link=document.createElement("a"),
this._link.className=K.a.dwj,this._link.innerText=this.Eqb,this.Cqb?(this._link.tabIndex=0,a.AFrameworkApplication.ua.Zy.jE(w.a.click,this._link,Object(f.a)(this,this.uji,"linkClickHandler"),this),a.AFrameworkApplication.ua.$y.jE(w.a.Bh,this._link,Object(f.a)(this,this.vwi,"onLinkKeyUp"),this)):(this._link.href=this.xwe,this._link.target="_blank"),this.Dqb.appendChild(this._link),this.htmlElement.appendChild(this.Dqb));a.AFrameworkApplication.ua.Zy.mb(w.a.click,this.htmlElement,Object(f.a)(this,this.onClick,
"onClick"));a.AFrameworkApplication.ua.$y.jE(w.a.Bh,this.zV,Object(f.a)(this,this.fEf,"onBodyKeyUp"),this);this.SHg&&!this.Soc&&(a.AFrameworkApplication.ua.Cva.mb(this.htmlElement,Object(f.a)(this,this.onClick,"onClick"),null),this.Soc=!0);this.RNb&&(this.LFa=document.createElement("span"),this.LFa.className=I.exj,this.h0=document.createElement("a"),this.h0.className=I.fxj,this.h0.tabIndex=0,this.h0.title=CommonUIStrings.l_DialogClose,this.h0.setAttribute(N.a.Ah,N.a.n1),this.CM=r.createClusteredImage(16,
16,I.gxj,"",!0,""),this.h0.appendChild(this.CM),this.LFa.style.display="table-cell",this.LFa.appendChild(this.h0),this.htmlElement.appendChild(this.LFa),a.AFrameworkApplication.ua.Zy.jE(w.a.click,this.h0,Object(f.a)(this,this.Jui,"onCloseClick"),this),a.AFrameworkApplication.ua.$y.jE(w.a.Bh,this.h0,Object(f.a)(this,this.Kui,"onCloseKeyUp"),this));return this.htmlElement}KUn(){this.zV&&this.zV.setAttribute(N.a.wz,N.a.eL)}j6g(R,C){if(C&&""!==C){var P=document.createElement("span");P.className=I.ZRj;
P.innerText=C;R.appendChild(P)}}cWa(R,C,P,W){R.className=I.awj;C.setAttribute("type","button");C.className=I.$vj;C.innerText=P;R.appendChild(C);this.htmlElement.appendChild(R);a.AFrameworkApplication.ua.Zy.jE(w.a.click,C,W,this)}lQi(){this.lIi||(this.zV.style.whiteSpace="nowrap",this.closeable?this.LFa.style.width="auto":this.FRb?this.Dqb.style.width="auto":this.wNb?this.ujc.style.width="auto":this.vNb?this.sjc.style.width="auto":this.zV.style.width="auto",this.htmlElement.clientWidth>this.mP.htmlElement.clientWidth?
this.zV.style.whiteSpace="normal":this.closeable?this.LFa.style.width="100%":this.FRb?this.Dqb.style.width="100%":this.wNb?this.ujc.style.width="100%":this.vNb?this.sjc.style.width="100%":this.zV.style.width="100%")}U5f(R,C){if(z.a.L9b()){var P={};P.WacSessionId=a.AFrameworkApplication.userSessionId;P.ActionName="BusinessBar"+R;P.InputMethod=C;m.ULS.sendTraceTag(35489761,207,50,JSON.stringify(P))}}G6(R,C,P,W){this.U5f(R,P);z.a.hgb()&&u.c(C,!0,u.e,W,10)}Ggh(R){this.Hhe(R.vp);this.G6("ButtonOne",L.a.xgh,
"Mouse",2);this.Ghe&&(this.G6("Close",L.a.WXb,"Mouse_ButtonOne",2),this.close(R));return!0}umk(R){this.Hhe(R);this.G6("ButtonOne",L.a.xgh,"Mouse",2);this.Ghe&&(this.G6("Close",L.a.WXb,"Mouse_ButtonOne",2),this.fWe(R))}Igh(R){this.Lhe(R.vp);this.G6("ButtonTwo",L.a.ygh,"Mouse",2);this.Khe&&(this.G6("Close",L.a.WXb,"Mouse_ButtonTwo",2),this.close(R));return!0}Amk(R){this.Lhe(R);this.G6("ButtonTwo",L.a.ygh,"Mouse",2);this.Khe&&(this.G6("Close",L.a.WXb,"Mouse_ButtonTwo",2),this.fWe(R))}uji(R){this.Cqb(R.vp);
this.G6("Link",L.a.Cgh,"Mouse",2);return!0}sSm(){this.Cqb(null)}vwi(R){return R.Ib.keyCode!==v.a.Ks||R.Ib.altKey?!1:(this.Cqb(R.vp),this.G6("Link",L.a.Cgh,"Keyboard",1),!0)}fEf(R){return R.Ib.keyCode===v.a.Ks&&!R.Ib.altKey&&this.Ala?(this.Ala(R.vp,R),this.G6("Invoke",L.a.Bgh,"Keyboard",1),!0):!1}dispose(){this.htmlElement&&(a.AFrameworkApplication.ua.Zy.sc(w.a.click,this.htmlElement,Object(f.a)(this,this.onClick,"onClick")),this.Soc&&a.AFrameworkApplication.ua.Cva.sc(this.htmlElement,Object(f.a)(this,
this.onClick,"onClick")));this.h0&&(a.AFrameworkApplication.ua.Zy.sc(w.a.click,this.h0,Object(f.a)(this,this.Jui,"onCloseClick")),a.AFrameworkApplication.ua.$y.sc(w.a.Bh,this.h0,Object(f.a)(this,this.Kui,"onCloseKeyUp")));this.rjc&&a.AFrameworkApplication.ua.Zy.sc(w.a.click,this.rjc,Object(f.a)(this,this.Ggh,"buttonOneClickHandler"));this.tjc&&a.AFrameworkApplication.ua.Zy.sc(w.a.click,this.tjc,Object(f.a)(this,this.Igh,"buttonTwoClickHandler"));this._link&&this.Cqb&&(a.AFrameworkApplication.ua.Zy.sc(w.a.click,
this._link,Object(f.a)(this,this.uji,"linkClickHandler")),a.AFrameworkApplication.ua.$y.sc(w.a.Bh,this._link,Object(f.a)(this,this.vwi,"onLinkKeyUp")));this.zV&&a.AFrameworkApplication.ua.$y.sc(w.a.Bh,this.zV,Object(f.a)(this,this.fEf,"onBodyKeyUp"));this.mP=this.h0=this.LFa=this.CM=this.Dqb=this._link=this.ujc=this.tjc=this.sjc=this.rjc=this.zV=this.vha=this.sY=this.zIa=this.Y6a=this.axa=null}onClick(R){this.G6("Invoke",L.a.Bgh,"Mouse",2);return!!this.Ala&&this.Ala(this,R)}Jui(R){this.G6("Close",
L.a.WXb,"Mouse",2);this.close(R);return!0}Kui(R){return R.Ib.keyCode!==v.a.Ks||R.Ib.altKey?!1:(this.G6("Close",L.a.WXb,"Keyboard",1),this.close(R),!0)}close(R){const C=R.vp;this.mP.removeEntry(C);this.R8h(C,R.eg)}R8h(R,C){if(R.Kja){const P=a.AFrameworkApplication.ya;P.yG=10;P.k6=C;R.Kja(R);P.yG=0;P.k6=0}}fWe(R){R&&this.mP&&(this.mP.removeEntry(R),this.R8h(R,0))}}I.Vug="WACBusinessBarEntry";I.gwj="WACBusinessBarTitle";I.Zvj="WACBusinessBarBody";I.fwj="WACBusinessBarTitleBodyHolder";I.awj="WACBusinessBarButtonHolder";
I.$vj="WACBusinessBarButton";I.ewj="WACBusinessBarLinkHolder";I.fxj="WACBusinessBarClose";I.exj="WACBusinessBarCloseHolder";I.gxj="BusinessBarClose_16x16x32";I.tFj="WACBusinessBarImage";I.ZRj="WACScreenReaderOnly";I.RAj="CancelRequest_24x24x32";I.BYj="Risks_24x24x32";I.Opb="Info_24x24x32";I.jQj="ReactBusinessBarEntry";I.$Xj="VNextBusinessBarEntry";Object(D.a)(I,"BusinessBarEntry",null,[266,10])},1502:function(D,M,d){d.r(M);d.d(M,"FindManagerHelper",function(){return w});D=d(0);var m=d(8),f=d(120),
a=d(9),l=d(180),r=d(998);d=d(1745);class w extends d.a{constructor(){super()}get Zc(){return a.App.xa.jb.Zc}get Qi(){return a.App.xa.jb.Zc.Ad}get uta(){return a.App.xa.jb.uta()}get kof(){return a.App.xa.jb.Jc.Ji}pNe(v){a.App.Wj.al.QIa(v)}fUd(v,u,z){return r.b(v,u,z)}y5f(v,u,z){if(1===z){if(!w.oh.z5f(v))return!1}else if(!(v.Se===u||v.Bb(u)&&v.kd(u)))return!1;return Object(f.a)(58,v.currentNode)||this.fUd(v,u,z)?!0:!1}YKa(v){return this.Qi.Eb(v).YKa()}zei(v,u,z,B){if(!v||v.matchCase!==z.matchCase||
v.matchWholeWord!==z.matchWholeWord||B.length!==u.length)return!0;for(v=0;v<B.length;v++){if(B[v]!==u[v])return!0;if(z.matchCase){if(B[v]!==u[v])return!0}else if(B[v].toLocaleLowerCase()!==u[v].toLocaleLowerCase())return!0}return!1}Kei(v,u,z,B){if(!v||v.matchWholeWord&&!z.matchWholeWord||v.matchCase&&!z.matchCase||B.length!==u.length)return!1;if(v.matchWholeWord)return v.matchCase?u[0]===B[0]:B[0].toLocaleLowerCase()===u[0].toLocaleLowerCase();for(let G=0;G<B.length;G++)if(v.matchCase){if(!B[G].startsWith(u[G]))return!1}else if(!B[G].toLocaleLowerCase().startsWith(u[G].toLocaleLowerCase()))return!1;
v.matchCase===z.matchCase&&v.matchWholeWord===z.matchWholeWord&&1===u.length&&m.ULS.sendTraceTag(4069025,313,50,"{0}",{["IncrementalSearchTriggeredQueryLength"]:z.text.length});return!0}Q1d(v,u,z){const B=a.App.Wj.al.Te(12);B.jp(v);B.rs(u);B.xv(z)}static get oh(){return l.PageNavigator.instance}static get instance(){w.Tmc||(w.Tmc=new w);return w.Tmc}}w.Tmc=null;Object(D.a)(w,"FindManagerHelper",d.a,[])},1503:function(D,M,d){d.d(M,"a",function(){return f});D=d(0);var m=d(2);class f{constructor(){this.currentDocumentPath=
m.AFrameworkApplication.K.lb("EditDocInClientUrl")}}Object(D.a)(f,"SmartLookupApplicationInterface",null,[])},1504:function(D,M,d){d.d(M,"a",function(){return L});D=d(0);var m=d(709),f=d(6),a=d(1692),l=d(1737),r=d(1738),w=d(209),v=d(11),u=d(49),z=d(133),B=d(180),G=d(648),F=d(5),K=d(585),N=d(89),H=d(158),J=d(540);class L{constructor(I,R,C,P,W){L.mNd=!1;this.uE=I;this.yAe=R;this.xAe=C;this.Xc=P;this.LCj=W}YHn(I,R){this.uE.Ila(I)&&I.properties.setValue(F.a.Gka,R)}u0b(){if(!L.mNd){var I=this.rUh();for(var R=
I.Rb(7);R;R=I.Vi(7))for(R=I.Rb(8);R;R=I.Vi(8));L.mNd=!0}}rUh(){const I=this.Xc.Ck();I.set(this.LCj());L.oh.tQ(I);return I}mu(){const I=this.rUh();this.xAe.hUd(I);this.Krn(I.currentNode);L.mNd=!1}L7m(I){this.u0b();if(I.isConnected){var R=this.b6(I);if(R=this.uE.IEd(I,R)){var C=this.Xc.Ck();C.set(R);C.Bb(25);I.anchor&&(C.set(I),C.Bb(37),C.Fg())}}}I0k(I,R){if(I.Bb(25)&&I.kd(25)&&!I.Zp(7)){const C=f.GraphIterator.$a(R);C.Bb(37);C.kd(37);R=K.a(C.currentNode,R.Bi().Nc,!0);I.Sf(R,7)}}T2k(I,R,C,P){I=new a.a(f.GraphIterator.$a(I),
f.GraphIterator.$a(R),{});I.zJb=!0;C=new m.a(C,P,new l.a(I,null));C.ah=!0;C.ll("ExecuteInternalFootnoteEndnoteCopy");C.run()}EYe(I,R){R=R.Ob.paragraph;var C=R.Bi().Ad;C=K.a(I,C,!0);R=f.GraphIterator.$a(R);this.I0k(R,I);R.Rb(7);R.Sf(C,8);return C}GUc(I,R,C,P){this.u0b();const W=this.b6(I);if(!this.uE.IEd(this.uE.zUh(I),W))return null;R=this.EYe(I,R);this.T2k(I,R,C,P);return R}KUc(I,R,C,P){this.u0b();var W=R.Ob.paragraph;const X=W.Bi().Ad;W=f.GraphIterator.$a(W);W.Bb(7);W.kd(7);this.dUd(W,R.b6());R=
K.a(I,X,!0);W.Sf(R,8);this.U2k(I,R,C,P);return R}U2k(I,R,C,P){I=new r.a(f.GraphIterator.$a(I),f.GraphIterator.$a(R),null,null);C=new m.a(C,P,I);C.ah=!0;C.ll("ExecuteInternalFootnoteEndnotePaste");C.run()}dUd(I,R){I.Rb(7);this.uE.pbi(I,R)||I.wf(7)}zRh(I,R){const C=this.Xc.Ck();C.set(R);C.Bb(7);C.kd(7);this.dUd(C,I);return C}hTh(I,R,C){return this.pTh(I,R,C,!1)}PCl(I,R,C){return this.pTh(I,R,C,!0)}pTh(I,R,C,P){var W=this.Xc.Ck();let X=null,V=!1;W.set(I);W.qo();W.kd(8);W.Wd();for(W=w.a.Ir(W,W.h3c(8));W.moveNext();){if(v.ParagraphReader.oc(W.currentNode)){const ca=
W.currentNode;var Y=N.i(ca,7);for(let fa of Y){if(ca===I){Y=fa.Ob.cp;if(P&&Y>=R)return X;Y>=R&&-1!==R&&(V=!0)}if(fa.b6()===C){if(!P&&V)return fa;X=fa}}ca===I&&(V=!0)}if(P&&V)return X}return null}Krn(I){const R=new u.GraphTransaction(3);R.Db(I);I=w.a.Vp(L.oh.gu(I));let C=1,P=1;for(;I.moveNext();){var W=I.currentNode;if(W&&v.ParagraphReader.oc(W)){W=N.i(W,7);for(let X of W){W=X.a2();const V=X.b6()?C++:P++;this.YHn(W,V)}}}R.dispose()}b6(I){return this.uE.Ila(I)?I.properties.getValue(F.a.U5):0}static arl(){return new L(J.a.instance,
z.PageReader.instance,B.PageNavigator.instance,new G.a,L.yel)}static yel(){return H.App.fm.jb.Zc}static get oh(){return B.PageNavigator.instance}static get instance(){return null!=L.xkg?L.xkg:L.xkg=L.arl()}}L.mNd=!1;Object(D.a)(L,"FootnoteEndnoteEditorInteractive",null,[397])},1509:function(D,M,d){D=d(0);class m{static lyl(){return m._nextEventReceiverId++}}m._nextEventReceiverId=0;Object(D.a)(m,"EventReceiverIdCounter",null,[]);d.d(M,"a",function(){return f});class f{constructor(a,l){this.APb=a;
this._id=m.lyl();this.nRj=l}get id(){return this._id}notify(a,l){this.nRj(a,l)}fk(a,l){return this.APb.N$m(a,l?this:null)}}Object(D.a)(f,"EventReceiver",null,[549])},1511:function(D,M,d){d.d(M,"a",function(){return K});D=d(0);var m=d(8),f=d(9),a=d(541),l=d(41),r=d(59),w=d(1889),v=d(2),u=d(1471),z=d(1485),B=d(110),G=d(591),F=d(1462);class K{static Txm(){const N=document.getElementsByClassName(G.a.bIf);if(N&&N.length){var H=N[0].clientWidth;for(let J=1;J<N.length;J++){if(N[J].clientWidth!==H||J===N.length-
1){m.ULS.sendTraceTag(540160401,327,50,"{0}:NoOfContainers={1}",N[J].clientWidth-H,N.length);break}H=N[J].clientWidth}}}static kbg(N,H,J){N&&(N=f.App.rd.Jq.Sdf(N),a.CoauthLockEditor.getInstance().s2a(N)&&m.ULS.sendTraceTag(540160402,327,15,`Comment with ObjectId: ${H.objectId} added to a locked ${J?"start":"end"} paragraph. Lock Type ${N.Type.toString()}`))}static Ino(N,H,J){const L=H.Eb(r.a.Of(N.objectId));if(L){var I=u.a.Z9(L,H,!0);H=u.a.Z9(L,H,!1);null!==I&&void 0!==I&&I.wt||(m.ULS.sendTraceTag(540160404,
327,15,`CommentRangeStart failed to save. startParaId: ${N.NWb}, CommentObjectId: ${N.objectId}`),K.Eki(J));null!==H&&void 0!==H&&H.wt||(m.ULS.sendTraceTag(540160405,327,15,`CommentRangeEnd failed to save. endParaId: ${N.MWb}, CommentObjectId: ${N.objectId}`),K.Eki(J))}else m.ULS.sendTraceTag(540160403,327,15,`Commited Comment missing CommentNode graph object ObjectId: ${N.objectId}`)}static Eki(N){N.logKpiFailure(z.a.pnh,"CommentReferenceFailedToSave",{isIntentional:!1,isInternal:!0},{name:z.a.DWe,
isIntentional:!1,isInternal:!0,isSessionEndingError:!1})}static bxm(N,H,J){0!==N.size&&N.forEach(L=>{H.has(L)||K.gxm(L,J)})}static gxm(N,H){H.Eb(r.a.Of(N))&&m.ULS.sendTraceTag(539800642,327,15,`comment start missing for ${N}`)}static Csk(N){const H=new Set;N.forEach(J=>{J&&J.Ti&&((J=K.gUh(J))?H.add(J):m.ULS.sendTraceTag(539554689,327,15,"Outline Node is undefined"))});H.forEach(J=>{const L=J.ia(B.a.QWe,[]);0===J.ia(B.a.OWe,[]).length&&0===L.length&&m.ULS.sendTraceTag(539800644,327,15,`Outline Element Node ${J.id.toString()} is missing comment info while paragraph has comments. This will cause some comments to fail to load.`)})}static hlm(N,
H,J,L){N=J.JMh(N);if(!N)return!1;J=F.k(N);L=L.Eb(J);H.has(J.toString())&&m.ULS.sendTraceTag(539800643,327,15,`Para Node ${J} missing comment reference for comment ${N.id}`);return L&&L.Ti?!0:(m.ULS.sendTraceTag(539567714,327,15,`Para Node ${J} with missing comment reference for comment ${N.id} is in a invalid state ${L?"paraNode containingGraph is null":"paraNode is null"}`),!1)}static gUh(N){let H;try{H=l.OutlineElementNavigator.Uk(N)}catch(J){m.ULS.sendTraceTag(539567715,327,10,`ParaNode ${N.id} OutlineNode failed to retrieve ${J}`)}return H}static qol(N){var H;
switch(null===(H=N.Cy)||void 0===H?void 0:H.sessionType){case w.a.create:return z.a.MWe;case w.a.reply:return z.a.Pud;case w.a.edit:return z.a.unh}}static qkh(N){if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForDuplicateReactionUsers",!0)&&(N=N[1])&&0!==N.length){var H=new Set;for(let J=0;J<N.length;J++)H.add(N[J].UserId);N.length>H.size&&m.ULS.sendTraceTag(521458447,327,15,`Reaction UserList has duplicates: ${N.length-H.size}`)}}}Object(D.a)(K,"CommentDiagnosticHelpers",
null,[])},1512:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{}m.open="open";m.refresh="refresh";m.nUf="saveAs";m.translate="translate";m.modeSwitch="modeSwitch";m.XZe="createNew";Object(D.a)(m,"ReasonList",null,[])},1513:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{static b2c(f){if(!f)return"{NULL}";const a=f.length;if(600>=a)return f;const l=a-195;return f.substring(0,400)+"[...]"+f.substring(l,a)}}Object(D.a)(m,"LogUtils",null,[])},1514:function(D,M,d){d.d(M,"b",
function(){return m});d.d(M,"a",function(){return f});d.d(M,"c",function(){return a});const m=(l,r,w,v,u,z,B,G)=>{var F=1;if(!l&&!r||!w||!v)return F;u&&z?(z=w+l,F=v+r,l=1/w,r=1/v,u=l>r?l:r,1>z?z=1:1920<z&&(z=1920),1>F?F=1:1280<F&&(F=1280),l=z-w,r=F-v,G?(w=z/w,v=F/v,F=Math.abs(w-B)<Math.abs(v-B)?w:v):F=Math.abs(l/w)>Math.abs(r/v)?z/w:F/v,F<u&&(F=u)):u?(B=w+l,1>B?B=1:1920<B&&(B=1920),F=B/w):z&&(B=v+r,1>B?B=1:1280<B&&(B=1280),F=B/v);return F},f=(l,r)=>{l=Math.atan2(r.y-l.y,r.x-l.x);0>l&&(l+=2*Math.PI);
return l},a=l=>{l%=360;0>l&&(l+=360);return l}},1515:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{}Object(D.a)(m,"SmartLookupSelection",null,[])},1517:function(D,M,d){d.d(M,"a",function(){return J});D=d(0);var m=d(22),f=d(813),a=d(648),l=d(38),r=d(180),w=d(5),v=d(44),u=d(17),z=d(8),B=d(120),G=d(72),F=d(43),K=d(441),N=d(157),H=d(921);class J{constructor(L,I,R,C,P,W){this.zYj=L;this.Ie=I;this.iif=R;this.txa=C;this.wpe=P;this.vpe=W}get Gk(){return null!=this.Dpg?this.Dpg:this.Dpg=m.a.instance.resolve("WordEditor.ITableEditor")}get Rd(){return null!=
this.Eqg?this.Eqg:this.Eqg=m.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Hk(){return null!=this.kqg?this.kqg:this.kqg=m.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get $Lb(){return this.zYj.value}get R3c(){return this.Ie.value}Mlh(L){const I=this.$Lb.yAb(L,f.a.MUd);I&&(this.ePa(I,L),this.Ena(1696,L))}ePa(L,I,R=!0){const C=this.$Lb.mLa(I);if(C&&(L=this.R3c.tf(L),C.uh(L))){const P=this.$Lb.fT(I);let W="Unknown";this.$Lb.X8.value&&(W=this.$Lb.X8.value.xb(L)?
L:"CustomStyle");z.ULS.sendTraceTag(0,311,50,"{0}",{["ApplyTableStyleId"]:W,["RowCount"]:this.wpe(I),["ColumnCount"]:this.vpe(I),["HR"]:!!(P&32),["FC"]:!!(P&128),["TR"]:!!(P&64),["LC"]:!!(P&256),["BR"]:!(P&512),["BC"]:!(P&1024),["TableId"]:I.id.toString()});R&&this.Vaa(I);this.E7f(I,C);R=C.uh(L);I.properties.setValue(w.a.tableStyle,R.id);this.HVe(I);I.wS.h2(!0)}}PZc(L,I,R){if(L=this.$Lb.yAb(R,L))this.Ena(I,R),this.ePa(L,R)}Ena(L,I,R=!0){R&&this.Vaa(I);I.properties.setValue(w.a.tableLook,L);z.ULS.sendTraceTag(0,
311,50,"{0}",{["HR"]:!!(L&32),["FC"]:!!(L&128),["TR"]:!!(L&64),["LC"]:!!(L&256),["BR"]:!(L&512),["BC"]:!(L&1024),["TableId"]:I.id.toString()});I.wS.h2(!0)}E7f(L,I){(L=this.txa(L))&&I.QZc(L,!1)}HVe(L){if(L.isConnected){L.hasProperty(v.a.fv)&&L.removeProperty(v.a.fv);this.ZQf(L);this.YWc(L);L=this.iif.pg(L);for(var I=L.Rb(1);I;){for(I=L.Rb(1);I;)I.hasProperty(u.a.NH)&&I.removeProperty(u.a.NH),I.hasProperty(w.a.Mga)&&I.removeProperty(w.a.Mga),this.rOa(I),this.YWc(I),I=L.Vi(1);I=L.Vi(1)}}}j3b(L){let I=
L.ia(v.a.Pma,null);if(I)return I;if(L=this.R3c.tf(L))if(I=({value:I}=this.$Lb.X8.value.Dc(L,I)).returnValue?I:null)return I;return L}kWi(L,I,R,C,P){L.properties.setValue(I.style,R);L.properties.setValue(I.size,C*N.a.HXb);L.properties.setValue(I.color,P)}Vaa(L){if(this.Rd.wg){var I;Object(B.a)(K.a,L)&&(I=Object(G.a)(K.a,L))&&(I=I.IQ())&&this.Hk.Vaa(L,I)}}ZQf(L){L.Qg(w.a.Ta,w.a.Va,w.a.kba,w.a.nb,w.a.pb,w.a.iba,w.a.Sa,w.a.Ua,w.a.hba,w.a.ob,w.a.qb,w.a.jba,w.a.rb,w.a.tb,w.a.Jga,w.a.Jb,w.a.Kb,w.a.Kga)}rOa(L){L.Qg.apply(L,
this.Gk.tUe)}YWc(L){L.Qg(w.a.Ca,w.a.za,w.a.Aa,w.a.Ba,w.a.pM,w.a.rO,w.a.nEa,w.a.lEa)}static Sgf(){return new J(m.a.instance.Ye("WordEditor.IWACTableStyleReader"),m.a.instance.Ye("Box4.Styles.IWACStyleReader"),new a.a,Object(F.a)(J.oh,J.oh.gu,"navigateToPageContentNode"),l.TableReader.ag,l.TableReader.kh,H.a.instance)}static get oh(){return r.PageNavigator.instance}static get instance(){return null!=J.tlg?J.tlg:J.tlg=J.Sgf()}}Object(D.a)(J,"WACTableStyleEditor",null,[296,16])},1518:function(D,M,d){d.d(M,
"a",function(){return m});D=d(0);class m{constructor(){this.data=this.landingTab=null}}Object(D.a)(m,"LaunchData",null,[])},1526:function(D,M,d){d.d(M,"a",function(){return a});D=d(0);var m=d(180),f=d(244);class a{Z_a(l){a.oh.tQ(l);return l.Rb(16)}static lr(){return new f.a(()=>new a)}static get instance(){return a._instance.value}static get oh(){return m.PageNavigator.instance}}a._instance=a.lr();Object(D.a)(a,"CommentNavigator",null,[201])},1527:function(D,M,d){d.d(M,"a",function(){return m});D=
d(0);class m extends Sys.EventArgs{constructor(){super();this.Hvi=this.ACa=null}}Object(D.a)(m,"OnCommentInitArgs",Sys.EventArgs,[])},1528:function(D,M,d){d.d(M,"a",function(){return w});D=d(0);var m=d(51),f=d(106),a=d(8),l=d(96),r=d(65);class w{constructor(v,u,z){a.ULS.shipAssertTag(6305502,307,!!v);this.properties=v;this.Lc=u;this.cP=z}RUh(){return this.properties.ia(f.a.$T,"")}pEi(){return!0}Rbj(){let v=!1,u=null;const z=this.RUh();if(this.cP||""!==z)try{({Ura:u,returnValue:v}=this.ugc(z))}catch(B){a.ULS.shipAssertTag(4203138,
307,!1),this.Lc.Yb(l.a.Aka,{["Reason"]:r.a.NSe}),m.a.YY(u)}else a.ULS.sendTraceTag(3994443,307,50,"PastedHTMLString empty"),this.Lc.Yb(l.a.J_,{["Reason"]:r.a.J6e});return{returnValue:v,xvd:u}}}Object(D.a)(w,"AStringInputImportStrategy",null,[571])},1530:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f){this.id=f}}Object(D.a)(m,"DesignerPaneToggleData",null,[])},1532:function(D,M,d){d.d(M,"a",function(){return r});D=d(0);var m=d(1774),f=d(648),a=d(5),l=d(998);class r{constructor(w){this.Rpl=
(v,u)=>{const z=this.IWh(v),B=this.Xc.pg(u);return B.Bb(z)?(B.kd(z),new m.a(B.currentNode,u,v)):null};this.Qpl=(v,u)=>{let z=null,B=null;const G=this.IWh(v);u=this.Xc.pg(u);({rootNode:z,tva:B}=this.NLn(u,v,G,z,B));return z&&B?new m.a(z,B,v):null};this.Vpl=v=>{v=this.Xc.pg(v);return(this.y6(2)||this.y6(4))&&v.Bb(36)?(v.kd(36),this.j8k(v.currentNode)):(this.y6(8)||this.y6(16))&&v.Bb(37)?(v.kd(37),this.sGh(v.currentNode)):this.y6(32)&&v.Bb(40)?32:this.y6(1)&&v.Bb(8)?1:0};this.Xc=w;this.k8k=this.Vpl;
this.W7k=this.Rpl;this.V7k=this.Qpl;this.z8k=31;this.T1f=this.Zpl()}bPh(w){const v=[],u=this.k8k(w);if(u){var z=this.W7k(u,w);z&&(v[v.length]=z)}for(let B of this.T1f)B!==u&&B&&(z=this.V7k(B,w))&&(v[v.length]=z);return v}y6(w){return!!w&&!!(this.z8k&w)}NLn(w,v,u,z,B){if(w.Bb(7)){w.kd(7);if(8===u||37===u||39===u)for(var G=w.Wd();G;){if(G.type===u)if(37===u){if((8===v||16===v)&&v===this.sGh(G)){z=w.currentNode;break}}else{z=w.currentNode;break}G=w.xj()}z&&w.RC()&&(G=this.Xc.pg(z),l.b(G,u,v)&&(B=w.currentNode))}return{rootNode:z,
tva:B}}Zpl(){const w=[];this.y6(1)&&(w[w.length]=1);this.y6(2)&&(w[w.length]=2);this.y6(4)&&(w[w.length]=4);this.y6(8)&&(w[w.length]=8);this.y6(16)&&(w[w.length]=16);this.y6(32)&&(w[w.length]=32);return w}IWh(w){let v=8;switch(w){case 1:case 2:case 4:v=8;break;case 8:case 16:v=37;break;case 32:v=39}return v}sGh(w){w=w.properties.getValue(a.a.U5);return this.y6(8)&&1===w?8:this.y6(16)&&!w?16:0}j8k(w){w=w.getValue(a.a.U3b);return this.y6(2)&&r.ecm(w)?2:this.y6(4)&&r.Ebm(w)?4:0}static YD(){return new r(new f.a)}static get instance(){return null!=
r.Dkg?r.Dkg:r.Dkg=r.YD()}static ecm(w){return w&&1!==w&&2!==w?!1:!0}static Ebm(w){return 3===w||4===w||5===w?!0:!1}}Object(D.a)(r,"WordFindContextHelper",null,[293])},1533:function(D,M,d){d.d(M,"a",function(){return u});D=d(0);var m=d(8),f=d(43),a=d(2),l=d(137),r=d(22),w=d(248),v=d(36);class u{constructor(){this.c9a=null;this.ZZg=!1}G5f(){try{this.c9a||(this.c9a=r.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"),this.ZZg=!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.EnableOAuthMgrForService",
!1))}catch(z){m.ULS.sendTraceTag(51689674,1300,10,"Unable to resolve ISearchOAuthManager: "+z)}}twl(){this.G5f();return this.c9a?this.c9a.getToken("Search",a.AFrameworkApplication.Mwf,!1):null}kYh(){if("Dev Box"===a.AFrameworkApplication.K.lb("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(z=>{window.setTimeout(()=>{z(window.TellMeSubstrateTokenOverride)},750)});this.G5f();return this.c9a?this.c9a.getToken("Search",
a.AFrameworkApplication.K1f,!0):null}XJl(){this.G5f();return this.c9a?this.c9a.getToken("Search",this.UJl(),this.ZZg):null}UJl(){return a.AFrameworkApplication.K.lb("TellMeServiceAuthEndpointForSearch")}uwl(){return Object(f.a)(this,this.twl,"getLokiTokenPromise")}zIl(){return Object(f.a)(this,this.kYh,"getSubstrateTokenPromise")}EJb(){return!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Sb.EJb}HKl(){const z={};this.EJb()&&(z.Loki=this.uwl(),z.Substrate=this.zIl());return z}xQc(z){l.a.MDa(Object.assign(new w.a,
{name:"Events",dataFields:[Object.assign(new v.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new v.a,{name:"Status",bool:z})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}rrm(){return a.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("tellme-strings").catch(()=>{this.xQc(!1);return!1}).then(()=>{this.xQc(!0);return!0}):new Promise((z,B)=>{const G=r.a.instance.resolve("Common.IDynamicScriptLoaderProvider").tE;G?G.loadScript("tellme-strings").then(()=>
{this.xQc(!0);z(!0)}).catch(()=>{this.xQc(!1);B(!1)}):(this.xQc(!1),B(!1))})}static Xhm(){return!!a.AFrameworkApplication.ua&&(a.AFrameworkApplication.ua.Sb.JOc||a.AFrameworkApplication.ua.Sb.T6b)}static UOd(){return!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Sb.T6b}}Object(D.a)(u,"ReactSharedHeaderSearchUtils",null,[])},1544:function(D,M,d){D=d(0);var m=d(584),f=d(16),a=d(2),l=d(67);class r{constructor(){this.Priority=0;this.Context=null;this.Length=this.StartInContext=this.Start=0;
this.Metadata=r.j_k;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=this.TileId=this.Explanation=this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}r.j_k=[];Object(D.a)(r,"Critique",null,[]);class w{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(D.a)(w,"Suggestion",null,[]);var v=d(604),u=d(19),
z=d(11);class B extends Sys.EventArgs{constructor(N,H,J,L,I,R){super();this.jEj=N;this.hGj=H;this.iGj=J;this.rfe=L;this.fz=I;this.Imb=R}}Object(D.a)(B,"AugloopProofingContextMenuArgs",Sys.EventArgs,[]);var G=d(230),F=d(337);d.d(M,"a",function(){return K});class K{constructor(N,H){this.rne=N;this.Ls=H}Zph(N){const [H,J,L]=this.j_h(N);return this.HOh(H,J,L)}O9l(N){return G.a.getTypeNameFor(N.content)===F.a.getTypeName()}HOh(N,H,J){if(J&&this.O9l(J)){const I=J.content;var L=new r;L.ExplanationTitle=
I.explanationTitle;L.Suggestions=this.FIl(J);L.CategoryTitle=I.categoryName;L.TypeId=I.typeId;L.CritiqueActions=I.critiqueActions;L.Priority=I.priority;J=this.rne.create(L);L=I.context;J.token=L.substring(I.range.start,I.range.start+I.range.length);J.lcid=m.a.lg(I.language).LCID;J.originalText=L;return new v.a(N,H,J)}return null}FIl(N){var H=N.content.suggestions;N=[];for(const J of H)H=new w,H.Action=J.suggestionActions,H.Text=J.text,H.Description=J.description,N.push(H);return N}j_h(N){const H=
this.Ls.OHc(N,0),J=N.cpBegin,L=N.cpEnd,I=u.SelectionEditor.xf(N);N=z.ParagraphReader.text(N.node,0);for(const R of H)if(I){if(R.begin<=J&&R.end>=L)return[R.begin,R.end,R.intent]}else if(R.begin<=J&&R.end>=J&&f.a.oph(N,R.end,L))return[R.begin,R.end,R.intent];return[null,null,null]}static Jy(){return!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}Bif(N,H,J){const [L,I,R]=this.j_h(N);R&&K.sa.raiseEvent(K.mdh,new B(N,
L,I,H,R,J))}static A5j(N){K.sa.addHandler(K.mdh,N)}y5k(N,H,J){N=this.Ls.oRh(N,0,0,N.characterData.length);for(let L=0;L<N.count;L++){const I=N.J(L);if(I.intent){const R=I.intent;if(R.content&&(0==R.content.priority||1==R.content.priority)&&I.begin>=H&&(!J||J(I.intent)))return this.HOh(I.begin,I.end,I.intent)}}return null}}K.sa=new l.a;K.mdh="augloopProofingContextMenuActionEventKey";Object(D.a)(K,"AugLoopProofingErrorDetailHelper",null,[])},1546:function(D,M,d){var m=d(1486);D=d(0);class f{}Object(D.a)(f,
"SerializableAnchorDataV1",null,[]);class a{}Object(D.a)(a,"SerializableCpDataV1",null,[]);var l=d(949);d.d(M,"a",function(){return r});d.d(M,"c",function(){return w});d.d(M,"b",function(){return v});d.d(M,"d",function(){return u});const r=z=>new m.a(z.RK,z.PS,z.TS,d(1571).versionedDeserialize(z.OS),z.PE,z.TE,d(1571).versionedDeserialize(z.OE),z.DK,z.SI),w=z=>{const B=new f;B.RK=z.u1d;B.PS=z.LNa;B.TS=z.g3a;B.DK=z.IG;B.SI=z.shapeId;z.yQ&&(B.OS=u(z.yQ));z.VCa&&(B.PE=z.VCa);z.Afc&&(B.TE=z.Afc);z.N2&&
(B.OE=u(z.N2));return B},v=z=>{if(!z)return null;const B=new l.a(z.CP);B.ksa=null!=z.FB?z.FB:0;B.$da=null!=z.FE?z.FE:0;B.ura=null!=z.CB?z.CB:0;B.vra=null!=z.CE?z.CE:0;B.DLa=null!=z.HB?z.HB:0;B.Eea=null!=z.HE?z.HE:0;B.Zua=null!=z.R?z.R:0;B.gsa=null!=z.E?z.E:0;B.Bva=null!=z.TW?z.TW:0;B.uua=null!=z.PB?z.PB:0;B.symbols=null!=z.SYM?z.SYM:0;B.$sa=null!=z.IE?z.IE:0;B.gua=null!=z.OO?z.OO:0;B.Oqa=null!=z.AX?z.AX:0;B.hza=null!=z.CCI?z.CCI:0;B.dryDeletion=null!=z.DD?z.DD:0;return B},u=z=>{if(!z)return null;
const B=new a;B.CP=z.cp;B.VS=1;0<z.ksa&&(B.FB=z.ksa);0<z.$da&&(B.FE=z.$da);0<z.ura&&(B.CB=z.ura);0<z.vra&&(B.CE=z.vra);0<z.DLa&&(B.HB=z.DLa);0<z.Eea&&(B.HE=z.Eea);0<z.Zua&&(B.R=z.Zua);0<z.gsa&&(B.E=z.gsa);0<z.Bva&&(B.TW=z.Bva);0<z.uua&&(B.PB=z.uua);0<z.symbols&&(B.SYM=z.symbols);0<z.$sa&&(B.IE=z.$sa);0<z.gua&&(B.OO=z.gua);0<z.Oqa&&(B.AX=z.Oqa);0<z.hza&&(B.CCI=z.hza);0<z.dryDeletion&&(B.DD=z.dryDeletion);return B}},1553:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f,a=
"",l="",r=""){this.IsCurrentUser=!1;this.UserId=f;this.Provider=a;this.DisplayName=l;this.Email=r}}Object(D.a)(m,"CommentTaskPerson",null,[900])},1554:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f,a,l,r,w=!1){this.priority=this.completion=-1;this.type=f;this.user=a;this.time=l;this.recordId=r;this.isLossy=w}}Object(D.a)(m,"HistoryRecord",null,[])},1555:function(D,M,d){d.d(M,"a",function(){return l});D=d(0);var m=d(536),f=d(425),a=d(618);class l{constructor(){this.Dsg=
null;this.VW=!1;this.CFb=this.vab=null;this.Yw=new m.a(new f.a);this.WT=new m.a(new f.a);this.oOf=this.xBb=!1}get en(){return a.a.en}set en(r){a.a.en=r}get b$a(){return this.Dsg}set b$a(r){this.Dsg=r}}l.Oi=1;Object(D.a)(l,"CommentsState",null,[])},1556:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{}m.yellow="FFFF00";m.oji="00FF00";m.Zbh="00FFFF";m.$Ih="FF00FF";m.blue="0000FF";m.red="FF0000";m.sri="000080";m.teal="008080";m.green="008000";m.purple="800080";m.eoi="800000";m.Oti="808000";
m.gray="808080";m.F4i="C0C0C0";m.black="000000";Object(D.a)(m,"FontHighlightColorEnum",null,[])},1557:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(){this.e8={};this.e8.ops=[]}Kea(f){const a=this.e8.ops;if(a.length){var l=a.length-1;const r=a[l];if(!r.attributes){r.insert+=f;a[l]=r;this.e8.ops=a;return}}l={};l.insert=f;Array.add(a,l)}y7h(f,a){const l={};this.bZi(l,a);Array.add(this.e8.ops,this.GZb(f,l))}smf(f,a,l,r=!1){var w={};w.fullName=a.fullName;w.email=a.email;w.resolveState=
a.resolveState;a={};a.atmention=w;f=this.GZb(f,a);l&&(w={},w.contentId=l.contentId,a={},a.atmention=w,r&&(w.isCurrentUser=l.isCurrentUser),f.optional=a);Array.add(this.e8.ops,f)}insertImage(f,a){f=this.GZb(f,{});const l={};l.base64=a.base64;a={};a.image=l;f.optional=a;Array.add(this.e8.ops,f)}m7h(f,a){const l={};l.link=a.link;this.bZi(l,a);Array.add(this.e8.ops,this.GZb(f,l))}cHc(){return Sys.Serialization.JavaScriptSerializer.serialize(this.e8)}GZb(f,a){const l={};l.insert=f;l.attributes=a;return l}bZi(f,
a){this.RIb(a.weight>=m.Iyf,f,"weight",a.weight);this.RIb(a.italic,f,"italic",!0);this.RIb(a.underline,f,"underline",!0);this.RIb(a.strikethrough,f,"strikethrough",!0);this.RIb(!!a.highlight,f,"highlight",a.highlight);this.RIb(!!a.color,f,"color",a.color);this.RIb(!!a.paragraph,f,"paragraph",a.paragraph)}RIb(f,a,l,r){f&&(a[l]=r)}static V1b(f){return Sys.Serialization.JavaScriptSerializer.deserialize(f,!0)}}m.Iyf=700;Object(D.a)(m,"DeltaFormatCreator",null,[857])},1558:function(D,M,d){d.d(M,"a",function(){return a});
D=d(0);var m=d(514),f=d(425);class a{constructor(l=!1){this.VL=null;this.GYa=!1;l&&(this.VL=new m.a(new f.a))}}Object(D.a)(a,"OpenCommentInfo",null,[])},1559:function(D,M,d){d.d(M,"b",function(){return z});d.d(M,"a",function(){return B});d.d(M,"c",function(){return G});d.d(M,"d",function(){return F});d.d(M,"e",function(){return K});var m=d(15),f=d(2),a=d(110),l=d(8),r=d(311),w=d(434),v=d(20),u=d(256);const z=()=>m.a.zk||m.a.Vs,B=()=>void 0!==window.self.FormData&&null!==window.self.FormData?!0:!1,
G=N=>!!N&&N.isConnected,F=(N,H,J,L)=>{if(!H||!H.isConnected)return N.dispose(),!1;const I=H.Bi();let R=u.a.Bq;v.a.instance.J(4)&&(R=H.ia(a.a.gK,u.a.Bq));const C={};C[r.a.nodeId]=H.id.toString();C[r.a.cellId]=I.Zl.toString();C[r.a.fileId]=I.Bs;C[r.a.gra]=I.contentReplicator.$t.toString();C[r.a.kQ]=I.contentReplicator.kQ;C[r.a.K1]=J.toString();C[r.a.lcid]=f.AFrameworkApplication.lcid.toString();C[r.a.accessToken]=f.AFrameworkApplication.accessToken;C[r.a.classId]=H.Qc.toString();C[r.a.gK]=R;L=L||{};
for(const P of w.a(L))C[P]=L[P];for(const P of w.a(C))N.CZb(P,C[P]);return!0},K=(N,H,J)=>{const L={};L.IsResponseNull=!H;H&&(L.OperationResult=H.StatusCode,L.RevisionListLength=H.RevisionList?H.RevisionList.length.toString():"null");l.ULS.sendTraceTag(36783366,322,50,"UploadResponseReceived: {0}",L);J&&J.isConnected&&(H&&!H.StatusCode?(J.MG().contentReplicator.bE(null,null,null),N.Yko()):N.Z0a(null,H?H.StatusCode:14))}},1560:function(D,M,d){var m=this&&this.xO||(Object.create?function(a,l,r,w){void 0===
w&&(w=r);Object.defineProperty(a,w,{enumerable:!0,get:function(){return l[r]}})}:function(a,l,r,w){void 0===w&&(w=r);a[w]=l[r]}),f=this&&this.__exportStar||function(a,l){for(var r in a)"default"===r||Object.prototype.hasOwnProperty.call(l,r)||m(l,a,r)};Object.defineProperty(M,"__esModule",{value:!0});f(d(1751),M);f(d(1752),M);D.exports.DocumentPullQuoteAnnotation||Object.defineProperty(D.exports,"DocumentPullQuoteAnnotation",{enumerable:!0,get:function(){return D.exports.DocumentPullQuoteAnnotation}});
D.exports.PullQuoteAnnotation||Object.defineProperty(D.exports,"PullQuoteAnnotation",{enumerable:!0,get:function(){return D.exports.PullQuoteAnnotation}});D.exports.PullQuotesSignal||Object.defineProperty(D.exports,"PullQuotesSignal",{enumerable:!0,get:function(){return D.exports.PullQuotesSignal}})},1561:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(D.a)(m,"InsightsParameters",null,[])},1564:function(D,
M,d){d.d(M,"a",function(){return R});D=d(0);var m=d(22),f=d(813),a=d(48),l=d(6),r=d(38),w=d(180),v=d(5),u=d(44),z=d(17),B=d(8),G=d(244),F=d(120),K=d(72),N=d(43),H=d(82),J=d(441),L=d(157),I=d(837);class R{constructor(C,P,W,X,V,Y){this.Nt=C;this.LEg=P;this.fOb=W;this.txa=X;this.wpe=V;this.vpe=Y;this.X8=new G.a(()=>this.sHd())}get Gk(){return null!=this.Epg?this.Epg:this.Epg=m.a.instance.resolve("WordEditor.ITableEditor")}get Rd(){return null!=this.Gqg?this.Gqg:this.Gqg=m.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Hk(){return null!=
this.lqg?this.lqg:this.lqg=m.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get $rd(){return this.Nt.value}Mlh(C){const P=this.$rd.yAb(C,I.a.e4c);P&&(this.Vaa(C),this.ePa(P,C),this.Ena(1696,C))}ePa(C,P,W=!0){const X=this.$rd.mLa(P);if(X&&(C=this.LEg(C),X.uh(C))){const V=this.$rd.fT(P);let Y="Unknown";this.X8.value&&(Y=this.X8.value.xb(C)?C:"CustomStyle");B.ULS.sendTraceTag(39661653,311,50,"{0}",{["ApplyTableStyleId"]:Y,["RowCount"]:this.wpe(P),["ColumnCount"]:this.vpe(P),
["HR"]:!!(V&32),["FC"]:!!(V&128),["TR"]:!!(V&64),["LC"]:!!(V&256),["BR"]:!(V&512),["BC"]:!(V&1024),["TableId"]:P.id.toString()});W&&this.Vaa(P);this.E7f(P,X);W=X.uh(C);P.properties.setValue(v.a.tableStyle,W.id);this.HVe(P);P.wS.h2(!0)}}PZc(C,P,W){if(C=this.$rd.yAb(W,C))this.Ena(P,W),this.ePa(C,W)}Ena(C,P,W=!0){W&&this.Vaa(P);P.properties.setValue(v.a.tableLook,C);B.ULS.sendTraceTag(39661654,311,50,"{0}",{["HR"]:!!(C&32),["FC"]:!!(C&128),["TR"]:!!(C&64),["LC"]:!!(C&256),["BR"]:!(C&512),["BC"]:!(C&
1024),["TableId"]:P.id.toString()});P.wS.h2(!0)}E7f(C,P){(C=this.txa(C))&&P.QZc(C,!1)}HVe(C){if(C.isConnected){C.hasProperty(u.a.fv)&&C.removeProperty(u.a.fv);this.ZQf(C);this.YWc(C);C=this.fOb(C);for(var P=C.Rb(1);P;){for(P=C.Rb(1);P;)P.hasProperty(z.a.NH)&&P.removeProperty(z.a.NH),P.hasProperty(v.a.Mga)&&P.removeProperty(v.a.Mga),this.rOa(P),this.YWc(P),P=C.Vi(1);P=C.Vi(1)}}}ZQf(C){C.Qg(v.a.Ta,v.a.Va,v.a.kba,v.a.nb,v.a.pb,v.a.iba,v.a.Sa,v.a.Ua,v.a.hba,v.a.ob,v.a.qb,v.a.jba,v.a.rb,v.a.tb,v.a.Jga,
v.a.Jb,v.a.Kb,v.a.Kga)}rOa(C){C.Qg.apply(C,this.Gk.tUe)}YWc(C){C.Qg(v.a.Ca,v.a.za,v.a.Aa,v.a.Ba,v.a.pM,v.a.rO,v.a.nEa,v.a.lEa)}j3b(C){let P=C.ia(u.a.Pma,null);if(P)return P;if(C=this.LEg(C))if(P=({value:P}=this.X8.value.Dc(C,P)).returnValue?P:null)return P;return C}VIc(C){return C.ia(v.a.Ea,16)}OYh(C){for(let P of this.X8.value.keys)if(this.X8.value.J(P)===C)return P;return null}kWi(C,P,W,X,V){C.properties.setValue(P.style,W);C.properties.setValue(P.size,X*L.a.HXb);C.properties.setValue(P.color,V)}sHd(){const C=
new H.a;C.Z(f.a.W0c,WordEditorIntl.WordEditorStrings.L_TableGrid);C.Z(f.a.yZd,WordEditorIntl.WordEditorStrings.L_PlainTable1);C.Z(f.a.zZd,WordEditorIntl.WordEditorStrings.L_PlainTable2);C.Z(f.a.AZd,WordEditorIntl.WordEditorStrings.L_PlainTable3);C.Z(f.a.BZd,WordEditorIntl.WordEditorStrings.L_PlainTable4);C.Z(f.a.CZd,WordEditorIntl.WordEditorStrings.L_PlainTable5);C.Z(f.a.cJd,WordEditorIntl.WordEditorStrings.L_TableGridLight);C.Z(f.a.mId,WordEditorIntl.WordEditorStrings.L_GridTable1Light);C.Z(f.a.gId,
this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel5));C.Z(f.a.hId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel6));C.Z(f.a.iId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel7));C.Z(f.a.jId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel8));C.Z(f.a.kId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel9));
C.Z(f.a.lId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable1Light,Box4Intl.Box4Strings.l_ThemeLabel10));C.Z(f.a.tId,WordEditorIntl.WordEditorStrings.L_GridTable2);C.Z(f.a.nId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel5));C.Z(f.a.oId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel6));C.Z(f.a.pId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel7));C.Z(f.a.qId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable2,
Box4Intl.Box4Strings.l_ThemeLabel8));C.Z(f.a.rId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel9));C.Z(f.a.sId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable2,Box4Intl.Box4Strings.l_ThemeLabel10));C.Z(f.a.AId,WordEditorIntl.WordEditorStrings.L_GridTable3);C.Z(f.a.uId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel5));C.Z(f.a.vId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel6));
C.Z(f.a.wId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel7));C.Z(f.a.xId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel8));C.Z(f.a.yId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel9));C.Z(f.a.zId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable3,Box4Intl.Box4Strings.l_ThemeLabel10));C.Z(f.a.HId,WordEditorIntl.WordEditorStrings.L_GridTable4);C.Z(f.a.BId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable4,
Box4Intl.Box4Strings.l_ThemeLabel5));C.Z(f.a.CId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel6));C.Z(f.a.DId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel7));C.Z(f.a.EId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel8));C.Z(f.a.FId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable4,Box4Intl.Box4Strings.l_ThemeLabel9));C.Z(f.a.GId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable4,
Box4Intl.Box4Strings.l_ThemeLabel10));C.Z(f.a.OId,WordEditorIntl.WordEditorStrings.L_GridTable5Dark);C.Z(f.a.IId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel5));C.Z(f.a.JId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel6));C.Z(f.a.KId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel7));C.Z(f.a.LId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel8));
C.Z(f.a.MId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel9));C.Z(f.a.NId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel10));C.Z(f.a.VId,WordEditorIntl.WordEditorStrings.L_GridTable6Colorful);C.Z(f.a.PId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));C.Z(f.a.QId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel6));
C.Z(f.a.RId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));C.Z(f.a.SId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel8));C.Z(f.a.TId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel9));C.Z(f.a.UId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));C.Z(f.a.bJd,WordEditorIntl.WordEditorStrings.L_GridTable7Colorful);
C.Z(f.a.WId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));C.Z(f.a.XId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel6));C.Z(f.a.YId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));C.Z(f.a.ZId,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel8));C.Z(f.a.$Id,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,
Box4Intl.Box4Strings.l_ThemeLabel9));C.Z(f.a.aJd,this.Kd(WordEditorIntl.WordEditorStrings.L_GridTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));C.Z(f.a.$Qd,WordEditorIntl.WordEditorStrings.L_ListTable1Light);C.Z(f.a.UQd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel5));C.Z(f.a.VQd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel6));C.Z(f.a.WQd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel7));
C.Z(f.a.XQd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel8));C.Z(f.a.YQd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel9));C.Z(f.a.ZQd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable1Light,Box4Intl.Box4Strings.l_ThemeLabel10));C.Z(f.a.gRd,WordEditorIntl.WordEditorStrings.L_ListTable2);C.Z(f.a.aRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel5));C.Z(f.a.bRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable2,
Box4Intl.Box4Strings.l_ThemeLabel6));C.Z(f.a.cRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel7));C.Z(f.a.dRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel8));C.Z(f.a.eRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel9));C.Z(f.a.fRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable2,Box4Intl.Box4Strings.l_ThemeLabel10));C.Z(f.a.nRd,WordEditorIntl.WordEditorStrings.L_ListTable3);
C.Z(f.a.hRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel5));C.Z(f.a.iRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel6));C.Z(f.a.jRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel7));C.Z(f.a.kRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel8));C.Z(f.a.lRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel9));
C.Z(f.a.mRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable3,Box4Intl.Box4Strings.l_ThemeLabel10));C.Z(f.a.uRd,WordEditorIntl.WordEditorStrings.L_ListTable4);C.Z(f.a.oRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel5));C.Z(f.a.pRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel6));C.Z(f.a.qRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel7));C.Z(f.a.rRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable4,
Box4Intl.Box4Strings.l_ThemeLabel8));C.Z(f.a.sRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel9));C.Z(f.a.tRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable4,Box4Intl.Box4Strings.l_ThemeLabel10));C.Z(f.a.BRd,WordEditorIntl.WordEditorStrings.L_ListTable5Dark);C.Z(f.a.vRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel5));C.Z(f.a.wRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel6));
C.Z(f.a.xRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel7));C.Z(f.a.yRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel8));C.Z(f.a.zRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel9));C.Z(f.a.ARd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable5Dark,Box4Intl.Box4Strings.l_ThemeLabel10));C.Z(f.a.HRd,WordEditorIntl.WordEditorStrings.L_ListTable6Colorful);C.Z(f.a.l8b,
this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));C.Z(f.a.CRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel6));C.Z(f.a.DRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel7));C.Z(f.a.ERd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel8));C.Z(f.a.FRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,
Box4Intl.Box4Strings.l_ThemeLabel9));C.Z(f.a.GRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable6Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));C.Z(f.a.ORd,WordEditorIntl.WordEditorStrings.L_ListTable7Colorful);C.Z(f.a.IRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel5));C.Z(f.a.JRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel6));C.Z(f.a.KRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,
Box4Intl.Box4Strings.l_ThemeLabel7));C.Z(f.a.LRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel8));C.Z(f.a.MRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel9));C.Z(f.a.NRd,this.Kd(WordEditorIntl.WordEditorStrings.L_ListTable7Colorful,Box4Intl.Box4Strings.l_ThemeLabel10));return C}Kd(C,P){return String.format(WordEditorIntl.WordEditorStrings.L_TableStyleNameWithThemeFormat,C,P)}Vaa(C){if(this.Rd.wg){let P=
null;if(Object(F.a)(J.a,C)){const W=Object(K.a)(J.a,C);W&&(P=W.IQ())}P&&this.Hk.Vaa(C,P)}}static Sgf(){return new R(new G.a(()=>a.StyleReader.b3a),a.StyleReader.tf,l.GraphIterator.$a,Object(N.a)(R.oh,R.oh.gu,"navigateToPageContentNode"),r.TableReader.ag,r.TableReader.kh)}static get oh(){return w.PageNavigator.instance}static get instance(){return null!=R.ulg?R.ulg:R.ulg=R.Sgf()}}Object(D.a)(R,"TableStyleEditor",null,[452,453,454])},1565:function(D,M,d){d.d(M,"c",function(){return r});d.d(M,"b",function(){return w});
d.d(M,"a",function(){return v});var m=d(37),f=d(683),a=d(70),l=d(293);const r=(u,z,B)=>{var G=u.characterData.length;if(z>B||B>G)return null;a:{for(F of u.pD)if(G=F.ic,G.Be){var F=G;break a}F=null}if(!F)return null;F=u.Ui(F.Tb);if(!F)return null;G=[];u=u.qa;for(let N=u.Fsa(z);N<u.length;N++){var K=u.J(N);if(K.cp>B||K.cp===B&&z!==B)break;(K=l.a.lLa(F,K.cp))&&0>Array.indexOf(G,K)&&G.push(K)}return G},w=u=>{let z=null;for(let G of u){var B=m.a.getElementBounds(G);z?(u=z,u.x>B.x&&(u.x=B.x),u.x+u.width<
B.x+B.width&&(u.width=B.x+B.width-u.x),u.y>B.y&&(u.y=B.y),u.y+u.height<B.y+B.height&&(u.height=B.y+B.height-u.y)):z=B}z||(z=new Sys.UI.Bounds(0,0,0,0));return z},v=(u,z)=>{u=w(u);if(!u.width&&!u.height)return null;const B=document.createElement("div");B.id=z;B.style.position="absolute";B.style.left=u.x+"px";B.style.top=u.y+"px";B.style.width=u.width+"px";B.style.height=u.height+"px";B.style.zIndex="-9999";a.d(B,f.a.kvb,"true");return B}},1566:function(D,M,d){var m=this&&this.xO||(Object.create?function(a,
l,r,w){void 0===w&&(w=r);Object.defineProperty(a,w,{enumerable:!0,get:function(){return l[r]}})}:function(a,l,r,w){void 0===w&&(w=r);a[w]=l[r]}),f=this&&this.__exportStar||function(a,l){for(var r in a)"default"===r||Object.prototype.hasOwnProperty.call(l,r)||m(l,a,r)};Object.defineProperty(M,"__esModule",{value:!0});f(d(1768),M);f(d(1769),M);f(d(1770),M);f(d(1771),M);f(d(1772),M);D.exports.SuggestionCategory||Object.defineProperty(D.exports,"SuggestionCategory",{enumerable:!0,get:function(){return D.exports.SuggestionCategory}})},
1567:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f){this.source=f}}Object(D.a)(m,"AcceptAllActionData",null,[])},1569:function(D,M,d){d.d(M,"c",function(){return f});d.d(M,"a",function(){return a});d.d(M,"b",function(){return l});var m=d(27);const f=(r,w,v)=>{if(!m.c(r)&&"#text"!==r.nodeName&&(w?r.setAttribute("unselectable","on"):r.setAttribute("unselectable","off"),v))for(r=r.firstChild;r;)f(r,w,!0),r=r.nextSibling},a=r=>{r=document.createElement(r);r.setAttribute("unselectable",
"on");return r},l=(r,w)=>{if(!m.c(r)){var v=r.className;if(m.c(v)||-1===v.indexOf(w))w=v.trim()+" "+w,w=w.trim(),r.className=w}}},1571:function(D,M,d){d.r(M);d.d(M,"validateCpDataV1",function(){return f});d.d(M,"isEqual",function(){return a});d.d(M,"isSupportedCpVersion",function(){return l});d.d(M,"validateVersionedCpData",function(){return w});d.d(M,"versionedDeserialize",function(){return v});var m=d(1546);const f=u=>"number"!==typeof u.CP||null!=u.FB&&"number"!==typeof u.FB||null!=u.FE&&"number"!==
typeof u.FE||null!=u.HB&&"number"!==typeof u.HB||null!=u.HE&&"number"!==typeof u.HE||null!=u.CB&&"number"!==typeof u.CB||null!=u.CE&&"number"!==typeof u.CE||null!=u.R&&"number"!==typeof u.R||null!=u.E&&"number"!==typeof u.E||null!=u.TW&&"number"!==typeof u.TW||null!=u.PB&&"number"!==typeof u.PB||null!=u.SYM&&"number"!==typeof u.SYM||null!=u.IE&&"number"!==typeof u.IE||null!=u.OO&&"number"!==typeof u.OO||null!=u.AX&&"number"!==typeof u.AX||null!=u.CCI&&"number"!==typeof u.CCI||null!=u.DD&&"number"!==
typeof u.DD?!1:!0,a=(u,z)=>u||z?u&&z&&u.CP===z.CP&&u.FB===z.FB&&u.FE===z.FE&&u.HB===z.HB&&u.HE===z.HE&&u.CB===z.CB&&u.CE===z.CE&&u.R===z.R&&u.E===z.E&&u.TW===z.TW&&u.PB===z.PB&&u.SYM===z.SYM&&u.IE===z.IE&&u.OO===z.OO&&u.AX===z.AX&&u.CCI===z.CCI&&u.DD===z.DD?!0:!1:!0,l=u=>1===u,r=u=>{let z=u,B=0;"number"===typeof z.VS&&(B=z.VS);if("number"===typeof z.VS||"number"===typeof z.CP)return{returnValue:z,U8f:B};z=null;for(let G=0;G<u.length;G++){const F=u[G];1===F.VS&&F.VS>B&&(B=F.VS,z=u[G])}return{returnValue:z,
U8f:B}},w=u=>{const z=({U8f:u}=r(u)).returnValue;if(!z)return!1;switch(u){case 0:case 1:return f(z);default:return!1}},v=u=>{if(!u)return null;const z=({U8f:u}=r(u)).returnValue;if(!z)return null;switch(u){case 0:case 1:return m.b(z);default:return null}}},1583:function(D,M,d){D=d(0);var m=d(584),f=d(16),a=d(170),l=d(68),r=d(2),w=d(22),v=d(8),u=d(1415),z=d(20),B=d(14),G=d(108),F=d(33),K=d(3),N=d(1009),H=d(164),J=d(19),L=d(24),I=d(139),R=d(11);class C{static get vdh(){C.Yic||(C.Yic=[],C.E8b(m.a.lg("ar-sa")),
C.E8b(m.a.lg("de-de")),C.E8b(m.a.lg("es-es")),C.OZ(m.a.lg("en-029"),m.a.lg("en-us")),C.OZ(m.a.lg("en-au"),m.a.lg("en-us")),C.OZ(m.a.lg("en-bz"),m.a.lg("en-us")),C.OZ(m.a.lg("en-ca"),m.a.lg("en-us")),C.OZ(m.a.lg("en-gb"),m.a.lg("en-us")),C.OZ(m.a.lg("en-id"),m.a.lg("en-us")),C.OZ(m.a.lg("en-my"),m.a.lg("en-us")),C.OZ(m.a.lg("en-ph"),m.a.lg("en-us")),C.OZ(m.a.lg("zh-tw"),m.a.lg("en-us")),C.E8b(m.a.lg("fr-fr")),C.OZ(m.a.lg("hr-ba"),m.a.lg("hr-hr")),C.OZ(m.a.lg("it-ch"),m.a.lg("it-it")),C.OZ(m.a.lg("nb-no"),
m.a.lg("nn-no")),C.E8b(m.a.lg("nl-nl")),C.OZ(m.a.lg("ro-md"),m.a.lg("ro-ro")),C.OZ(m.a.lg("ru-md"),m.a.lg("ru-ru")),C.OZ(m.a.lg("sr-latn-ba"),m.a.lg("sr-latn-cs")),C.OZ(m.a.lg("sr-latn-me"),m.a.lg("sr-latn-cs")),C.OZ(m.a.lg("sr-latn-rs"),m.a.lg("sr-latn-cs")),C.E8b(m.a.lg("sr-cyrl-cs")),C.OZ(m.a.lg("sv-fi"),m.a.lg("sv-se")));return C.Yic}static E8b(pa){C.Yic[pa.languageId]=pa.LCID}static OZ(pa,Ya){C.Yic[pa.LCID]=Ya.LCID}static SOh(pa){var Ya=m.a.lg(pa);if(!Ya)return 0;Ya=C.vdh[Ya.LCID]||C.vdh[Ya.languageId]||
0;return Ya===pa?0:Ya}}C.Yic=null;Object(D.a)(C,"AutoCorrectListFallback",null,[]);var P=d(372),W=d(84),X=d(106),V=d(110),Y=d(5),ca=d(17),fa=d(6),sa=d(100),ia=d(312),ea=d(41),da=d(69),ja=d(105),Ga=d(49),ya=d(1490);class ta extends ya.a{constructor(pa,Ya,Ja,nb,Bb,mb){super(pa,Ya,Ja,nb,mb);this.fX=Bb}get GB(){return!0}get commandId(){return K.a.Qek}set GB(pa){super.GB=pa}}Object(D.a)(ta,"ARegexCorrectAction",ya.a,[]);class ua extends ta{get Mgb(){return null!=this.Ylg?this.Ylg:this.Ylg=w.a.instance.Pa("Box4.List.IListCommands")}get Jo(){return null!=
this.cmg?this.cmg:this.cmg=w.a.instance.resolve("Box4.List.IListEditor")}get hd(){return null!=this.wmg?this.wmg:this.wmg=w.a.instance.resolve("Box4.List.IListReader")}get levelText(){const [pa,Ya]=this.fX;return Ya?pa.replace(Ya,"%1"):pa}}Object(D.a)(ua,"AListAutoCorrectAction",ta,[]);var Sa=d(231);class ka extends ua{static get vPf(){var pa;return null!==(pa=this.XCe)&&void 0!==pa?pa:this.XCe=["[\\*](?![\\*])","[\\-](?![\\-])"]}get commandId(){return K.a.Jek}lka(pa){if(this.Mgb){var Ya=fa.GraphIterator.$a(pa);
Ya.vd();ea.OutlineElementNavigator.ae(Ya);if(this.Jo.D6d(Ya,this.fX[0])){var Ja=this.hd.Es(Ya),nb=this.fX[0],Bb=f.a.charAt(nb,0),mb=this.Lwl(Bb),Qb=ia.a.wP(1,mb.listStyle);Ja&&Qb.pjf(Ja)||(Ja=new Ga.GraphTransaction(15),Ja.Ju(Ya),this.Vd.replaceTextRange(F.a.createTextRange(pa,this.CF,this.PZ+1),"",!0,!1),this.Jo.iYi(Qb),pa=new P.DictionaryPropertySet,pa.setValue(X.a.i9e,!0),Bb&&(Qb.jP=Bb,pa.setValue(V.a.jP,Qb.jP)),pa.setValue(Y.a.Qr,mb.levelText),pa.setValue(ca.a.font,mb.fontName),"-"===Bb&&W.Health.instance.recordKpiUsage("DashBulletAutoCreate",
0,ka.vB,null),Sa.a.SW&&(pa.setValue(V.a.hma,"autocorrect"),pa.setValue(V.a.efa,nb)),this.Mgb.lmk(Qb.listType,Qb.listStyle,pa),Ja.dispose())}}}Lwl(pa){const Ya={listStyle:0,levelText:sa.a.Cxd,fontName:sa.a.NCc};switch(pa){case "*":return Object.assign(Object.assign({},Ya),{listStyle:1});case "-":return Object.assign(Object.assign({},Ya),{levelText:"-",fontName:ja.a.GG});default:return Ya}}static bF(pa,Ya,Ja,nb,Bb){return new ka(null,pa,Ya,Ja,nb,Bb)}static yS(pa,Ya,Ja,nb,Bb){return new ka(pa,da.a(pa).zb,
Ya,Ja,nb,Bb)}}ka.vB="wwaengidc";Object(D.a)(ka,"BulletListAction",ua,[]);var ha=d(82);class Ca extends ta{constructor(pa,Ya,Ja,nb,Bb,mb){super(pa,Ya,Ja,nb,Bb,mb);this.cpc=!1;this.GB=!pa;Ca.Oo=new ha.a}get GB(){return this.cpc}set GB(pa){this.cpc=pa}Rxb(pa){this.bVe(pa.innerText,(Ya,Ja,nb)=>{pa.innerText=f.a.substring(pa.innerText,0,Ya)+nb+f.a.right(pa.innerText,Ja)})}lka(pa){this.bVe(R.ParagraphReader.text(pa).substring(this.CF,this.PZ),(Ya,Ja,nb)=>{this.Vd.replaceTextRange(F.a.createTextRange(pa,
this.CF+Ya,this.CF+Ja),nb,!0,!1)})}bVe(pa,Ya){if(!(2>this.fX.length)&&this.fX[1]){var Ja=this.fX[1];Ca.Oo.count||this.JDi();Ca.Oo.xb(Ja)&&(pa=pa.lastIndexOf(Ja),-1!==pa&&Ya(pa,pa+Ja.length,Ca.Oo.J(Ja)))}}}Object(D.a)(Ca,"ADictionarySequenceReplacerAction",ta,[]);class Pa extends Ca{get commandId(){return K.a.aRe}JDi(){Ca.Oo.Z("--","\u2014");Ca.Oo.Z(" -- "," \u2013 ");Ca.Oo.Z(" - "," \u2013 ");Ca.Oo.Z("-- ","\u2014");Ca.Oo.Z(" --"," \u2013");Ca.Oo.Z(" -"," \u2013")}static bF(pa,Ya,Ja,nb,Bb){return new Pa(null,
pa,Ya,Ja,nb,Bb)}static yS(pa,Ya,Ja,nb,Bb){return new Pa(pa,da.a(pa).zb,Ya,Ja,nb,Bb)}}Object(D.a)(Pa,"DashAction",Ca,[]);class Xa extends Ca{constructor(pa,Ya,Ja,nb,Bb,mb,Qb){super(pa,Ya,Ja,nb,Bb,mb);this.ga=Qb}get commandId(){return K.a.Kek}JDi(){Ca.Oo.Z(":)","\ud83d\ude0a");Ca.Oo.Z(":-)","\ud83d\ude0a");Ca.Oo.Z(":|","\ud83d\ude10");Ca.Oo.Z(":-|","\ud83d\ude10");Ca.Oo.Z(":(","\ud83d\ude41");Ca.Oo.Z(":-(","\ud83d\ude41");Ca.Oo.Z(";)","\ud83d\ude09");Ca.Oo.Z(";-)","\ud83d\ude09");Ca.Oo.Z(":D","\ud83d\ude00");
Ca.Oo.Z(":-D","\ud83d\ude00");Ca.Oo.Z(":')","\ud83d\ude02");Ca.Oo.Z("=D","\ud83d\ude03");Ca.Oo.Z(":>","\ud83d\ude06");Ca.Oo.Z(":->","\ud83d\ude06");Ca.Oo.Z(":3","\ud83d\ude0a");Ca.Oo.Z(":-3","\ud83d\ude0a");Ca.Oo.Z("B-)","\ud83d\ude0e");Ca.Oo.Z("*-*","\ud83d\ude0d");Ca.Oo.Z(":*","\ud83d\ude19");Ca.Oo.Z(":-*","\ud83d\ude19");Ca.Oo.Z(":X","\ud83d\ude36");Ca.Oo.Z(":-X","\ud83d\ude36");Ca.Oo.Z(":O","\ud83d\ude2e");Ca.Oo.Z(":-O","\ud83d\ude2e");Ca.Oo.Z(":#","\ud83e\udd10");Ca.Oo.Z(":-#","\ud83e\udd10");
Ca.Oo.Z(":P","\ud83d\ude1b");Ca.Oo.Z(":-P","\ud83d\ude1b");Ca.Oo.Z(";P","\ud83d\ude1c");Ca.Oo.Z(";-P","\ud83d\ude1c");Ca.Oo.Z(":-/","\ud83d\ude15");Ca.Oo.Z("$-$","\ud83e\udd11");Ca.Oo.Z(":S","\ud83d\ude16");Ca.Oo.Z(":-S","\ud83d\ude16");Ca.Oo.Z(":[","\ud83d\ude1f");Ca.Oo.Z(":-[","\ud83d\ude1f");Ca.Oo.Z(":\u2019(","\ud83d\ude22");Ca.Oo.Z(":'(","\ud83d\ude22");Ca.Oo.Z("@-@","\ud83d\ude31")}lka(pa){this.bVe(R.ParagraphReader.text(pa).substring(this.CF,this.PZ),(Ya,Ja,nb)=>{Ya=F.a.createTextRange(pa,
this.CF+Ya,this.CF+Ja);Ja={};Ja.MenuItemId=nb;this.ga.Qf(Ya,K.a.Reb,2,!1,null,Ja,null)})}static bF(pa,Ya,Ja,nb,Bb,mb){return new Xa(null,pa,Ya,Ja,nb,Bb,mb)}static yS(pa,Ya,Ja,nb,Bb,mb){return new Xa(pa,da.a(pa).zb,Ya,Ja,nb,Bb,mb)}}Object(D.a)(Xa,"EmojiAction",Ca,[]);class qa{constructor(pa,Ya,Ja,nb){this.oR=pa;this.wnd=Ya;this.Ipc=nb;this.yE=Ja}Tdi(){if(!this.yE)return!1;this.oR=this.oR.trimStart();return this.oR===this.yE?!0:!1}Nlm(){if(!this.oR)return!1;const pa=this.oR.lastIndexOf(" ");return-1!==
pa&&"."===this.oR.charAt(pa-1)&&"."===this.oR.charAt(pa-3)?!0:!1}Mlm(){if(!this.oR)return!1;var pa=this.oR.lastIndexOf(" ");return-1!==pa&&(pa=this.oR.substring(0,pa-1).lastIndexOf(" "),"."===this.oR.charAt(pa+2))?!0:!1}ffm(){return this.Tdi()&&(1===this.yE.length&&"."===this.wnd||"."===this.oR.charAt(1))?!0:!1}gfm(){return this.yE?0<="\\/".indexOf(this.wnd)||3===this.yE.length&&0<="\\/".indexOf(this.yE.charAt(1))?!0:!1:!1}fem(){return this.yE?0<=this.yE.indexOf("@")?!0:!1:!1}xA(){if(!this.yE)return!1;
for(const pa of qa.Whf())if(f.a.startsWith(this.yE+this.wnd,pa))return!0;return!1}Mdm(){return this.yE?"i"===this.yE&&0<=qa.quotes.indexOf(this.wnd)?!0:!1:!1}f9l(){if(!this.oR)return!1;const pa=f.a.o_a(this.oR,this.oR.length-1);if(-1!==pa&&this.oR.substring(pa+1,this.oR.length)===this.yE){const Ya=this.oR.charAt(pa-1);if(0<=qa.CVf.indexOf(Ya)||0<=qa.quotes.indexOf(Ya)&&0<=qa.CVf.indexOf(this.oR.charAt(pa-2)))return!0}return!1}Trk(){return!this.oR||this.Nlm()||this.ffm()||this.gfm()||this.Mlm()||this.fem()||
this.xA()?!1:this.Tdi()||this.Mdm()||this.f9l()?!0:!1}static Whf(){return qa.uNg||(qa.uNg="http: https: ftp:// mailto: \\\\ www.".split(" "))}}qa.CVf=".!?";qa.quotes="'\"";qa.uNg=null;Object(D.a)(qa,"FirstLetterUpperCaseRules",null,[]);class Ea{constructor(pa){this.yE=pa}Zbl(){if(!this.yE)return null;for(let pa=0;pa<Ea.S_h().length;pa++)if(this.yE===Ea.S_h()[pa])return Ea.eOl()[pa];return null}static S_h(){return Ea.WDg||(Ea.WDg=["1/2","1/4","3/4"])}static eOl(){return Ea.VDg||(Ea.VDg=["\u00bd","\u00bc",
"\u00be"])}}Ea.WDg=null;Ea.VDg=null;Object(D.a)(Ea,"FractionsCollection",null,[]);class Ia extends ya.a{constructor(pa,Ya,Ja,nb,Bb,mb){super(pa,Ya,Ja,nb,mb);this.Lqh=Bb}get GB(){return!0}get commandId(){return K.a.Lek}Rxb(pa){pa.innerText=f.a.substring(pa.innerText,0,this.CF)+this.Lqh+f.a.right(pa.innerText,this.PZ)}lka(pa){this.Vd.replaceTextRange(F.a.createTextRange(pa,this.CF,this.PZ),this.Lqh,!0,!1)}set GB(pa){super.GB=pa}static bF(pa,Ya,Ja,nb,Bb){return new Ia(null,pa,Ya,Ja,nb,Bb)}}Object(D.a)(Ia,
"FractionsReplaceCorrectAction",ya.a,[]);class na extends ua{get commandId(){return K.a.Nek}lka(pa){if(this.Mgb){var Ya=fa.GraphIterator.$a(pa);Ya.vd();ea.OutlineElementNavigator.ae(Ya);if(this.Jo.D6d(Ya,this.fX[0])){var [Ja,nb]=this.fX,Bb=na.yLm(nb),mb=f.a.n7b(nb)?4:2,Qb=F.a.createTextRange(pa,this.CF,this.PZ+1);this.Jo.uXb(pa,Ya,mb,Bb,Qb,Ja,this.levelText,this.Mgb)}}}static bF(pa,Ya,Ja,nb,Bb){return new na(null,pa,Ya,Ja,nb,Bb)}static yS(pa,Ya,Ja,nb,Bb){return new na(pa,da.a(pa).zb,Ya,Ja,nb,Bb)}static yLm(pa){if(!pa)return 0;
pa=f.a.mh(pa);if(!f.a.rMd(pa.charAt(0)))return 0;const Ya=pa.charCodeAt(0)-97+1;let Ja;for(Ja=1;Ja<pa.length&&pa.charAt(Ja)===pa.charAt(0);Ja++);return 26*(Ja-1)+Ya}}Object(D.a)(na,"LetterListAction",ua,[]);var Na=d(135);class Oa extends ua{get commandId(){return K.a.uXb}lka(pa){if(this.Mgb){var Ya=fa.GraphIterator.$a(pa);Ya.vd();ea.OutlineElementNavigator.ae(Ya);if(this.Jo.D6d(Ya,this.fX[0])){var [Ja,nb]=this.fX,Bb=parseInt(nb);if(!(99999999<=Bb)){var mb=F.a.createTextRange(pa,this.CF,this.PZ+1);
Na.a.MPd()&&Na.a.XPl();this.Jo.uXb(pa,Ya,1,Bb,mb,Ja,this.levelText,this.Mgb)}}}}static bF(pa,Ya,Ja,nb,Bb){return new Oa(null,pa,Ya,Ja,nb,Bb)}static yS(pa,Ya,Ja,nb,Bb){return new Oa(pa,da.a(pa).zb,Ya,Ja,nb,Bb)}}Object(D.a)(Oa,"NumberListAction",ua,[]);class Ra extends ya.a{get GB(){return!0}get commandId(){return K.a.Oek}Rxb(){}lka(pa){const Ya=F.a.createTextRange(pa,this.PZ-2,this.PZ),Ja=new Ga.GraphTransaction(15);Ja.Db(pa);let nb=!1,Bb=null,mb=0;for(;mb<pa.qa.length;){var Qb=pa.qa.J(mb),Vb=Qb.x6;
const mc=Qb.uT;if(Qb.cp>=Ya.cpBegin){Qb.cp>Ya.cpBegin||!Qb.formatting?Bb=nb?Qb.formatting:this.Vd.GX(pa,mb,Ya.cpBegin,Bb):(Bb=Qb.formatting,mc&&(nb=!1),Vb&&(nb=!0));mb++;break}Qb.formatting&&(Bb=Qb.formatting);mc&&(nb=!1);Vb&&(nb=!0);mb++}for(;mb<pa.qa.length;){Vb=pa.qa.J(mb);if(Vb.cp>=Ya.cpEnd){if(Vb.cp>Ya.cpEnd||!Vb.formatting&&!Vb.Wh)nb||this.Vd.GX(pa,mb,Ya.cpEnd,Bb);nb||Ra.ui.Uaa(Bb,!0);break}Vb.formatting&&(nb||Ra.ui.Uaa(Bb,!0),Bb=Vb.formatting);Qb=Vb.x6;Vb=Vb.uT;Qb&&(nb=!0);!Qb&&Vb&&(nb=!1);
mb++}Ja.dispose()}set GB(pa){super.GB=pa}static get ui(){return null!=Ra.Qig?Ra.Qig:Ra.Qig=w.a.instance.resolve("Box4.IFormattingEditor")}static bF(pa,Ya,Ja,nb){return new Ra(null,pa,Ya,Ja,nb)}}Object(D.a)(Ra,"OrdinalsReplaceCorrectAction",ya.a,[]);var ab;(function(pa){pa[pa.rand=0]="rand";pa[pa.randOld=1]="randOld";pa[pa.lorem=2]="lorem"})(ab||(ab={}));Object(D.b)("RandTextType",ab);class zb extends ta{constructor(pa,Ya,Ja,nb,Bb,mb){super(pa,Ya,Ja,nb,Bb,mb);zb.BCe||zb.k0n()}static Tem(){var pa;return null===
(pa=r.AFrameworkApplication.K)||void 0===pa?void 0:pa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isNoRandDoubleSpaceEnabled",!0)}get commandId(){return K.a.Pek}lka(pa){if(!pa.ow){var Ya=this.G6a.Qa.node===pa,Ja=5,nb=3;if(this.fX[0].startsWith("=rand.old")){var Bb=ab.randOld;Ja=3}else if(this.fX[0].startsWith("=rand"))Bb=ab.rand;else if(this.fX[0].startsWith("=lorem"))Bb=ab.lorem;else return;this.fX[1]&&(Ja=parseInt(this.fX[1]));this.fX[2]&&(nb=parseInt(this.fX[2]));if(!(20<nb||100<Ja)){pa.MG().sF.p9(7);
var mb=fa.GraphIterator.$a(pa);mb.vd();ea.OutlineElementNavigator.ae(mb);zb.eh.XC(mb,!1,!1);zb.eh.uN(mb);var Qb=!1;switch(Bb){case ab.rand:Bb=zb.BCe;break;case ab.randOld:Bb=zb.CVg;break;case ab.lorem:Bb=zb.nOg;Qb=!0;break;default:return}var Vb=0;for(let ob=0;ob<Ja;++ob){const cb=[];for(var mc=0;mc<nb;mc++)cb.push(Bb[Vb++%Bb.length]);mc=F.a.Uc(mb.currentNode,0);if(Qb){const db=G.FormattingReader.Ds(mc);zb.ui.$l(db,Y.a.noProof,!0)}this.Vd.replaceTextRange(mc,cb.join(zb.Tem()?"":" "),!0,!1);ob<Ja-1&&
(ea.OutlineElementNavigator.ae(mb),zb.eh.XC(mb,!1,!1),zb.eh.uN(mb))}Ja=mb.currentNode;mb=fa.GraphIterator.$a(pa);mb.vd();ea.OutlineElementNavigator.ae(mb);mb.Fg();Ya&&(this.G6a=L.SelectionFactory.xe(Ja,R.ParagraphReader.textLength(Ja)))}}}static get eh(){return null!=zb.Zmg?zb.Zmg:zb.Zmg=w.a.instance.resolve("Box4.IOutlineElementEditor")}static get ui(){return null!=zb.Vig?zb.Vig:zb.Vig=w.a.instance.resolve("Box4.IFormattingEditor")}static k0n(){zb.BCe="Video provides a powerful way to help you prove your point. ;When you click Online Video, you can paste in the embed code for the video you want to add. ;You can also type a keyword to search online for the video that best fits your document. ;To make your document look professionally produced, Word provides header, footer, cover page, and text box designs that complement each other. ;For example, you can add a matching cover page, header, and sidebar. ;Click Insert and then choose the elements you want from the different galleries. ;Themes and styles also help keep your document coordinated. ;When you click Design and choose a new Theme, the pictures, charts, and SmartArt graphics change to match your new theme. ;When you apply styles, your headings change to match the new theme. ;Save time in Word with new buttons that show up where you need them. ;To change the way a picture fits in your document, click it and a button for layout options appears next to it. ;When you work on a table, click where you want to add a row or a column, and then click the plus sign. ;Reading is easier, too, in the new Reading view. ;You can collapse parts of the document and focus on the text you want. ;If you need to stop reading before you reach the end, Word remembers where you left off - even on another device. ".split(";");
zb.CVg=["The quick brown fox jumps over the lazy dog. "];zb.nOg="Lorem ipsum dolor sit amet, consectetuer adipiscing elit. ;Maecenas porttitor congue massa. ;Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna. ;Nunc viverra imperdiet enim. ;Fusce est. ;Vivamus a tellus. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Proin pharetra nonummy pede. ;Mauris et orci. ;Aenean nec lorem. ;In porttitor. ;Donec laoreet nonummy augue. ;Suspendisse dui purus, scelerisque at, vulputate vitae, pretium mattis, nunc. ;Mauris eget neque at sem venenatis eleifend. ;Ut nonummy. ;Fusce aliquet pede non pede. ;Suspendisse dapibus lorem pellentesque magna. ;Integer nulla. ;Donec blandit feugiat ligula. ;Donec hendrerit, felis et imperdiet euismod, purus ipsum pretium metus, in lacinia nulla nisl eget sapien. ;Donec ut est in lectus consequat consequat. ;Etiam eget dui. ;Aliquam erat volutpat. ;Sed at lorem in nunc porta tristique. ;Proin nec augue. ;Quisque aliquam tempor magna. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Nunc ac magna. ;Maecenas odio dolor, vulputate vel, auctor ac, accumsan id, felis. ;Pellentesque cursus sagittis felis. ;Pellentesque porttitor, velit lacinia egestas auctor, diam eros tempus arcu, nec vulputate augue magna vel risus. ;Cras non magna vel ante adipiscing rhoncus. ;Vivamus a mi. ;Morbi neque. ;Aliquam erat volutpat. ;Integer ultrices lobortis eros. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Proin semper, ante vitae sollicitudin posuere, metus quam iaculis nibh, vitae scelerisque nunc massa eget pede. ;Sed velit urna, interdum vel, ultricies vel, faucibus at, quam. ;Donec elit est, consectetuer eget, consequat quis, tempus quis, wisi. ;In in nunc. ;Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos hymenaeos. ;Donec ullamcorper fringilla eros. ;Fusce in sapien eu purus dapibus commodo. ;Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. ;Cras faucibus condimentum odio. ;Sed ac ligula. ;Aliquam at eros. ;Etiam at ligula et tellus ullamcorper ultrices. ;In fermentum, lorem non cursus porttitor, diam urna accumsan lacus, sed interdum wisi nibh nec nisl. ;Ut tincidunt volutpat urna. ;Mauris eleifend nulla eget mauris. ;Sed cursus quam id felis. ;Curabitur posuere quam vel nibh. ;Cras dapibus dapibus nisl. ;Vestibulum quis dolor a felis congue vehicula. ;Maecenas pede purus, tristique ac, tempus eget, egestas quis, mauris. ;Curabitur non eros. ;Nullam hendrerit bibendum justo. ;Fusce iaculis, est quis lacinia pretium, pede metus molestie lacus, at gravida wisi ante at libero. ;Quisque ornare placerat risus. ;Ut molestie magna at mi. ;Integer aliquet mauris et nibh. ;Ut mattis ligula posuere velit. ;Nunc sagittis. ;Curabitur varius fringilla nisl. ;Duis pretium mi euismod erat. ;Maecenas id augue. ;Nam vulputate. ;Duis a quam non neque lobortis malesuada. ;Praesent euismod. ;Donec nulla augue, venenatis scelerisque, dapibus a, consequat at, leo. ;Pellentesque libero lectus, tristique ac, consectetuer sit amet, imperdiet ut, justo. ;Sed aliquam odio vitae tortor. ;Proin hendrerit tempus arcu. ;In hac habitasse platea dictumst. ;Suspendisse potenti. ;Vivamus vitae massa adipiscing est lacinia sodales. ;Donec metus massa, mollis vel, tempus placerat, vestibulum condimentum, ligula. ;Nunc lacus metus, posuere eget, lacinia eu, varius quis, libero. ;Aliquam nonummy adipiscing augue. ".split(";")}static bF(pa,
Ya,Ja,nb,Bb){return new zb(null,pa,Ya,Ja,nb,Bb)}static yS(pa,Ya,Ja,nb,Bb){return new zb(pa,da.a(pa).zb,Ya,Ja,nb,Bb)}}zb.BCe=null;zb.CVg=null;zb.nOg=null;Object(D.a)(zb,"RandAction",ta,[]);class Qa{constructor(pa,Ya,Ja,nb){this.pattern=nb&8?new RegExp(pa,"i"):new RegExp(pa);this.GXl=Ya;this.TOl=Ja;this.flags=nb}}Object(D.a)(Qa,"RegexAutoCorrectEntry",null,[]);class yb extends ua{static get vPf(){var pa;return null!==(pa=this.XCe)&&void 0!==pa?pa:this.XCe=(()=>["M{1,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})",
"(CM|CD|DC{0,3}|C{1,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})","(XC|XL|LX{0,3}|X{1,3})(IX|IV|V?I{0,3})","(IX|IV|VI{0,3}|I{1,3})"].map(Ya=>`\\(?(${Ya})[\\.\\)\\-]`))()}get commandId(){return K.a.Rek}lka(pa){if(this.Mgb){var Ya=fa.GraphIterator.$a(pa);Ya.vd();ea.OutlineElementNavigator.ae(Ya);if(this.Jo.D6d(Ya,this.fX[0])){var [Ja,nb]=this.fX,Bb=yb.zLm(nb);if(!(0>=Bb)){var mb=f.a.n7b(nb.charAt(0))?5:3,Qb=F.a.createTextRange(pa,this.CF,this.PZ+1);this.Jo.uXb(pa,Ya,mb,Bb,Qb,Ja,this.levelText,this.Mgb)}}}}static bF(pa,
Ya,Ja,nb,Bb){return new yb(null,pa,Ya,Ja,nb,Bb)}static yS(pa,Ya,Ja,nb,Bb){return new yb(pa,da.a(pa).zb,Ya,Ja,nb,Bb)}static p1k(){yb.fIa||(yb.fIa={},yb.fIa.M=1E3,yb.fIa.D=500,yb.fIa.C=100,yb.fIa.L=50,yb.fIa.X=10,yb.fIa.V=5,yb.fIa.I=1)}static zLm(pa){if(!pa)return 0;yb.p1k();pa=f.a.Tz(pa);let Ya=0,Ja=0;for(let nb=pa.length-1;0<=nb;nb--){const Bb=yb.fIa[f.a.charAt(pa,nb).toString()];Ja=Bb<Ya?Ja-Bb:Ja+Bb;Ya=Bb}return Ja}}yb.fIa=null;Object(D.a)(yb,"RomanListAction",ua,[]);var lb=d(42);class Eb extends ya.a{constructor(pa,
Ya,Ja,nb,Bb,mb){super(pa,Ya,Ja,Ja+1,mb);this.$Wj=nb;this.Yxg=Bb;this.BRc=!1}get GB(){return!1}get commandId(){return K.a.Sek}Rxb(pa){pa.innerText=f.a.substring(pa.innerText,0,this.CF)+this.Yxg+f.a.right(pa.innerText,this.PZ)}lka(pa){this.Vd.replaceTextRange(F.a.createTextRange(pa,this.CF,this.PZ),this.$Wj,!0,!1);this.Vd.replaceTextRange(F.a.createTextRange(pa,this.CF,this.CF+1),this.Yxg,!0,!1)}set GB(pa){super.GB=pa}static bF(pa,Ya,Ja,nb,Bb,mb){if("'"!==Ja&&'"'!==Ja)return null;var Qb=fa.GraphIterator.$a(pa);
Qb.vd();ea.OutlineElementNavigator.ae(Qb);if(lb.OutlineElementReader.hm(Qb.currentNode))return null;nb=!Ya||f.a.V$(nb)||-1!==Array.indexOf(Eb.DXm,nb);Qb="'"===Ja;return new Eb(mb,pa,Ya,Ja+"",nb?Qb?"\u2018":"\u201c":Qb?"\u2019":"\u201d",Bb)}}Eb.DXm=["[","{","("];Object(D.a)(Eb,"SmartQuoteCorrectAction",ya.a,[]);class bc extends ya.a{constructor(pa,Ya,Ja,nb,Bb,mb){super(pa,Ya,Ja,nb,mb);this.Xxg=Bb}get GB(){return bc.cpc}set GB(pa){bc.cpc=pa}get commandId(){return K.a.Tek}xij(){this.hed=this.xkh();this.hed||
(this.WMg=!1,this.PHg="MatchTextIsNotTheSame")}Rxb(pa){pa.innerText=f.a.substring(pa.innerText,0,this.CF)+this.Xxg+f.a.right(pa.innerText,this.PZ)}lka(pa){this.Vd.replaceTextRange(F.a.createTextRange(pa,this.CF,this.PZ),this.Xxg,!0,!1)}static yS(pa,Ya,Ja,nb,Bb){const mb=da.a(pa);return new bc(pa,mb?mb.zb:null,Ya,Ja,nb,Bb)}static bF(pa,Ya,Ja,nb,Bb){return new bc(null,pa,Ya,Ja,nb,Bb)}}bc.cpc=!1;Object(D.a)(bc,"StringReplaceCorrectAction",ya.a,[]);class Pb extends ya.a{constructor(pa,Ya,Ja,nb,Bb,mb,
Qb,Vb){super(pa,Ya,Ja,nb,Bb);this.Ok=mb;this.JHj=Qb;this.vC=Vb}get GB(){return!0}get commandId(){return K.a.Uek}Rxb(pa){let Ya=f.a.substring(pa.innerText,this.CF,this.PZ);Ya.charAt(0)!==Ya.charAt(0).toUpperCase()&&(Ya=Ya.charAt(0).toUpperCase()+Ya.substring(1,Ya.length));pa.innerText=f.a.substring(pa.innerText,0,this.CF)+Ya+f.a.right(pa.innerText,this.PZ)}lka(pa){const Ya=this.CF,Ja=this.CF+1,nb=pa.characterData.substring(Ya,Ja).charAt(0);if(!f.a.n7b(nb)){const Bb=F.a.createTextRange(pa,Ya,Ja);this.B9l(Bb)||
this.vC&&this.vC.MOc(pa,Ya,Ja)||this.Vd.replaceTextRange(Bb,nb.toUpperCase().toString(),!0,!1)}}B9l(pa){return this.JHj?!!this.Ok&&this.Ok.L$(pa):!1}set GB(pa){super.GB=pa}static yS(pa,Ya,Ja,nb){const Bb=da.a(pa);return new Pb(pa,Bb?Bb.zb:null,Ya,Ja,nb,null,!1,null)}static bF(pa,Ya,Ja,nb,Bb,mb){return new Pb(null,pa,Ya,Ja,nb,Bb,!0,mb)}}Object(D.a)(Pb,"UpperFirstLetterAutoCorrectAction",ya.a,[]);class Va{constructor(pa,Ya){this.Ipc=Ya;this.yE=pa}Zmo(){const pa=Number.parseInvariant(this.yE.substring(0,
this.yE.length-2));switch(Number.parseInvariant(this.yE.charAt(this.yE.length-3).toString())){case 1:return 11===pa?"th":"st";case 2:return 12===pa?"th":"nd";case 3:return 13===pa?"th":"rd";case 4:case 5:case 6:case 7:case 8:case 9:case 0:return"th";default:return""}}tfm(){var pa=m.a.lg(this.Ipc);if(!pa||!pa.name.toLowerCase().startsWith("en")||!this.yE||2>=this.yE.length)return!1;for(pa=0;pa<Va.RHd().length;pa++)if(this.yE.toLowerCase().endsWith(Va.RHd()[pa])){if(RegExp("^\\d+$").test(this.yE.substr(0,
this.yE.length-2))){const Ya=this.Zmo();if(this.yE.toLowerCase().endsWith(Va.RHd()[pa])&&Ya===Va.RHd()[pa])return!0}break}return!1}static RHd(){return Va.ESg||(Va.ESg=["st","nd","rd","th"])}}Va.ESg=null;Object(D.a)(Va,"ValidateOrdinalsRule",null,[]);d.d(M,"a",function(){return oa});class oa{constructor(pa,Ya,Ja,nb,Bb,mb,Qb){this.Btc=[];this.pNb=[];this.Xic=[];this.Uge=[];this.$6a=-1;this.LGg=this.Bca=this.F9c=!1;this.eFj=pa;this.Vd=Ya;this.Ok=Ja;this.ga=nb;this.EU=mb;this.vC=Qb;Bb?(this.F9c=Bb.$("WordEditorEmoticonAutoCorrectIsEnabled"),
this.Bca=Bb.$("ReplaceQuoteWithSmartQuoteIsEnabled"),this.LGg=Bb.$("HyperlinkUrlValidationIsEnabled"),v.ULS.sendTraceTag(23418953,324,50,"{0}",{["WordEditorEmoticonAutoCorrectIsEnabled"]:this.F9c,["ReplaceQuoteWithSmartQuoteIsEnabled"]:this.Bca})):(v.ULS.sendTraceTag(23418954,324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),this.Bca=this.F9c=!1)}pfb(pa){return 0<=oa.bRe.indexOf(pa)}Isf(pa){return 0<=oa.cRe.indexOf(pa)}wqf(pa){return pa.toLowerCase()===
pa}n7b(pa){return pa.toUpperCase()===pa}rMd(pa){return pa.toLowerCase()!==pa.toUpperCase()}dbm(pa,Ya,Ja,nb){return(new qa(pa,Ya,Ja,nb)).Trk()}kml(pa){do{if(pa.getAttribute("xml:lang"))return m.a.lg(pa.getAttribute("xml:lang"))||m.a.cMc;if(pa.getAttribute("lang"))return m.a.lg(pa.getAttribute("lang"))||m.a.cMc;pa=pa.parentNode}while(pa&&1===pa.nodeType);return m.a.cMc}Ebf(pa){return m.a.lg(G.FormattingReader.language(G.FormattingReader.Ds(pa)))||m.a.cMc}ABd(pa,Ya){0>Ya&&(Ya=0);let Ja=-1;const nb=oa.bRe.length;
for(let Bb=0;Bb<nb;++Bb){const mb=pa.lastIndexOf(f.a.charAt(oa.bRe,Bb),Ya);mb>Ja&&(Ja=mb)}pa=f.a.o_a(pa,Ya);pa>Ja&&(Ja=pa);return Ja}h7k(pa){for(let Ya=0;Ya<pa.length;++Ya)if(this.rMd(f.a.charAt(pa,Ya)))return Ya;return-1}e8e(pa,Ya){if(!pa||0>Ya)return-1;let Ja=Ya;Ja=Ja?this.ABd(pa,Ja-1):-1;Ja=Ja>f.a.o_a(pa,Ya-1)?Ja:f.a.o_a(pa,Ya-1);Ja++;return Ja}yGh(pa,Ya,Ja){if(!z.a.instance.J(9))return null;this.zEc(Ya);if(!this.pNb[Ya]){Ya=C.SOh(Ya);if(0>=Ya)return null;this.zEc(Ya);if(!this.pNb[Ya])return null}if(Ja&&
this.Xic[Ya]&&Array.contains(this.Xic[Ya],pa+Ja))return null;Ja=this.pNb[Ya][f.a.mh(pa)];if("string"!==typeof Ja||Ja===pa||!Ja)return null;var nb=this.h7k(pa);if(0>nb||this.wqf(f.a.charAt(pa,nb)))return Ja;Ya=!0;for(nb+=1;nb<pa.length;++nb){const Bb=f.a.charAt(pa,nb);Ya&&!this.n7b(Bb)&&(Ya=!1)}return Ya?null:f.a.Tz(f.a.substring(Ja,0,1))+f.a.right(Ja,1)}u7k(pa,Ya,Ja,nb){a.a.mark(4666);const Bb=this.kml(Ya).LCID;let mb=0,Qb=pa;const Vb=Ya.innerText;if(this.dpf(Vb.substring(Vb.lastIndexOf(" ",pa)+1,
pa)))return a.a.mark(4667),null;let mc=null;var ob=!1;do{Qb=Qb?this.ABd(Vb,Qb-1):-1;if(-1===Qb&&!Ja){ob=Ya;var cb=null;if(!this.pfb(Vb.charAt(0))){do{for(;ob&&!ob.previousSibling;)ob=ob.parentNode;ob&&(ob=ob.previousSibling,cb=ob.innerText)}while(ob&&!cb);if(ob&&cb&&!this.pfb(f.a.charAt(cb,cb.length-1)))return a.a.mark(4667),null}ob=!0}cb=f.a.substring(Vb,Qb+1,pa);++mb;var db=this.yGh(cb,Bb,nb.toString());if(db)mc=bc.yS(Ya,Qb+1,pa,db,this.Vd),oa.Rvf();else for(const kb of this.Btc)if(!(kb.flags&1&&
!(Ja&&1>Qb)||kb.flags&4||kb.flags&2&&" "!==nb)&&(db=kb.pattern.exec(cb))){mc=kb.GXl(Ya,Qb+1,pa,db,this.Vd,this.ga);break}}while(!ob&&!mc&&mb<oa.qoi&&0<=Qb);a.a.mark(4667);return mc}s7k(pa,Ya,Ja){const nb=pa.node;let Bb=R.ParagraphReader.text(nb);0>Ya&&(Ya=pa.cpBegin);pa=this.Ebf(pa).LCID;if(this.dpf(Bb.substring(f.a.o_a(Bb,Ya)+1,Ya)))return null;var mb=-1,Qb=I.HyperlinkReader.FHc(nb);for(var Vb=0;Vb<Qb.length;Vb++)if(Ya>Qb[Vb].cpEnd)mb=Qb[Vb].cpEnd;else{if(Ya>Qb[Vb].cpBegin)return null;break}Qb=null;
Vb=(Vb=Ya)?this.ABd(Bb,Vb-1):-1;Vb<mb&&(Vb=mb-1);mb=f.a.substring(Bb,Vb+1,Ya);mb=mb.trimStart();if(1>Vb)for(const mc of this.Btc){let ob=Bb;" "!==Ja&&(ob=Bb+Ja);if(mc.pattern.exec(ob))return null}Bb=Bb.substring(0,Ya);if(!this.dbm(Bb,Ja.toString(),mb,pa))return null;mb.charAt(0).toUpperCase()!==mb.charAt(0)&&(Qb=Pb.bF(nb,Vb+1,Ya,this.Vd,this.Ok,this.vC));return Qb}aGh(pa,Ya,Ja){pa=L.SelectionFactory.wo(pa,!1);if(!pa)return null;pa=pa.Tc;return J.SelectionEditor.xf(pa)?this.s7k(pa,Ya,Ja):null}dpf(pa){return f.a.RW(pa)}K7e(pa,
Ya,Ja,nb){a.a.mark(4666);const Bb=pa.node,mb=this.Ebf(pa).LCID,Qb=R.ParagraphReader.text(Bb);0>Ya&&(Ya=pa.cpBegin);if(Ja&&!this.pfb(f.a.charAt(Qb,Ya))||this.dpf(Qb.substring(f.a.o_a(Qb,Ya)+1,Ya)))return a.a.mark(4667),null;pa=-1;Ja=I.HyperlinkReader.FHc(Bb);for(var Vb=0;Vb<Ja.length;Vb++)if(Ya>Ja[Vb].cpEnd)pa=Ja[Vb].cpEnd;else{if(Ya>Ja[Vb].cpBegin)return null;break}Ja=0;Vb=Ya;let mc=null;do{Vb=Vb?this.ABd(Qb,Vb-1):-1;Vb<pa&&(Vb=pa-1);const cb=f.a.substring(Qb,Vb+1,Ya);++Ja;var ob=null;let db=!1;if(N.a.dAh){const kb=
Qb+String.fromCharCode(nb);db=this.Btc.some(Wb=>Wb.pattern.exec(kb))}db||(ob=this.yGh(cb,mb,null));if(ob)this.EU.vOa&&(mc=bc.bF(Bb,Vb+1,Ya,ob,this.Vd),oa.Rvf());else for(const kb of this.Btc)if(!(kb.flags&1&&-1!==Vb||kb.flags&4&&nb!==l.a.Ks||kb.flags&2&&nb!==l.a.nQa)&&(ob=kb.pattern.exec(cb))){mc=kb.TOl(Bb,Vb+1,Ya,ob,this.Vd,this.ga);if(mc.commandId!==K.a.aRe&&!this.EU.vOa||mc.commandId===K.a.aRe&&!this.EU.sXc)mc=null;break}}while(0<=Vb&&Vb>=pa&&!mc&&Ja<oa.qoi);a.a.mark(4667);return mc}$Fh(pa,Ya,
Ja){pa=L.SelectionFactory.wo(pa,!1);if(!pa)return null;pa=pa.Tc;return J.SelectionEditor.xf(pa)?this.K7e(pa,Ya,!1,Ja):null}gGh(pa,Ya){var Ja=L.SelectionFactory.wo(pa,!1);if(!Ja)return null;let nb=Ja.Tc;Ja.VD&&Ja.Tc.contextId!==B.a.endOfParagraph&&0<=Ya&&(nb=F.a.Uc(pa,Ya));if(!J.SelectionEditor.xf(nb)||I.HyperlinkReader.Lla(nb,!1))return null;Ja=R.ParagraphReader.text(nb.node);pa=0<Ya?f.a.o_a(Ja,Ya-1)+1:f.a.o_a(Ja,Ja.length-1)+1;Ya=0<Ya?Ya:Ja.length;Ja=f.a.substring(Ja,pa,Ya);return!Ja||this.LGg&&
!I.HyperlinkReader.xMa(Ja)||!f.a.RW(Ja)&&!f.a.PMc(Ja)||!oa.hyperlinkEditor.eon(nb,pa,Ya)?null:this.eFj.kIk(nb.node,pa,Ya)}kGh(pa,Ya){var Ja=L.SelectionFactory.wo(pa,!1);if(!Ja)return null;var nb=Ja.Tc;if(!J.SelectionEditor.xf(nb))return null;0>Ya&&(Ya=nb.cpBegin);var Bb=R.ParagraphReader.text(nb.node);Ja=this.e8e(Bb,Ya);const mb=oa.cRe.length;for(let Qb=0;Qb<mb;++Qb){const Vb=Bb.lastIndexOf(f.a.charAt(oa.cRe,Qb),Ya-1);Vb>Ja&&(Ja=Vb+1)}Bb=f.a.substring(Bb,Ja,Ya);if(!Bb)return null;nb=this.Ebf(nb).LCID;
return(new Va(Bb,nb)).tfm()?Ra.bF(pa,Ja,Ya,this.Vd):null}XFh(pa,Ya){var Ja=L.SelectionFactory.wo(pa,!1);if(!Ja)return null;Ja=Ja.Tc;if(!J.SelectionEditor.xf(Ja))return null;0>Ya&&(Ya=Ja.cpBegin);var nb=R.ParagraphReader.text(Ja.node);Ja=this.e8e(nb,Ya);nb=f.a.substring(nb,Ja,Ya);return nb?(nb=(new Ea(nb)).Zbl())?Ia.bF(pa,Ja,Ya,nb,this.Vd):null:null}r8k(pa,Ya,Ja,nb,Bb){var mb=L.SelectionFactory.wo(pa,!1);if(!mb)return null;mb=mb.Tc;if(Ja>Ya||!J.SelectionEditor.xf(mb))return null;0>Ya&&(Ya=mb.cpBegin);
if(0>Ya)return null;mb=R.ParagraphReader.text(mb.node);return Eb.bF(pa,Ja,Bb,Ya?mb.charAt(Ya-1):"\x00",this.Vd,nb)}Eub(pa,Ya,Ja,nb){this.Btc.push(new Qa(`^${pa}$`,Ya,Ja,nb))}ryf(pa){if(this.pNb[this.$6a]){const Ya=this.pNb[this.$6a];for(const Ja in pa)Ya[Ja]=pa[Ja]}else this.pNb[this.$6a]=pa}vyf(pa){this.Xic[this.$6a]?this.Xic[this.$6a].push(...(pa||[])):this.Xic[this.$6a]=pa}wqm(pa,Ya){this.Uge[Ya]||(this.Uge[Ya]=!0,r.AFrameworkApplication.Ze.Lj(pa,1,null,null,!1,3,Ja=>{this.$6a=Ya;try{Object(u.a)(Ja.data.Ee)}catch(nb){v.ULS.sendTraceTag(5898336,
324,50,"Failed to parse autocorrect: {0}",{["ResponseData"]:Ja.data?Ja.data.Ee:""})}this.$6a=-1},()=>{this.C0k(Ya)},null,void 0,void 0,void 0,void 0,"27"))}C0k(pa){pa=C.SOh(pa);0<pa&&this.zEc(pa)}static get lfk(){return null!=oa.Yge?oa.Yge:oa.Yge=oa.Ddh.map(([pa,...Ya])=>(new Qa(`^${pa}`,...Ya)).pattern)}static get Ddh(){if(null!=oa.Zge)return oa.Zge;const pa=[...ka.vPf.map(Ya=>[Ya,ka.yS,ka.bF,3]),["\\(?(\\d+)[\\.\\)\\-]",Oa.yS,Oa.bF,3],["\\(?(L|l|C|c|D|d|M|m){1}[\\.\\)\\-]",na.yS,na.bF,3],...yb.vPf.map(Ya=>
[Ya,yb.yS,yb.bF,11]),["\\(?([A-Za-z]){1}[\\.\\)\\-]",na.yS,na.bF,3]];return oa.Zge=pa}Fqm(){z.a.instance.J(9)&&(this.zEc(1033),this.Eub("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",zb.yS,zb.bF,5),this.Eub("=rand\\.old\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",zb.yS,zb.bF,5),this.Eub("=lorem\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",zb.yS,zb.bF,5),oa.Ddh.forEach(pa=>this.Eub(...pa)),this.Eub("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",Pa.yS,Pa.bF,0),this.F9c&&(this.Eub("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",Xa.yS,
Xa.bF,0),this.Eub("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",Xa.yS,Xa.bF,0)))}zEc(pa){this.Uge[pa]||this.wqm(H.a.oik(String.format("Acl/Acl{0}.js",pa)),pa)}static Rvf(){w.a.instance.Za("Common.ISystemInitiatedFeedback").execute(pa=>{pa.logActivity("AutocorrectStringMatch",null)})}static get hyperlinkEditor(){return null!=oa.rjg?oa.rjg:oa.rjg=w.a.instance.resolve("Box4.IHyperlinkEditor")}}oa.bRe=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014";oa.cRe=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'";
oa.CVf=".!?";oa.qoi=5;oa.Yge=null;oa.Zge=null;Object(D.a)(oa,"AutoCorrectRules",null,[583])},1588:function(D,M,d){D=d(0);var m=d(35),f=d(8),a=d(311),l=d(674),r=d(43),w=d(2),v=d(28);const u=(V,Y,ca)=>{if(V){var fa=0;do{try{V();break}catch(sa){if(f.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",fa,ca,sa.message,sa.stack),fa>=Y)break}fa++}while(1)}};var z=d(80),B=d(29),G=d(192),F=d(212),K=d(46),N=d(285),H=d(15),J=d(121);class L{constructor(V,
Y,ca,fa,sa,ia,ea,da,ja=!0,Ga=null,ya=!1){this.CFh="FileUpload.ashx";this._iframe=null;this._initialized=!1;this.ol=this.Nmc=this.Yne=this.wUa=this.k$c=this.BD=this._form=null;this.qh=!1;this.l0=this.l$c=this.P9a=null;this._parent=V;this.VFj=Y;this.lRj=ca;this.YDg=sa;this.Txa=ea;this.msg=da;this.Lvg=Ga;this.vKe=!1;this.TGj=fa.$("CanaryRenewalForFileUploadIsEnabled");this.Elo=!1;(this.d8a=ya)||this.BFk(ia);ja&&this.F6h()}get uQi(){return this.lRj}get sessionId(){return this.Txa}get iFrame(){return this._iframe}get US(){return this.BD}get fFb(){return w.AFrameworkApplication.K?
w.AFrameworkApplication.K.$("NativeFileOpenDialogIsEnabled"):!1}get vFh(){return w.AFrameworkApplication.K?w.AFrameworkApplication.K.$("FileInputDescriptionAccessibilityIsEnabled"):!1}get aem(){return this.d8a?!1:F.b(this._iframe.contentWindow.location.pathname,this.CFh,0)}get K9j(){return!H.a.K$&&w.AFrameworkApplication.K.$("AllowMultipleImageInsertFromLocalDevice")}F6h(){this.l0=J.a.create().toString();this.d8a?this.G5e():this.tak()}BFk(V){this._iframe=document.createElement("iframe");this._iframe.className=
V;this._iframe.id=V;this.YDg&&(this._iframe.style.visibility="visible",this._iframe.style.height="30px",this._iframe.setAttribute("frameborder","0"));this.wUa=Object(r.a)(this,this.zHf,"onUploadFrameLoad");v.a.addHandler(this._iframe,"load",this.wUa)}Iyd(V=null){w.AFrameworkApplication.ua.ZZd();if(!this.BD)return f.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";v.a.addHandler(this.BD,"change",()=>{this.P5k(V)});u(Object(r.a)(this,this.uFh,"fileInputClick"),1,"DoFileOpenDialog");return this.BD.value}P5k(V){V&&
V(this.BD.value)}Q5k(){this.k$c&&(this.k$c.innerText=this.fRh())}lkn(V){v.a.addHandler(this.BD,"change",()=>{V(this.fRh())})}fRh(){let V=null;if(this.BD.value){const Y=this.BD.value,ca=Y.lastIndexOf("\\");0<ca&&(V=Y.substring(ca+1,Y.length))}return V?V:""}uFh(){try{f.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.BD.click()}catch(V){throw f.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",V.message),V;}}B0c(){this.tim()?
this.v7i():(this.K7f(),this._form.submit())}tim(){return(this.TGj||this.d8a)&&!(void 0===window.self.FormData||null===window.self.FormData)}oVi(V){if(V){const Y=this.crh();this.ol=new XMLHttpRequest;this.ol.open("POST",Y);this.ol.setRequestHeader("X-CorrelationId",this.l0);this.svm(V);this.ol.onreadystatechange=Object(r.a)(this,this.Ova,"uploadResponseReceived");this.ol.send(V)}}svm(V){if(!H.a.K$&&V.get){var Y=V.get("ImageId");V=window.self.navigator;Y={["CorrelationId"]:this.l0,["Canary"]:w.AFrameworkApplication.canary,
["ImageNodeId"]:Y};V&&(V=V.connection?V.connection:V.mozConnection?V.mozConnection:V.webkitConnection?V.webkitConnection:null)&&(Y.effectiveType=V.effectiveType,Y.downlink=V.downlink,Y.type=V.type,Y.rtt=V.rtt);f.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",Y)}}v7i(){try{this.K7f();f.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");const V=new (Type.parse("FormData"))(this._form);this.oVi(V)}catch(V){f.ULS.sendTraceTag(594888407,
322,10,"SubmitFormWithRequest failed to send the request with exception "+V.message),this.w$b(null)}}u7i(V){try{if(this.K7f(),f.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.gno(V)){this.l$c=V;this._form.contains(this.BD)&&this._form.removeChild(this.BD);var Y=new (Type.parse("FormData"))(this._form);Y.append("applicationfileInput",V.blob,V.filename);this.oVi(Y)}else this.w$b(null)}catch(ca){f.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+
ca.message),this.w$b(null)}}gno(V){return V&&void 0!==V.blob&&null!==V.blob&&void 0!==V.filename&&null!==V.filename&&""!==V.filename?void 0===window.self.FormData||null===window.self.FormData?(f.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(V=V?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===V.blob||null===V.blob,void 0===V.filename||null===V.filename||""===V.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",
f.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",V)),!1)}Ova(){if(4===this.ol.readyState)if(200===this.ol.status){f.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.l0);const V=this.ol.getResponseHeader("X-NewKey"),Y=this.v8l(this.ol);let ca=!1;if(void 0!==V&&null!==V&&Y&&(ca=this.Umo(V),!this.vKe&&ca)){f.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",
this.l0);this.vKe=!0;this.xwd();void 0!==this.l$c&&null!==this.l$c?this.u7i(this.l$c):this.v7i();return}f.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.vKe,Y,!(void 0===V||null===V),ca,this.l0);this.w$b(this.ol.responseText)}else f.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.ol.status,
this.ol.responseText?!1:!0,this.l0),this.w$b(null)}v8l(V){try{const Y=m.a(V.responseText).Responses;if(void 0!==Y&&null!==Y&&1===Y.length){const ca=Y[0];if(void 0!==ca&&null!==ca&&2===ca.length&&28===ca[1].StatusCode)return!0}}catch(Y){}return!1}Umo(V){N.a.B6f(V);return w.AFrameworkApplication.canary!==V?!1:!0}K7f(){this.P9a||(this.P9a=new Date)}dispose(){this.qh||(this.d8a?this._parent.removeChild(this._form):(this._parent.removeChild(this._iframe),v.a.removeHandler(this._iframe,"load",this.wUa),
this.wUa=null),this.Yne&&(v.a.removeHandler(this.BD,"change",this.Yne),this.Yne=null),this.vFh&&(this.Nmc&&(v.a.removeHandler(this.BD,"change",this.Nmc),this.Nmc=null),this.k$c=null),this.BD=this._form=this._parent=this._iframe=null,this.qh=!0,this.P9a=null,f.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))}delayedDispose(){this.dispose()}CZb(V,Y){if(this._form){var ca;(ca=this._form.querySelector("input[name="+V+"]"))?ca.value=Y:(ca=this.KZe(),ca.type="hidden",ca.id=V,ca.name=V,ca.value=
Y,this._form.appendChild(ca))}}KZe(){return this.d8a?document.createElement("input"):this._iframe.contentWindow.document.createElement("input")}zHf(){try{if(!this._iframe.contentWindow.document.body)return}catch(Y){this.RJc();return}if(!(this._initialized||this.fFb&&H.a.UG))this.G5e();else if(!this.fFb||!H.a.UG||this.aem){let Y;Y=H.a.zk?this._iframe.contentWindow.document.body.innerText:this.Elo?this._iframe.contentWindow.document.body.firstChild.innerText:this._iframe.contentWindow.document.body.firstChild.innerHTML;
var V=this._iframe.contentWindow.document.body.innerText.toLowerCase();const ca=0<=V.indexOf("responses")||0<=V.indexOf("wopisrc");V=0<=V.indexOf("http error");!ca&&V&&f.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this._iframe.contentWindow.document.body.innerText);this.w$b(Y)}}G5e(){if(!this._initialized){var V=this.getString("uploadForm");const Y=this.getString("fileInput"),ca=this.crh();this.LHk();this._form.id=V;this._form.method="post";this._form.encoding=
"multipart/form-data";this._form.action=ca;this.BD.type="file";this.msg&&(this.BD.accept=this.msg,this.Lvg&&(this.BD.capture=this.Lvg));this.BD.id=Y;this.BD.name=Y;this.K9j&&(this.BD.multiple=!0);!this.vFh||H.a.zk||H.a.Vs||(this.Nmc=Object(r.a)(this,this.Q5k,"fileInputChangedHandleAccessibility"),v.a.addHandler(this.BD,"change",this.Nmc),this.k$c=B.a.Pqd(this._form,this.BD,"InputFileDescription",""));this.YDg&&(this.d8a||(V=this._iframe.contentWindow.document.body,V.style.margin="0",V.style.overflow=
"hidden"),V=w.AFrameworkApplication.ua,this.BD.style.fontFamily=V.Kva,this.BD.style.fontSize=V.T5f,this.BD.style.margin="0");(V=document.getElementById("__REQUESTDIGEST"))&&this.CZb("__REQUESTDIGEST",V.value);this.xwd();this._form.appendChild(this.BD);this._initialized=!0;this.VFj(this)}}LHk(){if(this.d8a)this._form=document.createElement("form"),this._parent.appendChild(this._form),this.BD=document.createElement("input");else{this._form=this._iframe.contentWindow.document.createElement("form");const V=
this._iframe.contentWindow.document;V.body.appendChild(this._form);this.BD=V.createElement("input")}}tak(){this._parent.appendChild(this._iframe);this.fFb&&H.a.UG&&this.G5e()}crh(){var V=new G.QueryStringBuilder(this.CFh);w.AFrameworkApplication.gja(V);this.kFn(V);V=V.toString();if(H.a.fj||H.a.UG||H.a.Vs)V=K.a.XCd(V);return V}Apd(){const V=new z.a(2,1,0,Object(r.a)(this,this.delayedDispose,"delayedDispose"),4);w.AFrameworkApplication.uc.$b(V)}}Object(D.a)(L,"UploadFrame",null,[10]);var I=d(16),R=
d(263),C=d(9),P=d(1693);class W extends L{constructor(V,Y,ca,fa,sa,ia,ea=null,da=!1){super(V,Y,ca,fa,sa,"WACUploadFrame",w.AFrameworkApplication.userSessionId,ia,!1,ea,da)}getString(V){return C.App.xa.pj(V)}kFn(V){R.a.instance.Lub(V)}xwd(){w.AFrameworkApplication.canary&&this.CZb(a.a.canary,w.AFrameworkApplication.canary);C.App.xa.jb.activeSection.YH&&this.CZb(a.a.YH,C.App.xa.jb.activeSection.YH)}hgf(V){let Y=null,ca;({group:ca}=l.a.G7(V)).returnValue?Y=ca.Responses[0]:f.ULS.sendTraceTag(41697634,
322,10,"Box4UploadFrame.GetServerResponse: unable to deserialize the response");return Y}RJc(){f.ULS.sendTraceTag(41697635,322,15,"Box4ImageUploadFrame.HandleUploadError: The response is invalid, falling back on a default unspecified failure response");const V=new P.a;V.StatusCode=14;this.uQi(V);this.Apd()}w$b(V){V?(V=I.a.d7i(V),V=V.replace(RegExp("&amp;","g"),"&"),(V=this.hgf(V))?(this.uQi(V),this.Apd()):this.RJc()):this.RJc()}}Object(D.a)(W,"Box4UploadFrame",L,[]);d.d(M,"a",function(){return X});
class X extends W{constructor(V,Y,ca,fa,sa,ia=null,ea=!1){super(V,Y,ca,fa,sa,X.hel(fa),ia,ea);this.F6h()}static hel(V){return V&&V.getBooleanFeatureGate("Microsoft.Office.WordOnline.PictureUploadSupportsWebp",!1)?X.D3g.join(",")+","+X.FKe.join(","):"image/*"}xwd(){super.xwd();this.CZb(a.a.kmb,"1");this.CZb(a.a.MLb,"1")}RJc(){super.RJc();f.ULS.sendTraceTag(41697632,322,15,"Box4ImageUploadFrame.HandleUploadError: Falling back on a default Unspecified Failure response")}hgf(V){const Y=super.hgf(V);if(!Y)try{const ca=
m.a(V);l.a.N9e(ca)}catch(ca){f.ULS.sendTraceTag(41697633,322,10,"Box4ImageUploadFrame.GetServerResponse: {0}",ca.toString())}return Y}}X.D3g=".jpg .jpeg .png .gif .bmp .tif .tiff .jfif".split(" ");X.FKe=[".webp"];Object(D.a)(X,"Box4ImageUploadFrame",W,[])},1589:function(D,M,d){D=d(0);var m=d(121),f=d(59),a=d(372),l=d(58),r=d(3),w=d(1159),v=d(21),u=d(6),z=d(318),B=d(49),G=d(1277),F=d(799),K=d(44),N=d(17),H=d(5),J=d(110),L=d(106),I=d(47),R=d(8),C=d(1784),P=d(619),W=d(1635),X=d(130),V=d(1514);class Y{constructor(ea,
da,ja,Ga,ya,ta){this.d0b=this.Ebb=null;this.X9e=da;if(ea[P.a.zJc])this.Aea=ea[P.a.zJc],this.Yxc=ea[P.a.Yxc],this.d0b=Array(4),this.d0b[0]=ea[P.a.Bbb],this.d0b[1]=ea[P.a.Cbb],this.d0b[2]=ea[P.a.Dbb],this.d0b[3]=ea[P.a.Abb],this.kpo=ea[P.a.width],this.QVl=ea[P.a.height],this.l7b=void 0!==ea[P.a.l7b]?"true"===ea[P.a.l7b].toLowerCase():void 0,this.gq=ja,this.T_b=Ga;else{da=ea[P.a.Bbb];const ua=ea[P.a.Cbb],Sa=ea[P.a.Dbb],ka=ea[P.a.Abb];ta&&ta.$("EffectExtentPointsForGraphicsEditorIsEnabled")&&void 0!==
da&&void 0!==ua&&void 0!==Sa&&void 0!==ka?(this.Bbb=da,this.Cbb=ua,this.Dbb=Sa,this.Abb=ka):(this.Bbb=ea[P.a.left],this.Cbb=ea[P.a.right],this.Dbb=ea[P.a.top],this.Abb=ea[P.a.bottom]);this.width=ea[P.a.width];this.height=ea[P.a.height];this.rotationAngle=ea[P.a.angle];this.f3m=ea[P.a.e3m];this.gq=ja;this.T_b=Ga;this.mab=ya;this.kBa=2;this.flipH=this.sW(ea,P.a.flipH);this.flipV=this.sW(ea,P.a.flipV);this.jKm();this.$fo()}}$fo(){this.Ebb||(this.Ebb=Array(4),this.Ebb[0]=X.a.jF(this.Bbb),this.Ebb[1]=
X.a.jF(this.Cbb),this.Ebb[2]=X.a.jF(this.Dbb),this.Ebb[3]=X.a.jF(this.Abb))}jKm(){var ea=V.c(this.rotationAngle);if(45<=ea&&135>=ea||225<=ea&&315>=ea){ea=this.width/2;const da=this.height/2;this.Bbb-=ea-da;this.Cbb+=ea-da;this.Dbb-=da-ea;this.Abb+=da-ea}}sW(ea,da){if(ea.hasOwnProperty(da))return ea[da]}}Object(D.a)(Y,"JsonToDocumentXmlResponseCommonParams",null,[]);class ca extends Y{constructor(ea,da,ja,Ga,ya,ta){super(ea,da,ja,Ga,ya,ta);this.T9j="string"===typeof ea[P.a.Eqd]?ea[P.a.Eqd]:null;this.K0b=
"string"===typeof ea[P.a.K0b]?ea[P.a.K0b]:null}}Object(D.a)(ca,"JsonToDocumentXmlResponseDrawingParams",Y,[]);var fa=d(483);class sa extends Y{constructor(ea,da,ja,Ga,ya,ta){var ua,Sa,ka,ha,Ca;super(ea,da,ja,Ga,ya,ta);this.Tko=ea[P.a.Q2m];this.NBk=ea[P.a.J2m];this.kBa=1;this.NBk||(this.kBa=0,this.Ebb=fa.a.instance.Rka(X.a.jF(this.width),X.a.jF(this.height),this.rotationAngle));this.WHf=this.sW(ea,P.a.F$b);this.fYd=this.sW(ea,P.a.fYd);this.XHf=this.sW(ea,P.a.XHf);this.Ejj=this.sW(ea,P.a.Djj);this.Dce=
this.sW(ea,P.a.Dce);this.u9f=this.sW(ea,P.a.u9f);this.HWc=null!==(ua=this.sW(ea,P.a.HWc))&&void 0!==ua?ua:"";this.extension=ea[P.a.extension];this.wza=null!==(Sa=this.sW(ea,P.a.left))&&void 0!==Sa?Sa:0;this.yza=null!==(ka=this.sW(ea,P.a.top))&&void 0!==ka?ka:0;this.xza=null!==(ha=this.sW(ea,P.a.right))&&void 0!==ha?ha:0;this.vza=null!==(Ca=this.sW(ea,P.a.bottom))&&void 0!==Ca?Ca:0;this.lockAspectRatio=this.sW(ea,P.a.lockAspectRatio);this.afh=this.sW(ea,P.a.Sfa);this.borderStyle=this.sW(ea,P.a.Vma);
this.borderColor=this.sW(ea,P.a.cDa);this.Mhk=void 0!==this.afh||void 0!==this.borderStyle||void 0!==this.borderColor;this.altTextDescription=this.sW(ea,P.a.altTextDescription);this.alphaModFix=this.sW(ea,P.a.alphaModFix)}}Object(D.a)(sa,"JsonToDocumentXmlResponsePictureParams",Y,[]);d.d(M,"a",function(){return ia});class ia{constructor(ea,da,ja,Ga,ya,ta,ua,Sa,ka,ha,Ca,Pa,Xa,qa,Ea,Ia,na){this.o6a=this.ktb=null;this.uad=ea;this.$oe=da;this.dJ=ja;this.sm=Ga;this.em=ya;this.Hc=ta;this.$Aj=Sa;this.$Ag=
ua;this.hj=ka;this.nm=ha;this.bPj=Ca;this.aPj=Pa;this.Ma=Xa;this.FU=qa;this.wc=Ea;this.AHj=Ia;this.CFj=na}Dma(ea,da,ja,Ga,ya,ta,ua){ta.stop();ua?R.ULS.sendTraceTag(575522565,3001,10,ea):R.ULS.sendTraceTag(575522566,3001,10,ea);this.$Ag?(Ga=this.Hc.Rc(7,r.a.AJc),Ga.Db(ja),da.Gb.setValue(K.a.wZ,0),da.Gb.setValue(N.a.cfa,da.enk),da.Gb.setValue(N.a.fma,da.cnk),Ga.dispose()):Ga();this.o6a&&this.o6a(ea);ya()}v0a(ea,da,ja,Ga,ya,ta,ua){R.ULS.sendTraceTag(575522567,3001,50,"GraphicsEditorJsonToDocumentXmlRequestHelper: {0}",
{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ua.ni});var Sa=ea.data.Ee,ka=null;try{ka=JSON.parse(Sa)}catch(Ca){this.Dma("Failed to parse incoming JSON blob.",da,ya,Ga,ja,ua,!1);return}if(C.a.error in ka)this.Dma("Error code returned from WordGraphicsEditorHandler endpoint: "+ka[C.a.error],da,ya,Ga,ja,ua,!1);else{Sa=10;var ha=1;try{Sa=parseInt(ka[P.a.gq]),ha=parseInt(ka[P.a.T_b])}catch(Ca){this.Dma("Invalid data found in the JSON blob. (i.e. placeholderkind/drawingid)",da,ya,Ga,ja,ua,
!1);return}ja=ea.data.request?w.a.bFc(ea.data.request.get_body()):null;ea=null;ea=da.Gb;Ga=da.getId();da=ea.getValue(H.a.gq);da=da!==Sa&&(5===da||5===Sa||this.PTl(ea,ka));5===Sa?(ka=new sa(ka,this.$oe,Sa,ha,ja,this.Ma),ea=this.skl(ya,ta,ka,da,ea,Ga)):(ka=new ca(ka,this.$oe,Sa,ha,ja,this.Ma),ea=this.rkl(ya,ta,ka,da,ea,Ga));ka=this.Hc.Rc(7,r.a.AJc);Sa=ya;v.ImageReader.m6(ya)&&da&&(Sa=u.GraphIterator.$a(ya),Sa.Bb(12),Sa=Sa.parentNode);ka.Db(Sa);ea();this.dJ.PDa(ta);ka.dispose();if(this.em&&this.em!==
m.a.nil){const Ca=Sa.Bi();null===Ca||void 0===Ca?void 0:Ca.contentReplicator.forceOutbound(()=>{R.ULS.sendTraceTag(574358089,3001,50,"Graphical Content Properties Persisted to Box4: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ua.ni});ua.stop();const Pa=new f.a(this.em,1);this.sm.WYb(Ca,Pa);const Xa=this.uad.properties;null!=Xa&&Object(z.a)(()=>{let qa=new B.GraphTransaction(3,r.a.imageRotate);qa.Db(ya);Xa.setValue(J.a.d3,1);qa.dispose()})},null,null)}this.ktb&&this.ktb(ya)}}pah(ea,
da){ea.Me(C.a.fKf,"false");ea.Me(C.a.X9e,this.$oe);ea.Me(C.a.mYe,"0");ea.bL(P.a.mab,window.self.devicePixelRatio.toString());void 0!==da&&null!==da&&(da=this.nm.Xl(da.tk),da=this.nm.tl(da),ea.Me(P.a.gq,G.a[da]));this.AHj&&(ea.Me(P.a.NKd,"true"),ea.Me(P.a.nZl,this.CFj.toString()))}i5g(ea){if(this.$Ag){ea=ea.tk;var da=this.nm.Xl(ea);if(!da)return null;const ja=new W.a(this.$Aj,da),Ga=this.Hc.Rc(15,r.a.AJc);Ga.Db(ea.node);this.UCi(da);da.setValue(H.a.gq,da.ia(H.a.gq,10));Ga.zl=r.a.AJc;Ga.tCa(this.em,
1);Ga.dispose();return ja}da=new a.DictionaryPropertySet;this.UCi(da);return(ea=this.hj.hzh(ea,da,this.em))&&ea.blob?new W.a(ea.blob.id,ea.blob.properties):null}JGd(){return Box4Intl.Box4Strings.l_GraphicsEditorError}UCi(ea){ea.setValue(N.a.cfa,l.a.jn(this.bPj,0));ea.setValue(N.a.fma,l.a.jn(this.aPj,1));ea.setValue(K.a.wZ,1);ea.setValue(L.a.H$,!0)}rkl(ea,da,ja,Ga,ya,ta){const ua=Sa=>{this.uad.Ago(ja,Sa,ea)};return this.vri(Ga,ya,ea)?this.MMh(da,ya,ta,ua):()=>{ua(ya)}}skl(ea,da,ja,Ga,ya,ta){const ua=
Sa=>{this.uad.Bgo(ja,Sa,ea)};return this.vri(Ga,ya,ea,ja)?this.MMh(da,ya,ta,ua):()=>ua(ya)}vri(ea,da,ja,Ga){return ea?!0:Ga?v.ImageReader.UFd(da,ja.Nc,!1)!==Ga.WHf:!1}MMh(ea,da,ja,Ga){const ya=F.a.instance.L4c;ya.ys(da);ya.id=ja;return()=>{this.uad.nsn(ea,ja,ya,this.FU,Ga)}}PMn(ea){this.ktb=ea}uHn(ea){this.o6a=ea}PTl(ea,da){return this.wc.isFeatureEnabled(49)&&(ea.hasProperty(I.a.Aea)&&!da[P.a.zJc]||!ea.hasProperty(I.a.Aea)&&da[P.a.zJc])?!0:!1}}Object(D.a)(ia,"GraphicsEditorJsonToDocumentXmlRequestHelper",
null,[632])},1590:function(D,M,d){D=d(0);var m=d(79),f=d(43),a=d(269),l=d(277);class r{constructor(G,F,K,N=0,H=0,J=null){this.commandId=G;this.controlId=F;this.timeStamp=K;this.commandSurface=a.a[N];this.Qw=l.a[H];this.contentType=J}}Object(D.a)(r,"CommandActionInfo",null,[]);class w{constructor(){this.Usj=RegExp("(Close|TabSwitch|((Populate|Query|Report|Show|BrowserFocus).+)|(.+(Rendered|Seen|Scroll)))")}tlm(G){return!this.Usj.exec(G)}}Object(D.a)(w,"EventsCacheLoggingUtils",null,[]);var v=d(2),
u=d(1748),z=d(494);d.d(M,"a",function(){return B});class B{constructor(){this.lOg=null;this.qxe=20;this.Rmc=this.k7c=this.M7c=null}init(){this.lOg=new w;this.M7c=new m.a;this.k7c=new m.a;this.Rmc=new m.a;this.qxe=v.AFrameworkApplication.K.rc("MaxCommandClickedEventQueueSize",20);u.a.O5j(Object(f.a)(this,this.oyk,"commandClickEventRaised"));z.a.instance.QNe(Object(f.a)(this,this.Fen,"recordActionEvent"))}e5f(G){G.count>this.qxe&&G.removeAt(this.qxe)}oyk(G,F){this.M7c.insert(0,new r(F.commandId,F.controlId,
F.time,F.commandSurface,F.Qw,F.contentType));this.e5f(this.M7c)}Fen(G,F){this.k7c.insert(0,new r(F.actionName,"",F.timeStamp,F.commandSurface,F.Qw,F.contentType));this.e5f(this.k7c);this.lOg.tlm(F.actionName)&&(this.Rmc.insert(0,new r(F.actionName,"",F.timeStamp,F.commandSurface,F.Qw,F.contentType)),this.e5f(this.Rmc))}N1b(){return this.M7c}Fcb(){return this.k7c}static get instance(){return B._instance||(B._instance=new B)}}B._instance=null;Object(D.a)(B,"CommandClickEventsCache",null,[])},1592:function(D,
M,d){D=d(0);class m{}Object(D.a)(m,"AuthContext",null,[]);var f=d(2),a=d(1480);d.d(M,"a",function(){return l});class l{static getAuthContext(){const r=f.AFrameworkApplication.K.lb("UserPrincipalName")||"";let w=r;f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginHintEnabled",!1)&&(w=a.a.MLm||r);return Object.assign(new m,{upn:r,loginHint:w,authority:a.a.authority,authorityType:l.hDd(),tenantId:f.AFrameworkApplication.K.lb("TenantId")||""})}static hDd(){let r=
0;const w=l.RKh();"aad"===w.toLowerCase()?r=2:"msa"===w.toLowerCase()&&(r=1);return r}static RKh(){return f.AFrameworkApplication.K.lb("HostAuthType")||""}}Object(D.a)(l,"OAuthIdentity",null,[])},1593:function(D,M,d){d.r(M);D=d(0);var m=d(1740),f=d(43),a=d(1742),l=d(471),r=d(1743),w=d(160),v=d(2),u=d(90),z=d(98),B=d(463),G=d(204),F=d(7),K=d(56),N=d(68),H=d(85),J=d(80),L=d(29),I=d(51),R=d(37),C=d(15),P=d(13);class W{constructor(Y){this.ITd=4;this.bVg=0;this.zzg=this.Dvg=this.CWg=this.CAg=this.WXg=
this.Yxa=this.UUb=this.ew=this.$_g=this.FDg=this.GDg=this.Rxa=this.yTa=this.wme=this.ARa=this.tRa=this.W=this.eY=this.swa=null;C.a.pta&&(this.ITd=6);this.Mu=Y;this.oY=H.KeyInputManager.mc(N.a.L3,0);this.render()}get containerElement(){return this.W}dispose(){var Y=v.AFrameworkApplication.ua.Zy;const ca=v.AFrameworkApplication.ua.$y;Y.sc(F.a.click,this.W,Object(f.a)(this,this.Rui,"onContainerClick"));Y.sc(F.a.KC,this.W,Object(f.a)(this,this.Sui,"onContainerDoubleClick"));ca.sc(F.a.Bh,this.W,Object(f.a)(this,
this.Tui,"onContainerKeyPress"));this.tRa&&(Y.sc(F.a.click,this.tRa,Object(f.a)(this,this.KEf,"onDeleteButtonClick")),ca.Klb(this.tRa,this.zzg));this.ARa&&(Y.sc(F.a.click,this.ARa,Object(f.a)(this,this.REf,"onDoneButtonClick")),ca.Klb(this.ARa,this.CAg));this.Rxa&&(Y.sc(F.a.click,this.Rxa,Object(f.a)(this,this.bXd,"onSaveButtonClick")),ca.Klb(this.Rxa,this.WXg));this.swa&&(Y.sc(F.a.click,this.swa,Object(f.a)(this,this.jEf,"onCancelButtonClick")),ca.Klb(this.swa,this.Dvg));this.yTa&&(Y.sc(F.a.click,
this.yTa,Object(f.a)(this,this.GGf,"onReplyButtonClick")),ca.Klb(this.yTa,this.CWg));this.ew&&(ca.sc(F.a.At,this.ew,Object(f.a)(this,this.GCa,"onKeyEvent")),ca.sc(F.a.Bh,this.ew,Object(f.a)(this,this.GCa,"onKeyEvent")),C.a.ki&&(Y=v.AFrameworkApplication.ua.Efc,Y.sc(F.a.VAc,this.ew,Object(f.a)(this,this.BCa,"onCompositionEvent")),Y.sc(F.a.YYb,this.ew,Object(f.a)(this,this.BCa,"onCompositionEvent")),Y.sc(F.a.ZYb,this.ew,Object(f.a)(this,this.BCa,"onCompositionEvent"))),B.a.instance.sc(F.a.paste,this.ew,
Object(f.a)(this,this.VSc,"onPaste")));this.Yxa=this.UUb=this.ew=this.swa=this.Rxa=this.wme=this.ARa=this.yTa=this.tRa=this.W=null}focus(){K.FocusManager.instance().YB(w.AFrame.fr);this.W.focus();this.Mu.sq.Raf().Uj.hy(this.W)}MHh(){K.FocusManager.instance().YB(a.a.KAc);this.ew.focus();this.Mu.sq.Raf().Uj.hy(this.ew);2===this.Mu.Qq&&this.ew.value&&0<this.ew.value.length&&R.a.EYc(this.ew);const Y=this.Mu.sq.waa.JTc,ca=R.a.hYa(Y,this.W);ca.y+this.W.clientHeight>Y.scrollTop+Y.clientHeight&&(Y.scrollTop=
ca.y+this.W.clientHeight-Y.clientHeight)}M8k(){Sys.UI.DomElement.removeCssClass(this.W,"NewOrEditComment");this.swa.style.display="none";this.ew.style.display="none";K.FocusManager.l5f(this.ew);K.FocusManager.l5f(this.Rxa);K.FocusManager.instance().pe(a.a.KAc).Ar(this.oY);K.FocusManager.instance().NHb(a.a.KAc);H.KeyInputManager.instance.sc(F.a.At,this.ew,Object(f.a)(this,this.GCa,"onKeyEvent"));H.KeyInputManager.instance.sc(F.a.Bh,this.ew,Object(f.a)(this,this.GCa,"onKeyEvent"));if(C.a.ki){const Y=
v.AFrameworkApplication.ua.Efc;Y.sc(F.a.VAc,this.ew,Object(f.a)(this,this.BCa,"onCompositionEvent"));Y.sc(F.a.YYb,this.ew,Object(f.a)(this,this.BCa,"onCompositionEvent"));Y.sc(F.a.ZYb,this.ew,Object(f.a)(this,this.BCa,"onCompositionEvent"))}B.a.instance.sc(F.a.paste,this.ew,Object(f.a)(this,this.VSc,"onPaste"));this.eY.removeChild(this.ew);this.eY.removeChild(this.UUb);this.Yxa=this.UUb=this.ew=null;this.u7f();this.Q2c();this.focus()}Q2c(){this.hOi(this.$_g,this.GDg,this.FDg,this.wme,this.W)}render(){var Y=
l.a("a",this.nfa("cc"),"CommentContainer");L.a.Gq(Y,L.a.o1,a.a.izk);Y.tabIndex=0;this.Mu.Rf&&(Y.className+=" Reply1");var ca=l.a("div",this.nfa("ch"),"CommentHeaderRow");const fa=l.a("span",this.nfa("ca"),"CommentAuthor UIFontBold");fa.innerText=this.Mu.author;ca.appendChild(fa);const sa=l.a("span",this.nfa("ct"),"CommentDate");sa.innerText=W.xOk(this.Mu.date,this.Mu.sq.wOk,this.Mu.sq.m6n);Sys.UI.DomElement.addCssClass(sa,v.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight");ca.appendChild(sa);
const ia=l.a("span",this.nfa("ci"),"CommentStatusIcon");ca.appendChild(ia);let ea=null;this.Mu.jCb&&(ea=r.a.cWa(this.nfa("cl"),a.a.Gyk,CommonUIStrings.l_CommentCancelButton,"ClosePaneGlyph_16x16x32",!1),Sys.UI.DomElement.addCssClass(ea,v.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight"),ea.tabIndex=0,ca.appendChild(ea));this.eY=l.a("div",this.nfa("cn"),"CommentContent");let da=null,ja=null,Ga=null;this.Mu.jCb?(da=l.a("textarea",this.nfa("ce"),a.a.Lnh+" UIFont"),da.rows=this.ITd,da.cols=50,da.tabIndex=
0,L.a.Gq(da,"title",CommonUIStrings.l_CommentContent),this.eY.appendChild(da),ja=l.a("div","","CommentTextMeasurementContainer"),Ga=l.a("textarea","",a.a.Lnh+" UIFont"),Ga.rows=1,Ga.cols=50,Ga.style.visibility="hidden",Ga.spellcheck=!1,ja.appendChild(Ga),this.eY.appendChild(ja),2===this.Mu.Qq&&(da.value=this.Mu.text.join("\n")+"\n")):this.u7f();const ya=l.a("div","","CommentFooterRow"),ta=l.a("span",this.nfa("cf"),""),ua=r.a.cWa(this.nfa("cr"),a.a.czk+" CommentFooterButton",CommonUIStrings.l_CommentReplyButton,
"CommentReply_16x16x32",!1);ua.tabIndex=0;ua.setAttribute(L.a.Ah,L.a.n1);ta.appendChild(ua);const Sa=r.a.cWa(this.nfa("cd"),"CommentDoneButton CommentFooterButton",CommonUIStrings.l_CommentDoneButton,"CheckboxUnchecked_16x16x32",!1);Sa.tabIndex=0;const ka=Sa.childNodes[0].childNodes[0];ta.appendChild(Sa);const ha=r.a.cWa(this.nfa("cx"),a.a.Hyk+" CommentFooterButton",CommonUIStrings.l_CommentDeleteButton,"Delete_16x16x32",!1);Sa.tabIndex=0;ta.appendChild(ha);ya.appendChild(ta);const Ca=l.a("span",
this.nfa("cfa"),""),Pa=r.a.cWa(this.nfa("cs"),a.a.dzk,CommonUIStrings.l_CommentSaveCommentButton,null);r.a.TIb(Pa,!1);Pa.tabIndex=0;Ca.appendChild(Pa);ya.appendChild(Ca);this.hOi(ia,ta,Ca,ka,Y);this.Mu.sq.Gqh||(fa.setAttribute("Unselectable","on"),sa.setAttribute("Unselectable","on"));Y.appendChild(ca);Y.appendChild(this.eY);Y.appendChild(ya);this.W=Y;this.ARa=Sa;this.wme=ka;this.tRa=ha;this.yTa=ua;this.Rxa=Pa;this.ew=da;this.UUb=ja;this.Yxa=Ga;this.swa=ea;this.GDg=ta;this.FDg=Ca;this.$_g=ia;Y=v.AFrameworkApplication.ua.Zy;
ca=v.AFrameworkApplication.ua.$y;Y.mb(F.a.click,this.W,Object(f.a)(this,this.Rui,"onContainerClick"));Y.mb(F.a.KC,this.W,Object(f.a)(this,this.Sui,"onContainerDoubleClick"));ca.mb(F.a.Bh,this.W,Object(f.a)(this,this.Tui,"onContainerKeyPress"));this.ARa&&(Y.mb(F.a.click,this.ARa,Object(f.a)(this,this.REf,"onDoneButtonClick")),this.CAg=ca.Wib(this.ARa,Object(f.a)(this,this.REf,"onDoneButtonClick"),N.a.Ks));this.yTa&&(Y.mb(F.a.click,this.yTa,Object(f.a)(this,this.GGf,"onReplyButtonClick")),this.CWg=
ca.Wib(this.yTa,Object(f.a)(this,this.GGf,"onReplyButtonClick"),N.a.Ks));this.Rxa&&(Y.mb(F.a.click,this.Rxa,Object(f.a)(this,this.bXd,"onSaveButtonClick")),this.WXg=ca.Wib(this.Rxa,Object(f.a)(this,this.bXd,"onSaveButtonClick"),N.a.Ks));this.tRa&&(Y.mb(F.a.click,this.tRa,Object(f.a)(this,this.KEf,"onDeleteButtonClick")),this.zzg=ca.Wib(this.tRa,Object(f.a)(this,this.KEf,"onDeleteButtonClick"),N.a.Ks));this.swa&&(Y.mb(F.a.click,this.swa,Object(f.a)(this,this.jEf,"onCancelButtonClick")),this.Dvg=ca.Wib(this.swa,
Object(f.a)(this,this.jEf,"onCancelButtonClick"),N.a.Ks));da&&(ca.mb(F.a.At,da,Object(f.a)(this,this.GCa,"onKeyEvent")),ca.mb(F.a.Bh,da,Object(f.a)(this,this.GCa,"onKeyEvent")),C.a.ki&&(Y=v.AFrameworkApplication.ua.Efc,Y.mb(F.a.VAc,da,Object(f.a)(this,this.BCa,"onCompositionEvent"),null),Y.mb(F.a.YYb,da,Object(f.a)(this,this.BCa,"onCompositionEvent"),null),Y.mb(F.a.ZYb,da,Object(f.a)(this,this.BCa,"onCompositionEvent"),null)),B.a.instance.mb(F.a.paste,da,Object(f.a)(this,this.VSc,"onPaste")),this.aPn())}fZi(Y){r.a.TIb(this.Rxa,
Y)}nfa(Y){return Y+"_"+this.Mu.id}hOi(Y,ca,fa,sa,ia){switch(this.Mu.NOa){case 0:case 1:this.J3i(Y,0);break;case 2:case 4:Y.style.display="none";break;case 3:Sys.UI.DomElement.addCssClass(ia,"SaveFailure"),Sys.UI.DomElement.addCssClass(ia,"NoReply"),this.J3i(Y,1)}this.Mu.done?(Sys.UI.DomElement.addCssClass(ia,"CommentIsDone"),sa.className=z.getImageClass("CheckboxChecked_16x16x32")):(Sys.UI.DomElement.removeCssClass(ia,"CommentIsDone"),sa.className=z.getImageClass("CheckboxUnchecked_16x16x32"));this.Mu.jCb?
(Sys.UI.DomElement.addCssClass(ia,"NewOrEditComment"),Sys.UI.DomElement.addCssClass(ia,"SelectedComment"),Y.style.display="none",ca.style.display="none",fa.style.display="inline",0===this.Mu.sq.mode&&(this.fZi(!1),r.a.TIb(this.swa,!1))):(1===this.Mu.pga?(Sys.UI.DomElement.addCssClass(ia,"SelectedComment"),Sys.UI.DomElement.removeCssClass(ia,"SelectedParentComment"),ca.style.display=1!==this.Mu.sq.mode||3===this.Mu.NOa||this.Mu.l6b?"none":"inline"):(2===this.Mu.pga?(Sys.UI.DomElement.removeCssClass(ia,
"SelectedComment"),Sys.UI.DomElement.addCssClass(ia,"SelectedParentComment")):(Sys.UI.DomElement.removeCssClass(ia,"SelectedComment"),Sys.UI.DomElement.removeCssClass(ia,"SelectedParentComment")),ca.style.display="inline"),fa.style.display="none")}J3i(Y,ca){I.a.jA(Y);switch(ca){case 0:ca=document.createElement("img");ca.alt=CommonUIStrings.l_CommentProgressTooltip;ca.src=u.a.y9("progress16.gif");Y.appendChild(ca);break;case 1:ca=z.createClusteredImage(16,16,"Risks_16x16x32","",!0,CommonUIStrings.l_CommentFailTooltip),
Y.appendChild(ca)}Y.style.display="inline-block"}u7f(){I.a.YY(this.eY);var Y=this.Mu.text;1===Y.length&&Y[0]&&(Y=Y[0].split("\n"));for(const ca of Y)Y=l.a("p","","CommentContentPara"),Y.innerText=ca||"\u00a0",this.Mu.sq.Gqh||Y.setAttribute("Unselectable","on"),this.eY.appendChild(Y)}aPn(){const Y=K.FocusManager.instance().pe(a.a.KAc);Y.parent=w.AFrame.fr;G.a.instance.Cpd(a.a.KAc,this.ew);Y.bindAction(H.KeyInputManager.mc(N.a.Jee,2),P.a.Bg);Y.bindAction(this.oY,P.a.CWe);Y.bindAction(H.KeyInputManager.mc(N.a.N7,
0),P.a.JWa);Y.bindAction(H.KeyInputManager.mc(N.a.gha,0),P.a.JWa);Y.Ar(K.FocusManager.instance().uV);Y.Ar(K.FocusManager.instance().vV)}Rui(Y){if(this.Mu.jCb&&Y.Ib.target===this.ew)return!0;this.Mu.XGf();return!0}Sui(){this.Mu.svi();return!0}Tui(Y){let ca=!1;Y.Ib.keyCode===N.a.Ks&&(0===this.Mu.pga?this.Mu.XGf():this.Mu.svi(),ca=!0);return ca}KEf(){if(this.tRa.disabled)return!0;this.Mu.Afa();return!0}REf(){if(this.ARa.disabled)return!0;this.Mu.uWm();return!0}GGf(){if(this.yTa.disabled)return!0;this.Mu.tUm();
return!0}bXd(){if(this.Rxa.disabled)return!0;this.Mu.WFb(this.ew.value);return!0}jEf(){if(this.swa.disabled)return!0;this.Mu.AFb();return!0}GCa(Y){if(Y.Ib.ctrlKey&&Y.Ib.keyCode===N.a.Ks)return 0<this.ew.value.length&&this.bXd(null),!0;if(Y.Ib.keyCode===N.a.L3)return!0;this.onTextEntered(Y.eventName===F.a.At&&Y.Ib.charCode===N.a.Ks);return!1}BCa(){this.onTextEntered(!1);return!1}VSc(){const Y=new J.a(0,1,0,()=>{this.onTextEntered(!1)},1);v.AFrameworkApplication.uc.$b(Y);return!1}onTextEntered(Y){if(0!==
this.Mu.sq.mode&&(this.fZi(0<this.ew.value.length),!C.a.pta)){this.UUb.clientWidth!==this.ew.clientWidth&&(this.UUb.style.width=this.ew.clientWidth+"px");this.Yxa.value=this.ew.value+"___";this.bVg>this.ew.value.length&&(this.Yxa.rows=1);for(var ca=0,fa=Number.MAX_VALUE;1<=(ca=this.Yxa.scrollHeight-this.Yxa.clientHeight)&&ca<fa;)fa=ca,this.Yxa.rows++;this.Yxa.rows<this.ITd?this.ew.rows=this.ITd:(Y&&this.Yxa.rows++,this.ew.rows=this.Yxa.rows);this.bVg=this.ew.value.length}}static xOk(Y,ca,fa){if(!Y||
isNaN(Y.getDate()))return"";let sa=fa;const ia=new Date;if(ia.getFullYear()!==Y.getFullYear()||ia.getMonth()!==Y.getMonth()||ia.getDate()!==Y.getDate())sa=String.format(CommonUIStrings.l_CommentLongDateFormat,ca,fa);return Y.localeFormat(sa)}}Object(D.a)(W,"CommentViewObject",null,[10,1082]);var X=d(121);d.d(M,"Comment",function(){return V});class V{constructor(Y,ca,fa,sa,ia,ea,da,ja,Ga=!1,ya=null,ta=null,ua=null){this.dtg=this.etg=this.WAg=null;this.okd=0;this.Y8a=2;this.ywa=0;this.Cme=this.eN=null;
this.Hqf=!1;this.objectId=null;this.l6b=!1;this._id=Y;this.dFg=ca;this.Rtg=fa;this.F8c=sa;this.cjd=ia;this.iGa=ea;this.jV=da;this.bFg=ja;this.pph=Ga;this.Xuj=ya;this.Yuj=ta;this.usersByReactionType=ua;this.$i=m.a.instance}get id(){return this._id}set id(Y){this._id=Y}get author(){return this.TOd?CommonUIStrings.l_RemovedAuthorName:this.Rtg}get authorId(){return this.Xuj}get tXb(){return this.Yuj}get date(){return this.TOd?null:this.F8c}set date(Y){this.F8c=Y}get done(){return this.iGa}set done(Y){this.iGa!==
Y&&(this.iGa=Y,this.eN&&this.eN.Q2c())}get Q0h(){return this.bFg}set Q0h(Y){this.bFg=Y}get Rf(){return this.cjd}set Rf(Y){this.cjd=Y}get text(){return this.jV}set text(Y){this.jV=Y;this.eN&&this.eN.u7f()}get sLa(){return this.dFg}set sLa(Y){this.dFg=Y}get cKa(){return this.WAg}set cKa(Y){this.WAg=Y}get NWb(){return this.etg}set NWb(Y){this.etg=Y}get MWb(){return this.dtg}set MWb(Y){this.dtg=Y}get pga(){return this.okd}set pga(Y){this.okd!==Y&&(this.okd=Y,this.eN&&this.eN.Q2c())}get NOa(){return this.Y8a}set NOa(Y){this.Y8a===
Y||0===this.Y8a&&2===Y||3===this.Y8a||(this.Y8a=Y,this.eN&&this.eN.Q2c())}get Qq(){return this.ywa}set Qq(Y){if(this.ywa!==Y){const ca=this.jCb&&0===Y;this.ywa=Y;ca&&this.eN&&this.eN.M8k()}}get jCb(){return 1===this.ywa||2===this.ywa}get TOd(){return!!this.$i&&this.$i.removePersonalInformation}get containerElement(){return this.eN?this.eN.containerElement:null}get sq(){return this.$i}get Cy(){return this.Cme}set Cy(Y){this.Cme=Y}dispose(){this.eN&&(this.eN.dispose(),this.eN=null)}render(){this.eN=
new W(this);return this.eN.containerElement}W_a(){this.eN&&this.eN.Q2c()}focus(){this.XGf();this.eN.focus();this.jCb&&this.eN.MHh()}toString(){let Y="[null]";this.jV&&0<this.jV.length&&(Y=30<this.jV[0].length?this.jV[0].substr(0,30)+"...":this.jV[0]);return String.format('I:{0} A:{1} T:{2} R:{3} D:{4} "{5}"',this._id||"[null]",this.Rtg||"[null]",this.F8c?this.F8c.toString():"[null]",this.cjd||"[null]",this.iGa,Y)}XGf(){2===this.sq.mode||3===this.sq.mode?this.jCb&&this.eN.MHh():(K.FocusManager.instance().YB(w.AFrame.fr),
1!==this.okd&&this.sq.selectComment(this._id))}svi(){this.sq.P1n&&0===this.ywa&&(K.FocusManager.instance().YB(w.AFrame.fr),this.ywa=2,this.Y8a=0,this.sq.editComment(this,null))}OPm(){3===this.sq.mode&&(K.FocusManager.instance().YB(w.AFrame.fr),this.ywa=0,this.Y8a=2,this.sq.dUe())}Afa(){K.FocusManager.instance().YB(w.AFrame.fr);this.sq.deleteComment(this)}uWm(){this.sq.awb(this,!this.iGa)}tUm(){2!==this.sq.mode&&(K.FocusManager.instance().YB(w.AFrame.fr),this.sq.addReply(this.cjd||this._id,null))}WFb(Y){K.FocusManager.instance().YB(w.AFrame.fr);
this.jV=Array(1);this.jV[0]=Y;1===this.ywa?this.sq.xra(this):this.sq.xab(this)}AFb(){K.FocusManager.instance().YB(w.AFrame.fr);this.sq.waa.JTc&&this.sq.waa.JTc.focus();1===this.ywa?(this.sq.deleteComment(this),this.sq.r4d(this.Rf)):this.OPm()}static Crh(Y,ca,fa,sa){const ia=X.a.create().toString();Y=new V(ia,V.GPl,Y,new Date,ca,!1,[],fa,!1,v.AFrameworkApplication.K.lb("PresenceUserId"),v.AFrameworkApplication.K.lb("PresenceProvider"));Y.ywa=1;Y.Y8a=0;Y.Cme=sa;return Y}}V.GPl=null;V.jBi=-1;Object(D.a)(V,
"Comment",null,[10,220])},1604:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(){this.handler=null}}Object(D.a)(m,"SetAnnotationResultCallbackParameters",null,[])},1605:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{static get oib(){return CommonUIStrings.l_ModernFontPicker_FontInfoPaneTitle}}m.Yyb="fontInfoTaskPane";m.experienceId="modernfontpicker";Object(D.a)(m,"FontInfoPaneConstants",null,[])},1606:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);
class m{constructor(){this.endDate=this.startDate=null}}Object(D.a)(m,"CommentTaskSchedule",null,[])},1607:function(D,M,d){d.d(M,"a",function(){return f});D=d(0);var m=d(67);class f{static get fe(){return null!=f.dhg?f.dhg:f.dhg=new m.a}static P5j(a){f.fe.addHandler(f.Vui,a)}static t6j(a){f.fe.addHandler(f.pxi,a)}}f.Vui="OnCopyComment";f.pxi="OnPasteComment";Object(D.a)(f,"CommentEventsManager",null,[])},1608:function(D,M,d){d.d(M,"a",function(){return m});const m={h7e:"TasksFeatureUsage",q4n:"TaskExperienceDegraded",
Y9d:"TaskCreate",Z9d:"TaskEngagement"}},1610:function(D,M,d){d.d(M,"c",function(){return r});d.d(M,"b",function(){return w});d.d(M,"a",function(){return v});var m=d(79),f=d(8),a=d(2),l=d(35);const r=u=>{if(!u)return null;let z;try{z=l.b(u)}catch(B){z=null,f.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",B)}return z},w=(u,z)=>{let B=[];if(u.breadcrumbs&&0<u.breadcrumbs.length)B=u.breadcrumbs;else{const G=u.service_info;G&&G.friendly_service_name&&
Array.add(B,G.friendly_service_name);u.display_path&&Array.addRange(B,u.display_path)}return B.join(z?" \u00ab ":" \u200f\u00bb ")},v=(u,z=!1)=>{if(!u)return[];if(!u.documents)return f.ULS.sendTraceTag(578352838,202,15,"missing documents object"),[];if(!u.documents.items)return f.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];u=u.documents.items;const B=new m.a;for(let F=0;F<u.length;F++){const K=u[F];var G=K.web_url;if(!G){f.ULS.sendTraceTag(578320064,202,15,"Empty web_url");if(!K.url){f.ULS.sendTraceTag(578140248,
202,15,"Empty url");continue}G=String.format("{0}?web=1",K.url)}const N={};N.DocumentUrl=G;N.MruId=K.mru_id;{G=K;let H=G.title;H?(G.extension&&(H=String.format("{0}.{1}",H,G.extension)),G=H):(f.ULS.sendTraceTag(578352837,202,15,"empty file title"),G="")}N.FileName=G;N.IsPinned=K.is_pinned;N.Path=w(K,a.AFrameworkApplication.isRtl);z&&(N.App=K.app,N.TimeStamp=K.time_stamp);B.add(N)}return B.toArray()}},1611:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{}m.Callback="action";Object(D.a)(m,
"MenuLauncherAsyncTriggerCommandProperties",null,[])},1612:function(D,M,d){var m=this&&this.xO||(Object.create?function(a,l,r,w){void 0===w&&(w=r);Object.defineProperty(a,w,{enumerable:!0,get:function(){return l[r]}})}:function(a,l,r,w){void 0===w&&(w=r);a[w]=l[r]}),f=this&&this.__exportStar||function(a,l){for(var r in a)"default"===r||Object.prototype.hasOwnProperty.call(l,r)||m(l,a,r)};Object.defineProperty(M,"__esModule",{value:!0});f(d(1753),M);f(d(1754),M);f(d(1755),M);f(d(1756),M);f(d(1757),
M);f(d(1758),M);D.exports.TextToImageAnnotation||Object.defineProperty(D.exports,"TextToImageAnnotation",{enumerable:!0,get:function(){return D.exports.TextToImageAnnotation}});D.exports.TextToImageSignal||Object.defineProperty(D.exports,"TextToImageSignal",{enumerable:!0,get:function(){return D.exports.TextToImageSignal}})},1613:function(D,M,d){var m=this&&this.xO||(Object.create?function(a,l,r,w){void 0===w&&(w=r);var v=Object.getOwnPropertyDescriptor(l,r);if(!v||("get"in v?!l.kH:v.writable||v.configurable))v=
{enumerable:!0,get:function(){return l[r]}};Object.defineProperty(a,w,v)}:function(a,l,r,w){void 0===w&&(w=r);a[w]=l[r]}),f=this&&this.__exportStar||function(a,l){for(var r in a)"default"===r||Object.prototype.hasOwnProperty.call(l,r)||m(l,a,r)};Object.defineProperty(M,"__esModule",{value:!0});f(d(1759),M);f(d(1760),M);D.exports.ThemeExtractorAnnotation||Object.defineProperty(D.exports,"ThemeExtractorAnnotation",{enumerable:!0,get:function(){return D.exports.ThemeExtractorAnnotation}});D.exports.ThemeExtractorSignal||
Object.defineProperty(D.exports,"ThemeExtractorSignal",{enumerable:!0,get:function(){return D.exports.ThemeExtractorSignal}})},1614:function(D,M,d){var m=this&&this.xO||(Object.create?function(a,l,r,w){void 0===w&&(w=r);var v=Object.getOwnPropertyDescriptor(l,r);if(!v||("get"in v?!l.kH:v.writable||v.configurable))v={enumerable:!0,get:function(){return l[r]}};Object.defineProperty(a,w,v)}:function(a,l,r,w){void 0===w&&(w=r);a[w]=l[r]}),f=this&&this.__exportStar||function(a,l){for(var r in a)"default"===
r||Object.prototype.hasOwnProperty.call(l,r)||m(l,a,r)};Object.defineProperty(M,"__esModule",{value:!0});f(d(1761),M);f(d(1762),M);D.exports.TableType||Object.defineProperty(D.exports,"TableType",{enumerable:!0,get:function(){return D.exports.TableType}});D.exports.TableTypeAnnotation||Object.defineProperty(D.exports,"TableTypeAnnotation",{enumerable:!0,get:function(){return D.exports.TableTypeAnnotation}})},1616:function(D,M,d){function m(){a||(f.Health.instance.addQosPillar("AsyncCollab"),a=!0)}
d.d(M,"a",function(){return m});var f=d(84);let a=!1},1617:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f,a=0,l=!1){this.kij=!1;this.paragraphNode=f;this.lCf=a;this.kij=l}}Object(D.a)(m,"ReviewActionArgs",null,[])},1624:function(D,M,d){d.d(M,"a",function(){return a});D=d(0);var m=d(49);d(5);var f=d(8);class a{constructor(l,r){this.wzm=()=>{f.ULS.sendTraceTag(39358976,324,50,"ForceSave request was successful in AutoSaveParamsUpdateService.")};this.Rta=(w,v)=>{f.ULS.sendTraceTag(39358977,
324,10,"ForceSave request failed in AutoSaveParamsUpdateService with status code {0}.",v)};this.TPb=r}sVi(l,r,w,v=null,u=null,z=null){if(l){var B=new m.GraphTransaction(0);B.Db(l);l.setValue(r,w);B.dispose();try{this.TPb(15,!1,v||this.wzm,u||this.Rta,z,null,null)}catch(G){f.ULS.sendTraceTag(39358947,324,10,"Error calling ForceSave in TableOfContentsActor.SendSaveRequest. Message: {0}",G.message)}}else f.ULS.sendTraceTag(39358946,324,10,"AutoSaveParametersNode is null in AutoSaveParamsUpdateService.")}}
Object(D.a)(a,"AutoSaveParamsUpdateService",null,[401])},1625:function(D,M,d){d.d(M,"a",function(){return f});D=d(0);var m=d(8);class f{constructor(a){this.Z9i=a}Pd(a,l){if(a){var r=this.Z9i();a();a=this.Z9i();m.ULS.sendTraceTag(0,345,50,`${l}-${a-r}`)}else m.ULS.shipAssertTag(520127454,345,!1)}}Object(D.a)(f,"PerfLogger",null,[499])},1626:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f,a){this.paragraphNode=f;this.state=a}}Object(D.a)(m,"ReviewCompletedArgs",null,[])},
1627:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f,a){this.index=f;this.count=a}}Object(D.a)(m,"DesignerReviewPosition",null,[])},1628:function(D,M,d){d.d(M,"a",function(){return f});D=d(0);var m;(function(a){a[a.empty=0]="empty";a[a.filled=1]="filled"})(m||(m={}));Object(D.b)("BlueDotHighlightContextType",m);class f{constructor(a,l,r=WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionTooltipClick,w=m.empty){this.paragraphNode=a;this.Ryc=l;this.H7n=r;this.ehk=w}}
Object(D.a)(f,"BlueDotHighlightContext",null,[])},1629:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(){this.Xx=this.Ko=this.marginRight=this.marginLeft=this.marginBottom=this.marginTop=0;this.rta=!1;this.fGb=this.JEb=5;this.ZV=this.yC=this.fyk=0}}Object(D.a)(m,"SectionPropertiesData",null,[])},1630:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{}Object(D.a)(m,"PersonaInfo",null,[])},1631:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{}Object(D.a)(m,
"PersonaIdentifiers",null,[])},1632:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);M=d(1101);d=d(1019);class m{}m.c_=[new M.a(1440,1440,1440,1440),new M.a(720,720,720,720),new M.a(1440,1440,1080,1080),new M.a(1440,1440,2880,2880),new M.a(1440,1440,1800,1800)];m.$ma=[new d.a(12240,15840),new d.a(12240,20160),new d.a(10440,15120),new d.a(11907,16839),new d.a(8391,11907)];Object(D.a)(m,"PredefinedPageProperties",null,[])},1634:function(D,M,d){d.d(M,"a",function(){return F});D=d(0);var m=d(192),
f=d(2),a=d(22),l=d(15),r=d(21),w=d(1277),v=d(263),u=d(461),z=d(8),B=d(311),G=d(619);class F{constructor(K,N,H,J,L,I,R,C,P,W,X,V,Y,ca){this.Lq=K;this.Fpb=N;this.Ma=H;this.zp=J;this.Yq=L;this.sD=I;this.V8=R;this.jOb=C;this.gOb=P;this.hOb=W;this.iOb=X;this.x6a=V;this.y6a=Y;this.sdd=ca}build(K,N,H,J){const L=new m.QueryStringBuilder("WordOart.ashx");f.AFrameworkApplication.gja(L);L.Me(B.a.nodeId,N.id.toString());N=r.ImageReader.cCl(N,K.Nc);L.Me(G.a.uxd,N?N.ia(u.a.nDf,""):"");L.Me(G.a.width,this.zp.toString());
L.Me(G.a.height,this.Yq.toString());L.Me(G.a.eUc,this.V8.toString());L.Me(G.a.Grn,w.a[this.Fpb]);N=this.Ma.$("WordEditorImageCropIsEnabled");L.Me(G.a.uuh,N.toString());N&&(L.Me(G.a.top,this.jOb.toString()),L.Me(G.a.bottom,this.gOb.toString()),L.Me(G.a.left,this.hOb.toString()),L.Me(G.a.right,this.iOb.toString()));N=this.Ma.$("WordEditorImageRotateIsEnabled");L.Me(G.a.RRi,N.toString());N&&(L.Me(G.a.angle,this.sD.toString()),L.Me(G.a.flipH,this.x6a?"true":"false"),L.Me(G.a.flipV,this.y6a?"true":"false"));
L.Me(G.a.fKf,H?"true":"false");L.Me(G.a.strict,this.sdd?"true":"false");this.Ma.$("WacWordEditorRenderHighContrastGraphicsIsEnabled")&&this.Lq&&this.Lq.Yjf&&L.Me(G.a.kBb,this.Lq.Yjf);(K=K.Bi())?(L.Me(B.a.fileId,K.Bs),L.Me(B.a.cellId,K.Zl.toString())):z.ULS.sendTraceTag(575522528,322,10,"parentGraphSpace is null. Cannot set FileId and CellId. url: {0}",L.toString());K=a.a.instance.Pa("Box4.IFeatureHelper");K=!!K&&K.isFeatureEnabled(51);L.Me(G.a.qYk,"true");L.Me(G.a.G2l,K.toString());L.Me(G.a.pBh,"true");
K&&L.Me(G.a.jDi,K.toString());L.Me(G.a.J2l,"true");v.a.instance.Lub(L);H&&J&&!l.a.zk&&L.bL(G.a.mab,window.self.devicePixelRatio.toString());L.Me(G.a.Idh,"true");return L.toString()}}Object(D.a)(F,"WordOartEndpointUrlBuilder",null,[])},1635:function(D,M,d){d.d(M,"a",function(){return f});D=d(0);var m=d(17);class f{constructor(a,l){this._id=a;this.Gb=l;this.enk=l.ia(m.a.cfa,0);this.cnk=l.ia(m.a.fma,0)}getId(){return this._id}}Object(D.a)(f,"GraphicsEditorImageContainer",null,[640])},1636:function(D,
M,d){d.d(M,"a",function(){return R});D=d(0);var m=d(59),f=d(2),a=d(130),l=d(192),r=d(21),w=d(483),v=d(1159),u=d(5),z=d(106),B=d(44),G=d(17),F=d(47),K=d(461),N=d(110),H=d(955),J=d(8),L=d(619),I=d(1634);class R{constructor(C,P,W,X,V,Y){this.properties=null;this.Lq=P;this.hj=X;this.Ma=V;this.aB=Y}Ago(C,P,W){C.Aea||(P.setValue(u.a.Dqd,C.T9j),P.setValue(u.a.LAd,C.K0b));this.Qkj(C,P,W)}Bgo(C,P,W){P.setValue(u.a.tGb,C.Tko);r.ImageReader.UFd(P,W.Nc,!1)!==C.WHf&&P.Qg(u.a.rZd,z.a.Bu,z.a.Ima,B.a.Y3a);if(C.fYd)P.setValue(G.a.Baa,
m.a.Of(C.fYd));else{var X=this.$rh(C.WHf,C.XHf,C.extension);W.Nc.Gu(X);P.setValue(G.a.Baa,X.id)}C.Dce?P.setValue(B.a.Y3a,m.a.Of(C.Dce)):C.Ejj&&(X=this.$rh(C.Ejj,C.u9f,C.extension),W.Nc.Gu(X),P.setValue(B.a.Y3a,X.id));P.ia(u.a.sZd,"")!==C.HWc&&(""!==C.HWc?P.setValue(u.a.sZd,C.HWc):P.removeProperty(u.a.sZd));0===C.wza&&0===C.yza&&0===C.xza&&0===C.vza||this.hj.NWf(P,C.yza,C.vza,C.wza,C.xza);void 0!==C.lockAspectRatio?P.setValue(u.a.HW,C.lockAspectRatio):P.setValue(u.a.HW,!1);C.Mhk&&(this.eJb(P,u.a.Sfa,
C.afh),this.eJb(P,u.a.Vma,C.borderStyle),this.eJb(P,u.a.cDa,C.borderColor));void 0!==C.altTextDescription&&P.setValue(u.a.GW,C.altTextDescription);this.eJb(P,F.a.alphaModFix,C.alphaModFix);this.Qkj(C,P,W);C=w.a.instance.lAd(P);P.setValue(u.a.X2,C)}$rh(C,P,W){const X=new H.a(524345);X.setValue(K.a.nDf,C);X.setValue(K.a.F$b,C);X.setValue(B.a.M5k,m.a.Of(C).guid);X.setValue(u.a.g5h,P);X.setValue(K.a.s7e,f.AFrameworkApplication.rootQuerySignature);X.setValue(B.a.sFh,W);return X}Qkj(C,P,W){C.Aea?(this.properties=
P,P.setValue(F.a.Aea,C.Aea),C.Yxc&&P.setValue(F.a.Cqd,C.Yxc),P.setValue(F.a.TAa,C.kpo),P.setValue(F.a.UAa,C.QVl),P.setValue(F.a.vYa,C.d0b),P.setValue(u.a.gq,C.gq),P.setValue(u.a.dyb,C.T_b),P.setValue(B.a.wZ,0),P.setValue(N.a.d3,0),this.eJb(P,F.a.rfb,C.l7b),this.q6g(P,W,!1,!0),this.Utk(P)):(P.setValue(u.a.kBa,C.kBa),P.setValue(z.a.Bu,C.kBa?C.f3m:""),C.mab&&P.setValue(z.a.t4b,C.mab),P.setValue(u.a.gq,C.gq),P.setValue(u.a.dyb,C.T_b),P.setValue(u.a.X2,C.Ebb),P.setValue(G.a.cfa,a.a.jF(C.width)),P.setValue(G.a.fma,
a.a.jF(C.height)),P.setValue(B.a.lDi,a.a.jF(C.width)),P.setValue(B.a.kDi,a.a.jF(C.height)),P.setValue(z.a.jBa,-1),P.setValue(z.a.iBa,-1),P.setValue(G.a.Wea,!0),P.setValue(u.a.YJ,C.rotationAngle),P.setValue(B.a.wZ,0),C.kBa&&this.q6g(P,W,!0,!1),this.Vtk(P));5!=r.ImageReader.tl(P)?this.Xtk(P):this.Ttk(P);this.eJb(P,u.a.VJc,C.flipH);this.eJb(P,u.a.dKc,C.flipV)}nsn(C,P,W,X,V=null){C=this.hj.isn(C.tk,P,W,X);null==C?J.ULS.sendTraceTag(561538391,3001,10,"Failed to replace picture properties"):V&&V(C)}q6g(C,
P,W,X){let V=!1;const Y=this.aB.gu(P);Y&&Y.Og(u.a.msf)&&(V=!0);P=(new I.a(this.Lq,r.ImageReader.tl(C),this.Ma,r.ImageReader.nA(C),r.ImageReader.zB(C),r.ImageReader.oZ(C),r.ImageReader.Cdb(C),Math.max(r.ImageReader.Xka(C),0),Math.max(r.ImageReader.Uka(C),0),Math.max(r.ImageReader.Vka(C),0),Math.max(r.ImageReader.Wka(C),0),r.ImageReader.$Ed(C),r.ImageReader.Ozb(C),V)).build(P,C,!0,!1);X&&(X=new l.QueryStringBuilder(P),X.Me(L.a.NKd,"true"),P=X.toString());C.setValue(u.a.ybb,P);W&&v.a.gJb(C,1,f.AFrameworkApplication.K,
this.Lq)}eJb(C,P,W){void 0===W||null===W?C.removeProperty(P):C.setValue(P,W)}Vtk(C){C.removeProperty(F.a.Aea);C.removeProperty(F.a.Cqd);C.removeProperty(F.a.TAa);C.removeProperty(F.a.UAa);C.removeProperty(F.a.vYa);C.removeProperty(F.a.LLm);C.removeProperty(F.a.kXk);C.removeProperty(F.a.rfb)}Xtk(C){C.removeProperty(u.a.rZd);C.removeProperty(u.a.tGb);C.removeProperty(G.a.Baa);C.removeProperty(u.a.sZd)}Ttk(C){C.removeProperty(u.a.LAd);C.removeProperty(u.a.Dqd);C.removeProperty(F.a.Aea);C.removeProperty(F.a.Cqd)}Utk(C){C.removeProperty(u.a.Dqd);
C.removeProperty(z.a.Bu);C.removeProperty(G.a.cfa);C.removeProperty(G.a.fma);C.removeProperty(u.a.X2);C.removeProperty(z.a.Ima);C.removeProperty(u.a.LAd);C.removeProperty(u.a.YJ)}}Object(D.a)(R,"GraphicsEditorImageEditor",null,[633])},1641:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(){this.vetoPillar=this.crewAlias=this.featureName=this.topLevelKpiName=null}}Object(D.a)(m,"FeatureUsageAndHealthConfig",null,[])},1644:function(D,M,d){d.d(M,"a",function(){return f});D=
d(0);M=d(245);var m=d(125);class f extends M.a{constructor(){super();this.CellId=this.FileId=null}Wl(){return 37}static construct(a){const l=new f;l.FileId=a.Bi().Bs;l.CellId=m.a(a.Nc.id);return l}}Object(D.a)(f,"LastSavedRevisionRequest",M.a,[])},1667:function(D,M,d){d.d(M,"a",function(){return B});D=d(0);var m=d(59),f=d(11),a=d(14),l=d(8),r=d(18),w=d(1496),v=d(1489),u=d(1491),z=d(1497);class B{constructor(G,F,K,N,H,J,L){this.fvi=(I,R)=>{R&&R.data&&R.data.Ox&&(I=new z.a(R.data.Ox,1,!0),this.vle.MX(I))};
this.cyi=(I,R)=>{R&&R.data&&R.data.Ox&&R.data.Ox.node&&this.zzj.lri(this.vle,R.data.Ox.node)};this.hcc=(I,R,C)=>{I=R.view.Be?R.view:null;if(!I||!I.Cb)return 8;I=I.Cb.ib.J(0).Qa;return f.ParagraphReader.oc(I.node)?1===C?32:2===C?(C=new z.a(I,2,!1),this.vle.MX(C),32):2:2};this.KZb=(I,R,C)=>{var P,W;I=R.view.Be?R.view:null;if(!I||!I.Cb)return 8;I=null===(P=I.Cb.ib.J(0))||void 0===P?void 0:P.Qa;return I&&I.node?f.ParagraphReader.oc(I.node)?1===C?32:2===C?(C=I.node,P=f.ParagraphReader.text(I.node),R=I.cpBegin,
I=I.cpEnd-R,0<I&&(P=P.substr(R,I)),I=Math.floor(Math.random()*B.BSi),R=m.a.create(),l.ULS.sendTraceTag(541446531,3016,50,"Create Pull Quote invoked from context menu. PullQuote info: {0}; Document info: {1}",{["suggestionId"]:R,["textLength"]:P.length,["paragraphLength"]:f.ParagraphReader.textLength(C),["paragraphRole"]:null===(W=this.ZO.qF(C))||void 0===W?void 0:W.role,["styleId"]:I},this.qKj.LHc()),W=[new w.c(new v.d(R,3,null,null,!1,I,P),C,I,P,X=>{this.QOb.YVc(u.a.create(X));this.QOb.jbc({role:27,
paragraphNode:X,placeholder:!1})},3)],this.ZPj.crd(W),32):2:2:8};this.ga=G;this.vle=F;this.zzj=K;this.QOb=N;this.ZPj=H;this.ZO=J;this.qKj=L}initialize(){this.ga.gb(r.a.hcc,a.a.view,this.hcc,1028);this.QOb.N6j(this.cyi);this.QOb.L5j(this.fvi);this.ga.gb(r.a.KZb,a.a.view,this.KZb,4)}dispose(){this.ga.Vy(r.a.KZb,a.a.view,this.KZb);this.QOb.Apn(this.fvi);this.QOb.Tpn(this.cyi);this.ga.Vy(r.a.hcc,a.a.view,this.hcc)}}B.BSi=5;Object(D.a)(B,"DesignerActionListener",null,[1017,10])},1670:function(D,M,d){d.d(M,
"a",function(){return m});D=d(0);class m{}m.seen="Seen";m.kept="Kept";m.rejected="Rejected";Object(D.a)(m,"CritiqueAction",null,[])},1679:function(D,M,d){var m=d(0),f=d(1741),a=d(385),l=d(609),r=d(59),w=d(22),v=d(1887),u=d(2),z=d(83),B=d(80),G=d(1557),F=d(149);class K{constructor(Aa,Wa){this.CommentId=Aa;this.ResolveState=Wa}}Object(m.a)(K,"CommentProperties",null,[]);var N=d(570),H=d(1889),J=d(1890),L=d(1593),I=d(195),R=d(1739);class C extends R.a{constructor(Aa,Wa="",$b="",xc="",bd=!1){super(Aa,
Wa,$b,xc,bd);this.DateUtc=null}}Object(m.a)(C,"CommentReactionUser",R.a,[]);var P;(function(Aa){Aa[Aa.like=1]="like"})(P||(P={}));Object(m.b)("ReactionType",P);var W;(function(Aa){Aa[Aa.first=0]="first";Aa[Aa.done=0]="done";Aa[Aa.undone=1]="undone";Aa[Aa.addComment=2]="addComment";Aa[Aa.deleteComment=3]="deleteComment";Aa[Aa.editComment=4]="editComment";Aa[Aa.addReaction=5]="addReaction";Aa[Aa.removeReaction=6]="removeReaction";Aa[Aa.last=7]="last"})(W||(W={}));Object(m.b)("CommentChangeType",W);
var X=d(205),V=d(583),Y=d(244);class ca{constructor(){this.eZg=this.w0g=!1;this.PWj=[]}get dgc(){return this.PWj}get oKb(){return this.w0g}set oKb(Aa){this.w0g=Aa;for(const Wa of this.dgc)Wa.oKb=Aa}get aJb(){return this.eZg}set aJb(Aa){this.eZg=Aa;for(const Wa of this.dgc)Wa.aJb=Aa}s3a(Aa){for(const Wa of this.dgc)Aa=Wa.s3a(Aa);return Aa}}Object(m.a)(ca,"AggregateCommentTaskPersonTransformer",null,[908]);var fa=d(8),sa=d(121),ia=d(1554);class ea{constructor(Aa,Wa){this.mJj=new Y.a(()=>Wa.s3a(Aa.value))}dnl(){return new Date}bWa(Aa,
Wa,$b){if(0===Aa)throw fa.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),Error.argument("recordType");const xc=sa.a.create().toString();$b=new ia.a(Aa,this.mJj.value,$b,xc,!1);$b.commentId=Wa;fa.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",Aa);return $b}}Object(m.a)(ea,"HistoryRecordFactory",null,[910]);var da=d(1606);class ja{constructor(Aa,Wa,$b,xc,bd,Wd){this.isLossy=
Aa;this.title=Wa;this.assignees=$b;this.schedule=xc;this.completion=bd;this.priority=Wd}}Object(m.a)(ja,"CommentTaskState",null,[]);class Ga{constructor(){this.commentId=null}}Object(m.a)(Ga,"HistoryItem",null,[]);class ya{constructor(Aa,Wa,$b,xc,bd,Wd,vf){this.wse=!1;if(1!==Wa.type)throw Error.argument("createRecord");this.olc=$b;this.llc=xc;this.mlc=bd;this.qQg=1;this.kbd=Aa;this.pLj=Wd;this._state=new ja(!1,this.olc,vf,new da.a,this.mlc,this.llc);this._history=[];this.Qsh(Wa)}OZb(Aa,Wa){if(1!==
Aa.type)throw Error.argument("createRecordTemplate");const $b=ya.PIl(Aa,this.qQg);this.qQg++;return Object.assign(new ia.a(Wa,Aa.user,Aa.time,$b),{commentId:Aa.commentId})}get gii(){return this.history[this.history.length-1]}get d2h(){return this.state.completion===this.mlc}get c2h(){return this.state.priority===this.llc}get e2h(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get f2h(){return this.state.title===
this.olc}Qsh(Aa){Aa=Object.assign(new Ga,{commentId:Aa.commentId,records:[Aa]});this.history.push(Aa)}NKh(Aa){let Wa=-1;for(let $b=0;$b<this.state.assignees.length;$b++)if(this.kbd.equals(this.state.assignees[$b],Aa)){Wa=$b;break}return Wa}NPn(Aa){const Wa=this.gii,$b=Wa.records[Wa.records.length-1];return this.kbd.equals($b.user,Aa.user)&&Wa.commentId===Aa.commentId&&$b.time.getTime()===Aa.time.getTime()?!0:!1}Lko(Aa){switch(Aa.type){case 2:-1===this.NKh(Aa.assignee)&&this.state.assignees.push(Aa.assignee);
break;case 3:const Wa=this.NKh(Aa.assignee);0<=Wa&&this.state.assignees.splice(Wa,1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=Aa.schedule;break;case 6:this.state.completion=Aa.completion;break;case 9:this.state.title=Aa.title;break;case 10:this.state.priority=Aa.priority;break;case 0:this.state.isLossy=!0;break;case 1:fa.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.wse=!0;break;case 8:this.wse=!1;break;case -1:fa.ULS.sendTraceTag(51139905,
327,10,"Undo record passed for state evaluation");break;default:this.state.isLossy=!0}Aa.isLossy&&(this.state.isLossy=!0);this.NPn(Aa)?this.gii.records.push(Aa):this.Qsh(Aa)}get isDeleted(){return this.wse}get state(){return this._state}get history(){return this._history}zsl(Aa){if(!Aa)return this.history;const Wa=Array.clone(this.history),$b=Wa[0],xc=$b.records.shift();if(!this.pLj){var bd=this.OZb(xc,4);$b.records.unshift(bd)}!Aa.d2h&&this.d2h&&(bd=this.OZb(xc,6),bd.completion=this.mlc,$b.records.unshift(bd));
!Aa.c2h&&this.c2h&&(bd=this.OZb(xc,10),bd.priority=this.llc,$b.records.unshift(bd));!Aa.e2h&&this.e2h&&(bd=this.OZb(xc,5),bd.schedule=new da.a,$b.records.unshift(bd));!Aa.f2h&&this.f2h&&(bd=this.OZb(xc,9),bd.title=this.olc,$b.records.unshift(bd));Aa.isDeleted&&(Aa=this.OZb(xc,8),$b.records.unshift(Aa));return Wa}static PIl(Aa,Wa){return"Synthesized-"+Aa.recordId+"-"+Wa}}Object(m.a)(ya,"CommentTaskStateBuilder",null,[]);class ta{constructor(Aa,Wa,$b,xc){this.id=Aa;this.commentId=Wa;this.currentState=
$b;this.history=xc}}Object(m.a)(ta,"CommentTaskItem",null,[]);var ua=d(1553);const Sa=Aa=>{const Wa=new ua.a(Aa.UserId,Aa.Provider,Aa.DisplayName,Aa.Email);Wa.IsCurrentUser=Aa.IsCurrentUser;return Wa};var ka=d(1736);class ha{static clone(Aa){Aa=ha.ywk(Aa.extensions);return new ka.a(Aa)}static gmh(Aa){return Aa?ha.clone(Aa):null}static isEmpty(Aa){return!Aa.extensions||!Aa.extensions.count}static nf(Aa){return!Aa||ha.isEmpty(Aa)}static ywk(Aa){if(!Aa)return null;const Wa=new a.a;Aa.forEach(($b,xc)=>
{Wa.add($b,xc);return!0});return Wa}}Object(m.a)(ha,"ExtensionListExtensions",null,[]);class Ca{static clone(Aa){var Wa=Sa(Aa.user);Wa=new ia.a(Aa.type,Wa,Aa.time,Aa.recordId,Aa.isLossy);Wa.commentId=Aa.commentId;Wa.anchorExtensionList=ha.gmh(Aa.anchorExtensionList);Wa.recordExtensionList=ha.gmh(Aa.recordExtensionList);Aa.assignee&&(Wa.assignee=Sa(Aa.assignee));if(Aa.schedule){var $b=Aa.schedule;const xc=new da.a;xc.startDate=$b.startDate;xc.endDate=$b.endDate;Wa.schedule=xc}Wa.completion=Aa.completion;
Wa.title=Aa.title;Wa.priority=Aa.priority;Wa.undoId=Aa.undoId;return Wa}}Object(m.a)(Ca,"HistoryRecordExtensions",null,[]);class Pa{constructor(Aa,Wa,$b,xc,bd,Wd,vf,uf=!1){this.kbd=Aa;this.yhd=Wa;this.YHa=$b;this.hyj=xc;this.olc=bd;this.llc=Wd;this.mlc=vf;this.Wcd=uf}ZLk(Aa,Wa,$b,xc=null){if(!Aa)throw fa.ULS.sendTraceTag(42796181,327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!Wa)throw fa.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");
if(!$b||!$b.length)throw fa.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==$b[0].type)throw fa.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var bd=[],Wd=null,vf=this.$8m($b);for(var uf of $b)if(!vf.contains(uf.recordId))if($b=this.VZh(uf.commentId,xc),$b=this.Rdl(uf,$b),1===$b.type){let Pe=[];this.Wcd&&Wd&&Wd.state&&(Pe=Wd.state.assignees);Wd=new ya(this.kbd,
$b,this.olc,this.llc,this.mlc,this.Wcd,Pe);bd.push(Wd)}else if(Wd)Wd.Lko($b);else throw fa.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");vf=null;uf=[];if(Wd){Wd.isDeleted||(vf=Wd.state);Wd=null;for(var oe of bd)bd=oe.zsl(Wd),Array.addRange(uf,bd),Wd=oe}oe=this.VZh(Wa,xc);vf&&(vf.completion=this.lAk(Wa,
xc,vf.completion));return new ta(Aa,oe,vf,uf)}xJh(Aa,Wa,$b,xc=null){if(!Wa)throw fa.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if($b&&!Aa)throw fa.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const bd=[],Wd=this.YHa.dnl();if($b){var vf=this.YHa.bWa(1,Aa,Wd);bd.push(vf)}vf=null;if(Wa.assigneeUpdate){if(!Wa.assigneeUpdate.assigneesToAdd||!Wa.assigneeUpdate.assigneesToRemove)throw fa.ULS.sendTraceTag(536999254,
327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var uf=0;uf<Wa.assigneeUpdate.assigneesToAdd.length;uf++){var oe=this.Rsh(2,Wa.assigneeUpdate.assigneesToAdd[uf],Aa,Wd);oe&&bd.push(oe)}for(uf=0;uf<Wa.assigneeUpdate.assigneesToRemove.length;uf++)(oe=this.Rsh(3,Wa.assigneeUpdate.assigneesToRemove[uf],Aa,Wd))&&bd.push(oe)}else Wa.assignee&&($b||(vf=this.YHa.bWa(4,Aa,Wd),bd.push(vf)),uf=this.YHa.bWa(2,Aa,Wd),vf=this.yhd.s3a(Wa.assignee),uf.assignee=vf,bd.push(uf));
Wa.title?(xc=this.YHa.bWa(9,Aa,Wd),xc.title=Wa.title,bd.push(xc)):$b&&xc&&(uf=this.YHa.bWa(9,Aa,Wd),uf.title=this.hyj.zLl(xc,vf),bd.push(uf));if(Wa.schedule){if(Wa.schedule.startDate>Wa.schedule.endDate)throw fa.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");xc=this.YHa.bWa(5,Aa,Wd);xc.schedule=Wa.schedule;bd.push(xc)}if(void 0!==Wa.completion&&null!==Wa.completion){xc=Wa.completion;if(0>xc||100<xc)throw fa.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),
Error.argumentOutOfRange("completion");$b||fa.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",xc);$b=this.YHa.bWa(6,Aa,Wd);$b.completion=xc;bd.push($b)}if(void 0!==Wa.priority&&null!==Wa.priority){Wa=Wa.priority;if(0>Wa||10<Wa)throw fa.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");Aa=this.YHa.bWa(10,Aa,Wd);Aa.priority=Wa;bd.push(Aa)}return bd}Rsh(Aa,Wa,$b,xc){if(2!==Aa&&3!==Aa)return fa.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),
null;Aa=this.YHa.bWa(Aa,$b,xc);Aa.assignee=this.yhd.s3a(Wa);return Aa}$8m(Aa){const Wa=new l.a,$b=new l.a;for(let xc=Aa.length-1;0<=xc;xc--){const bd=Aa[xc],Wd=$b.contains(bd.recordId);Wd||-1!==bd.type||($b.contains(bd.undoId)?fa.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):$b.add(bd.undoId));if(Wd||-1===bd.type)Wa.contains(bd.recordId)?fa.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):
Wa.add(bd.recordId)}return Wa}Rdl(Aa,Wa){const $b=Ca.clone(Aa);$b.commentId=Wa;$b.user=this.yhd.s3a(Aa.user);$b.assignee=this.yhd.s3a(Aa.assignee);return $b}lAk(Aa,Wa,$b){let xc=$b;Aa&&Wa&&(({value:Wa}=Wa.Dc(Aa)).returnValue?(xc=Wa.ResolveState?100:100===$b?0:$b,xc!==$b&&fa.ULS.sendTraceTag(592719873,327,50,"Task completion state has been changed to match comment resolution state for comment {0}",Aa)):fa.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",
Aa));return xc}VZh(Aa,Wa){let $b=Aa;Aa&&Wa&&(({value:Wa}=Wa.Dc(Aa)).returnValue?$b=Wa.CommentId:(fa.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",Aa),$b=Aa));return $b}}Object(m.a)(Pa,"CommentTaskTranslatorImpl",null,[909]);var Xa=d(991),qa=d(1191);class Ea{constructor(){this.Fbb=CommonUIStrings.l_Ellipsis}zLl(Aa,Wa){if(!Aa)throw fa.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");
try{var $b=G.a.V1b(Aa)}catch(oe){throw fa.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var xc=Aa=0,bd=0;const Wd=RegExp("\\s+","g"),vf=new Sys.StringBuilder;for(var uf of $b.ops)uf.attributes&&uf.attributes.atmention&&uf.attributes.atmention.email&&Wa&&($b=uf.attributes.atmention.email,0<$b.length&&($b===Wa.UserId||$b===Wa.Email||$b===Xa.a.dcb(Wa.UserId))&&(xc=Aa,bd=xc+uf.insert.length)),$b=uf.insert.replace(Wd,
" "),Aa+=$b.length,vf.append($b);!bd&&Wa&&fa.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",Wa.Provider);Wa=vf.toString().trimEnd();Aa=Wa.length;255<Aa?(uf=(255-(bd-xc))/2,0>xc-uf?(Aa=qa.a.instance.xXa(Wa,255-this.Fbb.length),bd=Wa.substring(0,Aa)+this.Fbb,Aa="Trimmed End"):bd+uf>Aa?(xc=qa.a.instance.MXa(Wa,Aa-255+this.Fbb.length),bd=this.Fbb+Wa.substring(xc,Aa),Aa="Trimmed Start"):(xc=qa.a.instance.MXa(Wa,xc-uf+this.Fbb.length),Aa=qa.a.instance.xXa(Wa,bd+uf-this.Fbb.length),
bd=this.Fbb+Wa.substring(xc,Aa)+this.Fbb,Aa="Trimmed Both")):(Aa="No Trim",bd=Wa);fa.ULS.sendTraceTag(592998804,327,50,Aa);return bd}}Object(m.a)(Ea,"ContentExtractor",null,[]);class Ia{constructor(Aa,Wa){this.lFj=Aa;this.pJj=Wa;this.aJb=this.oKb=!1}s3a(Aa){if(!Aa)return null;if(void 0===Aa.UserId||null===Aa.UserId)throw fa.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(Aa.IsCurrentUser||!this.lFj.equals(this.pJj.value,Aa))return Aa;Aa=Sa(Aa);Aa.IsCurrentUser=
!0;return Aa}}Object(m.a)(Ia,"EnsureIsCurrentUserSetTransformer",null,[908]);class na{constructor(){this.aJb=this.oKb=!1}s3a(Aa){if(!Aa)return null;if(void 0===Aa.UserId||null===Aa.UserId)return Aa;if(!Aa.Email||""===Aa.Email){let Wa;if(Wa=Xa.a.dcb(Aa.UserId))return Aa=Sa(Aa),Aa.Email=Wa,Aa}return Aa}}Object(m.a)(na,"RestoreEmailTransformer",null,[908]);class Na{constructor(){this.aJb=this.oKb=!1}s3a(Aa){if(!Aa)return null;if(void 0!==Aa.UserId&&null!==Aa.UserId)return Aa;switch(this.oKb?this.aJb?
2:1:0){case 0:if(void 0===Aa.UserId||null===Aa.UserId)throw fa.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");Aa=Sa(Aa);break;case 1:if(void 0===Aa.Id||null===Aa.Id)throw fa.ULS.sendTraceTag(593368214,327,10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===Aa.Email||null===Aa.Email)throw fa.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var Wa=Na.aCi(Aa.Id,Aa.Email,null);if(!Wa||""===Wa)throw fa.ULS.sendTraceTag(593368212,
327,10,"Failed to generate UserId"),Error.argument("UserId");var $b=u.AFrameworkApplication.K.lb("HostAuthType")||"";if("aad"!==$b.toLowerCase()||Wa.startsWith("S::")){if("msa"===$b.toLowerCase())throw fa.ULS.sendTraceTag(593368210,327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");fa.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",$b)}else throw fa.ULS.sendTraceTag(593368211,327,10,"Unexpected UserID format"),Error.argument("userId");
Aa=new ua.a(Wa,"AD",Aa.DisplayName,Aa.Email);break;case 2:if(void 0===Aa.UserPrincipalName||null===Aa.UserPrincipalName)throw fa.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");if(void 0!==Aa.SuggestionSubtype&&null!==Aa.SuggestionSubtype)if("OrganizationUser"===Aa.SuggestionSubtype)Wa="AD";else throw fa.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",Aa.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");
else throw fa.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");$b=Na.aCi(Aa.Id,Aa.UserPrincipalName,Aa.AadObjectId);if(!$b||""===$b)throw fa.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),Error.argument("UserId");if("AD"===Wa&&!$b.startsWith("S::"))throw fa.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");Aa=new ua.a($b,Wa,Aa.Name,Aa.UserPrincipalName);break;default:throw fa.ULS.sendTraceTag(593368203,
327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return Aa}static aCi(Aa,Wa,$b){if(!Wa||""===Wa)return fa.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),Aa;if($b&&""!==$b)return"S::"+Wa+"::"+$b;if(!Aa||""===Aa)return fa.ULS.sendTraceTag(593368217,327,50,"Missing ID"),Aa;if(Aa.startsWith("S::"))return Aa;if(-1!==Aa.indexOf("@")){$b=Aa.split("@");if(sa.a.Qd($b[0]))return"S::"+Wa+"::"+$b[0];fa.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return Aa}}
Object(m.a)(Na,"UserIdCanonicalizationTransformer",null,[908]);class Oa{constructor(Aa,Wa,$b=!1,xc=!1){this.MAj=Aa;this.Fvg=Wa;this.aKj=$b;this.Wcd=xc}vGk(){const Aa=new Xa.a;var Wa=new Y.a(Oa.Eml);const $b=new ca;this.Fvg&&($b.dgc.push(new Na),$b.dgc.push(new na));this.MAj&&$b.dgc.push(new Ia(Aa,Wa));$b.oKb=this.Fvg;$b.aJb=this.aKj;Wa=new ea(Wa,$b);const xc=new Ea;return new Pa(Aa,$b,Wa,xc,Oa.APk,Oa.pPk,Oa.qPk,this.Wcd)}static Eml(){const Aa=new ua.a(u.AFrameworkApplication.K.lb("PresenceUserId")||
"",u.AFrameworkApplication.K.lb("PresenceProvider")||"",u.AFrameworkApplication.userName||"");Aa.IsCurrentUser=!0;return Aa}}Oa.APk="";Oa.pPk=5;Oa.qPk=0;Object(m.a)(Oa,"CommentTaskTranslatorFactory",null,[899]);var Ra=d(57),ab=d(201),zb=d(13),Qa=d(6),yb=d(53),lb=d(9),Eb=d(180),bc=d(54),Pb=d(24),Va=d(714),oa=d(45),pa=d(19),Ya=d(11),Ja=d(1178),nb=d(33),Bb=d(93),mb=d(298),Qb=d(145),Vb=d(291),mc=d(425),ob=d(697),cb=d(389),db=d(76),kb=d(247),Wb=d(14),Fb=d(5),nc=d(688),gc=d(514),Jc=d(373),tb=d(43),dc=d(476),
Yb=d(120),pb=d(82),Gb=d(267),hb=d(1434),Ib=d(35),Ob=d(993);class kc{create(){return new Ob.a}}Object(m.a)(kc,"CommentNodeFactory",null,[200]);var Ac=d(1172),Nc=d(1013),kd=d(1471),Jd=d(1526);class ge{constructor(){this.qEc=this.p0c=null;this.Dzd=this.B8d=!1;this.BJa=this.$ya=null}}Object(m.a)(ge,"CommentAnchorParaNodesStatus",null,[]);var Oc=d(1375),qc=d(17);class Xc extends Oc.a{constructor(Aa){super();this.yQj=Aa}get index(){return 2}run(){this.yQj()}qnh(Aa,Wa){Wa.property===qc.a.rf&&this.kX()}}
Object(m.a)(Xc,"CommentContentPropertyTracker",Oc.a,[]);var xe=d(1462);class Ge{constructor(Aa,Wa){this.Q$b=Aa;this.g8h=Wa}}Object(m.a)(Ge,"CommentIntentIdentifier",null,[]);var bf=d(982),xd=d(1026),ke=d(186),Rf=d(158);class pd extends Oc.a{constructor(Aa,Wa){super();this.i5a=new gc.a(new bf.a);this.pVb=new xd.a(xe.c);this.qVb=new ke.ScriptSharpLegacyMap;this.vMj=Aa;this.wNj=Wa;this.qVb.add(Fb.a.x9,1);this.qVb.add(Fb.a.zG,0);this.qVb.add(qc.a.rf,0);this.qVb.add(Fb.a.C5,2)}get index(){return 4}run(){let Aa=
"";for(let Wa of this.i5a)if(this.vMj(Wa),this.pVb.xb(Wa.id))for(let $b of this.pVb.J(Wa.id))Aa+="_"+$b;this.wNj(Aa);this.i5a.clear();this.pVb=new xd.a(xe.c)}Yyk(Aa,Wa){Aa=Wa.property;if(Aa===Fb.a.x9||Aa===Fb.a.zG||Aa===qc.a.rf||Rf.App.Tce&&Aa===Fb.a.PYb||Aa===Fb.a.C5)this.i5a.add(Wa.node),this.qVb.xb(Aa)&&(this.pVb.xb(Wa.node.id)||this.pVb.add(Wa.node.id,new dc.a),this.pVb.J(Wa.node.id).add(this.qVb.J(Aa))),this.kX();kd.a.ivh.has(Wa.node.id.toString())&&Aa===Fb.a.ZD&&fa.ULS.sendTraceTag(521484097,
327,15,"Durable ID changed of a Cut Pasted Comment")}jzk(Aa,Wa){Wa.property===qc.a.lo&&(Aa=Wa.node,Aa.lCb&&(this.i5a.add(Aa),this.kX()))}x4n(Aa,Wa){this.i5a.add(Wa.node);this.kX()}}Object(m.a)(pd,"CommentNodeTransactionCompletedProcessor",Oc.a,[]);var fe=d(1527),Ec=d(1558);class rd{constructor(){this.Hme=new Map;this.Jpe=new Map}j0j(Aa,Wa){if(this.Hme.has(Aa))throw Error("DuplicateDurableId");if(this.Jpe.has(Wa))throw Error("DuplicateGuardId");this.Hme.set(Aa,Wa);this.Jpe.set(Wa,Aa)}Krl(Aa){return this.Hme.get(Aa)}tol(Aa){return this.Jpe.get(Aa)}}
Object(m.a)(rd,"CommentIdMapper",null,[]);var Ld=d(18),Gf=d(1485),ld=d(1608),Pc=d(1511);d.d(M,"a",function(){return cd});class cd extends f.a{constructor(Aa,Wa,$b,xc,bd,Wd,vf,uf,oe,Pe,We,Xi,zf,sf,Ye,Bh,Sg,Ti,ig,Tg,af,qf,gj,Fe,$e,Ff=null,ye){super();this.px=Aa;this.nwe=Wa;this.iwe=$b;this.Hc=xc;this.wxj=bd;this.zqb=Wd;this.qLe=vf;this.kkc=uf;this.Ma=oe;this.wc=Pe;this.Ls=We;this.NRb=Xi;this.wY=zf;this.DRb=sf;this.gNg=Ye;this.Xe=Bh;this.sm=Sg;this.EQa=Ti;this.sj=ig;this.f4=Tg;this.DM=af;this.iUa=qf;
this.auc=gj;this.pkc=[];this.VQa=[];this.CIe=new a.a(0);this.mjd=new a.a;this.xmd=new gc.a(Jc.a.Pj());this.cIe=new gc.a(Jc.a.Pj());this.m9c=null;this.uob=new a.a;this.ple=!1;this.t7c=new l.a;this.LHg=!1;this.vje=new Set;this.kY=[];this.lPb=2;this.$xa=new a.a(!1);this.wrc=new l.a;this.bmc=new Map;this.uje=new rd;this.o7c=0;this.vxj=5;this.oSc=(Sf,vg)=>{Sf=vg.paragraphNode;for(let Tf of vg.contents)this.yYa(Tf.element,Sf,Tf.intents,Tf.XH)};this.Uti=(Sf,vg)=>{if(Sf.Nc.id.equals(this.Ad.id)){this.EQa.pDa(7);
var Tf=Sf.getValue(Fb.a.zG),wg=Sf.getValue(Fb.a.ZD).toString();Tf=this.Xe.Obb?this.bmc.has(wg)?this.bmc.get(wg):wg:Tf;Tf=this.xB(Tf);if(vg){if(Tf){this.Hy&&this.Hy.Rf===Tf.id&&(fa.ULS.sendTraceTag(592188698,327,50,"Draft lost by parent deletion"),this.DM.logKpiFailure(Gf.a.Pud,"DraftCommentLostOnParentDelete",{isIntentional:!1,isInternal:!0},{name:Gf.a.DWe,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}));vg=Tf.Rf?"The comment is a reply":"";wg=xe.k(Sf,r.a.nil).toString();const rf=xe.h(Sf,
r.a.nil).toString();if(this.t7c.contains(Tf.id)&&!kd.a.o$l(Tf.cKa)){this.t7c.remove(Tf.id);const sh=+new Date-+Tf.date;fa.ULS.sendTraceTag(577307335,327,15,"New session comment deleted by inbound change: {0}. duration: {1}. startParaId: {2}. endParaId: {3}. {4}.",xe.a(Tf),sh,wg,rf,vg)}else fa.ULS.sendTraceTag(50426379,327,50,"{0} deleted by inbound changes. startParaId: {1}. endParaId: {2}. {3}.",xe.a(Tf),wg,rf,vg);this.$i.VCc(Tf);this.Pwh(Sf.id)}}else if(!Tf){this.DM.ensureFeatureDenominatorLoggedAndVetoPillarRegistered();
w.a.instance.Pa("WordEditor.Comments.EditorCommentManager")||fa.ULS.sendTraceTag(525379405,327,10,"comment Manager resolve failed");if(this.Xe.Gxb&&!this.sj.VW){this.f4.fna("OnCommentInit",Object.assign(new fe.a,{Hvi:()=>{this.CEf(Sf);this.EHb()}}));return}this.Xe.uq||this.sj.VW||this.f4.fna("OnCommentInit");this.lbn(Sf)||this.CEf(Sf)}this.ple=!0}};this.EHb=(Sf=null)=>{this.Xe.HKb&&this.s6h();this.Xe.HKb&&this.m0k();this.MJ.GHb(void 0,Sf);this.EQa.pDa(8)};this.fzi=(Sf,vg,Tf)=>{if(Sf.Nc.id.equals(this.Ad.id)){var wg=
Sf.ia(Fb.a.taskId,"");if(""===wg)fa.ULS.sendTraceTag(42856717,3003,10,"Newly added or deleted task node does not have a task id.");else{if(vg)if(this.cIe.add(wg),wg=this.DRb.value.WYh(Sf),void 0!==wg&&null!==wg)this.uob.remove(wg);else{fa.ULS.sendTraceTag(591971722,3003,10,"A task without comment id was deleted even though that shouldn't be possible.");return}else if(this.xmd.add(wg),vg=this.DRb.value,Sf=vg.WYh(Sf),void 0!==Sf&&null!==Sf)for(this.uob.J(Sf)?this.uob.Z(Sf,wg):this.uob.add(Sf,wg),Sf=
vg.YYh(wg),vg=0;vg<Sf.length;vg++){var rf=Sf[vg].commentId;rf&&(rf=Number.parseInvariant(rf),this.uob.J(rf)||this.uob.add(rf,wg))}else{fa.ULS.sendTraceTag(591971723,3003,10,"A task without comment id was added or modified even though that shouldn't be possible.");return}Tf&&this.EHb()}}};this.Weo=Sf=>{if(kd.a.NMd(Sf)){const Tf=this.nZ(Sf.id.toString());if(Tf){const wg={text:Tf.text,done:Tf.done};var vg=Qa.GraphIterator.$a(Sf);Tf.text=this.vzb(vg);Tf.done=Sf.ia(Fb.a.x9,!1);this.Xe.y$a&&Sf.hasProperty(Fb.a.C5)&&
(vg=(vg=Sf.getValue(Fb.a.C5))?Ib.b(vg||""):null,Tf.usersByReactionType=vg,Pc.a.qkh(Tf.usersByReactionType),this.Msk(Tf));this.Zeo(Sf,Tf);Tf.Rf||this.dfo(Sf,Tf);!this.Xe.wra||!this.XM||this.Hy&&this.Hy.id===Tf.id||this.XM.fireEvent(10,{comment:Tf,kMm:wg})}}else this.wc.isFeatureEnabled(125)&&72===Sf.type?this.fzi(Sf,!1,!1):this.Yeo(Sf)};this.n0k=()=>{const Sf=this.FDd();for(this.pkc.sort((vg,Tf)=>{const wg=vg.ia(Fb.a.hL,null),rf=Tf.ia(Fb.a.hL,null);if(!wg&&rf)return-1;if(!rf&&wg)return 1;vg.hasProperty(Fb.a.aza)&&
Tf.hasProperty(Fb.a.aza)?(vg=vg.getValue(Fb.a.aza),Tf=Tf.getValue(Fb.a.aza),Tf=vg<Tf):(vg=new Date(vg.getValue(Fb.a.JAc)),Tf=new Date(Tf.getValue(Fb.a.JAc)),Tf=vg<Tf);return Tf?-1:1});this.pkc.length;){const vg=this.pkc[0];Sf.Ydb(vg)&&(Sf.Ci(vg),this.$i.addComment(this.owd(Sf),null),this.$i.mode=1);Array.removeAt(this.pkc,0)}if(Sf.Rb(1))for(;Sf.wf(1););this.wc.isFeatureEnabled(125)&&this.DRb.value.$Yh();this.ple&&(this.EHb(),this.ple=!1)};this.JTk=Sf=>{1===Sf&&(Gb.WoncaApp.k$d.mrh(),this.NRb.value.Mjb(!0,
"CommentInboundFailed"));this.wY.Uw(yb.a.MYe,this.Uhi)};this.gta=Sf=>{if(!this.Xe.uq||Sf.done)return!1;if(Sf.Qq===v.a.beingCreated)return!0;if(Sf.objectId){if(this.$8l(Sf))return!1;if(!this.cem(Sf.objectId)||Sf.Rf)return!0;for(let vg of this.aT())if(vg.Rf===Sf.id)return!0}return!1};cd.dJ=Ff;this.zfd=new gc.a(Jc.a.Pj());!this.Xe.Gxb&&this.Xe.uq||Ob.a.mOa(this.Uti);$e.zWb(this.oSc);Fe&&(Fe.xv((Sf,vg)=>{Sf=xe.o(this.kY,vg.node.id);0<this.kY.length&&(!Sf||Sf===this.kY.length-1)&&(this.lPb=1,this.kY=[])}),
ye.execute(Sf=>{this.XM=Sf}),u.AFrameworkApplication.r2&&(u.AFrameworkApplication.Hf("AutoPopulateShareTUIComment;AutoPopulateShareTUICommentCf"),this.Xe.cfk&&this.u_j()))}u_j(){z.a.instance.$b(new B.a(5,1,0,()=>{const Aa=this.Hc.Rc(7);Aa.Db(this.gFa);var Wa=lb.App.xa.jb.Zc;Wa&&(Wa=Eb.PageNavigator.instance.hT(Wa),Wa=Qa.GraphIterator.$a(Wa),Wa.Wd(),Wa.Wd(),Wa.Wd(),Wa.Wd(),bc.a.instance.setSelection(Pb.SelectionFactory.wN(Wa.currentNode,0,0)),Wa=new G.a,Wa.Kea("Get the conversation going by adding comments and using Share (above) to send a link to this doc. It\u2019s free! No subscription or sign-in necessary. \n"),
this.Ywb(bc.a.instance.ib.kb,"Microsoft Word",Wa),Aa.dispose(),Ra.a("ShareTUICommentCreated"),fa.ULS.sendTraceTag(520728590,327,50,"ShareTUICommentCreated"))}))}get MJ(){return this.$i}get SOe(){return this.Yg}get Uhi(){return null!=this.Llg?this.Llg:this.Llg=Object.assign(new Va.a,{r9:WoncaIntl.WoncaStrings.l_InboundingCommentFailed,zja:1})}get AL(){return this.Hc}get Py(){return this.px.value}get Ad(){return this.Py.Ad}get gFa(){return this.nwe.value}get cza(){return this.iwe.value}get Cb(){return this.zqb.value}get uX(){return this.Ma.lb("PresenceUserId")}get T0a(){return this.Ma.lb("PresenceProvider")}yYa(Aa,
Wa,$b,xc){if($b&&this.Hy&&(!this.Hy||!this.Hy.Rf)){var bd=!1;for(let Wd of $b)if(3===Wd.type)switch(bd=!0,$b=xe.n(this.kY,Wd.id),-1<$b&&(this.kY[$b].Q$b=Wa.id),Aa.classList.add(oa.a.czd),xc){case 1:Aa.classList.add(oa.a.Z3e);break;case 0:Aa.classList.add(oa.a.$3e)}bd||Aa.classList.remove(oa.a.czd,oa.a.$3e,oa.a.Z3e);this.EQa.pDa(3)}}Saf(Aa=!1){return this.qLe.wcl(this.Yg,u.AFrameworkApplication.ya.mode,Wa=>!this.Xe.bKb||!Aa||this.gta(Wa))}yaf(Aa){return this.qLe.lil(this.$i.model.aT(),u.AFrameworkApplication.ya.mode,
Aa)}iff(Aa){if(!Aa||!Aa.Rf)return Aa;Aa=Aa.Rf;for(let Wa=0;Wa<this.Yg.length;Wa++)if(this.Yg[Wa].id===Aa)return this.Yg[Wa];return null}uGk(){const Aa=[];if(this.wc.isFeatureEnabled(125)){var Wa=this.DRb.value;for(let $b of Wa.$Yh())(Wa=this.KJh($b))&&Aa.push(Wa)}return Aa}XZl(Aa){if(!this.VQa)throw F.a.invalidOperation("UpdateContent must have been called before this.");for(let Wa=0;Wa<this.VQa.length;Wa++)if(this.VQa[Wa].id===Aa)return Wa;return-1}s6h(){const Aa=new pb.a;for(let $b of this.Yg)if($b.objectId&&
$b.sLa){var Wa=r.a.Of($b.objectId);if((Wa=this.Ad.Eb(Wa))&&Wa.hasProperty(Fb.a.ZD))if(Wa=Wa.getValue(Fb.a.ZD).toString(),Aa.xb(Wa)){const xc=Aa.J(Wa).CommentId;this.Doj(xc,$b,Wa)}else Aa.add(Wa,new K($b.id,$b.done))}this.m9c=Aa}Doj(Aa,Wa,$b){Aa!==Wa.sLa?(fa.ULS.sendTraceTag(42866777,327,10,"Multiple comments contains the same DurableId [{0}], GuardId [{1}], GuardId of existing entry: {2}",$b,Wa.sLa,Aa),this.DM.logKpiFailure(Gf.a.Kud,"MultipleCommentsWithSameDurableId",{isInternal:!0},{name:Gf.a.Hud,
isInternal:!0})):fa.ULS.sendTraceTag(554297428,327,15,"Duplicate entry of same comment with DurableId [{0}], GuardId [{1}]",$b,Wa.sLa)}KJh(Aa){const Wa=this.gNg.value;var $b=this.DRb.value;const xc=$b.l3b(Aa);if(void 0===xc||null===xc)return fa.ULS.sendTraceTag(592234717,3003,50,"GenerateTaskItemForTaskId was called with a taskId [{0}] that has no comment anchor id.",Aa),null;$b=$b.YYh(Aa);try{return Wa.ZLk(Aa,xc.toString(),$b,this.m9c)}catch(bd){return fa.ULS.sendTraceTag(42856716,3003,10,"CreateTaskItemFromHistoryRecords Failed due to [{0}]",
bd.message),null}}KMh(Aa=!1,Wa=!1){const $b=new l.a,xc=Wa?xe.j():new Set;this.$xa.keys.forEach(bd=>{xc.has(bd)||Aa&&this.$xa.J(bd)||$b.add(bd);return!0});return $b}TFd(){if(!this.Yg)return 0;let Aa=0;for(let Wa of this.Yg)Wa.Rf||Aa++;return Aa}OMc(Aa){var Wa,$b;return(null===($b=null===(Wa=this.Hy)||void 0===Wa?void 0:Wa.Cy)||void 0===$b?void 0:$b.draftId)===Aa}m0j(Aa){var Wa;if(Aa.Qq===v.a.beingCreated){if(this.$i.mode=2,this.Z6a=Aa,this.Cb.ib){var $b=this.Cb.ib.kb;if($b&&$b.Qa){if(pa.SelectionEditor.Km($b)){var xc=
pa.SelectionEditor.Q1($b.Qa,!1);xc&&(this.Cb.setSelection(xc),$b=xc)}for(xc=0;xc<$b.length;xc++){var bd=$b.J(xc).node;if(!Ya.ParagraphReader.oc(bd)||!(-1!==$b.J(xc).cpBegin&&-1!==$b.J(xc).cpEnd||-1!==$b.J(xc).gl&&-1!==$b.J(xc).ot))continue;var Wd=-1===$b.J(xc).cpBegin?$b.J(xc).gl:$b.J(xc).cpBegin;const vf=-1===$b.J(xc).cpEnd?$b.J(xc).ot:$b.J(xc).cpEnd,uf=r.a.create();this.Ls.G8b(bd,new Ja.a(3,Wd,vf,uf));this.kY.push(new Ge(bd.id,uf));this.S0j(null===(Wa=Aa.Cy)||void 0===Wa?void 0:Wa.draftId,bd,Wd,
$b)}}}}else this.ePf(Aa);$b=({index:Wa}=this.uae(Aa)).returnValue;xc=null;if(!Aa.Rf){bd=this.KMh();Aa.Qq!==v.a.beingCreated&&(xc=this.yGl(Aa),bd.remove(Aa.objectId));bd=({index:Wd}=this.Qxl(xc,bd)).returnValue;Wa=-1<Wd?Wd:Wa;Wd=0;if(bd)for(;Wa<this.Yg.length&&this.Yg[Wa].Rf;)Wa++;if(!bd&&this.Xe.uq&&Aa.Qq===v.a.beingCreated)for(bd=0;bd<Wa;bd++)this.Yg[bd].Rf||this.Yg[bd].done||Wd++;this.Z0n(Aa,Wd)}$b&&(Array.insert(this.Yg,Wa,Aa),this.Xe.wra&&this.XM&&Aa.Qq!==v.a.beingCreated&&this.XM.fireEvent(11,
{comment:Aa}),this.p0j(Aa,xc))}S0j(Aa,Wa,$b,xc){this.Xe.contentNavigationApiEnabled&&Aa&&Wa&&xc&&this.auc.BNe({contentId:Aa,containerContentType:0,W6:{Cd:$b,UL:Wa.pn}},{selection:xc})}p0j(Aa,Wa){if(this.Xe.contentNavigationApiEnabled&&Aa&&!Aa.Rf&&Aa.Qq!==v.a.beingCreated){var $b=this.Ad.Eb(Aa.objectId);if($b){var xc=xe.k($b,r.a.nil);xc=this.Ad.Eb(xc);$b=kd.a.zsa(xc,$b.id,!1);(null===$b||void 0===$b?0:$b.Ob)&&(null===$b||void 0===$b?0:$b.paragraph)?this.auc.BNe({contentId:Aa.id,containerContentType:0,
W6:{Cd:$b.Ob.cp,UL:$b.paragraph.pn}},{selection:Wa}):fa.ULS.sendTraceTag(520717896,327,10,`commentStartRangeObject Valid: ${!!$b},
        containingProperties Valid: ${!(null===$b||void 0===$b||!$b.Ob)},
        paragraph valid: ${!(null===$b||void 0===$b||!$b.paragraph)};
        Failed to add to ReviewSuggestionModel`)}}}xra(Aa){super.xra(Aa);this.t7c.add(Aa.id)}Yrn(Aa,Wa){this.Xe.contentNavigationApiEnabled&&this.auc.Xrn(Aa,Wa)}Z0n(Aa,Wa){this.Xe.uq&&Aa.Qq===v.a.beingCreated&&Aa.Cy&&this.CIe.Z(Aa.Cy.draftId,Wa)}rKl(Aa){return this.CIe.J(Aa)}ILi(Aa){this.CIe.remove(Aa)}Btl(Aa){let Wa=0,$b=0;for(let xc=0;xc<this.Yg.length;xc++){if(this.Yg[xc].id===Aa.id){$b=xc;break}this.Yg[xc].Rf||this.Yg[xc].done||Wa++}return{returnValue:$b,a6n:Wa}}dgf(Aa){var Wa=null,$b=this.Ad.Eb(Aa);
Aa=kd.a.Z9($b,this.Ad,!0);$b=kd.a.Z9($b,this.Ad,!1);Aa&&$b&&(Wa=Pb.SelectionFactory.xe(Aa.Ob.paragraph,Aa.Ob.cp),Wa=Pb.SelectionFactory.MC(Wa,nb.a.Uc($b.Ob.paragraph,$b.Ob.cp)));Aa&&$b||this.DM.logKpiFailure(Gf.a.Kud,"ParaNodeNotConnected",{isIntentional:!1,isInternal:!0});return Wa}yGl(Aa){Aa=r.a.Of(Aa.objectId);return this.dgf(Aa)}NQf(Aa,Wa){var $b=this.Ad.Eb(Aa);if($b){var xc=this.Ad.Eb(xe.k($b));$b=this.Ad.Eb(xe.h($b));if(xc===$b)for($b=0;$b<xc.qa.length&&!xc.qa.J($b).Gao(Aa,Wa);$b++);}}Qxl(Aa,
Wa){let $b=-1;var xc=null;Aa||(Aa=this.Cb.ib?this.Cb.ib.kb:null);if(!Aa||!Aa.Qa)return{returnValue:null,index:$b};const bd=this.nVh(Aa.Qa);if(!bd)return{returnValue:null,index:$b};var Wd=kd.a.Uul(bd.iterator.currentNode,Aa.Qa.cpBegin,this.Xe.uq,Wa);Wd&&(xc=this.nZ(Wd.Oj.toString()),Wd=Array.indexOf(this.Yg,xc),xc=0<=Wd?xc:null,$b=0<=Wd?Wd+1:$b);xc||(Aa=this.IMh(bd,Aa.Qa,this.Xe.uq,Wa),xc=0<=Aa?this.Yg[Aa]:null,$b=0<=Aa?Aa:$b);return{returnValue:xc,index:$b}}fkl(Aa=null){var Wa=null;Wa=this.Cb.ib.kb;
return Wa&&Wa.Qa?this.fql(Wa.Qa,this.Xe.uq,Aa):null}nVh(Aa){const Wa=new Qa.GraphIterator;Wa.set(Aa.node);return Wa.qo()?Bb.a.Ir(Wa,Wa.origin):null}fql(Aa,Wa,$b=null){const xc=this.nVh(Aa);Aa=this.IMh(xc,Aa,Wa,$b);return-1<Aa?this.Yg[Aa]:null}IMh(Aa,Wa,$b,xc=null){let bd=-1;if(Aa)for(Wa=Wa.cpBegin;-1===bd&&Aa.moveNext();)Ya.ParagraphReader.wh(Aa.iterator)&&((Wa=kd.a.QGc(Aa.iterator.currentNode,Wa,$b,xc))&&(bd=Array.indexOf(this.Yg,this.nZ(Wa.Oj.toString()))),Wa=0);return bd}r$h(Aa){const Wa=Aa.toString();
return this.$xa.xb(Wa)&&this.$xa.J(Wa)||this.wrc.contains(Aa)&&this.Ad.Qsa(Aa)&&this.Ad.Eb(Aa).ia(Fb.a.x9,!1)}FWi(Aa,Wa=!1){if(Aa=this.RGc(Aa))Aa.Hqf=!Wa}erf(Aa){return this.$xa.xb(Aa.toString())||this.wrc.contains(Aa)&&this.Ad.Qsa(Aa)&&!this.Ad.Eb(Aa).ia(Fb.a.hL,null)}ePf(Aa){!Aa.objectId||Aa.Rf||this.$xa.xb(Aa.objectId)||this.$xa.add(Aa.objectId,Aa.done)}deleteComment(Aa){Aa&&!Aa.Rf&&(this.Xe.uq&&Aa.Qq!==v.a.beingCreated?this.$xa.remove(Aa.objectId):Aa.Qq===v.a.beingCreated&&this.udj());this.t7c.remove(Aa.id);
return super.deleteComment(Aa)}bcf(Aa){return Aa&&Aa.hasProperty(Fb.a.ZD)?Aa.Og(Fb.a.ZD).toString():""}RGc(Aa){if(!Aa)return null;if(this.Xe.Obb)return this.xB(Aa);for(let Wa of this.Yg){const $b=this.Ad.Eb(r.a.Of(Wa.objectId));if(this.bcf($b)===Aa.toString())return Aa=$b.Og(Fb.a.zG),this.xB(Aa)}return null}aOf(Aa,Wa=!1){if(Aa&&kd.a.NMd(Aa)&&this.wc.isFeatureEnabled(125)){const $b=this.bcf(Aa);if(""!==$b){if(Wa){let xc;if(this.m9c&&({value:xc}=this.m9c.Dc($b,xc)).returnValue&&xc.ResolveState===Aa.ia(Fb.a.x9,
!1))return}(Aa=this.uob.J(Number.parseInvariant($b)))&&this.xmd.add(Aa)}}}lbn(Aa){const Wa=this.Qaf(Aa);let $b=!1;Wa.B8d&&Wa.Dzd||(this.wrc.add(Aa.id),$b=!0,this.Pui(Aa));return $b}Pui(Aa){N.a.h1(u.AFrameworkApplication.uc,()=>{this.CEf(Aa);this.wrc.remove(Aa.id);this.wrc.count||(this.EHb(),this.MJ.ego())},"DelayLoadCommentNodeIntoModel")}CEf(Aa){if(!this.$i&&(fa.ULS.sendTraceTag(525379406,327,10,"Comment Manager Not initialized"),this.o7c<this.vxj)){this.o7c+=1;this.Pui(Aa);fa.ULS.sendTraceTag(525378784,
327,50,`Comment Node add Retry attempt ${this.o7c}`);return}var Wa=this.FDd();Wa.Ci(Aa);Wa.RC()?(Wa=this.owd(Wa),this.$i.addComment(Wa,null),2!==this.$i.mode&&3!==this.$i.mode&&(this.$i.mode=1),this.aOf(Aa),this.OKm(Wa)):this.pkc.push(Aa);this.f4.fna("OnCommentNodeAdded",{commentNode:Aa})}OKm(Aa){this.Xe.uq&&!this.sj.en&&this.MJ.Rz&&Aa.Rf&&this.MJ.Rz.id===Aa.Rf&&this.MJ.notify(String.format(Box4Intl.Box4Strings.L_CommentReplyAdded,Aa.author),!1)}Qaf(Aa){const Wa=new ge;Wa.p0c=xe.k(Aa,r.a.nil);Wa.qEc=
xe.h(Aa,r.a.nil);Aa=Wa.p0c.equals(r.a.nil);const $b=Wa.qEc.equals(r.a.nil);Aa||(Wa.$ya=this.Ad.Eb(Wa.p0c),Wa.B8d=!!Wa.$ya&&Wa.$ya.isConnected);$b||(Wa.BJa=this.Ad.Eb(Wa.qEc),Wa.Dzd=!!Wa.BJa&&Wa.BJa.isConnected);return Wa}yCh(Aa,Wa){const $b=this.XZl(Aa);-1!==$b&&Array.removeAt(this.VQa,$b);Wa||((Aa=this.KJh(Aa))?this.VQa.push(Aa):fa.ULS.sendTraceTag(42870813,3003,10,"GenerateTaskItemForTaskId returned null"))}m0k(){for(let Aa of this.xmd)this.yCh(Aa,!1);this.xmd.clear();for(let Aa of this.cIe)this.yCh(Aa,
!0);this.cIe.clear()}uae(Aa){var Wa=this.Yg.length,$b=!1;if(Aa.Rf){var xc=($b=this.xB(Aa.Rf))&&$b.objectId?this.Ad.Eb(r.a.Of($b.objectId)):null;xc=!!xc&&xc.hasProperty(Fb.a.aza);Wa=Array.indexOf(this.Yg,$b);$b=0>Wa;for(Wa+=1;Wa<this.Yg.length&&this.Yg[Wa].Rf===Aa.Rf&&this.Yg[Wa]!==this.Hy&&!(xc&&Aa.date<this.Yg[Wa].date);)Wa++}return{returnValue:!$b,index:Wa}}UWl(){const Aa=new pd(this.Weo,this.EHb),Wa=lb.App.Wj.al;Wa.Te(40).jp(Object(tb.a)(Aa,Aa.Yyk,"commentPropertyChanged"));Wa.Te(12).jp(Object(tb.a)(Aa,
Aa.jzk,"commentTextChanged"));this.wc.isFeatureEnabled(125)&&Wa.Te(72).jp(Object(tb.a)(Aa,Aa.x4n,"taskPropertyChanged"));mb.GraphTransactionManager.instance.yna(Aa,3)}Msk(Aa){if(Aa&&this.vje.has(Aa.id)){var Wa=Aa.usersByReactionType[1];for(let $b=0;Wa&&$b<Wa.length;$b++)if(Wa[$b].UserId===this.uX)return;fa.ULS.sendTraceTag(542765345,327,15,`Like by current user on Comment ${Aa.objectId} removed by inbound changes`)}}dfo(Aa,Wa){this.Lwk(Wa);const $b=this.Xe.uq;$b&&this.LTl(Wa)?(this.WPk(Wa),this.aOf(Aa),
this.bjo(Wa)):$b||this.aOf(Aa,!0)}Yeo(Aa){let Wa=new Qa.GraphIterator;Wa.set(Aa);Wa.Bb(40);Wa.kd(40);if(Wa.currentNode){if(Aa=this.nZ(Wa.currentNode.id.toString())){let $b={done:Aa.done,text:Aa.text};Aa.text=this.vzb(Wa);!this.Xe.wra||!this.XM||this.Hy&&this.Hy.id===Aa.id||this.XM.fireEvent(10,{comment:Aa,kMm:$b})}}else fa.ULS.sendTraceTag(592738053,327,15,"UpdateComment Unexpected Node Type: "+Qb.a[Aa.type])}bjo(Aa){if(!this.sj.en){var Wa=new dc.a;this.o7f(Aa,Wa);0<Wa.count&&nc.b(Wa)}}WPk(Aa){const Wa=
new B.a(0,1,0,()=>{this.Xeo(Aa)},137,void 0,!0);u.AFrameworkApplication.uc.$b(Wa)}Lwk(Aa){var Wa;null!==(Wa=this.Hy)&&void 0!==Wa&&Wa.Cy&&this.Hy.Cy.sessionType!==H.a.metadata&&(Wa=this.Hy,Aa.Rf||!Aa.done||Wa.Rf!==Aa.id&&Wa.id!==Aa.id||(fa.ULS.sendTraceTag(592188699,327,15,"Draft comment lost on parent resolve, DraftType: {0}",Wa.Qq),this.DM.logKpiFailure(Gf.a.Pud,"DraftCommentLostOnParentResolve",{isIntentional:!1,isInternal:!0},{name:Gf.a.DWe,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}),
Wa.Qq===v.a.beingCreated?(this.$i.clearSelection(),this.deleteComment(Wa),this.selectComment(Aa)):Wa.Qq===v.a.beingEdited&&(Wa.Qq=v.a.normal,Wa.NOa=J.a.succeeded,this.$i.dUe())))}Zeo(Aa,Wa){var $b;const xc=null===($b=Wa.Cy)||void 0===$b?void 0:$b.draftId;if(this.Xe.Obb){if(Aa=Aa.getValue(Fb.a.ZD).toString(),Wa.id!==Aa){if(!Wa.Rf)for($b=Array.indexOf(this.Yg,Wa)+1;$b<this.Yg.length&&this.Yg[$b].Rf===Wa.id;$b++)this.Yg[$b].Rf=Aa;fa.ULS.sendTraceTag(555044877,327,50,"durable Id updated.");Wa.id=Aa;this.bmc.has(Aa)&&
this.bmc.delete(Aa)}}else if(Aa=Aa.getValue(Fb.a.zG),Wa.id!==Aa){if(!Wa.Rf)for($b=Array.indexOf(this.Yg,Wa)+1;$b<this.Yg.length&&this.Yg[$b].Rf===Wa.id;$b++)this.Yg[$b].Rf=Aa;Wa.id=Aa}xc&&this.Yrn(xc,Wa.id)}LTl(Aa){return this.$xa.xb(Aa.objectId)&&this.$xa.J(Aa.objectId)!==Aa.done}Xeo(Aa){this.$xa.Z(Aa.objectId,Aa.done);if(Aa.done)if(this.MJ.Igc(Aa),this.sj.en)this.MJ.JSc(Aa,!0);else{var Wa=new B.a(0,1,0,()=>{this.MJ.JSc(Aa,!0,!1);this.mjd.remove(Aa.id)},139);this.mjd.add(Aa.id,Wa);u.AFrameworkApplication.uc.$b(Wa);
this.uy&&Aa.id===(void 0===this.uy.Rf||null===this.uy.Rf?this.uy.id:this.uy.Rf)&&this.MJ.clearSelection()}else this.MJ.Igc(Aa),Wa=null,({value:Wa}=this.mjd.Dc(Aa.id)).returnValue?(u.AFrameworkApplication.uc.ef(Wa),this.mjd.remove(Aa.id)):this.MJ.JSc(Aa,!1)}Nwi(){this.N0l();this.L0l()}L0l(){this.Xe.HKb&&this.s6h();this.Xe.HKb&&(this.VQa=this.uGk(),Nc.a.mOa(this.fzi))}N0l(){!this.Xe.Gxb&&this.Xe.uq&&Ob.a.mOa(this.Uti);this.UWl();this.TWl()}TWl(){const Aa=new Xc(this.n0k),Wa=lb.App.Wj.al;Wa.Te(39).jp(Object(tb.a)(Aa,
Aa.qnh,"commentContainerPropertyChanged"));this.wc.isFeatureEnabled(125)&&Wa.Te(71).jp(Object(tb.a)(Aa,Aa.qnh,"commentContainerPropertyChanged"));mb.GraphTransactionManager.instance.yna(Aa,3)}nZ(Aa){for(let Wa=0;Wa<this.Yg.length;Wa++){const $b=this.Yg[Wa];if($b.objectId===Aa)return $b}return null}j4j(Aa){if(Aa)for(let Wa of Aa)Wa&&this.zfd.add(Wa)}Yuk(){this.zfd.clear()}wMe(Aa,Wa){Array.insert(this.Yg,Wa,Aa);this.ePf(Aa);this.vum(Aa);Wa=this.iEd(Aa);this.zfd.contains(Wa)&&(Aa.Hqf=!0,this.zfd.remove(Wa))}vum(Aa){fa.ULS.sendTraceTag(539800645,
327,50,`Comment added to Model. ${xe.a(Aa)} `)}owd(Aa){40!==Aa.Se&&fa.ULS.sendTraceTag(594363294,327,15,"[CreateCommentForNode] Iterator is not at commentNode");const Wa=Aa.currentNode;var $b=Wa.getValue(Fb.a.PYb);const xc=Wa.getValue(Fb.a.zG),bd=Wa.getValue(Fb.a.ZD).toString(),Wd=Wa.getValue(Fb.a.JAc);let vf=null,uf=null;this.wc.Uq(15);if(this.Xe.y$a&&Wa.hasProperty(Fb.a.C5)){var oe=Wa.getValue(Fb.a.C5);vf=oe?Ib.b(oe||""):null;Pc.a.qkh(vf)}Wa.hasProperty(Fb.a.aza)&&(uf=Wa.getValue(Fb.a.aza));let Pe=
null,We=null;this.wc.isFeatureEnabled(18)&&Wa.hasProperty(Fb.a.Dud)&&Wa.hasProperty(Fb.a.IAc)&&(Pe=Wa.getValue(Fb.a.Dud),We=Wa.getValue(Fb.a.IAc));oe=xe.k(Wa,r.a.nil).toString();const Xi=xe.h(Wa,r.a.nil).toString(),zf=Wa.ia(Fb.a.x9,!1),sf=Wa.ia(Fb.a.hL,null),Ye=Wa.ia(Fb.a.feb,!1),Bh=this.vzb(Aa);$b=new L.Comment(this.Xe.Obb?bd:xc,xc,$b,uf||new Date(Wd),this.Xe.Obb?this.uje.tol(sf):sf,zf,Bh,L.Comment.jBi,Ye,We,Pe,vf);$b.NWb=oe;$b.MWb=Xi;$b.objectId=Wa.id.toString();$b.cKa=bd;this.g6g(bd,xc);Aa.kd(39);
return $b}g6g(Aa,Wa){(!Aa||Number.parseInvariant(Aa)>=kd.a.moi)&&fa.ULS.sendTraceTag(544022547,327,10,`Durable Id is invalid ${Aa}`);Wa||fa.ULS.sendTraceTag(544022548,327,10,`Guard Id is invalid ${Wa}`);try{this.uje.j0j(Aa,Wa)}catch($b){"DuplicateDurableId"===$b.message?fa.ULS.sendTraceTag(544511521,327,10,`Duplicate Durable Id: ${Aa} with Guard Id: ${Wa}`):"DuplicateGuardId"===$b.message?fa.ULS.sendTraceTag(544511522,327,10,`Duplicate GuardId: ${Wa} with Durable Id: ${Aa}`):fa.ULS.sendTraceTag(544022549,
327,10,`Unkown Error when adding to CommentIds map: ${$b}`)}}vzb(Aa){if(40!==Aa.Se)return fa.ULS.sendTraceTag(594379426,327,15,"Trying to get text from node of type: {0}",Aa.Se),this.kkc.g4f([]);let Wa=Aa.Se+":";const $b=Aa.Hp();0<$b&&(Aa.Wd(),Wa+=Aa.Se+":");const xc=Array($b);for(let bd=0;bd<$b;bd++){Aa.Wd();Wa+=Aa.Se+":";const Wd=Aa.currentNode;Wd.lCb=!0;xc[bd]=Wd;Wd.qa||fa.ULS.sendTraceTag(594363293,327,15,"[GetCommentText_Crash] "+Wa);!Wd.qa&&this.Xe.TCn&&(u.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IWacWordSendErrorReportOnCommentInboundCrashSettings"),
this.qp());Aa.nc();Aa.xj();Wa+=bd<$b-1?":"+Aa.Se+":":":"}return this.kkc.g4f(xc)}qp(){if(Gb.WoncaApp.k$d){var Aa=new hb.a(!0,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportTitle,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportDescription,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportPrivacyStatement);Aa.Ed=1;Aa.We(1,WoncaIntl.WoncaStrings.l_SendErrorReport);Aa.We(0,WoncaIntl.WoncaStrings.l_NoThanks);Aa.lU(1);Aa.fy(yb.a.MYe,CommonUIStrings.l_DefaultDialogTitle,WoncaIntl.WoncaStrings.l_InboundingCommentFailed,
this.JTk,!1)}else this.wY.Uw(yb.a.MYe,this.Uhi)}iEd(Aa){if(!Aa||!Aa.objectId)return"";Aa=r.a.Of(Aa.objectId);Aa=this.Ad.Eb(Aa);return this.bcf(Aa)}BBl(Aa){return this.iEd(Aa.Rf?this.xB(Aa.Rf):Aa)}Ugn(Aa,Wa){if(this.wc.isFeatureEnabled(125))if(this.Xe.removePersonalInformation)fa.ULS.sendTraceTag(595128897,3003,50,"RecordTaskChanges no ops because filter PII flag on"),this.EHb();else{this.iUa.KB(zb.a.wYf);var $b=null===Wa||void 0===Wa?void 0:Wa.taskId,xc=!$b;xc?this.iUa.logKpiUsage(ld.a.Y9d,0):this.iUa.logKpiUsage(ld.a.Z9d,
0);try{const oe=this.DRb.value,Pe=this.iEd(Aa);if(""===Pe)this.uSd(xc,"FailedDurableIdForComment");else{var bd=this.BBl(Aa);if(""===bd)this.uSd(xc,"FailedDurableIdForParentComment");else if(xc&&Aa.Cy.sessionType!==H.a.create&&Aa.Cy.sessionType!==H.a.reply)fa.ULS.sendTraceTag(42856725,3003,10,"Unexpected create task for drafting session type [{0}]",Aa.Cy.sessionType),this.iUa.logKpiFailure(ld.a.Y9d,"FailedTaskCreateInvalidSessionType");else{var Wd=null;Aa.Cy.sessionType!==H.a.metadata&&(Wd=Pe);var vf=
this.gNg.value;var uf=I.a.nf(Aa.text)?vf.xJh(Wd,Wa,xc):vf.xJh(Wd,Wa,xc,Aa.text[0]);0<uf.length?xc?(oe.Sab(Number.parseInvariant(bd),uf)||this.iUa.logKpiFailure(ld.a.Y9d,"TaskCreateFailed"),this.EHb()):(this.iUa.logKpiUsage(ld.a.Z9d,0),oe.Hak($b,uf)||this.iUa.logKpiFailure(ld.a.Z9d,"TaskEngagementFailed")):this.uSd(xc,"HistoryRecordsLengthZero")}}}catch(oe){this.uSd(xc,"RecordTaskChangesFailed")}}}uSd(Aa,Wa){const $b={name:ld.a.q4n,isInternal:!0};Aa?this.iUa.logKpiFailure(ld.a.Y9d,Wa,$b):this.iUa.logKpiFailure(ld.a.Z9d,
Wa,$b)}upd(Aa,Wa){if(this.Xe.y$a&&Aa){var $b=u.AFrameworkApplication.userName,xc=Wa.toString();Aa.usersByReactionType||(Aa.usersByReactionType={});var bd=Aa.usersByReactionType[xc];$b=new C(this.uX,this.T0a,$b);$b.DateUtc=new Date;bd?bd.push($b):Aa.usersByReactionType[xc]=[$b];fa.ULS.sendTraceTag(572014993,327,50,"Reaction type {0} added to {1} with Object Id: {2} ",Wa,Aa.Rf?"reply":"parent",Aa.objectId);xc=[Aa];this.DM.KB(Ld.a.Zyk,{succeeded:!0,customData:{reactionType:P[Wa]}});this.iWc(xc,W.addReaction);
this.vje.add(Aa.id)}}i2d(Aa,Wa){if(this.Xe.y$a&&Aa&&Aa.usersByReactionType){var $b=Aa.usersByReactionType[Wa.toString()];if($b&&$b.length){for(let xc=0;xc<$b.length;xc++)if($b[xc].UserId===this.uX){Array.removeAt($b,xc);break}fa.ULS.sendTraceTag(572014994,327,50,"Reaction type {0} removed from {1} with Object Id: {2} ",Wa,Aa.Rf?"reply":"parent",Aa.objectId);$b=[Aa];this.DM.KB(Ld.a.$yk,{succeeded:!0,customData:{reactionType:P[Wa]}});this.vje.delete(Aa.id);this.iWc($b,W.removeReaction)}}}iWc(Aa,Wa){const $b=
this.Hc.Rc(15);$b.Db(this.gFa);this.Py.sF.p9(3);switch(Wa){case W.deleteComment:for(Wa=0;Wa<Aa.length;Wa++){var xc=Aa[Wa];if(xc.Qq===v.a.beingCreated)this.Xe.contentNavigationApiEnabled&&this.auc.remove(xc.Cy.draftId),this.MJ.S6f();else{var bd=r.a.Of(xc.objectId);(bd=this.Ad.Eb(bd))&&kd.a.Sxd(bd,this.Ad);fa.ULS.sendTraceTag(39364559,327,50,`Deleting Comment: [CommentObjectId:${xc.objectId}]`);this.Xe.wra&&this.XM&&this.XM.fireEvent(7,{comment:xc});this.Xe.contentNavigationApiEnabled&&this.auc.remove(xc.id)}}break;
case W.addComment:this.$i.mode=1;Aa=Aa[0];Aa.date=new Date;Wa=this.HJk(Aa);xc=Wa.getValue(Fb.a.ZD).toString();Aa.cKa=xc;this.Xe.Obb&&this.bmc.set(xc,Aa.id);xc=Aa.text;bd=this.FDd();if(Aa.Rf){var Wd=this.xB(Aa.Rf),vf=this.Ad.Eb(r.a.Of(Wd.objectId));Wa.setValue(Fb.a.hL,vf.getValue(Fb.a.zG));this.addReply(Wa,xc,this.Ad,bd,vf);fa.ULS.sendTraceTag(39364560,327,50,`Adding Reply: [ObjectId:${Aa.objectId}][ParentObjectId:${Wd.objectId}]`)}else(Wd=this.Cb.ib.kb)&&Wd.Qa&&(pa.SelectionEditor.Km(Wd)&&(vf=pa.SelectionEditor.Q1(Wd.Qa,
!1))&&(this.Cb.setSelection(vf),Wd=vf,fa.ULS.sendTraceTag(592569872,327,50,"[RecordChanges] Selection extended")),Ya.ParagraphReader.oc(Wd.Qa.node)&&Ya.ParagraphReader.oc(Wd.Tc.node)&&(this.Cub(Wa,xc,bd,Wd),fa.ULS.sendTraceTag(39364561,327,50,`Adding Comment: [ObjectId:${Aa.objectId}]`)));xc=Wa.ia(Fb.a.zG,null);Aa.sLa=xc;Aa.NOa=J.a.sentToServer;Aa.NOa=J.a.succeeded;Aa.objectId=Wa.id.toString();this.ePf(Aa);this.g6g(Aa.cKa,Aa.sLa);this.Xe.wra&&this.XM&&this.XM.fireEvent(11,{comment:Aa});break;case W.editComment:this.$i.mode=
1;Aa=Aa[0];Wa=r.a.Of(Aa.objectId);Wa=this.Ad.Eb(Wa);xc=Aa.sLa;Aa.sLa||(xc=Wa.getValue(Fb.a.zG),fa.ULS.sendTraceTag(554446870,327,15,`Missing GuardID for Comment with objectId ${Aa.objectId} while editing`),xc=this.Xe.Obb?xc:Aa.id);this.Dej(Wa,Aa.text,xc);fa.ULS.sendTraceTag(39364562,327,50,`Editing Comment: [CommentObjectId:${Aa.objectId}]`);Aa.NOa=J.a.sentToServer;Aa.NOa=J.a.succeeded;this.Xe.wra&&this.XM&&this.XM.fireEvent(10,{comment:Aa,changeType:Aa.Rf?"replyEdited":"edited"});break;case W.addReaction:case W.removeReaction:Wa=
Aa[0];Aa=r.a.Of(Wa.objectId);Aa=this.Ad.Eb(Aa);Wa=this.Xe.y$a?(Wa=Wa.usersByReactionType)?Ib.c(Wa):"":null;Wa&&Aa.setValue(Fb.a.C5,Wa);break;case W.done:case W.undone:for(Wa=0;Wa<Aa.length;Wa++)xc=Aa[Wa],bd=r.a.Of(xc.objectId),this.Ad.Eb(bd).setValue(Fb.a.x9,xc.done),fa.ULS.sendTraceTag(594124932,327,50,`${xc.done?"Resolved":"Re-opened"} Comment: [CommentObjectId:${xc.objectId}]`),this.Xe.wra&&this.XM&&this.XM.fireEvent(10,{comment:xc,changeType:xc.done?"resolved":"reopened"})}this.sm.xF();fa.ULS.sendTraceTag(572281361,
327,50,"Disposing transaction, should raise context reload event");$b.dispose()}FDd(){const Aa=new Qa.GraphIterator;Aa.set(this.Py);this.cza.Z_a(Aa);return Aa}JYc(){return this.vUi(!0)}KYc(){return this.vUi(!1)}vUi(Aa){if(!this.Yg.length)return null;let Wa=this.uy;do{if(Wa){const $b=this.Xe.uq&&!this.sj.en;Wa=Aa?this.dql(Wa,$b):this.eql(Wa,$b)}else Wa=Aa?this.Yg[0]:this.Yg[this.Yg.length-1];if(!Wa)return null}while(Wa.Rf&&""!==Wa.Rf);this.selectComment(Wa);return Wa}Drh(Aa,Wa,$b,xc,bd){const Wd=this.wxj.create(1074135127);
this.Xe.removePersonalInformation&&(Wa=CommonUIStrings.l_RemovedAuthorName,$b=null);Wd.setValue(Fb.a.commentId,X.a.JF());Wd.setValue(Fb.a.ZD,kd.a.acf());Wd.setValue(Fb.a.CJa,u.AFrameworkApplication.userSessionId);Wd.setValue(Fb.a.zG,Aa);Wd.setValue(Fb.a.PYb,Wa);Wd.setValue(Fb.a.Enh,Wa);Wd.setValue(Fb.a.JAc,$b?V.a.t9e($b,"MM/dd/yyyy HH:mm:ss",V.a.dataCulture):"");Wd.setValue(Fb.a.aza,$b);Wd.setValue(Fb.a.x9,xc);this.Xe.y$a&&bd&&(Aa=bd?Ib.c(bd):"",Wd.setValue(Fb.a.C5,Aa));this.wc.isFeatureEnabled(18)&&
(Wd.setValue(Fb.a.IAc,this.uX),Wd.setValue(Fb.a.Dud,this.T0a));return Wd}HJk(Aa){var Wa;const $b=this.Drh(Aa.id,Aa.author,Aa.date,Aa.done,null!==(Wa=Aa.usersByReactionType)&&void 0!==Wa?Wa:{});Aa.Rf&&(this.Xe.Obb?((Wa=this.uje.Krl(Aa.Rf))||fa.ULS.sendTraceTag(555008772,327,10,`Missing guardId for Comment With Durable Id ${Aa.Rf}`),Aa=Wa):Aa=Aa.Rf,$b.setValue(Fb.a.hL,Aa));return $b}addReply(Aa,Wa,$b,xc,bd){this.addComment(Aa,Wa,xc);Wa=cd.v7g(Aa,$b,bd,!0);$b=cd.v7g(Aa,$b,bd,!1);Wa&&xe.u(Aa,Wa.Ob.paragraph.id);
$b&&(xe.t(Aa,$b.Ob.paragraph.id),$b.Ob.paragraph.id||fa.ULS.shipAssertTag(5564303,327,!1,"Comment node has no end anchor!"))}Cub(Aa,Wa,$b,xc){this.addComment(Aa,Wa,$b);let bd,Wd;({start:Wa,end:bd,startCp:$b,endCp:Wd,ich:vf}=this.knk());vf&&(xc.Qa.node===Wa&&($b=Vb.a.$cb(xc,!0)),xc.Tc.node===bd&&(Wd=Vb.a.$cb(xc,!1)));if(-1===$b||-1===Wd){this.LHg||0!==this.lPb||(this.DM.logKpiFailure(Gf.a.MWe,"DraftSelectionLost",{isInternal:!0},{name:Gf.a.Hud,isInternal:!0}),this.LHg=!0);Wa=xc.Qa.node;$b=Vb.a.$cb(xc,
!0);bd=xc.Tc.node;Wd=Vb.a.$cb(xc,!1);if(2<xc.length){var vf=[];for(let uf=0;uf<xc.length;uf++)vf.push(xc.J(uf).node.id);this.$6g(Aa,vf)}fa.ULS.sendTraceTag(51233603,327,50,"Intents invalid reason {0}",this.lPb)}else if(2<this.kY.length){vf=[];for(xc=0;xc<this.kY.length;xc++)vf.push(this.kY[xc].Q$b);this.$6g(Aa,vf)}kd.a.cWb(Wa,Aa.id,$b,!0);kd.a.cWb(bd,Aa.id,Wd,!1);xe.u(Aa,Wa.id);xe.t(Aa,bd.id);this.udj();bd.id||fa.ULS.shipAssertTag(5564304,327,!1,"Comment node has no end anchor!")}$6g(Aa,Wa){if(!(2>=
Wa.length||!Aa||xe.r(Aa))){this.sj.WT.add(Aa.id,new gc.a(new mc.a));for(var $b=r.a.Dp(Wa[0],Wa[1])?2:1,xc=Wa.length-2;$b<=xc;$b++){const bd=Wa[$b];this.sj.Yw.xb(bd)?this.sj.Yw.J(bd).VL||(this.sj.Yw.J(bd).VL=new gc.a(new mc.a)):this.sj.Yw.add(bd,new Ec.a(!0));this.sj.Yw.J(bd).GYa=!0;this.sj.Yw.J(bd).VL.add(Aa.id);this.sj.WT.J(Aa.id).add(bd)}}}knk(){let Aa=null,Wa=-1,$b=null;var xc=-1;let bd=!1;if(!this.kY.length||2!==this.lPb)return{start:Aa,end:$b,startCp:Wa,endCp:xc,ich:bd};Aa=this.Ad.Eb(this.kY[0].Q$b);
$b=1===this.kY.length?Aa:this.Ad.Eb(this.kY[this.kY.length-1].Q$b);if(Ya.ParagraphReader.oc(Aa)&&Ya.ParagraphReader.oc($b)){xc=vf=>3===vf.type;let Wd=this.Ls.TXa(Aa,3,xc);Wa=0<Wd.count?Wd.J(0).begin:-1;Aa!==$b&&(Wd=this.Ls.TXa($b,3,xc));xc=0<Wd.count?Wd.J(0).end:-1;-1===Wa&&null!=Aa&&(Wa=Aa.qa.first.cp,bd=!0,fa.ULS.sendTraceTag(524862562,327,50,"Draft Anchor startCp was adjusted"));-1===xc&&null!=$b&&(xc=$b.qa.last.cp,bd=!0,fa.ULS.sendTraceTag(524862563,327,50,"Draft Anchor endCp was adjusted"))}this.lPb=
-1===Wa||-1===xc?0:2;return{start:Aa,end:$b,startCp:Wa,endCp:xc,ich:bd}}udj(){for(let Aa of this.kY){const Wa=this.Ad.Eb(Aa.Q$b);Ya.ParagraphReader.oc(Wa)&&this.Ls.Bgc(Wa,3)}this.kY=[];this.lPb=2}addComment(Aa,Wa,$b){Aa.anchor||($b.Sf(Aa,1),$b.Ci(Aa),this.GWi(Aa,Wa,$b))}GWi(Aa,Wa,$b){let xc=0;var bd=null;Wa=this.kkc.W6n(Wa,Wd=>{const vf=new ob.a;$b.Sf(vf,1);$b.Ci(vf);$b.Sf(Wd,2);$b.Ci(Wd);$b.nc();$b.nc()});for(let Wd=0;Wd<Wa.length;Wd++)bd=Wa[Wd],xc=bd.getValue(Fb.a.Mc),cd.paragraphEditor.M3a(bd),
cd.dJ&&cd.dJ.jJa&&cd.dJ.PDa(nb.a.create(bd));Aa.setValue(Fb.a.zG,xc.toString());return bd}mfb(Aa,Wa){return this.t7l(Aa,Wa)}UTl(){return 0<this.kY.length}Ywb(Aa,Wa,$b){return Aa.Qa&&Ya.ParagraphReader.oc(Aa.Qa.node)&&Ya.ParagraphReader.oc(Aa.Tc.node)?(Wa=this.Drh(Ya.ParagraphReader.iT(Aa.Tc.node).toString(),Wa?Wa:u.AFrameworkApplication.userName,new Date,!1,{}),$b||($b=new G.a,$b.Kea("\n")),this.Cub(Wa,[$b.cHc()],this.FDd(),Aa),Wa):null}vs(Aa){return!this.qLe.jZf(this.RGc(Aa.getValue(Fb.a.ZD)))}Dej(Aa,
Wa,$b){const xc=new Qa.GraphIterator;for(xc.set(Aa);xc.Wd();)xc.Fg();this.GWi(Aa,Wa,xc).lh(Fb.a.Mc,Number.parseInvariant($b));Aa.setValue(Fb.a.zG,$b);if(Wa=this.nZ(Aa.id.toString()))Wa.pph=!1;Aa.setValue(Fb.a.feb,!1)}Cej(Aa,Wa){this.Dej(Aa,[Sys.Serialization.JavaScriptSerializer.serialize(Wa)],Aa.getValue(Fb.a.zG))}AF(Aa){Aa=this.Ad.Eb(r.a.Of(Aa));return!!Aa&&Aa.ia(Fb.a.AF,!1)}nDi(Aa){Aa=this.Ad.Eb(r.a.Of(Aa));return!!Aa&&Aa.ia(Fb.a.$oh,!1)}$8l(Aa){const Wa=xe.j();return Aa&&Wa.has(Aa.objectId)}cem(Aa){const Wa=
this.Ad.Eb(r.a.Of(Aa));return Wa?this.m6b(Wa):(fa.ULS.sendTraceTag(562562755,341,15,"CommentNode is null, commentObjectId: "+Aa),!1)}m6b(Aa){var Wa=Aa.id,$b=xe.k(Aa),xc=xe.h(Aa);if(!r.a.Dp($b,xc))return!1;$b=Aa.Nc.Eb($b);if(!$b)return!1;xc=({bAc:Aa}=this.LBc($b,Wa,!0)).returnValue;var bd=({bAc:Wa}=this.LBc($b,Wa,!1)).returnValue;if(-1===xc||-1===bd)return!1;$b=$b.qa;xc=$b.J(Aa);bd=$b.J(Wa);if(!xc.hyperlink||!xc.hyperlink.zF||!bd.vl)return!1;for(Aa+=1;Aa<Wa;Aa++)if(xc=$b.J(Aa),xc.hyperlink||xc.vl)return!1;
return!0}kjf(){return cd.dUl(this.Yg,Aa=>this.AF(Aa),Aa=>this.nDi(Aa))}LBc(Aa,Wa,$b){let xc;for(xc=0;xc<Aa.qa.length;xc++){const bd=Aa.qa.J(xc);if(bd.Ff)for(let Wd=0;Wd<bd.Ff.length;Wd++){const vf=bd.Ff.J(Wd);if(vf.Oj.equals(Wa)&&vf.Oc===$b)return{returnValue:bd.cp,bAc:xc}}}return{returnValue:-1,bAc:xc}}Pwh(Aa){if(this.sj.WT.xb(Aa)){const Wa=new dc.a;for(let $b of this.sj.WT.J(Aa))this.Qmn($b,Aa,Wa);this.sj.WT.remove(Aa);nc.b(Wa)}}o7f(Aa,Wa){if(Aa.objectId){Aa=r.a.Of(Aa.objectId);var $b=this.Ad.Eb(Aa);
if($b){var xc=xe.k($b,r.a.nil);$b=xe.h($b,r.a.nil);xc.equals(r.a.nil)||Wa.add(this.Ad.Eb(xc));$b.equals(r.a.nil)||Wa.add(this.Ad.Eb($b));if(this.sj.WT.xb(Aa))for(let bd of this.sj.WT.J(Aa))Wa.add(this.Ad.Eb(bd))}}}Qmn(Aa,Wa,$b){let xc;({value:xc}=this.sj.Yw.Dc(Aa,xc));xc&&(xc.VL.remove(Wa),xc.VL.count||(xc.GYa=!1,$b.add(this.Ad.Eb(Aa))))}static get paragraphEditor(){return null!=cd.Kng?cd.Kng:cd.Kng=w.a.instance.resolve("Box4.IParagraphEditor")}static getInstance(){return cd.Fl()}static Fl(){if(cd._instance)return cd._instance;
const Aa=new Y.a(()=>(new Oa(!0,!0,!0)).vGk()),Wa=w.a.instance;cd._instance=new cd(new Y.a(()=>lb.App.xa.jb.Zc),new Y.a(()=>lb.App.xa.jb.Jc.ud),new Y.a(()=>Jd.a.instance),new cb.a,new kc,new Y.a(()=>bc.a.instance),Wa.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),Wa.resolve("WordEditor.Comments.ICommentFormatTranslator"),Wa.resolve("Common.IAppSettingsManager"),Wa.resolve("Box4.IFeatureHelper"),Wa.resolve("Box4.Intent.IIntentRangeEditor"),new Y.a(()=>lb.App.A_),Wa.resolve("Box4.IKickoutExecutor"),
Wa.Ye("WordEditor.Tasks.ITaskActor"),Aa,Wa.resolve("WordEditor.Comments.CommentsSettings"),Wa.resolve("Box4.IUndoManager"),Wa.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),Wa.resolve("WordEditor.Comments.CommentsState"),Wa.resolve("WordEditor.Comments.WordCommentEventsActor"),Wa.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),Wa.resolve("WordEditor.Comments.ITasksUsageAndHealthLogger"),Wa.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentModel"),lb.App.Wj.al.Te(12),
Wa.resolve("Box4.ParagraphRenderEvents"),Wa.resolve("Box4.CatchUpActivity.IChangeIdEditor"),Wa.Za("WordEditor.Extension.RichApiEventManager"));return cd._instance}static v7g(Aa,Wa,$b,xc){Wa=kd.a.Z9($b,Wa,xc);if(!Wa)return null;Wa=Wa.Ob.Ff;return kd.a.tpd(Aa.id,Wa,Wa.J(0).wt,xc)}t7l(Aa,Wa){if(lb.App.lostSession||(Wa?!lb.App.vs:!lb.App.vs&&!lb.App.fn)||1===Aa.mode||!Object(Yb.a)(Ac.PageView,db.InteractiveViewManager.instance.xd))return!1;Aa=this.Yfl();return!Aa||kb.a.instance.bZ(Aa)||kb.a.instance.ota(Aa)||
Aa.contextId===Wb.a.anchoredObject?!1:!0}Yfl(){const Aa=db.InteractiveViewManager.instance.xd;var Wa=Aa.Cb.Rg;this.b9l()&&this.Hy&&ab.l(Wa.node)&&(Wa=Qa.GraphIterator.$a(Wa.node),Wa.Bb(12),Wa=Wa.rp(12),Wa=Pb.SelectionFactory.Uja(Wa),Aa.Cb.setSelection(Wa),Wa=Aa.Cb.Rg);return Wa}b9l(){var Aa;return null===(Aa=this.Ma)||void 0===Aa?void 0:Aa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCommentInLoopsBugFixEnabled",!1)}static dUl(Aa,Wa,$b){const xc=new dc.a,bd=new dc.a,Wd=new pb.a,vf=new pb.a;
for(let Pe of Aa){var uf=Pe.id,oe=Pe.objectId;Aa=Pe.done;const We=!!oe&&Wa(oe);uf&&(Aa&&xc.add(uf),We&&bd.add(uf),oe&&Wd.Z(uf,oe));if(uf=Pe.Rf)({value:oe}=vf.Dc(uf,0)).returnValue||(oe=0),vf.Z(uf,oe+1);if(!uf&&!Aa&&!We)return!0}for(let Pe of bd){if(xc.contains(Pe))continue;let We;if(({value:We}=Wd.Dc(Pe,We)).returnValue&&$b(We))return!0;let Xi;if(({value:Xi}=vf.Dc(Pe,0)).returnValue&&0<Xi)return!0}return!1}akl(Aa){const Wa=[];let $b=this.Yg.findIndex(xc=>xc.id===Aa);if(-1<$b)for(Wa.push(this.Yg[$b]);++$b<
this.Yg.length&&this.Yg[$b].Rf===Aa;)Wa.push(this.Yg[$b]);return Wa}}cd._instance=null;cd.dJ=null;Object(m.a)(cd,"EditorCommentModel",f.a,[173,174,175])},1681:function(D,M,d){var m=d(75);D=d(0);var f=d(388),a=d(121),l=d(57),r=d(486),w=d(3),v=d(8),u=d(18),z=d(1567),B=d(1530);class G{constructor(fa,sa,ia=!1){this.paragraphNode=fa;this.role=sa;this.B4i=ia}}Object(D.a)(G,"DesignerReviewActionData",null,[]);class F{constructor(fa,sa,ia){this.paragraphNode=fa;this.Hq=sa;this.role=ia}}Object(D.a)(F,"TriageActionData",
null,[]);class K extends F{constructor(fa,sa){super(fa,0,sa)}}Object(D.a)(K,"RoleTriageActionData",F,[]);class N extends F{constructor(fa,sa,ia){super(fa,1,27);this.styleId=sa;this.K1=ia}}Object(D.a)(N,"PullQuoteTriageActionData",F,[]);class H extends F{constructor(fa,sa){super(fa,2,28);this.tla=sa}}Object(D.a)(H,"ImageTriageActionData",F,[]);class J{constructor(fa,sa){this.paragraphNode=fa;this.xDb=sa}}Object(D.a)(J,"ViewOriginalActionData",null,[]);var L=d(136),I=d(1489),R=d(1626);class C{constructor(fa,
sa){this.currentNode=fa;this.nextNode=sa}}Object(D.a)(C,"ReviewNavigationArgs",null,[]);class P{constructor(fa,sa){this.paragraphNode=fa;this.isVisible=sa}}Object(D.a)(P,"ReviewVisibilityArgs",null,[]);class W{constructor(fa){this.hSj=fa}getSelectedOption(){return this.hSj}getSeparatorIndexes(){return[1]}}Object(D.a)(W,"DesignerPreviewData",null,[]);var X=d(986),V=d(1477),Y=d(1627);d.d(M,"a",function(){return ca});class ca extends V.a{constructor(fa,sa,ia,ea,da,ja,Ga,ya,ta,ua,Sa,ka){super();this.Ac=
fa;this.ze=sa;this.dyd=ia;this.bfb=ea;this.ko=da;this.JA=ja;this.Qaj=Ga;this.Dn=ya;this.Ix=ta;this.eyd=ua;this.St=Sa;this.W9e=ka;this.J9a=null;this.c6c=void 0;this.Xje=0;this.a1=[X.a.mxh]}get types(){return this.a1}get KUi(){return Box4Intl.Box4Strings.l_ShowDesignerReviewTooltipSelectOrPress}get WKf(){return 0}JSn(fa){return 3!==fa.suggestion.Hq&&!this.Ix.isVisible&&(!this.Xje||!fa.dvb&&1===this.Xje)}MX(fa){var sa;if(!fa.source||f.SessionStatusManager.instance.Qj)return!1;const ia=fa.Ox;var ea=this.bfb.OHc(ia,
1);if(!ea||!ea.count)return!1;const da=ea.J(0).intent;if(fa.wec)return.5!=(null===da||void 0===da?void 0:da.state)&&4!=(null===da||void 0===da?void 0:da.state);const ja=ia.node;if(0==(null===da||void 0===da?void 0:da.state)&&(2==(null===da||void 0===da?void 0:da.suggestion.Hq)||1==(null===da||void 0===da?void 0:da.suggestion.Hq)))return da.dvb(),this.bfb.Bgc(ja,1),this.JA.GHi(new R.a(ja,1)),!0;if(1==fa.source&&27==(null===da||void 0===da?void 0:da.Oeb)&&(.5==(null===da||void 0===da?void 0:da.state)||
4==(null===da||void 0===da?void 0:da.state)))return!1;ea=this.Ix.isVisible?this.dyd.eTk(ja):new Y.a(0,1);let Ga;const ya=this.dul(null===(sa=null===da||void 0===da?void 0:da.suggestion)||void 0===sa?void 0:sa.Hq);sa=this.En.A2a(ia,{id:"Intent-"+X.a.mxh,suggestionGroups:[{type:ya,id:ya,title:da.description,snippet:this.R5m(this.ko.plainText(ia.node)),snippetFormatting:[],supportedActions:this.Daf(null===da||void 0===da?void 0:da.suggestion,!0),suggestions:({hCn:Ga}=this.juh(ja)).returnValue,previewData:Ga?
new W(Ga):null,isContentPending:!1}],setSize:ea.count,positionInSet:ea.index},this,fa.DMa,!1,()=>{var ta;this.JA.HHi(new P(ja,!0));this.Ix.isVisible||3===(null===(ta=null===da||void 0===da?void 0:da.suggestion)||void 0===ta?void 0:ta.Hq)||this.Xje++},()=>{this.JA.HHi(new P(ja,!1))},null,!1,ta=>{const ua=this.JSn(da);ta.showDesignerButton=!this.Ix.isVisible;ta.shouldSkipTwoStepReview=!0;ta.isFormattingSuggestion=0==da.suggestion.Hq;ta.shouldShowProactivePrompt=ua;ta.proactivePromptHintType=ua?r.e.HideFromReviewCardAndRibbon:
r.e.None});l.c(u.a.JXm,sa,void 0,void 0,30);return sa}executeAction(fa,sa){var ia,ea,da,ja,Ga;if(!fa||!sa)return!1;const ya=this.Dn.qF(sa);v.ULS.sendTraceTag(541446529,3016,50,"Action: {0}; Role: {1}; Pane: {2};",fa.actionType,null===ya||void 0===ya?void 0:ya.role,this.Ix.isVisible);const ta=this.eyd.qZ(sa);try{switch(fa.actionType){case r.b.Accepted:let ua=this.Ac.Xb(u.a.Ood,2,new G(sa,null===ya||void 0===ya?void 0:ya.role,!0));this.e7f(Ea=>{Ea.supportedActions=this.Daf(null===ta||void 0===ta?void 0:
ta.suggestion,!1)});return this.Ix.isVisible&&32===ua?this.KBf(sa):32===ua;case r.b.Rejected:let Sa=this.Ac.Xb(u.a.U1d,2,new G(sa,null===ya||void 0===ya?void 0:ya.role,!0));2===(null===ta||void 0===ta?void 0:ta.suggestion.Hq)||Object(I.e)(null===ta||void 0===ta?void 0:ta.suggestion)||this.I2c(sa,!1);2===(null===ta||void 0===ta?void 0:ta.suggestion.Hq)&&this.En.dismiss();return this.Ix.isVisible&&32===Sa?this.KBf(sa):32===Sa;case r.b.Next:case r.b.Previous:return!this.Ix.isVisible||this.KBf(sa,fa.actionType===
r.b.Previous);case r.b.Apply:const ka=null===(ia=fa.suggestion)||void 0===ia?void 0:ia.contentData;let ha;switch(null===ka||void 0===ka?void 0:ka.Hq){case 0:ha=new K(sa,ka.role);break;case 1:case 3:const Ea=ka.b1a;v.ULS.sendTraceTag(541446530,3016,50,"Changing PullQuote style: {0}",{["suggestionId"]:null===(ea=null===ta||void 0===ta?void 0:ta.suggestion)||void 0===ea?void 0:ea.id,["newStyleId"]:Ea});ta.suggestion.b1a=Ea;ha=new N(sa,Ea,a.a.create());break;case 2:ha=new H(sa,ka.tla);break;default:return v.ULS.shipAssertTag(527459665,
3016,!1,String.format("DesignerSuggestionType: {0}",ka.Hq)),!1}this.En.focus();let Ca=this.Ac.Xb(u.a.changeDesignerRole,2,ha);this.I2c(sa,!1);return 32===Ca;case r.b.AcceptAll:return 32===this.Ac.Xb(w.a.Y9a,2,new z.a(2));case r.b.RejectAll:return 32===this.Ac.processAction(u.a.GWc,2);case r.b.SnoozeAll:return 32===this.Ac.processAction(u.a.designerSnoozeContextualSuggestions,2);case r.b.Undo:let Pa=this.Ac.Xb(u.a.KEa,2,new G(sa,null===ya||void 0===ya?void 0:ya.role));this.I2c(sa,!0);return 32===Pa;
case r.b.OpenDesignerPane:return 32===this.Ac.Xb(u.a.WPa,2,new B.a(6));case r.b.ViewOriginal:const Xa={xDb:fa.descriptorData.isViewingOriginal,QWf:fa.descriptorData.setIsViewingOriginal};if(void 0==(null===Xa||void 0===Xa?void 0:Xa.xDb)||void 0==(null===Xa||void 0===Xa?void 0:Xa.QWf))return v.ULS.shipAssertTag(538789889,3016,!1,String.format("isViewingOriginal: {0}; setIsViewingOriginal: {1}",null===Xa||void 0===Xa?void 0:Xa.xDb,null===Xa||void 0===Xa?void 0:Xa.QWf)),!1;this.En.focus();let qa=this.Ac.Xb(u.a.c2e,
2,new J(sa,Xa.xDb));Xa.QWf(!Xa.xDb);this.I2c(sa,!0);return 32===qa;case r.b.GiveFeedback:switch(null===(da=null===ta||void 0===ta?void 0:ta.suggestion)||void 0===da?void 0:da.Hq){case 0:return this.St.invokeUserFeedback(L.a.Vrj),!0;case 1:case 3:return this.St.invokeUserFeedback(L.a.asj),!0;case 2:return this.St.invokeUserFeedback(L.a.Xrj),!0;default:return v.ULS.shipAssertTag(537658138,3016,!1,String.format("DesignerSuggestionType: {0}",null===(ja=null===ta||void 0===ta?void 0:ta.suggestion)||void 0===
ja?void 0:ja.Hq)),!1}case r.b.ShowMore:switch(null===(Ga=null===ta||void 0===ta?void 0:ta.suggestion)||void 0===Ga?void 0:Ga.Hq){case 2:v.ULS.sendTraceTag(527210449,3016,50,"User clicked show more images"),ta.suggestion.KZl(),this.I2c(sa,!0,!0)}return!0;default:return!1}}catch(ua){return v.ULS.shipAssertTag(572027277,3016,!1,String.format("{0} {1}",ua.message,ua.stack)),!1}}KBf(fa,sa=!1){let ia=this.dyd.y2b(fa,sa)||this.dyd.y2b(fa,!sa);this.JA.ocn(new C(fa,ia,!sa));return!ia||this.dyd.lri(this,ia)}irl(fa){switch(fa.Hq){case 0:case 1:case 3:return Object.assign(Object.assign({},
r.h),{font:fa.font,cssColor:fa.color,fontSize:fa.fontSize,fontWeight:fa.bold?r.d.Bold:r.d.Normal,italic:fa.italic,underlineType:fa.underline?r.f.Single:r.f.None,backgroundImg:fa.backgroundImg});case 2:break;default:v.ULS.shipAssertTag(527569927,3016,!1,`${fa.Hq}`)}}etl(fa){if(2===fa.Hq)return{src:fa.imageUrl,width:0,height:0,imageAltText:fa.altText}}juh(fa){var sa=null;let ia=null;if(this.J9a=this.Qaj.Dzl(fa)){ia=Array(this.J9a.options.length);for(fa=0;fa<this.J9a.options.length;fa++)sa=this.J9a.options[fa],
ia[fa]={type:"DesignerTriageItem",id:String.format("DesignerTriageItem {0}",fa),title:sa.title,supportedActions:[r.b.Apply],contentData:sa,image:this.etl(sa),titleFormatting:[this.irl(sa)]};sa=(null===ia||void 0===ia?0:ia.length)?ia[this.J9a.selectedIndex]:void 0}return{returnValue:ia,hCn:sa}}e7f(fa){this.En.definition?this.En.definition.suggestionGroups?1===this.En.definition.suggestionGroups.length&&(fa(this.En.definition.suggestionGroups[0]),this.En.definition=this.En.definition):v.ULS.shipAssertTag(573687426,
3016,!1):v.ULS.shipAssertTag(573687425,3016,!1)}I2c(fa,sa,ia=!1){const ea=this.eyd.qZ(fa);this.e7f(da=>{da.supportedActions=this.Daf(null===ea||void 0===ea?void 0:ea.suggestion,sa);if(this.J9a){if(ia){var ja=this.juh(fa).returnValue;da.suggestions=ja}ja=this.Qaj.fGl(this.J9a.options,fa);da.previewData=new W(da.suggestions[ja])}})}Daf(fa,sa){const ia=[];sa?(ia.push(r.b.Accepted),ia.push(r.b.Rejected),0==(null===fa||void 0===fa?void 0:fa.Hq)&&ia.push(r.b.ViewOriginal)):(ia.push(r.b.Next),ia.push(r.b.Undo));
this.Ix.isVisible||(this.ze.G9l()&&this.edk(ea=>{ea&&this.e7f(da=>da.supportedActions.push(r.b.GiveFeedback))})&&ia.push(r.b.GiveFeedback),this.ze.r$l()&&ia.push(r.b.OpenDesignerPane),ia.push(r.b.SnoozeAll));0===(null===fa||void 0===fa?void 0:fa.Hq)&&ia.push(r.b.AcceptAll);ia.push(r.b.RejectAll);(null===fa||void 0===fa?0:fa.u2h())&&ia.push(r.b.ShowMore);return ia}R5m(fa){const sa=fa.split(" ",10);return 10>sa.length?fa:sa.join(" ")+"\u2026"}static w$l(fa){return fa===X.a.nxh||fa===X.a.pxh||fa===X.a.txh}dul(fa){return 2===
fa?X.a.pxh:!this.ze.Lib()||1!==fa&&3!==fa?X.a.nxh:X.a.txh}edk(fa){void 0===this.c6c&&this.W9e.execute(sa=>Object(m.__awaiter)(this,void 0,void 0,function*(){this.c6c=yield sa.isFeatureEnabled(L.a.$qi,!1);fa(this.c6c)}));return!!this.c6c}}Object(D.a)(ca,"DesignerIntentProvider",V.a,[])},1689:function(D,M,d){var m=d(75);D=d(0);var f=d(11),a=d(108),l=d(49),r=d(33),w=d(24),v=d(486),u=d(1048),z=d(1477),B=d(2),G=d(772),F=d(15),K=d(68),N=d(584),H=d(16),J=d(18),L=d(8),I=d(432),R=d(835),C=d(433),P=d(854),
W=d(986),X=d(990),V=d(36);class Y{constructor(){this.Mze=void 0}onKeyPressed(ia){return this.Mze?this.Mze(ia):!1}setKeyPressHandler(ia){this.Mze=ia}}var ca;(function(ia){ia[ia.Dlj=0]="ArrowDown";ia[ia.Elj=1]="ArrowUp";ia[ia.Nto=2]="ArrowLeft";ia[ia.Oto=3]="ArrowRight";ia[ia.End=4]="End";ia[ia.lnj=5]="Enter";ia[ia.Buo=6]="Escape";ia[ia.Jnj=7]="Home";ia[ia.swo=8]="Space";ia[ia.Tab=9]="Tab"})(ca||(ca={}));var fa=d(794);d.d(M,"a",function(){return sa});class sa extends z.a{constructor(ia,ea,da,ja,Ga,
ya,ta,ua,Sa,ka,ha){super();this.ga=ia;this.Jf=ea;this.Vd=da;this.mC=ja;this.hb=Ga;this.jG=ya;this.AJ=ta;this.U3=ua;this.Vqc=Sa;this.bS=ha;this.UTj=0;this.KFe=!1;this.W_g=0;this.LKj=10;this.FUj=18E5;this.XTj=3500;this.ild="ContextIQSignalId";this.lGe=0;this.gJg=!0;this.isPaneOpen=!1;this.jka=()=>{this.Vqc.reset();this.gum()};ka&&ka.execute(Ca=>this.fTa=Ca);this.Ged=new X.a;this.MLg=new Y;this.getPersonImageUrl=this.getPersonImageUrl.bind(this);this.IJh(!0);this.Ucl()}Ucl(){const ia=B.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1),ea=Object.assign(new R.a,{parentPath:["Signal",P.ClientConfigSignal.getTypeName()],items:[Object.assign(new I.a,{id:"ClientConfigSignal",body:Object.assign(new P.ClientConfigSignal,{timestamp:Date.now(),clientConfig:Object.assign(new P.ClientConfig,{ecc:Object.assign(new P.EccConfig,{enabled:!0,entities:[Object.assign(new P.EccEntityConfig,{entityType:P.EntityType.People,enabled:!0,queryPrefix:["@"],customProps:[Object.assign(new P.CustomProp,{name:"Filter",value:'{"And":[{"Term":{"PeopleType":"Person"}},{"Term":{"PeopleSubtype":"OrganizationUser"}}]}'})]}),
Object.assign(new P.EccEntityConfig,{entityType:P.EntityType.File,enabled:!0,queryPrefix:["@"]}),Object.assign(new P.EccEntityConfig,{entityType:P.EntityType.Loop,enabled:ia,queryPrefix:["@"]})],bestMatch:Object.assign(new P.BestMatchConfig,{enabled:!1}),scopes:Object.assign(new P.ScopeConfig,{enabled:!1})}),flag:Object.assign(new P.FlagConfig,{enabled:!1}),nudge:Object.assign(new P.NudgeConfig,{enabled:!1}),prediction:Object.assign(new P.PredictionConfig,{enabled:!1})})})})]});this.AJ.zn().then(()=>
{this.U3.getAugLoopRuntimeManager().submitOperation(Object.assign(new C.a,{operation:ea}));L.ULS.sendTraceTag(520104021,3034,50,"Submitted ClientConfigSignal Operation.")})}IJh(ia){const ea=Object.assign(new R.a,{parentPath:["Signal",P.StartupSignal.getTypeName()],items:[Object.assign(new I.a,{id:"SessionStartupSignal",body:Object.assign(new P.StartupSignal,{timestamp:Date.now()})})]});this.AJ.zn().then(()=>{ia&&this.HA();this.U3.getAugLoopRuntimeManager().submitOperation(Object.assign(new C.a,{operation:ea}));
L.ULS.sendTraceTag(521412674,3034,50,"Submitted StartupSignal Operation.")});B.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ResendStartupSignalIsEnabled",!1)&&this.W_g<this.LKj&&(this.W_g++,setTimeout(()=>{this.IJh(!1)},this.FUj))}HA(){B.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQUseEccResultAnnotation",!1)?(this.Jf.mb(this,P.EccResultAnnotation.getTypeName()),L.ULS.sendTraceTag(521412673,3034,50,"Registered for EccResultAnnotations.")):
(this.Jf.mb(this,P.UserInitiatedResultAnnotation.getTypeName()),L.ULS.sendTraceTag(521412672,3034,50,"Registered for UserInitiatedResultAnnotations."))}xeo(ia,ea,da,ja,Ga){const ya=void 0===ea?!1:this.lGe>ea;this.En.YN&&!ya&&(ia=this.Zcl(ia),ja&&ia.suggestionGroups&&0<ia.suggestionGroups.length&&(ia.suggestionGroups[0].previewData=ja.substring(Ga+1,ja.length)),this.En.definition=ia,ea&&(this.lGe=ea));ea?(ja=Date.now(),da=[Object.assign(new V.a,{name:this.ild,string:da}),Object.assign(new V.a,{name:"ContextIQMenuOpen",
bool:this.En.YN}),Object.assign(new V.a,{name:"ContextIQStaleAnnotation",bool:ya})],this.Ged.nQc("ContextIQUserInitUserPerceivedLatency",ja-ea,1,!0,void 0,da)):L.ULS.sendTraceTag(537966025,3034,15,"SignalGenerationTime is undefined, can not determine if this annotation is stale or generate User Perceived Latency telemetry.")}Zcl(ia){if(ia){var ea=[];if(ia.annotationType===P.UserInitiatedResultAnnotation.getTypeName()){var da=ia.content;if(!da)return;for(var ja of da.results)ea=ea.concat(ja.results)}else{ja=
ia.content;if(!ja)return;for(da of ja.entityResults)ea=ea.concat(da.entities)}if(ja=this.gJg)this.gJg=!1;return Object.assign(Object.assign({},v.g),{id:W.a.ZVa,suggestionGroups:[{type:W.a.ZVa,isContentPending:!1,contentData:ea,isFirstInvoke:ja}]})}}getPersonImageUrl(ia,ea){return Object(m.__awaiter)(this,void 0,void 0,function*(){var da=new G.a(ia,"O365",ea,ia);if(this.fTa&&this.fTa.getPersonaIconPropertiesArray&&(da=yield this.fTa.getPersonaIconPropertiesArray([da]),0<da.length&&da[0].authorImageURL))return da[0].authorImageURL})}static B4c(){return!F.a.N6b&&
!F.a.l2&&B.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQAtMentionEntryPointIsEnabled",!1)}static get C2a(){return sa.WTj}QWn(ia){if(this.fTa){var ea=Object.assign(Object.assign({},v.g),{id:W.a.ZVa,suggestionGroups:[{type:W.a.ZVa,isContentPending:!0,contentData:[]}]});var da=!1;this.ga.V5(J.a.v2a)&&(da=!this.isPaneOpen);this.En.A2a(ia,ea,this,!0,!1,null,this.jka,null,!1,ja=>{ja.shouldIgnoreFocusEvent=Ga=>this.KFe?!0:this.En.shouldIgnoreFocusEvent(Ga);ja.getPersonImageUrl=
this.getPersonImageUrl},da,!1,this.MLg)}else L.ULS.sendTraceTag(539068165,3034,15,"PeopleAPI was not ready in time for showing a User Init Context IQ Card")}pmh(){this.En.dismiss()}onKeyDown(ia){if(ia&&ia.Ib){switch(ia.Ib.keyCode){case K.a.gha:var ea=ca.Dlj;break;case K.a.yK:ea=ca.End;break;case K.a.Ks:ea=ca.lnj;break;case K.a.M3:ea=ca.Jnj;break;case K.a.fx:ea=ca.Tab;break;case K.a.N7:ea=ca.Elj}void 0!==ea&&(ia.Ib.stopPropagation(),ia.Ib.preventDefault(),this.MLg.onKeyPressed(ea))}}mI(ia,ea){if(ia&&
ia.content&&ea===u.a.getTypeName()&&(ia.annotationType===P.UserInitiatedResultAnnotation.getTypeName()||ia.annotationType===P.EccResultAnnotation.getTypeName())){var da=ea=void 0,ja=void 0,Ga=0,ya=ia.parentPath.split("\\");if(ya&&6===ya.length)if(da=ya[5],ya=Date.now(),da in sa.C2a){clearTimeout(sa.C2a[da].$3f);ea=sa.C2a[da].startTime;ja=sa.C2a[da].eXn;Ga=sa.C2a[da].urd;delete sa.C2a[da];const ta=[Object.assign(new V.a,{name:this.ild,string:da})];this.Ged.nQc("ContextIQUserInitALLatency",ya-ea,1,
!0,void 0,ta)}else L.ULS.sendTraceTag(537962376,3034,15,"SignalId is not in the dictionary, can not generate AL Latency telemetry.");else L.ULS.sendTraceTag(537966026,3034,15,"Annotation's parent path is not the expected length of 6. Can not generate AL Latency telemetry.");this.xeo(ia,ea,da,ja,Ga)}}get types(){return[W.a.ZVa]}G6f(ia,ea){this.En.YN&&this.En.G6f(ia,ea)}MX(){return!1}executeAction(ia,ea,da,ja){const Ga=Date.now();if(!ea)return!1;switch(ia.actionType){case v.b.Apply:this.gJd(ia.descriptorData,
ea,da,ja);this.pmh();break;case v.b.ClearSearch:this.KFe=!0;this.clearSearch(ea,da,ja,!1);this.En.YN&&(this.o3i(),ia=f.ParagraphReader.text(ea).substring(0,da+1),this.l$e(ea,ia,da,Ga));this.KFe=!1;break;case v.b.Retry:this.En.YN&&(this.o3i(),ia=f.ParagraphReader.text(ea).substring(0,ja),this.l$e(ea,ia,da,Ga));break;case v.b.OpenEditorPane:if(32!==this.ga.processAction(J.a.v2a,2))return L.ULS.sendTraceTag(520898381,3034,15,"Failed to launch the editor pane from contextual card.",ia.actionType),!1;
break;default:return L.ULS.sendTraceTag(539849408,3034,15,"Failed to process action of type {0} since it is not known to us.",ia.actionType),!1}return!0}l$e(ia,ea,da,ja){var Ga,ya;const ta=da.toString(),ua=ia.id.toString(),Sa=ua+"-"+ta,ka=++this.UTj,ha=Sa+"-"+ka;ia=(ia=a.FormattingReader.EEd(ia,da,f.ParagraphReader.textLength(ia)))?a.FormattingReader.language(ia):B.AFrameworkApplication.lcid;ia=null!==(ya=null===(Ga=N.a.lg(ia))||void 0===Ga?void 0:Ga.C9e)&&void 0!==ya?ya:"";const Ca=Object.assign(new R.a,
{parentPath:["Signal",fa.TextPredictorSignal.getTypeName(),ua,ta,Sa],items:[Object.assign(new I.a,{id:ha,body:Object.assign(new fa.TextPredictorSignal,{languageId:ia,startOfSentence:!0,text:ea,timestamp:Date.now(),userInitQuery:!0})})]});this.AJ.zn().then(()=>{this.U3.getAugLoopRuntimeManager().submitOperation(Object.assign(new C.a,{operation:Ca}));L.ULS.sendTraceTag(521412643,3034,50,"Submitted Text Predictor Signal.");const Pa=[Object.assign(new V.a,{name:this.ild,string:ha})];this.Ged.nQc("ContextIQUserInitSignalGenerationLatency",
Date.now()-ja,1,!0,void 0,Pa)});Ga=setTimeout(()=>{this.MUn(ha)},this.XTj);sa.C2a[ha]={startTime:ja,eXn:ea,urd:da,$3f:Ga}}o3i(){let ia;ia=Object.assign(Object.assign({},v.g),{id:W.a.ZVa,suggestionGroups:[{type:W.a.ZVa,isContentPending:!0,contentData:[]}]});this.En.definition=ia}MUn(ia){if(ia in sa.C2a){var ea=sa.C2a[ia].startTime;ea=void 0===ea?!1:this.lGe>ea;if(!ea&&this.En.YN){let da;da=Object.assign(Object.assign({},v.g),{id:W.a.ZVa,suggestionGroups:[{type:W.a.ZVa,isContentPending:!1,errorMessage:"No results received from AugLoop",
contentData:[]}]});this.En.definition=da}ia=[Object.assign(new V.a,{name:this.ild,string:ia}),Object.assign(new V.a,{name:"ContextIQMenuOpen",bool:this.En.YN}),Object.assign(new V.a,{name:"ContextIQStaleSignal",bool:ea})];this.Ged.nQc("ContextIQUserInitALTimeout",1,0,!0,void 0,ia)}}gJd(ia,ea,da,ja){const Ga=ia.type;switch(Ga){case P.EntityType.File:this.v3l(ia,ea,da,ja);break;case P.EntityType.People:this.cao(ia,ea,da,ja);break;case P.EntityType.Loop:this.Q3l(ia,ea,da,ja);break;default:L.ULS.sendTraceTag(539849409,
3034,15,"Failed to process entity of type {0} since it is not known to us.",Ga)}}cao(ia,ea,da,ja){const Ga=ia.displayName,ya=ia.primaryEmailAddress,ta=new G.a(ya,"O365",Ga,ya);this.fTa.checkUserAccess(ta).then(ua=>{ua.UserCanWrite?(L.ULS.sendTraceTag(539100301,3034,50,"User has the correct permissions to be AtMentioned"),this.jG.Emf(ea,da,ja,Ga,ya)):this.fcj(ta,ea,da,ja)},()=>{L.ULS.sendTraceTag(539100302,3034,15,"Got back failed response from checking user access for AtMentioned User");this.fcj(ta,
ea,da,ja)})}fcj(ia,ea,da,ja){this.fTa.grantUsersAccess([ia]).then(Ga=>{let ya=!1;Ga.Details&&(ya=Ga.Details.Result[0].UserCanWrite);ya?(L.ULS.sendTraceTag(539100303,3034,50,"AtMentioned User has been granted access"),this.jG.Emf(ea,da,ja,ia.DisplayName,ia.Email)):(L.ULS.sendTraceTag(539100304,3034,50,"AtMentioned user has been denied access"),this.clearSearch(ea,da,ja,!0))},()=>{L.ULS.sendTraceTag(539100305,3034,15,"Failed Response from Attempt to grant access to AtMentioned user")})}v3l(ia,ea,da,
ja){if(ea){var Ga=new l.GraphTransaction(15),ya=ia.fileName+" ";try{Ga.Db(ea);this.Vd.replaceTextRange(r.a.createTextRange(ea,da,ja),ya);const ta=H.a.BKc(ia.url+"?web=1");this.mC.DG(r.a.createTextRange(ea,da,da+ia.fileName.length),ta,!1,!1,!1);this.hb.setSelection(w.SelectionFactory.xe(ea,da+ya.length))}finally{Ga&&Ga.dispose()}}else L.ULS.sendTraceTag(539849100,3034,15,"Paragraph node is undefined/null.")}Q3l(ia,ea,da,ja){if(ea){var Ga=new l.GraphTransaction(15);try{Ga.Db(ea);this.Vd.replaceTextRange(r.a.createTextRange(ea,
da,ja),"");this.hb.setSelection(w.SelectionFactory.xe(ea,da));const ya=ia.id;ya===W.a.XAm?this.ga.processAction(J.a.JLd,2):ya===W.a.WAm?this.ga.processAction(J.a.rLd,2):L.ULS.sendTraceTag(537458136,3034,15,"Trying to insert unsupported loop type.")}finally{Ga&&Ga.dispose()}}else L.ULS.sendTraceTag(537458135,3034,15,"Paragraph node is undefined/null.")}clearSearch(ia,ea,da,ja){if(ia){var Ga=new l.GraphTransaction(15);ja||(ea+=1);try{Ga.Db(ia),this.Vd.replaceTextRange(r.a.createTextRange(ia,ea,da),
""),this.hb.setSelection(w.SelectionFactory.xe(ia,ea))}finally{Ga&&Ga.dispose()}}else L.ULS.sendTraceTag(529413333,3034,15,"Paragraph node is undefined/null.")}gum(){this.bS.execute(ia=>{ia.logActivity("CIQ_AtInvoke",null)})}}sa.WTj={};Object(D.a)(sa,"ContextIQIntentProvider",z.a,[179])},1690:function(D,M,d){D=d(0);var m=d(684),f=d(516),a=d(7),l=d(1439),r=d(1892),w=d(370),v=d(8),u=d(120),z=d(1491);class B{constructor(H,J,L){this.isVisible=H;this.elements=J;this.content=L}}Object(D.a)(B,"TooltipVisibilityArgs",
null,[]);var G;(function(H){H[H.consistency=0]="consistency";H[H.iGo=1]="pullQuote";H[H.HIo=2]="suggestedImage";H[H.jGo=3]="pullQuoteMenu";H[H.Zzo=4]="designerPaste"})(G||(G={}));Object(D.b)("DesignerSuggestionType",G);var F=d(136),K=d(1628);d.d(M,"a",function(){return N});class N extends l.a{constructor(H,J,L,I,R,C,P,W){super();this.Nn=H;this.Gy=J;this.Nvk=L;this.jqi=I;this.ko=R;this.JA=C;this.pK=P;this.Jc=W;this.nra=this.eBa=null;this.onMouseEnter=X=>{X=X.vp;this.JA.ZHi(new B(!0,[X.Ryc],X.H7n));
const V=this.pK.qZ(X.paragraphNode);V&&V.suggestion.Xvm();return this.GXi(X)};this.Ama=X=>{this.JA.ZHi(new B(!1));return this.tlh(X.vp)};this.k0a=X=>{if(N.cDb(X.vp,this.nra))return!0;this.JA.pcn(z.a.create(X.vp.paragraphNode));return!0};this.KGf=(X,V)=>{V.data?V.data.isVisible?this.WFn(V.data.paragraphNode):this.yuk():v.ULS.shipAssertTag(573850384,3016,!1)};this.JA.aOe(this.KGf)}vIn(H){H?(H=this.$cf(H))&&this.GXi(H):v.ULS.shipAssertTag(589693324,3016,!1)}Nuk(){this.tlh(this.eBa)}AJb(H){H=this.ko.Ym(H.zb);
return!!H&&this.pK.kOc(H)}Swb(H){const J=H.Pvb(0,F.a.dhk,this.zoom),L=[];L.push(this.iWa(H.S6,J,H.I3c[0].y-H.w$[0].y));return L}iWa(H,J,L){var I,R=H.Ig.ownerDocument;const C=m.a.createElement(R,f.a.div);C.className=F.a.Zgk;C.style.left=J+"px";C.style.top=L+"px";J=m.a.createElement(R,f.a.div);J.className=F.a.bhk;R=m.a.createElement(R,f.a.div);R.className=F.a.$gk;H=this.ko.Ym(H.zb);L=this.pK.qZ(H);if(null===(I=null===L||void 0===L?void 0:L.suggestion)||void 0===I?0:I.Hq)R.className+=String.format(" {0}",
G[L.suggestion.Hq]);J.appendChild(R);C.appendChild(J);C.id=N.eLh(H);I=this.$cf(H,C);1==I.ehk&&(R.className+=String.format(" {0}",F.a.ahk));this.nra&&this.nra.paragraphNode===H?(C.className+=String.format(" {0}",F.a.URe),this.nra=I):this.eBa&&this.eBa.paragraphNode===H&&(C.className+=String.format(" {0}",F.a.TRe),this.eBa=I);this.jqi(a.a.sQ,C,this.onMouseEnter,I);this.jqi(a.a.iK,C,this.Ama,I);this.Nvk(a.a.click,C,this.k0a,I);return C}WFn(H){if(H){var J=this.$cf(H);J?(this.pK.qZ(H)&&(H=Object.assign(new r.a,
{action:0,type:3,vF:J,eO:this.nra}),this.Gy.$G(H)),this.nra=J,N.cDb(this.eBa,this.nra)&&(this.eBa=null)):v.ULS.shipAssertTag(590112344,3016,!1)}else v.ULS.shipAssertTag(590112343,3016,!1)}yuk(){if(this.nra){var H=Object.assign(new r.a,{action:1,type:3,vF:null,eO:this.nra});this.nra=null;this.Gy.$G(H)}}GXi(H){if(N.cDb(H,this.nra)||N.cDb(H,this.eBa))return!0;const J=Object.assign(new r.a,{action:2,type:3,vF:H,eO:this.eBa});this.eBa=H;this.Gy.$G(J);return!0}tlh(H){if(N.cDb(H,this.nra))return!0;H=Object.assign(new r.a,
{action:3,type:3,vF:null,eO:this.eBa});this.eBa=null;this.Gy.$G(H);return!0}$cf(H,J){J=J?J:this.qhl(H);if(!J)return null;const L=this.pK.qZ(H);return new K.a(H,J,N.IZh(L),N.rhl(L))}static IZh(H){if(!H)return WordEditorIntl.WordEditorStrings.L_ReviewDesignerSuggestion;switch(H.suggestion.Hq){case 0:return N.CMd(H.state)?WordEditorIntl.WordEditorStrings.L_ReviewUpdatedDesignerFormattingSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerFormattingSuggestion;case 1:case 3:return N.CMd(H.state)?
WordEditorIntl.WordEditorStrings.L_ReviewAddedDesignerPullQuoteSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerPullQuoteSuggestion;case 2:return N.CMd(H.state)?WordEditorIntl.WordEditorStrings.L_ReviewAddedDesignerText2ImageSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerText2ImageSuggestion;default:return WordEditorIntl.WordEditorStrings.L_ReviewDesignerSuggestion}}static rhl(H){return H?N.CMd(H.state)?1:0:0}static CMd(H){return 0!==H&&.1!==H}qhl(H){var J=null,L=this.Nn.pg(H);
L.Bb(11)&&(L.nc(),L=L.currentNode.Ui(this.Jc.Tb))&&(H=String.format("#{0}",N.eLh(H)),J=L.htmlElement.querySelector(H),!J&&Object(u.a)(w.a,L)&&(J=(J=L.O7e())?J.querySelector(H):null));return J}static eLh(H){return String.format("p{0}{1}",H.id.guid,H.id.n)}static cDb(H,J){return!!J&&!!H&&H.Ryc===J.Ryc}}Object(D.a)(N,"BlueDotActor",l.a,[613,614])},1692:function(D,M,d){D=d(0);var m=d(636);class f{constructor(l){this.CBa=l.hul();this.PAb=l.Vcf("intCopy");this.SYd=l.HUh("intCopy");this.gwb=l.Iaf("intCopy");
this.M$a=l.haf("intCopy")}static lF(){return f.lr()}static lr(){return new f(m.a.instance)}}Object(D.a)(f,"InternalCopyUsageHelper",null,[]);d.d(M,"a",function(){return a});class a{constructor(l,r,w){this.GV=f.lF();this.Gtd=null;this.zJb=this.Vbe=!1;this.xCg=null;this.source=l;this.target=r;this.TIf=w}get fha(){return this.GV}get xo(){return this.xCg}set xo(l){this.xCg=l}}Object(D.a)(a,"InternalCopyArguments",null,[])},1693:function(D,M,d){D=d(0);var m=d(1411);class f extends m.a{constructor(){super();
this.LastAutoSaveErrorReported=0;this.LastAutoSaveCorrelation=null;this.MeritsErrorReport=!1;this.LocalCobaltMachineId=this.LocalCobaltSessionId=null;this.WaciiEnabledRequests=0;this.ShowMergePrompt=!1;this.PartMergeInfo=0}}Object(D.a)(f,"ALocalCobaltServerResponse",m.a,[]);d.d(M,"a",function(){return a});class a extends f{constructor(){super();this.RootCellId=null;this.AvailableFileAccess=0;this.PageHtml=this.ClientKnowledge=this.LatestRevisionId=this.RevisionList=null;this.PinRevisionForAugLoopResponse=
this.ContentBytes=0;this.RevisionIdPinnedForAugLoop=null;this.ScheduledShutdownTime=0;this.LastSavedToHostRevisionSequenceNumber=-1}}Object(D.a)(a,"GetChangesResponse",f,[])},1694:function(D,M,d){D=d(0);var m=d(67);class f extends Sys.EventArgs{constructor(){super()}}Object(D.a)(f,"UploadEventArgs",Sys.EventArgs,[]);d.d(M,"a",function(){return a});class a{constructor(){this.sa=new m.a}T7f(l){this.sa.raiseEvent("UploadStarted",new f(l,-1))}Rgc(l,r){this.sa.raiseEvent("UploadComplete",new f(l,r))}static get instance(){return null!=
a.klg?a.klg:a.klg=new a}}Object(D.a)(a,"Box4UploadNotifier",null,[596])},1726:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static QKh(f){switch(f){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}
Object(D.a)(m,"WopiAuthContext",null,[716])},1727:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{}m.rXm="OneDriveWOPI";Object(D.a)(m,"HostApplicationType",null,[])},1728:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{}m.Mkj="WAC_Word";m.rKc=null;Object(D.a)(m,"AddinHostApp",null,[])},1729:function(D,M){Object.defineProperty(M,"__esModule",{value:!0});M.RoleType=M.ErrorCode=void 0;(function(d){d[d.Success=0]="Success";d[d.DocumentTooLarge=1]="DocumentTooLarge"})(M.ErrorCode||
(M.ErrorCode={}));(function(d){d[d.Unknown=0]="Unknown";d[d.Title=1]="Title";d[d.Subtitle=2]="Subtitle";d[d.Heading1=3]="Heading1";d[d.Heading2=4]="Heading2";d[d.Heading3=5]="Heading3";d[d.Heading4=6]="Heading4";d[d.Heading5=7]="Heading5";d[d.Heading6=8]="Heading6";d[d.Heading7=9]="Heading7";d[d.Heading8=10]="Heading8";d[d.Heading9=11]="Heading9";d[d.ListItem=12]="ListItem";d[d.BodyText=13]="BodyText";d[d.ListHeader=14]="ListHeader";d[d.Caption=15]="Caption";d[d.CoverPageElement=16]="CoverPageElement"})(M.RoleType||
(M.RoleType={}))},1730:function(D,M,d){Object.defineProperty(M,"__esModule",{value:!0});M.NavigationPaneInputClassifierSignal=M.DesignerInputClassifierSignal=M.DocumentRoleDetectionAnnotation=M.RoleDetectionAnnotation=M.RoleDetectionSettings=M.RoleDetectionCustomMetadata=M.BasePartialDocumentLevelAnnotation=M.WordNavPaneInputTargetDocumentClassificationAnnotation=M.WordDesignerInputTargetDocumentClassificationAnnotation=M.BaseInputTargetDocumentClassificationAnnotation=void 0;const m=d(203);class f{constructor(F){m.SchemaObject.assign(f,
this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(F){return m.SchemaObject.matchesTypesFor(F,[f.getTypeName()])}}M.BaseInputTargetDocumentClassificationAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(F){m.SchemaObject.assign(a,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=
F}static getTypeName(){return"AugLoop_RoleDetection_WordDesignerInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return m.SchemaObject.matchesTypesFor(F,[a.getTypeName()])}}M.WordDesignerInputTargetDocumentClassificationAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(F){m.SchemaObject.assign(l,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=
F}static getTypeName(){return"AugLoop_RoleDetection_WordNavPaneInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return m.SchemaObject.matchesTypesFor(F,[l.getTypeName()])}}M.WordNavPaneInputTargetDocumentClassificationAnnotation=l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class r{constructor(F){m.SchemaObject.assign(r,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=
F}static getTypeName(){return"AugLoop_RoleDetection_BasePartialDocumentLevelAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(F){return m.SchemaObject.matchesTypesFor(F,[r.getTypeName()])}}M.BasePartialDocumentLevelAnnotation=r;r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class w{constructor(F){m.SchemaObject.assign(w,this,F)}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionCustomMetadata"}static getBaseTypes(){return[]}static typeGuard(F){return m.SchemaObject.matchesTypesFor(F,
[w.getTypeName()])}}M.RoleDetectionCustomMetadata=w;w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class v{constructor(F){m.SchemaObject.assign(v,this,F)}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionSettings"}static getBaseTypes(){return[]}static typeGuard(F){return m.SchemaObject.matchesTypesFor(F,[v.getTypeName()])}}M.RoleDetectionSettings=v;v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class u{constructor(F){m.SchemaObject.assign(u,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=
F}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return m.SchemaObject.matchesTypesFor(F,[u.getTypeName()])}}M.RoleDetectionAnnotation=u;u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class z{constructor(F){m.SchemaObject.assign(z,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_DocumentRoleDetectionAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BasePartialDocumentLevelAnnotation",
"AugLoop_Core_Annotation"]}static typeGuard(F){return m.SchemaObject.matchesTypesFor(F,[z.getTypeName()])}}M.DocumentRoleDetectionAnnotation=z;z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class B{constructor(F){m.SchemaObject.assign(B,this,F)}static getTypeName(){return"AugLoop_RoleDetection_DesignerInputClassifierSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(F){return m.SchemaObject.matchesTypesFor(F,[B.getTypeName()])}}M.DesignerInputClassifierSignal=B;B.H_={T_:B.getTypeName(),
B_:B.getBaseTypes()};class G{constructor(F){m.SchemaObject.assign(G,this,F)}static getTypeName(){return"AugLoop_RoleDetection_NavigationPaneInputClassifierSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(F){return m.SchemaObject.matchesTypesFor(F,[G.getTypeName()])}}M.NavigationPaneInputClassifierSignal=G;G.H_={T_:G.getTypeName(),B_:G.getBaseTypes()}},1736:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f){this.extensions=f}}Object(D.a)(m,
"ExtensionList",null,[])},1737:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);d=d(1692);class m extends d.a{constructor(f,a){super(f.source,f.target,f.TIf);this.Ri=f;this.insertAfter=a}get fha(){return this.Ri.fha}get xo(){return this.Ri.xo}set xo(f){this.Ri.xo=f}}Object(D.a)(m,"CoreInternalCopyArguments",d.a,[])},1738:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f,a,l,r,w=null){this.source=f;this.target=a;this.insertAfter=l;this.fIf=r;this.xo=w||{}}}Object(D.a)(m,
"CoreInternalPasteArguments",null,[])},1739:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f,a="",l="",r="",w=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=f;this.Provider=a;this.DisplayName=l;this.Email=r;this.IsCurrentUser=w}}Object(D.a)(m,"OfficeSharedCommentUser",null,[])},1740:function(D,M,d){d.d(M,"a",function(){return H});D=d(0);var m=d(43),f=d(1741),a=d(160),l=d(2),r=d(104),w=d(289),v=d(1355),u=d(747),z=d(735),
B=d(1356),G=d(190),F=d(141),K=d(60),N=d(13);class H{constructor(J){this.j8=this.ii=this.i0=null;this.gC=0;this.XNb=this.Vha=this.Wb=null;this.pZg=!1;this.qje=null;this.Gqh=!0;this.ga=J;this.Vb()}get waa(){return this.i0}get model(){return this.ii}get f4b(){return this.j8}get wOk(){return l.AFrameworkApplication.JPn}get m6n(){return l.AFrameworkApplication.A0i}get zQk(){return CommonUIStrings.l_DeleteCommentConfirm}get P1n(){return!1}get Dz(){return!1}get Sri(){return!1}get zDh(){return this.Vha}set zDh(J){this.Vha=
J}get mode(){return this.gC}set mode(J){J!==this.gC&&(this.gC=J,-1!==this.gC&&(this.i0.W_a(),this.ii.W_a(),0===this.gC&&this.f5e()))}get vJb(){return this.pZg}set vJb(J){this.pZg=J}get removePersonalInformation(){return!1}get E2i(){return!0}dispose(){this.i0&&(this.i0.dispose(),this.i0=null);this.ii&&(this.ii.dispose(),this.ii=null);this.j8&&(this.j8.dispose(),this.j8=null);this.f5e()}selectComment(J,L=1){const I=this.ii.xB(J);!I||2===this.mode&&1!==I.Qq||(this.ii.selectComment(I),this.j8.highlightComment(I,
!0),this.i0.selectComment(I,L),1===L&&this.vJb&&this.Vha.selectComment(J))}JYc(){const J=this.ii.JYc();J&&(this.j8.highlightComment(J,!0),this.i0.selectComment(J),this.vJb&&this.Vha.selectComment(J.id))}KYc(){const J=this.ii.KYc();J&&(this.j8.highlightComment(J,!0),this.i0.selectComment(J),this.vJb&&this.Vha.selectComment(J.id))}r4d(J){J?this.selectComment(J,0):this.i0.Eri&&this.Raf().Uj.hy(this.i0.Eri)}clearSelection(){this.ii.clearSelection();this.vJb&&this.Vha.selectComment(null);this.j8.Luk()}paneClosing(){this.Dz||
(2===this.gC?(this.clearSelection(),this.deleteComment(this.ii.Hy)):this.clearSelection())}Cub(J){if(1===this.mode){J=f.a.Ywb(J);var L=({anchor:I}=this.j8.tFk()).returnValue;if(I&&0===L)this.addComment(J,I);else{switch(L){case 1:J=CommonUIStrings.l_NewCommentError;break;case 2:J=CommonUIStrings.l_NewCommentInvalidContent;break;default:J=CommonUIStrings.l_NewCommentError}var I=new F.StandardDialog;I.Ed=0;I.Bga(CommonUIStrings.l_DefaultDialogTitle,J,null)}}}addComment(J){0!==this.mode&&(this.ii.m0j(J),
0===J.Qq||this.Sri||this.selectComment(J.id),this.ga.processAction(N.a.Gnh,2))}editComment(J,L){1===this.mode&&J&&(this.ii.ZDc(J,L),this.selectComment(J.id))}dUe(){this.ii.dqk()}addReply(J,L){1===this.mode&&(J=this.ii.grh(J,L),this.selectComment(J.id,0),this.ga.processAction(N.a.Jnh,2))}deleteComment(J){if(1!==this.mode)if(2===this.mode){if(1!==J.Qq)return;this.mode=1}else return;this.E2i&&1!==J.Qq?(this.XNb=J,J=new F.StandardDialog,J.Ed=4,J.lU(2),J.q_f(CommonUIStrings.l_DefaultDialogTitle,this.zQk,
Object(m.a)(this,this.HQk,"deleteDialogHandler"))):this.VCc(J)}Vb(){this.ga.gb(N.a.Cyk,K.a.frame,r.ActionManager.Nf,64);this.ga.gb(N.a.Dyk,K.a.frame,r.ActionManager.Nf,64);this.ga.gb(N.a.knh,K.a.frame,r.ActionManager.Nf,64);this.ga.pa(N.a.CWe,K.a.frame,r.ActionManager.Nf);this.ga.pa(N.a.snh,K.a.frame,r.ActionManager.Nf);this.ga.pa(N.a.tnh,K.a.frame,r.ActionManager.Nf);this.ga.gb(N.a.Iyk,K.a.frame,r.ActionManager.Nf,64);this.ga.gb(N.a.Jyk,K.a.frame,r.ActionManager.Nf,64);this.ga.pa(N.a.Gnh,K.a.frame,
r.ActionManager.Nf);this.ga.pa(N.a.Hnh,K.a.frame,r.ActionManager.Nf);this.ga.pa(N.a.Jnh,K.a.frame,r.ActionManager.Nf);this.ga.gb(N.a.ezk,K.a.frame,r.ActionManager.Nf,64);this.ga.gb(N.a.gzk,K.a.frame,r.ActionManager.Nf,64);this.ga.gb(N.a.fzk,K.a.frame,r.ActionManager.Nf,64);this.ga.pa(N.a.Mnh,K.a.frame,r.ActionManager.Nf);this.ga.pa(N.a.d0a,K.a.frame,()=>{this.d0a();return 32})}HQk(J){1===J?this.VCc(this.XNb):(this.XNb&&this.selectComment(this.XNb.id),this.XNb=null)}VCc(J){const L=J.Rf;1===J.Qq?this.ga.processAction(N.a.CWe,
2):this.ga.processAction(N.a.snh,2);this.XNb=null;this.vJb||this.clearSelection();J=this.ii.deleteComment(J);for(let I=0;I<J.length;I++)J[I].dispose();this.r4d(L)}awb(J,L){0!==this.mode&&(this.ga.processAction(L?N.a.tnh:N.a.Mnh,2),this.ii.awb(J,L))}xra(J){this.ii.xra(J);this.mode=1;this.ga.processAction(N.a.Hnh,2)}xab(J){this.ii.xab(J);this.mode=1}xzk(J,L){this.ii.Ugn(J,L)}zLc(){}f5e(){}QJb(J,L,I,R,C){return this.i0.QJb(J,L,I,R,C)}KX(J,L,I,R,C){return this.i0.KX(J,L,I,R,C)}Raf(){var J=this.Wb.getRegion(a.AFrame.fr);
if(!J){const L=this.Wb.pe(a.AFrame.fr);J=new w.DOMFocusListing(()=>this.waa.JTc);J.uDa=!0;J.Go(3);J.Go(2);J.Go(4);J.Go(1);J.Go(6);J.Go(5);this.Wb.yja(()=>this.waa.JTc,L,J);J=this.Wb.getRegion(a.AFrame.fr);J.oOa();J.dX=!0;J.QVa=!0;L.Ar(this.Wb.uV);L.Ar(this.Wb.vV)}return J}upd(J,L){0!==this.mode&&this.ii.upd(J,L)}i2d(J,L){0!==this.mode&&this.ii.i2d(J,L)}d0a(){G.UISurfaces.UP().then(J=>{var L=Object.assign(new v.a,{target:'[data-unique-id~="ShowCommentsTopBar"]',showCloseIcon:!0,content:CommonUIStrings.l_DeepLinkedCommentDoesNotExistNotification,
calloutProps:Object.assign(new B.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});L=J.callout(L);const I=Object.assign(new z.a,{expirationOptions:Object.assign(new u.a,{displayTimeoutSeconds:10,onExpire:Object(m.a)(this,this.dismiss,"dismiss")})});this.qje=J.addNotification(L,I)})}dismiss(){G.UISurfaces.UP().then(J=>{J.removeNotification(this.qje);return this.qje=null})}static get instance(){return H._instance||(H.factory?H._instance=H.factory():null)}static set instance(J){H._instance=J}}H._instance=
null;H.factory=null;Object(D.a)(H,"CommentManager",null,[171,172,10])},1741:function(D,M,d){d.d(M,"a",function(){return a});D=d(0);var m=d(2),f=d(731);class a{constructor(){this.$i=null;this.Yg=[];this._changes=[];this.Z6a=this.TTb=this.uy=null}get Hs(){return this.uy}get Hy(){return this.Z6a}initialize(l){this.$i=l}dispose(){const l=this.Yg.length;for(let r=0;r<l;r++)this.Yg[r].dispose();this.Yg=[]}W_a(){this.uy&&this.uy.W_a();this.TTb&&this.TTb.W_a()}selectComment(l){this.clearSelection();l.pga=
1;this.uy=l;if(l.Rf){var r=Array.indexOf(this.Yg,l);for(--r;0<=r;r--){const w=this.Yg[r];if(w.id===l.Rf){w.pga=2;this.TTb=w;break}}}m.AFrameworkApplication.ua&&m.AFrameworkApplication.ua.Sb.Wla&&f.ShyRibbon.gab(1,0)}JYc(){if(!this.Yg.length)return null;let l;l=this.uy?this.FMh(this.uy,!0):this.Yg[0];this.selectComment(l);return l}KYc(){if(!this.Yg.length)return null;let l;l=this.uy?this.bkl(this.uy):this.Yg[this.Yg.length-1];this.selectComment(l);return l}clearSelection(){this.uy&&(this.uy.pga=0,
this.uy=null);this.TTb&&(this.TTb.pga=0,this.TTb=null)}ZDc(l,r){this.$i.mode=3;l.Qq=2;l.NOa=0;l.Cy=r;this.Z6a=l}dqk(){this.Z6a=null;this.$i.mode=1}grh(l,r){var w=this.xB(l);this.$i.mode=2;this.Z6a=l=d(1593).Comment.Crh(m.AFrameworkApplication.userName,l,w.Q0h,r);for(r=this.Yg.length-1;0<=r;r--)if(w=this.Yg[r],w.Rf===l.Rf||w.id===l.Rf){Array.insert(this.Yg,r+1,l);break}return l}xra(l){this.Nnh(l,2)}xab(l){this.Nnh(l,4)}deleteComment(l){const r=[],w=Array.indexOf(this.Yg,l);for(;w<this.Yg.length;){const v=
this.Yg[w];if(v.id===l.id||v.Rf===l.id)Array.removeAt(this.Yg,w),Array.add(r,v);else break}this.iWc(r,3);-1<Array.indexOf(r,this.Z6a)&&(this.Z6a=null,this.$i.mode=1);return r}awb(l,r){const w=[];let v=Array.indexOf(this.Yg,l);for(;v<this.Yg.length;){const u=this.Yg[v];if(u.id===l.id||u.Rf===l.id)u.done=r,Array.add(w,u),v++;else break}this.iWc(w,r?0:1)}aT(){return Array.clone(this.Yg)}I3b(){return!!this.Yg&&!!this.Yg.length}xB(l){for(let r=0;r<this.Yg.length;r++){const w=this.Yg[r];if(w.id===l)return w}return null}FMh(l,
r){l=Array.indexOf(this.Yg,l);return l===this.Yg.length-1?r?this.Yg[0]:null:this.Yg[l+1]}dql(l,r=!1){let w=l=Array.indexOf(this.Yg,l);do if(w=w===this.Yg.length-1?0:w+1,!r||!this.Yg[w].done)return this.Yg[w];while(w!==l);return this.Yg[l]}bkl(l){return(l=Array.indexOf(this.Yg,l))?this.Yg[l-1]:this.Yg[this.Yg.length-1]}eql(l,r=!1){let w=l=Array.indexOf(this.Yg,l);do if(w=w?w-1:this.Yg.length-1,!r||!this.Yg[w].done)return this.Yg[w];while(w!==l);return this.Yg[l]}upd(){}i2d(){}Nnh(l,r){const w=[];l.Qq=
0;Array.add(w,l);this.iWc(w,r);this.Z6a=null}static Ywb(l){return d(1593).Comment.Crh(m.AFrameworkApplication.userName,null,d(1593).Comment.jBi,l)}}Object(D.a)(a,"CommentModel",null,[10,174])},1742:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{}m.KAc="CommentPaneTextbox";m.Nud="CommentPane";m.Hyk="CommentDeleteButton";m.dzk="CommentSaveButton";m.czk="CommentReplyButton";m.Gyk="CommentCancelButton";m.Lnh="CommentTextEntry";m.izk="CommentTabHelp";Object(D.a)(m,"CommentManagerConstants",
null,[])},1743:function(D,M,d){d.d(M,"a",function(){return l});D=d(0);var m=d(471),f=d(98),a=d(29);class l{dispose(){}static cWa(r,w,v,u=null,z=!0){var B=z?"":v;r=m.a("a",r,"StandardButton "+w);r.title=B;r.tabIndex=0;B=null;u?(B=f.createClusteredImage(16,16,u,"StandardButtonImage",!0,null),B.setAttribute(a.a.Ah,a.a.xz),r.appendChild(B)):Sys.UI.DomElement.addCssClass(r,"StandardButtonNoImage");z?(u=m.a("span",null,"StandardButtonLabel"),u.innerText=v,r.appendChild(u)):Sys.UI.DomElement.addCssClass(B,
"StandardButtonImageNoText");r.setAttribute(a.a.Ah,a.a.n1);return r}static TIb(r,w){void 0!==r&&null!==r&&(r.disabled=!w,w?(w=a.a.eL,Sys.UI.DomElement.removeCssClass(r,"DisabledButton"),Sys.UI.DomElement.removeCssClass(r,"cui-disabled")):(w=a.a.Ho,Sys.UI.DomElement.containsCssClass(r,"DisabledButton")||Sys.UI.DomElement.addCssClass(r,"DisabledButton"),Sys.UI.DomElement.containsCssClass(r,"cui-disabled")||Sys.UI.DomElement.addCssClass(r,"cui-disabled")),a.a.Gq(r,a.a.yQe,w))}}Object(D.a)(l,"SimpleButtonFactory",
null,[10])},1745:function(D,M,d){d.d(M,"a",function(){return r});D=d(0);var m=d(1746),f=d(89),a=d(749),l=d(8);class r{get Zc(){return null}get Qi(){return null}get uta(){return!1}get kof(){return!1}pNe(){}fUd(){return!1}y5f(){return!1}dPh(w){return f.f(w,()=>!1)}YKa(){return null}CTd(w,v,u,z,B){v=v||[];u=u||[];const G=[];let F=0,K=0,N=0;for(;F<v.length||K<u.length;){const H=F<v.length&&K<u.length?v[F].begin<u[K].begin?v[F++]:u[K++]:F<v.length?v[F++]:u[K++];G[N]=m.a.createInstance(H.begin,H.end,w,
N,z,B);++N}return G}zei(){return!1}Kei(){return!1}BJc(w,v){if(v&&w){let u;const z=[];try{for(;u=v.exec(w);){const B=new a.a(u.index,v.lastIndex);z.push(B)}return z}catch(B){l.ULS.sendTraceTag(522846819,313,15,B instanceof SyntaxError?"Invalid regular expression":`errorName: ${B.name}`)}}return null}Q1d(){}}Object(D.a)(r,"BaseFindManagerHelper",null,[708])},1746:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f,a,l,r,w,v,u){this.id=++m.pRj;this.mug=f;this.h6a=a;this.wQg=
l;this.jGg=r;this.El=w;this.YHg=v;this.ap=u;this.next=this.previous=null}get begin(){return this.mug}get end(){return this.h6a}get type(){return this.El}$Th(){return this.ap.YKa(this.nodeId)}get nodeId(){return this.wQg}get peb(){return this.jGg}get qMd(){return this.YHg}nEk(f){this.mug=f.begin;this.h6a=f.end;this.wQg=f.nodeId;this.jGg=f.peb;this.El=f.type;this.YHg=f.qMd}static createInstance(f,a,l,r,w,v){const {FindManagerHelper:u}=d(1502);return new m(f,a,l,r,w,v,u.instance)}}m.pRj=0;Object(D.a)(m,
"FindResult",null,[726])},1747:function(D,M,d){d.d(M,"a",function(){return l});D=d(0);var m=d(43),f=d(80),a=d(15);class l{constructor(r,w,v){this.Xr=this.yHf=null;this.eXg=this.R8a=this.dXg=this.ETa=0;this.n$c=null;this._context=r;this.Hb=w;this.Ma=v;this.y_b=!1;this.Zbe=!0;this.Jun();this.fFb=this.K.$("NativeFileOpenDialogIsEnabled")}get context(){return this._context}get K(){return this.Ma}get retryCount(){return this.ETa}get Gwn(){return this.dXg}get jIb(){return this.R8a}get Hwn(){return this.eXg}v$b(r){this.Xr=
r;if(!this.y_b){if(this.Zbe){if(this.fFb&&a.a.UG){this.n$c=r.Iyd(Object(m.a)(this,this.WEf,"onFileChosen"));return}this.n$c=r.Iyd(null);if(!this.Vva(this.n$c,r))return}this.AKa(r,null)}}WEf(r){if(this.Vva(r,this.Xr)){if(a.a.UG||a.a.fj)this.n$c=r;this.AKa(this.Xr,null)}}eTc(){this.yHf&&this.yHf()}Own(r){if(!r||this.retryCount>=this.Gwn)return!1;this.ETa=this.retryCount+1;const w=new f.a(2,1,this.jIb,()=>{this.W2d(r)},110);this.Hb.$b(w);this.jIb<this.Hwn&&(this.R8a=2*this.jIb);return!0}Jun(){this.ETa=
0;this.dXg=this.K.rc("Box4UploadRetryCount",20);this.R8a=this.K.rc("Box4UploadRetryDelayStart",200);this.eXg=this.K.rc("Box4UploadRetryDelayMax",3200);this.Xr&&(this.Xr.dispose(),this.Xr=null)}}Object(D.a)(l,"FileUploader",null,[])},1748:function(D,M,d){d.d(M,"a",function(){return f});D=d(0);var m=d(2);d=d(67);class f{static O5j(a){f.Neg.addHandler(f.Vmh,a)}static Mbn(a){m.AFrameworkApplication.K.$("SqmCommandEventSourceEnabled")&&f.Neg.raiseEvent(f.Vmh,a)}}f.Vmh="CommandClickEvent";f.Neg=new d.a;
Object(D.a)(f,"CommandClickEvents",null,[])},1749:function(D,M){Object.defineProperty(M,"__esModule",{value:!0});M.ErrorCode=M.FormattingSuggestionType=void 0;(function(d){d[d.FontSize=0]="FontSize";d[d.FontFamily=1]="FontFamily";d[d.FontColor=2]="FontColor";d[d.Alignment=3]="Alignment";d[d.Indentation=4]="Indentation";d[d.Bold=5]="Bold";d[d.RightIndentation=6]="RightIndentation";d[d.Italic=7]="Italic";d[d.Underline=8]="Underline";d[d.AllCaps=9]="AllCaps";d[d.LineSpacing=10]="LineSpacing";d[d.BeforeSpacing=
11]="BeforeSpacing";d[d.AfterSpacing=12]="AfterSpacing";d[d.SpecialIndentType=13]="SpecialIndentType";d[d.SpecialIndentBy=14]="SpecialIndentBy";d[d.FontKerning=15]="FontKerning"})(M.FormattingSuggestionType||(M.FormattingSuggestionType={}));(function(d){d[d.Success=0]="Success";d[d.DocumentTooLarge=1]="DocumentTooLarge"})(M.ErrorCode||(M.ErrorCode={}))},1750:function(D,M,d){Object.defineProperty(M,"__esModule",{value:!0});M.FormattingSuggestionsSummaryAnnotation=M.FormattingSuggestionsAnnotation=
void 0;const m=d(203);class f{constructor(l){m.SchemaObject.assign(f,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_ConsistencyChecker_FormattingSuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[f.getTypeName()])}}M.FormattingSuggestionsAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=
l}static getTypeName(){return"AugLoop_ConsistencyChecker_FormattingSuggestionsSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[a.getTypeName()])}}M.FormattingSuggestionsSummaryAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1751:function(D,M){Object.defineProperty(M,"__esModule",{value:!0})},1752:function(D,M,d){Object.defineProperty(M,"__esModule",{value:!0});M.PullQuotesSignal=M.DocumentPullQuoteAnnotation=
M.PullQuoteAnnotation=void 0;const m=d(203);class f{constructor(r){m.SchemaObject.assign(f,this,r)}get metadata(){return this.M_}set metadata(r){this.M_=r}static getTypeName(){return"AugLoop_PullQuotes_PullQuoteAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(r){return m.SchemaObject.matchesTypesFor(r,[f.getTypeName()])}}M.PullQuoteAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(r){m.SchemaObject.assign(a,
this,r)}get metadata(){return this.M_}set metadata(r){this.M_=r}static getTypeName(){return"AugLoop_PullQuotes_DocumentPullQuoteAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(r){return m.SchemaObject.matchesTypesFor(r,[a.getTypeName()])}}M.DocumentPullQuoteAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(r){m.SchemaObject.assign(l,this,r)}static getTypeName(){return"AugLoop_PullQuotes_PullQuotesSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(r){return m.SchemaObject.matchesTypesFor(r,
[l.getTypeName()])}}M.PullQuotesSignal=l;l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},1753:function(D,M){Object.defineProperty(M,"__esModule",{value:!0})},1754:function(D,M){Object.defineProperty(M,"__esModule",{value:!0})},1755:function(D,M){Object.defineProperty(M,"__esModule",{value:!0})},1756:function(D,M,d){Object.defineProperty(M,"__esModule",{value:!0});M.TextToImageAnnotation=void 0;var m=d(203);D=function(){function f(a){m.SchemaObject.assign(f,this,a)}Object.defineProperty(f.prototype,
"metadata",{get:function(){return this.M_},set:function(a){this.M_=a},enumerable:!1,configurable:!0});f.getTypeName=function(){return"AugLoop_TextToImage_TextToImageAnnotation"};f.getBaseTypes=function(){return["AugLoop_Core_Annotation"]};f.typeGuard=function(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();M.TextToImageAnnotation=D},1757:function(D,M,d){Object.defineProperty(M,"__esModule",{value:!0});M.TextToImageSignal=void 0;
var m=d(203);D=function(){function f(a){m.SchemaObject.assign(f,this,a)}f.getTypeName=function(){return"AugLoop_TextToImage_TextToImageSignal"};f.getBaseTypes=function(){return["AugLoop_TextToSuggestions_TextToSuggestionSignal","AugLoop_Signals_Signal"]};f.typeGuard=function(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();M.TextToImageSignal=D},1758:function(D,M,d){Object.defineProperty(M,"__esModule",{value:!0});M.TextToImageTraceSignal=
void 0;var m=d(203);D=function(){function f(a){m.SchemaObject.assign(f,this,a)}f.getTypeName=function(){return"AugLoop_TextToImage_TextToImageTraceSignal"};f.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};f.typeGuard=function(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();M.TextToImageTraceSignal=D},1759:function(D,M){Object.defineProperty(M,"__esModule",{value:!0})},1760:function(D,M,d){Object.defineProperty(M,"__esModule",
{value:!0});M.ThemeExtractorSignal=M.ThemeExtractorAnnotation=void 0;const m=d(203);class f{constructor(l){m.SchemaObject.assign(f,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_ThemeExtractor_ThemeExtractorAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[f.getTypeName()])}}M.ThemeExtractorAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,
this,l)}static getTypeName(){return"AugLoop_ThemeExtractor_ThemeExtractorSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[a.getTypeName()])}}M.ThemeExtractorSignal=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1761:function(D,M){Object.defineProperty(M,"__esModule",{value:!0});M.TableType=void 0;D=M.TableType||(M.TableType={});D[D.Other=0]="Other";D[D.SimpleHeaded=1]="SimpleHeaded"},1762:function(D,M,d){Object.defineProperty(M,
"__esModule",{value:!0});M.TableTypeAnnotation=void 0;const m=d(203);class f{constructor(a){m.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_TableAnalysis_TableTypeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}M.TableTypeAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1763:function(D,M,d){d.d(M,"a",function(){return F});
D=d(0);var m=d(1515),f=d(1561),a=d(2),l=d(16),r=d(1503),w=d(35),v=d(8),u=d(9),z=d(19),B=d(134),G=d(11);class F{constructor(K=2E3){this.HXj=/(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)?/g;this.N7a=K}U9l(){F.X1();return!0}$km(){return!0}zth(K,N,H){K=Object.assign(new r.a,{selection:Object.assign(new m.a,{neighborhood:K.neighborhood,mentionStart:K.mentionStart,mentionLength:K.mentionLength}),entryPoint:N,launchData:H});return w.c(K)}getSelectedText(){const K=
F.X1();return this.ZGd(K)}agf(){const K=F.X1();return this.sGl(K)}ZGd(K){return this.fXh(K,!0)}sGl(K){return this.fXh(K,!1)}fXh(K,N){try{return this.rGl(K,N)}catch(H){v.ULS.sendTraceTag(545869845,1303,15,"Error accessing selection: {0}",H)}return Object.assign(new f.a,{neighborhood:"",mentionStart:0,mentionLength:0})}rGl(K,N){var H=null;let J=!1;N&&K&&K.VD&&z.SelectionEditor.xf(K.Qa)&&z.SelectionEditor.Yfb(K.Qa)&&(v.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),
J=z.SelectionEditor.xf(K.Qa),(H=z.SelectionEditor.Q1(K.Qa,!1))&&H.VD&&0<=H.Qa.cpBegin&&0<=H.Qa.cpEnd&&1>=H.Qa.cpEnd-H.Qa.cpBegin&&(H=null));H&&(K=H);if(!K)return Object.assign(new f.a,{neighborhood:"",mentionStart:0,mentionLength:0});const L=new Sys.StringBuilder;H=N=0;const I=[],R=K.length;let C=null;for(let X=0;X<R;X++){const V=K.J(X);if(!G.ParagraphReader.oc(V.node)||Array.contains(I,V.node.pn))continue;I.push(V.node.pn);const Y=G.ParagraphReader.text(V.node);a.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartLookupUrlExtIsEnabled",
!1)&&J&&(C=this.B4k(Y,V.cpBegin));let ca=Y,fa=0;var P=G.ParagraphReader.Vg(V.node,!0,!0,!0);let sa=G.ParagraphReader.Vg(V.node,!1,!0,!0),ia=0;for(;ca.length<this.N7a&&(P||sa);){if(!(ia%2)&&P){var W=G.ParagraphReader.text(P);W&&(ca=W+" "+ca,fa+=W.length+1);P=G.ParagraphReader.Vg(P,!0,!0,!0)}1===ia%2&&sa&&(ca=(W=G.ParagraphReader.text(sa))?ca+" "+W:ca,sa=G.ParagraphReader.Vg(sa,!1,!0,!0));ia++}P=X===R-1;X||-1===V.cpBegin||(N=V.cpBegin);H+=P&&-1!==V.cpEnd?V.cpEnd:Y.length;L.append(ca);a.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartLookupUrlExtIsEnabled",
!1)&&J&&C&&(N=C.start,H=C.start+C.length);N+=fa;H+=fa;P||(L.append(" "),H++)}for(K=B.AParagraphNode.dU(L.toString()," ");N<H&&l.a.Yu(K.charCodeAt(N));)N++;for(;H>N&&l.a.Yu(K.charCodeAt(H-1));)H--;return this.M8j(K,N,H)}B4k(K,N){for(var H;null!==(H=this.HXj.exec(K));){const J=H.index;H=H[0].length;if(N>=J&&N<=J+H)return{start:J,length:H}}return null}M8j(K,N,H){if(K.length>this.N7a){var J=H-N;if(J>this.N7a)K=K.substr(N,this.N7a),H=this.N7a,N=0;else{J=Math.max(N-Math.floor((this.N7a-J)/2),0);let L;L=
Math.min(J+this.N7a,K.length);J=Math.max(L-this.N7a,0);N-=J;H-=J;K=K.substring(J,L)}}return Object.assign(new f.a,{neighborhood:K,mentionStart:N,mentionLength:H-N})}static X1(){var K=u.App.xa.jb.Jc;if(!K)return v.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;K=K.Cb;return K&&K.ib&&K.ib.length?K.ib.kb:(v.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),null)}}Object(D.a)(F,"Box4InsightsSelection",null,[314,315])},1764:function(D,M,d){d.d(M,"a",function(){return m});
D=d(0);class m{constructor(){this.y=this.x=0}}Object(D.a)(m,"IPoint",null,[])},1765:function(D,M,d){d.d(M,"a",function(){return a});D=d(0);var m=d(16),f=d(8);d=d(1528);class a extends d.a{constructor(l,r,w,v,u){super(l,r,u);this.Xj=w;this.YZg=u}ugc(l){let r;if(this.cP&&!l)return f.ULS.sendTraceTag(594408835,307,10,"No htmlDomContent"),{returnValue:!1,Ura:null};if(this.YZg){if(this.Xj)return r=this.Xj.kJf(l,!1),{returnValue:!0,Ura:r};f.ULS.sendTraceTag(592269661,307,10,"_clipboardDataHelper should not be null")}r=
document.createElement("div");l=l.split(RegExp("\r\n|\r|\n"));for(var w=0;w<l.length-1;w++){const v=document.createElement("p");v.innerText=this.WPc(l[w]);r.appendChild(v)}w=document.createElement("span");w.innerText=m.a.pEc(l[l.length-1]);r.appendChild(w);return{returnValue:!0,Ura:r}}WPc(l){return m.a.pEc(l.length?l:" ")}}Object(D.a)(a,"MultiLineTextImportStrategy",d.a,[])},1768:function(D,M){Object.defineProperty(M,"__esModule",{value:!0})},1769:function(D,M){Object.defineProperty(M,"__esModule",
{value:!0});M.SuggestionCategory=void 0;D=M.SuggestionCategory||(M.SuggestionCategory={});D[D.TextRelatedImage=0]="TextRelatedImage";D[D.AbstractImage=1]="AbstractImage";D[D.Icon=2]="Icon"},1770:function(D,M){Object.defineProperty(M,"__esModule",{value:!0})},1771:function(D,M){Object.defineProperty(M,"__esModule",{value:!0})},1772:function(D,M,d){Object.defineProperty(M,"__esModule",{value:!0});M.TextToSuggestionSignal=void 0;var m=d(203);D=function(){function f(a){m.SchemaObject.assign(f,this,a)}
f.getTypeName=function(){return"AugLoop_TextToSuggestions_TextToSuggestionSignal"};f.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};f.typeGuard=function(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();M.TextToSuggestionSignal=D},1773:function(D,M,d){d.d(M,"a",function(){return r});D=d(0);var m=d(80),f=d(195),a=d(8),l=d(120);class r{constructor(w,v,u,z,B,G,F,K,N){this.yod=0;this.hV=null;this.zUa="";this.HQb=this.coe=
!1;this.xGa=this.g5=null;this.VRf=!1;this.IPb=null;this.u_n=H=>{this.xGa===H&&(this.xGa=null,this.g5?this.zUa=this.Aca.xUc(this.hV.text):(this.ZDf(),this.findInternal(null)),this.N5i())};this.findInternal=()=>{this.g5=null;if(!this.gUe())if(!this.Aca.pGb(this.zUa).length)this.dab(),this.hkb(!0);else if(!this.XSf())switch(this._state){case 0:this.Koo();break;case 1:this.IIi()}};this.u6a=w;this.Aca=v;this.FBj=u;this.ap=z;this.lwe=B;this.ysb=G;this.QBj=F;this.JPb=K;this.Ej=N;this._state=2;this.FK=0}get k9f(){return this.yod}set k9f(w){this.yod=
w}get phc(){return this.yod}set phc(w){this.yod=w}get taskManager(){return this.lwe.value}get SHb(){return this.ysb.value}get XXc(){return this.QBj.value}get T6k(){return this.coe}hkb(w){(this.coe=w)&&this.u6a&&this.u6a.S0b()}get X7e(){return null}get FBd(){return this.IPb}find(w){this.hV=w;this.hvk();this.xGa=new m.a(2,1,this.k9f,this.u_n,51);this.taskManager.$b(this.xGa)}xVa(){}UXc(){}C0i(){return!1}YHd(){}ZHd(){}K2h(){return!1}hvk(){this.g5&&(this.taskManager.ef(this.g5),this.g5=null);this.xGa&&
(this.taskManager.ef(this.xGa),this.xGa=null)}Koo(){var w=(new Date).getTime();this.vui();const v=this.Loo(w);this._state||(this.g5=new m.a(2,1,this.phc,this.findInternal,52),this.taskManager.$b(this.g5));w=(new Date).getTime()-w;a.ULS.sendTraceTag(17306246,313,50,"{0}",{["Extension Walk Time"]:w,["Count"]:v})}qif(w,v,u=!0){this.jkh(w);if(Object(l.a)(58,w))if(12===w.type)this.nPl(w,v,this.HQb,u);else{const z=this.ap.BJc(w.YKa(),this.FBd);u&&(z&&0<z.length?this.ZOa(w,z):w.Hja());u=this.ap.CTd(w.id,
z,null,v,this.HQb);this.Rpd(w.id,u,w,v);this.Jxf(w)}}nPl(w,v,u,z=!0){const B=[];var G=this.ap.dPh(w);if(!f.a.nf(G)&&(this.Jxf(w),z))for(var F of G)G=this.ap.BJc(F.YKa(),this.FBd),f.a.nf(G)?this.Hja(F):(this.ZOa(F,G),B.push(G));F=this.ap.BJc(w.YKa(),this.FBd);this.Hja(w);!f.a.nf(F)&&z&&this.ZOa(w,F);u=this.ap.CTd(w.id,F,B,v,u);this.Rpd(w.id,u,w,v)}Loo(w){let v=this._state=0;const u=this.WXh();this.uEi();const z=this.YZi();do this.EHf(),v++;while(this.jXe(u)&&(new Date).getTime()-w<r.Joi);z&&z.dispose();
this.KDf();return v}ZDf(){}N5i(){}gUe(){return!1}dab(){}XSf(){return!1}IIi(){}vui(){}jkh(){}ZOa(){}Hja(){}Jxf(){}Rpd(){}KDf(){}WXh(){return null}uEi(){}YZi(){return null}EHf(){}jXe(){return!1}}r.Joi=200;Object(D.a)(r,"BaseFindManager",null,[1306])},1774:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f,a,l){this.rootNode=f;this.tva=a;this.Y0b=l}}Object(D.a)(m,"FindNodeContext",null,[])},1780:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(){this.b0f=
this.formatting=null}}Object(D.a)(m,"TextFormattingActionData",null,[])},1781:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f,a=null,l=null,r=null){this.iconSet={};this.iconSet["default"]=f;this.iconSet.icon16=a;this.iconSet.icon24=l;this.iconSet.icon32=r}}Object(D.a)(m,"IconSetContainer",null,[])},1784:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);d=d(311);class m extends d.a{constructor(){super()}}m.mYe="conversionRequestType";m.fKf="png";m.X9e="gc2json";m.strict=
"strict";m.k3k="existingcontent";m.error="error";Object(D.a)(m,"GraphicsEditorParameters",d.a,[])},1797:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f){this.pnb=0;this.ifd=isFinite(f)?Math.max(f,8):8;this.Qp=Array(this.ifd);this.aj=this.V9a=this.rTa=0;this.cyg=this.oNh(this.ifd)}get count(){return this.aj}get isEmpty(){return!this.count}enqueue(f){this.count===this.pnb&&this.GZl();this.Qp[this.V9a]=f;this.V9a++;this.V9a===this.pnb&&(this.V9a=0);this.aj=this.count+1}dequeue(){if(!this.count)throw Error.create("Empty Queue");
const f=this.Qp[this.rTa];this.rTa++;this.rTa===this.pnb&&(this.rTa=0);this.aj=this.count-1;this.count<=this.cyg&&this.IOk();return f}Sy(){if(!this.count)throw Error.create("Empty Queue");return this.Qp[this.rTa]}GZl(){this.xYi(2*this.pnb)}IOk(){const f=Math.max(this.pnb/2,this.ifd);this.count>f||this.xYi(f)}xYi(f){const a=Array(f);let l=0;if(this.rTa<this.V9a||!this.count)for(var r=this.rTa;r<this.V9a;r++)a[l]=this.Qp[r],l++;else{for(r=this.rTa;r<this.pnb;r++)a[l]=this.Qp[r],l++;for(r=0;r<this.V9a;r++)a[l]=
this.Qp[r],l++}this.Qp=a;this.pnb=f;this.rTa=0;this.V9a=l;this.cyg=this.oNh(f)}oNh(f){return f<=this.ifd?-1:Math.floor(.25*f)}}Object(D.a)(m,"Queue",null,[])},1824:function(D,M,d){d.r(M);D=d(0);var m=d(2),f=d(80),a=d(1895),l=d(8),r=d(72),w=d(43),v=d(120),u=d(244),z=d(648),B=d(389),G=d(93),F=d(3),K=d(9),N=d(97),H=d(49),J=d(998),L=d(6),I=d(101);class R extends N.a{constructor(){super(new I.a(33));this.Z7e=this.UTf=0}fLd(){return 0}VDf(){const Ra=new H.GraphTransaction(3);Ra.Db(this);const ab=new L.GraphIterator;
ab.set(this);if(ab.RC()){const zb=ab.Wd();ab.set(zb);const Qa=J.b(ab,this.UTf,this.Z7e),yb=new L.GraphIterator;yb.set(this);yb.Wd();yb.Fg();Qa&&ab.currentNode!==zb&&yb.Sf(ab.currentNode,-2)}Ra.dispose()}}Object(D.a)(R,"FindTrackingNode",N.a,[]);var C=d(19),P=d(54),W=d(11),X=d(1773),V=d(1774);class Y{constructor(Ra){this.Xc=Ra;Ra=[];Ra.push(1);this.T1f=Ra}bPh(Ra){const ab=this.Xc.Ck();ab.set(Ra);const zb=[];ab.Bb(8)&&(ab.kd(8),zb.push(new V.a(ab.currentNode,Ra,1)));return zb}static YD(){return new Y(new z.a)}static get instance(){return null!=
Y.qkg?Y.qkg:Y.qkg=Y.YD()}}Object(D.a)(Y,"FindContextHelper",null,[293]);var ca=d(1502),fa=d(385),sa=d(83),ia=d(17);class ea{constructor(Ra,ab,zb,Qa,yb,lb,Eb,bc,Pb){this.$n=null;this.kQb=this.Npe=!1;this.P5a=this.Isg=this.i5a=null;this.YWg=!1;this.Q2=(Va,oa)=>{Va=oa.node;oa.property===ia.a.lo&&this.KNc(Va)&&this.UAb(Va,3)};this.Shb=(Va,oa)=>{Va=oa.node;this.KNc(Va)&&this.UAb(Va,2)};this.Cfa=(Va,oa)=>{Va=oa.node;oa=oa.Cof;!this.$z.T6k&&oa||!this.KNc(Va)||this.UAb(Va,1)};this.processDirtyNodes=()=>{const Va=
this.le.fg("UserAction","ProcessDirtyNodesInFindResultsTime");this.$n=null;const oa=this.Hc.Rc(3);oa.Db(this.ap.Zc);0<this.addedNodes.count&&(this.kQb=!0,this.twg(this.addedNodes,this.$z.Ej));0<this.$Cc.count&&this.twg(this.$Cc,this.$z.Ej);if(0<this.hab.count){const pa=!this.CQj(this.hab,this.$z,this.ap,this.BQj);this.kQb=this.kQb||pa}oa.dispose();this.$z.Ej.Mlb();this.Yjb(this.kQb);this.tTi();Va.stop()};this.vAn=()=>{this.Vtd();if(0<this.hab.count||0<this.addedNodes.count||0<this.$Cc.count)this.$n=
new f.a(2,1,500,this.processDirtyNodes,53),this.Hb.$b(this.$n)};this.$z=Ra;this.UU=ab;this.ap=zb;this.Hb=Qa;this.Hc=yb;this.twg=lb;this.CQj=Eb;this.BQj=bc;this.le=Pb;this.reset();this.tTi=this.vAn;this.ap.Q1d(this.Q2,this.Cfa,this.Shb)}get hab(){return this.i5a}get addedNodes(){return this.Isg}get $Cc(){return this.P5a}get HQi(){return this.YWg}get JTl(){return 0<this.hab.count||0<this.$Cc.count}start(){this.Npe=!0;this.Yjb(!1)}stop(){this.reset()}reset(){this.Npe=!1;this.Yjb(!1);this.i5a=new fa.a;
this.Isg=new fa.a;this.P5a=new fa.a;this.Vtd()}KNc(Ra){return!!Ra.Nc&&!!this.ap.Qi&&Ra.Nc.id.equals(this.ap.Qi.id)}UAb(Ra,ab){if(this.Npe&&Object(v.a)(58,Ra)&&!this.$z.SHb.tXc)if(this.$z.Ej.m3a||this.$z.Ej.vgb.length){switch(ab){case 1:this.hab.xb(Ra.id)||this.addedNodes.Z(Ra.id,Ra);break;case 2:this.hab.xb(Ra.id)&&this.hab.remove(Ra.id);this.addedNodes.xb(Ra.id)?this.addedNodes.remove(Ra.id):this.$Cc.Z(Ra.id,Ra);break;case 3:this.hab.Z(Ra.id,Ra)}this.tTi()}else 2!==ab&&this.Yjb(this.kQb=!0)}Vtd(){this.$n&&
(this.Hb.ef(this.$n),this.$n=null)}Yjb(Ra){this.HQi!==Ra&&(this.YWg=Ra,this.UU.Yjb(Ra));Ra||(this.kQb=!1)}static YD(Ra,ab){return new ea(Ra,ab,ca.FindManagerHelper.instance,sa.a.instance,new B.a,ea.Duk,ea.Oln,ea.Nln,K.App.xa.iq)}static createInstance(Ra,ab){return ea._instance||(ea._instance=ea.YD(Ra,ab))}static Oln(Ra,ab,zb,Qa){let yb=!1;const lb=ea.d_h(Ra,ea.dEm);for(let Eb=0;Eb<lb.length;++Eb){const bc=!Qa(lb[Eb],ab,zb);yb=yb||bc;Ra.remove(lb[Eb].id)}return!yb}static Nln(Ra,ab,zb){const Qa=ab.Ej;
Ra.Hja();const yb=Ra.id,lb=Qa.T2b(yb);if(lb)ab=zb.BJc(Ra.YKa(),ab.FBd),zb=zb.CTd(yb,ab,null,lb.type,lb.qMd),Ra.ZOa(ab),Qa.S2d(yb,zb);else return!1;return!0}static Duk(Ra,ab){const zb=ea.d_h(Ra,ea.cEm);for(let Qa=0;Qa<zb.length;++Qa){const yb=zb[Qa],lb=yb.id;yb.Hja();ab.WWc(lb);Ra.remove(lb)}}static d_h(Ra,ab){const zb=[];let Qa=ab;Ra.forEach((yb,lb)=>{zb.push(lb);--Qa;return Qa?!0:!1});return zb}}ea.dEm=5;ea.cEm=15;ea._instance=null;Object(D.a)(ea,"FindResultAppEventCoordinator",null,[1333]);class da{constructor(Ra,
ab){this.Htb=this.UMb=0;this.Wkc=this.uvc=this.oha=null;this.hVb=0;this.rqb=null;this.UU=Ra;this.Xha=ab;this.DTa=new fa.a;this.Csb=new fa.a;this.X7a=new fa.a;this.X5a=new fa.a;this.CTa=new fa.a(0);this.Ytc=new fa.a;for(Ra=0;Ra<ab.length;++Ra)this.CTa.Z(ab[Ra],0);this.vgb=[]}get MD(){return this.oha}set MD(Ra){this.oha=Ra;Ra=Array(1);Ra[0]=this.oha;this.UU.BKa(3,Ra)}get x7(){return this.uvc}set x7(Ra){this.uvc=Ra}get J1(){return this.Wkc}set J1(Ra){this.Wkc=Ra}get mAa(){let Ra=null;for(const ab of this.Xha)if(Ra=
this.DTa.J(ab))break;return Ra}get gMe(){return this.UMb}u6d(Ra){Ra!==this.UMb&&(this.UMb=Ra)}get Vga(){return this.Htb}Hdc(Ra){Ra!==this.Htb&&(this.Htb=Ra,this.UU&&!this.Htb&&(this.UU.T4d(0),this.UU.p6d(0)))}get m3a(){return this.hVb}get O7b(){return this.rqb}nMe(Ra,ab){if(Ra&&!(0>=Ra.length)){var zb=Ra[0].type,Qa=ab,yb=Qa?Qa.next:this.DTa.J(zb);Qa||this.DTa.Z(zb,Ra[0]);for(const lb of Ra){const Eb=lb;this.Ytc.Z(Eb.id,Eb);Qa&&(Qa.next=Eb);Eb.previous=Qa;Qa=Eb}Qa&&(Qa.next=yb);yb&&(yb.previous=Qa);
ab&&Ra[0].nodeId.equals(ab.nodeId)||this.X7a.Z(Ra[0].nodeId,Ra[0]);!yb&&Qa&&this.Csb.Z(Qa.type,Qa);this.O7b===ab&&(this.rqb=Qa);this.CTa.Z(zb,this.CTa.J(zb)+Ra.length);this.Hdc(this.Vga+Ra.length);this.hVb=this.m3a+Ra.length;this.UU&&this.UU.BKa(0,Ra)}}Vpd(Ra){!Ra||0>=Ra.length||this.nMe(Ra,this.Csb.J(Ra[0].type))}O5g(Ra){!Ra||0>=Ra.length||(this.O7b&&this.O7b.type!==Ra[0].type&&(this.rqb=null),this.nMe(Ra,this.O7b))}WWc(Ra){const ab=this.T2b(Ra);if(ab){Ra=ab;for(var zb=0;Ra;){++zb;if(!Ra.next||!Ra.nodeId.equals(Ra.next.nodeId))break;
Ra=Ra.next}this.EMi(ab,Ra)}else l.ULS.sendTraceTag(4069027,313,15,"RemoveResultsForNode called for node not in cache: {0}",Ra.toString())}EMi(Ra,ab){let zb=0,Qa=0;const yb=[];let lb=Ra;for(;lb!==ab.next;){const Eb=this.Vei(lb);this.X7a.J(lb.nodeId).id===lb.id&&(lb.next&&lb.next.nodeId.equals(lb.nodeId)?(this.X7a.Z(lb.nodeId,lb.next),Eb&&this.X5a.Z(lb.nodeId,lb.next)):(this.X7a.remove(lb.nodeId),Eb&&this.X5a.remove(lb.nodeId)));this.O7b&&this.O7b.id===lb.id&&(this.rqb=Ra.previous);this.x7&&this.x7.id===
lb.id&&(this.x7=this.yef(lb,Ra));this.J1&&this.J1.id===lb.id&&(this.J1=this.yef(lb,Ra));this.MD&&this.MD.id===lb.id&&(this.MD=this.yef(lb,Ra));this.Ytc.remove(lb.id);yb.push(lb);lb=lb.next;Eb?++Qa:++zb}Ra.previous?Ra.previous.next=ab.next:ab.next?this.DTa.Z(ab.type,ab.next):this.DTa.remove(ab.type);ab.next?ab.next.previous=Ra.previous:Ra.previous?this.Csb.Z(Ra.type,Ra.previous):this.Csb.remove(Ra.type);ab.next=null;Ra.previous=null;this.CTa.Z(Ra.type,this.CTa.J(Ra.type)-zb);this.Hdc(this.Vga-zb);
this.hVb=this.m3a-(zb+Qa);this.UU&&this.UU.BKa(1,yb)}S2d(Ra,ab){const zb=this.T2b(Ra);if(zb){const Qa=[],yb=[],lb=[];let Eb=zb,bc,Pb=0;do Pb<ab.length?(Eb.nEk(ab[Pb]),Qa.push(Eb)):(yb.push(Eb),this.x7&&this.x7.id===Eb.id&&0<Qa.length&&(this.x7=Qa[Qa.length-1])),++Pb,bc=Eb,Eb=Eb.next;while(Eb&&bc.nodeId.equals(Eb.nodeId));for(;Pb<ab.length;++Pb)lb.push(ab[Pb]);0<yb.length&&this.EMi(yb[0],yb[yb.length-1]);0<lb.length&&this.nMe(lb,0<Qa.length?Qa[Qa.length-1]:zb);ab=Qa.length;if(0<ab){if(this.X5a.xb(Ra)){this.X5a.remove(Ra);
this.Hdc(this.Vga+ab);let Va,oa;(Va=this.CTa).Z(oa=Qa[0].type,Va.J(oa)+ab)}this.UU&&this.UU.BKa(4,Qa)}}else l.ULS.sendTraceTag(4069056,313,15,"ReplaceResultsForNode: NodeId not found in cache nodeId={0}",Ra.toString())}Flh(){this.X7a=new fa.a;this.X5a=new fa.a;this.DTa=new fa.a;this.Csb=new fa.a;this.Ytc=new fa.a;for(let Ra=0;Ra<this.Xha.length;++Ra)this.CTa.Z(this.Xha[Ra],0);this.MD=null;this.u6d(0);this.J1=this.x7=this.rqb=null;this.Hdc(0);this.hVb=0;this.UU&&this.UU.BKa(2,null)}Tni(){this.X5a=
new fa.a;this.X7a.forEach((Ra,ab)=>{this.X5a.Z(Ra,ab);return!0});for(let Ra=0;Ra<this.Xha.length;++Ra)this.CTa.Z(this.Xha[Ra],0);this.MD=null;this.u6d(0);this.rqb=null;this.Hdc(0);this.UU&&this.UU.BKa(2,null)}T2b(Ra){return this.X7a.xb(Ra)?this.X7a.J(Ra):null}fk(Ra){let ab=null;this.Ytc.xb(Ra)&&(ab=this.Ytc.J(Ra));return ab}nPh(Ra){return this.DTa.xb(Ra)?this.DTa.J(Ra):null}Wul(Ra){return this.Csb.xb(Ra)?this.Csb.J(Ra):null}Mlb(){var Ra=0;if(this.MD){Ra=0;const Qa=this.MD.type;var ab=this.DTa.J(Qa);
if(ab){for(var zb=1;ab&&this.MD.id!==ab.id;)this.Vei(ab)||++zb,ab=ab.next;ab&&(Ra=zb)}if(ab){ab=0;for(zb=0;zb<this.Xha.length&&this.Xha[zb]!==Qa;++zb)ab+=this.CTa.J(this.Xha[zb]);Ra=ab+Ra}else l.ULS.sendTraceTag(4069057,313,10,"UpdateActiveIndexFromActiveResult, active result not found in cache, setting it to null"),this.MD=null,Ra=0}this.u6d(Ra);this.UU&&(this.UU.T4d(this.gMe),this.UU.p6d(this.Vga))}$Xa(Ra){return this.QFd(Ra,!1)}zGd(Ra){return this.QFd(Ra,!0)}QFd(Ra,ab){let zb=ab?Ra.previous:Ra.next,
Qa=Ra.type;for(;!zb&&(Qa=this.ryl(Qa,ab),zb=ab?this.Wul(Qa):this.nPh(Qa),Qa!==Ra.type););return zb||Ra}e2b(Ra){return this.rMh(Ra,!1)}QRh(Ra){return this.rMh(Ra,!0)}rMh(Ra,ab){let zb=this.QFd(Ra,ab);for(;zb.nodeId.equals(Ra.nodeId)&&zb.id!==Ra.id;)zb=this.QFd(zb,ab);return zb}ryl(Ra,ab){let zb=0;for(let Qa=0;Qa<this.Xha.length;++Qa)if(Ra===this.Xha[Qa]){zb=Qa;break}ab?(--zb,0>zb&&(zb=this.Xha.length-1)):(++zb,zb===this.Xha.length&&(zb=0));return this.Xha[zb]}TPi(){this.rqb=null}yef(Ra,ab){Ra=this.$Xa(Ra);
Ra.id===ab.id&&(Ra=null);return Ra}Vei(Ra){return this.X5a.xb(Ra.nodeId)}static createInstance(Ra,ab,zb=!1){return zb?new da(Ra,ab):da._instance||(da._instance=new da(Ra,ab))}}da._instance=null;Object(D.a)(da,"FindResultManager",null,[1305]);class ja{constructor(Ra,ab){this.KOl=zb=>{const Qa=this.ap.Qi.Eb(zb.nodeId);if(Qa){if(this.bB.MD){var yb=this.ap.Qi.Eb(this.bB.MD.nodeId);(yb=Object(r.a)(58,yb))?yb.ilh():l.ULS.sendTraceTag(4069060,313,15,"{0}",{["GoToResultInternal"]:"ActiveHitNodeNotFound",
["NodeId"]:this.bB.MD.nodeId})}Qa.zxf(zb.peb,zb.type)?(this.bB.MD=zb,l.ULS.sendTraceTag(4065305,313,50,"{0}",{["GoToResultInternal"]:"Success",["ResultId"]:zb.id})):d(1824).FindManager.instance.K2h()?l.ULS.sendTraceTag(4575581,313,15,"{0}",{["GoToResultInternal"]:"Failure",["NodeId"]:Qa.id,["HitIndexInNode"]:zb.peb,["ResultId"]:zb.id}):l.ULS.sendTraceTag(4069061,313,10,"{0}",{["GoToResultInternal"]:"Failure",["NodeId"]:Qa.id,["HitIndexInNode"]:zb.peb,["ResultId"]:zb.id});this.bB.Mlb()}else l.ULS.sendTraceTag(4069059,
313,10,"{0}",{["GoToResultInternal"]:"Invalid findResult.NodeId",["NodeId"]:zb.nodeId})};this.bB=Ra;this.ap=ab;this.$hf=this.KOl}s0h(){const Ra=this.bB.MD?this.bB.$Xa(this.bB.MD):this.bB.mAa;this.$hf(Ra)}JOl(){const Ra=this.bB.MD?this.bB.zGd(this.bB.MD):this.bB.mAa;this.$hf(Ra)}v0h(Ra){const ab=this.bB.fk(Ra);ab?this.$hf(ab):l.ULS.sendTraceTag(4069058,313,10,"{0}",{["GoToResult"]:"Invalid FindResult",["ResultId"]:Ra})}static YD(Ra){return new ja(Ra,ca.FindManagerHelper.instance)}static createInstance(Ra){return ja._instance||
(ja._instance=ja.YD(Ra))}}ja._instance=null;Object(D.a)(ja,"FindResultNavigator",null,[1304]);var Ga=d(16),ya=d(1191);N=d(107);class ta{static pGb(Ra){const ab=[];var zb=RegExp('"[^"\\r\\n]*"',"ig"),Qa=Ra.match(zb);let yb;if(Qa&&0<Qa.length)for(yb=0;yb<Qa.length;yb++){var lb=Qa[yb].split('"').join("");lb=lb.trim();lb=lb.split(ta.cKb).join(" ");if(""!==lb){ab.push(lb);var Eb=lb.split(ta.punctuation).join(" ");Eb=Eb.trim();Eb=Eb.split(ta.cKb).join(" ");""!==Eb&&Eb!==lb&&ab.push(Eb)}}Ra=Ra.split(zb).join(" ");
zb=ya.a.instance.Thl(Ra);if(!zb.length)return ab.sort(ta.U4i),ab;Qa=zb[0];for(yb=1;yb<zb.length;yb++)if(Eb=zb[yb],2!==Qa.AK||2!==Eb.AK)lb=Ra.substring(Qa.cp,Eb.cp),lb=lb.trim(),ta.vhi(lb,Qa)&&ab.push(lb),Qa=Eb;lb=Ra.substring(Qa.cp,Ra.length);lb=lb.trim();ta.vhi(lb,Qa)&&ab.push(lb);ab.sort(ta.U4i);return ab}static vhi(Ra,ab){return""!==Ra&&'"'!==Ra&&1!==ab.AK}static osn(Ra){for(let ab=0;ab<Ra.length;ab++)Ra[ab]=Ra[ab].split(ta.cKb).join("\\s+");return Ra}static U4i(Ra,ab){return Ra.length>ab.length?
-1:Ra.length===ab.length?0:1}}ta.punctuation=RegExp("[\\[\\]\\\\\\^\\$\\.\\|\\+\\(\\)\\?\\*\\-_=,;:%!'<>/@#&{}]");ta.cKb=RegExp("\\s+");ta.Ihn=[new N.a(RegExp("\\[","g"),"\\["),new N.a(RegExp("\\]","g"),"\\]"),new N.a(RegExp("\\\\","g"),"\\\\"),new N.a(RegExp("\\^","g"),"\\^"),new N.a(RegExp("\\$","g"),"\\$"),new N.a(RegExp("\\.","g"),"\\."),new N.a(RegExp("\\|","g"),"\\|"),new N.a(RegExp("\\+","g"),"\\+"),new N.a(RegExp("\\(","g"),"\\("),new N.a(RegExp("\\)","g"),"\\)"),new N.a(RegExp("\\?","g"),
"\\?"),new N.a(RegExp("\\*","g"),"\\*")];Object(D.a)(ta,"SearchAndFindUtils",null,[]);class ua{xUc(Ra){return Ga.a.Sda(Ra,ta.Ihn)}pGb(Ra){Ra=ta.pGb(Ra);return Ra=ta.osn(Ra)}yEi(){return null}FPd(){return!1}static get instance(){return null!=ua.Qkg?ua.Qkg:ua.Qkg=new ua}}Object(D.a)(ua,"QueryProcessor",null,[921]);var Sa=d(709),ka=d(22),ha=d(20),Ca=d(14),Pa=d(33),Xa=d(646),qa=d(749),Ea=d(291),Ia=d(247);class na{constructor(){this.uXc=this.transaction=null;this.Xfc=this.XRf=0;this.URf=this.abb=null}}
Object(D.a)(na,"ReplaceAllContext",null,[]);class Na{constructor(Ra,ab,zb,Qa,yb,lb,Eb,bc,Pb,Va,oa){this.LQm=(pa,Ya,Ja,nb,Bb)=>{let mb=null;if(pa>Ya)for(mb=Ja;0<Ya&&mb.nodeId.equals(Bb.id);)mb=this.bB.$Xa(mb),--Ya;else 0<pa?mb=this.bB.e2b(Ja):nb.nodeId!==Bb.id&&(mb=nb);return mb};this.wlh=()=>{const pa=this.bB.vgb;if(pa&&0<pa.length){const Ya=this.Hc.Rc(3);Ya.Db(this.ap.Qi.Eb(pa[0]));for(let Ja=0;Ja<pa.length;++Ja){const nb=this.ap.Qi.Eb(pa[Ja]);nb?nb.Hja(!1,!0):l.ULS.sendTraceTag(4069064,313,10,"Last replaced node not found in object Space, NodeId: {0}",
pa[Ja])}Ya.dispose();Array.clear(this.bB.vgb)}};this.OVm=(pa,Ya)=>{this.Otc=!0;this.fMi();const Ja=new na;Ja.uXc=pa?pa:"";Ja.URf=Ya;Ja.Xfc=this.bB.Vga;pa=this.Hc.Rc(15);pa.Db(this.ap.Zc);Ja.transaction=pa;this.$2k(Ja,pa)};this.eQm=(pa,Ya)=>{pa=new Sa.a(null,this.B8m,pa);const Ja=this.ap.Zc;Ja&&Ja.MG().sF.p9(9);pa.ll("ReplaceAll");Ya.ODa(pa);pa.run()};this.NTm=(pa,Ya)=>{pa=this.le.fg("UserAction","OnProcessReplaceAll");if(this.ohm(Ya))return this.aAk(Ya),!1;let Ja=Ya.abb;Ja||(Ja=this.bB.mAa);Ya.abb=
this.bB.e2b(Ja);const nb=this.ap.Qi.Eb(Ja.nodeId);if(!nb)return l.ULS.sendTraceTag(4065307,313,10,"ReplaceAll: Node for result with id: {0} and nodeId: {1}, Not Found!",Ja.id,Ja.nodeId),!0;const Bb=nb.bLa();if(Bb&&Bb.length)if(this.Crk(nb,Bb[0].begin,Bb[0].end))l.ULS.sendTraceTag(5007254,313,50,"ReplaceAll: Skipping node: {0} as Paragraph is locked",nb.id);else{let mb=0;for(let Qb=0;Qb<Bb.length;++Qb){Ya.XRf+=1;const Vb=this.replaceText(this.$z.X7e,nb,Ya.uXc,Pa.a.createTextRange(nb,Bb[Qb].begin+mb,
Bb[Qb].end+mb));mb+=Ya.uXc.length-(Bb[Qb].end-Bb[Qb].begin)+Vb;nb.xXf(0,Ya.uXc.length)}0<Ya.uXc.length&&this.bB.vgb.push(Ja.nodeId)}else l.ULS.sendTraceTag(4065308,313,15,"ReplaceAll: No hits found for result with id: {0} and nodeId: {1}!",Ja.id,Ja.nodeId);pa.stop();return!0};this.HOm=pa=>{pa.transaction.dispose();this.Otc=!1;this.$z.xVa(!1);pa.URf&&pa.URf(pa.XRf,pa.Xfc)};this.rUm=(pa,Ya,Ja,nb)=>{!pa.matchCase&&0<Ja.length&&(pa=Ya.YKa().substr(nb.cpBegin,nb.cpEnd-nb.cpBegin),Ja=this.rqk(Ja,pa));return this.Ptc(nb,
Ja,!0,!1)};this.$z=Ra;this.bB=ab;this.ap=zb;this.Hc=Qa;this.kwe=yb;this.bHj=Eb;this.rsg=bc;this.Ptc=Pb;this.lJj=Va;this.le=oa;this.Otc=!1;this.O_n=this.OVm;this.B8m=this.NTm;this.aAk=this.HOm;this.$2k=this.eQm;this.fMi=this.wlh;this.replaceText=this.rUm;this.rqk=Na.QNm;this.yyl=this.LQm}get UOa(){return this.kwe.value}get tXc(){return this.Otc}replace(Ra){var ab=!1;if(this.tXc)return l.ULS.sendTraceTag(4069062,313,15,"Replace: Cancelled as replace is already in progress"),ab;if(this.UOa.CNk){var zb=
this.UOa.osa;const lb=zb.node;zb.contextId===Ca.a.paragraph&&(zb=Pa.a.createTextRange(lb,0,W.ParagraphReader.textLength(lb)));var Qa=Object(r.a)(58,lb);if(Qa){var yb=new qa.a(zb.cpBegin,zb.cpEnd);yb=Qa.WQh(yb);if(yb!==Xa.a.invalid&&0<=yb){if(this.Ujh(zb))return l.ULS.sendTraceTag(5007250,313,50,"Replace: Cancelled as Paragraph is locked"),ab;this.Otc=!0;ab=this.Hc.Rc(15);ab.Db(lb);this.replaceText(this.$z.X7e,Qa,Ra,zb);ab.dispose();this.fMi();Qa.xXf(yb,Ra.length);0<Ra.length&&this.bB.vgb.push(lb.id);
Ra=this.bB.T2b(lb.id);zb=this.bB.$Xa(Ra);Qa=Qa.bLa();Qa=this.ap.CTd(lb.id,Qa,null,Ra.type,Ra.qMd);this.bB.S2d(lb.id,Qa);(zb=this.yyl(Qa.length,yb,Ra,zb,lb))?this.$z.XXc.v0h(zb.id):this.bB.Mlb();ab=!0;this.Otc=!1}else l.ULS.sendTraceTag(5007251,313,50,"Replace: Cancelled as current selection not on a find hit.")}else l.ULS.sendTraceTag(4069063,313,15,"Replace: Failed as No node found corresponding to current selection")}else l.ULS.sendTraceTag(5007252,313,50,"Replace: Cancelled as current selection does not contain single context");
ab?(l.ULS.sendTraceTag(4065306,313,50,"ReplaceManager Replace Success"),this.$z.VRf=!0):(l.ULS.sendTraceTag(5007253,313,50,"ReplaceManager Replace Not Successful"),this.$z.XXc.s0h());return ab}replaceAll(Ra,ab){this.tXc?l.ULS.sendTraceTag(4069065,313,15,"ReplaceAll: Called when Replace is already in Progress"):this.bB.Vga?this.O_n(Ra,ab):l.ULS.sendTraceTag(4069066,313,15,"ReplaceAll: Called when total results is 0")}Ujh(Ra){const ab=this.bHj(Ra);!ab&&this.rsg.value&&this.lJj.value&&this.rsg.value(Ra.node);
return ab}Crk(Ra,ab,zb){return this.Ujh(Pa.a.createTextRange(Ra,ab,zb))}ohm(Ra){return Ra.abb===this.bB.mAa}static get characterPropertiesEditor(){return null!=Na.Dfg?Na.Dfg:Na.Dfg=ka.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static YD(Ra,ab){const zb=new u.a(()=>K.App.rd&&K.App.rd.Jq?Object(w.a)(K.App.rd.Jq,K.App.rd.Jq.sG,"acquireAndApplyLock"):null);return new Na(Ra,ab,ca.FindManagerHelper.instance,new B.a,new u.a(()=>Ea.a.instance),new u.a(()=>P.a.instance),Object(w.a)(Ia.a.instance,
Ia.a.instance.E9l,"isContextSetInLockedRange"),zb,Object(w.a)(Na.characterPropertiesEditor,Na.characterPropertiesEditor.replaceTextRange,"replaceTextRange"),new u.a(()=>ha.a.instance.J(4)&&K.App.rd.Kp),K.App.xa.iq)}static createInstance(Ra,ab){return Na._instance||(Na._instance=Na.YD(Ra,ab))}static QNm(Ra,ab){const zb=Ga.a.mh(ab);!Ga.a.localeCompare(Ga.a.Tz(ab),ab)&&Ga.a.localeCompare(zb,ab)?Ra=Ga.a.Tz(Ra):Ga.a.n7b(ab.charAt(0))&&!Ga.a.wqf(ab.charAt(0))&&(ab=Ga.a.Tz(Ra.substr(0,1)),Ra=1===Ra.length?
ab:ab+Ra.substr(1,Ra.length-1));return Ra}}Na._instance=null;Object(D.a)(Na,"ReplaceManager",null,[1232]);d.d(M,"FindManager",function(){return Oa});class Oa extends X.a{constructor(Ra,ab,zb,Qa,yb,lb,Eb,bc,Pb,Va,oa,pa,Ya,Ja,nb,Bb=!1){super(Ra,ab,zb,yb,lb,Ya,Ja,oa,pa);this.Wha=this.uuc=null;this.Aod=!1;this.iya=this.L5a=this.w7a=null;this.wmc=0;this.Wld=Qa;this.zqb=Eb;this.Xc=bc;this.Hc=Pb;this.DBe=Va;this.PBj=nb;this.cqc=[];this._state=2;this.atb=!Bb;this.Tnb=new R;this.ap.pNe(this.Tnb);this.zUb=
new R;this.ap.pNe(this.zUb);this.ap.Zc&&(this.w7a=this.ap.Qi);this.k9f=400;this.phc=100}get Cb(){return this.zqb.value}get X7e(){return this.uuc}get GBd(){return this.PBj.value}xVa(Ra=!0){this.SHb&&this.SHb.tXc||(this.dab(Ra),this.u6a.reset(),this.zUa="",this.Wld&&this.GBd.stop(),this.ivk(),this.yZi(null))}ivk(){this.g5&&(this.taskManager.ef(this.g5),this.g5=null);this.xGa&&(this.taskManager.ef(this.xGa),this.xGa=null)}dab(Ra=!0){!this.w7a&&0<this.Ej.m3a&&l.ULS.sendTraceTag(4235910,313,10,"{0}",{["CancelFind"]:"LastKnowSpaceNull"});
if(0<this.Ej.m3a&&this.w7a){let zb=this.Ej.mAa;const Qa=zb.nodeId;if(this.w7a.Eb(Qa)){const yb=this.Hc.Rc(3);for(yb.Db(this.w7a.Eb(Qa));zb;){const lb=this.w7a.Eb(zb.nodeId);var ab=Object(r.a)(58,lb);if(ab){if(this.atb&&(ab.Hja(void 0,Ra),W.ParagraphReader.oc(lb)&&(ab=this.ap.dPh(lb))))for(const Eb of ab)Eb.Hja(void 0,Ra);lb.Sj(16,!0)}zb=this.Ej.e2b(zb);if(!zb||zb.nodeId.equals(Qa))break}yb.dispose()}else l.ULS.sendTraceTag(4235911,313,10,"ClearFindHits: Error - node not in last known space");this.Ej.Flh()}Ra&&
this.SHb&&this.SHb.wlh();this.$Pi();this.cqc=[];this.IPb=this.uuc=null;this.FK=0;this.VRf=this.Aod=!1}UXc(){const Ra=this.hV;this.dab();Ra&&""!==Ra.text&&this.find(Ra)}C0i(){return""===this.zUa}K2h(){return this.Wld&&this.GBd.JTl}yQi(){10>this.wmc?(this.wmc++,l.ULS.sendTraceTag(4069014,313,15,"{0}",{["ErrorRestartCount"]:this.wmc}),this.find(this.hV)):(l.ULS.sendTraceTag(4235912,313,10,"RestartFindAfterErrorCondition: max retries reached"),m.AFrameworkApplication.ya.processAction(F.a.Wvb,2),this.wmc=
0)}IIi(){var Ra=(new Date).getTime();let ab=!1;this.Ej.m3a||(ab=!0);let zb=0;if(!ab){this.Ej.x7||(this.Ej.x7=this.Ej.mAa);this.Ej.J1||(this.Ej.J1=this.Ej.x7,this.Ej.MD=null);let Qa=null,yb=!0;for(;!ab&&this.Ej.J1&&(new Date).getTime()-Ra<X.a.Joi;){const lb=this.Ej.J1,Eb=this.ap.Qi.Eb(lb.nodeId);Eb?(yb&&(Qa=this.Hc.Rc(3),Qa.Db(Eb),yb=!1),lb.qMd&&!this.L5a&&(this.L5a=Eb),this.Ej.J1=this.Ej.e2b(this.Ej.J1),ab=!this.Ej.J1||this.Ej.J1.nodeId.equals(this.Ej.x7.nodeId),this.qif(Eb,lb.type,this.atb),++zb):
this.Ej.WWc(lb.nodeId)}Qa&&Qa.dispose()}this.Ej.Mlb();ab&&(this.Ej.J1=null,this.Aod?this._state=0:(this._state=2,this.hkb(!0)));this.g5=new f.a(2,1,this.phc,Object(w.a)(this,this.findInternal,"findInternal"),52);this.taskManager.$b(this.g5);Ra=(new Date).getTime()-Ra;l.ULS.sendTraceTag(4065247,313,50,"{0}",{["RecheckTime"]:Ra,["Count"]:zb,["Total"]:this.Ej.Vga,["TotalWithDirty"]:this.Ej.m3a})}B5m(){this.dab();this.FK=0;if(this.ap.kof&&this.atb){var Ra=this.Cb;if(Ra){var ab=Ra.ib.kb;if(ab){var zb=
K.App.xa.jb.Jc;(zb=zb?zb.Cx:null)&&zb.cfc();ab=C.SelectionEditor.ak(ab,!1,!1);Ra.setSelection(ab);zb&&zb.KWb()}}}Ra=this.qTk();this.Wha=this.FBj.bPh(Ra)}zZi(){this.yZi(this.Wha[this.FK].tva)}yZi(Ra){this.GMn(Ra);this.PWi(Ra)}$Pi(){this.L5a=null;this.HQb=!1}vef(Ra){const ab=this.Xc.Ck();ab.set(Ra);if(!ab.Bb(7))return ab.reset(),null;if(this.ap.fUd(ab,7,0))return Ra=ab.currentNode,ab.reset(),Ra;l.ULS.sendTraceTag(4235914,313,10,"GetNextFindableNode: No findable nodes");ab.reset();return null}qTk(){if(this.ap.kof){var Ra=
this.Cb;if((Ra=Ra?Ra.ib.kb:null)&&this.atb)return Ra.Tc.ul?(Ra=Ra.Tc,C.SelectionEditor.Zt(Ra)?(Ra=Ra.node,Object(v.a)(58,Ra)?Ra:this.vef(Ra)):Object(v.a)(58,Ra.node)?Ra.node:this.vef(Ra.node)):this.vef(this.ap.Zc);Ra=this.Xc.Ck();Ra.set(this.ap.Zc);if(this.ap.y5f(Ra,8,1)){l.ULS.sendTraceTag(4069018,313,50,"No Selection: No selection, choosing title or first findable");const ab=Ra.currentNode;Ra.reset();return ab}l.ULS.sendTraceTag(4235915,313,10,"TryMoveToPageLeadingContent failed")}l.ULS.sendTraceTag(4235916,
313,10,"Error: ContentView isn't PageView");return null}ugf(){const Ra=this.Xc.Ck();Ra.set(this.zUb);if(1===Ra.Hp())return Ra.Wd(),Ra.currentNode;l.ULS.sendTraceTag(4069019,313,15,"Something went wrong in GetStartingNode...");return null}GMn(Ra){const ab=this.Hc.Rc(3);ab.Db(this.zUb);const zb=this.Xc.Ck();zb.set(this.zUb);zb.RC()&&(zb.Wd(),zb.Fg());Ra&&(zb.Sf(Ra,81),Ra=this.Wha[this.FK],this.zUb.UTf=Ra.rootNode.type,this.zUb.Z7e=Ra.Y0b);ab.dispose()}yml(){if(this.Tnb){var Ra=this.Xc.Ck();Ra.set(this.Tnb);
if(Ra.Hp())return Ra.Wd(),Ra.currentNode;Ra=this.DBe(this.ap.Zc);Ra.moveNext();if(Ra.currentNode)return Ra.currentNode}l.ULS.sendTraceTag(4069020,313,15,"Something went wrong in GetCurrentNode...");return null}PWi(Ra){const ab=this.Hc.Rc(3);ab.Db(this.Tnb);const zb=this.Xc.Ck();zb.set(this.Tnb);zb.RC()&&(zb.Wd(),zb.Fg());Ra&&(zb.Sf(Ra,81),Ra=this.Wha[this.FK],this.Tnb.UTf=Ra.rootNode.type,this.Tnb.Z7e=Ra.Y0b);ab.dispose()}YHd(){let Ra=this.Ej.MD||this.Ej.mAa;if(Ra){for(var ab=!1,zb=!0;Ra;){var Qa=
this.ap.Qi.Eb(Ra.nodeId);if(Qa=Object(r.a)(58,Qa))if(ab=Qa.Axf(Ra.type)){zb&&(Ra=this.Ej.$Xa(Ra));break}else Ra=this.Ej.$Xa(Ra);else if(zb=Ra,Ra=this.Ej.e2b(Ra),this.Ej.WWc(zb.nodeId),!Ra||zb.nodeId.equals(Ra.nodeId))break;zb=!1}ab?(this.Ej.MD=Ra,this.Ej.Mlb(),l.ULS.sendTraceTag(4065248,313,50,"FindManager GoToNextHit Success")):l.ULS.sendTraceTag(4069022,313,15,"Failed to go to Next Hit")}}ZHd(){let Ra=this.Ej.MD||this.Ej.mAa;if(Ra){for(var ab=!1,zb=!0;Ra;){var Qa=this.ap.Qi.Eb(Ra.nodeId);if(Qa=
Object(r.a)(58,Qa))if(ab=Qa.Lni(Ra.type)){zb&&(Ra=this.Ej.zGd(Ra));break}else Ra=this.Ej.zGd(Ra);else if(zb=Ra,Ra=this.Ej.QRh(Ra),this.Ej.WWc(zb.nodeId),!Ra||zb.nodeId.equals(Ra.nodeId))break;zb=!1}ab?(this.Ej.MD=Ra,l.ULS.sendTraceTag(4065249,313,50,"FindManager GoToPreviousHit Success")):l.ULS.sendTraceTag(4069024,313,15,"Failed to go to Previous Hit");this.Ej.Mlb()}}Upk(){return 2===this._state&&(this.VRf||this.Wld&&this.GBd.HQi)}ZDf(){this.ap.uta?(this.zUa=this.Aca.xUc(this.hV.text),this.w7a=this.ap.Qi,
this.$Pi()):this.yQi()}N5i(){this.Wld&&this.GBd.start()}gUe(){if(!this.ap.uta||this.w7a!==this.ap.Qi)return this.dab(),this.yQi(),!0;this.wmc=0;return!1}XSf(){const Ra=this.Aca.pGb(this.zUa),ab=this.Upk();let zb=!1;if(ab||this.ap.zei(this.uuc,this.cqc,this.hV,Ra)){zb=!0;this.hkb(!1);this.u6a.update();this.u6a.b8e();!ab&&this.ap.Kei(this.uuc,this.cqc,this.hV,Ra)?(this.Ej.Tni(),this.Ej.J1=null,this._state=1):(this.B5m(),this.zZi(),this._state=0,this.Aod=!0);this.uuc=this.hV;this.cqc=Ra;try{this.IPb=
this.JPb.Q2b(this.cqc.join("|"),this.hV)}catch(Qa){return l.ULS.sendTraceTag(0,313,10,"FindManager Find being completed because of invalid search with case filter {0} and whole word {1} .",this.hV.matchCase,this.hV.matchWholeWord),this.IPb=null,this._state=2,this.hkb(!0),!0}this.g5=new f.a(2,1,this.phc,Object(w.a)(this,this.findInternal,"findInternal"),52);this.taskManager.$b(this.g5)}return zb}vui(){if(!this.L5a){const Ra=this.Xc.Ck();Ra.set(1===this.Wha[this.FK].Y0b?this.ap.Zc:this.Wha[this.FK].rootNode);
this.ap.y5f(Ra,this.Wha[this.FK].rootNode.type,this.Wha[this.FK].Y0b)?(this.L5a=Ra.currentNode,Ra.reset()):(l.ULS.sendTraceTag(17306254,313,10,"TryToMoveToPageLeadingParagraph failed."),Ra.reset(),this.g5=new f.a(2,1,this.phc,Object(w.a)(this,this.findInternal,"findInternal"),52),this.taskManager.$b(this.g5))}}KDf(){this.Ej.Mlb();this.PWi(this.iya.currentNode);this.iya.currentNode===this.ugf()&&(this.FK++,this.FK===this.Wha.length?(this.FK=0,this._state=2,this.Aod=!1,this.hkb(!0)):this.zZi());this.iya=
null}WXh(){return this.ugf()}uEi(){const Ra=this.yml();this.iya=this.Xc.Ck();this.iya.set(Ra);this.iya.I_(this.Wha[this.FK].rootNode)}YZi(){const Ra=this.Hc.Rc(3);Ra.Db(this.iya.currentNode);return Ra}EHf(){this.qif(this.iya.currentNode,this.Wha[this.FK].Y0b,this.atb);this.ap.fUd(this.iya,this.Wha[this.FK].rootNode.type,this.Wha[this.FK].Y0b)}jXe(Ra){return!!this.iya.currentNode&&!this.iya.currentNode.id.equals(Ra.id)}jkh(Ra){!this.HQb&&this.L5a&&Ra.id===this.L5a.id&&this.ugf().id!==this.L5a.id&&
0<this.Ej.m3a&&(this.HQb=!0,this.Ej.TPi())}Rpd(Ra,ab,zb,Qa){const yb=this.Ej.T2b(Ra);yb?this.Ej.S2d(Ra,ab):this.HQb?this.Ej.O5g(ab):this.Ej.Vpd(ab);this.atb&&!this.Ej.MD&&0<ab.length&&zb.Axf(Qa)&&(this.Ej.MD=yb?yb:ab[0],this.Ej.x7||(this.Ej.x7=this.Ej.MD))}ZOa(Ra,ab){Ra.ZOa(ab)}Hja(Ra){this.atb&&Ra.Hja()}Jxf(Ra){Ra.Sj(16,!0)}static YD(Ra,ab,zb,Qa,yb=!1){ab||(ab=ua.instance);zb||(zb=Y.instance);const lb=da.createInstance(Ra,zb.T1f,yb),Eb=new u.a(()=>Na.createInstance(Oa.instance,Oa.instance.Ej)),bc=
new u.a(()=>ja.createInstance(Oa.instance.Ej)),Pb=new u.a(()=>ea.createInstance(Oa.instance,Ra));return new Oa(Ra,ab,zb,Qa,ca.FindManagerHelper.instance,new u.a(()=>m.AFrameworkApplication.uc),new u.a(()=>P.a.instance),new z.a,new B.a,G.a.createInstance,a.a.instance,lb,Eb,bc,Pb,yb)}static get instance(){return Oa._instance}static createInstance(Ra,ab=null,zb=null,Qa=!1,yb=!1){return yb?Oa.YD(Ra,ab,zb,Qa,!0):Oa.instance||(Oa._instance=Oa.YD(Ra,ab,zb,Qa))}}Oa._instance=null;Object(D.a)(Oa,"FindManager",
X.a,[])},1825:function(D,M,d){D=d(0);var m=d(22),f=d(2),a=d(205),l=d(5),r=d(17),w=d(44),v=d(8),u=d(72),z=d(120),B=d(79),G=d(20),F=d(196),K=d(14),N=d(6),H=d(585),J=d(64),L=d(108),I=d(799),R=d(987),C=d(41),P=d(223),W=d(211),X=d(92);class V{constructor(Eb){this.vma=Eb}}Object(D.a)(V,"ValidParentData",null,[]);var Y=d(42),ca=d(48),fa=d(390),sa=d(658),ia=d(384),ea=d(657),da=d(526);class ja{constructor(){this.t_b=0}}Object(D.a)(ja,"BelowOutlineElementData",null,[]);var Ga=d(634),ya=d(843),ta=d(543);class ua extends Ga.a{constructor(Eb,
bc,Pb,Va){super(4,Va);this.s_b=Eb;this.oub=bc;this.Myc=Pb}t3b(){var Eb=this.s_b;if(!Eb)return v.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),null;const bc=[],Pb=new ya.a(this.s_b.id,this.s_b.Mc,this.oub?this.oub.id:null);""!==Eb.characterData&&Eb.characterData&&(Eb=new ta.DeleteTextUpdateHint(this.s_b.id,0,Eb.characterData),bc.push(Eb));bc.push(Pb);return bc}}Object(D.a)(ua,"DeleteParagraphOperation",Ga.a,[]);var Sa=d(918),ka=
d(489);class ha extends Ga.a{constructor(Eb,bc,Pb,Va,oa){super(3,oa);this.xma=Eb;this.sNa=bc;this.dJm=Pb;this.Zta=Va}t3b(){const Eb=[];var bc=new Sa.AddParagraphUpdateHint(this.Zta.id,this.Zta.Mc,this.xma?this.xma.id:null);Eb.push(bc);""!==this.Zta.characterData&&this.Zta.characterData&&(bc=new ka.a(this.Zta.id,0,this.Zta.characterData),Eb.push(bc));return Eb}}Object(D.a)(ha,"InsertNewParagraphOperation",Ga.a,[]);var Ca=d(917);class Pa extends Ga.a{constructor(Eb,bc,Pb,Va){super(2,Va);this.xma=Eb;
this.sNa=bc;this.ATd=Pb}t3b(){const Eb=[],bc=new Ca.MergeParagraphUpdateHint(this.xma.id,this.xma.Mc,this.xma.characterData.length,this.sNa.id,this.sNa.Mc,this.ATd.id,this.ATd.Mc);Eb.push(bc);return Eb}}Object(D.a)(Pa,"MergeParagraphOperation",Ga.a,[]);var Xa=d(842);class qa extends Ga.a{constructor(Eb,bc,Pb,Va,oa){super(1,oa);this.O2=Eb;this.o5i=bc;this.oub=Pb;this.Myc=Va}t3b(){const Eb=[],bc=new Xa.a(this.O2.id,this.O2.Mc,this.o5i,this.oub.id,this.oub.Mc,this.Myc.id,this.Myc.Mc);Eb.push(bc);return Eb}}
Object(D.a)(qa,"SplitParagraphOperation",Ga.a,[]);var Ea=d(392),Ia=d(9),na=d(541),Na=d(49),Oa=d(1054),Ra=d(38),ab=d(134),zb=d(247),Qa=d(11),yb=d(187);d.d(M,"a",function(){return lb});class lb{constructor(Eb,bc,Pb,Va,oa,pa=null,Ya=null,Ja=null,nb=null){this.uJ=Eb;this.kG=bc;this.Cf=Pb;this.Yba=pa;this.B4=Ya;this.cS=Ja;this.tC=nb}IZj(Eb){G.a.instance.J(4)&&Ia.App.rd&&Ia.App.rd.Kp&&Ia.App.rd.Jq.sG(Eb)}mva(Eb,bc,Pb,Va=!1){C.OutlineElementNavigator.He(Eb);Qa.ParagraphReader.wh(Eb)?lb.paragraphEditor.np.mva(Eb,
bc,Pb):Ra.TableReader.isTable(Eb)&&14===Eb.Se&&(bc=(new ia.a(1,Pb)).gt,Pb=Object(u.a)(fa.TableNode,Eb.currentNode),this.IZi(Pb,bc,Va));C.OutlineElementNavigator.ae(Eb)}IZi(Eb,bc,Pb=!1){Eb&&Object(z.a)(fa.TableNode,Eb)&&(Pb?bc?(Eb.setValue(l.a.ge,bc),bc=Ra.TableReader.kh(Eb),lb.Gk.hXf(Eb,bc)):Eb.removeProperty(l.a.ge):Eb.ge=bc)}get np(){return R.a.gAb}get ZQ(){return this.cS||(this.cS=m.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}get pc(){return this.tC||(this.tC=m.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get Rd(){return null!=
this.vqg?this.vqg:this.vqg=m.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Hk(){return null!=this.hqg?this.hqg:this.hqg=m.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Jo(){return this.kG.value}get hd(){return this.Cf.value}get lK(){return this.uJ.value}get Zf(){return zb.a.instance}get zC(){return null!=this.bgg?this.bgg:this.bgg=m.a.instance.Pa("Box4.IContentControlConverter")}$wb(){const Eb=I.a.instance.createInstance(393229);Eb.setValue(r.a.mK,
P.a.first);Eb.setValue(r.a.QMk,new Date);Eb.ybe();return Eb}aKk(){const Eb=new Oa.a;Eb.setValue(r.a.mK,P.a.first);return Eb}l4e(Eb,bc,Pb=!1){Y.OutlineElementReader.Orf(Eb)?(Eb=Y.OutlineElementReader.isRtl(Eb),Pb?this.jJb(bc,Eb):this.iJb(bc,Eb)):this.Bon(bc)}Cdc(Eb,bc){const Pb=C.OutlineElementNavigator.Uk(Eb);Y.OutlineElementReader.hm(Pb)!==bc&&(this.iJb(Pb,bc),Eb.anchor.JW(4))}iJb(Eb,bc){const Pb=new Na.GraphTransaction(7);Pb.Db(Eb);this.jJb(Eb,bc);const Va=new N.GraphIterator;Va.set(Eb);Ea.a.instance.K5l(Va);
if(Va.Bb(10)){const oa=Va.kd(10);Va.Rb(1)===Eb&&this.lK.iJb(oa,bc)}Pb.dispose()}jJb(Eb,bc){let Pb=null,Va=null;if(G.a.instance.J(3)&&Eb.isConnected){Pb=Qa.ParagraphReader.Mw(Eb,!0,!0);Va=new B.a;for(let oa=0;oa<Pb.count;oa++)12===Pb.J(oa).type&&Va.add(Pb.J(oa).Hz())}Eb.properties.setValue(r.a.oX,bc);if(G.a.instance.J(3)&&Pb&&Va)if(Pb.count!==Va.count)v.ULS.shipAssertTag(35973010,376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",Pb.count,Va.count);else for(Eb=0;Eb<Pb.count;Eb++)this.Hk.gM(Pb.J(Eb),
Va.J(Eb),this.Rd.wg)}Bon(Eb){Eb.properties.removeProperty(r.a.oX)}uN(Eb,bc=null,Pb=!1){var Va=null;let oa=null;if(!Y.OutlineElementReader.Nh(Eb))return v.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),null;var pa=null;let Ya=null,Ja=0;bc&&(pa=bc.formatting,Ya=bc.Xva,Ja=bc.languageId);Pb||({xma:Va,sNa:oa}=this.TJh(Eb,Va,oa));bc=F.a.instance.createInstance(393230);bc.setValue(r.a.lo,"");Eb.Sf(bc,2);Eb.Ci(bc);lb.paragraphEditor.MHb(bc);lb.paragraphEditor.QBm(bc);
lb.paragraphEditor.M3a(bc);this.IZj(bc);pa&&(bc.qa.first.formatting.Aj=pa);Ja||(Ja=f.AFrameworkApplication.lcid);Eb.currentNode.lh(r.a.pIb,Eb.currentNode.ia(r.a.pIb,Ja));Eb.currentNode.setValue(l.a.MNa,0);!G.a.instance.J(10)||G.a.instance.J(8)||Ya||(pa=this.pc.Nx(bc))&&(Ya=pa.uh(ca.StyleReader.styleIdNormal));Ya&&this.ZQ.hM(Ya,bc,!0);!Pb&&Va&&(Pb=new da.a(bc),Va=new ha(Va,oa,Va,Pb,bc.Wza),Eb.currentNode.MG().sF.CJ(Va));return bc}TJh(Eb,bc,Pb){Pb=new N.GraphIterator;Pb.fd(Eb);bc=null;Pb.kpf?Pb.currentNode.MG().sF.p9(6):
(C.OutlineElementNavigator.J2(Pb,!0,!1),bc=this.PEd(Pb));Pb.fd(Eb);Pb=this.YKh(Pb);return{xma:bc,sNa:Pb}}YKh(Eb){const bc=new N.GraphIterator;bc.fd(Eb);Eb=null;bc.XBa||(C.OutlineElementNavigator.Rr(bc,!0,!1),Eb=this.PEd(bc));return Eb}PEd(Eb,bc=!1){Eb=C.OutlineElementNavigator.He(Eb,!0);return Eb?this.$Ph(Eb,bc):(v.ULS.sendTraceTag(8451733,355,15,"No paragraph node below OutlineElement"),null)}$Ph(Eb,bc=!1){if(12===Eb.type)return bc?new da.a(Eb):new ea.a(Eb);Eb.MG().sF.p9(5);return new sa.a(Eb)}iwk(Eb,
bc){var Pb=bc.currentNode.clone();Eb.SG(Pb,null,1);Eb.Ci(Pb);Pb.rra=bc.currentNode;C.OutlineElementNavigator.He(bc);bc.j6&1&&bc.currentNode.TLb(null);Pb=bc.currentNode.clone();Pb.u3=bc.currentNode.u3;Pb.ZI=bc.currentNode.ZI;Eb.SG(Pb,null,2);Eb.Ci(Pb);Eb.AZ(1);Pb.rra=bc.currentNode;G.a.instance.J(5)&&Pb.setValue(l.a.Mc,a.a.JF());bc.at(11)}MHb(Eb){Eb.Rb(2)&&Eb.Fg()}Zrn(Eb,bc){const Pb=Eb.currentNode;C.OutlineElementNavigator.He(Eb);const Va=Eb.currentNode;C.OutlineElementNavigator.ae(Eb);bc.dE(1);C.OutlineElementNavigator.He(bc);
Eb.Sf(bc.currentNode,2);bc.Fg();var oa=new N.GraphIterator;oa.fd(bc);if(oa.Rb(1)){const pa=new N.GraphIterator;pa.fd(Eb);const Ya=new V(null);if(!this.IMl(pa,oa.currentNode,Ya))return;H.f(pa,null,1,1,oa,-1)}bc.Fg();oa=null;Eb.QC(1)&&(oa=Eb.currentNode);for(Eb.nc();W.OutlineNavigator.K6(bc);)Eb.SG(bc.currentNode,oa,1),oa=bc.currentNode,bc.Fg();Eb.Ci(Pb);Eb.Ci(Va);Eb.Fg()}dba(Eb,bc,Pb,Va,oa,pa,Ya=!1,Ja=!1){var nb,Bb=Y.OutlineElementReader.Nh(Eb),mb=Y.OutlineElementReader.Nh(bc),Qb=Pb.Qd&&Pb.contextId===
K.a.Wc;Bb&&mb&&Qb||v.ULS.sendTraceTag(594642515,307,15,"sourceOutlineElementIsValid:{0}; destinationOutlineElementIsValid:{1}; ipContextIsValid:{2}",Bb,mb,Qb);var Vb=Eb.currentNode;if(null===(nb=this.Yba)||void 0===nb?0:nb.splitParagraph){if(11===Eb.Se)C.OutlineElementNavigator.He(Eb),bc=Eb.currentNode,C.OutlineElementNavigator.ae(Eb);else if(12===Eb.Se)bc=Eb.currentNode;else throw Error(`Unexpected node type ${Eb.Se}`);this.Yba.splitParagraph(bc,Pb.cpBegin)}else{this.MHb(bc);Bb=bc.Se;var mc=null;
nb=mb=null;var ob=!1;C.OutlineElementNavigator.He(Eb);Qb=Eb.Se;if(Qa.ParagraphReader.wh(Eb)){var cb=Eb.currentNode;(mb=Object(u.a)(ab.AParagraphNode,cb))?mb.qa&&mb.qa.length||v.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",mb):v.ULS.sendTraceTag(38925731,307,15,"srcParaNode is null");mb=new da.a(mb);(ob=Pb.cpBegin===Qa.ParagraphReader.textLength(cb))&&(nb=this.YKh(bc));const db=bc.currentNode;mc=this.uN(bc,void 0,!0);lb.paragraphEditor.sPa(Eb,bc,Pb,oa,
pa,Ya,Ja);G.a.instance.J(10)&&(Va?(oa=this.pc.yo(cb))&&this.ZQ.hM(oa,mc,!0):ob&&(oa=this.pc.yo(cb))&&((Ja=oa.ia(w.a.$d,null))?(oa=this.pc.Nx(mc).uh(Ja),this.ZQ.hM(oa,mc,!1)):this.ZQ.hM(oa,mc,!0)));this.l4e(Vb,db)}C.OutlineElementNavigator.ae(Eb);C.OutlineElementNavigator.ae(bc);C.OutlineElementNavigator.He(Eb);(Vb=Object(u.a)(ab.AParagraphNode,Eb.currentNode))?Vb.qa&&Vb.qa.length||v.ULS.sendTraceTag(38925762,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",Vb):v.ULS.sendTraceTag(38925761,
307,15,"srcPara is null");Vb=new da.a(Vb);C.OutlineElementNavigator.ae(Eb);(Eb=mc)?Eb.qa&&Eb.qa.length||v.ULS.sendTraceTag(38925764,307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",Eb):(v.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),v.ULS.sendTraceTag(40425482,307,50,"SplitAtIp state. {0}",{["splittingAtEnd"]:ob,["moveText"]:pa,["overrideParagraphStyle"]:Va,["sourceOutlineElementContentNodeType"]:Qb,["destinationOutlineElementNodeType"]:Bb,["alwaysMoveEopToDestinationPara"]:Ya}));
ob?(Pb=new da.a(Eb),Pb=new ha(mb,nb,Vb,Pb,Eb.Wza),bc.currentNode.MG().sF.CJ(Pb)):(Pb=pa?new qa(mb,Pb.cpBegin,Vb,new da.a(Eb),Eb.Wza):new qa(mb,Pb.cpBegin,new da.a(Eb),Vb,Eb.Wza),bc.currentNode.MG().sF.CJ(Pb))}}dih(Eb,bc){C.OutlineElementNavigator.He(Eb);let Pb=Qa.ParagraphReader.uu(Eb.currentNode)&&this.Cpk(Eb);const Va=Eb.currentNode;Pb=bc?Pb&&!this.Zf.a0m(Va):Pb&&!this.Zf.R_m(Va);C.OutlineElementNavigator.ae(Eb);return Pb}Cpk(Eb){return Qa.ParagraphReader.wh(Eb)&&!Qa.ParagraphReader.Cab(Eb.currentNode)}merge(Eb,
bc,Pb,Va,oa=null,pa=!1,Ya,Ja=!1,nb=!1,Bb=!1){var mb;if(Eb.currentNode.id===bc.currentNode.id)return!1;let Qb;const Vb=new N.GraphIterator;Vb.fd(bc);Ya=this.PEd(Vb);Vb.fd(Eb);Qb=this.PEd(Vb,!0);if(!this.dih(bc,!0)||!this.dih(Eb,!1))return!1;if(this.Zf.vh){C.OutlineElementNavigator.He(Eb);C.OutlineElementNavigator.He(bc);var mc=Qa.ParagraphReader.wh(Eb)?Eb.currentNode:null,ob=Qa.ParagraphReader.wh(bc)?bc.currentNode:null;C.OutlineElementNavigator.ae(Eb);C.OutlineElementNavigator.ae(bc);if(mc&&ob&&!this.Zf.eih(mc,
ob,!1)){if(!this.zC||!this.Zf.eih(mc,ob,!0))return!1;this.zC&&(this.zC.Kcj(mc,!1),this.zC.Kcj(ob,!0))}}mc=Object(u.a)(ab.AParagraphNode,Eb.currentNode);mc=(Pb||!mc||!mc.characterData.length)&&!J.ListReader.$h(Eb);Ja||this.Jo.merge(Eb,bc,mc,oa);C.OutlineElementNavigator.He(Eb);Ja=Eb.currentNode.Wza;C.OutlineElementNavigator.He(bc);if(Qa.ParagraphReader.wh(bc)){oa=bc.currentNode;if(G.a.instance.J(4)&&Ia.App.rd.Kp&&(mc=Eb.currentNode,ob=na.CoauthLockEditor.getInstance(),ob.s2a(this.Zf.K1b(oa))||ob.s2a(this.Zf.K1b(mc))))return bc.nc(),
Eb.nc(),!1;mc=!1;J.ListReader.pr&&(ob=Eb.parentNode)&&Y.OutlineElementReader.P$(ob)&&(mc=J.ListReader.o2(ob));ob=this.SPn(Qa.ParagraphReader.isEmpty(Eb),mc,Pb,Va,nb);if(G.a.instance.J(10)&&ob){var cb=this.pc.jHd(bc);cb&&this.ZQ.hM(cb,Eb.currentNode,!0)}if(Pb){cb=bc.currentNode;const db=Eb.currentNode;yb.s()&&ob&&yb.b(cb,db);nb&&Va||this.B4.qpi(cb,db,mc);f.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IWacWordPreserveEopFormattingPasteSettings");Bb&&(nb=this.lEk(db,cb),v.ULS.sendTraceTag(588288132,
307,50,"wasCopied: {0}",nb))}Pb=lb.paragraphEditor.merge(Eb,bc,Pb,Va,pa);Va=Vb.currentNode;pa=Eb.currentNode;Eb.nc();Pb&&Y.OutlineElementReader.isEmpty(bc,!0)&&this.HWa(bc);Eb=new Pa(Qb,Ya,new ea.a(Va),Ja);pa.MG().sF.CJ(Eb);(null===(mb=this.Yba)||void 0===mb?0:mb.EAc)&&this.Yba.EAc(Va,oa);return!0}bc.nc();Eb.nc();return!1}lEk(Eb,bc){let Pb=null;bc&&bc.qa&&0<bc.qa.length&&bc.qa.first.Wh&&(Pb=bc.qa.first.formatting);return Pb&&Eb&&Eb.qa&&0<Eb.qa.length&&L.FormattingReader.VBk(Eb.qa)?(Eb.qa.last.formatting=
Pb.Yf(Eb.qa.last),!0):!1}SPn(Eb,bc,Pb,Va,oa){return bc?!1:Pb?!(Va&&oa):Eb}i4l(Eb){const bc=new N.GraphIterator;bc.set(Eb.node);bc.vd();C.OutlineElementNavigator.ae(bc);const Pb=this.cta(bc),Va=this.cta(bc);this.dba(bc,Pb,Eb,!1,!0,!0);Y.OutlineElementReader.isEmpty(bc,!1)&&(this.Jo.vDa(bc),bc.Fg());Y.OutlineElementReader.isEmpty(Pb,!1)&&!Y.OutlineElementReader.Gfb(Pb)&&(this.Jo.vDa(Pb),Pb.Fg());return Va}XC(Eb,bc,Pb,Va=null,oa=!1,pa=!0){if(!this.zpk(Eb))return null;const Ya=Eb.currentNode;var Ja=!1;
pa&&(Ja=J.ListReader.$h(Eb),oa=bc||oa||!Y.OutlineElementReader.isEmpty(Eb,!1),Ja=this.Jo.iTn(Ja,oa));oa=bc?Eb.QC(1):Eb.currentNode;Eb.nc();Pb=this.lK.Seb(Eb,oa,Pb,Va);if(!Pb)return null;this.l4e(Ya,Pb);pa&&Ja&&this.Jo.S8n(Eb,bc,Ya,Pb);return Pb}zpk(Eb){return Y.OutlineElementReader.Nh(Eb)&&(Eb=Eb.parentNode,X.OutlineReader.sOd(Eb)||Y.OutlineElementReader.P$(Eb)||Y.OutlineElementReader.YBa(Eb))?!0:!1}t1a(Eb){const bc=new N.GraphIterator;bc.set(Eb);bc.vd();bc.at(11);let Pb=null,Va=null;({xma:Pb,sNa:Va}=
this.TJh(bc,Pb,Va));let oa=-1;12===Eb.type&&(oa=Eb.Wza);bc.currentNode?(bc.currentNode.MG().sF.CJ(new ua(this.$Ph(Eb,!0),Pb,Va,oa)),this.HWa(bc)):v.ULS.sendTraceTag(574650269,324,15,"The content to be deleted does not have a containing OE")}HWa(Eb){if(Eb.Zp(1)){const bc=new ja,Pb=new N.GraphIterator;Pb.fd(Eb);this.$gl(Pb,bc)&&this.np.bDc(Eb,-bc.t_b)}Eb.Fg();Ra.TableReader.Tw(Eb)&&this.z4m(Eb)}Kmf(Eb,bc,Pb){if(!X.OutlineReader.rw(Eb)&&!Y.OutlineElementReader.Nh(Eb))return null;const Va=this.aKk();
0<Pb&&Pb<P.a.last&&Va.setValue(r.a.mK,Math.min(P.a.nil,Pb));Eb.SG(Va,bc,1);return Va}k4l(Eb,bc){if(!Y.OutlineElementReader.Nh(Eb)&&!Y.OutlineElementReader.eK(Eb)||!X.OutlineReader.tta(Eb.parentNode)&&!Y.OutlineElementReader.P$(Eb.parentNode))return null;const Pb=Eb.currentNode;let Va;Va=Eb.currentNode;Eb.nc();bc=this.Kmf(Eb,Va,bc);Eb.Ci(Pb);return bc}z4m(Eb){Y.OutlineElementReader.eK(Eb)&&(Eb.Zp(1)||Eb.Fg());this.gHh(Eb,!1);this.c$g(Eb)}gHh(Eb,bc){var Pb,Va=null;for(Pb=Eb.Rb(1);Pb;){var oa=!1;Y.OutlineElementReader.YBa(Pb)&&
!Eb.Zp(1)&&(oa=!0);var pa=Pb;Pb=Eb.Vi(1);if(oa)oa=new N.GraphIterator,oa.set(pa),oa.vd(),oa.Fg();else if(Y.OutlineElementReader.YBa(pa)){if(Va){oa=new N.GraphIterator;oa.set(Va);var Ya=new N.GraphIterator;Ya.set(pa);Ya.vd();oa.Sf(Ya.currentNode,1);Ya.Fg();Ya=Y.OutlineElementReader.gea(pa);Ya===P.a.nil&&(Ya=1);const Ja=Y.OutlineElementReader.gea(pa);(Ya=Math.max(0,Ja-Ya))?pa.setValue(r.a.mK,Math.min(P.a.nil,Ya)):(oa.Ci(pa),Eb.Rb(1),H.d(oa),oa.nc());bc&&this.gHh(oa,!0)}}else Va=pa}bc=null;Va=P.a.last+
1;for(Pb=Eb.Rb(1);Pb;Pb=Eb.Vi(1))if(Y.OutlineElementReader.eK(Eb))pa=Y.OutlineElementReader.gea(Pb),Va>pa&&(Va=pa,bc=Pb);else{Eb.nc();return}if(bc){for(Pb=Eb.Rb(1);Pb;Pb=Eb.Vi(1))Pb!==bc&&(Pb=Y.OutlineElementReader.gea(Pb),Eb.currentNode.setValue(r.a.mK,Math.min(P.a.nil,Pb-Va)));Va+=Y.OutlineElementReader.gea(Eb.currentNode);Eb.currentNode.setValue(r.a.mK,Math.min(P.a.nil,Va));Pb=new N.GraphIterator;Pb.fd(Eb);Pb.Ci(bc);Pb.Rb(1);H.d(Pb)}}IMl(Eb,bc,Pb){var Va=Y.OutlineElementReader.gea(Eb.currentNode);
if(1===Va)return!0;if(Y.OutlineElementReader.eK(Eb))return!1;if(!Eb.Tcb(1)||this.kfm(Eb,bc))return Eb.currentNode.setValue(r.a.mK,Math.min(P.a.nil,1)),!0;if(Pb.vma&&Eb.Ci(Pb.vma)){if(Y.OutlineElementReader.eK(Eb)&&1===Va+Y.OutlineElementReader.gea(Eb.currentNode))return Pb.vma=Eb.dE(1),Eb.nc(),!0;Eb.nc()}if(Pb.vma&&Eb.Ci(Pb.vma)||!Pb.vma&&Eb.Rb(1)){if(Eb.currentNode!==bc&&Eb.wf(1)&&Y.OutlineElementReader.eK(Eb)&&1===Va+Y.OutlineElementReader.gea(Eb.currentNode))return Pb.vma=null,!0;Eb.nc()}if(Eb.Ydb(bc)&&
this.jfm(Eb,bc)){for(Pb=Eb.Rb(1);Pb;Pb=Eb.Vi(1))if(Pb!==bc){var oa=Y.OutlineElementReader.gea(Pb);Pb.setValue(r.a.mK,Math.min(P.a.nil,oa+(Va-1)))}Eb.currentNode.setValue(r.a.mK,Math.min(P.a.nil,1));return!0}if(1>Va)return Va=this.Kmf(Eb,Pb.vma,1-Va),Eb.Ci(Va),Pb.vma=null,!0;if(1<Va){Eb.currentNode.setValue(r.a.mK,Math.min(P.a.nil,1));bc=null;for(oa=Eb.Rb(1);oa;){if(Y.OutlineElementReader.eK(Eb)){oa.setValue(r.a.mK,Math.min(P.a.nil,Va-1+Y.OutlineElementReader.gea(oa)));oa=Eb.Vi(1);continue}bc||(bc=
this.k4l(Eb,Va-1));const pa=oa;oa=H.h(Eb,bc,1);oa===bc&&(oa=Eb.Vi(1));Pb.vma===pa&&(Pb.vma=bc,bc=null)}return!0}return!1}kfm(Eb,bc){return N.GraphIterator.yka(()=>{if(1===Eb.Tcb(1)){const Pb=Eb.Rb(1);Eb.nc();if(Pb===bc)return!0}return!1})}jfm(Eb,bc){return N.GraphIterator.yka(()=>{let Pb;for(Pb=Eb.Rb(1);Pb;Pb=Eb.Vi(1))if(Pb!==bc&&!Y.OutlineElementReader.eK(Eb))return Eb.nc(),!1;return!0})}$gl(Eb,bc){bc.t_b=0;do{const Pb=Eb.currentNode;if(Eb.Rb(1))bc.t_b-=Y.OutlineElementReader.gea(Pb);else{if(X.OutlineReader.rw(Eb)||
null===Eb.currentNode)return!1;if(3!==Eb.role||!Eb.e6(1))for(;!Eb.Vi(1);)if(bc.t_b+=Y.OutlineElementReader.gea(Eb.currentNode),X.OutlineReader.rw(Eb)||null===Eb.currentNode)return!1}}while(Y.OutlineElementReader.eK(Eb));return!0}cta(Eb,bc=!1){return this.DLd(Eb,!1,bc)}h4l(Eb){return this.DLd(Eb,!0,!1)}DLd(Eb,bc,Pb=!1){const Va=new N.GraphIterator;Va.fd(Eb);Eb=new N.GraphIterator;Eb.fd(Va);this.XC(Eb,bc,!1,null,Pb);Eb.currentNode.setValue(r.a.mK,Math.min(P.a.nil,Y.OutlineElementReader.gea(Va.currentNode)));
Va.Rb(1)&&H.f(Eb,null,1,1,Va,-1);return Eb}c$g(Eb){if(Y.OutlineElementReader.Ltn(Eb)){1!==Y.OutlineElementReader.gea(Eb.currentNode)&&Eb.currentNode.setValue(r.a.mK,P.a.first);for(var bc=Eb.Rb(1);bc;)if(Y.OutlineElementReader.eK(Eb)){bc=new N.GraphIterator;bc.fd(Eb);bc.nc();const Pb=new N.GraphIterator;Pb.fd(Eb);Pb.Rb(1);H.f(bc,Eb.currentNode,1,1,Pb,-1);bc=Eb.FWa(1)}else this.c$g(Eb),bc=Eb.Vi(1)}}static get Gk(){return null!=lb.Ipg?lb.Ipg:lb.Ipg=m.a.instance.resolve("Box4.ITableEditor")}static get paragraphEditor(){return lb.pu||
(lb.pu=m.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(Eb){lb.pu=Eb}}lb.pu=null;Object(D.a)(lb,"OutlineElementEditor",null,[310])},1826:function(D,M,d){D=d(0);var m=d(121),f=d(46),a=d(22),l=d(2),r=d(59),w=d(495),v=d(80),u=d(84),z=d(388),B=d(16),G=d(372),F=d(58),K=d(141),N=d(57),H=d(35),J=d(13),L=d(1001),I=d(110),R=d(5),C=d(17),P=d(106),W=d(8),X=d(311),V=d(619),Y=d(674),ca=d(166),fa=d(20),sa=d(21),ia=d(260),ea=d(261),da=d(33),ja=d(31);class Ga{constructor(Ra){this.ly=null;
this.OOg=!1;this.fp=null;this.Kt=new L.a;this.fca=new L.a;this.Bc=Ra}get uhb(){ja.a(4281429,307,this.Kt.count===this.fca.count);return this.Kt.count}get pTd(){return this.OOg}set pTd(Ra){this.OOg=Ra}zXb(Ra){this.ly=Ra}get K1(){return null}j$g(Ra,ab){this.Kt.add(Ra);this.fca.add(ab)}}Ga.Zgb=2712;Object(D.a)(Ga,"APicturePasteHandler",null,[572]);var ya=d(263),ta=d(3),ua=d(9),Sa=d(1114),ka;(function(Ra){Ra[Ra.unknown=0]="unknown";Ra[Ra.other=1]="other";Ra[Ra.file=2]="file";Ra[Ra.blob=3]="blob";Ra[Ra.chromeExtension=
4]="chromeExtension";Ra[Ra.cid=5]="cid"})(ka||(ka={}));Object(D.b)("UnsupportedUrlScheme",ka);var ha=d(256),Ca=d(49),Pa=d(11),Xa=d(1305),qa=d(1338),Ea=d(1694);class Ia{constructor(){this.delay=this.retry=0}}Object(D.a)(Ia,"ForceInboundData",null,[]);class na{constructor(Ra,ab,zb,Qa){this.CJd=!1;this.request=Ra;this.Atn=ab;this.url=Qa;this.w4l=zb}}Object(D.a)(na,"PicturePasteRequestInfo",null,[]);d.d(M,"a",function(){return Oa});const Na=["ImageInsertFailed"];class Oa extends Ga{constructor(Ra,ab,
zb,Qa,yb,lb=null,Eb=null,bc=!1,Pb=!1,Va=!1,oa=!1,pa=null,Ya=null){super(Ra);this.em=m.a.nil;this.gA=new L.a;this.CHa=0;this.Qpc=this.iXg=null;this.tVg=!1;this.Xsc=null;this.Q$c=new L.a;this.xp=null;this.M5m=()=>{var Ja=this.Vgl(),nb=131073;this.JIj&&(nb=1073872970);Ja=f.a.Jn(Ja,X.a.cellId,this.fp.Zl.toString());Ja=f.a.Jn(Ja,X.a.K1,this.em.toString());Ja=f.a.Jn(Ja,X.a.classId,nb.toString());this.fp.YH&&(Ja=f.a.Jn(Ja,X.a.YH,this.fp.YH));Ja=f.a.Jn(Ja,X.a.kmb,"1");Ja=f.a.Jn(Ja,V.a.imageType,"1");Ja=ya.a.instance.DNe(Ja);
this.fp.contentReplicator&&this.fp.contentReplicator.vDb&&(Ja=f.a.Jn(Ja,X.a.SRe,"1"));let Bb=0;nb=Ja;var mb=new L.a;const Qb=new L.a,Vb=new L.a,mc=new L.a,ob=new L.a,cb=new L.a;var db="";for(let gc=0;gc<this.uhb;gc++){W.ULS.shipAssertTag(7869452,307,!!this.fca.J(gc).src);W.ULS.shipAssertTag(7869453,307,""!==this.fca.J(gc).src);W.ULS.shipAssertTag(7869454,307,19922944>this.fca.J(gc).src.length);var kb=ha.a.Bq;fa.a.instance.J(4)&&(kb=this.Kt.J(gc).node.ia(I.a.gK,ha.a.Bq));this.$go(this.Kt.J(gc).blob,
this.fca.J(gc));var Wb=this.fca.J(gc).alt,Fb=this.fca.J(gc).LRk;this.dre&&!Fb&&(Fb=Wb,Wb="");kb=Xa.a.construct(this.Kt.J(gc).blob?this.Kt.J(gc).blob.id.toString():this.Kt.J(gc).node.id.toString(),this.fca.J(gc).src,Wb,this.fca.J(gc).width,this.fca.J(gc).height,Fb,kb,this.Kt.J(gc).pT,this.Kt.J(gc).blob?this.Kt.J(gc).blob.properties.ia(R.a.Vea,!1):!1,this.Kt.J(gc).blob?this.Kt.J(gc).blob.properties.ia(I.a.Qda,-1):-1,fa.a.instance.J(4)&&this.Kt.J(gc).blob?this.Kt.J(gc).blob.properties.ia(R.a.Pgb,Box4Intl.Box4Strings.l_Picture):
"",this.Kt.J(gc).node?this.Kt.J(gc).node.properties.ia(C.a.Wea,!1):!1,null,null,null,this.fca.J(gc).aud);if(this.fca.J(gc).src.startsWith("data:")){var nc=!1;(Wb=a.a.instance.Pa("Box4.IFeatureHelper"))&&Wb.isFeatureEnabled(11)&&Wb.isFeatureEnabled(51)&&this.fca.J(gc).aud?(nc=!0,Wb=ob,Fb=cb):(Wb=Vb,Fb=mc);Wb.add(kb);Fb.add(this.Kt.J(gc));nc=qa.a.construct(Wb.toArray(),!nc,l.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.fp.Bs:null,nc);nc=H.c(nc);nc.length>Oa.yEm?(W.ULS.shipAssertTag(7869456,
307,1<Wb.count),Wb.remove(kb),Fb.remove(this.Kt.J(gc)),nc=this.gA.count?(new r.a(this.em,Bb)).toString():this.fp.contentReplicator.$t.toString(),nb=f.a.Jn(nb,X.a.gra,nc),nb=f.a.Jn(nb,X.a.bac,Bb.toString()),sa.ImageReader.increaseMaxWebFriendlyDimensionTo1600&&(nb=f.a.Jn(nb,X.a.MLb,"1")),this.gA.add(new na(qa.a.construct(Wb.toArray(),!0,l.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.fp.Bs:null),db,Fb,nb)),Bb+=Vb.count,Wb=new L.a,Wb.add(kb),Fb=new L.a,Fb.add(this.Kt.J(gc))):
db=nc}else mb.add(kb),Qb.add(this.Kt.J(gc))}Vb.count&&(nb=Ja,nc=this.gA.count?(new r.a(this.em,Bb)).toString():this.fp.contentReplicator.$t.toString(),nb=f.a.Jn(nb,X.a.gra,nc),nb=f.a.Jn(nb,X.a.bac,Bb.toString()),sa.ImageReader.increaseMaxWebFriendlyDimensionTo1600&&(nb=f.a.Jn(nb,X.a.MLb,"1")),db=qa.a.construct(Vb.toArray(),!0,l.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.fp.Bs:null),this.gA.add(new na(db,H.c(db),mc,nb)),Bb+=Vb.count,this.Q$c.add(Oa.g9e));mb.count&&
(nb=Ja,nc=this.gA.count?(new r.a(this.em,Bb)).toString():this.fp.contentReplicator.$t.toString(),nb=f.a.Jn(nb,X.a.gra,nc),nb=f.a.Jn(nb,X.a.bac,Bb.toString()),nb=f.a.Jn(nb,X.a.MLb,"1"),mb=qa.a.construct(mb.toArray(),!1,l.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.fp.Bs:null),this.gA.add(new na(mb,H.c(mb),Qb,nb)),l.AFrameworkApplication.F6("WoInc325;WoInc325cf"),this.Q$c.add(this.JDg));ob.count&&(nb=Ja,nc=this.gA.count?(new r.a(this.em,Bb)).toString():this.fp.contentReplicator.$t.toString(),
nb=f.a.Jn(nb,X.a.gra,nc),nb=f.a.Jn(nb,X.a.bac,Bb.toString()),nb=f.a.Jn(nb,X.a.MLb,"1"),Ja=qa.a.construct(ob.toArray(),!1,l.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.fp.Bs:null,!0),this.gA.add(new na(Ja,H.c(Ja),cb,nb)),this.Q$c.add(this.JDg));W.ULS.sendTraceTag(595068930,307,50,"Prepared "+(this.gA?this.gA.count:-1)+" picture paste requests to send");this.Ijb()};this.picturePasteRequestSucceeded=Ja=>{W.ULS.sendTraceTag(572528019,307,50,"PicturePasteRequestSucceeded received response with Http status: {0}",
this.Lsl(Ja));if(({group:nb}=Y.a.G7(Ja.data.Ee)).returnValue){var nb=nb.Responses[0];if(nb.StatusCode)46!==nb.StatusCode||this.gA.J(this.CHa).CJd?(W.ULS.sendTraceTag(51212675,322,15,"Picture paste request failed with reason "+nb.StatusCode),Ja=Object.assign(new ca.a,{extendedProperties:new Map}),Ja.extendedProperties.set("statuscode",nb.StatusCode.toString()),u.Health.instance.recordQosError("PictureRemotePasteFailed",Na,!1,!0,!1,!1,Ja),this.$Ql()):(this.gA.J(this.CHa).CJd=!0,this.Ijb());else{let Bb=
nb="";Ja&&Ja.data&&Ja.data.qj&&(V.a.gD in Ja.data.qj&&Ja.data.qj[V.a.gD]&&(Bb=Ja.data.qj[V.a.gD]),"X-CorrelationId"in Ja.data.qj&&Ja.data.qj["X-CorrelationId"]&&(nb=Ja.data.qj["X-CorrelationId"]));W.ULS.sendTraceTag(595068929,307,50,"PicturePasteRequestSucceeded called.[Status code: {0}][X-CorrelationID: {1}]",Bb,nb);this.Xsc&&(this.Xsc.stop(),this.Xsc=null);this.CHa++;this.Idj&&this.Ijb();this.iXg=this.fp.contentReplicator.$t;let mb=null;mb=Object.assign(new Ia,{retry:0,delay:this.Q$c.J(this.CHa-
1)});Ja=new v.a(2,1,Oa.g9e,()=>{this.fp.contentReplicator.VZd(this.tIh,null,mb)},124);this.Hb.$b(Ja)}}else W.ULS.sendTraceTag(7869457,307,10,"PicturePasteRequestSucceeded received null or empty server response group"),Ja=new w.a(Ja.data),this.jac(Ja)};this.tIh=Ja=>{const nb=!r.a.Dp(this.iXg,this.fp.contentReplicator.$t);W.ULS.sendTraceTag(8246492,307,50,"Revision changed after ForceInbound: {0}",nb);if(nb)this.Uhh();else{const Bb=Ja?Ja:null;if(Ja&&Bb&&Bb.retry<Oa.ebl){Bb.retry+=1;Ja=new v.a(2,1,Bb.delay,
()=>{this.fp.contentReplicator.VZd(this.tIh,null,Bb)},125);this.Hb.$b(Ja);return}Ja=Oa.g9e;null!=Bb&&(Ja=Bb.delay);Ja=new v.a(2,1,Ja,()=>{this.fp.contentReplicator.VZd(null,null,null)},125);this.Hb.$b(Ja);this.Vhh()}Oa.hDf--;l.AFrameworkApplication.ya.processAction(J.a.K3a,2);Ea.a.instance.Rgc(this.fp,0);this.Wdg();this.fw.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)};this.jac=Ja=>{var nb="",Bb="";Ja&&Ja.data&&Ja.data.qj&&("X-CorrelationId"in Ja.data.qj&&Ja.data.qj["X-CorrelationId"]&&
(nb=Ja.data.qj["X-CorrelationId"]),V.a.gD in Ja.data.qj&&Ja.data.qj[V.a.gD]&&(Bb=Ja.data.qj[V.a.gD]));Bb=""===Bb?"":String.format("[Operation Result: {0}]",Bb);nb=""===nb?"":String.format("[X-CorrelationID: {0}]",nb);W.ULS.sendTraceTag(51212676,322,15,"Picture paste request failed.[HttpStatus: {2}] [Connection state: {3}]{0}{1}",Bb,nb,Ja.data.mf,z.SessionStatusManager.instance.dK);9===Ja.data.status||this.gA.J(this.CHa).CJd?(Ea.a.instance.Rgc(this.fp,127),this.Gjh(),this.Xsc=null,u.Health.instance.recordQosError("PictureRemotePasteFailed",
Na,!1,!0,!1,!1,null)):(this.gA.J(this.CHa).CJd=!0,this.Ijb())};this.hj=ab;this.Hb=zb;this.sm=Qa;this.le=ua.App.xa.iq;this.voc=lb;this.BY=Eb;this.n8a=bc;this.ZAe=Pb;this.dre=Va;this.Twe=oa;this._operationId=pa;this.SRj=Ya;this.JDg=l.AFrameworkApplication.K.rc("PicturePasteHttpForceInboundDelay",3E3);this.tVg=this.K?this.K.$("ProvideUnsupportedUrlSchemeIsEnabled"):!1;ua.App.Ffc.addHandler(this);this.JIj=!!yb&&yb.isFeatureEnabled(131)}get fw(){return this.xp||(this.xp=a.a.instance.resolve("Common.Utils.IAriaNotifier"))}get K(){return l.AFrameworkApplication.K}get iac(){return ua.App.iac}get Eoi(){return this.uhb===
ua.App.Uxf}get Idj(){return this.CHa!==this.gA.count}Wdg(){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>{const Ra=a.a.instance.Za("Common.ISystemInitiatedFeedback");Ra&&Ra.execute(ab=>{ab.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}get K1(){return this.em}lua(Ra){Ra.alt.length>Ga.Zgb&&(Ra.alt=Ra.alt.substring(0,B.a.Ky(Ra.alt,Ga.Zgb)?Ga.Zgb-1:Ga.Zgb));if(this.BY&&this.n8a&&this.ZAe&&
Oa.Acm(Ra)){this.Twe&&N.c(ta.a.L4k);var ab="unknown";this.tVg&&(Ra=new URL(Ra.src),ab=ka[Sa.a.Edo(Ra.protocol)]);W.ULS.sendTraceTag(41969745,322,15,"Unable to paste image with local URL. OperationId: {0}, URL scheme: {1}, rtfDataStatus: {2}",this._operationId,ab,this.SRj);Ra=Object.assign(new ca.a,{extendedProperties:new Map});Ra.extendedProperties.set("protocol",ab);u.Health.instance.recordQosError("PictureRemoteWithLocalPath",Na,!0,!0,!1,!1,Ra);this.sWn()}else{ab=new G.DictionaryPropertySet;Ra=
this.jTi(Ra);null!==Ra.aud&&"chart"===Ra.aud.type&&ab.setValue(R.a.gq,7);this.hj.$Zd(ab,Ra.width,Ra.height,!0);W.ULS.shipAssertTag(7869444,307,Pa.ParagraphReader.oc(this.Bc.currentNode));this.Xsc=this.le.fg("WebServiceCall",Oa.L2m);W.ULS.sendTraceTag(20505094,322,50,String.format("ImagePasteRequest img width: {0}, height {1}",Ra.width,Ra.height));var zb=da.a.iw(this.Bc.currentNode);ab=this.hj.FLd(zb,ab);this.j$g(ab,Ra)}}oGf(){0<this.uhb&&(this.em=m.a.create(),this.fp=this.Kt.J(0).node.Bi(),W.ULS.sendTraceTag(38122840,
307,50,"Pasted pictures: {0}",this.uhb),this.pTd&&(W.ULS.sendTraceTag(38122841,307,15,"MaxPicturesExceeded in paste."),this.BVn()),Ea.a.instance.T7f(this.fp),this.Wdg(),this.fp.contentReplicator.forceOutbound(this.M5m,null,null))}v5d(Ra){if(0<this.uhb){const zb=Ra.ia(R.a.Vea,!1),Qa=Ra.ia(P.a.WOc,!1),yb=Ra.ia(P.a.H$,!1);Ra=Ra.ia(I.a.Qda,-1);for(let lb=0;lb<this.Kt.count;lb++){var ab=this.Kt.J(lb).blob;ab&&(ab=ab.properties,ab.setValue(R.a.Vea,zb),ab.setValue(P.a.WOc,Qa),ab.setValue(P.a.H$,yb),ab.setValue(I.a.Qda,
Ra),this.hj.zUf(ab,Ra))}}}u0a(){}jTi(Ra){W.ULS.shipAssertTag(7869447,307,fa.a.instance.J(7));var ab=ia.WordSectionNavigator.instance.RL(this.Bc.xn);if(!ab)return Ra;var zb=F.a.Ni(Oa.Sg.oA(ab)-Oa.Sg.Hsa(ab)-Oa.Sg.Zka(ab),1);ab=F.a.Ni(Oa.Sg.Gv(ab)-Oa.Sg.vL(ab)-Oa.Sg.wL(ab),0);W.ULS.shipAssertTag(7869449,307,0<=zb);W.ULS.shipAssertTag(7869450,307,0<=ab);if(Ra.height>zb){const Qa=zb/Ra.height;Ra.height=zb;Ra.width=Math.floor(Ra.width*Qa)}Ra.width>ab&&(zb=ab/Ra.width,Ra.width=ab,Ra.height=Math.floor(Ra.height*
zb));return Ra}sWn(){const Ra=Box4Intl.Box4Strings.l_PastedImageFailedWithInvalidUrl;if(!this.Qpc||this.Qpc.message!==Ra&&!this.Qpc.cCa)this.Qpc=this.BY.qza(Ra,!1),this.BY.eB(this.Qpc)}Vgl(){if(this.voc&&this.voc.$Co())return this.voc.QBo();var Ra=new Sys.Net.WebRequest;Ra.set_url("PicturePaste.ashx");Ra=Ra.getResolvedUrl();l.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")||(Ra=f.a.Jn(Ra,X.a.fileId,this.fp.Bs));return Ra}$go(Ra,ab){if(Ra&&ab){const zb=F.a.yf(sa.ImageReader.fI(Ra.properties),
0);Ra=F.a.yf(sa.ImageReader.tL(Ra.properties),1);0<zb&&zb<ab.width&&(ab.width=zb,ab.height=Ra)}}Ijb(){const Ra={},ab=m.a.create().toString();Ra[Oa.correlationID]=ab;l.AFrameworkApplication.Ze.Lj(this.gA.J(this.CHa).url,2,this.gA.J(this.CHa).Atn,Ra,!1,2,this.picturePasteRequestSucceeded,this.jac,null,void 0,void 0,void 0,void 0,"26");Oa.hDf++;W.ULS.sendTraceTag(572528018,307,50,"SendPicturePasteRequest PicturePaste request added to the queue with correlation id : {0}",ab)}Lsl(Ra){return Ra&&Ra.data?
Ra.data.mf:-1}$Ql(){Ea.a.instance.Rgc(this.fp,127);this.Gjh()}Gjh(){W.ULS.shipAssertTag(7869458,307,this.Idj);const Ra=new Ca.GraphTransaction(15);Ra.Db(this.Kt.J(0).node);for(let ab=this.CHa;ab<this.gA.count;ab++){const zb=this.gA.J(ab).w4l;for(let Qa=0;Qa<zb.count;Qa++){const yb=zb.J(Qa).blob.properties;this.hj.$Oa(yb,Box4Intl.Box4Strings.l_PastedImageFailed);sa.ImageReader.MXi(yb)}}Ra.dispose();this.sm.FYb(this.fp,!1);this.Thh()}BVn(){const Ra=new K.StandardDialog;Ra.Ed=0;Ra.fy(0,Box4Intl.Box4Strings.l_MaxPicturesExceededTitle,
String.format(Box4Intl.Box4Strings.l_MaxPicturesExceededMessage,ua.App.Uxf),null,!0);l.AFrameworkApplication.ya.processAction(ta.a.xCi,2)}BRm(Ra,ab){Ra.alt.length>Ga.Zgb&&(Ra.alt=Ra.alt.substring(0,B.a.Ky(Ra.alt,Ga.Zgb)?Ga.Zgb-1:Ga.Zgb));const zb=new G.DictionaryPropertySet;this.hj.$Zd(zb,Ra.width,Ra.height);ab=this.hj.FLd(ab,zb);Ra=this.jTi(Ra);this.j$g(ab,Ra)}Thh(){}Uhh(){}Vhh(){}TJd(){return!!Oa.hDf}static get Sg(){return ea.a.instance}static Acm(Ra){return!!Ra&&!!Ra.src&&!Sa.a.Wfi(Ra.src)}}Oa.g9e=
1E3;Oa.ebl=4;Oa.L2m="PicturePasteRequestTime";Oa.correlationID="X-CorrelationId";Oa.hDf=0;Oa.yEm=20971520;Object(D.a)(Oa,"Box4ImageSteward",Ga,[573])},1828:function(D,M,d){D=d(0);var m=d(43),f=d(98),a=d(7),l=d(29);class r extends Sys.UI.Control{constructor(K,N,H,J){super(document.createElement("div"));this.cY=this.xha=this.CM=this.mv=this.C0=this.U4a=this.f8a=null;this.Jnc=this.J6a=!1;this.content=this._title=null;this.kha=0;this.Ndh=null;this.fda=0;this.Eyi=null;this.W0g=K;this.LSb=N;this.Kj=H;this.jmh=
J;this.Ik=N.ownerDocument;this.RJd=this.yt=this.DR=!1}get R6(){this.f8a||(this.f8a=this.Ik.createElement("div"),this.f8a.id=this.pj("WACCalloutOuter"),this.f8a.className="WACCalloutOuter",this.f8a.setAttribute(l.a.Ah,l.a.rch),this.f8a.style.width=this.kha+"px");return this.f8a}get Hyc(){if(!this.U4a){this.U4a=this.Ik.createElement("div");this.U4a.id=this.pj("WACCalloutBeakContainer");this.U4a.className="WACCalloutBeakContainer";var K="CalloutBeakTopFilled_32x16x32";if(5===this.fda||6===this.fda||
4===this.fda)K="CalloutBeakBottomFilled_32x16x32";K=f.createClusteredImage(32,16,K,"WACCalloutBeak",!0,"");this.U4a.appendChild(K)}return this.U4a}set Hyc(K){this.U4a=K}get qI(){return this.DR}get title(){return this._title}set title(K){this._title!==K&&(this._title=K,this.xha&&(this.xha.innerText=this._title))}get yt(){return this.J6a}set yt(K){this.J6a!==K&&(this.J6a=K,this.C0&&(this.C0.contains(this.CM)&&!this.J6a?this.C0.removeChild(this.CM):!this.C0.contains(this.CM)&&this.J6a&&this.f6g()))}get RJd(){return this.Jnc}set RJd(K){this.Jnc!==
K&&(this.Jnc=K,this.C0&&(this.C0.contains(this.xha)&&!this.Jnc?this.C0.removeChild(this.xha):!this.C0.contains(this.xha)&&this.Jnc&&this.N7g()))}show(){this.DR||(this.iHk(),this.JH(),this.LSb.appendChild(this.R6),this.R6.style.display="Block",this.xMn(),this.DR=!0,this.Eyi&&this.Eyi())}dismiss(){this.DR&&(this.NSk(),this.LSb.removeChild(this.R6),this.DR=!1,this.jmh&&this.jmh())}dispose(){this.dismiss();this.xha=this.CM=this.mv=this.U4a=this.C0=this.f8a=null;Sys.Component.prototype.dispose.call(this)}pj(K){return this.get_element().id+
K}iHk(){this.C0=this.Ik.createElement("div");this.C0.id=this.pj("WACCalloutHeader");this.C0.className="WACCalloutHeader";this.yt&&this.f6g();this.RJd&&this.N7g();this.mv=this.Ik.createElement("div");this.mv.id=this.pj("WACCalloutContent");this.mv.className="WACCalloutContent";this.mv.style.width=190<this.kha?this.kha-26+"px":"164px";this.mv.appendChild(this.content);this.R6.appendChild(this.Hyc);this.R6.appendChild(this.C0);this.R6.appendChild(this.mv)}f6g(){this.CM=this.Ik.createElement("a");this.CM.className=
"WACCalloutCloseAnchor";this.CM.id=this.pj("WACCalloutCloseAnchor");this.CM.href="#";this.C0.appendChild(this.CM);const K=f.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.CM.appendChild(K)}N7g(){this.xha=this.Ik.createElement("div");this.xha.className="WACCalloutTitle UIFontBold";this.xha.style.width=190<this.kha?this.kha-30+"px":"160px";this.xha.id=this.pj("WACCalloutTitle");this.xha.innerText=this.title;this.C0.contains(this.CM)?
this.C0.insertBefore(this.xha,this.CM):this.C0.appendChild(this.xha)}xMn(){var K=this.W0g;let N;if(1===this.fda){var H=this.Ndh.y+16;N=-16}else 2===this.fda||3===this.fda||0===this.fda?(H=K.y+K.height+15,N=-15):(H=K.y-this.R6.clientHeight-15-2,N=this.R6.clientHeight-1);this.R6.style.top=H+"px";this.Hyc.style.top=N+"px";1===this.fda?(K=this.Ndh.x-16,this.R6.style.left="50%",this.R6.style.marginLeft=-this.kha/2+"px",H=Sys.UI.DomElement.getBounds(this.R6),this.Hyc.style.left=K-H.x+"px"):(H=K.x+this.W0g.width/
2,2===this.fda||5===this.fda?(K=20,H-=36):0===this.fda||4===this.fda?(K=this.kha/2-16,H-=this.kha/2):(K=this.kha-20-32,H=H-this.kha+36),this.R6.style.left=H+"px",this.Hyc.style.left=K+"px")}JH(){this.yt&&!this.cY&&(this.cY=Object(m.a)(this,this.Kja,"closeHandler"),this.Kj.mb(a.a.click,this.CM,this.cY,null))}NSk(){this.yt&&this.cY&&(this.Kj.sc(a.a.click,this.CM,this.cY),this.cY=null)}Kja(){this.dismiss();return!0}}Object(D.a)(r,"Callout",Sys.UI.Control,[1002]);class w extends r{constructor(K,N,H,J,
L,I=null){super(K,H,L.C_,I);this.APg=0;this.kha=this.lxl(J);this.gVb=N;this.xi=L;this.C6n=7;this.nq=this.gVb.ownerDocument.createElement("div");this.nq.className="ModalCalloutControlOverlay";this.nq.tabIndex=0;this.gVb.insertBefore(this.nq,this.gVb.firstChild)}show(){this.qI||(this.xi.ZZd(),this.xi.gda(!1),this.nq.style.zIndex=String(this.xi.oya),super.show(),this.Uy(),this.APg=window.setTimeout(Object(m.a)(this,this.dismiss,"dismiss"),1E3*this.C6n))}dismiss(){this.qI&&(this.xi.Q9(!1),this.J7(),this.gVb&&
this.gVb.contains(this.nq)&&this.gVb.removeChild(this.nq),super.dismiss(),window.clearTimeout(this.APg))}Uy(){this.xi.i1(Object(m.a)(this,this.dismiss,"dismiss"));this.xi.Zy.mb(a.a.click,this.nq,Object(m.a)(this,this.onClick,"onClick"))}J7(){this.xi.dga(Object(m.a)(this,this.dismiss,"dismiss"));this.xi.Zy.sc(a.a.click,this.nq,Object(m.a)(this,this.onClick,"onClick"))}onClick(){this.dismiss();return!0}lxl(K){let N=0;switch(K){case 0:N=190;break;case 1:N=250;break;case 2:N=300;break;case 3:N=360}return N}}
Object(D.a)(w,"ModalCallout",r,[]);var v=d(8),u=d(735),z=d(190);class B extends w{constructor(K,N,H,J,L,I=null){super(K,N,H,J,L,I);this.LR=null}show(){if(!this.qI){const K=Object.assign(new u.a,{onShow:()=>{w.prototype.show.call(this)}});z.UISurfaces.UP().then(N=>{const H=N.externalNotification();this.LR=N.addNotification(H,K);return null},N=>{v.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",N);return null})}}dismiss(){this.qI&&this.LR&&(z.UISurfaces.UP().then(K=>{K.removeNotification(this.LR);
return this.LR=null},K=>{v.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",K);return null}),super.dismiss())}}Object(D.a)(B,"ReactManagedModalCallout",w,[]);var G=d(2);d.d(M,"a",function(){return F});class F{static Jsh(K,N,H,J){return G.AFrameworkApplication.ua.Sb.nMa?new B(K,N,H,J,G.AFrameworkApplication.ua,null):new w(K,N,H,J,G.AFrameworkApplication.ua,null)}}Object(D.a)(F,"ModalCalloutControlFactory",null,[])},1834:function(D,M,d){D=d(0);class m{constructor(a){this.next=
null;this.data=a}}Object(D.a)(m,"QueueNode",null,[]);d.d(M,"a",function(){return f});class f{constructor(){this.apb=this.fnb=null;this.aj=0}get count(){return this.aj}get isEmpty(){return!this.count||!this.fnb||!this.apb}enqueue(a){a=new m(a);this.isEmpty?this.apb=this.fnb=a:this.fnb=this.fnb.next=a;this.aj=this.count+1}back(){return this.isEmpty?null:this.fnb.data}dequeue(){if(this.isEmpty)return null;const a=this.apb;this.apb=a.next;this.aj=this.count-1;this.apb||(this.fnb=null);return a.data}clear(){this.apb=
this.fnb=null;this.aj=0}toArray(){const a=Array(this.count);let l=this.apb;for(let r=0;r<this.count&&l;r++)a[r]=l.data,l=l.next;return a}}Object(D.a)(f,"Queue",null,[])},1885:function(D,M,d){d.d(M,"b",function(){return m});d.d(M,"e",function(){return f});d.d(M,"d",function(){return a});d.d(M,"c",function(){return l});d.d(M,"h",function(){return r});d.d(M,"a",function(){return w});d.d(M,"f",function(){return v});d.d(M,"g",function(){return u});var m;(function(z){z[z.Unspecified=0]="Unspecified";z[z.Inline=
1]="Inline";z[z.Floating=2]="Floating"})(m||(m={}));var f;(function(z){z[z.Undefined=0]="Undefined";z[z.Bullet=1]="Bullet";z[z.Numbered=2]="Numbered";z[z.Lim=3]="Lim";z[z.Nil=4]="Nil";z[z.Any=5]="Any";z[z.NoList=6]="NoList";z[z.Invalid=7]="Invalid"})(f||(f={}));var a;(function(z){z[z.DontCare=1]="DontCare";z[z.Thin=2]="Thin";z[z.ExtraLight=3]="ExtraLight";z[z.Light=4]="Light";z[z.Normal=5]="Normal";z[z.Medium=6]="Medium";z[z.SemiBold=7]="SemiBold";z[z.Bold=8]="Bold";z[z.ExtraBold=9]="ExtraBold";z[z.Heavy=
10]="Heavy"})(a||(a={}));var l;(function(z){z[z.NoCaps=0]="NoCaps";z[z.SmallCaps=1]="SmallCaps";z[z.AllCaps=2]="AllCaps";z[z.AllPetiteCaps=3]="AllPetiteCaps";z[z.PetiteCaps=4]="PetiteCaps";z[z.Unicase=5]="Unicase";z[z.Titling=6]="Titling";z[z.Other=7]="Other"})(l||(l={}));var r;(function(z){z[z.None=0]="None";z[z.Words=1]="Words";z[z.SingleLine=2]="SingleLine";z[z.DoubleLine=3]="DoubleLine";z[z.HeavyLine=4]="HeavyLine";z[z.DottedLine=5]="DottedLine";z[z.DottedHeavyLine=6]="DottedHeavyLine";z[z.DashLine=
7]="DashLine";z[z.DashHeavyLine=8]="DashHeavyLine";z[z.DashLongLine=9]="DashLongLine";z[z.DashLongHeavyLine=10]="DashLongHeavyLine";z[z.DotDashLine=11]="DotDashLine";z[z.DotDashHeavyLine=12]="DotDashHeavyLine";z[z.DotDotDashLine=13]="DotDotDashLine";z[z.DotDotDashHeavyLine=14]="DotDotDashHeavyLine";z[z.WavyLine=15]="WavyLine";z[z.WavyHeavyLine=16]="WavyHeavyLine";z[z.WavyDoubleLine=17]="WavyDoubleLine"})(r||(r={}));var w;(function(z){z[z.Left=0]="Left";z[z.Right=1]="Right";z[z.Center=2]="Center";
z[z.Justified=3]="Justified";z[z.Other=4]="Other";z[z.None=5]="None";z[z.JustifyLow=6]="JustifyLow";z[z.Distributed=7]="Distributed";z[z.ThaiDistributed=8]="ThaiDistributed"})(w||(w={}));var v;(function(z){z[z.Image=0]="Image";z[z.TextBox=1]="TextBox";z[z.Chart=2]="Chart";z[z.SmartArt=3]="SmartArt";z[z.Drawing=4]="Drawing";z[z.EquationObject=5]="EquationObject";z[z.Ink=6]="Ink";z[z.InkSpace=7]="InkSpace";z[z.InkEndOfLine=8]="InkEndOfLine";z[z.LineBreak=9]="LineBreak";z[z.PageBreak=10]="PageBreak";
z[z.PageNumbers=11]="PageNumbers";z[z.FootnoteEndnote=12]="FootnoteEndnote";z[z.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark";z[z.Tab=14]="Tab";z[z.UnsupportedObject=15]="UnsupportedObject";z[z.Other=16]="Other"})(v||(v={}));var u;(function(z){z[z.Initial=0]="Initial";z[z.FirstLine=1]="FirstLine";z[z.Hanging=2]="Hanging"})(u||(u={}))},1887:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);var m;(function(f){f[f.normal=0]="normal";f[f.beingCreated=1]="beingCreated";f[f.beingEdited=
2]="beingEdited"})(m||(m={}));Object(D.b)("CommentType",m)},1889:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{static sdf(f){return f===m.create?0:f===m.reply?1:f===m.edit?2:f===m.metadata?3:null}}m.create="CREATE";m.reply="REPLY";m.edit="EDIT";m.metadata="METADATA";Object(D.a)(m,"CommentSessionType",null,[])},1890:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);var m;(function(f){f[f.unsaved=0]="unsaved";f[f.sentToServer=1]="sentToServer";f[f.succeeded=2]="succeeded";f[f.failed=
3]="failed";f[f.saveNotNeeded=4]="saveNotNeeded"})(m||(m={}));Object(D.b)("CommentSaveStatus",m)},1891:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f,a){this.className=f;this.CJc=a}}Object(D.a)(m,"HighlightCssClassPair",null,[])},1892:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(){this.type=this.action=0;this.eO=this.vF=null}}Object(D.a)(m,"HighlightOperation",null,[])},1893:function(D,M,d){d.d(M,"a",function(){return f});D=d(0);M=d(245);
var m=d(125);class f extends M.a{constructor(){super();this.LastKnownPaginationRevision=this.FileId=null}Wl(){return 36}static A9(a,l){const r=new f;r.FileId=a;r.LastKnownPaginationRevision=m.a(l);return r}}Object(D.a)(f,"PaginationRequest",M.a,[])},1895:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{Q2b(f,a){let l="g";a.matchCase||a.gTd||(l+="i");if(a.matchPrefix||a.matchWholeWord)f="\\b"+f;if(a.matchSuffix||a.matchWholeWord)f+="\\b";return new RegExp(f,l)}static get instance(){return m._instance||
(m._instance=new m)}}m._instance=null;Object(D.a)(m,"FindUtils",null,[1081])},1897:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f,a){this._text=f;this.Smc=a}get text(){return this._text}get matchCase(){return this.XCb(1)}get matchWholeWord(){return this.XCb(2)}get gTd(){return this.XCb(4)}get matchPrefix(){return this.XCb(8)}get matchSuffix(){return this.XCb(16)}get ignorePunct(){return this.XCb(32)}get ignoreSpace(){return this.XCb(64)}XCb(f){return(this.Smc&f)===f}static createQuery(f,
a){return new m(f,a)}}Object(D.a)(m,"Query",null,[1079])},1898:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);var m;(function(f){f[f.none=0]="none";f[f.matchCase=1]="matchCase";f[f.wholeWordOnly=2]="wholeWordOnly";f[f.wildCards=4]="wildCards";f[f.prefix=8]="prefix";f[f.suffix=16]="suffix";f[f.ignorePunct=32]="ignorePunct";f[f.ignoreSpace=64]="ignoreSpace"})(m||(m={}));Object(D.b)("QueryFilters",m)},1899:function(D,M,d){d.d(M,"a",function(){return w});D=d(0);var m=d(153),f=d(160),a=d(2),l=
d(56),r=d(154);class w extends m.a{constructor(v,u=!1){super(v,!1,u)}get jOd(){return!1}get PJ(){return r.a.lDc+"/modeless"}get xgb(){return null}set xgb(v){}get tgb(){return null}set tgb(v){}Zh(v,u=null,z=null){this.iS&&(z.isModal=!1);super.Zh(v,u,z)}hide(){if(a.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||this.ed)this.Kfj(),a.AFrameworkApplication.ua.gv.Hw(f.AFrame.Uyf),super.hide()}a1j(){const v=a.AFrameworkApplication.ua.gv,
u=a.AFrameworkApplication.ua.Yo;v.tya(this.PJ);v.kS(this.PJ);u.pe(this.PJ).parent=f.AFrame.Lp}uya(){l.FocusManager.YI()&&(super.uya(),this.a1j(),a.AFrameworkApplication.ua.gv.tG(f.AFrame.Uyf))}BQf(){if(l.FocusManager.YI()&&!a.AFrameworkApplication.Dk){const v=l.FocusManager.instance();v.GQ(this.PJ);const u=v.getRegion(this.PJ);u&&u.Uj.hy(null);v.NHb(this.PJ)}}Yfa(){"DL"===this.jya||"DP"===this.jya?super.Yfa():a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("WacAutoFitNonModalDialogIsEnabled")?
(this.Kfj(),this.zdh()&&this.r4i(this.ed.clientHeight,this.ed.clientWidth)):this.nO()}nO(){this.r4i(m.a.jzg,m.a.qzg)}r4i(v,u){if(this.tgb&&this.xgb){let z,B;z=r.a.RZd+this.xgb;B=r.a.QZd+this.tgb;z+v>this.oA()&&(z=this.oA()-v);B+u>this.Gv()&&(B=this.Gv()-u);this.s4i(z,B)}else super.nO()}getNumber(v){if(!v)return null;v.endsWith("px")&&(v=v.substring(0,v.length-2));return r.a.s6b(v)?((v=parseInt(v))||(v=1),v):null}Kfj(){if(this.ed&&this.ed.style){var v=this.getNumber(this.ed.style.top);v&&(this.xgb=
v-r.a.RZd);if(v=a.AFrameworkApplication.isRtl?this.getNumber(this.ed.style.right):this.getNumber(this.ed.style.left))this.tgb=v-r.a.QZd}}}Object(D.a)(w,"ModelessCustomDialog",m.a,[])},1900:function(D,M,d){d.d(M,"a",function(){return z});D=d(0);var m=d(8),f=d(2),a=d(285),l=d(184),r=d(495),w=d(592),v=d(593),u=d(16);class z{constructor(B,G=null,F=-1,K=null){this.d5=B;this.R3g=K||(()=>G);this.J8c=F}Lj(B,G,F,K,N,H,J,L,I,R=null,C=!1,P=null,W=null){const X=new XMLHttpRequest;let V="";H="";2===G?(V="POST",
F&&(H=F)):V="GET";G={};this.d5&&(B=a.a.PMe(G,B,a.a.hce,f.AFrameworkApplication.ahc,this.d5));X.open(V,B,!0);this.elk(G,B);if(K)for(let ca in K)X.setRequestHeader(ca,u.a.aQ(K[ca]));for(let ca in G)X.setRequestHeader(ca,G[ca]);B=P||this.J8c;0<B&&(X.timeout=B);B=[];Array.add(B,a.a.I5);K=new Sys.Net.WebRequest;const Y=new w.a(1,2,K,B,N,J,L,I,C,R,W);X.onreadystatechange=()=>{this.YTm(X,Y)};try{X.send(H)}catch(ca){m.ULS.sendTraceTag(24938643,205,15,"Invoke failed in SimpleClientRequestSender")}return 1}S2b(){return 1}YTm(B,
G){if(this.$sk(B,G)&&4===B.readyState)if(B.getResponseHeader(a.a.fCh)&&f.AFrameworkApplication.sEc)f.AFrameworkApplication.sEc();else{var F=B.getResponseHeader(a.a.Cih);a.a.B6f(F);this.Zio(B,G);B.status===l.a.qD?(G.status=2,G.sK(new v.a(G))):(G.status=B.status&&B.status!==l.a.Mbc?B.status===l.a.Vfa?5:3:7,G.R1(new r.a(G)))}}elk(B,G){B["X-xhr"]=1;f.AFrameworkApplication.SZa&&(B[a.a.Yki]=1);f.AFrameworkApplication.buildVersion&&(B[a.a.K9b]=u.a.aQ(f.AFrameworkApplication.buildVersion));let F=null;this.R3g&&
(F=this.R3g());F&&(B[a.a.f9f]=F);f.AFrameworkApplication.canary&&(B[a.a.jYb]=u.a.aQ(f.AFrameworkApplication.canary),f.AFrameworkApplication.oQc&&m.ULS.sendTraceTag(24938644,205,50,"Canary in request: {0}",B[a.a.jYb]));f.AFrameworkApplication.accessToken&&(a.a.fwb(G,f.AFrameworkApplication.h5)||(B[a.a.PLe]=u.a.aQ(f.AFrameworkApplication.accessToken)),a.a.fwb(G,f.AFrameworkApplication.nya)||(B[a.a.QLe]=f.AFrameworkApplication.LIa.toString()));f.AFrameworkApplication.userType&&(B[a.a.hij]=u.a.aQ(f.AFrameworkApplication.userType))}Zio(B,
G){G.mf=B.status?B.status:l.a.Mbc;try{G.Ee=B.responseText;if(void 0!==G.FOa&&null!==G.FOa){G.qj={};for(let F=0;F<G.FOa.length;++F){const K=G.FOa[F];G.qj[K]=B.getResponseHeader(K)}}G.P6d&&(G.gga=B.responseText&&B.responseText.length?B.responseXML:null)}catch(F){m.ULS.sendTraceTag(24938645,205,10,"OnRequestCompleted: Unable to get ResponseData/XML, Id={0}, Url={1} ResponseAvailable={2}",G.id,G.request.get_url(),4===B.readyState)}}$sk(B,G){return B?G?!0:(m.ULS.sendTraceTag(24938648,205,15,"OnRequestCompleted in SimpleClientRequestSender: RequestItem doesn't exist."),
!1):(m.ULS.sendTraceTag(24938646,205,15,"OnRequestCompleted in SimpleClientRequestSender: XMLHttpRequest doesn't exist."),!1)}static create(B,G,F){return new z(B,null,F,G)}}Object(D.a)(z,"SimpleClientRequestSender",null,[838])},1901:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);var m;(function(f){f[f.connected=0]="connected";f[f.disconnected=1]="disconnected";f[f.connecting=2]="connecting";f[f.timeout=3]="timeout"})(m||(m={}));Object(D.b)("AppNetworkConnectivityState",m)},1902:function(D,
M,d){d.d(M,"a",function(){return m});D=d(0);class m{BKa(){}S0b(){}p6d(){}T4d(){}reset(){}b8e(){}update(){}Yjb(){}dispose(){}}Object(D.a)(m,"FindStatusManagerStub",null,[280,10])},1920:function(D,M,d){D=d(0);var m=d(1553),f=d(1554),a=d(1606),l=d(216),r=d(35);class w{}w.eventType="Type";w.Vbb="Time";w.eventId="Id";w.fdh="AttributionId";w.gdh="AttributionProvider";w.edh="AttributionName";w.Rch="AssigneeId";w.Sch="AssigneeProvider";w.Qch="AssigneeName";w.startDate="Start";w.endDate="End";w.title="Title";
w.inh="Anchor";w.anchorExtensionList="AnchorExtensionList";w.FCi="Percent";w.priority="Priority";w.undoId="UndoId";w.isLossy="IsLossy";w.recordExtensionList="RecordExtensionList";Object(D.a)(w,"Key",null,[]);var v=d(385),u=d(1736);const z=G=>{if(!G)return null;let F=null;G=v.a.YBc(G,K=>K.toString(),K=>K.toString());0<G.count&&(F=new u.a(G));return F};d.d(M,"a",function(){return B});class B{DVf(G){if(!G)return"[]";G=B.CDk(G);return r.c(G)}v_b(G){G=r.b(G||"[]");return B.mDk(G)}static uba(G,F){throw Error.argument(G,
F);}static C2b(G,F){F=F.toString();return F in G?G[F].toString():null}static wAb(G,F){F=F.toString();F in G||B.uba("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",F));return G[F].toString()}static vdf(G,F){F=F.toString();F in G||B.uba("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",F));return Number.parseInvariant(G[F].toString())}static Bzl(G,F,K){F=F.toString();return F in G?Boolean.parse(G[F].toString()):K}static Czl(G,F){F=
F.toString();return F in G?G[F]:null}static s1f(G){G=new Date(G);isNaN(G.getUTCMilliseconds())&&B.uba("dateTime","Date and time is in invalid format");return G}static S0e(G){return G.toISOString()}static Zrh(G,F){return z(B.Czl(G,F))}static DDk(G){const F={};F[w.eventType]=G.type;F[w.Vbb]=B.S0e(G.time);F[w.eventId]=G.recordId;G.isLossy!==B.Sci&&(F[w.isLossy]=G.isLossy);G.user&&(G.user.UserId&&G.user.Provider&&G.user.DisplayName||B.uba("record","HistoryRecord has invalid attribution"),F[w.fdh]=G.user.UserId,
F[w.gdh]=G.user.Provider,F[w.edh]=G.user.DisplayName);G.commentId&&(F[w.inh]=G.commentId);if(G.anchorExtensionList&&G.anchorExtensionList.extensions){var K=G.anchorExtensionList.extensions.Qfc();F[w.anchorExtensionList]=K}G.recordExtensionList&&G.recordExtensionList.extensions&&(K=G.recordExtensionList.extensions.Qfc(),F[w.recordExtensionList]=K);switch(G.type){case 1:case 4:case 7:case 8:case 0:break;case 2:case 3:G.assignee&&G.assignee.UserId&&G.assignee.Provider&&G.assignee.DisplayName||B.uba("record",
"HistoryRecord has invalid assignee");F[w.Rch]=G.assignee.UserId;F[w.Sch]=G.assignee.Provider;F[w.Qch]=G.assignee.DisplayName;break;case 5:G.schedule||B.uba("record","Schedule history record must have a schedule object");G.schedule.startDate&&(F[w.startDate]=B.S0e(G.schedule.startDate));G.schedule.endDate&&(F[w.endDate]=B.S0e(G.schedule.endDate));break;case 6:(0>G.completion||100<G.completion)&&B.uba("record","Progress history record must have a completion >= 0 and <= 100");F[w.FCi]=G.completion;
break;case 10:(0>G.priority||10<G.priority)&&B.uba("record","Priority history record must have a completion >= 0 and <= 10");F[w.priority]=G.priority;break;case 9:G.title||B.uba("record","SetTitle history record must have a title");F[w.title]=G.title;break;case -1:G.undoId||B.uba("record","Undo history record must have an id to undo");F[w.undoId]=G.undoId;break;default:B.uba("record","Unsupported history record type")}return F}static MDk(G){var F=null,K=B.C2b(G,w.fdh);const N=B.C2b(G,w.gdh),H=B.C2b(G,
w.edh);if(K||N||H)K&&N&&H||B.uba("dictionary","Record has invalid attribution user"),F=new m.a(K,N,H);F=new f.a(B.vdf(G,w.eventType),F,B.s1f(B.wAb(G,w.Vbb)),B.wAb(G,w.eventId));F.commentId=B.C2b(G,w.inh);F.anchorExtensionList=B.Zrh(G,w.anchorExtensionList);F.recordExtensionList=B.Zrh(G,w.recordExtensionList);F.isLossy=B.Bzl(G,w.isLossy,B.Sci);switch(F.type){case 1:case 4:case 7:case 8:case 0:break;case 2:case 3:F.assignee=new m.a(B.wAb(G,w.Rch),B.wAb(G,w.Sch),B.wAb(G,w.Qch));break;case 5:F.schedule=
new a.a;if(K=B.C2b(G,w.startDate))F.schedule.startDate=B.s1f(K);if(G=B.C2b(G,w.endDate))F.schedule.endDate=B.s1f(G);break;case 10:F.priority=B.vdf(G,w.priority);(0>F.priority||10<F.priority)&&B.uba("dictionary","Priority record must have history >= 0 and <= 10");break;case 6:F.completion=B.vdf(G,w.FCi);(0>F.completion||100<F.completion)&&B.uba("dictionary","Progress record must have history >= 0 and <= 100");break;case 9:F.title=B.wAb(G,w.title);break;case -1:F.undoId=B.wAb(G,w.undoId);break;default:B.uba("dictionary",
"Unsupported history record type")}return F}static CDk(G){const F=Array(G.length);for(let K=0;K<G.length;++K)F[K]=B.DDk(G.J(K));return F}static mDk(G){const F=new l.a;for(const K of G)G=B.MDk(K),F.add(G);return F}}B.Sci=!1;Object(D.a)(B,"JsonTaskHistorySerialization",null,[208])},1921:function(D,M,d){D=d(0);class m{constructor(r){this.result=null;this.XJi=r}exec(r){return(this.result=this.XJi.exec(r))?!0:!1}gI(){return this.result.index}sFd(){return this.XJi.lastIndex}}Object(D.a)(m,"RegularExpressionWrapper",
null,[]);var f=d(2),a=d(16);d.d(M,"a",function(){return l});class l{xUc(r){return this.D5i(r).join("").replace(RegExp("(\\\\.\\\\.\\\\.)","g"),"(\\.\\.\\.|\u2026)")}yEi(r){var w=r.text;w=r.gTd?this.KZn(w):this.D5i(w);if(r.ignorePunct||r.ignoreSpace){let v="";r.ignoreSpace&&(v+="\\s");r.ignorePunct&&(v+=l.o$m);v="["+v+"]*";for(let u=1;u<w.length;u++)if(!r.gTd||"{"!==w[u].charAt(0)&&"@"!==w[u].charAt(0))w[u]=v+w[u]}return w.join("")}pGb(r){return[r]}FPd(r){for(let w=0;w<r.length;++w){const v=r.charAt(w);
let u=0;if("["===v){if(!({LC:u}=this.ajm(r.substr(w))).returnValue)return!1;w=u+w-1}else if("<"===v){if(!this.Yim(r.substr(w)))return!1}else if(">"===v){if(!w)return!1}else if("{"===v){if(!w||!({LC:u}=this.$im(r.substr(w))).returnValue)return!1;w=u+w-1}else if("@"===v){if(!w||!this.Zim(r.substr(w)))return!1}else if("("===v){if(!({LC:u}=this.Xim(r.substr(w))).returnValue)return!1;w=u+w-1}else if("}"===v||"]"===v||")"===v)return!1}return!0}GGh(r,w){let v,u;u=v=0;if(r.length<=w)return{returnValue:!1,
LC:v,U3c:u};const z=r.length;var B=r.charAt(w);if("["===B)for(B=w+1;B<z;B++){if("]"===r.charAt(B)&&1!==B-w)return v=B,u=5,{returnValue:!0,LC:v,U3c:u}}else if("{"===B)for(B=-1,w+=1;w<z;w++){let G=r.charAt(w);if(","===G)B=w;else if("}"===G)return u=-1===B?6:1!==w-B?7:8,v=w,{returnValue:!0,LC:v,U3c:u}}return{returnValue:!1,LC:v,U3c:u}}dbo(r,w,v){let u;if((u=w)||1!==r.length)switch(r.charAt(w+1)){case "{":let z,B;if(!({LC:z,U3c:B}=this.GGh(r,w+1)).returnValue)return{returnValue:this.IEa("*",v,!1),LC:u};
r=this.IEa("*",v,!0)+this.IEa(r.substring(w+1,z+1),B);u=z;if(7===B||8===B)r+="?";return{returnValue:r,LC:u};case "@":return u=w+1,{returnValue:this.IEa("*",v,!0),LC:u};case "*":if(!w){for(u++;"*"===r.charAt(u);)u++;if(u===r.length)return{returnValue:this.IEa("*",v,!0),LC:u}}return{returnValue:this.IEa("*",v,!1),LC:u};default:return{returnValue:this.IEa("*",v,!1),LC:u}}else return{returnValue:this.IEa(r,v,!0),LC:u}}IEa(r,w,v=!1){const u=r.length;switch(w){case 5:return"!"===r.charAt(1)&&2<u?"([^"+
this.zEi(r.substr(2,u-3))+"]\u0640*)":"(["+this.zEi(r.substr(1,u-2))+"]\u0640*)";case 6:return r;case 7:return r;case 9:return"+?";case 8:return r;case 3:return"\\b";case 4:return"\\b";case 1:return".";case 2:return v?"(.+?)":"(.*?)";case 10:return r}return null}y_h(r){switch(r){case "?":return 1;case "*":return 2;case "<":return 3;case ">":return 4;case "@":return 9}return 0}W4m(r){return"["===r||"]"===r||"\\"===r||"("===r||")"===r?String.format("\\{0}",r):"'"===r||"\u2018"===r||"\u2019"===r||'"'===
r||"\u201c"===r||"\u201d"===r||a.a.V$(r)?this.PLf(r):r}zEi(r){const w=[];for(let v=0;v<r.length;++v)w[v]=this.W4m(r.charAt(v));return w.join("")}ajm(r){let w;var v;w=-1;var u=new m(RegExp("\\[.+?\\]","g"));if(u.exec(r)){if(v=u.gI())return{returnValue:!1,LC:w};w=u.sFd()}else return{returnValue:!1,LC:w};if((new m(RegExp("(\\(\\))|(.+?!)","g"))).exec(r.substring(1,w-1)))return{returnValue:!1,LC:w};v=new m(RegExp("[^!\\[]-[^\\]]","g"));for(r.substring(0,w);v.exec(r.substring(0,w));){u=v.gI();const z=
RegExp("[-]","g");u=r.substring(u,v.sFd()).split(z);if(u[0].charAt(0)>u[1].charAt(0))return{returnValue:!1,LC:w}}return{returnValue:!0,LC:w}}Yim(r){return(new m(RegExp("\\<(\\{|\\@|\\>|\\<|\\}|\\))","g"))).exec(r)?!1:!0}$im(r){let w;w=-1;var v;if((new m(RegExp("(\\}\\{)|(\\}\\@)","g"))).exec(r))return{returnValue:!1,LC:w};const u=new m(RegExp("\\{\\d+(,|(,\\d+))?\\}","g"));if(u.exec(r)){if(v=u.gI())return{returnValue:!1,LC:w};w=u.sFd();v=RegExp("[{,}]","g");v=r.substring(0,w).split(v);if(4===v.length&&
(r=Number.parseInvariant(v[1]),v=Number.parseInvariant(v[2]),r>=v))return{returnValue:!1,LC:w}}else return{returnValue:!1,LC:w};return{returnValue:!0,LC:w}}Zim(r){return(new m(RegExp("\\@\\{","g"))).exec(r)?!1:!0}Xim(r){let w;w=-1;let v;const u=new m(RegExp("\\(([^\\[\\]]*?(\\[.+?\\])?)+?\\)","g"));if(u.exec(r)){if(v=u.gI(),w=u.sFd(),v||!this.FPd(r.substring(1,w-1)))return{returnValue:!1,LC:w}}else if(f.AFrameworkApplication.K&&f.AFrameworkApplication.K.$("ScriptLabBugFixIsEnabled"))return{returnValue:!1,
LC:w};return{returnValue:!0,LC:w}}KZn(r){const w=[],v=r.length,u=!!f.AFrameworkApplication.K&&f.AFrameworkApplication.K.$("ScriptLabBugFixIsEnabled");let z=0;for(let B=0;B<v;++B){const G=u?z:B,F=r.charAt(B);let K=0,N=0;"["===F||"\\"===F||"^"===F||"$"===F||"."===F||"|"===F||"+"===F||"("===F||")"===F||"?"===F||"*"===F||"<"===F||">"===F||"@"===F||"?"===F||"{"===F?"["!==F&&"{"!==F||!({LC:K,U3c:N}=this.GGh(r,B)).returnValue?"?"===F||"<"===F||">"===F||"@"===F?(N=this.y_h(F),w[G]=this.IEa(F,N)):"*"===F?
(N=this.y_h(F),w[G]=({LC:K}=this.dbo(r,B,N)).returnValue,B=K):"("===F||")"===F?(N=10,w[G]=this.IEa(F,N)):w[G]=String.format("\\{0}",F):(w[G]=this.IEa(r.substr(B,K+1-B),N),B=K):w[G]="'"===F||"\u2018"===F||"\u2019"===F||'"'===F||"\u201c"===F||"\u201d"===F||"-"===F||"\u2013"===F||"\u2014"===F||a.a.V$(F)?"["+this.PLf(F)+"]":"\u2026"===F?"\\.\\.\\.":F;""!==w[G]&&0===N&&(w[G]=B<r.length-1&&("@"===r.charAt(B+1)||"{"===r.charAt(B+1))?"("+w[G]+"\u0640*)":w[G]+"\u0640*");z++}return w}D5i(r){const w=[];for(let v=
0;v<r.length;++v){const u=r.charAt(v);w[v]="["===u||"\\"===u||"^"===u||"$"===u||"."===u||"|"===u||"+"===u||"("===u||")"===u||"?"===u||"*"===u?String.format("\\{0}",u):"'"===u||"\u2018"===u||"\u2019"===u||'"'===u||"\u201c"===u||"\u201d"===u||"-"===u||"\u2013"===u||"\u2014"===u||a.a.V$(u)?"["+this.PLf(u)+"]":"\u2026"===u?"\\.\\.\\.":u;""!==w[v]&&(w[v]+="\u0640*")}return w}PLf(r){return"'"===r||"\u2018"===r||"\u2019"===r?"'\u2018\u2019":'"'===r||"\u201c"===r||"\u201d"===r?'"\u201c\u201d':"-"===r||"\u2013"===
r||"\u2014"===r?"-\u2013\u2014":a.a.V$(r)?l.$bo:r}static get instance(){return l._instance||(l._instance=new l)}}l._instance=null;l.$bo=" \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000";l.o$m='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d\u201c';Object(D.a)(l,"WordQueryProcessor",null,[921])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16261146/wdjs/WordEditorDS.common.js.map