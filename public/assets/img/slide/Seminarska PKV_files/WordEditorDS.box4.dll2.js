'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1452:function(D,M,d){D=d(0);var m=d(17),f=d(44),a=d(5),l=d(110),r=d(150),w=d(780),v=d(216),u=d(609),z=d(2),B=d(385),G=d(22),F=d(43),K=d(244),N=d(1),H=d(1519);class J{constructor(P,W){this.TAj=P;this.Az=W}J(P){return this.TAj.Ey(P,this.Az)}}Object(D.a)(J,"PropertyMergeStrategies",null,[]);var L=d(1575),I=d(1536);class R extends I.a{constructor(){super();this.RRc=this.zTd=this.wn=null;this.C_d=0}get Yda(){return"Property"}Hzb(){this.detail.Z("Type",
this.Yda);this.detail.Z("ComplexMerger",null!=this.wn?this.wn:-1);this.detail.Z("Strategy",null!=this.zTd?this.zTd:-1);this.detail.Z("ClassId",null!=this.RRc?this.RRc:-1);this.detail.Z("PropId",this.C_d);return this.detail}}Object(D.a)(R,"PropertyMergeFailureDetail",I.a,[]);d.d(M,"a",function(){return C});class C{constructor(P=null){this.pVg=this.wc=null;this.WRb=P||this.VHc()}get wn(){return 1}get $gb(){return this.WRb}VHc(){return[Object(F.a)(this,this.xao,"tryPreProcessFavoredRevision"),Object(F.a)(this,
this.nwk,"cloneObjectAndRemoveNeededProperties"),Object(F.a)(this,this.oao,"tryMergeNodeInternal")]}set Pb(P){this.wc=P}get Az(){return 5}get E_d(){return this.pVg||(this.pVg=new J(this.lk(),this.Az))}SA(P,W){const X=P.Ng.value.Df;r.a.instance.Ya(4016352,1,4,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",X.id,X.Qc);P.Wo.logger.Pg(Object.assign(new R,{wn:this.wn,RRc:X.Qc,C_d:W}));return!1}x5f(P){const W=P.Ng.value;
r.a.instance.Ya(4016353,1,5,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",W.Df.id,W.Df.Qc);for(let X=0;X<this.$gb.length;X++)if(!(0,this.$gb[X])(P))return r.a.instance.Ya(4016354,1,4,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",W.Df.id,W.Df.Qc,X),P.Wo.logger.hSd("GraphNodeComplexMerge.GetMergeFunctions()",X),this.hvm(P),P.Nk=null,!1;r.a.instance.Ya(4016355,1,5,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",
W.Df.id,W.Df.Qc);return!0}hvm(P){P.n9f||(P.n9f=!0,L.a(P.Ng.value.hu,"Base",1),L.a(P.Ng.value.Df,"Favored",1),L.a(P.Um.value.Df,"Conflict",1))}xao(P){const W=P.Ng.value,X=this.E_d;if(!W.PW)return!0;let V=!0;W.dna.forEach((Y,ca)=>{if(!ca.PW||P.zg.contains(Y))return!0;ca=X.J(Y);if(5===ca){const fa=W.hu.Qc;r.a.instance.Ya(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",fa,Y,ca);P.Wo.logger.Pg(Object.assign(new R,
{wn:this.wn,RRc:fa,C_d:Y,zTd:ca}));return V=!1}6===ca&&P.EMf.add(Y);return!0});return V}nwk(P){P.Nk=P.Ng.value.Df.xG();const W=P.EMf,X=P.Nk;W&&W.forEach(V=>{X.removeProperty(w.a.oW(V));return!0});return!0}oao(P){const W=P.Um.value,X=W.hu.Qc,V=this.E_d;let Y=!0;W.dna.forEach((ca,fa)=>{const sa=V.J(ca);Y=this.pao(P,fa,ca,sa);Y||(P.Nk=null,r.a.instance.Ya(4018177,1,4,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",X,ca,sa),P.Wo.logger.Pg(Object.assign(new R,{wn:this.wn,
RRc:X,C_d:ca,zTd:sa})));return Y});return Y}pao(P,W,X,V){const Y=P.Nk;if(!W.PW&&8!==V||2===V||7===V||P.zg.contains(X))return!0;if(5===V)return!1;if(4===V||3===V){let ca;if(({value:ca}=P.Ng.value.dna.Dc(X)).returnValue&&ca.PW)return 4!==V;V=0}8===V&&(V=0);if(0===V){if(!W.isDeleted)return P=w.a.oW(X),(C.sno(W,X,P)||C.dSn())&&Y.nva(P,W.newValue),!0;V=6}return 6===V?(Y.removeProperty(w.a.oW(X)),!0):1===V?this.SA(P,X):!1}HFm(P,W,X,V,Y,ca){P=P||new v.a;W=W||new v.a;X=X||new v.a;var fa=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseList.Length: {0}] to not exceed [favoredList.Length: {1}] or [conflictList.Length: {2}]",
P.length,W.length,X.length),sa=P.length<=W.length&&P.length<=X.length;this.Oci()&&sa&&r.a.instance.Ya(541181455,1,1,fa);if(!sa&&this.Yai(ca.runtime.Pb))return null;if(this.Oci())for(fa=0;fa<P.length;fa++){sa=P.mg(fa);var ia=W.mg(fa);let ea=X.mg(fa);sa=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseVal: {0}] [favoredVal: {1}] and [conflictVal: {2}] [index: {3}] [baseList.Count {4}] to all be the same.",sa,ia,ea,fa,P.length);r.a.instance.Ya(541181457,1,1,sa)}if(this.Yai(ca.runtime.Pb))for(ca=
0;ca<P.length;ca++)if(fa=P.mg(ca),sa=W.mg(ca),ia=X.mg(ca),!V(fa,sa)||!V(fa,ia))return null;P=P.p3();V=new u.a;ca=P.length;for(fa=ca;fa<W.length;fa++)sa=W.mg(fa),P.add(sa),V.add(sa);for(;ca<X.length;ca++)W=X.mg(ca),V.contains(W)?r.a.instance.Ya(4018180,1,5,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",W):(P.add(W),Y(W));return P}Oci(){return!!z.AFrameworkApplication.K&&z.AFrameworkApplication.K.$("LogMPALErrors")}Yai(P){if(!P)return!1;
P.kif(1000008);return P.OAb(1000008)}Nim(P){if(!P)return!1;P.kif(1000009);return P.OAb(1000009)}ppi(P,W,X,V){return H.a(P,W,X,V)}vCa(P,W,X){P=P||new v.a;W=W||new v.a;X=X||new v.a;const V=P.UF(),Y=W.UF(),ca=X.UF();P=C.filter(P,fa=>Y.contains(fa)&&ca.contains(fa));P.UF();P.uA(P.length,C.filter(W,fa=>!V.contains(fa)));P.uA(P.length,C.filter(X,fa=>!V.contains(fa)&&!Y.contains(fa)));return P}AFm(P,W){const X=w.a.oW(W),V=P.Yd;var Y=V.getPropertyObjectIds(P.Ng.value.hu,X),ca=V.getPropertyObjectIds(P.Ng.value.Df,
X);const fa=V.getPropertyObjectIds(P.Um.value.Df,X);Y=this.vCa(Y,ca,fa);ca=P.Nk;0<Y.length?V.setPropertyObjectIds(ca,X,Y):ca.removeProperty(X);P.zg.add(W)}Lab(P,W,X){P.hasProperty(X)?W.nva(X,P.QP(X)):W.removeProperty(X)}Trn(P,W){var X=W.Mj();for(const V of X)W.removeProperty(V);X=P.Mj();for(const V of X)W.nva(V,P.QP(V))}Btf(P,W,X,V,Y){W=P.getPropertyInt32(W,Y);X=P.getPropertyInt32(X,Y);X=null!=W&&null!=X?Math.max(W,X):null!=X?X:null!=W?W:null;null!=X?P.setPropertyInt32(V,Y,X):V.removeProperty(Y)}YUe(P,
W,X,V,Y,ca){W=P(W,Y);X=P(X,Y);P=P(V,Y);V=W.UF();let fa=!1;ca&&(fa=ca(W,X,P));fa?(ca=!0,V=!1):(ca=V.Zoh(X),V=V.Zoh(P));r.a.instance.Ya(588011013,1,4,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",w.a.yb(Y),W.Cq(),X.Cq(),P.Cq(),ca,V);return{aBc:P,AZa:ca,vZa:V}}lsk(P,W,X,V,Y){let ca;W=P(W,Y);X=P(X,Y);P=P(V,Y);V=this.Qfi(W,X);ca=this.Qfi(W,P);r.a.instance.Ya(588011014,1,4,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",
w.a.yb(Y),W.Cq(),X.Cq(),P.Cq(),V,ca);return{aBc:P,AZa:V,vZa:ca}}Qfi(P,W){if(!P&&!W)return!0;if(!P||!W)return!1;if(!P.count&&!W.count)return!0;let X=!1;W.forEach((V,Y)=>X=P.xb(V)&&Y==P.J(V));return X}lk(){let P;P=this.Nim(this.wc)?C.wJj.value:C.vJj.value;const W=new B.a(0);for(let X=0;X<P.length;X++)W.Z(P[X],7);return W}static Dda(){return new C}static get instance(){return C._instance.value}static dSn(){return G.a.instance.Pa("Box4.IFeatureHelper").isFeatureEnabled(82)}static sno(P,W,X){if(void 0!==
P.newValue&&null!==P.newValue||N.a.wdi(X.type))return!0;C.twm(P,W,X);return!1}static twm(P,W,X){X=X.type===N.a.string;W=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",W);X||(W+=String.format(" [NewValue: {0}] [OldValue: {1}]",P.newValue,P.oldValue));r.a.instance.Ya(19145822,1,2,W)}static uyf(P,W,X){const V=w.a.yb(X),Y=P.Yd;var ca=Y.getPropertyObjectIds(P.Ng.value.hu,X);const fa=Y.getPropertyObjectIds(P.Ng.value.Df,X);var sa=Y.getPropertyObjectIds(P.Um.value.Df,X);sa=C.HMl(sa,
P.Wo.runtime.xec);W=W.vCa(ca,fa,sa);ca=P.Nk;0<W.length?Y.setPropertyObjectIds(ca,X,W):ca.removeProperty(X);P.zg.add(V);return!0}static HMl(P,W){const X=new v.a;P.forEach(V=>{W.contains(V,(Y,ca)=>Y.equals(ca))||X.add(V);return!0});return X}static filter(P,W){const X=new v.a;P.forEach(V=>{W(V)&&X.add(V);return!0});return X}static Tsl(){return[w.a.yb(m.a.p5e),w.a.yb(m.a.lastModifiedTime),w.a.yb(m.a.mK),w.a.yb(m.a.pIb),w.a.yb(m.a.GTf),w.a.yb(f.a.PRc),w.a.yb(a.a.avd),w.a.yb(a.a.ybb),w.a.yb(l.a.zSi)]}static Usl(){return[w.a.yb(m.a.p5e),
w.a.yb(m.a.lastModifiedTime),w.a.yb(m.a.mK),w.a.yb(m.a.pIb),w.a.yb(m.a.GTf),w.a.yb(f.a.PRc),w.a.yb(a.a.avd),w.a.yb(l.a.zSi)]}}C._instance=new K.a(C.Dda);C.vJj=new K.a(C.Tsl);C.wJj=new K.a(C.Usl);Object(D.a)(C,"GraphNodeComplexMerge",null,[1863])},1453:function(D,M,d){d.r(M);D=d(0);var m=d(120),f=d(1472),a=d(1459),l=d(1579),r=d(1580);class w{constructor(u,z){this.k7a=!1;this.lfa=null;if(!u)throw Error.argumentNull("annotations");if(!u.s7b(z))throw Error.argument("structTypeID","Invalid struct type ID");
this.Kv=u;this.A8b=this.Kv.ETh(z);this.XUj=z}get RWb(){return this.Kv}get isReadOnly(){return this.k7a}get xPa(){return this.XUj}ddb(u){if(0>u||u>=this.A8b)throw Error.argument("iField","Invalid field index");return this.lfa&&null!=this.lfa[u]?this.lfa[u]:this.Kv.bYh(this.xPa,u)}yWf(u,z){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>u||u>=this.A8b)throw Error.argument("iField","Invalid field index");if(!this.Kv.i6b(this.Kv.xAb(this.xPa,
u),z))throw Error.argument("value","Value is not of the correct type for the specified field");(this.lfa||(this.lfa=Array(this.A8b)))[u]=z}yba(){const {Annotations:u}=d(1453);let z="[";if(this.lfa){let B=!0;for(let G=0;G<this.A8b;++G){if(null==this.lfa[G])continue;const F=this.Kv.xAb(this.xPa,G);if(u.bmb(F,this.lfa[G],this.Kv.bYh(this.xPa,G)))continue;B?B=!1:z+=", ";z+=this.Kv.cYh(this.xPa,G);z+="=";const K=this.Kv.yba(F,this.lfa[G]);F===u.H7?(z+='"',z+=f.a.k6e(K),z+='"'):z+=K}}return z+"]"}isEqual(u){const {Annotations:z}=
d(1453);if(this===u)return!0;if(!u||this.Kv!==u.RWb||this.xPa!==u.xPa)return!1;for(let B=0;B<this.A8b;++B)if(!z.bmb(this.Kv.xAb(this.xPa,B),this.ddb(B),u.ddb(B)))return!1;return!0}clone(){const u=new w(this.Kv,this.xPa);this.lfa&&(u.lfa=Array.clone(this.lfa));return u}qS(){return this.isReadOnly?this.clone():this}Nvf(){const {Annotations:u}=d(1453);if(!this.isReadOnly&&(this.k7a=!0,this.lfa))for(let z=0;z<this.A8b;++z){const B=this.lfa[z];null!=B&&u.pEb(B)}}toString(){return this.yba()}}Object(D.a)(w,
"StructValue",null,[1215,1212]);d.d(M,"Annotations",function(){return v});class v{constructor(u,z){if(!u)throw Error.argumentNull("initData");if(!z)throw Error.argumentNull("objectFetcher");this.iBm=z.bYk;let B=0;var G=z.Qcb(u.J(B));++B;this.qxf=new l.a(new r.a(G));this.QAj=u.J(B);++B;this.Vmi=Array(this.eAd);this.FQc=Array(this.eAd);this.Tgb=Array(this.eAd);for(G=0;G<this.eAd;++G){this.Vmi[G]=z.getString(u.J(B));++B;this.FQc[G]=u.J(B);++B;var F=u.J(B);++B;this.Tgb[G]=Array(F);for(var K=0;K<F;++K)this.Tgb[G][K]=
z.getString(u.J(B)),++B}this.WUj=u.J(B);++B;this.Ani=Array(this.v0c);this.PSd=Array(this.v0c);this.QSd=Array(this.v0c);this.OSd=Array(this.v0c);for(G=0;G<this.v0c;++G)for(this.Ani[G]=z.getString(u.J(B)),++B,F=u.J(B),++B,this.PSd[G]=Array(F),this.QSd[G]=Array(F),this.OSd[G]=Array(F),K=0;K<F;++K)this.PSd[G][K]=z.getString(u.J(B)),++B,this.QSd[G][K]=u.J(B),++B,this.OSd[G][K]=({Fea:B}=this.VJa(this.QSd[G][K],u,B,null,null,null)).returnValue,v.pEb(this.OSd[G][K]);this.Guj=u.J(B);++B;this.Vwf=Array(this.qXb);
this.Wwf=Array(this.qXb);this.Uwf=Array(this.qXb);for(G=0;G<this.qXb;++G)this.Vwf[G]=z.getString(u.J(B)),++B,this.Wwf[G]=u.J(B),++B,this.Uwf[G]=({Fea:B}=this.VJa(this.Wwf[G],u,B,null,null,null)).returnValue,v.pEb(this.Uwf[G])}zGc(u){for(let z=0;z<this.qXb;++z)if(this.Vwf[z]===u)return z;return-1}OKh(u){if(!this.p7b(u))throw Error.argument("attrID","Invalid attribute ID");return this.Vwf[u]}getAttributeType(u){if(!this.p7b(u))throw Error.argument("attrID","Invalid attribute ID");return this.Wwf[u]}xAb(u,
z){if(!this.s7b(u))throw Error.argument("structTypeID","Invalid struct type ID");u=this.QSd[v.w0c(u)];if(0>z||z>=u.length)throw Error.argument("iField","Invalid field index");return u[z]}yba(u,z){if(!this.Ysf(u))throw Error.argument("typeID","Invalid type ID");if(!this.i6b(u,z))throw Error.argument("value","Value is not of the correct type");switch(u){case v.H7:return z;case v.Jva:return z?"True":"False";case v.JEa:case v.boa:return z.toString();case v.wU:return z.yba();default:if(!v.hH(u)&&v.o2c(u)){u=
v.c6e(u);const F=this.Tgb[u].length;switch(this.FQc[u]){case 0:return this.Tgb[u][z];case 1:if(z){var B="";for(var G=1;G<F;++G)z&1<<G-1&&(0<B.length&&(B+=" & "),B+=this.Tgb[u][G]);return B}return this.Tgb[u][0];case 2:B="";for(G=0;G<F;++G)z&1<<G&&(0<B.length&&(B+=" & "),B+=this.Tgb[u][G]);return B;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.FQc[u]);}}else return z.yba()}}Ysf(u){switch(u){case v.H7:case v.Jva:case v.JEa:case v.boa:case v.wU:return!0;default:return v.hH(u)?
this.Ysf(v.XXa(u)):v.o2c(u)?this.Xkm(u):this.s7b(u)}}Xkm(u){u=v.c6e(u);return 0<=u&&u<this.Vmi.length}s7b(u){u=v.w0c(u);return 0<=u&&u<this.Ani.length}p7b(u){return 0<=u&&u<this.qXb}i6b(u,z){if(null==z)return!1;switch(u){case v.H7:return"string"===typeof z;case v.Jva:return"boolean"===typeof z;case v.JEa:return"number"===typeof z;case v.boa:return"number"===typeof z;case v.wU:return Object(m.a)(1211,z);default:if(v.hH(u))return Object(m.a)(1214,z)&&z.F2===v.XXa(u);if(v.o2c(u)){if("number"!==typeof z)return!1;
u=v.c6e(u);const B=this.Tgb[u].length;switch(this.FQc[u]){case 0:return 0<=z&&z<B;case 1:return!(z&-1<<B-1);case 2:return!!z&&!(z&-1<<B);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.FQc[u]);}}else return Object(m.a)(1215,z)&&z.xPa===u}}get qXb(){return this.Guj}get eAd(){return this.QAj}get v0c(){return this.WUj}Fgl(u){if(!this.p7b(u))throw Error.argument("attrID","Invalid attribute ID");return this.Uwf[u]}ETh(u){if(!this.s7b(u))throw Error.argument("structTypeID","Invalid struct type ID");
return this.PSd[v.w0c(u)].length}cYh(u,z){if(!this.s7b(u))throw Error.argument("structTypeID","Invalid struct type ID");return this.PSd[v.w0c(u)][z]}bYh(u,z){if(!this.s7b(u))throw Error.argument("structTypeID","Invalid struct type ID");u=this.OSd[v.w0c(u)];if(0>z||z>=u.length)throw Error.argument("iField","Invalid field index");return u[z]}VJa(u,z,B,G,F,K){if(!z)throw Error.argumentNull("initData");if(v.hH(u)){var N=z.J(B);++B;u=v.XXa(u);var H=new a.a(this,u);for(var J=0;J<N;++J)Array.add(H.items,
({Fea:B}=this.VJa(u,z,B,G,F,K)).returnValue);return{returnValue:H,Fea:B}}switch(u){case v.H7:return{returnValue:(G||this.qxf).getString(z.J(B++)),Fea:B};case v.Jva:return{returnValue:1===z.J(B++),Fea:B};case v.JEa:return{returnValue:z.J(B++),Fea:B};case v.boa:return{returnValue:(F||this.iBm)[z.J(B++)],Fea:B};case v.wU:u=z.J(B++);N=new f.a(this);for(H=0;H<u;++H)J=z.J(B),++B,K&&(J=K[J]),N.ay(J,({Fea:B}=this.VJa(this.getAttributeType(J),z,B,G,F,K)).returnValue);return{returnValue:N,Fea:B};default:if(v.o2c(u))return{returnValue:z.J(B++),
Fea:B};if(v.Wcj(u)){N=z.J(B++);H=new w(this,u);for(J=0;J<N;++J){const L=z.J(B);++B;H.yWf(L,({Fea:B}=this.VJa(this.xAb(u,L),z,B,G,F,K)).returnValue)}return{returnValue:H,Fea:B}}throw Error.argument("typeID","Invalid type ID");}}static o2c(u){return 16<=(u&16383)&&16384!==(u&16384)&&32768!==(u&32768)}static Wcj(u){return 16<=(u&16383)&&16384===(u&16384)&&32768!==(u&32768)}static hH(u){return 32768===(u&32768)}static gwl(u){if(v.hH(u))throw Error.argument("nonListTypeID","Non-list type ID required");
return u|32768}static XXa(u){if(!v.hH(u))throw Error.argument("listTypeID","List type ID required");return u&-32769}static bmb(u,z,B){switch(u){case v.H7:case v.Jva:case v.JEa:case v.boa:return z===B;case v.wU:return z.isEqual(B);default:return v.hH(u)?z.isEqual(B):v.o2c(u)?z===B:z.isEqual(B)}}static pEb(u){Object(m.a)(1212,u)&&u.Nvf()}static qS(u){return Object(m.a)(1212,u)?u.qS():u}static c6e(u){return u-16}static w0c(u){return(u&-16385)-16}}v.H7=1;v.Jva=2;v.JEa=3;v.boa=5;v.wU=9;Object(D.a)(v,"Annotations",
null,[1216])},1456:function(D,M,d){D=d(0);var m=d(282);class f{constructor(){this.userId=this.email=this.displayName=null}}Object(D.a)(f,"InsertMentionParameters",null,[]);class a{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(D.a)(a,"InsightsParameters",null,[]);var l=d(1655),r=d(1656),w=d(1657),v=d(1658),u=d(2),z=d(1503),B=d(1515),G=d(35),F=d(15),K=d(16),N=d(27);d.d(M,"a",function(){return H});class H{static get Xmf(){return"Insights_16x16x32"}static get y7k(){return"Find_16x16x32"}static get MBi(){return"-Parameterized"}static get S_f(){return"Parameterized"}static get Bae(){return"bTryQuery"}static get E5f(){return"TellMeSuggestion_"}static get wcj(){return"bTryQueryAlternate"}static get h3f(){return"MenuTellMe"}static get R1m(){const J=
{},L=[];Array.add(L,{Term:{PeopleType:"Person"}});J.And=L;return J}static J_e(J){return J+H.MBi}static getParameter(J){let L="",I="";if(J)for(let R=0;R<J.oFh;++R)"Type"===J.ucf(R)?L=J.getValue(R):"Value"===J.ucf(R)&&(I=J.getValue(R));return new m.a(L,I)}static exb(J){J=Object.assign(new a,{neighborhood:J,mentionStart:0,mentionLength:J.length});return G.c(J)}static Jth(J,L,I){J=Object.assign(new f,{displayName:J,email:L,userId:I});return G.c(J)}static mWa(J,L,I=null){J=Object.assign(new B.a,{neighborhood:J,
mentionStart:0,mentionLength:J?J.length:0});L=Object.assign(new z.a,{selection:J,userIntent:null,entryPoint:L,launchData:I});return G.c(L)}static hwn(J,L){return H.mWa(J,H.iwn(L))}static iwn(J){switch(J){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;default:return 0}}static ybi(){return!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("IsGoLocalEnvironment")}static gDb(){const J=u.AFrameworkApplication.K?
u.AFrameworkApplication.K.lb("SovereignEnvironmentName"):null;return!!J&&0<J.length}static isEnterpriseUser(){const J=u.AFrameworkApplication.K?u.AFrameworkApplication.K.lb("HostAuthType"):null;return!!J&&"aad"===J.toLowerCase()||"external"===J&&H.Gof()}static OYf(J){return J.Y4n&&!H.gDb()}static kfi(){const J=u.AFrameworkApplication.K?u.AFrameworkApplication.K.lb("UiHostIntegrationType"):"";return!!u.AFrameworkApplication.K&&"UnifiedUiHostTeams"===J&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static NYf(J){return J.OPa&&J.I5k&&(J.f1c||J.d1c||J.egb)&&!H.kfi()&&H.isEnterpriseUser()&&!H.gDb()}static bCa(){return u.AFrameworkApplication.K?u.AFrameworkApplication.D2a||u.AFrameworkApplication.K.$("SmartLookupEnableNativePane"):u.AFrameworkApplication.D2a}static tT(J){return!J||H.Mfi(J.ng)}static Mfi(J){return!J||!J.trim().length}static h5f(J){if(!J)return 0;const L=Math.pow(10,5);return Math.round(J*L)/L}static $6n(){var J=new Date;return J?new Date(J.getUTCFullYear(),J.getUTCMonth(),J.getUTCDate(),
J.getUTCHours(),J.getUTCMinutes(),J.getUTCSeconds(),J.getUTCMilliseconds()):null}static lhf(J){J=new Date(J);return(H.$6n().getTime()-J.getTime())/1E3}static ugi(J){const {InsightsMenuItemFactory:L}=d(1654);switch(J){case l.a.Hjf:case r.a.WGh:case L.M7h:case w.a.msi:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "LaunchAddinDialogFromTellMe":return!0}return J.startsWith(H.Bae)||
J.startsWith(H.E5f)||J.startsWith(H.wcj)||J.startsWith("PeopleSuggestion")||J.startsWith("FileSuggestion")||J.startsWith("FindInDocumentSuggestion")||J.startsWith("NotesSuggestion")||J.startsWith("OnenoteNotesSuggestion")||J.startsWith("SmartLookupFromTellMe")||J.startsWith("GetHelpFromTellMe")||J.startsWith("GetHelpWithDescriptionFromTellMe")||J.startsWith("AddinSuggestion")||J.startsWith("OfficeScripts")?!0:!1}static Ncf(J,L){const I=[];Array.add(I,new v.a(400,J));Array.add(I,new v.a(200,L));J=
{};J.parts=I;return JSON.stringify(J)}static Ocb(J){const L=J.indexOf("<b0>"),I=J.lastIndexOf("</b0>"),R=[];Array.add(R,new v.a(400,J.substring(0,L)));Array.add(R,new v.a(600,J.substring(L+4,I)));Array.add(R,new v.a(400,J.substring(I+5,J.length)));J={};J.parts=R;return JSON.stringify(J)}static yZh(J){const L=H.lhf(J);return 60>L?CommonUIStrings.l_TimeSince_SecsAgo:3600>L?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(L/60).toString()):86400>L?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(L/3600).toString()):172800>L?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(J)).localeFormat("MMMM dd, yyyy"))}static Vjl(J){const L=Array(J.length);for(let I=0;I<J.length;I++)L[I]=J[I].commandId;return L}static Gof(){if("Dev Box"===u.AFrameworkApplication.K.lb("StatusBarEnvironmentNameToUse"))return!0;let J=u.AFrameworkApplication.K.lb("UserPrincipalName");J=N.c(J)?"":K.a.mh(J);const L=u.AFrameworkApplication.K.vu("TellMeIntEnabledForFeatureCrew")?
u.AFrameworkApplication.K.AB("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(L,J)&&"inner"===u.AFrameworkApplication.K.lb("Microsoft365Ring")}static Psl(J){switch(J.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"SaveAsPowerPointPotx_20";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"SaveAsWordDocx_20";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"SaveAsExcelXlsx_20";
case "pdf":return"PdfFile_32";case "one":case "onepkg":return"OneNote_32";case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio_32"}return""}static K$(){return F.a.n2&&!F.a.So}}H.P$d=9E5;Object(D.a)(H,"TellMeUtils",null,[])},1457:function(D,M,d){d.r(M);D=d(0);var m=d(43),f=d(120),a=d(72),l=d(1590),r=d(221);class w{constructor(kb,Wb,Fb,nc,gc,Jc){this.groupType=kb;this.resultType=Wb;
this.A1f=Fb;this.f6=nc;this.l3e=gc;this.resultIndex=Jc}}Object(D.a)(w,"ClickLoggingInfo",null,[]);const v=kb=>{const Wb=[];for(;kb;)Array.add(Wb,"{ContextId:"+kb.contextId+", IsGraphNodeContext:"+kb.ul+"}"),kb=kb.tk;Wb.reverse();return"{"+Wb.join(", ")+"}"};class u{constructor(){this.yla=this.sessionId=null}}Object(D.a)(u,"CorrelationRecord",null,[1104]);var z=d(1478);class B{constructor(kb,Wb){this.Id=null;this.TimeStamp=0;this.Id=kb;this.TimeStamp=Wb}}Object(D.a)(B,"MRUControl",null,[]);var G=d(1581),
F=d(1577),K=d(1456),N=d(2),H=d(1349);class J{constructor(kb,Wb){this.JKj=10;this.Q4=[];this.sxa=[];this.YJg=this.XJg=!1;this.nrc=this.mrc="";this.URb=Wb;this.jc=kb;this.RKg=kb.aq}YGc(){!this.XJg&&this.RKg&&this.jc&&F.a.Tci()&&(this.mrc="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.jc.application,this.Q4=this.CLh(),this.XJg=!0);return this.Q4}CDl(){!this.YJg&&this.RKg&&this.jc&&F.a.Tci()&&(this.nrc="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.jc.application,this.sxa=this.CLh(!0),this.YJg=!0);return this.sxa}Xjm(kb){return kb.startsWith("TellMeUpsell")||
"OpenInClientUpsell"===kb||"TryOfficeUpsell"===kb}mof(kb){return this.z7l(kb)||this.Xjm(kb)||K.a.ugi(kb)?!1:!0}rya(kb){kb=kb.ControlId;this.mof(kb)&&(kb=this.cRf(kb),this.$nn(kb),this.aCm(),Array.insert(this.Q4,0,new B(kb,Date.now())),this.mrc.length&&(kb=JSON.stringify(this.Q4),H.a.instance.setItem(this.mrc,kb)))}HH(kb){this.$Bm();Array.insert(this.sxa,0,new B(G.a[kb],Date.now()));this.nrc.length&&(kb=JSON.stringify(this.sxa),H.a.instance.setItem(this.nrc,kb))}CLh(kb=!1){if(!this.Q4.length){var Wb=
kb?H.a.instance.getItem(this.nrc):H.a.instance.getItem(this.mrc);if(!Wb||""===Wb)return kb?this.sxa:this.Q4;let Fb=null;try{Fb=JSON.parse(Wb)}catch(nc){this.uuk(kb),Fb=null}if(!Fb||!Fb.length||10<Fb.length)return kb?this.sxa:this.Q4;Wb=0;for(const nc of Fb)if(kb||this.jc.DPd(nc.Id)&&this.mof(nc.Id))if(kb?Array.insert(this.sxa,Wb++,nc):Array.insert(this.Q4,Wb++,nc),Wb===this.URb)break}return kb?this.sxa:this.Q4}CXe(kb){kb=this.cRf(kb);for(const Wb of this.Q4)if(Wb.Id===kb)return!0;return!1}uuk(kb=
!1){H.a.instance.setItem(kb?this.nrc:this.mrc,"")}J9l(kb){kb=this.cRf(kb.ControlId);return this.mof(kb)?this.CXe(kb):!1}$nn(kb){if(0<this.Q4.length){let Wb=0;for(const Fb of this.Q4){if(Fb.Id===kb){Array.removeAt(this.Q4,Wb);break}Wb++}}}cRf(kb){return"Excel"===this.jc.application&&kb.startsWith("m_excelWebRenderer_ewaCtl_")?kb.substr(26,kb.length):kb}aCm(){this.Q4.length===this.URb&&Array.removeAt(this.Q4,this.Q4.length-1)}$Bm(){this.sxa.length===this.JKj&&Array.removeAt(this.sxa,this.sxa.length-
1)}z7l(kb){kb=kb.split("|");let Wb="";if(6<=kb.length)Wb=kb[0];else if(3<=kb.length){if("3"===kb[0])return!0;Wb=kb[1]}return Wb.startsWith("WA")}static createInstance(kb){let Wb=3;N.AFrameworkApplication.K&&(Wb=N.AFrameworkApplication.K.rc("TellMeMaxRecommendedResultsToReturn",3));return new J(kb,Wb)}}Object(D.a)(J,"MruControlsManager",null,[1103]);class L{constructor(kb){this.Nrb=kb}Gda(kb,Wb){let Fb;return kb.RB&&(Fb=this.Nrb[kb.value])?Fb.Gda(kb,Wb):(Fb=this.CMh(kb.value))?Fb.Gda(Fb.vHm,Wb):null}sBl(kb,
Wb){if(kb=this.Nrb[kb])for(const Fb of Wb)if(Wb=K.a.getParameter(Fb),Wb.key===kb.aJf)return Wb.value;return null}QKm(kb){(kb=this.CMh(kb))&&kb.NKm()}CMh(kb){const Wb=kb.indexOf(K.a.MBi);return 0<Wb?this.Nrb[kb.substring(0,Wb)]:null}}Object(D.a)(L,"ParameterizedCommandManager",null,[1102]);var I=d(1487);class R{constructor(kb,Wb){this.ng=kb;this.d1a=Wb}}Object(D.a)(R,"TellMeQuery",null,[]);var C=d(1578);class P{constructor(kb,Wb){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=kb;this.TimeElapsedSinceClick=
Wb}}Object(D.a)(P,"CommandClickedEvent",null,[]);var W=d(27);class X{constructor(kb,Wb){this.$Mj=kb;this.dqa=Wb}resultsUpdated(kb){this.$Mj(W.c(kb.query)?"":kb.query.ng,kb.Sn,kb.attributes,this.dqa,kb.E6b)}}Object(D.a)(X,"ResultsUpdatedCallback",null,[1101]);var V=d(79);class Y{constructor(kb,Wb){this.menuModel=kb;this.EQi=Wb}}Object(D.a)(Y,"GeneratedMenuModel",null,[]);class ca{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(D.a)(ca,
"MenuModel",null,[]);class fa{constructor(kb,Wb,Fb){this.jc=kb;this.Nrb=Wb;this.Nca=Fb}Kdl(kb,Wb,Fb){const {TellMeActor:nc}=d(1457);let gc=0;const Jc=new ca,tb=[];let dc="";Jc.sections=[];let Yb=new V.a;const pb=!!this.jc&&this.jc.d_a;var Gb=!!this.jc&&this.jc.okb||N.AFrameworkApplication.ua.Sb.okb;for(const Ib of kb){kb=0;pb||(Yb=new V.a);const Ob=new V.a;let kc=Ib.displayName;for(const Ac of Ib.results){if(0<=Ac.value.indexOf(K.a.S_f)){if(Ac.RB){var hb=this.Nrb[Ac.value];if(hb&&Ac.value.endsWith(K.a.S_f)){if("FindParameterized"!==
Ac.value&&!Gb){const Nc=[];Nc.push(appChrome.actions.setControlLabel(Ac.value,hb.qFd(Ac)));Nc.push(appChrome.actions.setButtonCommandValueId(Ac.value,hb.Paf(Ac)));appChrome.api.dispatch(Nc)}hb=Ac.value.replace(K.a.S_f,"");Yb.remove(hb)?kb--:Ob.add(hb);Yb.add(Ac.value);kb++}}}else switch(Ac.type){case 5:Ob.contains(Ac.value)||(Yb.add(Ac.value),kb++);break;case 7:Yb.add(Ac.RB);kb++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 6:case 19:case 20:case 21:case 25:case 26:Yb.add(Ac.value),
kb++}13===Ib.groupType&&(kc=K.a.bCa()?0<Wb.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,Wb):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,Wb));21===Ib.groupType&&(kc=CommonUIStrings.l_LearningUILiveText)}gc+=kb;""!==kc&&0<kb&&(dc+=" , "+kb.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+kc+" , ");0<Yb.count&&!pb&&(kb=appChrome.api.menuSection(Yb.toArray(),Ib.displayName,null,I.a[Ib.groupType]),tb.push(kb))}Gb=
null;0<gc&&(Gb=0<Wb.length?1!==gc?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,gc,Wb):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,Wb):1!==gc?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,gc):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,pb?(Wb=appChrome.api.menuSection(Yb.toArray(),"",null,null),tb.push(Wb)):Gb+=dc);Fb&&(this.jc.VAa?nc.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(Gb)):
appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Gb)));Jc.sections=tb;return new Y(Jc,gc,[])}static get X4e(){return fa.sBg||(fa.sBg=new Y(Object.assign(new ca,{sections:[]}),0,[]))}}fa.sBg=null;Object(D.a)(fa,"TellMeMenuDefintionGenerator",null,[]);var sa;(function(kb){kb[kb.TellMeControlActivated=0]="TellMeControlActivated";kb[kb.TellMeQueryExecuted=1]="TellMeQueryExecuted";kb[kb.TellMeResultsRendered=2]="TellMeResultsRendered";kb[kb.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(sa||
(sa={}));Object(D.b)("PerformanceMarker",sa);var ia;(function(kb){kb[kb.TellMeTimeToRender=0]="TellMeTimeToRender";kb[kb.TellMeSessionLength=1]="TellMeSessionLength";kb[kb.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(ia||(ia={}));Object(D.b)("PerformanceMeasure",ia);class ea{mark(kb){window.performance.mark(sa[kb])}measure(kb,Wb,Fb){const {TellMeActor:nc}=d(1457);try{window.performance.measure(ia[kb],sa[Wb],sa[Fb])}catch(gc){nc.instance.Qe.onError("TellMePerformance:Measure","error measuring "+
ia[kb])}}iwf(kb,Wb,Fb){const {TellMeActor:nc}=d(1457);nc.instance.Qe.swf(Wb,Fb,kb,this.Pwl(kb))}Vuk(){var kb=[0,1,2,3];for(const Wb of kb)window.performance.clearMarks(sa[Wb])}clearMeasures(kb){for(const Wb of kb)window.performance.clearMeasures(ia[Wb])}Pwl(kb){let Wb=0;(kb=this.ufl(kb))&&0<kb.length&&(Wb=kb[kb.length-1].duration);return Wb}ufl(kb){return window.performance.getEntriesByName(ia[kb],"measure")}}Object(D.a)(ea,"TellMePerformance",null,[]);var da=d(1507),ja=d(1506),Ga=d(35);class ya{constructor(kb){this.WVj=
kb}YFb(kb,Wb,Fb){const {TellMeActor:nc}=d(1457);nc.instance.Qe.nX(Wb,ja.a.Tac,kb.data.mf.toString(),Math.round(window.performance.now()-Fb),ja.a.Tac,!0,da.a.Rsa);kb=Ga.b(kb.data.Ee);Wb=-1;kb.Index&&(Wb=kb.Index);nc.instance.Qe.Hym(Wb,this.WVj)}LFb(kb,Wb,Fb){const {TellMeActor:nc}=d(1457);nc.instance.Qe.nX(Wb,ja.a.Tac,kb.data.mf.toString(),Math.round(window.performance.now()-Fb),ja.a.Tac,!1,da.a.Rsa)}IDl(kb){if(kb&&""!==kb.trim()){const Fb=window.performance.now(),nc=N.AFrameworkApplication.m9i;var Wb=
{};Wb.Text=kb;Wb.IsFileHash="false";Wb=Ga.c(Wb);N.AFrameworkApplication.Ze.Lj(nc,2,Wb,{"Content-Type":"application/json",Accept:"application/json"},!1,0,gc=>{this.YFb(gc,kb.length,Fb)},gc=>{this.LFb(gc,kb.length,Fb)},null,null,!1,4E3,6E3)}}}Object(D.a)(ya,"TellMeQueryIndexCallback",null,[]);var ta=d(1460);class ua{constructor(kb,Wb,Fb){this.xml=kb;this.EQi=Wb;this.WVk=Fb}}Object(D.a)(ua,"GeneratedMenuXml",null,[]);var Sa=d(1655),ka=d(16);class ha{constructor(kb,Wb){this.Q7c=kb||{};this.$Sa=Wb}get eIb(){return 5}Gda(kb,
Wb=null){return this.$Sa.Gda(kb,Wb)||this.pjk(kb.value)}pjk(kb){return ha.XSe(kb,this.Q7c[kb]||null)}static XSe(kb,Wb=null){kb=String.format('<ClonedControl Id="{0}" ',kb);for(let gc in Wb){var Fb=gc,nc=Wb[gc];nc=nc?ka.a.If(nc.toString()):"";kb+=String.format('{0}="{1}" ',Fb,nc)}return kb+"/>"}}Object(D.a)(ha,"CommandMenuItemFactory",null,[967]);var Ca=d(236);class Pa{constructor(){this.KBj=CommonUIStrings.l_FindInDocumentText}get eIb(){return 8}Gda(kb){var Wb=kb.RB;kb=ka.a.If(kb.value);const Fb=
ka.a.If(Wb);Wb=ka.a.If(String.format(this.KBj,Wb));return this.$cl(kb,Fb,Wb)}$cl(kb,Wb,Fb){return Ca.a(kb,"1540292897",Fb,K.a.y7k,null,Wb,Fb,null,null)}}Object(D.a)(Pa,"FindInDocumentMenuItemFactory",null,[967]);var Xa=d(1656),qa=d(1654),Ea=d(1657);class Ia{get eIb(){return 7}Gda(kb){const Wb=Object(a.a)(C.a,kb);return this.Sdl(ka.a.If(kb.value),Wb.id)}Sdl(kb,Wb){return Ca.a(Wb,"1404166600",kb,null,null,kb,kb,null,null)}}Object(D.a)(Ia,"TryQueryMenuItemFactory",null,[967]);class na{constructor(kb){this.u4=
[];this.jc=kb}upl(kb){for(const Wb of this.u4)if(Wb.eIb===kb)return Wb;return null}ha(kb){this.u4.push(kb)}uin(kb){this.ha(new ha(this.jc.ZCk,kb));this.ha(new Ea.a(this.jc.MJm));this.ha(new Sa.a(this.jc.fBn,this.jc.eBn,this.jc.h5n,this.jc.RVl,this.jc.lRn));this.ha(new qa.InsightsMenuItemFactory);this.ha(new Pa);this.ha(new Xa.a);this.ha(new Ia)}}Object(D.a)(na,"MenuItemFactoryRegistry",null,[]);var Na=d(1461);class Oa{constructor(kb,Wb){this.jc=kb;this.bPg=new na(this.jc);this.bPg.uin(Wb)}Ldl(kb,
Wb){let Fb=0;const nc=[],gc=[];for(const tb of kb){kb=K.a.h3f;var Jc=[];for(const dc of tb.results){const Yb=this.bPg.upl(dc.type).Gda(dc,Wb);kb=K.a.h3f;Jc.push(Yb);if(13===dc.type||14===dc.type)kb="Menu32";17===dc.type&&(kb="MenuTellMeExtended");dc.groupType=tb.groupType;gc.push(Object(a.a)(Na.a,dc))}Fb=Fb?Fb:Jc.length;Jc=Ca.d("TellMeDropdownControls",Jc);kb=Ca.h("TellMeDropdownMenuSection",Jc,kb,tb.displayName);nc.push(kb)}Wb=Ca.i(nc,"LookupDropdownMenu");return new ua(Wb,Fb,gc)}static get xzd(){return Oa.tBg||
(Oa.tBg=new ua(Ca.i([],"LookupDropdownMenu"),0,[]))}}Oa.tBg=null;Object(D.a)(Oa,"TellMeXmlGenerator",null,[]);class Ra{}Ra.kIm="MRU";Ra.test="Test";Object(D.a)(Ra,"ActionType",null,[]);var ab=d(1494),zb;(function(kb){kb[kb.Service=0]="Service";kb[kb.Local=1]="Local";kb[kb.MRU=2]="MRU";kb[kb.TestResult=3]="TestResult";kb[kb.Unknown=4]="Unknown"})(zb||(zb={}));Object(D.b)("SubResultType",zb);var Qa=d(81);class yb{constructor(kb,Wb,Fb,nc,gc=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=
this.SubResultType=this.ResultType=null;this.CommandId=kb;this.IsEnabled=Wb;this.ResultType=G.a[Fb];this.SubResultType=zb[nc];this.OptionalData=gc?Qa.a.toJSON(gc):null}}Object(D.a)(yb,"ResultInfo",null,[]);var lb=d(102),Eb=d(137),bc=d(248);class Pb{constructor(kb,Wb=null){this.acd="TellMeWAC.";this.FOj=kb;this.UWj=Wb}NDa(kb,Wb,Fb){Wb=lb.a.KJ(Wb);kb=lb.a.E_e(kb,this.FOj,this.UWj,Fb,Wb);Eb.a.NDa(kb,this.acd)}MDa(kb,Wb,Fb=0){Wb=lb.a.KJ(Wb);Eb.a.MDa(Object.assign(new bc.a,{name:kb,dataFields:Wb,durationMs:Fb}),
this.acd)}}Object(D.a)(Pb,"TellMeOtelLogger",null,[1114]);var Va=d(121);class oa{constructor(kb,Wb,Fb,nc,gc,Jc,tb){this.S4=this.P8=this.$wg=null;this.$mb=kb;this.kOb=Wb;this.XHa=Fb;this.j7a=nc;this.pSa=gc;this.CIj=Jc;this.S4=tb?tb:new Pb(this.j7a?r.CuiHelper.R_f:r.CuiHelper.b$d)}get aq(){return this.j7a}get ina(){return this.XHa}V5d(kb){this.$wg=kb;switch(kb){case ta.a.contextMenu:this.P8=ta.a.contextMenu;break;default:this.P8=ta.a.tellMe}}fgk(kb,Wb){this.XHa.yla||(this.XHa.yla=Va.a.create().toString(),
this.xki(kb,!0,Wb))}VBh(kb,Wb=!0){this.XHa.yla&&this.Wum(kb,Wb);this.j7a&&appChrome.api.updateTellMeCorrelationId("");this.XHa.yla=null}xki(kb,Wb,Fb){const {TellMeActor:nc}=d(1457),gc=this.K5(z.a.mZa);gc[ab.a.culture]=this.kOb;gc[ab.a.appName]=this.$mb;gc[ab.a.context]=kb;gc[ab.a.UOd]=this.pSa;gc[ab.a.Tjm]=this.CIj;gc[ab.a.Fim]=Fb;gc[ab.a.Vcm]=Wb;gc[ab.a.contentType]=nc.instance.ixd;this.S4.NDa(z.a.mZa,gc,this.$wg);this.j7a&&appChrome.api.updateTellMeCorrelationId(this.XHa.yla)}Wum(kb,Wb){const Fb=
this.K5(z.a.YBb);Fb[ab.a.EYk]=kb;Fb[ab.a.Ucm]=Wb;this.S4.MDa(z.a.YBb,Fb)}Gym(kb,Wb,Fb){let nc=0;!Fb&&0<kb.length&&(nc=kb.trim().split(" ").length);const gc=this.K5(z.a.query);gc[ab.a.query]="!";gc[ab.a.Oib]=Wb;gc[ab.a.SGi]=kb.length;gc[ab.a.xhi]=Fb;gc[ab.a.Aso]=nc;this.S4.NDa(z.a.query,gc,this.P8)}Awm(kb,Wb,Fb,nc,gc,Jc,tb,dc=null){const Yb=this.K5(z.a.latency);Yb[ab.a.culture]=this.kOb;Yb[ab.a.SGi]=kb;Yb[ab.a.$cj]=Wb;Yb[ab.a.statusCode]=Fb;Yb[ab.a.AEn]=gc;Yb[ab.a.isSuccess]=Jc;Yb[ab.a.Xnm]=tb;dc&&
(Yb[ab.a.x7n]=dc);this.S4.MDa(z.a.latency,Yb,nc)}swf(kb,Wb,Fb,nc){const gc=this.K5(z.a.performance);gc[ab.a.culture]=this.kOb;gc[ab.a.jgk]=sa[kb];gc[ab.a.N_k]=sa[Wb];gc[ab.a.h2m]=ia[Fb];this.S4.MDa(z.a.performance,gc,nc)}Rym(kb,Wb){var {TellMeActor:Fb}=d(1457);const {CommandResultsUtility:nc}=d(1495);if(kb.results.length){var gc=this.K5(z.a.nOi);gc[ab.a.f6]=Wb.toString();gc[ab.a.groupType]=I.a[kb.groupType];16===kb.groupType&&(gc[ab.a.fim]=Fb.instance.q3c);Wb=[];Fb=[];var Jc=[];for(const tb of kb.results)gc[ab.a.resultType]||
(gc[ab.a.resultType]=G.a[tb.type]),kb={},25===tb.type&&(kb.AssetId=tb.IH),Fb.push(nc.zMc(tb.value)),Wb.push(tb.value),Jc.push(new yb(tb.value,nc.zMc(tb.value),tb.type,tb.r7i,kb));0<Wb.length&&(gc[ab.a.kwn]="{"+Wb.join(", ")+"}",gc[ab.a.s_k]="{"+Fb.join(", ")+"}",gc[ab.a.fwn]=Ga.c(Jc));this.S4.NDa(z.a.nOi,gc,this.P8)}}wel(kb,Wb){if(4===kb)return Ra.kIm;switch(Wb){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return G.a[Wb]}uum(kb,
Wb,Fb,nc,gc){const Jc=this.K5(z.a.click);Jc[ab.a.$cj]=kb;Jc[ab.a.l0m]=Wb;Jc[ab.a.commandId]=Fb;Jc[ab.a.qda]=nc;Jc[ab.a.actionType]=this.wel(gc.groupType,gc.resultType);Jc[ab.a.resultType]=G.a[gc.resultType];Jc[ab.a.A1f]=zb[gc.A1f];Jc[ab.a.groupType]=I.a[gc.groupType];Jc[ab.a.f6]=gc.f6.toString();Jc[ab.a.l3e]=gc.l3e.toString();Jc[ab.a.resultIndex]=gc.resultIndex.toString();this.S4.NDa(z.a.click,Jc,this.P8)}Aum(kb,Wb){this.XHa.yla||(this.XHa.yla=Va.a.create().toString(),this.xki("",!1,Wb));Wb=this.K5(z.a.Lph);
Wb[ab.a.Oib]=kb;this.S4.MDa(z.a.Lph,Wb)}Qki(kb,Wb,Fb){if(kb){if(Fb)for(let nc in Fb)kb[nc]=Fb[nc];this.S4.MDa(z.a.events,kb,Wb)}}daa(kb,Wb,Fb=null){const nc=this.K5(z.a.events);nc[ab.a.event]=kb;this.Qki(nc,Math.round(Wb),Fb)}E_a(kb,Wb,Fb=null){const nc=this.K5(z.a.events);nc[ab.a.event]=z.a.error;nc[ab.a.module]=kb;nc[ab.a.errorMessage]=Wb;nc[ab.a.message]=Wb;this.Qki(nc,Math.round(window.performance.now()),Fb)}rum(kb){const Wb=this.K5(z.a.Wmh);Wb[ab.a.value]=kb;Wb[ab.a.w1d]=this.j7a;this.S4.NDa(z.a.Wmh,
Wb,this.P8)}Ltm(kb){const Wb=this.K5(z.a.m5g);Wb[ab.a.value]=kb;Wb[ab.a.w1d]=this.j7a;this.S4.NDa(z.a.m5g,Wb,this.P8)}uvm(kb){const Wb=this.K5(z.a.KFh);Wb[ab.a.value]=kb;Wb[ab.a.w1d]=this.j7a;this.S4.NDa(z.a.KFh,Wb,this.P8)}Eym(kb){const Wb=this.K5(z.a.iGi);Wb[ab.a.value]=kb;Wb[ab.a.w1d]=this.j7a;this.S4.NDa(z.a.iGi,Wb,this.P8)}Xtm(kb){const Wb=this.K5(z.a.LVi);Wb[ab.a.value]=kb;this.S4.NDa(z.a.LVi,Wb,this.P8)}Iym(kb,Wb){const Fb=this.K5(z.a.NGi);Fb[ab.a.Tac]=kb;Wb&&(Fb[ab.a.yla]=Wb);this.S4.MDa(z.a.NGi,
Fb)}K5(kb){return{["SessionID"]:this.XHa.sessionId,["CorrelationID"]:this.XHa.yla,["Time"]:(new Date).getTime(),["Event"]:kb,["Scenario"]:this.P8}}}Object(D.a)(oa,"UsageLogger",null,[1097]);var pa=d(56),Ya=d(1611),Ja=d(1175),nb=d(80),Bb=d(29),mb=d(224),Qb=d(376),Vb=d(15),mc=d(584),ob=d(60),cb=d(13);d.d(M,"TellMeActor",function(){return db});class db{constructor(){this.$Sa=this.M0=this.Wb=this.Ma=this.yO=this.jy=this.Hb=this.ga=this.Qe=this.wJ=this.Fxe=this.H4g=this.fqa=this.jc=null;this.kRb=!1;this.lje=
[];this.Wwg=[];this.RPg=[];this.SPg=[];this.PKg=!1;this.WNb=this.Nca=null;this.kpc=this.pSa=!1;this.nfd=!0;this.MY=this.goc=this.cFg=this.Uxe=this.CPg=null;this.PX=[];this.G5a=this.DOb=this.Gwa=null;this.EQb=!1;this.Nxe=0;this.xNb=null;this.dqa=-1;this.dPg=0;this.rpc=!1;this.g6a=null;this.o3g=!1;this.Mt=null}get ixd(){return this.yO?this.yO.contentType:db.unknown}get actions(){return this.PX}set actions(kb){this.PX=kb}YIc(){return this.Qe?this.Qe.ina.yla:null}KN(){return this.jc}get aHm(){return this.nfd}get Foo(){return this.CPg}performance(){return this.wJ}get q3c(){return this.o3g}set q3c(kb){this.o3g=
kb}ZF(kb){const Wb=window.performance.now();this.Nca&&!W.c(kb)&&(this.Nca(kb),this.Qe.DA(z.a.ZF,window.performance.now()-Wb))}initialize(kb,Wb=null,Fb=null,nc=null,gc=null,Jc=null,tb=null,dc=null,Yb=null,pb=null,Gb=null){const {InteractionLogger:hb}=d(1831),{GroupsPlacementInfo:Ib}=d(1827),{AggregatorResultsProvider:Ob}=d(1678);this.jc=kb;this.pSa=!!N.AFrameworkApplication.ua&&N.AFrameworkApplication.ua.Sb.T6b;this.Qe=nc;if(!nc){nc=new u;nc.sessionId=N.AFrameworkApplication.userSessionId;const kc=
mc.a.lg(N.AFrameworkApplication.lcid)||mc.a.cMc;this.Qe=new hb(new oa(this.jc.application,kc.name,nc,this.jc.aq,this.pSa,kb.OPa,null),this.jc.fDk,this.jc)}this.$Sa=new L(this.jc.parameterData);this.H4g=Fb||new Oa(this.jc,this.$Sa);this.Nca=tb;this.Fxe=this.Fxe||new fa(this.jc,this.jc.parameterData,tb);this.Wb=pa.FocusManager.instance();this.M0=J.createInstance(this.jc);this.cFg=new Ib(kb);this.ga=gc||N.AFrameworkApplication.ya;this.Hb=Jc||N.AFrameworkApplication.uc;this.jy=Yb;this.fqa=Wb;this.Mt=
Gb;this.wJ=new ea;Yb?Yb.execute(kc=>{kc.isFeatureEnabled(db.X4n,!0).then(Ac=>{const {AggregatorResultsProvider:Nc}=d(1678);this.rpc=Ac;this.fqa=this.fqa||Nc.createInstance(this.M0,this.jc,this.$Sa,this.rpc);return null})}):(this.rpc=!0,this.fqa=this.fqa||Ob.createInstance(this.M0,this.jc,this.$Sa,this.rpc));this.Ma=dc;this.Gwa=Oa.xzd;this.CPg=new Promise(kc=>{this.Uxe=kc});pb&&pb.execute(kc=>{this.yO=kc});this.jc.aq&&K.a.kfi()&&(kb=String.format(CommonUIStrings.l_TeamsUnifiedAppHelpText,this.jc.application),
appChrome.api.dispatch(appChrome.actions.updateTellMePlaceholderText(kb,kb)))}Vb(){this.Z3j()}Mjn(kb){this.goc=kb}Z3j(){this.ga.gb(cb.a.tellMe,ob.a.frame,Object(m.a)(this,this.tellMe,"tellMe"),96);this.ga.gb(cb.a.g3f,ob.a.frame,Object(m.a)(this,this.Sgh,"cacheAsyncMenuRefreshFunction"),96);this.ga.gb(cb.a.l3f,ob.a.frame,Object(m.a)(this,this.jli,"logItemExecuted"),96);this.ga.gb(cb.a.o3f,ob.a.frame,Object(m.a)(this,this.Gki,"logControlDeactivation"),96);this.ga.gb(cb.a.n3f,ob.a.frame,Object(m.a)(this,
this.eli,"logInputFocus"),96);this.ga.gb(cb.a.j3f,ob.a.frame,Object(m.a)(this,this.mZa,"interactionBegin"),96);this.ga.gb(cb.a.q3f,ob.a.frame,Object(m.a)(this,this.mZa,"interactionBegin"),96);this.ga.gb(cb.a.m3f,ob.a.frame,Object(m.a)(this,this.dli,"logInputBlur"),96);this.ga.gb(cb.a.p3f,ob.a.frame,Object(m.a)(this,this.Fki,"logControlActivated"),96);this.ga.gb(cb.a.e1c,ob.a.frame,Object(m.a)(this,this.OHh,"focusSearchBox"),96);this.ga.gb(cb.a.f3f,ob.a.frame,Object(m.a)(this,this.Moh,"constructLiveNotificationForMenu"),
96);this.ga.gb(cb.a.r3f,ob.a.frame,Object(m.a)(this,this.Umf,"insertTryQuery"),96);this.ga.gb(cb.a.Ruf,ob.a.frame,Object(m.a)(this,this.Umf,"insertTryQuery"),96);this.ga.gb(cb.a.t7e,ob.a.frame,Object(m.a)(this,this.FNa,"openOrInsertUrl"),96);this.ga.gb(cb.a.u7e,ob.a.frame,Object(m.a)(this,this.FNa,"openOrInsertUrl"),96);this.ga.gb(cb.a.v7e,ob.a.frame,Object(m.a)(this,this.FNa,"openOrInsertUrl"),96);this.ga.gb(cb.a.w7e,ob.a.frame,Object(m.a)(this,this.FNa,"openOrInsertUrl"),96);this.ga.gb(cb.a.x7e,
ob.a.frame,Object(m.a)(this,this.FNa,"openOrInsertUrl"),96);this.ga.gb(cb.a.HHf,ob.a.frame,Object(m.a)(this,this.FNa,"openOrInsertUrl"),96);this.ga.gb(cb.a.IHf,ob.a.frame,Object(m.a)(this,this.FNa,"openOrInsertUrl"),96);this.ga.gb(cb.a.JHf,ob.a.frame,Object(m.a)(this,this.FNa,"openOrInsertUrl"),96);this.ga.gb(cb.a.IJf,ob.a.frame,Object(m.a)(this,this.iZa,"insertMention"),96);this.ga.gb(cb.a.JJf,ob.a.frame,Object(m.a)(this,this.iZa,"insertMention"),96);this.ga.gb(cb.a.KJf,ob.a.frame,Object(m.a)(this,
this.iZa,"insertMention"),96);this.ga.gb(cb.a.i3f,ob.a.frame,Object(m.a)(this,this.Mzi,"openFeedback"),96);this.ga.gb(cb.a.s3f,ob.a.frame,Object(m.a)(this,this.FNa,"openOrInsertUrl"),96);this.ga.gb(cb.a.rOe,ob.a.frame,Object(m.a)(this,this.oQd,"launchAddin"),96);this.ga.gb(cb.a.sOe,ob.a.frame,Object(m.a)(this,this.oQd,"launchAddin"),96);this.ga.gb(cb.a.tOe,ob.a.frame,Object(m.a)(this,this.oQd,"launchAddin"),96);this.ga.gb(cb.a.YJb,ob.a.frame,Object(m.a)(this,this.YJb,"showTellMeCoachmark"),96);this.ga.gb(cb.a.quf,
ob.a.frame,Object(m.a)(this,this.Gii,"launchAddinStore"),96)}Nhn(kb){this.nfd=!1;const Wb=window.performance.now();kb.A_a.isCompleted?(this.nfd=!0,this.Uxe(!0)):kb.MV(()=>{this.nfd=!0;this.Uxe(!0);this.Qe.DA(z.a.GRk,window.performance.now()-Wb)});this.zin(kb)}zin(kb){Qb.a.wWc(Object(m.a)(this,this.h3e,"dispatcher"));Qb.a.xEc([new mb.a(cb.a.tellMe,ob.a.frame,96),new mb.a(cb.a.g3f,ob.a.frame,96),new mb.a(cb.a.l3f,ob.a.frame,96),new mb.a(cb.a.o3f,ob.a.frame,96),new mb.a(cb.a.n3f,ob.a.frame,96),new mb.a(cb.a.j3f,
ob.a.frame,96),new mb.a(cb.a.q3f,ob.a.frame,96),new mb.a(cb.a.m3f,ob.a.frame,96),new mb.a(cb.a.p3f,ob.a.frame,96),new mb.a(cb.a.e1c,ob.a.frame,96),new mb.a(cb.a.f3f,ob.a.frame,96),new mb.a(cb.a.r3f,ob.a.frame,96),new mb.a(cb.a.Ruf,ob.a.frame,96),new mb.a(cb.a.t7e,ob.a.frame,96),new mb.a(cb.a.u7e,ob.a.frame,96),new mb.a(cb.a.v7e,ob.a.frame,96),new mb.a(cb.a.w7e,ob.a.frame,96),new mb.a(cb.a.x7e,ob.a.frame,96),new mb.a(cb.a.HHf,ob.a.frame,96),new mb.a(cb.a.IHf,ob.a.frame,96),new mb.a(cb.a.JHf,ob.a.frame,
96),new mb.a(cb.a.IJf,ob.a.frame,96),new mb.a(cb.a.JJf,ob.a.frame,96),new mb.a(cb.a.KJf,ob.a.frame,96),new mb.a(cb.a.i3f,ob.a.frame,96),new mb.a(cb.a.s3f,ob.a.frame,96),new mb.a(cb.a.rOe,ob.a.frame,96),new mb.a(cb.a.sOe,ob.a.frame,96),new mb.a(cb.a.tOe,ob.a.frame,96),new mb.a(cb.a.YJb,ob.a.frame,96),new mb.a(cb.a.quf,ob.a.frame,96)],kb)}h3e(kb,Wb,Fb,nc,gc){if(Wb.contextId===ob.a.frame)switch(kb){case cb.a.tellMe:return this.tellMe(kb,Wb,Fb,nc,gc);case cb.a.g3f:return this.Sgh(kb,Wb,Fb,nc,gc);case cb.a.l3f:return this.jli(kb,
Wb,Fb,nc,gc);case cb.a.o3f:return this.Gki(kb,Wb,Fb,nc,gc);case cb.a.n3f:return this.eli(kb,Wb,Fb,nc,gc);case cb.a.j3f:return this.mZa(kb,Wb,Fb,nc,gc);case cb.a.q3f:return this.Rvn(Fb);case cb.a.m3f:return this.dli(kb,Wb,Fb,nc,gc);case cb.a.p3f:return this.Fki(kb,Wb,Fb,nc,gc);case cb.a.e1c:return this.OHh(kb,Wb,Fb,nc,gc);case cb.a.f3f:return this.Moh(kb,Wb,Fb,nc,gc);case cb.a.r3f:case cb.a.Ruf:return this.Umf(kb,Wb,Fb,nc,gc);case cb.a.t7e:case cb.a.u7e:case cb.a.v7e:case cb.a.w7e:case cb.a.x7e:case cb.a.HHf:case cb.a.IHf:case cb.a.JHf:case cb.a.s3f:return this.FNa(kb,
Wb,Fb,nc,gc);case cb.a.IJf:case cb.a.JJf:case cb.a.KJf:return this.iZa(kb,Wb,Fb,nc,gc);case cb.a.i3f:return this.Mzi(kb,Wb,Fb,nc,gc);case cb.a.rOe:case cb.a.sOe:case cb.a.tOe:return this.oQd(kb,Wb,Fb,nc,gc);case cb.a.YJb:return this.YJb(kb,Wb,Fb,nc,gc);case cb.a.quf:return this.Gii(kb,Wb,Fb,nc,gc)}return 2}OHh(kb,Wb,Fb){if(1===Fb)return 32;this.CZi();kb=!1;(this.jc.OPa||this.pSa)&&(Wb=document.getElementById("SearchButton"))&&Wb.click();if(!this.jc.OPa&&this.pSa)for(Wb=document.getElementsByClassName("ms-suiteux-search-box"),
Fb=0;Fb<Wb.length;Fb++){const nc=Wb[Fb].querySelector("input[type=search]");nc&&(kb=pa.FocusManager.uK(nc))}else kb=pa.FocusManager.uK($get(this.jc.aq?r.CuiHelper.R_f:r.CuiHelper.b$d));this.kpc=!0;return kb?32:8}Umf(kb,Wb,Fb,nc,gc){if(1===Fb)return 32;if(W.c(gc))return this.Qe.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.CZi();kb=gc.CommandValueId;Wb=this.jc.aq?r.CuiHelper.R_f:r.CuiHelper.b$d;this.jc.aq&&!W.c(gc[Ja.a.q2a])&&(gc[Ja.a.q2a]=!1);if(kb){if(this.jc.aq)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(kb)),
this.g6a=[19],32;if(gc=$get(Wb))gc.value=kb}return pa.FocusManager.uK($get(Wb))?32:8}CZi(){this.Wb.nK(this.jc.OPa||this.pSa?this.jc.dBb:this.jc.J1a,!1)}mel(kb,Wb){switch(kb){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,Wb);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,Wb);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,Wb);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,
Wb)}return Wb}Moh(kb,Wb,Fb,nc,gc){if(1===Fb)return 32;if(W.c(gc))return this.Qe.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;kb=this.Gwa?this.Gwa.EQi:0;gc.Value=1!==kb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,kb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.Gwa)for(const Jc of this.Gwa.WVk)gc=Object(f.a)(C.a,Jc)?Jc.id:ka.a.replaceAll(Jc.value,'"',""),(gc=$get(gc+"-"+K.a.h3f))&&Bb.a.Gq(gc,Bb.a.cda,ka.a.If(this.mel(Jc.groupType,
gc.innerText)));return 32}Sgh(kb,Wb,Fb,nc,gc){if(1===Fb)return 32;if(W.c(gc))return this.Qe.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.xNb=new nb.a(2,1,0,()=>{gc[Ya.a.Callback]()},97);this.Gwa&&this.Hb.$b(this.xNb);return 32}jli(kb,Wb,Fb,nc,gc){if(1===Fb)return 32;if(W.c(gc))return this.Qe.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;gc.CloseAllMenus&&(kb=void 0===gc.ParentControlId||null===gc.ParentControlId?"<NA>":gc.ParentControlId,
Wb=this.WNb?this.WNb[gc.ControlId]:null,!Wb&&this.WNb&&"<NA>"!==kb&&(Wb=this.WNb[kb]),Wb||(Wb=this.kRb&&this.M0.J9l(gc),Wb=this.cTk(Wb,gc.ControlId),Wb=new w(Wb,27,4,-1,-1,-1),this.Qe.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+gc.ControlId+" determined group:"+I.a[Wb.groupType])),this.Qe.rOm(gc.ControlId,kb,gc.CommandId,gc.CloseAllMenus,Wb),this.$Sa.QKm(gc.ControlId),gc.Location!==ta.a.contextMenu&&(this.M0.rya(gc),this.M0.HH(Wb.resultType),this.jc.R6d&&this.fqa.M1j(gc.CommandId)));
return 32}Gki(kb,Wb,Fb,nc,gc){if(1===Fb)return 32;F.a.Vjm()&&(new ya(this.YIc())).IDl(this.DOb);kb=this.DOb;Wb=this.dqa;Fb=this.Qe.q8c;if(W.c(gc))return this.Qe.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;gc=gc.UILocation;kb&&0<kb.length&&this.rpc&&K.a.OYf(this.jc)&&this.jc.oPd&&19!==gc&&Wb>Fb&&!this.jc.PQ&&(this.Qe.uwf(kb),this.Qe.mWf(Wb));this.Qe.Eun();this.jc.bce&&19!==gc&&(this.wJ.mark(3),this.wJ.measure(1,0,3),this.wJ.measure(2,2,3),this.wJ.iwf(0,1,2),this.wJ.iwf(2,
2,3),this.wJ.iwf(1,0,3),this.wJ.Vuk(),this.wJ.clearMeasures([0,2,1]));this.Qe.ZOm(window.performance.now()-this.Nxe);this.jc.aq&&(this.G5a=null,this.Qe.mua());this.kpc=this.EQb=!1;this.DOb="";return 32}eli(kb,Wb,Fb){if(1===Fb)return 32;this.Qe.Ohb(v(Wb),this.kpc);return 32}dli(kb,Wb,Fb){if(1===Fb)return 32;this.Qe.mua();this.EQb=!1;return 32}Fki(kb,Wb,Fb,nc,gc){if(1===Fb)return 32;this.MY=null;gc&&(this.MY=gc);this.jc.bce&&(W.c(this.MY)||this.MY.Location!==ta.a.contextMenu)&&this.wJ.mark(0);this.Qe.V5d(W.c(this.MY)||
W.c(this.MY.Location)?ta.a.unknown:this.MY.Location);this.Qe.YOm(this.dPg,this.kpc);this.EQb||this.o0a();return 32}Yrh(kb,Wb){const Fb=[],nc=Date.now();for(let gc of kb)kb=(nc-gc.timeStamp)/1E3,kb=K.a.h5f(kb),Array.add(Fb,new P(Wb?gc.commandId:gc.controlId,kb));return Fb}Esh(kb=!1){var Wb=kb?this.M0.CDl():this.M0.YGc();kb=[];const Fb=Date.now();for(const nc of Wb)Wb=(Fb-nc.TimeStamp)/1E3,Wb=K.a.h5f(Wb),Array.add(kb,new P(nc.Id,Wb));return kb}o0a(){if(!this.EQb){this.kRb=this.EQb=!0;""!==this.jc.LUf&&
N.AFrameworkApplication.Gl(this.jc.LUf);if(!this.PKg){this.PKg=!0;const kb={};kb.IsMLREnabled=this.jc.xem;kb.IsReactRibbonEnabled=this.jc.aq;kb.IsSharedHeaderEnabled=!!N.AFrameworkApplication.ua&&N.AFrameworkApplication.ua.Sb.sI;kb.IsSearchUxEnabled=this.pSa;kb.IsTellMeInHeaderEnabled=this.jc.OPa;kb.IsGoLocalEnv=K.a.ybi();kb.IsSovereignEnvironment=K.a.gDb();kb.IsTellMeServiceResultsEnabled=K.a.OYf(this.jc);kb.IsSubstrateProviderEnabled=K.a.NYf(this.jc);kb.ShouldFetchTokens=!!N.AFrameworkApplication.ua&&
N.AFrameworkApplication.ua.Sb.EJb;kb.IsSerpletEnabled=K.a.bCa();kb.FirstOnClickTimeInMS=Math.round(window.performance.now());kb.IsHeaderHidden=N.AFrameworkApplication.hideHeader||N.AFrameworkApplication.ZP;kb.IsSearchInHeaderHidden=N.AFrameworkApplication.lKc;void 0!==window.performance.timing&&null!==window.performance.timing&&(kb.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));kb.IsFindWithMatchesEnabled=this.jc.yBd;kb.HelpShowsTopSearchResult=this.jc.q_c;kb.HelpShowsNumberOfMatches=
this.jc.p_c;N.AFrameworkApplication.K&&(kb.UiHost=N.AFrameworkApplication.K.lb("UiHostIntegrationType"));this.Qe.lzm(JSON.stringify(kb))}this.lje=this.Yrh(l.a.instance.N1b(),!1);this.Wwg=this.Yrh(l.a.instance.Fcb(),!0);this.RPg=this.Esh();this.SPg=this.Esh(!0);this.Qe.o0a()}}mZa(kb,Wb,Fb,nc,gc){if(1===Fb)return 32;if(W.c(gc))return this.Qe.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(Vb.a.rNc)return 32;this.Nxe=window.performance.now();this.o0a();kb=new X(Object(m.a)(this,
this.pua,"onRequestCompleted"),0);this.dqa++;this.Qe.beginQuery("",this.dqa,this.kRb);this.Gwa=Oa.xzd;this.G5a=fa.X4e;if(this.fqa)db.instance.actions=[],this.fqa.uI(new R("",this.dqa),kb,this.jc.aq);else this.Qe.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.xNb&&this.Hb.$b(this.xNb);return 32}Rvn(kb){if(1===kb)return 32;this.Wb.GQ(this.jc.OPa||this.pSa?this.jc.dBb:this.jc.J1a,!1);return 32}tellMe(kb,Wb,Fb,nc,gc){if(1===Fb)return 32;if(W.c(gc))return this.Qe.onError("TellMeActor:TellMe",
"actiondata comes null"),16;this.MY=gc;this.Qe.V5d(W.c(this.MY.Location)?ta.a.unknown:this.MY.Location);kb=this.MY.Value;this.jc.aq||kb&&""!==kb.trim()?(!this.G5a&&this.jc.aq&&(this.Qe.Ohb(v(Wb),this.kpc),this.o0a()),this.e3k(kb,this.MY.Location),this.MY.PopulationXML=this.Gwa.xml):this.kRb?this.MY.PopulationXML=this.Gwa.xml:(this.MY.PopulationXML=Oa.xzd.xml,this.G5a=fa.X4e,this.DOb="");return 32}e3k(kb,Wb){this.Nxe=window.performance.now();this.jc.bce&&Wb!==ta.a.contextMenu&&this.wJ.mark(1);this.jc.aq&&
appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(kb));kb&&0<kb.trim().length&&(this.kRb=!1);this.jc.J1k();Wb=W.c(Wb)?ta.a.tellMe:Wb;if(kb!==this.DOb||this.jc.aq){this.dqa++;this.Qe.beginQuery(kb,this.dqa,this.kRb);const Fb=new R(kb,this.dqa),nc=new X(Object(m.a)(this,this.pua,"onRequestCompleted"),this.dqa);this.Gwa=Oa.xzd;this.G5a=fa.X4e;if(this.fqa)db.instance.actions=[],this.fqa.uI(Fb,nc,this.jc.aq,Wb,this.g6a),this.g6a=null;else this.Qe.onError("TellMeActor:ExecuteTellMeQuery",
"Aggregator provider not resolved yet");this.dPg=this.dqa;this.DOb=kb}}kho(kb){if(this.jc.aq){var Wb=appChrome.selectors.getActiveControlStates();if(Wb=Object(a.a)(Object,Wb[kb.value])){kb.label=Wb.label;let Fb=null;"description"in Wb&&(Fb=Wb.description);Fb&&Object.getType(Fb)===String?kb.description=Fb:"secondaryText"in Wb?kb.description=Wb.secondaryText:"fullDescriptionLabel"in Wb&&(kb.description=Wb.fullDescriptionLabel)}}}I3m(kb){this.WNb={};let Wb=0,Fb=0;for(const nc of kb){kb=0;for(const gc of nc.results)this.WNb[gc.value]=
new w(gc.groupType,gc.type,gc.r7i,Wb,kb,Fb),kb++,Fb++,gc.label||5!==gc.type||this.kho(gc);0<kb&&Wb++}}B$b(kb,Wb,Fb,nc,gc){if(1===Fb)return 32;if(W.c(gc))return this.Qe.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(kb=gc.CommandValueId)&&window.open(kb,"_blank");return 32}iZa(kb,Wb,Fb,nc,gc){if(1===Fb)return 32;if(W.c(gc))return this.Qe.onError("TellMeActor:InsertMention","actiondata comes null"),16;kb=gc.UILocation;let Jc;gc=gc.CommandValueId;try{Jc=Ga.a(gc)}catch(tb){return this.Qe.onError("TellMeActor:InsertMention",
"commandValueId is not in proper format"),16}return W.c(Jc)?(this.Qe.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):W.c(this.goc)?(this.Qe.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==kb?(this.Qe.onError("TellMeActor:InsertMention","location "+kb+" is unexpected"),16):this.goc.iZa(Jc.displayName,Jc.email,Jc.userId)?32:(this.Qe.onError("TellMeActor:InsertMention","mention is not inserted"),16)}FNa(kb,Wb,Fb,nc,gc){return 1===Fb?32:
W.c(gc)?(this.Qe.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===gc.UILocation?this.X4l(Fb,gc):this.B$b(kb,Wb,Fb,nc,gc)}Mzi(kb,Wb,Fb,nc,gc){if(1===Fb)return 32;if(W.c(gc))return this.Qe.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.Mt&&this.Mt.execute(Jc=>{Jc.pPa("TellMeSurvey",null)});return 32}X4l(kb,Wb){if(1===kb)return 32;if(W.c(Wb))return this.Qe.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(W.c(this.goc))return this.Qe.onError("TellMeActor:InsertUrl",
"_iInsertContentHandler comes null"),16;kb=Wb.CommandValueId;return W.c(kb)?(this.Qe.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.goc.insertHtmlText(kb)?32:(this.Qe.onError("TellMeActor:InsertUrl","url is not inserted"),16)}pua(kb,Wb,Fb,nc,gc){Fb=window.performance.now();this.I3m(Wb);this.Qe.iJn(Wb);this.jc.aq?(this.G5a=this.Fxe.Kdl(Wb,kb,gc),this.jc.VAa?(this.PX.push(appChrome.actions.updateTellMeSearchResults(this.G5a.menuModel,kb,gc)),appChrome.api.dispatch(this.PX)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.G5a.menuModel,
kb,gc)),this.jc.bce&&this.EQb&&(W.c(this.MY)||this.MY.Location!==ta.a.contextMenu)&&(this.wJ.mark(2),this.wJ.measure(0,1,2))):this.Gwa=this.H4g.Ldl(Wb,this.Qe.ina);this.xNb&&this.Hb.$b(this.xNb);gc={};gc.GroupsCount=Wb.length;gc.QueryID=nc;gc.QueryLength=kb.length;this.Qe.DA(z.a.XKk,window.performance.now()-Fb,gc)}cTk(kb,Wb){return Wb.startsWith(this.jc.aq?K.a.E5f:K.a.Bae)?5:kb?4:"bSearchHelp"===Wb||Wb.startsWith("GetHelpFromTellMe")?8:"bInsights"===Wb||Wb.startsWith("SmartLookupFromTellMe")?13:Wb===
this.jc.M7e?2:0}HH(kb,Wb){this.fqa&&this.fqa.HH(kb,Wb)}Gii(kb,Wb,Fb,nc,gc){return this.ga.Xb(cb.a.pQd,2,gc)}oQd(kb,Wb,Fb,nc,gc){({AddinResultsProvider:kb}=d(1591));gc=gc.CommandValueId;if(W.b(gc))return this.Qe.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!kb.Zub[gc])return this.Qe.onError("TellMeActor:LaunchAddin","Add-in with assetId "+gc+" doesn't not exist in entitlements"),16;kb=d(1591).AddinResultsProvider.Zub[gc];Wb={};Wb.solutionId=kb.id;Wb.version=kb.appVersion;Wb.storeType=
kb.storeType;Wb.storeId=kb.storeId;Wb.assetId=kb.assetId;Wb.assetStoreId=kb.assetStoreId;Wb.displayName=kb.displayName;Wb.targetType=kb.targetType;Wb.height=kb.height;Wb.width=kb.width;kb=this.ga.Xb(cb.a.Gmf,2,Wb);if(32!==kb)this.Qe.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+kb+". AssetId: "+gc);return kb}YJb(){if(!W.c(this.Mt))for(let kb of l.a.instance.Fcb()){if("ShowContextMenuWithFloatie"===kb.commandId)return this.Mt.execute(Wb=>{Wb.logActivity("TellMe1TabSwitchCoachMarkActivity",
null)}),32;if(kb.commandId&&-1===kb.commandId.indexOf("Tab"))break}return 8}static get instance(){return db._instance||(db._instance=new db)}}db._instance=null;db.X4n="mso_tellMeService";db.unknown="Unknown";Object(D.a)(db,"TellMeActor",null,[])},1459:function(D,M,d){d.d(M,"a",function(){return f});D=d(0);var m=d(1472);class f{constructor(a,l){this.k7a=!1;const {Annotations:r}=d(1453);if(!a)throw Error.argumentNull("annotations");if(!a.Ysf(l))throw Error.argument("memberTypeID","Invalid type ID");
if(r.hH(l))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.Kv=a;this.UKj=l;this.Qp=[]}get RWb(){return this.Kv}get isReadOnly(){return this.k7a}get F2(){return this.UKj}get items(){return this.Qp}yba(){const {Annotations:a}=d(1453);let l="[";for(let r=0,w=this.items.length;r<w;++r){0<r&&(l+=", ");const v=this.Kv.yba(this.F2,this.items[r]);this.F2===a.H7?(l+='"',l+=m.a.k6e(v),l+='"'):l+=v}return l+"]"}isEqual(a){const {Annotations:l}=d(1453);if(this===a)return!0;if(!a||
a.RWb!==this.Kv||a.F2!==this.F2||a.items.length!==this.items.length)return!1;for(let r=0;r<this.items.length;++r)if(!l.bmb(this.F2,this.items[r],a.items[r]))return!1;return!0}clone(){const a=new f(this.Kv,this.F2);Array.addRange(a.items,this.items);return a}qS(){return this.isReadOnly?this.clone():this}Nvf(){const {Annotations:a}=d(1453);if(!this.isReadOnly){this.k7a=!0;for(const l of this.items)a.pEb(l)}}toString(){return this.yba()}}Object(D.a)(f,"ListValue",null,[1214,1212])},1460:function(D,M,
d){d.d(M,"a",function(){return m});D=d(0);class m{}m.tellMe="TellMe";m.contextMenu="ContextMenu";m.unknown="Unknown";Object(D.a)(m,"TellMeScenario",null,[])},1461:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f,a,l=null,r=null,w=4,v=-99999,u=0){this.IH="";this.xqd=-1;this.value=f;this.type=a;this.r7i=w;this.label=this.RB=l;this.groupType=26;this.description=r;this.score=v;this.count=u}}Object(D.a)(m,"ResultBinding",null,[])},1463:function(D,M,d){d.d(M,"a",function(){return m});
D=d(0);class m{constructor(f){this.attributes=null;this.query=f;this.Sn=[]}wv(f){this.Sn.push(f)}DMi(f){const a=[];for(const l of this.Sn)l.groupType!==f&&a.push(l);this.Sn.length!==a.length&&(this.Sn=a)}get E6b(){return!1}}Object(D.a)(m,"SimpleResultsUpdatedEventArgs",null,[1069])},1464:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f=26,a=""){this.Kt=[];this.groupType=f;this.displayName=a}get results(){return this.Kt}zy(f){f.groupType=this.groupType;Array.add(this.results,
f)}SQf(f=1){if(this.results.length>=f)for(let a=0;a<f;a++)Array.removeAt(this.results,this.results.length-1)}}Object(D.a)(m,"SimpleResultGroup",null,[1070])},1472:function(D,M,d){D=d(0);class m{constructor(a,l){this.E$a=a;this.value=l}}Object(D.a)(m,"AttrValuePair",null,[]);d.d(M,"a",function(){return f});class f{constructor(a){this.k7a=!1;if(!a)throw Error.argumentNull("annotations");this.Kv=a;this.eX=[]}get RWb(){return this.Kv}get isReadOnly(){return this.k7a}get Yif(){return 0<this.eX.length}jq(a){if(!this.Kv.p7b(a))throw Error.argument("attributeID",
"Invalid attribute ID");for(const l of this.eX)if(a===l.E$a)return a=l.value,{returnValue:!0,value:a};return{returnValue:!1,value:null}}ay(a,l){var {Annotations:r}=d(1453);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.Kv.p7b(a))throw Error.argument("attributeID","Invalid attribute ID");if(!this.Kv.i6b(this.Kv.getAttributeType(a),l))throw Error.argument("value","Value is not of the correct type for the specified attribute");r.pEb(l);
for(r=0;r<this.eX.length;++r){const w=this.eX[r];if(a===w.E$a){w.value=l;return}}Array.add(this.eX,new m(a,l))}pOa(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Kv.p7b(a))throw Error.argument("attributeID","Invalid attribute ID");for(let l=0;l<this.eX.length;++l)if(a===this.eX[l].E$a){Array.removeAt(this.eX,l);break}}tCd(a){if(!a)throw Error.argumentNull("action");for(const l of this.eX)a(l.E$a,l.value)}clone(){const a=new f(this.Kv);
a.$Va(this);return a}$Va(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!a)throw Error.argumentNull("other");if(a.RWb!==this.Kv)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.eX);a.tCd((l,r)=>{this.ay(l,r)})}yba(){const {Annotations:a}=d(1453);let l="[",r=!0;for(const w of this.eX){r?r=!1:l+=", ";l+=this.Kv.OKh(w.E$a);l+="=";const v=this.Kv.getAttributeType(w.E$a),u=this.Kv.yba(v,w.value);v===a.H7?(l+=
'"',l+=f.k6e(u),l+='"'):l+=u}return l+"]"}isEqual(a){const {Annotations:l}=d(1453);if(!a)throw Error.argumentNull("other");if(this===a)return!0;if(!a||this.Kv!==a.RWb||this.Yif!==a.Yif)return!1;let r=0,w=null,v=!1;a.tCd((u,z)=>{++r;if(!v){var B=-1;for(let G=0,F=this.eX.length;G<F;++G)if(this.eX[G].E$a===u){B=G;break}0>B?v=!0:(w||(w=Array(this.eX.length)),w[B]=z)}});if(this.eX.length!==r||v)return!1;for(let u=0,z=this.eX.length;u<z;++u)if(!l.bmb(this.Kv.getAttributeType(this.eX[u].E$a),this.eX[u].value,
w[u]))return!1;return!0}qS(){return this.isReadOnly?this.clone():this}Nvf(){const {Annotations:a}=d(1453);if(!this.isReadOnly){this.k7a=!0;for(const l of this.eX)a.pEb(l.value)}}toString(){return this.yba()}static k6e(a){return a.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(D.a)(f,"FeatureBundle",null,[1211,1212])},1478:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{}m.click="Click";m.mZa="InteractionBegin";m.YBb="InteractionEnd";m.Lph="ControlActivated";
m.query="Query";m.NGi="QueryIndexRecorded";m.Wmh="Clicks";m.m5g="ActionEvents";m.KFh="FilteredActionEvents";m.LVi="SessionContext";m.latency="Latency";m.performance="Performance";m.nOi="RenderedResults";m.events="Events";m.XKk="CreateResultsMenu";m.ZF="UpdateRibbonControls";m.jwn="ResultsAggregation";m.uI="IssueQuery";m.syk="CommandSuggestions";m.error="Error";m.Avf="LoadModelData";m.GRk="DepsResolveTime";m.bHm="ModelDataWaitTime";m.timedOut="TimedOut";m.a8j="AddinQueryCommandReady";m.Oel="GetAddinEntitlements";
m.iGi="ProviderMRUEvents";Object(D.a)(m,"EventNames",null,[])},1482:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(){this.nxf=null;this.faa=this.pxf=0}J9e(f,a,l){if(!f)throw Error.argumentNull("referenceList");if(0>a||a>f.length)throw Error.argumentOutOfRange("startIndex");if(0>l||l>f.length)throw Error.argumentOutOfRange("length");if(a+l>f.length)throw Error.argument("Invalid start-length range");this.nxf=f;this.pxf=a;this.faa=l}Acb(f,a,l){this.J9e(f.nxf,f.pxf+a,l)}J(f){if(0>
f||f>=this.faa)throw Error.argumentOutOfRange("index");return this.nxf[this.pxf+f]}get count(){return this.faa}static h_e(f){const a=new m;a.J9e(f,0,f.length);return a}}Object(D.a)(m,"ReadOnlyList",null,[1236])},1487:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);var m;(function(f){f[f.Classifier=0]="Classifier";f[f.AppsForOffice=1]="AppsForOffice";f[f.FindInDocument=2]="FindInDocument";f[f.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";f[f.RecentlyUsed=4]="RecentlyUsed";f[f.TryQuery=
5]="TryQuery";f[f.Empty=6]="Empty";f[f.TryCommand=7]="TryCommand";f[f.Assistance=8]="Assistance";f[f.Answer=9]="Answer";f[f.Definition=10]="Definition";f[f.Entity=11]="Entity";f[f.WolframAnswer=12]="WolframAnswer";f[f.Insights=13]="Insights";f[f.People=14]="People";f[f.Document=15]="Document";f[f.Recommended=16]="Recommended";f[f.ServiceClassifier=17]="ServiceClassifier";f[f.ServiceRecommended=18]="ServiceRecommended";f[f.Image=19]="Image";f[f.Notes=20]="Notes";f[f.Learning=21]="Learning";f[f.Feedback=
22]="Feedback";f[f.Template=23]="Template";f[f.Addin=24]="Addin";f[f.OfficeScript=25]="OfficeScript";f[f.None=26]="None";f[f.MergedActions=27]="MergedActions";f[f.MergedScopedSearches=28]="MergedScopedSearches";f[f.MergedSuggestedSearches=29]="MergedSuggestedSearches"})(m||(m={}));Object(D.b)("ResultGroupType",m)},1492:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);d=d(1536);class m extends d.a{constructor(){super();this.info=this.kj=this.eventId=null}get Yda(){return"Misc"}Hzb(){this.detail.Z("Type",
this.Yda);this.detail.Z("EventId",this.eventId);this.detail.Z("Func",this.kj);this.detail.Z("Info",this.info);return this.detail}}Object(D.a)(m,"BasicMergeFailureDetail",d.a,[])},1493:function(D,M,d){d.d(M,"a",function(){return l});D=d(0);var m=d(609),f=d(780),a=d(1510);class l{constructor(r,w=!0){this.im=w&&r?r.xG():r;this.iVb=new m.a}fB(r){this.iVb.add(f.a.yb(r))}tNn(r){this.iVb=r}tpi(r){this.im&&(new a.a(this.im,r)).dna.forEach((w,v)=>{v.PW&&!this.iVb.contains(w)&&(this.iVb.add(w),v.isDeleted?
(v=this.im,v.hasProperty(f.a.oW(w))&&v.removeProperty(f.a.oW(w))):this.im.nva(f.a.oW(w),v.newValue));return!0})}}Object(D.a)(l,"PartialMergeResult",null,[])},1494:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{}m.appName="AppName";m.qda="CloseAllMenus";m.commandId="CommandId";m.context="Context";m.culture="Culture";m.message="Message";m.errorMessage="ErrorMessage";m.event="Event";m.yla="CorrelationID";m.l0m="ParentUiElement";m.query="Input";m.Oib="QueryID";m.SGi="QueryLength";m.Tac=
"QueryIndex";m.kwn="ResultsList";m.suggestions="Suggestions";m.scenario="Scenario";m.sessionId="SessionID";m.source="Source";m.timeStamp="Time";m.$cj="UiElement";m.w1d="ReactUx";m.value="Val";m.statusCode="StatusCode";m.AEn="Service";m.isSuccess="IsSuccess";m.x7n="TokenAcquired";m.Xnm="LatencyType";m.groupName="GroupName";m.f6="GroupIndex";m.groupType="GroupType";m.fwn="ResultInfoList";m.resultType="ResultType";m.A1f="SubResultType";m.Ucm="IsInputBlur";m.Vcm="IsInputFocus";m.Fim="IsShortCutUsed";
m.actionType="ActionType";m.count="Count";m.EYk="DwellTime";m.xhi="IsZeroTerm";m.Aso="WordsCount";m.UOd="IsSearchUxEnabled";m.Tjm="IsTellMeInHeaderEnabled";m.module="Module";m.resultIndex="ResultIndex";m.l3e="DisplayIndex";m.s_k="EnableList";m.provider="Provider";m.contentType="ContentType";m.fim="IsSelectionBased";m.jgk="BeginPerformanceMarker";m.N_k="EndPerformanceMarker";m.h2m="PerformanceMeasure";Object(D.a)(m,"Columns",null,[])},1495:function(D,M,d){d.r(M);d.d(M,"CommandResultsUtility",function(){return z});
D=d(0);var m=d(1494),f=d(1478),a=d(1508),l=d(1461),r=d(1464),w=d(1457),v=d(1456),u=d(2);class z{static y2c(B,G){if(G&&G.aq){const F={};for(const K of B)G.DPd(K)&&(F[K]=appChrome.selectors.getModelType(K));w.TellMeActor.instance.ZF(F)}}static i5n(B){return B.startsWith("btnTellMeOfficeAddIn")}static zMc(B){const G=w.TellMeActor.instance.KN();return!!G&&G.aq&&!appChrome.selectors.isControlDisabled(B)}static bSd(B,G,F,K){if(w.TellMeActor.instance.Qe&&B){const N=[];for(const H of B)N.push(String.format('{{"Id":"{0}","Score":{1}}}',
H.commandId,H.score));B={};B[m.a.suggestions]="[{"+N.join(",")+"}]";B[m.a.xhi]=G;B[m.a.groupType]=F;B[m.a.provider]=K;w.TellMeActor.instance.Qe.DA(f.a.syk,window.performance.now(),B)}}static Ill(B,G){const F=[],K=[];for(const N of G){G=N.commandId;let H=N;N.commandId in B&&(G=B[N.commandId],H=new a.a(G,N.score));Array.contains(K,G)||(F.push(H),K.push(G))}return F}static NGd(B,G,F,K,N,H,J,L){F.rbf&&(G=z.Ill(F.rbf,G));var I=v.a.Vjl(G);z.y2c(I,F);var R=[],C=[];I=[];const P=new r.a(J);J=16===J||18===
J||7===J||4===J?u.AFrameworkApplication.K?u.AFrameworkApplication.K.rc("TellMeMaxRecommendedResultsToReturn",3):3:0===J||17===J?5:0;for(const W of G)if(!z.H9l(W.commandId)){G=z.i5n(W.commandId);if(F.DPd(W.commandId)&&!G){if(v.a.ugi(W.commandId))continue;G=null;N&&H&&(G=N.sBl(W.commandId,H));z.zMc(W.commandId)?Array.add(R,new l.a(W.commandId,5,G,null,L,W.score)):Array.add(C,new l.a(W.commandId,5,G,null,L,W.score))}else F.gvb&&G&&K&&Array.add(I,W.commandId.substr(21));if(R.length+I.length>=J)break}F=
0;for(N=0;N<R.length&&F<J;N++,F++)P.zy(R[N]);for(R=0;R<C.length&&F<J;R++,F++)P.zy(C[R]);for(C=0;C<I.length&&F<J;C++,F++)K.FJo(B,I[C],P);return P}static H9l(B){z.feh||(u.AFrameworkApplication.K&&u.AFrameworkApplication.K.vu("TellMeControlPredictionBlockList")&&u.AFrameworkApplication.K.AB("TellMeControlPredictionBlockList").forEach(G=>{Array.add(z.eeh,G.toLowerCase())}),z.feh=!0);return Array.contains(z.eeh,B.toLowerCase())}static cof(B){return 2<B.length&&";"===B.charAt(0)&&";"===B.charAt(B.length-
1)&&!!u.AFrameworkApplication.K&&(u.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}static EMh(B){const G=new r.a(0);var F=B.split(";");B=w.TellMeActor.instance.KN();for(const K of F)if(0<K.length){F=K.split(":");const N=2===F.length?F[0]:K;if(!B.DPd(N))break;if(1===F.length)F=new l.a(N,5,null,null,1),G.zy(F);else if(2===F.length)F=new l.a(N,5,F[1],null,1),G.zy(F);else break}return G}static s1j(B,
G,F){if(!(G&&G.results&&B&&B.results&&B.results.length))return{returnValue:!1,MMe:B,ANe:G};const K=[];for(var N of G.results)Array.add(K,N.value);N=0;const H=0<G.results.length?G.results[0].score:0;for(const J of B.results)if(J.score>F&&!Array.contains(K,J.value)&&z.zMc(J.value)&&(0<H&&(J.score=H),Array.insert(G.results,N,J),N++),2===N)break;return 0<N?(F=G.results.length-5,0<F&&G.SQf(F),{returnValue:!0,MMe:B,ANe:G}):{returnValue:!1,MMe:B,ANe:G}}}z.feh=!1;z.eeh=[];Object(D.a)(z,"CommandResultsUtility",
null,[])},1505:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{static O6n(f){return f.toString().charCodeAt(0)}static ujm(f){return 55296<=f&&57343>=f}static charAt(f,a){return f.charAt(a)}static gch(f,a){if(f===a)return!0;"\u00a0"===f&&(f=" ");"\u00a0"===a&&(a=" ");return f===a}static fch(f,a){if(f===a)return!0;if(!f||!a||f.length!==a.length)return!1;f=m.xOi(f);a=m.xOi(a);return f===a}static xOi(f){return f.replace(m.TQc," ")}static Lkb(f,a,l){return f.substring(a,a+l)}}m.TQc=RegExp("\u00a0",
"g");Object(D.a)(m,"CharUtils",null,[])},1506:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{}m.tellMe="TellMe";m.loki="Loki";m.substrate="Substrate";m.Tac="QueryIndex";m.n9i="TellMeRanker";m.o9i="TellMeRankerLogging";Object(D.a)(m,"Services",null,[])},1507:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{}m.Rsa="HttpRequest";m.provider="Provider";Object(D.a)(m,"LatencyTypes",null,[])},1508:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f,
a){this.commandId=f;this.score=a}}Object(D.a)(m,"CommandSuggestion",null,[])},1510:function(D,M,d){D=d(0);var m=d(385),f=d(780),a=d(244),l=d(43);class r{constructor(v,u,z){this.TPj=v;this.kMj=u;this.GLj=z;this.zse=new a.a(Object(l.a)(this,this.ysk,"checkIfDifferent"))}get Iib(){return this.TPj}get oldValue(){return this.kMj}get newValue(){return this.GLj}get hfb(){return!(void 0===this.newValue||null===this.newValue)&&(void 0===this.oldValue||null===this.oldValue)}get isDeleted(){return(void 0===
this.newValue||null===this.newValue)&&!(void 0===this.oldValue||null===this.oldValue)}get PW(){return this.hfb||this.isDeleted||this.zse.value}ysk(){return this.hfb||this.isDeleted?!0:!f.a.mch(this.Iib,this.oldValue,this.newValue)}}Object(D.a)(r,"PropertyDiff",null,[]);d.d(M,"a",function(){return w});class w{constructor(v,u){this.hMj=v;this.DLj=u;this.zse=new a.a(()=>this.KMc());this.VPj=new a.a(Object(l.a)(this,this.t2k,"evaluatePropertyDiffs"))}get hu(){return this.hMj}get Df(){return this.DLj}get hfb(){return!!this.Df&&
!this.hu}get isDeleted(){return!this.Df&&!!this.hu}get PW(){return this.hfb||this.isDeleted||this.zse.value}get dna(){return this.VPj.value}KMc(v=null){let u=!1;this.dna.forEach((z,B)=>{u=B.PW&&(!v||7!==v.J(z));return!u});return u}t2k(){const v=new m.a;var u=this.Df,z=this.hu;if(this.hfb){z=u.Mj();for(var B=0;B<z.length;B++){var G=z[B];v.Z(f.a.yb(G),new r(G,null,u.QP(G)))}}else if(this.isDeleted)for(u=z.Mj(),B=0;B<u.length;B++)G=u[B],v.Z(f.a.yb(G),new r(G,z.QP(G),null));else{B=z.Mj();for(G=0;G<B.length;G++){var F=
B[G],K=f.a.yb(F),N=z.QP(F);const H=u.hasProperty(F)?u.QP(F):null;v.Z(K,new r(F,N,H))}B=u.Mj();for(G=0;G<B.length;G++)F=B[G],z.hasProperty(F)||(K=f.a.yb(F),N=u.QP(F),v.Z(K,new r(F,null,N)))}return v}}Object(D.a)(w,"MergeableObjectDiff",null,[])},1519:function(D,M,d){d.d(M,"b",function(){return r});d.d(M,"a",function(){return v});var m=d(216),f=d(385),a=d(609),l=d(1646);const r=(z,B,G)=>{const F=w(z,B,G);let K=0,N=0,H=0,J=new l.a;const L=new m.a;for(let I=0;I<F.length;I++){const R=F.mg(I+1);J.Lqd(z.mg(K));
J.Oqd(B.mg(N));J.Tqd(G.mg(H));K++;N++;for(H++;K<z.length&&(!R||!R.equals(z.mg(K)));)J.Lqd(z.mg(K)),K++;for(;N<B.length&&(!R||!R.equals(B.mg(N)));)J.Oqd(B.mg(N)),N++;for(;H<G.length&&(!R||!R.equals(G.mg(H)));)J.Tqd(G.mg(H)),H++;L.add(J);J=new l.a}for(;K<z.length;)J.Lqd(z.mg(K)),K++;for(;N<B.length;)J.Oqd(B.mg(N)),N++;for(;H<G.length;)J.Tqd(G.mg(H)),H++;J.isEmpty||L.add(J);return L},w=(z,B,G)=>{const F=new m.a,K=B.UF(),N=G.UF();z.forEach(H=>{K.contains(H)&&N.contains(H)&&F.add(H);return!0});return F},
v=(z,B,G)=>{z=z||new m.a;B=B||new m.a;G=G||new m.a;const F=new m.a,K=new f.a(0),N=new a.a;for(var H=0;H<z.length;H++){var J=z.mg(H);K.Z(J,H)}for(z=H=0;H<B.length&&z<G.length;){J=B.mg(H);let L=G.mg(z),I=K.Ey(J,-1),R=K.Ey(L,-1);-1===I?(u(N,F,J),H++):-1===R?(u(N,F,L),z++):I===R?(u(N,F,J),H++,z++):I<R?H++:z++}for(;H<B.length;H++)J=B.mg(H),-1===K.Ey(J,-1)&&u(N,F,J);for(;z<G.length;z++)B=G.mg(z),-1===K.Ey(B,-1)&&u(N,F,B);return F},u=(z,B,G)=>{z.contains(G)||(B.add(G),z.add(G))}},1520:function(D,M,d){d.d(M,
"a",function(){return f});D=d(0);var m=d(59);class f{constructor(){this.cp=0;this.id=m.a.create()}}Object(D.a)(f,"LcsUpdateHint",null,[1284,360])},1523:function(D,M,d){D=d(0);var m=d(17),f=d(5),a=d(216),l=d(150),r=d(205),w=d(59),v=d(609),u=d(43),z=d(250),B=d(1536);class G extends B.a{constructor(){super();this.mIb=null}get Yda(){return"CreateMergeBlock"}Hzb(){this.detail.Z("Type",this.Yda);this.detail.Z("Revision",this.mIb);return this.detail}}Object(D.a)(G,"CreateMergeBlockFailureDetail",B.a,[]);
var F=d(1573),K=d(1575),N=d(1645),H=d(1537),J=d(1493),L=d(1698);d.d(M,"a",function(){return I});class I{static Dwd(R,C,P,W,X,V,Y){let ca;ca="";const fa=new a.a;for(let ia=0;ia<P.length;ia++){var sa=void 0;let ea;sa=F.a.$ll(C,P.J(ia),W,X,V,Y,R);if(!sa)return{returnValue:null,R_a:ca};({tyf:ea,R_a:sa}=sa.PSh());if(!ea)return{returnValue:null,R_a:ca};ca+=sa;fa.uA(fa.length,ea)}return{returnValue:fa,R_a:ca}}static Hsh(R,C,P,W,X,V,Y,ca){let fa,sa,ia,ea,da,ja;ja=da=ea=ia=sa=fa=null;({R_a:ea,returnValue:fa}=
I.Dwd(C,Ga=>R.runtime.jk.J(Ga),P,1,V,Y,ca));if(!fa)return l.a.instance.Ya(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),R.logger.Pg(Object.assign(new G,{mIb:"Base"})),{returnValue:!1,FJ:fa,eFc:sa,s2c:ia,Grd:ea,aBd:da,Vae:ja};({R_a:da,returnValue:sa}=I.Dwd(C,Ga=>R.runtime.Vt.J(Ga)||R.runtime.jk.J(Ga),W,2,V,Y,ca));if(!sa)return l.a.instance.Ya(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),
R.logger.Pg(Object.assign(new G,{mIb:"Favored"})),{returnValue:!1,FJ:fa,eFc:sa,s2c:ia,Grd:ea,aBd:da,Vae:ja};({R_a:ja,returnValue:ia}=I.Dwd(C,Ga=>R.runtime.kq.J(Ga)||R.runtime.jk.J(Ga),X,4,V,Y,ca));return ia?{returnValue:!0,FJ:fa,eFc:sa,s2c:ia,Grd:ea,aBd:da,Vae:ja}:(l.a.instance.Ya(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),R.logger.Pg(Object.assign(new G,{mIb:"Unfavored"})),{returnValue:!1,
FJ:fa,eFc:sa,s2c:ia,Grd:ea,aBd:da,Vae:ja})}static Umh(R,C=!1){const P=new a.a;let W=0;for(;W<R.length;){var X=R.J(W);if(1===X.type||4===X.type||2===X.type)P.add(X),W++;else if(3===X.type){let Y="";Y+=X.character;W++;let ca=X.kMa,fa=!1;for(;W<R.length;W++){var V=R.J(W);3===V.type?X.runId===V.runId&&X.cI.equals(V.cI)&&(X.p$===V.p$||X.$Aa===V.$Aa)&&X.lE.Lz(V.lE)&&(!C||X.rt&&X.rt.equals(V.rt))?(Y+=V.character,V.kMa&&(ca=!0)):fa=!0:fa=!0;if(fa){X=new L.a(null,X.source,X.Bj,X.Cg,X.runId,X.cI,Y,X.phb,!0,
ca,X.p$,X.$Aa,X.ZNa,X.lE,X.rt);P.add(X);break}}}}l.a.instance.Ya(17044302,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",P.Cq());return P}static jyk(R,C=!1){const P=new a.a;let W=0;for(;W<R.length;){var X=R.J(W);if(1===X.type||4===X.type||2===X.type)P.add(X),W++;else if(3===X.type){let Y=X.character.toString();W++;let ca=X.kMa;for(;W<R.length;W++){var V=R.J(W);if(3===V.type&&I.pRn(X,V,C))Y+=V.character,V.kMa&&(ca=!0);else break}X=new L.a(null,X.source,X.Bj,X.Cg,
X.runId,X.cI,Y,X.phb,!0,ca,X.p$,X.$Aa,X.ZNa,X.lE,X.rt);P.add(X)}}l.a.instance.Ya(50931345,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",P.Cq());return P}static pRn(R,C,P){return R.runId===C.runId&&R.cI.equals(C.cI)&&(R.p$===C.p$||R.$Aa===C.$Aa)&&R.lE.Lz(C.lE)&&(!P||!!R.rt&&R.rt.equals(C.rt))}static lLn(R,C,P,W,X,V,Y,ca,fa,sa,ia,ea,da,ja,Ga,ya){R.setPropertyString(P.im,m.a.lo,X);R.setPropertyUint32(P.im,f.a.Mc,W);R.setPropertyUint32s(P.im,f.a.Fq,V);R.setPropertyUint32s(P.im,
f.a.Zs,Y);R.setPropertyObjectIds(P.im,m.a.Un,fa);R.hasProperty(P.im,f.a.mj)&&R.setPropertyUint32(P.im,f.a.mj,I.qdl());C&&C(10)&&R.setPropertyObjectIds(P.im,f.a.Su,ya);W=!1;for(X=0;X<sa.length;X++)if(sa.J(X)){W=!0;break}W&&R.setPropertyBools(P.im,f.a.qCf,sa);I.lnk(C,R,P,ia,ea,da,ja);I.mnk(R,P,Ga);P.fB(m.a.lo);P.fB(f.a.Mc);P.fB(f.a.Fq);P.fB(f.a.Zs);P.fB(m.a.Un);P.fB(f.a.qCf);P.fB(m.a.zm);P.fB(m.a.Dkb);P.fB(f.a.pLa);P.fB(f.a.gDa);P.fB(m.a.cua);P.fB(f.a.Su);R.hasProperty(P.im,f.a.mj)&&P.fB(f.a.mj);0<
ca.length?R.setPropertyUint32s(P.im,m.a.zm,ca):P.im.removeProperty(m.a.zm)}static lnk(R,C,P,W,X,V,Y){if(R(106)){R=W.contains(!0,(ca,fa)=>fa);I.tXf(C,P,m.a.cua,R?W:null);I.tXf(C,P,m.a.Dkb,I.bQi(W,X));I.tXf(C,P,f.a.pLa,I.bQi(W,V));W=!1;for(X=0;X<Y.length;X++)0!==Y.J(X)&&(W=!0);W?C.setPropertyUint32s(P.im,f.a.gDa,Y):P.im.removeProperty(f.a.gDa)}}static mnk(R,C,P){const W=Y=>Y;var X=Object(u.a)(R,R.setPropertyBools,"setPropertyBools");I.gJa(C,P.Yeb,W,X,f.a.yBa);I.gJa(C,P.kbb,W,X,f.a.Mda);I.gJa(C,P.V0a,
W,X,f.a.fDa);X=Y=>0<Y.length;var V=Object(u.a)(R,R.setPropertyStrings,"setPropertyStrings");I.gJa(C,P.Xeb,X,V,f.a.zBa);I.gJa(C,P.jbb,X,V,f.a.Oza);I.gJa(C,P.Cib,X,V,f.a.zEa);X=Y=>!!Y;V=Object(u.a)(R,R.setPropertyListOfMilliseconds,"setPropertyListOfMilliseconds");I.gJa(C,P.Zeb,X,V,f.a.ABa);I.gJa(C,P.yWa,X,V,f.a.Pza);I.gJa(C,P.Eib,X,V,f.a.AEa);P.V0a.any(W)?I.gJa(C,P.Dib,()=>!0,Object(u.a)(R,R.setPropertyObjectIds,"setPropertyObjectIds"),f.a.Hva):C.im.removeProperty(f.a.Hva)}static bQi(R,C){const P=
new a.a;let W=!1;for(let X=0;X<R.length;X++){const V=C.J(X)&&!R.J(X);P.add(V);W=V||W}return W?P:null}static tXf(R,C,P,W){W?R.setPropertyBools(C.im,P,W):C.im.removeProperty(P)}static qdl(){return r.a.JF()}static KTh(R,C){return R.runtime.Vt.Ey(C,R.runtime.jk.J(C)||R.runtime.kq.get(C))}static WHc(R,C,P,W,X){let V;V=new a.a;const Y=!!P&&P(10);if(R.runtime.Pb.isFeatureEnabled(81)){var ca=I.jyk(W,Y);var fa=I.Umh(W,Y);ca.length!==fa.length&&R.runtime.Pb.Uq(81)}else ca=I.Umh(W,Y);fa=0;let sa="",ia=new a.a,
ea=new a.a,da=new a.a,ja=new a.a,Ga=new a.a,ya=new a.a,ta=new a.a,ua=new a.a,Sa=new a.a;const ka=new N.a;let ha=new a.a;var Ca=ca.J(ca.length-1);if(2!==Ca.type&&4!==Ca.type)return l.a.instance.Ya(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",Ca.type),R.logger.Pg(Object.assign(new H.a,{kj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",Ca.type)})),{returnValue:!1,
ZYd:V};var Pa=0;for(Ca=0;Ca<ca.length;Ca++){var Xa=ca.J(Ca),qa=null;if(1===Xa.type||3===Xa.type)qa=Xa,sa+=qa.text;else if(4===Xa.type){Xa=I.KTh(R,Xa.Bj);Xa=new J.a(Xa);V.add(Xa);continue}qa?(ia.add(qa.runId),ea.add(qa.Cg),Pa+=qa.text.length,da.add(Pa),ja.add(qa.cI),Ga.add(qa.phb),ya.add(qa.kMa),ta.add(qa.p$),ua.add(qa.$Aa),Sa.add(qa.ZNa),ka.Yeb.add(qa.lE.oUl),ka.kbb.add(qa.lE.RTl),ka.V0a.add(qa.lE.OUl),ka.Xeb.add(qa.lE.insertion.author),ka.jbb.add(qa.lE.deletion.author),ka.Cib.add(qa.lE.eDa.author),
ka.Zeb.add(qa.lE.insertion.mRc),ka.yWa.add(qa.lE.deletion.mRc),ka.Eib.add(qa.lE.eDa.mRc),ka.Dib.add(qa.lE.eDa.sLf),Y&&ha.add(qa.rt)):ia.length||(ia.add(0),ea.add(0),da.add(0),ja.add(w.a.nil),Ga.add(!1),ya.add(!1),ta.add(!1),ua.add(!1),Sa.add(0),ka.Yeb.add(!1),ka.kbb.add(!1),ka.V0a.add(!1),ka.Xeb.add(""),ka.jbb.add(""),ka.Cib.add(""),ka.Zeb.add(0),ka.yWa.add(0),ka.Eib.add(0),ka.Dib.add(w.a.nil));if(2===Xa.type){Pa=Xa;Xa=Pa.Mc;da.eF(da.length-1);qa=X.J(fa);if(!qa)return l.a.instance.Ya(17044307,1,2,
"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",fa,X.length,W.length,Ca,ca.length),R.logger.Pg(Object.assign(new H.a,{kj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),l.a.instance.Xga(17044308,1,4,"GetMergeableObjectsFromMergeBlocks Paragraphs",X.Cq()),l.a.instance.Xga(17044309,1,4,"GetMergeableObjectsFromMergeBlocks MergeBlocks",
W.Cq()),l.a.instance.Xga(17044310,1,4,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",ca.Cq()),{returnValue:!1,ZYd:V};if(qa=I.KTh(R,qa))qa=new J.a(qa.xG()),I.lLn(C,P,qa,Pa.Mc,sa,ia,ea,da,ja,Ga,ya,ta,ua,Sa,ka,ha),V.add(qa);l.a.instance.Ya(17044312,1,4,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",Pa.Bj,Xa,ia.Cq(),ea.Cq(),
da.Cq(),ya.Cq(),ta.Cq(),ua.Cq(),ja.Cq(),"",Sa.Cq());fa++;sa="";ia=new a.a;ea=new a.a;da=new a.a;ja=new a.a;Ga=new a.a;ya=new a.a;ta=new a.a;ua=new a.a;Sa=new a.a;ka.reset();Pa=0;ha=new a.a}}return{returnValue:!0,ZYd:V}}static Yun(R,C){const P=R.runtime.Lm.J(z.a.wK),W=C.getPropertyObjectIds(P.im,f.a.L_);for(let X=0;X<W.length;X++)R.runtime.Lm.remove(W.J(X));C.setPropertyObjectIds(P.im,f.a.L_,new a.a);C.setPropertyString(P.im,f.a.hQa,w.a.nil.toString());P.fB(f.a.L_);P.fB(f.a.hQa)}static t2l(R,C){if(R.runtime.Lm.xb(z.a.wK))return null;
const P=new J.a(R.runtime.jk.J(z.a.wK).xG());C.setPropertyString(P.im,f.a.hQa,R.output.QL.last().id.toString());C.setPropertyObjectIds(P.im,f.a.L_,new a.a);P.fB(f.a.L_);P.fB(f.a.hQa);R.runtime.Lm.Z(z.a.wK,P);return P}static bef(R){const C=new a.a;R.forEach(P=>{C.add(P.id);return!0});return C}static s8b(R,C,P,W){let X=0;P.forEach(V=>{K.a(V,C+X++,1);393230===V.Qc&&R.getPropertyObjectIds(V,m.a.Un).forEach(Y=>{W.add(Y);return!0});return!0})}static gvm(R,C){const P=new v.a;let W=0;C.forEach(X=>{if(P.contains(X))return!0;
P.add(X);if(({index:W}=I.cwf("BaseFormatting_",W,X,V=>R.runtime.jk.J(V))).returnValue||({index:W}=I.cwf("FavoredFormatting_",W,X,V=>R.runtime.Vt.J(V))).returnValue||({index:W}=I.cwf("ConflictingFormatting_",W,X,V=>R.runtime.kq.J(V))).returnValue)return!0;W++;return!0})}static cwf(R,C,P,W){if(P=W(P))if(K.a(P,R+C,1),1179649===P.Qc)return C++,{returnValue:!0,index:C};return{returnValue:!1,index:C}}static O3e(R){return!!R.runtime.jk.J(z.a.wK)}static gJa(R,C,P,W,X){C.any(P)?(W(R.im,X,C),R.fB(X)):R.im.removeProperty(X)}static eZi(R,
C){const P=new a.a;P.add(0);const W=R?R.length:0;for(let X=0;X<W;X++)P.insert(X+1,R.mg(X));P.insert(P.length,C);return P}}Object(D.a)(I,"ParagraphMergeUtils",null,[])},1534:function(D,M,d){d.d(M,"a",function(){return f});D=d(0);var m=d(216);class f{constructor(a,l,r){this.mm=null;this.El=a;this.source=l;this.Bj=r}get type(){return this.El}get T2a(){return!1}get Lbm(){return 1===(this.source&1)}get Mbm(){return 2===(this.source&2)}get Nbm(){return 4===(this.source&4)}z2(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",
this.phl(),this.B1b())}phl(){let a="";this.Lbm&&(a+="Base");this.Mbm&&(a+="FavoredUpdate");this.Nbm&&(a+="UnfavoredUpdate");return a}B1b(){return""}Lz(a){return this.type===a.type}j0c(){const a=new m.a;a.add(this);return a}get length(){return 0}}Object(D.a)(f,"AMergeBlock",null,[70,71])},1535:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);d=d(1534);class m extends d.a{constructor(f,a,l){super(2,f,a);this.Mc=l}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),
this.Mc,this.Bj)}B1b(){return"Eop"}clone(){return new m(this.source,this.Bj,this.Mc)}Lz(f,a,l,r=!1,w=!0){return super.Lz(f,a,l,r)?w?f.Mc===this.Mc:f.Bj===this.Bj&&f.Mc===this.Mc:!1}get length(){return 1}}Object(D.a)(m,"EopMergeBlock",d.a,[])},1536:function(D,M,d){d.d(M,"a",function(){return f});D=d(0);var m=d(385);class f{constructor(){this.detail=new m.a}}Object(D.a)(f,"AMergeFailureDetail",null,[1872])},1537:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);d=d(1492);class m extends d.a{constructor(){super()}get Yda(){return"ParagraphMerge"}}
Object(D.a)(m,"ParagraphMergeFailureDetail",d.a,[])},1538:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);d=d(1492);class m extends d.a{constructor(){super()}get Yda(){return"RdOpLcs"}}Object(D.a)(m,"ReducedOpsLcsFailureDetail",d.a,[])},1539:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);d=d(1492);class m extends d.a{constructor(){super()}get Yda(){return"TableMerge"}}Object(D.a)(m,"TableMergeFailureDetail",d.a,[])},1542:function(D,M,d){D=d(0);class m{constructor(){this.D1c=this.DLc=
null;this.ayf=this.score=this.VQc=0}hJf(F,K,N){this.score=F.J(K);++K;this.DLc=F.J(K)?N.Tka(F.J(K)):null;++K;this.D1c=F.J(K)?N.Tka(F.J(K)):null;++K;this.VQc=F.J(K);++K;this.ayf=F.J(K);++K;return K}}Object(D.a)(m,"TokenStringGeneratorInit",null,[]);class f{constructor(F,K,N,H,J){this.ncb=F;this.count=K;this.UBd=N;this.EN=H;this.depth=J}}Object(D.a)(f,"ErrorTolerantTrieMatch",null,[]);var a=d(1587),l=d(1663);class r{constructor(F=null,K=0,N=0,H=0){this.TWj=F||new l.a;this.qsa=K;this.EN=N;this.depth=
H}get D3(){return this.TWj}getKey(){return this.D3.Pw.toString()+":"+this.qsa.toString()}}Object(D.a)(r,"TrieBookmark",null,[]);class w{constructor(F,K){this.ZMa=F;this.hxf=K}SAm(F){if(null==F)throw Error.argumentNull("prefix");let K={};var N=K[""]=new r;this.zKd(N,K);for(N=0;N<F.length;++N){const H=F.charCodeAt(N),J={};for(let L in K)this.S8j(H,K[L],J);K=J}return this.g9n(K)}zKd(F,K){if(!(F.EN>=this.hxf)&&(F=new r(a.a.YVe(F.D3),F.qsa,F.EN+1,F.depth),F.D3.qE&a.a.t4a&&(F.qsa+=1),this.ZMa.bLb(F.D3))){F.depth+=
1;let N=!0;for(;N;)w.Cbe(F,K),this.zKd(F,K),F.qsa+=this.ZMa.R1b(F.D3,!0)+(F.D3.qE&a.a.t4a?1:0),N=this.ZMa.Y1c(F.D3)}}S8j(F,K,N){K.EN+1<=this.hxf&&(K.EN+=1,w.Cbe(K,N),--K.EN);K.D3.qE&a.a.t4a&&(K.qsa+=1);if(this.ZMa.bLb(K.D3)){K.depth+=1;let H=!0;for(;H;)K.D3.dMb===F?(w.Cbe(K,N),this.zKd(K,N)):K.EN+1<=this.hxf&&(K.EN+=1,w.Cbe(K,N),this.zKd(K,N),--K.EN),K.qsa+=this.ZMa.R1b(K.D3,!0)+(K.D3.qE&a.a.t4a?1:0),H=this.ZMa.Y1c(K.D3)}}g9n(F){const K=[];for(var N in F){const H=F[N];if(!H.D3.Pw)continue;const J=
!!(H.D3.qE&a.a.t4a),L=this.ZMa.R1b(H.D3,!1)+(J?1:0);Array.add(K,new f(H.qsa,L,J,H.EN,H.depth))}K.sort((H,J)=>{let L=H.ncb-J.ncb;return L||(L=-(H.count-J.count))?L:L=H.depth-J.depth});if(2>K.length)return K;F=[];for(N=0;N<K.length;)N+=w.Naj(N,K,F);return F}static Cbe(F,K){const N=F.getKey();N in K?(K=K[N],K.EN=Math.min(K.EN,F.EN)):K[N]=new r(a.a.YVe(F.D3),F.qsa,F.EN,F.depth)}static Naj(F,K,N){const H=K[F];let J=H.ncb;const L=J+H.count;let I=1,R=H.UBd;for(;F+I<K.length&&K[F+I].ncb<L;){const C=K[F+I];
C.ncb>J&&(Array.add(N,new f(J,C.ncb-J,R,H.EN,H.depth)),R=!1);I+=w.Naj(F+I,K,N);J=C.ncb+C.count}J<L&&Array.add(N,new f(J,L-J,R,H.EN,H.depth));return I}}Object(D.a)(w,"ErrorTolerantTrieLookupEngine",null,[1281]);class v extends m{constructor(F,K,N){super();this.z5h=this.Hzi=!1;this.qDh=null;if(F){var H=0;try{H=this.hJf(F,H,K);this.Hzi=1===F.J(H);++H;this.z5h=1===F.J(H);++H;const J=F.J(H);this.qDh=this.E0m(N,J)}catch(J){throw Error.argument("initData");}}}E0m(F,K){return new w(F,K)}}Object(D.a)(v,"FuzzyMatchTokenStringGeneratorInit",
m,[]);class u extends m{constructor(F,K){super();this.query=this.name=null;if(F){this.annotations=K.annotations;var N=0;try{N=this.hJf(F,N,K),this.name=K.getString(F.J(N)),++N,this.query=K.QJ(F.J(N))}catch(H){throw Error.argument("initData");}}}}Object(D.a)(u,"QueryTokenStringGeneratorInit",m,[]);class z extends m{constructor(F,K){super();if(F)try{this.hJf(F,0,K)}catch(N){throw Error.argument("initData");}}}Object(D.a)(z,"SurfaceStringTokenStringGeneratorInit",m,[]);var B=d(1482);d.d(M,"a",function(){return G});
class G{constructor(F){this.Ywf=F}get DLc(){return this.Ywf.DLc}get D1c(){return this.Ywf.D1c}get VQc(){return this.Ywf.VQc}static create(F,K,N){const {SurfaceStringTokenStringGenerator:H}=d(1794),{QueryTokenStringGenerator:J}=d(1795),{FuzzyMatchTokenStringGenerator:L}=d(1796);let I=0;try{if(F.J(I)!==G.Jvb)throw Error.argument("initData","Input does not represent a token string generator");++I;const R=F.J(I);++I;const C=new B.a;C.Acb(F,I,F.count-I);switch(R){case H.mzc:return new H(new z(C,K));case J.mzc:return new J(new u(C,
K));case L.mzc:return new L(new v(C,K,N));default:throw Error.argument("initData");}}catch(R){throw Error.argument("initData");}}static V7g(F,K,N,H,J,L){F=F.C7n.getId(K,null);if(0>F)return++L,L;G.W7g(F,N,H,J);return L}static W7g(F,K,N,H){Array.add(H.r1f,F);Array.add(H.b7i,K);++H.Sfc[N]}}G.Jvb=1099767983;Object(D.a)(G,"TokenStringGenerator",null,[1249])},1572:function(D,M,d){d.d(M,"a",function(){return a});D=d(0);var m=d(216);M=d(1534);var f=d(1505);class a extends M.a{constructor(l,r,w){super(l,r,
w)}mZn(l){let r;r=null;if(!this.text||!this.T2a||0>=l||l>=this.length)return{returnValue:!1,B5i:r};r=new m.a;const w=this.clone();w.b_c(f.a.Lkb(this.text,0,l));const v=this.clone();v.b_c(f.a.Lkb(this.text,l,this.length-l));r.add(w);r.add(v);return{returnValue:!0,B5i:r}}z2(){return!0}get length(){return this.text.length}}Object(D.a)(a,"ATextMergeBlock",M.a,[])},1573:function(D,M,d){d.d(M,"a",function(){return f});D=d(0);var m=d(150);class f{yPe(a,l){return a+("[Block: "+l+"] ")}static $ll(a,l,r,w,
v,u,z){const {ParagraphMergeBlockCreator:B}=d(1832),{TableMergeBlockCreator:G}=d(1835);if(393230===l.Qc)return new B(a,l,r,v,u,w(10),z);if(393250===l.Qc)return new G(l,r);m.a.instance.Ya(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",l.Qc);return null}}Object(D.a)(f,"MergeBlockCreator",null,[])},1574:function(D,M,d){d.d(M,"a",function(){return l});D=d(0);var m=d(5),f=d(59);M=d(1572);var a=d(1510);class l extends M.a{constructor(r,w,v,u,z,B,G,F,K,N,H,J,L,I){super(w,
v,u);this.Cg=z;this.runId=B;this.phb=F;this.zCj=G;this.cge=r;this.kMa=K;this.p$=N;this.$Aa=H;this.ZNa=J;this.lE=L;this.rt=I}get Wxc(){return this.cge}get cI(){return this.zCj}get azb(){return this.Wxc(this.cI)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",super.toString(),this.Cg,this.runId,this.phb,this.Bj,this.cI.toString(),this.rt?this.rt.toString():"NULL")}Lz(r,w,v,u=!1){if(!super.Lz(r,w,v,u))return!1;if(u)return!0;
if(!this.lE.Lz(r.lE)||this.rt&&!this.rt.equals(r.rt))return!1;if(this.cI.equals(r.cI)||this.cI.equals(f.a.nil)||r.cI.equals(f.a.nil))return!0;r=new a.a(this.azb,r.azb);w=w.ksh(this.azb,v);return r.KMc(w.E_d)?!1:!0}get K7l(){return this.z2()&&"\ufffc"===this.text&&this.azb?this.azb.hasProperty(m.a.gq)||1179725!==this.azb.Qc?!0:!1:!1}}Object(D.a)(l,"AUserRunMergeBlock",M.a,[])},1575:function(D,M,d){d.d(M,"a",function(){return f});var m=d(150);const f=(a,l,r=4)=>{a?m.a.instance.Xga(4273285,r,4,l,a.w1c()):
m.a.instance.Ya(4293845,r,1,l,"{0}: Node was null.",l)}},1576:function(D,M,d){d.d(M,"e",function(){return w});d.d(M,"a",function(){return v});d.d(M,"d",function(){return u});d.d(M,"b",function(){return z});d.d(M,"c",function(){return B});var m=d(5),f=d(17),a=d(59),l=d(992),r=d(1519);const w=(K,N,H)=>{const J=new l.a;let L=a.a.nil;N=J.getPropertyObjectId(N,m.a.Vkb);N.equals(a.a.nil)||(K=K.runtime.jk.J(N),H&&(K=H.Ey(N,K)),K&&(L=J.getPropertyObjectId(K,m.a.Vkb)));return L},v=(K,N,H,J,L)=>{const I=new l.a;
let R=null;var C=I.getPropertyObjectId(H,m.a.Vkb);C!==a.a.nil&&(R=K.runtime.jk.J(C),N&&(R=N.Ey(C,R)));if(R){C=I.getPropertyObjectIds(R,f.a.rf);for(L=0;L<C.length&&!C.J(L).equals(H.id);L++);L===C.length&&(L=-1)}H=w(K,H,N);if(!H.equals(a.a.nil)&&(K=K.runtime.jk.J(H),N&&(K=N.Ey(H,K)),K)){N=I.getPropertyObjectIds(K,f.a.rf);for(J=0;J<N.length&&!N.J(J).equals(R.id);J++);J===N.length&&(J=-1)}return{rowIndex:J,KYb:L}},u=(K,N,H,J,L)=>{var I=new l.a;let R=null;var C=K.runtime.jk.J(H);N&&(C=N.Ey(H,C));if(!C)return null;
C=I.getPropertyObjectIds(C,f.a.rf);H=null;J<C.length&&(J=C.J(J),H=K.runtime.jk.J(J),N&&(H=N.Ey(J,H)));H&&(I=I.getPropertyObjectIds(H,f.a.rf),L<I.length&&(L=I.J(L),R=K.runtime.jk.J(L),N&&(R=N.Ey(L,R))));return R},z=(K,N,H)=>{let J,L;L=J=-1;const I=(new l.a).getPropertyObjectId(H,m.a.Vkb);var R=w(K,H,N);if(R.equals(a.a.nil)||I.equals(a.a.nil))return{rowIndex:J,KYb:L};N=K.runtime.A2f;var C=N.J(R);if(!C){C=G(K,R);if(!C)return{rowIndex:J,KYb:L};N.Z(R,C)}for(R=0;R<C.length;R++)if(C.J(R).equals(I)){J=R;
break}C=N.J(I);if(!C){C=F(K,I);if(!C)return{rowIndex:J,KYb:L};N.Z(I,C)}for(K=0;K<C.length;K++)if(C.J(K).equals(H.id)){L=K;break}return{rowIndex:J,KYb:L}},B=(K,N,H,J)=>{if(0>H||0>J)return a.a.nil;new l.a;const L=K.runtime.A2f;let I=L.J(N);if(!I){I=G(K,N);if(!I)return a.a.nil;L.Z(N,I)}if(H<I.length)N=I.J(H);else return a.a.nil;H=L.J(N);if(!H){H=F(K,N);if(!H)return a.a.nil;L.Z(N,H)}if(J<H.length)K=H.J(J);else return a.a.nil;return K},G=(K,N)=>{var H=new l.a;const J=K.runtime.jk.J(N);if(J){var L=K.runtime.Vt.Ey(N,
J);K=K.runtime.kq.Ey(N,J);N=H.getPropertyObjectIds(J,f.a.rf);L=H.getPropertyObjectIds(L,f.a.rf);H=H.getPropertyObjectIds(K,f.a.rf);return N.Dp(L,(I,R)=>I.equals(R))?H:N.Dp(H,(I,R)=>I.equals(R))?L:r.a(N,L,H,(I,R)=>I.equals(R))}return(L=K.runtime.Vt.J(N))?H.getPropertyObjectIds(L,f.a.rf):(L=K.runtime.kq.J(N))?H.getPropertyObjectIds(L,f.a.rf):null},F=(K,N)=>{var H=new l.a;const J=K.runtime.jk.J(N);if(J){var L=K.runtime.Vt.Ey(N,J);K=K.runtime.kq.Ey(N,J);N=H.getPropertyObjectIds(J,f.a.rf);L=H.getPropertyObjectIds(L,
f.a.rf);H=H.getPropertyObjectIds(K,f.a.rf);return N.Dp(L,(I,R)=>I.equals(R))?H:N.Dp(H,(I,R)=>I.equals(R))?L:null}return(L=K.runtime.Vt.J(N))?H.getPropertyObjectIds(L,f.a.rf):(L=K.runtime.kq.J(N))?H.getPropertyObjectIds(L,f.a.rf):null}},1577:function(D,M,d){d.d(M,"a",function(){return f});D=d(0);var m=d(1456);d=d(2);class f{static Vjm(){return!m.a.ybi()&&!m.a.gDb()&&f.isFeatureEnabled(0)}static Ifi(){return f.isFeatureEnabled(1)}static Tci(){return f.isFeatureEnabled(2)}static isFeatureEnabled(a){return!!(f.qBj&
1<<a)}}f.qBj=d.AFrameworkApplication.K?d.AFrameworkApplication.K.rc("TellMeFeatureConfigValue",0):0;Object(D.a)(f,"TellMeFeatureAvailability",null,[])},1578:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);d=d(1461);class m extends d.a{constructor(f,a,l,r,w=null){super(f,a,w,null,l);this.id=r}}Object(D.a)(m,"TryQueryResultBinding",d.a,[])},1579:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f){this.Ab=f}get g0a(){return this.Ab.g0a}get e2n(){return 4!==this.Ab.style}get g2n(){return!0}get trie(){return this.Ab.trie}getId(f,
a){if(!this.e2n)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Ab.style){case 0:return this.Rsl(f,a);default:throw Error.notImplemented();}}getString(f){if(!this.g2n)throw Error.invalidOperation("String lookup not supported on this string table");if(0>f||f>=this.g0a)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Ab.style){case 0:return this.bIl(f);case 4:return this.aIl(f);default:throw Error.notImplemented();}}Rsl(f,a){f=this.Ab.trie.tmi(f,
0,f.length,a);if(!f.succeeded)return-1;if(0>f.fgc||f.fgc>=this.Ab.g0a)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Ab.Z1c?this.Ab.bWc.Zx(this.Ab.Z1c+4*f.fgc,4):f.fgc}bIl(f){if(this.Ab.Z1c){let a=0;for(;a<this.Ab.g0a&&this.Ab.bWc.Zx(this.Ab.Z1c+4*a,4)!==f;++a);if(a>=this.Ab.g0a)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Ab.trie.aYh(a)}return this.Ab.trie.aYh(f)}aIl(f){const a=this.Ab.bWc.Zx(this.Ab.Z6i+4*f,4);f=
this.Ab.bWc.Zx(this.Ab.$6i+4*f,4);if(0>f||0>a)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const l=Array(a);for(let r=0;r<a;++r)l[r]=({$Xl:f}=this.Vdn(f)).returnValue;return String.fromCharCode.apply(null,l)}Vdn(f){let a=0;for(let l=0;3>l;++l){const r=this.Ab.bWc.J(this.Ab.Njh+f)^182;++f;a|=(r&127)<<7*l;if(!(r&128))break}return{returnValue:a,$Xl:f}}}Object(D.a)(m,"StringTable",null,[1239])},1580:function(D,M,d){d.d(M,"a",function(){return f});D=d(0);var m=d(1587);
class f{constructor(a){this.trie=null;this.Njh=this.Z6i=this.$6i=this.Z1c=0;if(a){this.bWc=a;var l=0;if(a.Zx(l,4)!==f.Jvb)throw Error.argument("bytes","Input does not represent a string table");l+=4;this.g0a=a.Zx(l,4);l+=4;this.style=a.Zx(l,4);l+=4;switch(this.style){case 0:const r=1===a.Zx(l,4);l+=4;r||(this.Z1c=l,l+=4*this.g0a);a.Zx(l,4);this.trie=this.e1m(a,l+4);break;case 4:this.$6i=l;this.Z6i=l+=4*this.g0a;l+=4*this.g0a;a.Zx(l,4);this.Njh=l+4;break;default:throw Error.argument("bytes");}}}e1m(a,
l){return new m.a(a,l)}}f.Jvb=1025118440;Object(D.a)(f,"StringTableInit",null,[])},1581:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);var m;(function(f){f[f.Answer=0]="Answer";f[f.Definition=1]="Definition";f[f.Entity=2]="Entity";f[f.WolframAnswer=3]="WolframAnswer";f[f.Assistance=4]="Assistance";f[f.Command=5]="Command";f[f.Document=6]="Document";f[f.TryQuery=7]="TryQuery";f[f.FindInDocument=8]="FindInDocument";f[f.HelpAction=9]="HelpAction";f[f.Insights=10]="Insights";f[f.People=11]="People";
f[f.Image=12]="Image";f[f.FirstRunResult=13]="FirstRunResult";f[f.NoCommandsFoundResult=14]="NoCommandsFoundResult";f[f.TestResult=15]="TestResult";f[f.AppsForOffice_Installed=16]="AppsForOffice_Installed";f[f.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";f[f.AppsForOffice_Query=18]="AppsForOffice_Query";f[f.Notes_Onenote=19]="Notes_Onenote";f[f.Notes_Samsung=20]="Notes_Samsung";f[f.Notes_Sticky=21]="Notes_Sticky";f[f.Learning=22]="Learning";f[f.Feedback=23]="Feedback";f[f.Template=
24]="Template";f[f.Addin=25]="Addin";f[f.OfficeScript=26]="OfficeScript";f[f.Unknown=27]="Unknown"})(m||(m={}));Object(D.b)("ResultType",m)},1584:function(D,M,d){D=d(0);var m=d(5),f=d(609),a=d(150),l=d(216),r=d(59),w=d(385),v=d(72),u;(function(Va){Va[Va.none=0]="none";Va[Va.mergeConflict=1]="mergeConflict";Va[Va.containerBaseIdValidationFailure=2]="containerBaseIdValidationFailure";Va[Va.failedToApplyHints=3]="failedToApplyHints";Va[Va.validateUpdateHintsAreComplete=4]="validateUpdateHintsAreComplete";
Va[Va.other=5]="other"})(u||(u={}));Object(D.b)("ParagraphMergeUsingHintsFailureReason",u);var z=d(992),B=d(250),G=d(875);const F=Va=>{const oa=new l.a;Va.forEach(pa=>{oa.add(pa);return!0});return oa};var K=d(1535),N=d(1519),H=d(1538);const J=(Va,oa)=>{if(Va.length!==oa.length)return!1;for(let pa=0;pa<Va.length;pa++)Va.J(pa).mm=oa.J(pa),oa.J(pa).mm=Va.J(pa);return!0},L=(Va,oa,pa)=>{let Ya,Ja,nb;Ya=0;Ja=!1;nb=0;var Bb;if(!({idx:Bb}=W(Va,oa)).returnValue)return a.a.instance.Ya(18969440,1,5,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",
oa,Va.Cq()),{returnValue:!1,vJc:Ya,lhb:Ja,DRc:nb};if(!pa&&2===Va.J(Bb).type)return{returnValue:!0,vJc:Bb,lhb:Ja,DRc:nb};if(!Va.J(Bb).z2())return a.a.instance.Ya(17044256,1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",Bb,pa,Va.Cq()),{returnValue:!1,vJc:Ya,lhb:Ja,DRc:nb};let mb=!1,Qb=0;for(;Bb<Va.length&&Va.J(Bb).Bj.equals(oa);Bb++){if(pa===Qb){mb=!0;break}if(pa>Qb&&pa<Qb+Va.J(Bb).length){Ja=mb=!0;nb=pa-Qb;break}Qb+=Va.J(Bb).length}mb||
pa!==Qb||(mb=!0);mb&&(Ya=Bb);return{returnValue:mb,vJc:Ya,lhb:Ja,DRc:nb}},I=(Va,oa,pa)=>{let Ya,Ja,nb;nb=Ja=0;Ya=!1;let Bb=0,mb=!1;for(;Ja<Va.length;Ja++){if(oa===Bb){mb=!0;break}if(oa>Bb&&oa<Bb+Va.J(Ja).length){Ya=mb=!0;nb=oa-Bb;break}Bb+=Va.J(Ja).length}mb||oa!==Bb||(mb=!0);mb||(Va=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",Va.length,Bb,oa),a.a.instance.Ya(573178201,1,2,Va),pa.Pg(Object.assign(new H.a,{eventId:"8k6fz",info:Va})));return{returnValue:mb,
lhb:Ya,deh:Ja,ceh:nb}},R=(Va,oa,pa)=>{let Ya;if(Va.J(oa).z2()&&({B5i:Ya}=Va.J(oa).mZn(pa)).returnValue)return Va.uA(oa+1,Ya),Va.eF(oa),!0;a.a.instance.Ya(18969441,1,5,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",oa,pa,Va.Cq());return!1},C=(Va,oa,pa)=>{let Ya,Ja;if(!({vJc:pa,lhb:Ja,DRc:Ya}=L(Va,oa,pa)).returnValue)return{returnValue:!1,index:0};if(!Ja)return{returnValue:!0,index:pa};if(R(Va,pa,Ya))return{returnValue:!0,index:pa+1};a.a.instance.Ya(18969442,
1,5,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",oa,Ya,Va.Cq());return{returnValue:!1,index:0}},P=(Va,oa,pa)=>{let Ya;if(!({lhb:Ya,deh:oa,ceh:pa}=I(Va,oa,pa)).returnValue)return{returnValue:!1,index:0};if(!Ya)return{returnValue:!0,index:oa};if(R(Va,oa,pa))return{returnValue:!0,index:oa+1};a.a.instance.Ya(574433311,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",pa,Va.Cq());return{returnValue:!1,index:0}},W=(Va,oa)=>
{let pa;pa=0;for(let Ya=0;Ya<Va.length;Ya++)if(Va.J(Ya).Bj.equals(oa))return pa=Ya,{returnValue:!0,idx:pa};a.a.instance.Ya(18969443,1,5,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",oa,Va.Cq());return{returnValue:!1,idx:pa}},X=(Va,oa)=>{let pa;pa=-1;for(let Ya=oa;Ya<Va.length;Ya++)if(2===Va.J(Ya).type)return pa=Ya,{returnValue:!0,Wda:pa};a.a.instance.Ya(18969472,1,5,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",oa,Va.Cq());
return{returnValue:!1,Wda:pa}},V=(Va,oa,pa)=>{let Ya;Ya=-1;for(let Ja=pa;Ja<Va.length;Ja++)if(2===Va.J(Ja).type&&Va.J(Ja).Bj.equals(oa))return Ya=Ja,{returnValue:!0,Wda:Ya};a.a.instance.Ya(18969473,1,5,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",oa,pa,Va.Cq());return{returnValue:!1,Wda:Ya}},Y=(Va,oa)=>{let pa;pa=0;var Ya;if(!({idx:Ya}=W(Va,oa)).returnValue)return a.a.instance.Ya(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",
oa,Va),{returnValue:!1,length:pa};for(;Ya<Va.length;Ya++)if(6!==Va.J(Ya).type){if(2===Va.J(Ya).type)return{returnValue:!0,length:pa};a.a.instance.shipAssertTag(17342617,1,Va.J(Ya).z2(),"We found something other than text with type "+Va.J(Ya).type);a.a.instance.shipAssertTag(17877021,1,Va.J(Ya).Bj.equals(oa),"Unexpected GraphNodeId {0} for ParaId {1}",Va.J(Ya).Bj,oa);pa+=Va.J(Ya).length}a.a.instance.Ya(18969474,1,5,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",oa,Va);return{returnValue:!1,
length:pa}},ca=Va=>{const oa=new l.a;for(let pa=0;pa<Va.length;pa++)oa.add(Va.J(pa).clone());return oa};var fa=d(1537),sa=d(1505);class ia{constructor(Va,oa,pa=null,Ya=null){this.Bj=Va;this.type=oa;this.text=pa;this.Mc=Ya}isEqual(Va){return Va.Bj.equals(this.Bj)&&this.type===Va.type&&this.Mc===Va.Mc&&sa.a.fch(this.text,Va.text)}toString(){let Va=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.Bj,this.Mc,this.type);this.text&&(Va+=String.format(" [TextLength: {0}]",this.text.length));
return Va}}Object(D.a)(ia,"MergeBlockValidationState",null,[]);var ea=d(120),da=d(918),ja=d(843),Ga=d(543),ya=d(489),ta=d(917),ua=d(842),Sa=d(1492),ka=d(1653),ha;(function(Va){Va[Va.base=1]="base";Va[Va.favoredUpdate=2]="favoredUpdate";Va[Va.unfavoredUpdate=4]="unfavoredUpdate";Va[Va.min=1]="min";Va[Va.max=7]="max"})(ha||(ha={}));Object(D.b)("MergeBlockSource",ha);class Ca{constructor(Va,oa,pa,Ya){this.Cg=Va;this.cp=oa;this.Frd=pa;this.$2c=Ya}}Object(D.a)(Ca,"MergedListBlocksWithUpdatedFormattingIds",
null,[]);var Pa=d(1534);class Xa extends Pa.a{constructor(Va,oa){super(6,Va,oa);this.Mc=0}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Bj)}B1b(){return"Selection"}clone(){return new Xa(this.source,this.Bj)}Lz(){return!1}get length(){return 0}}Object(D.a)(Xa,"SelectionMergeBlock",Pa.a,[]);var qa;(function(Va){Va[Va.success=0]="success";Va[Va.selfSplit=1]="selfSplit";Va[Va.noSecondaryBlockToSplit=2]="noSecondaryBlockToSplit";Va[Va.unexpected=3]="unexpected"})(qa||(qa=
{}));Object(D.b)("SplitTwinListResult",qa);var Ea=d(1572);class Ia extends Ea.a{constructor(Va,oa,pa,Ya){super(5,Va,oa);this._text=null;this.b_c(pa);this.wXj=Ya}get text(){return this._text}b_c(Va){this._text=Va}get F2c(){return this.wXj}clone(){return new Ia(this.source,this.Bj,this.text,this.F2c)}get T2a(){return this.text&&this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(D.a)(Ia,"UpdateHintTextMergeBlock",Ea.a,[]);class na{constructor(Va,oa,pa,Ya){this.L0=
!1;this.N8a=new w.a;this.ee=Va;this.S2g=Ya;this.Evg=pa;this._base=oa;this.tle=ca(oa);if(!J(this.base,this.Je))throw a.a.instance.Ya(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),Va.logger.Pg(Object.assign(new Sa.a,{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get Je(){return this.tle}get mergeConflict(){return this.L0}iQe(Va,oa){switch(Va.type){case 1:return this.zbk(Va,oa);case 2:return this.KPe(Va,oa);case 3:return this.rck(Va,
oa);case 4:return this.Qbk(Va);case 5:return this.Rak(Va,oa);case 6:return this.IPe(Va);default:return!1}}hQe(Va,oa){switch(Va.type){case 1:return this.OPe(Va,oa);case 2:return this.JPe(Va,oa);case 3:return this.qck(Va,oa);case 4:return this.Pbk(Va);case 5:return this.Qak(Va,oa);case 6:return this.HPe(Va);default:return{returnValue:!1,Ht:null}}}zbk(Va,oa){let pa;const Ya=({Hea:pa}=this.eEa(Va.Cg,oa,!1,Va.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(0!==Ya&&1!==Ya)return 3!==Ya&&(a.a.instance.Ya(590202197,
1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",ha[oa],qa[Ya]),this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vv"}))),!1;this.L0=!1;oa=new Ia(oa,Va.Cg,Va.text,Va.id);this.tmf(Va,pa,oa);return!0}KPe(Va,oa){let pa,Ya=({Hea:pa}=this.eEa(Va.Cg,oa,!1,Va.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;if(0!==Ya&&1!==Ya)return 3!==Ya&&(a.a.instance.Ya(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",
ha[oa],qa[Ya]),this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;let Ja;({Hea:Ja,returnValue:Ya}=this.eEa(Va.Cg,oa,!1,Va.cp+Va.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(0!==Ya&&1!==Ya)return 3!==Ya&&(a.a.instance.Ya(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",ha[oa],qa[Ya]),this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),
!1;this.L0=!1;this.B1e(Va,pa,Ja);return!0}rck(Va,oa){let pa;const Ya=({Gkf:pa}=this.ZQh(Va,oa,!1)).returnValue;if(0!==Ya&&1!==Ya)return 3!==Ya&&(a.a.instance.Ya(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",ha[oa],qa[Ya]),this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),!1;this.L0=!1;oa=new K.a(oa,Va.nt,Va.Mqa);this.tmf(Va,pa,oa);return!0}Qbk(Va){let oa;if(!({EKd:oa}=this.$Qh(Va,
this.Je,"Derived")).returnValue)return!1;this.B1e(Va,oa,oa+1);return!0}Rak(Va,oa){let pa;if(!({syf:oa,Fkf:pa}=this.OSh(Va,!1,oa)).returnValue)return!1;this.tmf(Va,pa,oa);return!0}IPe(Va){let oa;if(!({DKd:oa}=this.QQh(Va,this.Je,"Derived")).returnValue)return!1;this.B1e(Va,oa,oa+1);return!0}nbh(Va,oa,pa){const Ya=({Hea:oa}=this.eEa(Va,pa,!1,oa,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;if(0!==Ya&&1!==Ya)return 3!==Ya&&(a.a.instance.Ya(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",
ha[pa],qa[Ya]),this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vz"}))),!1;this.L0=!1;Va=new Xa(pa,Va);this.Je.insert(oa,Va);return!0}OPe(Va,oa){var pa=null;if(na.Mai(Va.text.length))return{returnValue:!1,Ht:pa};let Ya,Ja,nb;var Bb=({Hea:Ya,Ysa:Ja,Bda:nb}=this.eEa(Va.Cg,oa,!0,Va.cp,!1,"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(0!==Bb&&2!==Bb)return 3!==Bb&&(a.a.instance.Ya(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",
ha[oa],qa[Bb]),this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,Ht:pa};this.L0=!1;({Wda:Bb}=X(this.Je,Ja));Bb=this.Je.J(Bb).Bj;pa=new Ia(oa,Va.Cg,Va.text,Va.id);oa=new Ia(oa,Bb,Va.text,Va.id);pa.mm=oa;oa.mm=pa;this.base.insert(Ya,pa);this.Je.insert(Ja,oa);pa=new l.a;pa.add(new ya.a(Bb,nb,Va.text,Va.id,Va.Yt));return{returnValue:!0,Ht:pa}}JPe(Va,oa){let pa;pa=null;if(na.Mai(Va.text.length))return{returnValue:!1,Ht:pa};let Ya;var Ja,
nb=({Hea:Ya,Ysa:Bb,Bda:Ja}=this.eEa(Va.Cg,oa,!0,Va.cp,!1,"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(0!==nb){if(2!==nb)return 3!==nb&&(a.a.instance.Ya(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",ha[oa],qa[nb]),this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,Ht:pa};var Bb=0;for({idx:Ja}=W(this.base,Va.Cg);Ja<this.base.length&&Bb<
Va.cp;Ja++)Bb+=this.base.J(Ja).length;Bb-=this.base.J(Ja-1).length;({Ysa:Bb,Bda:Ja,returnValue:nb}=this.eEa(Va.Cg,oa,!0,Bb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==nb)return 3!==nb&&(a.a.instance.Ya(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",ha[oa],qa[nb]),this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,Ht:pa};this.L0=
!1}var mb,Qb;({Hea:mb,Ysa:Qb,Bda:Vb,returnValue:nb}=this.eEa(Va.Cg,oa,!0,Va.cp+Va.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(0!==nb){if(2!==nb)return 3!==nb&&(a.a.instance.Ya(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",ha[oa],qa[nb]),this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,Ht:pa};var Vb=0;for({idx:Qb}=W(this.base,Va.Cg);Qb<
this.base.length&&Vb<Va.cp+Va.text.length;Qb++)Vb+=this.base.J(Qb).length;({Ysa:Qb,Bda:Vb,returnValue:nb}=this.eEa(Va.Cg,oa,!0,Vb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==nb)return 3!==nb&&(a.a.instance.Ya(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",ha[oa],qa[nb]),this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,Ht:pa};this.L0=
!1}oa="";pa=new l.a;for(--Qb;Qb>=Bb;Qb--)if(6!==this.Je.J(Qb).type)if(this.Je.J(Qb).mm)oa=this.Je.J(Qb).text+oa,this.Je.eF(Qb);else{if(5===this.Je.J(Qb).type)nb=Vb-oa.length;else if(2===this.Je.J(Qb).type){if(nb=0,!({length:Vb}=Y(this.Je,this.Je.J(Qb).Bj)).returnValue)return a.a.instance.Ya(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,Ht:pa}}else return a.a.instance.Ya(589898051,
1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,Ht:pa};if(!({Wda:mc}=X(this.Je,Qb+1)).returnValue)return a.a.instance.Ya(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,Ht:pa};var mc=this.Je.J(mc).Bj;pa.add(new Ga.DeleteTextUpdateHint(mc,
nb,oa));oa=""}for(--mb;mb>=Ya;mb--)this.base.eF(mb);if(!({Wda:mc}=X(this.Je,Bb)).returnValue)return a.a.instance.Ya(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,Ht:pa};mc=this.Je.J(mc).Bj;oa&&oa.length&&pa.add(new Ga.DeleteTextUpdateHint(mc,Ja,oa,Va.id,Va.Yt));return{returnValue:!0,Ht:pa}}qck(Va,oa){var pa=null;let Ya,Ja,nb;var Bb=({Gkf:Ya,V4h:Ja,Bda:nb}=
this.ZQh(Va,oa,!0)).returnValue;if(0!==Bb)return 3!==Bb&&(a.a.instance.Ya(590202207,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",ha[oa],qa[Bb]),this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),{returnValue:!1,Ht:pa};var mb;if(!({Wda:mb}=X(this.Je,Ja)).returnValue)return a.a.instance.Ya(17342618,1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),
{returnValue:!1,Ht:pa};Bb=this.Je.J(mb).Bj;const Qb=this.Je.J(mb).Mc;let Vb,mc,ob;({nt:mb,t5:Vb,Mqa:mc,o9:ob}=this.fyl(Va,mb));this.Ijh(this.Je,mb,Vb,ob,Ja);pa=new K.a(oa,Va.nt,Va.Mqa);oa=new K.a(oa,mb,mc);pa.mm=oa;oa.mm=pa;this.base.insert(Ya,pa);this.Je.insert(Ja,oa);pa=new l.a;pa.add(new ua.a(Bb,Qb,nb,mb,mc,Vb,ob,Va.id,Va.Yt));return{returnValue:!0,Ht:pa}}Pbk(Va){let oa;oa=null;let pa,Ya;var Ja;if(!({EKd:pa}=this.$Qh(Va,this.base,"Base")).returnValue)return{returnValue:!1,Ht:oa};if(!this.base.J(pa).mm||
!({Wda:Ya}=V(this.Je,this.base.J(pa).mm.Bj,0)).returnValue)return a.a.instance.Ya(17342619,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc1"})),this.L0=!0,{returnValue:!1,Ht:oa};if(!({Wda:Ja}=X(this.Je,Ya+1)).returnValue)return a.a.instance.Ya(17342620,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),
this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc2"})),this.L0=!0,{returnValue:!1,Ht:oa};let nb,Bb,mb,Qb,Vb,mc;({T_a:Ja,U_a:mb,iCf:nb,wJm:Qb,eJm:Bb,fJm:Vb}=this.wml(Va,Ya,Ja));if(!({length:mc}=Y(this.Je,Ja)).returnValue)return{returnValue:!1,Ht:oa};this.Hjh(this.Je,Ja,mb,Ya);this.Je.eF(Ya);this.base.eF(pa);oa=new l.a;oa.add(new ta.MergeParagraphUpdateHint(nb,Qb,mc,Bb,Vb,Ja,mb,Va.id,Va.Yt));return{returnValue:!0,Ht:oa}}Qak(Va,oa){var pa=null;let Ya,Ja,nb;
if(!({syf:nb,Fkf:Ya}=this.OSh(Va,!0,oa)).returnValue)return{returnValue:!1,Ht:pa};if(!({teb:Ja}=this.JHc(this.base,this.Je,Ya,!0)).returnValue)return a.a.instance.Ya(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),{returnValue:!1,Ht:pa};if(0<Ja&&2!==this.Je.J(Ja-1).type)return a.a.instance.Ya(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),this.ee.logger.Pg(Object.assign(new ka.a,
{kj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.L0=!0,{returnValue:!1,Ht:pa};let Bb;if(!({nt:Bb}=this.UJh(Ja)).returnValue)return{returnValue:!1,Ht:pa};oa=new K.a(oa,Va.Cg,Va.Mc);pa=nb;pa.mm=oa;oa.mm=pa;this.base.insert(Ya,nb);this.Je.insert(Ja,oa);pa=new l.a;pa.add(new da.AddParagraphUpdateHint(Va.Cg,Va.Mc,Bb,Va.id,Va.Yt));return{returnValue:!0,Ht:pa}}HPe(Va){let oa;oa=null;let pa;var Ya;if(!({DKd:Ya}=this.QQh(Va,this.base,"Base")).returnValue)return{returnValue:!1,Ht:oa};if(!this.base.J(Ya).mm||
!this.base.J(Ya).mm.Bj.equals(Va.Cg))return a.a.instance.Ya(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),this.L0=!0,{returnValue:!1,Ht:oa};if(!({teb:pa}=this.JHc(this.base,this.Je,Ya,!0)).returnValue)return a.a.instance.Ya(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),
{returnValue:!1,Ht:oa};if(0<pa&&2!==this.Je.J(pa).type)return a.a.instance.Ya(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.L0=!0,{returnValue:!1,Ht:oa};const Ja=this.Je.J(pa).Bj,nb=this.Je.J(pa).Mc;this.Je.eF(pa);this.base.eF(Ya);({nt:Ya}=this.UJh(pa));0<pa&&6===this.Je.J(pa-1).type&&this.u4m(pa-1,Ya);oa=new l.a;oa.add(new ja.a(Ja,nb,Ya,Va.id,
Va.Yt));return{returnValue:!0,Ht:oa}}mbh(Va,oa,pa){let Ya;var Ja=({Hea:oa,Ysa:Ya}=this.eEa(Va,pa,!0,oa,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(0!==Ja)return 3!==Ja&&(a.a.instance.Ya(590202208,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",ha[pa],qa[Ja]),this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({Wda:Ja}=X(this.Je,Ya));Ja=this.Je.J(Ja).Bj;
Va=new Xa(pa,Va);pa=new Xa(pa,Ja);Va.mm=pa;pa.mm=Va;this.base.insert(oa,Va);this.Je.insert(Ya,pa);return!0}wml(Va,oa,pa){let Ya,Ja,nb;Ya=Va.T_a.equals(Va.Cg)?this.Je.J(oa).Bj:this.Je.J(pa).Bj;Va=Va.U_a===Va.Mc?this.Je.J(oa).Mc:this.Je.J(pa).Mc;Ja=this.Je.J(oa).Bj;oa=this.Je.J(oa).Mc;nb=this.Je.J(pa).Bj;pa=this.Je.J(pa).Mc;return{T_a:Ya,U_a:Va,iCf:Ja,wJm:oa,eJm:nb,fJm:pa}}fyl(Va,oa){let pa;var Ya=Va.Cg.equals(Va.nt)?Va.t5:Va.nt;const Ja=Va.Mc===Va.Mqa?Va.o9:Va.Mqa;Va.Cg.equals(Va.nt)?pa=this.Je.J(oa).Bj:
(pa=Ya,Ya=this.Je.J(oa).Bj);Va.Mc===Va.Mqa?(Va=this.Je.J(oa).Mc,oa=Ja):(Va=Ja,oa=this.Je.J(oa).Mc);return{nt:pa,t5:Ya,Mqa:Va,o9:oa}}Jjh(Va,oa,pa,Ya){for(;Ya<Va.length;Ya++){if(!Va.J(Ya).z2()&&6!==Va.J(Ya).type&&2!==Va.J(Ya).type){a.a.instance.shipAssertTag(17311188,1,!1,"Found merge block of type "+Va.J(Ya).type);break}Va.J(Ya).Bj=oa;if(2===Va.J(Ya).type){Va.J(Ya).Mc=pa;break}}}Ijh(Va,oa,pa,Ya,Ja){this.Jjh(Va,pa,Ya,Ja);na.Kjh(Va,oa,Ja)}Hjh(Va,oa,pa,Ya){this.Jjh(Va,oa,pa,Ya+1);na.Kjh(Va,oa,Ya)}$Qh(Va,
oa,pa){let Ya,Ja=-1;if(!({Wda:Ya}=V(oa,Va.Cg,0)).returnValue)return a.a.instance.Ya(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+pa+"for GraphNodeId "+Va.Cg),{returnValue:!1,EKd:Ya};if(!({Wda:Ja}=X(oa,Ya+1)).returnValue||!oa.J(Ja).Bj.equals(Va.t5))return a.a.instance.Ya(17342623,1,2,"GetIndicesForMergePara: Failed to find index "+Ya+1+" in "+pa+" of length "+oa.length),{returnValue:!1,EKd:Ya};this.Hjh(oa,Va.T_a,Va.U_a,Ya);return{returnValue:!0,EKd:Ya}}ZQh(Va,oa,pa){let Ya;
const Ja=pa?this.base:this.Je,nb=pa?"Base":"Derived",Bb=({Hea:oa,Ysa:pa,Bda:Ya}=this.eEa(Va.Cg,oa,pa,Va.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;if(3===Bb||2===Bb)return a.a.instance.Ya(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+nb),{returnValue:Bb,Gkf:oa,V4h:pa,Bda:Ya};this.Ijh(Ja,Va.nt,Va.t5,Va.o9,oa);return{returnValue:Bb,Gkf:oa,V4h:pa,Bda:Ya}}QQh(Va,oa,pa){return({idx:Va}=W(oa,Va.Cg)).returnValue?2!==oa.J(Va).type?(a.a.instance.Ya(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+
pa),{returnValue:!1,DKd:-1}):{returnValue:!0,DKd:Va}:(a.a.instance.Ya(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+pa),{returnValue:!1,DKd:-1})}u4m(Va,oa){var pa=this.Je.J(Va);if(oa){let Ya;({Wda:Ya}=V(this.Je,oa,0));pa=pa.clone();pa.Bj=oa;this.Je.eF(Va);this.Je.insert(Ya,pa)}else this.Je.length>Va&&(this.Je.J(Va+1).z2()||2===this.Je.J(Va+1).type)&&(pa.Bj=this.Je.J(Va+1).Bj)}OSh(Va,oa,pa){var Ya=oa?this.base:this.Je;oa=oa?"Base":"Derived";pa=new K.a(pa,Va.Cg,Va.Mc);if(Va.nt){if(!({Wda:Ya}=
V(Ya,Va.nt,0)).returnValue)return a.a.instance.Ya(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",Va.nt,oa),{returnValue:!1,syf:pa,Fkf:Ya};Ya+=1}else Ya=0;return{returnValue:!0,syf:pa,Fkf:Ya}}UJh(Va){let oa;oa=null;let pa=Va-1;if(-1===pa)return{returnValue:!0,nt:oa};6===this.Je.J(pa).type&&pa--;if(2===this.Je.J(pa).type||4===this.Je.J(pa).type)return oa=this.Je.J(pa).Bj,{returnValue:!0,nt:oa};a.a.instance.Ya(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",
this.Je.J(Va-1).type);return{returnValue:!1,nt:oa}}JHc(Va,oa,pa,Ya){let Ja,nb=!0;Ja=-1;if(pa>Va.length)return a.a.instance.Ya(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),{returnValue:!1,teb:Ja};if(pa<Va.length){if(-1<pa&&pa<Va.length&&!Va.J(pa).mm){nb=!1;for(var Bb=pa+1;Bb<Va.length;Bb++)if(Va.J(Bb).mm){pa=Bb;nb=!0;break}}if(!nb)return{returnValue:!1,teb:Ja};nb=!1;for(Bb=0;Va.J(pa)&&Bb<oa.length;Bb++)if(oa.J(Bb).mm===Va.J(pa)){Ja=Bb;nb=!0;break}if(!nb)return{returnValue:!1,
teb:Ja}}else Ja=oa.length;if(0<Ja&&Ya&&!oa.J(Ja-1).mm){for(Va=Ja-1;0<=Va&&!oa.J(Va).mm;Va--);Ja=Va+1;6===oa.J(Ja).type&&5!==this.ee.input.source&&Ja++}return{returnValue:!0,teb:Ja}}eEa(Va,oa,pa,Ya,Ja,nb){let Bb;var mb;let Qb;var Vb=this.base;let mc=this.Je,ob=!1;pa||(Vb=this.Je,mc=this.base);Qb=mb=Bb=0;let cb,db,kb=0;if(!({vJc:Ya,lhb:cb,DRc:db}=L(Vb,Va,Ya)).returnValue)return a.a.instance.Ya(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),
{returnValue:3,Hea:Bb,Ysa:mb,Bda:Qb};0<=Ya&&Ya<Vb.length&&!Vb.J(Ya).mm&&cb&&!Ja&&(a.a.instance.Ya(17044296,1,4,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",nb),this.L0=!0,kb=oa===Vb.J(Ya).source?1:2,ob=!0);Ja&&!Vb.J(Ya)&&Ya--;Ja&&cb&&!Vb.J(Ya).mm&&(cb=!1,db=0);if(!pa&&!({idx:Va}=W(mc,Va)).returnValue&&!cb)return{returnValue:0,Hea:Ya,Ysa:mb,Bda:Qb};if(!({teb:Va}=this.JHc(Vb,mc,Ya,pa&&!cb)).returnValue&&!ob&&(oa=
!1,1===this.S2g&&0<Ya&&!db&&(Ya--,{teb:Va,returnValue:oa}=this.JHc(Vb,mc,Ya,pa&&!cb),oa&&(Ya++,Va<mc.length-1?Va++:oa=!1)),!oa))return a.a.instance.Ya(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),this.ee.logger.Pg(Object.assign(new ka.a,{kj:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.L0=!0,{returnValue:3,Hea:Bb,Ysa:mb,Bda:Qb};if(cb&&(!R(Vb,Ya,db)||!ob&&!R(mc,Va,db)))return a.a.instance.shipAssertTag(17044297,
1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),{returnValue:3,Hea:Bb,Ysa:mb,Bda:Qb};Bb=Ya;mb=Va;cb&&(Bb=Ya+1,ob||(mb=Vb.J(Ya),pa=mc.J(Va),mb.mm=pa,pa.mm=mb,Vb=Vb.J(Ya+1),mb=mc.J(Va+1),Vb.mm=mb,mb.mm=Vb,mb=Va+1));if(mb>=mc.length)return a.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+mb+" secondaryList length was "+mc.length),{returnValue:3,Hea:Bb,Ysa:mb,Bda:Qb};
for(Vb=0;Vb<mb;Vb++)mc.J(Vb).Bj.equals(mc.J(mb).Bj)&&(Qb+=mc.J(Vb).length);return{returnValue:kb,Hea:Bb,Ysa:mb,Bda:Qb}}B1e(Va,oa,pa){this.Evg.contains(Va.id)&&this.N8a.Z(Va.id,new l.a);for(--pa;pa>=oa;pa--)this.Evg.contains(Va.id)?this.N8a.J(Va.id).insert(this.N8a.J(Va.id).length,this.Je.J(pa)):this.Je.J(pa).mm&&(this.Je.J(pa).mm.mm=null),this.Je.eF(pa)}tmf(Va,oa,pa){if(this.N8a.xb(Va.Yt)){const Ya=this.N8a.J(Va.Yt);for(let Ja=0;Ja<Ya.length;Ja++)Ya.J(Ja).Bj=pa.Bj,Object(ea.a)(K.a,pa)&&Object(ea.a)(K.a,
Ya.J(Ja))&&(Ya.J(Ja).Mc=pa.Mc);this.Je.uA(oa,this.N8a.J(Va.Yt));this.N8a.remove(Va.Yt)}else this.Je.insert(oa,pa)}FLl(Va){let oa,pa;pa=oa=-1;if(!Va.mm)return{returnValue:!1,u_b:oa,U1e:pa};var Ya;let Ja=0,nb=!1;if(!({idx:Ya}=W(this.Je,Va.mm.Bj)).returnValue)return{returnValue:!1,u_b:oa,U1e:pa};for(;Ya<this.Je.length;Ya++){if(Va.mm===this.Je.J(Ya)){oa=Ya;pa=Ja;nb=!0;break}Ja+=this.Je.J(Ya).length}return{returnValue:nb,u_b:oa,U1e:pa}}Q7e(Va){let oa;oa=new l.a;let pa=0,Ya=0;for(;pa<Va.length;){if(Ya>=
this.base.length)return a.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),{returnValue:!1,Agc:oa};if(Va.J(pa).length>this.base.J(Ya).length){if(!R(Va,pa,this.base.J(Ya).length))return a.a.instance.Ya(17335389,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",pa,this.base.J(Ya).length),{returnValue:!1,Agc:oa}}else if(Va.J(pa).length<this.base.J(Ya).length){var Ja=
!!this.base.J(Ya).mm,nb=0;if(Ja&&!({teb:nb}=this.JHc(this.base,this.Je,Ya,!1)).returnValue)return a.a.instance.shipAssertTag(17335390,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",Ya),{returnValue:!1,Agc:oa};if(!R(this.base,Ya,Va.J(pa).length)||Ja&&!R(this.Je,nb,Va.J(pa).length))return a.a.instance.Ya(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),
{returnValue:!1,Agc:oa};if(Ja){Ja=this.base.J(Ya);var Bb=this.Je.J(nb);Ja.mm=Bb;Bb.mm=Ja;Ja=this.base.J(Ya+1);nb=this.Je.J(nb+1);Ja.mm=nb;nb.mm=Ja}}if(this.base.J(Ya).mm&&5!==this.base.J(Ya).type&&this.base.J(Ya).z2()&&(nb=this.base.J(Ya),Ja=Va.J(pa),!nb.cI.equals(Ja.cI)||!nb.lE.Lz(Ja.lE))){let mb;if(!({u_b:Bb,U1e:mb}=this.FLl(this.base.J(Ya))).returnValue)return{returnValue:!1,Agc:oa};oa.add(new Ca(this.Je.J(Bb).Bj,mb,nb,Ja))}pa++;Ya++}return{returnValue:!0,Agc:oa}}static Kjh(Va,oa,pa){for(--pa;0<=
pa;pa--){if(!Va.J(pa).z2()&&6!==Va.J(pa).type){a.a.instance.shipAssertTag(17311187,1,2===Va.J(pa).type||4===Va.J(pa).type,"Found merge block of type "+Va.J(pa).type);break}Va.J(pa).Bj=oa}}static Mai(Va){return Va?!1:(a.a.instance.Ya(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),!0)}}Object(D.a)(na,"ParagraphMergeUsingHintsTwinList",null,[1870]);var Na=d(1651),Oa=d(1652),Ra=d(1648),ab=d(1650),zb=d(1649);class Qa{constructor(Va,oa,
pa,Ya){this.cp=Va;this.length=oa;this.Frd=pa;this.$2c=Ya}}Object(D.a)(Qa,"UpdateFormattingIdsPosInfo",null,[]);class yb{constructor(Va,oa,pa){this.L0=!1;this.N8a=new w.a;this.ee=Va;this.S2g=pa;this._base=oa;this.tle=ca(oa);if(!J(this.base,this.Je))throw a.a.instance.Ya(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),Va.logger.Pg(Object.assign(new H.a,{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get Je(){return this.tle}get mergeConflict(){return this.L0}iQe(Va,
oa){switch(Va.type){case 11:return this.xbk(Va,oa);case 8:return this.KPe(Va,oa);case 10:return this.IPe(Va);default:return!1}}hQe(Va,oa){switch(Va.type){case 11:return this.wbk(Va,oa);case 8:return this.JPe(Va,oa);case 10:return this.HPe(Va);default:return{returnValue:!1,Ht:null}}}nbh(){a.a.instance.Ya(574433295,1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");this.ee.logger.Pg(Object.assign(new H.a,{kj:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}mbh(){a.a.instance.Ya(574433296,
1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");this.ee.logger.Pg(Object.assign(new H.a,{kj:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}Q7e(Va){let oa;oa=new l.a;let pa=0,Ya=0,Ja=0;for(;pa<Va.length;){if(Ya>=this.base.length)return a.a.instance.shipAssertTag(574433297,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),this.ee.logger.Pg(Object.assign(new H.a,{kj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),
{returnValue:!1,Z2c:oa};if(Va.J(pa).length>this.base.J(Ya).length){if(!R(Va,pa,this.base.J(Ya).length))return a.a.instance.Ya(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.ee.logger.Pg(Object.assign(new H.a,{kj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6s"})),{returnValue:!1,Z2c:oa}}else if(Va.J(pa).length<this.base.J(Ya).length&&!this.I2a(Ja+Va.J(pa).length,!0).returnValue)return a.a.instance.Ya(574433299,1,2,
"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),this.ee.logger.Pg(Object.assign(new H.a,{kj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,Z2c:oa};if(this.base.J(Ya).mm&&5!==this.base.J(Ya).type&&this.base.J(Ya).z2()){const nb=this.base.J(Ya),Bb=Va.J(pa);if(!nb.cI.equals(Bb.cI)||!nb.lE.Lz(Bb.lE)){let mb,Qb;if(({u_b:mb,hxh:Qb}=this.GLl(this.base.J(Ya))).returnValue)oa.add(new Qa(Qb,this.Je.J(mb).length,nb,Bb));else return a.a.instance.Ya(571757956,
1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),this.ee.logger.Pg(Object.assign(new H.a,{kj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,Z2c:oa}}}Ja+=this.base.J(Ya).length;pa++;Ya++}return{returnValue:!0,Z2c:oa}}xbk(Va,oa){let pa;if(!({Qza:pa}=this.I2a(Va.cp,!0)).returnValue)return a.a.instance.Ya(574433300,1,2,"ApplyInsertTextHintToDerived"),this.ee.logger.Pg(Object.assign(new H.a,{kj:"ApplyInsertTextHintToDerived",
eventId:"8ps6u"})),!1;for(let Ja=0;Ja<Va.uZ.length;Ja++)switch(Va.uZ.J(Ja).type){case 7:var Ya=Va.uZ.J(Ja);this.Je.insert(pa,new Ia(oa,null,Ya.text,Ya.id));break;case 9:Ya=Va.uZ.J(Ja);this.Je.insert(pa,new K.a(oa,Ya.Cg,Ya.Mc));break;default:return a.a.instance.Ya(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.ee.logger.Pg(Object.assign(new H.a,{kj:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}KPe(Va,oa){let pa,Ya;if(!({Qza:pa}=this.I2a(Va.cp,!0)).returnValue||!({Qza:Ya}=this.I2a(Va.cp+
Va.text.length,!1)).returnValue)return a.a.instance.Ya(575706433,1,2,"ApplyDeleteTextHintToDerived"),this.ee.logger.Pg(Object.assign(new H.a,{kj:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for(Va=Ya;Va>=pa;Va--)this.Je.J(Va).source!==oa&&this.Qxd(this.Je,Va);return!0}IPe(Va){let oa;if(!({Qza:oa}=this.I2a(Va.cp,!0)).returnValue)return a.a.instance.Ya(574433302,1,2,"ApplyDeleteParaHintToDerived"),this.ee.logger.Pg(Object.assign(new H.a,{kj:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),
!1;this.F1e(this.Je,Va,oa);return!0}wbk(Va,oa){let pa;pa=null;let Ya,Ja;if(!({tvb:Ya,Qza:Ja}=this.I2a(Va.cp,!0)).returnValue)return a.a.instance.Ya(574433303,1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.ee.logger.Pg(Object.assign(new H.a,{kj:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,Ht:pa};var nb=this.tbf(this.Je,Ja-1);nb=new zb.a(nb);for(let Bb=0;Bb<Va.uZ.length;Bb++)switch(Va.uZ.J(Bb).type){case 7:nb.uZ.add(this.OPe(Va.uZ.J(Bb),oa,Ya,Ja));break;
case 9:nb.uZ.add(this.ybk(Va.uZ.J(Bb),oa,Ya,Ja));break;default:return a.a.instance.Ya(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),this.ee.logger.Pg(Object.assign(new H.a,{kj:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,Ht:pa}}pa=new l.a;pa.add(nb);return{returnValue:!0,Ht:pa}}OPe(Va,oa,pa,Ya){const Ja=new Ia(oa,Va.Cg,Va.text,Va.id);oa=new Ia(oa,Va.Cg,Va.text,Va.id);Ja.mm=oa;oa.mm=Ja;this.base.insert(pa,Ja);this.Je.insert(Ya,oa);pa=new ab.a(Va.Cg,Va.text);pa.id=Va.id;return pa}ybk(Va,
oa,pa,Ya){const Ja=new K.a(oa,Va.Cg,Va.Mc);oa=new K.a(oa,Va.Cg,Va.Mc);Ja.mm=oa;oa.mm=Ja;this.base.insert(pa,Ja);this.Je.insert(Ya,oa);return new Ra.a(Va.Cg,Va.Mc)}JPe(Va){let oa;oa=new l.a;let pa;var Ya;let Ja;if(!({tvb:pa,Qza:Ya}=this.I2a(Va.cp,!0)).returnValue||!({tvb:Ja,Qza:nb}=this.I2a(Va.cp+Va.text.length,!1)).returnValue)return a.a.instance.Ya(588001990,1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.ee.logger.Pg(Object.assign(new H.a,{kj:"ApplyDeleteTextHintToBaseAndDerived",eventId:"9ddlg"})),
{returnValue:!1,Ht:oa};for(Va=nb;Va>=Ya;Va--)if(this.Je.J(Va).mm){var nb=Va;oa.add(({nJm:Va}=this.c7k(Va,Ya)).returnValue);this.Qxd(this.Je,Va,nb)}for(Ya=Ja;Ya>=pa;Ya--)this.Qxd(this.base,Ya);return{returnValue:!0,Ht:oa}}HPe(Va){let oa;oa=null;let pa,Ya;if(!({tvb:pa,Qza:Ya}=this.I2a(Va.cp,!0)).returnValue)return a.a.instance.Ya(574433305,1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.ee.logger.Pg(Object.assign(new H.a,{kj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps6z"})),{returnValue:!1,Ht:oa};
if(!this.F1e(this.base,Va,pa))return a.a.instance.Ya(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),this.ee.logger.Pg(Object.assign(new H.a,{kj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps60"})),{returnValue:!1,Ht:oa};this.F1e(this.Je,Va,Ya)&&(oa=new l.a,oa.add(new Na.a(this.tbf(this.Je,Ya-1),Va.Cg,Va.Mc)));return{returnValue:!0,Ht:oa}}I2a(Va,oa){var pa;var Ya=pa=-1;let Ja,nb;if(!({lhb:nb,deh:Va,ceh:Ja}=I(this.base,Va,this.ee.logger)).returnValue)return{returnValue:!1,tvb:pa,
Qza:Ya};const Bb=Va>=this.base.length;Bb&&Va--;if(this.base.J(Va).mm){const mb=this.y8k(this.Je,this.base.J(Va));if(nb){if(0>mb||!R(this.base,Va,Ja)||!R(this.Je,mb,Ja))return a.a.instance.Ya(575706444,1,2,"SplitTwinListAndFindIdx"),this.ee.logger.Pg(Object.assign(new H.a,{kj:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,tvb:pa,Qza:Ya};pa=this.base.J(Va);Ya=this.Je.J(mb);pa.mm=Ya;Ya.mm=pa;pa=this.base.J(Va+1);Ya=this.Je.J(mb+1);pa.mm=Ya;Ya.mm=pa;pa=oa?Va+1:Va;Ya=oa?mb+1:mb}else oa?(pa=
Bb?Va+1:Va,Ya=Bb?mb+1:mb):(pa=Bb?Va:Va-1,Ya=Bb?mb:mb-1)}else if(nb){if(R(this.base,Va,Ja))pa=oa?Va+1:Va;else return a.a.instance.Ya(575706445,1,2,"SplitTwinListAndFindIdx"),this.ee.logger.Pg(Object.assign(new H.a,{kj:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,tvb:pa,Qza:Ya};oa?(Ya=({tBb:Ya}=this.T0b(this.base,this.Je,Va,!1)).returnValue?Ya+1:0,Ya=Ya>=this.Je.length?this.Je.length-1:Ya):(Ya=({tBb:Ya}=this.T0b(this.base,this.Je,Va,!0)).returnValue?Ya-1:this.Je.length-1,Ya=0>Ya?0:Ya)}else oa?
(({tBb:Ya}=this.T0b(this.base,this.Je,Va,!0)).returnValue||(({tBb:Ya}=this.T0b(this.base,this.Je,Va,!1)).returnValue?Ya+=1:(Ya=Bb?this.Je.length-1:0,Ya=0>Ya?0:Ya)),pa=Bb?Va+1:Va):(({tBb:Ya}=this.T0b(this.base,this.Je,Va,!1)).returnValue||(({tBb:Ya}=this.T0b(this.base,this.Je,Va,!0)).returnValue?--Ya:(Ya=Va?this.Je.length-1:0,Ya=0>Ya?0:Ya)),pa=Bb?Va:Va-1);return{returnValue:!0,tvb:pa,Qza:Ya}}T0b(Va,oa,pa,Ya){let Ja=null;if(Ya)for(;pa<Va.length;pa++){if(Va.J(pa).mm){Ja=Va.J(pa).mm;break}}else for(;0<=
pa;pa--)if(Va.J(pa).mm){Ja=Va.J(pa).mm;break}if(Ja)for(Va=0;Va<oa.length;Va++)if(oa.J(Va)===Ja)return oa=Va,{returnValue:!0,tBb:oa};return{returnValue:!1,tBb:-1}}y8k(Va,oa){for(let pa=0;pa<Va.length;pa++)if(Va.J(pa).mm===oa)return pa;return-1}Qxd(Va,oa,pa=-1){for(pa=0>pa?oa:pa;pa>=oa;pa--)Va.J(pa).mm&&(Va.J(pa).mm.mm=null),Va.eF(pa)}tbf(Va,oa){let pa=0;for(;0<=oa;oa--)pa+=Va.J(oa).length;return pa}$Jl(Va){Va=Object(v.a)(Ea.a,Va);Va||(a.a.instance.Ya(575706448,1,2,"GetTextBlock"),this.ee.logger.Pg(Object.assign(new H.a,
{kj:"GetTextBlock",eventId:"8ujvq"})));return Va}c7k(Va,oa){let pa="";for(;Va>=oa&&this.Je.J(Va).mm&&2!==this.Je.J(Va).type;)pa=this.$Jl(this.Je.J(Va)).text+pa,Va--;oa=0>Va?0:this.tbf(this.Je,Va);Va+=1;return{returnValue:new Oa.a(oa,pa),nJm:Va}}GLl(Va){let oa,pa,Ya=!1;pa=oa=0;if(!Va.mm)return{returnValue:!1,u_b:oa,hxh:pa};for(oa=0;oa<this.Je.length;oa++){if(this.Je.J(oa).mm===Va){Ya=!0;break}pa+=this.Je.J(oa).length}return{returnValue:Ya,u_b:oa,hxh:pa}}F1e(Va,oa,pa){pa=pa===Va.length?--pa:pa;pa>Va.length-
1&&(a.a.instance.Ya(571757957,1,2,"DeleteEopInList: Idx out of range"),this.ee.logger.Pg(Object.assign(new H.a,{kj:"DeleteEopInList",eventId:"8ffwf"})));if(2===Va.J(pa).type){const Ya=Va.J(pa);if(Ya.Bj!==oa.Cg||Ya.Mc!==oa.Mc)return!1;this.Qxd(Va,pa);return!0}return!1}}Object(D.a)(yb,"ParagraphMergeUsingHintsTwinListLcs",null,[1870]);var lb=d(1523),Eb=d(1493),bc=d(1647);d.d(M,"a",function(){return Pb});class Pb{constructor(Va,oa,pa,Ya,Ja,nb,Bb=null,mb=null,Qb=null){this.VO=this.Eqa=this.vGa=this.Boa=
null;this._initialized=!1;this.ee=Va;this.sE=oa;this.eya=Ya;this.Uwa=pa;this.fpa=Ja;this.jhe=new f.a;for(Va=0;Va<this.sE.length;Va++)this.jhe.add(this.sE.J(Va).id);this.vCg=new f.a;for(Va=0;Va<this.Uwa.length;Va++)this.vCg.add(this.Uwa.J(Va).id);this.F2g=new f.a;for(Va=0;Va<this.eya.length;Va++)this.F2g.add(this.eya.J(Va).id);this.Lg=nb;this.nKe=Bb||G.a.instance;this.tH=mb;this.DV=Qb;this.mqb=1===(this.tH&&this.DV&&1===this.tH.QEa&&1===this.DV.QEa?1:0);this.epa=0}get tTf(){return 1!==this.epa}s2l(){var Va=
!0;if(this.tH&&this.DV)return Va;if(this.tH||this.DV)return a.a.instance.Ya(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),!1;this.ee.runtime.Vt.xb(B.a.wK)&&(Va=this.ee.runtime.Vt.J(B.a.wK),Va=this.L8f(Va,this.ee.runtime.dza.id,"favored")&&({updateHints:this.tH}=this.E6h(Va,this.jhe,this.vCg,this.ee.runtime.Vt,"favored")).returnValue);Va&&this.ee.runtime.kq.xb(B.a.wK)&&
(Va=this.ee.runtime.kq.J(B.a.wK),Va=this.L8f(Va,this.ee.runtime.dza.id,"unfavored")&&({updateHints:this.DV}=this.E6h(Va,this.jhe,this.F2g,this.ee.runtime.kq,"unfavored")).returnValue);this.tH=this.tH?this.tH:new bc.a(new l.a,0);this.DV=this.DV?this.DV:new bc.a(new l.a,0);Va&&this.ee.input.q4b&&(Va=this.ee.input.x3.last().YXa(B.a.wK),Va=this.L8f(Va,this.ee.input.x3.last().r1.id,"alreadyMerged"));return Va}D0l(){const Va=new f.a;if(this.mqb)return Va;const oa=this.tH?this.tH.updateHints.p3():new l.a;
let pa=0;for(;pa<oa.length-1;){const Ya=oa.J(pa);let Ja,nb=!1;for(Ja=pa+1;Ja<oa.length;Ja++){const Bb=oa.J(Ja);if(Ya.jci(Bb)){Va.add(Ya.id);oa.eF(Ja);oa.eF(pa);nb=!0;break}}nb||pa++}return Va}L8f(Va,oa,pa){Va=this.Lg.getPropertyString(Va,m.a.hQa);Va=r.a.Of(Va);return oa.equals(Va)?!0:(this.yZc(2),a.a.instance.Ya(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",this.ee.runtime.dza.id,
Va,pa),!1)}E6h(Va,oa,pa,Ya,Ja){let nb;nb=new bc.a(new l.a,0);Va=this.Lg.getPropertyObjectIds(Va,m.a.L_).p3();for(let mb=0;mb<Va.length;mb++){if(!Ya.xb(Va.J(mb)))return a.a.instance.Ya(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",Va.J(mb),Ja),{returnValue:!1,updateHints:nb};const Qb=Ya.J(Va.J(mb));var Bb=r.a.Of(this.Lg.getPropertyString(Qb,m.a.cha));if(oa.contains(Bb)||pa.contains(Bb)){Bb=this.nKe.fJc(Qb);
if(!Bb)return a.a.instance.Ya(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",Qb.id,Ja),{returnValue:!1,updateHints:nb};nb.updateHints.add(Bb)}}0<Va.length&&a.a.instance.Ya(17162308,1,5,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",Ja,Va.Cq(),nb.updateHints.Cq());return{returnValue:!0,updateHints:nb}}E1l(){return({FJ:this.Boa,
eFc:this.vGa,s2c:this.Eqa}=lb.a.Hsh(this.ee,this.Lg,this.sE,this.Uwa,this.eya,this.fpa,!0,!0)).returnValue?!0:!1}p2l(Va){const oa=lb.a.Dwd(this.Lg,pa=>this.ee.runtime.jk.J(pa),this.sE,1,this.fpa,!0,!0).returnValue;if(!oa)return a.a.instance.Ya(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.VO=this.mqb?new yb(this.ee,oa,1):new na(this.ee,oa,Va,this.tH?this.tH.QEa:0);return!0}initialize(){if(this._initialized)return!1;this._initialized=!0;
if(!this.s2l()||!this.E1l())return!1;const Va=this.D0l();return this.p2l(Va)?!0:!1}QSh(Va){const oa=new l.a;let pa="";for(let Ya=0;Ya<Va.length;Ya++){const Ja=Va.J(Ya);Ja.z2()?pa+=Va.J(Ya).text:2===Ja.type?(oa.add(new ia(Ja.Bj,Ja.type,pa,Ja.Mc)),pa=""):4===Ja.type&&(oa.add(new ia(Ja.Bj,Ja.type)),pa="")}return oa}validateUpdateHintsAreComplete(Va,oa,pa){oa=this.QSh(oa);Va=this.QSh(Va);let Ya=oa.length===Va.length;if(Ya)for(let Ja=0;Ja<oa.length;Ja++)if(!oa.J(Ja).isEqual(Va.J(Ja))){Ya=!1;break}Ya||
(this.yZc(4),a.a.instance.Ya(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",pa,Va.Cq(),oa.Cq()));return Ya}Ubh(Va,oa,pa){(oa=({H3a:Va}=this.Nck(Va,oa,pa)).returnValue)||this.yZc(this.VO.mergeConflict?1:3);return{returnValue:oa,H3a:Va}}Nck(Va,oa,pa){let Ya;Ya=new l.a;let Ja=!0;var nb=0;let Bb=null,mb=this.tH?this.tH.updateHints.length:0;for(var Qb=0;Qb<mb&&Ja;Qb++)Bb=this.tH.updateHints.J(Qb),
nb<this.DV.updateHints.length&&Bb.id.equals(this.DV.updateHints.J(nb).id)&&5!==this.ee.input.source?({returnValue:Ja}=this.VO.hQe(Bb,2),nb++):Ja=this.VO.iQe(Bb,2);if(!Ja)return a.a.instance.Ya(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",Bb.toString()),{returnValue:!1,H3a:Ya};if(!this.validateUpdateHintsAreComplete(this.VO.Je,this.vGa,"Favored"))return{returnValue:!1,H3a:Ya};if(Va&&1===this.ee.input.G2&&!this.VO.nbh(oa,pa,2))return a.a.instance.Ya(17409920,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",
oa,pa),{returnValue:!1,H3a:Ya};Ja=!0;Qb=new l.a;for(mb=this.DV?this.DV.updateHints.length:0;nb<mb&&Ja;nb++){Bb=this.DV.updateHints.J(nb);let Vb;({Ht:Vb,returnValue:Ja}=this.VO.hQe(Bb,4));Ja&&Vb&&Qb.uA(Qb.length,Vb)}return Ja?this.validateUpdateHintsAreComplete(this.VO.base,this.Eqa,"Unfavored")?Va&&2===this.ee.input.G2&&!this.VO.mbh(oa,pa,4)?(a.a.instance.Ya(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",oa,pa),{returnValue:!1,H3a:Ya}):{returnValue:!0,
H3a:Qb}:{returnValue:!1,H3a:Ya}:(a.a.instance.Ya(17044291,1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",Bb.id,Bb.type),{returnValue:!1,H3a:Ya})}Swl(){let Va,oa=0;let pa=0,Ya=r.a.nil;for(Va=new w.a;pa<this.VO.base.length;){const Bb=this.VO.base.J(pa);Ya.equals(Bb.Bj)||(oa=0,Ya=Bb.Bj);if(5===Bb.type){var Ja=oa+Bb.length;var nb=void 0;let mb;const Qb=ca(this.Eqa);if(!({index:nb}=C(Qb,Bb.Bj,oa)).returnValue||!({index:mb}=C(Qb,Bb.Bj,Ja)).returnValue)return a.a.instance.Ya(17335384,
1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",Bb.F2c),{returnValue:!1,hpi:Va};for(Ja=new l.a;nb<mb;nb++)Ja.add(Qb.J(nb));Va.Z(Bb.F2c,Ja)}oa+=Bb.length;pa++}return{returnValue:!0,hpi:Va}}Twl(){let Va;Va=new w.a;let oa=0;for(let Ya=0;Ya<this.VO.base.length;Ya++){const Ja=this.VO.base.J(Ya);if(5===Ja.type){var pa=void 0;let nb;const Bb=ca(this.Eqa);if(!({index:pa}=P(Bb,oa,this.ee.logger)).returnValue||!({index:nb}=
P(Bb,oa+Ja.length,this.ee.logger)).returnValue)return a.a.instance.Ya(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),{returnValue:!1,ipi:Va};const mb=new l.a;for(;pa<nb;pa++)mb.add(Bb.J(pa));Va.Z(Ja.F2c,mb)}oa+=Ja.length}return{returnValue:!0,ipi:Va}}Rbk(Va){let oa;oa=new l.a;let pa;if(this.mqb){if(!({ipi:pa}=this.Twl()).returnValue)return{returnValue:!1,lRc:oa}}else if(!({hpi:pa}=this.Swl()).returnValue)return{returnValue:!1,lRc:oa};let Ya;Ya=this.mqb?
new yb(this.ee,ca(this.vGa),1):new na(this.ee,ca(this.vGa),new f.a,this.tH?this.tH.QEa:0);for(var Ja=0;Ja<Va.length;Ja++)if(!Ya.iQe(Va.J(Ja),4))return{returnValue:!1,lRc:oa};for(Va=Ya.Je.length-1;0<=Va;Va--)5===Ya.Je.J(Va).type&&(Ja=Ya.Je.J(Va).F2c,Ya.Je.eF(Va),Ya.Je.uA(Va,pa.J(Ja)));this.mqb&&(this.Avh(Ya.Je),this.Avh(this.VO.Je));if(!this.validateUpdateHintsAreComplete(this.VO.Je,Ya.Je,"Merged"))return{returnValue:!1,lRc:oa};oa=Ya.Je;return{returnValue:!0,lRc:oa}}Avh(Va){const oa=new w.a;for(let pa=
Va.length-1;0<=pa;pa--){const Ya=Object(v.a)(K.a,Va.J(pa));Ya&&(oa.xb(Ya.Mc)?oa.J(Ya.Mc).source!==Ya.source&&Va.eF(pa):oa.add(Ya.Mc,Ya))}}Mck(Va){let oa;if(!({Z2c:oa}=this.VO.Q7e(ca(this.Eqa))).returnValue)return!1;for(let Ya=0;Ya<oa.length;Ya++){const Ja=oa.J(Ya);let nb,Bb;if(!({index:nb}=P(Va,Ja.cp,this.ee.logger)).returnValue||!({index:Bb}=P(Va,Ja.cp+Ja.length,this.ee.logger)).returnValue)return a.a.instance.Ya(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),this.ee.logger.Pg(Object.assign(new H.a,
{kj:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var pa=!1;for(let mb=nb;mb<Bb&&!pa;mb++)pa=!Ja.Frd.cI.equals(Va.J(mb).cI);if(!pa){for(pa=nb;pa<Bb;pa++)Va.eF(nb);Va.insert(nb,Ja.$2c)}}return!0}Lck(Va){let oa;if(!({Agc:oa}=this.VO.Q7e(ca(this.Eqa))).returnValue)return!1;for(let Ja=0;Ja<oa.length;Ja++){var pa=oa.J(Ja);let nb,Bb;if(({index:nb}=C(Va,pa.Cg,pa.cp)).returnValue&&({index:Bb}=C(Va,pa.Cg,pa.cp+pa.$2c.length)).returnValue){var Ya=!1;for(let mb=nb;mb<Bb&&!Ya;mb++)Ya=!pa.Frd.cI.equals(Va.J(mb).cI)||
!pa.Frd.lE.Lz(Va.J(mb).lE);if(Ya){if(this.tH&&1===this.tH.QEa||this.DV&&1===this.DV.QEa)return!1}else{for(Ya=nb;Ya<Bb;Ya++)Va.eF(nb);Va.insert(nb,pa.$2c)}}else if(pa=pa.$2c.K7l,a.a.instance.Ya(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",pa),pa||this.tH&&1===this.tH.QEa||this.DV&&1===this.DV.QEa)return!1}return!0}IBl(Va){let oa,pa;pa=new l.a;oa=this.ee.runtime.Lm.J(B.a.wK);let Ya;({Ayf:Ya}=Pb.rKh(this.ee,
this.Lg));const Ja=new l.a;for(let Bb=0;Bb<Va.length;Bb++){if(Ya.contains(Va.J(Bb).id,(Qb,Vb)=>Qb.equals(Vb)))continue;if(this.ee.runtime.Lm.xb(Va.J(Bb).id))return a.a.instance.shipAssertTag(17044293,1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",Va.J(Bb).id),{returnValue:!1,aZd:oa,$Yd:pa};Ja.add(Va.J(Bb).id);var nb=Va.J(Bb).bYa();const mb=new Eb.a(nb);nb=nb.Mj();for(const Qb of nb)mb.fB(Qb);pa.add(mb)}Va=this.Lg.getPropertyObjectIds(oa.im,m.a.L_);Va.uA(Va.length,Ja);this.Lg.setPropertyObjectIds(oa.im,
m.a.L_,Va);return{returnValue:!0,aZd:oa,$Yd:pa}}tEd(Va){return String.format("Name: {0}, Message: {1}, Stack: {2}",Va.name,Va.message,Va.stack)}yZc(Va){0===this.epa&&(this.epa=Va)}mgc(){let Va;Va=null;let oa,pa;var Ya;try{if({Lm:Va,aZd:oa,$Yd:pa,returnValue:Ya}=this.l$n(),Ya){if(oa&&pa){this.ee.runtime.Lm.Z(oa.im.id,oa);for(Ya=0;Ya<pa.length;Ya++){const mb=pa.J(Ya);this.ee.runtime.Lm.Z(mb.im.id,mb)}const Ja=oa.im,nb=this.Lg.getPropertyObjectIds(Ja,m.a.L_),Bb=this.Lg.getPropertyString(Ja,m.a.hQa);
a.a.instance.Ya(17162312,1,5,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",nb.Cq(),Bb)}else a.a.instance.Ya(593826831,1,5,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,Lm:Va}}}catch(Ja){a.a.instance.Ya(17162313,1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.tEd(Ja))}this.yZc(5);a.a.instance.Ya(17409922,1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",
this.epa,this.tTf);this.F_a();this.tH&&1===this.tH.QEa&&this.ee.logger.Pg(Object.assign(new fa.a,{eventId:"bc04c",kj:"ParagraphMergeUsingHints.TryDoMerge",info:u[this.epa]+"/LCS"}));return{returnValue:!1,Lm:Va}}l$n(){let Va,oa,pa;pa=oa=Va=null;let Ya;Ya=this.initialize();this.ee.logger.MT("PMUH Initialize");let Ja=null;Ya=Ya&&({H3a:Ja}=this.Ubh(!1,r.a.nil,0)).returnValue;this.ee.logger.MT("PMUH ApplyUpdateHints");let nb=new l.a;Ya=Ya&&({lRc:nb}=this.Rbk(Ja)).returnValue;this.ee.logger.MT("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");
Ya=this.mqb?Ya&&this.Mck(nb):Ya&&this.Lck(nb);this.ee.logger.MT("PMUH ApplyUnfavoredFormattingChanges");this.mqb&&!this.Ywn(nb)&&(a.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.ee.logger.Pg(Object.assign(new H.a,{kj:"ReuseParaIdsIfPossible",eventId:"8ettb"})),Ya=!1);const Bb=this.dGd(nb);Ya=Ya&&({ZYd:Va}=lb.a.WHc(this.ee,this.Lg,this.fpa,nb,Bb)).returnValue;this.ee.logger.MT("PMUH GetMergeableObjectsFromMergeBlocks");this.tH&&1===this.tH.QEa&&this.DV&&1===this.DV.QEa||(Ya=
Ya&&({aZd:oa,$Yd:pa}=this.IBl(F(Ja))).returnValue,this.ee.logger.MT("PMUH GetPartialMergeResultForUpdateHintNodes"));return{returnValue:Ya,mergeConflict:!!this.VO&&this.VO.mergeConflict,Lm:Va,aZd:oa,$Yd:pa}}dGd(Va){const oa=new l.a;for(let pa=0;pa<Va.length;pa++)2===Va.J(pa).type&&oa.add(Va.J(pa).Bj);return oa}kcf(Va){const oa=new l.a;for(let pa=0;pa<Va.length;pa++)2===Va.J(pa).type&&oa.add(Va.J(pa));return oa}Ywn(Va){var oa=this.kcf(this.Boa),pa=this.kcf(this.vGa),Ya=this.kcf(this.Eqa),Ja=this.dGd(oa),
nb=this.dGd(pa),Bb=this.dGd(Ya);nb=N.b(Ja,nb,Bb);Ja=new l.a;for(Bb=0;Bb<nb.length;Bb++)Ja.uA(Ja.length,nb.J(Bb).A8k());nb=this.F8k(Va);oa=this.B8k(nb,Ja,oa,pa,Ya);pa=0;Ya=new f.a;for(Ja=0;Ja<Va.length;Ja++)if(nb=Va.J(Ja),2===nb.type)if(Ya.contains(nb.Bj))if(pa<oa.length)Va.eF(Ja),Va.insert(Ja,oa.J(pa)),pa++;else return!1;else Ya.add(nb.Bj);0<Va.length&&2!==Va.J(Va.length-1).type&&pa<oa.length&&Va.insert(Va.length,oa.J(pa));return!0}F8k(Va){const oa=new f.a;for(let pa=0;pa<Va.length;pa++)2===Va.J(pa).type&&
oa.add(Va.J(pa).Bj);return oa}B8k(Va,oa,pa,Ya,Ja){const nb=new l.a;for(let Bb=0;Bb<oa.length;Bb++){const mb=oa.J(Bb);if(!Va.contains(mb)){let Qb;(({block:Qb}=this.H7e(Ya,mb)).returnValue||({block:Qb}=this.H7e(Ja,mb)).returnValue||({block:Qb}=this.H7e(pa,mb)).returnValue)&&Qb&&nb.add(Qb)}}return nb}H7e(Va,oa){for(let pa=0;pa<Va.length;pa++)if(2===Va.J(pa).type&&Va.J(pa).Bj===oa)return Va=Va.J(pa),{returnValue:!0,block:Va};return{returnValue:!1,block:null}}F_a(){const Va=new l.a;lb.a.s8b(this.Lg,"BaseObjects_",
this.sE,Va);lb.a.s8b(this.Lg,"FavoredObjects_",this.Uwa,Va);lb.a.s8b(this.Lg,"ConflictObjects_",this.eya,Va)}mok(){let Va,oa;Va=r.a.nil;oa=-1;let pa=0;for(let Ya=0;Ya<this.VO.Je.length;Ya++){const Ja=this.VO.Je.J(Ya);if(Ja.z2())pa+=Ja.length;else if(6!==Ja.type)pa=0;else return Va=Ja.Bj,oa=pa,{returnValue:!0,objectId:Va,cp:oa}}a.a.instance.Ya(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");return{returnValue:!1,objectId:Va,cp:oa}}C2c(Va,oa){let pa,Ya;Ya=oa;pa=Va;try{let Ja=
this.initialize();if(Ja=(Ja=Ja&&this.Ubh(!0,Va,oa).returnValue)&&({objectId:pa,cp:Ya}=this.mok()).returnValue)return a.a.instance.Ya(17409924,1,5,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",pa,Ya),{returnValue:!0,G1a:pa,ona:Ya}}catch(Ja){a.a.instance.Ya(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.tEd(Ja))}this.yZc(5);a.a.instance.Ya(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",
this.epa,this.tTf);this.F_a();return{returnValue:!1,G1a:pa,ona:Ya}}static rKh(Va,oa){let pa;pa=new l.a;if(!Va.input.q4b)return{returnValue:!0,Ayf:pa};Va=Va.input.x3.last().YXa(B.a.wK);pa=oa.getPropertyObjectIds(Va,m.a.L_);return{returnValue:!0,Ayf:pa}}static Y4m(Va){if(!lb.a.O3e(Va))return!0;const oa=new z.a;Va.runtime.Lm.Z(B.a.wK,lb.a.t2l(Va,oa));return!0}static G4m(Va){if(!Va.runtime.Lm.xb(B.a.wK)||!Va.runtime.kq.xb(B.a.wK))return!0;const oa=new z.a,pa=Va.runtime.Lm.J(B.a.wK);var Ya=oa.getPropertyString(pa.im,
m.a.hQa);if(r.a.Of(Ya).equals(r.a.nil))return!0;Ya=oa.getPropertyObjectIds(pa.im,m.a.L_);const Ja=oa.getPropertyObjectIds(Va.runtime.kq.J(B.a.wK),m.a.L_);let nb;({Ayf:nb}=Pb.rKh(Va,oa));for(let Bb=0;Bb<Ja.length;Bb++)Ya.contains(Ja.J(Bb),(mb,Qb)=>mb.equals(Qb))||nb.contains(Ja.J(Bb),(mb,Qb)=>mb.equals(Qb))||(Ya.add(Ja.J(Bb)),Va.runtime.Lm.Z(Ja.J(Bb),new Eb.a(Va.runtime.kq.J(Ja.J(Bb)).xG())));oa.setPropertyObjectIds(pa.im,m.a.L_,Ya);return!0}}Object(D.a)(Pb,"ParagraphMergeUsingHints",null,[1791])},
1587:function(D,M,d){D=d(0);class m{constructor(v){this.asi=v;this.succeeded=!1;this.fgc=v?v.fgc:0;this.Ojm=!1;this.length=this.i4n=0}}Object(D.a)(m,"TrieResult",null,[]);class f{constructor(v,u,z){this.Vgb=new m(null);this.qBm=v;this.HQc=u;this.Umi=u+z-1}get result(){return this.Vgb}gTh(){let v;return this.HQc<=this.Umi?(v=this.qBm.charAt(this.HQc),++this.HQc,{returnValue:!0,ch:v}):{returnValue:!1,ch:"\x00"}}ZPf(v,u,z){v&&(this.Vgb.Ojm=!0,this.Vgb.i4n=u);this.Vgb.length=this.HQc;this.Vgb.succeeded=
!0;this.Vgb.fgc=z;this.HQc!==this.Umi+1&&(this.Vgb=new m(this.Vgb))}}Object(D.a)(f,"LookUpStringVisitor",null,[1247]);var a=d(1663);class l{constructor(){this.ojh=this.Mgh=this.Ogh=this.Lgh=this.Ngh=this.sTe=this.qTe=this.uTe=this.pTe=0}}Object(D.a)(l,"TRIESTATS",null,[]);class r{constructor(){this.symbol=this.aSc=0}}Object(D.a)(r,"TrieSymbol",null,[]);d.d(M,"a",function(){return w});class w{constructor(v,u){this.D2=null;this.JSd=this.ini=this.gni=this.kni=this.cni=this.jni=this.hni=this.lni=this.dni=
0;this.yI=v;if(v.Zx(u,4)!==w.Jvb)throw Error.argument("Input does not represent a trie");u+=4;this.Wmi=1===v.Zx(u,4);u+=4;this.nBm=1===v.Zx(u,4);u+=4;this.jBm=v.Zx(u,4);u+=4;if(v.Zx(u,4)){v=u+4;this.D2=this.den(v);this.dni=u=v+w.Gmk;this.lni=u+=w.tsd*(this.D2.pTe+(this.D2.pTe%2?1:0));this.hni=u+=w.tsd*(this.D2.uTe+(this.D2.uTe%2?1:0));this.jni=u+=w.tsd*(this.D2.qTe+(this.D2.qTe%2?1:0));this.cni=u+=w.tsd*(this.D2.sTe+(this.D2.sTe%2?1:0));this.kni=u+=w.wTe*this.D2.Lgh;this.gni=u+=w.xTe*this.D2.Ogh;
this.ini=u+=w.xTe*this.D2.Mgh;u+=w.xTe*this.D2.Ngh;if(u!==v+this.D2.ojh)throw Error.argument("Corrupted trie binary");this.JSd=u}else this.D2=null}tmi(v,u,z,B){v=new f(v,u,z);this.mjj(v,B);return v.result}aYh(v){if(this.Wmi)if(v)--v;else return"";if(!this.D2)throw Error.argument("Invalid trieID");const u=new a.a;u.qE=0;this.bLb(u);const z=[];for(;;){if(u.qE&w.t4a)if(v)--v;else return Array.add(z,u.dMb),String.fromCharCode.apply(null,z);const B=!!(u.qE&w.vee),G=this.R1b(u,!0);if(B||v<G){if(Array.add(z,
u.dMb),!this.bLb(u))throw Error.argument("Invalid trieID");}else if(v-=G,!this.Y1c(u))throw Error.argument("Invalid trieID");}}mjj(v,u){let z=0;this.Wmi&&(v.ZPf(this.nBm,this.jBm,0),++z);if(this.D2){var B=new a.a;B.qE=0;if(this.bLb(B))for(;;){var G=void 0;if(!({ch:G}=v.gTh()).returnValue)break;u&&(G=u(G));G=G.toString().charCodeAt(0);let F=!1;for(;!F;){const K=!!(B.qE&w.t4a);if(B.dMb===G){if(F=!0,K&&v.ZPf(!!(B.qE&w.Ldg),B.R9d,z),!this.bLb(B))return}else if(z+=this.R1b(B,!0),!this.Y1c(B))return;K&&
++z}}}}bLb(v){if(!v.qE)return this.a5f(v),!0;if(!(v.qE&w.uee))return!1;v.ELa=0;v.Pw=v.seb;this.a5f(v);return!0}Y1c(v){if(v.qE&w.vee)return!1;this.a5f(v);return!0}R1b(v,u){return v.qE&w.Kdg?v.ssd:v.qE&w.uee?!u&&v.qE&w.vee?this.Nll(v):1:0}Nll(v){v=w.YVe(v);if(!this.bLb(v))return 0;let u=0;do v.qE&w.t4a&&++u,u+=this.R1b(v,!1);while(this.Y1c(v));return u}a5f(v){v.qE||(v.ELa=0,v.Pw=this.JSd);var u=this.zxd(this.dni,v.Pw),z=u.symbol;v.Pw+=u.aSc;u=this.yI.Zx(this.cni+w.wTe*z,w.wTe);v.dMb=u&65535;v.qE=u>>
16;v.qE&w.Kdg&&(v.ssd=this.DOk(v));v.qE&w.Ldg&&(u=this.zxd(this.lni,v.Pw),z=u.symbol,v.Pw+=u.aSc,v.R9d=this.yI.Zx(this.kni+4*z,4));v.qE&w.Mqj?(v.seb=this.JSd+((this.yI.J(v.Pw)<<8|this.yI.J(v.Pw+1))<<8|this.yI.J(v.Pw+2)),v.Pw+=3):v.qE&w.Nqj?(v.seb=v.Pw,v.ELa=v.seb):v.qE&w.Oqj?(u=this.zxd(this.hni,v.Pw),z=u.symbol,v.Pw+=u.aSc,v.seb=this.JSd+this.yI.Zx(this.gni+4*z,4)):v.qE&w.uee&&(u=this.zxd(this.jni,v.Pw),z=u.symbol,v.Pw+=u.aSc,v.ELa||(v.ELa=v.Pw),v.ELa+=this.yI.Zx(this.ini+4*z,4),v.seb=v.ELa)}zxd(v,
u){const z=new r;let B=0;for(;;){B+=this.yI.J(u);++u;++z.aSc;const G=this.yI.Zx(v,2);if(B<G)break;z.symbol+=G;B-=G;v+=2;B<<=8}z.symbol+=B;return z}DOk(v){let u=this.yI.J(v.Pw);192<=u?(u=(u&63)<<15|(this.yI.J(v.Pw+1)&127)<<8,u|=this.yI.J(v.Pw+2),v.Pw+=3):128<=u?(u=(u&127)<<8|this.yI.J(v.Pw+1),v.Pw+=2):v.Pw+=1;return u}den(v){const u=new l;u.pTe=this.yI.Zx(v+12,2);u.uTe=this.yI.Zx(v+14,2);u.qTe=this.yI.Zx(v+16,2);u.sTe=this.yI.Zx(v+18,2);u.Ngh=this.yI.Zx(v+24,4);u.Lgh=this.yI.Zx(v+28,4);u.Ogh=this.yI.Zx(v+
32,4);u.Mgh=this.yI.Zx(v+36,4);u.ojh=this.yI.Zx(v+40,4);return u}static YVe(v){const u=new a.a;u.dMb=v.dMb;u.qE=v.qE;u.ssd=v.ssd;u.Pw=v.Pw;u.seb=v.seb;u.ELa=v.ELa;u.R9d=v.R9d;return u}}w.Jvb=1654263084;w.Gmk=48;w.tsd=2;w.xTe=4;w.wTe=4;w.t4a=1;w.vee=2;w.Kdg=4;w.Ldg=8;w.uee=16;w.Nqj=64;w.Oqj=128;w.Mqj=256;Object(D.a)(w,"Trie",null,[1246])},1591:function(D,M,d){d.r(M);D=d(0);d(1460);var m=d(1533),f=d(1494),a=d(1478),l=d(1507),r=d(1457),w=d(2),v=d(80),u=d(13);class z{constructor(){this.WGe=0}dNf(C,P){this.WGe=
window.performance.now();this.qQa(()=>{const W=window.performance.now(),X={};P.c8j&&(X.callback=V=>{C(V,OSF.StoreTypeEnum.MarketPlace,W)},w.AFrameworkApplication.ya.Xb(u.a.dHb,2,X));P.d8j&&(X.callback=V=>{C(V,OSF.StoreTypeEnum.PrivateCatalog,W)},w.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?X.storeType=10:X.storeType=OSF.StoreTypeEnum.PrivateCatalog,w.AFrameworkApplication.ya.Xb(u.a.dHb,2,X))},0,()=>{if(r.TellMeActor.instance.Qe)r.TellMeActor.instance.Qe.onError("AddinEntitlementsQuery:QueryEntitlementAsync",
"Query entitlements timeout after "+(window.performance.now()-this.WGe)+" ms")})}qQa(C,P=0,W=null){2!==w.AFrameworkApplication.ya.processAction(u.a.dHb,1)?(r.TellMeActor.instance.Qe&&r.TellMeActor.instance.Qe.DA(a.a.a8j,window.performance.now()-this.WGe),C()):20>P?w.AFrameworkApplication.uc.$b(new v.a(2,1,500,()=>{this.qQa(C,P+1,W)})):W&&W()}static get instance(){z._instance||(z._instance=new z);return z._instance}}z._instance=null;Object(D.a)(z,"AddinEntitlementsQuery",null,[]);class B{constructor(){this.description=
this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.Jtf=this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(D.a)(B,"AddinInfo",null,[]);var G=d(1461),F=d(1464),K=d(1463),N=d(1506),H=d(1456),J=d(35),L=d(584),I=d(121);d.d(M,"AddinResultsProvider",function(){return R});class R{constructor(C){this.lG=null;this.GK=-1;this.tve=0;this.jc=C;this.hg=w.AFrameworkApplication.Ze;this.fkd=new m.a;this.ytj=this.jc.RJl;
this.rzg=this.jc.QJl;this.eQj=this.jc.TJl;this.xtj=this.jc.jzl;this.u9a=this.RIc();this.KQm=(P,W,X)=>{if(P){const V=P.errorCode;if(r.TellMeActor.instance.Qe){const Y={};Y.StoreType=W;Y.ErrorCode=V;Y.AddinCount=P.value?P.value.length:0;r.TellMeActor.instance.Qe.DA(a.a.Oel,window.performance.now()-X,Y)}if(0===V&&P.value){R.Zub=R.Zub||{};P=P.value;for(const Y of P)P=new B,P.displayName=Y[0],P.id=Y[1],P.description=Y[2],P.targetType=Y[3],P.appVersion=4<Y.length?Y[4]:"",P.assetId=5<Y.length?Y[5]:"",P.assetStoreId=
6<Y.length?Y[6]:"",P.width=7<Y.length?Y[7]:0,P.height=8<Y.length?Y[8]:0,P.iconUrl=9<Y.length?Y[9]:"",P.providerName=10<Y.length?Y[10]:"",P.storeId=11<Y.length?Y[11]:"",P.storeType=12<Y.length?Y[12]:"",this.jc.TTi&&(P.Jtf=this.zul(P)),R.Zub[P.id]=P,0<P.iconUrl.length&&appChrome.addInApi.registerAddinIcon("AddinIcon_"+P.id,P.iconUrl)}}};z.instance.dNf(this.KQm,this.jc)}WJ(){return"Add-ins"}wW(){return 0===this.jc.Hv?0:1===this.jc.Hv?1:2}uI(C,P,W,X,V=null){W=new K.a(C);V&&!Array.contains(V,24)||H.a.tT(C)||
(V=new F.a(24),V.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,X=C.ng,this.jc.k9h&&!this.jc.j9h?(this.lRh(X,V,2),(!this.tve||window.performance.now()-this.tve>=this.ytj)&&this.Ldm(X)?this.Vel(C,P,V):(P.resultsUpdated(W),r.TellMeActor.instance.Qe.onError("AddinResultsProvider:IssueQuery:GetAddinStoreResults","Cannot send requests to the Office add-in store frequently"))):this.lRh(X,V,3),W.wv(V));P.resultsUpdated(W)}lRh(C,P,W){if((C=this.dBn(C))&&0<C.length){let X=0;C.forEach(V=>{if(!(++X>
W)){var Y="AddinSuggestion"+X,ca={};ca["default"]=0<V.iconUrl.length?"AddinIcon_"+V.id:"AppForOfficeLogo_20";var fa=[];fa.push(appChrome.actions.setControlLabel(Y,V.displayName));fa.push(appChrome.actions.setControlIconSet(Y,ca));fa.push(appChrome.actions.setCompoundButtonCommandValueId(Y,V.id));fa.push(appChrome.actions.updateCompoundButtonDescription(Y,V.description));appChrome.api.dispatch(fa);Y=new G.a(Y,25,void 0,void 0,1);Y.IH=Telemetry.PrivacyRules.GetPrivacyCompliantId(V.id,V.storeType,V.assetId,
null,null,V.storeId);P.zy(Y)}})}}dBn(C){if(!R.Zub)return null;const P=[],W=R.Zub;for(let V in W){var X=W[V];X&&(this.jc.TTi?R.wDm(C,X)&&Array.add(P,X):0<=X.displayName.toLowerCase().indexOf(C.toLowerCase())?Array.add(P,X):this.jc.Whm&&0<=X.description.toLowerCase().indexOf(C.toLowerCase())&&Array.add(P,X))}return P}zul(C){const P=R.E5i(C.displayName);this.jc.b8j&&Array.addRange(P,R.E5i(C.description));return P}Vel(C,P,W){const X=new K.a(C),V=C.ng,Y=this.lG=I.a.create().toString();this.v9();this.GK=
window.setTimeout(()=>{if(Y===this.lG){this.lG="";this.GK=-1;P.resultsUpdated(X);var ca={};ca[f.a.provider]=this.WJ();ca[f.a.Oib]=C.d1a;r.TellMeActor.instance.Qe.DA(a.a.timedOut,this.rzg,ca);ca={"Content-Type":"application/json",Accept:"application/json, text/plain, */*"};ca["X-Office-Version"]=w.AFrameworkApplication.buildVersion;ca["X-Office-Application"]=w.AFrameworkApplication.K.lb("Application");ca["X-Office-Platform"]="WAC";ca["X-TellMe-SessionId"]=r.TellMeActor.instance.YIc();ca["X-TellMe-Culture"]=
w.AFrameworkApplication.uiCulture;ca["X-TellMe-ProcessSessionId"]=w.AFrameworkApplication.userSessionId;ca["Client-Request-Id"]=Y;const fa=window.performance.now();this.hg.Lj(this.Uel(V),1,null,ca,!0,0,sa=>{this.w0a(sa,C,P,W,Y,fa)},sa=>{this.m0a(sa,C,P,Y,fa)},null,null,!1,4E3,6E3);this.tve=window.performance.now()}},this.rzg)}w0a(C,P,W,X,V,Y){r.TellMeActor.instance.Qe.nX(P.ng.length,this.u9a.join(","),C.data.mf.toString(),Math.round(window.performance.now()-Y),N.a.tellMe,!0,l.a.Rsa);H.a.tT(P);V=new K.a(P);
this.v9();const ca=J.b(C.data.Ee);this.d7l(ca,P.ng)&&this.A_f(P.ng,X);V.wv(X);W.resultsUpdated(V);r.TellMeActor.instance.Qe.nX(P.ng.length,this.u9a.join(","),C.data.mf.toString(),Math.round(window.performance.now()-Y),N.a.tellMe,!0,l.a.provider)}m0a(C,P,W,X,V){this.v9();r.TellMeActor.instance.Qe.nX(P.ng.length,this.u9a.join(","),C.data.mf.toString(),Math.round(window.performance.now()-V),N.a.tellMe,!1,l.a.Rsa);C=new K.a(P);W.resultsUpdated(C)}A_f(C,P){const W=[],X=String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,
C);W.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",X));W.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",C));appChrome.api.dispatch(W);P.zy(new G.a("LaunchAddinDialogFromTellMe",25))}Ldm(C){return this.jc.h9h&&(C.length<=this.jc.Sel||C.length>=this.jc.Rel||RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>/?~\uff01@#\uffe5\u2026\u2026&*\uff08\uff09\u2014\u2014|{}\u3010\u3011\u2018\uff1b\uff1a\u201d\u201c'\u3002\uff0c\u3001\uff1f]").test(C))?!1:!0}d7l(C,P){if(!C&&
!C.TotalCount)return!1;let W=0;C=C.Values;for(let V=0;V<C.length;V++){var X=C[V];const Y=X.Title,ca=X.ShortDescription,fa=X.Rating;X=X.NumberOfVotes;if(this.jc.g7l)if(0<=Y.toLowerCase().indexOf(P.toLowerCase())||this.jc.e7l&&0<=ca.toLowerCase().indexOf(P.toLowerCase()))this.jc.i9h&&fa>=this.jc.NDl?W++:this.jc.f7l&&X>=this.jc.dzl?W++:this.jc.i9h||this.jc.h9h||W++;else continue;else W++;if(W>=this.jc.Qel)return!0}return!1}v9(){-1!==this.GK&&(window.clearTimeout(this.GK),this.GK=-1)}RIc(){const C=[];
this.jc.hMc&&Array.add(C,"Addin");return C}Uel(C){return String.format(this.xtj+"/api/addins/search?ad={0}&apiversion=1.0&client={1}&clientsessionid={2}&corr={3}&cv=16.0&free=false&orderby=Desc&orderfield=None&qu={4}&rs={5}&skiptoitem=0&top={6}&ui={7}",this.country,"WAC_Word",w.AFrameworkApplication.userSessionId,w.AFrameworkApplication.userSessionId,C,this.appUILocale,this.eQj,this.appUILocale)}get appUILocale(){return L.a.lg(w.AFrameworkApplication.lcid).name}get country(){const C=this.appUILocale.split("-");
return"es"===C[0].toString().toLowerCase()?"ES":C[C.length-1]}static wDm(C,P){if(!P.Jtf)return!1;for(const W of C.split(" ")){C=!1;for(const X of P.Jtf)if(X.toLowerCase().startsWith(W.toLowerCase())){C=!0;break}if(!C)return!1}return!0}static E5i(C){const P=[];for(const W of C.split(" ")){C=0;for(let X=0;X<W.length;X++){const V=W.charAt(X);V.toString().toUpperCase()===V.toString()&&X>C&&(Array.add(P,W.substring(C,X)),C=X)}Array.add(P,W.substring(C,W.length));C&&Array.add(P,W.substring(0,W.length))}return P}}
R.Zub=null;Object(D.a)(R,"AddinResultsProvider",null,[1093])},1645:function(D,M,d){d.d(M,"a",function(){return f});D=d(0);var m=d(216);class f{constructor(){this.Dib=this.Eib=this.yWa=this.Zeb=this.Cib=this.jbb=this.Xeb=this.V0a=this.kbb=this.Yeb=null;this.reset()}reset(){this.Yeb=new m.a;this.kbb=new m.a;this.V0a=new m.a;this.Xeb=new m.a;this.jbb=new m.a;this.Cib=new m.a;this.Zeb=new m.a;this.yWa=new m.a;this.yWa=new m.a;this.Eib=new m.a;this.Dib=new m.a}tno(a){return this.wLa(this.Yeb,a)&&this.wLa(this.kbb,
a)&&this.wLa(this.V0a,a)&&this.wLa(this.Xeb,a)&&this.wLa(this.jbb,a)&&this.wLa(this.Cib,a)&&this.wLa(this.Zeb,a)&&this.wLa(this.yWa,a)&&this.wLa(this.Eib,a)&&this.wLa(this.Dib,a)}wLa(a,l){return!a||!a.length||a.length===l}}Object(D.a)(f,"MergeableTrackedChangesProperties",null,[])},1646:function(D,M,d){d.d(M,"a",function(){return a});D=d(0);var m=d(216),f=d(609);class a{constructor(){this.wFa=new m.a;this.uGa=new m.a;this.FIa=new m.a}get rvb(){return this.wFa}get g7e(){return this.uGa}get Jlb(){return this.FIa}get isEmpty(){return!this.wFa.length&&
!this.uGa.length&&!this.FIa.length}get Zxf(){return Math.max(Math.max(this.wFa.length,this.uGa.length),this.FIa.length)}get PGm(){return Math.min(Math.min(this.wFa.length,this.uGa.length),this.FIa.length)}Lqd(l){this.wFa.add(l)}Oqd(l){this.uGa.add(l)}Tqd(l){this.FIa.add(l)}A8k(){const l=new f.a,r=new m.a;let w=0;for(;w<this.wFa.length||w<this.uGa.length||w<this.FIa.length;)w<this.wFa.length&&!l.contains(this.wFa.J(w))&&(r.add(this.wFa.J(w)),l.add(this.wFa.J(w))),w<this.uGa.length&&!l.contains(this.uGa.J(w))&&
(r.add(this.uGa.J(w)),l.add(this.uGa.J(w))),w<this.FIa.length&&!l.contains(this.FIa.J(w))&&(r.add(this.FIa.J(w)),l.add(this.FIa.J(w))),w++;return r}}Object(D.a)(a,"ObjectCollection",null,[])},1647:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f,a){this.QEa=a;this.updateHints=f}}Object(D.a)(m,"UpdateHintCollection",null,[])},1648:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);d=d(1520);class m extends d.a{constructor(f,a){super();this.Cg=f;this.Mc=a}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",
this.cp,this.type,this.Cg,this.Mc)}}Object(D.a)(m,"LcsInsertParaUpdateHint",d.a,[])},1649:function(D,M,d){d.d(M,"a",function(){return f});D=d(0);var m=d(216);d=d(1520);class f extends d.a{constructor(a){super();this.uZ=new m.a;this.cp=a}get type(){return 11}toString(){let a="";for(let l=0;l<this.uZ.length;l++)a+=String.format("({0}), ",this.uZ.J(l).toString());return String.format("[Cp:{0}] {1}",this.cp,a)}}Object(D.a)(f,"LcsInsertUpdateHint",d.a,[])},1650:function(D,M,d){d.d(M,"a",function(){return m});
D=d(0);d=d(1520);class m extends d.a{constructor(f,a){super();this.text=a;this.Cg=f}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [Text:{3}]",this.cp,this.type,this.Cg,this.text)}}Object(D.a)(m,"LcsInsertTextUpdateHint",d.a,[])},1651:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);d=d(1520);class m extends d.a{constructor(f,a,l){super();this.cp=f;this.Cg=a;this.Mc=l}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",
this.cp,this.type,this.Cg,this.Mc)}}Object(D.a)(m,"LcsDeleteParaUpdateHint",d.a,[])},1652:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);d=d(1520);class m extends d.a{constructor(f,a){super();this.cp=f;this.text=a}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}] [Text:{2}]",this.cp,this.type,this.text)}}Object(D.a)(m,"LcsDeleteTextUpdateHint",d.a,[])},1653:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);d=d(1492);class m extends d.a{constructor(){super()}get Yda(){return"Conflict"}}
Object(D.a)(m,"ConflictMergeFailureDetail",d.a,[])},1654:function(D,M,d){d.r(M);d.d(M,"InsightsMenuItemFactory",function(){return l});D=d(0);var m=d(1456),f=d(236),a=d(16);class l{constructor(r=null){this.bGj=r||CommonUIStrings.l_InsightsButtonText}get eIb(){return 10}Gda(r){var w=r.RB;r=m.a.bCa()?m.a.mWa(w,1):m.a.exb(w);w=String.format(this.bGj,w);return this.idl(r,w)}idl(r,w){return f.a(l.M7h,m.a.bCa()?"1914896509":"3317204163",a.a.If(w),m.a.Xmf,null,a.a.If(r),a.a.If(w),null,null)}}l.M7h="bInsights";
Object(D.a)(l,"InsightsMenuItemFactory",null,[967])},1655:function(D,M,d){d.d(M,"a",function(){return a});D=d(0);var m=d(236),f=d(16);class a{constructor(l,r,w,v,u){this.OEe=l;this.NEe=r;this.$Vj=w;this.GEj=v;this.RGg=u}get eIb(){return 4}Gda(l,r=null){r=r.sessionId+"|"+r.yla+"|"+l.RB;if(this.RGg||this.GEj){let w=this.RGg||f.a.Tz(CommonUIStrings.l_HelpTooltip)===f.a.Tz(l.RB.trim());if(this.$Vj&&2<l.RB.length){const v=l.RB;";"===v.charAt(0)&&";"===v.charAt(v.length-1)&&v.substring(1,v.length-1)===
a.Hjf&&(w=!0)}l=w?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,l.RB);return this.HJh(r,f.a.If(l),w)}return this.HJh(r,f.a.If(String.format(CommonUIStrings.l_TextWithQuotation,l.RB)),!1)}HJh(l,r,w){return m.a(a.Hjf,w?this.NEe:this.OEe,r,"OfficeAssistant_16x16x32","A0",f.a.If(l),r,null,null)}}a.Hjf="bSearchHelp";Object(D.a)(a,"AssistanceMenuItemFactory",null,[967])},1656:function(D,M,d){d.d(M,"a",function(){return r});D=d(0);var m=d(2),f=d(236),a=d(98),
l=d(16);class r{get eIb(){return 13}Gda(){return r.Pjk()}static Pjk(){return f.b(r.WGh,"798637440",l.a.If(CommonUIStrings.l_LookupFirstRunExperienceTitle),m.AFrameworkApplication.mr,a.getImageClass("Info_32x32x32"),null,null,l.a.If(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,l.a.If(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}r.WGh="bTellMeFirstRun";Object(D.a)(r,"FirstRunMenuItemFactory",null,[967])},1657:function(D,M,d){d.d(M,"a",function(){return l});
D=d(0);var m=d(2),f=d(236),a=d(16);class l{constructor(r=null,w=null){this.uQg=r;this.OLj=w||CommonUIStrings.l_LookupNoResultsDescription}get eIb(){return 14}Gda(r){r=String.format(this.OLj,r.RB);return this.Nkk(r)}Nkk(r){return f.b(l.msi,"798637440",a.a.If(CommonUIStrings.l_LookupNoResultsTitle),this.uQg?m.AFrameworkApplication.mr:null,this.uQg,null,null,a.a.If(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,a.a.If(r),null,null)}}l.msi="lookupNoResults";Object(D.a)(l,"NoCommandsFoundMenuItemFactory",
null,[967])},1658:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(f,a){this.FontWeight=0;this.Text=null;this.FontWeight=f;this.Text=a}}Object(D.a)(m,"LabelFormatted",null,[])},1659:function(D,M,d){d.d(M,"a",function(){return w});D=d(0);d(1460);var m=d(1461),f=d(1464),a=d(1463),l=d(1456),r=d(16);class w{constructor(v){this.jc=v}WJ(){return"Assistance"}wW(){return 0===this.jc.Hv?0:1===this.jc.Hv?1:this.jc.hTc?3:2}uI(v,u,z=!1,B,G=null){B=new a.a(v);if((!G||Array.contains(G,
8))&&!l.a.tT(v)){G=new f.a(8);if(z){z=r.a.Tz(CommonUIStrings.l_HelpTooltip)===r.a.Tz(v.ng.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,v.ng);const F=[];this.jc.d_a&&(this.jc.Z6d||F.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),z=this.yTh(v.ng));const K="||"+v.ng;F.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",z));F.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",K));
appChrome.api.dispatch(F);v=new m.a("GetHelpFromTellMe",4,v.ng,null,1)}else v=new m.a("bSearchHelp",4,v.ng,null,1);G.zy(v);G.displayName=CommonUIStrings.l_HelpButtonTitle;B.wv(G)}u.resultsUpdated(B)}Wdb(v,u=null){const z=new f.a(8),B=r.a.Tz(CommonUIStrings.l_HelpTooltip)===r.a.Tz(v.ng.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,v.ng);for(let F=0;F<u.length&&2>F;F++){var G=void 0;G=[];let K="GetHelpWithDescriptionFromTellMe"+(F+1).toString(),
N=4;if(this.jc.p_c)G.push(appChrome.actions.setControlLabel(K,B)),G.push(appChrome.actions.setCompoundButtonCommandValueId(K,v.ng)),G.push(appChrome.actions.updateCompoundButtonDescription(K,this.rhf(u.length)));else if(this.jc.q_c){let H=this.JZh(u[F]);K="GetHelpFromTellMe"+(F+1).toString();this.jc.d_a&&(H=this.yTh(H));N=9;G.push(appChrome.actions.setControlLabel(K,H));G.push(appChrome.actions.setButtonCommandValueId(K,this.VKl(u[F])))}appChrome.api.dispatch(G);G=new m.a(K,N,null,null,0);G.label=
this.JZh(u[F]);G.description=this.UKl(u[F]);z.zy(G);if(this.jc.q_c)break}z.displayName=CommonUIStrings.l_HelpButtonTitle;return z}rhf(v){return 1===v?String.format(CommonUIStrings.l_SearchResultText,v):String.format(CommonUIStrings.l_SearchResultsText,v)}yTh(v){return this.jc.nsf?l.a.Ncf(v,CommonUIStrings.l_HelpScopedButtonText):v+CommonUIStrings.l_HelpScopedButtonText}JZh(v){return v.name?v.name:""}UKl(v){return v.description?v.description:""}VKl(v){return v.id?"AssetID="+v.id:""}}Object(D.a)(w,
"AssistanceResultsProvider",null,[1093])},1660:function(D,M,d){d.d(M,"a",function(){return v});D=d(0);d(1460);var m=d(1461),f=d(1464),a=d(1463),l=d(1457),r=d(1456),w=d(1518);class v{constructor(u){this.jc=u}WJ(){return"Image"}wW(){return 0===this.jc.Hv?0:1===this.jc.Hv?1:3===this.jc.Hv?3:2}uI(u,z,B,G,F=null){B=new a.a(u);(!F||Array.contains(F,19))&&r.a.tT(u)&&this.jc.PQ&&this.Wdb(u,B,1);z.resultsUpdated(B)}Wdb(u,z,B,G=null){var F=[];let K;l.TellMeActor.instance.KN()&&l.TellMeActor.instance.KN().d_a?
(K=this.jc.nsf?r.a.Ncf(u.ng,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):u.ng+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.jc.Z6d||F.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):K=this.jc.PQ?r.a.tT(u)?this.jc.A$a?r.a.Ocb(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.jc.A$a?r.a.Ocb(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,
u.ng)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,u.ng):this.jc.Qdc?CommonUIStrings.l_TellMeImageSuggestionButtonText:u.ng+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.jc.VAa?(l.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",K)),F=r.a.mWa(u.ng,9,Object.assign(new w.a,{landingTab:"Image"})),l.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",F))):(F.push(appChrome.actions.setControlLabel("ImageForSearch",
K)),u=r.a.mWa(u.ng,9,Object.assign(new w.a,{landingTab:"Image"})),F.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",u)),appChrome.api.dispatch(F));B=new m.a("ImageForSearch",12,null,null,B);G&&(B.score=G.ConfidenceScore);G=new f.a(19,this.jc.Qdc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);G.zy(B);z.wv(G)}}Object(D.a)(v,"ImageResultsProvider",null,[1093])},1661:function(D,M,d){d.d(M,"a",function(){return w});D=d(0);d(1460);var m=d(1461),f=d(1464),a=d(1463),
l=d(1456),r=d(2);class w{constructor(v){this.jc=v}WJ(){return"Template"}wW(){return 0===this.jc.Hv?0:1===this.jc.Hv?1:3}uI(v,u){v=new a.a(v);u.resultsUpdated(v)}Wdb(v,u,z){var B=[];let G;G=this.jc.PQ?this.jc.A$a?l.a.Ocb(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,v.ng)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,v.ng):String.format(CommonUIStrings.l_TellMeTemplateButtonText,v.ng);B.push(appChrome.actions.setControlLabel("TemplateForSearch",G));B.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",
String.format(r.AFrameworkApplication.K.lb("TellMeTemplateProviderURL"),r.AFrameworkApplication.uiCulture,v.ng)));appChrome.api.dispatch(B);v=new f.a(23);v.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;B=new m.a("TemplateForSearch",24,null,null,0);B.label=z[0].Title?z[0].Title:"";B.description=z[0].Description?z[0].Description:"";v.zy(B);u.wv(v)}}Object(D.a)(w,"TemplateResultsProvider",null,[1093])},1662:function(D,M,d){d.d(M,"a",function(){return z});D=d(0);d(1460);var m=d(1495),f=d(1461),
a=d(1464),l=d(1463),r=d(1578),w=d(1457),v=d(1456),u=d(16);class z{constructor(B,G,F,K){this.M0=B;this.L9a=G;this.q2g=K;this.UBj=F;this.jc=w.TellMeActor.instance.KN()}WJ(){return"EmptyQuery"}wW(){return 1===this.jc.Hv?1:0}uI(B,G,F=!1,K,N=null){K=new l.a(B);if((!N||Array.contains(N,5)||Array.contains(N,6)||Array.contains(N,4))&&v.a.tT(B)){this.M0.YGc().length||!this.UBj||this.q2g||(B=new a.a(6),N=new f.a(null,13,void 0,void 0,1),B.zy(N),K.wv(B));B=new a.a(4);if(0<this.M0.YGc().length){B.displayName=
CommonUIStrings.l_TellMeRecentlyUsedTitle;N=this.M0.YGc();var H=[];for(var J of N)H.push(J.Id);m.CommandResultsUtility.y2c(H,this.jc);for(var L of N)m.CommandResultsUtility.zMc(L.Id)&&B.zy(new f.a(L.Id,5,null,null,2));K.wv(B)}if(this.q2g&&0<this.L9a.length&&this.M0.YGc().length<z.maxResults){J=new a.a(5);J.displayName=CommonUIStrings.l_TellMeTryQueryTitle;L=z.maxResults-B.results.length;B=[];for(N=0;N<this.L9a.length&&N<L;++N){if(F){H=v.a.E5f+(N+1);const I=this.L9a[N].key,R=u.a.replaceAll(I,'"',"");
B.push(appChrome.actions.setControlLabel(H,I));B.push(appChrome.actions.setButtonCommandValueId(H,R));H=new r.a(I,7,0,R,H)}else H=new r.a(this.L9a[N].key,7,0,this.L9a[N].value);J.zy(H)}0<B.length&&appChrome.api.dispatch(B);K.wv(J)}}G.resultsUpdated(K)}}z.maxResults=5;Object(D.a)(z,"EmptyQueryResultsProvider",null,[1093])},1663:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(){this.R9d=this.ELa=this.seb=this.Pw=this.ssd=this.qE=this.dMb=0}}Object(D.a)(m,"TRIESCAN",null,[])},
1678:function(D,M,d){d.r(M);var m=d(0),f=d(1460),a=d(1494),l=d(1478),r=d(1591);class w{constructor(Za,Cb){this.gwa=Za;this.Jk=Cb}resultsUpdated(Za){this.gwa.GLn(this.Jk,Za)}}Object(m.a)(w,"AggregatorResultsProviderCallback",null,[1101]);var v=d(1464),u=d(1463);class z{constructor(Za){this.uoa=null;this.jc=Za;this.jc.gvb&&(this.uoa=null)}WJ(){return"AppsForOffice"}wW(){return 0===this.jc.Hv?0:1===this.jc.Hv?1:2}uI(Za,Cb,Rb,pc,Rc=null){Rb=new u.a(Za);if(!Rc||Array.contains(Rc,1))Rc=new v.a(1),this.uoa.Yxo(Rc,
Za.ng),Rb.wv(Rc);Cb.resultsUpdated(Rb)}}Object(m.a)(z,"AppsForOfficeRecommendationResultsProvider",null,[1093]);var B=d(1659),G=d(1453),F=d(1472),K=d(120);class N{constructor(Za,Cb){this.Ab=Za;this.mBm=Cb}isMatch(Za,Cb){if(!Object(K.a)(1211,Za))throw Error.argument("objToTest","Expected feature bundle");let Rb;return({value:Rb}=Za.jq(this.Ab.dra)).returnValue?this.Ab.N8f.isMatch(Rb,Cb):this.mBm}}Object(m.a)(N,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1240]);class H{constructor(Za,Cb){this.Ab=
Za;this.dxf=Cb}isMatch(Za){if(!Object(K.a)(1211,Za))throw Error.argument("objToTest","Expected feature bundle");return!!(this.dxf^Za.jq(this.Ab.dra).returnValue)}}Object(m.a)(H,"AnnotatedWithAnnotationFilter",null,[1240]);class J{constructor(Za){this.Ab=Za}isMatch(Za,Cb){if(!Object(K.a)(1215,Za))throw Error.argument("objToTest","Expected struct value");return this.Ab.N8f.isMatch(Za.ddb(this.Ab.zKa),Cb)}}Object(m.a)(J,"FieldValueMatchesStructFilter",null,[1240]);class L{constructor(Za,Cb){Za&&(this.zKa=
Za.J(0),this.N8f=Cb.Tka(Za.J(1)))}}Object(m.a)(L,"FieldValueMatchesStructFilterInit",null,[]);class I{constructor(Za){this.dxf=Za}isMatch(Za){if(!Object(K.a)(1211,Za))throw Error.argument("objToTest","Expected feature bundle");return!!(this.dxf^Za.Yif)}}Object(m.a)(I,"HasAnnotationsAnnotationFilter",null,[1240]);class R{constructor(Za,Cb){this.Ab=Za;this.J6=Cb}isMatch(Za,Cb){if(!Object(K.a)(1214,Za))throw Error.argument("objToTest","Expected list value");switch(this.J6){case 0:for(const Rb of Za.items)if(this.Ab.filter.isMatch(Rb,
Cb))return!0;return!1;case 1:for(const Rb of Za.items)if(!this.Ab.filter.isMatch(Rb,Cb))return!1;return!0;default:throw Error.notImplemented();}}}Object(m.a)(R,"ItemTestListFilter",null,[1240]);class C{constructor(Za){this.Ab=Za}isMatch(Za,Cb){if(!Object(K.a)(1214,Za))throw Error.argument("objToTest","Expected list value");return this.Ab.filter.isMatch(Za.items.length,Cb)}}Object(m.a)(C,"LengthMatchesListFilter",null,[1240]);class P{constructor(Za,Cb){this.Ab=Za;this.J6=Cb}isMatch(Za,Cb,Rb=null){let pc=
0===this.J6;for(const Rc of this.Ab.Kkh)if((pc=Rc.isMatch(Za,Cb,Rb))?1===this.J6:0===this.J6)return pc;2===this.J6&&(pc=!pc);return pc}}Object(m.a)(P,"NonterminalFilter",null,[1240]);class W{constructor(Za,Cb){if(Za){var Rb=Za.J(0);this.Kkh=Array(Rb);for(let pc=0;pc<Rb;++pc)this.Kkh[pc]=Cb.Tka(Za.J(1+pc))}}}Object(m.a)(W,"NonterminalFilterInit",null,[]);class X{constructor(Za,Cb){this.Ab=Za;this.J6=Cb}isMatch(Za,Cb){if("number"!==typeof Za)throw Error.argument("objToTest","Expected number value");
let Rb=this.Ab.number;if(this.Ab.query){Cb=this.Ab.query.Ys(null,Cb);if("number"!==typeof Cb)throw Error.invalidOperation("Query did not return number");Rb+=Cb}switch(this.J6){case 0:return Za===Rb;case 1:return Za<Rb;case 2:return Za<=Rb;case 3:return Za>Rb;case 4:return Za>=Rb;default:throw Error.notImplemented();}}}Object(m.a)(X,"NumberFilter",null,[1240]);class V{constructor(Za,Cb){Za&&(this.number=Za.J(0),this.query=Za.J(1)?Cb.QJ(Za.J(1)):null)}}Object(m.a)(V,"NumberFilterInit",null,[]);class Y{constructor(Za,
Cb,Rb){this.xEd=this.Apl;this.sBm=Za;this.$mi=Cb;this.Zmi=Rb}EUe(Za){this.$mi=Za}Apl(Za){if(!Za)throw Error.argument("name","Invalid named feature bundle reference");const Cb=Za.substr(1);return 1===Za.charCodeAt(0)&&Cb===this.sBm?this.$mi:this.Zmi?this.Zmi.xEd(Za):null}}Object(m.a)(Y,"SimpleNamedFeatureBundleResolver",null,[1253]);class ca{constructor(Za){this.Ab=Za}isMatch(Za,Cb){if(!Object(K.a)(1211,Za))throw Error.argument("objToTest","Expected feature bundle");Za=this.Ab.query.Ys(null,new Y(this.Ab.lce,
Za,Cb));if("boolean"!==typeof Za)throw Error.invalidOperation("Query did not return bool");return Za}}Object(m.a)(ca,"PredicateAnnotationFilter",null,[1240]);class fa{constructor(Za,Cb){Za&&(this.lce=Cb.getString(Za.J(0)),this.query=Cb.QJ(Za.J(1)))}}Object(m.a)(fa,"PredicateAnnotationFilterInit",null,[]);class sa{constructor(Za){this.Ab=Za}isMatch(Za,Cb){if("boolean"!==typeof Za)throw Error.argument("objToTest","Expected bool value");Cb=this.Ab.query.Ys(null,Cb);if("boolean"!==typeof Cb)throw Error.invalidOperation("Query did not return bool");
return Za===Cb}}Object(m.a)(sa,"QueryBooleanFilter",null,[1240]);class ia{constructor(Za,Cb){this.Ab=Za;this.J6=Cb}isMatch(Za,Cb){if("number"!==typeof Za)throw Error.argument("objToTest","Expected integer");Cb=this.Ab.query.Ys(null,Cb);if("number"!==typeof Cb)throw Error.invalidOperation("Query did not return an enum value");switch(this.J6){case 0:return Za===Cb;case 1:return 0!==(Za&Cb);case 2:return Za===(Za&Cb);case 3:return Cb===(Za&Cb);default:throw Error.notImplemented();}}}Object(m.a)(ia,"QueryEnumFilter",
null,[1240]);class ea{constructor(Za,Cb){Za&&(this.nOd=1===Za.J(0),this.query=Cb.QJ(Za.J(1)))}}Object(m.a)(ea,"QueryEnumFilterInit",null,[]);class da{constructor(Za,Cb){this.Ab=Za;this.J6=Cb}isMatch(Za,Cb){if(!Object(K.a)(1214,Za))throw Error.argument("objToTest","Expected list value");Cb=this.Ab.query.Ys(null,Cb);if(!Object(K.a)(1214,Cb))throw Error.invalidOperation("Query did not return list value");if(Za.F2!==Cb.F2)return!1;switch(this.J6){case 0:return G.Annotations.bmb(G.Annotations.gwl(Za.F2),
Za,Cb);case 1:for(const Rb of Za.items)for(const pc of Cb.items)if(G.Annotations.bmb(Za.F2,Rb,pc))return!0;return!1;case 2:for(const Rb of Za.items)for(const pc of Cb.items)if(!G.Annotations.bmb(Za.F2,Rb,pc))return!1;return!0;case 3:for(const Rb of Cb.items)for(const pc of Za.items)if(!G.Annotations.bmb(Za.F2,Rb,pc))return!1;return!0;default:throw Error.notImplemented();}}}Object(m.a)(da,"QueryListFilter",null,[1240]);class ja{constructor(Za,Cb){this.Ab=Za;this.J6=Cb}isMatch(Za,Cb){if("string"!==
typeof Za)throw Error.argument("objToTest","Expected string");Cb=this.Ab.query.Ys(null,Cb);if("string"!==typeof Cb)throw Error.invalidOperation("Query did not return string");this.Ab.Xnf&&(Za=Za.toUpperCase(),Cb=Cb.toUpperCase());switch(this.J6){case 0:return Za===Cb;case 1:return 0<=Za.indexOf(Cb);case 2:return Za.startsWith(Cb);case 3:return Za.endsWith(Cb);case 4:return 0<=Cb.indexOf(Za);case 5:return Cb.startsWith(Za);case 6:return Cb.endsWith(Za);default:throw Error.notImplemented();}}}Object(m.a)(ja,
"QueryStringFilter",null,[1240]);class Ga{constructor(Za,Cb){Za&&(this.query=Cb.QJ(Za.J(0)),this.Xnf=1===Za.J(1))}}Object(m.a)(Ga,"QueryStringFilterInit",null,[]);class ya{constructor(Za){this.Ab=Za}isMatch(Za,Cb){if(!Object(K.a)(1215,Za))throw Error.argument("objToTest","Expected struct value");Cb=this.Ab.query.Ys(null,Cb);if(!Object(K.a)(1215,Cb))throw Error.invalidOperation("Query did not return struct value");return Za.isEqual(Za)}}Object(m.a)(ya,"QueryStructFilter",null,[1240]);class ta{constructor(Za){this.Ab=
Za}isMatch(Za,Cb){Za=this.Ab.query.Ys(null,Cb);if("boolean"!==typeof Za)throw Error.invalidOperation("Query did not return bool");return Za}}Object(m.a)(ta,"QueryWhereConstraintFilter",null,[1240]);class ua{constructor(Za){this.Ab=Za}isMatch(Za){if("string"!==typeof Za)throw Error.argument("objToTest","Expected string");return this.Ab.uPf.test(Za)}}Object(m.a)(ua,"RegexStringFilter",null,[1240]);class Sa{constructor(Za,Cb){Za&&(this.uPf=Cb.Q2b(Za.J(0)))}}Object(m.a)(Sa,"RegexStringFilterInit",null,
[]);class ka{constructor(Za,Cb){Za&&(this.filter=Cb.Tka(Za.J(0)))}}Object(m.a)(ka,"SingleFilterFilterInit",null,[]);class ha{constructor(Za,Cb){Za&&(this.query=Cb.QJ(Za.J(0)))}}Object(m.a)(ha,"SingleQueryFilterInit",null,[]);class Ca{constructor(Za){this.Ab=Za}isMatch(Za){if("boolean"!==typeof Za)throw Error.argument("objToTest","Expected bool value");return Za===this.Ab.value}}Object(m.a)(Ca,"StoredValueBooleanFilter",null,[1240]);class Pa{constructor(Za){Za&&(this.value=1===Za.J(0))}}Object(m.a)(Pa,
"StoredValueBooleanFilterInit",null,[]);class Xa{constructor(Za,Cb){this.Ab=Za;this.J6=Cb}isMatch(Za){if("number"!==typeof Za)throw Error.argument("objToTest","Expected integer");switch(this.J6){case 0:return this.Ab.nOd?this.Ab.value?!!(Za&this.Ab.value):!Za:Za===this.Ab.value;case 1:return this.Ab.nOd?(Za&this.Ab.value)===this.Ab.value:32>Za&&(1<<Za&this.Ab.value)===this.Ab.value;case 2:return this.Ab.nOd?!!(Za&this.Ab.value):32>Za&&!!(1<<Za&this.Ab.value);default:throw Error.notImplemented();}}}
Object(m.a)(Xa,"StoredValueEnumFilter",null,[1240]);class qa{constructor(Za){Za&&(this.nOd=1===Za.J(0),this.value=Za.J(1))}}Object(m.a)(qa,"StoredValueEnumFilterInit",null,[]);class Ea{constructor(){this.k0m=null;this.vTe=this.sBb=0}}Object(m.a)(Ea,"WHEREConstraintData",null,[]);class Ia{constructor(Za){this.Ab=Za}isMatch(Za,Cb){if(!Object(K.a)(Ea,Za))throw Error.argument("objToTest","Expected WHERE constraint data");let Rb=-1,pc=-1;const Rc=Za.k0m;switch(this.Ab.mUe){case 4:Rb=Rc.HFc;pc=Rc.f0f;break;
case 5:Rb=Za.sBb;pc=Rc.HFc-Za.sBb;break;case 6:Rb=Rc.HFc+Rc.f0f;pc=Za.sBb+Za.vTe-Rb;break;case 1:case 2:case 3:let wb=!1;for(let Td=Rc.Ryo;Td;Td=Td.next)if(this.Ab.cmo===Td.name){wb=!0;1===this.Ab.mUe?(Rb=Td.HFc,pc=Td.f0f):2===this.Ab.mUe?(Rb=Za.sBb,pc=Td.HFc-Za.sBb):(Rb=Td.HFc+Td.f0f,pc=Za.sBb+Za.vTe-Rb);break}if(!wb)return!1;break;case 7:Rb=Za.sBb;pc=Za.vTe;break;default:throw Error.notImplemented();}return null!==this.Ab.OZn.VBo(Rc.zIo,Rb,pc,Rb,!0,2,Cb)}}Object(m.a)(Ia,"SubSreWhereConstraintFilter",
null,[1240]);class na{constructor(Za,Cb){if(Za){var Rb=Cb.getString(Za.J(0));this.mUe=Rb.charCodeAt(0);this.cmo=Rb.substr(1);this.OZn=Cb.CFl(Za.J(1))}}}Object(m.a)(na,"SubSreWhereConstraintFilterInit",null,[]);class Na{constructor(Za){this.Ab=Za}isMatch(Za,Cb,Rb=null){if(!Object(K.a)(1211,Za))throw Error.argument("objToTest","Expected feature bundle");if(null==Rb)throw Error.argumentNull("parentTextForSpan");if(this.Ab.K$g&&!this.Ab.K$g.isMatch(Za,Cb))return!1;if(this.Ab.E3f){let pc;if(({value:pc}=
Za.jq(this.Ab.LYn)).returnValue){if(!this.Ab.E3f.isMatch(pc,Cb))return!1}else{let Rc,wb;if(!({value:Rc}=Za.jq(this.Ab.b5i)).returnValue||!({value:wb}=Za.jq(this.Ab.a5i)).returnValue||0>Rc||0>wb||Rc+wb>Rb.length||!this.Ab.E3f.isMatch(Rb.substr(Rc,wb),Cb))return!1}}if(this.Ab.Y5i){let pc;if(!({value:pc}=Za.jq(this.Ab.b5i)).returnValue||!this.Ab.Y5i.isMatch(pc,Cb))return!1}if(this.Ab.jji){let pc;if(!({value:pc}=Za.jq(this.Ab.a5i)).returnValue||!this.Ab.jji.isMatch(pc,Cb))return!1}return!0}}Object(m.a)(Na,
"TextSpanFilter",null,[1240]);class Oa{constructor(Za,Cb){Za&&(this.annotations=Cb.annotations,this.b5i=Za.J(0),this.a5i=Za.J(1),this.LYn=Za.J(2),this.E3f=Za.J(3)?Cb.Tka(Za.J(3)):null,this.K$g=Za.J(4)?Cb.Tka(Za.J(4)):null,this.Y5i=Za.J(5)?Cb.Tka(Za.J(5)):null,this.jji=Za.J(6)?Cb.Tka(Za.J(6)):null)}}Object(m.a)(Oa,"TextSpanFilterInit",null,[]);class Ra{constructor(Za,Cb){Za&&(this.annotations=Cb.annotations,this.dra=Za.J(0),this.N8f=Za.J(1)?Cb.Tka(Za.J(1)):null)}}Object(m.a)(Ra,"ValueFilterAnnotationFilterInit",
null,[]);var ab=d(1482);class zb{Tka(Za,Cb){const Rb=Za.J(0),pc=new ab.a;pc.Acb(Za,1,Za.count-1);switch(Rb){case 1:return new P(new W(pc,Cb),0);case 2:return new P(new W(pc,Cb),1);case 3:return new P(new W(pc,Cb),2);case 101:return new ua(new Sa(pc,Cb));case 103:return new ja(new Ga(pc,Cb),0);case 104:return new ja(new Ga(pc,Cb),1);case 105:return new ja(new Ga(pc,Cb),2);case 106:return new ja(new Ga(pc,Cb),3);case 107:return new ja(new Ga(pc,Cb),4);case 108:return new ja(new Ga(pc,Cb),5);case 109:return new ja(new Ga(pc,
Cb),6);case 201:return new Ca(new Pa(pc));case 202:return new sa(new ha(pc,Cb));case 301:return new X(new V(pc,Cb),0);case 302:return new X(new V(pc,Cb),1);case 303:return new X(new V(pc,Cb),2);case 304:return new X(new V(pc,Cb),3);case 305:return new X(new V(pc,Cb),4);case 401:return new Xa(new qa(pc),0);case 402:return new Xa(new qa(pc),1);case 403:return new Xa(new qa(pc),2);case 404:return new ia(new ea(pc,Cb),0);case 405:return new ia(new ea(pc,Cb),1);case 406:return new ia(new ea(pc,Cb),2);
case 407:return new ia(new ea(pc,Cb),3);case 501:return new J(new L(pc,Cb));case 502:return new ya(new ha(pc,Cb));case 601:return new R(new ka(pc,Cb),0);case 602:return new R(new ka(pc,Cb),1);case 603:return new C(new ka(pc,Cb));case 604:return new da(new ha(pc,Cb),0);case 605:return new da(new ha(pc,Cb),1);case 606:return new da(new ha(pc,Cb),2);case 607:return new da(new ha(pc,Cb),3);case 701:return new I(!1);case 702:return new I(!0);case 703:return new H(new Ra(pc,Cb),!1);case 704:return new H(new Ra(pc,
Cb),!0);case 705:return new N(new Ra(pc,Cb),!1);case 706:return new N(new Ra(pc,Cb),!0);case 707:return new ca(new fa(pc,Cb));case 901:return new Na(new Oa(pc,Cb));case 1002:return new ta(new ha(pc,Cb));case 1001:return new Ia(new na(pc,Cb));default:throw Error.argument("initData");}}}Object(m.a)(zb,"FilterFactory",null,[1213]);var Qa=d(1459);class yb{constructor(Za){this.Ab=Za}get WC(){return this.Ab.WC}get h3(){return this.Ab.h3}get n9d(){return this.Ab.n9d}get WMd(){return this.Ab.WMd}load(Za,
Cb){return this.Ys(Za,Za?new Y("root",Za,Cb):Cb)}store(Za,Cb,Rb){this.Nec(Za,Cb,Za?new Y("root",Za,Rb):Rb,null)}Ys(Za,Cb){if(!this.WMd&&!this.Ab.annotations.i6b(this.WC,Za))throw Error.argument("input","Input value not of expected type");let Rb=this.Ab.bHh;for(;Rb;)Za=Rb.load(Za,Cb),Rb=Rb.next;return Za}Nec(Za,Cb,Rb,pc){if(!this.n9d)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.WMd&&!this.Ab.annotations.i6b(this.WC,Za))throw Error.argument("lvalue",
"Lvalue not of expected type");if(!this.Ab.annotations.i6b(this.h3,Cb))throw Error.argument("rvalue","Rvalue not of expected type");return this.Ab.bHh.store(Za,Cb,Rb,pc)}static Imh(Za,Cb,Rb,pc){if(Rb===pc)return Cb;if(G.Annotations.hH(Rb)&&G.Annotations.hH(pc)){Rb=G.Annotations.XXa(Rb);pc=G.Annotations.XXa(pc);const Rc=new Qa.a(Za,pc);for(const wb of Cb.items)Array.add(Rc.items,yb.Imh(Za,wb,Rb,pc));return Rc}if(Rb===G.Annotations.JEa){if(pc===G.Annotations.boa)return Cb;if(pc===G.Annotations.H7)return Cb.toString()}else if(Rb===
G.Annotations.boa){if(pc===G.Annotations.JEa)return Math.floor(Cb);if(pc===G.Annotations.H7)return Cb.toString()}else if(Rb===G.Annotations.H7){if(pc===G.Annotations.JEa)return parseInt(Cb);if(pc===G.Annotations.boa)return parseFloat(Cb)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(m.a)(yb,"AnnotationQuery",null,[1243]);class lb{constructor(){this.h3=this.WC=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}aYa(Za){if(this.next)return{returnValue:this.next,
hEa:Za};if(Za){const Cb=Za.Jph;Za=Za.KEi;return{returnValue:Cb,hEa:Za}}return{returnValue:null,hEa:Za}}}Object(m.a)(lb,"AnnotationQueryStep",null,[1264]);class Eb extends lb{constructor(Za){super();this.Ab=Za}load(Za,Cb){Cb=this.Ab.query.Ys(Za,Cb);if(G.Annotations.hH(this.WC)){var Rb=G.Annotations.XXa(this.WC);let Rc=new Qa.a(this.Ab.annotations,Rb);if(G.Annotations.hH(this.Ab.query.h3)){if(Za.items.length!==Cb.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");
for(let wb=0,Td=Za.items.length;wb<Td;++wb)Array.add(Rc.items,this.xsd(Za.items[wb],Cb.items[wb],Rb===G.Annotations.boa))}else for(var pc of Za.items)Array.add(Rc.items,this.xsd(pc,Cb,Rb===G.Annotations.boa));return Rc}if(G.Annotations.hH(this.Ab.query.h3)){pc=new Qa.a(this.Ab.annotations,this.WC);for(Rb of Cb.items)Array.add(pc.items,this.xsd(Za,Rb,this.WC===G.Annotations.boa));return pc}return this.xsd(Za,Cb,this.WC===G.Annotations.boa)}xsd(Za,Cb,Rb){Za=this.bYb(Za,Cb);return Rb?Za:Math.floor(Za)}}
Object(m.a)(Eb,"NumericAnnotationQueryStep",lb,[]);class bc extends Eb{constructor(Za){super(Za)}bYb(Za,Cb){return Za+Cb}}Object(m.a)(bc,"AddAnnotationQueryStep",Eb,[]);class Pb extends lb{constructor(Za){super();this.Ab=Za}load(Za,Cb){if(this.WC===G.Annotations.Jva&&this.Ab.query.h3===G.Annotations.Jva){let Rc;if(({result:Rc}=this.wih(Za)).returnValue)return Rc}if(G.Annotations.hH(this.WC)){var Rb=new Qa.a(this.Ab.annotations,G.Annotations.Jva);Cb=this.Ab.query.Ys(Za,Cb);if(G.Annotations.hH(this.Ab.query.h3)){if(Za.items.length!==
Cb.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Rc=0,wb=Za.items.length;Rc<wb;++Rc)Array.add(Rb.items,this.XAc(Cb.items[Rc],Za.items[Rc]))}else for(var pc of Za.items)Array.add(Rb.items,this.XAc(Cb,pc));return Rb}pc=this.Ab.query.Ys(Za,Cb);if(G.Annotations.hH(this.Ab.query.h3)){Cb=new Qa.a(this.Ab.annotations,G.Annotations.Jva);for(Rb of pc.items)Array.add(Cb.items,this.XAc(Rb,Za));return Cb}return this.XAc(pc,Za)}}Object(m.a)(Pb,"BinaryBooleanAnnotationQueryStep",
lb,[]);class Va extends Pb{constructor(Za){super(Za)}wih(Za){return{returnValue:!Za,result:!1}}XAc(Za,Cb){return Za&&Cb}}Object(m.a)(Va,"AndAnnotationQueryStep",Pb,[]);class oa{constructor(Za){Za&&(this.annotations=Za)}}Object(m.a)(oa,"AnnotationsOnlyQueryStepInit",null,[]);class pa extends lb{constructor(Za){super();this.Ab=Za}load(Za,Cb){Cb=this.Ab.query.Ys(Za,Cb);Za=Za.clone();G.Annotations.hH(this.Ab.query.h3)?Array.addRange(Za.items,Cb.items):Array.add(Za.items,Cb);return Za}}Object(m.a)(pa,
"AppendAnnotationQueryStep",lb,[]);class Ya extends lb{constructor(Za){super();this.Ab=Za}load(Za,Cb){if(this.WC===G.Annotations.wU)return this.UEc(Za,Cb);const Rb=new Qa.a(this.Ab.annotations,G.Annotations.wU);for(const pc of Za.items)Array.add(Rb.items,this.UEc(pc,Cb));return Rb}UEc(Za,Cb){const Rb=new F.a(this.Ab.annotations);Rb.$Va(Za);Za=new F.a(this.Ab.annotations);this.Ab.script.pKa(null,new Y("Input",Rb,new Y("Output",Za,Cb)));return Za}}Object(m.a)(Ya,"ApplyAnnotationQueryStep",lb,[]);class Ja extends lb{constructor(Za){super();
this.Ab=Za}load(Za,Cb){if(this.WC===G.Annotations.wU)return Cb=this.UEc(Za,Cb),Cb.jq(this.Ab.I$g).returnValue||new Qa.a(this.Ab.annotations,G.Annotations.wU),Cb;const Rb=new Qa.a(this.Ab.annotations,G.Annotations.wU);for(const pc of Za.items)if(Za=this.UEc(pc,Cb),({value:Za}=Za.jq(this.Ab.I$g)).returnValue)for(const Rc of Za.items)Array.add(Rb.items,Rc);return Rb}UEc(Za,Cb){const Rb=new F.a(this.Ab.annotations);Rb.$Va(Za);Za=new F.a(this.Ab.annotations);this.Ab.script.pKa(null,new Y("Input",Rb,new Y("Output",
Za,Cb)));return Za}}Object(m.a)(Ja,"ApplyExpandAnnotationQueryStep",lb,[]);class nb{constructor(Za,Cb){Za&&(this.annotations=Cb.annotations,this.script=Cb.jzb(Za.J(0)),this.I$g=Za.J(1))}}Object(m.a)(nb,"ApplyExpandQueryStepInit",null,[]);class Bb{constructor(Za,Cb){Za&&(this.annotations=Cb.annotations,this.script=Cb.jzb(Za.J(0)))}}Object(m.a)(Bb,"ApplyQueryStepInit",null,[]);class mb extends lb{constructor(Za){super();this.Ab=Za}load(Za){if(this.WC===G.Annotations.wU)return this.SRd(Za);const Cb=
new Qa.a(this.Ab.annotations,this.Ab.annotations.getAttributeType(this.Ab.dra));for(const Rb of Za.items)Array.add(Cb.items,this.SRd(Rb));return Cb}store(Za,Cb,Rb,pc){if(this.WC===G.Annotations.wU){var Rc=Cb,wb=({hEa:pc}=this.aYa(pc)).returnValue;wb&&(Rc=wb.store(G.Annotations.qS(this.SRd(Za)),Cb,Rb,pc));Za.ay(this.Ab.dra,Rc)}else{var Td=Cb;if(Rc=({hEa:pc}=this.aYa(pc)).returnValue){Td=new Qa.a(this.Ab.annotations,this.Ab.annotations.getAttributeType(this.Ab.dra));for(wb of Za.items)Array.add(Td.items,
this.SRd(wb));Td=Rc.store(Td,Cb,Rb,pc)}Cb=Td;if(Cb.items.length!==Za.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let sd=0,Me=Za.items.length;sd<Me;++sd)Rb=Za.items[sd],Rb.isReadOnly&&(Rb=Rb.clone(),Za.items[sd]=Rb),Rb.ay(this.Ab.dra,Cb.items[sd])}return Za}SRd(Za){({value:Za}=Za.jq(this.Ab.dra)).returnValue||(Za=this.Ab.annotations.Fgl(this.Ab.dra));return Za}}Object(m.a)(mb,"AttrAnnotationQueryStep",lb,[]);class Qb{constructor(Za,Cb){Za&&
(this.annotations=Cb,this.dra=Za.J(0))}}Object(m.a)(Qb,"AttrQueryStepInit",null,[]);class Vb extends lb{constructor(Za){super();this.Ab=Za}load(Za){const Cb=new F.a(this.Ab.annotations);Cb.$Va(Za);return this.Ab.module.execute(Cb)}}Object(m.a)(Vb,"CallModuleAnnotationQueryStep",lb,[]);class mc{constructor(Za,Cb){Za&&(this.annotations=Cb.annotations,this.module=Cb.ief(Za.J(0)))}}Object(m.a)(mc,"CallModuleQueryStepInit",null,[]);class ob extends lb{constructor(Za){super();this.Ab=Za}load(Za,Cb){if(G.Annotations.hH(this.WC)){var Rb=
this.Ab.query.Ys(Za,Cb);Cb=new Qa.a(this.Ab.annotations,G.Annotations.H7);let wb="string"===typeof Rb;for(var pc of Za.items)if(wb)Array.add(Cb.items,pc+Rb);else for(var Rc of Rb.items)Array.add(Cb.items,pc+Rc);return Cb}pc=this.Ab.query.Ys(Za,Cb);if("string"===typeof pc)return Za+pc;Rc=new Qa.a(this.Ab.annotations,G.Annotations.H7);for(Rb of pc.items)Array.add(Rc.items,Za+Rb);return Rc}}Object(m.a)(ob,"ConcatAnnotationQueryStep",lb,[]);class cb extends lb{constructor(Za){super();this.Ab=Za}load(Za){return yb.Imh(this.Ab.annotations,
Za,this.WC,this.h3)}}Object(m.a)(cb,"ConvertAnnotationQueryStep",lb,[]);class db extends lb{constructor(){super()}load(Za){return Za.items.length}}Object(m.a)(db,"CountAnnotationQueryStep",lb,[]);class kb extends Eb{constructor(Za){super(Za)}bYb(Za,Cb){return Za/Cb}}Object(m.a)(kb,"DivideAnnotationQueryStep",Eb,[]);class Wb extends lb{constructor(Za){super();this.Ab=Za}load(Za,Cb){Cb=new Y(this.Ab.lce,null,Cb);for(const Rb of Za.items)if(Cb.EUe(Rb),this.Ab.query.Ys(Rb,Cb))return!0;return!1}}Object(m.a)(Wb,
"ExistsAnnotationQueryStep",lb,[]);class Fb extends Eb{constructor(Za){super(Za)}bYb(Za,Cb){return Math.pow(Za,Cb)}}Object(m.a)(Fb,"ExpAnnotationQueryStep",Eb,[]);class nc{constructor(Za,Cb){Za&&(this.xKa=Cb.getString(Za.J(0)))}}Object(m.a)(nc,"FeatureBundleNameQueryStepInit",null,[]);class gc extends lb{constructor(Za){super();this.Ab=Za}load(Za){if(G.Annotations.hH(this.WC)){const Cb=new Qa.a(this.Ab.annotations,this.Ab.annotations.xAb(G.Annotations.XXa(this.WC),this.Ab.zKa));for(const Rb of Za.items)Array.add(Cb.items,
Rb.ddb(this.Ab.zKa));return Cb}return Za.ddb(this.Ab.zKa)}store(Za,Cb,Rb,pc){if(G.Annotations.hH(this.WC)){var Rc=Cb,wb=({hEa:pc}=this.aYa(pc)).returnValue;if(wb){Rc=new Qa.a(this.Ab.annotations,this.Ab.annotations.xAb(G.Annotations.XXa(this.WC),this.Ab.zKa));for(var Td of Za.items)Array.add(Rc.items,Td.ddb(this.Ab.zKa));Rc=wb.store(Rc,Cb,Rb,pc)}Cb=Rc;if(Cb.items.length!==Za.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(let sd=0,Me=Za.items.length;sd<
Me;++sd)Rb=Za.items[sd],Rb.isReadOnly&&(Rb=Rb.clone(),Za.items[sd]=Rb),Rb.yWf(this.Ab.zKa,Cb.items[sd])}else wb=Cb,(Td=({hEa:pc}=this.aYa(pc)).returnValue)&&(wb=Td.store(G.Annotations.qS(Za.ddb(this.Ab.zKa)),Cb,Rb,pc)),Za.yWf(this.Ab.zKa,wb);return Za}}Object(m.a)(gc,"FieldAnnotationQueryStep",lb,[]);class Jc{constructor(Za,Cb){Za&&(this.annotations=Cb,this.zKa=Za.J(0))}}Object(m.a)(Jc,"FieldQueryStepInit",null,[]);class tb extends lb{constructor(Za){super();this.Ab=Za}load(Za,Cb){for(const Rb of Za.items)if(this.Ab.filter.isMatch(Rb,
Cb))return Rb;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(Za,Cb,Rb,pc){let Rc=Cb,wb=-1;for(let sd=0,Me=Za.items.length;sd<Me;sd++)if(this.Ab.filter.isMatch(Za.items[sd],Rb)){wb=sd;break}if(0>wb)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const Td=({hEa:pc}=this.aYa(pc)).returnValue;Td&&(Rc=Td.store(G.Annotations.qS(Za.items[wb]),Cb,Rb,pc));Za.items[wb]=Rc;return Za}}Object(m.a)(tb,"FirstItemMatchingAnnotationQueryStep",
lb,[]);class dc extends lb{constructor(Za){super();this.Ab=Za}load(Za,Cb){Cb=new Y(this.Ab.lce,null,Cb);for(const Rb of Za.items)if(Cb.EUe(Rb),!this.Ab.query.Ys(Rb,Cb))return!1;return!0}}Object(m.a)(dc,"ForAllAnnotationQueryStep",lb,[]);class Yb extends lb{constructor(Za){super();this.Ab=Za}load(Za,Cb){Za=Cb?Cb.xEd(this.Ab.xKa):null;if(!Za)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ab.xKa+'"');return Za}store(Za,Cb,Rb,pc){Za=Rb?Rb.xEd(this.Ab.xKa):null;if(!Za)throw Error.invalidOperation('Feature bundle resolution failure: "'+
this.Ab.xKa+'"');let Rc=Cb;const wb=({hEa:pc}=this.aYa(pc)).returnValue;wb&&(Rc=wb.store(Za,Cb,Rb,pc));Za!==Rc&&Za.$Va(Rc);return Za}}Object(m.a)(Yb,"GetAnnotationQueryStep",lb,[]);class pb{constructor(Za,Cb){this.uyj=Za;this.yPj=Cb}get Jph(){return this.uyj}get KEi(){return this.yPj}}Object(m.a)(pb,"AnnotationQueryStoreContinuation",null,[1267]);class Gb extends lb{constructor(Za){super();this.Ab=Za}load(Za,Cb){return this.Ab.h$d.Ys(Za,Cb)?this.Ab.zbj.Ys(Za,Cb):this.Ab.XAd?this.Ab.XAd.Ys(Za,Cb):
Za}store(Za,Cb,Rb,pc){var Rc=this.Ab.h$d.Ys(Za,Rb);this.next&&(pc=new pb(this.next,pc));if(Rc)return this.Ab.zbj.Nec(Za,Cb,Rb,pc);if(this.Ab.XAd)return this.Ab.XAd.Nec(Za,Cb,Rb,pc);Rc=Cb;let wb=null;pc&&(wb=pc.Jph,pc=pc.KEi);wb&&(Rc=wb.store(G.Annotations.qS(Za),Cb,Rb,pc));return Rc}}Object(m.a)(Gb,"IfAnnotationQueryStep",lb,[]);class hb{constructor(Za,Cb){Za&&(this.h$d=Cb.QJ(Za.J(0)),this.zbj=Cb.QJ(Za.J(1)),this.XAd=Za.J(2)?Cb.QJ(Za.J(2)):null)}}Object(m.a)(hb,"IfQueryStepInit",null,[]);class Ib{constructor(Za,
Cb){Za&&(this.b_l=Cb.QJ(Za.J(0)),this.Ahi=Cb.QJ(Za.J(1)))}}Object(m.a)(Ib,"IndexAndItemQueryStepInit",null,[]);class Ob extends lb{constructor(Za){super();this.Ab=Za}load(Za,Cb){const Rb=this.Ab.b_l.Ys(Za,Cb);Cb=this.Ab.Ahi.Ys(Za,Cb);Za=Za.clone();if(0>Rb||Rb>Za.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(G.Annotations.hH(this.Ab.Ahi.h3))for(let pc=0;pc<Cb.items.length;++pc)Array.insert(Za.items,Rb+pc,Cb.items[pc]);else Array.insert(Za.items,Rb,Cb);
return Za}}Object(m.a)(Ob,"InsertAtAnnotationQueryStep",lb,[]);class kc extends lb{constructor(Za){super();this.Ab=Za}load(Za,Cb){return!(!Cb||!Cb.xEd(this.Ab.xKa))}}Object(m.a)(kc,"IsDefinedAnnotationQueryStep",lb,[]);class Ac extends lb{constructor(Za){super();this.Ab=Za}load(Za,Cb){Cb=this.gI(Za,Cb);return Za.items[Cb]}store(Za,Cb,Rb,pc){const Rc=this.gI(Za,Rb);let wb=Cb;const Td=({hEa:pc}=this.aYa(pc)).returnValue;Td&&(wb=Td.store(G.Annotations.qS(Za.items[Rc]),Cb,Rb,pc));Za.items[Rc]=wb;return Za}gI(Za,
Cb){Cb=this.Ab.query.Ys(Za,Cb);if(0>Cb||Cb>=Za.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Cb}}Object(m.a)(Ac,"ItemAnnotationQueryStep",lb,[]);class Nc extends lb{constructor(Za){super();this.Ab=Za}load(Za,Cb){const Rb=new Qa.a(this.Ab.annotations,G.Annotations.XXa(this.WC));for(const pc of Za.items)this.Ab.filter.isMatch(pc,Cb)&&Array.add(Rb.items,pc);return Rb}}Object(m.a)(Nc,"ItemsMatchingAnnotationQueryStep",lb,[]);class kd extends lb{constructor(Za){super();
this.Ab=Za}load(Za,Cb){Cb=this.gI(Za,Cb);return Za.items[Za.items.length-Cb-1]}store(Za,Cb,Rb,pc){const Rc=this.gI(Za,Rb);let wb=Cb;const Td=({hEa:pc}=this.aYa(pc)).returnValue;Td&&(wb=Td.store(G.Annotations.qS(Za.items[Za.items.length-Rc-1]),Cb,Rb,pc));Za.items[Za.items.length-Rc-1]=wb;return Za}gI(Za,Cb){Cb=this.Ab.query?this.Ab.query.Ys(Za,Cb):0;if(0>Cb||Cb>=Za.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");return Cb}}Object(m.a)(kd,"LastItemAnnotationQueryStep",
lb,[]);class Jd extends lb{constructor(Za){super();this.Ab=Za}load(Za){if(G.Annotations.hH(this.WC)){const Cb=new Qa.a(this.Ab.annotations,G.Annotations.JEa);for(const Rb of Za.items)Array.add(Cb.items,Rb.length);return Cb}return Za.length}}Object(m.a)(Jd,"LengthAnnotationQueryStep",lb,[]);class ge extends lb{constructor(Za){super();this.Ab=Za}load(Za,Cb){if(G.Annotations.hH(this.WC)){const Rb=new Qa.a(this.Ab.annotations,G.Annotations.Jva);for(const pc of Za.items)Array.add(Rb.items,this.Ab.filter.isMatch(pc,
Cb));return Rb}return this.Ab.filter.isMatch(Za,Cb)}}Object(m.a)(ge,"MatchesAnnotationQueryStep",lb,[]);class Oc extends lb{constructor(Za){super();this.Ab=Za}load(Za,Cb){return this.Ab.filter.isMatch(Za,Cb)}}Object(m.a)(Oc,"MatchesAsListAnnotationQueryStep",lb,[]);class qc extends Eb{constructor(Za){super(Za)}bYb(Za,Cb){return Za%Cb}}Object(m.a)(qc,"ModuloAnnotationQueryStep",Eb,[]);class Xc extends Eb{constructor(Za){super(Za)}bYb(Za,Cb){return Za*Cb}}Object(m.a)(Xc,"MultiplyAnnotationQueryStep",
Eb,[]);class xe extends lb{constructor(Za){super();this.Ab=Za}load(Za){if(G.Annotations.hH(this.WC)){const Cb=new Qa.a(this.Ab.annotations,G.Annotations.Jva);for(const Rb of Za.items)Array.add(Cb.items,!Rb);return Cb}return!Za}}Object(m.a)(xe,"NotAnnotationQueryStep",lb,[]);class Ge extends Pb{constructor(Za){super(Za)}wih(Za){return{returnValue:Za,result:!0}}XAc(Za,Cb){return Za||Cb}}Object(m.a)(Ge,"OrAnnotationQueryStep",Pb,[]);class bf extends lb{constructor(Za){super();this.Ab=Za}load(Za,Cb){const Rb=
this.Ab.Y0f.Ys(Za,Cb);Za=this.Ab.JBc.Ys(Za,Cb);Cb=new Qa.a(this.Ab.annotations,G.Annotations.JEa);for(let pc=0;pc<Za;++pc)Array.add(Cb.items,Rb+pc);return Cb}}Object(m.a)(bf,"RangeAnnotationQueryStep",lb,[]);class xd{constructor(Za,Cb){Za&&(this.annotations=Cb.annotations,this.filter=Cb.Tka(Za.J(0)))}}Object(m.a)(xd,"SingleFilterQueryStepInit",null,[]);class ke{constructor(Za,Cb){Za&&(this.annotations=Cb.annotations,this.query=Za.J(0)?Cb.QJ(Za.J(0)):null)}}Object(m.a)(ke,"SingleOptionalQueryQueryStepInit",
null,[]);class Rf{constructor(Za,Cb){Za&&(this.annotations=Cb.annotations,this.query=Cb.QJ(Za.J(0)))}}Object(m.a)(Rf,"SingleQueryQueryStepInit",null,[]);class pd{constructor(Za,Cb){Za&&(this.annotations=Cb.annotations,this.Y0f=Cb.QJ(Za.J(0)),this.JBc=Za.J(1)?Cb.QJ(Za.J(1)):null)}}Object(m.a)(pd,"StartAndCountOrLengthQueryStepInit",null,[]);class fe extends lb{constructor(Za){super();this.Ab=Za}load(Za,Cb){let Rb;({startIndex:Cb,length:Rb}=this.dHd(Za,Cb));const pc=new Qa.a(this.Ab.annotations,Za.F2);
for(let Rc=0;Rc<Rb;++Rc)Array.add(pc.items,Za.items[Cb+Rc]);return pc}store(Za,Cb,Rb,pc){let Rc,wb;({startIndex:Rc,length:wb}=this.dHd(Za,Rb));var Td=Cb;const sd=({hEa:pc}=this.aYa(pc)).returnValue;if(sd){Td=new Qa.a(this.Ab.annotations,Za.F2);for(let Me=0;Me<wb;++Me)Array.add(Td.items,Za.items[Rc+Me]);Td=sd.store(Td,Cb,Rb,pc)}Cb=Td;for(Rb=0;Rb<wb;++Rb)Array.removeAt(Za.items,Rc);for(let Me=0,tf=Cb.items.length;Me<tf;++Me)Array.insert(Za.items,Rc+Me,Cb.items[Me]);return Za}dHd(Za,Cb){let Rb;Rb=this.Ab.Y0f.Ys(Za,
Cb);if(0>Rb)throw Error.invalidOperation("Invalid start index in Sublist() query step");Cb=this.Ab.JBc?this.Ab.JBc.Ys(Za,Cb):Za.items.length-Rb;if(0>Cb||Rb+Cb>Za.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:Rb,length:Cb}}}Object(m.a)(fe,"SublistAnnotationQueryStep",lb,[]);class Ec extends lb{constructor(Za){super();this.Ab=Za}load(Za,Cb){if(G.Annotations.hH(this.WC)){const Rb=new Qa.a(this.Ab.annotations,G.Annotations.H7);
for(let pc=0,Rc=Za.items.length;pc<Rc;++pc)Array.add(Rb.items,this.mYh(Za.items[pc],Cb));return Rb}return this.mYh(Za,Cb)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}mYh(Za,Cb){let Rb;({startIndex:Cb,length:Rb}=this.dHd(Za,Cb));return Za.substr(Cb,Rb)}dHd(Za,Cb){let Rb;Rb=this.Ab.Y0f.Ys(Za,Cb);if(0>Rb)throw Error.invalidOperation("Invalid start index in Substring() query step");Cb=this.Ab.JBc?this.Ab.JBc.Ys(Za,Cb):Za.length-Rb;if(0>Cb||Rb+Cb>Za.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");
return{startIndex:Rb,length:Cb}}}Object(m.a)(Ec,"SubstringAnnotationQueryStep",lb,[]);class rd extends Eb{constructor(Za){super(Za)}bYb(Za,Cb){return Za-Cb}}Object(m.a)(rd,"SubtractAnnotationQueryStep",Eb,[]);class Ld extends lb{constructor(Za){super();this.Ab=Za}load(Za){const Cb=new Qa.a(this.Ab.annotations,G.Annotations.H7);for(let Rb=0;Rb<Za.length;++Rb)Array.add(Cb.items,Za.charAt(Rb).toString());return Cb}}Object(m.a)(Ld,"ToCharListAnnotationQueryStep",lb,[]);class Gf extends lb{constructor(Za){super();
this.Ab=Za}load(Za){const Cb=new Qa.a(this.Ab.annotations,this.WC);Array.add(Cb.items,Za);return Cb}}Object(m.a)(Gf,"ToListAnnotationQueryStep",lb,[]);class ld extends lb{constructor(Za){super();this.Ab=Za}load(){return this.Ab.value}}Object(m.a)(ld,"ValueAnnotationQueryStep",lb,[]);class Pc{constructor(Za,Cb){if(Za){var Rb=Za.J(0),pc=1;this.value=({Fea:pc}=Cb.VJa(Rb,Za,pc,null,null,null)).returnValue;G.Annotations.pEb(this.value)}}}Object(m.a)(Pc,"ValueQueryStepInit",null,[]);class cd{constructor(Za,
Cb){Za&&(this.lce=Cb.getString(Za.J(0)),this.query=Cb.QJ(Za.J(1)))}}Object(m.a)(cd,"VarNameAndQueryQueryStepInit",null,[]);class Aa{constructor(Za,Cb){this.lDg=null;if(Za){this.annotations=Cb.annotations;var Rb=0;this.WC=Za.J(Rb);++Rb;this.h3=Za.J(Rb);++Rb;this.n9d=1===Za.J(Rb);++Rb;this.WMd=1===Za.J(Rb);++Rb;var pc=Za.J(Rb);++Rb;if(pc){var Rc=Rb,wb=Rb+pc,Td=Rb+2*pc;Rb+=3*pc;var sd=Za.count-Rb,Me=null;for(let Pf=0;Pf<pc;++Pf){var tf=Rb+Za.J(Td+Pf);const Yh=(Pf===pc-1?sd:Za.J(Td+Pf+1))-Za.J(Td+Pf),
ti=new ab.a;ti.Acb(Za,tf,Yh);tf=Aa.hyl(Za.J(wb+Pf),ti,Cb);tf.WC=Za.J(Rc+Pf);tf.h3=Pf===pc-1?this.h3:Za.J(Rc+Pf+1);Me?Me.next=tf:this.lDg=tf;Me=tf}}}}get bHh(){return this.lDg}static hyl(Za,Cb,Rb){switch(Za){case 1:return new Yb(new nc(Cb,Rb));case 2:return new kc(new nc(Cb,Rb));case 3:return new mb(new Qb(Cb,Rb.annotations));case 4:return new gc(new Jc(Cb,Rb.annotations));case 5:return new Gb(new hb(Cb,Rb));case 6:return new ge(new xd(Cb,Rb));case 43:return new Oc(new xd(Cb,Rb));case 45:return new Ya(new Bb(Cb,
Rb));case 49:return new Ja(new nb(Cb,Rb));case 46:return new ld(new Pc(Cb,Rb.annotations));case 51:return new Vb(new mc(Cb,Rb));case 52:return new bf(new pd(Cb,Rb));case 53:return new cb(new oa(Rb.annotations));case 13:return new Ac(new Rf(Cb,Rb));case 14:return new kd(new ke(Cb,Rb));case 15:return new db;case 18:return new tb(new xd(Cb,Rb));case 16:return new dc(new cd(Cb,Rb));case 17:return new Wb(new cd(Cb,Rb));case 22:return new Ob(new Ib(Cb,Rb));case 24:return new pa(new Rf(Cb,Rb));case 26:return new fe(new pd(Cb,
Rb));case 27:return new Nc(new xd(Cb,Rb));case 30:return new Gf(new oa(Rb.annotations));case 31:return new Ec(new pd(Cb,Rb));case 32:return new ob(new Rf(Cb,Rb));case 47:return new Jd(new oa(Rb.annotations));case 48:return new Ld(new oa(Rb.annotations));case 34:return new bc(new Rf(Cb,Rb));case 35:return new rd(new Rf(Cb,Rb));case 36:return new Xc(new Rf(Cb,Rb));case 37:return new kb(new Rf(Cb,Rb));case 38:return new qc(new Rf(Cb,Rb));case 39:return new Fb(new Rf(Cb,Rb));case 40:return new Va(new Rf(Cb,
Rb));case 41:return new Ge(new Rf(Cb,Rb));case 42:return new xe(new oa(Rb.annotations));default:throw Error.argument("currStepInitData");}}}Object(m.a)(Aa,"AnnotationQueryInit",null,[]);class Wa{constructor(Za){this.Ab=Za}execute(Za,Cb){this.pKa(Za,Za?new Y("root",Za,Cb):Cb)}pKa(Za,Cb){for(const Rb of this.Ab.commands)Cb=Rb.execute(Za,Cb)}}Object(m.a)(Wa,"AnnotationScript",null,[1242]);class $b{constructor(Za){this.Ab=Za}execute(Za,Cb){const Rb=this.Ab.W2l.Ys(Za,Cb),pc=this.Ab.gZm.Ys(Za,Cb);this.Ab.script.pKa(Za,
new Y("Input",Rb,new Y("Output",pc,Cb)));return Cb}}Object(m.a)($b,"ApplyAnnotationScriptCommand",null,[1257]);class xc{constructor(Za,Cb){Za&&(this.W2l=Cb.QJ(Za.J(0)),this.gZm=Cb.QJ(Za.J(1)),this.script=Cb.jzb(Za.J(2)))}}Object(m.a)(xc,"ApplyScriptCommandInit",null,[]);class bd{constructor(Za){this.Ab=Za}execute(Za,Cb){const Rb=this.Ab.gUf.Ys(Za,Cb);this.Ab.ASd.Nec(Za,Rb,Cb,null);return Cb}}Object(m.a)(bd,"AssignAnnotationScriptCommand",null,[1257]);class Wd{constructor(Za){this.Ab=Za}execute(Za,
Cb){const Rb=this.Ab.ASd.Ys(Za,Cb);Za=this.Ab.gUf.Ys(Za,Cb);Rb!==Za&&Rb.$Va(Za);return Cb}}Object(m.a)(Wd,"CopyAnnotationScriptCommand",null,[1257]);class vf{constructor(Za){this.Ab=Za}execute(Za,Cb){let Rb=this.Ab.qvf.Ys(Za,Cb);if(this.Ab.qvf.n9d){Rb=G.Annotations.qS(Rb);var pc=new Y(this.Ab.xKa,null,Cb);for(let wb=0,Td=Rb.items.length;wb<Td;++wb){var Rc=this.QDh(Za,Rb.items[wb],pc);if(0>this.Ab.q3d)Rb.items[wb]=Rc;else if(({value:Rc}=Rc.jq(this.Ab.q3d)).returnValue)Rb.items[wb]=Rc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");
}this.Ab.qvf.Nec(Za,Rb,Cb,null)}else{pc=new Y(this.Ab.xKa,null,Cb);for(let wb=0,Td=Rb.items.length;wb<Td;++wb)this.QDh(Za,Rb.items[wb],pc)}return Cb}QDh(Za,Cb,Rb){let pc;0>this.Ab.q3d?pc=G.Annotations.qS(Cb):(pc=new F.a(this.Ab.annotations),pc.ay(this.Ab.q3d,Cb));Rb.EUe(pc);this.Ab.ihk.pKa(Za,Rb);return pc}}Object(m.a)(vf,"EnumerateAnnotationScriptCommand",null,[1257]);class uf{constructor(Za,Cb){Za&&(this.annotations=Cb.annotations,this.xKa=Cb.getString(Za.J(0)),this.qvf=Cb.QJ(Za.J(1)),this.ihk=
Cb.jzb(Za.J(2)),this.q3d=Za.J(3))}}Object(m.a)(uf,"EnumerateScriptCommandInit",null,[]);class oe{constructor(Za){this.Ab=Za}execute(Za,Cb){this.Ab.h$d.Ys(Za,Cb)?this.Ab.V9n.pKa(Za,Cb):this.Ab.REh&&this.Ab.REh.pKa(Za,Cb);return Cb}}Object(m.a)(oe,"IfAnnotationScriptCommand",null,[1257]);class Pe{constructor(Za,Cb){Za&&(this.h$d=Cb.QJ(Za.J(0)),this.V9n=Cb.jzb(Za.J(1)),this.REh=Za.J(2)?Cb.jzb(Za.J(2)):null)}}Object(m.a)(Pe,"IfScriptCommandInit",null,[]);class We{constructor(Za,Cb){Za&&(this.annotations=
Cb.annotations,this.ASd=Cb.QJ(Za.J(0)),this.gUf=Cb.QJ(Za.J(1)))}}Object(m.a)(We,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class Xi{constructor(Za){this.Ab=Za}execute(Za,Cb){const Rb=this.Ab.gUf.Ys(this.Ab.ASd.Ys(Za,Cb),Cb);this.Ab.ASd.Nec(Za,Rb,Cb,null);return Cb}}Object(m.a)(Xi,"ModifyAnnotationScriptCommand",null,[1257]);class zf{constructor(Za){this.Ab=Za}execute(Za,Cb){const Rb=new F.a(this.Ab.annotations);this.Ab.query&&Rb.$Va(this.Ab.query.Ys(Za,Cb));return Cb=new Y(this.Ab.xKa,Rb,Cb)}}
Object(m.a)(zf,"NewAnnotationScriptCommand",null,[1257]);class sf{constructor(Za,Cb){Za&&(this.annotations=Cb.annotations,this.xKa=Cb.getString(Za.J(0)),this.query=Za.J(1)?Cb.QJ(Za.J(1)):null)}}Object(m.a)(sf,"NewScriptCommandInit",null,[]);class Ye{constructor(Za){this.Ab=Za}execute(Za,Cb){Za=this.Ab.query.Ys(Za,Cb);if(this.Ab.query.h3===G.Annotations.wU)Za.pOa(this.Ab.dra);else for(const Rb of Za.items)Rb.pOa(this.Ab.dra);return Cb}}Object(m.a)(Ye,"RemoveAnnotationScriptCommand",null,[1257]);class Bh{constructor(Za,
Cb){Za&&(this.annotations=Cb.annotations,this.query=Cb.QJ(Za.J(0)),this.dra=Za.J(1))}}Object(m.a)(Bh,"RemoveScriptCommandInit",null,[]);class Sg{constructor(Za,Cb){if(Za){var Rb=0,pc=Za.J(Rb);++Rb;if(pc){var Rc=Rb,wb=Rb+pc;Rb+=2*pc;var Td=Za.count-Rb;this.commands=Array(pc);for(let sd=0;sd<pc;++sd){const Me=Rb+Za.J(wb+sd),tf=(sd===pc-1?Td:Za.J(wb+sd+1))-Za.J(wb+sd),Pf=new ab.a;Pf.Acb(Za,Me,tf);this.commands[sd]=Sg.Yxl(Za.J(Rc+sd),Pf,Cb)}}}}static Yxl(Za,Cb,Rb){switch(Za){case 1:return new bd(new We(Cb,
Rb));case 2:return new Xi(new We(Cb,Rb));case 3:return new Ye(new Bh(Cb,Rb));case 6:return new zf(new sf(Cb,Rb));case 7:return new vf(new uf(Cb,Rb));case 8:return new oe(new Pe(Cb,Rb));case 9:return new Wd(new We(Cb,Rb));case 10:return new $b(new xc(Cb,Rb));default:throw Error.argument("initData");}}}Object(m.a)(Sg,"AnnotationScriptInit",null,[]);var Ti=d(1587);class ig{constructor(Za){this.$_=Za;this.jx=0}a7(){const Za=this.$_.Zx(this.jx,4);this.jx+=4;return Za}get xyc(){return this.$_}get offset(){return this.jx}set offset(Za){this.jx=
Za}}Object(m.a)(ig,"ByteArrayReader",null,[]);class Tg{constructor(){this.yI=null;this.eni=this.faa=0}J(Za){if(0>Za||Za>=this.faa)throw Error.argumentOutOfRange("index");return this.yI.Zx(this.eni+4*Za,4)}get count(){return this.faa}static OHk(Za,Cb,Rb){const pc=new Tg;pc.yI=Za;pc.eni=Cb;pc.faa=Rb;return pc}}Object(m.a)(Tg,"ReadOnlyListOverByteArray",null,[1236]);class af{constructor(Za,Cb){this.Ymi=this.Xmi=!1;this.Kv=this.ZMa=this.Twf=this.ani=null;try{this.Kv=Cb.annotations;const Rb=Cb.Qcb(Za.J(0)),
pc=new ig(Rb);if(-914743053!==pc.a7())throw Error.argument("Input does not represent a flat lexicon");this.Xmi=1===pc.a7();this.Ymi=1===pc.a7();const Rc=pc.a7();pc.offset+=Rc;const wb=pc.a7();this.Twf=af.p0m(pc,wb,this.Kv);const Td=pc.a7();this.ani=af.G0m(pc,Td);const sd=pc.a7();this.ZMa=new Ti.a(pc.xyc,pc.offset);pc.offset+=sd}catch(Rb){throw Error.argument("initData");}}get trie(){return this.ZMa}wil(Za){return"i"===Za&&this.Ymi?"\u0130":Za.toUpperCase()}Xnf(){return this.Xmi}Ufl(Za){let Cb;Cb=
new Qa.a(this.Kv,G.Annotations.wU);if(1!==Za)if(0===Za)Za=new F.a(this.Kv),Array.add(Cb.items,Za);else if(Za&1073741824){Za=this.ani[Za&-1073741825];for(let pc=0;pc<Za.length;++pc){var Rb=Za[pc];Rb=0===Rb?new F.a(this.Kv):this.Twf[Rb-2];Array.add(Cb.items,Rb)}}else Array.add(Cb.items,this.Twf[Za-2]);return{returnValue:!0,tpm:Cb}}static p0m(Za,Cb,Rb){if(Cb%4)throw Error.argument("reader");const pc=Tg.OHk(Za.xyc,Za.offset,Cb/4);Za.offset+=Cb;Za=[];for(Cb=0;Cb<pc.count;){const Rc=({Fea:Cb}=Rb.VJa(G.Annotations.wU,
pc,Cb,null,null,null)).returnValue;Array.add(Za,Rc)}return Za}static G0m(Za,Cb){Cb=Za.offset+Cb;const Rb=[];for(;Za.offset<Cb;){const pc=Za.a7(),Rc=Array(pc);for(let wb=0;wb<pc;++wb){const Td=Za.a7();Rc[wb]=Td}Array.add(Rb,Rc)}return Rb}}Object(m.a)(af,"RawFlatLexicon",null,[1241]);var qf=d(1579),gj=d(1580);class Fe{constructor(Za){if(null==Za)throw Error.argumentNull("base64String");const Cb=Za.length;if(Cb%4)throw Error.argument("base64String's length must be a multiple of 4");this.faa=.75*Cb;this.AEb=
Array(Math.ceil(this.faa/4));Za.endsWith("==")?this.faa-=2:Za.endsWith("=")&&--this.faa;let Rb=0;for(let pc=0;pc<Cb;pc+=4){const Rc=Fe.b4d[Za.charCodeAt(pc)-43]<<18|Fe.b4d[Za.charCodeAt(pc+1)-43]<<12|Fe.b4d[Za.charCodeAt(pc+2)-43]<<6|Fe.b4d[Za.charCodeAt(pc+3)-43];let wb=Rc>>16&255;this.AEb[Math.floor(Rb/4)]|=wb<<Rb%4*8;++Rb;wb=Rc>>8&255;this.AEb[Math.floor(Rb/4)]|=wb<<Rb%4*8;++Rb;wb=Rc&255;this.AEb[Math.floor(Rb/4)]|=wb<<Rb%4*8;++Rb}}get length(){return this.faa}J(Za){if(0>Za||Za>=this.faa)throw Error.argumentOutOfRange("i");
return this.vLh(Za)}Zx(Za,Cb){if(0>Za||0>Cb||Za+Cb>this.faa)throw Error.argument("Bad range");let Rb=0;for(let pc=0;pc<Cb;++pc)Rb|=this.vLh(Za+pc)<<8*pc;return Rb}fen(Za,Cb){let Rb=0,pc=0,Rc=Math.floor(Za/8);for(Za%=8;pc<Cb;){const wb=8-Za>Cb-pc?Cb-pc:8-Za,Td=this.J(Rc);Rb|=(Td>>Za&~(255<<wb))<<pc;pc+=wb;++Rc;Za=0}return Rb}vLh(Za){return this.AEb[Math.floor(Za/4)]>>Za%4*8&255}}Fe.b4d=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,
22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(m.a)(Fe,"ByteArray",null,[]);class $e{constructor(Za,Cb,Rb){this.bD=Za;this.oBm=Cb;this.rBm=Rb;this.mni=Array(Za.b?Za.b.length:0);this.qxf=new qf.a(new gj.a(this.Qcb(this.bD.s)));this.H6=Array(Za.t.length);this.uD=new G.Annotations(this.Ncb(0),this)}get annotations(){return this.uD}get bYk(){return this.bD.d}vxl(){if(!(""in this.bD.m))throw Error.argument("name","Unrecognized module");return this.ief(this.bD.m[""])}Qcb(Za){if(0>
Za||!this.bD.b||Za>=this.bD.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.mni[Za]||(this.mni[Za]=new Fe(this.bD.b[Za]))}getString(Za){if(1>Za||Za>=this.bD.t.length)throw Error.argumentOutOfRange("blobID");if(1!==this.bD.t[Za])throw Error.argument("blobID","Requested blob is not a string");if(null==this.H6[Za]){const Cb=this.Ncb(Za).J(0);this.H6[Za]=this.qxf.getString(Cb)}return this.H6[Za]}Q2b(Za){if(1>Za||Za>=this.bD.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.bD.t[Za])throw Error.argument("blobID",
"Requested blob is not a Regex");if(!this.H6[Za]){var Cb=this.Ncb(Za);const Rb=this.getString(Cb.J(0));Cb=1===Cb.J(1);this.H6[Za]=new RegExp(Rb,Cb?"i":"")}return this.H6[Za]}CFl(Za){if(1>Za||Za>=this.bD.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.bD.t[Za])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}ief(Za){if(1>Za||Za>=this.bD.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.bD.t[Za])throw Error.argument("blobID","Requested blob is not an NL module");
return this.H6[Za]||(this.H6[Za]=this.rBm.Oxl(this.Ncb(Za),this))}QJ(Za){if(1>Za||Za>=this.bD.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.bD.t[Za])throw Error.argument("blobID","Requested blob is not an annotation query");return this.H6[Za]||(this.H6[Za]=new yb(new Aa(this.Ncb(Za),this)))}jzb(Za){if(1>Za||Za>=this.bD.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.bD.t[Za])throw Error.argument("blobID","Requested blob is not an annotation script");return this.H6[Za]||
(this.H6[Za]=new Wa(new Sg(this.Ncb(Za),this)))}Tka(Za){if(1>Za||Za>=this.bD.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.bD.t[Za])throw Error.argument("blobID","Requested blob is not a filter");return this.H6[Za]||(this.H6[Za]=this.oBm.Tka(this.Ncb(Za),this))}ODl(Za){if(1>Za||Za>=this.bD.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.bD.t[Za])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.H6[Za]||(this.H6[Za]=new af(this.Ncb(Za),
this))}Ncb(Za){const Cb=this.bD.n[Za];Za=(Za<this.bD.t.length-1?this.bD.n[Za+1]:this.bD.n.length)-Cb;if(0>Cb||0>Za||Cb+Za>this.bD.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Cb+","+Za+")");const Rb=new ab.a;Rb.J9e(this.bD.n,Cb,Za);return Rb}}Object(m.a)($e,"ObjectFetcher",null,[1210]);class Ff{constructor(Za,Cb,Rb){if(!Za)throw Error.argumentNull("prediction");if(!Cb)throw Error.argumentNull("fieldNames");if(!Rb)throw Error.argumentNull("values");if(Cb.length!==
Rb.length)throw Error.argument("values","fieldNames and values do not have same length");this.mPj=Za;this.BEb=Cb;this.LQc=Rb}get prediction(){return this.mPj}get oFh(){return this.BEb.length}ucf(Za){return 0<=Za&&Za<this.BEb.length?this.BEb[Za]:null}getValue(Za){return 0<=Za&&Za<this.LQc.length?this.LQc[Za]:null}}Object(m.a)(Ff,"PredictionData",null,[]);class ye{constructor(Za,Cb){if(!Za)throw Error.argumentNull("predictions");if(!Cb)throw Error.argumentNull("tokenAttributes");this.uBm=Za;this.yBm=
Cb}sff(){return this.uBm}oKh(){return this.yBm}}Object(m.a)(ye,"PredictionDataWithTokenAttributes",null,[]);class Sf{constructor(Za,Cb){this.prediction=null;this.score=0;this.prediction=Za;this.score=Cb}}Object(m.a)(Sf,"PredictionWithScore",null,[]);class vg{constructor(Za,Cb){if(!Za)throw Error.argumentNull("predictions");if(!Cb)throw Error.argumentNull("attributes");this.nPj=Za;this.Iuj=Cb}sff(){return this.nPj}oKh(){return this.Iuj}}Object(m.a)(vg,"PredictionsWithTokenAttributes",null,[]);class Tf{constructor(Za,
Cb,Rb){if(!Za)throw Error.argumentNull("attributeName");if(!Cb)throw Error.argumentNull("fieldNames");if(!Rb)throw Error.argumentNull("values");if(Cb.length!==Rb.length)throw Error.argument("values","fieldNames and values do not have same length");this.Huj=Za;this.BEb=Cb;this.LQc=Rb}get attributeName(){return this.Huj}get oFh(){return this.BEb.length}ucf(Za){return 0<=Za&&Za<this.BEb.length?this.BEb[Za]:null}getValue(Za){return 0<=Za&&Za<this.LQc.length?this.LQc[Za]:null}}Object(m.a)(Tf,"TokenAttributes",
null,[]);var wg=d(43),rf=d(677);class sh{constructor(Za,Cb,Rb,pc,Rc){this.q4c=0;this.u$f=null;this.r4c=this.Chc=0;this.kde=this.mMb=this.roa=this.Dhc=null;this.v$f=0;this.yye=this.VA=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.aR=Za;this.elj=this.ilj=Cb;this.dlj=this.glj=Rb;this.o4c=this.flj=pc;this.p4c=this.hlj=Rc}jlj(){this.r4c=0;return this.s$f}s$f(){if(!(this.r4c<this.o4c))return this.t$f;this.Dhc=this.elj.items[this.r4c+
this.dlj];this.roa=new F.a(this.aR.Ab.annotations);1!==this.o4c&&this.aR.Ab.wMc||this.roa.$Va(this.Dhc);if(0<=this.aR.Ab.kUd){({value:this.mMb}=this.roa.jq(this.aR.Ab.kUd)).returnValue?this.mMb=this.mMb.qS():this.mMb=new Qa.a(this.aR.Ab.annotations,G.Annotations.wU);this.kde=this.p4c.items;this.v$f=this.kde.length;for(this.q4c=0;this.q4c<this.v$f;++this.q4c)this.u$f=this.kde[this.q4c],Array.add(this.mMb.items,this.u$f);this.roa.ay(this.aR.Ab.kUd,this.mMb)}else 0<=this.aR.Ab.T_f?this.roa.ay(this.aR.Ab.T_f,
this.p4c.items[0]):0<=this.aR.Ab.fSe?this.roa.ay(this.aR.Ab.fSe,!0):this.aR.Ab.Odi?this.p4c.items[0].tCd((Za,Cb)=>this.roa.ay(Za,Cb)):(this.roa.$Va(this.p4c.items[0]),1!==this.o4c&&this.aR.Ab.wMc||(({value:this.Chc}=this.Dhc.jq(this.aR.Ab.q1)).returnValue&&this.roa.ay(this.aR.Ab.q1,this.Chc),({value:this.Chc}=this.Dhc.jq(this.aR.Ab.r5)).returnValue&&this.roa.ay(this.aR.Ab.r5,this.Chc),this.Dhc.jq(this.aR.Ab.F$a).returnValue&&this.roa.ay(this.aR.Ab.F$a,this.Chc)));this.VA=this.roa;this._state=2;return this.llj}t$f(){this._state=
3}klj(){this.r4c++;return this.s$f}llj(){return 1<this.o4c&&this.aR.Ab.wMc?this.t$f:this.klj}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new sh(this.aR,this.ilj,this.glj,this.flj,this.hlj)).getEnumerator()}[Symbol.iterator](){return Object(rf.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.yye=this.jlj());for(;1===this._state;)this.yye=this.yye();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");
}get_current(){return this.VA}}Object(m.a)(sh,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[10,74,132]);class si{constructor(Za,Cb,Rb){this.IQc=this.fni=0;this.B8b=null;this.rxf=this.Zwf=this.z8b=this.HSd=this.bxf=0;this.ISd=!1;this.lxf=Za;this.txf=Cb;this.tBm=Rb}gTh(){null===this.B8b&&({D9i:this.B8b,O4h:this.bxf,length:this.HSd,E4k:Za}=this.lxf.HZh(this.txf.items[this.IQc],this.tBm),this.ISd=Za||this.ISd);if(this.z8b<
this.HSd){var Za=this.B8b.charAt(this.bxf+this.z8b);++this.z8b;return{returnValue:!0,ch:Za}}if(this.IQc===this.txf.items.length-1)return{returnValue:!1,ch:"\x00"};++this.IQc;this.z8b=0;this.B8b=null;return{returnValue:!0,ch:" "}}ZPf(Za,Cb){this.z8b===this.HSd&&this.B8b&&(this.rxf=Cb,this.Zwf=this.IQc-this.fni+1)}Sun(Za){if(0>Za||Za>=this.txf.items.length)throw Error.argumentOutOfRange("iToken");this.IQc=this.fni=Za;this.B8b=null;this.Zwf=this.z8b=this.HSd=this.bxf=0;this.rxf=-1;this.ISd=!1}xwl(){return{Emk:this.Zwf,
Vmm:this.rxf,D4k:this.ISd}}}Object(m.a)(si,"TriePrefixVisitor",null,[1247]);class Dg{constructor(Za){this.Ab=Za}execute(Za){if(!({value:Rb}=Za.jq(this.Ab.bJa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Cb;({value:Cb}=Za.jq(this.Ab.gVa)).returnValue||(Cb=null);var Rb=this.cfl(Rb,Cb);Za=G.Annotations.qS(Za);Za.ay(this.Ab.bJa,Rb);return Za}cfl(Za,Cb){let Rb=null;const pc=this.Ab.flatLexicon.trie,Rc=new si(this,Za,Cb);let wb=null;this.Ab.flatLexicon.Xnf()&&
(wb=Object(wg.a)(this.Ab.flatLexicon,this.Ab.flatLexicon.wil,"getCaseInsensitiveForm"));let Td=0,sd;var Me;let tf;for(;Td<Za.items.length;){const Pf=Za.items[Td];Rc.Sun(Td);pc.mjj(Rc,wb);({Emk:sd,Vmm:Me,D4k:tf}=Rc.xwl());if(0<sd){({tpm:Me}=this.Ab.flatLexicon.Ufl(Me));for(let Yh of this.EJk(Za,Td,sd,Me)){1<sd&&this.Ab.wMc&&this.uKk(Za,Cb,Td,Pf,sd,tf,Yh);if(!Rb)for(Rb=new Qa.a(this.Ab.annotations,G.Annotations.wU),Me=0;Me<Td;++Me)Array.add(Rb.items,Za.items[Me]);Array.add(Rb.items,Yh)}Td+=sd}else Rb&&
Array.add(Rb.items,Pf),++Td}return Rb||Za}uKk(Za,Cb,Rb,pc,Rc,wb,Td){if(wb)wb=!0;else if(this.Ab.udi){wb=!1;var sd=-1;for(var Me=0;Me<Rc;Me++){var tf=Za.items[Rb+Me];let Fh;var Pf=void 0;if(!({value:Fh}=tf.jq(this.Ab.q1)).returnValue||!({value:Pf}=tf.jq(this.Ab.r5)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");if(0<Me){if(Fh>sd+1){wb=!0;break}if(0>sd||null===Cb||sd>=Cb.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");
if(" "!==Cb.charAt(sd)){wb=!0;break}}sd=Fh+Pf}}else wb=!1;if(wb){Pf=new Sys.StringBuilder;for(wb=0;wb<Rc;++wb)({D9i:sd,O4h:Me,length:tf}=this.HZh(Za.items[Rb+wb],Cb)),0<wb&&Pf.append(" "),Pf.append(sd.substr(Me,tf));Td.ay(this.Ab.F$a,Pf.toString())}Za=Za.items[Rb+Rc-1];let Yh,ti;({value:pc}=pc.jq(this.Ab.q1)).returnValue&&({value:Yh}=Za.jq(this.Ab.q1)).returnValue&&({value:ti}=Za.jq(this.Ab.r5)).returnValue?(Td.ay(this.Ab.q1,pc),Td.ay(this.Ab.r5,Yh+ti-pc)):(Td.pOa(this.Ab.q1),Td.pOa(this.Ab.r5))}EJk(Za,
Cb,Rb,pc){return new sh(this,Za,Cb,Rb,pc)}HZh(Za,Cb){let Rb,pc;if(({value:Rb}=Za.jq(this.Ab.F$a)).returnValue)pc=!0,Cb=0,Za=Rb.length;else{pc=!1;if(null===Cb)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");Rb=Cb;if(!({value:Cb}=Za.jq(this.Ab.q1)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation","token");if(!({value:Za}=Za.jq(this.Ab.r5)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");
if(0>Cb||0>Za||Cb+Za>Rb.length)throw Error.argument("Token start/length values out of range","token");}return{D9i:Rb,O4h:Cb,length:Za,E4k:pc}}}Object(m.a)(Dg,"FlatLexiconNLModule",null,[1237]);class ai{constructor(Za,Cb){this.fSe=this.kUd=this.T_f=this.F$a=this.r5=this.q1=this.gVa=this.bJa=0;this.Odi=this.udi=this.wMc=!1;this.flatLexicon=null;this.annotations=Cb.annotations;let Rb=0;try{this.bJa=Za.J(Rb),++Rb,this.gVa=Za.J(Rb),++Rb,this.q1=Za.J(Rb),++Rb,this.r5=Za.J(Rb),++Rb,this.F$a=Za.J(Rb),++Rb,
this.T_f=Za.J(Rb),++Rb,this.kUd=Za.J(Rb),++Rb,this.fSe=Za.J(Rb),++Rb,this.wMc=1===Za.J(Rb),++Rb,this.udi=1===Za.J(Rb),++Rb,this.Odi=1===Za.J(Rb),++Rb,this.flatLexicon=Cb.ODl(Za.J(Rb))}catch(pc){throw Error.argument("initData");}}}Object(m.a)(ai,"FlatLexiconNLModuleInit",null,[]);class Ue{constructor(){this.GKc=0;this.D7e=null;this.AYc=0}}Object(m.a)(Ue,"FeatureGenStackRec",null,[]);class ed{constructor(Za){this.v4f=Array(Za);this.Sfc=Array(Za);this.r1f=[];this.b7i=[]}}Object(m.a)(ed,"TokenStringLattice",
null,[]);const Dl=(Za,Cb,Rb)=>{for(let pc=0;pc<Za.length;pc++)Rb=Cb(Rb,Za[pc]);return Rb},Hi=(Za,Cb)=>{const Rb=Array(Za.length);for(let pc=0;pc<Za.length;pc++)Rb[pc]=Cb(Za[pc]);return Rb},tk=(Za,Cb)=>{Cb=Array(Math.min(Cb,Za.length));for(let Rb=0;Rb<Cb.length;Rb++)Cb[Rb]=Za[Rb];return Cb},ok=(Za,Cb)=>{const Rb=[];for(const pc of Za)Cb(pc)&&Array.add(Rb,pc);return Rb};class se{constructor(Za,Cb){this.key=Za;this.value=Cb}}Object(m.a)(se,"KeyValuePair",null,[]);const bi=(Za,Cb)=>({returnValue:Cb in
Za,value:Za[Cb]}),sl=Za=>{const Cb=[];for(let Rb in Za){const pc=new se(Rb,Za[Rb]);Array.add(Cb,pc)}return Cb};class El{constructor(Za){this.GZh=this.JKl;this.Ab=Za;this.LSd=this.ixf=this.jxf=0;for(const Cb of this.Ab.cBd)this.jxf=Math.max(this.jxf,Cb.RKf),this.ixf=Math.max(this.ixf,Cb.MKf),this.LSd=Math.max(this.LSd,Cb.zkb.length)}get D6k(){return this.Ab.Q$d.trie}execute(Za){if(!Za)throw Error.argumentNull("input");let Cb,Rb;({tokens:Cb,$nm:Rb}=this.KKl(Za));let pc=null,Rc=null,wb={};if(this.Ab.$Mc){Cb=
G.Annotations.qS(Cb);for(var Td=0;Td<Cb.items.length;++Td)Cb.items[Td]=G.Annotations.qS(Cb.items[Td])}else({ZEh:Rc,returnValue:pc}=this.YTh(Za,wb));Td=Array(this.LSd);const sd=Array(this.LSd);for(var Me=0;Me<sd.length;++Me)sd[Me]=new Ue;for(Me=-this.jxf;Me<Cb.items.length+this.ixf;++Me){let tf=null;this.Ab.$Mc&&(tf=Cb.items[Me],wb={},{ZEh:Rc,returnValue:pc}=this.YTh(tf,wb));for(const Pf of this.Ab.cBd){if(0>Me&&-Me>Pf.RKf||Me>=Cb.items.length&&Me-Cb.items.length+1>Pf.MKf)continue;let Yh=!0;for(let ti=
0;ti<Pf.zkb.length;++ti){const Fh=Me+Pf.zkb[ti];Td[ti]=Fh;if(0>Fh?0>this.Ab.SKf:Fh>=Cb.items.length?0>this.Ab.NKf:!Rb.Sfc[Fh]){Yh=!1;break}}Yh&&({qNk:pc,rNk:Rc}=this.g5l(Pf,Rb,pc,Rc,wb,sd,Td))}this.Ab.$Mc&&(tf.ay(this.Ab.FZa?this.Ab.pXb:this.Ab.nXb,pc),this.Ab.FZa&&tf.ay(this.Ab.oXb,Rc))}Za=G.Annotations.qS(Za);this.Ab.$Mc?Za.ay(this.Ab.bJa,Cb):(Za.ay(this.Ab.FZa?this.Ab.pXb:this.Ab.nXb,pc),this.Ab.FZa&&Za.ay(this.Ab.oXb,Rc));return Za}KKl(Za){let Cb,Rb;if(!Za||!({value:Cb}=Za.jq(this.Ab.bJa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");
let pc;({value:pc}=Za.jq(this.Ab.gVa)).returnValue||(pc="");Rb=new ed(Cb.items.length);const Rc=ok(this.Ab.x4f,wb=>!wb.DLc||wb.DLc.isMatch(Za,null));for(let wb=0;wb<Cb.items.length;++wb){const Td=Cb.items[wb];let sd=null;Rb.v4f[wb]=Rb.r1f.length;let Me=Rb.Sfc[wb]=0;for(const tf of Rc)0<tf.VQc&&Rb.Sfc[wb]+Me>=tf.VQc||tf.D1c&&!tf.D1c.isMatch(Td,null)||({E1c:sd,lzc:Me}=tf.apply(this,Td,wb,Rb,pc,sd,Me))}return{tokens:Cb,$nm:Rb}}g5l(Za,Cb,Rb,pc,Rc,wb,Td){let sd=0;wb[0].GKc=-1;for(wb[0].D7e=Za.KRi;;){var Me=
Td[sd],tf=0>Me||Me>=Cb.Sfc.length?1:Cb.Sfc[Me];let ti=!1;for(;wb[sd].GKc<tf-1;){++wb[sd].GKc;var Pf=void 0,Yh=void 0;0>Me?(Pf=this.Ab.SKf,Yh=1):Me>=Cb.v4f.length?(Pf=this.Ab.NKf,Yh=1):(Yh=Cb.v4f[Me]+wb[sd].GKc,Pf=Cb.r1f[Yh],Yh=Cb.b7i[Yh]);wb[sd].AYc=Yh*(sd?wb[sd-1].AYc:Za.score);if(({value:Pf}=bi(wb[sd].D7e,Pf.toString())).returnValue){sd===Za.zkb.length-1?(Me=Pf,wb[sd].AYc&&(({value:tf}=bi(Rc,Me.toString())).returnValue||(tf=-1),0>tf&&(Rb=G.Annotations.qS(Rb),Array.add(Rb.items,Me)),this.Ab.FZa&&
(pc=G.Annotations.qS(pc),0>tf?Array.add(pc.items,wb[sd].AYc):pc.items[tf]+=wb[sd].AYc),0>tf&&(this.Ab.Wgi||this.Ab.FZa)&&(Rc[Me.toString()]=Rb.items.length-1))):(++sd,wb[sd].GKc=-1,wb[sd].D7e=Pf);ti=!0;break}}if(!ti&&(--sd,0>sd))break}return{qNk:Rb,rNk:pc}}YTh(Za,Cb){let Rb;if(({value:Rb}=Za.jq(this.Ab.FZa?this.Ab.pXb:this.Ab.nXb)).returnValue)for(let pc=0;pc<Rb.items.length;++pc)Cb[Rb.items[pc].toString()]=pc;else Rb=new Qa.a(this.Ab.annotations,G.Annotations.JEa);if(this.Ab.FZa){if(({value:Cb}=
Za.jq(this.Ab.oXb)).returnValue||(Cb=new Qa.a(this.Ab.annotations,G.Annotations.boa)),Cb.items.length!==Rb.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Ab.annotations.yba(G.Annotations.wU,Za));}else Cb=null;return{returnValue:Rb,ZEh:Cb}}get C7n(){return this.Ab.Q$d}JKl(Za,Cb){var Rb;if(({value:Rb}=Cb.jq(this.Ab.F$a)).returnValue)Za=Rb;else{if(!({value:Rb}=Cb.jq(this.Ab.q1)).returnValue)throw Error.argument("Token is missing Span.StartIndex");
if(!({value:Cb}=Cb.jq(this.Ab.r5)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>Rb||0>Cb||Rb+Cb>Za.length)throw Error.argument("Token indices are out of range");Za=Za.substr(Rb,Cb)}return Za}}Object(m.a)(El,"NGramNLModule",null,[1237,1238]);class ci{constructor(Za){this.zkb=null;this.score=this.MKf=this.RKf=0;this.KRi=null;if(Za){var Cb=0;try{if(Za.J(Cb)!==ci.Jvb)throw Error.argument("initData","Input does not represent a feature template");++Cb;const Rb=Za.J(Cb);++Cb;this.zkb=
Array(Rb);for(let pc=0;pc<Rb;++pc)this.zkb[pc]=Za.J(Cb),++Cb;this.RKf=Za.J(Cb);++Cb;this.MKf=Za.J(Cb);++Cb;this.score=Za.J(Cb);++Cb;this.KRi=({I4h:Cb}=ci.yIi(Za,Cb)).returnValue}catch(Rb){throw Error.argument("initData");}}}static yIi(Za,Cb){const Rb=Za.J(Cb);++Cb;const pc={};for(let Rc=0;Rc<Rb;++Rc){const wb=Za.J(Cb);++Cb;Za.J(Cb)?pc[wb.toString()]=({I4h:Cb}=ci.yIi(Za,Cb)).returnValue:(++Cb,pc[wb.toString()]=Za.J(Cb),++Cb)}return{returnValue:pc,I4h:Cb}}}ci.Jvb=240803228;Object(m.a)(ci,"FeatureTemplate",
null,[1248]);var Kk=d(1542);class pf{constructor(Za,Cb){this.FZa=this.Wgi=this.$Mc=!1;this.F$a=this.r5=this.q1=this.bJa=this.gVa=this.oXb=this.pXb=this.nXb=0;this.Q$d=null;this.NKf=this.SKf=0;this.cBd=this.x4f=null;if(Za){this.annotations=Cb.annotations;var Rb=0;try{this.$Mc=1===Za.J(Rb);++Rb;this.Wgi=1===Za.J(Rb);++Rb;this.FZa=1===Za.J(Rb);++Rb;this.nXb=Za.J(Rb);++Rb;this.pXb=Za.J(Rb);++Rb;this.oXb=Za.J(Rb);++Rb;this.gVa=Za.J(Rb);++Rb;this.bJa=Za.J(Rb);++Rb;this.q1=Za.J(Rb);++Rb;this.r5=Za.J(Rb);
++Rb;this.F$a=Za.J(Rb);++Rb;this.Q$d=this.a1m(Cb.Qcb(Za.J(Rb)));++Rb;this.SKf=Za.J(Rb);++Rb;this.NKf=Za.J(Rb);++Rb;const pc=Za.J(Rb);++Rb;this.x4f=Array(pc);for(let wb=0;wb<pc;++wb){const Td=Za.J(Rb);++Rb;const sd=this.Q$d.trie,Me=new ab.a;Me.Acb(Za,Rb,Td);this.x4f[wb]=this.d1m(Me,Cb,sd);Rb+=Td}const Rc=Za.J(Rb);++Rb;this.cBd=Array(Rc);for(Cb=0;Cb<Rc;++Cb){const wb=Za.J(Rb);++Rb;const Td=new ab.a;Td.Acb(Za,Rb,wb);this.cBd[Cb]=this.H0m(Td);Rb+=wb}}catch(pc){throw Error.argument("initData");}}}a1m(Za){return new qf.a(new gj.a(Za))}d1m(Za,
Cb,Rb){return Kk.a.create(Za,Cb,Rb)}H0m(Za){return new ci(Za)}}Object(m.a)(pf,"NGramNLModuleInit",null,[]);class $l{constructor(Za){this.Ab=Za}execute(Za){if(!Za)throw Error.argumentNull("input");Za=Za.clone();this.Ab.script.execute(Za,null);return Za}}Object(m.a)($l,"ScriptNLModule",null,[1237]);class qd{constructor(Za,Cb){Za&&(this.script=Cb.jzb(Za.J(0)))}}Object(m.a)(qd,"ScriptNLModuleInit",null,[]);const Ak=Za=>{Za=Hi(Za,Cb=>Cb*Cb);return Math.sqrt(Dl(Za,(Cb,Rb)=>Cb+Rb,0))},tl=Za=>Dl(Za,(Cb,Rb)=>
Cb>Rb?Cb:Rb,Za[0]);class Ek{constructor(Za){this.Ab=Za}execute(Za){if(!Za)throw Error.argumentNull("input");var Cb=[],Rb=[];this.Dxk(Za,Cb,Rb);this.q8j(Cb,Rb);const pc={};for(let wb=0;wb<Cb.length;++wb){var Rc=Cb[wb];const Td=this.Ab.m8h.J(Rc);Rc=this.Ab.n8h.J(Rc);for(let sd=0;sd<Rc;++sd){const Me=this.Ab.A5.J(this.Ab.Tkh.J(Td+sd)),tf=this.Ab.Ukh.J(Td+sd);let Pf;({value:Pf}=bi(pc,Me)).returnValue||(Pf=0);pc[Me]=Pf+Rb[wb]*tf}}Rb=sl(pc);Rb.sort((wb,Td)=>{var sd=wb.value,Me=Td.value;(sd=-(sd>Me?1:sd<
Me?-1:0))||(sd=wb.key.localeCompare(Td.key));return sd});Cb=new Qa.a(this.Ab.annotations,G.Annotations.wU);for(const wb of tk(Rb,this.Ab.IDm))Rb=new F.a(this.Ab.annotations),Rb.ay(this.Ab.tek,wb.key),Rb.ay(this.Ab.vek,wb.value),Array.add(Cb.items,Rb);Za.ay(this.Ab.uek,Cb);return Za}Dxk(Za,Cb,Rb){if(({value:Za}=Za.jq(this.Ab.sek)).returnValue){let pc;if(({value:pc}=Za.jq(this.Ab.pXb)).returnValue){let Rc;if(!({value:Rc}=Za.jq(this.Ab.oXb)).returnValue||pc.items.length!==Rc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");
this.xud(pc,Rc,Cb,Rb)}if(({value:pc}=Za.jq(this.Ab.xek)).returnValue){let Rc;if(!({value:Rc}=Za.jq(this.Ab.yek)).returnValue||pc.items.length!==Rc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");this.xud(pc,Rc,Cb,Rb)}({value:pc}=Za.jq(this.Ab.nXb)).returnValue&&this.xud(pc,null,Cb,Rb);({value:pc}=Za.jq(this.Ab.wek)).returnValue&&this.xud(pc,null,Cb,Rb)}}xud(Za,Cb,Rb,pc){for(let wb=0;wb<Za.items.length;++wb){var Rc=void 0;Za.F2===
G.Annotations.H7?({value:Rc}=bi(this.Ab.CAh,Za.items[wb])).returnValue||(Rc=-1):(Rc=Za.items[wb],Rc=Rc>=this.Ab.Ryf&&Rc<=this.Ab.mEm?this.Ab.CCf?this.Ab.CCf.J(Rc-this.Ab.Ryf)-1:Rc-this.Ab.Ryf:-1);if(0<=Rc){let Td;Td=Cb?Cb.items[wb]:1;0<Td&&(Array.add(Rb,Rc),Array.add(pc,Td))}}}q8j(Za,Cb){if(Za.length){switch(this.Ab.H$m){case 0:break;case 1:for(var Rb=0;Rb<Cb.length;++Rb)Cb[Rb]=1+Math.log(Cb[Rb]);break;case 2:Rb=tl(Cb);for(let pc=0;pc<Cb.length;++pc)Cb[pc]=.5+Cb[pc]/Rb*.5;break;case 3:for(Rb=0;Rb<
Cb.length;++Rb)Cb[Rb]=1;break;default:throw Error.notImplemented();}if(this.Ab.WLd)for(Rb=0;Rb<Cb.length;++Rb)Cb[Rb]*=this.Ab.WLd.J(Za[Rb]);Za=Ak(Cb);for(Rb=0;Rb<Cb.length;++Rb)Cb[Rb]/=Za}}}Object(m.a)(Ek,"TfIdfRankerNLModule",null,[1237]);class Fl{constructor(Za,Cb=0){if(!Za)throw Error.argumentNull("byteArray");this.MSd=Cb;if(604662927!==Za.Zx(this.MSd+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.aj=Za.Zx(this.MSd+4,4);this.Pmi=Za.Zx(this.MSd+8,4);this.hBm=
Za}J(Za){if(0>Za||Za>=this.count)throw Error.argumentOutOfRange("index");return this.hBm.fen(8*this.MSd+96+Za*this.Pmi,this.Pmi)}get count(){return this.aj}}Object(m.a)(Fl,"CompactIntArray",null,[1236]);const Sn=(Za,Cb)=>{Cb=Array(Cb);for(let wb=0;wb<Cb.length;wb++){var Rb=wb,pc=Za.a7(),Rc=1===(pc>>31&1)?-1:1;const Td=pc&8388607;pc=pc>>23&255;256===pc+1?Rc=Td?Number.NaN:1===Rc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:pc?(pc-=127,Rc=Rc*hm(Td,1)*Math.pow(2,pc)):Rc=Rc*hm(Td,0)*Math.pow(2,-126);
Cb[Rb]=Rc}return Cb},hm=(Za,Cb)=>{let Rb=0;for(let pc=0;23>pc;pc++)Rb+=(Za>>22-pc&1)/Math.pow(2,pc+1);return Cb+Rb};class Mg{constructor(Za,Cb){this.CCf=null;this.cti=0;this.n8h=this.m8h=this.WLd=null;this.bti=0;this.Ukh=this.Tkh=null;this.annotations=Cb.annotations;let Rb=0;this.wek=Za.J(Rb);++Rb;this.nXb=Za.J(Rb);++Rb;this.xek=Za.J(Rb);++Rb;this.yek=Za.J(Rb);++Rb;this.pXb=Za.J(Rb);++Rb;this.oXb=Za.J(Rb);++Rb;this.sek=Za.J(Rb);++Rb;this.uek=Za.J(Rb);++Rb;this.tek=Za.J(Rb);++Rb;this.vek=Za.J(Rb);
++Rb;var pc=Za.J(Rb);++Rb;var Rc=Array(pc);for(var wb=0;wb<pc;++wb)Rc[wb]=Cb.getString(Za.J(Rb)),++Rb;this.A5=ab.a.h_e(Rc);this.IDm=Za.J(Rb);++Rb;this.H$m=Za.J(Rb);++Rb;pc=Za.J(Rb);++Rb;this.CAh={};for(Rc=0;Rc<pc;++Rc){wb=Cb.getString(Za.J(Rb));++Rb;const Td=Za.J(Rb);++Rb;this.CAh[wb]=Td}this.Ryf=Za.J(Rb);++Rb;this.mEm=Za.J(Rb);++Rb;pc=Za.J(Rb);++Rb;0<pc&&(pc=Cb.Qcb(Za.J(Rb)),++Rb,this.CCf=this.UYd(new ig(pc)));++Rb;Za=Cb.Qcb(Za.J(Rb));this.O0m(Za)}UYd(Za){return new Fl(Za.xyc,Za.offset)}O0m(Za){try{const Cb=
new ig(Za);this.cti=Cb.a7();1===Cb.a7()?this.WLd=ab.a.h_e(Sn(Cb,this.cti)):this.WLd=null;const Rb=Cb.a7();this.m8h=this.UYd(Cb);Cb.offset+=Rb;const pc=Cb.a7();this.n8h=this.UYd(Cb);Cb.offset+=pc;this.bti=Cb.a7();const Rc=Cb.a7();this.Tkh=this.UYd(Cb);Cb.offset+=Rc;this.Ukh=ab.a.h_e(Sn(Cb,this.bti))}catch(Cb){throw Error.argument("byteReader");}}}Object(m.a)(Mg,"TfIdfRankerNLModuleInit",null,[]);class Xo{constructor(Za,Cb,Rb,pc){this.fJf=Za;this.PGh=Rb;this.tokens=pc;this.aka=Cb;this.Vcc=-1;this.L4d=
0}}Object(m.a)(Xo,"TokenizerData",null,[]);class vj{constructor(Za){this.Ab=Za}execute(Za){if(!Za)throw Error.argumentNull("input");if(!({value:pc}=Za.jq(this.Ab.gVa)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Cb;({value:Cb}=Za.jq(this.Ab.q1)).returnValue||(Cb=0);let Rb;({value:Rb}=Za.jq(this.Ab.r5)).returnValue||(Rb=pc.length-Cb);if(0>Cb||Cb>pc.length)throw Error.argument("input","Start index out of range");if(0>Rb||Rb>pc.length)throw Error.argument("input",
"Length out of range");if(Cb+Rb>pc.length)throw Error.argument("input","Bad start-length range");var pc=new Xo(pc,Cb,Cb+Rb,new Qa.a(this.Ab.annotations,G.Annotations.wU));this.D7n(pc);Za=Za.isReadOnly?Za.clone():Za;Za.ay(this.Ab.bJa,pc.tokens);return Za}D7n(Za){for(;Za.aka<Za.PGh;){if(this.Ab.pif){var Cb=this.Ab.pif.tmi(Za.fJf,Za.aka,Za.PGh-Za.aka,null);!Cb.succeeded&&Cb.asi&&(Cb=Cb.asi);if(Cb.succeeded){this.Vwi(Za,Cb.length,this.Ab.K0h);Za.aka+=Cb.length;continue}}Cb=Za.fJf.substr(Za.aka);let Rb=
-1,pc=-1,Rc=-1;for(let wb=0;wb<this.Ab.S3d.length;++wb){const Td=this.Ab.S3d[wb].exec(Cb);Td&&0<Td[1].length&&(0>Rb||Td[0].length>pc)&&(Rb=wb,pc=Td[0].length,Rc=Td[1].length)}0<=Rb?(this.Vwi(Za,Rc,this.Ab.aUf[Rb]),Za.aka+=Rc):Za.aka+=1}}Vwi(Za,Cb,Rb){if(this.Ab.qfi)Rb!==vj.Nmk&&(0>Za.Vcc&&(Za.Vcc=Za.aka),Za.L4d=Za.aka+Cb-Za.Vcc,Rb===vj.Mmk&&(0<=Za.Vcc&&0<Za.L4d&&(Cb=new F.a(this.Ab.annotations),Cb.ay(this.Ab.q1,Za.Vcc),Cb.ay(this.Ab.r5,Za.L4d),Cb.ay(this.Ab.UQe,vj.Omk),Cb.ay(this.Ab.gVa,Za.fJf),Array.add(Za.tokens.items,
Cb)),Za.Vcc=-1,Za.L4d=0));else{let pc=new F.a(this.Ab.annotations);pc.ay(this.Ab.q1,Za.aka);pc.ay(this.Ab.r5,Cb);pc.ay(this.Ab.UQe,Rb);Array.add(Za.tokens.items,pc)}}}vj.Nmk="GAP";vj.Mmk="EOS_CHUNK";vj.Omk="SENTENCE";Object(m.a)(vj,"TokenizerNLModule",null,[1237]);class Zf{constructor(Za,Cb){this.r5=this.q1=this.UQe=this.bJa=this.gVa=0;this.qfi=!1;this.aUf=this.S3d=this.K0h=this.pif=null;if(Za){this.annotations=Cb.annotations;var Rb=0;try{this.gVa=Za.J(Rb);++Rb;this.bJa=Za.J(Rb);++Rb;this.UQe=Za.J(Rb);
++Rb;this.q1=Za.J(Rb);++Rb;this.r5=Za.J(Rb);++Rb;this.qfi=1===Za.J(Rb);++Rb;var pc=Za.J(Rb);++Rb;0<pc&&(this.pif=Cb.ief(pc).D6k);this.K0h=Za.J(Rb)?Cb.getString(Za.J(Rb)):"";++Rb;const Rc=Za.J(Rb);++Rb;this.S3d=Array(Rc);this.aUf=Array(Rc);for(pc=0;pc<Rc;++pc)this.S3d[pc]=new RegExp(Cb.getString(Za.J(Rb))),++Rb,this.aUf[pc]=Cb.getString(Za.J(Rb)),++Rb}catch(Rc){throw Error.argument("initData");}}}}Object(m.a)(Zf,"TokenizerNLModuleInit",null,[]);class bl{constructor(Za){this.Ab=Za}execute(Za){if(!Za)throw Error.argumentNull("input");
let Cb;if(!({value:Cb}=Za.jq(this.Ab.cdh)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const Rb of this.Ab.I0f)Cb=Rb.apply(Cb);Za=G.Annotations.qS(Za);Za.ay(this.Ab.ddh,Cb);return Za}static gQe(Za,Cb){const Rb=new Sys.StringBuilder;for(let pc=0;pc<Za.length;++pc)Rb.append(Cb(Za.substr(pc,1)));return Rb.toString()}}Object(m.a)(bl,"TransliteratorNLModule",null,[1237]);class gn{constructor(Za){Za&&(this.style=Za.J(0))}apply(Za){return bl.gQe(Za,
Cb=>gn.drk(Cb,this.style))}static drk(Za,Cb){switch(Cb){case 0:return Za.toLowerCase();case 1:return"I"===Za?"\u0131":Za.toLowerCase();case 2:return Za.toUpperCase();case 3:return"i"===Za?"\u0130":Za.toUpperCase();default:throw Error.invalidOperation();}}}gn.Kvb=0;Object(m.a)(gn,"ChangeCaseTransliterationStage",null,[1245]);class Vl{apply(Za){return bl.gQe(Za,Vl.W8n)}static W8n(Za){const Cb=Za.charCodeAt(0);return 65281<=Cb&&65374>=Cb?String.fromCharCode(Cb-65248):Za}}Vl.Kvb=4;Object(m.a)(Vl,"LatinFullWidthToHalfWidthTransliterationStage",
null,[1245]);class Zg{constructor(Za,Cb){Za&&(this.uPf=Cb.Q2b(Za.J(0)),this.xsn=Cb.getString(Za.J(1)))}apply(Za){return Za.replace(this.uPf,this.xsn)}}Zg.Kvb=1;Object(m.a)(Zg,"RegexReplaceTransliterationStage",null,[1245]);class ni{constructor(Za,Cb){if(Za){var Rb=Za.J(0),pc=Cb.getString(Za.J(1)),Rc=new Fl(Cb.Qcb(Za.J(2)));Za=0>Za.J(3)?null:new Fl(Cb.Qcb(Za.J(3)));this.J1f={};for(Cb=0;Cb<Rb;++Cb)this.J1f[pc.charAt(Cb).toString()]=pc.substr(Rc.J(Cb),Za?Za.J(Cb):1)}}apply(Za){return bl.gQe(Za,Cb=>Cb in
this.J1f?this.J1f[Cb]:Cb)}}ni.Kvb=2;Object(m.a)(ni,"SingleCharSubstitutionsTransliterationStage",null,[1245]);class pk{constructor(Za,Cb){this.ddh=this.cdh=0;this.I0f=null;if(Za){this.annotations=Cb.annotations;var Rb=0;try{this.cdh=Za.J(Rb);++Rb;this.ddh=Za.J(Rb);++Rb;const pc=Za.J(Rb);++Rb;this.I0f=Array(pc);for(let Rc=0;Rc<pc;++Rc){const wb=Za.J(Rb);++Rb;const Td=Za.J(Rb);++Rb;const sd=new ab.a;sd.Acb(Za,Rb,Td);Rb+=Td;this.I0f[Rc]=this.$0m(wb,sd,Cb)}}catch(pc){throw Error.argument("initData");
}}}$0m(Za,Cb,Rb){switch(Za){case gn.Kvb:return new gn(Cb);case Zg.Kvb:return new Zg(Cb,Rb);case ni.Kvb:return new ni(Cb,Rb);case Vl.Kvb:return new Vl;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(m.a)(pk,"TransliteratorNLModuleInit",null,[]);class Nj{Oxl(Za,Cb){const Rb=Za.J(0),pc=new ab.a;pc.Acb(Za,1,Za.count-1);switch(Rb){case 0:return new $l(new qd(pc,Cb));case 2:return new vj(new Zf(pc,Cb));case 3:return new El(new pf(pc,Cb));case 5:return new Dg(new ai(pc,
Cb));case 9:return new bl(new pk(pc,Cb));case 10:return new Ek(new Mg(pc,Cb));default:throw Error.notImplemented();}}}Object(m.a)(Nj,"NLModuleFactory",null,[1217]);class Uk{constructor(Za){this.Kmk=";";if(!Za)throw Error.argumentNull("resource");this.mfa=new $e(Za,new zb,new Nj);this.lxf=this.mfa.vxl();this.Omi=this.mfa.annotations.zGc("Text.Text");this.Mmi=this.mfa.annotations.zGc("Classification.Predictions");this.Xwf=this.mfa.annotations.zGc("Classification.PredictionString");this.Nmi=this.mfa.annotations.zGc("Classification.Probability");
this.gBm=this.mfa.annotations.zGc("NLMod.Tokens");if(0>this.Omi||0>this.Mmi||0>this.Xwf||0>this.Nmi)throw Error.argument("resourceObj","Resource does not represent a ranker");}ahl(){const Za=[];this.v6e(void 0,this.ZKh(Za),null);return Za}chl(Za,Cb){const Rb=[],pc=[];this.v6e(Za,this.ZKh(Rb),(Rc,wb)=>{const Td=this.mfa.annotations.OKh(Rc),sd=[],Me=[];Cb&&Cb.length&&-1===Array.indexOf(Cb,Td)||(Rc=this.mfa.annotations.getAttributeType(Rc),this.MDi(Rc,wb,sd,Me),wb=new Tf(Td,sd,Me),Array.add(pc,wb))});
return new vg(Rb,pc)}bhl(Za){const Cb=[];this.v6e(Za,Rb=>{let pc;if(({value:pc}=Rb.jq(this.Xwf)).returnValue){let Rc;({value:Rc}=Rb.jq(this.Nmi)).returnValue&&Array.add(Cb,new Sf(pc,Rc))}},null);return Cb}v6e(Za,Cb,Rb){var pc=new F.a(this.mfa.annotations);pc.ay(this.Omi,Za);Za=this.lxf.execute(pc);if(({value:pc}=Za.jq(this.Mmi)).returnValue)for(const Rc of pc.items)Cb(Rc);if(Rb&&({value:Cb}=Za.jq(this.gBm)).returnValue)for(const Rc of Cb.items)Rc.tCd(Rb)}MDi(Za,Cb,Rb,pc){if(G.Annotations.hH(Za))for(var Rc of Cb.items)this.MDi(Cb.F2,
Rc,Rb,pc);else if(G.Annotations.Wcj(Za)){Rc=this.mfa.annotations.ETh(Za);for(let wb=0;wb<Rc;wb++)Array.add(Rb,this.mfa.annotations.cYh(Za,wb)),Array.add(pc,this.mfa.annotations.yba(this.mfa.annotations.xAb(Za,wb),Cb.ddb(wb)))}else Array.add(Rb,"VALUE"),Array.add(pc,this.mfa.annotations.yba(Za,Cb))}ZKh(Za){return Cb=>{let Rb;({value:Rb}=Cb.jq(this.Xwf)).returnValue&&Array.add(Za,this.uCl(Rb))}}uCl(Za){const Cb=Za.indexOf(this.Kmk);return 0>Cb?Za:Za.substring(0,Cb)}}Object(m.a)(Uk,"Ranker",null,[]);
var gg=d(1495),le=d(1508),Od=d(1461),pg=d(1457),Oi=d(1456),aj=d(2);class Lj{constructor(Za,Cb){this.CMg="";this.DCe=null;this.ECe=!1;this.uoa=null;this.Kuj=["TellMe.TellMeParamCollection"];this.jc=Za;this.$Sa=Cb;this.jc.gvb&&(this.uoa=null)}get w0d(){if(!this.DCe&&!this.ECe){let Za=null;try{Za=window.TellMeModel}catch(Cb){if(pg.TellMeActor.instance.Qe)pg.TellMeActor.instance.Qe.onError("QueryRanker","TellMeModel not found. Exception: "+Cb)}if(Za){try{this.DCe=new Uk(Za)}catch(Cb){if(pg.TellMeActor.instance.Qe)pg.TellMeActor.instance.Qe.onError("QueryRanker",
"Exception thrown while loading classifier. Exception: "+Cb)}this.ECe=!0}else if(pg.TellMeActor.instance.Qe)pg.TellMeActor.instance.Qe.onError("QueryRanker","Classifier model not found")}return this.DCe}WJ(){return"Command"}wW(){return 0===this.jc.Hv?0:1===this.jc.Hv?1:2}uI(Za,Cb,Rb=!1,pc=f.a.tellMe,Rc=null){const wb=new u.a(Za);if((!Rc||Array.contains(Rc,0))&&!Oi.a.tT(Za)){if(!this.w0d&&this.ECe){if(pg.TellMeActor.instance.Qe)pg.TellMeActor.instance.Qe.onError("CRASH","CommandResultsProvider: Found invalid Model data");
throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.jc.gvb&&this.uoa&&this.uoa.initialize();if(gg.CommandResultsUtility.cof(Za.ng)&&(Rc=gg.CommandResultsUtility.EMh(Za.ng),0<Rc.results.length)){Rc.displayName="Classifier Debug";wb.wv(Rc);Cb.resultsUpdated(wb);return}Rc=Za?this.CMg=Za.ng:this.CMg;if(aj.AFrameworkApplication.K.$("TellMeParameterizedQueriesEnabled")){Rc=this.wCl(Rc);var Td=this.DDd(Rc.sff());Rc=Rc.oKh()}else Rc=this.vCl(Rc),Td=this.Yjl(Rc),Rc=[];gg.CommandResultsUtility.bSd(Td,
!1,"Classifier","TFIDF");Td=gg.CommandResultsUtility.NGd(Za,Td,this.jc,this.uoa,this.$Sa,Rc,0,1);0<Td.results.length&&pc!==f.a.contextMenu&&(Td.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);Rb||Td.results.length||this.jc.yZ||this.jc.D2a||(Za=new Od.a("lookupNoResults",14,Za.ng,null,1),Td.zy(Za));0<Td.results.length&&wb.wv(Td);wb.attributes=Rc}Cb.resultsUpdated(wb)}sff(){let Za=[];try{Za=this.w0d.ahl()}catch(Cb){if(pg.TellMeActor.instance.Qe)pg.TellMeActor.instance.Qe.onError("GetPredictions",
"Exception: "+Cb)}return Za}vCl(Za){let Cb=[];try{Cb=this.w0d.bhl(Za)}catch(Rb){if(pg.TellMeActor.instance.Qe)pg.TellMeActor.instance.Qe.onError("GetPredictionsWithScore","Exception: "+Rb)}return Cb}wCl(Za){try{return this.w0d.chl(Za,this.Kuj)}catch(Cb){if(pg.TellMeActor.instance.Qe)pg.TellMeActor.instance.Qe.onError("GetPredictionsWithTokenAttributes","Exception: "+Cb)}return new vg([],[])}DDd(Za){const Cb=[];if(Za)for(const Rb of Za)Cb.push(new le.a(Rb,-99999));return Cb}Yjl(Za){const Cb=[];if(Za)for(const Rb of Za)Cb.push(new le.a(Rb.prediction,
Rb.score));return Cb}}Object(m.a)(Lj,"CommandResultsProvider",null,[1093]);var yd=d(1662);class dg{constructor(Za){this.jc=Za}WJ(){return"Feedback"}wW(){return 0===this.jc.Hv?0:1===this.jc.Hv?1:2}uI(Za,Cb,Rb,pc,Rc=null){Za=new u.a(Za);if(!Rc||Array.contains(Rc,21))Rc=[],Rc.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Rc),Rc=new v.a(22),Rc.displayName="",Rc.zy(new Od.a("TellMeFeedback",23,null,null,1)),Za.wv(Rc);Cb.resultsUpdated(Za)}}
Object(m.a)(dg,"FeedbackResultsProvider",null,[1093]);class Nb{constructor(Za,Cb,Rb,pc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=Za;this.CommandId=Cb;this.CommandValueId=Rb;this.InputText=pc}}Object(m.a)(Nb,"FindInDocumentProp",null,[]);var Ii=d(1518),Ie=d(16);class $g{constructor(Za){this.txe=2;this.arb=[];this.V7a=[];this.jc=Za;$g.kAa=Za.M7e;$g.hGh="FindInDocumentSuggestion";$g.$Ci="FindInDocumentSuggestion3";this.fwe=Object.assign(new Ii.a,{landingTab:"Indoc",
data:null});this.QSj=this.jc.okb||!!aj.AFrameworkApplication.ua&&aj.AFrameworkApplication.ua.Sb.okb}WJ(){return"FindInDocument"}wW(){return 0===this.jc.Hv?0:1===this.jc.Hv?1:3===this.jc.Hv?this.jc.w4i?2:3:2}uI(Za,Cb,Rb=!1,pc,Rc=null){const wb=new u.a(Za);if(Rc&&!Array.contains(Rc,2))Cb.resultsUpdated(wb);else if(Array.clear(this.arb),Oi.a.tT(Za)){if(Rb&&this.T1i()){Rb=new v.a(2);Rb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Rc=1;pc="";if(0<this.V7a.length&&!this.jc.Qdc)for(var Td of this.V7a)if(""!==
Td.Label.toLowerCase()){if(Rc>=this.txe)break;this.Egj(Rb,Td.Label,Td.CommandValueId,$g.hGh+Rc,Td.InputText);Rc++}Td="";this.jc.PQ?(wb.wv(Rb),Rb=new v.a(3),Td=this.jc.A$a?Oi.a.Ocb(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):CommonUIStrings.l_TellMeOpenFindPaneTextV2):Td=CommonUIStrings.l_TellMeOpenFindPaneText;pc=this.DMh("");this.Egj(Rb,Td,pc,$g.$Ci,"");wb.wv(Rb)}Cb.resultsUpdated(wb)}else Td="",Rb&&(Rb=this.DMh(Za.ng),pc=[],this.jc.d_a?(this.jc.Z6d&&pc.push(appChrome.actions.setControlIconSet($g.kAa,
{"default":"FindInDocument_20"})),Td=this.jc.nsf?Oi.a.Ncf(Za.ng,CommonUIStrings.l_FindInDocumentScopedButtonText):Za.ng+CommonUIStrings.l_FindInDocumentScopedButtonText):this.jc.PQ?(Td=this.jc.A$a?Oi.a.Ocb(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,Za.ng)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,Za.ng),pc.push(appChrome.actions.setControlIconSet($g.kAa,{"default":"FindInDocument_20"}))):Td=this.jc.Qdc?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,
Za.ng),this.jc.VAa?(pg.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel($g.kAa,Td)),pg.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId($g.kAa,Rb))):(pc.push(appChrome.actions.setControlLabel($g.kAa,Td)),pc.push(appChrome.actions.setButtonCommandValueId($g.kAa,Rb)),appChrome.api.dispatch(pc)),this.sYi(Td,$g.kAa,Rb,Za.ng)),this.jc.w4i?(Td=new Od.a($g.kAa,8,Za.ng),Rb=new v.a(2),Rb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,Rb.zy(Td),wb.wv(Rb),
Cb.resultsUpdated(wb)):this.jc.AEd(Za.ng).then(sd=>{const Me=new Od.a($g.kAa,8,Za.ng,null,1);Me.count=sd;sd=new v.a(2);sd.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;sd.zy(Me);wb.wv(sd);Cb.resultsUpdated(wb)},sd=>{pg.TellMeActor.instance.Qe.onError("FindInDocumentResultsProvider:issueQuery","Find manager promise rejected: "+sd);sd=new Od.a($g.kAa,8,Za.ng,null,1);const Me=new v.a(2);Me.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Me.zy(sd);wb.wv(Me);Cb.resultsUpdated(wb)})}T1i(){return!!this.jc&&
this.jc.R6d}Egj(Za,Cb,Rb,pc,Rc=null){const wb=[];Cb&&wb.push(appChrome.actions.setControlLabel(pc,Cb));this.jc.PQ&&wb.push(appChrome.actions.setControlIconSet(pc,{"default":"FindInDocument_20"}));wb.push(appChrome.actions.setButtonCommandValueId(pc,Rb));appChrome.api.dispatch(wb);this.sYi(Cb,pc,Rb,"");Za.zy(new Od.a(pc,8,Rc,null,1,-99999))}DMh(Za){return this.QSj?Oi.a.mWa(Za,15,this.fwe):Ie.a.If(Za)}sYi(Za,Cb,Rb,pc){this.T1i()&&this.arb.length<this.txe&&(Za=new Nb(Za,Cb,Rb,pc),Array.add(this.arb,
Za))}OJn(Za){for(let Cb=0;Cb<this.arb.length;Cb++)if(this.arb[Cb].CommandId===Za){const Rb=this.arb[Cb].Label;let pc=!1;if(0<this.V7a.length){let Rc=0;for(const wb of this.V7a){if(wb.Label===Rb){Array.removeAt(this.V7a,Rc);pc=!0;break}Rc++}}!pc&&this.V7a.length>=this.txe-1&&Array.removeAt(this.V7a,1);Array.insert(this.V7a,0,this.arb[Cb])}}}$g.kAa=null;$g.hGh=null;$g.$Ci=null;Object(m.a)($g,"FindInDocumentResultsProvider",null,[1093]);var fh=d(1660);class Pi{constructor(Za){this.jc=Za}WJ(){return"Insights"}wW(){return 0===
this.jc.Hv?0:1===this.jc.Hv?1:2}uI(Za,Cb,Rb=!1,pc,Rc=null){pc=new u.a(Za);if(!Rc||Array.contains(Rc,13))if(this.FSn()||!Oi.a.tT(Za)){Rc=new v.a(13);var wb=""===Za.ng.trim(),Td=wb?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",sd=new Od.a(Td,10,Za.ng,null,1);Rb&&(Rb=null,Oi.a.bCa()?wb?wb=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(wb=this.jc.Qdc?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,Za.ng),Rb=Oi.a.mWa(Za.ng,1)):
(wb=String.format(CommonUIStrings.l_InsightsButtonText,Za.ng),Rb=Oi.a.exb(Za.ng)),this.jc.VAa?(pg.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Td,wb)),Rb&&pg.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",Rb))):(Za=[],Za.push(appChrome.actions.setControlLabel(Td,wb)),Rb&&Za.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",Rb)),appChrome.api.dispatch(Za)),sd.label=wb);Rc.zy(sd);pc.wv(Rc)}Cb.resultsUpdated(pc)}FSn(){return Oi.a.bCa()&&
this.jc.W4n}}Object(m.a)(Pi,"InsightsResultsProvider",null,[1093]);var jk=d(1658);class Cf{constructor(Za){this.jc=Za}WJ(){return"Learning"}wW(){return 0===this.jc.Hv?0:1===this.jc.Hv?1:2}uI(Za,Cb,Rb,pc,Rc=null){Rb=new u.a(Za);Rc&&!Array.contains(Rc,21)||!Oi.a.tT(Za)||(Rc=[],pc=this.jc.dpm,Rc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",pc)),pc=Cf.hrl(pc),Rc.push(appChrome.actions.setControlLabel("LearningForSearch",pc)),appChrome.api.dispatch(Rc),Za=new Od.a("LearningForSearch",
22,Za.ng,null,1),Rc=new v.a(21),Rc.zy(Za),Rb.wv(Rc));Cb.resultsUpdated(Rb)}static hrl(Za){const Cb=[];Array.add(Cb,new jk.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Cb,new jk.a(400,CommonUIStrings.l_TellMeLearningButtonText));Array.add(Cb,new jk.a(600,Za));Array.add(Cb,new jk.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));Za={};Za.parts=Cb;return JSON.stringify(Za)}}Object(m.a)(Cf,"LearningProvider",null,[1093]);var im=d(476);class ch{constructor(Za,Cb){this.oRb=this.tVb=
this.z8a=this.mfd=null;this.Ew=!1;this.YRb=Za;this.Syj=Cb;Za&&this.AEh(Za)}xae(){this.YRb.xae()&&this.AEh(this.YRb)}DIl(Za){let Cb=[];var Rb=[];Za=ch.kKm(Za);var pc="";Array.clear(Rb);for(let Rc=0;Rc<Za.length;Rc++){const wb=Za.charAt(Rc);-1!==" ".indexOf(wb)?(pc.length&&Array.add(Rb,pc),pc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(wb)?(pc.length&&Array.add(Rb,pc),pc=wb,Array.add(Rb,pc),pc=""):pc+=wb}pc.length&&Array.add(Rb,pc);for(Za=0;Za<Rb.length;Za++)pc=this.Xjl(Rb[Za]),pc=this.PDk(pc),
Cb=ch.nFm(Cb,pc);return Cb=this.I2j(Cb)}Cqf(){this.Ew||this.xae();return this.Ew}yxd(Za){return this.mfd[Za.toString()]}I2j(Za){for(let Cb=0;Cb<Za.length;Cb++){const Rb=this.z8a[Cb];if(Za[Cb].commandId!==this.yxd(Rb[0]))throw Error.create("Incorrect Tcid orders with Priors data");let pc;(pc=Za[Cb]).score=pc.score+Rb[1]}return Za}PDk(Za){const Cb=[];for(var Rb=0;Rb<this.z8a.length;Rb++)Cb.push(new le.a(this.yxd(this.z8a[Rb][0]),-5));Rb=new im.a;for(var pc=0;pc<Za.length;pc++)Rb.add(this.yxd(Za[pc][0]));
for(pc=0;pc<Cb.length;pc++){const wb=Cb[pc];for(let Td=0;Td<Za.length;Td++){var Rc=Za[Td];const sd=this.yxd(Rc[0]);Rc=Rc[1];if(sd===wb.commandId){wb.score=Rc;Rb.remove(sd);break}}if(!Rb.count)break}return Cb}Xjl(Za){const Cb=1>Za.length;for(let Td=0;2>=Td;Td++){const sd=this.oRb;for(let Me in sd){var Rb=sd[Me],pc=Za,Rc=Me;const tf=Rc.length+1,Pf=Array((pc.length+1)*tf);for(var wb=0;wb<=pc.length;wb++)Pf[wb*tf]=wb;for(wb=0;wb<=Rc.length;wb++)Pf[wb]=wb;for(wb=0;wb<Rc.length;wb++)for(let Yh=0;Yh<pc.length;Yh++)Pf[(Yh+
1)*tf+(wb+1)]=pc.charAt(Yh)===Rc.charAt(wb)?Pf[Yh*tf+wb]:Math.min(Math.min(Pf[Yh*tf+(wb+1)]+1,Pf[(Yh+1)*tf+wb]+1),Pf[Yh*tf+wb]+1);pc=Pf[pc.length*tf+Rc.length];if((!pc||!Cb)&&pc<=Td)return Rb}}return this.tVb}AEh(Za){this.mfd=Za.hef();this.z8a=Za.dDl();this.tVb=Za.RLl();this.oRb=Za.Bul();if(this.Ew=!!this.mfd&&!!this.z8a&&!!this.oRb&&!!this.tVb)this.Ew=0<this.z8a.length&&ch.Jnf(this.z8a);this.Ew&&(this.Ew=0<this.tVb.length&&ch.Jnf(this.tVb));this.Ew&&(this.oRb=ch.GMl(this.oRb));this.Ew||(this.oRb=
this.tVb=this.z8a=this.mfd=null)}WKl(Za){Za=this.DIl(Za);return this.r6k(Za,this.Syj)}r6k(Za,Cb){let Rb=[];for(let pc=0;pc<Za.length;pc++)Za[pc].score>=Cb&&Rb.push(Za[pc]);Rb.sort((pc,Rc)=>pc.score<Rc.score?1:pc.score>Rc.score?-1:0);0<Rb.length-10&&(Rb=Rb.slice(0,10));return Rb}static nFm(Za,Cb){if(!Za.length)return Cb;if(Za.length!==Cb.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let Rb=0;Rb<Za.length;Rb++){if(Za[Rb].commandId!==Cb[Rb].commandId)throw Error.create("Incorrect CommandId");
let pc;(pc=Za[Rb]).score=pc.score+Cb[Rb].score}return Za}static kKm(Za){return Ie.a.mh(Za)}static Jnf(Za){for(let Cb=0;Cb<Za.length;Cb++)if(2!==Za[Cb].length)return!1;return!0}static GMl(Za){const Cb={};for(let Rc in Za){var Rb=Rc,pc=Za[Rc];const wb=pc;wb.length&&ch.Jnf(wb)&&(Cb[Rb]=pc)}return Cb}}Object(m.a)(ch,"NaiveBayesClassifierModel",null,[]);class Oj{constructor(Za,Cb){this.uoa=null;this.jc=Za;this.hrc=new ch(Cb,Za.Pxl);this.jc.gvb&&(this.uoa=null)}WJ(){return"NBCommand"}wW(){return 0===this.jc.Hv?
0:1===this.jc.Hv?1:2}uI(Za,Cb,Rb=!1,pc=f.a.tellMe,Rc=null){const wb=new u.a(Za);if((!Rc||Array.contains(Rc,0))&&!Oi.a.tT(Za)){if(gg.CommandResultsUtility.cof(Za.ng)&&(Rc=gg.CommandResultsUtility.EMh(Za.ng),0<Rc.results.length)){Rc.displayName="Classifier Debug";wb.wv(Rc);Cb.resultsUpdated(wb);return}if(!this.hrc.Cqf()){if(pg.TellMeActor.instance.Qe)pg.TellMeActor.instance.Qe.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");
}this.jc.gvb&&this.uoa&&this.uoa.initialize();Rc=this.hrc.WKl(Za.ng);gg.CommandResultsUtility.bSd(Rc,!1,"Classifier","NaiveBayesian");Rc=gg.CommandResultsUtility.NGd(Za,Rc,this.jc,this.uoa,null,null,0,1);0<Rc.results.length&&pc!==f.a.contextMenu&&(Rc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);Rb||Rc.results.length||this.jc.yZ||this.jc.D2a||(Za=new Od.a("lookupNoResults",14,Za.ng,null,1),Rc.zy(Za));0<Rc.results.length&&wb.wv(Rc)}Cb.resultsUpdated(wb)}}Object(m.a)(Oj,"NaiveBayesCommandProvider",
null,[1093]);class Kg{constructor(){this.Xqb=null;this.Ew=!1;this.xae()}xae(){this.Ew||(this.Xqb=window.NBCRM)&&4===this.Xqb.length&&(this.Ew=!0);return this.Ew}dDl(){return this.Ew?this.Xqb[1]:null}RLl(){return this.Ew?this.Xqb[2]:null}Bul(){return this.Ew?this.Xqb[3][0]:null}hef(){return this.Ew?this.Xqb[0][0]:null}}Object(m.a)(Kg,"NaiveBayesModelAdapter",null,[1117]);var ul=d(212);class vl{constructor(Za){this.jc=Za}WJ(){return"OfficeScript"}wW(){return 0===this.jc.Hv?0:1===this.jc.Hv?1:2}uI(Za,
Cb){const Rb=new u.a(Za);if(!Oi.a.tT(Za)){Za=ul.d(Za.ng);var pc=new v.a(25);pc.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;pc=this.y7g(Za,vl.Ybo,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,pc);pc=this.y7g(Za,vl.scl,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,pc);Rb.wv(pc)}Cb.resultsUpdated(Rb)}y7g(Za,Cb,Rb,pc,Rc,wb){const Td=[];for(const sd of Cb)if(ul.a(Za,sd)){this.jc.VAa?(pg.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Rb,
Rc)),pg.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Rb,pc))):(Td.push(appChrome.actions.setControlLabel(Rb,Rc)),Td.push(appChrome.actions.setButtonCommandValueId(Rb,pc)),appChrome.api.dispatch(Td));wb.zy(new Od.a(Rb,26,null,null,1));break}return wb}}vl.Ybo="unhide row rows col cols column columns".split(" ");vl.scl=["freeze","selection","pane","panes"];Object(m.a)(vl,"OfficeScriptsSamplesProvider",null,[1093]);var am=d(79),Ug=d(282),xh=d(1507),Ed=d(1487),bm=d(1506),
In=d(35),nf=d(121),Ph=d(27);class um{constructor(Za){this.lG=null;this.GK=-1;this.byf=14;this.eyf=12;this.attributes=this.$Je=this.query=null;this.E6b=!1;this.vTb=[];this.hg=aj.AFrameworkApplication.Ze;aj.AFrameworkApplication.K&&(this.byf=aj.AFrameworkApplication.K.rc("TellMeMaxTermedResults",this.byf),this.eyf=aj.AFrameworkApplication.K.rc("TellMeMaxZeroTermResults",this.eyf));this.OT=Za}get Sn(){return this.vTb}get Zae(){return this.$Je}wv(Za){let Cb=!1;for(let Rb=0;Rb<this.Sn.length;Rb++)if(26!==
this.Sn[Rb].groupType&&this.Sn[Rb].groupType===Za.groupType){this.nNe(this.Sn[Rb],Za);Cb=!0;break}Cb||this.Sn.push(Za)}nNe(Za,Cb){for(let Rb=0;Rb<Cb.results.length;Rb++)Za.zy(Cb.results[Rb])}DMi(Za){const Cb=[];for(const Rb of this.Sn)Rb.groupType!==Za&&Cb.push(Rb);this.Sn.length!==Cb.length&&(this.vTb=Cb)}Rnn(Za){let Cb=null,Rb=null,pc=null;for(let Rc=0;Rc<Za.length;Rc++){const wb=Za[Rc];if(wb&&wb.Sn&&wb.Sn.length)for(const Td of wb.Sn)if(17===Td.groupType||18===Td.groupType)Cb=Td;else if(0===Td.groupType||
16===Td.groupType)Rb=Td,pc=wb}Cb&&Rb&&0<Rb.results.length&&(17===Cb.groupType&&({MMe:Rb,ANe:Cb}=gg.CommandResultsUtility.s1j(Rb,Cb,this.OT.KN()?this.OT.KN().xjl:-.6)),pc.DMi(Rb.groupType))}oYn(){new am.a;this.b0c(this.OT.tni)}BOc(Za,Cb){return this.query.ng.length>this.OT.KN().JDl&&this.tgm(Za,Cb)||this.query.ng.length>this.OT.KN().KDl&&this.gjm(Za,Cb)?!0:!1}gjm(Za,Cb){return Za&&Za.length&&Cb&&Cb.length?-1===Cb.toLowerCase().indexOf(Za.toLowerCase())?!1:!0:!1}tgm(Za,Cb){return Za&&Za.length&&Cb&&
Cb.length?Cb.toLowerCase().startsWith(Za.toLowerCase()):!1}B6k(Za){const Cb=[];for(const Rb of this.OT.KN().PQ?this.Zae:this.Sn)Za.contains(Rb.groupType)||Cb.push(Rb);this.OT.KN().PQ?this.$Je=Cb:this.vTb=Cb}cjo(Za,Cb){const Rb=[];for(const pc of this.Sn){const Rc=pc;if(13!==Rc.groupType){const wb=Za[Ed.a[Rc.groupType].toLowerCase()];let Td="False";wb<Cb&&(Td="True");Rc.displayName=Rc.displayName+" ("+Td+": "+wb+")"}Rb.push(Rc)}this.vTb=Rb}b0c(Za,Cb=!1,Rb=null){if(this.OT.KN().PQ){if(!Cb)for(this.$Je=
Array(this.Sn.length),Cb=0;Cb<this.Sn.length;Cb++)this.Zae[Cb]=this.Sn[Cb];this.OT.yni.b0c(this.Sn,this.Zae,this.query,Za,Rb)}else{for(Rb=new am.a;this.Sn.length;){Cb=this.Sn.pop();const pc=Ed.a[Cb.groupType].toLowerCase(),Rc=Za[pc];if(Ph.c(Rc))throw Error.create("GroupId "+pc+" missed from group SortingOrder");Rb.add(new Ug.a(Rc,Cb))}Rb.Sc((pc,Rc)=>pc.key<Rc.key?-1:1);for(Za=0;Za<Rb.count;Za++)Cb=Rb.J(Za).value,this.Sn.push(Cb)}}pYn(){var Za=!1;let Cb=!1,Rb=!1;for(let Rc=0;Rc<this.Sn.length;Rc++){var pc=
this.Sn[Rc];const wb=pc.groupType;if(8===wb||15===wb||14===wb){pc=pc.results;for(let Td=0;Td<pc.length;Td++){if(8===wb&&this.BOc(this.query.ng,pc[Td].label)){Za=!0;break}if(15===wb&&this.BOc(this.query.ng,pc[Td].label)){Cb=!0;break}if(14===wb){if(this.BOc(this.query.ng,pc[Td].label)||this.BOc(this.query.ng,pc[Td].description)){Rb=!0;break}const sd=pc[Td].label.split(" ");for(const Me of sd)if(this.BOc(this.query.ng,Me)){Rb=!0;break}}}}}Za=this.OT.wFl(Za,Cb,Rb);this.b0c(Za)}w0a(Za,Cb,Rb,pc,Rc,wb){if(Rc===
this.lG){var Td=Za.data.Ee;Rc=null;try{Rc=In.b(Td)}catch(za){pg.TellMeActor.instance.Qe.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+za);return}if("RankerResults"in Rc&&Rc.RankerResults){this.v9();var sd=Rc.RankerResults,Me=new am.a,tf=new am.a;Td=0;for(var Pf of sd){sd=Pf.ProviderId;var Yh=Pf.Score;Td+=Yh;Me.add(new Ug.a(sd,Yh))}Me.Sc((rb,Zb)=>rb.value>Zb.value?-1:1);Yh=wb?wb.rXh:1E-6;Pf={};sd={};let za=0;for(var ti=0;ti<Me.count;ti++){let rb=parseInt(Me.J(ti).key),
Zb=Me.J(ti).value/Td;1===rb&&(sd.answer=za++,sd.entity=za++,sd.definition=za++,sd.wolframanswer=za++,Zb<Yh&&(tf.add(9),tf.add(11),tf.add(10),tf.add(12)),Pf.answer=Zb,Pf.entity=Zb,Pf.definition=Zb,Pf.wolframanswer=Zb);2===rb&&(sd.assistance=za++,Zb<Yh&&tf.add(8),Pf.assistance=Zb);3===rb&&(sd.classifier=za++,sd.serviceclassifier=za++,Zb<Yh&&(tf.add(0),tf.add(17)),Pf.classifier=Zb,Pf.serviceclassifier=Zb);4===rb&&(sd.people=za++,Zb<Yh&&tf.add(14),Pf.people=Zb);5===rb&&(sd.document=za++,Zb<Yh&&tf.add(15),
Pf.document=Zb);6===rb&&(sd.findindocument=za++,Zb<Yh&&tf.add(2),Pf.findindocument=Zb);7===rb&&(sd.notes=za++,Zb<Yh&&tf.add(20),Pf.notes=Zb);8===rb&&(sd.image=za++,Zb<Yh&&tf.add(19),Pf.image=Zb)}Me=new am.a;Me.add("classifier");Me.add("serviceclassifier");Me.add("appsforoffice");Me.add("addin");Me.add("findindocument");Me.add("assistance");Me.add("document");Me.add("people");Me.add("answer");Me.add("wolframanswer");Me.add("definition");Me.add("entity");Me.add("image");Me.add("template");Me.add("officescript");
for(ti=0;ti<Me.count;ti++)Me.J(ti)in sd||(sd[Me.J(ti)]=za++);sd.learning=za++;sd.insights=za++;sd.feedback=za++;wb&&wb.bdi&&this.cjo(Pf,Yh);wb&&wb.cdi&&this.B6k(tf);tf={};for(var Fh in Pf)tf[Fh]=Pf[Fh]*Td;this.b0c(sd,!0,tf)}if(wb.$Od&&"Intents"in Rc&&Rc.Intents){Fh=Rc.Intents;for(var Pg of Fh)if(this.Ssf(Pg)&&"Serplet"===Pg.GroupType&&Pg.ConfidenceScore>Pg.ConfidenceThreshold){Fh=!1;Rc=0;if(wb.aPd){Td=new Od.a("",27);for(tf=0;tf<this.Sn.length;tf++)if((Me=this.Sn[tf].results)&&0<Me.length){Rc=tf;
Td=Me[0];break}2===Td.groupType&&(Fh=!0)}Td=new v.a(13);Fh&&wb.aPd&&(Td=new v.a(13,CommonUIStrings.l_TellMeWebTitle));tf=new Od.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.ng,null,0);Me=[];Pf=null;Pf=Oi.a.bCa()?Oi.a.mWa(this.query.ng,1):Oi.a.exb(this.query.ng);Me.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",Pf));Pf=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.ng);Me.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",
Pf));appChrome.api.dispatch(Me);Td.zy(tf);tf=[];if(Fh&&wb.aPd)for(tf.push(this.Sn[Rc]),tf.push(Td),Fh=Rc+1;Fh<this.Sn.length;Fh++)(Rc=this.Sn[Fh].results)&&0<Rc.length&&tf.push(this.Sn[Fh]);else for(tf.push(Td),Fh=0;Fh<this.Sn.length;Fh++)(Rc=this.Sn[Fh].results)&&0<Rc.length&&tf.push(this.Sn[Fh]);this.vTb=tf}}if(wb.KOc&&!wb.PQ){Pg=Fh=-1;for(Rc=0;Rc<this.Sn.length;Rc++)switch(this.Sn[Rc].groupType){case 23:Fh=Rc;break;case 0:case 17:case 2:-1===Pg&&(Pg=Rc)}if(-1!==Fh){Pg=-1===Pg?0:Fh>Pg?Pg+1:Pg;Fh=
this.Sn[Fh];Rc=Array(this.Sn.length);Td=0;for(tf=0;tf<Rc.length;tf++)tf===Pg?Rc[tf]=Fh:(23===this.Sn[Td].groupType&&Td++,Rc[tf]=this.Sn[Td],Td++);this.vTb=Rc}}pc.resultsUpdated(this);pc=pg.TellMeActor.instance.Qe;pc.nX(Cb.length,"RankerInference",Za.data.mf.toString(),Math.round(window.performance.now()-Rb),bm.a.n9i,!0,xh.a.Rsa);this.E6b&&pc&&(Za=this.query.d1a,Cb=pc.q8c,wb.oPd&&Za>Cb&&!wb.PQ&&(pc.uwf(this.query.ng),pc.mWf(Za)))}}Ssf(Za){if("GroupType"in Za&&Za.GroupType&&"ConfidenceScore"in Za&&
"ConfidenceThreshold"in Za)return!0;pg.TellMeActor.instance.Qe.onError("IsValidIntentGroup","Invalid intents found");return!1}m0a(Za,Cb,Rb,pc,Rc){pc===this.lG&&(this.v9(),pg.TellMeActor.instance.Qe.nX(Cb.length,"RankerInference",Za.data.mf.toString(),Math.round(window.performance.now()-Rb),bm.a.n9i,!1,xh.a.Rsa));Rc.resultsUpdated(this)}v9(){-1!==this.GK&&(window.clearTimeout(this.GK),this.GK=-1)}qYn(Za){let Cb;Cb=this.OT.KN().PQ?pg.TellMeActor.instance.Qe.Dgf(this.Zae,this.query.ng):pg.TellMeActor.instance.Qe.Dgf(this.Sn,
this.query.ng);var Rb=this.OT.KN().qXh;""!==Rb&&(Rb="_"+Rb);let pc="";this.OT.KN().kOd&&(pc="RankerInference"+Rb+",");this.OT.KN().$Od&&(pc+="SerpletClassifier");","===pc.charAt(pc.length-1)&&(pc=pc.substring(0,pc.length-1));Rb=pg.TellMeActor.instance.Qe.dZh(pc);const Rc=this.lG=nf.a.create().toString();Rb["Client-Request-Id"]=Rc;const wb=window.performance.now(),Td=this.OT.KN()?this.OT.KN().sXh:600;this.v9();this.GK=window.setTimeout(()=>{if(Rc===this.lG){this.lG="";this.GK=-1;Za.resultsUpdated(this);
const sd={};sd[a.a.provider]="Ranker";sd[a.a.Oib]=this.query.d1a;pg.TellMeActor.instance.Qe.DA(l.a.timedOut,Td,sd)}},Td);this.hg.Lj(pg.TellMeActor.instance.Qe.eZh(),2,Cb,Rb,!1,0,sd=>{this.w0a(sd,this.query.ng,wb,Za,Rc,this.OT.KN())},sd=>{this.m0a(sd,this.query.ng,wb,Rc,Za)},null,null,!1,4E3,6E3)}K9n(){var Za=0,Cb=new am.a,Rb=this.OT.rni,pc=this.OT.sni;for(var Rc=0;Rc<this.Sn.length;Rc++){var wb=this.Sn[Rc],Td=Ed.a[wb.groupType].toLowerCase(),sd=Rb[Td];Za+=wb.results.length;wb.results.length>sd&&(Td=
pc[Td],Ph.c(Td)||Cb.add(new Ug.a(Td,wb)))}pc=!this.query||""===this.query.ng.trim();Rc=Za-(pc?this.eyf:this.byf);if(!(0>=Rc)){pc=window.performance.now();Za=Za.toString()+" total,"+Rc.toString()+" to remove.";if(0<Cb.count)for(Cb.Sc((Me,tf)=>Me.key>tf.key?-1:1),wb=0;wb<Cb.count&&0<Rc;wb++){Td=Cb.J(wb).value;sd=Ed.a[Td.groupType].toLowerCase();let Me=Td.results.length-Rb[sd];Me>Rc&&(Me=Rc);0<Me&&(Td.SQf(Me),Za+=sd+": "+Me.toString()+" results removed.",Rc-=Me)}if(0<Rc){Za+=Rc.toString()+" results left after trimming.";
Cb=new am.a;Rb=this.OT.wni;for(wb=0;wb<this.Sn.length;wb++)Td=this.Sn[wb],sd=Rb[Ed.a[Td.groupType].toLowerCase()],Ph.c(sd)||Cb.add(new Ug.a(sd,Td));Cb.Sc((Me,tf)=>Me.key<tf.key?-1:1);for(Rb=0;0<Rc;)wb=Cb.J(Rb++).value,Rc>=wb.results.length?(Array.remove(this.Sn,wb),Za+=Ed.a[wb.groupType]+": "+wb.results.length.toString()+" results force removed.",Rc-=wb.results.length):(wb.SQf(Rc),Za+=Ed.a[wb.groupType]+": "+Rc.toString()+" results force removed.",Rc=0)}pg.TellMeActor.instance.Qe&&(Cb={},Cb[a.a.message]=
Za,pg.TellMeActor.instance.Qe.DA("ShowOptimal",window.performance.now()-pc,Cb))}}}Object(m.a)(um,"CombineResultsUpdatedEventArgs",null,[1069]);var Kc=d(1577);class dk{constructor(Za,Cb,Rb,pc=!1,Rc=""){this.dBe=this.IDe=!1;this.Ku=Za;this.Dsb=[];this.uVg=Cb.length;this.jc=pg.TellMeActor.instance.KN();this.udd=pc;this.$ia=Rc;this.NUb={};for(Za=0;Za<Cb.length;++Za)this.NUb[Za.toString()]=Rb?0:Cb[Za].wW()}GLn(Za,Cb){Cb&&Cb.query&&Cb.query.d1a<pg.TellMeActor.instance.dqa||(this.Dsb[Za]=Cb,this.dBe?this.IDe=
!0:(!this.jc||3!==this.jc.Hv||3!==this.NUb[Za.toString()]||this.hyh())&&this.eMd())}G1m(){this.dBe=!0}pco(){this.dBe=!1;this.IDe&&(this.IDe=!1,this.eMd())}hyh(){if(this.Dsb.length<this.uVg)return!1;for(let Za=0;Za<this.uVg;++Za)if(!this.Dsb[Za])return!1;return!0}eMd(){var Za=this.hyh();const Cb=window.performance.now(),Rb=new um(pg.TellMeActor.instance.cFg);Rb.Rnn(this.Dsb);for(var pc=0;pc<this.Dsb.length;++pc){var Rc=this.Dsb[pc];if(Rc&&Rc.Sn&&Rc.Sn.length&&(Rb.query=Rc.query,Rc.attributes&&0<Rc.attributes.length&&
(Rb.attributes=Rc.attributes),Rc&&Rc.Sn&&(Za||this.ntk(pc,this.Dsb))))for(const wb of Rc.Sn)Rb.wv(wb)}Rb.Sn&&Rb.Sn.length&&(Rb.E6b=Za,this.jc&&this.jc.gae&&Rb.K9n(),Kc.a.Ifi()&&(this.jc&&this.jc.Khm&&Rb.query.ng&&0<Rb.query.ng.length?Rb.pYn():Rb.oYn()),Kc.a.Ifi()&&this.jc&&(this.jc.kOd||this.jc.$Od)&&this.udd&&Rb.query.ng&&0<Rb.query.ng.length&&Rb.E6b&&this.$ia!==f.a.contextMenu?(3===this.jc.Hv&&Za||this.Ku.resultsUpdated(Rb),Rb.qYn(this.Ku)):this.Ku.resultsUpdated(Rb),Za=pg.TellMeActor.instance.Qe,
Rb.E6b&&Za&&(pc=Rb.query.d1a,Rc=Za.q8c,Rb.query.ng&&0<Rb.query.ng.length&&this.udd&&this.jc.oPd&&this.$ia!==f.a.contextMenu&&pc>Rc&&!this.jc.kOd&&!this.jc.PQ&&(Za.uwf(Rb.query.ng),Za.mWf(pc)),Za.DA(l.a.jwn,window.performance.now()-Cb)))}ntk(Za,Cb){if(!(this.NUb&&Za.toString()in this.NUb)||Cb.length<=Za||!Cb[Za])return!1;if(!Cb[Za].Sn.length)return!0;const Rb=this.NUb[Za.toString()];if(0===Rb)return!0;const pc=this.NUb;for(let wb in pc){var Rc=pc[wb];const Td=Number.parseInvariant(wb);if(Td!==Za&&
Rc===Rb&&!(Cb.length>Td&&Cb[Td]))return!1}return!0}}Object(m.a)(dk,"ResultsAggregator",null,[]);var oi=d(1687);class Bd{constructor(){this.Mfc=this.Nfc=this.Lfc=this.logCount=this.logRank=this.invertedRank=0}c1j(Za,Cb){switch(Za){case 1:this.invertedRank=Cb;break;case 3:this.logRank=Cb;break;case 2:this.logCount=Cb;break;case 5:this.Lfc=Cb;break;case 4:this.Nfc=Cb;break;case 6:this.Mfc=Cb}}}Object(m.a)(Bd,"CommandFeatures",null,[]);class uk{constructor(Za){this.ACg=0;this.hLj=Za;this.jxj={}}get modelId(){return this.hLj}get featureIntercept(){return this.ACg}get zAc(){return this.jxj}a0j(Za,
Cb,Rb){0===Cb?this.ACg=Rb:(this.zAc[Za]||(this.zAc[Za]=new Bd),this.zAc[Za].c1j(Cb,Rb))}}Object(m.a)(uk,"CoefficientsModel",null,[]);const cl=(Za,Cb)=>Math.pow(10,-Cb/(60*Math.LN10/Math.LN2*Za));class qe{constructor(Za,Cb){this.aj=1;this.f$c=new Bd;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=Za?1/Za:0;this.features.logRank=2/Math.pow(2,Za);this.features.Lfc=cl(10,Cb);this.features.Nfc=cl(2,Cb);this.features.Mfc=cl(1,Cb)}get count(){return this.aj}get features(){return this.f$c}D5h(){this.aj=
this.count+1;this.features.logCount=1+Math.log(this.count)/Math.LN2}Qio(Za){const Cb=2/Math.pow(2,Za);this.features.invertedRank=Math.max(this.features.invertedRank,Za?1/Za:0);this.features.logRank=Math.max(this.features.logRank,Cb)}qko(Za){const Cb=cl(10,Za),Rb=cl(2,Za);Za=cl(1,Za);this.features.Lfc=Math.max(this.features.Lfc,Cb);this.features.Nfc=Math.max(this.features.Nfc,Rb);this.features.Mfc=Math.max(this.features.Mfc,Za)}}Object(m.a)(qe,"CommandModel",null,[]);class Wf{constructor(Za){this.bkc=
null;if(!Za&&pg.TellMeActor.instance.Qe)pg.TellMeActor.instance.Qe.onError("PredictionEngine","IModelAdapter can't be null");this.YRb=Za;this.lfd=this.Avf()}Avf(){const Za=this.YRb.oxl(),Cb=this.YRb.hef();if(void 0===Za||null===Za||void 0===Cb||null===Cb)return!1;try{window.performance.now();this.bkc={};for(let Rb=0;Rb<Za.length;Rb++){const pc=Za[Rb],Rc=Cb[pc[0].toString()].trim(),wb=pc[1],Td=0!==wb?Cb[pc[2].toString()].trim():"",sd=pc[3];Rc in this.bkc||(this.bkc[Rc]=new uk(Rc));this.bkc[Rc].a0j(Td,
wb,sd)}}catch(Rb){if(pg.TellMeActor.instance.Qe)pg.TellMeActor.instance.Qe.onError("LoadModelData","Error Loading Suggestions Model: "+Rb);return!1}return!0}hdl(){const Za=this.YRb.Ttl(),Cb={};if(!Za)return Cb;let Rb=1;for(let pc=0;pc<Za.length;pc++){const Rc=Za[pc];Rc.Id in Cb?(Cb[Rc.Id].D5h(),Cb[Rc.Id].Qio(Rb),Cb[Rc.Id].qko(Rc.TimeElapsedSinceClick)):Cb[Rc.Id]=new qe(Rb,Rc.TimeElapsedSinceClick);Rb++}return Cb}Cqf(){this.lfd||(this.lfd=this.Avf());return this.lfd}tCl(){let Za=[];if(!this.lfd){if(pg.TellMeActor.instance.Qe)pg.TellMeActor.instance.Qe.onError("GetPredictedCommands",
"IModelAdapter returned no data");return Za}const Cb=this.hdl(),Rb=this.bkc;for(let Rc in Rb){const wb=Rb[Rc],Td=wb.modelId;let sd=0;for(let Me in Cb){var pc=Me;const tf=Cb[Me].features;(pc=pc in wb.zAc?wb.zAc[pc]:null)&&(sd+=tf.invertedRank*pc.invertedRank+tf.logRank*pc.logRank+tf.logCount*pc.logCount+tf.Lfc*pc.Lfc+tf.Nfc*pc.Nfc+tf.Mfc*pc.Mfc)}sd+=wb.featureIntercept;Za.push(new le.a(Td,sd))}Za.sort((Rc,wb)=>Rc.score<wb.score?1:Rc.score>wb.score?-1:0);0<Za.length-10&&(Za=Za.slice(0,10));return Za}}
Object(m.a)(Wf,"PredictionEngine",null,[]);class dl{constructor(){this.AYg={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),
"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),
"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}DDd(Za,
Cb){return Cb&&"word"===Cb.application.toLowerCase()&&Za in this.AYg?this.AYg[Za]:[]}}Object(m.a)(dl,"SuggestionResultsUtility",null,[]);class Ne{constructor(Za,Cb,Rb){this.jc=Cb;this.hrc=new Wf(Za);this.M0=Rb;this.s0g=new dl}WJ(){return"Suggestion"}wW(){return 0===this.jc.Hv?0:1===this.jc.Hv?1:2}uI(Za,Cb,Rb,pc=f.a.tellMe,Rc=null){Rb=new u.a(Za);pg.TellMeActor.instance.q3c=!1;if((!Rc||Array.contains(Rc,16))&&Oi.a.tT(Za)){if(!this.hrc.Cqf()){if(pg.TellMeActor.instance.Qe)pg.TellMeActor.instance.Qe.onError("CRASH",
"SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}if(this.VOd()&&0<this.s0g.DDd(pg.TellMeActor.instance.ixd,this.jc).length){const Td=this.s0g.DDd(pg.TellMeActor.instance.ixd,this.jc);Rc=[];for(var wb of Td)this.jc.R6d&&"Find"===wb||Rc.push(new le.a(wb,0));pg.TellMeActor.instance.q3c=!0}else Rc=this.hrc.tCl();gg.CommandResultsUtility.bSd(Rc,!0,"Recommended","LRE");wb=[];for(const Td of Rc)this.M0&&this.M0.CXe(Td.commandId)||
wb.push(Td);Za=gg.CommandResultsUtility.NGd(Za,wb,this.jc,null,null,null,16,1);0<Za.results.length&&pc!==f.a.contextMenu&&(Za.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<Za.results.length&&Rb.wv(Za)}Cb.resultsUpdated(Rb)}VOd(){return!!this.jc&&(this.jc.VOd||this.jc.Vlm)}}Object(m.a)(Ne,"SuggestionResultsProvider",null,[1093]);class rj{Ttl(){return pg.TellMeActor.instance.lje}oxl(){return window.TellMeSuggestionModel}hef(){return window.CoefficientModelIdMap}}Object(m.a)(rj,"SuggestionsModelAdapter",
null,[1115]);var vk=d(1701),Vh=d(1661);d.d(M,"AggregatorResultsProvider",function(){return zd});class zd{constructor(Za=!1){this.iTb={};this.iTb[f.a.tellMe]=[];this.iTb[f.a.contextMenu]=[];this.udd=Za}zhi(Za,Cb,Rb,pc,Rc=null){let wb;var Td=!1;switch(pc){case f.a.contextMenu:wb=this.iTb[f.a.contextMenu];Td=!0;break;default:wb=this.iTb[f.a.tellMe]}Cb=new dk(Cb,wb,Td,this.udd,pc);Cb.G1m();for(let sd=0;sd<wb.length;++sd){const Me=window.performance.now(),tf=new w(Cb,sd);(Td=pg.TellMeActor.instance.KN())&&
Td.sik?window.setTimeout(()=>{wb[sd].uI(Za,tf,Rb,pc,Rc);if(pg.TellMeActor.instance.Qe){const Pf={};Pf[a.a.provider]=wb[sd].WJ();Pf[a.a.Oib]=Za.d1a;pg.TellMeActor.instance.Qe.DA(l.a.uI,window.performance.now()-Me,Pf)}},0):(wb[sd].uI(Za,tf,Rb,pc,Rc),pg.TellMeActor.instance.Qe&&(Td={},Td[a.a.provider]=wb[sd].WJ(),Td[a.a.Oib]=Za.d1a,pg.TellMeActor.instance.Qe.DA(l.a.uI,window.performance.now()-Me,Td)))}Cb.pco()}WJ(){return"Aggregator"}wW(){return 0}uI(Za,Cb,Rb=!1,pc=f.a.tellMe,Rc=null){if(pg.TellMeActor.instance.aHm)this.zhi(Za,
Cb,Rb,pc,Rc);else{const wb=window.performance.now();pg.TellMeActor.instance.Foo.then(()=>{pg.TellMeActor.instance.Qe&&pg.TellMeActor.instance.Qe.DA(l.a.bHm,window.performance.now()-wb);this.zhi(Za,Cb,Rb,pc,Rc);return!0})}}HH(Za,Cb){this.iTb[Cb].push(Za)}M1j(Za){switch(Za){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Cb=this.iTb[f.a.tellMe];for(const Rb of Cb)if("FindInDocument"===Rb.WJ()){Rb.OJn(Za);break}}}static createInstance(Za,Cb,Rb,pc){const Rc=
pc&&Oi.a.OYf(Cb);var wb=Rc&&Cb.KHf;const Td=Cb.Dsf&&!Oi.a.gDb(),sd=Cb.Oqf,Me=new zd(Rc);if(Cb.GSn){var tf=new Cf(Cb);Me.HH(tf,f.a.tellMe)}tf=Cb.aq?aj.AFrameworkApplication.K.$("TellMeIsSuggestionsForSimplifiedUxEnabled"):aj.AFrameworkApplication.K.$("TellMeSuggestionsIsEnabled");const Pf=!tf&&aj.AFrameworkApplication.K.$("TellMeFirstRunExperienceIsEnabled");Me.HH(new yd.a(Za,Cb.Bao,Pf,!1),f.a.tellMe);tf&&Me.HH(new Ne(new rj,Cb,Za),f.a.tellMe);Za=aj.AFrameworkApplication.ua.Sb.vgi?new Oj(Cb,new Kg):
new Lj(Cb,Rb);Me.HH(Za,f.a.contextMenu);(Rc&&Cb.LHf||wb)&&Me.HH(vk.a.auh(Cb,!0),f.a.tellMe);Me.HH(Za,f.a.tellMe);!Cb.eGh||"Word"===Cb.application&&Cb.yBd||Me.HH(new $g(Cb),f.a.tellMe);Cb.gvb&&(wb=new z(Cb),Me.HH(wb,f.a.tellMe),Me.HH(wb,f.a.contextMenu));!Cb.nvb||Cb.q_c||Cb.p_c||Me.HH(new B.a(Cb),f.a.tellMe);pc&&(Cb.yZ||Oi.a.bCa())&&(wb=new Pi(Cb),Me.HH(wb,f.a.tellMe),Me.HH(wb,f.a.contextMenu));Rc&&Me.HH(vk.a.auh(Cb,!1),f.a.tellMe);pc&&!Cb.L1f&&Oi.a.NYf(Cb)&&(Me.HH(new oi.a(Cb),f.a.tellMe),Cb.A7i&&
Me.HH(new oi.a(Cb),f.a.contextMenu));Td&&Me.HH(new dg(Cb),f.a.tellMe);(Cb.Vdc||Cb.PQ)&&Me.HH(new fh.a(Cb),f.a.tellMe);Cb.KOc&&Me.HH(new Vh.a(Cb),f.a.tellMe);pc&&aj.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ForbiddenCatalogGetLoaderParamsFromCallback",!1)&&Cb.hMc&&Me.HH(new r.AddinResultsProvider(Cb),f.a.tellMe);sd&&"Excel"===Cb.application&&Me.HH(new vl(Cb),f.a.tellMe);return Me}}Object(m.a)(zd,"AggregatorResultsProvider",null,[1093])},1680:function(D,M,d){D=d(0);
var m=d(17),f=d(5),a=d(150),l=d(216),r=d(385),w=d(59),v=d(72),u=d(918),z=d(843),B=d(543);d(489);var G=d(1651),F=d(1652),K=d(1648),N=d(1650),H=d(1649),J=d(917),L=d(842);class I{constructor(da,ja,Ga){this.Ecl=da;this.Kfk=ja;this.rrk=Ga}}Object(D.a)(I,"BacktraceAndMakeUpdateHintsInput",null,[]);var R=d(1505),C;(function(da){da[da.EOP=0]="EOP";da[da.character=1]="character";da[da.embeddedMarker=2]="embeddedMarker"})(C||(C={}));Object(D.b)("LCSBlockType",C);class P{toString(){return String.format("[Type: {0}]",
C[this.type])}}Object(D.a)(P,"ALCSBlock",null,[]);class W extends P{constructor(da,ja){super();this.tie=ja;this.OAe=da}get type(){return 1}get character(){return this.tie}get av(){return this.OAe}Lz(da){return 1===da.type&&R.a.gch(da.character,this.character)}toString(){return String.format("{0} [Char: {1}]",super.toString(),this.character)}}Object(D.a)(W,"CharacterLCSBlock",P,[]);class X extends P{constructor(da,ja,Ga){super();this.OAe=da;this.sLe=ja;this.hqc=Ga}get type(){return 0}get Mc(){return this.sLe}get length(){return this.hqc}get av(){return this.OAe}Lz(da){return 0!==
da.type?!1:da.av===this.av&&da.Mc===this.Mc}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",super.toString(),this.av.toString(),this.Mc,this.length)}}Object(D.a)(X,"EOPLCSBlock",P,[]);class V extends W{constructor(da,ja,Ga){super(da,"\ufffc");this.wKj=ja;this.W$c=Ga}get type(){return 2}get Yl(){return this.wKj}get Aj(){return this.W$c}Lz(da){return 2!==da.type?!1:da.Yl===this.Yl&&this.Aj.equals(da.Aj)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",super.toString(),
this.Yl,this.Aj)}}Object(D.a)(V,"EmbeddedMarkerLCSBlock",W,[]);class Y{constructor(da,ja){this.x=da;this.y=ja}equals(da){return da.x===this.x&&da.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(D.a)(Y,"IntPair",null,[881]);var ca=d(1537),fa=d(1523),sa=d(1538),ia=d(1647);d.d(M,"a",function(){return ea});class ea{constructor(da,ja){this.Lg=da;this.ee=ja}luh(da,ja,Ga,ya,ta,ua,Sa){return this.tMk(da,ja,Ga,ya,ta,ua,Sa)}tMk(da,ja,Ga,ya,ta,ua,Sa){let ka;ka=null;({returnValue:da}=this.pFd(da,
ja));if(!da)return a.a.instance.Ya(575706449,1,2,"Failed to get LCS blocks from objects for base"),this.ee.logger.MT("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ka};({returnValue:Ga}=this.pFd(Ga,ya));if(!Ga)return a.a.instance.Ya(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.ee.logger.MT("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:ka};this.ee.logger.MT("GetLCSBlocksFromObject");ka=this.sMk(da,Ga,ta,ua,Sa);return ka?{returnValue:!0,updateHints:ka}:(a.a.instance.Ya(575706451,
1,2,"Failed to Create UpdateHints"),{returnValue:!1,updateHints:ka})}VFh(da,ja,Ga,ya){({returnValue:da}=this.pFd(da,ja));if(!da)return-1;({returnValue:Ga}=this.pFd(Ga,ya));if(!Ga)return-1;({G0e:Ga}=this.YFh(da,Ga));return Ga}pFd(da,ja){let Ga;const ya=new l.a;Ga=new l.a;if(!da.length)return a.a.instance.Ya(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),this.ee.logger.Pg(Object.assign(new ca.a,{kj:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,d6e:Ga};for(let Sa=0;Sa<
da.length;Sa++)if(this.ee.runtime.RF("GetLCSBlocksFromObject: paraObjs#"+Sa),393230===da.J(Sa).Qc){const ka=this.Lg.getPropertyString(da.J(Sa),m.a.lo),ha=this.Lg.getPropertyUint32(da.J(Sa),f.a.Mc);if(null==ha)return a.a.instance.Ya(594124835,1,2,"Abandoning LCS due to missing WordId"),this.ee.logger.Pg(Object.assign(new ca.a,{kj:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,d6e:Ga};let Ca=this.Lg.getPropertyUint32s(da.J(Sa),m.a.zm);Ca=fa.a.eZi(Ca,ka.length);const Pa=this.Lg.getPropertyObjectIds(da.J(Sa),
m.a.Un);let Xa;for(Xa=0;Xa<Ca.length-1;Xa++){var ta=ja(Pa.mg(Xa)),ua=void 0;ua=ta?(ua=this.Lg.getPropertyBool(ta,m.a.E7))?ua:!1:!1;if(ua)ya.add(this.nHk(da.J(Sa).id,ta));else for(ta=Ca.mg(Xa);ta<Ca.mg(Xa+1);ta++)ya.add(new W(da.J(Sa).id,R.a.charAt(ka,ta)))}ya.add(new X(da.J(Sa).id,ha,Ca.J(Xa)));Ga.add(ya.length-1)}else return a.a.instance.Ya(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",da.J(Sa).Qc),this.ee.logger.Pg(Object.assign(new ca.a,{kj:"GetLCSBlocksFromObject",
eventId:"900ba"})),{returnValue:null,d6e:Ga};this.ee.runtime.RF("LCS: GetLCSBlocks for base");return{returnValue:ya,d6e:Ga}}nHk(da,ja){const Ga=null==this.Lg.getPropertyInt32(ja,f.a.gq)?0:this.Lg.getPropertyInt32(ja,f.a.gq);return new V(da,Ga,ja.id)}sMk(da,ja,Ga,ya,ta){ya=({G0e:Ga}=this.YFh(da,ja,Ga,ya,ta)).returnValue;this.ee.logger.MT("FindFurthestPaths");da=new I(ya,da,ja);da=new ia.a(this.Afk(da,Ga),1);this.ee.logger.MT("BacktraceAndMakeUpdateHints");return da}YFh(da,ja,Ga=-1,ya=-1,ta=-1){let ua;
if(-1===Ga||-1===ya||-1===ta)ta=ya=Ga=-1;ua=-1;const Sa=new r.a;Sa.Z(new Y(-1,1),new Y(0,-1));if(-1!==Ga){Sa.Z(new Y(0,0),new Y(Ga,Ga));var ka=1}else ka=0,ya=da.length,ta=ja.length;for(Ga=0;ka<=da.length+ja.length;ka++){let ha=!1;for(let Ca=-ka;Ca<=ka;Ca+=2){let Pa,Xa;Ca===-ka?(Pa=Sa.J(new Y(ka-1,Ca+1)).x,Xa=Sa.J(new Y(ka-1,Ca+1)).y+1):Ca===ka?(Pa=Sa.J(new Y(ka-1,Ca-1)).x+1,Xa=Sa.J(new Y(ka-1,Ca-1)).y):Sa.J(new Y(ka-1,Ca-1)).x>=Sa.J(new Y(ka-1,Ca+1)).x?(Pa=Sa.J(new Y(ka-1,Ca-1)).x+1,Xa=Sa.J(new Y(ka-
1,Ca-1)).y):(Pa=Sa.J(new Y(ka-1,Ca+1)).x,Xa=Sa.J(new Y(ka-1,Ca+1)).y+1);for(;Pa<ya&&Xa<ta&&da.J(Pa).Lz(ja.J(Xa));)Pa++,Xa++;Sa.Z(new Y(ka,Ca),new Y(Pa,Xa));if(Pa===ya&&Xa===ta){ha=!0;ua=ka;Ga=Ca;break}}if(ha)break;this.ee.runtime.RF("LCS FindFurthestPaths")}if(Ga!==ya-ta)return{returnValue:null,G0e:ua};Sa.Z(new Y(ua,Ga),new Y(ya+1,ta+1));a.a.instance.Ya(593826837,1,4,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",da.length,ja.length,ua);return{returnValue:Sa,
G0e:ua}}Afk(da,ja){const Ga=da.Ecl,ya=da.Kfk;da=da.rrk;const ta=new l.a;let ua=ya.length,Sa=da.length;for(;0<ua||0<Sa;){var ka=ua-1,ha=Sa-1;if(this.F1m(Ga,ja,ua,Sa)){ka=da.J(ha);if(1===ka.type||2===ka.type)this.T4l(ta,ua,ka);else if(0===ka.type)this.t4l(ta,ua,ka);else return a.a.instance.Ya(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",ka.type),this.ee.logger.Pg(Object.assign(new sa.a,{kj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;Sa--;ja--}else if(this.E1m(Ga,
ja,ua,Sa)){ha=ya.J(ka);if(1===ha.type||2===ha.type)this.vRk(ta,ka,ha);else if(0===ha.type)this.aRk(ta,ka,ha);else return a.a.instance.Ya(575706453,1,2,"Abandoning LCS due to unexpected block of type {0}",ha.type),this.ee.logger.Pg(Object.assign(new sa.a,{kj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;ua--;ja--}else if(ua&&Sa&&ya.J(ka).Lz(da.J(ha)))ua--,Sa--;else return a.a.instance.Ya(575706454,1,2,"Abandoning LCS due to being unable to find a path"),this.ee.logger.Pg(Object.assign(new sa.a,
{kj:"BacktraceAndMakeUpdateHints",eventId:"0"})),null}this.ee.runtime.RF("LCS: CreateUpdateHintsFromLCSBlocks");return ta}E1m(da,ja,Ga,ya){ja=new Y(ja-1,Ga-ya-1);return da.xb(ja)&&da.J(ja).x===Ga-1&&da.J(ja).y===ya}F1m(da,ja,Ga,ya){ja=new Y(ja-1,Ga-ya+1);return da.xb(ja)&&da.J(ja).x===Ga&&da.J(ja).y===ya-1}addPara(da,ja,Ga,ya,ta,ua){var Sa=null;Ga.block?Sa=Ga.block.av:0<=ta&&0===da.J(ta).type&&(Sa=da.J(ta).av);Ga=da=ua.av;if(ya.JWb.contains(da))for(ta=0,da=w.a.Of("{00000000-0000-0000-0000-000000000000}{"+
ta+"}");ya.JWb.contains(da);)ta++,da=w.a.Of("{00000000-0000-0000-0000-000000000000}{"+ta+"}");Sa=new u.AddParagraphUpdateHint(da,ua.Mc,Sa);Sa.xYm=Ga;ja.updateHints.add(Sa);ya.av=da;ya.Mc=ua.Mc;ya.JWb.add(da);ya.KNa=0}t4l(da,ja,Ga){Ga=new K.a(Ga.av,Ga.Mc);let ya=!1;if(0<da.length&&11===da.mg(da.length-1).type){const ta=da.mg(da.length-1);ta.cp===ja&&(ya=!0,ta.uZ.add(Ga))}ya||(ja=new H.a(ja),ja.uZ.add(Ga),da.add(ja))}splitPara(da,ja,Ga,ya,ta,ua,Sa,ka){da=this.P7k(ua.av,da,ja,ya);if(!da)return!1;ja=
new L.a(ua.av,ua.Mc,ua.KNa,da.av,da.Mc,Sa.av,Sa.Mc);Ga.updateHints.add(ja);ua.Mc=da.Mc;da!==ka?(ta.block=da,ta.uzo=ua.KNa,ta=new u.AddParagraphUpdateHint(ka.av,ka.Mc,da.av),Ga.updateHints.add(ta),ua.av=ka.av,ua.Mc=ka.Mc,ua.JWb.add(ka.av),ua.KNa=0):ua.JWb.add(Sa.av);return!0}T4l(da,ja,Ga){var ya=!1;if(0<da.length&&11===da.mg(da.length-1).type){const ta=da.mg(da.length-1);ta.cp===ja&&((ya=Object(v.a)(N.a,ta.uZ.J(ta.uZ.length-1)))?ya.text=Ga.character.toString()+ya.text:ta.uZ.add(new N.a(Ga.av,Ga.character.toString())),
ya=!0)}ya||(ja=new H.a(ja),ja.uZ.add(new N.a(Ga.av,Ga.character.toString())),da.add(ja))}deletePara(da,ja,Ga,ya,ta,ua){let Sa=-1;for(let ka=0;ka<ta.length;ka++)if(ta.J(ka)===ua){0<ka&&(Sa=ka-1);break}ua=null;0<=Sa&&(ua=ya.J(ta.J(Sa)));ya=new z.a(Ga.av,Ga.Mc,ua?ua.av:null);da.updateHints.add(ya);ua&&ja.av.equals(Ga.av)&&(ja.KNa=ua.length,ja.av=ua.av,ja.Mc=ua.Mc);ja.JWb.remove(Ga.av)}aRk(da,ja,Ga){ja=new G.a(ja,Ga.av,Ga.Mc);da.add(ja)}mergePara(da,ja,Ga){da.updateHints.add(new J.MergeParagraphUpdateHint(Ga.av,
Ga.Mc,Ga.length,ja.av,ja.Mc,Ga.av,ja.Mc));ja.KNa=Ga.length;ja.JWb.remove(ja.av);ja.av=Ga.av}deleteText(da,ja,Ga){let ya=!1;if(0<da.updateHints.length&&2===da.updateHints.mg(da.updateHints.length-1).type){const ta=da.updateHints.mg(da.updateHints.length-1);ta.Cg.equals(ja.av)&&ta.cp===ja.KNa&&(ta.cp=ja.KNa-1,ta.text=Ga.character.toString()+ta.text,ya=!0)}ya||da.updateHints.add(new B.DeleteTextUpdateHint(ja.av,ja.KNa-1,Ga.character.toString()));--ja.KNa}vRk(da,ja,Ga){let ya=!1;if(0<da.length&&8===da.mg(da.length-
1).type){const ta=da.mg(da.length-1);ta.cp===ja+1&&(ta.text=Ga.character.toString()+ta.text,--ta.cp,ya=!0)}ya||da.add(new F.a(ja,Ga.character.toString()))}P7k(da,ja,Ga,ya){for(;0<=ya;){var ta=ja.J(Ga.J(ya));if(0!==ta.type)break;if(ta.av.equals(da))return ta;ya--}return null}}Object(D.a)(ea,"LCSUpdateHintGenerator",null,[])},1686:function(D,M,d){d.r(M);D=d(0);var m=d(17),f=d(5),a=d(150),l=d(385),r=d(609),w=d(216),v=d(59),u=d(43),z=d(1492);class B extends z.a{constructor(){super()}get Yda(){return"ChildNodeListMerge"}}
Object(D.a)(B,"ChildNodeListMergeFailureDetail",z.a,[]);class G{Elb(Y,ca,fa){return ca.Ey(Y,fa.J(Y))}Ubj(Y,ca,fa,sa){let ia;return({value:ia}=ca.Dc(Y)).returnValue||({value:ia}=fa.Dc(Y)).returnValue?ia:sa.J(Y)}}Object(D.a)(G,"ChildNodeListMergeUtils",null,[1942]);var F=d(1519),K=d(1700),N=d(1575);class H{constructor(Y,ca){this.classId=Y;this.abo=ca}}Object(D.a)(H,"NodeChildrenTransformation",null,[]);var J=d(780),L=d(1510);class I{constructor(Y,ca,fa){this.QD=Y;this.foa=fa;this.R5=ca}D_d(Y){let ca,
fa;return({fGi:ca}=this.$bj(this.foa,Y)).returnValue&&ca.PW||({fGi:fa}=this.$bj(this.R5,Y)).returnValue&&fa.PW}$bj(Y,ca){let fa;return{returnValue:({value:fa}=(new L.a(this.QD,Y)).dna.Dc(J.a.yb(ca))).returnValue,fGi:fa}}}Object(D.a)(I,"NodeTriplet",null,[]);var R=d(1646);class C{constructor(Y,ca,fa){this.ee=Y;this.Lg=ca;this.HV=fa;this.n0g=!0}get Wo(){return this.ee}get Yd(){return this.Lg}get Tva(){return this.HV}get success(){return this.n0g}HBl(){a.a.instance.Ya(4220310,1,5,"Evaluating ParentObjects");
const Y=new l.a;this.dTe(Y,ca=>this.Wo.runtime.jk.J(ca));this.dTe(Y,ca=>this.Tva.Elb(ca,this.Wo.runtime.Vt,this.Wo.runtime.jk));this.dTe(Y,ca=>this.Tva.Elb(ca,this.Wo.runtime.kq,this.Wo.runtime.jk));return Y}dTe(Y,ca){const fa=ca(d(1686).ChildNodeListMerge.tYd);this.Yd.getPropertyObjectIds(fa,m.a.rf).forEach(sa=>{this.Yd.getPropertyObjectIds(ca(sa),m.a.rf).forEach(ia=>{Y.xb(ia)&&!sa.equals(Y.J(ia))&&(this.n0g=!1,a.a.instance.Ya(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",
ia,sa,Y.J(ia)));Y.Z(ia,sa);return!0});return!0})}}Object(D.a)(C,"OutlineGroupParentFinder",null,[]);var P=d(1493),W=d(1539),X=d(1576);d.d(M,"ChildNodeListMerge",function(){return V});class V{constructor(Y,ca=null,fa=null,sa=null,ia=null){this.Lg=Y;this.X_m=ca||K.a.tcj;this.GUd=fa||this.Lyl();this.Tva=sa||new G;this.lpi=ia||this.Uwl()}get Yd(){return this.Lg}Lyl(){return[new H(393227,Object(u.a)(this,this.LZm,"pageContentNodeThreewayChildMerge")),new H(1073872968,Object(u.a)(this,this.sso,"wordSectionNodeThreewayChildMerge")),
new H(393241,Object(u.a)(this,this.kYd,"outlineElementContainerThreewayChildMerge")),new H(393252,Object(u.a)(this,this.l3n,"tableCellThreewayChildMergev2")),new H(1074135125,Object(u.a)(this,this.kYd,"outlineElementContainerThreewayChildMerge")),new H(1074135123,Object(u.a)(this,this.kYd,"outlineElementContainerThreewayChildMerge")),new H(1074135127,Object(u.a)(this,this.kYd,"outlineElementContainerThreewayChildMerge"))]}Uwl(){return[Object(u.a)(this,this.H5m,"prepareObjectGroupings"),Object(u.a)(this,
this.uRl,"handleInterOutlineGroupMerge"),Object(u.a)(this,this.g2m,"performThreewayChildMerge")]}mFm(Y){let ca=0;for(;ca<this.lpi.length;ca++)if(!(0,this.lpi[ca])(Y))return a.a.instance.Ya(4273296,1,4,"MergeChildNodeLists: Merged failed. [Function: {0}]",ca),Y.logger.hSd("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",ca),!1;return!0}H5m(Y){const ca=new l.a,fa=new l.a,sa=new r.a;Y.runtime.Vt.forEach((ia,ea)=>V.dCi(ea,ca));Y.runtime.kq.forEach((ia,ea)=>V.dCi(ea,fa));for(let ia=0;ia<this.GUd.length;ia++){const ea=
this.GUd[ia].classId;Y.runtime.qhb.Z(ea,new l.a);ca.xb(ea)&&ca.J(ea).forEach(da=>{var ja=Y.runtime.jk.J(da.id);ja&&(ja=new I(ja,da,Y.runtime.kq.Ey(da.id,ja)),Y.runtime.qhb.J(ea).add(da.id,ja),sa.add(da.id));return!0});fa.xb(ea)&&fa.J(ea).forEach(da=>{if(sa.contains(da.id))return!0;const ja=Y.runtime.jk.J(da.id);ja&&Y.runtime.qhb.J(ea).add(da.id,new I(ja,ja,da));return!0})}Y.runtime.RF("PrepareObjectGroupings");Y.logger.ifa("PrepareObjectGroupings");return!0}g2m(Y){let ca=!0;for(let fa=0;ca&&fa<this.GUd.length;fa++){const sa=
this.GUd[fa];Y.runtime.RF("Before function#"+fa);const ia=sa.classId;Y.runtime.qhb.J(ia).forEach((ea,da)=>{Y.runtime.pJa.contains(da.QD.id)||(ca=sa.abo(Y,da)&&ca);ca||(a.a.instance.Ya(4273297,1,4,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",ia,da.QD.id),Y.logger.Pg(Object.assign(new B,{kj:"PerformThreewayChildMerge",eventId:"aqtsr"})));return ca});Y.runtime.RF("PerformThreewayChildMerge"+fa)}Y.logger.ifa("PerformThreewayChildMerge");return ca}LZm(Y,ca){if(ca.D_d(m.a.rf)){var fa=
this.Yd.getPropertyObjectIds(ca.QD,m.a.rf);const sa=this.Yd.getPropertyObjectIds(ca.R5,m.a.rf);ca=this.Yd.getPropertyObjectIds(ca.foa,m.a.rf);fa=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",fa.length,sa.length,ca.length,Y.input.source);a.a.instance.Ya(4030551,1,4,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",fa);Y.logger.Pg(Object.assign(new B,{kj:"PageContentNodeThreewayChildMerge",eventId:"apybx",info:fa}));
return!1}return!0}sso(Y,ca){if(ca.D_d(m.a.rf)){const Ga=new r.a,ya=new r.a,ta=new r.a,ua=new r.a;var fa=this.Yd.getPropertyObjectIds(ca.QD,m.a.rf),sa=fa.UF(),ia,ea=({Rqh:ia}=this.Yij(ca.R5,sa,Ga,"Favored")).returnValue,da=({Rqh:ja}=this.Yij(ca.foa,sa,ya,"Unfavored")).returnValue;if(!ea||!da)return fa=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",sa.count,Ga.count,
ya.count,ia,ja),Y.logger.Pg(Object.assign(new B,{kj:"WordSectionNodeThreewayChildMerge",info:fa})),!1;fa.forEach(Sa=>{Ga.contains(Sa)||ta.add(Sa);ya.contains(Sa)||ua.add(Sa);return!0});ca=ca.QD.xG();sa=new w.a;for(ia=0;ia<fa.length;ia++){var ja=fa.mg(ia);if(ta.contains(ja)||ua.contains(ja)){if(Y.runtime.pJa.add(ja),sa.length&&(ea=sa.mg(sa.length-1),ea=Y.runtime.qhb.J(393241).J(ea),da=Y.runtime.qhb.J(393241).J(ja),ea&&da))ta.contains(ja)?ua.contains(ja)||(ea.QD=ea.QD.xG(),ea.foa=ea.foa.xG(),this.Mqd(ea.QD,
da.QD),this.Mqd(ea.foa,da.foa)):(ea.QD=ea.QD.xG(),ea.R5=ea.R5.xG(),this.Mqd(ea.QD,da.QD),this.Mqd(ea.R5,da.R5))}else sa.add(ja)}this.Yd.setPropertyObjectIds(ca,m.a.rf,sa);fa=new P.a(ca);fa.fB(m.a.rf);Y.runtime.Lm.Z(ca.id,fa)}return!0}Mqd(Y,ca){const fa=this.Yd.getPropertyObjectIds(Y,m.a.rf);ca=this.Yd.getPropertyObjectIds(ca,m.a.rf);const sa=fa.p3();ca.forEach(ia=>{sa.add(ia);return!0});this.Yd.setPropertyObjectIds(Y,m.a.rf,sa)}Yij(Y,ca,fa,sa){let ia=0,ea=!0;this.Yd.getPropertyObjectIds(Y,m.a.rf).forEach(da=>
{ca.contains(da)?fa.add(da):(ea=!1,a.a.instance.Ya(573912977,1,4,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",sa,da),ia++);return!0});return{returnValue:ea,Rqh:ia}}uRl(Y){let ca=!0;Y.runtime.qhb.J(393241).forEach((fa,sa)=>{if(this.edm(sa)){a.a.instance.Ya(4220302,1,4,"OutlineGroup {0} requires inter-OG merge.",sa.QD.id);let ia;const ea=new C(Y,this.Yd,this.Tva);if(({zAi:fa,Bkj:ia}=this.x$n(Y,ea.HBl(),sa)).returnValue)return a.a.instance.Ya(4220303,1,4,"Merging WordSection {0} as a unit.",
ia),ca=ea.success&&this.bGm(Y,ia,fa)&&ca,ca||(a.a.instance.Ya(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",sa.QD.id,ea.success),Y.logger.Pg(Object.assign(new B,{kj:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",ea.success)}))),ca}return!0});return ca}edm(Y){if(!Y.D_d(m.a.rf))return!1;const ca=this.Yd.getPropertyObjectIds(Y.QD,m.a.rf).J(0),fa=this.Yd.getPropertyObjectIds(Y.R5,
m.a.rf);Y=this.Yd.getPropertyObjectIds(Y.foa,m.a.rf);return!fa.contains(ca,(sa,ia)=>sa.equals(ia))||!Y.contains(ca,(sa,ia)=>sa.equals(ia))}x$n(Y,ca,fa){ca=ca.J(fa.QD.id);a.a.instance.Ya(4220304,1,4,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",fa.QD.id,ca);if(Y.runtime.pJa.contains(ca))return a.a.instance.Ya(4220305,1,5,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",
ca),{returnValue:!1,zAi:null,Bkj:ca};const sa=new R.a;fa=Y.runtime.jk.J(ca);this.Yd.getPropertyObjectIds(fa,m.a.rf).forEach(ia=>{sa.Lqd(ia);return!0});fa=this.Tva.Elb(ca,Y.runtime.Vt,Y.runtime.jk);this.Yd.getPropertyObjectIds(fa,m.a.rf).forEach(ia=>{sa.Oqd(ia);return!0});Y=this.Tva.Elb(ca,Y.runtime.kq,Y.runtime.jk);this.Yd.getPropertyObjectIds(Y,m.a.rf).forEach(ia=>{sa.Tqd(ia);return!0});return{returnValue:!0,zAi:sa,Bkj:ca}}jLf(Y,ca,fa,sa,ia){let ea=!0;Y.forEach(da=>{const ja=ca(da);this.Yd.getPropertyObjectIds(ja,
m.a.rf).forEach(Ga=>{fa.add(Ga);if(sa.xb(Ga))return(ea=sa.J(Ga).equals(da)&&ea)||a.a.instance.Ya(4273300,1,2,"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",ia,Ga,da,sa.J(Ga)),ea;sa.Z(Ga,da);return!0});return!0});return ea}Vzl(Y,ca){let fa,sa,ia,ea;fa=new w.a;sa=new w.a;ia=new w.a;ea=new l.a;const da=Y.runtime.jk;return this.jLf(ca.rvb,ja=>da.J(ja),fa,ea,"Base")&&this.jLf(ca.g7e,ja=>this.Tva.Elb(ja,Y.runtime.Vt,da),sa,ea,"Favored")&&
this.jLf(ca.Jlb,ja=>this.Tva.Elb(ja,Y.runtime.kq,da),ia,ea,"Unfavored")?{returnValue:!0,Jdh:fa,TEh:sa,pdj:ia,sti:ea}:{returnValue:!1,Jdh:fa,TEh:sa,pdj:ia,sti:ea}}K8k(Y,ca,fa,sa){let ia=!0;const ea=Y.runtime.jk,da=Y.runtime.Vt,ja=Y.runtime.kq,Ga=Y.runtime.Lm,ya=new w.a,ta=new l.a;fa.forEach(ua=>{const Sa=sa.J(ua);if(!Sa)return a.a.instance.Ya(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",ua),Y.logger.Pg(Object.assign(new B,{kj:"FinishInterOutlineGroupMerge",
eventId:"aqgws"})),ia=!1;Sa.equals(ya.last())||(ya.add(Sa),ta.add(Sa,new w.a));ta.J(Sa).add(ua);Y.runtime.pJa.add(ua);return!0});if(!ia)return!1;ta.forEach((ua,Sa)=>{const ka=this.Tva.Ubj(ua,da,ja,ea).xG();this.Yd.setPropertyObjectIds(ka,m.a.rf,Sa);Ga.Z(ua,new P.a(ka));Ga.J(ua).fB(m.a.rf);Y.runtime.pJa.add(ua);return ia});fa=this.Tva.Ubj(ca,da,ja,ea).xG();this.Yd.setPropertyObjectIds(fa,m.a.rf,ya);Ga.Z(ca,new P.a(fa));Ga.J(ca).fB(m.a.rf);Y.runtime.pJa.add(ca);return ia}bGm(Y,ca,fa){let sa,ia;if(!({Jdh:ea,
TEh:sa,pdj:ia,sti:fa}=this.Vzl(Y,fa)).returnValue)return!1;var ea=F.b(ea,sa,ia);ea=this.cIf(Y,ea);return!!ea&&this.K8k(Y,ca,ea,fa)}kYd(Y,ca){return this.uAi(Y,ca)}uAi(Y,ca){if(ca.D_d(m.a.rf)){var fa=this.Szl(ca);fa=this.cIf(Y,fa);if(!fa)return a.a.instance.Ya(4220308,1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",ca.QD.id),Y.logger.Pg(Object.assign(new B,{kj:"OutlineElementContainerThreewayChildMerge",
eventId:"aqgwu"})),N.a(ca.QD,"OutlineElementContainerThreewayChildMerge_Base",1),N.a(ca.R5,"OutlineElementContainerThreewayChildMerge_Favored",1),N.a(ca.foa,"OutlineElementContainerThreewayChildMerge_Unfavored",1),!1;var sa=this.Yd.getPropertyObjectIds(ca.QD,m.a.rf);const ia=fa.UF();sa.forEach(ea=>{ia.contains(ea)||(ea=this.Yd.getPropertyObjectIds(ca.QD,m.a.iL),0<ea.length&&Y.runtime.JIf.add(ea.J(0)));return!0});sa=ca.R5.xG();this.Yd.setPropertyObjectIds(sa,m.a.rf,fa);Y.runtime.Lm.Z(sa.id,new P.a(sa));
Y.runtime.Lm.J(sa.id).fB(m.a.rf)}return!0}pDb(Y){if(!Y)return a.a.instance.Ya(573957964,1,2,"Feature helper is null"),!1;Y.Uq(114);return Y.isFeatureEnabled(114)}l3n(Y,ca){if(!this.pDb(Y.runtime.Pb))return this.x2f(Y,ca);var fa=ca.QD.id,sa=X.e(Y,ca.QD,null);if(sa.equals(v.a.nil))return a.a.instance.Ya(573957965,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",fa),Y.logger.Pg(Object.assign(new W.a,{info:"Table node ID could not be found for table cell"})),!1;var ia=Y.runtime.uwb.J(sa);
if(ia&&(ia=ia.J(fa)))if(ia.qg)ca=ca.R5.xG(),ca.removeProperty(m.a.rf),this.Yd.setPropertyBool(ca,f.a.ghostCell,!0),null!=ia.colSpan?this.Yd.setPropertyUint32(ca,f.a.colSpan,ia.colSpan):ca.removeProperty(f.a.colSpan),Y.runtime.Lm.Z(ca.id,new P.a(ca)),Y.runtime.Lm.J(ca.id).fB(m.a.rf),Y.runtime.Lm.J(ca.id).fB(f.a.ghostCell),Y.runtime.Lm.J(ca.id).fB(f.a.colSpan);else{let ea,da;({Drd:sa,ZAd:ea,Tae:da}=this.Xvl(Y,ca,ia,sa));if(!ea.length&&!da.length)return a.a.instance.Ya(573957966,1,2,"A non-ghost cell does not have OE nodes on either side. Table cell ID: {0}",
fa),Y.logger.Pg(Object.assign(new W.a,{info:"A non-ghost cell does not have OE nodes on either side"})),!1;ea.length?da.length?(fa=F.b(sa,ea,da),fa=this.cIf(Y,fa)):fa=ea:fa=da;if(!fa)return a.a.instance.Ya(573957920,1,1,"TableCellThreewayChildMergev2: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",ca.QD.id),Y.logger.Pg(Object.assign(new B,{kj:"TableCellThreewayChildMergev2",eventId:"8n426"})),N.a(ca.QD,"TableCellThreewayChildMergev2_Base",
1),N.a(ca.R5,"TableCellThreewayChildMergev2_Favored",1),N.a(ca.foa,"TableCellThreewayChildMergev2_Unfavored",1),!1;ca=ca.R5.xG();this.Yd.setPropertyObjectIds(ca,m.a.rf,fa);ca.removeProperty(f.a.ghostCell);fa=ia.rowSpan;ia=ia.colSpan;null!=fa&&null!=ia&&(1<fa||1<ia)?(this.Yd.setPropertyUint32(ca,f.a.rowSpan,fa),this.Yd.setPropertyUint32(ca,f.a.colSpan,ia)):(ca.removeProperty(f.a.rowSpan),ca.removeProperty(f.a.colSpan));Y.runtime.Lm.Z(ca.id,new P.a(ca));Y.runtime.Lm.J(ca.id).fB(m.a.rf);Y.runtime.Lm.J(ca.id).fB(f.a.ghostCell);
Y.runtime.Lm.J(ca.id).fB(f.a.rowSpan);Y.runtime.Lm.J(ca.id).fB(f.a.colSpan)}else return this.x2f(Y,ca);Y.logger.ifa("TableCellThreewayChildMergev2");return!0}Xvl(Y,ca,fa,sa){let ia,ea;({Drd:ca,ZAd:ia,Tae:ea}=this.xOh(ca));ca||(ca=new w.a);ia||(ia=new w.a);ea||(ea=new w.a);var da=ca.UF(),ja=ia.UF(),Ga=ea.UF(),ya=fa.gVd;if(ya)for(var ta=0;ta<ya.length;ta++){var ua=ya.J(ta),Sa=Y.runtime.jk.J(ua);!da.contains(ua)&&Sa&&(da.add(ua),ca.add(ua));!ja.contains(ua)&&Y.runtime.Vt.Ey(ua,Sa)&&(ja.add(ua),ia.add(ua));
!Ga.contains(ua)&&Y.runtime.kq.Ey(ua,Sa)&&(Ga.add(ua),ea.add(ua))}Y.logger.ifa("OENodesAddedToChildrenList");if(ya=fa.Xhf)for(ta=0;ta<ya.length;ta++)if(ua=ya.J(ta),Sa=Y.runtime.jk.J(ua)){var ka=this.Yd.getPropertyObjectIds(Sa,m.a.rf);if(ka)for(var ha=0;ha<ka.length;ha++){var Ca=ka.J(ha);da.contains(Ca)||(da.add(Ca),ca.add(Ca))}ka=Y.runtime.Vt.Ey(ua,Sa);if(ka=this.Yd.getPropertyObjectIds(ka,m.a.rf))for(ha=0;ha<ka.length;ha++)Ca=ka.J(ha),ja.contains(Ca)||(ja.add(Ca),ia.add(Ca));ua=Y.runtime.kq.Ey(ua,
Sa);if(ua=this.Yd.getPropertyObjectIds(ua,m.a.rf))for(Sa=0;Sa<ua.length;Sa++)ka=ua.J(Sa),Ga.contains(ka)||(Ga.add(ka),ea.add(ka))}Y.logger.ifa("GhostCellOENodesAddedToChildrenList");if(fa=fa.DCf)for(da=0;da<fa.length;da++)if(ja=fa.J(da),ja=Y.runtime.uwb.J(sa).J(ja))if(ja=ja.gVd){ja=ja.UF();Ga=new w.a;for(ya=0;ya<ca.length;ya++)ja.contains(ca.J(ya))||Ga.add(ca.J(ya));ca=Ga;Ga=new w.a;for(ya=0;ya<ia.length;ya++)ja.contains(ia.J(ya))||Ga.add(ia.J(ya));ia=Ga;Ga=new w.a;for(ya=0;ya<ea.length;ya++)ja.contains(ea.J(ya))||
Ga.add(ea.J(ya));ea=Ga}Y.logger.ifa("NonGhostCellsOENodesRemovedFromChildrenList");return{Drd:ca,ZAd:ia,Tae:ea}}x2f(Y,ca){let fa=ca.R5.hasProperty(m.a.rf),sa=ca.foa.hasProperty(m.a.rf);fa&&(fa=!!this.Yd.getPropertyObjectIds(ca.R5,m.a.rf).length);sa&&(sa=!!this.Yd.getPropertyObjectIds(ca.foa,m.a.rf).length);if(fa!==sa)if(this.Djm(Y.runtime.Pb))Y.logger.vki(Object.assign(new W.a,{info:"TableCell OE missing children, ghost cell likely touched"}));else return Y.logger.Pg(Object.assign(new W.a,{info:"TableCell OE missing children, ghost cell likely touched"})),
!1;return this.uAi(Y,ca)}Szl(Y){let ca,fa;({Drd:Y,ZAd:ca,Tae:fa}=this.xOh(Y));return F.b(Y,ca,fa)}cIf(Y,ca){a.a.instance.Ya(4220309,1,5,"Considering {0} OutlineElement collections for merge.",ca.length);const fa=new w.a;let sa=!0;ca.forEach(ia=>{if(!ia)return a.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),Y.logger.Pg(Object.assign(new B,{kj:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),sa=!1;if(1===ia.PGm&&1===ia.Zxf){const ka=ia.rvb.J(0),ha=ia.g7e.J(0),Ca=ia.Jlb.J(0);
if(ka&&ka.equals(ha)&&ka.equals(Ca))return fa.add(ka),!0;if(1!==ca.length)return a.a.instance.shipAssertTag(4030554,1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",ka,ha,Ca,ca.length),Y.logger.Pg(Object.assign(new B,{kj:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),sa=!1}const ea=new l.a,da=new w.a,ja=new w.a,Ga=new w.a,ya=new w.a,ta=new w.a,
ua=new w.a,Sa=Y.runtime.jk;ia.rvb.forEach(ka=>sa=this.aMf(Y,ka,ha=>Sa.J(ha),da,ya,ea,"Base"));if(!sa)return a.a.instance.Ya(4285026,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),Y.logger.Pg(Object.assign(new B,{kj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),!1;ia.g7e.forEach(ka=>sa=this.aMf(Y,ka,ha=>this.Tva.Elb(ha,Y.runtime.Vt,Sa),ja,ta,ea,"Favored"));if(!sa)return a.a.instance.Ya(4285027,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),
Y.logger.Pg(Object.assign(new B,{kj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),!1;ia.Jlb.forEach(ka=>sa=this.aMf(Y,ka,ha=>this.Tva.Elb(ha,Y.runtime.kq,Sa),Ga,ua,ea,"Unfavored"));if(!sa)return a.a.instance.Ya(4285056,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),Y.logger.Pg(Object.assign(new B,{kj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;Y.runtime.Pb&&Y.runtime.Pb.OAb(1000005)&&(ta.length&&this.Z4k(ta,Y.runtime.Vt)?
(this.U7g(ta,Y,fa,ea),this.Ypd(Y,ea,ua)):this.U7g(ua,Y,fa,ea));if(da.length){ia=null;if(!({Lm:ia}=this.X_m(Y,da,ja,Ga,ia)).returnValue||!ia)return sa=!1;ia.forEach(ka=>{0<ka.iVb.count&&Y.runtime.Lm.Z(ka.im.id,ka);fa.add(ea.J(ka.im.id));return!0})}return!0});return sa?fa:null}Z4k(Y,ca){for(let fa=0;fa<Y.length;fa++)if(ca.get(Y.mg(fa).id))return!0;return!1}Ypd(Y,ca,fa){fa.length&&(fa.forEach(sa=>{Y.runtime.xec.add(sa.id);Y.runtime.xec.add(ca.J(sa.id));return!0}),K.a.Ypd(Y,this.Yd,fa.J(0)))}U7g(Y,ca,
fa,sa){Y.forEach(ia=>{const ea=new P.a(ia.xG());ca.runtime.Lm.Z(ia.id,ea);fa.add(sa.J(ia.id));return!0})}aMf(Y,ca,fa,sa,ia,ea,da){var ja=fa(ca);if(!ja)return a.a.instance.Ya(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",da,ca),Y.logger.Pg(Object.assign(new B,{kj:"ProcessOutlineElement",eventId:"aqwkb",info:String.format("[Revision: {0}] Failed to find OutlineElement",da)})),!1;const Ga=this.Yd.getPropertyObjectIds(ja,m.a.iL);if(!Ga||!Ga.length)return a.a.instance.Ya(4285058,
1,1,"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",da,ca),Y.logger.Pg(Object.assign(new B,{kj:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",da)})),N.a(ja,"ProcessOutlineElement_"+da,1),!1;ja=Ga.mg(0);fa=fa(ja);if(!fa)return a.a.instance.Ya(4285059,1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",da,ja,ca),Y.logger.Pg(Object.assign(new B,{kj:"ProcessOutlineElement",
eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",da)})),!1;if((da=this.Yd.getPropertyString(fa,f.a.tM))&&""!==da&&Y.runtime.Pb&&(Y.runtime.Pb.kif(1000005),Y.runtime.Pb.OAb(1000005)))return ia.add(fa),ea.add(ja,ca),Y.runtime.pJa.add(ja),!0;sa.add(fa);ea.add(ja,ca);Y.runtime.pJa.add(ja);return!0}xOh(Y){let ca,fa;ca=this.Yd.getPropertyObjectIds(Y.QD,m.a.rf);fa=this.Yd.getPropertyObjectIds(Y.R5,m.a.rf);Y=this.Yd.getPropertyObjectIds(Y.foa,m.a.rf);
return{Drd:ca,ZAd:fa,Tae:Y}}Djm(Y){if(!Y)return a.a.instance.Ya(51422868,1,2,"Feature Helper is null"),!1;Y.Uq(113);return Y.isFeatureEnabled(113)}static dCi(Y,ca){ca.xb(Y.Qc)||ca.Z(Y.Qc,new w.a);ca.J(Y.Qc).add(Y);return!0}}V.tYd=v.a.Of("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Object(D.a)(V,"ChildNodeListMerge",null,[1790])},1687:function(D,M,d){D=d(0);var m=d(1460),f=d(1533),a=d(1494),l=d(1478),r=d(1507);class w{constructor(Y,ca){this.DimensionValue=this.DimensionName=null;this.DimensionName=
Y;this.DimensionValue=ca}}Object(D.a)(w,"Dimension",null,[]);class v{constructor(Y,ca,fa,sa,ia){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=Y;this.Query=ca;this.From=fa;this.Size=sa;ia&&(this.Filter=ia)}}Object(D.a)(v,"EntityRequest",null,[]);class u{constructor(Y){this.QueryString=null;this.QueryString=Y}}Object(D.a)(u,"Query",null,[]);var z=d(1461);class B{constructor(Y,ca){this.Dimensions=this.Name=null;this.Name=Y;this.Dimensions=ca}}Object(D.a)(B,"Scenario",
null,[]);var G=d(1464),F=d(1463);class K{constructor(Y,ca,fa,sa){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=Y;this.TimeZone=ca;this.Cvid=fa;this.Scenario=sa}}Object(D.a)(K,"SubstrateBody",null,[]);var N=d(1506),H=d(1457),J=d(1456),L=d(2),I=d(1631),R=d(1630),C=d(1518),P=d(35),W=d(16),X=d(121);d.d(M,"a",function(){return V});class V{constructor(Y){this.dsc=this.X8a=this.Lfd=this.Qmc=this.Tsc=0;this.AQg=this.lUg=this.lG=null;this.yqb=0;this.GK=-1;this.Bvc="";this.hg=
L.AFrameworkApplication.Ze;this.jc=Y;this.u9a=this.RIc();this.fkd=new f.a;this.NOg=this.jc.gae?3:2;this.d1g=this.jc.gae&&this.jc.r3i?5:3;this.I4g=this.jc.R6d?2:3;this.J4g=1;this.Sed=this.jc.HTh;this.w_g=this.jc.Qim;this.Ttc=Y.HXh;L.AFrameworkApplication.K&&(this.lUg=L.AFrameworkApplication.K.lb("AppCatalogUrl")+L.AFrameworkApplication.K.lb("SearchPersonaPhotoBaseUrl"))}WJ(){return"Substrate"}wW(){return 0===this.jc.Hv?0:1===this.jc.Hv?1:3}uI(Y,ca,fa,sa=m.a.tellMe,ia=null){const ea=new F.a(Y);if(!ia||
Array.contains(ia,14)||Array.contains(ia,15)||Array.contains(ia,20))if(!this.yqb||window.performance.now()-this.yqb>=J.a.P$d)if(fa=this.fkd.kYh())this.yqb=window.performance.now(),fa.then(da=>{da&&""!==da?(this.Bvc=da,""!==this.lG&&this.jYh(Y,sa,this.Bvc,ca,ia)):(H.TellMeActor.instance.Qe.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),ca.resultsUpdated(ea))},da=>{H.TellMeActor.instance.Qe.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+
da);ca.resultsUpdated(ea)});else{if(H.TellMeActor.instance.Qe)H.TellMeActor.instance.Qe.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");ca.resultsUpdated(ea)}else this.Bvc&&""!==this.Bvc?this.jYh(Y,sa,this.Bvc,ca,ia):(ca.resultsUpdated(ea),H.TellMeActor.instance.Qe.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else ca.resultsUpdated(ea)}Sbc(){this.X8a=this.dsc=this.Lfd=this.Qmc=this.Tsc=0}jYh(Y,ca,fa,sa,ia){this.Sbc();const ea=new F.a(Y),da=this.lG=
X.a.create().toString();this.v9();this.GK=window.setTimeout(()=>{if(da===this.lG){this.lG="";this.GK=-1;sa.resultsUpdated(ea);const ya={};ya[a.a.provider]=this.WJ();ya[a.a.Oib]=Y.d1a;H.TellMeActor.instance.Qe.DA(l.a.timedOut,this.Ttc,ya)}},this.Ttc);const ja={"Content-Type":"application/json",Accept:"application/json"};ja.Authorization="Bearer "+fa;ja["X-Office-Version"]=L.AFrameworkApplication.buildVersion;ja["X-Office-Application"]=L.AFrameworkApplication.K.lb("Application");ja["X-Office-Platform"]=
"WAC";ja["X-TellMe-SessionId"]=H.TellMeActor.instance.YIc();ja["X-TellMe-Culture"]=L.AFrameworkApplication.uiCulture;ja["X-TellMe-ProcessSessionId"]=L.AFrameworkApplication.userSessionId;ja["Client-Request-Id"]=da;const Ga=window.performance.now();this.hg.Lj(this.xIl(),2,this.yIl(Y.ng,this.jc.application,H.TellMeActor.instance.YIc(),J.a.tT(Y)),ja,!1,0,ya=>{this.w0a(ya,Y,sa,da,Ga,ca,ia)},ya=>{this.m0a(ya,Y,sa,da,Ga)},null,null,!1,4E3,6E3)}v9(){-1!==this.GK&&(window.clearTimeout(this.GK),this.GK=-1)}w0a(Y,
ca,fa,sa,ia,ea,da){H.TellMeActor.instance.Qe.nX(ca.ng.length,this.u9a.join(","),Y.data.mf.toString(),Math.round(window.performance.now()-ia),N.a.substrate,!0,r.a.Rsa);const ja=J.a.tT(ca),Ga=new F.a(ca);if(sa===this.lG){this.v9();Y=P.b(Y.data.Ee);if(Y.Groups){Y=Y.Groups;for(const ya of Y)"People"===ya.Type&&this.jc.f1c&&(da?Array.contains(da,14):1)?(Y=this.SUh(ya.Suggestions,ja,ea),0<Y.results.length&&Ga.wv(Y)):"File"===ya.Type&&this.jc.d1c&&(da?Array.contains(da,15):1)?(Y=this.$Oh(ya.Suggestions,
ja,ea),0<Y.results.length&&Ga.wv(Y)):"Notes"===ya.Type&&this.jc.egb&&ea!==m.a.contextMenu&&(da?Array.contains(da,20):1)&&(Y=this.DTh(ya.Suggestions,ja,ca),0<Y.results.length&&Ga.wv(Y))}fa.resultsUpdated(Ga);H.TellMeActor.instance.Qe.nX(ca.ng.length,this.u9a.join(","),"",Math.round(window.performance.now()-ia),"",!0,r.a.provider)}else fa.resultsUpdated(Ga)}DTh(Y,ca,fa){const sa=new G.a(20);sa.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const ia of Y)this.ilm(ia)&&(Y=ia.NotesType,Y=W.a.mh(Y),
Y=this.Yyl(Y,ia.LastModifiedTime,ia.BodyPreview,ia.Subject,ca,fa,ia))&&(Y.groupType=20,sa.zy(Y));return sa}SUh(Y,ca,fa){const sa=new G.a(14);sa.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const ea of Y)if(this.jlm(ea)){var ia=ea.Id.split("@")[0];Y=ea.EmailAddresses[0];let da=ea.Type;if(void 0===da||null===da)da="User";if(ia=this.UBl(da,ea.DisplayName,ea.JobTitle,Y,ia,fa,ca))ia.description=Y,Y=ea.JobTitle,"Department"in ea&&"CompanyName"in ea&&(Y+="@"+ea.Department+"@"+ea.CompanyName),
ia.IH=Y,sa.zy(ia)}return sa}$Oh(Y,ca,fa){const sa=new G.a(15);sa.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const da of Y)if(this.Zkm(da)){var ia=da.FileName;Y=da.FileExtension;const ja=ia.length>Y.length?ia.substr(0,ia.length-Y.length-1):da.Title;var ea=void 0;Y=0;"DateCreated"in da?(Y=J.a.lhf(da.DateCreated),ea=J.a.yZh(da.DateCreated),ea=String.format(CommonUIStrings.l_CreatedTimeFormatString,da.Author,ea)):ea=da.Author;const Ga=da.AccessUrl+"?web=1",ya=W.a.BKc(Ga);ia=String.format('<a href="{0}">{1}</a>',
ya,W.a.vZ(ia));if(fa!==m.a.contextMenu||W.a.RW(Ga))if(ia=this.Lpl(ja,fa===m.a.contextMenu?ia:Ga,ea,da.FileExtension,da.Text,ca))ia.description=da.Author,ia.xqd=Y,sa.zy(ia)}return sa}m0a(Y,ca,fa,sa,ia){sa===this.lG&&(this.v9(),H.TellMeActor.instance.Qe.nX(ca.ng.length,this.u9a.join(","),Y.data.mf.toString(),Math.round(window.performance.now()-ia),N.a.substrate,!1,r.a.Rsa));Y=new F.a(ca);fa.resultsUpdated(Y)}UBl(Y,ca,fa,sa,ia,ea,da){da=da?this.J4g:this.NOg;if(!window.LPC&&!J.a.Gof()||this.Tsc===da)return null;
this.Tsc+=1;da="PeopleSuggestion"+this.Tsc.toString();var ja=this.lUg+"?size=1&accountName="+sa;Y=Object.assign(new I.a,{PersonaType:Y,Smtp:sa,ProfilePictureUrl:ja,AadObjectId:ia});const Ga=Object.assign(new R.a,{identifiers:Y,displayName:ca});Y=ea===m.a.contextMenu;this.jc.VAa?(H.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(da,Ga,ca,fa)),ea===m.a.contextMenu&&(fa=J.a.Jth(ca,sa,ia),H.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(da,fa))),
H.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(da,Y))):(ja=[],ja.push(appChrome.actions.setPersonaButtonCoauthor(da,Ga,ca,fa)),ea===m.a.contextMenu&&(fa=J.a.Jth(ca,sa,ia),ja.push(appChrome.actions.setButtonCommandValueId(da,fa))),ja.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(da,Y)),appChrome.api.dispatch(ja));return new z.a(da,11,ca,sa,0)}Yyl(Y,ca,fa,sa,ia,ea,da){if(ia&&!this.jc.zgi||this.Lfd===this.Sed||this.dsc===this.Sed||
this.X8a===this.Sed)return null;var ja=null;this.Lfd+=1;ia="";const Ga=[],ya={};da.type="Notes";this.AQg=Object.assign(new C.a,{landingTab:"Notes",data:da});ea=J.a.mWa(ea.ng,33,this.AQg);if("onenotepagepreviews"===Y){if(!("ClickthroughUrl"in da&&da.ClickthroughUrl)||""===da.ClickthroughUrl)return null;this.dsc+=1;ia="OnenoteNotesSuggestion"+this.dsc.toString();ya["default"]="SaveAsonetoc2_20";ja=da.ClickthroughUrl;Ga.push(appChrome.actions.setControlIconSet(ia,ya));Ga.push(appChrome.actions.setCompoundButtonCommandValueId(ia,
ja));ja=new z.a(ia,19,null,null,0)}else if("stickynote"===Y){if(!this.w_g)return null;this.X8a+=1;ia="NotesSuggestion"+this.X8a.toString();ya["default"]="ShowAllNotes_20";Ga.push(appChrome.actions.setControlIconSet(ia,ya));Ga.push(appChrome.actions.setCompoundButtonCommandValueId(ia,ea));ja=new z.a(ia,21,null,null,0)}else if("samsung"===Y){if(!this.w_g)return null;this.X8a+=1;ia="NotesSuggestion"+this.X8a.toString();ya["default"]="CategoryCollapsed_20";Ga.push(appChrome.actions.setControlIconSet(ia,
ya));Ga.push(appChrome.actions.setCompoundButtonCommandValueId(ia,ea));ja=new z.a(ia,20,null,null,0)}""!==ia&&(Y=J.a.yZh(ca),Y=String.format(CommonUIStrings.l_LastModifiedString,Y),ja.label=sa,ja.xqd=J.a.lhf(ca),Ga.push(appChrome.actions.setControlLabel(ia,sa)),Ga.push(appChrome.actions.updateCompoundButtonDescription(ia,Y)),Ga.push(appChrome.actions.setControlCustomTooltip(ia,fa)),appChrome.api.dispatch(Ga));return ja}Lpl(Y,ca,fa,sa,ia,ea){if(this.Qmc===(ea?this.I4g:this.d1g))return null;this.Qmc+=
1;ea="FileSuggestion"+this.Qmc.toString();const da=[],ja={};ja["default"]=J.a.Psl(sa);this.jc.VAa?(H.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ea,Y)),H.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(ea,ja)),H.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ea,fa)),H.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ea,ca)),H.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(ea,
ia))):(da.push(appChrome.actions.setControlLabel(ea,Y)),da.push(appChrome.actions.setControlIconSet(ea,ja)),da.push(appChrome.actions.updateCompoundButtonDescription(ea,fa)),da.push(appChrome.actions.setCompoundButtonCommandValueId(ea,ca)),da.push(appChrome.actions.setControlCustomTooltip(ea,ia)),appChrome.api.dispatch(da));return new z.a(ea,6,Y,fa,0)}RIc(){const Y=[];this.jc.f1c&&Array.add(Y,"People");this.jc.d1c&&Array.add(Y,"File");this.jc.egb&&Array.add(Y,"Notes");return Y}yIl(Y,ca,fa,sa){var ia=
new u(Y);Y=new v("File",ia,0,sa?this.I4g:this.d1g,null);sa=new v("People",ia,0,sa?this.J4g:this.NOg,J.a.R1m);ia=new v("Notes",ia,0,this.Sed,null);ca=new w("app",ca.toLowerCase());var ea=[];Array.add(ea,ca);ca=new B("tellmesearch",ea);ea=[];this.jc.d1c&&Array.add(ea,Y);this.jc.f1c&&Array.add(ea,sa);this.jc.egb&&Array.add(ea,ia);fa=new K(ea,"UTC",fa,ca);return P.c(fa)}xIl(){let Y=this.jc.D1n;this.jc.egb&&(Y+="?&setflight=NotesFrom3S");""!==this.jc.lYh&&(Y=Y+"&"+this.jc.lYh);return Y}jlm(Y){return"DisplayName"in
Y&&"Id"in Y&&"EmailAddresses"in Y&&!!Y.Id&&!!Y.EmailAddresses}Zkm(Y){return"FileExtension"in Y&&!!Y.FileExtension&&"FileName"in Y&&!!Y.FileName&&""!==Y.FileName&&"AccessUrl"in Y&&!!Y.AccessUrl&&""!==Y.AccessUrl}ilm(Y){return"Id"in Y&&!!Y.Id&&"NotesType"in Y&&!!Y.NotesType&&"Subject"in Y&&!!Y.Subject&&""!==Y.Subject}}Object(D.a)(V,"SubstrateResultsProvider",null,[1093])},1688:function(D,M,d){D=d(0);var m=d(47),f=d(5),a=d(17),l=d(150),r=d(84),w=d(149),v=d(216),u=d(609),z=d(59),B=d(385),G=d(2),F=d(1417),
K=d(743);class N{constructor(da,ja=0){this.wZe=null;this.qJf=0;this.QL=da;this.IFm=ja}}Object(D.a)(N,"GraphMergerResponse",null,[]);var H=d(43),J=d(1),L=d(166),I=d(699),R=d(1492),C=d(1536);class P extends C.a{constructor(){super();this.L5i=null;this.Ojj=!1}get Yda(){return"Crash"}Hzb(){this.detail.Z("Type",this.Yda);this.detail.Z("Trace",this.W9n(this.L5i));this.detail.Z("Continue",this.Ojj);return this.detail}W9n(da){da=da.split("\n");const ja=4<da.length?4:da.length,Ga=new Sys.StringBuilder;for(let ya=
0;ya<ja;ya++)ya===ja-1?Ga.append(String.format("{0}...",da[ya])):Ga.append(String.format("{0}\n",da[ya]));return Ga.toString()}}Object(D.a)(P,"CrashMergeFailureDetail",C.a,[]);var W=d(1829),X=d(1510),V=d(1584),Y=d(1493);class ca{constructor(){this.vhk=new B.a;this.Wyk=new B.a;this.hCk=new B.a}}Object(D.a)(ca,"RangeMarkers",null,[]);class fa{constructor(){this.colSpan=this.rowSpan=null;this.qg=!1;this.ype=new v.a;this.Eye=new v.a;this.Yye=new v.a}get Xhf(){return this.ype.p3()}set Xhf(da){da||(this.ype=
new v.a);this.ype=da.p3()}get DCf(){return this.Eye.p3()}set DCf(da){da||(this.Eye=new v.a);this.Eye=da.p3()}get gVd(){return this.Yye.p3()}set gVd(da){da||(this.Yye=new v.a);this.Yye=da.p3()}}Object(D.a)(fa,"TableCellStructureInfo",null,[]);var sa=d(1539),ia=d(1576);d.d(M,"a",function(){return ea});class ea{constructor(){this.fId=0;this.XEg=this.E6a=this.WRb=this.Lg=this.jXg=this.xTb=null;this.LOg=0;this.BLg=50;this.zCg=this.nwg=null}get gRi(){return this.xTb}get jxn(){return this.jXg}get Yd(){return this.Lg}get $gb(){return this.WRb}get E0h(){return this.E6a}get $Ol(){return this.XEg}get M8b(){return this.LOg}get Lkh(){return this.nwg}get fFc(){return this.zCg}S8b(da,
ja,Ga,ya,ta,ua,Sa){Ga=this.lJk(da,ja,ya,ta,ua,Sa,this.fFc);ya=0;const ka=Ga.runtime.V6d;let ha=null;try{this.$wm(ka,Ga,Sa,da,ja,ta,ua);for(da=1;ya<this.$gb.length;ya++)if(!(0,this.$gb[ya])(Ga)){da=2;Ga.logger.hSd("GraphMerger.GetMergeFunctions()",ya);break}return ha=new N(Ga.output.QL,da)}catch(Ca){const Pa=!Ga.output.timeout;Ga.output.crash=Pa;const Xa=this.tEd(Ca),qa=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",Pa?"Crashed":"Timed Out",Ga.input.SEb,!!Ga.output.QL,
Xa);Pa?(l.a.instance.Ya(4051608,1,1,"MergeChanges Crash. [Error: {0}]",qa),Ga.logger.Pg(Object.assign(new P,{L5i:Xa,Ojj:!!Ga.output.QL}))):l.a.instance.Ya(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",qa);if(Ga.output.QL)return ha=new N(Ga.output.QL,2);throw Ca;}finally{Ga.output.succeeded?this.Xwm(ka,Ga,ya):Ga.output.timeout?this.Zwm(Ga,ya):Ga.output.crash?Ga.output.QL?this.Ywm(Ga,ya):this.Wwm(Ga,ya):this.Vwm(Ga,ya);Ga.logger.Uwm();l.a.instance.Xga(42350232,1,Ga.output.succeeded?4:2,"MergeLogger",
Ga.logger.Xwl());Ga.logger.SQc.q2h()&&l.a.instance.Xga(559015903,1,2,"MarkerInfo",Ga.logger.SQc.toString());if(Ga.runtime.Pb&&Ga.runtime.Pb.isFeatureEnabled(78))try{this.Otm(Ga)}catch(Ca){l.a.instance.Ya(571619421,1,4,"Error logging references: {0}",Ca.toString())}this.Fym(Ga);ha.qJf|=(Ga.output.succeeded?2:1)<<2*(Sa-1);if(ha)try{ha.wZe=this.o5m(Ga)}catch(Ca){l.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",Ca)}}}Fym(da){if(!da.output.succeeded){da=da.output.timeout?"Timeout":
da.logger.oGi?da.logger.oGi.Yda:"Unknown";const ja=new L.a;r.Health.instance.recordQosError(da,["MergeFailure"],!0,!0,!1,!1,ja)}}Otm(da){const ja=ta=>{const ua=this.xAa()-da.input.uPa>this.M8b;if(0<this.M8b&&ua)throw l.a.instance.Ya(571619422,1,2,"Timed out while calculating added and deleted nodes: {0}",ta),w.a.invalidOperation(ta);};let Ga=da.runtime.Vt.keys,ya=ta=>da.runtime.Vt.J(ta);this.Qvf(da,ja,Ga,ya,"Favored");Ga=da.runtime.kq.keys;ya=ta=>da.runtime.kq.J(ta);this.Qvf(da,ja,Ga,ya,"Unfavored");
Ga=da.runtime.Lm.keys;ya=ta=>{const ua=da.runtime.Lm.J(ta);return ua?ua.im:da.runtime.Vt.J(ta)};this.Qvf(da,ja,Ga,ya,"Merged")}Qvf(da,ja,Ga,ya,ta){var ua=new v.a;const Sa=new v.a;for(let ka=0;ka<Ga.length;ka++){ja("LogAddedAndDeletedNodes");const ha=ya(Ga.J(ka));if(4325465===ha.Qc)continue;const Ca=da.runtime.jk.J(ha.id);Ca&&this.Ptm(ua,Sa,ha,Ca)}this.pli(Sa,ka=>da.runtime.jk.J(ka),ja);this.pli(ua,ya,ja);ja=new Sys.StringBuilder;for(Ga=0;Ga<ua.length;Ga++)ja.append(ua.J(Ga).toString()+",");ua=new Sys.StringBuilder;
for(Ga=0;Ga<Sa.length;Ga++)ua.append(Sa.J(Ga).toString()+",");l.a.instance.Xga(571619423,1,4,ta+" revision: Added references",ja.toString());l.a.instance.Xga(571619424,1,4,ta+" revision: Deleted references",ua.toString())}Ptm(da,ja,Ga,ya){const ta=Ga.Mj();for(let Sa=0;Sa<ta.length;Sa++){const ka=ta[Sa];if(this.C9h(ka)){var ua=this.Yd.getPropertyObjectIds(Ga,ka);this.Tvm(da,ja,ya,ka,ua)}else this.Adi(ka)&&(ua=this.Yd.getPropertyObjectId(Ga,ka),this.Svm(da,ja,ya,ka,ua))}}pli(da,ja,Ga){Ga("LogNestedReferences");
Ga=new v.a;const ya=new u.a;for(let ta=0;ta<da.length;ta++){const ua=da.J(ta);this.qwf(ua,Ga,ya,ja)}for(ja=0;ja<Ga.length;ja++)da.add(Ga.J(ja))}qwf(da,ja,Ga,ya){const ta=ya(da);if(ta){const Sa=ta.Mj();for(let ka=0;ka<Sa.length;ka++){var ua=Sa[ka];if(this.C9h(ua)){ua=this.Yd.getPropertyObjectIds(ta,ua);for(let ha=0;ha<ua.length;ha++)Ga.contains(ua.J(ha))||(ja.add(ua.J(ha)),Ga.add(ua.J(ha)),this.qwf(ua.J(ha),ja,Ga,ya))}else this.Adi(ua)&&(ua=this.Yd.getPropertyObjectId(ta,ua),Ga.contains(ua)||(ja.add(ua),
Ga.add(ua),this.qwf(da,ja,Ga,ya)))}}}Tvm(da,ja,Ga,ya,ta){if(this.Yd.hasProperty(Ga,ya)){Ga=this.Yd.getPropertyObjectIds(Ga,ya);const ua=Ga.UF();ya=ta.UF();for(let Sa=0;Sa<ta.length;Sa++)ua.contains(ta.J(Sa))||da.add(ta.J(Sa));for(da=0;da<Ga.length;da++)ya.contains(Ga.J(da))||ja.add(Ga.J(da))}else for(ja=0;ja<ta.length;ja++)da.add(ta.J(ja))}Svm(da,ja,Ga,ya,ta){ta&&(this.Yd.hasProperty(Ga,ya)?(Ga=this.Yd.getPropertyObjectId(Ga,ya),ta.equals(Ga)||(da.add(ta),ja.add(Ga))):da.add(ta))}Twm(da){l.a.instance.Ya(4535064,
1,4,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",da.input.SEb,da.output.crash,da.output.timeout)}$wm(da,ja,Ga,ya,ta,ua,Sa){if(da){da=ya.length?ya.mg(ya.length-1):null;var ka=ta.length?ta.mg(ta.length-1):null;Ga=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",ja.input.SEb,ya.length,da?
da.id:z.a.nil,da?da.r1?da.r1.id:z.a.nil:z.a.nil,ta.length,ka?ka.id:z.a.nil,ka?ka.r1?ka.r1.id:z.a.nil:z.a.nil,ua,Sa,this.M8b,Ga);switch(ja.input.source){case 5:l.a.instance.Ya(51663493,1,4,Ga);break;default:l.a.instance.Ya(4051606,1,4,Ga)}}}Xwm(da,ja,Ga){if(da)switch(da=this.kHc(ja,Ga,"Succeeded"),ja.input.source){case 5:l.a.instance.Ya(51663494,1,4,da);break;default:l.a.instance.Ya(4059162,1,4,da)}}Zwm(da,ja){ja=this.kHc(da,ja,"Timeout");switch(da.input.source){case 5:l.a.instance.Ya(51663495,1,4,
ja);break;default:l.a.instance.Ya(4059163,1,2,ja)}}Vwm(da,ja){ja=this.kHc(da,ja,"Rejection");switch(da.input.source){case 5:l.a.instance.Ya(51663496,1,4,ja);break;default:l.a.instance.Ya(4059164,1,2,ja)}}Ywm(da,ja){ja=this.kHc(da,ja,"Crash - Rejection");switch(da.input.source){case 5:l.a.instance.Ya(51663497,1,4,ja);break;default:l.a.instance.Ya(4059165,1,2,ja)}}Wwm(da,ja){ja=this.kHc(da,ja,"Crash - Failed");switch(da.input.source){case 5:l.a.instance.Ya(51663498,1,4,ja);break;default:l.a.instance.Ya(4059166,
1,2,ja)}}kHc(da,ja,Ga){const ya=da.output.QL,ta=ya&&ya.length?ya.mg(ya.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",da.input.SEb,Ga,this.xAa()-da.input.uPa,ja,ya?ya.length:0,ta?ta.id:z.a.nil,ta?ta.r1?ta.r1.id:z.a.nil:z.a.nil,da.input.source)}lJk(da,ja,Ga,ya,ta,ua,Sa){const ka=new W.a,ha=ka.input;ha.x3=da;ha.bwa=ja;ha.Zl=Ga;ha.G2=ya;ha.q4b=ta;ha.source=
ua;ha.fFc=Sa;ha.uPa=this.xAa();ka.logger.FMn(ha.uPa);da=ka.runtime;da.w_c=l.a.instance.u7(1,5);da.V6d=l.a.instance.u7(1,4);let Ca="";da.RF=Pa=>{if(this.M8b){var Xa=this.xAa()-ha.uPa,qa=Xa>this.M8b;Ca+=String.format(" ({0}: {1})",Pa,Xa);qa&&(ka.output.timeout=!0,Pa=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",ha.SEb,this.M8b,Pa,Xa,Ca),l.a.instance.Ya(528061012,1,2,Pa),this.d6n(Pa))}};return ka}VHc(){return[Object(H.a)(this,
this.CYm,"otherAuthorsHaveChangesToMerge"),Object(H.a)(this,this.Wcm,"isInputValid"),Object(H.a)(this,this.K1l,"initializeOutputMergeState"),Object(H.a)(this,this.nLd,"initializeRuntimeMergeState"),V.a.Y4m,Object(H.a)(this,this.X4m,"preProcessTableStructure"),Object(H.a)(this.Lkh,this.Lkh.mFm,"mergeChildNodeLists"),Object(H.a)(this,this.tao,"tryObjectMerge"),V.a.G4m,Object(H.a)(this,this.H6k,"finalizeObjectMerge"),Object(H.a)(this,this.kno,"validateMarkers"),Object(H.a)(this,this.P1j,"addMergeResultsToOutput")]}CYm(da){const ja=
da.input.x3;da=da.output;return ja?ja.length?!0:(l.a.instance.Ya(4051610,1,5,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),da.QL=ja,da.succeeded=!0,!1):(l.a.instance.Ya(4051609,1,5,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),da.QL=ja,da.succeeded=!0,!1)}Wcm(da){var ja=da.input;const Ga=ja.x3,ya=ja.bwa,ta=ja.Zl,ua=ja.G2;ja=ja.q4b;da=da.output;if(!ya||!ya.length)return l.a.instance.Ya(42350233,1,5,"IsInputValid: No local changes to merge."),
da.QL=Ga,da.succeeded=!0,!1;let Sa=!0;if(2!==ua&&1!==ua)return da.QL=Ga,!1;ta&&ta!==z.a.nil||(Sa=!1);Ga.length<(ja?2:1)&&(l.a.instance.Ya(4051614,1,5,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",ja),Sa=!1);Sa||(da.QL=2===ua?Ga:ya);return Sa}nLd(da){var ja=da.input,Ga=ja.x3,ya=ja.bwa,ta=ja.G2,ua;let Sa;({I5n:ua,bto:Sa,dza:ja}=this.Xul(da,Ga,ya,ja.q4b));if(!ja)return l.a.instance.Ya(4273301,1,
2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",ua.id,Sa.id),da.logger.Pg(Object.assign(new R.a,{kj:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.Oli(ua,Ga.length,"TheirChanges"),this.Oli(Sa,ya.length,"YourChanges"),da.output.QL=2===ta?Ga:ya,!1;da.runtime.dza=ja;({Tbo:Ga,$4k:ya}=this.tTk(ta,ua,Sa));({Ubo:ja,a5k:ta,Ofk:ua}=this.rxl(da,Ga,ya,ja));da.runtime.jk=ua;da.runtime.kq=ja;da.runtime.Vt=
ta;da.runtime.Lm=new B.a;da.runtime.$Ad=ya.id;da.runtime.Uae=Ga.id;da.runtime.qhb=new B.a;da.runtime.pJa=new u.a;da.runtime.w1e=new B.a;da.runtime.uwb=new B.a;da.runtime.A2f=new B.a;da.runtime.v1d=new ca;da.runtime.BTd=new v.a;da.runtime.JIf=new u.a;da.runtime.xec=new v.a;da.runtime.Pb=da.input.fFc(da);da.runtime.Pb.Wpd(1000001,"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature","WoWor220;WoWor220cf",m.a.j5n);da.runtime.Pb.Wpd(1000005,"Microsoft.Office.WordOnline.TOCMerge","Word-TOCMerge;Word-TOCMergecf",
m.a.d7n);da.runtime.Pb.Wpd(1000008,"Microsoft.Office.WordOnline.FailOnMPALAsserts","69bca399;0362i899",m.a.J4k);da.runtime.Pb.Wpd(1000009,"Microsoft.Office.WordOnline.RemoveEditedImageUrlFromIgnoredProperties","mergeeditedimageurl;mergeeditedimageurlcf",m.a.inn);da.runtime.H6h=!0;G.AFrameworkApplication.K&&(this.BLg=G.AFrameworkApplication.K.rc("WordEditorGraphMergeMaxIterationsPerCycle",50));return!0}Oli(da,ja,Ga){const ya=new v.a;for(;da;)ya.add(da),da=da.r1;const ta=new Sys.StringBuilder;ta.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",
Ga,ja,ya.length));let ua=ya.length,Sa=0;ya.forEach(ka=>({N4h:ua,omi:Sa}=this.D3j(ta,ka,ya,ua,Sa)).returnValue);l.a.instance.Ya(4273302,1,4,ta.toString())}D3j(da,ja,Ga,ya,ta){da.append(String.format(" [{0} {1} {2}]",ya,ja.Bta?"S":"B",ja.id));ya--;ta++;return 50<ta&&Ga.length!==ta?(da.append(" ...Truncated."),{returnValue:!1,N4h:ya,omi:ta}):{returnValue:!0,N4h:ya,omi:ta}}Xul(da,ja,Ga,ya){ja=ja.mg(ja.length-1-(ya?1:0));Ga=Ga.mg(Ga.length-1);ya=ja.Wcb(Ga);da.runtime.RF("GetCommonBase");da.logger.ifa("GetCommonBase");
return{I5n:ja,bto:Ga,dza:ya}}rxl(da,ja,Ga,ya){let ta,ua;({result:ta}=ja.T8b(ya));da.runtime.RF("GetUnfavoredChanges");da.logger.ifa("GetUnfavoredChanges");({result:ua}=Ga.T8b(ya));5===da.input.source&&(da.runtime.d5k=I.a.oWh(Ga),da.runtime.Wbo=I.a.oWh(ja));da.runtime.RF("GetFavoredChanges");da.logger.ifa("GetFavoredChanges");ja=new F.a(Object(H.a)(ya,ya.YXa,"getMergeableObject"));da.runtime.RF("GetModifiedObjects");da.logger.ifa("GetModifiedObjects");return{Ubo:ta,a5k:ua,Ofk:ja}}tTk(da,ja,Ga){2===
da?(da=ja,ja=Ga):da=Ga;return{Tbo:ja,$4k:da}}K1l(da){const ja=da.input,Ga=ja.x3,ya=ja.bwa;da.output.QL=(2===ja.G2?Ga:ya).p3();da.runtime.RF("InitializeOutputMergeState");da.logger.ifa("InitializeOutputMergeState");return!0}P1j(da){var ja=da.input.Zl;const Ga=da.runtime.Lm,ya=da.output.QL;ja=this.mJk(da,ya.mg(ya.length-1),ja,z.a.create());this.h6k(da,ja,Ga);ya.add(ja);return da.output.succeeded=!0}mJk(da,ja,Ga,ya){da.runtime.V6d&&l.a.instance.Ya(4051616,1,4,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",
Ga,ya);da=this.jxn(ya);da.lgk(ja,Ga);return da}h6k(da,ja,Ga){da.runtime.V6d&&l.a.instance.Ya(4059167,1,4,"FillRevision: Adding {0} objects to merged revision.",Ga.count);Ga.forEach((ya,ta)=>{ja.f3j(ta.im);return!0})}pDb(da){if(!da)return l.a.instance.Ya(573957952,1,2,"Feature helper is null"),!1;da.Uq(114);return da.isFeatureEnabled(114)}X4m(da){if(!this.pDb(da.runtime.Pb))return!0;const ja=da.runtime.Vt,Ga=da.runtime.kq,ya=da.runtime.jk;let ta=!0;ja.forEach((ua,Sa)=>{393252===Sa.Qc&&(ta=this.eEi(da,
ua,Sa,ya,ja));return ta});if(!ta)return!1;Ga.forEach((ua,Sa)=>{393252===Sa.Qc&&(ta=this.eEi(da,ua,Sa,ya,Ga));return ta});da.logger.ifa("PreProcessTableStructure");return ta}eEi(da,ja,Ga,ya,ta){const ua=null==this.Yd.getPropertyBool(Ga,f.a.ghostCell)?!1:this.Yd.getPropertyBool(Ga,f.a.ghostCell),Sa=null==this.Yd.getPropertyUint32(Ga,f.a.rowSpan)?1:this.Yd.getPropertyUint32(Ga,f.a.rowSpan),ka=null==this.Yd.getPropertyUint32(Ga,f.a.colSpan)?1:this.Yd.getPropertyUint32(Ga,f.a.colSpan);if(ua)return!0;var ha=
ya.J(ja);if(ha){ya=null==this.Yd.getPropertyBool(ha,f.a.ghostCell)?!1:this.Yd.getPropertyBool(ha,f.a.ghostCell);var Ca=null==this.Yd.getPropertyUint32(ha,f.a.rowSpan)?1:this.Yd.getPropertyUint32(ha,f.a.rowSpan);var Pa=null==this.Yd.getPropertyUint32(ha,f.a.colSpan)?1:this.Yd.getPropertyUint32(ha,f.a.colSpan);ya=ya!==ua;Ca=Ca!==Sa;Pa=Pa!==ka}else Pa=Ca=ya=!0;const Xa=ia.e(da,Ga,ta);if(Xa.equals(z.a.nil))return l.a.instance.Ya(573957953,1,2,"Table cell's containing table node id could not be found. Table Cell ID: {0}",
ja),da.logger.Pg(Object.assign(new sa.a,{info:"Table Cell's containing table node ID could not be found"})),!1;let qa=da.runtime.uwb.J(Xa);qa||(da.runtime.uwb.Z(Xa,new B.a),qa=da.runtime.uwb.J(Xa));let Ea=qa.J(ja),Ia=new v.a;const na=new v.a,Na=new v.a;ya&&(Ea||(Ia=this.Yd.getPropertyObjectIds(Ga,a.a.rf)));if(Ca||Pa)if(Ea){if(Ea.qg)return l.a.instance.Ya(573957961,1,4,"Table cell has conflicting ghostcell properties we are not handling"),da.logger.Pg(Object.assign(new sa.a,{info:"A table cell is ghost in one revision while non-ghost in another."})),
!1;if(null!=Ea.rowSpan&&Sa!==Ea.rowSpan||null!=Ea.colSpan&&ka!==Ea.colSpan)return l.a.instance.Ya(573957962,1,4,"Same table cell has different rowSpan/colSpan in conflicting revisions"),da.logger.Pg(Object.assign(new sa.a,{info:"A table cell has different rowSpan/colSpan in the conflicting revisions"})),!1}else{var Oa;({rowIndex:Ga,KYb:Oa}=ia.b(da,ta,Ga));if(-1===Ga||-1===Oa)return l.a.instance.Ya(573957954,1,2,"Table cell location could not be found. Table Cell ID: {0}",ja),da.logger.Pg(Object.assign(new sa.a,
{info:"Table cell location could not be found"})),!1;for(var Ra=Ga;Ra<Ga+Sa;Ra++)for(var ab=Oa;ab<Oa+ka;ab++){var zb=ia.c(da,Xa,Ra,ab);if(zb.equals(z.a.nil))return l.a.instance.Ya(573957955,1,4,"Other revision deleted the table cells this revision is trying to merge"),da.logger.Pg(Object.assign(new sa.a,{info:"Ghost cell not found in the table bounds"})),!1;var Qa=ta.Ey(zb,da.runtime.jk.J(zb));if(!Qa)return l.a.instance.Ya(573957956,1,4,"Other revision has inserted cells in between the cells this revision is trying to merge"),
da.logger.Pg(Object.assign(new sa.a,{info:"Newly inserted cell in another revision cannot be merged with the cell in current revision"})),!1;if(!zb.equals(ja)){if(null==this.Yd.getPropertyBool(Qa,f.a.ghostCell)||!this.Yd.getPropertyBool(Qa,f.a.ghostCell))return l.a.instance.Ya(573957957,1,4,"Other revision deleted some of the cells this revision is trying to merge"),da.logger.Pg(Object.assign(new sa.a,{info:"Cannot merge a non-ghost cell with the controlling cell"})),!1;var yb=qa.J(zb);if(yb)return l.a.instance.Ya(573957958,
1,4,"The ghost cell is already merged with some other cells in the other revision"),da.logger.Pg(Object.assign(new sa.a,{info:"Ghost cell is already merged with some other cell"})),!1;na.add(zb);yb=new fa;yb.qg=!0;Qa=this.Yd.getPropertyUint32(Qa,f.a.colSpan);null!=Qa&&(yb.colSpan=Qa);qa.Z(zb,yb)}}if(ha&&(null==this.Yd.getPropertyBool(ha,f.a.ghostCell)||!this.Yd.getPropertyBool(ha,f.a.ghostCell))&&(ta=null==this.Yd.getPropertyUint32(ha,f.a.rowSpan)?1:this.Yd.getPropertyUint32(ha,f.a.rowSpan),Ga=null==
this.Yd.getPropertyUint32(ha,f.a.colSpan)?1:this.Yd.getPropertyUint32(ha,f.a.colSpan),ta>Sa||Ga>ka)){Ra=Oa=-1;({rowIndex:Oa,KYb:Ra}=ia.a(da,null,ha,Oa,Ra));if(-1===Oa||-1===Ra)return l.a.instance.Ya(573957959,1,2,"Table cell location could not be found in base revision. Table Cell ID: {0}",ja),da.logger.Pg(Object.assign(new sa.a,{info:"Table cell location could not be found in base revision, although the object is present itself"})),!1;ha=na.UF();for(ab=Oa;ab<Oa+ta;ab++)for(zb=Ra;zb<Ra+Ga;zb++){yb=
ia.d(da,null,Xa,ab,zb);if(!yb)return l.a.instance.Ya(573957960,1,2,"Table cell could not be found within table bounds"),da.logger.Pg(Object.assign(new sa.a,{info:"Ghost cell not found in the table bounds"})),!1;yb.id.equals(ja)||ha.contains(yb.id)||Na.add(yb.id)}}}!Ea&&(ya||Ca||Pa)&&(l.a.instance.Ya(573957963,1,4,"Adding cell info structure to the ComplexTableStructure Dictionary for table cell id: {0}",ja),Ea=new fa,Ea.rowSpan=Sa,Ea.colSpan=ka,Ea.qg=ua,Ea.gVd=Ia,Ea.Xhf=na,Ea.DCf=Na,qa.add(ja,Ea));
return!0}tao(da){return this.pcj(da,!1)}H6k(da){return this.pcj(da,!0)}pcj(da,ja){const Ga=da.runtime,ya=Ga.jk,ta=Ga.Vt,ua=ja?Ga.w1e:Ga.kq,Sa=Ga.Lm;let ka=!0;const ha=da.runtime.w_c;let Ca=0,Pa=0,Xa=0;ua.forEach((qa,Ea)=>{ha&&l.a.instance.Ya(4051617,1,5,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",qa,Ea.Qc,ja);Pa++;this.BLg===Pa&&(Ca++,da.runtime.RF(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",Ca,Xa,ja)),Pa=0);if(da.runtime.Pb&&da.runtime.Pb.OAb(1000005)&&
da.runtime.xec.contains(Ea.id,(Na,Oa)=>Na.equals(Oa))||this.DXn(Ea.Qc))return!0;if(!ja&&this.ZPk(Ea.Qc,da.runtime.Pb))return Ga.w1e.Z(qa,Ea),!0;var Ia=ta.get(qa);if(!Ia)return Sa.xb(qa)?Sa.J(qa).tpi(Ea):Sa.Z(qa,new Y.a(Ea,!1)),!0;if(!ya.J(qa)&&!this.aGm(Ia.Qc)){var na=!!da.input.x3&&!!da.input.x3.last()&&da.input.x3.last().s2(qa);const Na=!!da.input.bwa&&!!da.input.bwa.last()&&da.input.bwa.last().s2(qa),Oa=new X.a(Ia,Ea);if(!Oa.PW)return Sa.Z(qa,new Y.a(Ia,!1)),!0;l.a.instance.Ya(4051618,1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",
qa,Ea.Qc,ja,na,Na,!Oa.PW,da.input.source);da.logger.Pg(Object.assign(new R.a,{kj:"GraphMerger.TryObjectMerge",eventId:"ap3k8"}));return ka=!1}na=Sa.Ey(qa,new Y.a(ya.J(qa)));({Nk:Ia,returnValue:ka}=this.$Ol.merge(da,this.E0h,this.Yd,na,Ia,Ea));Xa++;ka&&(da.runtime.RF(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",qa,Ea.Qc,Xa,Ca,ja)),Ia&&(Sa.xb(Ia.im.id)?Sa.J(Ia.im.id).tpi(Ia.im):Sa.Z(Ia.im.id,Ia)));return ka});da.logger.ifa("ObjectMerge");ha&&
l.a.instance.Ya(4059168,1,5,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",ua.count,Xa,ja);return ka}kno(da){try{for(let ja=0;ja<da.runtime.BTd.length;ja++){const Ga=da.runtime.BTd.J(ja);if(da.runtime.Lm.J(Ga)){if(!this.hem(da,Ga))return!1}else l.a.instance.Ya(527034192,1,2,"ValidateMerge: Couldn't find merged node to verify");da.runtime.RF("Validate markers taking too long")}}catch(ja){l.a.instance.Ya(559535579,1,2,"ValidateMerge threw an exception: {0}",ja)}return da.logger.SQc.q2h()?
!1:!0}USn(da){return 38===da||39===da||40===da||41===da||44===da||45===da||33===da||34===da?!1:!0}Jwl(da){switch(da){case 38:case 39:case 40:case 41:return f.a.oe;case 44:case 45:return f.a.Rrd;case 33:case 34:return f.a.Oj}return K.CommonProperties.nil}jno(da,ja){const Ga=this.Yd.getPropertyUint32(da,f.a.gq);if(!Ga||this.USn(Ga))return!0;da=this.Yd.getPropertyObjectId(da,this.Jwl(Ga));return ea.i2b(ja,da)?!0:(ja.logger.SQc.YLd=Ga,!1)}hem(da,ja){if(da.runtime.JIf.contains(ja))return!1;if(ja=ea.i2b(da,
ja)){ja=this.Yd.getPropertyObjectIds(ja,a.a.Un);for(let Ga=0;Ga<ja.length;Ga++){const ya=ea.i2b(da,ja.mg(Ga));if(ya&&!this.jno(ya,da))return!1}}return!0}DXn(da){switch(da){case 1074135137:case 1074135138:case 1074135139:case 1074135140:case 131162:case 4325465:return!0}return!1}ZPk(da,ja){let Ga=!1;if(1074135145===da)return!0;ja&&ja.Uq(134);ja&&ja.isFeatureEnabled(134)&&1074135153===da&&(Ga=!0);return Ga}aGm(da){switch(da){case 1074135162:return!0}return!1}sLk(da,ja){const Ga=new v.a,ya=new v.a,ta=
new v.a;var ua=da.runtime.dza;const Sa=ua?ua.id:z.a.nil;this.rvf(ua).forEach(ka=>{Ga.add(ja(ka));return!0});ua=da.input.x3.mg(da.input.x3.length-1);this.rvf(ua,Sa).forEach(ka=>{ya.add(ja(ka));return!0});da=da.input.bwa.mg(da.input.bwa.length-1);this.rvf(da,Sa).forEach(ka=>{ta.add(ja(ka));return!0});return{Mfk:Ga,J5n:ya,cto:ta}}rvf(da,ja=null){const Ga=new v.a;ja||(ja=z.a.nil);for(;da&&!ja.equals(da.id);)Ga.add(da),da=da.r1;Ga.reverse();return Ga}f2n(da){const ja=3===this.fId;let Ga=!1;!da.output.succeeded&&
(2===this.fId||da.output.crash&&1===this.fId)&&(Ga=!0);let ya=!1;da.input.x3&&0<da.input.x3.length&&(ja||Ga)&&da.runtime.Vt&&da.runtime.jk&&da.runtime.Pb&&(ya=da.runtime.Pb.isFeatureEnabled(53));return ya}C9h(da){return 9===J.a.vAb(J.a.M9e(da))}Adi(da){return 8===J.a.vAb(J.a.M9e(da))}static yrl(da){return da.output.crash?2:da.output.succeeded?3:1}static i2b(da,ja){if(!ja||ja===z.a.nil)return null;const Ga=da.runtime.Lm.J(ja);return Ga?Ga.im:da.runtime.jk.J(ja)}}ea.eId=z.a.Of("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");
Object(D.a)(ea,"GraphMergerBase",null,[1341])},1698:function(D,M,d){D=d(0);var m=d(216),f=d(1574),a=d(149),l=d(1505);class r extends f.a{constructor(v,u,z,B,G,F,K,N,H,J,L,I,R,C){super(v,3,u,z,B,G,F,N,H,J,L,I,R,C);this.tie=K}get character(){return this.tie}get text(){return this.character.toString()}b_c(){throw a.a.notImplemented();}toString(){return String.format("{0}",super.toString())}B1b(){return"CharRun"}clone(){return new r(this.Wxc,this.source,this.Bj,this.Cg,this.runId,this.cI,this.character,
this.phb,this.kMa,this.p$,this.$Aa,this.ZNa,this.lE,this.rt)}Lz(v,u,z,B=!1){return super.Lz(v,u,z,B)?v.character===this.character?!0:l.a.gch(v.character,this.character):!1}}Object(D.a)(r,"CharRunMergeBlock",f.a,[]);d.d(M,"a",function(){return w});class w extends f.a{constructor(v,u,z,B,G,F,K,N,H,J,L,I,R,C,P){super(v,1,u,z,B,G,F,N,J,L,I,R,C,P);this._text=K;this.FHe=H}get text(){return this._text}b_c(v){this._text=v}get T2a(){return this.FHe&&this._text&&this._text.length?!0:!1}toString(){return String.format("{0} [SupportsSplit: {1}]",
super.toString(),this.FHe)}B1b(){return"TextRun"}clone(){return new w(this.Wxc,this.source,this.Bj,this.Cg,this.runId,this.cI,this._text,this.phb,this.FHe,this.kMa,this.p$,this.$Aa,this.ZNa,this.lE,this.rt)}Lz(v,u,z,B=!1){return super.Lz(v,u,z,B)?l.a.fch(this._text,v._text):!1}j0c(){const v=new m.a;for(let z=0;z<this.text.length;z++){var u=l.a.charAt(this._text,z);if(l.a.ujm(l.a.O6n(u))){let B="";B+=u;u=l.a.charAt(this._text,++z);B+=u;u=new w(this.Wxc,this.source,this.Bj,this.Cg,this.runId,this.cI,
B,this.phb,!1,this.kMa,this.p$,this.$Aa,this.ZNa,this.lE,this.rt);v.add(u)}else u=new r(this.Wxc,this.source,this.Bj,this.Cg,this.runId,this.cI,u,this.phb,this.kMa,this.p$,this.$Aa,this.ZNa,this.lE,this.rt),v.add(u)}return v}}Object(D.a)(w,"TextRunMergeBlock",f.a,[])},1699:function(D,M,d){D=d(0);var m=d(972),f=d(17),a=d(385),l=d(216),r=d(59);d(780);var w=d(609),v=d(150),u=d(149),z=d(992),B;(function(H){H[H.none=0]="none";H[H.browser=1]="browser";H[H.serverPutChanges=2]="serverPutChanges";H[H.syncDiff=
3]="syncDiff";H[H.docxMerge=4]="docxMerge";H[H.undo=5]="undo"})(B||(B={}));Object(D.b)("GraphMergeSource",B);var G=d(1686),F=d(1519),K=d(1680);d.d(M,"a",function(){return N});class N{constructor(H){this.cA=new z.a;this.TO=new a.a;this.N1g=new a.a(0);this.I5c=new l.a;this.iGg=new l.a;this.ZPg=new l.a;this.jNg=new l.a;this.hPg="";this.MRa=null;this.Dr=this.Jve=0;this.$gd=new a.a(0);this.Sne=this.FTg=this.Ydd=0;const {MarkerValidation:J}=d(1792);this._state=H;this.xKj=new J}get SQc(){return this.xKj}get oGi(){return this.MRa}FMn(H){this.Jve=
H}hSd(H,J){this.hPg=String.format("{0}-{1}",H,J)}N5d(H){this.Fuk();this.Sne=H}dXf(){this.Sne=0}Fuk(){this.MRa&&this.I5c.add(this.MRa);this.MRa=null}Pg(H){this.MRa||(this.MRa=H);switch(this.Sne){case 1:this.iGg.add(H);break;case 2:this.ZPg.add(H);break;case 3:this.jNg.add(H);break;default:this.MRa&&this.I5c.add(H)}}vki(H){this.I5c.add(H)}Uwm(){this.Dr=this.xAa();this.ifa("MergeEnd")}ifa(H){const J=this.xAa();this.N1g.Z(H,J-this.Jve);this.Jve=J}JKn(){this.Ydd=this.xAa();this.FTg++}MT(H){const J=this.xAa();
let L;({value:L}=this.$gd.Dc(H)).returnValue?(L+=J-this.Ydd,this.$gd.Z(H,L)):this.$gd.Z(H,J-this.Ydd);this.Ydd=J}Xwl(){this.TO.Z("Id",this._state.input.SEb.toString());this.TO.Z("Source",B[this._state.input.source]);this.TO.Z("Base",N.awa(this.Ugl()));this.TO.Z("Favored",N.awa(this.CWh(!0)));this.TO.Z("Unfavored",N.awa(this.CWh(!1)));this.TO.Z("NodesRolledBackIfFailed",N.awa(this.Qyl()));if(!this._state.output.succeeded){let H,J,L,I,R;({Pfk:H,b5k:J,Vbo:L,Ufk:I,Xbo:R}=this.M6k(this._state.runtime));
this.TO.Z("CharactersLost",this.ejl(H,J,L));this.TO.Z("CharactersLostInComments",this.ckl());this.TO.Z("CharactersLostInTables",this.Mfl(R,I))}this.TO.Z("FuncStep",this.hPg);this.TO.Z("FailureDetail",N.awa(this.Hzb()));this.TO.Z("FailDetailHints",this.vEd(this.iGg));this.TO.Z("FailDetailNaiveMerge",this.vEd(this.ZPg));this.TO.Z("FailDetailLcs",this.vEd(this.jNg));this.TO.Z("ExtraDetails",this.vEd(this.I5c));this.TO.Z("Timeline",N.awa(this.N1g));this.TO.Z("ParagraphMergesCount",this.FTg);this.TO.Z("ParagraphMergeDurations",
N.awa(this.$gd));this.TO.Z("MarkerInfo",N.awa(this.SQc.aOh()));this.TO.Z("Result",N.awa(this.Zwl()));return JSON.stringify(N.awa(this.TO))}xAa(){return(new Date).getTime()}Ugl(){const H=new a.a,J=this._state.input.bwa,L=this._state.runtime.dza?this._state.runtime.dza.id:r.a.nil;let I=!1,R=0;for(;R<J.length;R++)if(J.J(R).id.equals(L)){I=!0;break}H.Z("LastId",L.toString());H.Z("Length",I?R+1:-1);return H}CWh(H){const J=new a.a;if(0===this._state.input.G2)return null;H=H?2===this._state.input.G2?this._state.input.x3:
this._state.input.bwa:2===this._state.input.G2?this._state.input.bwa:this._state.input.x3;J.Z("FirstId",H.J(0).id.toString());J.Z("LastId",H.length?H.J(H.length-1).id.toString():null);J.Z("Length",H.length);return J}Qyl(){if(!this._state.runtime.H6h)return null;const H=this._state.runtime.kq,J=new a.a(0);H.forEach((L,I)=>{({value:L}=J.Dc(I.Qc.toString()));J.Z(I.Qc.toString(),L+1);return!0});return J}ejl(H,J,L){let I=null,R=null,C=null;const P=this._state.runtime.kq;let W=0;try{C=new K.a(this.cA,this._state);
I=F.b(H,J,L);R=new w.a;for(H=0;H<I.length;H++)if(!I.J(H).rvb.Dp(I.J(H).Jlb,(X,V)=>X.equals(V))){const X=this.kyh(I.J(H),C);W+=X;R.add(I.J(H))}I&&P.forEach((X,V)=>{if(393230===V.Qc){V=null;for(let Y=0;Y<I.length;Y++)if(!R.contains(I.J(Y))&&I.J(Y).Jlb.contains(X,(ca,fa)=>ca===fa)){V=I.J(Y);break}V&&(X=this.kyh(V,C),R.add(V),W+=X)}return!0});return W}catch(X){return v.a.instance.Ya(579190992,1,2,"Exception in GetCharactersLost: "+X.toString()),-1}}M6k(H){let J,L,I,R,C;H.RF=W=>{if(750<this.xAa()-this._state.input.uPa)throw v.a.instance.Ya(579190991,
1,2,"Timed out while calculating characters lost: {0}",W),u.a.invalidOperation(W);};J=new l.a;L=new l.a;I=new l.a;R=new l.a;const P=new l.a;C=new l.a;try{if(H.jk){const W=H.jk.J(G.ChildNodeListMerge.tYd);let X,V;X=H.Vt.J(G.ChildNodeListMerge.tYd)||W;V=H.kq.J(G.ChildNodeListMerge.tYd)||W;this.F7e(W,Y=>H.jk.J(Y),J,R);this.F7e(X,Y=>H.Vt.J(Y)||H.jk.J(Y),L,P);this.F7e(V,Y=>H.kq.J(Y)||H.jk.J(Y),I,C)}}catch(W){v.a.instance.Ya(573089732,1,2,"Exception in FindAllParagraphAndTableIds: "+W.toString())}return{Pfk:J,
b5k:L,Vbo:I,Ufk:R,Xbo:C}}Mfl(H,J){try{let I=0;const R=this._state.runtime;var L=W=>R.kq.J(W)||R.jk.J(W);const C=new w.a,P=this.u8k(H,R,L,C);for(H=0;H<P.count;H++){let W=P.keys.J(H);const X=P.J(W);if(!C.contains(W)){let V=this.xYh(R,L,C,W,X);if(-1!==V)I+=V;else return v.a.instance.Ya(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(L=0;L<J.length;L++){let W=J.J(0);if(!C.contains(W)){let X=this.xHd(R.jk.J(W));if(-1===X)return v.a.instance.Ya(573089734,1,2,
"Error calculating characters lost in table deleted from base"),-1;I+=X}}return I}catch(I){return v.a.instance.Ya(573089735,1,2,"Exception in GetAllTablesCharactersLost: "+I.toString()),-1}}xYh(H,J,L,I,R){H.RF("GetTableCharactersLost");let C=0;R=this.cA.getPropertyObjectIds(R,f.a.rf);for(let Y=0;Y<R.length;Y++){var P=J(R.J(Y));P=this.cA.getPropertyObjectIds(P,f.a.rf);for(let ca=0;ca<P.length;ca++){var W=J(P.J(ca));if(H.jk.J(R.J(Y))&&H.jk.J(P.J(ca))){var X=H.jk.J(P.J(ca));if(!X)return v.a.instance.Ya(573089737,
1,2,"Base cell unexpectedly null"),-1;W=this.cA.getPropertyObjectIds(X,f.a.rf);var V=H.Vt.J(P.J(ca))||H.jk.J(P.J(ca));V=this.cA.getPropertyObjectIds(V,f.a.rf);X=this.cA.getPropertyObjectIds(X,f.a.rf);W=F.b(W,V,X);for(X=0;X<W.length;X++){V=W.J(X);const fa=this.tJl(H,J,L,V);if(-1===fa)return v.a.instance.Ya(573089738,1,2,"Error getting characters lost for parition {0}",V.toString()),-1;C+=fa}}else{X=this.dKl(J,W,L);if(-1===X)return v.a.instance.Ya(573089736,1,2,"Error getting text length of cell {0}",
W.id.toString()),-1;C+=X}}}L.add(I);return C}tJl(H,J,L,I){let R=0;var C=new l.a,P=new l.a;const W=new a.a;new a.a;for(var X=0;X<I.rvb.length;X++){var V=H.jk.J(I.rvb.J(X));V=this.cA.getPropertyObjectIds(V,f.a.iL);if(1!==V.length)return v.a.instance.Ya(573089739,1,2,"Unexpected number of ContentNodes: {0}",V.length),-1;var Y=H.jk.J(V.J(0));393230===Y.Qc?C.add(Y):393250===Y.Qc&&W.add(V.J(0),Y)}for(X=0;X<I.Jlb.length;X++){V=J(I.Jlb.J(X));V=this.cA.getPropertyObjectIds(V,f.a.iL);if(1!==V.length)return v.a.instance.Ya(573089740,
1,2,"Unexpected number of ContentNodes: {0}",V.length),-1;Y=J(V.J(0));if(393230===Y.Qc)P.add(Y);else if(393250===Y.Qc){Y=this.xYh(H,J,L,V.J(0),Y);if(-1===Y)return v.a.instance.Ya(573089741,1,2,"Error diffing table {0}",V.J(0).toString()),-1;R+=Y}}X=new K.a(this.cA,this._state);if(0<C.length&&0<P.length){C=X.VFh(C,ca=>H.jk.J(ca),P,ca=>J(ca));if(-1===C)return v.a.instance.Ya(573089742,1,2,"Problem diffing parition {0} with LCS",I.toString()),-1;R+=C}else if(0<C.length)for(I=0;I<C.length;I++)R+=this.cA.getPropertyString(C.J(I),
f.a.lo).length+1;else if(0<P.length)for(I=0;I<P.length;I++)R+=this.cA.getPropertyString(P.J(I),f.a.lo).length+1;for(I=0;I<W.count;I++)if(C=W.keys.J(I),!L.contains(C)){P=this.xHd(W.J(C));if(-1===P)return v.a.instance.Ya(573089743,1,2,"Error getting length of table {0}",C.toString()),-1;R+=P}return R}dKl(H,J,L){let I=0;J=this.cA.getPropertyObjectIds(J,f.a.rf);for(let P=0;P<J.length;P++){var R=H(J.J(P));R=this.cA.getPropertyObjectIds(R,f.a.iL);if(1!==R.length)return v.a.instance.Ya(573089744,1,2,"Unexpected number of ContentNodes: {0}",
R.length),-1;var C=H(R.J(0));if(393230===C.Qc)I+=this.cA.getPropertyString(C,f.a.lo).length+1;else if(393250===C.Qc){C=this.xHd(C);if(-1===C)return v.a.instance.Ya(573089745,1,2,"Problem finding text length of table {0}",R.J(0).toString()),-1;I+=C;L.add(R.J(0))}}return I}xHd(H){this._state.runtime.RF("GetTextLengthOfTable");let J=0;const L=W=>this._state.runtime.kq.J(W)||this._state.runtime.jk.J(W);H=this.cA.getPropertyObjectIds(H,f.a.rf);for(let W=0;W<H.length;W++){var I=L(H.J(W));I=this.cA.getPropertyObjectIds(I,
f.a.rf);for(let X=0;X<I.length;X++){var R=L(I.J(X));R=this.cA.getPropertyObjectIds(R,f.a.rf);for(let V=0;V<R.length;V++){var C=L(R.J(V));C=this.cA.getPropertyObjectIds(C,f.a.iL);if(1!==C.length)return v.a.instance.Ya(573089746,1,2,"Unexpected number of ContentNodes: {0}",C.length),-1;var P=L(C.J(0));if(393230===P.Qc)J+=this.cA.getPropertyString(P,f.a.lo).length+1;else if(393250===P.Qc){P=this.xHd(P);if(-1===P)return v.a.instance.Ya(573089747,1,2,"Error finding the text length of table {0}",C.J(0)),
-1;J+=P}}}}return J}u8k(H,J,L,I){const R=new a.a;for(let C=0;C<H.length;C++){let P=!1;J.kq.J(H.J(C))&&(P=!0);const W=L(H.J(C)),X=this.cA.getPropertyObjectIds(W,f.a.rf);if(!P)for(let V=0;V<X.length;V++)if(J.kq.J(X.J(V))){P=!0;break}P?R.add(H.J(C),W):I.add(H.J(C))}return R}kyh(H,J){return this.jyh(H.rvb,H.Jlb,J)}jyh(H,J,L){const I=new l.a;for(var R=0;R<H.length;R++)I.add(this._state.runtime.jk.J(H.J(R)));H=new l.a;for(R=0;R<J.length;R++)H.add(this._state.runtime.kq.J(J.J(R))||this._state.runtime.jk.J(J.J(R)));
return L.VFh(I,C=>this._state.runtime.jk.J(C),H,C=>this._state.runtime.kq.J(C)||this._state.runtime.jk.J(C))}F7e(H,J,L,I){if(393227===H.Qc){H=this.cA.getPropertyObjectIds(H,f.a.rf);for(let R=0;R<H.length;R++){const C=this.cA.getPropertyObjectIds(J(H.J(R)),f.a.rf);for(let P=0;P<C.length;P++){const W=this.cA.getPropertyObjectIds(J(C.J(P)),f.a.rf);for(let X=0;X<W.length;X++){const V=this.cA.getPropertyObjectIds(J(W.J(X)),f.a.iL);if(1!==V.length)return;const Y=J(V.J(0));393230===Y.Qc?L.add(V.J(0)):393250===
Y.Qc?I.add(V.J(0)):v.a.instance.Ya(573089748,1,2,"Unsupported class id in GetCharactersLost: "+m.a[Y.Qc])}}}}}G7e(H,J){H=this.cA.getPropertyObjectIds(H,f.a.rf);const L=new l.a;for(let I=0;I<H.length;I++){const R=this.cA.getPropertyObjectIds(J(H.J(I)),f.a.iL);if(1!==R.length)return null;L.add(R.J(0))}return L}ckl(){let H=0;const J=this._state.runtime,L=J.kq,I=C=>J.kq.J(C)||J.jk.J(C);let R=null;J.RF=C=>{if(750<this.xAa()-this._state.input.uPa)throw v.a.instance.Ya(573089749,1,2,"Timed out while calculating comment characters lost: {0}",
C),u.a.invalidOperation(C);};try{L.forEach((C,P)=>{if(1074135127===P.Qc){C=this.G7e(P,I);var W=J.jk.J(P.id);if(W)W=this.G7e(W,V=>J.jk.J(V)),R||(R=new K.a(this.cA,this._state)),H+=this.jyh(W,C,R);else for(W=0;W<C.length;W++)H+=this.cA.getPropertyString(J.kq.J(C.J(W)),f.a.lo).length+1}if(1074135126===P.Qc&&(C=this.cA.getPropertyObjectIds(P,f.a.rf).UF(),P=J.jk.J(P.id)))for(P=this.cA.getPropertyObjectIds(P,f.a.rf),W=0;W<P.length;W++)if(!C.contains(P.J(W))){var X=J.jk.J(P.J(W));X=this.G7e(X,V=>J.jk.J(V));
for(let V=0;V<X.length;V++)H+=this.cA.getPropertyString(J.jk.J(X.J(V)),f.a.lo).length+1}return!0})}catch(C){return v.a.instance.Ya(573089750,1,2,"Exception in GetCommentCharactersLost: "+C.toString()),-1}return H}Hzb(){return this.MRa?this.MRa.Hzb():null}vEd(H){const J=new l.a;H.forEach(L=>{J.add(N.awa(L.Hzb()));return!0});return J.toArray()}Zwl(){const H=new a.a;H.Z("Succeeded",this._state.output.succeeded);H.Z("Timeout",this._state.output.timeout);H.Z("Crash",this._state.output.crash);H.Z("MergedRevisions",
this._state.output.QL?this._state.output.QL.length:-1);H.Z("Duration",this.Dr-this._state.input.uPa);return H}static awa(H){if(!H)return null;const J={};H.forEach((L,I)=>{J[L.toString()]=I;return!0});return J}}Object(D.a)(N,"MergeLogger",null,[])},1700:function(D,M,d){D=d(0);var m=d(244),f=d(17),a=d(5),l=d(110),r=d(780),w=d(150),v=d(216),u=d(385),z=d(1452);class B{constructor(K,N,H){this.position=K;this.leader=N;this.val=H}equals(K){return this.position===K.position&&this.leader===K.leader&&this.val===
K.val}toString(){return this.position.toString()}}Object(D.a)(B,"TabStop",null,[]);var G=d(1793);d.d(M,"a",function(){return F});class F extends z.a{constructor(){super()}get wn(){return 20}get Az(){return 0}lk(){const K=super.lk();K.Z(r.a.yb(f.a.lo),1);K.Z(r.a.yb(f.a.Un),1);K.Z(r.a.yb(f.a.zm),1);K.Z(r.a.yb(a.a.Zs),1);K.Z(r.a.yb(a.a.Fq),1);K.Z(r.a.yb(a.a.Mc),1);K.Z(r.a.yb(f.a.Dkb),1);K.Z(r.a.yb(a.a.pLa),1);K.Z(r.a.yb(a.a.gDa),1);K.Z(r.a.yb(f.a.cua),1);K.Z(r.a.yb(a.a.yBa),1);K.Z(r.a.yb(a.a.Mda),1);
K.Z(r.a.yb(a.a.zBa),1);K.Z(r.a.yb(a.a.Oza),1);K.Z(r.a.yb(a.a.ABa),1);K.Z(r.a.yb(a.a.Pza),1);K.Z(r.a.yb(a.a.fDa),1);K.Z(r.a.yb(a.a.zEa),1);K.Z(r.a.yb(a.a.AEa),1);K.Z(r.a.yb(a.a.Hva),1);K.Z(r.a.yb(a.a.Su),1);K.Z(r.a.yb(a.a.Qy),1);K.Z(r.a.yb(a.a.Ry),1);K.Z(r.a.yb(a.a.Mv),1);K.Z(r.a.yb(l.a.gK),6);K.Z(r.a.yb(l.a.rQa),6);K.Z(r.a.yb(a.a.jwb),7);K.Z(r.a.yb(l.a.gK),6);K.Z(r.a.yb(a.a.C4i),2);K.Z(r.a.yb(l.a.RBk),2);K.Z(r.a.yb(l.a.J_m),2);K.Z(r.a.yb(a.a.cgc),2);K.Z(r.a.yb(a.a.T1c),2);K.Z(r.a.yb(a.a.aLb),2);K.Z(r.a.yb(a.a.ylb),
2);K.Z(r.a.yb(a.a.U1c),2);K.Z(r.a.yb(a.a.V1c),2);K.Z(r.a.yb(a.a.lockNotFullySupportedParagraphInBlockContentControl),2);return K}SA(K,N){if(N===r.a.yb(f.a.lo)||N===r.a.yb(f.a.Un)||N===r.a.yb(f.a.zm)||N===r.a.yb(a.a.Zs)||N===r.a.yb(a.a.Fq)||N===r.a.yb(a.a.Mc)||N===r.a.yb(f.a.Dkb)||N===r.a.yb(a.a.pLa)||N===r.a.yb(a.a.gDa)||N===r.a.yb(f.a.cua)||N===r.a.yb(a.a.yBa)||N===r.a.yb(a.a.Mda)||N===r.a.yb(a.a.zBa)||N===r.a.yb(a.a.Oza)||N===r.a.yb(a.a.ABa)||N===r.a.yb(a.a.Pza)||N===r.a.yb(a.a.fDa)||N===r.a.yb(a.a.zEa)||
N===r.a.yb(a.a.AEa)||N===r.a.yb(a.a.Hva)||N===r.a.yb(a.a.Su)||N===r.a.yb(a.a.tM)){var H=K.Um.value.hu,J=K.Um.value.Df;N=K.Ng.value.Df;if(K.Wo.runtime.pJa.contains(H.id))return w.a.instance.Ya(18989579,1,4,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",H.id),!0;if(K.Wo.runtime.Pb.OAb(1000005)&&this.LXn(K,N,J))return K.Nk=N.xG(),F.S6g(K),F.Ypd(K.Wo,K.Yd,J),!0;const L=new v.a;L.add(H);H=new v.a;H.add(J);J=new v.a;J.add(N);if(!({Lm:N}=
F.tcj(K.Wo,L,J,H)).returnValue)return K.n9f=!0,K.Nk=null,!1;F.S6g(K);K.Nk=N.mg(0).im;return!0}return N===r.a.yb(a.a.Qy)||N===r.a.yb(a.a.Ry)||N===r.a.yb(a.a.Mv)?(this.h$n(K),K.zg.add(r.a.yb(a.a.Qy)),K.zg.add(r.a.yb(a.a.Ry)),K.zg.add(r.a.yb(a.a.Mv)),!0):!1}LXn(K,N,H){N=K.Yd.getPropertyString(N,a.a.tM);K=K.Yd.getPropertyString(H,a.a.tM);return N||K?!0:!1}h$n(K){const N=K.Yd,H=K.Nk;var J=K.Um.value.Df,L=K.Ng.value.Df;K=this.Hbf(K.Um.value.hu,N);L=this.Hbf(L,N);J=this.Hbf(J,N);({dGm:J,eGm:K,fGm:L}=this.axl(K,
L,J));J.length?(N.setPropertyUint32s(H,a.a.Mv,J),N.setPropertyUint32s(H,a.a.Qy,K),N.setPropertyUint32s(H,a.a.Ry,L)):this.Wmn(H)}Hbf(K,N){const H=N.getPropertyUint32s(K,a.a.Mv),J=N.getPropertyUint32s(K,a.a.Qy);K=N.getPropertyUint32s(K,a.a.Ry);N=new v.a;if(!H)return N;for(let L=0;L<H.length;++L)N.add(new B(H.J(L),J.J(L),K.J(L)));return N}axl(K,N,H){({oAi:N,pAi:R,qAi:I}=this.KNh(K,N));let J,L;({oAi:H,pAi:J,qAi:L}=this.KNh(K,H));K=this.xQl(K,R,I,J,L);var I=this.wQl(K,N,H);K=new v.a;N=new v.a;var R=new v.a;
for(H=0;H<I.length;++H)K.add(I.J(H).position),N.add(I.J(H).leader),R.add(I.J(H).val);return{dGm:K,eGm:N,fGm:R}}KNh(K,N){let H,J,L;H=new v.a;J=new u.a;L=new u.a;let I,R;for(I=R=0;I<K.length&&R<N.length;)K.J(I).position===N.J(R).position?(K.J(I).equals(N.J(R))||L.Z(K.J(I).position,N.J(R)),++I,++R):K.J(I).position<N.J(R).position?(J.Z(K.J(I).position,K.J(I)),++I):(H.add(N.J(R)),++R);for(;I<K.length;)J.Z(K.J(I).position,K.J(I)),++I;for(;R<N.length;)H.add(N.J(R)),++R;return{oAi:H,pAi:J,qAi:L}}xQl(K,N,
H,J,L){const I=new v.a;for(let R=0;R<K.length;++R){const C=K.J(R).position;N.xb(C)||(H.xb(C)?I.add(H.J(C)):J.xb(C)||(L.xb(C)?I.add(L.J(C)):I.add(K.J(R))))}return I}wQl(K,N,H){N=this.rpi(N,H);return this.rpi(K,N)}rpi(K,N){const H=new v.a;let J,L;for(J=L=0;J<K.length&&L<N.length;)K.J(J).position<=N.J(L).position?(H.add(K.J(J)),K.J(J).position===N.J(L).position&&++L,++J):H.add(N.J(L++));for(;J<K.length;)H.add(K.J(J++));for(;L<N.length;)H.add(N.J(L++));return H}Wmn(K){K.removeProperty(a.a.Mv);K.removeProperty(a.a.Qy);
K.removeProperty(a.a.Ry)}static nh(){return new F}static get instance(){return F.Kg.value}static S6g(K){K.zg.add(r.a.yb(f.a.lo));K.zg.add(r.a.yb(f.a.Un));K.zg.add(r.a.yb(f.a.zm));K.zg.add(r.a.yb(a.a.Zs));K.zg.add(r.a.yb(a.a.Fq));K.zg.add(r.a.yb(a.a.Mc));K.zg.add(r.a.yb(f.a.Dkb));K.zg.add(r.a.yb(a.a.pLa));K.zg.add(r.a.yb(a.a.gDa));K.zg.add(r.a.yb(f.a.cua));K.zg.add(r.a.yb(a.a.yBa));K.zg.add(r.a.yb(a.a.Mda));K.zg.add(r.a.yb(a.a.zBa));K.zg.add(r.a.yb(a.a.Oza));K.zg.add(r.a.yb(a.a.ABa));K.zg.add(r.a.yb(a.a.Pza));
K.zg.add(r.a.yb(a.a.fDa));K.zg.add(r.a.yb(a.a.zEa));K.zg.add(r.a.yb(a.a.AEa));K.zg.add(r.a.yb(a.a.Hva));K.zg.add(r.a.yb(a.a.Su));K.zg.add(r.a.yb(a.a.tM))}static tcj(K,N,H,J){return(new G.a(K,N,H,J)).mgc()}static Ypd(K,N,H){H=N.getPropertyObjectIds(H,f.a.Un);for(let L=0;L<H.length;L++){var J=K.runtime.kq.J(H.mg(L));if(J&&(J=N.getPropertyObjectId(J,a.a.oe))){K.runtime.xec.add(J);break}}}}F.Kg=new m.a(F.nh);Object(D.a)(F,"ParagraphNodeComplexMerge",z.a,[])},1701:function(D,M,d){D=d(0);var m=d(79),f=
d(1460),a=d(1533),l=d(1494),r=d(1478),w=d(1507),v=d(1461),u=d(1464),z=d(1463),B=d(1457),G=d(1456);class F{constructor(V){this.jc=V;this.u9a=this.RIc()}WJ(){return"Add-ins"}wW(){return 0===this.jc.Hv?0:1===this.jc.Hv?1:3}uI(V,Y){V=new z.a(V);Y.resultsUpdated(V)}Wdb(V,Y,ca){const fa=new u.a(24);fa.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;ca&&this.A_f(V.ng,Y,fa)}A_f(V,Y,ca){const fa=[];let sa;sa=this.jc.h7l?this.jc.PQ&&this.jc.A$a?G.a.Ocb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,
V)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,V):this.jc.i7l?this.jc.PQ&&this.jc.A$a?G.a.Ocb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,V)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,V):this.jc.PQ&&this.jc.A$a?G.a.Ocb(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,V)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,V);this.jc.VAa?(B.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",
sa)),B.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",V))):(fa.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",sa)),fa.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",V)),appChrome.api.dispatch(fa));ca.zy(new v.a("LaunchAddinDialogFromTellMe",25));Y.wv(ca)}RIc(){const V=[];this.jc.hMc&&Array.add(V,"Addin");return V}}Object(D.a)(F,"AddinStoreResultsProvider",null,[1093]);var K=d(1659),N=d(1495),
H=d(1508),J=d(1660),L=d(1687),I=d(1661),R=d(1506),C=d(2),P=d(35),W=d(121);d.d(M,"a",function(){return X});class X{constructor(V,Y,ca){this.$uc=this.Ykd=this.Zkd=this.Xkd=!1;this.lG=null;this.GK=-1;this.$ia=this.Avc=null;this.Rvc="";this.yqb=0;this.jc=V;const fa=G.a.bCa();this.g6a=Y||[];this.hg=C.AFrameworkApplication.Ze;this.SZg=V.LHf;this.$kd=V.KHf;this.VFe=fa&&this.IJb();this.WFe=fa&&this.JJb();this.DTj=fa&&this.KJb();this.YFe=this.MJb();this.UZg=this.Vdc();V.L1f&&G.a.NYf(V)&&(this.Avc=new L.a(V),
this.Xkd=V.d1c,this.Zkd=V.f1c,this.Ykd=V.egb,this.$uc=this.Xkd&&this.ZC("File")||this.Zkd&&this.ZC("People")||this.Ykd&&this.ZC("Notes"));this.Wkd=this.tSn();this.dld=V.hTc;this.XFe=this.MSn();this.RZg=this.sSn();this.U7=this.WJl();this.Htg=new K.a(V);this.wFj=new J.a(V);this.YVj=new I.a(V);this.ztj=new F(V);this.Ttc=ca;this.fkd=new a.a;this.dld&&(this.Htg=new K.a(V))}ZC(V){return Array.contains(this.g6a,V)?!0:!1}WJ(){return"TellMeService"}wW(){return 0===this.jc.Hv?0:1===this.jc.Hv?1:this.ZC("Command")||
this.ZC("Recommended")?2:3}SJl(V){let Y="";if(!V&&this.ZC("Command")&&this.jc.Eqf){Y+="CommandSearch_DLIS,";var ca=this.jc.r9i;0<ca.length&&(Y+=ca+",")}V&&this.ZC("Recommended")&&this.$kd&&(ca=this.jc.s9i,0<ca.length&&(Y+=ca+","));!V&&this.ZC("Help")&&(V=this.jc.q9i,0<V.length&&(Y+=V+","));0<Y.length&&(Y=Y.substr(0,Y.length-1));return Y}uI(V,Y,ca,fa=f.a.tellMe,sa=null){const ia=new z.a(V);ca=G.a.tT(V);if(this.$uc&&(!this.yqb||window.performance.now()-this.yqb>=G.a.P$d)){var ea=this.fkd.XJl();if(ea)this.yqb=
window.performance.now(),ea.then(ya=>{this.Rvc=ya},ya=>{B.TellMeActor.instance.Qe.onError("TellMeServiceProvider:issueQuery","tellMeServiceToken promise rejected: "+ya)});else if(B.TellMeActor.instance.Qe)B.TellMeActor.instance.Qe.onError("TellMeServiceProvider:IssueQuery","undefined token promise")}var da=this.$uc&&!!this.Rvc;ea=da||ca&&this.ZC("Recommended")&&this.$kd;da=da||!ca&&(this.SZg&&this.ZC("Command")||this.VFe&&this.ZC("Answer")||this.WFe&&this.ZC("Definition")||this.UZg&&this.ZC("Image")||
this.dld&&this.ZC("Help")||this.YFe&&this.ZC("WolframAnswer")||this.XFe&&this.ZC("Template")||this.RZg&&this.ZC("Addin"));if(ea||da)if(this.$ia=fa,fa={"Content-Type":"application/json",Accept:"application/json"},fa["X-Office-Version"]=C.AFrameworkApplication.buildVersion,fa["X-Office-Application"]=C.AFrameworkApplication.K.lb("Application"),fa["X-Office-Platform"]="WAC",fa["X-TellMe-SqmUserId"]=C.AFrameworkApplication.K.lb("LoggableUserId")||"",fa["X-TellMe-SessionId"]=B.TellMeActor.instance.YIc(),
this.Rvc&&(fa.Authorization="Bearer "+this.Rvc),ea=this.SJl(ca),0<ea.length&&(fa["X-TellMe-Flights"]=ea),ea=[],!ca&&this.ZC("Answer")&&this.VFe&&(sa?Array.contains(sa,9):1)&&Array.add(ea,"Answer"),!ca&&this.ZC("Command")&&this.SZg&&!N.CommandResultsUtility.cof(V.ng)&&(sa?Array.contains(sa,17):1)&&Array.add(ea,"Command"),!ca&&this.ZC("Definition")&&this.WFe&&(sa?Array.contains(sa,10):1)&&Array.add(ea,"Definition"),!ca&&this.ZC("Help")&&this.dld&&(sa?Array.contains(sa,8):1)&&Array.add(ea,"Help"),!ca&&
this.ZC("WolframAnswer")&&this.YFe&&(sa?Array.contains(sa,12):1)&&Array.add(ea,"WolframAnswer"),ca&&this.ZC("Recommended")&&this.$kd&&!B.TellMeActor.instance.q3c&&(sa?Array.contains(sa,18):1)&&Array.add(ea,"Recommended"),!ca&&this.ZC("Image")&&this.UZg&&(sa?Array.contains(sa,19):1)&&Array.add(ea,"Image"),this.Rvc&&this.$uc&&(sa?Array.contains(sa,14)||Array.contains(sa,15)||Array.contains(sa,20):1)&&(this.Avc.Sbc(),this.Xkd&&this.ZC("File")&&Array.add(ea,"File"),this.Zkd&&this.ZC("People")&&Array.add(ea,
"People"),this.Ykd&&this.ZC("Notes")&&Array.add(ea,"Notes")),!ca&&this.ZC("Template")&&this.XFe&&(sa?Array.contains(sa,23):1)&&Array.add(ea,"Template"),!ca&&this.ZC("Addin")&&this.RZg&&(sa?Array.contains(sa,24):1)&&Array.add(ea,"Addin"),ea.length){fa["X-TellMe-SuggestionTypes"]=ea.join(",");fa["X-TellMe-Culture"]=C.AFrameworkApplication.uiCulture;fa["X-TellMe-ProcessSessionId"]=C.AFrameworkApplication.userSessionId;var ja=this.lG=W.a.create().toString();fa["Client-Request-Id"]=ja;var Ga=window.performance.now();
this.v9();this.GK=window.setTimeout(()=>{if(ja===this.lG){this.lG="";this.GK=-1;Y.resultsUpdated(ia);const ya={};ya[l.a.provider]=this.WJ();ya[l.a.Oib]=V.d1a;B.TellMeActor.instance.Qe.DA(r.a.timedOut,this.Ttc,ya)}},this.Ttc);this.hg.Lj(this.U7,2,this.VJl(V.ng),fa,!1,0,ya=>{this.w0a(ya,V,Y,ja,Ga,sa)},ya=>{this.m0a(ya,V,Y,ja,Ga)},null,null,!1,4E3,6E3)}else B.TellMeActor.instance.Qe.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),Y.resultsUpdated(ia);else Y.resultsUpdated(ia)}v9(){-1!==
this.GK&&(window.clearTimeout(this.GK),this.GK=-1)}w0a(V,Y,ca,fa,sa,ia){const ea=new z.a(Y);if(fa===this.lG){this.v9();B.TellMeActor.instance.Qe.nX(Y.ng.length,this.g6a.join(","),V.data.mf.toString(),Math.round(window.performance.now()-sa),R.a.tellMe,!0,w.a.Rsa);fa=V.data.Ee;V=null;try{V=P.b(fa)}catch(ua){B.TellMeActor.instance.Qe.onError("OnSuccessCallBack","Exception occured while deserializing response:"+ua);return}fa=G.a.tT(Y);if("Groups"in V&&V.Groups){var da=V.Groups;for(var ja of da)if("GroupType"in
ja&&"Suggestions"in ja&&ja.Suggestions)if("Commands"===ja.GroupType&&(ia?Array.contains(ia,17):1)||"Recommended"===ja.GroupType&&(ia?Array.contains(ia,18):1)){var Ga=(da="Recommended"===ja.GroupType)?"DLIS":"NaiveBayes";"Source"in ja&&ja.Source&&(Ga=ja.Source);var ya=ja.Suggestions;new m.a;var ta=[];for(const ua of ya)this.Tkm(ua)&&(ya=ua.Type,("Command"===ya||da&&"Recommended"===ya)&&ta.push(new H.a(ua.CommandId,ua.Score)));N.CommandResultsUtility.bSd(ta,!Y.ng.trim().length,ja.GroupType,Ga);Ga=B.TellMeActor.instance.M0;
ya=[];for(const ua of ta)da&&Ga&&Ga.CXe(ua.commandId)||ya.push(ua);ta=N.CommandResultsUtility.NGd(Y,ya,this.jc,null,null,null,da?18:17,0);0<ta.results.length&&(this.$ia!==f.a.contextMenu&&(ta.displayName=da?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),ea.wv(ta))}else if("Answer"===ja.GroupType){ya=ja.Suggestions;da=null;ta=2147483647;Ga="";for(const ua of ya)if(this.Skm(ua))if(Ga=ua.Type,ya=this.BGd(Ga),"Answer"===Ga&&this.VFe){da=this.wth(Ga,ua,Y.ng);break}else ya&&
ya<ta&&(ta=ya,da=this.wth(Ga,ua,Y.ng));ta=G.a.hwn(Y.ng,Ga);da&&(ia?Array.contains(ia,da.type):1)&&(Ga=[],this.Wkd?this.jc.VAa?(B.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(da.value,da.RB)),B.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(da.value,da.description)),B.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(da.value,ta))):(Ga.push(appChrome.actions.setControlLabel(da.value,da.RB)),Ga.push(appChrome.actions.updateCompoundButtonDescription(da.value,
da.description)),Ga.push(appChrome.actions.setCompoundButtonCommandValueId(da.value,ta)),appChrome.api.dispatch(Ga)):this.jc.VAa?(B.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(da.value,da.RB+" - "+da.description)),B.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(da.value,ta))):(Ga.push(appChrome.actions.setControlLabel(da.value,da.RB+" - "+da.description)),Ga.push(appChrome.actions.setButtonCommandValueId(da.value,ta)),appChrome.api.dispatch(Ga)),
ta=this.yLk(da.type),ta.zy(da),ea.wv(ta))}else"Help"===ja.GroupType&&ja.Suggestions.length&&(ia?Array.contains(ia,8):1)?this.dld&&(da=this.Htg.Wdb(Y,ja.Suggestions))&&0<da.results.length&&ea.wv(da):"Template"===ja.GroupType&&(ia?Array.contains(ia,23):1)?(da=ja.Suggestions)&&0<da.length&&this.YVj.Wdb(Y,ea,da):"Addin"===ja.GroupType&&(ia?Array.contains(ia,24):1)?(da=ja.Suggestions)&&0<da.length&&this.ztj.Wdb(Y,ea,da):"Substrate"===ja.GroupType&&this.$uc&&"Type"in ja&&("File"===ja.Type&&this.Xkd&&(ia?
Array.contains(ia,15):1)?(da=this.Avc.$Oh(ja.Suggestions,fa,this.$ia))&&0<da.results.length&&ea.wv(da):"People"===ja.Type&&this.Zkd&&(ia?Array.contains(ia,14):1)?(da=this.Avc.SUh(ja.Suggestions,fa,this.$ia))&&0<da.results.length&&ea.wv(da):"Notes"===ja.Type&&this.Ykd&&(ia?Array.contains(ia,14):1)&&(da=this.Avc.DTh(ja.Suggestions,fa,Y))&&0<da.results.length&&ea.wv(da));else B.TellMeActor.instance.Qe.onError("OnSuccessCallBack","GroupType"in ja?"Invalid group suggestions found for "+ja.GroupType:"Invalid group found")}if(V.Intents){ja=
V.Intents;for(const ua of ja)this.Ssf(ua)&&("Image"===ua.GroupType&&ua.ConfidenceScore>ua.ConfidenceThreshold&&(ia?Array.contains(ia,19):1)?this.wFj.Wdb(Y,ea,0,ua):"Commands"===ua.GroupType&&ua.ConfidenceScore<ua.ConfidenceThreshold&&(ia?Array.contains(ia,17):1)&&(ja=new u.a(17),ea.wv(ja)))}ca.resultsUpdated(ea);B.TellMeActor.instance.Qe.nX(Y.ng.length,this.g6a.join(","),"",Math.round(window.performance.now()-sa),"",!0,w.a.provider)}}m0a(V,Y,ca,fa,sa){const ia=new z.a(Y);fa===this.lG&&(this.v9(),
B.TellMeActor.instance.Qe.nX(Y.ng.length,this.g6a.join(","),V.data.mf.toString(),Math.round(window.performance.now()-sa),R.a.tellMe,!1,w.a.Rsa));ca.resultsUpdated(ia)}BGd(V){switch(V){case "Entity":return this.DTj?3:0;case "Definition":return this.WFe?5:0;case "WolframAnswer":return this.YFe?2:0;default:return 0}}wth(V,Y,ca){switch(V){case "Answer":return new v.a(this.Wkd?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===Y.Title?ca:Y.Title,Y.Description,0);case "Entity":return new v.a(this.Wkd?
"AnswerForSearch":"AnswerForSearchSingleLine",2,""===Y.Title?ca:Y.Title,Y.Description,0);case "Definition":return new v.a(this.Wkd?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===Y.Title?ca:Y.Title,Y.Description,0);case "WolframAnswer":return new v.a("WolframForSearch",3,""===Y.Title?ca:Y.Title,Y.Description,0);default:return null}}yLk(V){switch(V){case 0:return new u.a(9,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new u.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new u.a(10,
CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new u.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new u.a(19,this.jc.Qdc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}Skm(V){return"Type"in V&&!!V.Type&&""!==V.Type&&"Description"in V&&!!V.Description&&""!==V.Description}Tkm(V){return"Type"in V&&!!V.Type&&""!==V.Type&&"CommandId"in V&&!!V.CommandId&&""!==V.CommandId&&"Score"in V&&!!V.Score}Ssf(V){if("GroupType"in V&&V.GroupType&&"ConfidenceScore"in
V&&"ConfidenceThreshold"in V)return!0;B.TellMeActor.instance.Qe.onError("IsValidIntentGroup","Invalid intents found");return!1}VJl(V){const Y=G.a.Mfi(V),ca={};ca.Query=V;Y&&this.$kd&&(ca.CommandClickedEvents=B.TellMeActor.instance.lje,ca.CommandActionEvents=B.TellMeActor.instance.Wwg,ca.TellMeCommandClickMruEvents=B.TellMeActor.instance.RPg,ca.ContentType=B.TellMeActor.instance.ixd);this.XFe&&(V={},V.Application=this.jc.application,ca.TemplateInfo=V);return P.c(ca)}IJb(){return!!this.jc&&this.jc.IJb||
!!C.AFrameworkApplication.ua&&C.AFrameworkApplication.ua.Sb.IJb}JJb(){return!!this.jc&&this.jc.JJb||!!C.AFrameworkApplication.ua&&C.AFrameworkApplication.ua.Sb.JJb}KJb(){return!!this.jc&&this.jc.KJb||!!C.AFrameworkApplication.ua&&C.AFrameworkApplication.ua.Sb.KJb}MJb(){return!!this.jc&&this.jc.MJb||!!C.AFrameworkApplication.ua&&C.AFrameworkApplication.ua.Sb.MJb}Vdc(){return!!this.jc&&(this.jc.Vdc||this.jc.PQ)}tSn(){return!!this.jc&&!this.jc.d_a}MSn(){return!!this.jc&&this.jc.KOc}sSn(){return!!this.jc&&
this.jc.k9h&&this.jc.j9h}wgi(){return!!C.AFrameworkApplication.K&&C.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}xgi(){return!!C.AFrameworkApplication.K&&C.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}WJl(){if(!C.AFrameworkApplication.K)return"";if(this.xgi())return C.AFrameworkApplication.K.lb("TellMeServiceProdEndpointForSearch");if(this.wgi())return C.AFrameworkApplication.K.lb("TellMeServiceEdogEndpointForSearch");
if(G.a.Gof())return C.AFrameworkApplication.K.lb("TellMeServiceIntEndpointForSearch");let V=C.AFrameworkApplication.K.lb("TellMeServiceSearchEndpoint");V&&""!==V||(V=C.AFrameworkApplication.p9i);return V}static auh(V,Y){if(Y)return new X(V,["Command","Recommended"],V.xpl);Y=G.a.bCa()?"Answer Definition Help WolframAnswer Image File People Notes Template".split(" "):"Help WolframAnswer File People Notes Template".split(" ");return new X(V,Y,V.HXh)}}Object(D.a)(X,"TellMeServiceProvider",null,[1093])},
1792:function(D,M,d){d.r(M);d.d(M,"MarkerValidation",function(){return a});D=d(0);var m=d(385),f=d(1699);class a{constructor(){this.YLd=this.x8h=this.w8h=this.v8h=0}aOh(){const l=new m.a(0);l.Z("InvalidBookmarks",this.v8h);l.Z("InvalidComments",this.w8h);l.Z("InvalidContentControls",this.x8h);0!==this.YLd&&l.Z("InvalidMarkerType",this.YLd);return l}q2h(){return 0<this.v8h||0<this.w8h||0<this.x8h||0!==this.YLd?!0:!1}toString(){return JSON.stringify(f.a.awa(this.aOh()))}}Object(D.a)(a,"MarkerValidation",
null,[])},1793:function(D,M,d){d.d(M,"a",function(){return w});D=d(0);var m=d(150),f=d(992),a=d(250),l=d(1584),r=d(1523);class w{constructor(v,u,z,B,G=null,F=null,K=null,N=null){this.ee=v;this.sE=u;this.Uwa=z;this.eya=B;this.YKj=G;this.pBj=F;this.lXj=K;this.fpa=N||this.gZe()}gZe(){return v=>!!this.ee.runtime.Pb&&this.ee.runtime.Pb.isFeatureEnabled(v)}AHk(){return()=>this.ee.runtime.Pb}O3e(){return!!this.ee.runtime.jk.J(a.a.wK)}V4i(){let v;if(1===this.ee.input.source||2===this.ee.input.source)v=85;
else if(4===this.ee.input.source||3===this.ee.input.source)v=41;else if(5===this.ee.input.source)v=128;else return!1;return this.O3e()&&this.fpa(v)}Y6i(v,...u){return String.format.apply(null,[v].concat(u))}fGd(v){const {ParagraphMerge:u}=d(1830);let z=this.ee,B=this.Uwa,G=this.eya;v||(z=this.YKj||this.ee,B=this.pBj||B,G=this.lXj||G);var F=r.a.bef(this.sE);const K=r.a.bef(B),N=r.a.bef(G);F=this.Y6i("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",
z.input.source,z.runtime.dza.id,z.runtime.$Ad,z.runtime.Uae,F.Cq(),K.Cq(),N.Cq());return v?{returnValue:new l.a(z,this.sE,B,G,this.gZe(),new f.a),Cq:F}:{returnValue:new u(z,this.sE,B,G,this.gZe(),this.AHk(),new f.a),Cq:F}}mgc(){this.ee.logger.JKn();var v=this.V4i();var u=({Cq:B}=this.fGd(v)).returnValue;m.a.instance.Ya(18994389,1,4,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",v,B);this.ee.logger.MT("ParagraphMergeSelector initialization");v?this.ee.logger.N5d(1):this.ee.logger.N5d(2);
let z=({Lm:u}=u.mgc()).returnValue;this.ee.logger.dXf();var B=!z;v=!!this.ee.runtime.jk.J(a.a.wK)&&(v&&!z||!v);B&&({Cq:B,returnValue:u}=this.fGd(!1),{Lm:u,returnValue:z}=u.mgc(),m.a.instance.Ya(18994390,1,z?4:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",z,B));v&&(B=new f.a,r.a.Yun(this.ee,B));this.ee.logger.MT("ParagraphMergeSelector finalization");return{returnValue:z,Lm:u}}C2c(v,u){let z,B,G;const F=this.V4i()&&this.fpa(129);let K=({Cq:G}=this.fGd(F)).returnValue,N=({G1a:z,
ona:B}=K.C2c(v,u)).returnValue;m.a.instance.Ya(18994391,1,4,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",F,G);F&&!N&&K.tTf&&({Cq:G,returnValue:K}=this.fGd(!1),{G1a:z,ona:B,returnValue:N}=K.C2c(v,u),m.a.instance.Ya(18994392,1,N?4:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",N,G));return{returnValue:N,G1a:z,ona:B}}}Object(D.a)(w,"ParagraphMergeSelector",null,[1791])},1794:function(D,M,d){d.r(M);d.d(M,"SurfaceStringTokenStringGenerator",
function(){return f});D=d(0);var m=d(1542);class f extends m.a{constructor(a){super(a);this.Ab=a}apply(a,l,r,w,v,u,z){null==u&&(u=a.GZh(v,l));z=m.a.V7g(a,u,this.Ab.score,r,w,z);return{E1c:u,lzc:z}}}f.mzc=0;Object(D.a)(f,"SurfaceStringTokenStringGenerator",m.a,[])},1795:function(D,M,d){d.r(M);d.d(M,"QueryTokenStringGenerator",function(){return a});D=d(0);var m=d(1542),f=d(1453);class a extends m.a{constructor(l){super(l);this.Ab=l}apply(l,r,w,v,u,z,B){r=this.Ab.query.load(r,null);u=0;let G=null;this.Ab.query.h3===
f.Annotations.Jva?r&&(G=this.Ab.name):((G=this.Ab.name)&&(G+="_"),G+=this.Ab.annotations.yba(this.Ab.query.h3,r));null!=G&&(u=m.a.V7g(l,G,this.Ab.score,w,v,u));return{E1c:z,lzc:B+u}}}a.mzc=1;Object(D.a)(a,"QueryTokenStringGenerator",m.a,[])},1796:function(D,M,d){d.r(M);d.d(M,"FuzzyMatchTokenStringGenerator",function(){return f});D=d(0);var m=d(1542);class f extends m.a{constructor(a){super(a);this.Ab=a}apply(a,l,r,w,v,u,z){null==u&&(u=a.GZh(v,l));a=this.Ab.qDh.SAm(u);if(this.Ab.Hzi)for(var B of a)if(!B.EN&&
B.UBd)return{E1c:u,lzc:z};B=0;for(const G of a)if(G.EN&&!({tTe:B}=this.Wbh(G,!0,r,w,B)).returnValue)return{E1c:u,lzc:z};if(this.Ab.z5h)for(const G of a)if(!({tTe:B}=this.Wbh(G,!1,r,w,B)).returnValue)break;return{E1c:u,lzc:z}}Wbh(a,l,r,w,v){let u;l?(l=0,u=a.UBd?1:0):(l=a.UBd?1:0,u=a.count-l);for(let z=0;z<u;++z)if(m.a.W7g(a.ncb+l+z,this.Ab.score,r,w),++v,0<this.Ab.ayf&&v>=this.Ab.ayf)return{returnValue:!1,tTe:v};return{returnValue:!0,tTe:v}}}f.mzc=2;Object(D.a)(f,"FuzzyMatchTokenStringGenerator",m.a,
[])},1821:function(D,M,d){D=d(0);var m=d(5),f=d(44),a=d(244),l=d(1452);class r extends l.a{constructor(){super()}get wn(){return 2}get Az(){return 7}static nh(){return new r}static get instance(){return r.Kg.value}}r.Kg=new a.a(r.nh);Object(D.a)(r,"AppBindingNodeComplexMerge",l.a,[]);var w=d(17),v=d(780),u=d(150),z=d(1493);class B extends l.a{constructor(){super()}get wn(){return 3}get Az(){return 7}lk(){const tb=super.lk();tb.Z(v.a.yb(w.a.HT),1);return tb}SA(tb,dc){if(dc===v.a.yb(w.a.HT)){const pb=
tb.Nk;var Yb=tb.Yd;u.a.instance.Ya(6633221,1,4,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",pb.id,pb.Qc,dc);dc=Yb.getPropertyMilliseconds(tb.Ng.value.Df,w.a.HT);Yb=Yb.getPropertyMilliseconds(tb.Um.value.Df,w.a.HT);dc<Yb&&this.Dkl(tb);tb.zg.add(v.a.yb(w.a.HT));return!0}u.a.instance.Ya(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.Ng.value.Df.id,dc);return!1}Dkl(tb){this.Trn(tb.Um.value.Df,
tb.Nk);this.Xaf(tb,m.a.tPe);this.Xaf(tb,m.a.bah);this.Xaf(tb,m.a.R$g)}Xaf(tb,dc){var Yb=tb.Yd,pb=tb.Nk;if(Yb.hasProperty(pb,dc)&&(dc=Yb.getPropertyObjectIds(pb,dc))&&dc.length)for(Yb=tb.Wo.runtime.kq,tb=tb.Wo.runtime.Lm,pb=0;pb<dc.length;pb++){const Gb=dc.J(pb);if(!Yb.xb(Gb))continue;const hb=Yb.J(Gb).xG();tb.add(Gb,new z.a(hb,!1))}}static nh(){return new B}static get instance(){return B.Kg.value}}B.Kg=new a.a(B.nh);Object(D.a)(B,"AppNodeComplexMerge",l.a,[]);class G extends l.a{constructor(){super()}get wn(){return 4}get Az(){return 7}static nh(){return new G}static get instance(){return G.Kg.value}}
G.Kg=new a.a(G.nh);Object(D.a)(G,"AppPropNodeComplexMerge",l.a,[]);class F extends l.a{constructor(){super()}get wn(){return 5}get Az(){return 7}static nh(){return new F}static get instance(){return F.Kg.value}}F.Kg=new a.a(F.nh);Object(D.a)(F,"AppRefNodeComplexMerge",l.a,[]);var K=d(385),N=d(609),H=d(216),J=d(16);class L{constructor(tb,dc){this.id=tb;this.b_n=dc}}Object(D.a)(L,"IdAndTime",null,[]);class I extends l.a{constructor(){super()}get wn(){return 6}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.$Ua),
1);return tb}SA(tb,dc){if(dc===v.a.yb(m.a.$Ua)){const Yb=tb.Nk,pb=tb.Yd;u.a.instance.Ya(6633224,1,4,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Yb.id,Yb.Qc,dc);dc=pb.getPropertyObjectIds(tb.Ng.value.hu,m.a.$Ua);const Gb=pb.getPropertyObjectIds(tb.Ng.value.Df,m.a.$Ua),hb=pb.getPropertyObjectIds(tb.Um.value.Df,m.a.$Ua);dc=this.bFm(tb,dc,Gb,hb);0<dc.length?pb.setPropertyObjectIds(Yb,m.a.$Ua,dc):Yb.removeProperty(m.a.$Ua);tb.zg.add(v.a.yb(m.a.$Ua));
return!0}u.a.instance.Ya(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.Ng.value.Df.id,dc);return!1}bFm(tb,dc,Yb,pb){const Gb=this.vCa(dc,Yb,pb),hb=dc.UF(),Ib=Yb.UF(),Ob=pb.UF();dc=l.a.filter(Gb,Nc=>!hb.contains(Nc)&&Ib.contains(Nc));Yb=l.a.filter(Gb,Nc=>!hb.contains(Nc)&&Ob.contains(Nc));if(!dc.length||!Yb.length)return Gb;const kc=new K.a;dc.forEach(Nc=>{const kd=new L(Nc,this.LKh(tb,Nc,!1));this.HKh(tb,Nc,!1).forEach(Jd=>
{kc.add(Jd,kd);return!0});return!0});const Ac=new N.a;Yb.forEach(Nc=>{const kd=this.LKh(tb,Nc,!0);this.HKh(tb,Nc,!0).forEach(Jd=>kc.xb(Jd)?(Ac.add(kc.J(Jd).b_n>=kd?Nc:kc.J(Jd).id),!1):!0);return!0});return l.a.filter(Gb,Nc=>!Ac.contains(Nc))}LKh(tb,dc,Yb){return(dc=this.OAa(tb,dc,Yb))?tb.Yd.getPropertyMilliseconds(dc,w.a.HT):0}OAa(tb,dc,Yb){tb=Yb?tb.Wo.runtime.kq:tb.Wo.runtime.Vt;return tb.xb(dc)?tb.J(dc):null}HKh(tb,dc,Yb){const pb=new H.a,Gb=new N.a,hb=tb.Yd;dc=this.OAa(tb,dc,Yb);var Ib=this.fWh(hb,
dc);if(Ib)for(pb.add(Ib),Gb.add(Ib),dc=hb.getPropertyObjectIds(dc,m.a.tPe),Ib=0;dc&&Ib<dc.length;Ib++){const Ob=this.fWh(hb,this.OAa(tb,dc.J(Ib),Yb));if(!Ob)break;Gb.contains(Ob)||(pb.add(Ob),Gb.add(Ob))}return pb}fWh(tb,dc){if(!tb.hasProperty(dc,m.a.s$a)||!tb.hasProperty(dc,m.a.VWb)||!tb.hasProperty(dc,m.a.WWb))return null;const Yb=tb.getPropertyString(dc,m.a.s$a),pb=tb.getPropertyString(dc,m.a.VWb);tb=tb.getPropertyString(dc,m.a.WWb);return J.a.Tz(Yb+";"+pb+";"+tb)}static nh(){return new I}static get instance(){return I.Kg.value}}
I.Kg=new a.a(I.nh);Object(D.a)(I,"AppsNodeComplexMerge",l.a,[]);class R extends l.a{constructor(){super()}get wn(){return 36}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.R6f),1);tb.Z(v.a.yb(m.a.qXf),1);return tb}SA(tb,dc){u.a.instance.Ya(51430790,1,4,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",dc);if(dc===v.a.yb(m.a.R6f)||dc===v.a.yb(m.a.qXf)){const hb=v.a.oW(dc);var Yb=tb.Ng.value.Df,pb=tb.Um.value.Df;const Ib=tb.Nk;var Gb=tb.Yd.getPropertyStrings(tb.Ng.value.hu,hb);Yb=tb.Yd.getPropertyStrings(Yb,
hb);pb=tb.Yd.getPropertyStrings(pb,hb);Gb=this.vCa(Gb,Yb,pb);tb.Yd.setPropertyStrings(Ib,hb,Gb);tb.zg.add(dc);return!0}return!1}static nh(){return new R}static get instance(){return R.Kg.value}}R.Kg=new a.a(R.nh);Object(D.a)(R,"AutoSaveParametersNodeComplexMerge",l.a,[]);class C extends l.a{constructor(){super()}get wn(){return 44}lk(){const tb=super.lk();tb.Z(v.a.yb(w.a.rf),1);return tb}SA(tb,dc){const Yb=tb.Wo.runtime.Pb;if(dc===v.a.yb(w.a.rf))return u.a.instance.Ya(589608865,1,4,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
tb.Nk.id,tb.Nk.Qc,dc),Yb.Uq(134),Yb.isFeatureEnabled(134)?this.eFm(tb,dc):this.AFm(tb,dc),!0;u.a.instance.Ya(589608912,1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",tb.Ng.value.Df.id,dc);return!1}eFm(tb,dc){const Yb=v.a.oW(dc),pb=tb.Yd;var Gb=pb.getPropertyObjectIds(tb.Ng.value.hu,Yb),hb=pb.getPropertyObjectIds(tb.Ng.value.Df,Yb),Ib=pb.getPropertyObjectIds(tb.Um.value.Df,Yb);Ib=C.PLl(tb,hb,Ib);Gb=this.vCa(Gb,hb,
Ib);hb=tb.Nk;0<Gb.length?pb.setPropertyObjectIds(hb,Yb,Gb):hb.removeProperty(Yb);tb.zg.add(dc)}static nh(){return new C}static get instance(){return C.Kg.value}static PLl(tb,dc,Yb){const pb=new H.a,Gb=new K.a;dc.forEach(hb=>{const Ib=tb.Wo.runtime.Vt.J(hb);Ib&&Gb.add(Ib.QP(m.a.Rs).toString(),hb);return!0});Yb.forEach(hb=>{var Ib=tb.Wo.runtime.kq.J(hb);Ib?(Ib=Ib.QP(m.a.Rs).toString(),Gb.xb(Ib)&&Gb.get(Ib)!==hb?u.a.instance.Ya(557061773,1,4,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):
pb.add(hb)):pb.add(hb);return!0});return pb}}C.Kg=new a.a(C.nh);Object(D.a)(C,"BookmarkContainerNodeComplexMerge",l.a,[]);class P extends l.a{constructor(){super()}get wn(){return 41}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.Bvb),1);tb.Z(v.a.yb(m.a.Rs),1);return tb}SA(tb,dc){return dc===v.a.yb(m.a.Bvb)?(tb.zg.add(v.a.yb(m.a.Bvb)),!0):dc===v.a.yb(m.a.Rs)?(tb.zg.add(v.a.yb(m.a.Rs)),!0):!1}nf(tb){return tb&&tb.length?!1:!0}static nh(){return new P}static get instance(){return P.Kg.value}}P.Kg=new a.a(P.nh);
Object(D.a)(P,"BookmarkNodeComplexMerge",l.a,[]);class W extends l.a{constructor(){super();this.MMd=!1}get wn(){return 7}lk(){const tb=super.lk();tb.Z(v.a.yb(w.a.rf),1);return tb}SA(tb,dc){if(dc===v.a.yb(w.a.rf)){const Gb=tb.Nk,hb=tb.Yd;var Yb=tb.Wo.runtime.Pb;Yb&&(this.MMd=Yb.isFeatureEnabled(79));u.a.instance.Ya(4511579,1,4,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Gb.id,Gb.Qc,dc);dc=hb.getPropertyObjectIds(tb.Ng.value.hu,w.a.rf);
Yb=hb.getPropertyObjectIds(tb.Ng.value.Df,w.a.rf);var pb=hb.getPropertyObjectIds(tb.Um.value.Df,w.a.rf);dc=this.oFm(dc,Yb,pb);if(this.MMd&&0<dc.length){Yb=new Sys.StringBuilder;for(pb=0;pb<dc.length;pb++)Yb.append(dc.J(pb).toString()+",");u.a.instance.Ya(559710276,1,4,"Merge result for CommentContentNode {0}: {1}",Gb.id,Yb.toString())}0<dc.length?hb.setPropertyObjectIds(Gb,w.a.rf,dc):Gb.removeProperty(w.a.rf);tb.zg.add(v.a.yb(w.a.rf));return!0}u.a.instance.Ya(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
tb.Ng.value.Df.id,dc);return!1}oFm(tb,dc,Yb){const pb=new H.a,Gb=new K.a(0);this.f6k(tb,Yb,pb,Gb);return this.jTk(dc,Gb,pb)}f6k(tb,dc,Yb,pb){tb=tb||new H.a;dc=dc||new H.a;tb.forEach(Gb=>{pb.Z(Gb,1);return!0});dc.forEach(Gb=>{pb.Dc(Gb).returnValue?pb.Z(Gb,2):(pb.Z(Gb,0),Yb.add(Gb));return!0})}jTk(tb,dc,Yb){tb=tb||new H.a;const pb=new H.a,Gb=new H.a,hb=new H.a;tb.forEach(Ib=>{let Ob=!0,kc;({value:kc}=dc.Dc(Ib)).returnValue&&(0===kc?dc.Z(Ib,2):1===kc&&(Ob=!1));Ob?pb.add(Ib):this.MMd&&Gb.add(Ib);return!0});
Yb.forEach(Ib=>{let Ob=!1,kc;({value:kc}=dc.Dc(Ib)).returnValue?0===kc&&(Ob=!0,dc.Z(Ib,2)):u.a.instance.Ya(4511585,1,4,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",Ib);Ob?pb.add(Ib):this.MMd&&hb.add(Ib);return!0});this.Lli(Gb,"Favored");this.Lli(hb,"Unfavored");return pb}Lli(tb,dc){if(tb.length){var Yb=new Sys.StringBuilder;for(let pb=0;pb<tb.length;pb++)Yb.append(tb.J(pb).toString()+",");u.a.instance.Ya(561637572,
1,4,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",dc,Yb.toString())}}static nh(){return new W}static get instance(){return W.Kg.value}}W.Kg=new a.a(W.nh);Object(D.a)(W,"CommentContentNodeComplexMerge",l.a,[]);class X extends l.a{constructor(){super()}get wn(){return 8}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.x9),3);tb.Z(v.a.yb(m.a.ZD),3);tb.Z(v.a.yb(m.a.JAc),2);tb.Z(v.a.yb(m.a.commentId),2);tb.Z(v.a.yb(m.a.Enh),2);tb.Z(v.a.yb(m.a.aza),2);tb.Z(v.a.yb(m.a.CJa),1);tb.Z(v.a.yb(m.a.feb),
1);tb.Z(v.a.yb(m.a.nfb),1);tb.Z(v.a.yb(m.a.C5),1);tb.Z(v.a.yb(m.a.AF),1);tb.Z(v.a.yb(m.a.IAc),2);tb.Z(v.a.yb(m.a.Dud),2);tb.Z(v.a.yb(m.a.PYb),2);tb.Z(v.a.yb(m.a.JWe),2);tb.Z(v.a.yb(m.a.hL),1);tb.Z(v.a.yb(w.a.rf),0);tb.Z(v.a.yb(m.a.zG),0);return tb}SA(tb,dc){if(dc===v.a.yb(m.a.hL)){var Yb=tb.Yd.getPropertyString(tb.Um.value.Df,m.a.hL);this.nf(Yb)?tb.Nk.removeProperty(m.a.hL):tb.Nk.nva(m.a.hL,Yb);return!0}if(dc!==v.a.yb(m.a.CJa)&&dc!==v.a.yb(m.a.feb)&&dc!==v.a.yb(m.a.nfb)&&dc!==v.a.yb(m.a.AF)&&dc!==
v.a.yb(m.a.C5))return!1;var pb=tb.Ng.value.Df,Gb=tb.Um.value.Df;Yb=tb.Nk;if(dc===v.a.yb(m.a.CJa)){pb=tb.Yd.getPropertyString(pb,m.a.CJa);Gb=tb.Yd.getPropertyString(Gb,m.a.CJa);Gb=this.nf(pb)?Gb:this.nf(Gb)?pb:null;if(this.nf(Gb))return!0;tb.Yd.setPropertyString(Yb,m.a.CJa,Gb);tb.zg.add(v.a.yb(m.a.CJa));return!0}if(dc===v.a.yb(m.a.nfb))return pb=tb.Yd.getPropertyBool(pb,m.a.nfb),Gb=tb.Yd.getPropertyBool(Gb,m.a.nfb),pb=null!=pb?pb:!1,pb=(null!=Gb?Gb:!1)||pb,tb.Yd.setPropertyBool(Yb,m.a.nfb,pb),tb.zg.add(v.a.yb(m.a.nfb)),
!0;if(dc===v.a.yb(m.a.feb)){pb=tb.Yd.getPropertyBool(pb,m.a.feb);Gb=tb.Yd.getPropertyBool(Gb,m.a.feb);if(pb===Gb)return!0;pb=null!=pb?pb:!1;pb=(null!=Gb?Gb:!1)||pb;tb.Yd.setPropertyBool(Yb,m.a.feb,pb);return!0}if(dc===v.a.yb(m.a.AF)){pb=tb.Yd.getPropertyBool(pb,m.a.AF);Gb=tb.Yd.getPropertyBool(Gb,m.a.AF);if(pb===Gb)return!0;pb=null!=pb?pb:!1;pb=(null!=Gb?Gb:!1)||pb;tb.Yd.setPropertyBool(Yb,m.a.AF,pb);tb.zg.add(v.a.yb(m.a.AF));return!0}if(dc===v.a.yb(m.a.C5)){dc=tb.Wo.runtime.Pb;dc.Uq(15);if(!dc.isFeatureEnabled(15))return!1;
pb=tb.Yd.getPropertyString(pb,m.a.C5);Gb=tb.Yd.getPropertyString(Gb,m.a.C5);if(pb===Gb)return!0;tb.Yd.setPropertyString(Yb,m.a.C5,Gb||pb);tb.zg.add(v.a.yb(m.a.C5));return!0}return!1}nf(tb){return tb&&tb.length?!1:!0}static nh(){return new X}static get instance(){return X.Kg.value}}X.Kg=new a.a(X.nh);Object(D.a)(X,"CommentNodeComplexMerge",l.a,[]);class V extends l.a{constructor(){super()}get wn(){return 46}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.contentControlNode),1);tb.Z(v.a.yb(w.a.lastModifiedTime),
0);tb.Z(v.a.yb(m.a.kBc),2);return tb}SA(tb,dc){if(dc===v.a.yb(m.a.contentControlNode))return u.a.instance.Ya(556865370,1,4,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",tb.Nk.id,tb.Nk.Qc,dc),l.a.uyf(tb,this,m.a.contentControlNode);u.a.instance.Ya(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",tb.Ng.value.Df.id,dc);return!1}static nh(){return new V}static get instance(){return V.Kg.value}}
V.Kg=new a.a(V.nh);Object(D.a)(V,"ContentControlContainerNodeComplexMerge",l.a,[]);var Y=d(59),ca=d(1688);class fa extends l.a{constructor(){super()}get wn(){return 37}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.E5),1);tb.Z(v.a.yb(m.a.slb),1);tb.Z(v.a.yb(m.a.tvd),2);tb.Z(v.a.yb(m.a.lBc),2);tb.Z(v.a.yb(m.a.contentControlNode),1);tb.Z(v.a.yb(m.a.o6),1);tb.Z(v.a.yb(m.a.xda),1);tb.Z(v.a.yb(m.a.iZb),1);tb.Z(v.a.yb(m.a.nBc),1);tb.Z(v.a.yb(m.a.Eab),1);tb.Z(v.a.yb(m.a.Dab),1);tb.Z(v.a.yb(m.a.TXe),2);tb.Z(v.a.yb(m.a.mBc),
1);tb.Z(v.a.yb(m.a.uvd),1);tb.Z(v.a.yb(m.a.D5),1);return tb}SA(tb,dc){var Yb=tb.Ng.value.Df,pb=tb.Um.value.Df;const Gb=tb.Nk;if(dc===v.a.yb(m.a.contentControlNode))return l.a.uyf(tb,this,m.a.contentControlNode);if(dc===v.a.yb(m.a.o6)){dc=tb.Yd.getPropertyBool(Yb,m.a.o6);pb=tb.Yd.getPropertyBool(pb,m.a.o6);if(null!=dc&&dc||null!=pb&&pb)tb.Yd.setPropertyBool(Gb,m.a.o6,!0),tb.zg.add(v.a.yb(m.a.o6));return!0}if(dc===v.a.yb(m.a.xda))return dc=tb.Yd.getPropertyBool(Yb,m.a.xda),pb=tb.Yd.getPropertyBool(pb,
m.a.xda),tb.Yd.setPropertyBool(Gb,m.a.xda,null!=dc&&!!dc&&null!=pb&&!!pb),tb.zg.add(v.a.yb(m.a.xda)),!0;if(dc===v.a.yb(m.a.iZb))return dc=tb.Yd.getPropertyUint32(pb,m.a.iZb),null!=dc&&(tb.Yd.setPropertyUint32(Gb,m.a.iZb,dc),tb.zg.add(v.a.yb(m.a.iZb))),!0;if(dc===v.a.yb(m.a.nBc)||dc===v.a.yb(m.a.Eab)||dc===v.a.yb(m.a.Dab))return(pb=tb.Yd.getPropertyString(pb,v.a.oW(dc)))&&0<pb.length&&(tb.Yd.setPropertyString(Gb,v.a.oW(dc),pb),tb.zg.add(dc)),!0;if(dc===v.a.yb(m.a.mBc)||dc===v.a.yb(m.a.uvd)){Yb=tb.Yd.getPropertyObjectId(Yb,
v.a.oW(dc));if(ca.a.i2b(tb.Wo,Yb))return!0;if((pb=tb.Yd.getPropertyObjectId(pb,v.a.oW(dc)))&&pb!==Y.a.nil)return tb.Yd.setPropertyObjectId(Gb,v.a.oW(dc),pb),tb.zg.add(dc),!0;Gb.removeProperty(v.a.oW(dc));tb.zg.add(dc);return!0}if(dc===v.a.yb(m.a.D5)){Yb=tb.Yd.getPropertyObjectId(Yb,m.a.D5);if((Yb=ca.a.i2b(tb.Wo,Yb))&&tb.Yd.getPropertyObjectIds(Yb,m.a.contentControlNode).UF().contains(tb.Nk.id))return!0;pb=tb.Yd.getPropertyObjectId(pb,m.a.D5);return(Yb=ca.a.i2b(tb.Wo,pb))&&tb.Yd.getPropertyObjectIds(Yb,
m.a.contentControlNode).UF().contains(tb.Nk.id)?(tb.Yd.setPropertyObjectId(Gb,m.a.D5,pb),tb.zg.add(dc),!0):!1}if(dc===v.a.yb(m.a.E5))return dc=tb.Yd.getPropertyBool(pb,m.a.E5),null==dc||dc||(tb.Yd.setPropertyBool(Gb,m.a.E5,!1),tb.zg.add(v.a.yb(m.a.E5))),!0;if(dc===v.a.yb(m.a.slb)){dc=tb.Yd.getPropertyObjectId(Yb,m.a.slb);pb=tb.Yd.getPropertyObjectId(pb,m.a.slb);if(dc&&!dc.equals(pb))return!1;if(dc=dc||pb)tb.Yd.setPropertyObjectId(Gb,m.a.slb,dc),tb.zg.add(v.a.yb(m.a.slb));return!0}return!1}static nh(){return new fa}static get instance(){return fa.Kg.value}}
fa.Kg=new a.a(fa.nh);Object(D.a)(fa,"ContentControlNodeComplexMerge",l.a,[]);class sa extends l.a{constructor(){super()}get wn(){return 10}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.customXmlPartNode),1);return tb}SA(tb,dc){if(dc===v.a.yb(m.a.customXmlPartNode)){dc=tb.Nk;const pb=tb.Yd;var Yb=pb.getPropertyObjectIds(tb.Ng.value.hu,m.a.customXmlPartNode);const Gb=pb.getPropertyObjectIds(tb.Ng.value.Df,m.a.customXmlPartNode),hb=pb.getPropertyObjectIds(tb.Um.value.Df,m.a.customXmlPartNode);Yb=this.tFm(Yb,
Gb,hb);0<Yb.length?pb.setPropertyObjectIds(dc,m.a.customXmlPartNode,Yb):dc.removeProperty(m.a.customXmlPartNode);tb.zg.add(v.a.yb(m.a.customXmlPartNode));return!0}return!1}tFm(tb,dc,Yb){return this.vCa(tb,dc,Yb)}static nh(){return new sa}static get instance(){return sa.Kg.value}}sa.Kg=new a.a(sa.nh);Object(D.a)(sa,"CustomXmlPartContainerNodeComplexMerge",l.a,[]);class ia extends l.a{constructor(){super()}get wn(){return 9}get Az(){return 0}static nh(){return new ia}static get instance(){return ia.Kg.value}}
ia.Kg=new a.a(ia.nh);Object(D.a)(ia,"CustomXmlPartNodeComplexMerge",l.a,[]);class ea extends l.a{constructor(){super()}get wn(){return 29}get Az(){return 3}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.embeddedFontNode),1);return tb}SA(tb,dc){if(dc===v.a.yb(m.a.embeddedFontNode)){dc=tb.Yd;var Yb=dc.getPropertyObjectIds(tb.Ng.value.hu,m.a.embeddedFontNode),pb=dc.getPropertyObjectIds(tb.Ng.value.Df,m.a.embeddedFontNode);const Gb=dc.getPropertyObjectIds(tb.Um.value.Df,m.a.embeddedFontNode);Yb=this.vCa(Yb,
pb,Gb);pb=tb.Nk;0<Yb.length?dc.setPropertyObjectIds(pb,m.a.embeddedFontNode,Yb):pb.removeProperty(m.a.embeddedFontNode);tb.zg.add(v.a.yb(m.a.embeddedFontNode));return!0}return!1}static nh(){return new ea}static get instance(){return ea.Kg.value}}ea.Kg=new a.a(ea.nh);Object(D.a)(ea,"EmbeddedFontContainerNodeComplexMerge",l.a,[]);class da extends l.a{constructor(){super()}get wn(){return 30}get Az(){return 3}static nh(){return new da}static get instance(){return da.Kg.value}}da.Kg=new a.a(da.nh);Object(D.a)(da,
"EmbeddedFontNodeComplexMerge",l.a,[]);class ja extends l.a{constructor(){super()}get wn(){return 11}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.U5),4);tb.Z(v.a.yb(m.a.pXa),1);return tb}SA(tb,dc){if(dc===v.a.yb(m.a.pXa)){const Yb=tb.Nk,pb=tb.Yd;u.a.instance.Ya(4063307,1,4,"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Yb.id,Yb.Qc,dc);dc=pb.getPropertyObjectIds(tb.Ng.value.hu,m.a.pXa);const Gb=pb.getPropertyObjectIds(tb.Ng.value.Df,
m.a.pXa),hb=pb.getPropertyObjectIds(tb.Um.value.Df,m.a.pXa);dc=this.ppi(dc,Gb,hb,(Ib,Ob)=>Ib.equals(Ob));0<dc.length?pb.setPropertyObjectIds(Yb,m.a.pXa,dc):Yb.removeProperty(m.a.pXa);tb.zg.add(v.a.yb(m.a.pXa));return!0}u.a.instance.Ya(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.Ng.value.Df.id,dc);return!1}static nh(){return new ja}static get instance(){return ja.Kg.value}}ja.Kg=new a.a(ja.nh);
Object(D.a)(ja,"FootnoteEndnoteContainerNodeComplexMerge",l.a,[]);class Ga extends l.a{constructor(){super()}get wn(){return 12}get Az(){return 3}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.Gka),1);return tb}SA(tb,dc){const Yb=tb.Nk,pb=tb.Yd;if(dc===v.a.yb(m.a.Gka)){let Gb=-1;u.a.instance.Ya(5002527,1,4,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Yb.id,Yb.Qc,dc);const hb=pb.getPropertyInt32(tb.Ng.value.Df,m.a.Gka),Ib=pb.getPropertyInt32(tb.Um.value.Df,
m.a.Gka);null!=hb&&-1!==hb?Gb=hb:null!=Ib&&(Gb=Ib);pb.setPropertyInt32(Yb,m.a.Gka,Gb);tb.zg.add(dc);return!0}u.a.instance.Ya(5002528,1,4,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.Ng.value.hu.id,dc);return!1}static nh(){return new Ga}static get instance(){u.a.instance.Ya(5002526,1,4,"FootnoteEndnoteNodeComplexMerge: Got Instance");return Ga.Kg.value}}Ga.Kg=new a.a(Ga.nh);Object(D.a)(Ga,"FootnoteEndnoteNodeComplexMerge",
l.a,[]);class ya extends l.a{constructor(){super()}get wn(){return 47}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.glossaryPageContentNode),1);return tb}SA(tb,dc){return dc===v.a.yb(m.a.glossaryPageContentNode)?(u.a.instance.Ya(525099865,1,4,"GlossaryPageManifestNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",tb.Nk.id,tb.Nk.Qc,dc),l.a.uyf(tb,this,m.a.glossaryPageContentNode)):!1}static nh(){return new ya}static get instance(){return ya.Kg.value}}ya.Kg=new a.a(ya.nh);
Object(D.a)(ya,"GlossaryPageManifestNodeComplexMerge",l.a,[]);class ta extends l.a{constructor(){super()}get wn(){return 13}get Az(){return 3}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.nga),4);return tb}static nh(){return new ta}static get instance(){return ta.Kg.value}}ta.Kg=new a.a(ta.nh);Object(D.a)(ta,"HeaderFooterContainerNodeComplexMerge",l.a,[]);class ua extends l.a{constructor(){super()}get wn(){return 14}get Az(){return 3}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.runId),3);tb.Z(v.a.yb(m.a.Mc),
3);tb.Z(v.a.yb(m.a.r9h),3);tb.Z(v.a.yb(m.a.pT),1);tb.Z(v.a.yb(f.a.wZ),1);tb.Z(v.a.yb(w.a.imageAltText),1);tb.Z(v.a.yb(m.a.GW),1);tb.Z(v.a.yb(w.a.Baa),1);tb.Z(v.a.yb(f.a.Y3a),1);tb.Z(v.a.yb(m.a.m$a),1);return tb}SA(tb,dc){if(dc===v.a.yb(w.a.imageAltText)||dc===v.a.yb(m.a.GW)||dc===v.a.yb(m.a.pT)||dc===v.a.yb(m.a.HW)||dc===v.a.yb(w.a.reb)||dc===v.a.yb(w.a.Baa)||dc===v.a.yb(f.a.wZ)||dc===v.a.yb(f.a.Y3a)||dc===v.a.yb(m.a.m$a)){const pb=tb.Nk;var Yb=tb.Yd;u.a.instance.Ya(4018185,1,4,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
pb.id,pb.Qc,dc);const Gb=Yb.getPropertyInt32(tb.Ng.value.Df,f.a.wZ);Yb=Yb.getPropertyInt32(tb.Um.value.Df,f.a.wZ);if(null!=Gb&&(0===Gb||2===Gb))return!0;if(null!=Yb&&(0===Yb||2===Yb))return dc=tb.Um.value.Df,this.Lab(dc,pb,w.a.imageAltText),this.Lab(dc,pb,m.a.GW),this.Lab(dc,pb,m.a.HW),dc.hasProperty(m.a.pT)&&this.Lab(dc,pb,m.a.pT),this.Lab(dc,pb,w.a.reb),this.Lab(dc,pb,w.a.Baa),this.Lab(dc,pb,f.a.wZ),this.Lab(dc,pb,f.a.Y3a),tb.zg.add(v.a.yb(w.a.imageAltText)),tb.zg.add(v.a.yb(m.a.GW)),tb.zg.add(v.a.yb(m.a.HW)),
tb.zg.add(v.a.yb(m.a.pT)),tb.zg.add(v.a.yb(w.a.reb)),tb.zg.add(v.a.yb(w.a.Baa)),tb.zg.add(v.a.yb(f.a.wZ)),tb.zg.add(v.a.yb(f.a.Y3a)),tb.zg.add(v.a.yb(m.a.m$a)),!0}u.a.instance.Ya(4018186,1,4,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.Ng.value.hu.id,dc);return!1}static nh(){return new ua}static get instance(){return ua.Kg.value}}ua.Kg=new a.a(ua.nh);Object(D.a)(ua,"ImageNodeComplexMerge",l.a,[]);class Sa extends l.a{constructor(){super()}get wn(){return 40}get Az(){return 0}static nh(){return new Sa}static get instance(){return Sa.Kg.value}}
Sa.Kg=new a.a(Sa.nh);Object(D.a)(Sa,"IntelligenceAnnotationNodeComplexMerge",l.a,[]);class ka extends l.a{constructor(){super()}get wn(){return 32}get Az(){return 0}static nh(){return new ka}static get instance(){return ka.Kg.value}}ka.Kg=new a.a(ka.nh);Object(D.a)(ka,"IntelligenceContentLocatorNodeComplexMerge",l.a,[]);class ha extends l.a{constructor(){super()}get wn(){return 34}get Az(){return 0}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.afb),1);return tb}SA(tb,dc){const Yb=tb.Nk,pb=tb.Yd;if(dc===
v.a.yb(m.a.afb)){dc=pb.getPropertyObjectIds(tb.Ng.value.hu,m.a.afb);const Gb=pb.getPropertyObjectIds(tb.Ng.value.Df,m.a.afb),hb=pb.getPropertyObjectIds(tb.Um.value.Df,m.a.afb);dc=this.vCa(dc,Gb,hb);pb.setPropertyObjectIds(Yb,m.a.afb,dc);tb.zg.add(v.a.yb(m.a.afb));return!0}return!1}static nh(){return new ha}static get instance(){return ha.Kg.value}}ha.Kg=new a.a(ha.nh);Object(D.a)(ha,"IntelligenceRegionNodeComplexMerge",l.a,[]);class Ca extends l.a{constructor(){super()}get wn(){return 35}get Az(){return 0}static nh(){return new Ca}static get instance(){return Ca.Kg.value}}
Ca.Kg=new a.a(Ca.nh);Object(D.a)(Ca,"IntelligenceRejectionNodeComplexMerge",l.a,[]);class Pa extends l.a{constructor(){super()}get wn(){return 39}get Az(){return 0}static nh(){return new Pa}static get instance(){return Pa.Kg.value}}Pa.Kg=new a.a(Pa.nh);Object(D.a)(Pa,"IntelligenceReviewedNodeComplexMerge",l.a,[]);class Xa extends l.a{constructor(){super()}get wn(){return 33}get Az(){return 0}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.VLc),1);tb.Z(v.a.yb(m.a.OLd),1);tb.Z(v.a.yb(m.a.$mf),1);tb.Z(v.a.yb(m.a.bnf),
1);return tb}SA(tb,dc){const Yb=tb.Nk,pb=tb.Yd;if(dc===v.a.yb(m.a.VLc)||dc===v.a.yb(m.a.OLd)||dc===v.a.yb(m.a.$mf)||dc===v.a.yb(m.a.bnf)){dc=dc===v.a.yb(m.a.VLc)?m.a.VLc:m.a.OLd;var Gb=pb.getPropertyObjectIds(tb.Ng.value.hu,dc);const hb=pb.getPropertyObjectIds(tb.Ng.value.Df,dc),Ib=pb.getPropertyObjectIds(tb.Um.value.Df,dc);Gb=this.vCa(Gb,hb,Ib);pb.setPropertyObjectIds(Yb,dc,Gb);tb.zg.add(v.a.yb(dc));return!0}return!1}static nh(){return new Xa}static get instance(){return Xa.Kg.value}}Xa.Kg=new a.a(Xa.nh);
Object(D.a)(Xa,"IntelligenceRootNodeComplexMerge",l.a,[]);class qa extends l.a{constructor(){super()}get wn(){return 42}get Az(){return 0}static nh(){return new qa}static get instance(){return qa.Kg.value}}qa.Kg=new a.a(qa.nh);Object(D.a)(qa,"IntelligenceSettingNodeComplexMerge",l.a,[]);class Ea extends l.a{constructor(){super()}get wn(){return 45}get Az(){return 0}static nh(){return new Ea}static get instance(){return Ea.Kg.value}}Ea.Kg=new a.a(Ea.nh);Object(D.a)(Ea,"IntelligenceWorkflowNodeComplexMerge",
l.a,[]);class Ia extends l.a{constructor(){super()}get wn(){return 15}get Az(){return 3}static nh(){return new Ia}static get instance(){return Ia.Kg.value}}Ia.Kg=new a.a(Ia.nh);Object(D.a)(Ia,"NumberListNodeComplexMerge",l.a,[]);var na=d(110);class Na extends l.a{constructor(){super()}get wn(){return 16}get Az(){return 0}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.fvb),1);tb.Z(v.a.yb(na.a.QWe),7);tb.Z(v.a.yb(na.a.OWe),7);return tb}SA(tb,dc){const Yb=tb.Nk,pb=tb.Yd;if(dc===v.a.yb(m.a.fvb))return this.Btf(pb,
tb.Ng.value.Df,tb.Um.value.Df,Yb,m.a.fvb),tb.zg.add(dc),!0;u.a.instance.Ya(4207940,1,4,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.Ng.value.hu.id,dc);return!1}static nh(){return new Na}static get instance(){return Na.Kg.value}}Na.Kg=new a.a(Na.nh);Object(D.a)(Na,"OutlineElementNodeComplexMerge",l.a,[]);class Oa extends l.a{constructor(){super()}get wn(){return 17}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.fvb),1);
tb.Z(v.a.yb(m.a.mka),1);tb.Z(v.a.yb(na.a.bI),1);tb.Z(v.a.yb(na.a.R7b),1);tb.Z(v.a.yb(na.a.Hfa),8);return tb}SA(tb,dc){const Yb=tb.Nk,pb=tb.Yd;if(dc===v.a.yb(m.a.fvb))return this.Btf(pb,tb.Ng.value.Df,tb.Um.value.Df,Yb,m.a.fvb),tb.zg.add(dc),!0;if(dc===v.a.yb(m.a.mka)){var Gb=pb.getPropertyBool(tb.Ng.value.Df,m.a.mka),hb=pb.getPropertyBool(tb.Um.value.Df,m.a.mka);pb.setPropertyBool(Yb,m.a.mka,null==Gb?!1:Gb&&null==hb?!1:hb);tb.zg.add(dc);return!0}if(dc===v.a.yb(na.a.R7b))return this.Btf(pb,tb.Ng.value.Df,
tb.Um.value.Df,Yb,na.a.R7b),tb.zg.add(dc),!0;if(dc===v.a.yb(na.a.bI))return Gb=pb.getPropertyBool(tb.Ng.value.Df,na.a.bI),hb=pb.getPropertyBool(tb.Um.value.Df,na.a.bI),pb.setPropertyBool(Yb,na.a.bI,null==Gb?!0:Gb||null==hb?!0:hb),tb.zg.add(dc),!0;u.a.instance.Ya(4057305,1,4,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.Ng.value.hu.id,dc);return!1}static nh(){return new Oa}static get instance(){return Oa.Kg.value}}Oa.Kg=
new a.a(Oa.nh);Object(D.a)(Oa,"OutlineGroupNodeComplexMerge",l.a,[]);var Ra=d(47),ab=d(43);class zb extends l.a{constructor(){super()}get wn(){return 18}get Az(){return 2}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.FJd),3);tb.Z(v.a.yb(w.a.uaa),this.Az);tb.Z(v.a.yb(m.a.Xs),1);tb.Z(v.a.yb(m.a.f9),1);tb.Z(v.a.yb(m.a.U2),1);tb.Z(v.a.yb(m.a.nQ),1);tb.Z(v.a.yb(m.a.pp),1);tb.Z(v.a.yb(Ra.a.oQ),1);tb.Z(v.a.yb(Ra.a.A9b),1);return tb}SA(tb,dc){const Yb=tb.Yd;if(tb.Wo.runtime.Pb.isFeatureEnabled(74)){var pb=tb.Wo.runtime.Pb.isFeatureEnabled(133),
Gb=this.eSh(pb),hb=this.iSh(pb);if(dc===v.a.yb(m.a.Xs)||dc===v.a.yb(m.a.U2)||dc===v.a.yb(Gb)||dc===v.a.yb(m.a.pp)||dc===v.a.yb(hb))return this.Uao(Yb,tb,pb)}else if(dc===v.a.yb(m.a.Xs)||dc===v.a.yb(m.a.pp)){({aBc:dc,AZa:pb,vZa:Gb}=this.YUe(Object(ab.a)(Yb,Yb.getPropertyUint32s,"getPropertyUint32s"),tb.Ng.value.hu,tb.Ng.value.Df,tb.Um.value.Df,m.a.Xs,null));if(!Gb&&!pb)return u.a.instance.Ya(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
tb.Ng.value.Df.id,v.a.yb(m.a.Xs)),!0;let Ib,Ob;({aBc:hb,AZa:Ib,vZa:Ob}=this.YUe(Object(ab.a)(Yb,Yb.getPropertyObjectIds,"getPropertyObjectIds"),tb.Ng.value.hu,tb.Ng.value.Df,tb.Um.value.Df,m.a.pp,null));if(!Ib&&!Ob)return u.a.instance.Ya(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",tb.Ng.value.Df.id,v.a.yb(m.a.pp)),!0;const kc=Ib&&!Ob;if((pb&&!Gb)!==kc)return u.a.instance.Ya(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
tb.Ng.value.Df.id,v.a.yb(m.a.Xs),v.a.yb(m.a.pp)),!1;kc&&(Yb.setPropertyObjectIds(tb.Nk,m.a.pp,hb),Yb.setPropertyUint32s(tb.Nk,m.a.Xs,dc));u.a.instance.Ya(4318877,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",tb.Ng.value.Df.id,v.a.yb(m.a.Xs),pb,Gb,v.a.yb(m.a.pp),Ib,Ob);tb.zg.add(v.a.yb(m.a.pp));tb.zg.add(v.a.yb(m.a.Xs));
return!0}u.a.instance.Ya(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.Ng.value.Df.id,dc);return!1}R2h(tb,dc,Yb,pb){let Gb;({aBc:dc,AZa:pb,vZa:Gb}=this.YUe(dc,Yb.Ng.value.hu,Yb.Ng.value.Df,Yb.Um.value.Df,tb,pb));return Gb||pb?{returnValue:!0,oXe:dc,AZa:pb,vZa:Gb}:(u.a.instance.Ya(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
Yb.Ng.value.Df.id.toString(),v.a.yb(tb)),{returnValue:!1,oXe:dc,AZa:pb,vZa:Gb})}W1h(tb,dc,Yb,pb,Gb){let hb;let Ib,Ob,kc,Ac;({oXe:hb,AZa:Nc,vZa:Ib,returnValue:kc}=this.R2h(tb,Object(ab.a)(Yb,Yb.getPropertyUint32s,"getPropertyUint32s"),pb,null));({oXe:Yb,AZa:Gb,vZa:Ob,returnValue:Ac}=this.R2h(dc,Object(ab.a)(Yb,Yb.getPropertyObjectIds,"getPropertyObjectIds"),pb,Gb));var Nc=Nc&&!Ib;return kc&&Ac?Nc!==(Gb&&!Ob)?(u.a.instance.Ya(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
pb.Ng.value.Df.id.toString(),v.a.yb(tb),v.a.yb(dc)),{returnValue:2,cvd:hb,bvd:Yb,T9d:Nc}):{returnValue:0,cvd:hb,bvd:Yb,T9d:Nc}:{returnValue:1,cvd:hb,bvd:Yb,T9d:Nc}}Xof(tb){let dc=!0;tb.forEach(Yb=>Yb!==Y.a.nil?dc=!1:!0);return dc}ppl(tb,dc,Yb){return this.Xof(tb)&&this.Xof(dc)&&this.Xof(Yb)?!0:!1}Uao(tb,dc,Yb){const pb=this.eSh(Yb);Yb=this.iSh(Yb);let Gb,hb,Ib,Ob,kc,Ac;var Nc=({cvd:Ob,bvd:kc,T9d:hb}=this.W1h(pb,m.a.pp,tb,dc,null)).returnValue;if(2===Nc||1===Nc)return!0;({cvd:Ib,bvd:Ac,T9d:Gb,returnValue:Nc}=
this.W1h(m.a.Xs,m.a.U2,tb,dc,Object(ab.a)(this,this.ppl,"getExtendedGuidEquivalence")));if(2===Nc||1===Nc)return!0;let kd;({aBc:Nc,AZa:Jd,vZa:kd}=this.lsk(Object(ab.a)(tb,tb.getPropertyDictionary,"getPropertyDictionary"),dc.Ng.value.hu,dc.Ng.value.Df,dc.Um.value.Df,Yb));if(!kd&&!Jd)return u.a.instance.Ya(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",dc.Ng.value.Df.id.toString(),v.a.yb(Yb)),!0;var Jd=Jd&&!kd;
if(Gb!==hb||Gb!==Jd)return u.a.instance.Ya(592545116,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",dc.Ng.value.Df.id.toString(),v.a.yb(m.a.Xs),v.a.yb(pb),v.a.yb(Yb),hb,Gb,Jd),!0;Gb&&(tb.setPropertyObjectIds(dc.Nk,m.a.pp,kc),tb.setPropertyUint32s(dc.Nk,pb,Ob),tb.setPropertyObjectIds(dc.Nk,
m.a.U2,Ac),tb.setPropertyUint32s(dc.Nk,m.a.Xs,Ib),tb.setPropertyDictionary(dc.Nk,Yb,Nc));u.a.instance.Ya(592545118,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingAbsListId: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",dc.Ng.value.Df.id.toString(),hb,Gb,Jd);dc.zg.add(v.a.yb(pb));dc.zg.add(v.a.yb(m.a.pp));dc.zg.add(v.a.yb(m.a.Xs));dc.zg.add(v.a.yb(m.a.U2));dc.zg.add(v.a.yb(Yb));return!0}eSh(tb){return tb?Ra.a.A9b:m.a.f9}iSh(tb){return tb?Ra.a.oQ:
m.a.nQ}static nh(){return new zb}static get instance(){return zb.Kg.value}}zb.Kg=new a.a(zb.nh);Object(D.a)(zb,"PageContentNodeComplexMerge",l.a,[]);class Qa extends l.a{constructor(){super()}get wn(){return 19}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.UDa),1);tb.Z(v.a.yb(m.a.appsNode),2);tb.Z(v.a.yb(m.a.customXmlPartContainerNode),2);tb.Z(v.a.yb(m.a.intelligenceRootNode),1);return tb}SA(tb,dc){const Yb=tb.Yd;if(dc===v.a.yb(m.a.UDa)){var pb=Yb.getPropertyObjectIds(tb.Ng.value.hu,m.a.UDa),Gb=Yb.getPropertyObjectIds(tb.Ng.value.Df,
m.a.UDa),hb=Yb.getPropertyObjectIds(tb.Um.value.Df,m.a.UDa);if((pb=this.HFm(pb,Gb,hb,(Ib,Ob)=>Ib.equals(Ob),Ib=>{let Ob;({value:Ob}=tb.Wo.runtime.kq.Dc(Ib)).returnValue?tb.Wo.runtime.Lm.Z(Ib,new z.a(Ob,!1)):u.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")},tb.Wo))&&0<pb.length)return Yb.setPropertyObjectIds(tb.Nk,m.a.UDa,pb),tb.zg.add(v.a.yb(m.a.UDa)),!0}if(dc===v.a.yb(m.a.intelligenceRootNode))return pb=
Yb.getPropertyObjectIds(tb.Ng.value.hu,m.a.intelligenceRootNode),Gb=Yb.getPropertyObjectIds(tb.Ng.value.Df,m.a.intelligenceRootNode),hb=Yb.getPropertyObjectIds(tb.Um.value.Df,m.a.intelligenceRootNode),pb=this.vCa(pb,Gb,hb),Yb.setPropertyObjectIds(tb.Nk,m.a.intelligenceRootNode,pb),tb.zg.add(dc),!0;u.a.instance.Ya(4018187,1,4,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.Ng.value.Df.id,dc);return!1}static nh(){return new Qa}static get instance(){return Qa.Kg.value}}
Qa.Kg=new a.a(Qa.nh);Object(D.a)(Qa,"PageManifestNodeComplexMerge",l.a,[]);class yb extends l.a{constructor(){super()}get wn(){return 43}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.mja),0);tb.Z(v.a.yb(m.a.yGb),0);tb.Z(v.a.yb(m.a.hDb),0);tb.Z(v.a.yb(m.a.kla),1);tb.Z(v.a.yb(m.a.sessionId),3);tb.Z(v.a.yb(m.a.buildVersion),3);tb.Z(v.a.yb(m.a.ZW),1);tb.Z(v.a.yb(m.a.tbi),1);tb.Z(v.a.yb(m.a.Eu),1);return tb}SA(tb,dc){if(dc===v.a.yb(m.a.ZW)||dc===v.a.yb(m.a.tbi)||dc===v.a.yb(m.a.Eu)){var Yb=tb.Um.value.Df,pb=
tb.Ng.value.Df,Gb=v.a.oW(dc);pb=tb.Yd.getPropertyBool(pb,Gb);Yb=tb.Yd.getPropertyBool(Yb,Gb);tb.Yd.setPropertyBool(tb.Nk,Gb,null==pb?!1:pb&&null==Yb?!1:Yb);tb.zg.add(dc);return!0}if(dc===v.a.yb(m.a.kla)){dc=tb.Yd;Yb=tb.Ng.value.hu;pb=tb.Um.value.Df;Gb=tb.Ng.value.Df;Yb=Yb?dc.getPropertyObjectId(Yb,m.a.kla):null;pb=pb?dc.getPropertyObjectId(pb,m.a.kla):null;Gb=Gb?dc.getPropertyObjectId(Gb,m.a.kla):null;u.a.instance.Ya(589657691,1,4,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",
Yb?Yb.toString():"NULL",pb?pb.toString():"NULL",Gb?Gb.toString():"NULL");if(pb){if(Gb&&pb.equals(Gb))return tb.zg.add(v.a.yb(m.a.kla)),dc.setPropertyObjectId(tb.Nk,m.a.kla,pb),!0;if(ca.a.eId.equals(pb))return tb.zg.add(v.a.yb(m.a.kla)),dc.setPropertyObjectId(tb.Nk,m.a.kla,ca.a.eId),!0}if(Gb&&ca.a.eId.equals(Gb))return tb.zg.add(v.a.yb(m.a.kla)),dc.setPropertyObjectId(tb.Nk,m.a.kla,ca.a.eId),!0;u.a.instance.Ya(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",
Yb?Yb.toString():"NULL",pb?pb.toString():"NULL",Gb?Gb.toString():"NULL")}return!1}static nh(){return new yb}static get instance(){return yb.Kg.value}}yb.Kg=new a.a(yb.nh);Object(D.a)(yb,"PageMetadataNodeComplexMerge",l.a,[]);var lb=d(1700),Eb=d(106);class bc extends l.a{constructor(){super()}get wn(){return 31}lk(){const tb=super.lk();tb.Z(v.a.yb(Eb.a.Jv),1);tb.Z(v.a.yb(m.a.listID),3);tb.Z(v.a.yb(m.a.listLevel),1);tb.Z(v.a.yb(m.a.we),3);tb.Z(v.a.yb(m.a.BXb),3);tb.Z(v.a.yb(m.a.runId),3);tb.Z(v.a.yb(m.a.hAd),
3);tb.Z(v.a.yb(w.a.fontColor),3);tb.Z(v.a.yb(m.a.zoh),3);tb.Z(v.a.yb(m.a.Mc),1);tb.Z(v.a.yb(Eb.a.HMd),3);tb.Z(v.a.yb(Eb.a.ntf),3);tb.Z(v.a.yb(Eb.a.uNc),3);tb.Z(v.a.yb(m.a.Hal),3);tb.Z(v.a.yb(na.a.Sdj),3);for(let dc=0;dc<bc.u_a.length;dc++)tb.Z(bc.u_a[dc],1);return tb}SA(tb,dc){var Yb=tb.Yd;const pb=tb.Nk;var Gb=tb.Wo.runtime.Pb.isFeatureEnabled(132);v.a.oW(dc);if(dc===v.a.yb(m.a.Mc)){Yb=tb.Yd.getPropertyInt32(tb.Um.value.Df,m.a.Mc);if(null==Yb||!Yb)return!0;tb.Yd.setPropertyInt32(pb,m.a.Mc,Yb);tb.zg.add(dc);
return!0}if(dc===v.a.yb(Eb.a.Jv)){Gb=Yb.getPropertyUint32(tb.Ng.value.Df,Eb.a.Jv);const hb=Yb.getPropertyUint32(tb.Um.value.Df,Eb.a.Jv);if(null!=Gb&&null!=hb&&Gb===hb)return Yb.setPropertyUint32(pb,Eb.a.Jv,Gb),tb.zg.add(dc),!0;if(null==Gb&&null==hb)return pb.removeProperty(Eb.a.Jv),tb.zg.add(v.a.yb(Eb.a.Jv)),!0;if(null!=Gb&&null==hb)return Yb.setPropertyUint32(pb,Eb.a.Jv,Gb),tb.zg.add(dc),!0;if(null==Gb&&null!=hb)return Yb.setPropertyUint32(pb,Eb.a.Jv,hb),tb.zg.add(dc),!0}else{if(dc===v.a.yb(m.a.listLevel))return this.nao(Yb,
tb);if(dc===v.a.yb(f.a.paragraphStyle)){if(Gb)return this.mcj(tb)}else if(Array.contains(bc.u_a,dc))return this.mcj(tb)}return!1}mcj(tb){let dc=!0,Yb=!0,pb,Gb;({Nam:dc,h9l:Yb,c5k:pb,OAk:Gb}=this.msk(tb));u.a.instance.Ya(578932993,1,4,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",tb.Ng.value.Df.id.toString(),dc,Yb);return dc&&!Yb?(this.eqi(Gb,tb),!0):dc?!1:(this.eqi(pb,tb),!0)}msk(tb){let dc,Yb,pb,Gb;const hb=
tb.Um.value;let Ib;const Ob=tb.Ng.value;let kc;Yb=dc=!0;pb=new K.a;Gb=new K.a;for(let Ac=0;Ac<bc.u_a.length;Ac++){const Nc=bc.u_a[Ac],kd=({value:Ib}=hb.dna.Dc(Nc)).returnValue;({value:kc}=Ob.dna.Dc(Nc)).returnValue&&(dc=this.Zbj(tb.Ng,pb,kc,Nc)&&dc);kd&&(Yb=this.Zbj(tb.Um,Gb,Ib,Nc)&&Yb)}return{Nam:dc,h9l:Yb,c5k:pb,OAk:Gb}}Zbj(tb,dc,Yb,pb){const Gb=v.a.oW(pb);tb=tb.value.Df;dc.Z(pb,tb.hasProperty(Gb)?tb.QP(Gb):null);return!Yb.PW}eqi(tb,dc){const Yb=dc.Nk;for(let Gb=0;Gb<bc.u_a.length;Gb++){var pb=
bc.u_a[Gb];const hb=v.a.oW(pb);(pb=tb.J(pb))?Yb.nva(hb,pb):Yb.removeProperty(hb)}for(tb=0;tb<bc.u_a.length;tb++)dc.zg.add(bc.u_a[tb]);u.a.instance.Ya(578932994,1,4,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",dc.Ng.value.Df.id.toString())}nao(tb,dc){const Yb=dc.Nk,pb=tb.getPropertyInt32(dc.Ng.value.Df,m.a.listLevel),Gb=tb.getPropertyInt32(dc.Um.value.Df,m.a.listLevel);return null!=pb&&null!=Gb&&pb===Gb?(tb.setPropertyInt32(Yb,m.a.listLevel,pb),dc.zg.add(v.a.yb(m.a.listLevel)),
!0):null==pb&&null==Gb?(Yb.removeProperty(m.a.listLevel),dc.zg.add(v.a.yb(m.a.listLevel)),!0):null!=pb&&null==Gb?(tb.setPropertyInt32(Yb,m.a.listLevel,pb),dc.zg.add(v.a.yb(m.a.listLevel)),!0):null==pb&&null!=Gb?(tb.setPropertyInt32(Yb,m.a.listLevel,Gb),dc.zg.add(v.a.yb(m.a.listLevel)),!0):!1}static nh(){return new bc}static get instance(){return bc.Kg.value}}bc.Kg=new a.a(bc.nh);bc.u_a=[v.a.yb(m.a.ge),v.a.yb(m.a.$s),v.a.yb(w.a.M2),v.a.yb(m.a.baa),v.a.yb(m.a.Qr),v.a.yb(m.a.sr),v.a.yb(w.a.bX),v.a.yb(m.a.uRe),
v.a.yb(w.a.font),v.a.yb(na.a.Ogb),v.a.yb(f.a.paragraphStyle)];Object(D.a)(bc,"PersistablePropertySetComplexMerge",l.a,[]);class Pb extends l.a{constructor(){super()}get wn(){return 21}get Az(){return 0}static nh(){return new Pb}static get instance(){return Pb.Kg.value}}Pb.Kg=new a.a(Pb.nh);Object(D.a)(Pb,"RevisionMetadataNodeComplexMerge",l.a,[]);class Va extends l.a{constructor(){super()}get wn(){return 48}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.QEi),3);return tb}static nh(){return new Va}static get instance(){return Va.Kg.value}}
Va.Kg=new a.a(Va.nh);Object(D.a)(Va,"ShadowNumberListNodeComplexMerge",l.a,[]);class oa extends l.a{constructor(){super()}get wn(){return 22}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.languageHint),7);tb.Z(v.a.yb(m.a.WNc),2);return tb}static nh(){return new oa}static get instance(){return oa.Kg.value}}oa.Kg=new a.a(oa.nh);Object(D.a)(oa,"SharedPersistablePropertySetComplexMerge",l.a,[]);class pa extends l.a{constructor(){super()}get wn(){return 38}get Az(){return 3}static nh(){return new pa}static get instance(){return pa.Kg.value}}
pa.Kg=new a.a(pa.nh);Object(D.a)(pa,"StylePropertySetComplexMerge",l.a,[]);var Ya=d(1539),Ja=d(1576);class nb extends l.a{constructor(){super()}get wn(){return 23}get Az(){return 0}lk(){const tb=super.lk();tb.Z(v.a.yb(w.a.rf),4);tb.Z(v.a.yb(m.a.rowSpan),1);tb.Z(v.a.yb(m.a.colSpan),1);tb.Z(v.a.yb(m.a.ghostCell),1);tb.Z(v.a.yb(Ra.a.vMerge),1);tb.Z(v.a.yb(Ra.a.gridSpan),1);tb.Z(v.a.yb(m.a.q3a),2);tb.Z(v.a.yb(m.a.zlb),2);tb.Z(v.a.yb(m.a.oEa),2);tb.Z(v.a.yb(m.a.Vkb),5);return tb}pDb(tb){if(!tb)return u.a.instance.Ya(573957923,
1,2,"Feature helper is null"),!1;tb.Uq(114);return tb.isFeatureEnabled(114)}fK(tb){if(!tb)return u.a.instance.Ya(540120285,1,2,"Feature helper is null"),!1;tb.Uq(115);return tb.isFeatureEnabled(115)}SA(tb,dc){tb.Wo.runtime.RF("TableCellNodeComplexMerge.TryMergeCustomProperty, propertyId:"+dc);var Yb=dc===v.a.yb(m.a.rowSpan)||dc===v.a.yb(m.a.colSpan)||dc===v.a.yb(m.a.ghostCell);this.fK(tb.Wo.runtime.Pb)&&(Yb=Yb||dc===v.a.yb(Ra.a.vMerge)||dc===v.a.yb(Ra.a.gridSpan));if(!this.pDb(tb.Wo.runtime.Pb))return!Yb;
var pb=tb.Um.value.hu,Gb=Ja.e(tb.Wo,pb,null);if(Gb.equals(Y.a.nil))return u.a.instance.Ya(573845783,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",pb.id),tb.Wo.logger.Pg(Object.assign(new Ya.a,{info:"Table node ID could not be found for table cell"})),!1;var hb=tb.Wo.runtime.uwb.J(Gb).J(pb.id);if(!hb)return!Yb;pb=tb.Nk;Gb=tb.Yd;if(dc===v.a.yb(m.a.ghostCell))return Gb.setPropertyBool(pb,m.a.ghostCell,hb.qg),tb.zg.add(v.a.yb(m.a.ghostCell)),!0;if(dc===v.a.yb(m.a.rowSpan))return dc=
hb.rowSpan,hb=hb.colSpan,null!=dc&&null!=hb&&(1<dc||1<hb)?Gb.setPropertyUint32(pb,m.a.rowSpan,dc):pb.removeProperty(m.a.rowSpan),tb.zg.add(v.a.yb(m.a.rowSpan)),!0;if(dc===v.a.yb(m.a.colSpan))return dc=hb.rowSpan,Yb=hb.colSpan,hb=hb.qg,null!=dc&&null!=Yb&&(1<dc||1<Yb)?Gb.setPropertyUint32(pb,m.a.colSpan,Yb):hb&&null!=Yb?Gb.setPropertyUint32(pb,m.a.colSpan,Yb):pb.removeProperty(m.a.colSpan),tb.zg.add(v.a.yb(m.a.colSpan)),!0;u.a.instance.Ya(573690910,1,2,"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property whose merge strategy is not custom merge. PropertyID:{0}",
dc);tb.Wo.logger.Pg(Object.assign(new Ya.a,{info:"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property which should not be custom merged"}));return!Yb}static nh(){return new nb}static get instance(){return nb.Kg.value}}nb.Kg=new a.a(nb.nh);Object(D.a)(nb,"TableCellNodeComplexMerge",l.a,[]);class Bb extends l.a{constructor(){super()}get wn(){return 24}pDb(tb){if(!tb)return u.a.instance.Ya(573845782,1,2,"Feature helper is null"),!1;tb.Uq(114);return tb.isFeatureEnabled(114)}get Az(){return 0}lk(){const tb=
super.lk();tb.Z(v.a.yb(w.a.rf),1);tb.Z(v.a.yb(w.a.v_),1);tb.Z(v.a.yb(w.a.wva),1);tb.Z(v.a.yb(m.a.gfc),1);tb.Z(v.a.yb(m.a.D7),1);tb.Z(v.a.yb(m.a.q3a),2);tb.Z(v.a.yb(m.a.zlb),2);tb.Z(v.a.yb(m.a.oEa),2);return tb}SA(tb,dc){tb.Wo.runtime.RF("TableNodeComplexMerge.TryMergeCustomProperty, PropertyId:"+dc);if(dc===v.a.yb(w.a.rf)||dc===v.a.yb(w.a.v_)||dc===v.a.yb(m.a.gfc)||dc===v.a.yb(m.a.D7)||dc===v.a.yb(w.a.wva)){const Gb=tb.Nk;var Yb=tb.Yd;u.a.instance.Ya(4273303,1,4,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Gb.id,Gb.Qc,dc);if(this.vWk(tb))return!1;var pb=Yb.getPropertyObjectIds(tb.Ng.value.hu,w.a.rf);const hb=Yb.getPropertyObjectIds(tb.Ng.value.Df,w.a.rf),Ib=Yb.getPropertyObjectIds(tb.Um.value.Df,w.a.rf);pb=this.ppi(pb,hb,Ib,(Ob,kc)=>Ob.equals(kc));if(0<pb.length)return Yb.setPropertyObjectIds(Gb,w.a.rf,pb),Yb.setPropertyInt32(Gb,w.a.wva,pb.length),this.pDb(tb.Wo.runtime.Pb)&&({value:dc}=tb.Um.value.dna.Dc(v.a.yb(w.a.v_)),{value:Yb}=tb.Ng.value.dna.Dc(v.a.yb(w.a.v_)),dc.PW?Gb.nva(w.a.v_,dc.newValue):
Gb.nva(w.a.v_,Yb.newValue)),tb.zg.add(v.a.yb(w.a.rf)),tb.zg.add(v.a.yb(w.a.v_)),tb.zg.add(v.a.yb(w.a.wva)),tb.zg.add(v.a.yb(m.a.gfc)),tb.zg.add(v.a.yb(m.a.D7)),!0}u.a.instance.Ya(4018189,1,4,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.Ng.value.Df.id,dc);return!1}vWk(tb){const dc=tb.Um.value,Yb=tb.Ng.value;let pb,Gb;({value:pb}=dc.dna.Dc(v.a.yb(w.a.v_)));({value:Gb}=Yb.dna.Dc(v.a.yb(w.a.v_)));return pb.PW||Gb.PW?pb.PW&&Gb.PW?(u.a.instance.Ya(4273304,
1,4,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",pb.oldValue,Gb.newValue,pb.newValue),tb.Wo.logger.Pg(Object.assign(new Ya.a,{kj:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),!0):Bb.bzh(tb.Wo,pb,Yb,"BaseConflict")||Bb.bzh(tb.Wo,Gb,dc,"BaseFavored")?!0:!1:!1}static nh(){return new Bb}static get instance(){return Bb.Kg.value}static bzh(tb,dc,Yb,pb){return dc.PW&&({value:dc}=Yb.dna.Dc(v.a.yb(w.a.rf)),
dc.PW)?(u.a.instance.Ya(4273305,1,4,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",pb),tb.logger.Pg(Object.assign(new Ya.a,{kj:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}Bb.Kg=new a.a(Bb.nh);Object(D.a)(Bb,"TableNodeComplexMerge",l.a,[]);class mb extends l.a{constructor(){super()}get wn(){return 25}get Az(){return 0}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.Mc),3);tb.Z(v.a.yb(w.a.rf),4);tb.Z(v.a.yb(m.a.q3a),
2);tb.Z(v.a.yb(m.a.zlb),2);tb.Z(v.a.yb(m.a.oEa),2);tb.Z(v.a.yb(Ra.a.G2f),2);tb.Z(v.a.yb(Ra.a.F2f),2);tb.Z(v.a.yb(m.a.Vkb),5);return tb}static nh(){return new mb}static get instance(){return mb.Kg.value}}mb.Kg=new a.a(mb.nh);Object(D.a)(mb,"TableRowNodeComplexMerge",l.a,[]);class Qb extends l.a{constructor(){super()}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.A4n),2);tb.Z(v.a.yb(w.a.rf),1);return tb}SA(tb,dc){if(dc===v.a.yb(w.a.rf)){const pb=tb.Nk,Gb=tb.Yd;u.a.instance.Ya(42754251,1,4,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
pb.id,pb.Qc,dc);var Yb=Gb.getPropertyObjectIds(tb.Ng.value.hu,w.a.rf);const hb=Gb.getPropertyObjectIds(tb.Ng.value.Df,w.a.rf),Ib=Gb.getPropertyObjectIds(tb.Um.value.Df,w.a.rf);if(Yb=this.SFm(Yb,hb,Ib))return 0<Yb.length?Gb.setPropertyObjectIds(pb,w.a.rf,Yb):pb.removeProperty(w.a.rf),tb.zg.add(v.a.yb(w.a.rf)),!0}u.a.instance.Ya(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",tb.Ng.value.Df.id,dc);return!1}SFm(tb,dc,
Yb){const pb=new K.a(0);tb.forEach(hb=>{pb.Z(hb,0);return!0});dc.forEach(hb=>{pb.xb(hb)?pb.Z(hb,1):pb.Z(hb,3);return!0});Yb.forEach(hb=>{let Ib;({value:Ib}=pb.Dc(hb)).returnValue?1===Ib?pb.Z(hb,5):3===Ib?(u.a.instance.Ya(42754253,1,2,"TaskNode was found added by both sides of merge"),pb.Z(hb,3)):pb.Z(hb,2):pb.Z(hb,4);return!0});const Gb=new H.a;pb.forEach((hb,Ib)=>{0!==Ib&&2!==Ib&&1!==Ib&&Gb.add(hb);return!0});return Gb}static nh(){return new Qb}static get instance(){return Qb.Kg.value}}Qb.Kg=new a.a(Qb.nh);
Object(D.a)(Qb,"TaskContentNodeComplexMerge",l.a,[]);class Vb{equals(tb,dc){return tb&&dc?tb.UserId===dc.UserId&&tb.Provider===dc.Provider&&tb.DisplayName===dc.DisplayName&&tb.Email===dc.Email:!tb&&!dc}SJ(){return 0}}Object(D.a)(Vb,"CommentTaskPersonComparer",null,[160]);class mc{equals(tb,dc){return tb&&dc?tb.startDate?tb.endDate?tb.startDate.getTime()===dc.startDate.getTime()&&tb.endDate.getTime()===dc.endDate.getTime():!dc.endDate:!dc.startDate:!tb&&!dc}SJ(){return 0}}Object(D.a)(mc,"CommentTaskScheduleEqualityComparer",
null,[160]);class ob{equals(tb,dc){if(!tb||!dc)return!tb&&!dc;if(!tb.extensions&&!dc.extensions)return!0;if(!tb.extensions||!dc.extensions||tb.extensions.count!==dc.extensions.count)return!1;let Yb=!0;tb.extensions.forEach((pb,Gb)=>{let hb;return({value:hb}=dc.extensions.Dc(pb)).returnValue&&Gb===hb?!0:Yb=!1});return Yb}SJ(){return 0}}Object(D.a)(ob,"ExtensionListEqualityComparer",null,[160]);class cb{X1k(tb,dc){return tb&&dc?tb.recordId===dc.recordId&&cb.jxg.equals(tb.user,dc.user)&&cb.jxg.equals(tb.assignee,
dc.assignee)&&tb.type===dc.type&&tb.title===dc.title&&tb.priority===dc.priority&&tb.isLossy===dc.isLossy&&tb.completion===dc.completion&&tb.commentId===dc.commentId&&tb.time===dc.time&&cb.zxj.equals(tb.schedule,dc.schedule):!tb&&!dc}equals(tb,dc){return this.X1k(tb,dc)}SJ(){return 0}}cb.jxg=new Vb;cb.zxj=new mc;new ob;Object(D.a)(cb,"HistoryRecordEqualityComparer",null,[160]);var db=d(1920),kb=d(1510);class Wb extends l.a{constructor(tb){super();this.yIa=tb}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.FKb),
5);tb.Z(v.a.yb(m.a.taskId),2);tb.Z(v.a.yb(m.a.n4n),2);tb.Z(v.a.yb(m.a.r4n),2);tb.Z(v.a.yb(m.a.Ava),1);return tb}x5f(tb){if(!tb.Um.value.hu&&!tb.Ng.value.hu){const dc=tb.Ng.value.Df.xG();dc.removeProperty(m.a.Ava);const Yb=tb.Ng.value.Df,pb=tb.Um.value.Df;tb.Ng=new a.a(()=>new kb.a(dc,Yb));tb.Um=new a.a(()=>new kb.a(dc,pb))}return super.x5f(tb)}SA(tb,dc){if(dc!==v.a.yb(m.a.Ava))return u.a.instance.Ya(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
tb.Ng.value.Df.id,dc),!1;const Yb=tb.Nk,pb=tb.Yd;u.a.instance.Ya(42754255,1,4,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Yb.id,Yb.Qc,dc);dc=pb.getPropertyString(tb.Ng.value.hu,m.a.Ava);const Gb=pb.getPropertyString(tb.Ng.value.Df,m.a.Ava),hb=pb.getPropertyString(tb.Um.value.Df,m.a.Ava);dc=this.RFm(dc,Gb,hb);if(!dc)return!1;0<dc.length?pb.setPropertyString(Yb,m.a.Ava,dc):Yb.removeProperty(m.a.Ava);tb.zg.add(v.a.yb(m.a.Ava));return!0}RFm(tb,
dc,Yb){tb=this.yIa.v_b(tb);dc=this.yIa.v_b(dc);Yb=this.yIa.v_b(Yb);if(!Wb.mei(tb,dc))return u.a.instance.Ya(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),null;if(!Wb.mei(tb,Yb))return u.a.instance.Ya(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),null;Yb=Wb.kyk(tb.length,dc,Yb);return this.yIa.DVf(Yb)}static nh(){const tb=new db.a;return new Wb(tb)}static get instance(){return Wb.Kg.value}static kyk(tb,dc,Yb){const pb=new H.a;for(let Gb=
0;Gb<dc.length;Gb++)pb.add(dc.J(Gb));for(;tb<Yb.length;tb++)pb.add(Yb.J(tb));return pb}static mei(tb,dc){const Yb=tb.length;if(Yb>dc.length)return!1;for(let pb=0;pb<Yb;pb++)if(!Wb.MEj.equals(dc.J(pb),tb.J(pb)))return dc.J(pb).recordId===tb.J(pb).recordId&&u.a.instance.Ya(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),!1;return!0}}Wb.Kg=new a.a(Wb.nh);Wb.MEj=new cb;Object(D.a)(Wb,"TaskSingleNodeComplexMerge",l.a,[]);class Fb extends l.a{constructor(){super()}get wn(){return 26}lk(){const tb=
super.lk();tb.Z(v.a.yb(w.a.rf),1);return tb}SA(tb,dc){const Yb=w.a.rf;if(dc===v.a.yb(Yb)){dc=tb.Nk;const Gb=tb.Yd;var pb=Gb.getPropertyObjectIds(tb.Ng.value.hu,Yb);const hb=Gb.getPropertyObjectIds(tb.Ng.value.Df,Yb),Ib=Gb.getPropertyObjectIds(tb.Um.value.Df,Yb);pb=this.YFm(pb,hb,Ib);Gb.setPropertyObjectIds(dc,Yb,pb);tb.zg.add(v.a.yb(Yb));return!0}return!1}YFm(tb,dc,Yb){return this.vCa(tb,dc,Yb)}static nh(){return new Fb}static get instance(){return Fb.Kg.value}}Fb.Kg=new a.a(Fb.nh);Object(D.a)(Fb,
"VectorClockContainerNodeComplexMerge",l.a,[]);class nc extends l.a{constructor(){super()}get wn(){return 27}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.OX),1);return tb}SA(tb,dc){const Yb=m.a.OX;if(dc===v.a.yb(Yb)){dc=tb.Nk;const pb=tb.Yd,Gb=pb.getPropertyUint32(tb.Ng.value.Df,Yb)||0,hb=pb.getPropertyUint32(tb.Um.value.Df,Yb)||0;pb.setPropertyUint32(dc,Yb,this.Owl(Gb,hb));tb.zg.add(v.a.yb(Yb));return!0}return!1}Owl(tb,dc){return tb>dc?tb:dc}static nh(){return new nc}static get instance(){return nc.Kg.value}}
nc.Kg=new a.a(nc.nh);Object(D.a)(nc,"VectorClockNodeComplexMerge",l.a,[]);class gc extends l.a{constructor(){super()}get wn(){return 28}get Az(){return 0}lk(){const tb=super.lk();tb.Z(v.a.yb(m.a.vzh),3);tb.Z(v.a.yb(m.a.Mc),3);tb.Z(v.a.yb(m.a.iXk),5);tb.Z(v.a.yb(m.a.ypi),5);tb.Z(v.a.yb(m.a.nga),5);return tb}static nh(){return new gc}static get instance(){return gc.Kg.value}}gc.Kg=new a.a(gc.nh);Object(D.a)(gc,"WordSectionNodeComplexMerge",l.a,[]);d.d(M,"a",function(){return Jc});class Jc{ksh(tb,dc){switch(tb.Qc){case 131073:return tb.hasProperty(m.a.imageType)||
tb.hasProperty(f.a.wZ)?this.Lo(ua.instance,dc):this.Lo(bc.instance,dc);case 1074135140:return this.Lo(r.instance,dc);case 1074135137:return this.Lo(B.instance,dc);case 1074135139:return this.Lo(G.instance,dc);case 1074135138:return this.Lo(F.instance,dc);case 1074135136:return this.Lo(I.instance,dc);case 1074135157:return this.Lo(R.instance,dc);case 1074135152:return this.Lo(C.instance,dc);case 1074135153:return this.Lo(P.instance,dc);case 1074135126:return this.Lo(W.instance,dc);case 1074135127:return this.Lo(X.instance,
dc);case 1074135145:return this.Lo(fa.instance,dc);case 1074135144:return this.Lo(V.instance,dc);case 1074135142:return this.Lo(sa.instance,dc);case 1074135143:return this.Lo(ia.instance,dc);case 1074135163:return this.Lo(ea.instance,dc);case 1074135164:return this.Lo(da.instance,dc);case 1074135124:return this.Lo(ja.instance,dc);case 1074135125:return this.Lo(Ga.instance,dc);case 1074135122:return this.Lo(ta.instance,dc);case 393233:return this.Lo(ua.instance,dc);case 1073872970:return this.Lo(ua.instance,
dc);case 1074135170:return this.Lo(Sa.instance,dc);case 1074135168:return this.Lo(ka.instance,dc);case 1074135166:return this.Lo(ha.instance,dc);case 1074135167:return this.Lo(Ca.instance,dc);case 1074135169:return this.Lo(Pa.instance,dc);case 1074135165:return this.Lo(Xa.instance,dc);case 393234:return this.Lo(Ia.instance,dc);case 393229:return this.Lo(Na.instance,dc);case 393241:return this.Lo(Oa.instance,dc);case 393227:return this.Lo(zb.instance,dc);case 131120:return this.Lo(yb.instance,dc);
case 393271:return this.Lo(Qa.instance,dc);case 393230:return this.Lo(lb.a.instance,dc);case 131140:return this.Lo(Pb.instance,dc);case 1179649:return this.Lo(oa.instance,dc);case 1073872969:return this.Lo(pa.instance,dc);case 393252:return this.Lo(nb.instance,dc);case 393250:return this.Lo(Bb.instance,dc);case 393251:return this.Lo(mb.instance,dc);case 1074135154:return this.Lo(Fb.instance,dc);case 1074135161:return this.Lo(Qb.instance,dc);case 1074135162:return this.Lo(Wb.instance,dc);case 1074135155:return this.Lo(nc.instance,
dc);case 1073872968:return this.Lo(gc.instance,dc);case 1074135172:return this.Lo(Ea.instance,dc);case 1074135171:return this.Lo(qa.instance,dc);case 1074135149:return this.Lo(ya.instance,dc);case 1074135151:return this.Lo(Va.instance,dc)}return this.Lo(l.a.instance,dc)}Lo(tb,dc){tb.Pb=dc?dc():null;return tb}}Object(D.a)(Jc,"GraphNodeComplexMergeFactory",null,[1792])},1827:function(D,M,d){d.r(M);D=d(0);var m=d(1487),f=d(79),a=d(282),l=d(72),r=d(1464);class w{constructor(H,J,L,I=0){this.S0h=H;this.groupType=
J;this.sif=I;this.YXc=L}}Object(D.a)(w,"SortingGroup",null,[]);class v{constructor(H,J,L,I){this.order=H;this.f6=J;this.vPl=L;this.groupType=I}}Object(D.a)(v,"SortingProp",null,[]);var u=d(1457),z=d(1460),B=d(1456),G=d(27);class F{constructor(H,J){this.vni={};this.uni={};this.qni=this.Bni=1;this.igh(H,J)}rYn(H,J,L){var I=B.a.tT(L)?this.vni:this.uni;L=new f.a;for(var R of J)J=Object(l.a)(v,I[m.a[R.groupType].toLowerCase()]),G.c(J)||L.add(new a.a(J,R));L.Sc((P,W)=>P.key.order<W.key.order?-1:1);Array.clear(H);
R=u.TellMeActor.instance.MY;for(J=0;J<L.count;){I=L.J(J).key.f6;var C=L.J(J).value;const P=new r.a(L.J(J).key.groupType);G.c(R)||R.Location===z.a.contextMenu||(P.displayName=L.J(J).key.vPl);for(const W of C.results)P.zy(W);for(C=++J;C<L.count&&L.J(C).key.f6===I;)this.nNe(P,L.J(C).value),C=++J;H.push(P)}}Ajo(H,J){this.qni=this.Bni=1;this.igh(H,J)}igh(H,J){this.T4i(H);for(var L=0;L<H.length;L++){let I=H[L];for(const R of I.YXc)this.q1j(R,L,I.S0h,I.groupType)}this.T4i(J);for(H=0;H<J.length;H++){L=J[H];
for(const I of L.YXc)this.p1j(I,H,L.S0h,L.groupType)}}T4i(H){H.sort((J,L)=>Object(l.a)(w,J).sif>Object(l.a)(w,L).sif?-1:1)}q1j(H,J,L,I){this.vni[m.a[H].toLowerCase()]=new v(this.Bni++,J,L,I)}p1j(H,J,L,I){this.uni[m.a[H].toLowerCase()]=new v(this.qni++,J,L,I)}nNe(H,J){for(let L=0;L<J.results.length;L++)H.zy(J.results[L])}}Object(D.a)(F,"BaseGroupingSorter",null,[]);class K{constructor(){this.SSd=[new w(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new w(CommonUIStrings.l_TellMeCommandProviderTitle,
7,[18,16,7]),new w(CommonUIStrings.l_TellMeSuggestionsProviderTitle,29,[15,14,19,3]),new w("",13,[13]),new w("",22,[22])];this.NSd=[new w(CommonUIStrings.l_TellMeCommandProviderTitle,27,[17,0,1,8,25]),new w(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,28,[2,19,23]),new w(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,29,[15,14,20,9,12,10,11,24]),new w("",13,[13]),new w("",22,[22])];this.bni=new F(this.SSd,this.NSd)}b0c(H,J,L,I=null,R=null){let C=!1;if(I){for(const P of B.a.tT(L)?
this.SSd:this.NSd)this.jdn(P,I);C=!0}if(R){for(const P of B.a.tT(L)?this.SSd:this.NSd)this.Bjo(J,P,R);C=!0}C&&this.bni.Ajo(this.SSd,this.NSd);this.bni.rYn(H,J,L)}jdn(H,J){const L=new f.a;for(var I of H.YXc){const R=J[m.a[I].toLowerCase()];L.add(new a.a(G.c(R)?Number.MAX_VALUE:R,I))}if(L.count){L.Sc((R,C)=>R.key<C.key?-1:1);J=Array(L.count);for(I=0;I<L.count;I++)J[I]=L.J(I).value;H.YXc=J}}Bjo(H,J,L){let I=0;for(const R of J.YXc)if(m.a[R].toLowerCase()in L&&L[m.a[R].toLowerCase()])for(const C of H)if(C.groupType===
R){I+=L[m.a[R].toLowerCase()];break}J.sif=I}}Object(D.a)(K,"SimplifiedGroupingSorter",null,[]);d.d(M,"GroupsPlacementInfo",function(){return N});class N{constructor(H){this.tni={};this.rni={};this.sni={};this.wni={};this.oxf={};this.xni=this.ABm=this.vBm=this.xBm=1;this.yni=null;this.aD=H;this.Glk();this.b4m();this.jlk();this.dkk();H.PQ&&(this.yni=new K)}GH(H){this.tni[m.a[H].toLowerCase()]=this.xBm++}aL(H,J){this.rni[m.a[H].toLowerCase()]=J}NIa(H){this.sni[m.a[H].toLowerCase()]=this.vBm++}f1(H){this.wni[m.a[H].toLowerCase()]=
this.ABm++}ND(H){this.oxf[m.a[H].toLowerCase()]=this.xni++}Glk(){const H=!!this.aD&&this.aD.d_a,J=!!this.aD&&this.aD.hTc,L=!!this.aD&&this.aD.egb,I=!!this.aD&&this.aD.Dsf&&!B.a.gDb(),R=!!this.aD&&this.aD.KOc,C=!!this.aD&&this.aD.hMc,P=!!this.aD&&this.aD.Oqf;this.GH(4);this.GH(18);this.GH(16);this.GH(7);this.GH(17);this.GH(0);this.GH(1);P&&this.GH(25);R&&this.GH(23);H||this.GH(2);H&&!J||this.GH(8);this.GH(15);L&&this.GH(20);this.GH(14);this.GH(9);this.GH(12);this.GH(10);this.GH(11);H&&this.GH(2);H&&
!J&&this.GH(8);this.GH(19);C&&this.GH(24);this.GH(21);this.GH(13);I&&this.GH(22)}b4m(){this.aL(21,1);this.aL(4,3);this.aL(18,3);this.aL(16,3);this.aL(7,3);this.aL(17,5);this.aL(0,5);this.aL(1,1);this.aL(25,2);this.aL(2,1);this.aL(8,2);this.aL(15,3);this.aL(14,2);this.aL(24,3);this.aL(9,1);this.aL(12,1);this.aL(10,1);this.aL(11,1);this.aL(19,1);this.aL(23,1);this.aL(13,1);this.aL(20,2);this.aL(22,1)}jlk(){this.NIa(4);this.NIa(0);this.NIa(17);this.NIa(7);this.NIa(16);this.NIa(18);this.NIa(15);this.NIa(20);
this.NIa(8);this.NIa(14)}dkk(){this.f1(14);this.f1(10);this.f1(12);this.f1(9);this.f1(11);this.f1(20);this.f1(15);this.f1(8);this.f1(2);this.f1(1);this.f1(24);this.f1(7);this.f1(18);this.f1(16);this.f1(17);this.f1(0);this.f1(4)}Oun(){this.oxf={};this.xni=1}wFl(H,J,L){this.Oun();const I=!!this.aD&&this.aD.d_a,R=!!this.aD&&this.aD.hTc,C=!!this.aD&&this.aD.egb,P=!!this.aD&&this.aD.Dsf&&!B.a.gDb(),W=!!this.aD&&this.aD.KOc,X=!!this.aD&&this.aD.hMc,V=!!this.aD&&this.aD.Oqf;H=H&&R;this.ND(4);this.ND(18);
this.ND(16);this.ND(7);this.ND(17);this.ND(0);this.ND(1);V&&this.ND(25);W&&this.ND(23);I&&!R||!H||this.ND(8);J&&this.ND(15);I||this.ND(2);X&&this.ND(24);L&&this.ND(14);I&&!R||H||this.ND(8);J||this.ND(15);C&&this.ND(20);L||this.ND(14);this.ND(9);this.ND(12);this.ND(10);this.ND(11);I&&this.ND(2);I&&!R&&this.ND(8);this.ND(19);this.ND(21);this.ND(13);P&&this.ND(22);return this.oxf}KN(){return this.aD}}Object(D.a)(N,"GroupsPlacementInfo",null,[])},1829:function(D,M,d){D=d(0);var m=d(1699),f=d(59);class a{constructor(){this.source=
0;this.Zl=this.bwa=this.x3=null;this.G2=0;this.q4b=!1;this.mode=this.uPa=0;this.fFc=null;this.SEb=f.a.create()}}Object(D.a)(a,"InputState",null,[]);class l{constructor(){this.timeout=this.succeeded=this.crash=!1;this.QL=null}}Object(D.a)(l,"OutputState",null,[]);class r{constructor(){this.H6h=this.V6d=this.w_c=!1;this.Pb=this.BTd=this.JIf=this.v1d=this.A2f=this.uwb=this.pJa=this.RF=this.qhb=this.xec=this.Wbo=this.d5k=this.Lm=this.w1e=this.kq=this.Vt=this.jk=this.Uae=this.$Ad=this.dza=null}}Object(D.a)(r,
"RuntimeState",null,[]);d.d(M,"a",function(){return w});class w{constructor(){this.input=new a;this.runtime=new r;this.output=new l;this.logger=new m.a(this)}}Object(D.a)(w,"MergeState",null,[])},1830:function(D,M,d){d.r(M);D=d(0);var m=d(609),f=d(216),a=d(150),l=d(120),r=d(1574),w=d(1653),v=d(1680),u=d(5),z=d(1821);class B{constructor(L,I){this.start=L;this.end=I}}Object(D.a)(B,"MergeDiffIdx",null,[]);class G{constructor(L,I,R,C=!1,P=null,W=null,X=!0){this.V8c=this.U8c=this.fAg=this.brc=0;this.vVb=
this.ihe=null;this.E6a=P||new z.a;this.Lg=R;this.Boa=L.p3();this.DXj=I.p3();this.AO=new B(0,0);this.hS=new B(0,0);this.$qe=C;this.moc=X;this.gpa=W;this.Bnk();this.TJn()}get FJ(){return this.Boa}get XI(){return this.DXj}get My(){return this.brc}get Cz(){return this.fAg}get Rra(){return this.U8c}get ika(){return this.V8c}get gUk(){const L=new f.a;for(let I=this.ihe.start;I<this.ihe.end;I++)L.add(this.FJ.mg(I));return L}get I2e(){const L=new f.a;for(let I=this.vVb.start;I<this.vVb.end;I++)L.add(this.XI.mg(I));
return L}N3e(L){if(this.Cz<L.Cz){if(this.Cz+this.Rra>L.Cz)return!0}else if(this.Cz>L.Cz){if(L.Cz+L.Rra>this.Cz)return!0}else if(2===this.My&&3===L.My||3===this.My&&2===L.My||2===this.My&&2===L.My||3===this.My&&3===L.My)return!0;return!1}vOi(L,I,R,C){L.eF(I);L.uA(I,R);return C+=R.length-1}p5i(L,I,R,C,P){let W=this.FJ.mg(L),X=this.XI.mg(I);if(!W||!X||!W.T2a&&!X.T2a)return{returnValue:!1,Iya:C,PEa:P};let V=new f.a,Y=new f.a;W.T2a&&(V=W.j0c(),W=V.mg(R?0:V.length-1));X.T2a&&(Y=X.j0c(),X=Y.mg(R?0:Y.length-
1));if(!W.Lz(X,this.E6a,this.gpa,this.$qe,this.moc))return{returnValue:!1,Iya:C,PEa:P};V.length&&(C=this.vOi(this.FJ,L,V,C));Y.length&&(P=this.vOi(this.XI,I,Y,P));return{returnValue:!0,Iya:C,PEa:P}}q7k(L,I,R,C,P,W){for(;P<=R&&W<=C;){const X=L.mg(P),V=I.mg(W);if(!X.Lz(V,this.E6a,this.gpa,this.$qe,this.moc))break;this.AO.start+=X.length;this.hS.start+=V.length;P++;W++}return{tRe:P,J6f:W}}o7k(L,I,R,C,P,W){for(;P>=R&&W>=C;){const X=L.mg(P),V=I.mg(W);if(!X.Lz(V,this.E6a,this.gpa,this.$qe,this.moc))return{returnValue:!0,
Iya:P,PEa:W};P--;W--}return{returnValue:!1,Iya:P,PEa:W}}p7k(L,I,R,C){let P=!1;do({tRe:L,J6f:I}=this.q7k(this.FJ,this.XI,R,C,L,I)),{Iya:R,PEa:C,returnValue:P}=this.p5i(L,I,!0,R,C);while(P);return{tRe:L,J6f:I,Iya:R,PEa:C}}n7k(L,I,R,C){let P=!1;do{if(!({Iya:R,PEa:C}=this.o7k(this.FJ,this.XI,L,I,R,C)).returnValue)break;({Iya:R,PEa:C,returnValue:P}=this.p5i(R,C,!1,R,C))}while(P);return{Iya:R,PEa:C}}Bnk(){var L=0,I=0,R=this.FJ.length-1,C=this.XI.length-1;0<=R&&this.FJ.mg(R);0<=C&&this.XI.mg(C);({tRe:L,
J6f:I,Iya:R,PEa:C}=this.p7k(L,I,R,C));if(L<R||I<C)({Iya:R,PEa:C}=this.n7k(L,I,R,C));R++;C++;this.ihe=new B(L,R);this.vVb=new B(I,C);this.AO.end=this.AO.start;this.hS.end=this.hS.start;for(var P=L;P<R;P++){var W=this.FJ.mg(P);this.AO.end+=W.length}for(P=I;P<C;P++)W=this.XI.mg(P),this.hS.end+=W.length;a.a.instance.Ya(3993809,1,4,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",L,R,I,C);a.a.instance.Ya(3993810,1,4,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",
this.AO.start,this.AO.end,this.hS.start,this.hS.end);this.AO.start<=this.AO.end&&this.hS.start<=this.hS.end&&(L=this.FJ.mg(L),I=this.XI.mg(I),P=this.FJ.mg(R),W=this.XI.mg(C),R=this.FJ.mg(R-1),C=this.XI.mg(C-1),a.a.instance.Ya(3993811,1,4,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",L,P,I,W,R,C))}TJn(){this.fAg=this.AO.start;this.U8c=this.V8c=0;this.AO.start===this.AO.end&&this.hS.start===
this.hS.end?this.brc=0:this.AO.start===this.AO.end&&this.hS.start<this.hS.end?(this.brc=1,this.V8c=this.hS.end-this.hS.start):this.hS.start===this.hS.end&&this.AO.start<this.AO.end?(this.brc=2,this.U8c=this.AO.end-this.AO.start):(this.brc=3,this.U8c=this.AO.end-this.AO.start,this.V8c=this.hS.end-this.hS.start);a.a.instance.Ya(3993814,1,4,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",this.My,this.Cz,this.Rra,this.ika)}mem(L,I){return L.z2()&&
I.z2()?L.runId===I.runId&&L.Cg===I.Cg:!1}mjm(L){if(!L.z2()||"\ufffc"!==L.text)return!1;L=L.azb;return L?L.hasProperty(u.a.Oj)||L.hasProperty(u.a.Rrd)||L.hasProperty(u.a.p4e)||L.hasProperty(u.a.U5)||L.hasProperty(u.a.imageType)||L.hasProperty(u.a.sMa)||L.hasProperty(u.a.lDb)||L.hasProperty(u.a.gq)&&(L=this.Lg.getPropertyInt32(L,u.a.gq))&&(36===L||35===L||24===L||23===L||33===L||34===L||44===L||45===L||42===L||43===L)?!0:!1:!1}CNc(L){return L.z2()&&!this.mjm(L)}hpk(){if(2===this.My)return!1;var L=this.vVb.start;
if(!L)return!1;let I=null;for(var R=this.vVb.start;R<this.vVb.end;R++){const C=this.XI.mg(R);if(this.CNc(C)){I=C;break}}if(!I)return!1;--L;for(R=this.XI.mg(L);R&&!this.CNc(R);)L--,R=this.XI.mg(L);return R&&this.mem(R,I)?!0:!1}TPh(L){const I=new f.a;for(let R=0;R<L.length;R++)L.J(R).T2a?I.uA(I.length,L.J(R).j0c()):I.insert(I.length,L.J(R));return I}oem(){if(3!==this.My||this.Rra!==this.ika)return!1;const L=this.TPh(this.gUk),I=this.TPh(this.I2e);if(L.length!==I.length)return!1;for(let R=0;R<L.length;R++)if(!L.J(R).Lz(I.J(R),
this.E6a,this.gpa,!0,this.moc))return!1;return!0}nem(){if(0!==this.My&&3!==this.My||this.FJ.length!==this.XI.length)return!1;let L=!1;for(let I=0;I<this.FJ.length;I++){if(!this.FJ.J(I).Lz(this.XI.J(I),this.E6a,this.gpa,!0,this.moc))return!1;if(3===this.FJ.J(I).type||1===this.FJ.J(I).type){const R=this.FJ.J(I),C=this.XI.J(I);L=R.runId!==C.runId||R.Cg!==C.Cg||L}}return L}}Object(D.a)(G,"MergeBlockDiff",null,[]);var F=d(1537);class K{constructor(L,I){this.id=L;this.index=I}}Object(D.a)(K,"ParagraphStartIndex",
null,[]);var N=d(1584),H=d(1523);d.d(M,"ParagraphMerge",function(){return J});class J{constructor(L,I,R,C,P,W,X){this.wTb=this.Jrb=this.Ao=this.Aw=null;this.zh=!1;this.G2g=this.wCg=this.jug=this.Eqa=this.vGa=this.Boa=null;this.ee=L;this.sE=I;this.eya=C;this.Uwa=R;this.fpa=P;this.gpa=W;this.Lg=X}nWh(L){const I=new m.a;L.FJ.forEach(R=>{2===R.type&&I.add(R.Bj);return!0});L.XI.forEach(R=>{2===R.type&&I.remove(R.Bj);return!0});return I}RSh(L){const I=new f.a;L.XI.forEach(R=>{2===R.type&&I.add(R.Bj);return!0});
return I}moh(L){const I=new f.a;let R=0,C=0;L.XI.forEach(P=>{2===P.type&&(I.add(new K(P.Bj,R<L.Cz?R:R<L.Cz+L.ika?L.Cz:R-L.ika+L.Rra)),R=C);C+=P.length;return!0});return I}qAk(L,I){var R=this.moh(L);const C=this.moh(I);L=this.nWh(L);const P=this.nWh(I);I=new f.a;const W=new m.a;let X=0;for(let V=0;V<R.length;V++){const Y=R.J(V);if(X<C.length){let ca=C.J(X);for(;X<C.length&&ca.index<=Y.index;){if(ca.id.equals(Y.id)){X++;break}L.contains(ca.id)||W.contains(ca.id)||(I.add(ca.id),W.add(ca.id));X++;ca=
C.J(X)}}P.contains(Y.id)||(I.add(Y.id),W.add(Y.id))}for(;X<C.length;)R=C.J(X),L.contains(R.id)||W.contains(R.id)||(I.add(R.id),W.add(R.id)),X++;return I}initialize(){if(this.zh){const L=!!this.Aw&&!!this.Ao;this.ee.logger.Pg(Object.assign(new F.a,{kj:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return L}this.zh=!0;if(!({FJ:this.Boa,eFc:this.vGa,s2c:this.Eqa,Grd:this.jug,aBd:this.wCg,Vae:this.G2g}=H.a.Hsh(this.ee,this.Lg,this.sE,this.Uwa,this.eya,this.fpa,!1,!1)).returnValue)return!1;
this.Aw=new G(this.Boa,this.vGa,this.Lg,void 0,void 0,this.gpa);this.Ao=new G(this.Boa,this.Eqa,this.Lg,void 0,void 0,this.gpa);a.a.instance.Ya(593272919,1,4,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",this.Aw.Rra,this.Aw.ika,this.Ao.Rra,this.Ao.ika));return!0}EEa(){a.a.instance.Ya(593826836,1,4,"Attempting to merge with LCS");let L=!1;const I=new v.a(this.Lg,this.ee);let R=null,C=null;var P=null;const W=V=>this.ee.runtime.jk.J(V),
X=V=>this.ee.runtime.kq.J(V)||this.ee.runtime.jk.J(V);this.Aw=new G(this.Boa,this.vGa,this.Lg,void 0,void 0,this.gpa,!1);this.Ao=new G(this.Boa,this.Eqa,this.Lg,void 0,void 0,this.gpa,!1);({updateHints:R}=I.luh(this.sE,W,this.Uwa,V=>this.ee.runtime.Vt.J(V)||this.ee.runtime.jk.J(V),this.Aw.Cz,this.Aw.Cz+this.Aw.Rra,this.Aw.Cz+this.Aw.ika)).returnValue&&({updateHints:C}=I.luh(this.sE,W,this.eya,X,this.Ao.Cz,this.Ao.Cz+this.Ao.Rra,this.Ao.Cz+this.Ao.ika)).returnValue&&(L=!0);L||(a.a.instance.Ya(593826835,
1,2,"Failed to create update hints with LCS"),L=!1);L&&(P=new N.a(this.ee,this.sE,this.Uwa,this.eya,V=>this.ee.runtime.Pb?this.ee.runtime.Pb.isFeatureEnabled(V):!1,this.Lg,null,R,C),({Lm:P}=P.mgc()).returnValue||(a.a.instance.Ya(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),this.ee.logger.Pg(Object.assign(new F.a,{kj:"TryLCSMerge",eventId:"9zrqs"})),L=!1));a.a.instance.Ya(593826833,1,L?4:2,"TryLCSMerge: [Success: {0}]",L);return{returnValue:L,Lm:P}}mgc(){let L;L=null;if(!this.initialize())return this.ee.logger.MT("ParagraphMerge Initialize"),
this.F_a(),{returnValue:!1,Lm:L};this.ee.logger.MT("ParagraphMerge Initialize");let I;this.ee.logger.N5d(2);let R=({EEa:I}=this.JWk()).returnValue;R=R&&({Lm:L,EEa:I}=this.WHc(this.ee,this.Lg,this.fpa,this.wTb,this.Jrb)).returnValue;this.ee.logger.dXf();if(!R){this.ee.logger.MT("ParagraphMerge DoMergeInteral");if(I){this.ee.logger.N5d(3);({Lm:L,returnValue:R}=this.EEa());this.ee.logger.dXf();if(R)return{returnValue:!0,Lm:L};this.F_a();return{returnValue:!1,Lm:L}}this.F_a();return{returnValue:!1,Lm:L}}if(!({Lm:L,
EEa:I}=this.WHc(this.ee,this.Lg,this.fpa,this.wTb,this.Jrb)).returnValue)return this.ee.logger.MT("ParagraphMerge DoMergeInteral"),this.F_a(),{returnValue:!1,Lm:L};this.ee.logger.MT("ParagraphMerge DoMergeInteral");return{returnValue:!0,Lm:L}}WHc(){let L;if(!({ZYd:L}=H.a.WHc(this.ee,this.Lg,this.fpa,this.wTb,this.Jrb)).returnValue)return this.ee.logger.MT("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),this.F_a(),{returnValue:!1,Lm:L,EEa:!0};this.ee.logger.MT("ParagraphMerge GetMergeableObjectsFromMergeBlocks");
return{returnValue:!0,Lm:L,EEa:!1}}F_a(L=!1){a.a.instance.Xga(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+L+"] BaseRevisionMergeBlocksList: {0}",this.jug);a.a.instance.Xga(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",this.wCg);a.a.instance.Xga(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.G2g);L=new f.a;H.a.s8b(this.Lg,"BaseObjects_",this.sE,L);H.a.s8b(this.Lg,"FavoredObjects_",this.Uwa,L);H.a.s8b(this.Lg,"ConflictObjects_",this.eya,L);H.a.gvm(this.ee,L)}Bhh(L){let I,R;R=I=0;
if(0===this.Aw.My)I=this.Ao.Cz;else if(1===this.Aw.My)I=this.Ao.Cz<this.Aw.Cz?this.Ao.Cz:this.Ao.Cz===this.Aw.Cz?L||1!==this.Ao.My?this.Ao.Cz+this.Aw.ika:this.Ao.Cz:this.Ao.Cz+this.Aw.ika;else if(2===this.Aw.My||3===this.Aw.My)I=this.Ao.Cz<=this.Aw.Cz?this.Ao.Cz:this.Ao.Cz+(this.Aw.ika-this.Aw.Rra);if(2===this.Ao.My||3===this.Ao.My)R=I+this.Ao.Rra;return{B0h:I,ROl:R}}jGh(L,I){let R;R=0;if(!I)return{returnValue:!0,VRc:R};let C=0,P=0;for(;C<L.length;){let W;for(let X=C;X<L.length;X++){C=X;W=L.J(X);
const V=W.length;P+=V;if(!(P<I)){if(P>I)if(W.T2a)L.eF(C),L.uA(C,W.j0c()),P-=V;else return a.a.instance.Ya(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",I),this.ee.logger.Pg(Object.assign(new F.a,{kj:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,VRc:R};break}}if(P===I)return C++,R=C,{returnValue:!0,VRc:R}}a.a.instance.Ya(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",
I);this.ee.logger.Pg(Object.assign(new F.a,{kj:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,VRc:R}}zck(L,I,R){let C=0;var P=0,W=!1;const X=this.Ao.I2e.p3();if(this.Ao.hpk())for(--I;0<=I;I--){let V=L.J(I);if(this.Ao.CNc(V)){P=L.J(I);C=P.runId;P=P.Cg;W=!0;break}}W||((P=L.J(R))&&this.Ao.CNc(P)?(C=P.runId,P=P.Cg):P=C=0);for(L=0;L<X.length;L++)R=X.J(L),R.z2()&&(W=R,this.Ao.CNc(R)?(W.runId=C,W.Cg=P):(W.runId=0,W.Cg=0));return X}Ddi(L){if(2===L.length){const I=1===L.J(0).type?L.J(0):
null;L=2===L.J(1).type;if(I&&L&&""===I.text)return!0}return!1}JWk(){const L=this.Aw.nem();if(!L&&0===this.Aw.My)return this.wTb=this.Ao.XI.p3(),this.Jrb=this.RSh(this.Ao),{returnValue:!0,EEa:!1};if(0===this.Ao.My)return this.wTb=this.Aw.XI.p3(),this.Jrb=this.RSh(this.Aw),{returnValue:!0,EEa:!1};(this.Ddi(this.Aw.XI)||this.Ddi(this.Ao.XI))&&this.ee.logger.vki(Object.assign(new F.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!L){var I=this.Aw.N3e(this.Ao);I&&this.fpa(58)&&(a.a.instance.Ya(17326359,
1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.Aw=new G(this.Boa,this.vGa,this.Lg,!0,void 0,this.gpa),this.Ao=new G(this.Boa,this.Eqa,this.Lg,!0,void 0,this.gpa),I=this.Aw.N3e(this.Ao));if(I)return a.a.instance.Ya(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),this.ee.logger.Pg(Object.assign(new w.a,{kj:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,
EEa:!0}}var R;I=0;this.Jrb=this.qAk(this.Aw,this.Ao);({B0h:R,ROl:P}=this.Bhh(!1));const C=this.Aw.XI.p3();if(!({VRc:R}=this.jGh(C,R)).returnValue||(2===this.Ao.My||3===this.Ao.My)&&!({VRc:I}=this.jGh(C,P)).returnValue)return{returnValue:!1,EEa:!1};if(2===this.Ao.My||3===this.Ao.My){this.bdc(C,I);this.bdc(C,R-1);var P=null;for(var W=I-1;W>=R;W--)2===C.J(W).type&&(P=C.J(W)),C.eF(W);0<C.length&&(W=C.J(C.length-1),2!==W.type&&4!==W.type&&P&&(this.ee.runtime.Pb.Uq(81),this.ee.runtime.Pb.isFeatureEnabled(81)&&
(C.add(P),this.Jrb.add(P.Bj))));a.a.instance.Ya(4019726,1,4,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",I-R-1,R)}if(1===this.Ao.My||3===this.Ao.My)P=this.Ao.I2e,L&&(P=this.zck(C,R,I)),this.bdc(C,R-1),this.bdc(C,R),this.bdc(P,0),this.bdc(P,P.length-1),C.uA(R,P),a.a.instance.Ya(4019727,1,4,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",R,L,P.Cq());this.wTb=C;return{returnValue:!0,EEa:!1}}bdc(L,I){0>I||I>=L.length||(L=L.J(I),
Object(l.a)(r.a,L)&&(L.kMa=!0))}C2c(L,I){let R;R=I;if(!this.initialize())return{returnValue:!1,G1a:L,ona:R};if(this.Ao.N3e(this.Aw))return this.F_a(!0),this.ee.logger.Pg(Object.assign(new w.a,{kj:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,G1a:L,ona:R};if(0===this.Ao.My||3===this.Ao.My&&this.Ao.oem())return{returnValue:!0,G1a:L,ona:I};let C;({B0h:C}=this.Bhh(!0));I<C||I===C&&(1!==this.Ao.My||1===this.Ao.My&&1===this.Aw.My&&I===this.Aw.Cz+this.Aw.ika)?R=I:(R=I+this.Ao.ika-this.Ao.Rra,R<
C&&(R=C));return{returnValue:!0,G1a:L,ona:R}}}Object(D.a)(J,"ParagraphMerge",null,[1791])},1831:function(D,M,d){d.r(M);D=d(0);var m=d(1590),f=d(1507),a=d(1487),l=d(1701),r=d(1506);class w{constructor(N="",H="",J="",L=-99999,I=-1,R=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=N?N:"";this.Description=H?H:"";this.Type=J?J:"";this.Score=L;this.Age=I;this.Count=R}}Object(D.a)(w,"Suggestion",null,[]);class v{constructor(N,H){this.GroupType=this.Suggestions=null;
this.Suggestions=N;this.GroupType=H}}Object(D.a)(v,"SuggestionGroup",null,[]);class u{}u.help="help";u.answer="answer";u.commands="commands";u.BEn="servicecommands";u.template="template";Object(D.a)(u,"SuggestionGroupType",null,[]);var z=d(1457),B=d(1456),G=d(2),F=d(35);d.d(M,"InteractionLogger",function(){return K});class K{constructor(N,H,J){this.Jme=0;this.kIe=this.bqc=null;this.ke=N;this.pGe=this.Zje=this.wre=!1;this.yyj=H;this.hg=G.AFrameworkApplication.Ze;this.jc=J;this.q8c=this.UAe=0}get ina(){return this.ke.ina}V5d(N){this.ke.V5d(N)}Mli(){if(this.bqc){var N=
0;for(const H of this.bqc)this.ke.Rym(H,N++);this.bqc=null}}beginQuery(N,H,J){this.ke.Gym(N,H,J)}Ohb(N,H){this.ke.fgk(N,H);this.wre=!0;this.pGe=!1}mua(){this.wre=!1;this.Zje||(this.Mli(),this.ke.VBh(this.Jme))}Hym(N,H){this.ke.Iym(N,H)}rOm(N,H,J,L,I){for(const R of this.yyj)if(N.startsWith(R)){this.pGe=!0;break}this.ke.uum(N,H,J,L,I)}ZOm(N){this.Zje=!1;this.Jme=N;this.wre||this.pGe||(this.Mli(),this.ke.VBh(this.Jme,!1))}YOm(N,H){this.ke.Aum(N,H);this.Zje=!0}c$e(N,H){if(!N.count)return"";let J="";
const L=Date.now();for(let I of N)N=(L-I.timeStamp)/1E3,N=B.a.h5f(N),0<J.length&&(J+=";"),J+=H?I.commandId:I.controlId,J+=":",J+=N.toString();return J}o0a(){var N=this.c$e(m.a.instance.N1b(),!1);0<N.length&&this.ke.rum(N);N=this.c$e(m.a.instance.Fcb(),!0);0<N.length&&this.ke.Ltm(N);N=this.c$e(m.a.instance.Rmc,!0);0<N.length&&this.ke.uvm(N);N=z.TellMeActor.instance.SPg;0<N.length&&this.ke.Eym(F.c(N))}lzm(N){this.ke.Xtm(N)}nX(N,H,J,L,I,R,C,P=null){this.ke.Awm(N,H,J,L,I,R,C,P)}swf(N,H,J,L){this.ke.swf(N,
H,J,L)}DA(N,H,J=null){this.ke.daa(N,H,J)}onError(N,H,J=null){this.ke.E_a(N,H,J)}iJn(N){this.bqc=N}BIl(N){const H=[];if(!N)return H;for(let J=0;J<N.length;J++){const L=a.a[N[J].groupType].toLowerCase(),I=[],R=N[J].results;if(R){for(let C=0;C<R.length;C++)"findindocument"===L?Array.add(I,new w("","",L,R[C].score,R[C].xqd,R[C].count)):Array.add(I,new w(R[C].label,R[C].description,L,R[C].score,R[C].xqd,R[C].count));"answer"===L||"definition"===L||"wolframanswer"===L||"entity"===L?Array.add(H,new v(I,
u.answer)):"classifier"===L||"appsforoffice"===L?Array.add(H,new v(I,u.commands)):"serviceclassifier"===L?Array.add(H,new v(I,u.BEn)):"assistance"===L?Array.add(H,new v(I,u.help)):("document"===L||"people"===L||"findindocument"===L||"notes"===L||"image"===L||"template"===L)&&Array.add(H,new v(I,L))}}return H}Dgf(N,H){const J={};J.Query=H;J.SuggestionGroups=F.c(this.BIl(N));return F.c(J)}dZh(N){const H={"Content-Type":"application/json",Accept:"application/json"};H["X-Office-Version"]=G.AFrameworkApplication.buildVersion;
H["X-Office-Application"]=G.AFrameworkApplication.K.lb("Application");H["X-Office-Platform"]="WAC";H["X-TellMe-SqmUserId"]=G.AFrameworkApplication.K.lb("LoggableUserId")||"";H["X-TellMe-SessionId"]=this.ke.ina.yla;H["X-TellMe-SuggestionTypes"]="Ranker";H["X-TellMe-Culture"]=G.AFrameworkApplication.uiCulture;H["X-TellMe-ProcessSessionId"]=G.AFrameworkApplication.userSessionId;H["X-TellMe-Flights"]=N;H["X-TellMe-PartialQueryIndex"]=this.UAe;return H}w0a(N,H,J){this.nX(H.length,"RankerLogging",N.data.mf.toString(),
Math.round(window.performance.now()-J),r.a.o9i,!0,f.a.Rsa)}m0a(N,H,J){this.nX(H.length,"RankerLogging",N.data.mf.toString(),Math.round(window.performance.now()-J),r.a.o9i,!1,f.a.Rsa)}eZh(){this.kIe||(this.kIe=new l.a(this.jc,null,6E3));return this.kIe.U7}uwf(N){const H=this.Dgf(this.bqc,N),J=this.dZh("RankerLogging"),L=window.performance.now();this.hg.Lj(this.eZh(),2,H,J,!1,0,I=>{this.w0a(I,N,L)},I=>{this.m0a(I,N,L)},null,null,!1,4E3,6E3);this.UAe++}Eun(){this.UAe=0}mWf(N){this.q8c=N}}Object(D.a)(K,
"InteractionLogger",null,[])},1832:function(D,M,d){d.r(M);D=d(0);var m=d(17),f=d(5),a=d(150),l=d(216),r=d(59),w=d(1645),v=d(1573),u=d(1535),z=d(1523);class B{constructor(N,H,J=null){this.author=N;this.mRc=H;this.sLf=J||r.a.nil}Lz(N){return N?this.author===N.author&&this.mRc===N.mRc&&this.sLf===N.sLf:!1}}Object(D.a)(B,"RunMergeBlockTrackedChangeAttribute",null,[]);class G{constructor(N,H,J){this.insertion=N||G.U4e;this.deletion=H||G.U4e;this.eDa=J||G.U4e}get oUl(){return 0<this.insertion.author.length}get RTl(){return 0<
this.deletion.author.length}get OUl(){return 0<this.eDa.author.length}Lz(N){return N?this.insertion.Lz(N.insertion)&&this.deletion.Lz(N.deletion)&&this.eDa.Lz(N.eDa):!1}}G.U4e=new B("",0);Object(D.a)(G,"RunMergeBlockTrackedChangeInfo",null,[]);var F=d(1698);d.d(M,"ParagraphMergeBlockCreator",function(){return K});class K extends v.a{constructor(N,H,J,L,I,R,C){super();this.maxValue=Number.MAX_VALUE;this.dA=new w.a;this.FNb=null;this.YM=0;this.dJg=!1;this.$qc="";this.cge=N;this.ns=H;this.Lt=J;this.iUj=
L;this.R$c=I;this.mIg=R;this.Lg=C;if(this.Lg.hasProperty(this.ns,m.a.lo))if(this.Lg.hasProperty(this.ns,f.a.Mc))if(this.Lg.hasProperty(this.ns,f.a.Fq))if(this.Lg.hasProperty(this.ns,f.a.Zs))if(this.Lg.hasProperty(this.ns,m.a.Un))if(this.O0=this.Lg.getPropertyString(this.ns,m.a.lo),this.sLe=this.Lg.getPropertyUint32(this.ns,f.a.Mc),this.Gr=this.Lg.getPropertyUint32s(this.ns,f.a.Fq),this.Vgd=this.Lg.getPropertyUint32s(this.ns,f.a.Zs),this.Poe=this.Lg.getPropertyObjectIds(this.ns,m.a.Un),this.O0||""===
this.O0)if(this.O0.length||1!==this.Poe.length||(this.Gr.length||(this.Gr.add(0),a.a.instance.Ya(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),this.Vgd.length||(this.Vgd.add(0),a.a.instance.Ya(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),this.HLj=this.iDd(this.ns,f.a.qCf,this.Gr.length),this.Psc=this.iDd(this.ns,m.a.cua,this.Gr.length),this.Nia=this.iDd(this.ns,m.a.Dkb,this.Gr.length),this.cia=
this.iDd(this.ns,f.a.pLa,this.Gr.length),this.zia=this.KLl(this.ns,f.a.gDa,this.Gr.length),this.f0l(),N=this.Lg.hasProperty(this.ns,m.a.zm)?this.Lg.getPropertyUint32s(this.ns,m.a.zm):new l.a,this.Rjd=z.a.eZi(N,this.O0.length),this.Gr.length!==this.Vgd.length)a.a.instance.Ya(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",H.id);else if(this.Gr.length!==this.Poe.length)a.a.instance.Ya(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",
H.id);else{this.mIg&&(this.Lg.hasProperty(this.ns,f.a.Su)?this.FNb=this.Lg.getPropertyObjectIds(this.ns,f.a.Su):(a.a.instance.Ya(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",H.id),this.FNb=this.dZ(this.Gr.length,r.a.nil)),this.Gr.length!==this.FNb.length&&(a.a.instance.Ya(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",H.id,this.Gr.length,this.FNb.length),this.FNb=this.dZ(this.Gr.length,
r.a.nil)));if(this.Gr.length!==this.Psc.length||this.Gr.length!==this.Nia.length||this.Gr.length!==this.cia.length||this.Gr.length!==this.zia.length)this.Gr.length===this.Psc.length||this.R$c||a.a.instance.Ya(8266445,1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",H.id,this.Gr.length,this.Psc.length),this.Gr.length===this.Nia.length||this.R$c||a.a.instance.Ya(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",
H.id,this.Gr.length,this.Nia.length),this.Gr.length===this.cia.length||this.R$c||a.a.instance.Ya(20742792,1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",H.id,this.Gr.length,this.cia.length),this.Gr.length===this.zia.length||this.R$c||a.a.instance.Ya(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",
H.id,this.Gr.length,this.zia.length),N=this.Lg.getPropertyBool(this.ns,m.a.JXe),a.a.instance.Ya(17877020,1,4,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",H.id,I,null==N?!1:N),this.Psc=this.dZ(this.Gr.length,!0),this.Nia=this.dZ(this.Gr.length,!1),this.cia=this.dZ(this.Gr.length,!1),this.zia=this.dZ(this.Gr.length,0),this.Lg.setPropertyBool(this.ns,m.a.JXe,!1);this.dA.tno(this.Gr.length)?(this.Rjd.length!==this.Gr.length+1&&a.a.instance.Ya(3993801,
1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",H.id,this.Gr.length,this.Rjd.length),this.MIj=!0):a.a.instance.Ya(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",H.id)}else a.a.instance.Ya(4322133,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",H.id);else a.a.instance.Ya(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",
H.id);else a.a.instance.Ya(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",H.id);else a.a.instance.Ya(3993796,1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",H.id);else a.a.instance.Ya(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",H.id);else a.a.instance.Ya(3993794,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",H.id)}f0l(){this.Lg.hasProperty(this.ns,f.a.yBa)?this.dA.Yeb=this.Lg.getPropertyBools(this.ns,f.a.yBa):
this.dA.Yeb=this.dZ(this.Gr.length,!1);this.Lg.hasProperty(this.ns,f.a.Mda)?this.dA.kbb=this.Lg.getPropertyBools(this.ns,f.a.Mda):this.dA.kbb=this.dZ(this.Gr.length,!1);this.Lg.hasProperty(this.ns,f.a.zBa)?this.dA.Xeb=this.Lg.getPropertyStrings(this.ns,f.a.zBa):this.dA.Xeb=this.dZ(this.Gr.length,"");this.Lg.hasProperty(this.ns,f.a.Oza)?this.dA.jbb=this.Lg.getPropertyStrings(this.ns,f.a.Oza):this.dA.jbb=this.dZ(this.Gr.length,"");this.Lg.hasProperty(this.ns,f.a.ABa)?this.dA.Zeb=this.Lg.getPropertyListOfMilliseconds(this.ns,
f.a.ABa):this.dA.Zeb=this.dZ(this.Gr.length,0);this.Lg.hasProperty(this.ns,f.a.Pza)?this.dA.yWa=this.Lg.getPropertyListOfMilliseconds(this.ns,f.a.Pza):this.dA.yWa=this.dZ(this.Gr.length,0);this.Lg.hasProperty(this.ns,f.a.fDa)?this.dA.V0a=this.Lg.getPropertyBools(this.ns,f.a.fDa):this.dA.V0a=this.dZ(this.Gr.length,!1);this.Lg.hasProperty(this.ns,f.a.zEa)?this.dA.Cib=this.Lg.getPropertyStrings(this.ns,f.a.zEa):this.dA.Cib=this.dZ(this.Gr.length,"");this.Lg.hasProperty(this.ns,f.a.AEa)?this.dA.Eib=this.Lg.getPropertyListOfMilliseconds(this.ns,
f.a.AEa):this.dA.Eib=this.dZ(this.Gr.length,0);this.Lg.hasProperty(this.ns,f.a.Hva)?this.dA.Dib=this.Lg.getPropertyObjectIds(this.ns,f.a.Hva):this.dA.Dib=this.dZ(this.Gr.length,r.a.nil)}iDd(N,H,J){return this.Lg.hasProperty(N,H)?this.Lg.getPropertyBools(N,H):this.dZ(J,!1)}KLl(N,H,J){return this.Lg.hasProperty(N,H)?this.Lg.getPropertyUint32s(N,H):this.dZ(J,0)}dZ(N,H){const J=new l.a;for(let L=0;L<N;L++)J.add(H);return J}cKl(N){const H=this.Rjd.mg(N);N=this.Rjd.mg(N+1);return this.O0.substring(H,N)}eTh(){if(this.dJg)return null;
var N=this.YM<this.Gr.length?this.Gr.mg(this.YM):this.maxValue;if(N===this.maxValue||this.iUj&&!this.O0.length)return this.dJg=!0,N=new u.a(this.Lt,this.ns.id,this.sLe),this.$qc=this.yPe(this.$qc,N.toString()),N;const H=this.Vgd.mg(this.YM),J=this.Poe.mg(this.YM),L=this.HLj.mg(this.YM),I=this.Psc.mg(this.YM),R=this.Nia.mg(this.YM),C=this.cia.mg(this.YM),P=this.zia.mg(this.YM),W=this.mIg?this.FNb.mg(this.YM):null;var X=null;this.dA.Yeb.mg(this.YM)&&(X=new B(this.dA.Xeb.mg(this.YM)||"",this.dA.Zeb.mg(this.YM)));
var V=null;this.dA.kbb.mg(this.YM)&&(V=new B(this.dA.jbb.mg(this.YM)||"",this.dA.yWa.mg(this.YM)));var Y=null;this.dA.V0a.mg(this.YM)&&(Y=new B(this.dA.Cib.mg(this.YM)||"",this.dA.Eib.mg(this.YM),this.dA.Dib.mg(this.YM)));X=new G(X,V,Y);V=this.cKl(this.YM);this.YM++;Y=V.startsWith("\ufddfHYPERLINK ");N=new F.a(this.cge,this.Lt,this.ns.id,H,N,J,V,L,!Y,I,R,C,P,X,W);this.$qc=this.yPe(this.$qc,N.toString());return N}PSh(){let N;N=null;var H="";if(!this.MIj)return{tyf:N,R_a:H};if(H=this.eTh())N=new l.a,
N.add(H);for(;H=this.eTh();)N.add(H);H=this.$qc;return{tyf:N,R_a:H}}}Object(D.a)(K,"ParagraphMergeBlockCreator",v.a,[])},1835:function(D,M,d){d.r(M);D=d(0);var m=d(216),f=d(1573),a=d(1534);class l extends a.a{constructor(w,v){super(4,w,v)}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Bj)}B1b(){return"Table"}clone(){return new l(this.source,this.Bj)}Lz(w,v,u,z=!1){return super.Lz(w,v,u,z)?this.Bj.equals(w.Bj):!1}get length(){return 1}}Object(D.a)(l,"TableMergeBlock",
a.a,[]);d.d(M,"TableMergeBlockCreator",function(){return r});class r extends f.a{constructor(w,v){super();this.sug=new l(v,w.id)}PSh(){let w;w=new m.a;w.add(this.sug);return{tyf:w,R_a:this.yPe("",this.sug.toString())}}}Object(D.a)(r,"TableMergeBlockCreator",f.a,[])},1912:function(D,M,d){d.r(M);var m=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},
children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},f=d(0),a=d(43),l=d(67);class r extends Sys.EventArgs{constructor(Q,wa){super();this.t$d=Q;this.actualValue=wa}}Object(f.a)(r,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var w=d(31);class v{constructor(){this.eOb=[];this.hyg=this.pke=0;this.Ih=null;this.sa=new l.a}init(Q,wa,eb){this.Ih=Q;this.pke=wa;this.hyg=eb;this.Ih.fqd(Object(a.a)(this,this.GFb,"onCpuMeterFrameAvailable"));
this.R5j(Object(a.a)(this,this.gFk,"cpuPercentThresholdExceeded"))}GFb(Q,wa){wa.IRc&&(Array.enqueue(this.eOb,wa.IRc.CP),this.eOb.length>this.hyg&&(Array.dequeue(this.eOb),this.Srk()))}Srk(){var Q=this.eOb.length;let wa=0;for(let eb=0;eb<Q;eb++){const Lb=Array.dequeue(this.eOb);wa+=Lb;Array.enqueue(this.eOb,Lb)}Q=wa/Q;Q>this.pke&&this.sa.raiseEvent("CPTTE",new r(this.pke,Q))}gFk(Q,wa){w.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.rwd(wa.t$d,wa.actualValue))}R5j(Q){this.sa.addHandler("CPTTE",
Q)}rwd(Q,wa){const eb={};eb.ThresholdValue=Q;eb.ActualValue=wa;return eb}}Object(f.a)(v,"CpuMeterMonitor",null,[1840]);var u=d(430);class z{constructor(){this.S=this.T=this.M=this.C=0}}Object(f.a)(z,"ProfileInformation",null,[]);var B=d(7),G=d(28),F=d(205),K=d(81);class N{constructor(Q=0,wa=0){this.Gpb=!1;this.bpb={};this.Hed=Q;this.Zed=wa;this.WJe=0;G.a.addHandler(window.self,B.a.h$g,()=>{this.Gpb=!0});G.a.addHandler(window.self,B.a.i$g,()=>{this.Gpb=!1})}k$g(Q,wa,eb){const Lb=N.generateKey(wa,eb);
Lb in this.bpb?wa=this.bpb[Lb]:(wa=new z,wa.S=eb?1:0,this.bpb[Lb]=wa,this.WJe++);wa.C++;wa.M=Q>wa.M?Q:wa.M;wa.T+=Q}zya(Q,wa){this.k$g(Q,wa,!1);this.Gpb&&this.k$g(Q,wa,!0)}getData(){if(0<this.Zed&&this.WJe>this.Zed)return this.jml();const Q=0<this.Hed,wa={},eb=this.bpb;for(let ec in eb){var Lb=ec;const Tc=eb[ec];this.SRi(Tc);Q&&Tc.T>=this.Hed&&(wa[Lb]=Tc)}return Q?K.a.nf(wa)?null:wa:this.bpb}jml(){var Q=0<this.Hed,wa=[];const eb=this.bpb;for(let Lb in eb){const ec={key:Lb,value:eb[Lb]};let Tc=ec.value;
(!Q||Tc.T>=this.Hed)&&Array.add(wa,ec)}if(wa.length>this.Zed)wa.sort((Lb,ec)=>ec.value.T-Lb.value.T),wa=wa.slice(0,this.Zed);else if(!wa.length)return null;Q={};for(const Lb of wa)wa=Lb.value,this.SRi(wa),Q[Lb.key]=wa;return Q}SRi(Q){Q.M=F.a.fU(Q.M,0);Q.T=F.a.fU(Q.T,0)}reset(){this.bpb={};this.WJe=0}static generateKey(Q,wa){return wa?Q+" [it]":Q}}Object(f.a)(N,"FunctionCallAggregator",null,[846]);var H=d(2),J=d(1187);class L{}Object(f.a)(L,"CpuMeterFrame",null,[]);class I extends Sys.EventArgs{constructor(Q){super();
this.IRc=Q}}Object(f.a)(I,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class R{}Object(f.a)(R,"MiniTaskItemInfo",null,[]);class C{}Object(f.a)(C,"TaskItemInfo",null,[]);var P=d(996),W=d(1373),X=d(195);class V{constructor(Q,wa,eb,Lb,ec){this.htb=0;this.DY=null;this.Tjd=this.R_g=0;this.TXg=!1;this.BPb=0;this.fpc=!1;this.Rpa=null;this.$bd=0;this.mze=new l.a;this.wmd=[];this.my=Q;this.hxe=wa;this.Uoe=eb;this.tOg=Lb;H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("WrapSetTimeoutForTelemetryIsEnabled")&&
this.G7b();this.aBj=ec;this.Voe=new N(100);this.sKj=P.a.lF(1,5,new W.a)}fqd(Q){this.mze.addHandler("OnCpuMeterFrameAvailable",Q)}lRf(Q){this.mze.removeHandler("OnCpuMeterFrameAvailable",Q)}Gib(Q,wa,eb,Lb=null){eb=Lb?Lb.priority:7;const ec=this.my();this.start(wa,eb);try{Q()}finally{this.stop(wa,Lb),Q=this.my()-ec,this.tOg.track(Q,wa)}}Pd(Q,wa){const eb=this.my();try{Q()}finally{Q=this.my()-eb,this.Uoe.zya(Q,wa),0<this.htb&&this.Voe.zya(Q,wa),this.tOg.track(Q,wa)}}eHf(Q){const wa=new C;wa.TN=Q.Kwf;
wa.TP=Q.priority;this.XHi(1,wa)}H8b(Q){this.$bd|=Q}start(Q,wa){if(!this.htb){this.Voe.reset();const eb=this.chi(Q);eb&&this.bTd(1);this.DY=new C;this.DY.TN=Q;this.DY.TP=wa;this.DY.ST=(new Date).toISOString();this.DY.STS=F.a.fU(this.my(),2);eb?this.DY.UI=1:this.uem(Q)?this.DY.UI=2:this.DY.UI=0}this.htb++}bTd(Q){this.BPb|=Q}Ptd(Q=!0,wa=0){this.BPb=Q?0:this.BPb&~wa}stop(Q,wa=null){let eb;this.htb--;0>=this.htb&&this.DY&&(eb=this.my()-this.DY.STS,this.Tjd+=eb,this.hxe.zya(eb,Q),this.chi(Q)&&this.Ptd(!1,
1),this.DY.TRT=F.a.fU(eb,2),wa&&(this.DY.TQT=F.a.fU(wa.vbn,2),this.DY.TDT=F.a.fU(wa.fii,2)),this.aBj&&(this.XHi(0,this.DY),this.Ysn()),this.htb=0);0<=Q.indexOf(J.a.ibo)&&this.H8b(2);0<=Q.indexOf(J.a.BOi)&&this.H8b(4);1===(this.BPb&1)&&this.H8b(1);2===(this.BPb&2)&&this.H8b(8)}Ysn(){var Q=this.DY.TRT;if(750<Q){let eb=this.Voe.getData();if(eb){const Lb={};for(let ec in eb){var wa=eb[ec];const Tc=ec;Tc.startsWith("SiOp_")||Tc.endsWith("[it]")||(Lb[Tc]=Math.round(100*wa.T/Q))}eb=Lb}Q=Object.assign(new R,
{B:this.DY.STS,T:Q,S:eb});this.sKj.track(Q,this.DY.TN)}}hYn(){var Q=this.my()-this.R_g,wa=F.a.fU(this.Tjd/Q*100,2);Q=new L;Q.CP=wa;Q.II=this.$bd;wa=this.hxe.getData();K.a.count(wa)&&(Q.LRT=wa);wa=this.Uoe.getData();K.a.count(wa)&&(Q.FP=wa);this.mze.raiseEvent("OnCpuMeterFrameAvailable",new I(Q));this.W5i()}W5i(){this.hxe.reset();this.Uoe.reset();this.Tjd=this.htb=0;this.R_g=this.my();this.$bd=0;this.DY=null}run(){this.TXg?this.hYn():(this.W5i(),this.TXg=!0);this.Rpa?this.Rpa(Object(a.a)(this,this.run,
"run"),1E3):window.setTimeout(Object(a.a)(this,this.run,"run"),1E3)}xpd(Q,wa,eb){const Lb=Array(2);Lb[0]=wa;Lb[1]=eb;this.wmd[Q]||(this.wmd[Q]=[]);this.wmd[Q].push(Lb)}XHi(Q,wa){Q=this.wmd[Q];if(!X.a.nf(Q))for(let Lb=0;Lb<Q.length;Lb++){var eb=Q[Lb];const ec=eb[0];eb=eb[1];ec&&!ec(wa)||eb(wa)}}G7b(){if(!this.fpc){const Q=window.setTimeout;this.Rpa=(wa,eb)=>Q(wa,eb);this.fpc=!0}}chi(Q){return Q.startsWith("key")||Q.startsWith("input")}uem(Q){return Q.startsWith("click")||Q.startsWith("mouse")||Q.startsWith("pointer")}}
Object(f.a)(V,"CpuMeter",null,[100]);class Y{constructor(Q){this.Hkc=null;this.er=new u.a;this.my=Q}initialize(Q,wa,eb,Lb=!1){this.Hkc||(this.Hkc=new V(this.my,Q,wa,eb,Lb),this.er.Gg(this.Hkc));return this.Hkc}}Object(f.a)(Y,"CpuMeterProvider",null,[1839]);var ca=d(177),fa=d(156);class sa{constructor(Q=1){this.wC=[];this.O8c=[];this.aj=Q}A7k(){let Q=0;for(let wa=0;wa<this.wC.length;wa++)this.wC[wa]<this.wC[Q]&&(Q=wa);return Q}zya(Q,wa){Q=F.a.fU(Q,2);if(this.wC.length<this.aj)Array.add(this.wC,Q),
Array.add(this.O8c,wa);else{var eb=this.A7k();Q>this.wC[eb]&&(this.wC[eb]=Q,this.O8c[eb]=wa)}}getData(){return this.wC.length?{["Vals"]:this.wC,["Desc"]:this.O8c}:null}reset(){this.wC=[];this.O8c=[]}}Object(f.a)(sa,"MaxDataAggregator",null,[846]);var ia=d(37),ea=d(22);class da{get name(){return"Common.App.CpuMeter"}zc(Q){Q.register(Y,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").singleInstance().Xd(()=>new Y(ia.a.lf));Q.register(v,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").singleInstance().Xd(()=>
new v)}init(){const Q=H.AFrameworkApplication.K;if(Q.$("CpuMeterIsEnabled")){const wa=ea.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");fa.a.instance.cyc.continueWith(()=>{da.P0l(Q,wa)})}}dispose(){}static P0l(Q,wa){const eb=P.a.lF(10,5,new N(Q.rc("TaskManagerLoggingThreshold",0),Q.rc("CpuMeterMaximumEntriesToLog",0)));wa=wa.initialize(new sa(5),new N,eb,Q.$("CPUMeterExposeTaskDetailsIsEnabled"));wa.run();Q.$("CpuMeterMonitorIsEnabled")&&ea.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(wa,
Q.NP("CpuMeterAverageCpuPercentThreshold",80),Q.rc("CpuMeterRollingAverageFramesCount",15));w.b(16827671,306,50,"Initializing CpuMeter")}static main(){ca.a.instance.Pc(new da)}}Object(f.a)(da,"CpuMeterPackage",null,[1,2]);var ja=d(8),Ga=d(84),ya=d(1022),ta=d(1002),ua=d(15),Sa=d(1374);class ka{constructor(){this.Ypa=this.Eic=null;this.JVb=!0;this.qpc=!1}zc(Q){H.AFrameworkApplication.K.$("EventTimingMeterIsEnabled")&&Q.register(1798,"Common.IEventTimingMeter").singleInstance().Xd(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var Q=
new ta.a(H.AFrameworkApplication.K.rc("EventTimingMeterEventSamplingPercent",0)/100);Q=new ya.a(Object(a.a)(Q,Q.p2a,"shouldBeInSample"));const wa=P.a.lF(16,1,Q);this.Ypa=new Sa.a("TypingDuration-SlowPercentileAtValue","Percentile",H.AFrameworkApplication.K.NP("AshaVetoForTypingThresholdInMS",150),H.AFrameworkApplication.K.NP("AshaVetoForTypingThresholdPercentile",95),this.JVb);(this.qpc=!ua.a.XZa)&&H.AFrameworkApplication.rK(()=>{this.eVe()});this.Eic=eb=>{eb=eb.rawEvent.detail;for(const Lb of eb)wa.track(Lb,
"EventTimingData"),"false"!==Lb.metadata.altPressed.toString()||"false"!==Lb.metadata.ctrlPressed.toString()||"false"!==Lb.metadata.repeat.toString()||"CharacterKey"!==Lb.metadata.key.toString()&&"Space"!==Lb.metadata.key.toString()||!this.qpc||this.Ypa.Mua(Lb.timeToRequestAnimationFrameMs)};G.a.addHandler(window.self,B.a.g$g,this.Eic)}dispose(){this.Eic&&(G.a.removeHandler(window.self,B.a.g$g,this.Eic),this.Eic=null)}eVe(){this.Ypa.hOa();this.Ypa.EAi&&(ja.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),
Ga.Health.instance.recordQosError("SlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){ca.a.instance.Pc(new ka)}}Object(f.a)(ka,"EventTimingMeterPackage",null,[1,2]);var ha=d(79),Ca=d(72),Pa=d(35);class Xa{constructor(Q,wa,eb,Lb=null,ec=null){this.PK=Q;this.xnc=wa;this.snc=eb;this.zUg=Lb;this.atc=ec}AAd(Q){const wa=new Sys.StringBuilder(this.PK.iYc);wa.append("RoamingServiceHandler.ashx?action=");wa.append("getFirstRunExperienceSettings");wa.append("&");wa.append(this.zff(Q));
wa.append("&");wa.append(H.AFrameworkApplication.um);H.AFrameworkApplication.Ze.Lj(wa.toString(),1,null,null,!0,2,Object(a.a)(this,this.iYa,"getRequestSuccessCallback"),Object(a.a)(this,this.PAa,"getRequestFailureCallback"),null)}F0b(Q){var wa=new Sys.StringBuilder(this.PK.iYc);wa.append("RoamingServiceHandler.ashx?action=");wa.append("saveFirstRunExperienceSettings");wa.append("&");wa.append(H.AFrameworkApplication.um);wa=wa.toString();Q=Pa.c(Q);H.AFrameworkApplication.Ze.Lj(wa,2,Q,null,!0,4,Object(a.a)(this,
this.J4m,"postRequestSuccessCallback"),Object(a.a)(this,this.Zma,"postRequestFailureCallback"),null)}iYa(Q){let wa=!1,eb=null;try{if(0<Q.data.Ee.length){const Lb=Object(Ca.a)(Object,Pa.a(Q.data.Ee)),ec=Lb?Lb[this.PK.qPe]:null;ec&&(eb=Object(Ca.a)(Object,Pa.a(ec.toString())))}wa=!0}catch(Lb){this.PAa(null)}wa&&this.xnc&&this.xnc(Q.data,eb)}PAa(Q){this.snc&&this.snc(Q?Q.data:null)}J4m(Q){this.zUg&&this.zUg(Q?Q.data:null)}Zma(Q){this.atc&&this.atc(Q?Q.data:null)}zff(Q){const wa=new Sys.StringBuilder("requestedsettings=");
for(let eb=0;eb<Q.count;eb++)wa.append(Q.J(eb)),eb<Q.count-1&&wa.append(";");return wa.toString()}}Object(f.a)(Xa,"FirstRunExperienceRequestHandler",null,[]);var qa=d(199);class Ea{constructor(){this.$mc=this.A$c=this.PK=null}WUn(Q){Q?(this.PK=Q,this.rem()&&(ja.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),Q=new ha.a,Q.add(this.PK.qPe),this.A$c=new Xa(this.PK,Object(a.a)(this,this.iYa,"getRequestSuccessCallback"),Object(a.a)(this,
this.PAa,"getRequestFailureCallback"),null,Object(a.a)(this,this.Zma,"postRequestFailureCallback")),this.A$c.AAd(Q)),(this.PK.Agi||H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.VZf()):ja.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}rem(){try{if(this.PK.Agi)return!0;if(!H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||H.AFrameworkApplication.K.$("IsAnonymousUser"))return!1;
if(this.PK.h$l||this.PK.k7b||H.AFrameworkApplication.K.$("IsO365ConsumerHost"))return!0;const Q=H.AFrameworkApplication.K.lb("FlightId");return-1!==(Q?Q.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Q){ja.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",Q?Q.toString():null)}return!1}OSi(Q){const wa={},eb={};eb.FREDisplayedDate=(new Date).toUTCString();eb.VersionDisplayed=Q;eb.RemindMeLater=!1;wa[this.PK.qPe]=Pa.c(eb);ja.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");
this.A$c&&this.A$c.F0b(wa)}iYa(Q,wa){Q=Q?+Q.uS-+Q.TG:-1;Q>this.PK.FRi?ja.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",Q,this.PK.FRi):wa?this.TTn(wa)?(ja.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.PK.Ppi),this.VZf()):(this.g3e(!1),
ja.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(ja.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.VZf())}PAa(Q){this.g3e(!1);ja.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",Q?Q.mf:-1)}Zma(Q){ja.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",
Q?Q.mf:-1)}VZf(){this.g3e(!0);var Q=ea.a.instance.Pa("Common.ISystemInitiatedFeedback");Q?this.P2i(Q):(ja.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((Q=ea.a.instance.Za("Common.ISystemInitiatedFeedback"))?Q.execute(wa=>{this.P2i(wa)}):ja.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}P2i(Q){if(Q){var wa=this.PK.t$k;
wa&&(H.AFrameworkApplication.Gl(wa),H.AFrameworkApplication.F6(wa));ja.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",wa);Q.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.$mc=Object(a.a)(this,this.nQm,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.$mc,!0),window.addEventListener("FRELaunchedEvent",this.$mc,!0)):(ja.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),
this.OSi(this.PK.currentVersion))}else ja.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}nQm(Q){if(Q){var wa=Q.detail;Q=Q.type;var eb=this.PK&&this.PK.cih?this.PK.cih.split("-")[0]:null;if("FRELaunchedEvent"===Q||eb&&wa&&wa.id&&-1!==wa.id.indexOf(eb))wa.success&&(ja.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.OSi(this.PK.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.$mc,
!0),window.removeEventListener("FRELaunchedEvent",this.$mc,!0))}}TTn(Q){if("RemindMeLater"in Q&&"FREDisplayedDate"in Q){if("true"===Q.RemindMeLater.toString()&&(+new Date-+new Date(Q.FREDisplayedDate.toString()))/36E5>this.PK.Ppi)return!0}else if(H.AFrameworkApplication.K.$("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in Q&&Q.VersionDisplayed<this.PK.currentVersion)return ja.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}g3e(Q){H.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
qa.a.dispatch("FREDecisionEvent",{["show"]:Q})}}Object(f.a)(Ea,"FirstRunExperienceLauncher",null,[1795]);class Ia{constructor(){this.W=null}get name(){return"Common.App.FirstRunExperienceLauncher"}zc(Q){this.W=Q;this.W.register(1795,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").singleInstance().Xd(()=>new Ea)}init(){}dispose(){}static main(){ca.a.instance.Pc(new Ia)}}Object(f.a)(Ia,"FirstRunExperienceLauncherPackage",null,[1,2]);class na{constructor(){this.y=this.x=0}}Object(f.a)(na,
"HammerPoint",null,[]);var Na=d(13);class Oa{constructor(Q,wa,eb,Lb,ec){this.DMg=this.gSa=this.Nbd=1;this.Lnd=this.twc=this.uUa=0;this.zye=this.PFa=null;this.Pmb=this.boe=this.fid=!1;this.Ki=Q;this.jIa=wa;this.Lsb=eb;this.ga=Lb;ec&&(this.fid=ec.$("PromoteLayerPinchToZoomIsEnabled"),this.boe=ec.$("FinalizeWithInitialPinchScaleIsEnabled"),this.Pmb=ec.$("AdjustPinchStartXWithPageMarginIsEnabled"))}get qK(){return this.jIa}Tbm(){return!!this.Ki.instance}JQm(Q){this.ga&&this.ga.processAction(Na.a.i6i,
2);const wa=this.Ki.instance;this.fid&&wa.MHi();this.gSa=wa.vj;this.Nbd=Q.iGc.scale;this.DMg=1;this.zye=this.Ghh();this.PFa=this.jIa.getBounds();if(!this.PFa)return ja.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;Q=this.dVh(Q);this.Pmb?this.CYi(this.jIa.scrollWidth,this.PFa.width,Q,this.gSa,wa):this.uUa=this.jIa.scrollWidth>this.PFa.width?this.qzc(this.Lsb.scrollLeft,Q.x,this.gSa):null;this.Lnd=this.jIa.scrollHeight>this.PFa.height?this.qzc(this.Lsb.scrollTop,Q.y,this.gSa):null;return!0}JSf(){this.uUa=
null;this.twc=0}CYi(Q,wa,eb,Lb,ec){Q>wa?this.uUa?(Q=ec.Vuf,Q!==this.twc&&(this.uUa-=this.twc-Q,this.twc=Q)):(this.uUa=this.qzc(this.Lsb.scrollLeft,eb.x,Lb),this.twc=ec.Vuf):this.JSf()}IQm(Q){const wa=this.dVh(Q);if(!wa)return ja.ULS.sendTraceTag(42821147,353,15,"Unexpected null pinch center"),!1;Q=this.xHn(Q.iGc.scale/this.Nbd)*this.gSa;this.ojo(wa,Q);this.pjo(wa,Q);return!0}ojo(Q,wa){const eb=this.jIa.scrollWidth,Lb=this.PFa.width;this.Pmb?this.CYi(eb,Lb,Q,wa,this.Ki.instance):!this.uUa&&eb>Lb&&
(this.uUa=this.qzc(this.Lsb.scrollLeft,Q.x,wa));if(Q=this.Ohh(Q.x,this.uUa,eb,Lb,wa))this.Lsb.scrollLeft=Q}pjo(Q,wa){const eb=this.jIa.scrollHeight,Lb=this.PFa.height;!this.Lnd&&eb>Lb&&(this.Lnd=this.qzc(this.Lsb.scrollTop,Q.y,wa));if(Q=this.Ohh(Q.y,this.Lnd,eb,Lb,wa))this.Lsb.scrollTop=Q}Ohh(Q,wa,eb,Lb,ec){return eb<=Lb||!wa||!Lb?null:Math.max(0,Math.min(wa*ec-Q,eb-Lb))}qzc(Q,wa,eb){return(Q+wa)/eb}HQm(Q){Q=Q.iGc.scale;this.boe&&(Q/=this.Nbd);this.LFh(Q);this.fid&&this.Ki.instance.lOf();this.ga&&
this.ga.processAction(Na.a.m5e,2);this.Pmb&&this.JSf()}GQm(Q){Q=Q.iGc.scale;this.boe&&(Q/=this.Nbd);this.LFh(Q,!0);this.fid&&this.Ki.instance.lOf();this.ga&&this.ga.processAction(Na.a.m5e,2);this.Pmb&&this.JSf()}xHn(Q){const wa=this.Ki.instance,eb=new Date>=this.zye;eb&&(this.zye=this.Ghh());Math.abs(Q-this.DMg)>=.01*Q&&wa.eOn(Q*this.gSa,eb);return wa.vj/this.gSa}LFh(Q,wa=!1){Q*=this.gSa;this.Ki.instance.fYf(Q,!1);const eb={};eb.initialScale=this.gSa;eb.finalScale=Q;eb.cancelled=wa;ja.ULS.sendTraceTag(42821150,
353,50,"Pinch zoom ended: {0}",eb)}dVh(Q){return(Q=Q.iGc.center)&&this.PFa?Object.assign(new na,{x:Q.x-this.PFa.x,y:Q.y-this.PFa.y}):null}Ghh(){const Q=(new Date).getTime();return new Date(Q+1E3)}}Object(f.a)(Oa,"PinchZoomAdapter",null,[1865]);class Ra{constructor(Q){this._element=Q}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}Object(f.a)(Ra,"ScrollContainerElement",null,[1864]);
var ab=d(124);class zb{constructor(Q,wa,eb,Lb,ec,Tc){this.iHe=this.B6a=null;this.W=Q;this.le=wa;this.Xcd=eb;this.uKg=Lb;this.$Hj=ec;this.iQb=Tc;this.A7c=new ha.a}register(Q,wa){this.Xcd&&(4===H.AFrameworkApplication.ua.Sb.jo&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.OneNoteDelayLoadHammerJs",!1)?ab.a.get_instance().sl(8,()=>{this.nQi(Q,wa)}):this.nQi(Q,wa))}nQi(Q,wa){this.W.Za("Common.IGestureInputManager").execute(eb=>{this.N_n();this.B6a=eb;this.A7c.add(Q);
if(this.uKg){if(this.$Hj&&0!==eb.trl()){this.K6i();return}var Lb=this.W.Za("Common.IZoomManager");this.W.resolve("Common.IAppSettingsManager");const ec=new Ra(Q);Lb=new Oa(Lb,ec,wa,H.AFrameworkApplication.ya,H.AFrameworkApplication.K);eb.rjn(Q,Lb)}this.K6i()})}unregister(){if(this.B6a&&this.A7c){if(this.uKg){for(let Q of this.A7c)this.B6a.Gco(Q);this.A7c.clear()}this.B6a=null}}N_n(){this.iQb&&(this.le?this.iHe=this.le.fg("Task","Register"):ja.ULS.sendTraceTag(590387076,310,10,"_stopwatchBuilder is null"))}K6i(){this.iQb&&
(this.iHe?this.iHe.stop():ja.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}Object(f.a)(zb,"GestureInputRegistrar",null,[1797]);class Qa{constructor(){this.W=null;this.zh=!1}get name(){return"Common.App.GestureInput"}init(){this.zh||(this.W.resolve("Common.IGestureInputRegistrar"),this.zh=!0)}dispose(){}zc(Q){this.W=Q;Q.register(1797,"Common.IGestureInputRegistrar").singleInstance().Xd(()=>new zb(Q,H.AFrameworkApplication.ua.iq,H.AFrameworkApplication.FNc(),H.AFrameworkApplication.jei(),
!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("PinchZoomOnlyPointerEventsIsEnabled"),!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled")))}static main(){ca.a.instance.Pc(new Qa)}}Object(f.a)(Qa,"GestureInputPackage",null,[1,2]);var yb=d(322),lb=d(82);class Eb{constructor(){this.Sib=this.SJh=null}}Object(f.a)(Eb,"GestureAdapterInfo",null,[]);var bc=d(376),Pb=d(238);class Va{constructor(){this.gob=null}uvf(){if(!this.gob){var Q="hammer.min.js";H.AFrameworkApplication.K.vu("IsServerFlavorDebug")&&
(Q=H.AFrameworkApplication.K.$("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");Q=H.AFrameworkApplication.vw(String.format("{0}",Q),5);Q=Pb.a.create(Q,null,null);bc.a.KS(Q);this.gob=Q.A_a}return this.gob}static get instance(){Va._instance||(Va._instance=new Va);return Va._instance}}Va._instance=null;Object(f.a)(Va,"HammerJsDependencyLoader",null,[1866]);const oa=(Q,wa,eb=null)=>{if(void 0===wa||null===wa)throw ja.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");
let Lb=null;switch(Q){case B.a.pinch:Lb=new Hammer.Pinch(eb);break;case B.a.pan:Lb=new Hammer.Pan(eb)}Lb&&(Lb.manager=wa);return Lb};var pa;(function(Q){Q[Q.none=-1]="none";Q[Q.pinch=0]="pinch";Q[Q.pan=1]="pan";Q[Q.swipe=2]="swipe"})(pa||(pa={}));Object(f.b)("GestureEvent",pa);var Ya=d(55);class Ja extends Ya.a{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we){super(Q,eb,Lb,Tc);this.Ujc=wa;this.XTa=Ad;this.Noa=we;this.KCj=ec}get shiftKey(){return this.XTa}get ctrlKey(){return this.Noa}get clientPoint(){return this.Ujc}get iGc(){return this.KCj}static create(Q,
wa,eb,Lb,ec,Tc){if(eb.rawEvent)if(Tc){var Ad=eb.rawEvent;Ad=new Sys.UI.Point(Ad.clientX,Ad.clientY)}else Ad=Ya.a.rDd(eb);else Ad=new Sys.UI.Point(eb.clientX,eb.clientY);return new Ja(Q,Ad,wa,eb,Lb,ec,eb.shiftKey,eb.ctrlKey,Tc)}}Object(f.a)(Ja,"GestureEventArgs",Ya.a,[]);class nb{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(f.a)(nb,"GestureManagerData",null,[]);class Bb{}Bb.eqj=2;Bb.fqj=4;Bb.gqj=8;Bb.hqj=8;Object(f.a)(Bb,"HammerConstants",null,[]);var mb=d(73),Qb=d(103),Vb=d(16),mc=d(91);class ob extends G.a{constructor(Q,wa){super();this.ZGa=yb.a.bel;this.yBe=!!window.PointerEvent;this.$1g=window.hasOwnProperty("ontouchstart");this.fpb=this.Trc=null;this.NGa=
!1;this.yia=new lb.a;this.Zsc=new lb.a;this.nEg=new ha.a;this.I5a=null;this.yNb=this.iQb=this.bwg=this.xie=this.Uwe=this.OWg=this.swg=this.Bwc=!1;this.Rqc=-1;this.curRecognizer=this.element=this.handlers=this.session=this.jHe=null;this.sg=mb.EventHandlerManager.instance;this.yBe?(ja.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.Trc=Object(a.a)(this,this.RWd,"onPointerEvent"),this.fpb=B.a.eel):this.$1g?(ja.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.Trc=Object(a.a)(this,
this.Zhb,"onTouchEvent"),this.fpb=B.a.touchEvents):(ja.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.Trc=Object(a.a)(this,this.FWd,"onMouseEvent"),this.fpb=B.a.cel);this.le=wa;this.r0=Q;H.AFrameworkApplication.K&&(this.Bwc=H.AFrameworkApplication.K.$("UsePointerCaptureIsEnabled"),this.swg=H.AFrameworkApplication.K.$("ClearCacheOnPrimaryPointerIsEnabled"),this.OWg=H.AFrameworkApplication.K.$("ResetHandledBeforeInputHandlerIsEnabled"),this.Uwe=H.AFrameworkApplication.K.$("LogCoalescedEventsIsEnabled"),
this.xie=H.AFrameworkApplication.K.$("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.bwg=H.AFrameworkApplication.K.$("CheckIfHammerExistsAfterDownloadIsEnabled"),this.iQb=H.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled"),this.yNb=this.Bwc&&H.AFrameworkApplication.K.$("CancelDragFromGestureInputManagerIsEnabled")&&H.AFrameworkApplication.K.$("UseGestureInputManagerPointerCacheIsEnabled"))}trl(){return this.yBe?0:this.$1g?1:2}Cu(Q){super.Cu(Q);this.sg.qBa(this.fpb,Q,0,this.Trc)}wu(Q){super.wu(Q);
this.sg.xWa(Q,this.fpb)}rjn(Q,wa){H.AFrameworkApplication.FNc()?Va.instance.uvf().continueWith(eb=>{this.M_n();if(eb.Ii||eb.ho)ja.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",eb.status);else{ja.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",eb.status);if(this.bwg){eb=window.Hammer;if("undefined"===typeof eb){ja.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.O8d();return}if("undefined"===typeof eb.inputHandler){ja.ULS.sendTraceTag(590901390,
310,10,"Hammer.inputHandler does not exist");this.O8d();return}}if(!Q)throw this.O8d(),Error.argumentNull("source element can not be null");eb=Qb.a.Eb(Q,this.ZGa);if(void 0===eb||null===eb)eb=new lb.a,Qb.a.Hl(Q,this.ZGa,eb),this.sjn(Q);if(!eb.xb(pa[0])){var Lb=Object.assign(new Eb,{Sib:oa(pa[0],this,null),SJh:wa});eb.add(pa[0],Lb)}}this.O8d()}):ja.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}M_n(){this.iQb&&(this.le?this.jHe=this.le.fg("Task",
"RegisterGestureAdapterAfterLoad"):ja.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}O8d(){this.iQb&&(this.jHe?this.jHe.stop():ja.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}Gco(Q){ja.ULS.sendTraceTag(42256223,310,Q?100:10,"source element {0} ",Q.id);const wa=Qb.a.Eb(Q,this.ZGa);void 0!==wa&&null!==wa&&(wa.remove(pa[0]),wa.count||(Qb.a.f_(Q,this.ZGa),this.curRecognizer=null,this.Hco(Q)))}sjn(Q){this.nEg.add(Q);this.sg.qBa(this.fpb,Q,
0,this.Trc)}Hco(Q){this.nEg.remove(Q);this.sg.xWa(Q,this.fpb)}recognize(Q){var wa=Array(Q.pointers.length);for(var eb=0;eb<Q.pointers.length;eb++)wa[eb]=Q.pointers[eb].target;eb=null;for(this.I5a=this.ywl(wa);void 0!==this.I5a&&null!==this.I5a&&(eb=Qb.a.Eb(this.I5a,this.ZGa),void 0===eb||null===eb);this.I5a=this.I5a.parentNode);if(void 0!==eb&&null!==eb){this.curRecognizer&&this.curRecognizer.state===Bb.hqj&&(this.curRecognizer=null);wa=eb.keys;for(let Lb of wa){wa=eb.J(Lb);void 0!==wa&&null!==wa&&
void 0!==wa.Sib&&null!==wa.Sib&&(void 0===this.curRecognizer||null===this.curRecognizer||wa.Sib===this.curRecognizer||wa.Sib.canRecognizeWith(this.curRecognizer))&&wa.Sib.recognize(Q);const ec=wa.Sib.state;this.curRecognizer||Bb.eqj!==ec&&Bb.fqj!==ec&&Bb.gqj!==ec||(this.curRecognizer=wa.Sib)}}}emit(Q,wa){if("hammer.input"!==Q){this.NGa=!1;wa=Ja.create(Q,this.I5a,wa.srcEvent,wa,3,this.yBe);var eb=Qb.a.Eb(this.I5a,this.ZGa);if(this.ggm(Q))var Lb=0;else if(this.Gfm(Q))Lb=1;else if(this.xjm(Q))Lb=2;else{ja.ULS.sendTraceTag(42256256,
310,15,"Event can not be recognized by current manager");return}({value:eb}=eb.Dc(pa[Lb]));void 0!==eb&&null!==eb&&((eb=eb.SJh,eb.Tbm())?Q.endsWith("start")?this.NGa=eb.JQm(wa):Q.endsWith("end")?(eb.HQm(wa),this.NGa=!0):Q.endsWith("cancel")?(eb.GQm(wa),this.NGa=!0):Q.endsWith("move")&&(this.NGa=eb.IQm(wa)):ja.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",Q))}}get(Q){return Object(Ca.a)(Hammer.Recognizer,Q)}ywl(Q){if(1>Q.length)return null;if(1===Q.length)return Q[0];
var wa=Q[0],eb=!0;for(let Lb=1;Lb<Q.length;Lb++){if(!Q[Lb])return null;if(wa!==Q[Lb]){eb=!1;break}}if(eb)return wa;wa=this.tKh(Q[0]);eb=0;for(const Lb of Q){Q=this.tKh(Lb);if(wa.J(wa.count-1)!==Q.J(Q.count-1))return null;for(let ec=wa.count-2,Tc=Q.count-2;ec>=eb&&0<=Tc;ec--,Tc--)if(wa.J(ec)!==Q.J(Tc)){eb=ec+1;break}}return wa.J(eb)}tKh(Q){const wa=new ha.a;for(;void 0!==Q&&null!==Q;Q=Q.parentNode)wa.add(Q);return wa}gRh(Q){switch(Q){case B.a.uO:case B.a.Fvb:return 1;case B.a.tO:case B.a.RSe:return 2;
case B.a.QI:case B.a.Gvb:return 4;case B.a.T$d:case B.a.QSe:return 8}return 0}Zhb(Q,wa,eb){Q=this.gRh(Q);wa=this.Stl(eb);Hammer.inputHandler(this,Q,wa);this.NGa&&eb.preventDefault();return this.NGa}S1h(){return 1<this.yia.count}Psd(){ja.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.Bwc)for(let Q of this.yia)this.zMi(Q.key);else this.yia=new lb.a;this.session=null}j2j(Q,wa,eb){ja.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",Q);if(!this.Zsc.xb(Q)){try{wa.setPointerCapture(Q)}catch(Lb){ja.ULS.sendTraceTag(594055958,
310,10,"Exception: {0}",Lb)}this.Zsc.add(Q,wa)}this.yia.Z(Q,eb);this.yNb&&1<this.yia.count&&this.r0&&!this.r0.Czc&&(this.r0.Czc=!0)}zMi(Q){ja.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",Q);if(this.Zsc.xb(Q)){try{this.Zsc.J(Q).releasePointerCapture(Q)}catch(wa){ja.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",wa)}this.Zsc.remove(Q)}else ja.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",Q);this.yia.remove(Q);this.yNb&&
1>=this.yia.count&&this.r0&&this.r0.Czc&&(this.r0.Czc=!1)}RWd(Q,wa,eb){var Lb=eb.rawEvent.pointerType.toString();const ec=eb.rawEvent.pointerId.toString();if("touch"!==Lb)return!1;Q=this.gRh(Q);if(1!==Q&&!this.yia.xb(ec))return!1;this.swg&&1===Q&&eb.rawEvent.isPrimary&&this.yia.count&&(ja.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.Psd());this.Bwc?this.j2j(ec,wa,eb):this.yia.Z(ec,eb);this.Uwe&&2===Q&&(!this.xie||this.xie&&"function"===typeof eb.rawEvent.getCoalescedEvents)&&
(wa=eb.rawEvent.getCoalescedEvents())&&this.S1h()&&(this.Rqc=Math.max(this.Rqc,wa.length));this.OWg&&(this.NGa=!1);Lb=this.Qtl(this.yia,eb,Lb);Hammer.inputHandler(this,Q,Lb);if(4===Q||8===Q)this.Bwc?this.zMi(ec):this.yia.remove(ec),this.yia.count||(this.session=null,this.Uwe&&-1!==this.Rqc&&(ja.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Rqc),this.Rqc=-1));this.NGa&&eb.preventDefault();return this.NGa}FWd(){return!1}Stl(Q){const wa=new nb;var eb=Q.rawEvent;const Lb=
eb.touches;eb=eb.changedTouches;wa.pointers=Array.clone(Lb);wa.pointers=Array.clone(0<Lb.length?Lb:eb);wa.changedPointers=Array.clone(eb);wa.srcEvent=Q;wa.pointerType="touch";return wa}Qtl(Q,wa,eb){const Lb=new nb;Lb.pointers=mc.toArray(Q.values);Lb.changedPointers=[wa];Lb.pointerType=eb;Lb.srcEvent=wa;return Lb}ggm(Q){return Vb.a.startsWith(Q,B.a.pinch)}Gfm(Q){return Vb.a.startsWith(Q,B.a.pan)}xjm(Q){return Vb.a.startsWith(Q,B.a.swipe)}}Object(f.a)(ob,"GestureInputManager",G.a,[1845,1846]);var cb=
d(241);class db{constructor(){this.W=null;this.zh=!1}get name(){return"Common.App.GestureInputManager"}zc(Q){Q.register(ob,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").singleInstance().Xd(()=>new ob(cb.a.instance,H.AFrameworkApplication.ua.iq));this.W=Q}init(){this.zh||(this.W.resolve("Common.App.GestureManager.GestureInputManager"),this.zh=!0)}dispose(){}static main(){ca.a.instance.Pc(new db)}}Object(f.a)(db,"GestureInputManagerPackage",null,[1,2]);var kb=d(244),
Wb=d(46),Fb=d(1513);class nc{constructor(Q,wa,eb){this.EFe=this.DFe=null;this.hUb=new u.a;this.hg=Q;this.Krc=eb;this.f5=wa.appSettings[nc.Voo]||""}get BPn(){return this.hUb.task}get Ija(){return this.hg.value}Btn(){const Q={};Q[nc.uTl]=H.AFrameworkApplication.um;Q["Content-Type"]="application/json; charset=utf-8";ja.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const wa=Wb.a.Bp(this.f5+nc.CPn,nc.YLm,H.AFrameworkApplication.ua.Sb.jo.toString());
this.Ija.Lj(wa,1,"",Q,!0,2,Object(a.a)(this,this.YFb,"onSuccessCallback"),Object(a.a)(this,this.LFb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}kxm(Q){try{const wa={};wa.FlightName=Q.FlightName;wa.SessionID=Q.SessionID;ja.ULS.sendTraceTag(594883776,215,50,Pa.c(wa))}catch(wa){ja.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}YFb(Q){if((Q=Q.data.Ee)&&Q.length)try{const wa=Pa.a(Q);this.DFe=wa.NavBarDataJson;ja.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");
this.DFe?({Dv:this.EFe}=Pa.d(wa.NavBarDataJson)).returnValue?(this.kxm(this.EFe),this.hUb.Gg(this.EFe)):(ja.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:Fb.a.b2c(this.DFe)}),this.hUb.Paa()):(ja.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.hUb.Paa())}catch(wa){ja.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.hUb.Paa()}else ja.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}LFb(){this.hUb.Paa();
ja.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return nc._instance||(nc._instance=nc.hzb())}static hzb(){return new nc(new kb.a(()=>H.AFrameworkApplication.Ze),H.AFrameworkApplication.K,H.AFrameworkApplication.ua.Sb.jo)}}nc.uTl="X-qs";nc.YLm="at";nc.CPn="O365ShellServiceProxy.ashx";nc._instance=null;nc.Voo="ShellWebServiceBase";Object(f.a)(nc,"O365ShellActor",null,[1834]);class gc{constructor(){this.W=null}get name(){return"Common.App.O365Shell"}zc(Q){this.W=
Q;this.W.register(nc,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").singleInstance().Xd(()=>new nc(new kb.a(()=>H.AFrameworkApplication.Ze),H.AFrameworkApplication.K,H.AFrameworkApplication.ua.Sb.jo))}init(){H.AFrameworkApplication.K.yq(Object(a.a)(this,this.Ww,"onFullAppSettingsReady"))}Ww(){H.AFrameworkApplication.e8f&&H.AFrameworkApplication.ua.Sb.sI&&this.W.resolve("Common.App.O365Shell.O365ShellActor").Btn()}dispose(){}static main(){ca.a.instance.Pc(new gc)}}
Object(f.a)(gc,"PackageManager",null,[1,2]);class Jc{z_a(){}init(){}dispose(){}}Object(f.a)(Jc,"NoOpOfflineLogger",null,[1875,10]);var tb=d(594);class dc{}dc.Hqd=0;Object(f.a)(dc,"OfflineLoggerConstants",null,[]);var Yb=d(80),pb=d(229),Gb=d(320);class hb{constructor(Q,wa,eb,Lb,ec){this.oSa=!1;this.M4=null;this.Ukc=this.uRb=this.Unb=0;this.sJ=this.G7a=this.VR=null;this.Bl=!1;this.wxa=eb;this.cya=Lb;this.Txa=ec;this.hg=wa;this.Hb=Q}init(){this.rYf();this.arm();this.oSa=!1;this.hg.kWb(this);this.VR=
new Yb.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),104);this.Hb.$b(this.VR)}ezc(Q){return"OfflineLog|"+Q}arm(){const Q=this.wxa.getItem("OfflineLoggerManifest");void 0!==Q&&null!==Q&&0<Q.length&&(this.M4=hb.vgc(Q));this.M4||(this.M4={});if(void 0===this.M4.end||null===this.M4.end)this.M4.end=0;if(void 0===this.M4.offset||null===this.M4.offset)this.M4.offset=0;this.Unb=this.M4.offset;isFinite(this.Unb)||(this.Unb=0);this.uRb=this.M4.end;isFinite(this.uRb)||(this.uRb=0);this.Ukc=
this.uRb}rYf(){this.G7a=new Gb.a;this.sJ=new pb.a;this.cya.J8g(Object(a.a)(this,this.sHf,"onUlsReadyToBeSent"));this.cya.l9g(Object(a.a)(this,this.uHf,"onUlsSentSuccessfully"));this.cya.k9g(Object(a.a)(this,this.tHf,"onUlsSentFailed"));this.cya.A8g(Object(a.a)(this,this.GDf,"onAfterUlsHostDisposed"))}sHf(Q,wa){if(void 0!==wa&&null!==wa&&void 0!==wa.args&&null!==wa.args){Q=!1;if(!this.G7a.xb(wa.args.tag)){if(!this.G7a.xb(dc.Hqd))return;Q=!0}this.G7a.remove(Q?dc.Hqd:wa.args.tag);this.sJ.xb(wa.uM)||
this.sJ.Z(wa.uM,new ha.a);this.sJ.J(wa.uM).add(wa.args)}}uHf(Q,wa){this.sJ.remove(wa.uM)}tHf(Q,wa){if(void 0!==wa&&null!==wa&&this.sJ.xb(wa.uM)){Q=this.sJ.J(wa.uM);for(let eb=0,Lb=Q.count;eb<Lb;++eb)wa=hb.serialize(Q.J(eb),this.Txa),this.g2c(this.ezc(this.Ukc++),wa)}}GDf(){this.dispose()}g2c(Q,wa){try{return this.wxa.setItem(Q,wa),!0}catch(eb){return ja.ULS.sendTraceTag(18614232,222,15,"OfflineLogger SetItem failed with exception: {0}",eb.message),!1}}sendOfflineLogs(){if(!this.oSa){for(var Q=this.Unb,
wa=new ha.a,eb=null;Q<this.uRb&&5>=wa.count;++Q){var Lb=this.ezc(Q);const ec=this.wxa.getItem(Lb);this.wxa.removeItem(Lb);if(void 0===ec||null===ec)continue;const Tc=({sessionId:Lb}=hb.deserialize(ec)).returnValue;if(Tc){if(!eb)eb=Lb;else if(Lb!==eb)break;wa.add(Tc)}else ja.ULS.sendTraceTag(18614233,222,15,"Unable to deserialze the offline log: {0}",ec)}0<wa.count&&this.cya.LPi(this,mc.toArray(wa),eb);this.Unb=Q;Q>=this.uRb&&(this.Hb.ef(this.VR),this.VR=null)}}z_a(Q,wa,eb){!this.Bl&&ja.ULS.u7(wa,
eb)&&this.G7a.Z(Q,!0)}dispose(){if(!this.Bl){this.VR&&this.Hb.ef(this.VR);var Q=mc.toArray(this.sJ.keys);Q.sort();for(const wa of Q){Q=this.sJ.J(wa);for(let eb=0,Lb=Q.count;eb<Lb;++eb){const ec=hb.serialize(Q.J(eb),this.Txa);this.g2c(this.ezc(this.Ukc++),ec)}}this.Unb<this.Ukc?(this.M4.end=this.Ukc,this.M4.offset=this.Unb,this.g2c("OfflineLoggerManifest",JSON.stringify(this.M4))):this.wxa.removeItem("OfflineLoggerManifest")}this.Bl=!0}mNa(){this.oSa=!0}mhb(){this.oSa=!1}static serialize(Q,wa){const eb=
{};eb.t=Q.tag;eb.c=Q.category;eb.l=Q.level;eb.m=Q.message;eb.lt=Q.logType;eb.s=wa;eb.ts=Q.timestamp;eb.o=Q.isMinified;eb.a=Q.args;return JSON.stringify(eb)}static deserialize(Q){return(Q=hb.vgc(Q))?{returnValue:new tb.a(Q.ts,Q.c,Q.t,Q.l,Q.m,Q.lt,Q.o,Q.a),sessionId:Q.s}:{returnValue:null,sessionId:null}}static vgc(Q){try{return JSON.parse(Q)}catch(wa){ja.ULS.sendTraceTag(18614234,222,10,"OfflineLogger TryParseString failed with exception: {0}",wa.message)}return null}}Object(f.a)(hb,"OfflineLoggerImpl",
null,[1875,10,211]);class Ib{constructor(Q,wa,eb,Lb){this.sessionId=Q;this.version=wa;this.xrd=eb;this.ZHf=Lb;this.mma=new ha.a}}Object(f.a)(Ib,"CachedLogUpload",null,[]);class Ob{constructor(Q){Q.name&&(this.n=Q.name);Q.stack&&(this.s=Q.stack);Q.message&&(this.m=Q.message);Q.file&&(this.f=Q.file);null!=Q.line&&(this.l=Q.line);null!=Q.column&&(this.c=Q.column)}}Object(f.a)(Ob,"LoggingExceptionArgsLocalStorage",null,[]);class kc{constructor(Q){this.t=Q.tag;this.c=Q.category;this.l=Q.level;this.m=Q.message;
this.lt=Q.logType;this.ts=Q.timestamp;this.o=Q.isMinified;this.a=Q.args;Q.exceptionArgs&&(this.e=new Ob(Q.exceptionArgs))}}Object(f.a)(kc,"LoggingArgsLocalStorage",null,[]);var Ac=d(361);class Nc{constructor(Q,wa,eb,Lb,ec,Tc){this.t=Q;this.m=wa;this.s=eb;this.v=Lb;this.i=ec;this.a=Tc;this.op="Log"}}Object(f.a)(Nc,"LoggingKeyLocalStorage",null,[]);var kd=d(121);const Jd=(Q,wa,eb)=>!(void 0===Q||null===Q)&&!(void 0===Q.i||null===Q.i)&&!(void 0===Q.t||null===Q.t)&&!(void 0===Q.s||null===Q.s)&&"Log"===
Q.op&&Q.t===wa&&isFinite(Q.t)&&kd.a.Qd(Q.s)&&(void 0===Q.m||null===Q.m||Q.m===eb);class ge{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we,Rd,yf,rg){this.oSa=this.eOg=this.UNg=this.VNg=!1;this.sJ=this.G7a=this.M4=this.VR=null;this.Bl=!1;this.pqb=[];this.nRb=[];this.wxa=eb;this.cya=Lb;this.Txa=ec;this.hg=wa;this.Hb=Q;this.Krc=Tc;this.Zye=Ad;this.ZWg=we;this.DSa=Rd;this.$Jj=yf;this.oue=rg}get manifest(){return this.M4}get hQc(){return this.G7a}get RMa(){return this.sJ}init(){this.rYf();this.oSa=!1;this.hg.kWb(this);
this.VR=new Yb.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendAtBoot,"determineLogsToSendAtBoot"),103);this.Hb.$b(this.VR)}determineLogsToSendAtBoot(){this.Hxh(!0)}determineLogsToSendOnReconnect(){this.Hxh(!1)}Hxh(Q){this.aAd();this.pqb=[];Q&&(this.nRb=[]);for(var wa=0;wa<this.wxa.length;wa++){const eb=this.wxa.key(wa),Lb=ge.vgc(eb,!1);Jd(Lb,this.Krc,this.Zye)&&(Lb.s===this.Txa?Array.add(this.pqb,eb):Q&&Array.add(this.nRb,eb))}if(this.pqb.length||Q&&this.nRb.length)if(wa=this.oue?Object(a.a)(this,
this.jYn,"sortDescendKeysToUpload"):Object(a.a)(this,this.mYn,"sortKeysToUpload"),this.pqb.sort(wa),Q&&this.nRb.sort(wa),0<this.pqb.length||0<this.nRb.length)this.VR=new Yb.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),105),this.Hb.$b(this.VR)}mYn(Q){return Q.s!==Q.s?Q.s.localeCompare(Q.s):Q.i-Q.i}jYn(Q){return Q.s!==Q.s?Q.s.localeCompare(Q.s):Q.i-Q.i}ezc(Q,wa,eb,Lb){return JSON.stringify(new Nc(this.Krc,this.Zye,wa,eb,Q,Lb))}rYf(){this.G7a=new Gb.a;this.sJ=new pb.a;this.cya.J8g(Object(a.a)(this,
this.sHf,"onUlsReadyToBeSent"));this.cya.l9g(Object(a.a)(this,this.uHf,"onUlsSentSuccessfully"));this.cya.k9g(Object(a.a)(this,this.tHf,"onUlsSentFailed"));this.cya.A8g(Object(a.a)(this,this.GDf,"onAfterUlsHostDisposed"))}sHf(Q,wa){if(void 0!==wa&&null!==wa&&void 0!==wa.args&&null!==wa.args){if(this.hQc.xb(wa.args.tag))this.hQc.remove(wa.args.tag);else if(this.hQc.xb(dc.Hqd))this.hQc.remove(dc.Hqd);else if(!(this.$Jj&&50>wa.args.level))return;({value:Q}=this.RMa.Dc(wa.uM)).returnValue||(Q=new Ib(wa.sessionId,
wa.version,wa.xrd,wa.ZHf),this.RMa.Z(wa.uM,Q));this.RMa.J(wa.uM).mma.add(wa.args)}}uHf(Q,wa){this.RMa.remove(wa.uM)}tHf(Q,wa){void 0!==wa&&null!==wa&&this.RMa.xb(wa.uM)&&this.mqi(wa.uM)&&!this.eOg&&(this.eOg=!0,ja.ULS.sendTraceTag(37290073,222,50,"Added logs to local storage."))}mqi(Q){let wa=!1;if(({value:Lb}=this.RMa.Dc(Q)).returnValue&&Lb&&0<Lb.mma.count){if(Lb.xrd>=this.DSa)return!1;var eb=Lb.mma;const ec=Array(eb.count);for(let Tc=0,Ad=eb.count;Tc<Ad;++Tc)ec[Tc]=new kc(eb.J(Tc));eb=ge.serialize(ec);
var Lb=this.ezc(Lb.ZHf,Lb.sessionId,Lb.version,Lb.xrd);this.g2c(Lb,eb)&&(this.RMa.remove(Q),wa=!0)}return wa}GDf(){this.dispose()}g2c(Q,wa){try{return this.wxa.setItem(Q,wa),!0}catch(eb){return ja.ULS.sendTraceTag(37290074,222,15,"OfflineLogger SetItem failed with exception: {0}",eb.message),!1}}sendOfflineLogs(){if(!this.oSa){var Q=0<this.pqb.length?this.pqb:this.nRb,wa=Q.length;if(wa)for(;0<wa;){H.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IWacWordSendOfflineLogsV2ImprovementSettings");
wa--;var eb=this.oue?Q.pop():Q[0];this.oue||Array.removeAt(Q,0);const Tc=ge.vgc(eb,!0);if(Jd(Tc,this.Krc,this.Zye)){var Lb=this.wxa.getItem(eb);this.wxa.removeItem(eb);if(void 0!==Lb&&null!==Lb)if(Tc.a>this.DSa)ja.ULS.sendTraceTag(37290075,222,50,"Log has more attempt {0} than the max allowed {1}.",Tc.a,this.DSa);else if(eb=ge.vgc(Lb,!0),void 0!==eb&&null!==eb&&isFinite(eb.length))if(eb.length){Lb=eb[eb.length-1];var ec=(new Date).getTime()-Lb.ts;if(ec<-ge.c$i)ja.ULS.sendTraceTag(37290078,222,50,
"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",Lb.ts);else if(ec>this.ZWg*ge.c$i)ja.ULS.sendTraceTag(37290079,222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.ZWg,Lb.ts);else{Tc.s===this.Txa?this.VNg||(this.VNg=!0,ja.ULS.sendTraceTag(37290080,222,50,"Attempted to re-send logs from this session.")):this.UNg||(this.UNg=!0,ja.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",Tc.s));
wa=Array(eb.length);for(Lb=0;Lb<eb.length;Lb++){Q=Lb;a:{ec=eb[Lb];if(void 0===ec||null===ec){ec=null;break a}let Ad=null;ec.e&&(Ad=new Ac.a(null),Ad.name=ec.e.n,Ad.stack=ec.e.s,Ad.message=ec.e.m,Ad.file=ec.e.f,Ad.line=ec.e.l,Ad.column=ec.e.c);ec=new tb.a(ec.ts,ec.c,ec.t,ec.l,ec.m,ec.lt,ec.o,ec.a,Ad)}wa[Q]=ec}this.cya.LPi(this,wa,Tc.s,Tc.v,Tc.a+1,Tc.i);break}}else ja.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",Lb);else ja.ULS.sendTraceTag(37290076,222,15,"Unable to deserialize the offline log: {0}",
Lb)}}else this.aAd()}}z_a(Q,wa,eb){!this.Bl&&ja.ULS.u7(wa,eb)&&this.hQc.Z(Q,!0)}dispose(){if(!this.Bl){this.VR&&this.Hb.ef(this.VR);var Q=mc.toArray(this.RMa.keys);for(const wa of Q)this.mqi(wa)}this.Bl=!0}mNa(){this.oSa=!0;this.aAd()}mhb(){this.oSa=!1;this.aAd();this.VR&&this.Hb.ef(this.VR);this.VR=new Yb.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendOnReconnect,"determineLogsToSendOnReconnect"),102);this.Hb.$b(this.VR)}aAd(){this.VR&&(this.Hb.ef(this.VR),this.VR=null)}static serialize(Q){return JSON.stringify(Q)}static vgc(Q,
wa){try{return JSON.parse(Q)}catch(eb){wa&&ja.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",eb.message)}return null}}ge.c$i=864E5;Object(f.a)(ge,"OfflineLoggerImplV2",null,[1875,10,211]);class Oc{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(Q){return this.handleError("Length",Q),-1}}key(Q){try{return localStorage.key(Q)}catch(wa){return this.handleError("Key",wa),null}}getItem(Q){try{return localStorage.getItem(Q)}catch(wa){return this.handleError("GetItem",
wa),null}}setItem(Q,wa){try{return localStorage.setItem(Q,wa)}catch(eb){return this.handleError("SetItem",eb),null}}removeItem(Q){try{localStorage.removeItem(Q)}catch(wa){this.handleError("RemoveItem",wa)}}clear(){try{localStorage.clear()}catch(Q){this.handleError("Clear",Q)}}handleError(Q,wa){ja.ULS.sendTraceTag(19170128,222,10,"Invoking localStorage function[{0}] failed, message: {1}",Q,wa.message)}}Object(f.a)(Oc,"OfflineStorage",null,[1874]);class qc{create(Q){let wa=null;try{void 0!==localStorage&&
null!==localStorage&&(wa=new Oc)}catch(eb){ja.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",eb.message)}Object.getType(ja.ULS.host).implementsInterface(1059)&&wa||(ja.ULS.sendTraceTag(18614230,222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",wa?"supported":"not supported",Object.getType(ja.ULS.host).implementsInterface(1059)?"supported":"not supported"),Q=0);Q=1===Q?new hb(H.AFrameworkApplication.uc,H.AFrameworkApplication.Ze,wa,
ja.ULS.host,H.AFrameworkApplication.userSessionId):2===Q?new ge(H.AFrameworkApplication.uc,H.AFrameworkApplication.Ze,wa,ja.ULS.host,H.AFrameworkApplication.userSessionId,H.AFrameworkApplication.ua.Sb.jo,H.AFrameworkApplication.ua.Sb.wfa,H.AFrameworkApplication.K.rc("OfflineLoggerRetentionInDays",30),H.AFrameworkApplication.K.rc("OfflineLoggerMaxAttempts",5),H.AFrameworkApplication.K.$("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),H.AFrameworkApplication.K.$("SendOfflineLogsV2ImprovementIsEnabled")):
new Jc;Q.init();return Q}}Object(f.a)(qc,"OfflineLoggerFactory",null,[]);class Xc{zc(){}get name(){return"Common.App.OfflineLogger"}init(){const Q=H.AFrameworkApplication.K;let wa=0;Q.$("OneNoteOfflineLoggerIsEnabled")?wa=1:Q.$("OfflineLoggerV2IsEnabled")&&(wa=2);0!==wa&&(H.AFrameworkApplication.S3f=(new qc).create(wa))}dispose(){}}Object(f.a)(Xc,"OfflineLoggerPackage",null,[1,2]);var xe=d(1349);class Ge{constructor(Q){this.oni=null;ja.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");
this.KQc=H.AFrameworkApplication.K.lb("PhoneLinkServiceEndpoint");(this.I6=Q)||ja.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.KQc&&this.KQc.length||ja.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}A5k(Q){Q&&(this.KQc="https://dcg-df.microsoft.com/",ja.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.z5k()}z5k(){ja.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");
if(864E5>=+new Date-+this.oni)ja.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.oni=new Date;var Q=new Date;this.I6.aoa("BayBridge",this.KQc).then(wa=>{const eb=+new Date-+Q;wa.IsSuccess?(ja.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",eb),this.r5k(wa.Token,this.mgl())):ja.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",
eb,wa.ErrorCode,wa.ErrorMessage)}).catch(wa=>{ja.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",wa,+new Date-+Q)})}}r5k(Q,wa){const eb={};eb.Authorization="Bearer "+Q;eb["Authorization-Type"]="AAD";eb.Accept="application/json";H.AFrameworkApplication.Ze.Lj(wa,1,null,eb,!1,2,Object(a.a)(this,this.YHl,"getStatusSucceeded"),Object(a.a)(this,this.WHl,"getStatusFailed"),null,void 0,void 0,void 0,void 0,"39")}kil(){const Q=xe.a.instance.getItem("AccountLinkedStatusCache");
return Q&&Q.length?"true"===Q.toLowerCase()?!0:!1:!1}mgl(){return this.KQc+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}WHl(){ja.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}YHl(Q){ja.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");Q=Pa.a(Q.data.Ee).state+"";xe.a.instance.setItem("AccountLinkedStatusCache",Q)}}Object(f.a)(Ge,"PhoneLinkManager",null,[1794]);class bf{constructor(){this.W=
null}get name(){return"Common.App.PhoneLink"}zc(Q){this.W=Q;this.W.register(1794,"Common.App.PhoneLink.IPhoneLinkManager").singleInstance().Xd(()=>new Ge(this.W.resolve("Common.App.OAuth.IOAuthManager")))}init(){H.AFrameworkApplication.K.yq(()=>{this.YYa()})}YYa(){this.W.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){ca.a.instance.Pc(new bf)}}Object(f.a)(bf,"PhoneLinkPackage",null,[1,2]);const xd=Q=>{try{return Pa.a(Q)}catch(wa){}return null};class ke{constructor(Q,wa,
eb,Lb,ec,Tc){this.pY=!1;this.Mq=null;this.lBe=!1;this.ga=Q;this.hg=wa;this.Yj=eb;this.eNg=Lb;this.Ma=ec;this.EJj=Tc}init(Q,wa){wa&&Q.Za("Common.Interface.IRtcBasicProvider").execute(Object(a.a)(this,this.jRe,"awaitRtc"))}jRe(Q){const wa=Q.MHc();wa.continueWith(()=>{this.Mq=wa.result;this.lBe&&(this.Mq.kO(2,null,!0),this.lBe=!1);this.Mq.j1((eb,Lb)=>{2===Lb.type&&this.Ac.processAction(Na.a.fileNameUpdate,2)});this.Mq.xya((eb,Lb)=>{2===Lb.newState&&this.Ac.processAction(Na.a.fileNameUpdate,2)});2===
this.Mq.connectionState&&this.Ac.processAction(Na.a.fileNameUpdate,2)})}qKa(Q){this.$Dh(Q,!0)}$Dh(Q,wa){const eb=this.blk(Q.u4i),Lb={};Lb[ke.Bph]=ke.Cph;this.zPi.Lj(eb,2,"",Lb,!1,2,Object(a.a)(this,this.j$b,"onRefreshFilenameSuccess"),wa?Object(a.a)(this,this.eUm,"onRefreshFilenameFailureRetry"):Object(a.a)(this,this.Qxi,"onRefreshFilenameFailureNoRetry"),Q)}j$b(Q){this.pY=!1;const wa=xd(Q.data.Ee);Q.data.state.onSuccess(wa,this.eNg.value)}eUm(Q){5!==Q.data.status||this.pY?this.Qxi(Q):(this.pY=!0,
this.$Dh(Q.data.state,!1))}Qxi(Q){Q.data.state.onFailure(-1)}uyb(Q){this.aEh(Q,!0)}aEh(Q,wa){const eb=this.clk(),Lb={};Lb[ke.Bph]=ke.Cph;Lb[ke.sTl]=Vb.a.Ij(Q.GPi);Lb[ke.qTl]=this.EJj.value.cxk;this.zPi.Lj(eb,2,"",Lb,!1,2,Object(a.a)(this,this.ZSc,"onRenameFileSuccess"),wa?Object(a.a)(this,this.jUm,"onRenameFileFailureRetry"):Object(a.a)(this,this.Sxi,"onRenameFileFailureNoRetry"),Q)}clk(){return this.hgh()}blk(Q){let wa=this.hgh();return wa=Wb.a.Bp(wa,ke.wTl,Q?"2":"1")}hgh(){let Q=(this.Ma.value.appSettings.RenameWebServiceBase||
"")+ke.rTl;Q=Wb.a.Bp(Q,ke.tTl,Vb.a.Ij(H.AFrameworkApplication.um));this.Ep&&this.Ep.ipf&&(Q=Wb.a.Bp(Q,ke.vTl,"1"));return Q}ZSc(Q){this.pY=!1;const wa=xd(Q.data.Ee);Q.data.state.onSuccess(wa,this.eNg.value);this.Osi()}Osi(){this.Mq?this.Mq.kO(2,null,!0):this.lBe=!0}jUm(Q){5!==Q.data.status||this.pY?this.Sxi(Q):(this.pY=!0,this.aEh(Q.data.state,!1))}Sxi(Q){Q.data.state.onFailure(-1)}get Ac(){return this.ga.value}get zPi(){return this.hg.value}get Ep(){return this.Yj.value}static get instance(){return ke._instance||
(ke._instance=ke.hzb())}static hzb(){return new ke(new kb.a(()=>H.AFrameworkApplication.ya),new kb.a(()=>H.AFrameworkApplication.Ze),new kb.a(()=>H.AFrameworkApplication.Ep),new kb.a(()=>ea.a.instance.resolve("Postmessage.IHostPostmessenger")),new kb.a(()=>H.AFrameworkApplication.K),new kb.a(()=>ea.a.instance.resolve("Common.IRenameProps")))}}ke.Bph="Content-Type";ke.Cph="application/json; charset=utf-8";ke.rTl="renamehandler.ashx";ke.tTl="qs";ke.sTl="n";ke.vTl="sl";ke.qTl="X-CoauthLockId";ke.wTl=
"u";ke._instance=null;Object(f.a)(ke,"ExecuteRenameFileHandler",null,[]);class Rf{constructor(){this.onFailure=this.onSuccess=null;this.u4i=!1}}Object(f.a)(Rf,"ExecuteRefreshFilenameData",null,[]);class pd{constructor(){this.onFailure=this.onSuccess=this.GPi=null}}Object(f.a)(pd,"ExecuteRenameFileData",null,[]);class fe{constructor(){this.W=null;this.Fne=ke.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}zc(Q){this.W=Q}init(){H.AFrameworkApplication.K.yq(Object(a.a)(this,this.Ww,
"onFullAppSettingsReady"))}Ww(){H.AFrameworkApplication.iOc()&&(ke.instance.init(this.W,H.AFrameworkApplication.lXc),H.AFrameworkApplication.uyb=Object(a.a)(this,this.uyb,"executeRenameFile"),H.AFrameworkApplication.qKa=Object(a.a)(this,this.qKa,"executeRefreshFilename"),H.AFrameworkApplication.SYc=Object(a.a)(this,this.SYc,"sendFileNameAndLocationUpdateNotification"))}uyb(Q,wa,eb){const Lb=new pd;Lb.GPi=Q;Lb.onSuccess=wa;Lb.onFailure=eb;this.Fne.uyb(Lb)}qKa(Q,wa,eb){const Lb=new Rf;Lb.onSuccess=
Q;Lb.onFailure=wa;Lb.u4i=eb;this.Fne.qKa(Lb)}SYc(){this.Fne.Osi()}dispose(){}}Object(f.a)(fe,"PackageManager",null,[1,2]);var Ec=d(141);class rd{constructor(Q,wa,eb){this.i_f=this.j_f=this.k_f=!1;this.x_f=!Q&&!wa;this.y_f=!Q&&!eb;this.x_f||this.y_f||(this.k_f=!Q,this.j_f=!wa,this.i_f=!eb)}}Object(f.a)(rd,"RenameDisabledDialogInfo",null,[]);class Ld extends Ec.StandardDialog{constructor(Q,wa,eb,Lb,ec){super();this.A3f=[];this.gca=new rd(Q,wa,eb);this.T9a=Lb;this.l7a=ec;this.kg="RenameDisabledDialog";
this.Ed=0;this.We(1,CommonUIStrings.l_DialogClose);this.iNn();this.krn()}iNn(){this.gca.x_f?this.M_c(this.T9a?this.l7a?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.gca.y_f?this.M_c(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.L1j();this.sxc(this.A3f)}M_c(Q){Array.add(this.A3f,Q)}L1j(){const Q=[];this.gca.k_f||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledSignIn);
this.gca.j_f||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.gca.i_f||Array.add(Q,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<Q.length&&Array.add(this.A3f,Q)}}Object(f.a)(Ld,"ReactRenameDisabledDialogBase",Ec.StandardDialog,[]);class Gf extends Ld{constructor(Q,wa,eb,Lb,ec){super(Q,wa,eb,Lb,ec)}krn(){this.ahb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(f.a)(Gf,"ReactRenameDisabledDialog",Ld,[]);var ld=d(153);class Pc{static get ug(){return ld.a.Lx(Pc.rl,
CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}Pc.rl="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(f.a)(Pc,"RenameDisabledDialogHtml",null,[]);class cd extends ld.a{constructor(Q,wa,eb,Lb,ec){super();this.gca=new rd(Q,wa,eb);this.T9a=Lb;this.l7a=ec;this.kg="RenameDisabledDialog";this.Ed=0;this.We(1,CommonUIStrings.l_DialogClose);this.ug=Pc.ug;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.m3("RenameRow")}UT(){if(this.gca.x_f){let Q;Q=this.T9a?this.l7a?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;cd.M_c(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Q)}else this.gca.y_f?cd.M_c(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.uWl()}uWl(){this.gca.k_f&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.gca.j_f&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.gca.i_f&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static M_c(Q,wa,eb){Q.style.display="none";wa.innerText=eb}}Object(f.a)(cd,"RenameDisabledDialog",ld.a,[]);var Aa=d(60);class Wa{constructor(Q,wa){this.Tqb=0;this.ga=Q;this.fGa=wa}initialize(Q){if(!this.ga||!this.fGa)return!1;this.Tqb=Q;this.Vb();return!0}Vb(){this.ga.pa(Na.a.RWe,Aa.a.frame,Object(a.a)(this,this.RWe,"commitNewDocumentTitle"))}RWe(Q,wa,eb,Lb,ec){if(1===eb)return this.ga.processAction(Na.a.renameFile,
1);Q=Vb.a.eI(this.fGa.yz);ec=(0,ec.getNewDocumentTitle)();ec.length>this.Tqb&&(ec=ec.substr(0,this.Tqb));if(32!==this.ga.Xb(Na.a.renameFile,2,ec))return this.Pgc(Q),8;this.Pgc(ec);return 32}Pgc(Q){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(Q))}static Fl(){return new Wa(H.AFrameworkApplication.ya,H.AFrameworkApplication.ut)}}Object(f.a)(Wa,"ReactRenameUIHandler",null,[1873]);var $b=d(221),xc=d(1015),bd=d(463),Wd=d(85),vf=d(144),uf=d(29);class oe{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we,
Rd,yf,rg,vi){this._initialized=!1;this._element=null;this.Tqb=0;this.bFe=this.bre=!1;this.ga=Q;this.uha=wa;this.re=eb;this.Er=Lb;this.fGa=ec;this.ZXg=Tc;this.lkd=Ad;this.Sie=we;this.L6a=Rd;this.kKg=yf;this.yi=rg;this.Lse=vi}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(Q,wa,eb){if(!(this.ga&&this.fGa&&this.ZXg&&this.lkd&&this.Sie&&wa)||0>=Q)return!1;this._element=wa;this._element.title=eb;this._element.setAttribute(uf.a.Ah,uf.a.n1);this._element.setAttribute("Unselectable",
"on");this.Tqb=Q;this.HA();return this._initialized=!0}HA(){this.uha&&(this.uha.mb(B.a.blur,this._element,Object(a.a)(this,this.onBlur,"onBlur")),this.uha.mb(B.a.paste,this._element,Object(a.a)(this,this.VSc,"onPaste")));this.re.mb(B.a.Di,this._element,Object(a.a)(this,this.onKeyDown,"onKeyDown"));this.Er.mb(B.a.pointerDown,this._element,Object(a.a)(this,this.NB,"onPointerDown"));this.Er.mb(B.a.$L,this._element,Object(a.a)(this,this.nua,"onPointerUp"))}onBlur(){this.isActive&&!this.bre&&(this.kKg||
this.Sie(this._element),this.Onh(),this.T0e(!1));return this.bre=!1}VSc(){ja.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(Q){return this.isActive?this.ORm(Q):this.PRm(Q)}ORm(Q){let wa=!1;switch(Q.Ib.keyCode){case Sys.UI.Key.enter:this.Onh();this.T0e(this.yi||this.Lse);wa=!0;break;case Sys.UI.Key.tab:this.kKg&&this.Sie(this._element);break;case Sys.UI.Key.esc:this.aTf(),this.T0e(this.yi||this.Lse),wa=!0}return wa}PRm(Q){let wa=!1;switch(Q.Ib.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.Abj(this.Lse),
this.isActive&&this.lkd(this._element),wa=!0}return wa}NB(){this.isActive||(this.Abj(!1),this.isActive&&(this._element.focus(),this.lkd(this._element),this.bFe=!0));return!1}nua(){return this.bFe?(this.lkd(this._element),this.bFe=!1,!0):!1}J6b(){return 32===this.ga.processAction(Na.a.renameFile,1)}Onh(){const Q=Vb.a.eI(this.fGa.yz);let wa=this._element.innerText.trim();wa.length>this.Tqb&&(wa=wa.substr(0,this.Tqb));wa!==Q&&""!==wa?32!==this.ga.Xb(Na.a.renameFile,2,wa)?this.aTf():this.Pgc(wa):this.aTf()}aTf(){this.Pgc(Vb.a.eI(this.fGa.yz))}Pgc(Q){this._initialized&&
(this._element.innerText=Q,this.ZXg())}Abj(Q){this.J6b()?this.isActive||(Q&&(this.bre=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(uf.a.Ah,uf.a.Hch),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,$b.CuiHelper.KAh),this.L6a&&this.L6a.execute(wa=>{wa.PHi(!0)}),Q&&this._element.focus(),ja.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ga.processAction(Na.a.mec,
2)}T0e(Q){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(uf.a.Ah,uf.a.n1);Sys.UI.DomElement.removeCssClass(this._element,$b.CuiHelper.KAh);this.L6a&&this.L6a.execute(wa=>{wa.PHi(!1)});Q&&(this._element.blur(),this._element.focus())}static ava(){xc.a.ava(H.AFrameworkApplication.isRtl)}static Fl(){return new oe(H.AFrameworkApplication.ya,bd.a.instance,Wd.KeyInputManager.instance,vf.a.instance,H.AFrameworkApplication.ut,oe.ava,
ia.a.CBn,ia.a.Jlh,ea.a.instance.Za("Common.App.Header.HeaderEventSource"),ua.a.IB,ua.a.ki,ua.a.fj)}}Object(f.a)(oe,"RenameUIHandler",null,[1873]);class Pe{static get instance(){return H.AFrameworkApplication.ua.Sb.sI?Pe._instance||(Pe._instance=Wa.Fl()):Pe._instance||(Pe._instance=oe.Fl())}}Pe._instance=null;Object(f.a)(Pe,"RenameUIHandlerFactory",null,[]);var We=d(112);class Xi{constructor(){this.aCf=this.iJm=this.tNk=null}}Object(f.a)(Xi,"RenameMruEntryProperties",null,[]);var zf=d(163),sf=d(86),
Ye=d(1512),Bh;(function(Q){Q[Q.unknown=-1]="unknown";Q[Q.success=0]="success";Q[Q.renameInvalidFileName=1]="renameInvalidFileName";Q[Q.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";Q[Q.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";Q[Q.permissionDenied=4]="permissionDenied";Q[Q.serverCommunicationFailure=5]="serverCommunicationFailure";Q[Q.fileNameTooLong=6]="fileNameTooLong"})(Bh||(Bh={}));Object(f.b)("CommonOperationResult",Bh);class Sg{constructor(Q,wa,eb,Lb,ec,Tc,
Ad,we,Rd,yf,rg,vi){this.FKg=Q;this.ga=wa;this.Yj=eb;this.IK=Lb;this.Bqb=ec;this.QXj=Tc;this.T9a=Ad;this.Y2g=we;this.JQj=Rd;this.l7a=yf;this.Ma=rg;this.IQj=vi}Vb(){H.AFrameworkApplication.ua&&H.AFrameworkApplication.ua.Sb.sI||this.Ac.pa(Na.a.J4b,Aa.a.frame,Object(a.a)(this,this.J4b,"initializeRenameUIHandler"));this.Ac.pa(Na.a.mec,Aa.a.frame,Object(a.a)(this,this.mec,"showRenameDisabledDialog"));this.Ac.pa(Na.a.renameFile,Aa.a.frame,Object(a.a)(this,this.renameFile,"renameFile"));this.Ac.gb(Na.a.fileNameUpdate,
Aa.a.frame,Object(a.a)(this,this.zhn,"refreshFilename"),64);this.Ac.gb(Na.a.cUd,Aa.a.frame,Object(a.a)(this,this.cUd,"moveToFolderCompleteByHost"),64);this.Ac.pa(Na.a.$Eb,Aa.a.frame,Object(a.a)(this,this.$Eb,"moveToFolder"));H.AFrameworkApplication.ua&&(H.AFrameworkApplication.K.$("PostMessageEmbedded")||H.AFrameworkApplication.K.$("IsJsApi"))&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0)&&H.AFrameworkApplication.WP().execute(Q=>{Q.vv(sf.a.Gqi);
Q.VB(sf.a.Gqi,Sg.wen);Q.vv(sf.a.r7e);Q.VB(sf.a.r7e,Sg.uen)})}J6b(){return 0===this.IQj.pWh()?32:8}amo(){return this.Ep?this.T9a?this.Ep.Rzh:this.Ep.Kcb:!0}J4b(){return Pe.instance.initialize(H.AFrameworkApplication.mBd,H.AFrameworkApplication.Jzh,H.AFrameworkApplication.MNi||CommonUIStrings.l_RenameFileTooltip)?32:8}mec(){const Q=this.amo(),wa=this.QXj();ja.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.Bqb,wa,Q,this.T9a);H.AFrameworkApplication.ua&&H.AFrameworkApplication.ua.Sb.zA&&H.AFrameworkApplication.K.$("ReactRenameDisabledDialogIsEnabled")?new Gf(this.Bqb,!wa,!Q,this.T9a,this.l7a()):new cd(this.Bqb,!wa,!Q,this.T9a,this.l7a());return 32}renameFile(Q,wa,eb,Lb,ec){if(1===eb)return this.J6b();if(!H.AFrameworkApplication.uyb)return 8;if(8===this.J6b())return this.Ac.processAction(Na.a.mec,2),8;ja.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");H.AFrameworkApplication.uyb(ec,Object(a.a)(this,
this.ZSc,"onRenameFileSuccess"),Object(a.a)(this,this.iUm,"onRenameFileFailure"));return 32}ZSc(Q,wa){Q?0!==Q.OperationResult?this.i1h(Q.OperationResult):(this.lDn(wa,Q.NewName),this.deo(Q,Object(a.a)(H.AFrameworkApplication.ua.Sb,H.AFrameworkApplication.ua.Sb.Zfj,"updateOpenInClientDocumentUrl")),H.AFrameworkApplication.K.$("DocumentNameInJewelInfoMenuIsEnabled")&&H.AFrameworkApplication.ua.updateCommandUI(),this.JQj.Xdj()):this.i1h(5)}lDn(Q,wa){const eb={};eb[zf.a.X5k]=wa;Q.sendMessage(sf.a.r7e,
eb)}deo(Q,wa){this.oeo(Q);H.AFrameworkApplication.syd=Q.DirectInvokeDavUrl;wa=wa(Q.EditDocInClientUrl);const eb=new Xi;eb.aCf=this.IK.yz;eb.tNk=wa;eb.iJm=Q.EditDocInClientUrl;this.Ac.Xb(Na.a.NNi,2,eb)}i1h(Q){switch(Q){case 1:Q=new Ec.StandardDialog,Q.Ed=0,Q.nU(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.AQi()}}oeo(Q){this.IK.yz=Sg.mak(this.IK.yz,Q.NewName);Q.BreadcrumbFolderName&&(this.IK.breadcrumbFolderName=Q.BreadcrumbFolderName);Q.BreadcrumbFolderUrl&&
(this.IK.breadcrumbFolderUrl=Q.BreadcrumbFolderUrl);this.Y2g(Q.NewName)}iUm(Q){const wa=new Ec.StandardDialog;wa.Ed=0;switch(Q){case 1:ja.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");wa.Bga(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:ja.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");wa.Bga(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;
default:ja.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:Q}),wa.Bga(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}H.AFrameworkApplication.WP().execute(eb=>{eb.sendMessage(sf.a.W5k,{["FailureMessage"]:Bh[Q]})});this.AQi()}zhn(Q,wa,eb){if(1===eb)return this.J6b();if(!H.AFrameworkApplication.qKa)return 8;H.AFrameworkApplication.qKa(Object(a.a)(this,this.j$b,"onRefreshFilenameSuccess"),Object(a.a)(this,this.UWd,"onRefreshFilenameFailure"),
!1);return 32}$Eb(Q,wa,eb,Lb,ec){if(1===eb)return H.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?32:8;if(2===eb){const Tc={};Q=H.AFrameworkApplication.tDb;wa=H.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");Q=(!Q||Q&&wa)&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);Tc[zf.a.O1n]=Q;ec&&ec.MoveButtonClickedTime&&(Tc[zf.a.CHm]=ec.MoveButtonClickedTime.getTime());H.AFrameworkApplication.WP().execute(Ad=>{Ad.sendMessage(sf.a.$Eb,
Tc)});if(ec&&ec.MoveButtonClickedTime){if(Q=We.a.aF())ec=(new Date).getTime()-ec.MoveButtonClickedTime.getTime(),Q.set("MovePostDuration",ec.toString());Ga.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",Q)}return 32}return 8}cUd(Q,wa,eb,Lb,ec){if(1===eb)return H.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?this.J6b():8;if(2===eb){if(!H.AFrameworkApplication.SYc)return Ga.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),
8;if(!ec)return Ga.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(ec[zf.a.R9l])if(ec[zf.a.Ahj])if(Q=ec[zf.a.Ahj].toLowerCase(),wa=H.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"),eb=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),wa&&H.AFrameworkApplication.tDb&&eb){const Tc={};Tc[zf.a.obc]="1";Tc[zf.a.documentUrl]=Q;Tc[zf.a.reason]=Ye.a.nUf;Ga.Health.instance.recordKpiSuccess("MoveToFolder",null);
H.AFrameworkApplication.WP().execute(Ad=>{Ad.sendMessage(sf.a.Vxb,Tc)})}else if(!H.AFrameworkApplication.tDb&&eb)Ga.Health.instance.recordKpiSuccess("MoveToFolder",null),ia.a.ym(Q,ia.a.poa(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return Ga.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else Ga.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else H.AFrameworkApplication.qKa(Object(a.a)(this,this.j$b,"onRefreshFilenameSuccess"),
Object(a.a)(this,this.UWd,"onRefreshFilenameFailure"),!1),H.AFrameworkApplication.SYc(),Ga.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}sTn(Q,wa){return Q&&wa?Q!==this.IK.breadcrumbFolderName||wa!==this.IK.breadcrumbFolderUrl:!1}j$b(Q,wa){Q&&(Q.NewName!==Vb.a.eI(this.IK.yz)||this.sTn(Q.BreadcrumbFolderName,Q.BreadcrumbFolderUrl))&&this.ZSc(Q,wa)}UWd(){}AQi(){this.Y2g(Vb.a.eI(this.IK.yz))}get Ac(){return this.ga.value}get Ep(){return this.Yj.value}static get instance(){return Sg._instance||
(Sg._instance=Sg.hzb())}static hzb(){return new Sg(H.AFrameworkApplication.iOc,new kb.a(()=>H.AFrameworkApplication.ya),new kb.a(()=>H.AFrameworkApplication.Ep),H.AFrameworkApplication.ut,H.AFrameworkApplication.Kta,()=>H.AFrameworkApplication.o8f,H.AFrameworkApplication.lXc,Object(a.a)(Pe.instance,Pe.instance.Pgc,"updateTitle"),ea.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>H.AFrameworkApplication.Eu,H.AFrameworkApplication.K,ea.a.instance.resolve("Common.IRenameProps"))}static mak(Q,
wa){Q=Vb.a.WKa(Q);return wa+Q}static wen(Q){const wa=Q.Values[zf.a.wem];ja.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",wa);wa?H.AFrameworkApplication.ya.Xb(Na.a.cUd,2,Q.Values):Ga.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static uen(Q){H.AFrameworkApplication.ya.Xb(Na.a.renameFile,2,Q.Values.NewName)}}Sg._instance=null;Object(f.a)(Sg,"RenameActor",null,[]);var Ti=d(127),ig=d(1353),Tg=d(564),af=d(388);class qf{constructor(Q,
wa){this.ga=Q;this.ylc=wa}Vb(){this.ga.pa(Na.a.t_f,Aa.a.frame,Object(a.a)(this,this.gWn,"showRenameDialogAction"))}gWn(Q,wa,eb){Q=32;if(1===eb)return af.SessionStatusManager.instance.Qj||H.AFrameworkApplication.Pla?8:32;2===eb&&(32!==this.ga.processAction(Na.a.renameFile,1)?(this.ga.processAction(Na.a.mec,2),Ti.a.instance.Yb(ig.a.Aka,{["Reason"]:Tg.a.tqn}),Q=8):32===this.ga.processAction(Na.a.nec,1)?this.ga.processAction(Na.a.nec,2):this.ylc.value.create().nPa());return Q}}Object(f.a)(qf,"RenameDialogActor",
null,[1877]);class gj{constructor(Q,wa,eb){this.dialog=null;this.ga=Q;this.IK=wa;this.s6a=eb}lEl(){const Q={};Q.nameInputProps={["type"]:"AppInputProps",["id"]:gj.P_b,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:Vb.a.eI(this.IK.yz),["maxLength"]:this.s6a};return Q}nPa(){const Q={["id"]:"RenameDialog",["bodyControls"]:this.lEl()};this.dialog=new ld.a(!1,!1,!0);this.dialog.Ed=1;this.dialog.kg="RenameDialog";this.dialog.Zh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.sRf,"renameDialogHandler"),
Q)}sRf(Q,wa){if(wa&&1===Q){if(wa[gj.P_b]&&(Q=Vb.a.eI(this.IK.yz),wa=(wa[gj.P_b]||"").trim(),wa!==Q&&""!==wa)){this.ga.Xb(Na.a.renameFile,2,wa);return}Ti.a.instance.Yb(ig.a.L_b,{["Reason"]:Tg.a.yFh})}}}gj.P_b="txtDocumentName";Object(f.a)(gj,"ReactRenameDialog",null,[1916]);class Fe{static get ug(){return ld.a.Lx(Fe.rl,CommonUIStrings.l_RenameDialogLabel)}}Fe.rl="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(f.a)(Fe,"RenameDialogHtml",null,[]);class $e extends ld.a{constructor(Q,wa,eb){super();this.ga=Q;this.IK=wa;this.s6a=eb;this.kg="RenameDialog";this.ug=Fe.ug}nPa(){var Q={["txtDocumentName"]:Vb.a.eI(this.IK.yz)};this.Zh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.sRf,"renameDialogHandler"),Q);Q=document.getElementById($e.P_b);0<this.s6a&&(Q.maxLength=this.s6a);Q.focus()}sRf(Q,wa){if(1===Q&&(Q=Vb.a.eI(this.IK.yz),wa=(wa[$e.P_b]||"").trim(),wa!==Q&&""!==wa)){this.ga.Xb(Na.a.renameFile,
2,wa);return}Ti.a.instance.Yb(ig.a.L_b,{["Reason"]:Tg.a.yFh})}}$e.P_b="txtDocumentName";Object(f.a)($e,"RenameDialog",ld.a,[1916]);class Ff{constructor(Q){this.fGa=null;this.s6a=0;this.ga=Q;this._initialized=!1}initialize(Q,wa){this.fGa=Q;this.s6a=wa;this._initialized=!0}create(){return this._initialized?H.AFrameworkApplication.ua&&H.AFrameworkApplication.ua.Sb.zA&&H.AFrameworkApplication.K.$("ReactRenameDialogIsEnabled")?new gj(this.ga,this.fGa,this.s6a):new $e(this.ga,this.fGa,this.s6a):null}}Object(f.a)(Ff,
"RenameDialogFactory",null,[1876]);var ye=d(160),Sf=d(57),vg=d(159),Tf=d(83);class wg{constructor(Q,wa){this.ga=Q;this.Wb=wa}Vb(){this.ga.pa(Na.a.nec,Aa.a.frame,Object(a.a)(this,this.hWn,"showRenameFlyoutAction"))}Gpk(){return vg.d("setDocumentTitleFlyoutOpened")&&H.AFrameworkApplication.ua.Sb.sI}hWn(Q,wa,eb){if(1===eb)return this.Gpk()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}B3j(){wg.Gim&&H.AFrameworkApplication.r2&&Tf.a.instance.$b(new Yb.a(5,1,
5E3,()=>{32===this.ga.processAction(Na.a.nec,1)&&this.Wb&&this.Wb.xg.name===ye.AFrame.Xp&&(Sf.a("RenameFloatieShownOnNewDocumentLoad",!0),this.ga.processAction(Na.a.nec,2))}))}static get Gim(){wg.ndd&&null!=wg.ndd||(H.AFrameworkApplication.Hf("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),wg.ndd=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return wg.ndd}}wg.ndd=null;
Object(f.a)(wg,"RenameFlyoutActor",null,[1862]);class rf{constructor(Q,wa,eb,Lb,ec){this.cxk=null;this.Yj=ec;this.GKg=eb;this.FKg=Lb;this.SXj=Q;this.l7a=wa}get Ep(){return this.Yj.value}pWh(){if(!this.FKg())return 5;if(this.l7a())return 1;if(this.Ep){if(this.GKg&&!this.Ep.Rzh)return 3;if(!this.GKg&&!this.Ep.Kcb)return 4}return this.SXj()?0:2}}Object(f.a)(rf,"RenameProps",null,[1861]);class sh{constructor(Q,wa,eb,Lb,ec,Tc){this.Pl=!1;this.Qve=new lb.a;this.dPb=wa;this.my=eb;this.TNb=Lb;this.Ma=ec;
this.Qia=Tc}enable(){this.Pl||(this.Xdj(),this.Z0f(),this.Pl=!0)}generateKey(Q,wa,eb){return String.format("{0}/{1}/{2}",eb,Q,wa)}xul(){const Q=Vb.a.eI(this.dPb().yz);return this.generateKey(this.dPb().breadcrumbFolderName,this.dPb().breadcrumbFolderUrl,Q)}yul(Q,wa,eb){return Q&&wa?this.generateKey(Q,wa,eb):eb}fUk(Q,wa,eb){return Q&&Q!==this.dPb().breadcrumbFolderName||wa&&wa!==this.dPb().breadcrumbFolderUrl?!0:eb!==Vb.a.eI(this.dPb().yz)}Xdj(){const Q=this.xul();this.Qve.Z(Q,new Date)}TJf(Q){this.ERn(Q)&&
this.h5g(Q)}ERn(Q){const wa=this.TNb();return wa?this.Qia&&this.Qia.io||!wa.ipf||!H.AFrameworkApplication.qKa?(this.N6i(Q),this.Pl=!1):!0:!1}Myi(Q,wa,eb,Lb){const ec=this.fUk(Q,wa,eb);Q=this.yul(Q,wa,eb);wa=this.Qve.Dc(Q).returnValue;ec&&!wa&&(this.k1h(Lb),ja.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.owf));ec||this.Qve.Z(Q,this.my())}}Object(f.a)(sh,"ARenamedFileChecker",null,[1831]);class si extends sh{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we){super(Q,wa,eb,Lb,ec,Tc);this.xJ=ec;
this.HQj=Ad;this.Fqe=we}get owf(){return"RenamedFileCheckerUsingSettingsRefresh"}Z0f(){this.xJ.Kxc(Object(a.a)(this,this.D1h,"handleSettingsRefresh"))}D1h(Q,wa){wa&&wa.iFb&&wa.Kti&&(wa.qMa("BreadcrumbDocName")||wa.qMa("BreadcrumbFolderName")||wa.qMa("BreadcrumbFolderUrl")||wa.qMa("DirectInvokeDAVUrl")||wa.qMa("EditDocInClientUrl"))&&(ja.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.owf),this.TJf(wa))}N6i(){this.xJ.DNi(Object(a.a)(this,this.D1h,"handleSettingsRefresh"))}h5g(Q){if(Q&&
Q.iFb){const wa=Q.iFb;this.Myi(wa.lb("BreadcrumbFolderName"),wa.lb("BreadcrumbFolderUrl"),wa.lb("BreadcrumbDocName"),Q)}}k1h(Q){const wa={OperationResult:0,classId:1};Q=Q.iFb;wa.BreadcrumbFolderName=Q.lb("BreadcrumbFolderName");wa.BreadcrumbFolderUrl=Q.lb("BreadcrumbFolderUrl");wa.DirectInvokeDavUrl=Q.lb("DirectInvokeDAVUrl");wa.EditDocInClientUrl=Q.lb("EditDocInClientUrl");Q=Q.lb("BreadcrumbDocName");wa.NewName=H.AFrameworkApplication.LDc?Q:Vb.a.eI(Q);this.Fqe.execute(eb=>{this.C6l(wa,eb)})}C6l(Q,
wa){this.HQj().ZSc(Q,wa)}}Object(f.a)(si,"RenamedFileCheckerUsingSettingsRefresh",sh,[]);class Dg extends sh{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we,Rd,yf){super(Q,eb,Lb,ec,Tc,Rd);this.Htc=this.In=null;this.YOj=wa;this.ga=Ad;this.Hb=we;yf&&yf.execute(rg=>{this.Jln(rg)})}get owf(){return"RenamedFileCheckerUsingTask"}Jln(Q){this.In=Q;this.In.Tub(Object(a.a)(this,this.o$,"handleVisibilityChange"))}o$(Q,wa){!this.Pl||0!==wa.newState&&1!==wa.newState||this.Htc||(this.Z0f(),this.TJf(this.Htc))}Z0f(){this.Htc=
new Yb.a(3,2,this.YOj(),Object(a.a)(this,this.TJf,"performRenameFileCheckTick"),89);this.Hb.$b(this.Htc)}N6i(Q){this.Hb.ef(Q)}h5g(Q){this.In&&2===this.In.PD?this.vnn(Q):H.AFrameworkApplication.qKa(Object(a.a)(this,this.j$b,"onRefreshFilenameSuccess"),Object(a.a)(this,this.UWd,"onRefreshFilenameFailure"),!0)}vnn(Q){this.Hb.ef(Q);this.Htc=null}j$b(Q){Q&&this.Myi(Q.BreadcrumbFolderName,Q.BreadcrumbFolderUrl,Q.NewName,null)}k1h(){this.ga.processAction(Na.a.fileNameUpdate,2)}UWd(){}}Object(f.a)(Dg,"RenamedFileCheckerUsingTask",
sh,[]);var ai=d(56);class Ue{constructor(){this.Ma=this.W=null}get name(){return"Common.App.RenameFile"}zc(Q){this.W=Q;this.Ma=H.AFrameworkApplication.K;this.W.register(qf,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Xd(()=>new qf(H.AFrameworkApplication.ya,this.W.Ye("Common.App.Rename.IRenameDialogFactory"))).singleInstance();this.W.register(Ff,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Xd(()=>new Ff(H.AFrameworkApplication.ya)).singleInstance();
this.W.register(1831,"Common.App.Rename.IRenamedFileChecker").Xd(()=>this.OKk()).singleInstance();this.W.register(wg,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Xd(()=>new wg(H.AFrameworkApplication.ya,ai.FocusManager.instance())).singleInstance()}OKk(){if(this.Ma.$("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const Q=this.W.Pa("Common.IRefreshableAppSettings");if(Q&&Q.Nei)return new si(()=>Q.rc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>H.AFrameworkApplication.ut,
()=>new Date,()=>H.AFrameworkApplication.Ep,Q,this.W.Pa("Common.ISessionStatus"),()=>Sg.instance,this.W.Za("Postmessage.IHostPostmessenger"))}return new Dg(()=>this.Ma.rc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Ma.rc("RenamedFileCheckerPingIntervalInMs",12E4),()=>H.AFrameworkApplication.ut,()=>new Date,()=>H.AFrameworkApplication.Ep,H.AFrameworkApplication.K,H.AFrameworkApplication.ya,H.AFrameworkApplication.uc,this.W.Pa("Common.ISessionStatus"),this.W.Za("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Ma.yq(Object(a.a)(this,
this.Ww,"onFullAppSettingsReady"))}Ww(){const Q=H.AFrameworkApplication.ua.Sb.sI;H.AFrameworkApplication.iOc()&&Pe.instance.initialize(H.AFrameworkApplication.mBd,Q?null:H.AFrameworkApplication.Jzh,Q?null:H.AFrameworkApplication.MNi||CommonUIStrings.l_RenameFileTooltip)&&(this.W.register(rf,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Xd(()=>new rf(()=>H.AFrameworkApplication.o8f,()=>H.AFrameworkApplication.Eu,H.AFrameworkApplication.lXc,H.AFrameworkApplication.iOc,new kb.a(()=>H.AFrameworkApplication.Ep))).singleInstance(),
Sg.instance.Vb(),this.Ma.$("RenameDialogIsEnabled")&&(this.W.resolve("Common.App.Rename.RenameDialogFactory").initialize(H.AFrameworkApplication.ut,H.AFrameworkApplication.mBd),this.W.resolve("Common.App.Rename.IRenameDialogActor").Vb()),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").Vb(),H.AFrameworkApplication.lXc&&this.W.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").B3j())}dispose(){}}Object(f.a)(Ue,"PackageManager",null,
[1,2]);class ed{static get ug(){return ld.a.Lx(ed.rl,CommonUIStrings.l_SaveACopyFileName)}}ed.rl="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(f.a)(ed,"FileNameDialogHtml",null,[]);class Dl extends ld.a{constructor(Q,
wa,eb,Lb){super();this.K$c=this.CGa=null;this.ga=Q;this.voa=wa;this.ywc=eb;this.We(1,CommonUIStrings.l_SaveButtonLabel);this.ug=ed.ug;this.kg="FileNameDialog-SaveACopy";this.Fm=Lb}Uza(Q,wa,eb){this.K$c=Q;this.CGa=eb;Q={["txtFileName"]:Vb.a.eI(H.AFrameworkApplication.ut.yz),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,wa)};this.Zh(CommonUIStrings.l_SaveToOneDrive,Object(a.a)(this,this.lBd,"fileNameDialogHandler"),Q);ja.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");
document.getElementById("txtFileName").focus()}lBd(Q,wa){1!==Q?ja.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(Q=wa.txtFileName.trim(),ja.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),wa=Vb.a.WKa(H.AFrameworkApplication.fileName),Q&&""!==Q&&""!==wa&&(Q+=wa),this.ywc.gEa(this.K$c,this.CGa,Q,this.Fm))}}Object(f.a)(Dl,"FileNameDialog",ld.a,[1859]);class Hi{constructor(Q,wa,eb){this.ga=Q;this.voa=wa;this.ywc=eb}create(Q){return new Dl(this.ga,
this.voa,this.ywc,Q)}}Object(f.a)(Hi,"FileNameDialogFactory",null,[1830]);class tk extends Ec.StandardDialog{constructor(Q){super();this.Ed=1;this.We(1,CommonUIStrings.l_RetryButtonLabel);this.We(0,CommonUIStrings.l_DialogClose);this.ga=Q}FS(Q){ja.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",Q);this.fy(Q,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(a.a)(this,this.pTf,"retryDialogHandler"))}pTf(Q){1===Q?(ja.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),
this.ga.processAction(Na.a.ycc,2)):ja.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(f.a)(tk,"RetryDialog",Ec.StandardDialog,[1829]);var ok=d(224);class se{constructor(Q,wa,eb,Lb){this.sjd=null;this.XRj=Q;this.Ma=eb;this.sSg=wa;this.yNg=new u.a;this.le=Lb}k7b(){return this.Ma.$("SaveToCloudStorageUIIsEnabled")}Gcb(){return Na.a.vUf}ysd(){bc.a.wWc(Object(a.a)(this,this.ZSi,"saveToCloudActionDispatcher"));bc.a.xEc([new ok.a(Na.a.vUf,Aa.a.frame,0)],this.sSg.B2b())}Vb(){const Q=
this.sSg.B2b();Q?(Q.MV(()=>{this.yNg.Gg(!0)}),this.ysd()):ja.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}cJi(){ja.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}ZSi(Q,wa,eb,Lb,ec){return wa.contextId!==Aa.a.frame||Q!==this.Gcb()?2:this.k7b()?1===eb?af.SessionStatusManager.instance.Qj||H.AFrameworkApplication.Pla?8:32:2===eb?(this.cJi(),ec&&ec.FileDownloadUrl&&ja.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),
this.le&&(this.sjd=this.le.fg("DialogShown","SaveToOneDriveReponseTime")),this.yNg.task.continueWith(()=>{this.sjd&&(this.sjd.stop(),this.sjd=null);this.XRj.start(ec)}),32):8:8}}Object(f.a)(se,"SaveToCloudStorageActor",null,[1860]);class bi extends se{constructor(Q,wa,eb,Lb){super(Q,wa,eb,Lb);this.xNj=wa}k7b(){return this.Ma.$("SaveACopyBrsIsEnabled")}Gcb(){return Na.a.ycc}ysd(){bc.a.wWc(Object(a.a)(this,this.ZSi,"saveToCloudActionDispatcher"));bc.a.xEc([new ok.a(Na.a.ycc,Aa.a.frame,0)],this.xNj.B2b())}cJi(){ja.ULS.sendTraceTag(7205456,
216,50,"User clicked on SaveAs button from the backstage.")}}Object(f.a)(bi,"SaveACopyActor",se,[]);class sl{}sl.default=0;Object(f.a)(sl,"SaveToCloudErrorCodes",null,[]);class El{constructor(Q,wa,eb,Lb,ec,Tc){this.Fm=null;this.STj=Q;this.nqa=wa;this.ywc=eb;this.Ma=Lb;this.W5c=ec;this.fG=Tc}start(Q){this.Fm=Q;if("SharePointOnlineConsumer"===this.Ma.lb("FileSource")){const wa=ea.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(wa){wa.start(null,Q);return}}this.nqa.lMc?
(ja.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.Gok()):(ja.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.qWn())}qWn(){this.STj.create().Uza()}qp(){this.fG().FS(sl.default)}Gok(){try{ja.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let Q={["client_id"]:this.Ma.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.W5c||2===this.W5c)Q={["client_id"]:this.Ma.appSettings.UploadToSkyDriveClientId};
WL.init(Q);ja.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(a.a)(this,this.onSuccess,"onSuccess"),Object(a.a)(this,this.onFailure,"onFailure"))}catch(Q){ja.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Q,Q.stack),this.qp()}}onSuccess(Q){ja.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");Q&&Q.data&&
Q.data.folders&&this.ywc.gEa(Q.data.folders[0].id,Q.data.folders[0].urls.viewInBrowser,null,this.Fm)}onFailure(Q){if(Q&&Q.error){if("user_canceled"===Q.error.code){ja.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}ja.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",Q.error.code,Q.error.message)}else ja.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.qp()}}Object(f.a)(El,"SaveToCloudManager",
null,[1856]);class ci extends El{constructor(Q,wa,eb,Lb,ec,Tc,Ad){super(wa,eb,Lb,ec,Tc,Ad);this.zBj=Q}onSuccess(Q){Q&&Q.data&&Q.data.folders?(ja.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.zBj.create(this.Fm).Uza(Q.data.folders[0].id,Q.data.folders[0].name,Q.data.folders[0].urls.viewInBrowser)):(ja.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.qp())}onFailure(Q){Q&&Q.error&&"user_canceled"===Q.error.code&&ja.ULS.sendTraceTag(7205457,
216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.onFailure(Q)}qp(){ja.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.qp()}}Object(f.a)(ci,"SaveACopyManager",El,[]);var Kk=d(184);class pf{constructor(Q,wa,eb,Lb,ec){this.CGa=this.Pk=this.Ejc=null;this.pY=!1;this.Fm=this.xUa=null;this.uKe=Q;this.nTa=wa;this.fG=eb;this.xi=Lb;this.le=ec}z2a(){this.xi&&1===this.xi.state||(this.Pk=this.nTa(),this.Pk.message=CommonUIStrings.l_CommentProgressTooltip,this.Pk.Ed=
5,this.Pk.yt=!1,this.Pk.jM(CommonUIStrings.l_DefaultDialogTitle,null,null))}kka(){this.Pk&&(this.Pk.close(),this.Pk=null)}r3(){1!==H.AFrameworkApplication.ua.state&&this.fG().FS(sl.default)}DHb(){ja.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");ia.a.ym(this.CGa,ia.a.poa(3),void 0,"UploadToCloudManager.RedirectToFolder")}CHb(Q){let wa=!1,eb=!1;H.AFrameworkApplication.K&&(wa=H.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),eb=H.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));
ja.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,wa);if(wa&&eb){ja.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Lb={};Lb[zf.a.obc]="1";Lb[zf.a.documentUrl]=Q;H.AFrameworkApplication.WP().execute(ec=>{ec.sendMessage(sf.a.Vxb,Lb)})}else ia.a.ym(Q,ia.a.poa(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}gEa(Q,wa,eb=null,Lb=null){ja.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");
this.le&&(this.xUa=this.le.fg("DialogShown","SaveToOneDriveUploadTime"));this.z2a();this.CGa=wa;this.Ejc=this.uKe.create(Q,eb,Lb);this.Fm=Lb;this.Xda()}Xda(){ja.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.Ejc.execute(Object(a.a)(this,this.TUm,"onSaveToCloudUploadFinished"),Object(a.a)(this,this.SUm,"onSaveToCloudUploadFailed"))}TUm(Q){this.kka();this.pY=!1;if(Q&&Q.data&&Q.data.Ee){var wa;if(({Dv:wa}=Pa.d(Q.data.Ee)).returnValue)if(Q=wa,Q.StatusCode!==Kk.a.qD&&Q.StatusCode!==
Kk.a.rCc)ja.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.r3();else{ja.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?this.CHb(Q.NewDocumentUrl):this.DHb()}catch(eb){ja.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",eb.toString())}this.cUc()}else ja.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Fb.a.b2c(Q.data.Ee)}),
this.r3()}else ja.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.r3()}SUm(Q){5!==Q.data.status&&12!==Q.data.status||this.pY?(ja.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",Q.data.status),this.kka(),this.r3(),this.cUc()):(ja.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.pY=!0,this.Xda())}cUc(){this.xUa&&(this.xUa.stop(),this.xUa=null)}}Object(f.a)(pf,"UploadToCloudManager",null,
[1857]);class $l extends pf{constructor(Q,wa,eb,Lb,ec,Tc){super(wa,eb,Lb,ec,Tc);this.ga=Q}Srf(){return!!this.Fm&&!!this.Fm.SaveEntryPoint&&"VersionHistory"===this.Fm.SaveEntryPoint.toString()}r3(){ja.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.Srf()&&this.ga.Xb(Na.a.$2d,2,{["FailureReason"]:"Unknown"});super.r3()}DHb(){ja.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.Srf()&&this.ga.processAction(Na.a.GXc,2);super.DHb()}CHb(Q){ja.ULS.sendTraceTag(7205461,
216,50,"Redirecting to edit url {0} for Save A Copy.",Q);this.Srf()&&this.ga.processAction(Na.a.GXc,2);super.CHb(Q)}Xda(){this.Fm&&"true"===this.Fm.SkipSaveToHost?super.Xda():32!==this.ga.processAction(Na.a.zIb,1)?(ja.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.Xda()):this.ga.Xb(Na.a.zIb,2,[()=>{ja.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");pf.prototype.Xda.call(this)},()=>{ja.ULS.sendTraceTag(8741713,
216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.r3()}])}}Object(f.a)($l,"SaveACopyUploadToCloudManager",pf,[]);var qd=d(733),Ak=d(1173);class tl{constructor(){this.W=null}get name(){return"Common.App.SaveACopy"}init(){H.AFrameworkApplication.K.yq(Object(a.a)(this,this.Ww,"onFullAppSettingsReady"))}Ww(){H.AFrameworkApplication.K.$("SaveACopyBrsIsEnabled")&&this.W.resolve("Common.App.SaveACopy.SaveACopyActor").Vb()}dispose(){}zc(Q){this.W=Q;this.W.register($l,
"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Xd(()=>new $l(H.AFrameworkApplication.ya,Q.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Ak.a).create(),()=>new tk(H.AFrameworkApplication.ya),H.AFrameworkApplication.ua,H.AFrameworkApplication.ua.iq)).singleInstance();this.W.register(Hi,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Xd(()=>new Hi(H.AFrameworkApplication.ya,H.AFrameworkApplication.ua.Sb,Q.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).singleInstance();
this.W.register(bi,"Common.App.SaveACopy.SaveACopyActor").Xd(()=>new bi(Q.resolve("Common.App.SaveACopy.SaveACopyManager"),Q.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),H.AFrameworkApplication.K,H.AFrameworkApplication.ua.iq)).singleInstance();this.W.register(ci,"Common.App.SaveACopy.SaveACopyManager").Xd(()=>new ci(Q.resolve("Common.App.SaveACopy.FileNameDialogFactory"),Q.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),qd.a.instance,Q.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),
H.AFrameworkApplication.K,H.AFrameworkApplication.uka,()=>new tk(H.AFrameworkApplication.ya))).singleInstance()}static main(){ca.a.instance.Pc(new tl)}}Object(f.a)(tl,"PackageManager",null,[1,2]);var Ek=d(40);class Fl extends Ec.StandardDialog{constructor(Q,wa){super();this.vSb=!1;this.KM=null;this.ga=Q;this.Emc=wa;this.YDa=!1}FS(Q,wa,eb){this.KM=wa;this.vSb=eb;ja.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",Q,eb);Q=this.VUe(Q);0===Q?(this.Ed=6,this.We(0,CommonUIStrings.l_DialogClose)):
(this.Ed=0,this.We(1,CommonUIStrings.l_DialogClose));0===Q&&ja.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.fy(Ek.a.nzn,this.Fnl(Q),this.Enl(Q,wa),Object(a.a)(this,this.pTf,"retryDialogHandler"),!0)}pTf(Q){1===Q?(ja.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.KM?this.ga.Xb(Na.a.wYc,2,[this.KM,this.vSb]):this.ga.processAction(Na.a.wYc,2)):ja.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}VUe(Q){return 0>Q||6<Q?(ja.ULS.sendTraceTag(8194012,
216,15,"Unexpected error code {0}.",Q),0):Q}Enl(Q,wa){Q=this.VUe(Q);return this.Emc?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,wa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][Q]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,
CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,wa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][Q]}Fnl(Q){Q=this.VUe(Q);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][Q]}}Object(f.a)(Fl,"ErrorRetryDialog",Ec.StandardDialog,
[1978]);class Sn{constructor(Q,wa){this.Ma=Q;this.ga=wa;this.Emc=this.Ma.$("SaveToHostWithExtraCharsInFileName")}create(){return new Fl(this.ga,this.Emc)}}Object(f.a)(Sn,"ErrorRetryDialogFactory",null,[1956]);class hm extends ld.a{constructor(Q,wa,eb,Lb,ec,Tc,Ad=null){super();this.v4=null;this.ga=wa;this.voa=Lb;this.yUa=Tc;this.Ma=Q;this.fG=ec;this.xi=eb;this.Emc=this.Ma.$("SaveToHostWithExtraCharsInFileName");this.Fm=Ad;this.We(1,CommonUIStrings.l_SaveButtonLabel)}get ua(){return this.xi}zyh(Q,wa){this.rga(1,
!!Q&&Q!==wa);this.v4=document.getElementById(hm.xFh);G.a.addHandler(this.v4,"change",Object(a.a)(this,this.ZVd,"onFileNameChange"));G.a.addHandler(this.v4,"input",Object(a.a)(this,this.ZVd,"onFileNameChange"));this.v4.focus()}wFh(Q){return this.Emc?(new RegExp("["+this.rDh('\\/:*?"<>|')+"]")).test(Q):(new RegExp("["+this.rDh('\\/:*?"<>|#{}%~&')+"]")).test(Q)}rDh(Q){return Q.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}Fif(){const Q=Vb.a.eI(H.AFrameworkApplication.ut.yz);this.rga(1,!!this.v4&&
""!==this.v4.value&&this.v4.value!==Q)}ZVd(){this.v4&&window.setTimeout(()=>{this.Fif()},0)}lBd(Q,wa){if(1!==Q)ja.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{Q=wa[hm.xFh];wa=hm.JAi in wa?wa[hm.JAi]:!1;ja.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Vb.a.EJi(Q),wa);const eb=Vb.a.WKa(H.AFrameworkApplication.fileName);(Q=Q?Q.trim():null)&&""!==Q&&""!==eb||1===this.ua.state?this.wFh(Q)?
this.fG.create().FS(1,Q,wa):this.yUa.gEa(Q+eb,wa,this.Fm):this.fG.create().FS(2,Q,wa)}}dispose(){this.v4&&(G.a.removeHandler(this.v4,"change",Object(a.a)(this,this.ZVd,"onFileNameChange")),G.a.removeHandler(this.v4,"input",Object(a.a)(this,this.ZVd,"onFileNameChange")),this.v4=null);super.dispose()}}hm.xFh="txtFileName";hm.JAi="chkOverwrite";Object(f.a)(hm,"FileNameDialogBase",ld.a,[]);class Mg{static get ug(){return ld.a.Lx(Mg.rl,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}
Mg.rl="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(f.a)(Mg,"FileNameDialogHtml",null,[]);class Xo extends hm{constructor(Q,wa,eb,Lb,ec,Tc){super(Q,wa,eb,Lb,ec,Tc);this.ug=Mg.ug;this.kg="FileNameDialog-SaveAsToHost"}Uza(Q,wa){const eb=Vb.a.eI(H.AFrameworkApplication.ut.yz);wa={["txtFileName"]:Q||eb,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:wa};this.Zh(CommonUIStrings.L_SaveAs,Object(a.a)(this,this.lBd,"fileNameDialogHandler"),wa);this.zyh(Q,eb)}}Object(f.a)(Xo,"FileNameDialog",hm,[1979]);class vj{constructor(Q,wa,
eb,Lb,ec,Tc){this.ga=wa;this.Ma=Q;this.voa=Lb;this.yUa=Tc;this.fG=ec;this.xi=eb}create(){return new Xo(this.Ma,this.ga,this.xi,this.voa,this.fG,this.yUa)}}Object(f.a)(vj,"FileNameDialogFactory",null,[1955]);class Zf{constructor(Q,wa,eb){this.yUa=eb;this.$ne=wa;this.Ma=Q}Vb(){2===H.AFrameworkApplication.ua.Sb.jo?H.AFrameworkApplication.ya.gb(Na.a.wYc,Aa.a.frame,Object(a.a)(this,this.ISi,"saveAsToHostActionDispatcher"),4):H.AFrameworkApplication.ya.pa(Na.a.wYc,Aa.a.frame,Object(a.a)(this,this.ISi,"saveAsToHostActionDispatcher"))}ISi(Q,
wa,eb,Lb,ec){return wa.contextId!==Aa.a.frame||Q!==Na.a.wYc?2:this.Ma.$("SaveAsToHostBrsIsEnabled")?1===eb?af.SessionStatusManager.instance.Qj||H.AFrameworkApplication.Pla?8:32:2===eb?(ja.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),Q=this.$ne.create(),ec&&Object.getType(ec)===Array&&2===ec.length?Q.Uza(ec[0],!!ec[1]):Q.Uza(null,!1),32):8:8}}Object(f.a)(Zf,"SaveAsToHostActor",null,[]);class bl{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we){this.Pk=null;this.vSb=
this.pY=!1;this.xUa=this.Fm=this.KM=null;this.Ma=wa;this.f5=this.Ma.appSettings.SaveAsToHostWebServiceBase;this.eIg=Lb;this.nTa=ec;this.hg=eb;this.fG=Tc;this.le=we;this.xi=Ad;this.ga=Q;this.WRa=wa.lb("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}z2a(){1!==this.xi.state&&(this.Pk=this.nTa(),this.Pk.message=CommonUIStrings.l_CommentProgressTooltip,this.Pk.Ed=5,this.Pk.yt=!1,this.Pk.jM(CommonUIStrings.l_DefaultDialogTitle,null,null))}r3(Q=0){1!==this.xi.state&&this.fG.create().FS(Q,Vb.a.eI(this.KM),
this.vSb)}DHb(){const Q=this.Ma.appSettings.BreadcrumbFolderUrl;ja.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");ia.a.ym(Q,ia.a.poa(3),void 0,"UploadToHostManager.RedirectToFolder")}CHb(Q){let wa=!1,eb=!1;this.Ma&&(wa=this.Ma.$("SaveACopyIsEnabledForUiHost"),eb=this.Ma.$("UiHostSupportsDocRebootFeatures"));ja.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",Q,wa,eb);if(wa&&eb){ja.ULS.sendTraceTag(51245197,
216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Lb={};Lb[zf.a.obc]="1";Lb[zf.a.documentUrl]=Q;Lb[zf.a.reason]=Ye.a.nUf;H.AFrameworkApplication.WP().execute(ec=>{ec.sendMessage(sf.a.Vxb,Lb)})}else wa&&!eb&&H.AFrameworkApplication.gMa?ia.a.ym(Q,ia.a.poa(4),void 0,"UploadToHostManager.RedirectToEditUrl"):ia.a.ym(Q,ia.a.poa(3),void 0,"UploadToHostManager.RedirectToEditUrl")}gEa(Q,wa,eb=null){ja.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.eIg&&
!this.eIg()&&this.hg&&(this.le&&(this.xUa=this.le.fg("DialogShown","SaveAsToHostUploadTime")),this.z2a(),this.vSb=wa,this.KM=Q,(this.Fm=eb)&&"true"===this.Fm.SkipSaveToHost?this.wAd():this.Xda())}Xda(){32!==this.ga.processAction(Na.a.zIb,1)?(ja.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.wAd()):this.ga.Xb(Na.a.zIb,2,[()=>{ja.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.wAd()},(Q,wa)=>
{ja.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.r3(wa)}])}VWm(Q){this.kka();this.pY=!1;if(Q&&Q.data&&Q.data.Ee)if(({Dv:wa}=Pa.d(Q.data.Ee)).returnValue)if(Q=wa,Q.StatusCode!==Kk.a.qD&&Q.StatusCode!==Kk.a.rCc){ja.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var wa={};wa.FailureReason=Q.StatusCode.toString();wa.ExtraInfo=Q.ExtraInfo;this.xOa(wa);this.r3(parseInt(Q.ExtraInfo))}else{ja.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.oSf();try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?this.CHb(Q.NewDocumentUrl):this.DHb()}catch(eb){ja.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",eb.toString())}this.cUc()}else ja.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Fb.a.b2c(Q.data.Ee)}),this.xOa({["FailureReason"]:"Failed to deserialize response"}),this.r3();else ja.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.xOa({["FailureReason"]:"null response"}),this.r3()}UWm(Q){5!==Q.data.status&&12!==Q.data.status||this.pY?(ja.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:Q.data.status,["HttpStatus"]:Q.data.mf}),this.xOa({["FailureReason"]:Q.data.mf.toString()}),this.kka(),this.r3(),this.cUc()):(ja.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.pY=!0,this.Fm&&"true"===this.Fm.SkipSaveToHost?this.wAd():this.Xda())}kka(){this.Pk&&
(this.Pk.close(),this.Pk=null)}cUc(){this.xUa&&(this.xUa.stop(),this.xUa=null)}oSf(){this.Fm&&"VersionHistory"===this.Fm.SaveEntryPoint&&this.ga.processAction(Na.a.GXc,2)}xOa(Q){this.Fm&&"VersionHistory"===this.Fm.SaveEntryPoint&&this.ga.Xb(Na.a.$2d,2,Q)}wAd(){let Q=this.f5+this.WRa;Q=Wb.a.Bp(Q,"qs",Vb.a.Ij(H.AFrameworkApplication.um));Q=Wb.a.Bp(Q,"n",Vb.a.Ij((new Date).getTime().toString()));Q=Wb.a.Bp(Q,"ov",Vb.a.Ij(this.vSb.toString()));Q=Wb.a.Bp(Q,"fn",Vb.a.Ij(this.KM));this.Fm&&this.Fm.FileDownloadUrl&&
(Q=Wb.a.Bp(Q,"furl",Vb.a.Ij(this.Fm.FileDownloadUrl)));this.hg.Lj(Q,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(a.a)(this,this.VWm,"onUploadFinished"),Object(a.a)(this,this.UWm,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(f.a)(bl,"UploadToHostManager",null,[1954]);class gn{constructor(){this.W=null}get name(){return"Common.App.SaveAsToHost"}init(){H.AFrameworkApplication.K.yq(Object(a.a)(this,this.Ww,"onFullAppSettingsReady"))}Ww(){H.AFrameworkApplication.K.$("SaveAsToHostBrsIsEnabled")&&
this.W.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Vb()}zc(Q){this.W=Q;this.W.register(Sn,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Xd(()=>new Sn(H.AFrameworkApplication.K,H.AFrameworkApplication.ya)).singleInstance();this.W.register(bl,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Xd(()=>new bl(H.AFrameworkApplication.ya,H.AFrameworkApplication.K,H.AFrameworkApplication.Ze,
()=>H.AFrameworkApplication.Dk,()=>(new Ak.a).create(),Q.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),H.AFrameworkApplication.ua,H.AFrameworkApplication.ua.iq)).singleInstance();this.W.register(vj,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Xd(()=>new vj(H.AFrameworkApplication.K,H.AFrameworkApplication.ya,H.AFrameworkApplication.ua,H.AFrameworkApplication.ua.Sb,Q.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),Q.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).singleInstance();
this.W.register(Zf,"Common.App.SaveAsToHost.SaveAsToHostActor").Xd(()=>new Zf(H.AFrameworkApplication.K,Q.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),Q.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).singleInstance()}dispose(){}static main(){ca.a.instance.Pc(new gn)}}Object(f.a)(gn,"SaveAsToHostPackage",null,[1,2]);class Vl extends Ec.StandardDialog{constructor(){super();this.Ed=0;this.We(1,CommonUIStrings.l_DialogClose)}FS(Q){this.fy(Q,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(f.a)(Vl,"ErrorDialog",Ec.StandardDialog,[1829]);var Zg=d(192);class ni extends Ec.StandardDialog{constructor(Q,wa,eb){super();this.ga=Q;this.nqa=wa;this.voa=eb;this.i8=!1;this.Ed=1;this.lU(1);this.We(1,CommonUIStrings.l_SignIn);this.We(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}Uza(){this.nqa.l8g(Object(a.a)(this,this.Jyi,"onSignIn"));this.Lv(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(a.a)(this,this.S2l,"inputHandler"))}S2l(Q){0===
Q?(ja.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.oZd()}Jrk(){let Q="2";if(this.voa)switch(this.voa.jo){case 3:Q="0";break;case 2:Q="3";break;case 1:Q="1"}return Q}hide(){this.nqa.fpn(Object(a.a)(this,this.Jyi,"onSignIn"));super.hide()}oZd(){const Q=new Zg.QueryStringBuilder("Signin.aspx");Q.Me("prompt","1");Q.Me("cbcxt",this.Jrk());H.AFrameworkApplication.gja(Q);ia.a.ym(Q.toString(),"LoginWindow",void 0,"SignInDialog")}Jyi(){this.cCa&&this.hide();ja.ULS.sendTraceTag(7143885,
216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.ga.processAction(Na.a.vUf,2)}}Object(f.a)(ni,"SignInDialog",Ec.StandardDialog,[1972]);class pk{constructor(Q,wa,eb){this.ga=Q;this.nqa=wa;this.voa=eb}create(){return new ni(this.ga,this.nqa,this.voa)}}Object(f.a)(pk,"SignInDialogFactory",null,[1945]);class Nj{constructor(Q,wa,eb,Lb,ec,Tc,Ad){this.f5=Q;this.KM=wa;this.GPb=eb;this.K$c=Lb;this.wCe=ec;this.WRa=Tc;this.Fm=Ad}execute(Q,wa){if(!H.AFrameworkApplication.Dk&&
H.AFrameworkApplication.Ze){var eb=this.f5+this.WRa;eb=Wb.a.Bp(eb,"fo",Vb.a.Ij(this.K$c));eb=Wb.a.Bp(eb,"fn",Vb.a.Ij(this.KM));eb=Wb.a.Bp(eb,"qs",Vb.a.Ij(this.wCe));eb=Wb.a.Bp(eb,"n",Vb.a.Ij((new Date).getTime().toString()));this.Fm&&this.Fm.FileDownloadUrl&&(eb=Wb.a.Bp(eb,"furl",Vb.a.Ij(this.Fm.FileDownloadUrl)));this.GPb&&(eb=Wb.a.Bp(eb,"fnn",Vb.a.Ij(this.GPb)));H.AFrameworkApplication.Ze.Lj(eb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Q,wa,null)}}}Object(f.a)(Nj,"SkyDriveUploadCaller",
null,[1971]);class Uk{constructor(Q){this.Ma=Q;this.dub=Q.appSettings.SkyDriveUploadWebServiceBase;this.KM=Q.appSettings.FileName;this.WRa=Q.lb("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(Q,wa,eb){return new Nj(this.dub,this.KM,wa,Q,H.AFrameworkApplication.um,this.WRa,eb)}}Object(f.a)(Uk,"SkydriveUploadCallerFactory",null,[1944]);class gg{constructor(){this.W=null}get name(){return"Common.App.SaveToCloudStorage"}init(){H.AFrameworkApplication.K.$("SaveToCloudStorageUIIsEnabled")&&
this.W.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Vb()}dispose(){}zc(Q){this.W=Q;this.W.register(pk,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Xd(()=>new pk(H.AFrameworkApplication.ya,qd.a.instance,H.AFrameworkApplication.ua.Sb)).singleInstance();this.W.register(Uk,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Xd(()=>new Uk(H.AFrameworkApplication.K)).singleInstance();
this.W.register(se,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Xd(()=>new se(Q.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),Q.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),H.AFrameworkApplication.K,H.AFrameworkApplication.ua.iq)).singleInstance();this.W.register(pf,"Common.App.SaveToCloudStorage.UploadToCloudManager").Xd(()=>new pf(Q.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Ak.a).create(),()=>new Vl,H.AFrameworkApplication.ua,
H.AFrameworkApplication.ua.iq)).singleInstance();this.W.register(El,"Common.App.SaveToCloudStorage.SaveToCloudManager").Xd(()=>new El(Q.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),qd.a.instance,Q.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),H.AFrameworkApplication.K,H.AFrameworkApplication.uka,()=>new Vl)).singleInstance()}static main(){ca.a.instance.Pc(new gg)}}Object(f.a)(gg,"PackageManager",null,[1,2]);class le extends Ec.StandardDialog{constructor(){super();this.Ed=
0;this.We(1,CommonUIStrings.l_DialogClose)}FS(Q,wa){this.Ryh(Q,wa,Ek.a.pzn)}Ryh(Q,wa,eb){ja.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",eb);this.fy(eb,Q,wa,null)}p3e(Q,wa){ja.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.fy(Ek.a.rzn,Q,wa,null,!0)}}Object(f.a)(le,"ErrorDialog",Ec.StandardDialog,[926]);class Od{static get ug(){return ld.a.Lx(Od.rl,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,
"")}}Od.rl="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(f.a)(Od,"FileNameDialogHtml",null,[]);var pg=d(68);class Oi extends hm{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we){super(Q,wa,eb,Lb,ec,Tc,we);this.W6a=this.GEe=this.$O=null;this.zmk=CommonUIStrings.l_SaveToAnotherFolder;this.ug=Od.ug;this.kg="FileNameDialog-SaveToSharePoint";this.suc=Ad;this.KNj=we}Uza(Q){const wa=Vb.a.eI(H.AFrameworkApplication.ut.yz),eb=H.AFrameworkApplication.breadcrumbFolderName,Lb=H.AFrameworkApplication.breadcrumbBrandName,ec={["txtFileName"]:Q||wa};let Tc=CommonUIStrings.L_SaveAs;
2===H.AFrameworkApplication.ua.Sb.jo&&(Tc=CommonUIStrings.L_SaveACopy);this.Zh(Tc,Object(a.a)(this,this.lBd,"fileNameDialogHandler"),ec);this.zyh(Q,wa);this.h2e.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");H.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost")||(this.$O=document.getElementById("anotherFolder"),Q=document.getElementById("folderLocation"),this.GEe=uf.a.Pqd(Q,this.$O,"anotherFolderDescribedBy",""),
this.$O.className="WACButton WACDialogButtonNormal",Q=!1,eb&&eb.length?(this.a6g(this.$O,this.GEe,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Lb,eb)),Q=this.I_j(Lb,eb)):this.a6g(this.$O,this.GEe,CommonUIStrings.l_CurrentOnlineFolder),this.x1j(this.$O),this.K_j(this.$O),Q?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.$O,"SaveToAnotherLocationTwo"),ja.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):
Sys.UI.DomElement.addCssClass(this.$O,"SaveToAnotherLocationOne"),G.a.addHandler(this.$O,B.a.click,Object(a.a)(this,this.RGf,"onSaveToAnotherLocationClick")),G.a.addHandler(this.$O,B.a.Di,Object(a.a)(this,this.pyi,"onSaveToAnotherLocationKeyDown")))}I_j(Q,wa){let eb;eb=!1;const Lb=document.getElementById("currentLocation");Lb.innerText="";const ec=this.$Sh(Lb,Q),Tc=this.$Sh(Lb,wa);let Ad=255,we=255;255<ec+Tc&&(Ad=Math.max(238,408-ec),we=Math.max(170,408-Tc),eb=!0);this.F3j(Lb,Q,we,wa,Ad);return eb}$Sh(Q,
wa){const eb=document.createElement("div");eb.innerText=wa;eb.style.visibility="hidden";Q.appendChild(eb);wa=eb.clientWidth;Q.removeChild(eb);return wa}F3j(Q,wa,eb,Lb,ec){wa&&(this.$5g(Q,wa,eb),this.v3j(Q));Lb&&this.$5g(Q,Lb,ec)}$5g(Q,wa,eb){const Lb=document.createElement("div");Lb.innerText=wa;Lb.title=wa;Lb.className="SaveToAnotherFolderBreadcrumb";Lb.style.maxWidth=eb.toString()+"px";Q.appendChild(Lb)}v3j(Q){const wa=document.createElement("span");wa.id="FolderSeparator";const eb=document.createElementNS("http://www.w3.org/2000/svg",
"svg");eb.setAttribute("class","SeparatorCaret");const Lb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Lb.setAttribute("points","1 4 1 11 5 7.5");eb.appendChild(Lb);wa.appendChild(eb);Q.appendChild(wa)}a6g(Q,wa,eb){eb=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,eb);wa&&(wa.innerText=eb);Q.tabIndex=0;Q.setAttribute(uf.a.Ah,uf.a.n1)}K_j(Q){const wa=document.createElement("span");wa.id="anotherFolderText";wa.innerText=this.zmk;wa.className="AnotherFolderTextSpan";
Q.appendChild(wa)}x1j(Q){const wa=document.createElement("span");wa.className="cui-img-cont-float cui-img-16by16 ";this.W6a=document.createElementNS("http://www.w3.org/2000/svg","svg");this.W6a.setAttribute("class","FolderIconSVG");const eb=document.createElementNS("http://www.w3.org/2000/svg","path");eb.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.W6a.appendChild(eb);wa.appendChild(this.W6a);Q.appendChild(wa)}pyi(Q){!Q||
Q.keyCode!==pg.a.Ks&&Q.keyCode!==pg.a.jce||this.RGf(Q)}RGf(){if(this.v4){const Q=Vb.a.WKa(H.AFrameworkApplication.fileName);let wa=this.v4.value;this.hide();wa&&""!==wa&&""!==Q||1===this.ua.state?(""!==Q&&(wa+=Q),this.wFh(wa)?this.fG.create().FS(1,wa,!1):this.suc.start(wa,this.KNj)):this.fG.create().FS(2,wa,!1)}}prk(Q){this.$O&&this.W6a&&(Q?(this.$O.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.$O,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.W6a,"DisabledFolderIconSVG")):(this.$O.tabIndex=
-1,Sys.UI.DomElement.containsCssClass(this.$O,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.W6a,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.$O,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.W6a,"DisabledFolderIconSVG"))))}Fif(){super.Fif();this.prk(!!this.v4&&""!==this.v4.value)}dispose(){this.$O&&(G.a.removeHandler(this.$O,B.a.click,Object(a.a)(this,this.RGf,"onSaveToAnotherLocationClick")),G.a.removeHandler(this.$O,B.a.Di,Object(a.a)(this,this.pyi,
"onSaveToAnotherLocationKeyDown")),this.$O=null);super.dispose()}}Object(f.a)(Oi,"FileNameDialog",hm,[1086]);var aj=d(536),Lj=d(373),yd=d(1509),dg=d(1610);class Nb{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(f.a)(Nb,"SaveAsDialogInput",null,[]);class Ii{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(f.a)(Ii,"SaveLocation",null,[]);var Ie=d(166);class $g{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we,Rd){this.jwe=
null;this.KM="";this.suc=Q;this.fG=wa;this.Fm=Rd;this.yUa=eb;this.xi=ec;this.IK=Lb;this.Rtb=Ad;this.fUb=we;Tc&&(this.jwe=new kb.a(()=>new yd.a(Tc.value,null)))}vml(){const Q=new aj.a(Lj.a.Pj());Q.Z("type","currentHost");return Object.assign(new Ii,{folderName:this.IK.breadcrumbFolderName,friendlyPath:this.IK.breadcrumbBrandName,properties:Q})}Eim(Q){return!!Q&&"ClassicMru"===Q.type&&!!Q.service_info&&!!Q.service_info.service_id&&-1!==Q.service_info.service_id.indexOf("SHAREPOINT")}$Gl(){if(!this.jwe||
!this.Rtb)return null;var Q=this.jwe.value.fk("SaveAsToSharePointDialog",!1);if(!Q||3!==Q.state||!Q.Pqi)return null;Q=Q.Pqi;const wa=new ha.a;let eb=0,Lb=0;for(var ec=0;ec<Q.length;ec++){var Tc=Q[ec];if(!this.Eim(Tc))continue;eb++;if(!Tc.sharepoint_info)continue;const Ad=Tc.url,we=Tc.sharepoint_info.site_url,Rd=Tc.title;Tc=dg.b(Tc,H.AFrameworkApplication.isRtl);if(!(Ad&&we&&Rd&&Tc))continue;Lb++;const yf=new aj.a(Lj.a.Pj());yf.Z("type","SharePoint");yf.Z("siteUrl",we);yf.Z("folderUrl",Ad);Lb++;wa.add(Object.assign(new Ii,
{folderName:Rd,friendlyPath:Tc,properties:yf}))}ec=new Map;ec.set("NumPlaces",Q.length.toString());ec.set("NumSharepointPlaces",eb.toString());ec.set("placesWithMetadata",Lb.toString());Ga.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",ec);0<eb&&(Lb?.5>1*Lb/eb&&Ga.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):Ga.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return wa}Dnl(){const Q=
new ha.a;Q.add(this.vml());const wa=this.$Gl();wa&&Q.addRange(wa);return Object.assign(new Nb,{enableMoreLocations:!H.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.KM,extension:Vb.a.WKa(this.IK.yz),saveLocations:Q.toArray(),scenario:"SaveToSharePoint"})}Sbf(){const Q=Object(a.a)(this,this.Dnl,"getDialogInput"),wa={};wa.inputPropsCallback=Q;return wa}Uza(Q){this.KM=Q;this.KM||(this.KM=String.format(CommonUIStrings.l_SaveACopy_Filename,Vb.a.eI(this.IK.yz)));Q={["id"]:"SaveAsDialog",
["bodyControls"]:this.Sbf()};let wa=CommonUIStrings.L_SaveAs;2===this.xi.Sb.jo&&(wa=CommonUIStrings.L_SaveACopy);const eb=new ld.a(!1,!1,!0);eb.Ed=1;eb.kg="SaveAsDialog";eb.We(1,CommonUIStrings.l_SaveButtonLabel);eb.Zh(wa,Object(a.a)(this,this.lzn,"saveAsDialogHandler"),Q)}FVn(Q,wa){Q&&""!==Q&&""!==wa||1===this.xi.state?this.Dim()?this.nrm(Q,wa):(""!==wa&&(Q+=wa),this.suc.start(Q,this.Fm)):(ja.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.fG.create().FS(2,
Q,!1))}nrm(Q,wa){Ga.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const eb=this.fUb.vZe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.fUb.xcf(eb).then(Lb=>{if(Lb&&0<Lb.length){const ec=Lb[0][zf.a.C2m];Lb=Lb[0][zf.a.D2m];if(""!==ec&&""!==Lb)this.Rtb.gEa(Lb,Q+wa,ec,this.Fm),Ga.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.fG.create().FS(0,Q,!1);const Tc=We.a.aF();Tc&&(Tc.set("SiteUrlAvailable",
""===ec?"false":"true"),Tc.set("FolderUrlAvailable",""===Lb?"false":"true"));Ga.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new Ie.a,{extendedProperties:Tc}))}}else this.fG.create().FS(0,Q,!1),Ga.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Lb=>{"Canceled"===Lb?((Lb=We.a.aF())&&Lb.set("IsCanceled","true"),Ga.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Ie.a,{extendedProperties:Lb}))):
Ga.Health.instance.recordKpiFailure("SaveACopySFP",Lb,!1,!1,null)})}Dim(){return this.fUb?this.fUb.bsf():(ja.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}lzn(Q,wa){if(wa&&1===Q){Q=wa.fileName;var eb=Vb.a.WKa(this.IK.yz);wa.moreLocationsSelected&&this.FVn(Q,eb);if(wa.locationCallback){var Lb=wa.locationCallback();Lb?Lb.properties&&"currentHost"===Lb.properties.J("type")?this.yUa.gEa(Q+eb,!1,this.Fm):Lb.properties&&"SharePoint"===Lb.properties.J("type")?(wa=Lb.properties.J("siteUrl"),
Lb=Lb.properties.J("folderUrl"),this.Rtb.gEa(Lb,Q+eb,wa,this.Fm)):ja.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):ja.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else ja.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(f.a)($g,"ReactSaveAsDialog",null,[1086]);class fh{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we=null,Rd=null,yf=null){this.ga=wa;this.Ma=Q;this.voa=Lb;this.yUa=Tc;this.fG=ec;this.xi=eb;this.XXg=Ad;this.xJj=we;this.Rtb=Rd;this.fUb=
yf}create(Q){return this.xi&&this.xi.Sb.zA?new $g(this.XXg,this.fG,this.yUa,H.AFrameworkApplication.ut,this.xi,this.xJj,this.Rtb,this.fUb,Q):new Oi(this.Ma,this.ga,this.xi,this.voa,this.fG,this.yUa,this.XXg,Q)}}Object(f.a)(fh,"FileNameDialogFactory",null,[1066]);class Pi{constructor(Q,wa,eb,Lb){this.Tv=this.bsc=null;this.Qob=Q;this.xi=eb;this.XOj=Lb;this.URa=new kb.a(()=>new yd.a(wa.value,Object(a.a)(this,this.bAb,"getMoreInfoEventReceived")))}get Dzi(){this.bsc||(this.URa.value.fk("Save As",!0),
this.Tv&&this.Tv.Aaa&&this.Tv.Aaa.length&&(this.bsc=this.tzl(this.Tv.Aaa)));return this.bsc}start(Q){if(!this.Dzi)if(H.AFrameworkApplication.breadcrumbFolderUrl&&H.AFrameworkApplication.breadcrumbFolderUrl.length)this.bsc=H.AFrameworkApplication.breadcrumbFolderUrl;else return ja.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Tv),!1;const wa=this.XOj();wa.SVn();const eb=
wa.ZBl();if(!eb)return ja.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.Qob.start((Lb,ec)=>{wa.hide();Q(Lb,ec)},()=>{this.AFb(wa)},eb,this.bsc);return!0}AFb(Q){Q.hide();ja.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}tzl(Q){Q=Q.toLowerCase();Q.endsWith("/")||(Q+="/");const wa=Q.indexOf("/documents/");return-1!==wa?Q.substring(0,wa+1)+"_layouts/15/onedrive.aspx":""}bAb(Q){this.Tv||3!==Q.state||(this.Tv=Q)}}Object(f.a)(Pi,"OneDriveFilePickerHelper",
null,[1065]);class jk extends ld.a{constructor(){super()}SVn(){this.Ynb="FilePickerDialog";this.ug="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.kg="PickerDialog-MsoSp";this.showDialog("",null)}ZBl(){return document.getElementById("FilePickerDiv")}nO(){}Yfa(){}}Object(f.a)(jk,"PickerDialog",ld.a,[1064]);class Cf{constructor(Q,wa,eb,Lb,ec,Tc,Ad){this.Ma=Q;this.$ne=eb;this.ga=wa;this.suc=Lb;this.Qob=ec;this.asc=Tc;this.twj=Ad}Vb(){const Q=this.Qob.B2b();Q?ua.a.K$||this.Ma.$("SaveToSharePointOnDemandDownloadJsIsEnabled")?
this.ga.gb(Na.a.Acc,Aa.a.frame,Object(a.a)(this,this.bTi,"saveToSharePointActionDispatcher"),64):(Q.A_a.continueWith(wa=>{wa.Ii&&this.Qob.IFf(wa)}),this.ysd()):ja.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}ysd(){bc.a.wWc(Object(a.a)(this,this.bTi,"saveToSharePointActionDispatcher"));bc.a.xEc([new ok.a(Na.a.Acc,Aa.a.frame,0)],this.Qob.B2b())}get k7b(){return this.Ma.$("SaveToAnotherFolderBrsIsEnabled")}get Bih(){return this.Ma.$("UserCanWriteRelative")}bTi(Q,
wa,eb,Lb,ec){return wa.contextId!==Aa.a.frame||Q!==Na.a.Acc?2:this.k7b&&(this.asc.Dzi||this.Bih)?1===eb?af.SessionStatusManager.instance.Qj||H.AFrameworkApplication.Pla?8:this.twj()?32:8:2===eb?(ja.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(ec&&ec.SaveEntryPoint&&"VersionHistory"===ec.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.Bih?(ja.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.$ne.create(ec).Uza(null)):(ja.ULS.sendTraceTag(24524225,
216,50,"No permission save to current folder, show Picker to save to another folder."),this.suc.start(null,ec)),32):8:8}}Object(f.a)(Cf,"SaveToSharePointActor",null,[]);class im{constructor(Q,wa,eb,Lb){this.Fm=this.iQg=null;this.Rtb=Q;this.fG=wa;this.asc=eb;this.xi=Lb}start(Q,wa){ja.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.iQg=Q;this.Fm=wa;this.asc.start((eb,Lb)=>{this.hMf(eb,Lb)})||this.o_f()}hMf(Q,wa){if(Q)this.onSuccess(wa);else this.onFailure(wa)}o_f(){1!==this.xi.state&&this.fG().p3e(CommonUIStrings.l_DefaultDialogTitle,
CommonUIStrings.l_OneDriveContactError)}onSuccess(Q){ja.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(Q&&Q.data&&Q.data.value&&Q.data.value.length&&Q.data.value[0].sharePoint){const wa=Q.data.value[0].sharePoint.url;Q=Q.data.value[0].sharePoint.listUrl;let eb=null;if(wa&&(eb=Q?this.rHl(Q):this.qHl(wa))){this.Rtb.gEa(wa,this.iQg,eb,this.Fm);return}ja.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",
!wa,!eb)}ja.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.o_f()}qHl(Q){Q.endsWith("/")||(Q+="/");let wa=0;for(let eb=0;eb<Q.length;eb++)if("/"===Q.charAt(eb)&&5===++wa)return Q.substr(0,eb);return null}rHl(Q){Q.endsWith("/")&&(Q=Q.substring(0,Q.length-1));const wa=Q.lastIndexOf("/");return-1!==wa?Q.substring(0,wa):null}onFailure(Q){ja.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");Q&&Q.error?ja.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",
Q.error.errorCode,Q.error.message):ja.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.o_f()}}Object(f.a)(im,"SaveToSharePointManager",null,[1959]);class ch{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we){this.f5=Q;this.KM=wa;this.GPb=Lb;this.wCe=Tc;this.CGa=eb;this.fUj=ec;this.WRa=Ad;this.Fm=we}execute(Q,wa){if(!H.AFrameworkApplication.Dk&&H.AFrameworkApplication.Ze){var eb=this.f5+this.WRa;eb=Wb.a.Bp(eb,"fu",Vb.a.Ij(this.CGa));eb=Wb.a.Bp(eb,"su",Vb.a.Ij(this.fUj));eb=Wb.a.Bp(eb,"fn",
Vb.a.Ij(this.KM));eb=Wb.a.Bp(eb,"n",Vb.a.Ij((new Date).getTime().toString()));this.Fm&&this.Fm.FileDownloadUrl&&(eb=Wb.a.Bp(eb,"furl",Vb.a.Ij(this.Fm.FileDownloadUrl)));eb=eb+"&"+this.wCe;this.GPb&&this.GPb.length?eb=Wb.a.Bp(eb,"fnn",Vb.a.Ij(this.GPb)):ja.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");ja.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");H.AFrameworkApplication.Ze.Lj(eb,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,
2,Q,wa,null,void 0,void 0,void 0,void 0,"9")}}}Object(f.a)(ch,"SharePointSaveAsCaller",null,[1980]);class Oj{constructor(Q){this.dub=Q.appSettings.SaveAsToHostWebServiceBase;this.KM=Q.appSettings.FileName;this.WRa=Q.lb("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(Q,wa,eb,Lb){return new ch(this.dub,this.KM,Q,wa,eb,H.AFrameworkApplication.um,this.WRa,Lb)}}Object(f.a)(Oj,"SharePointUploadCallerFactory",null,[1958]);var Kg=d(1351);class ul{constructor(Q,wa,eb,Lb,ec){this.Pk=this.Ejc=
null;this.hge=!1;this.zEe=this.CGa=null;this.uKe=wa;this.nTa=eb;this.fG=Lb;this.xi=ec;this.ga=Q}gEa(Q,wa,eb,Lb){this.hge=!1;ja.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.z2a();this.CGa=Q;Lb&&Lb.SaveEntryPoint&&(this.zEe=Lb.SaveEntryPoint);this.Ejc=this.uKe.create(Q,wa,eb,Lb);Lb&&"true"===Lb.SkipSaveToHost?this.Xda():this.kbl()}kbl(){const Q=()=>{ja.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.Xda()};32!==this.ga.Xb(Na.a.zIb,2,[()=>{ja.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.Xda()},Q])&&Q()}Xda(){ja.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.Ejc.execute(Object(a.a)(this,this.VUm,"onSaveToSharePointUploadFinished"),Object(a.a)(this,this.UUm,"onSaveToSharePointUploadFailed"))}VUm(Q){if(Q&&Q.data&&Q.data.Ee){var wa;if(({Dv:wa}=Pa.d(Q.data.Ee)).returnValue)if(wa.StatusCode!==Kk.a.qD&&wa.StatusCode!==
Kk.a.rCc)ja.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",Q.data.status,wa.StatusCode),wa.StatusCode!==Kk.a.tSf&&this.tzh(Q.data.status)||(this.xOa(wa.StatusCode.toString()),this.OUn(wa.StatusCode));else{ja.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.oSf();try{wa.NewDocumentUrl?this.CHb(wa.NewDocumentUrl):this.DHb()}catch(eb){ja.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",
eb.toString())}}else ja.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Fb.a.b2c(Q.data.Ee)}),this.Lyd()||(this.xOa("Failed to deserialize response"),this.S_c())}else ja.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.Lyd()||(this.xOa("Unknown"),this.S_c())}UUm(Q){Q&&Q.data?this.tzh(Q.data.status)||(ja.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.xOa(Kg.a[Q.data.status]),this.S_c()):(ja.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),
this.Lyd()||(this.xOa("Unknown"),this.S_c()))}Lyd(){if(!this.hge)return ja.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.hge=!0,this.Xda(),!0;ja.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}tzh(Q){ja.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",Q);return this.Lyd()}DHb(){ja.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");ia.a.ym(this.CGa,ia.a.poa(3),void 0,"UploadToSharePointManager.RedirectToFolder")}CHb(Q){let wa=
!1,eb=!1;H.AFrameworkApplication.K&&(wa=H.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),eb=H.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));ja.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",Q,wa);if(wa&&eb){ja.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Lb={};Lb[zf.a.obc]="1";Lb[zf.a.documentUrl]=Q;Lb[zf.a.reason]=Ye.a.nUf;H.AFrameworkApplication.WP().execute(ec=>
{ec.sendMessage(sf.a.Vxb,Lb)})}else ia.a.ym(Q,ia.a.poa(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}z2a(){this.xi&&1===this.xi.state||(this.Pk=this.nTa(),this.Pk.message=CommonUIStrings.l_CommentProgressTooltip,this.Pk.Ed=5,this.Pk.yt=!1,this.Pk.jM(CommonUIStrings.l_DefaultDialogTitle,null,null))}kka(){this.Pk&&(this.Pk.close(),this.Pk=null)}S_c(){this.qp(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}GVn(){this.qp(CommonUIStrings.l_NoSavePermissionDialogTitle,
CommonUIStrings.l_NoSavePermissionDialogMessage)}UUn(){const Q=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.qp(CommonUIStrings.l_SaveAsFileTooLargeTitle,Q,Ek.a.mzn)}qp(Q,wa,eb=Ek.a.qzn){ja.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",Q,wa);this.kka();1!==this.xi.state&&this.fG().Ryh(Q,wa,eb)}OUn(Q){ja.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",Q);switch(Q){case Kk.a.Oae:this.GVn();break;case Kk.a.tSf:this.UUn();break;
default:this.S_c()}}oSf(){"VersionHistory"===this.zEe&&this.ga.processAction(Na.a.GXc,2)}xOa(Q){"VersionHistory"===this.zEe&&this.ga.Xb(Na.a.$2d,2,{["FailureReason"]:Q})}}Object(f.a)(ul,"UploadToSharePointManager",null,[1957]);var vl=d(730),am=d(122);class Ug{constructor(){this.Lkd=this.fye=this.Xxe=this.W=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}zc(Q){this.W=Q;this.Xxe=vl.a.Iq(Q.Za("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.fye=vl.a.Iq(Q.Za("Common.IEventEmitter<Common.IMruResult>"));
this.Lkd=vl.a.Iq(Q.Za("Common.App.SharedFilePicker.ISharedFilePicker"));am.Task.WAA.call(null,this.Xxe,this.fye,this.Lkd).continueWith(()=>{this.Qhn()})}Qhn(){this.W.register(Oj,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Xd(()=>new Oj(H.AFrameworkApplication.K)).singleInstance();this.W.register(ul,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Xd(()=>
new ul(H.AFrameworkApplication.ya,this.W.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new Ak.a).create(),()=>new le,H.AFrameworkApplication.ua)).singleInstance();this.W.register(im,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Xd(()=>new im(this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new le,this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),H.AFrameworkApplication.ua)).singleInstance();
this.W.register(Pi,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Xd(()=>new Pi(this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new kb.a(()=>this.Xxe.result),H.AFrameworkApplication.ua,()=>new jk)).singleInstance();this.W.register(fh,"Common.App.SaveToSharePoint.FileNameDialogFactory").Xd(()=>new fh(H.AFrameworkApplication.K,H.AFrameworkApplication.ya,H.AFrameworkApplication.ua,H.AFrameworkApplication.ua.Sb,
this.W.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.W.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new kb.a(()=>this.fye.result),this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.Lkd?this.Lkd.result:null)).singleInstance();this.W.register(Cf,"Common.App.SaveToSharePoint.SaveToSharePointActor").Xd(()=>new Cf(H.AFrameworkApplication.K,H.AFrameworkApplication.ya,this.W.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),
this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>H.AFrameworkApplication.ua.Ppk)).singleInstance();H.AFrameworkApplication.K.$("SaveToAnotherFolderBrsIsEnabled")&&this.W.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Vb()}static main(){ca.a.instance.Pc(new Ug)}}Object(f.a)(Ug,"PackageManager",null,[1,2]);
class xh{}Object(f.a)(xh,"StringDifference",null,[1947]);class Ed{constructor(Q,wa){this.charCode=Q;this.description=wa}}Object(f.a)(Ed,"UBTableEntry",null,[]);class bm{}new Ed(8,"C0 Controls 1");new Ed(9,"Horizontal tab (HT)");new Ed(10,"Line feed (LF)");new Ed(12,"C0 Controls 2");new Ed(13,"Carriage return (CR)");new Ed(31,"C0 Controls 3");new Ed(32,"Space");new Ed(47,"ASCII Punctuation and Symbols 1");new Ed(57,"ASCII Digits");new Ed(64,"ASCII Punctuation and Symbols 2");new Ed(90,"Uppercase Latin Alphabet");
new Ed(96,"ASCII Punctuation and Symbols 3");new Ed(122,"Lowercase Latin Alphabet");new Ed(127,"U+0000..U+007F Basic Latin");new Ed(159,"C1 Controls");new Ed(160,"NB Space");new Ed(191,"Latin-1 Punctuation and Symbols");new Ed(255,"U+0080..U+00FF Latin-1 Supplement");new Ed(383,"U+0100..U+017F Latin Extended-A");new Ed(591,"U+0180..U+024F Latin Extended-B");new Ed(687,"U+0250..U+02AF IPA Extensions");new Ed(767,"U+02B0..U+02FF Spacing Modifier Letters");new Ed(879,"U+0300..U+036F Combining Diacritical Marks");
new Ed(1023,"U+0370..U+03FF Greek and Coptic");new Ed(1279,"U+0400..U+04FF Cyrillic");new Ed(1327,"U+0500..U+052F Cyrillic Supplement");new Ed(1423,"U+0530..U+058F Armenian");new Ed(1535,"U+0590..U+05FF Hebrew");new Ed(1791,"U+0600..U+06FF Arabic");new Ed(1871,"U+0700..U+074F Syriac");new Ed(1919,"U+0750..U+077F Arabic Supplement");new Ed(1983,"U+0780..U+07BF Thaana");new Ed(2047,"U+07C0..U+07FF NKo");new Ed(2111,"U+0800..U+083F Samaritan");new Ed(2143,"U+0840..U+085F Mandaic");new Ed(2303,"U+08A0..U+08FF Arabic Extended-A");
new Ed(2431,"U+0900..U+097F Devanagari");new Ed(2559,"U+0980..U+09FF Bengali");new Ed(2687,"U+0A00..U+0A7F Gurmukhi");new Ed(2815,"U+0A80..U+0AFF Gujarati");new Ed(2943,"U+0B00..U+0B7F Oriya");new Ed(3071,"U+0B80..U+0BFF Tamil");new Ed(3199,"U+0C00..U+0C7F Telugu");new Ed(3327,"U+0C80..U+0CFF Kannada");new Ed(3455,"U+0D00..U+0D7F Malayalam");new Ed(3583,"U+0D80..U+0DFF Sinhala");new Ed(3711,"U+0E00..U+0E7F Thai");new Ed(3839,"U+0E80..U+0EFF Lao");new Ed(4095,"U+0F00..U+0FFF Tibetan");new Ed(4255,
"U+1000..U+109F Myanmar");new Ed(4351,"U+10A0..U+10FF Georgian");new Ed(4607,"U+1100..U+11FF Hangul Jamo");new Ed(4991,"U+1200..U+137F Ethiopic");new Ed(5023,"U+1380..U+139F Ethiopic Supplement");new Ed(5119,"U+13A0..U+13FF Cherokee");new Ed(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new Ed(5791,"U+1680..U+169F Ogham");new Ed(5887,"U+16A0..U+16FF Runic");new Ed(5919,"U+1700..U+171F Tagalog");new Ed(5951,"U+1720..U+173F Hanunoo");new Ed(5983,"U+1740..U+175F Buhid");new Ed(6015,"U+1760..U+177F Tagbanwa");
new Ed(6143,"U+1780..U+17FF Khmer");new Ed(6319,"U+1800..U+18AF Mongolian");new Ed(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");new Ed(6479,"U+1900..U+194F Limbu");new Ed(6527,"U+1950..U+197F Tai Le");new Ed(6623,"U+1980..U+19DF New Tai Lue");new Ed(6655,"U+19E0..U+19FF Khmer Symbols");new Ed(6687,"U+1A00..U+1A1F Buginese");new Ed(6831,"U+1A20..U+1AAF Tai Tham");new Ed(7039,"U+1B00..U+1B7F Balinese");new Ed(7103,"U+1B80..U+1BBF Sundanese");new Ed(7167,"U+1BC0..U+1BFF Batak");
new Ed(7247,"U+1C00..U+1C4F Lepcha");new Ed(7295,"U+1C50..U+1C7F Ol Chiki");new Ed(7375,"U+1CC0..U+1CCF Sundanese Supplement");new Ed(7423,"U+1CD0..U+1CFF Vedic Extensions");new Ed(7551,"U+1D00..U+1D7F Phonetic Extensions");new Ed(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new Ed(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new Ed(7935,"U+1E00..U+1EFF Latin Extended Additional");new Ed(8191,"U+1F00..U+1FFF Greek Extended");new Ed(8303,"U+2000..U+206F General Punctuation");
new Ed(8351,"U+2070..U+209F Superscripts and Subscripts");new Ed(8399,"U+20A0..U+20CF Currency Symbols");new Ed(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");new Ed(8527,"U+2100..U+214F Letterlike Symbols");new Ed(8591,"U+2150..U+218F Number Forms");new Ed(8703,"U+2190..U+21FF Arrows");new Ed(8959,"U+2200..U+22FF Mathematical Operators");new Ed(9215,"U+2300..U+23FF Miscellaneous Technical");new Ed(9279,"U+2400..U+243F Control Pictures");new Ed(9311,"U+2440..U+245F Optical Character Recognition");
new Ed(9471,"U+2460..U+24FF Enclosed Alphanumerics");new Ed(9599,"U+2500..U+257F Box Drawing");new Ed(9631,"U+2580..U+259F Block Elements");new Ed(9727,"U+25A0..U+25FF Geometric Shapes");new Ed(9983,"U+2600..U+26FF Miscellaneous Symbols");new Ed(10175,"U+2700..U+27BF Dingbats");new Ed(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new Ed(10239,"U+27F0..U+27FF Supplemental Arrows-A");new Ed(10495,"U+2800..U+28FF Braille Patterns");new Ed(10623,"U+2900..U+297F Supplemental Arrows-B");
new Ed(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");new Ed(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new Ed(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");new Ed(11359,"U+2C00..U+2C5F Glagolitic");new Ed(11391,"U+2C60..U+2C7F Latin Extended-C");new Ed(11519,"U+2C80..U+2CFF Coptic");new Ed(11567,"U+2D00..U+2D2F Georgian Supplement");new Ed(11647,"U+2D30..U+2D7F Tifinagh");new Ed(11743,"U+2D80..U+2DDF Ethiopic Extended");new Ed(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");
new Ed(11903,"U+2E00..U+2E7F Supplemental Punctuation");new Ed(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new Ed(12255,"U+2F00..U+2FDF Kangxi Radicals");new Ed(12287,"U+2FF0..U+2FFF Ideographic Description Characters");new Ed(12351,"U+3000..U+303F CJK Symbols and Punctuation");new Ed(12447,"U+3040..U+309F Hiragana");new Ed(12543,"U+30A0..U+30FF Katakana");new Ed(12591,"U+3100..U+312F Bopomofo");new Ed(12687,"U+3130..U+318F Hangul Compatibility Jamo");new Ed(12703,"U+3190..U+319F Kanbun");new Ed(12735,
"U+31A0..U+31BF Bopomofo Extended");new Ed(12783,"U+31C0..U+31EF CJK Strokes");new Ed(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new Ed(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new Ed(13311,"U+3300..U+33FF CJK Compatibility");new Ed(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new Ed(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new Ed(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new Ed(42127,"U+A000..U+A48F Yi Syllables");new Ed(42191,"U+A490..U+A4CF Yi Radicals");
new Ed(42239,"U+A4D0..U+A4FF Lisu");new Ed(42559,"U+A500..U+A63F Vai");new Ed(42655,"U+A640..U+A69F Cyrillic Extended-B");new Ed(42751,"U+A6A0..U+A6FF Bamum");new Ed(42783,"U+A700..U+A71F Modifier Tone Letters");new Ed(43007,"U+A720..U+A7FF Latin Extended-D");new Ed(43055,"U+A800..U+A82F Syloti Nagri");new Ed(43071,"U+A830..U+A83F Common Indic Number Forms");new Ed(43135,"U+A840..U+A87F Phags-pa");new Ed(43231,"U+A880..U+A8DF Saurashtra");new Ed(43263,"U+A8E0..U+A8FF Devanagari Extended");new Ed(43311,
"U+A900..U+A92F Kayah Li");new Ed(43359,"U+A930..U+A95F Rejang");new Ed(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new Ed(43487,"U+A980..U+A9DF Javanese");new Ed(43615,"U+AA00..U+AA5F Cham");new Ed(43647,"U+AA60..U+AA7F Myanmar Extended-A");new Ed(43743,"U+AA80..U+AADF Tai Viet");new Ed(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new Ed(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new Ed(44031,"U+ABC0..U+ABFF Meetei Mayek");new Ed(55215,"U+AC00..U+D7AF Hangul Syllables");new Ed(55295,"U+D7B0..U+D7FF Hangul Jamo Extended-B");
new Ed(56191,"U+D800..U+DB7F High Surrogates");new Ed(56319,"U+DB80..U+DBFF High Private Use Surrogates");new Ed(57343,"U+DC00..U+DFFF Low Surrogates");new Ed(63743,"U+E000..U+F8FF Private Use Area");new Ed(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new Ed(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new Ed(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new Ed(65039,"U+FE00..U+FE0F Variation Selectors");new Ed(65055,"U+FE10..U+FE1F Vertical Forms");new Ed(65071,"U+FE20..U+FE2F Combining Half Marks");
new Ed(65103,"U+FE30..U+FE4F CJK Compatibility Forms");new Ed(65135,"U+FE50..U+FE6F Small Form Variants");new Ed(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new Ed(65519,"U+FF00..U+FFEF Halfwidth and fullwidth forms");new Ed(65535,"U+FFF0..U+FFFF Specials");new Ed(65663,"U+10000..U+1007F Linear B Syllabary");new Ed(65791,"U+10080..U+100FF Linear B Ideograms");new Ed(65855,"U+10100..U+1013F Aegean Numbers");new Ed(65935,"U+10140..U+1018F Ancient Greek Numbers");new Ed(65999,"U+10190..U+101CF Ancient Symbols");
new Ed(66047,"U+101D0..U+101FF Phaistos Disc");new Ed(66207,"U+10280..U+1029F Lycian");new Ed(66271,"U+102A0..U+102DF Carian");new Ed(66351,"U+10300..U+1032F Old Italic");new Ed(66383,"U+10330..U+1034F Gothic");new Ed(66463,"U+10380..U+1039F Ugaritic");new Ed(66527,"U+103A0..U+103DF Old Persian");new Ed(66639,"U+10400..U+1044F Deseret");new Ed(66687,"U+10450..U+1047F Shavian");new Ed(66735,"U+10480..U+104AF Osmanya");new Ed(67647,"U+10800..U+1083F Cypriot Syllabary");new Ed(67679,"U+10840..U+1085F Imperial Aramaic");
new Ed(67871,"U+10900..U+1091F Phoenician");new Ed(67903,"U+10920..U+1093F Lydian");new Ed(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new Ed(68095,"U+109A0..U+109FF Meoritic Cursive");new Ed(68191,"U+10A00..U+10A5F Kharoshthi");new Ed(68223,"U+10A60..U+10A7F Old South Arabian");new Ed(68415,"U+10B00..U+10B3F Avestan");new Ed(68447,"U+10B40..U+10B5F Inscriptional Parthian");new Ed(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new Ed(68687,"U+10C00..U+10C4F Old Turkic");new Ed(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");
new Ed(69759,"U+11000..U+1107F Brahmi");new Ed(69839,"U+11080..U+110CF Kaithi");new Ed(69887,"U+110D0..U+110FF Sora Sompeng");new Ed(69967,"U+11100..U+1114F Chakma");new Ed(70111,"U+11180..U+111DF Sharada");new Ed(71375,"U+11680..U+116CF Takri");new Ed(74751,"U+12000..U+123FF Cuneiform");new Ed(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new Ed(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new Ed(92735,"U+16800..U+16A3F Bamum Supplement");new Ed(94111,"U+16F00..U+16F9F Miao");new Ed(110847,
"U+1B000..U+1B0FF Kana Supplement");new Ed(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new Ed(119295,"U+1D100..U+1D1FF Musical Symbols");new Ed(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new Ed(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new Ed(119679,"U+1D360..U+1D37F Counting Rod Numerals");new Ed(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new Ed(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");new Ed(127023,"U+1F000..U+1F02F Mahjong Tiles");
new Ed(127135,"U+1F030..U+1F09F Domino Tiles");new Ed(127231,"U+1F0A0..U+1F0FF Playing Cards");new Ed(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");new Ed(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new Ed(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new Ed(128591,"U+1F600..U+1F64F Emoticons");new Ed(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new Ed(128895,"U+1F700..U+1F77F Alchemical Symbols");new Ed(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");
new Ed(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");new Ed(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");new Ed(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new Ed(917631,"U+E0000..U+E007F Tags");new Ed(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new Ed(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new Ed(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");Object(f.a)(bm,"UnicodeBlocks",null,[1946]);class In{constructor(){this.W=
null}zc(Q){this.W=Q;this.W.register(xh,"Common.App.SensitiveLogging.StringDifference").as("Common.App.SensitiveLogging.IStringDifference").singleInstance();this.W.register(bm,"Common.App.SensitiveLogging.UnicodeBlocks").as("Common.App.SensitiveLogging.IUnicodeBlocks").singleInstance()}get name(){return"Common.App.SensitiveLogging"}init(){this.W.resolve("Common.App.SensitiveLogging.IStringDifference");this.W.resolve("Common.App.SensitiveLogging.IUnicodeBlocks")}dispose(){}static main(){ca.a.instance.Pc(new In)}}
Object(f.a)(In,"SensitiveLoggingPackage",null,[1,2]);var nf;(function(Q){Q[Q.myFiles=0]="myFiles";Q[Q.recent=1]="recent";Q[Q.currentFolder=2]="currentFolder";Q[Q.yourPhone=3]="yourPhone"})(nf||(nf={}));Object(f.b)("SharedFilePickerLandingLocation",nf);class Ph{constructor(Q){this.pBb=this.Kac=null;this._initialized=!1;this.pkf=Q}M5e(Q){this._initialized||(Q.vv(sf.a.FIi),Q.VB(sf.a.FIi,Object(a.a)(this,this.aUm,"onReceivedPickerResponse")),this._initialized=!0)}xcf(Q){return this.pBb=new Promise((wa,
eb)=>{const Lb={};Lb[zf.a.B2m]=Q;this.Kac=(ec,Tc)=>{""===Tc?(ja.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),wa(ec)):("Canceled"===Tc?ja.ULS.sendTraceTag(572548164,306,50,Tc):ja.ULS.sendTraceTag(556901065,306,10,Tc),eb(Tc))};this.pkf.execute(ec=>{this.M5e(ec);ec.sendMessage(sf.a.kYm,Lb)})})}aUm(Q){this.Kac(Q.Values[zf.a.dCn],void 0===Q.Values[zf.a.XJf]||null===Q.Values[zf.a.XJf]?"":Q.Values[zf.a.XJf])}bsf(){return H.AFrameworkApplication.K.$("UiHostCommonFilePicker")}vZe(Q,
wa,eb,Lb,ec,Tc,Ad,we,Rd=null){const yf={};yf[zf.a.EBn]=Q;yf[zf.a.titleText]=wa;yf[zf.a.G9j]=eb;yf[zf.a.H9j]=Lb;yf[zf.a.J9j]=ec;yf[zf.a.NVk]=!0;yf[zf.a.b6k]=Tc;yf[zf.a.F2m]=Ad;yf[zf.a.E2m]=nf[we];vg.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(yf[zf.a.G2m]="Dark");Rd&&(null!=Rd.LWb&&(yf[zf.a.LWb]=Rd.LWb),null!=Rd.B4b&&(yf[zf.a.B4b]=Rd.B4b));return yf}}Object(f.a)(Ph,"SharedFilePickerManager",null,[1950]);class um{constructor(){this.W=null}get name(){return"Common.App.SharedFilePicker"}zc(Q){this.W=
Q;Q.register(Ph,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").singleInstance().Xd(()=>new Ph(Q.Za("Postmessage.IHostPostmessenger")))}init(){H.AFrameworkApplication.K.yq(()=>{this.YYa()})}YYa(){this.W.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){ca.a.instance.Pc(new um)}}Object(f.a)(um,"SharedFilePickerPackage",null,[1,2]);class Kc extends Sys.EventArgs{constructor(Q){super();this.vJm=Q}}Object(f.a)(Kc,
"TypingSpeedMeterChangedEventArgs",Sys.EventArgs,[]);class dk{}Object(f.a)(dk,"TypingSpeedMeterWindow",null,[]);class oi{constructor(Q,wa,eb,Lb,ec){this.$yf=null;this.Jyg=this.Vmd=this.LIe=this.G9b=0;this.PJe=new l.a;this.my=Q;this.Ih=wa;this.Ih.fqd(Object(a.a)(this,this.GFb,"onCpuMeterFrameAvailable"));this.cXj=eb;this.NKj=ec;this.vWj=Lb}U6j(Q){this.PJe.addHandler("TypingSpeedWindowAvailable",Q)}Ypn(Q){this.PJe.removeHandler("TypingSpeedWindowAvailable",Q)}GFb(Q,wa){this.$yf=wa.IRc}Rhi(){var Q=this.my();
Q-this.Vmd>this.vWj&&this.hQi();this.G9b||(this.LIe=Q);this.Vmd=Q;this.G9b++;this.G9b>=this.NKj&&(this.PJe.raiseEvent("TypingSpeedWindowAvailable",new Kc(this.Rhh())),Q=new dk,Q.TS=this.Rhh(),this.$yf&&(Q.CP=this.$yf.CP),Q.EC=this.Jyg,this.cXj.track(Q),this.hQi())}hQi(){this.Vmd=this.LIe=this.G9b=0}Rhh(){return 2>this.G9b?0:Math.round(6E4*(this.G9b-1)/(this.Vmd-this.LIe))}wio(Q){this.Jyg=Q}dispose(){this.Ih.lRf(Object(a.a)(this,this.GFb,"onCpuMeterFrameAvailable"))}}Object(f.a)(oi,"TypingSpeedMeter",
null,[1977]);class Bd{constructor(Q){this.Ktb=null;this.er=new u.a;this.my=Q}initialize(Q,wa,eb,Lb){this.Ktb||(this.Ktb=new oi(this.my,Q,wa,eb,Lb),this.er.Gg(this.Ktb));return this.Ktb}}Object(f.a)(Bd,"TypingSpeedMeterProvider",null,[1953]);class uk{constructor(){this.OJe=null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(H.AFrameworkApplication.K.$("TypingSpeedMeterIsEnabled")){const Q=ea.a.instance.resolve("Common.App.TypingSpeedMeter.TypingSpeedMeterProvider"),wa=vl.a.Iq(ea.a.instance.Za("Common.ICpuMeterProvider"));
wa.continueWith(()=>{const eb=wa.result.er.task;var Lb=new ta.a(H.AFrameworkApplication.K.rc("TypingSpeedMeterWindowSamplingPercent",0)/100);Lb=new ya.a(Object(a.a)(Lb,Lb.p2a,"shouldBeInSample"));const ec=P.a.lF(12,1,Lb),Tc=H.AFrameworkApplication.K.rc("TypingSpeedMeterWindowTimeoutMs",5E3),Ad=H.AFrameworkApplication.K.rc("TypingSpeedMeterMaxKeystrokesPerWindow",5);eb.CWR(()=>this.OJe=Q.initialize(eb.result,ec,Tc,Ad))})}}dispose(){this.OJe&&this.OJe.dispose()}zc(Q){Q.register(Bd,"Common.App.TypingSpeedMeter.TypingSpeedMeterProvider").as("Common.ITypingSpeedMeterProvider").singleInstance().Xd(()=>
new Bd(ia.a.lf))}static main(){ca.a.instance.Pc(new uk)}}Object(f.a)(uk,"TypingSpeedMeterPackage",null,[1,2]);class cl{create(Q){return new ta.a(Q)}}Object(f.a)(cl,"RandomSamplerFactory",null,[856]);var qe=d(9),Wf=d(1383);class dl{constructor(Q,wa,eb,Lb,ec){Q.p6j(()=>{Lb.yXc()});Q.L6j((Tc,Ad)=>{Lb.wXc(Ad.revisionId,Ad.i0a)});Q.bOe((Tc,Ad)=>{Lb.wZl(Ad.lxn,Ad.i0a,Ad.f$i)});Q.o6j(()=>{Lb.eSf()});wa.O6j((Tc,Ad)=>{Lb.s6n(Ad.HOi,Ad.t$d,Ad.actualValue)});wa.B5j((Tc,Ad)=>{Lb.r6n(Ad.HOi,Ad.t$d,Ad.actualValue)});
ec.eqd(()=>{Lb.q2c()});eb.j1((Tc,Ad)=>{6===Ad.type&&Lb.scc(Ad.WI)})}}Object(f.a)(dl,"EventForwarder",null,[]);class Ne{constructor(Q,wa,eb){this.$Lj=Q;this.EM=eb;this.$Ub=wa}create(Q,wa){return new dl(this.$Lj,this.$Ub,Q,wa,this.EM)}}Object(f.a)(Ne,"EventForwarderFactory",null,[]);var rj=d(434);class vk{}vk.kbo="TypingToOutboundReplicationStart";vk.MYm="OutboundReplicationStartToOutboundReplicationEnd";vk.cSi="RtcNotificationToInboundReplicationEnd";vk.Zcj="TypingToInboundReplicationEnd";Object(f.a)(vk,
"PerfTrackerPhases",null,[]);class Vh{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we,Rd=null){this.Zwe=this.TNg=!1;this.Tye=5;this.tPg=50;this.wxe=20;this.Uve=this.gxe=this.gwa=null;this.Qkc=this.Gkc=0;this.VGe=this.dIe=!1;this.vmd=Array(7);this.hic=null;this.tFg=!1;this.zie=null;this.Rfa={};this.Gbd=Q;this.nRa=wa;this.BKj=eb;this.iHg=Lb.create(vk.cSi,ec,Tc,20,!1);this.Cnd=Lb.create(vk.Zcj,Ad,we,20,!0);if(this.Ma=H.AFrameworkApplication.K)this.TNg=this.Ma.$("LogSteppedInboundFrameIsEnabled"),this.Zwe=this.Ma.$("LogTasksDetailsFromCPUMeterIsEnabled"),
this.wxe=this.Ma.rc("InboundFrameMaxNumberOfLongRunningTasks",20),this.tPg=this.Ma.rc("InboundFrameMinLengthForLongRunningTasksInMs",50),this.Tye=this.Ma.rc("InboundFrameNumberOfLastShortTasks",5);this.Cnb=Rd}get Nsk(){null==this.zie&&(this.zie=!!this.Ma&&this.Ma.$("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));return this.zie}initialize(Q){this.gwa=Q}Dsn(Q,wa,eb=null){this.blh();ja.ULS.shipAssertTag(8229761,324,0<Q.length);let Lb=!1;for(const Tc of Q){const Ad=Tc.toString();if(Ad in
this.Rfa){var ec=this.Rfa[Ad];if(!ec.Ycc){ec.JVi(Q,wa,eb);if(this.Zwe&&!Lb){const we=this.z4k(),Rd=this.Udl(this.hic);Lb=!0;this.Uli(Tc.toString(),ec,we,this.Uve,this.vmd,Rd)}else this.Uli(Tc.toString(),ec,null,null,this.vmd,null);delete this.Rfa[Ad]}}else ec=this.Gbd.create(this.iHg,this.Cnd),ec.JVi(Q,wa),this.Rfa[Ad]=ec}this.VGe=!1}scc(Q){ja.ULS.shipAssertTag(8257930,304,Q.jhi,"Expected data not sent on the wire");if(Q.jhi){if(Q.B3d in this.Rfa){var wa=this.Rfa[Q.B3d];wa.Q3d||(wa.scc(Q.revisionId,
Q.rAi,Q.P1i,Q.i0a),delete this.Rfa[Q.B3d])}else wa=this.Gbd.create(this.iHg,this.Cnd),wa.scc(Q.revisionId,Q.rAi,Q.P1i,Q.i0a),this.Rfa[Q.B3d]=wa;this.blh()}}b0l(){this.dIe||(this.gxe=Array(this.wxe),this.Uve=Array(this.Tye),this.Qkc=this.Gkc=0,this.vmd=[0,0,0,0,0,0,0,0],this.hic=Array(3),this.hic[1]=[0,0],this.hic[2]=[0,0],this.dIe=!0)}iSn(Q){return!Q.TP&&Q.TN===J.a.BOi&&(Q=rj.a(this.Rfa))&&Q[0]?!0:!1}ePm(Q){this.dIe=!1;const wa=rj.a(this.Rfa);wa&&wa[0]&&(Q.TRT>=this.tPg&&this.Gkc<this.wxe?this.gxe[this.Gkc++]=
Q:(this.Uve[this.Qkc]=Q,this.Qkc=this.Qkc<this.Tye-1?this.Qkc+1:0),this.zzm(Q),this.Tzm(Q))}dPm(){this.Zwe&&(this.b0l(),this.VGe=!0)}zzm(Q){this.vmd[Q.TP]++}Tzm(Q){if(Q&&Q.UI){const wa=this.hic[Q.UI];wa[0]+=1;wa[1]+=Q.TRT}}Udl(Q){const wa={};Q&&(Q[1]&&(wa.Typing=Q[1]),Q[2]&&(wa.Clicking=Q[2]));return wa}z4k(){return this.Gkc?this.gxe.slice(0,this.Gkc-1):null}blh(){var Q=rj.a(this.Rfa);if(Q&&(this.tFg||this.EAm(Q),Q.length>this.BKj))for(const wa of Q){Q=this.Rfa[wa];const eb=Q.createdTime,Lb=this.nRa();
6E4<Lb-eb&&(w.b(8438528,304,50,"{0}",{["Not Received"]:Q.Ycc?"RtcNotification":"ServerRevision",["Duration"]:Lb-eb}),Q.Ycc||w.b(42075798,304,15,"{0}",{["RevisionId"]:wa,["Duration"]:Lb-eb}),delete this.Rfa[wa])}}EAm(Q){if(this.Nsk&&this.Cnb)for(const wa of Q)if(Q=this.Rfa[wa],Q.Q3d&&!Q.Ycc&&(Q=Q.createdTime,2E3<this.nRa()-Q)){let eb=null;qe.App.xa&&qe.App.xa.jb&&qe.App.xa.jb.Zc&&(eb=qe.App.xa.jb.Zc.contentReplicator);this.Cnb.execute(Lb=>{Lb.flush(eb,1)});this.tFg=!0}}Uli(Q,wa,eb,Lb,ec,Tc){this.TNg&&
(wa=wa.Edl())&&(wa.RevisionId=Q,wa.LRTWR=eb,wa.LSTWR=Lb,wa.TSD=ec,wa.UIWR=Tc,this.gwa&&this.gwa.track(wa))}}Object(f.a)(Vh,"InboundMonitor",null,[2005]);class zd{constructor(Q,wa,eb,Lb){this.aA=wa;this.Gbd=eb;this.sWj=Lb}create(Q,wa,eb,Lb,ec=null){return new Vh(this.Gbd,this.aA,50,this.sWj,Q,wa,eb,Lb,ec)}}Object(f.a)(zd,"InboundMonitorFactory",null,[1965]);var Za=d(299);class Cb{}Cb.fce="UserCount";Cb.hxn="RevisionChainLength";Object(f.a)(Cb,"PerfTrackerPivotNames",null,[]);class Rb{}Object(f.a)(Rb,
"PerfTrackingContext",null,[]);const pc=Q=>5>=Q?"5AndFewer":10>=Q?"6To10":15>=Q?"11To15":20>=Q?"15To20":25>=Q?"21To25":30>=Q?"26To30":"31AndAbove";class Rc{}Object(f.a)(Rc,"SteppedInboundFrame",null,[]);class wb{constructor(Q,wa,eb,Lb,ec){this.p8a=this.Ibd=null;this.dHg=500;this.Hbd=this.zpa=this.Hpb=this.xQb=this.j5c=-1;this.Peg=null;this.RYg=this.IXg=!1;this.lXg=null;this.VSg=this.DHa=0;this.RSb=Q;this.createdTime=wa();this.Ukd=!1;this.eAe=0;this.lrb=eb;this.HFj=Lb;this.Cnd=ec;H.AFrameworkApplication.K&&
(this.dHg=H.AFrameworkApplication.K.rc("InboundFrameSamplingMinimalTotalTimeMs",500))}get Q3d(){return this.IXg}get Ycc(){return this.RYg}get iRi(){return this.lXg}get i0a(){return this.DHa}get LYm(){return this.VSg}get gyb(){return this.lrb()}scc(Q,wa,eb,Lb){this.Q3d||(this.Ukd=eb,this.eAe=wa,this.j5c=F.a.fU(ia.a.lf(),2),this.Peg=(new Date).toISOString(),this.p8a=Q,this.VSg=Lb,this.IXg=!0,this.Ycc?this.hCh():(this.p6i(),fa.a.instance.yy(Q.toString()+"Start"),Za.a.instance.bTd(2)))}JVi(Q,wa,eb=null){this.Ycc||
(this.DHa=wa,this.RYg=!0,this.lXg=Q,this.Hbd=F.a.fU(ia.a.lf(),2),this.Q3d&&(fa.a.instance.yy(this.p8a.toString()+"End"),eb&&(this.xQb=eb.Mtn,this.Hpb=eb.A1a,this.zpa=eb.Esn),Za.a.instance.Ptd(),this.hCh()))}Edl(){if(!(0<this.j5c&&0<this.xQb&&0<this.Hpb&&0<this.zpa&&0<this.Hbd))return null;const Q=new Rc;Q.TT=F.a.fU(this.Hbd-this.j5c,2);if(Q.TT<this.dHg)return null;Q.ST=this.Peg;Q.UC=this.gyb;Q.RS=F.a.fU(this.xQb-this.j5c,2);Q.SR=F.a.fU(this.Hpb-this.xQb,2);Q.RRS=F.a.fU(this.zpa-this.Hpb,2);Q.RP=F.a.fU(this.Hbd-
this.zpa,2);Q.ResponseLanded=F.a.fU(this.Hpb,2);0<Q.RS?(fa.a.instance.gX("RTCToRequestSent",this.p8a.toString()+"Start","RequestInvoked"+this.xQb),fa.a.instance.gX("RequestSentToResponseReceived","RequestInvoked"+this.xQb,"RequestCompleted"+this.Hpb),fa.a.instance.gX("ResponseReceivedToReplicationStart","RequestCompleted"+this.Hpb,"ReplicationStart"+this.zpa)):fa.a.instance.gX("RTCToReplicationStart",this.p8a.toString()+"Start","ReplicationStart"+this.zpa);fa.a.instance.gX("Replication","ReplicationStart"+
this.zpa,this.p8a.toString()+"End");return Q}p6i(){this.Ibd=this.RSb.create();this.Ibd.start(vk.cSi,vk.Zcj)}hCh(){this.Ibd||this.p6i();const Q=this.Ibd.end(this.Ukd,this.rKk());this.HFj.Z2d(Q);this.Cnd.Z2d(Q+this.eAe)}rKk(){const Q={};Q[Cb.fce]=pc(this.gyb);var wa=this.iRi.length;Q[Cb.hxn]=9>=wa?wa.toString():"10AndAbove";return Object.assign(new Rb,{P:Q,FC:this.i0a,CFC:this.LYm+this.i0a,ID:this.p8a.toString(),CD:this.eAe,UC:this.gyb,RCL:this.iRi.length})}}Object(f.a)(wb,"InboundOperation",null,[2004]);
class Td{constructor(Q,wa,eb){this.tGa=Q;this.nRa=wa;this.lrb=eb}create(Q,wa){return new wb(this.tGa,this.nRa,this.lrb,Q,wa)}}Object(f.a)(Td,"InboundOperationFactory",null,[1964]);class sd{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we,Rd){this.Vkd=!0;this.cUg=this.shd=null;this.kO=yf=>{this.ij.kO(6,yf)};this.dAe=Q;this.KAj=wa;this.WOj=eb;this.ij=Lb;this.QJe=ec.create("TypingToOutboundReplicationStart",Tc,Ad,20,!1);this.lDe=ec.create("OutboundReplicationStartToOutboundReplicationEnd",we,Rd,20,!1)}get GJf(){return this.shd}get hZd(){return this.cUg}q2c(){!this.GJf&&
this.Vkd&&(this.Vkd=this.KAj())&&(this.shd=this.dAe.create(this.kO,this.WOj(),this.QJe,this.lDe),this.GJf.q2c())}yXc(){this.Vkd=!0;this.cUg=this.GJf;this.hZd&&(this.shd=null,this.hZd.yXc())}eSf(){this.shd=null}wXc(Q,wa){this.hZd&&this.hZd.wXc(Q,wa)}}Object(f.a)(sd,"OutboundMonitor",null,[]);class Me{constructor(Q,wa){this.dAe=Q;this.ONj=wa}create(Q,wa,eb,Lb,ec,Tc,Ad){return new sd(this.dAe,Q,wa,eb,this.ONj,Lb,ec,Tc,Ad)}}Object(f.a)(Me,"OutboundMonitorFactory",null,[]);var tf=d(59);class Pf{constructor(Q){this.H8a=
Q}get ndn(){return this.H8a}xb(Q){return!!this.H8a&&Q in this.H8a}get jhi(){return this.xb(Pf.hzd)&&this.xb(Pf.nIb)&&this.xb(Pf.mZf)}get revisionId(){if(this.xb(Pf.nIb))return tf.a.Of(this.H8a[Pf.nIb]);throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");}get B3d(){if(this.xb(Pf.nIb))return this.H8a[Pf.nIb];throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");}get rAi(){if(this.xb(Pf.hzd))return Number.parseInvariant(this.H8a[Pf.hzd]);throw Error.create("Unable to parse DurationKey key from dictionary into int");
}get P1i(){if(this.xb(Pf.nIb))return Boolean.parse(this.H8a[Pf.mZf]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");}get i0a(){if(this.xb(Pf.aDf))return Number.parseInvariant(this.H8a[Pf.aDf]);throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}static QHk(Q){return new Pf(Q)}static VHk(Q,wa,eb,Lb){const ec={};ec[Pf.hzd]=Q.toString();ec[Pf.nIb]=wa.toString();ec[Pf.mZf]=eb.toString();ec[Pf.aDf]=Lb.toString();return new Pf(ec)}}
Pf.nIb="RevisionID";Pf.hzd="Duration";Pf.mZf="ShouldSample";Pf.aDf="NumSequentialFailures";Object(f.a)(Pf,"ReplicationNotificationMessage",null,[2002]);class Yh{constructor(Q,wa,eb,Lb,ec,Tc,Ad){this.Dr=this.Fi=0;this.zrb=this.pwc=null;this.Jfe=[];this.aVg=null;this.X9c={};this.DHa=0;this.RSb=Q;this.qSj=wa;this.nRa=eb;this.lrb=Lb;this.OZg=ec;this.p8a=null;this.X9c.TypingStartStage=null;this.X9c.ReplicationStartStage="TypingStartStage";this.X9c.ReplicationEndStage="ReplicationStartStage";this.m3g=1<
this.gyb;this.QJe=Tc;this.lDe=Ad}get gyb(){return this.lrb()}q2c(){this.TUe("TypingStartStage")&&(this.gPf("TypingStartStage"),ja.ULS.shipAssertTag(8257931,324,!this.zrb&&!this.Dr,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),this.Fi=this.nRa(),this.pwc=this.RSb.create(),this.h6i(this.pwc,vk.kbo))}yXc(){if(this.TUe("ReplicationStartStage")){this.gPf("ReplicationStartStage");ja.ULS.shipAssertTag(8257932,324,!!this.pwc,"TypingStart not called");if(this.pwc){const Q=this.cCh(this.pwc,
this.p8a);this.QJe.Z2d(Q)}this.zrb=this.RSb.create();this.h6i(this.zrb,vk.MYm)}}wXc(Q,wa){this.TUe("ReplicationEndStage")&&(this.gPf("ReplicationEndStage"),this.Dr=this.nRa(),this.DHa=wa,ja.ULS.shipAssertTag(8257933,324,!!this.zrb,"ReplicationStart not called"),this.zrb&&(ja.ULS.shipAssertTag(8193425,324,!!this.zrb,"ReplicationStart not called"),wa=this.cCh(this.zrb,Q),this.lDe.Z2d(wa)),ja.ULS.shipAssertTag(8257934,324,!!this.Fi,"StartTime not set. No message sent to other editors."),this.Fi&&(Q=
Pf.VHk(this.Dr-this.Fi,Q,this.OZg,this.DHa),this.qSj(Q.ndn)))}TUe(Q){if(this.X9c[Q]===this.aVg)return!0;ja.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.f_j()});return!1}f_j(){const Q=new Sys.StringBuilder;Q.append("Actual Phase:");for(let wa=0;wa<this.Jfe.length;wa++)Q.append(" "+this.Jfe[wa]);return Q.toString()}gPf(Q){this.Jfe.push(Q);this.aVg=Q}h6i(Q,wa){this.m3g&&Q.start(wa)}cCh(Q,wa){if(!this.m3g)return-1;const eb={};eb[Cb.fce]=pc(this.gyb);wa=Object.assign(new Rb,
{P:eb,FC:this.DHa,CFC:0,ID:wa?wa.toString():"",CD:0,UC:this.gyb,RCL:0});return Q.end(this.OZg,wa)}}Object(f.a)(Yh,"OutboundOperation",null,[2003]);class ti{constructor(Q,wa,eb){this.RSb=Q;this.nRa=wa;this.lrb=eb}create(Q,wa,eb,Lb){return new Yh(this.RSb,Q,this.nRa,this.lrb,wa,eb,Lb)}}Object(f.a)(ti,"OutboundOperationFactory",null,[1963]);class Fh{constructor(Q,wa){this.sxg=this._name=this.V0=null;this.le=Q;this.gwa=wa}start(Q,wa=null){this.V0=this.le.fg("UserAction",Q);this._name=Q;this.sxg=wa}end(Q,
wa){let eb=-1;Q&&(eb=this.V0.ni,wa.D=eb,wa.CN=this.sxg,wa.CD+=eb,this.gwa.track(wa,this._name));return eb}}Object(f.a)(Fh,"PerfTracker",null,[2001]);class Pg{constructor(Q,wa){this.le=Q;this.gwa=wa}create(){return new Fh(this.le,this.gwa)}}Object(f.a)(Pg,"PerfTrackerFactory",null,[1962]);class za{constructor(Q,wa,eb){this.nsc=null;this.NNj=Q;this.hHg=wa;this.jTb=eb}init(Q,wa,eb,Lb,ec,Tc,Ad){wa=this.jTb.create(wa/100);eb=this.jTb.create(eb/100);this.nsc=this.NNj.create(Object(a.a)(wa,wa.p2a,"shouldBeInSample"),
Object(a.a)(eb,eb.p2a,"shouldBeInSample"),Q,Lb,ec,Tc,Ad)}q2c(){this.nsc.q2c()}yXc(){this.nsc.yXc()}eSf(){this.nsc.eSf()}wXc(Q,wa){this.nsc.wXc(Q,wa)}wZl(Q,wa,eb=null){this.hHg.Dsn(Q,wa,eb)}scc(Q){Q=Pf.QHk(Q);this.hHg.scc(Q);fa.a.instance.yy(Q.revisionId+"Start")}s6n(Q,wa,eb){w.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.rwd(Q,wa,eb))}r6n(Q,wa,eb){w.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",this.rwd(Q,wa,eb))}rwd(Q,wa,eb){const Lb=
{};Lb.PhaseName=Q;Lb.ThresholdValue=wa;Lb.ActualValue=eb;return Lb}}Object(f.a)(za,"ReplicationTelemetryManager",null,[]);var rb=d(919);class Zb extends rb.a{constructor(Q,wa){super(Q,wa);this.aj=this.Uld=0}Mua(Q){this.Uld+=Q;this.aj++}getValue(){return this.aj?this.Uld/this.aj:0}COa(){this.aj=this.Uld=0}}Object(f.a)(Zb,"AverageMetric",rb.a,[]);class yc extends rb.a{constructor(Q,wa){super(Q,wa);this.pxa=0}Mua(Q){Q>this.pxa&&(this.pxa=Q)}getValue(){return this.pxa}COa(){this.pxa=0}}Object(f.a)(yc,
"MaxMetric",rb.a,[]);var Vc=d(1797);class Sd extends rb.a{constructor(Q,wa,eb=100){super(Q,wa);this.Ued=this.gSb=this.JUb=0;this.Fjd=eb;this.dEe=new Vc.a(this.Fjd)}Mua(Q){if(this.gSb===this.Fjd){const wa=this.dEe.dequeue();this.JUb-=wa;this.gSb--}this.dEe.enqueue(Q);this.JUb+=Q;this.gSb++;Q=this.JUb/this.gSb;Q>this.Ued&&this.gSb===this.Fjd&&(this.Ued=Q)}getValue(){return this.Ued}COa(){this.Ued=0;this.dEe=new Vc.a(this.Fjd);this.gSb=this.JUb=0}}Object(f.a)(Sd,"MaxRollingAverageMetric",rb.a,[]);class de extends rb.a{constructor(Q,
wa){super(Q,wa);this.aj=0}Mua(){this.aj++}getValue(){return this.aj}COa(){this.aj=0}}Object(f.a)(de,"CounterMetric",rb.a,[]);class jf{constructor(Q,wa){this.JVb=wa;this.$ge=new Zb(Q+"-AverageValue","Milliseconds");this.uxe=new yc(Q+"-MaxValue","Milliseconds");this.Bxe=new Sd(Q+"-MaxRollingAverageValue","Milliseconds");this.nke=new de(Q+"-NumberOfEvents","Count");this.Ypa=new Sa.a(Q+"-SlowPercentileAtValue","Percentile",H.AFrameworkApplication.K.NP("CoAuthLatencySlowTargetValue",3E3),H.AFrameworkApplication.K.NP("CoAuthLatencySlowThresholdPercentile",
95),this.JVb);this.pBe=new Sa.a(Q+"-BrokenSlowPercentileAtValue","Percentile",H.AFrameworkApplication.K.NP("CoAuthLatencyBrokenSlowTargetValue",5E3),H.AFrameworkApplication.K.NP("CoAuthLatencyBrokenSlowThresholdPercentile",95),this.JVb)}d_(Q){this.$ge.Mua(Q);this.uxe.Mua(Q);this.Bxe.Mua(Q);this.nke.Mua(Q);this.Ypa.Mua(Q);this.pBe.Mua(Q)}B1d(){this.$ge.hOa();this.uxe.hOa();this.Bxe.hOa();this.nke.hOa();this.Ypa.hOa();this.pBe.hOa();this.$ge.COa();this.uxe.COa();this.Bxe.COa();this.nke.COa();this.Ypa.COa();
this.pBe.COa()}}Object(f.a)(jf,"ReplicationLatencyMetrics",null,[]);class Ke{constructor(){this.dwe=new lb.a}tJi(Q,wa,eb){if(!(0>wa)){if(!({value:Lb}=this.dwe.Dc(Q,Lb)).returnValue){var Lb=new jf(Q,eb);this.dwe.Z(Q,Lb)}Lb.d_(wa)}}B1d(){for(const Q of this.dwe.values)Q.B1d()}}Object(f.a)(Ke,"ReplicationTelemetryMetricsManager",null,[1961]);class Je{tJi(){}B1d(){}}Object(f.a)(Je,"ReplicationTelemetryMetricsManagerStub",null,[1961]);class Sh{constructor(Q,wa,eb,Lb,ec,Tc,Ad){this.nUa=this.jnd=0;this.cLj=
Q;this.tBe=eb;this.v1g=Lb;this.fug=ec;this.$Ub=wa;this.dLj=Tc;this.JVb=Ad}Z2d(Q){this.cLj.tJi(this.tBe,Q,this.JVb);Q>this.v1g&&this.$Ub.b6n(this.tBe,this.v1g,Q);this.jnd+=Q;this.nUa++;this.jnd/this.nUa>this.fug&&this.nUa>this.dLj&&this.$Ub.pfk(this.tBe,this.fug,this.jnd/this.nUa)}}Object(f.a)(Sh,"TimeSpanVerifier",null,[1999]);class sc{constructor(Q,wa){this.ZQj=Q;this.$Ub=wa}create(Q,wa,eb,Lb,ec){return new Sh(this.ZQj,this.$Ub,Q,wa,eb,Lb,ec)}}Object(f.a)(sc,"TimeSpanVerifierFactory",null,[1960]);
class mg extends Sys.EventArgs{constructor(Q,wa,eb){super();this.HOi=Q;this.t$d=wa;this.actualValue=eb}}Object(f.a)(mg,"TimeSpanVerifierEventArgs",Sys.EventArgs,[]);class Lc{constructor(){this.sa=new l.a}b6n(Q,wa,eb){this.sa.raiseEvent("TSVTE",new mg(Q,wa,eb))}pfk(Q,wa,eb){this.sa.raiseEvent("TSVATE",new mg(Q,wa,eb))}O6j(Q){this.sa.addHandler("TSVTE",Q)}B5j(Q){this.sa.addHandler("TSVATE",Q)}}Object(f.a)(Lc,"TimeSpanVerifierNotifier",null,[1823]);class Pj{constructor(){this.W=this.Ma=null}get name(){return"Box4.ReplicationTelemetry"}zc(Q){this.Ma=
Q.resolve("Common.IAppSettingsManager");this.W=Q;if(this.Ma.$("Box4ReplicationTelemetryIsEnabled")){Q.ha("ReplicationTelemetry.IPerfTrackerFactory",()=>new Pg(qe.App.xa.iq,P.a.lF(20,1,new W.a))).singleInstance();Q.ha("ReplicationTelemetry.ITimeSpanVerifierNotifier",()=>new Lc).singleInstance();this.Ma.$("Box4ReplicationTelemetryMetricsIsEnabled")?Q.ha("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new Ke).singleInstance():Q.ha("ReplicationTelemetry.IReplicationTelemetryMetricsManager",
()=>new Je).singleInstance();Q.ha("ReplicationTelemetry.ITimeSpanVerifierFactory",()=>new sc(Q.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager"),Q.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"))).singleInstance();Q.ha("ReplicationTelemetry.OutboundOperationFactory",()=>new ti(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Pj.uOh)).singleInstance();Q.ha("ReplicationTelemetry.OutboundMonitorFactory",()=>new Me(Q.resolve("ReplicationTelemetry.OutboundOperationFactory"),
Q.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory"))).singleInstance();Q.ha("ReplicationTelemetry.InboundOperationFactory",()=>new Td(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Pj.uOh)).singleInstance();var wa=new zd(Q.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Q.resolve("ReplicationTelemetry.InboundOperationFactory"),Q.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory")),eb=this.Ma.$("ComponentStateLoggingPackageIsEnabled")?
this.W.Za("Common.IComponentStateLogManager"):null;Q.ha("ReplicationTelemetry.IInboundMonitor",()=>wa.create(this.Ma.rc("Box4ReplicationTelemetryInboundOperationThreshold",0),this.Ma.rc("Box4ReplicationTelemetryInboundOperationAverageThreshold",0),this.Ma.rc("Box4ReplicationTelemetryTypingToInboundEndThreshold",0),this.Ma.rc("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",0),eb)).singleInstance();Q.ha("Common.IRandomSamplerFactory",()=>new cl).singleInstance();Q.ha("ReplicationTelemetry.ReplicationTelemetryManager",
()=>new za(Q.resolve("ReplicationTelemetry.OutboundMonitorFactory"),Q.resolve("ReplicationTelemetry.IInboundMonitor"),Q.resolve("Common.IRandomSamplerFactory"))).singleInstance();Q.ha("ReplicationTelemetry.EventForwarderFactory",()=>new Ne(Wf.a.instance,Q.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"),Q.resolve("Box4.ContentEditableViewEventSource")))}}init(){if(this.Ma.$("Box4ReplicationTelemetryIsEnabled")){var Q=this.Ma.rc("Box4ReplicationTelemetrySamplePercent",0),wa=this.Ma.rc("Box4ReplicationTelemetryPhaseSamplePercent",
0),eb=this.Ma.rc("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),Lb=this.Ma.rc("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",0),ec=this.Ma.rc("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",0),Tc=this.Ma.rc("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),Ad=this;this.W.Za("Box4.Presence.IRtcProxyProvider").execute(Rd=>{Rd.iI().continueWith(()=>{const yf=Rd.iI().result,rg=Ad.W.resolve("ReplicationTelemetry.ReplicationTelemetryManager");
rg.init(yf,Q,wa,eb,Lb,ec,Tc);Ad.W.resolve("ReplicationTelemetry.EventForwarderFactory").create(yf,rg);if(Ad.Ma.$("LogSteppedInboundFrameIsEnabled")){const vi=vl.a.Iq(Ad.W.Za("Common.ICpuMeterProvider"));vi.continueWith(()=>{const Rk=Ad.W.resolve("ReplicationTelemetry.IInboundMonitor");var Ij=new ya.a(()=>!0);Ij=P.a.lF(19,1,Ij);Rk.initialize(Ij);const Sl=vi.result.er.task;Sl.continueWith(()=>{Sl.result.xpd(0,()=>Rk.VGe,hk=>{Rk.ePm(hk)});Sl.result.xpd(1,hk=>Rk.iSn(hk),()=>{Rk.dPm()})})})}ja.ULS.sendTraceTag(8257935,
305,50,"ReplicationTelemetry init")})});var we=this;H.AFrameworkApplication.rK(()=>{we.W.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager").B1d()})}}dispose(){}static uOh(){const Q=qe.App.rd;return Q?Q.TAh:0}}Object(f.a)(Pj,"ReplicationTelemetryPackage",null,[1,2]);var Vk=d(922),th=d(14),Wh=d(145),jg=d(3),Ui=d(96),Wl=d(65),ef=d(228),Wg=d(19),uh=d(24),Qj=d(11),zg=d(1899);class qk{static get ug(){return ld.a.Lx(qk.rl,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}qk.rl="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(f.a)(qk,"InsertSymbolsDialogHtml",null,[]);class md extends zg.a{constructor(Q,wa,eb){super();this.rRb=this.xIa=this.v9a=null;this.Qre=0;this.G4l=Lb=>{1===Lb?(this.xFf("symbol_d_"+md.Vpc),this.Wb.nK(this.PJ,!0),this.Wb.Cs().Uj.hy(this.aG),this.aG.focus()):this.hide()};this.c8i=Lb=>{if(Lb.target!==this.rRb){const ec=this.Wb.Cs();ec&&ec.Uj&&(ec.Uj.hy(Lb.target),this.rRb=Lb.target)}this.hVm(Lb.target.id)};this.K2n=Lb=>{const ec=Lb.Af;if("a"!==ec.tagName.toLowerCase())return!1;Lb.eventName===B.a.KC&&
this.xFf(ec.id);this.Wb.nK(this.PJ,!0);this.Wb.Cs().Uj.hy(ec);ec.focus();return!0};this.M2n=Lb=>{var ec=Lb.Af;if("a"!==ec.tagName.toLowerCase())return!1;const Tc=parseInt(ec.id.substr(ec.id.lastIndexOf("_")+1));if(Lb.Ib.ctrlKey||Lb.Ib.altKey||Lb.Ib.keyCode>=pg.a.FMb&&Lb.Ib.keyCode<=pg.a.GMb)return!1;if(Lb.eventName===B.a.Di){Lb=Lb.Ib.keyCode;let Ad=-1;Lb===Sys.UI.Key.enter?(this.xFf(ec.id),this.Wb.nK(this.PJ,!0),this.Wb.Cs().Uj.hy(ec),ec.focus()):Lb===Sys.UI.Key.up?Ad=Tc-15:Lb===Sys.UI.Key.down?Ad=
Tc+15:Lb===Sys.UI.Key.left?Ad=H.AFrameworkApplication.isRtl?Tc+1:Tc-1:Lb===Sys.UI.Key.right&&(Ad=H.AFrameworkApplication.isRtl?Tc-1:Tc+1);0<=Ad&&(ec=this.Igf("symbol_d_"+Ad))&&ec.focus()}return!0};this.ga=Q;this.Wb=wa;this.w9a=eb;this.We(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.We(0,CommonUIStrings.l_DialogClose);this.i8=!1;this.ug=qk.ug;this.kg="InsertSymbolsDialog"}dispose(){0<md.mJe&&ja.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",
this.Qre,md.mJe);md.Nzg++;ja.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",md.Nzg);this.ga=this.w9a=null;super.dispose()}nPa(){this.Zh(Box4Intl.Box4Strings.L_SymbolSingle,this.G4l,null);this.Qre=0;md.Tzg++;ja.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",md.Tzg);const Q=this.Igf("symbol_d_"+md.Vpc);Q&&Q.focus()}hide(){var Q=document.getElementById("symbolsContainer");if(Q&&(Q=Q.getElementsByTagName("a")))for(let wa=0;wa<Q.length;wa++)G.a.removeHandler(Q[wa],
B.a.focus,this.c8i);super.hide()}get xgb(){return md.aqc}set xgb(Q){md.aqc=Q}get tgb(){return md.Ppc}set tgb(Q){md.Ppc=Q}UT(){super.UT();var Q=document.getElementById("symbolsContainer");if(Q&&(Q.innerHTML=this.w9a.$jk(),Q=Q.getElementsByTagName("a")))for(let wa=0;wa<Q.length;wa++)G.a.addHandler(Q[wa],B.a.focus,this.c8i)}tja(){const Q=document.getElementById("symbolsContainer");Q&&(this.v9a||(this.v9a=this.K2n,this.lq.mb(B.a.click,Q,this.v9a),this.lq.mb(B.a.KC,Q,this.v9a)),this.xIa||(this.xIa=this.M2n,
this.re.mb(B.a.Di,Q,this.xIa),this.re.mb(B.a.At,Q,this.xIa),this.re.mb(B.a.Bh,Q,this.xIa)));super.tja()}pbb(){const Q=document.getElementById("symbolsContainer");Q&&(this.v9a&&(this.lq.sc(B.a.click,Q,this.v9a),this.lq.sc(B.a.KC,Q,this.v9a),this.v9a=null),this.xIa&&(this.re.sc(B.a.Di,Q,this.xIa),this.re.sc(B.a.At,Q,this.xIa),this.re.sc(B.a.Bh,Q,this.xIa),this.xIa=null));super.pbb()}hVm(Q){this.DZi("symbol_d_"+md.Vpc,!1);md.Vpc=parseInt(Q.substr(Q.lastIndexOf("_")+1));this.DZi(Q,!0);if(Q=document.getElementById("SymbolNameValueLabel")){const wa=
this.kHd(md.Vpc);Q.innerText=wa.altText}}kHd(Q){const wa=this.w9a.x9d.n2f.value,eb=rj.a(wa);return wa[eb[Q]]}xFf(Q){this.Qre++;md.mJe++;Q=parseInt(Q.substr(Q.lastIndexOf("_")+1));const wa=this.kHd(Q),eb={};eb.SourceControlId="symbol_"+Q+"_"+wa.v9d;this.ga.Xb(jg.a.Veb,2,eb);ja.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",Q)}Igf(Q){const wa=document.getElementById("symbolsContainer");return wa?wa.querySelector("#"+Q):null}DZi(Q,wa){(Q=this.Igf(Q))&&(wa?Q.setAttribute("selected",
"true"):Q.removeAttribute("selected"))}}md.Vpc=0;md.aqc=null;md.Ppc=null;md.Tzg=0;md.Nzg=0;md.mJe=0;Object(f.a)(md,"InsertSymbolsDialog",zg.a,[]);class Pd{constructor(Q,wa,eb,Lb,ec,Tc,Ad){this.NIl=()=>this.w9a.alk();this.XGi=(we,Rd,yf,rg,vi)=>{if(1===yf)return 32;we=this.w9a.$Bi(vi);we=String.format(this.w9a.L2n,we.character);vi[Vk.a.InnerHTML]=we;vi[Vk.a.On]=!1;return 32};this.NLa=(we,Rd,yf,rg,vi)=>{if(({ve:we,selected:yf,NLa:Sl}=this.MCc(Rd,yf)).returnValue)return Sl;var Rk=Wg.SelectionEditor.xf(yf);
let Ij=!0;yf=8;var Sl=this.Hc.Rc(15);Sl.Db(we.ud);Rk||(yf=this.ga.Qf(Rd,jg.a.hka,2,!0,rg,null),Rd=32===yf,ja.ULS.shipAssertTag(6407387,348,Rd,"DeleteForReplace did not succeed. Response is {0}",yf),Ij=Rd);Ij&&(Rd=we.Cb.Rg,Rk=Wg.SelectionEditor.xf(Rd),ja.ULS.shipAssertTag(6407388,348,Rk,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",Rd.contextId),yf=8,Rk&&(yf=this.ga.Qf(Rd,jg.a.Veb,2,!1,rg,vi),ja.ULS.shipAssertTag(6407389,348,32===yf,"Insertion at IP context did not succeed. Response is {0}",
yf),32===yf&&ai.FocusManager.instance().Jg(we.aI)));Sl.dispose();return yf};this.F4l=(we,Rd,yf,rg,vi)=>{if(1===yf)return 32;if(Wg.SelectionEditor.sZa(Rd))return 2;we=this.w9a.$Bi(vi);rg.Jr=we.index;rg=this.Xc.pg(Rd.node);yf=rg.Bb(11);ja.ULS.shipAssertTag(6379466,324,yf,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",Wh.a[Rd.node.type]);yf=this.Hc.Rc(15);yf.Ju(rg);Pd.characterPropertiesEditor.replaceTextRange(Rd,we.character,!0,!1);Rd=uh.SelectionFactory.xe(rg.currentNode,
Rd.cpBegin+1);this.hb.setSelection(Rd);yf.dispose();return 32};this.GGb=(we,Rd,yf,rg,vi)=>{if(1===yf)return 32;vi.MenuItems=this.lVj.value;return 32};this.d8i=(we,Rd,yf)=>{({NLa:we}=this.MCc(Rd,yf));return we};this.f3i=(we,Rd,yf)=>{2===yf&&(new md(this.ga,ai.FocusManager.instance(),ea.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).nPa();return 32};this.rNf=()=>32;this.ga=Q;this.Xc=wa;this.lVj=new kb.a(this.NIl);this.Hc=eb;this.w9a=Lb;this.Ok=ec;this.hb=Tc;this.Cm=Ad}Vb(){this.ga.gb(jg.a.rNf,
th.a.application,this.rNf,96);this.ga.pa(jg.a.GGb,th.a.view,this.GGb);this.ga.pa(jg.a.w9d,th.a.view,this.d8i);this.ga.pa(jg.a.I0d,th.a.view,this.XGi);this.ga.pa(jg.a.Veb,th.a.view,this.NLa);this.ga.pa(jg.a.GGb,th.a.Wc,this.GGb);this.ga.pa(jg.a.w9d,th.a.Wc,this.d8i);this.ga.pa(jg.a.I0d,th.a.Wc,this.XGi);this.ga.pa(jg.a.Veb,th.a.Wc,this.F4l);this.ga.Vc(jg.a.GGb,1124);this.ga.Vc(jg.a.w9d,1036);this.ga.Vc(jg.a.I0d,1124);this.ga.Vc(jg.a.Veb,1036);H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&
(this.ga.pa(jg.a.KLc,th.a.view,this.f3i),this.ga.pa(jg.a.KLc,th.a.Wc,this.f3i),this.ga.Vc(jg.a.KLc,1124))}MCc(Q,wa){let eb,Lb=null;Q.view.Be&&(Lb=Q.view);eb=null;if(!Lb||!Lb.Cb)return w.b(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",Q.toString()),{returnValue:!0,ve:Lb,selected:eb,NLa:8};eb=Lb.Cb.Rg;if(!eb)return{returnValue:!0,ve:Lb,selected:eb,NLa:2};if(this.Ok.bZ(eb)||this.Ok.ota(eb))return{returnValue:!0,ve:Lb,
selected:eb,NLa:8};if(Lb.Cb.ib.rI||this.Cm&&this.Cm.instance&&this.Cm.instance.vT(eb)||Wg.SelectionEditor.sZa(Q.tk))return{returnValue:!0,ve:Lb,selected:eb,NLa:2};if(Pd.Tg.Wva(Qj.ParagraphReader.KW,eb))return Q=8,Pd.Lc.Yb(Ui.a.zf,{["Reason"]:Wl.a.pN}),{returnValue:!0,ve:Lb,selected:eb,NLa:Q};Q=32;return 1===wa?{returnValue:!0,ve:Lb,selected:eb,NLa:Q}:{returnValue:!1,ve:Lb,selected:eb,NLa:Q}}static get characterPropertiesEditor(){return Pd.Vd||(Pd.Vd=ea.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(Q){Pd.Vd=
Q}static get Tg(){return ef.ContextSetEditor.instance}static get Lc(){return Ti.a.instance}}Pd.Vd=null;Object(f.a)(Pd,"SymbolsActor",null,[1789]);class Kd{constructor(Q,wa){this.v9d=Q;this.altText=wa}}Object(f.a)(Kd,"Symbol",null,[]);class Cd{constructor(){this.MHe=null;this.G0g=new kb.a(Cd.w_e)}get n2f(){return this.G0g}ERh(Q){this.MHe||(this.MHe=rj.a(this.G0g.value));return Array.indexOf(this.MHe,Q)}static w_e(){const Q={};Q["\u2022"]=new Kd("\u2022",Box4Intl.Box4Strings.L_Bullet);Q["\u20ac"]=new Kd("\u20ac",
Box4Intl.Box4Strings.L_EuroSign);Q["\u00a3"]=new Kd("\u00a3",Box4Intl.Box4Strings.L_PoundSign);Q["\u00a5"]=new Kd("\u00a5",Box4Intl.Box4Strings.L_YenSign);Q["\u00a9"]=new Kd("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);Q["\u00ae"]=new Kd("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);Q["\u2122"]=new Kd("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);Q["\u00b1"]=new Kd("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);Q["\u2260"]=new Kd("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);Q["\u2264"]=new Kd("\u2264",
Box4Intl.Box4Strings.L_LessThanOrEqualTo);Q["\u2265"]=new Kd("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);Q["\u00f7"]=new Kd("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);Q["\u00d7"]=new Kd("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);Q["\u221e"]=new Kd("\u221e",Box4Intl.Box4Strings.L_Infinity);Q["\u00b5"]=new Kd("\u00b5",Box4Intl.Box4Strings.L_MicroSign);Q["\u03b1"]=new Kd("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);Q["\u03b2"]=new Kd("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);
Q["\u03c0"]=new Kd("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);Q["\u03a9"]=new Kd("\u03a9",Box4Intl.Box4Strings.L_OhmSign);Q["\u03a3"]=new Kd("\u03a3",Box4Intl.Box4Strings.L_NArySummation);Q["\u00b0"]=new Kd("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);Q["\u0394"]=new Kd("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);Q["\u263a"]=new Kd("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);Q["\u2665"]=new Kd("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);Q["\u20b9"]=new Kd("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);
Q["\u00bf"]=new Kd("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);Q["\u00a1"]=new Kd("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);Q["\u2014"]=new Kd("\u2014",Box4Intl.Box4Strings.L_EmDash);Q["\u2026"]=new Kd("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);Q["\u00c0"]=new Kd("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);Q["\u00c1"]=new Kd("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);Q["\u00c2"]=new Kd("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);
Q["\u00c3"]=new Kd("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);Q["\u00c4"]=new Kd("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);Q["\u00c5"]=new Kd("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);Q["\u00c6"]=new Kd("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);Q["\u00c7"]=new Kd("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);Q["\u00c8"]=new Kd("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);Q["\u00c9"]=new Kd("\u00c9",
Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);Q["\u00ca"]=new Kd("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);Q["\u00cb"]=new Kd("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);Q["\u00cc"]=new Kd("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);Q["\u00cd"]=new Kd("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);Q["\u00ce"]=new Kd("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);Q["\u00cf"]=new Kd("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);
Q["\u00d1"]=new Kd("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);Q["\u00d2"]=new Kd("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);Q["\u00d3"]=new Kd("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);Q["\u00d4"]=new Kd("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);Q["\u00d5"]=new Kd("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);Q["\u00d6"]=new Kd("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);Q["\u00d9"]=
new Kd("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);Q["\u00da"]=new Kd("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);Q["\u00db"]=new Kd("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);Q["\u00dc"]=new Kd("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);Q["\u00df"]=new Kd("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);Q["\u00e0"]=new Kd("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);Q["\u00e1"]=new Kd("\u00e1",
Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);Q["\u00e2"]=new Kd("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);Q["\u00e3"]=new Kd("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);Q["\u00e4"]=new Kd("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);Q["\u00e5"]=new Kd("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);Q["\u00e6"]=new Kd("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);Q["\u00e7"]=new Kd("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);
Q["\u00e8"]=new Kd("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);Q["\u00e9"]=new Kd("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);Q["\u00ea"]=new Kd("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);Q["\u00eb"]=new Kd("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);Q["\u00ec"]=new Kd("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);Q["\u00ed"]=new Kd("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);Q["\u00ee"]=new Kd("\u00ee",
Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);Q["\u00ef"]=new Kd("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);Q["\u00f1"]=new Kd("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);Q["\u00f2"]=new Kd("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);Q["\u00f3"]=new Kd("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);Q["\u00f4"]=new Kd("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);Q["\u00f5"]=new Kd("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);
Q["\u00f6"]=new Kd("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);Q["\u00f9"]=new Kd("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);Q["\u00fa"]=new Kd("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);Q["\u00fb"]=new Kd("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);Q["\u00fc"]=new Kd("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);Q["\u00ff"]=new Kd("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);Q["\u011e"]=
new Kd("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);Q["\u011f"]=new Kd("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);Q["\u0130"]=new Kd("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);Q["\u0131"]=new Kd("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);Q["\u0152"]=new Kd("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);Q["\u0153"]=new Kd("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);Q["\u015e"]=new Kd("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);
Q["\u015f"]=new Kd("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);Q["\u0178"]=new Kd("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return Q}}Object(f.a)(Cd,"SymbolsLoader",null,[1788]);var hn=d(439),Xm=d(359),kh=d(213),dd=d(653),vb=d(1436),wc=d(236),ud=d(98);class ve{constructor(Q){this.x9d=Q}get L2n(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}$Bi(Q){Q=Q.SourceControlId.split("_");const wa={};2===Q.length?(wa.character=
Q[1],wa.index=this.x9d.ERh(wa.character)):(wa.character=Q[2],wa.index=parseInt(Q[1]));return wa}alk(){return this.tYh()}build(){return this.OIl()}$jk(){const Q=new Sys.StringBuilder;Q.append('<table class="moreSymbolsTable">');const wa=this.x9d.n2f.value,eb=rj.a(wa);let Lb=0;for(;Lb<eb.length;){Lb%15||Q.append('<tr role="presentation">');const ec=wa[eb[Lb]];Q.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabindex="0" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+Lb,Vb.a.vZ(ec.v9d),Vb.a.vZ(ec.altText)));Lb++;Lb%15&&Lb!==eb.length||Q.append("</tr>")}Q.append("</table>");return Q.toString()}OIl(){const Q=this.tYh();return wc.q(Q)}tYh(){const Q=Object.assign(new hn.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Q.MenuSectionList.push(this.R3j());H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&Q.MenuSectionList.push(this.U1j());return Q}U1j(){const Q=Object.assign(new Xm.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",
ControlsId:"ctrlMoreSymbols",ControlList:[]}),wa=Object.assign(new kh.a,{Id:"btnMoreSymbols",Command:jg.a.KLc.toString(),LabelText:Vb.a.If(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:Vb.a.If(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:H.AFrameworkApplication.mr,Image16by16Class:ud.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Q.ControlList.push(wa);return Q}R3j(){const Q=Object.assign(new Xm.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),
wa=Object.assign(new dd.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),eb=this.x9d.n2f.value,Lb=rj.a(eb),ec=Math.min(25,Lb.length);for(let Ad=0;Ad<ec;Ad++){var Tc=eb[Lb[Ad]];Tc=Object.assign(new vb.a,{Id:String.format("{0}{1}_{2}","symbol_",Ad,Tc.v9d),Character:Tc.v9d,Command:jg.a.Veb.toString(),QueryCommand:jg.a.I0d.toString(),Alt:Vb.a.If(Tc.altText)});wa.GalleryItems.push(Tc)}Q.ControlList.push(wa);
return Q}}Object(f.a)(ve,"SymbolsUiBuilder",null,[1787]);var ue=d(54),Bf=d(247),Se=d(648),Ae=d(389);class nh{constructor(){this.W=null}get name(){return"Box4.Symbols"}init(){H.AFrameworkApplication.K.$("InsertSymbolIsEnabled")&&this.W.resolve("Box4.Symbols.ISymbolsActor").Vb()}dispose(){}zc(Q){this.W=Q;this.W.register(Cd,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").singleInstance();this.W.ha("Box4.Symbols.SymbolsUiBuilder",()=>new ve(this.W.resolve("Box4.Symbols.ISymbolsLoader"))).as("Box4.Symbols.ISymbolsUIBuilder").singleInstance();
this.W.ha("Box4.Symbols.SymbolsActor",()=>new Pd(H.AFrameworkApplication.ya,new Se.a,new Ae.a,this.W.resolve("Box4.Symbols.ISymbolsUIBuilder"),Bf.a.instance,ue.a.instance,this.W.Za("Box4.IExternalSelectionManager"))).as("Box4.Symbols.ISymbolsActor").singleInstance()}static main(){ca.a.instance.Pc(new nh)}}Object(f.a)(nh,"Box4SymbolsPackage",null,[1,2]);var Dd=window.AccCheckerPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",
Width:"300",Overflow:"auto"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},Db=d(1572),$f=d(1534),Jh=d(1523),Ai=d(1821),kk=d(204),on=d(436);class Bi{constructor(){this.nFa=null}zc(Q){this.container=Q}init(){this.nFa=this.container.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager")}dispose(){this.nFa&&this.nFa.dispose()}}Object(f.a)(Bi,"ALiveBooksAccessibilityCheckPackageManager",null,[1,
2]);class oh{get yCk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get zCk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get ACk(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get HYm(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get oib(){return CommonUIStrings.l_AccCheckerPaneTitle}get i1m(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}Object(f.a)(oh,"AccessibilityCheckStringsProvider",null,[55]);
class ei{constructor(){this.iSi=this.contentId=null}}Object(f.a)(ei,"ResultIds",null,[]);class Qg{constructor(Q,wa){this._element=null;this.gg=wa;this.re=Q}get element(){this._element||(this._element=this.hHk(),this.Uy());return this._element}hYf(Q){this._element=Q}dispose(){this.element&&(this.J7(),this.hYf(null))}Uy(){this.gg&&this.re?(this.gg.mb(B.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.re.mb(B.a.Di,this.element,Object(a.a)(this,this.DF,"onKeyPress"))):ja.ULS.shipAssertTag(19789026,
334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}J7(){this.gg&&this.re&&(this.gg.sc(B.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.re.sc(B.a.Di,this.element,Object(a.a)(this,this.DF,"onKeyPress")))}onClick(){this.rWd();return!0}DF(Q){return this.wdm(Q.Ib.keyCode)?(this.rWd(),!0):!1}wdm(Q){return Q===pg.a.jce||Q===pg.a.Ks}}Object(f.a)(Qg,"AInteractivePaneElement",null,[134,10]);var pi=d(471),
Ci=d(51);class Qe extends Qg{constructor(Q,wa,eb){super(Q,wa);this.oze=eb}hide(){this.element.removeAttribute(uf.a.Ah);uf.a.Gq(this.element,uf.a.wz,uf.a.Ho);this.element.style.display="none"}show(){uf.a.Gq(this.element,uf.a.wz,uf.a.eL);uf.a.Gq(this.element,uf.a.Ah,uf.a.vQe);this.element.style.display="block"}hHk(){const Q=pi.b("div",this.Gsi,"AccCheckerNotification");uf.a.Gq(Q,uf.a.pch,uf.a.Ho);uf.a.Gq(Q,uf.a.dda,this.HCf);Q.tabIndex=0;const wa=pi.b("span",this.Fsi,"AccCheckerNotificationIcon");var eb=
ud.createClusteredImage(16,16,"Info_16x16x32","",!0,"");wa.appendChild(eb);eb=pi.b("span",this.HCf,"AccCheckerNotificationText");Ci.a.ey(eb,this.Hsi);Q.appendChild(wa);Q.appendChild(eb);return Q}rWd(){this.oze()}}Object(f.a)(Qe,"APopupNotification",Qg,[133,134,10]);class Bk extends Qe{constructor(Q,wa,eb,Lb){super(Q,wa,eb);this.rqa=Lb}get Gsi(){return"AccCheckerOutOfSyncNotificationId"}get Fsi(){return"AccCheckerOutOfSyncNotificationIconId"}get HCf(){return"AccCheckerOutOfSyncNotificationTextId"}get Hsi(){return this.rqa.HYm}}
Object(f.a)(Bk,"OutOfSyncNotification",Qe,[]);class cc extends Qe{constructor(Q,wa,eb,Lb){super(Q,wa,eb);this.rqa=Lb}get Gsi(){return"AccCheckerPartialResultNotificationId"}get Fsi(){return"AccCheckerPartialResultNotificationIconId"}get HCf(){return"AccCheckerPartialResultNotificationTextId"}get Hsi(){return this.rqa.i1m}}Object(f.a)(cc,"PartialResultNotification",Qe,[]);var cm=d(137),Uj=d(36),Fd=d(178);class he{constructor(Q,wa,eb,Lb=null,ec=null,Tc=null,Ad=null){this.WWg=this.UK=this.re=this.nFa=
null;this.EMa=Lb;this.gg=Q;this.Wb=wa;this.Mo=eb;this.rqa=Ad||new oh;this.bAe=ec||new Bk(this.EMa,this.gg,Object(a.a)(this,this.rUk,"dimissOutOfSyncNotification"),this.rqa);this.WAe=Tc||new cc(this.EMa,this.gg,Object(a.a)(this,this.sUk,"dimissPartialResultNotification"),this.rqa)}show(){}hide(){}get EMa(){return this.re||(this.re=H.AFrameworkApplication.ua.$y)}set EMa(Q){this.re=Q}Irh(){}pla(){}dispose(){}A3a(){}x6l(Q){var wa=this.WWg[Q];Q=wa.contentId;if((wa=wa.iSi+"")&&wa.length){const eb=[];Array.add(eb,
Object.assign(new Uj.a,{name:"RuleID",string:wa}));cm.a.sendTelemetryEvent(Object.assign(new Fd.a,{name:String.format("{0}.{1}",he.e3f,"ViolationSelected"),dataFields:eb}))}this.MIm(Q)}MIm(Q){Q&&this.nFa.DHn(Q)||(this.Wb.nK(ye.AFrame.P4g,!1),this.qUn())}rUk(){this.G_c(!1)}sUk(){this.X2i(!1)}qUn(){const Q=Object.assign(new Ec.StandardDialog(!0),{yt:H.AFrameworkApplication.A$,Ed:1,YDa:!1});Q.lU(1);Q.We(1,this.rqa.yCk);Q.We(0,CommonUIStrings.l_DialogCancel);Q.nU(this.rqa.ACk,this.rqa.zCk,wa=>{1===wa&&
this.xnf()})}flk(Q){let wa=null;if(Q.Results&&0<Q.Results.length){wa={};let eb=0;for(const Lb of Q.Results)Lb.ResultId=he.kZj+ ++eb,Q=new ei,Q.contentId=Lb.ContentId,Q.iSi=Lb.RuleId,wa[Lb.ResultId]=Q}return wa}rzm(){cm.a.addNamespaceMapping(he.e3f,he.T4n);cm.a.sendTelemetryEvent(Object.assign(new Fd.a,{name:String.format("{0}.{1}",he.e3f,"ShowTaskpane")}))}}he.kZj="AccCheckResult";he.e3f="Office.UX.AccChecker";he.T4n="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(f.a)(he,
"BaseAccessibilityCheckPane",null,[57,10]);class hi{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(f.a)(hi,"AccCheckerTaskPaneProps",null,[]);var qi=d(1363),ad=d(1377),Vj=d(1006),bj=d(190);class Uc extends he{constructor(Q,wa,eb,Lb,ec=null,Tc=null,Ad,we=null,Rd=null){super(wa,
eb,Lb,Tc,void 0,void 0,we);this.nsg=null;this.GVg=this.VAe=this.Fgd=this.Xjd=this.ujd=!1;this.oKe=null;this.gIe=!!H.AFrameworkApplication.ua&&!!H.AFrameworkApplication.ua.Sb&&H.AFrameworkApplication.ua.Sb.Csf;this.Zmc=this.R3=null;this.Nnc=0;this.Lad=null;this.RX=ec;Rd&&(this.R3=Rd.cpd,this.Zmc=Rd.mBo,this.Nnc=Rd.sCo);this.fA=new ad.a}get isVisible(){return this.GVg}iPa(Q){this.GVg=Q}n3e(Q){Q&&(this.nsg=Q,Q.IsSuccess&&(this.WWg=this.flk(Q),Q.IsPartialResult&&this.X2i(!0)),this.ujd=!0,this.Xjd=!1,
this.Vn())}G_c(Q){this.isVisible&&Q!==this.Fgd&&(this.Fgd=Q,this.Vn())}X2i(Q){this.VAe=Q;this.Vn()}mO(){this.Xjd||bj.UISurfaces.Xt().then(Q=>{fa.a.instance.yy(Uc.Fmb+":PaneOpen:Start");Q.showTaskPane(Uc.Fmb,this.nB());this.xnf();return null});this.isVisible?bj.UISurfaces.Xt().then(Q=>{Q.setSelectedTaskPane(Uc.Fmb);return null}):this.rzm()}Vn(){bj.UISurfaces.Xt().then(Q=>{Q.updateTaskPane(Uc.Fmb,this.nB());return null})}nB(){var Q=new hi;this.fA.fJb(Q);Q=Object.assign(new Vj.a,{title:this.rqa.oib,
hideHeader:!1,width:320,location:2,contentProps:Q,onOpen:()=>{this.k7();this.iPa(!0);H.AFrameworkApplication.ua.updateCommandUI()},onClose:()=>{this.Saa();this.iPa(!1);this.Xjd=this.ujd=!1;this.Vn();H.AFrameworkApplication.ua.updateCommandUI()},isModernPane:!0});this.gIe&&(Q.enableResize=!0,Q.minResizeWidth=268,Q.maxResizeWidth=920);return Q}initialize(Q){const wa=this.Wb.pe(Uc.Fmb);wa.parent=ye.AFrame.Lp;wa.LL=!0;this.nFa=Q;this.i_j()}dispose(){this.A3a();this.bAe&&(this.bAe.dispose(),this.bAe=null);
this.WAe&&(this.WAe.dispose(),this.WAe=null);super.dispose()}i_j(){this.fA.oK(this.onRecheckExecute());this.fA.oK(this.kel());this.fA.oK(this.DEl());this.fA.oK(this.onInvokeNavigateExecute());this.fA.oK(this.rsl());this.fA.oK(this.Qzl());this.fA.oK(this.JBl());this.fA.oK(this.updateLastScanTime());this.fA.oK(this.showHelpPane())}onRecheckExecute(){return Q=>{Q.onRecheckExecute=()=>{this.xnf()}}}kel(){return Q=>{Q.accessibilityCheckResultCollection=this.nsg}}DEl(){return Q=>{Q.resultsReady=this.ujd}}onInvokeNavigateExecute(){return Q=>
{Q.onInvokeNavigateExecute=wa=>{this.x6l(wa)}}}rsl(){return Q=>{Q.helpLink=this.a4k}}Qzl(){return Q=>{Q.outOfSync=this.Fgd}}JBl(){return Q=>{Q.partialResult=this.VAe}}updateLastScanTime(){return Q=>{Q.updateLastScanTime=wa=>{this.oKe=wa}}}showHelpPane(){return Q=>{Q.showHelpPane=()=>{H.AFrameworkApplication.K&&H.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?H.AFrameworkApplication.LJ||this.ach()?this.Lad?this.Lad():this.R3.value&&this.Zmc&&
this.Nnc&&this.R3.value.Xb(this.Nnc,2,this.Zmc):this.V3i():this.ach()?this.Lad?this.Lad():this.R3.value&&this.Zmc&&this.Nnc&&this.R3.value.Xb(this.Nnc,2,this.Zmc):this.V3i()}}}ach(){return!this.RX||!this.RX.value}V3i(){const Q=this.RX.value;if(Q){var wa={};wa.query=Uc.cQj+Uc.FEj;wa=Object.assign(new qi.a,{jX:wa});Q.Yaa(Uc.oqe,wa)}}xnf(){this.VAe=this.Fgd=this.ujd=!1;this.oKe&&this.oKe();this.Vn();this.Xjd=!0;this.nFa.dOm()}k7(){this.Wb.Jg(Uc.Fmb)}Saa(){this.c_a()&&this.Wb.Jg(this.Wb.AS)}c_a(){return!!this.Wb.xg&&
this.Wb.xg.name===Uc.Fmb}}Uc.Fmb="AccessibilityCheckerPane";Uc.FEj="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";Uc.oqe="FA000000012";Uc.cQj="AssetID=";Object(f.a)(Uc,"ReactAccessibilityCheckPane",he,[]);class Jf extends Uc{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we,Rd=null){super(Q,wa,eb,Lb,ec,Tc,void 0,Rd);this.dBj=we;this.fP=Ad}get a4k(){return this.dBj}mO(){this.fP.PJa();super.mO()}}Object(f.a)(Jf,"ReactLiveBooksAccessibilityCheckPane",Uc,[]);var ui=d(1110),zn=d(133),jn=d(180),Yp=d(76),Ji=d(158),ic=d(517),Ve;
(function(Q){Q[Q.error=0]="error";Q[Q.warning=1]="warning";Q[Q.tip=2]="tip";Q[Q.intelligentService=3]="intelligentService"})(Ve||(Ve={}));Object(f.b)("AccessibilityRuleCategory",Ve);class Qi{constructor(Q,wa,eb=null){this.hfe=null;this.LJg=this.wIg=!1;this.MIa=Q;this.p5c=wa;this.ga=eb;this.Ac.pa(Na.a.Cwk,Aa.a.frame,Object(a.a)(this,this.eWe,"closePane"))}get Ac(){return this.ga||(this.ga=H.AFrameworkApplication.ya)}set Ac(Q){this.ga=Q}p0k(){this.wIg||(this.MIa.initialize(this),this.p5c.initialize(this),
this.wIg=!0)}dOm(){w.b(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.p5c.uyn()}mO(Q,wa,eb){if(1===eb)return af.SessionStatusManager.instance.Qj?8:32;this.MIa.isVisible||this.p0k();this.QVn();return 32}eWe(Q,wa,eb){1!==eb&&this.MIa.pla();return 32}JGf(){this.MIa.G_c(!0)}n3e(Q){if(Q){if(Q.AccessibilityRules&&Object.keys(Q.AccessibilityRules).length){const eb=Q.AccessibilityRules;for(let Lb in eb){var wa=Lb;const ec=eb[Lb].RuleId+"";wa!==ec&&w.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",
wa,ec)}this.hfe=eb}else!this.hfe&&Q.Results&&0<Q.Results.length?(w.b(18993251,200,15,"No accessibility rule definitions available"),Q.IsSuccess=!1):Q.AccessibilityRules=this.hfe;Q.IsSuccess||w.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.Lnn(Q);this.bzm(Q);this.MIa.n3e(Q)}}Lnn(Q){const wa=Q.AccessibilityRules;if(Q=Q.Results)for(let eb=Q.length-1;0<=eb;eb--){const Lb=Q[eb];let ec="";const Tc=Lb.RuleId;Lb.ContentName||(ec+="Result does not have content name. ");Tc in wa||(ec+=String.format("No accessibility check rule exists for ID {0}.",
Tc));0<ec.length&&(w.b(36214999,200,15,"Omitting invalid accessibility check result: "+ec),Array.removeAt(Q,eb))}}MFl(){return H.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):ea.a.instance.resolve("Common.IDynamicScriptLoaderProvider").tE.loadScript("accessibility-checker-pane-strings")}QVn(){this.LJg?this.MIa.mO():this.MFl().then(()=>{this.LJg=!0;this.MIa.mO()}).catch(Q=>ja.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",
Q))}bzm(Q){var wa={};const eb={};var Lb=Q.Results,ec=[];Array.add(ec,Object.assign(new Uj.a,{name:"FinalViolationCount",int64:0}));Array.add(ec,Object.assign(new Uj.a,{name:"FinalErrorCount",string:"0"}));Array.add(ec,Object.assign(new Uj.a,{name:"FinalWarningCount",string:"0"}));Array.add(ec,Object.assign(new Uj.a,{name:"FinalTipCount",string:"0"}));Array.add(ec,Object.assign(new Uj.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Lb){for(const we of Lb)if(Q.AccessibilityRules){var Tc=Q.AccessibilityRules[we.RuleId];
if(Tc){if(wa[Ve[Tc.Category]]){let Rd=wa[Ve[Tc.Category]];wa[Ve[Tc.Category]]=++Rd}else wa[Ve[Tc.Category]]=1;eb[we.RuleId]?(Tc=eb[we.RuleId],eb[we.RuleId]=++Tc):eb[we.RuleId]=1}}ec[0].int64=Lb.length;for(var Ad in wa)switch(Q=wa[Ad],Lb=Ad,Lb="Final"+Lb.charAt(0).toUpperCase()+Lb.substring(1,Lb.length)+"Count",Lb){case "FinalErrorCount":ec[1].string=Q.toString();break;case "FinalWarningCount":ec[2].string=Q.toString();break;case "FinalTipCount":ec[3].string=Q.toString();break;case "FinalIntelligentServiceCount":ec[4].string=
Q.toString()}}cm.a.sendTelemetryEvent(Object.assign(new Fd.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:ec}));for(let we in eb)wa=we,ec=eb[we],Ad=[],Array.add(Ad,Object.assign(new Uj.a,{name:"RuleID",string:wa})),Array.add(Ad,Object.assign(new Uj.a,{name:"FinalViolationCount",string:ec.toString()})),cm.a.sendTelemetryEvent(Object.assign(new Fd.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Ad}))}dispose(){this.MIa&&
this.MIa.dispose();this.p5c&&this.p5c.dispose()}}Object(f.a)(Qi,"AAccessibilityCheckManager",null,[54,10]);var wl=d(332);class Of extends Qi{constructor(Q,wa,eb){super(wa,eb,Q);this.graph=null}ZGi(Q,wa,eb,Lb,ec){if(1===eb)return 32;ec[wl.a.On]=this.MIa.isVisible;return 32}skn(){for(const Q of this.tsi){const wa=this.graph.Te(Q);wa.jp(Object(a.a)(this,this.Vh,"onPropertyChanged"));wa.rs(Object(a.a)(this,this.bO,"onConnected"));wa.xv(Object(a.a)(this,this.DSc,"onDisconnected"))}}Pco(){for(const Q of this.tsi){const wa=
this.graph.Te(Q);wa.wX(Object(a.a)(this,this.Vh,"onPropertyChanged"));wa.dM(Object(a.a)(this,this.bO,"onConnected"));wa.Iaa(Object(a.a)(this,this.DSc,"onDisconnected"))}}dispose(){super.dispose();this.Pco()}Vh(){this.JGf()}bO(){this.JGf()}DSc(){this.JGf()}}Object(f.a)(Of,"ALiveBooksAccessibilityCheckManager",Qi,[]);class jl extends Of{constructor(Q,wa,eb,Lb,ec,Tc){super(Q,wa,eb);this.Ac.pa(Na.a.GZf,Aa.a.frame,Object(a.a)(this,this.mO,"showPane"));this.Ac.gb(Na.a.cbn,Aa.a.frame,Object(a.a)(this,this.ZGi,
"queryToggleAccCheckerPane"),96);this.graph=ec;this.tLj=Lb;this.OHj=Tc;this.skn()}get tsi(){return[12,14,22,19,30,43,44]}DHn(Q){if(this.OHj)return ja.ULS.sendTraceTag(20713608,334,15,"ODT file. Disable content navigation."),!0;ja.ULS.shipAssertTag(20272215,334,!!Q);return this.tLj.HIm(Q)}}Object(f.a)(jl,"WordAccessibilityCheckManager",Of,[]);var Ll=d(93),Zp=d(33),Ym=d(139),pn=d(21),vm=d(183),Lk=d(5),mf=d(18),ie=d(492);class Th{constructor(Q,wa,eb,Lb,ec,Tc,Ad){this.Fo=null;this.lxb=0;this.Xc=wa;this.aB=
eb;this.hb=Lb;this.ga=ec;this.Yc=Tc;this.mt=Q;this.qd=Ad}get TQ(){if(!this.Fo){const Q=this.Xc.pg(this.mt.Zc);this.aB.z5f(Q);if(Q.Bb(7)||Q.kd(7))this.Fo=Ll.a.Ir(Q,Q.origin)}return this.Fo}HIm(Q){if(!Q||!Q.Cg||0>=Q.Cg.length)return ja.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),!1;var wa=Array(Q.Cg.length);let eb=7,Lb=null;for(let Tc=0;Tc<Q.Cg.length;Tc++)if(Lb=this.L7k(Q.Cg[Tc])){if(7===eb)eb=this.lxb;else if(eb!==this.lxb)return ja.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),
!1;var ec=this.qd.NNa(Lb.characterData,Lb.qa);const Ad=Q.cpBegin?this.qd.Owb(ec,Q.cpBegin):-1;ec=Q.cpEnd?this.qd.Owb(ec,Q.cpEnd):-1;if(-1>Ad||-1>ec)return ja.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),!1;wa[Tc]=Zp.a.jL(Ad,ec,!1,Lb);switch(Q.contentType){case 5:if(!Ym.HyperlinkReader.o2h(wa[Tc],!1))return!1;break;case 6:if(!pn.ImageReader.I$(wa[Tc]))return!1;break;case 7:wa[Tc]=Zp.a.jL(-1,-1,!1,Lb)}}else return!1;wa=new vm.Selection(wa,!1);return this.sMn(Lb,
wa,Q.contentType)}L7k(Q){if(this.TQ)for(this.TQ.reset(),this.lxb=7;this.TQ.moveNext();){var wa=this.TQ.currentNode.type;if(38===wa||36===wa||23===wa)this.lxb=wa;else if(12===wa){wa=this.TQ.currentNode;const eb=wa.ia(Lk.a.Mc,0);if(Q===eb)return wa}}return null}k2f(Q){this.ga.processAction(mf.a.ES,2);this.ga.processAction(mf.a.L9,2);let wa=2;switch(this.lxb){case 23:wa=32;break;case 38:wa=this.ga.Xb(mf.a.aib,2,new ie.a(Q));break;case 36:wa=this.ga.Xb(mf.a.zgb,2,new ie.a(Q));break;default:ja.ULS.shipAssertTag(20272220,
334,!1,"Unexpected search scope encountered: {0}",this.lxb)}if(32===wa)return!0;ja.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",this.lxb);return!1}sMn(Q,wa,eb){if(this.k2f(Q)){Q=this.mt.uv;const Lb=this.hb.ib.kb;Lb&&Lb.equals(wa)&&this.Yc.Ina(Q,null);this.Yc.Ina(Q,wa);switch(eb){case 0:case 1:this.ga.processAction(jg.a.GIb,2);break;case 2:this.ga.processAction(jg.a.GYc,2);break;case 3:this.ga.processAction(jg.a.dva,2)}return!0}return!1}}Object(f.a)(Th,"WordAccessibilityCheckNavigateManager",
null,[1966]);class An{constructor(Q){this.nFa=null;this.uEg=Q}get fileId(){return this.uEg?this.uEg():null}initialize(Q){this.nFa=Q}Fui(Q){this.nFa.n3e(Q)}}Object(f.a)(An,"AAccessibilityCheckService",null,[56,10]);class ri{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(Q){Q=Sys.Serialization.JavaScriptSerializer.deserialize(Q);const wa=Q.AccessibilityRules,eb={};if(wa)for(let Lb=0;Lb<wa.length;++Lb){const ec=wa[Lb];eb[ec.Key]=
ec.Value}Q.AccessibilityRules=eb;return Q}}Object(f.a)(ri,"AccessibilityCheckResultCollection",null,[]);class kl extends An{constructor(Q){super(Q)}onFailure(Q,wa){ja.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",wa);Q=Object.assign(new ri,{IsSuccess:!1});this.Fui(Q)}onSuccess(Q){Q=kl.BEl(Q);let wa=null;if(Q)try{wa=this.PRk(Q)}catch(eb){ja.ULS.shipAssertTag(20730843,334,!1,"AccChecker response data is invalid. [{0}]",eb.message),wa=Object.assign(new ri,{IsSuccess:!1})}else ja.ULS.shipAssertTag(20730844,
334,!1,"AccChecker response is NULL."),wa=Object.assign(new ri,{IsSuccess:!1});this.Fui(wa)}dispose(){}static BEl(Q){let wa=null;Q&&Q.hk&&(wa=Q.hk[0]);return wa?wa.Body:null}}Object(f.a)(kl,"ALiveBooksAccessibilityCheckService",An,[]);var ek=d(1044),Fm=d(245);class fo extends Fm.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1}Wl(){return 56}static construct(Q,wa){const eb=new fo;eb.FileId=Q;eb.IsCoauthorable=wa;return eb}}Object(f.a)(fo,"WordAccessibilityCheckRequest",Fm.a,[]);class tg{}
Object(f.a)(tg,"AccessibilityCheckRule",null,[]);var Wk=d(149);class Tn{static parse(Q){switch(Vb.a.mh(Q)){case "warnings":return 1;case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw Q=String.format("Invalid Accessibility result category: {0}",Q),Wk.a.argument(Q);}}}Object(f.a)(Tn,"AccessibilityRuleCategoryParser",null,[]);class Un{constructor(){this.Category=this.Text=this.Id=null}static L6n(Q){const wa=new tg;wa.RuleId=Q.Id;wa.RuleName=Q.Text;wa.Category=
Tn.parse(Q.Category);return wa}}Object(f.a)(Un,"WordAccessibilityCheckRule",null,[]);class Xk{}Object(f.a)(Xk,"AccessibilityCheckResult",null,[]);class Yk{constructor(){this.cpEnd=this.cpBegin=this.Cg=null;this.contentType=0}}Object(f.a)(Yk,"WordAccessibilityCheckContentId",null,[]);const Gm=Q=>{switch(Vb.a.mh(Q)){case "tableheading":return 0;case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;
case "anchoredepicture":return 7;default:return 8}};var Gl=d(1546);class go{constructor(){this.OE=this.OS=this.ContentType=this.Label=this.RuleId=this.ParaId=null}static J6n(Q){const wa=new Xk;wa.RuleId=Q.RuleId;wa.ContentName=Q.Label;const eb=new Yk;eb.Cg=Q.ParaId;eb.cpBegin=Gl.b(Q.OS);eb.cpEnd=Gl.b(Q.OE);eb.contentType=Gm(Q.ContentType);wa.ContentId=eb;return wa}}Object(f.a)(go,"WordAccessibilityViolation",null,[]);class Dq{constructor(){this.Violations=this.Rules=null}static K6n(Q){const wa=new ri;
try{var eb={};if(Q.Rules){for(let Lb=0;Lb<Q.Rules.length;++Lb){const ec=Un.L6n(Q.Rules[Lb]);eb[ec.RuleId]=ec}wa.AccessibilityRules=eb}if(Q.Violations){const Lb=Array(Q.Violations.length);for(eb=0;eb<Q.Violations.length;++eb)Lb[eb]=go.J6n(Q.Violations[eb]);wa.Results=Lb}wa.IsPartialResult=!1;wa.IsSuccess=!0}catch(Lb){ja.ULS.shipAssertTag(20272214,334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",Lb.message),wa.IsSuccess=!1}return wa}}Object(f.a)(Dq,
"WordAccessibilityCheckResult",null,[]);class Yo extends kl{constructor(Q,wa,eb){super(Q);this.TPb=wa;this.Wpb=eb}uyn(){const Q=Object.assign(new ek.a,{Vr:fo.construct(this.fileId,this.Wpb),status:1,WG:"AccessibilityCheck"});this.TPb(12,!1,Object(a.a)(this,this.onSuccess,"onSuccess"),Object(a.a)(this,this.onFailure,"onFailure"),Q,null,Q)}PRk(Q){Q=Pa.b(Q);return Dq.K6n(Q)}}Object(f.a)(Yo,"WordAccessibilityCheckService",kl,[]);class Ml extends Bi{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}zc(Q){super.zc(Q);
Q.ha("Common.App.AccessibilityChecker.IAccessibilityCheckPane",()=>new Jf(H.AFrameworkApplication.ya,kk.a.instance,ai.FocusManager.instance(),on.a.instance,Q.Ye("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),Wd.KeyInputManager.instance,ui.a.instance,H.AFrameworkApplication.K.lb("AccessibilityCheckerHelpUrl"))).singleInstance();Q.ha("Common.App.AccessibilityChecker.IAccessibilityCheckService",()=>new Yo(()=>H.AFrameworkApplication.rootQuerySignature,ic.a.HP,zn.PageReader.instance.lFd(qe.App.xa.jb.Zc))).singleInstance();
Q.ha("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager",()=>new Th(qe.App.xa.jb,Q.resolve("Box4.Graph.IGraphIteratorFactory"),jn.PageNavigator.instance,Q.resolve("Box4.ISelectionManager"),H.AFrameworkApplication.ya,Yp.InteractiveViewManager.instance,Q.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).singleInstance();Q.ha("Common.App.AccessibilityChecker.IAccessibilityCheckManager",()=>new jl(H.AFrameworkApplication.ya,Q.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),
Q.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),Q.resolve("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager"),qe.App.Wj.al,Ji.App.LNc)).singleInstance()}init(){Ji.App.Gce&&this.container.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{Bi.prototype.init.call(this)})}}Object(f.a)(Ml,"WordAccCheckerPackageManager",Bi,[]);class Mj{constructor(Q,wa){this.B0g=!1;this.G9n=()=>{this.F9n()};this.Yj=Q;this.bS=wa}Mhb(Q){Q.IW.F7j(this.G9n)}F9n(){!this.B0g&&this.Yj&&
(this.Yj.hCa?this.bS?this.bS.execute(Q=>{Q.logActivity("WordWebToWebActiveCoauth","WebToWebActiveCoauthFloodgateSurveyIsEnabled")}):ja.ULS.sendTraceTag(51389134,304,10,"Future ISystemInitiatedFeedback not available"):this.B0g=!0)}}Object(f.a)(Mj,"CoauthSurveyManager",null,[1785]);class ll{constructor(){this.mt=this.W=null}get name(){return"WordEditor.CoauthSurveys"}init(){qe.App.xa&&(this.mt=qe.App.xa.jb)&&(this.mt.fta?this.Dga():this.mt.Zca(()=>{this.Dga()}))}Dga(){var Q=this.mt.Zc;Q&&(Q=Q.contentReplicator)&&
this.W.resolve("WordEditor.CoauthSurveys.CoauthSurveyManager").Mhb(Q)}dispose(){}zc(Q){this.W=Q;Q.ha("WordEditor.CoauthSurveys.CoauthSurveyManager",()=>new Mj(Q.resolve("WordEditor.IWordEditorCoauthManager"),Q.Za("Common.ISystemInitiatedFeedback"))).as("WordEditor.CoauthSurveys.ICoauthSurveyManager").singleInstance()}static main(){H.AFrameworkApplication.K.$("CoauthSurveysPackageIsEnabled")&&ca.a.instance.Pc(new ll)}}Object(f.a)(ll,"WordEditorCoauthSurveyManagerPackage",null,[1,2]);var qo;(function(Q){Q[Q.graphSpaceReplicatorNotSendingContent=
0]="graphSpaceReplicatorNotSendingContent";Q[Q.inboundRequestTakesTooLongToSendAfterRTC=1]="inboundRequestTakesTooLongToSendAfterRTC";Q[Q.docxSaveMonitorKickoutElapsed=2]="docxSaveMonitorKickoutElapsed"})(qo||(qo={}));Object(f.b)("ComponentLoggingScenario",qo);var wm=d(1418);class Vn{flush(Q,wa){const eb=this.Cnl(Q);eb.LoggingScenario=qo[wa];rj.a(eb).length?ja.ULS.sendTraceTag(594571986,3013,15,"{0}",eb):ja.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",
wm.a[Q.PVa])}Cnl(Q){const wa={};if(!Q)return wa;const eb=new Vc.a;for(eb.enqueue(Q);!eb.isEmpty;){Q=eb.dequeue();const Lb=wm.a[Q.PVa];try{wa[Lb]=Q.dI()}catch(ec){ja.ULS.sendTraceTag(594571985,3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",Lb.toString(),{["Kind"]:"Exception",["Stack"]:ec.stack,["Message"]:ec.message,["FileName"]:ec.fileName,["LineNumber"]:ec.lineNumber})}if((Q=Q.Wud)&&Q.length)for(let ec of Q)!ec||wm.a[ec.PVa]in wa||eb.enqueue(ec)}return wa}}
Object(f.a)(Vn,"ComponentStateLogManager",null,[1784]);class Hm{flush(){}}Object(f.a)(Hm,"NoOpComponentStateLogManager",null,[1784]);class Sm{constructor(){this.W=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.W.resolve("Common.IComponentStateLogManager")}dispose(){}zc(Q){this.W=Q;H.AFrameworkApplication.K.$("ComponentStateLoggingPackageIsEnabled")?Q.ha("WordEditor.ComponentStateLogging.ComponentStateLogManager",()=>new Vn).as("Common.IComponentStateLogManager").singleInstance():
Q.ha("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new Hm).as("Common.IComponentStateLogManager").singleInstance()}static main(){ca.a.instance.Pc(new Sm)}}Object(f.a)(Sm,"WordEditorComponentStateLoggingPackage",null,[1,2]);var ho=d(1900);class Hj{constructor(Q,wa,eb){this.hg=Q;this.lld=wa;this.EVg=eb}Lj(Q,wa,eb,Lb,ec,Tc,Ad,we,Rd,yf=null,rg=!1,vi=null,Rk=null,Ij=null,Sl=null,hk=!1){return this.EVg?this.lld.Lj(Q,wa,eb,Lb,ec,Tc,Ad,we,Rd,yf,rg,Rk,Ij):this.hg.Lj(Q,wa,eb,Lb,ec,Tc,
Ad,we,Rd,yf,rg,vi,Rk,Ij,Sl,hk)}S2b(Q){return this.EVg?this.lld.S2b():this.hg.S2b(Q)}}Object(f.a)(Hj,"ClientRequestAdapter",null,[903]);var xm=d(181),zp=d(263),cj=d(267),Xh=d(1372),$k=d(285),nl=d(1385),Qf=d(1901),Hl=d(53),Im=d(714),ff=d(590),Bj=d(125),Vf=d(674),Ri=d(476),dj;(function(Q){Q[Q.none=0]="none";Q[Q.getCells=1]="getCells";Q[Q.hotStoreStatus=2]="hotStoreStatus";Q[Q.saveMonitor=3]="saveMonitor";Q[Q.saveMonitor_LineageTombstone=4]="saveMonitor_LineageTombstone";Q[Q.kickoutExecutor=5]="kickoutExecutor"})(dj||
(dj={}));Object(f.b)("MostRecentRevisionIdOrigin",dj);class Zo extends Sys.EventArgs{constructor(Q,wa,eb,Lb){super();this.T7b=Q;this.AXm=wa;this.httpStatusCode=eb;this.gD=Lb}}Object(f.a)(Zo,"UpdatedLastRevisionSaveIdEventArgs",Sys.EventArgs,[]);class Vg{constructor(){this.Y4=0}get isEmpty(){return!this.Y4}Fxc(Q){this.Y4|=Q}jOc(Q){return!!(this.Y4&Q)}clear(){this.Y4=0}Bzc(){return!1}}Object(f.a)(Vg,"DocxSaveMonitorRetryAttemptOnce",null,[]);class Jm{constructor(Q,wa=3){this.Y4=0;this.xjd=new Map;this.HKj=
Q;this.tRj=wa}get isEmpty(){return!this.Y4}Fxc(Q){this.Y4|=Q;let wa=this.xjd.get(Q)||0;this.xjd.set(Q,++wa)}jOc(Q){return!!(this.Y4&Q)}clear(){this.Y4=0;this.xjd.clear()}Bzc(Q){return this.tRj&Q?(this.xjd.get(Q)||0)<this.HKj:!1}}Object(f.a)(Jm,"DocxSaveMonitorRetryAttemptMany",null,[]);class ro{static create(Q=!1,wa=3,eb=0){return Q?new Jm(wa,eb):new Vg}}Object(f.a)(ro,"DocxSaveMonitorRetryAttemptFactory",null,[]);var $o=d(1644),so;(function(Q){Q[Q.EEo=-1]="noResultYet";Q[Q.EJo=0]="upToDate";Q[Q.qHo=
1]="sessionLost";Q[Q.KJo=2]="userSignedOut";Q[Q.cGo=3]="previousRequestPending";Q[Q.b3d=4]="requestFailed";Q[Q.LHo=5]="shuttingDown";Q[Q.JEo=6]="nullResponseData";Q[Q.VCo=7]="invalidResponseData";Q[Q.gBo=8]="failedRevisionLookup";Q[Q.WGo=9]="savedWithinThreshold";Q[Q.GEo=10]="notSavedWarning";Q[Q.lDo=11]="kickoutThreshold";Q[Q.pJo=12]="unknownRevision";Q[Q.pzo=13]="contentNotYetLoaded";Q[Q.sessionExpired=14]="sessionExpired";Q[Q.canaryError=15]="canaryError";Q[Q.timeout=16]="timeout";Q[Q.mDo=17]=
"kickoutThreshold_Offline";Q[Q.rAo=18]="dssSessionDeleted";Q[Q.sAo=19]="dssSessionExpired";Q[Q.RJo=20]="waitingForSessionTokenRefresh";Q[Q.tAo=21]="dssSessionNotFound"})(so||(so={}));Object(f.b)("SaveMonitorResult",so);class Lg{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we,Rd,yf,rg,vi,Rk,Ij,Sl,hk,Yl,Sj,eg,yq,bs,$i,xk,cs,Zl,jt=null,Pp,Ss){this.irc=0;this.YQb=!1;this.Stc=null;this.Opc=this.WM=-1;this.RBe=null;this.Ohd=0;this.Phd=!1;this.orb=null;this.Prc=0;this.HEe=this.I1g=null;this.mR=this.JMg=this.qme=0;this.bwe=
null;this.OJg=!1;this.In=null;this.mld=0;this.Qmd=void 0;this.MZg=!1;this.R8k=()=>{var hg;ja.ULS.sendTraceTag(524871194,Lg.Pn,50,"DocxSaveMonitor tick: {0}",{["IsUpToDate"]:this.$W,["AppVisibilityState"]:Xh.a[null===(hg=this.In)||void 0===hg?void 0:hg.PD]});hg=this.xqb;this.xqb=this.my();if(this.MO())this.mz.event(5),this.stop("session has shut down");else{this.d7a===Lg.VQi&&this.REa(this.Gmc);var Mh=this.ync();if(Mh)if(this.pue()&&H.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IWacWordDocxSaveMonitorWaitForTokenRefreshSettings"),
this.$W)this.mz.event(0);else if(this.bRb())this.mz.event(1),this.stop("session is lost"),H.AFrameworkApplication.Hf("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),this.OJg&&!this.xdm()&&(ja.ULS.sendTraceTag(554726995,Lg.Pn,10,"DocxSaveMonitor: Session lost but not kicked out"),this.Uw(Hl.a.Ozh));else if(this.pue())20!==this.mz.currentState?(this.mz.event(20),this.I1g=this.my(),ja.ULS.sendTraceTag(593510691,Lg.Pn,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",
this.K1g)):this.my().getTime()-this.I1g.getTime()>this.K1g&&(this.mz.event(14),this.stop("Waited too long for session token to be refreshed"),this.Uw(Hl.a.Wyd));else if(this.KIj())if(this.xqb=hg,this.YQb)this.mz.event(3),this.my().getTime()-this.Stc.getTime()>this.mve&&(hg=this.Xie.S2b(this.WM),ja.ULS.sendTraceTag(19161610,205,50,"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.WM,Kg.a[hg]),this.ijd&&this.ijd.log(),this.stop("stuck on previousRequestPending"),this.Uw());
else if(hg=ff.b($o.a.construct(Mh)),this.YQb=!0,this.Stc=this.dRj(),this.WM=this.Xie.Lj(Lg.serviceUrl,2,hg,{"Content-Type":"application/json; charset=utf-8"},!1,0,this.dtk,this.ctk,null,void 0,void 0,this.gQj,this.mFe,void 0,void 0,!0),0>=this.WM)this.YQb=!1,ja.ULS.sendTraceTag(19161611,205,50,"DocxSaveMonitorKickout: Request {0} was not added to the queue.",this.WM.toString());else{hg=this.Xie.S2b(this.WM);Mh=100;if(hg&&1!==hg||this.mHg)Mh=50;ja.ULS.sendTraceTag(19161612,Lg.Pn,Mh,"DocxSaveMonitor: Sending Request {0}",
{["Id"]:this.WM,["Status"]:Kg.a[hg]});this.ijd&&this.ijd.start(this.WM)}else this.mz.event(2);else this.mz.event(13)}};this.ctk=hg=>{this.mR=this.evd+1;let Mh=this.YQb=!1,Kf=!1;hg=hg.data;ua.a.wl&&H.AFrameworkApplication.F6("MultipleRetriesForDocxSaveMonitor_t;MultipleRetriesForDocxSaveMonitor_c");hg?(ja.ULS.sendTraceTag(22552773,Lg.Pn,15,"Request failed {0}",{["Status"]:hg.status,["HttpStatus"]:hg.mf,["Correlation"]:hg.qj?hg.qj[$k.a.I5]:"",["Id"]:hg.id,["ConsecutiveErrors"]:this.evd,["Request.InvokedTime"]:hg.TG,
["Request.EnqueueTime"]:hg.jKa,["Request.CompletedTime"]:hg.uS}),Kf=7===hg.status||13===hg.status,this.Bzc(2)&&Kf?(this.fRa.Fxc(2),Mh=!0,this.Opc=hg.mf,this.mz.event(16)):this.Bzc(1)&&5===hg.status?(this.fRa.Fxc(1),Mh=!0,this.Opc=hg.mf,this.mz.event(15)):(this.mz.event(4),this.Opc=hg.mf)):(this.mz.event(4),ja.ULS.sendTraceTag(23425240,Lg.Pn,15,"RequestFailed and event data is null"));if(!Mh&&(this.fRa.clear(),Kf?this.Ntf(17,Hl.a.MXk,"while offline"):this.Ntf(11,Hl.a.M3e,"while online")))return;this.REa(Mh?
this.Ogl(Kf):this.Gmc)};this.dtk=hg=>{this.mR=this.evd+1;this.YQb=!1;var Mh={};this.fRa.clear();if(hg=hg.data){var Kf=hg.qj?hg.qj[$k.a.I5]:"";Mh.HttpStatus=hg.mf;Mh.Correlation=Kf;Mh.Id=hg.id;ja.ULS.sendTraceTag(23425242,Lg.Pn,this.mHg?50:100,"Request succeeded at the HTTP level {0}",Mh);this.Opc=hg.mf}else ja.ULS.sendTraceTag(23425241,Lg.Pn,15,"Request succeeded with null response data");if(this.MO()||!this.Xyd)this.mz.event(5),this.stop("session has shut down");else if(!this.xim())if(hg&&hg.Ee)if(hg=
this.Pra(hg.Ee))if(this.t8.Ulb(hg),hg.StatusCode)this.Otf(hg,Mh)||this.mz.event(8,Mh);else{this.mR=0;this.xqb=this.my();this.LDe.clear();Mh={["LastSavedRevisionId"]:hg.LastSavedRevisionId,["LastSavedRevisionSequenceNumber"]:hg.RevisionSequenceNumber};hg=Bj.b(hg.LastSavedRevisionId);this.rdc(hg,3);var zq=this.obf().store.getRevision(hg);if(zq){hg=null;Kf=this.adb();zq=(zq=zq.Wcb(Kf))?zq.id:tf.a.nil;let Ep=Kf;for(;Ep&&!Ep.id.equals(zq);)hg=Ep,Ep=Ep.hl;this.iSl(hg,Mh,Kf)||this.mz.event(9)}else this.VQl()||
this.mz.event(12,Mh);this.REa(this.Cvc)&&ja.ULS.sendTraceTag(22552774,Lg.Pn,50,"Received response from server -- going back to normal interval")}else this.mz.event(7),this.Ptf("invalid response",Mh);else this.mz.event(6),this.Ptf("null response",Mh)};this.gwn=(hg,Mh)=>{hg={};hg.DocxSaveMonitorState=so[Mh.newState];hg.PreviousState=so[Mh.tLf];hg.PreviousStateHits=Mh.uLf;hg.PreviousStateTransitionTime=Mh.vLf.toISOString();hg.LastHttpStatus=this.Opc;hg.LastSuccessTime=this.xqb.toISOString();this.Stc&&
(hg.LastRequestStartTime=this.Stc.toISOString());hg.LastSavedRevisionID=this.d9b.toString();hg.LastSavedRevisionIdOrigin=this.irc;hg.LastSavedRevisionIdSetTime=this.HEe?this.HEe.toISOString():null;hg.IsViable=this.kf.Hta;hg.IsNetworkConnected=this.kf.dK;hg.IsExpired=this.kf.F$;hg.HasEmergencyViewModeBeenDeployed=this.kf.Qj;hg["Navigator.Online"]=window.navigator.onLine;const Kf=Mh.c0n;Kf&&Lg.npi(hg,Kf);Mh=Mh.newState;switch(Mh){case 13:ja.ULS.sendTraceTag(5830086,Lg.Pn,50,"{0}",hg);break;case 1:ja.ULS.sendTraceTag(5884125,
Lg.Pn,50,"{0}",hg);break;case 0:ja.ULS.sendTraceTag(5830087,Lg.Pn,50,"{0}",hg);break;case 2:ja.ULS.sendTraceTag(5830088,Lg.Pn,50,"{0}",hg);break;case 3:ja.ULS.sendTraceTag(5830089,Lg.Pn,50,"{0}",hg);break;case 4:ja.ULS.sendTraceTag(5884126,Lg.Pn,50,"{0}",hg);break;case 5:ja.ULS.sendTraceTag(5884127,Lg.Pn,50,"{0}",hg);break;case 6:ja.ULS.shipAssertTag(5830090,Lg.Pn,!1,"{0}",hg);break;case 7:ja.ULS.shipAssertTag(5830091,Lg.Pn,!1,"{0}",hg);break;case 8:ja.ULS.sendTraceTag(5830092,Lg.Pn,15,"{0}",hg);
break;case 10:ja.ULS.sendTraceTag(5830094,Lg.Pn,15,"{0}",hg);break;case 9:ja.ULS.sendTraceTag(5884128,Lg.Pn,50,"{0}",hg);break;case 11:ja.ULS.sendTraceTag(5830096,Lg.Pn,15,"{0}",hg);break;case 17:ja.ULS.sendTraceTag(37835678,Lg.Pn,15,"{0}",hg);break;case 12:ja.ULS.sendTraceTag(5830095,Lg.Pn,15,"{0}",hg);break;case 18:ja.ULS.sendTraceTag(38122832,Lg.Pn,15,"{0}",hg);break;case 19:ja.ULS.sendTraceTag(38122833,Lg.Pn,15,"{0}",hg);break;case 21:ja.ULS.sendTraceTag(0,Lg.Pn,15,"{0}",hg);break;case 14:ja.ULS.sendTraceTag(6575508,
Lg.Pn,15,"{0}",hg);break;case 15:ja.ULS.sendTraceTag(36739287,Lg.Pn,50,"{0}",hg);break;case 16:ja.ULS.sendTraceTag(36767649,Lg.Pn,15,"{0}",hg);break;case 20:ja.ULS.sendTraceTag(593510690,Lg.Pn,15,"{0}",hg);break;default:ja.ULS.shipAssertTag(5884129,Lg.Pn,!1,"Bad state:{0} logInfo:{1}",Mh,hg)}};this.Cvc=Q;this.Gmc=wa;this.d7a=Q;this.X3g=eb;this.nTj=Lb;this.gQj=Tc;this.mFe=Ad;this.lSb=we;this.zAg=Rd;this.Xie=yf;this.wY=rg;this.t8=vi;this.ync=Rk;this.KIj=Ij;this.bRb=Sl;this.pue=hk;this.MO=Yl;this.my=
Sj;this.dRj=eg;this.OJg=Zl;this.fRa=ro.create(Ss.isEnabled,Ss.maxRetries,$i.Y4);this.LDe=new Ri.a;this.cpe=xk;this.mz=new nl.a(-1);this.kf=jt;this.tv=Pp;this.mz.hOe(this.gwn);this.ijd=yq;this.xqb=Sj();this.mHg=bs;this.Htj=Ss.isEnabled?null:$i;this.Cnb=cs;this.K1g=this.X3g;this.Zxe=tf.a.nil;this.sa=new l.a;ea.a.instance.Za("Common.App.VisibilityManagement.IVisibilityManager").execute(hg=>{this.In=hg;this.In.Tub((Mh,Kf)=>{this.o$(Mh,Kf)});this.bCe=hg.PD});this.kf&&this.kf.TNe((hg,Mh)=>{this.xFb(hg,
Mh)});this.MZg=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldReportUpToDateKPI",!1):!1;this.mve=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIntervalMs",ec):ec;this.uRj=Ss}xFb(Q,wa){ja.ULS.sendTraceTag(528577692,Lg.Pn,15,"DocxSaveMonitor: AppNetworkChanged event raised. OldState: [{0}], NewState: [{1}]",Qf.a[wa.uDf],Qf.a[wa.KRc]);1!==wa.KRc&&3!==wa.KRc&&(ja.ULS.sendTraceTag(528566343,
Lg.Pn,50,"Resetting list of current failed request retries. State before resetting is - Canary: [{0}], Timeout: [{1}]",this.fRa.jOc(1),this.fRa.jOc(2)),this.fRa.clear())}get Xyd(){return this.qme}get d9b(){return this.Zxe}get $W(){const Q=!this.adb()||this.d9b.equals(this.adb().id);this.etn(Q,this.tv.$W);Q||ja.ULS.sendTraceTag(521413851,Lg.Pn,50,"Document has unSavedChanges: currentRevisionId [{0}], mostRecentRevisionIdResult [{1}]",this.adb().id.toString(),this.d9b.toString());return Q}get uci(){return this.my().getTime()-
this.xqb.getTime()>this.mve}get evd(){return this.mR}get PVa(){return 3}get Wud(){let Q=null;qe.App.xa&&qe.App.xa.jb&&qe.App.xa.jb.Zc&&(Q=qe.App.xa.jb.Zc.contentReplicator);return[Q,Ji.App.z_]}o$(){var Q,wa,eb;const Lb={["VisibilityState"]:Xh.a[this.In.PD],["IsVisible"]:this.In.isVisible,["DocxSaveMonitor"]:{["RequestPending"]:this.YQb,["KickoutIntervalElapsed"]:this.uci,["LastSuccessfulIterationTime"]:null!==(Q=this.xqb)&&void 0!==Q?Q:"null",["RequestStartTime"]:null!==(wa=this.Stc)&&void 0!==wa?
wa:"null",["SkippedKickouts"]:this.mld,["LastSkippedKickoutAt"]:null!==(eb=this.OMg)&&void 0!==eb?eb:"null"},["IsViable"]:this.kf.Hta,["IsNetworkConnected"]:this.kf.dK,["IsExpired"]:this.kf.F$,["HasEmergencyViewModeBeenDeployed"]:this.kf.Qj,["Navigator.Online"]:window.navigator.onLine};ja.ULS.sendTraceTag(539874775,Lg.Pn,50,Pa.c(Lb));this.bCe!=this.In.PD&&(0===this.In.PD?(Sf.c(mf.a.Eik,void 0,void 0,void 0,void 0,void 0,Lb),this.Qmd&&Sf.b("AvgTimeSpentOutsideOfWord",Date.now()-this.Qmd,1),this.Qmd=
void 0):0===this.bCe&&(Sf.c(mf.a.Fik,void 0,void 0,void 0,void 0,void 0,Lb),this.Qmd=Date.now()),this.bCe=this.In.PD)}start(){this.qme=this.zAg.Sab(this.R8k,this.d7a)}REa(Q){if(!this.Xyd||this.d7a===Q)return!1;const wa=this.d7a;this.d7a=Q;this.stop("changing save monitor interval from "+wa+"ms to "+Q+"ms");this.start();return!0}rdc(Q,wa){if(wa>=this.irc&&Q&&!tf.a.nil.equals(Q)){var eb=!this.Zxe.equals(Q);this.irc=wa;this.Zxe=Q;const Lb=this.my();this.HEe=Lb;const ec=this.$W;eb&&(wa={["Id"]:Q.toString(),
["IsUpToDate"]:ec,["Origin"]:dj[wa]},this.bwe&&(wa.LastUpToDateTime=this.bwe.toISOString()),(eb=this.obf())&&eb.store&&(Q=eb.store.getRevision(Q))&&(wa.LastSavedCreationTime=Q.creationTime.toISOString()),ja.ULS.sendTraceTag(557320151,Lg.Pn,50,"Updating Last Saved Revision: {0}",wa));ec&&(this.bwe=Lb)}else wa<this.irc?ja.ULS.sendTraceTag(572051800,Lg.Pn,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',this.irc,wa):ja.ULS.sendTraceTag(572051801,Lg.Pn,15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',
wa)}stop(Q){this.ef(Q)}ef(Q){this.Xyd&&(ja.ULS.sendTraceTag(5830084,Lg.Pn,50,"Stopping DocxSaveMonitor because {0}!",Q),this.zAg.ef(this.Xyd),this.qme=0)}VQl(){if(0>=this.lSb)return!1;var Q=this.Kef();if(!Q)return this.RBe=null,this.Ohd=0,this.Phd=!1;this.orb=Q.QBd;this.orb===this.RBe?this.Ohd++:(this.RBe=this.orb,this.Ohd=1,this.Phd=!1);if(this.Ohd<Lg.KGm)return!1;this.Prc=+this.my()-+this.orb;if(this.Prc<=this.lSb)return!1;if(!this.Phd)return this.Phd=!0,this.QHi(),!1;if(this.Cnb)this.Cnb.execute(wa=>
{wa.flush(this,0)});else{Q="";try{this.cpe&&(Q=this.cpe())}catch(wa){Q=Pa.c({["Kind"]:"Exception",["Stack"]:wa.stack,["Message"]:wa.message,["FileName"]:wa.fileName,["LineNumber"]:wa.lineNumber}),ja.ULS.sendTraceTag(50426817,Lg.Pn,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",Q)}ja.ULS.sendTraceTag(50426818,Lg.Pn,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",this.orb.toISOString(),
this.Prc,this.lSb,Q)}this.lSb=-1;this.stop("Exceeded oldest allowed local revision");this.Uw(Hl.a.NXk);return!0}Kef(){let Q=null,wa=this.adb();for(;wa&&!wa.Bta;)Q=wa,wa=wa.hl;return Q}xim(){return this.bRb()?(this.mz.event(1),this.stop("session is lost"),!0):this.pue()?(this.mz.event(14),ja.ULS.sendTraceTag(20029718,Lg.Pn,15,"ExpiredSessionNotLostYet"),this.stop("session is expired"),this.Uw(Hl.a.Wyd),!0):!1}obf(){const Q=this.ync();return Q?Q.Nc:null}adb(){const Q=this.obf();return Q?Q.Im:null}Bzc(Q){return this.uRj.isEnabled?
this.fRa.Bzc(Q):this.Htj.jOc(Q)&&!this.fRa.jOc(Q)}Ogl(Q){return Q?Lg.D6n:Lg.VQi}Ntf(Q,wa,eb){if(this.uci)if(this.In&&!this.In.isVisible)ja.ULS.sendTraceTag(540669727,Lg.Pn,15,"Kickout interval has elapsed, but browser tab is not visible. We will not kick out immediately"),this.mld+=1,this.OMg=this.my();else return this.mz.event(Q,{}),this.stop("request failed after kickout interval "+eb),this.Cnb&&this.Cnb.execute(Lb=>{Lb.flush(this,2)}),this.Uw(wa),!0;return!1}Otf(Q,wa){const eb=Q.StatusCode;return 88===
eb||89===eb||236===eb?(wa.KickoutDiagnostics=this.cpe(),88===eb?(wa.Result="deleted DSS session",this.mz.event(18,wa),this.stop("deleted DSS session"),this.Uw(Hl.a.localCobaltDeletedSessionFault)):89===eb?(wa.Result="expired DSS session",this.mz.event(19,wa),this.stop("expired DSS session"),this.Uw(Hl.a.localCobaltExpiredSessionFault)):(H.AFrameworkApplication.Gl("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled"),H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",
!1)&&(Q=Bj.b(Q.LastSavedRevisionId),this.rdc(Q,4)),wa.Result="DSS session not found",this.mz.event(21,wa),this.stop("DSS session not found"),this.Uw(Hl.a.localCobaltSessionNotFound)),!0):14===eb?(this.stop("DSS returned an unspecified failure"),this.Uw(Hl.a.wtm),!0):104===eb?(this.stop("this operation is disabled on the server"),!0):this.Ptf("unrecognized OperationResult: "+eb,wa)}Ptf(Q,wa){if(!this.LDe.contains(Q))this.LDe.add(Q);else if(this.Ntf(11,Hl.a.M3e,Q))return wa.ConsecutiveErrors=this.evd,
wa.Reason=Q,ja.ULS.sendTraceTag(41997899,Lg.Pn,15,"DocxSaveMonitor kickout. {0}",wa),!0;this.REa(this.Gmc);return!1}iSl(Q,wa,eb){let Lb=!1;if(Q){const ec=this.my().getTime()-Q.creationTime.getTime();ec>=this.X3g&&(Lb=!0,Lg.npi(wa,this.QEl(Q,ec,eb)),ec>=this.mve&&10===this.mz.currentState?(this.mz.event(11,wa),this.stop("didn't save in time"),this.Uw()):(this.mz.event(10,wa),this.QHi(),this.k9e()))}return Lb}v6j(Q){this.sa.addHandler(Lg.cEi,Q)}V8g(Q){this.sa.addHandler(Lg.s9e,Q)}wNi(Q){this.sa.removeHandler(Lg.s9e,
Q)}QHi(){this.sa.raiseEvent(Lg.cEi)}Pra(Q){let wa;return({group:wa}=Vf.a.G7(Q)).returnValue?wa.Responses[0]:null}QEl(Q,wa,eb){const Lb={};Lb.FirstUnsavedRevisionId=Q.id.toString();Lb.FirstUnsavedRevisionLengthToRoot=Q.mQ;Lb.UnsavedTimeInMs=wa;Lb.CurrentRevisionId=eb.id.toString();Lb.CurrentRevisionLengthToRoot=eb.mQ;return Lb}k9e(){ic.a.l9e(8)}Uw(Q=Hl.a.M3e){this.nTj?(this.stop(Lg.lnm),Q===Hl.a.Wyd?this.wY.value.Uw(Q,Object.assign(new Im.a,{zja:4,v1:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,
r9:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):this.wY.value.Uw(Q,new Im.a)):ja.ULS.sendTraceTag(19247383,Lg.Pn,50,"Kickout disabled")}dI(){const Q={};this.orb&&(Q.ORT=this.orb.toISOString());0<this.Prc&&(Q.AA=this.Prc);0<this.lSb&&(Q.MAA=this.lSb);0<this.mld&&(Q.LSKO=this.OMg.toISOString());this.mz&&0<=this.mz.currentState&&(Q.SMS=so[this.mz.currentState]);const wa={};H.AFrameworkApplication.Xla&&(wa.S=1);qe.App.lostSession&&(wa.LS=1);this.kf&&(this.kf.io&&(wa.KO=1),this.kf.F$&&
(wa.TE=1));this.In&&(wa.VS=Xh.a[this.In.PD]);window.navigator&&(wa.NW=!window.navigator.onLine);Q.AMD=wa;return Q}csl(){const Q={"Content-Type":"application/json; charset=utf-8","X-Requested-With":"Fetch"};H.AFrameworkApplication.buildVersion&&(Q["X-OfficeVersion"]=Vb.a.aQ(H.AFrameworkApplication.buildVersion));H.AFrameworkApplication.accessToken&&(Q["X-AccessToken"]=Vb.a.aQ(H.AFrameworkApplication.accessToken),Q["X-AccessTokenTtl"]=H.AFrameworkApplication.LIa.toString());H.AFrameworkApplication.canary&&
(Q["X-Key"]=Vb.a.aQ(H.AFrameworkApplication.canary));H.AFrameworkApplication.userType&&(Q["X-UserType"]=Vb.a.aQ(H.AFrameworkApplication.userType));const wa=H.AFrameworkApplication.Ze.P3;wa&&(Q["X-WacCluster"]=Vb.a.aQ(wa));H.AFrameworkApplication.userSessionId&&(Q["X-UserSessionId"]=Vb.a.aQ(H.AFrameworkApplication.userSessionId));return Q}p9e(){var Q=this.kf?this.kf.networkState:null;if(1===Q||3===Q)ja.ULS.sendTraceTag(558158790,Lg.Pn,15,"Not sending request because we dont have network.");else if(Q=
this.ync()){var wa=new Sys.Net.WebRequest;wa.set_httpVerb("POST");wa.set_url(Lg.serviceUrl);var eb={};eb.body=ff.b($o.a.construct(Q));eb.headers=this.csl();eb.method=wa.get_httpVerb();try{"function"===typeof window.fetch?window.fetch(wa.getResolvedUrl(),eb).then(Lb=>{ja.ULS.sendTraceTag(561551382,Lg.Pn,50,"Request succeeded at the HTTP level {0}",Lb.statusText);this.JMg=Lb.status;return Lb.json()},Lb=>{ja.ULS.sendTraceTag(561551383,Lg.Pn,15,"Request failed at the HTTP level {0}",Lb);return null}).then(Lb=>
{Lb=JSON.stringify(Lb);this.Usk(Lb,this.JMg);return Lb},()=>{ja.ULS.sendTraceTag(561551385,Lg.Pn,15,"Request succeeded with null response data");return""}):ja.ULS.sendTraceTag(561002076,Lg.Pn,15,"Browser does not support Fetch.")}catch(Lb){ja.ULS.sendTraceTag(561551386,Lg.Pn,15,String.format("Exception when attempting to get last revision save id : {0}",Lb))}}else ja.ULS.sendTraceTag(540079457,Lg.Pn,15,"Target node is null, not sending last saved revision request.")}Usk(Q,wa){let eb=tf.a.nil,Lb=!1,
ec=-1;wa===Kk.a.qD&&((Q=this.Pra(Q))?(eb=Bj.b(Q.LastSavedRevisionId),Q.StatusCode||(Lb=!0,ec=Q.StatusCode)):ja.ULS.sendTraceTag(561002077,Lg.Pn,50,"Response is null when attempting to get last revision save id"));this.sa.raiseEvent(Lg.s9e,new Zo(eb,Lb,wa,ec))}static npi(Q,wa){for(let eb in wa)Q[eb]=wa[eb]}xdm(){return af.SessionStatusManager.instance.io}etn(Q,wa){if(this.MZg)if(Ga.Health.instance.recordKpiUsage(Lg.w6f,0,Lg.L0b,null),Q===wa)Ga.Health.instance.recordKpiSuccess(Lg.w6f,null);else{const eb=
new Map;eb.set("DocxSaveMonitor",Q.toString());eb.set("RSNManager",wa.toString());eb.set("TimeSinceLastRSNUpdate",(+new Date-+this.tv.uii).toString());Ga.Health.instance.recordKpiFailure(Lg.w6f,"Inconsistency",!1,!1,Object.assign(new Ie.a,{extendedProperties:eb}))}}}Lg.VQi=0;Lg.serviceUrl=qe.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";Lg.lnm="kickout";Lg.cEi="PS";Lg.s9e="FLSR";Lg.Pn=343;Lg.KGm=5;Lg.D6n=5E4;Lg.w6f="UpToDate";Lg.L0b="wwrelfc";Object(f.a)(Lg,"DocxSaveMonitor",
null,[1786,121]);class $p{Sab(Q,wa){return window.setInterval(Q,wa)}ef(Q){window.clearInterval(Q)}}$p.instance=new $p;Object(f.a)($p,"DocxSaveMonitorTaskManager",null,[1781]);class Fk{constructor(Q){this.WM=0;this.qqa=Q}start(Q){this.qqa&&(this.WM=Q,this.qqa.reset())}log(){if(this.qqa){var Q={};Q.RequstId=this.WM;Q.InvokeCount=this.qqa.dMc;Q.InvokeFailedCount=this.qqa.eMc;Q.NoOpenConnectionCount=this.qqa.ORc;Q.SynchronousNotificationCount=this.qqa.O0c;Q.ResponseNotAvailable=this.qqa.TXc;ja.ULS.sendTraceTag(19161613,
205,50,"ClientRequestManagerTelemetryStorage: {0}",Q)}}}Object(f.a)(Fk,"RequestLifeCycleTelemetryManager",null,[1779]);class kn{constructor(){this.W=this.CEe=null;this.lLk=()=>{var Q=H.AFrameworkApplication.K;if(!Q.$("DocxSaveMonitorEnabled"))return null;var wa=Q.$("DocxSaveMonitorKickoutEnabled");const eb=Q.rc("DocxSaveMonitorIntervalMs",6E4),Lb=Q.rc("DocxSaveMonitorFailureIntervalMs",5E3),ec=Q.rc("DocxSaveMonitorWarningTimeMs",12E4),Tc=Q.rc("DocxSaveMonitorKickoutTimeMs",3E5),Ad=Q.rc("DocxSaveMonitorQueueTimeoutMs",
6E4),we=Q.rc("DocxSaveMonitorSentTimeoutMs",12E4),Rd=Q.rc("DocxSaveMonitorOldestAllowedLocalRevisionMs",3E5);var yf=Q.$("DocxSaveMonitorTelemetryInfoEnabled");const rg=Q.$("DocxSaveMonitorInfoRequestLoggingEnabled");var vi=H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",!1),Rk=Q.$("DocxSaveMonitorRawWebRequestsEnabled")||vi;vi=Q.$("ComponentStateLoggingPackageIsEnabled");Q=Q.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",
!1);var Ij=H.AFrameworkApplication.Ze,Sl=Rk?new ho.a(H.AFrameworkApplication.userSessionId,Ij.P3,Ij.gwh):null;Sl=new Hj(Ij,Sl,Rk);yf=yf&&Ij&&!Rk?new Fk(Ij.qba):null;Rk=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorIsEnabled",!1):!1;Ij=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorMaxRetries",3):3;const hk=ro.create(Rk,Ij);hk.Fxc(1);
hk.Fxc(2);vi=vi?this.W.Za("Common.IComponentStateLogManager"):null;wa=new Lg(eb,Lb,ec,wa,Tc,Ad,we,Rd,$p.instance,Sl,ea.a.instance.Ye("Box4.IKickoutExecutor"),zp.a.instance,this.k3b,()=>!H.AFrameworkApplication.sUd||qd.a.instance.lMc,()=>qe.App.lostSession,Object(a.a)(xm.a.instance,xm.a.instance.Wya,"checkAndTriggerSessionHasExpired"),()=>H.AFrameworkApplication.Dk,()=>new Date,()=>new Date,yf,rg,hk,this.Xel,vi,Q,ea.a.instance.Pa("Common.ISessionStatus")||af.SessionStatusManager.instance,ea.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager"),
{isEnabled:Rk,maxRetries:Ij});wa.start();ja.ULS.sendTraceTag(5884131,Lg.Pn,50,"SaveMonitor initialized");return wa};this.k3b=()=>{const Q=qe.App.xa.jb.Jc;return Q?Q.ud:null};this.Xel=()=>{const Q={};H.AFrameworkApplication.uc&&(Q.TM=H.AFrameworkApplication.uc.dI());cj.WoncaApp.nE&&(Q.RS=cj.WoncaApp.nE.dI());Ji.App.z_&&(Q.CRS=Ji.App.z_.dI());qe.App.xa&&qe.App.xa.jb&&qe.App.xa.jb.Zc&&qe.App.xa.jb.Zc.contentReplicator&&(Q.GSR=qe.App.xa.jb.Zc.contentReplicator.dI());H.AFrameworkApplication.Xla&&(Q.S=
1);qe.App.lostSession&&(Q.LS=1);qe.App.rd&&qe.App.rd.QA.io&&(Q.KO=1);return Sys.Serialization.JavaScriptSerializer.serialize(Q)}}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(qe.App.vs||qe.App.fn)this.CEe=this.W.resolve("WordEditor.DocxSaveMonitor.DocxSaveMonitor")}dispose(){this.CEe&&this.CEe.stop("WordEditorDocxSaveMonitorPackage is being disposed")}zc(Q){this.W=Q;(qe.App.vs||qe.App.fn)&&Q.ha("WordEditor.DocxSaveMonitor.DocxSaveMonitor",this.lLk).as("Wonca.IDocxSaveMonitor").singleInstance()}static main(){ca.a.instance.Pc(new kn)}}
Object(f.a)(kn,"WordEditorDocxSaveMonitorPackage",null,[1,2]);var Nl;(function(Q){Q[Q.version0=0]="version0";Q[Q.version1=1]="version1"})(Nl||(Nl={}));Object(f.b)("FirstRunExperienceVersion",Nl);class ol{get qPe(){return"Word"}get cih(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return Nl.version0}get currentVersion(){return Nl.version1}get h$l(){return ol.isEnabled()&&H.AFrameworkApplication.K.$("WordEditorFirstRunExperienceDataStoreIsEnabled")}get k7b(){return ol.isEnabled()&&H.AFrameworkApplication.K.$("WordEditorFirstRunExperienceUIV2IsEnabled")}get Agi(){return H.AFrameworkApplication.K.$("WordEditorFirstRunExperienceTestIsEnabled")}get t$k(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get Ppi(){return 24}get FRi(){return 4E3}get iYc(){return""}static isEnabled(){const Q=
H.AFrameworkApplication.sessionStartInfoSettings?H.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup:"";return"Unknown"!==Q&&"Automation"!==Q}}Object(f.a)(ol,"FirstRunExperienceLauncherSettings",null,[1821]);class Bn{constructor(Q){this.jDg=Q}VUn(Q){this.jDg&&this.jDg.WUn(Q)}}Object(f.a)(Bn,"FirstRunExperienceManager",null,[1820]);class to{constructor(){this.W=null}get name(){return"WordEditor.FirstRunExperience"}zc(Q){this.W=Q;this.W.ha("WordEditor.FirstRunExperience.IFirstRunExperienceManager",
()=>new Bn(this.W.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"))).singleInstance()}init(){const Q=this.W.resolve("WordEditor.FirstRunExperience.IFirstRunExperienceManager");Q&&Q.VUn(new ol)}dispose(){}}Object(f.a)(to,"WordEditorFirstRunExperiencePackageManager",null,[1,2]);class qn{constructor(Q,wa,eb){this.GGi=(Lb,ec,Tc,Ad,we)=>{if(1===Tc)return 32;switch(Lb){case mf.a.HGi:we[wl.a.On]=1===this.RGa.cbb;break;case mf.a.IGi:we[wl.a.On]=2===this.RGa.cbb}return 32};this.Lna=
(Lb,ec,Tc,Ad,we)=>{if(1===Tc)return 32;if(2===Tc){ec=this.RGa.hh.isVisible;this.RGa.NA(!0,1===we);Tc=0;switch(Lb){case mf.a.WZf:we=1;break;case mf.a.XZf:we=2;break;case mf.a.j7d:we=2;Tc=1;break;case mf.a.k7d:we=1;Tc=2;break;case mf.a.l7d:we=1;Tc=3;break;case mf.a.G$d:we=this.RGa.cbb;this.gLg&&!we&&(we=1);break;default:Tc=we=0}ec&&Lb===mf.a.Lna||this.RGa.ZHn(we,Tc);return 32}return 8};this.cKd=(Lb,ec,Tc,Ad,we)=>{this.toggleButton(we,!1);return this.Nwk(Tc)};this.G$d=(Lb,ec,Tc,Ad,we)=>this.RGa.hh.isVisible?
this.cKd(Lb,ec,Tc,Ad,we):this.Lna(Lb,ec,Tc,Ad,we);this.ga=Q;this.RGa=wa;this.gLg=eb}dispose(){this.RGa&&this.RGa.dispose()}Vb(){this.ga.pa(mf.a.G$d,th.a.view,this.G$d);this.ga.gb(mf.a.Lna,th.a.view,this.Lna,4);this.ga.pa(mf.a.cKd,th.a.view,this.cKd);this.ga.gb(mf.a.j7d,th.a.view,this.Lna,4);this.ga.pa(mf.a.k7d,th.a.view,this.Lna);this.ga.pa(mf.a.l7d,th.a.view,this.Lna);this.gLg&&(this.ga.gb(mf.a.HGi,th.a.view,this.GGi,96),this.ga.pa(mf.a.WZf,th.a.view,this.Lna),this.ga.gb(mf.a.IGi,th.a.view,this.GGi,
96),this.ga.pa(mf.a.XZf,th.a.view,this.Lna))}Nwk(Q){if(1===Q)return 32;this.RGa.NA(!1);return 32}toggleButton(Q,wa){Q&&(Q[wl.a.On]=wa)}}Object(f.a)(qn,"FormatPictureActor",null,[10]);class Ko{constructor(Q){this.utb=!1;this.hh=Q}get cbb(){return this.hh.wNk}ZHn(Q,wa){switch(Q){case 0:case 1:this.hh.TVn(wa);break;case 2:this.hh.dWn(wa)}}NA(Q,wa=!1){this.utb||this.hmf();Q?this.hh.mO(wa):this.hh.pla()}dispose(){this.hh.dispose()}hmf(){this.utb||(this.hh.initialize(),this.utb=!0)}}Object(f.a)(Ko,"FormatPictureManager",
null,[1783,10]);var Lo=d(372),ij=d(106),jm=d(335);class jj{}jj.sO=jm.a.JCd;jj.M$b=1;jj.oib=WordEditorIntl.WordEditorStrings.L_FormatPicture;jj.Lra="FormatPictureTaskPaneData";Object(f.a)(jj,"FormatPicturePaneConstants",null,[]);class Tm{constructor(){this.type="FormatPictureTaskPaneProps";this.section=0;this.description=this.title=this.numberFormatInfo=null;this.rotationAngle=this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=
this.onTitleChange=null;this.disabled=!1}}Object(f.a)(Tm,"FormatPictureTaskPaneProps",null,[]);class yi{constructor(Q,wa,eb,Lb){this.REe=0;this.wlc=this.Yia=null;this.Kjd=this.Bjd=this.ned=this.y6c=this.gnd=0;this.ou=this.YOb=!1;this.Dke=0;this.qVm=()=>{this.mXi()};this.xl=()=>{let ec=!1;ec=this.Z$m()||ec;ec=this.f1a()||ec;ec=this.e1a()||ec;ec=this.Rac()||ec;(ec=this.V$m()||ec)&&this.Vn()};this.fP=Q;this.sJj=wa;this.hwe=eb;this.gg=Lb}initialize(){this.VY();this.Aga()}get isVisible(){return this.ou}mO(Q){this.L_c(Q)}pla(){this.Saa();
this.nWl()}TVn(Q){this.EZi(Q,1)}dWn(Q){this.EZi(Q,2)}EZi(Q,wa){this.Dke=wa;this.REe=Q}get wNk(){return this.Dke}dispose(){}VY(){this.fP.PJa();this.REe=this.Dke=0}get Ai(){return this.sJj.value}get Ac(){return this.hwe.value}c_a(){return!!this.Ai.xg&&this.Ai.xg.name===jj.sO}mXi(){this.Ai.Jg(jj.sO)}Aga(){const Q=this.Ai.pe(jj.sO);Q.parent=ye.AFrame.Lp;Q.Wca(this.qVm)}Saa(){this.c_a()&&this.Ai.Jg(this.Ai.AS)}L_c(Q){bj.UISurfaces.Xt().then(wa=>{wa.showTaskPane(jj.sO,this.nB(Q));this.isVisible&&Q&&this.Ai.Jg(jj.sO);
return null})}Vn(){bj.UISurfaces.Xt().then(Q=>{Q.updateTaskPane(jj.sO,this.nB(!1));return null})}nWl(){bj.UISurfaces.Xt().then(Q=>{Q.hideTaskPane(jj.sO,2);return null})}nB(){const Q=new Tm;this.UOn(Q);return Object.assign(new Vj.a,{title:jj.oib,hideHeader:!1,width:320,location:2,contentProps:Q,onOpen:wa=>{this.ou=!0;qe.App.xa.SUa(this.xl);qe.App.xa.updateCommandUI();this.mXi();this.gg.Cpd(jj.sO,wa)},onClose:()=>{this.Saa();this.ou=!1;qe.App.xa.Fbc(this.xl);qe.App.xa.updateCommandUI()},isModernPane:!0,
enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}UOn(Q){const wa=vg.e().numberFormatInfo;Q.section=this.REe;Q.numberFormatInfo="object"===typeof wa?wa:null;Q.title=this.Yia;Q.description=this.wlc;Q.topCrop=this.gnd;Q.bottomCrop=this.y6c;Q.leftCrop=this.ned;Q.rightCrop=this.Bjd;Q.rotationAngle=this.Kjd;Q.onTitleChange=this.onTitleChange();Q.onDescriptionChange=this.onDescriptionChange();Q.onCropSpinButtonChange=this.onCropSpinButtonChange();Q.onRotationSpinButtonChange=this.onRotationSpinButtonChange();
Q.disabled=this.YOb}onTitleChange(){return Q=>{if(Q!==this.Yia){this.Yia=Q;var wa=new Lo.DictionaryPropertySet;wa.setValue(ij.a.ueb,Q);this.Ac.Xb(jg.a.sZc,2,wa);this.Vn()}}}onDescriptionChange(){return Q=>{if(Q!==this.wlc){var wa=new Lo.DictionaryPropertySet;wa.setValue(ij.a.GW,Q);this.wlc=Q;this.Ac.Xb(jg.a.YIb,2,wa);this.Vn()}}}onCropSpinButtonChange(){return(Q,wa)=>{const eb=new Lo.DictionaryPropertySet;switch(wa){case 0:this.gnd=Q;eb.setValue(ij.a.Aeb,Q);this.Ac.Xb(mf.a.WKc,2,eb);break;case 1:this.y6c=
Q;eb.setValue(ij.a.xeb,Q);this.Ac.Xb(mf.a.PKc,2,eb);break;case 2:this.ned=Q;eb.setValue(ij.a.yeb,Q);this.Ac.Xb(mf.a.QKc,2,eb);break;case 3:this.Bjd=Q,eb.setValue(ij.a.zeb,Q),this.Ac.Xb(mf.a.RKc,2,eb)}this.Vn()}}onRotationSpinButtonChange(){return Q=>{this.Kjd=Q;const wa=new Lo.DictionaryPropertySet;wa.setValue(ij.a.aLc,0);wa.setValue(ij.a.YJ,Q);this.Ac.Xb(jg.a.imageRotate,2,wa);this.Vn()}}Z$m(){const Q=2===this.Ac.Xb(jg.a.sZc,1,null),wa=Q!==this.YOb;this.YOb=Q;return wa}f1a(){var Q=new Lo.DictionaryPropertySet;
this.Ac.Xb(jg.a.f1a,2,Q);Q=Q.ia(ij.a.ueb,"");const wa=Q!==this.Yia;this.Yia=Q;return wa}e1a(){var Q=new Lo.DictionaryPropertySet;this.Ac.Xb(jg.a.e1a,2,Q);Q=Q.ia(ij.a.GW,"");const wa=Q!==this.wlc;this.wlc=Q;return wa}Rac(){var Q=new Lo.DictionaryPropertySet;this.Ac.Xb(mf.a.kVc,2,Q);const wa=Q.ia(ij.a.Aeb,0),eb=Q.ia(ij.a.xeb,0),Lb=Q.ia(ij.a.yeb,0);Q=Q.ia(ij.a.zeb,0);const ec=wa!==this.gnd||eb!==this.y6c||Lb!==this.ned||Q!==this.Bjd;this.gnd=wa;this.y6c=eb;this.ned=Lb;this.Bjd=Q;return ec}V$m(){var Q=
new Lo.DictionaryPropertySet;this.Ac.Xb(jg.a.hHb,2,Q);Q=Q.ia(ij.a.YJ,0);const wa=Q!==this.Kjd;this.Kjd=Q;return wa}}Object(f.a)(yi,"ReactFormatPicturePane",null,[1782,10]);class Mf{constructor(){this.T$c=this.W=null}get name(){return"WordEditor.FormatPicture"}zc(Q){this.W=Q;this.W.ha("WordEditor.FormatPicture.IFormatPictureManager",()=>new Ko(this.W.resolve("WordEditor.FormatPicture.IFormatPicturePane"),Ji.App.okj)).singleInstance();this.W.ha("WordEditor.FormatPicture.IFormatPicturePane",()=>new yi(ui.a.instance,
new kb.a(()=>ai.FocusManager.instance()),new kb.a(()=>H.AFrameworkApplication.ya),kk.a.instance)).singleInstance();this.W.ha("WordEditor.FormatPicture.FormatPictureActor",()=>new qn(H.AFrameworkApplication.ya,this.W.resolve("WordEditor.FormatPicture.IFormatPictureManager"),Ji.App.okj)).singleInstance()}init(){if(Ji.App.Mce||Ji.App.L9f)this.T$c=this.W.resolve("WordEditor.FormatPicture.FormatPictureActor"),this.T$c.Vb(),qe.App.xa.updateCommandUI()}dispose(){this.T$c&&this.T$c.dispose()}static main(){ca.a.instance.Pc(new Mf)}}
Object(f.a)(Mf,"WordEditorFormatPicturePackage",null,[1,2]);class Ol{constructor(){this.ZPb=this.Rtc=null;this.djd=0}get name(){return"WordEditor.FrameTiming"}zc(){this.ZPb=new EventTiming.FrameTimingMeter;this.djd=H.AFrameworkApplication.K.rc("FrameTimingMeterReportingIntervalInSeconds",60);0>=this.djd&&(this.djd=60);this.Rtc=Q=>{(Q=Q.rawEvent)&&ja.ULS.sendTraceTag(24962208,306,50,Pa.c(Q.detail))};G.a.addHandler(window.self,B.a.QOi,this.Rtc)}init(){this.ZPb&&this.ZPb.start(this.djd)}dispose(){this.ZPb&&
(this.ZPb.stop(),this.ZPb=null);this.Rtc&&(G.a.removeHandler(window.self,B.a.QOi,this.Rtc),this.Rtc=null)}static main(){ca.a.instance.Pc(new Ol)}}Object(f.a)(Ol,"FrameTimingPackageManager",null,[1,2]);var lk=d(1444),ji=d(555);class ki extends Fm.a{constructor(){super();this.Prompt=0;this.FileId=null}Wl(){return 100}static construct(Q,wa){const eb=new ki;eb.FileId=Q;eb.Prompt=wa;return eb}}Object(f.a)(ki,"GraphMergeConsentChangedRequest",Fm.a,[]);var ym=d(581);class Ki extends ym.a{constructor(){super();
this.Location=this.FileId=null}Wl(){return 34}static construct(Q,wa){const eb=new Ki;eb.FileId=Q;eb.Location=wa;return eb}}Object(f.a)(Ki,"PlayGraphMergeReplayRequest",ym.a,[]);class Rg{constructor(Q,wa,eb,Lb,ec,Tc=null,Ad=null){this.Bl=!1;this.OM=null;this.JYg=this.Sue=!1;this.tXe=()=>{if(this.mwa.LJd)this.Sue=!0;else if(this.Sue=!1,!this.gEn){this.JYg=!0;var we=this.NFa.Iua;ja.ULS.sendTraceTag(39084353,300,50,"GraphMerge consent given: {0}",400===we);if(100===we||400===we)we=ki.construct(this.AR(),
we),this.$x(we)}};this.w1h=(we,Rd)=>{Rd&&Rd.xyf&&Rd.xyf.wZe&&!this.mwa.Dgi&&(this.mwa.Wdj(),this.mwa.LJd=!0,this.$x(Rd.xyf.wZe))};this.t1h=(we,Rd)=>{Rd&&Rd.T3c&&this.mwa.Wdj()};this.u1h=(we,Rd)=>{Rd&&(Rd.ShowMergePrompt&&this.NFa.uPi(this.tXe),H.AFrameworkApplication.jh&&(H.AFrameworkApplication.jh.SessionMergeInfo|=Rd.PartMergeInfo))};this.AR=Q;this.Hod=eb;this.mwa=Lb;this.NFa=ec;this.Hod&&this.Hod.d6j(this.w1h);this.t8=Tc||zp.a.instance;if(!Ad){const we=new ji.a;Ad=Rd=>we.Jka(0,Rd)}this.jvj=Ad}get Clm(){return this.Sue}get gEn(){return this.JYg}$x(Q){const wa=
new ek.a;wa.Vr=Q;wa.status=1;wa.WG="GraphMerge";const eb=this.jvj(()=>{this.SXc(wa,33===Q.Wl())});eb.CJ(wa);eb.gW()}SXc(Q,wa){this.Bl||(wa&&(this.mwa.LJd=!1),2===Q.statusCode&&!X.a.MCb(Q.hk)&&1===Q.hk.length&&Q.hk[0]?(Q=Q.hk[0],Q.StatusCode?this.mwa.pXf():wa&&this.NFa.uPi(this.tXe),this.t8.Ulb(Q),this.Clm&&this.tXe()):this.mwa.pXf())}Mhb(Q){this.OM=Q;this.OM.xWb(this.t1h);this.OM.yWb(this.u1h)}dispose(){this.Bl||(this.Hod&&this.Hod.Gpn(this.w1h),this.OM&&(this.OM.PHb(this.t1h),this.OM.hXc(this.u1h)),
this.Bl=!0)}}Object(f.a)(Rg,"GraphMergeBackupManager",null,[1970,10]);class Vi{constructor(Q,wa=null,eb=null,Lb=null){this.ehe=0;this.Gte=!1;this.XLg=new Date(0);this.LJd=!1;this.NFa=Q;this.my=wa||(()=>new Date);eb||(eb=H.AFrameworkApplication.K?H.AFrameworkApplication.K.rc("WordEditorGraphMergeBackupDelayInMs",12E4):12E4);this.eLj=eb;Lb||(Lb=H.AFrameworkApplication.K?H.AFrameworkApplication.K.rc("WordEditorGraphMergeMaxBackups",1):1);this.FOg=Lb}get ikm(){return+this.my()-+this.XLg<this.eLj}get Dgi(){return 500===
this.NFa.Iua?!1:100===this.NFa.Iua?!0:this.Gte||this.LJd||this.ikm}Wdj(){this.XLg=this.my();this.ehe++;this.ehe>=this.FOg&&this.pXf()}pXf(){this.Gte||(this.Gte=!0,ja.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",this.ehe,this.FOg))}}Object(f.a)(Vi,"GraphMergeBackupThrottler",null,[1818]);class Jn{constructor(Q,wa,eb=null){this.nFg=!1;this.GU=Q;this.tBj=wa;null==eb&&(eb=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("WordEditorGraphMergeBypassConsentPrompt"));
this.iCe=eb?500:300}get Iua(){return this.iCe}uPi(Q){if(!this.nFg&&300===this.Iua){var wa=this.tBj.value;wa&&wa.isFeatureEnabled(53)&&(this.nFg=!0,this.GU.execute(eb=>{eb.fVn(()=>{this.bBk(Q)},()=>{this.consentDenied(Q)})}))}}consentDenied(Q){300===this.Iua&&(ja.ULS.sendTraceTag(42333270,300,50,"Consent denied for investigating merge failures."),this.iCe=100,Q());this.VLi()}bBk(Q){300===this.Iua&&(ja.ULS.sendTraceTag(42333271,300,50,"Consent received for investigating merge failures."),this.iCe=400,
Q());this.VLi()}VLi(){this.GU.execute(Q=>{Q.gWl()})}}Object(f.a)(Jn,"GraphMergeCollectionConsentManager",null,[1816]);class zm extends Sys.EventArgs{constructor(Q){super();this.xyf=Q}}Object(f.a)(zm,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);var ib=d(827),fc=d(699),Hc=d(992),hd=d(628),Ud=d(1688),aa=d(1686),La=d(216),jb=d(150);class Tb{constructor(Q,wa,eb,Lb,ec,Tc){this.EMf=this.zg=null;this.DOc=this.n9f=!1;this.Nk=null;this.w_c=Q.runtime.w_c;this.Wo=Q;this.Yd=wa;this.Ng=eb;this.Um=Lb;this.MAk=
ec;this.graphNodeComplexMerge=Tc}}Object(f.a)(Tb,"GraphNodeComplexMergeState",null,[]);var jc=d(1510),zc=d(1493);class Sc{constructor(Q,wa=null){this.Lg=Q;this.WRb=wa||this.VHc()}get $gb(){return this.WRb}get Yd(){return this.Lg}VHc(){return[Object(a.a)(this,this.tXn,"simpleMerge"),Object(a.a)(this,this.cAk,"complexMerge")]}YOn(Q,wa,eb,Lb,ec,Tc){wa=new Tb(Q,eb,new kb.a(()=>new jc.a(Lb?Lb.im:null,ec)),new kb.a(()=>new jc.a(Lb?Lb.im:null,Tc)),new kb.a(()=>new jc.a(Tc,ec)),wa.ksh(ec,()=>Q.runtime.Pb));
wa.zg=Lb.iVb;wa.EMf=new La.a;return wa}merge(Q,wa,eb,Lb,ec,Tc){wa=this.YOn(Q,wa,eb,Lb,ec,Tc);eb=!0;for(Lb=0;Lb<this.$gb.length&&eb;Lb++)(eb=(0,this.$gb[Lb])(wa))||Q.logger.hSd("GraphNodeMerge.GetMergeFunctions()",Lb);if(Q=wa.DOc&&wa.Nk?new zc.a(wa.Nk,!1):null)switch(Q.tNn(wa.zg),(Q?Q.im:ec).Qc){case 1074135145:wa.Wo.runtime.v1d.hCk.Z(Q.im.id,Q.im);break;case 1074135153:wa.Wo.runtime.v1d.vhk.Z(Q.im.id,Q.im);break;case 1074135127:wa.Wo.runtime.v1d.Wyk.Z(Q.im.id,Q.im);break;case 393230:wa.Wo.runtime.BTd.add(Q.im.id)}return{returnValue:wa.DOc,
Nk:Q}}tXn(Q){if(Q.Wo.runtime.Pb&&Q.Wo.runtime.Pb.OAb(1000005)&&0<Q.zg.count)return!0;var wa=Q.graphNodeComplexMerge.E_d;return Q.Um.value.KMc(wa)&&Q.MAk.value.KMc(wa)?Q.Ng.value.KMc(wa)?!0:(wa=Q.Um.value.Df,Q.DOc=!0,Q.Nk=wa.xG(),!1):(Q.DOc=!0,!1)}cAk(Q){const wa=Q.Um.value.Df;Q.w_c&&jb.a.instance.Ya(4018183,1,4,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",wa.id,wa.Qc);const eb=Q.graphNodeComplexMerge.x5f(Q);Q.DOc=eb;jb.a.instance.Ya(4018184,1,eb?5:4,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",
eb?"Succeeded":"Failed",wa.id,wa.Qc,!!Q.Nk);return eb}}Object(f.a)(Sc,"GraphNodeMerge",null,[1793]);class rc extends Fm.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=null;this.Prompt=this.Reason=this.Source=0}Wl(){return 33}static construct(Q,wa,eb,Lb,ec,Tc,Ad,we,Rd,yf,rg){const vi=new rc;vi.FileId=Q;vi.BaseRevisions=wa;vi.TheirRevisions=
eb;vi.YourRevisions=Lb;vi.IgnoreConflictsInLastServerRevision=ec;vi.MergeHint=Tc;vi.ObjectSpaceId=Ad?Bj.a(Ad):null;vi.RequestId=we?Bj.a(we):null;vi.Source=Rd;vi.Reason=yf;vi.Prompt=rg;return vi}}Object(f.a)(rc,"CreateGraphMergeReplayRequest",Fm.a,[]);var ee=d(789),me=d(250),ae=d(17),cf=d(1793),qg=d(1829);class Gg{constructor(Q,wa=null,eb=null){this.TWk=(Lb,ec)=>{let Tc=Lb;var Ad=ec,we=this.T7a.get(Lb);if(!we)return{BDa:Tc,fIb:Ad};Ad=new La.a;Ad.add(we);var Rd=this.Zqb.get(Lb)||this.sE.J(Lb);we=new La.a;
we.add(Rd);Rd=new La.a;Rd.add(this.sE.J(Lb));ja.ULS.sendTraceTag(17409890,318,50,"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",this.oG.lif,this.oG.G2,this.CSh(we),this.CSh(Ad));var yf=this.SSh(this.oG.G2);this.P9k(yf,Lb,Ad);we=new cf.a(yf,Rd,1===yf.input.G2?we:Ad,1===yf.input.G2?Ad:we,this.SSh(1),we,Ad);Ad=new La.a;for(Rd=0;Rd<ec.length;Rd++){this.oG.RF("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");const rg=({G1a:Tc,
ona:yf}=we.C2c(Lb,ec.J(Rd))).returnValue;Ad.add(yf);rg?ja.ULS.sendTraceTag(17409891,318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",Lb,ec.J(Rd),Tc,yf):ja.ULS.sendTraceTag(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",Lb)}return{BDa:Tc,fIb:Ad}};this.oG=Q;this.sE=Q.jk;this.T7a=Q.K5n;this.Zqb=Q.dto;this.cKj=Q.vtm;
this.Lg=wa||new Hc.a;this.COj=eb||this.TWk}FDc(Q){const wa=new La.a;for(let eb=0;eb<Q.length;eb++){const Lb=this.KWk(Q.J(eb));wa.add(Lb)}return wa}EDc(Q,wa,eb){const Lb=Q.ju===Q.Fz&&Q.startCp===Q.endCp;wa&&({BDa:Q.ju,ona:Q.startCp}=this.kQa(Q.ju,Q.startCp,Q.ju),Lb&&(Q.Fz=Q.ju,Q.endCp=Q.startCp));eb&&!Lb&&({BDa:Q.Fz,ona:Q.endCp}=this.kQa(Q.Fz,Q.endCp,Q.Fz));return Q}KWk(Q){if(Q.ju===Q.Fz){var wa=new La.a;wa.add(Q.startCp);wa.add(Q.endCp);({BDa:Q,fIb:wa}=this.C7f(Q.ju,wa));return new ee.a(Q,wa.J(0),
Q,wa.J(1))}wa=new La.a;var eb=new La.a;let Lb;wa.add(Q.startCp);({BDa:wa,fIb:Lb}=this.C7f(Q.ju,wa));eb.add(Q.endCp);({BDa:Q,fIb:eb}=this.C7f(Q.Fz,eb));return new ee.a(wa,Lb.J(0),Q,eb.J(0))}C7f(Q,wa){let eb=Q,Lb=wa;if(!this.sE.J(Q))return ja.ULS.sendTraceTag(4339675,318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",Q),{BDa:eb,fIb:Lb};if(this.T7a.get(Q))({BDa:eb,fIb:Lb}=this.COj(Q,wa,eb,Lb));else if(this.oG.tlf&&!this.oG.tlf.J(this.oG.tlf.length-
1).s2(Q)){Lb=new La.a;for(let ec=0;ec<wa.length;ec++){let Tc;({BDa:eb,ona:Tc}=this.kQa(Q,wa.J(ec),eb));Lb.add(Tc)}}return{BDa:eb,fIb:Lb}}CSh(Q){let wa="";Q.forEach(eb=>{wa+=eb.w1c();wa+=" ";return!0});return wa}SSh(Q){const wa=ea.a.instance.Pa("Box4.IFeatureHelper"),eb=new qg.a;eb.input.source=this.oG.lif;eb.input.G2=this.oG.G2;eb.input.fFc=()=>wa;eb.runtime.jk=this.sE;eb.runtime.dza=this.oG.Bzk;1===Q?(eb.runtime.Vt=this.Zqb,eb.runtime.kq=this.T7a,eb.runtime.$Ad=this.oG.jii,eb.runtime.Uae=this.oG.Aii):
2===Q&&(eb.runtime.Vt=this.T7a,eb.runtime.kq=this.Zqb,eb.runtime.$Ad=this.oG.Aii,eb.runtime.Uae=this.oG.jii);eb.runtime.Pb=wa;return eb}P9k(Q,wa,eb){if(Q.runtime.Vt.xb(me.a.wK)){var Lb=Q.runtime.Vt.J(me.a.wK);Lb=this.Lg.getPropertyObjectIds(Lb,Lk.a.L_);if(1===Lb.length&&(Lb=Lb.J(0),Q.runtime.Vt.xb(Lb)&&(Lb=Q.runtime.Vt.J(Lb),3===this.Lg.getPropertyInt32(Lb,Lk.a.Qlb)))){const ec=this.Lg.getPropertyString(Lb,Lk.a.cha),Tc=this.Lg.getPropertyString(Lb,Lk.a.yLb);wa.toString()===ec&&ec===Tc&&(wa=this.Lg.getPropertyObjectId(Lb,
Lk.a.E2c),Q.runtime.Vt.xb(wa)&&eb.add(Q.runtime.Vt.J(wa)))}}}XAl(Q,wa){let eb=0;for(let Lb=0;Lb<Q.length;Lb++)if(wa.equals(Q.J(Lb)))return eb=Lb,{returnValue:!0,idx:eb};return{returnValue:!1,idx:eb}}kQa(Q,wa){const eb=this.cKj&&!!this.Zqb.J(Q)&&!this.sE.J(Q);let Lb=Q,ec=wa,Tc=!1,Ad=!1;(eb?this.Zqb:this.T7a).forEach((we,Rd)=>{this.oG.RF("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");if(this.Vqf(Rd.Qc)&&this.sE.J(we)){Rd=null;if(eb){Rd=this.rIc(rg=>this.Zqb.J(rg)||this.sE.J(rg),
we);var yf=this.oOd(Rd,Q)}else yf=this.rIc(rg=>this.sE.J(rg),we),yf=this.oOd(yf,Q);if(yf&&(Ad=!0,Rd||(Rd=this.rIc(rg=>this.Zqb.J(rg)||this.sE.J(rg),we)),we=this.rIc(rg=>this.T7a.J(rg)||this.sE.J(rg),we),yf=0,({idx:yf}=this.XAl(Rd,Q)).returnValue)){for(let rg=yf+1;rg<Rd.length;rg++)if(this.oOd(we,Rd.J(rg)))return ec=0,Lb=Rd.J(rg),Tc=!0,!1;for(--yf;0<=yf;yf--)if(this.oOd(we,Rd.J(yf)))return ec=Number.MAX_VALUE,Lb=Rd.J(yf),Tc=!0,!1}}return!0});Tc||(ja.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",
Q,wa,eb,Ad),5===this.oG.lif&&(ja.ULS.sendTraceTag(17340240,318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",Lb),({SGh:wa}=this.sql()).returnValue?(Lb=wa,ec=0,ja.ULS.sendTraceTag(17340241,318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",Lb)):ja.ULS.sendTraceTag(17340242,
318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",Lb)));return{BDa:Lb,ona:ec}}sql(){let Q=tf.a.nil,wa=new La.a;this.T7a.forEach((eb,Lb)=>{this.oG.RF("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");return this.Vqf(Lb.Qc)?(wa=this.rIc(ec=>this.T7a.J(ec)||this.sE.J(ec),eb),!1):!0});return 0<wa.length?(Q=wa.J(0),{returnValue:!0,SGh:Q}):{returnValue:!1,SGh:Q}}Vqf(Q){return 393241===Q||393250===Q||393251===Q||393252===Q}rIc(Q,
wa){var eb=Q(wa);wa=new La.a;if(!this.Vqf(eb.Qc))return wa;eb=this.Lg.getPropertyObjectIds(eb,ae.a.rf);for(let Lb=0;Lb<eb.length;Lb++){const ec=new La.a;this.cff(Q,eb.J(Lb),ec);wa.uA(wa.length,ec)}return wa}cff(Q,wa,eb){var Lb=Q(wa);if(Lb)if(393230===Lb.Qc)eb.add(wa);else if(393229===Lb.Qc)wa=this.Lg.getPropertyObjectIds(Lb,ae.a.iL).mg(0),this.cff(Q,wa,eb);else if(393250===Lb.Qc||393251===Lb.Qc||393252===Lb.Qc)for(wa=this.Lg.getPropertyObjectIds(Lb,ae.a.rf),Lb=0;Lb<wa.length;Lb++)this.cff(Q,wa.J(Lb),
eb)}oOd(Q,wa){for(let eb=0;eb<Q.length;eb++)if(wa.equals(Q.J(eb)))return!0;return!1}}Object(f.a)(Gg,"GraphMergeSelectionRecordUpdater",null,[]);class Si extends Ud.a{constructor(Q=null,wa=null,eb=null,Lb=null,ec=null,Tc=null,Ad=null,we=null,Rd=-1,yf=null,rg=null,vi=null){super();this.Kth=Rk=>{const Ij=Rk.r1,Sl=qe.App.xa.jb.Zc;return new ib.a(Rk,Ij,Sl.Ad,Sl.fileId,Sl.IHb,Sl.contextId,Ij?Ij.id:tf.a.nil,this.gRi,!1,!0)};this.AR=Q||(()=>H.AFrameworkApplication.rootQuerySignature);wa||(wa=Rk=>new fc.a(Rk));
this.jXg=wa;this.Lg=eb||new Hc.a;this.nwg=Ad||new aa.ChildNodeListMerge(this.Yd);this.xTb=we;this.gRi||(this.xTb=(Rk,Ij,Sl)=>new hd.a(Rk,Ij,Sl));this.WRb=Lb||this.VHc();this.E6a=ec||new Ai.a;this.XEg=Tc||new Sc(this.Yd);this.LOg=void 0===Rd||null===Rd||-1===Rd?Ji.App.pkj:Rd;this.mwa=yf;this.NFa=rg;this.fId=this.bTk(vi);this.zCg=()=>ea.a.instance.Pa("Box4.IFeatureHelper")}bTk(Q){Q||(Q=H.AFrameworkApplication.K?H.AFrameworkApplication.K.rc("WordEditorGraphMergeBackupCasesBrowser",0):0);return Q}xAa(){return(new Date).getTime()}Y6i(Q,
...wa){return String.format.apply(null,[Q].concat(wa))}d6n(Q){throw Wk.a.invalidOperation(Q);}tEd(Q){return String.format("Name: {0}, Message: {1}, Stack: {2}",Q.name,Q.message,Q.stack)}o5m(Q){if(this.mwa&&this.mwa.Dgi||!this.f2n(Q))return null;this.Twm(Q);let wa;({Mfk:Lb,J5n:ec,cto:wa}=this.sLk(Q,this.Kth));const eb=Ud.a.yrl(Q);var Lb=rc.construct(this.AR(),Lb.Eva(),ec.Eva(),wa.Eva(),Q.input.q4b,Q.input.G2,Q.input.Zl,Q.input.SEb,Q.input.source,eb,this.NFa.Iua);var ec=Q.output.QL;3===eb&&0<ec.length&&
(Lb.MergedRevision=this.Kth(Q.output.QL.last()));return Lb}FDc(Q,wa){return(new Gg(Q)).FDc(wa)}EDc(Q,wa,eb,Lb){return(new Gg(Q)).EDc(wa,eb,Lb)}}Object(f.a)(Si,"GraphMerger",Ud.a,[]);class li extends Si{constructor(Q,wa=null,eb=null){super(Q,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,wa,eb);this.sa=new l.a}get Iua(){return this.NFa?this.NFa.Iua:0}get delayedMergeOperation(){return null}set delayedMergeOperation(Q){}d6j(Q){this.sa.addHandler(li.jif,Q)}Gpn(Q){this.sa.removeHandler(li.jif,
Q)}bZf(){return!1}S8b(Q,wa,eb,Lb,ec,Tc,Ad){(Q=super.S8b(Q,wa,eb,Lb,ec,Tc,Ad))&&this.sa.raiseEvent(li.jif,new zm(Q));return Q}}li.jif="GMC";Object(f.a)(li,"WordEditorGraphMerger",Si,[1814,1340,1341]);class Xl{constructor(){this.W=null}get name(){return"WordEditor.GraphMerge"}zc(Q){this.W=Q;this.W.ha("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",()=>new Jn(this.W.Za("WordEditor.IBusinessBarController"),new kb.a(()=>Q.Pa("Box4.IFeatureHelper")))).as("Box4.IGraphMergeCollectionConsentManager").singleInstance();
this.W.ha("WordEditor.GraphMerge.GraphMergeBackupThrottler",()=>new Vi(this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IGraphMergeBackupThrottler").singleInstance();this.W.ha("WordEditor.GraphMerge.WordEditorGraphMerger",()=>new li(()=>H.AFrameworkApplication.rootQuerySignature,this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IWordEditorGraphMerger").singleInstance();
this.W.ha("WordEditor.GraphMerge.GraphMergeBackupManager",()=>new Rg(()=>H.AFrameworkApplication.rootQuerySignature,H.AFrameworkApplication.ya,this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger"),this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("Box4.IGraphMergeBackupManager").singleInstance()}init(){qe.App.SQ||(qe.App.SQ=lk.a.Dda());const Q=this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger");qe.App.SQ.Fgk(Q);
this.W.resolve("Box4.IGraphMergeBackupManager")}dispose(){let Q=this.W.Pa("Box4.IGraphMergeBackupManager");Q&&Q.dispose()}}Object(f.a)(Xl,"GraphMergePackage",null,[1,2]);var Wn=d(164);class Wj{constructor(Q){this.hSb=0;this.hh=Q}yvh(Q){this.hSb=Math.max(0,--this.hSb);this.XNi(Q);0<this.hSb&&window.setTimeout(()=>{this.yvh(Q)},1E3)}XNi(Q){Q.style.backgroundColor="rgba(255,0,0,"+Math.min(1,this.hSb/20)+")"}drn(Q){this.hh&&this.hh.$_m&&(this.hSb++,this.XNi(Q),this.hh.fti=Ci.a.G$e(Q,!1),1===this.hSb&&
window.setTimeout(()=>{this.yvh(Q)},1E3))}}Object(f.a)(Wj,"ParagraphRenderVisualizationManager",null,[1817]);class xl{constructor(Q,wa,eb,Lb,ec){this.Ktc=this.Z7c=this.owc=this.hh=null;this.oke=new ha.a;this.Mtc=null;this.PQg=0;this.qzi=(Tc,Ad)=>{this.owc&&(this.owc.innerText=Ad.vJm+" CPM")};this.GFb=(Tc,Ad)=>{this.Z7c&&(this.Z7c.innerText=Ad.IRc.CP+"%",this.oke.add(Ad.IRc.CP))};this.showTaskPane=()=>{if(!qe.App.xa.glb)return 16;this.hh||this.Qwd();this.fP.showTaskPane(this.hh);this.hh.element.style.overflow=
"scroll";return 32};this.MVk=()=>{const Tc=ia.a.ym("","LogFile","","InteractivePerf.DisplayCpuPercentLogs").document;Tc.writeln("<HEAD>");Tc.writeln('<STYLE type="text/css">');Tc.writeln("* { padding: 0px; margin: 0px; font-family: monospace; }");Tc.writeln("</STYLE>");Tc.writeln("</HEAD>");Tc.writeln("<BODY style='BACKGROUND-COLOR: #f3f8fd;'>");const Ad=document.createElement("div");var we=document.createElement("div");we.innerText=String.format("{0}, {1}","Frame","CpuPercent");Ad.appendChild(we);
for(we=0;we<this.oke.count;we++){const Rd=this.Cjk(we,this.oke.J(we));Rd&&Ad.appendChild(Rd)}Tc.writeln(Ad.innerHTML);Tc.writeln("</BODY>");Tc.close();return!0};this.ga=Q;this.fP=wa;this.gg=eb;this.Cqa=Lb;this.gyg=ec}get $_m(){return this.Ktc?this.Ktc.checked:!1}get fti(){return this.PQg}set fti(Q){this.Mtc&&(this.Mtc.innerText=String.format("Total number of child elements in last rendered paragraph: {0}",Q));this.PQg=Q}Vb(){this.ga.pa(mf.a.orh,th.a.application,this.showTaskPane)}dispose(){null!==
this.hh&&(this.fP.Qxb(xl.gy,this.hh),this.hh=null);this.Cqa.execute(Q=>{this.MDh(Q,wa=>{wa.Ypn(this.qzi)})});this.gyg.execute(Q=>{this.LDh(Q,wa=>{wa.lRf(this.GFb)})})}Qwd(){const Q=new $b.CuiHelper(Wn.a.U$a,Box4Intl.Box4Strings);this.hh=this.fP.B_e(xl.gy,0,xl.width,"InteractivePerfTaskPaneData",Q);this.AFk();this.xFk();this.zFk()}Xcf(Q){Q=document.getElementById(Q);return Ci.a.pzb(Ci.a.pzb(Q,"cui-groupContainer"),"cui-groupBody")}LDh(Q,wa){const eb=Q.er.task;eb.continueWith(()=>{wa(eb.result)})}MDh(Q,
wa){const eb=Q.er.task;eb.continueWith(()=>{wa(eb.result)})}AFk(){const Q=this.Xcf("TypingSpeedMeterGroup");Q.style.margin="10px";Q.style.fontSize="15px";const wa=document.createElement("div");wa.innerText="Typing Speed";this.owc=document.createElement("div");this.owc.innerText="0 CPM";this.Cqa.execute(eb=>{this.MDh(eb,Lb=>{Lb.U6j(this.qzi)})});Q.appendChild(wa);Q.appendChild(this.owc)}xFk(){const Q=this.Xcf("CpuMeterGroup");Q.style.margin="10px";Q.style.fontSize="15px";const wa=document.createElement("div");
wa.innerText="CPU Meter";this.Z7c=document.createElement("div");this.gyg.execute(ec=>{this.LDh(ec,Tc=>{Tc.fqd(this.GFb)})});const eb=document.createElement("div"),Lb=document.createElement("button");Lb.innerText="View Cpu Percent";this.gg.mb(B.a.click,Lb,this.MVk);eb.appendChild(Lb);Q.appendChild(wa);Q.appendChild(this.Z7c);Q.appendChild(eb)}zFk(){const Q=this.Xcf("RenderGroup"),wa=document.createElement("label");wa.innerText="Enable render visualizations";this.Ktc=document.createElement("input");
this.Ktc.setAttribute("type","checkbox");Q.appendChild(this.Ktc);Q.appendChild(wa);this.Mtc=document.createElement("div");this.Mtc.style.margin="10px";Q.appendChild(this.Mtc);ea.a.instance.ha("Box4.IParagraphRenderVisualizationManager",()=>new Wj(this))}Cjk(Q,wa){Q=Q.toString();wa=wa.toString();const eb=document.createElement("div");eb.innerText=String.format("{0}, {1}",Q,wa);return eb}}xl.gy="InteractivePerfTaskPane";xl.width=400;Object(f.a)(xl,"InteractivePerfTaskPane",null,[]);class pp{constructor(){this.hh=
null}get name(){return"WordEditor.InteractivePerfTaskPane"}zc(Q){Q.ha("WordEditor.InteractivePerfTaskPane.InteractivePerfTaskPane",()=>new xl(H.AFrameworkApplication.ya,ui.a.instance,H.AFrameworkApplication.ua.Zy,Q.Za("Common.ITypingSpeedMeterProvider"),Q.Za("Common.ICpuMeterProvider"))).singleInstance()}init(){if(this.hh=ea.a.instance.Pa("WordEditor.InteractivePerfTaskPane.InteractivePerfTaskPane"))this.hh.Vb(),"1"===Wb.a.jT(document.URL,"wdShowIPerfTaskPane")&&H.AFrameworkApplication.ya.processAction(mf.a.orh,
2)}dispose(){this.hh&&(this.hh.dispose(),this.hh=null)}static main(){ca.a.instance.Pc(new pp)}}Object(f.a)(pp,"InteractivePerfTaskPanePackageManager",null,[1,2]);var gh=d(302);class Nk{constructor(Q){this.nje="FontPicker";this.gte=null;this.L4a=Q;this.d$c=this.L4a.Rua(gh.a.$Db,Object(a.a)(this,this.Dyb,"featureStateChangeCallback"));this.L4a.isFeatureEnabled(gh.a.$Db,!1).then(wa=>{this.gte=wa})}get isLicensed(){return this.gte}Dyb(Q){this.gte=Q.isEnabled;Q=appChrome.actions.updateFontPickerLicenseState(this.nje,
Q.isEnabled);appChrome.api.dispatch(Q)}dispose(){this.L4a.zbc(gh.a.$Db,this.d$c)}}Object(f.a)(Nk,"ModernFontPickerFeatureHelper",null,[931,10]);var Eq=d(497),el=d(644),Pl=d(1605);class uo{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(f.a)(uo,"FontInfoTaskPaneProps",null,[]);class dm{constructor(Q,wa,eb,Lb=null){this.HJe=this.VU=this.d$c=null;this._state=this.sRb=0;this.hwe=
Q;this.L4a=wa;this.hvj=eb;this.Wb=Lb}get Ac(){return this.hwe.value}initialize(){this.Ac.pa(Na.a.uSf,Aa.a.frame,Object(a.a)(this,this.uSf,"requestFontInfo"));this.d$c=this.L4a.Rua(gh.a.$Db,Object(a.a)(this,this.Dyb,"featureStateChangeCallback"));this.Aga()}mO(Q=!1){const wa=bj.UISurfaces.Xt(),eb=this.L4a.isFeatureEnabled(gh.a.$Db,!1),Lb=[];Lb.push(wa);Lb.push(eb);Promise.all(Lb).then(ec=>{ec[0].showTaskPane(Pl.a.Yyb,this.nB(ec[1]));Q&&this.uK()})}uio(Q){bj.UISurfaces.Xt().then(wa=>{wa.updateTaskPane(Pl.a.Yyb,
this.nB(Q));return null})}Dyb(Q){this.uio(Q.isEnabled)}uSf(Q,wa,eb,Lb,ec){this.VU=ec.CommandValueId;this.HJe=ec.Trigger;this.sRb=ec.InputMethod;this.mO(2===this._state&&1===this.sRb);return 32}nB(Q){const wa=new uo;wa.onUpsellButtonClicked=Object(a.a)(this,this.onUpsellButtonClicked,"onUpsellButtonClicked");wa.fontName=this.VU;wa.isLicensed=Q;wa.trigger=this.HJe;wa.helpArticleUrl=this.oBk();wa.paneId=Pl.a.Yyb;Q=this.c0l();Q.contentProps=wa;return Q}c0l(){return Object.assign(new Vj.a,{title:Pl.a.oib,
hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(a.a)(this,this.onOpen,"onOpen"),onClose:Object(a.a)(this,this.onClose,"onClose"),onShow:Object(a.a)(this,this.onShow,"onShow"),onHide:Object(a.a)(this,this.onHide,"onHide")})}Aga(){if(this.Wb){var Q=this.Wb.pe(Pl.a.Yyb);Q.parent=ye.AFrame.Lp;Q.LL=!0}}onOpen(){this._state=2;this.uK()}onShow(Q){0!==this._state&&(this._state=2,1===Q&&(this.sRb=Q),this.uK())}onClose(){this.sRb=this._state=
0;this.blur()}onHide(){this._state=1;this.sRb=0}uK(){this.Wb&&1===this.sRb&&this.Wb.Jg(Pl.a.Yyb)}blur(){this.Wb&&this.Wb.xg&&this.Wb.xg.name===Pl.a.Yyb&&this.Wb.Jg(this.Wb.AS)}onUpsellButtonClicked(){this.L4a.launchUpsellExperience(Pl.a.experienceId)}dispose(){this.L4a.zbc(gh.a.$Db,this.d$c)}oBk(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.hvj,this.qsl(),"WDWAENDUSER",H.AFrameworkApplication.lcid)}qsl(){switch(this.HJe){case "missing":return"hlpFontInfoMissingFont";
case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return dm.ejk(this.VU)}static ejk(Q){let wa="hlpFontInfo";for(let eb=0;eb<Q.length;++eb){const Lb=Vb.a.charAt(Q,eb);if(255<Q.charCodeAt(eb)||Vb.a.sMd(Lb))wa+=Lb}return wa}}Object(f.a)(dm,"FontInfoPane",null,[930,10]);class qp extends dm{constructor(Q,wa,eb,Lb,ec){super(Q,wa,Lb.lb("FontInfoHelpBaseUrl"),ec);this.fP=eb}mO(Q){this.VY();super.mO(Q)}Dyb(Q){super.Dyb(Q);
qe.App.xa.updateCommandUI()}VY(){this.fP.PJa()}}Object(f.a)(qp,"WordEditorFontInfoPane",dm,[]);class Xr{constructor(){this.QPb=this.gfd=this.fnc=this.W=null}get name(){return"WordEditor.ModernFontPicker"}zc(Q){this.W=Q;Q.ha("Common.ModernFontPicker.IModernFontPickerFeatureHelper",()=>new Nk(this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).singleInstance();Q.ha("Common.ModernFontPicker.IFontInfoPane",()=>new qp(new kb.a(()=>H.AFrameworkApplication.ya),this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
ui.a.instance,H.AFrameworkApplication.K,ai.FocusManager.instance())).singleInstance()}init(){this.gfd=this.W.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper");this.fnc=this.W.resolve("Common.ModernFontPicker.IFontInfoPane");this.fnc.initialize();H.AFrameworkApplication.K.$("IsAnonymousUser")||((this.QPb=this.W.Pa(el.a))?this.QPb.initialize():ja.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));qe.App.xa.updateCommandUI()}dispose(){this.fnc&&(this.fnc.dispose(),
this.fnc=null);this.gfd&&(this.gfd.dispose(),this.gfd=null);this.QPb&&(this.QPb.gAc(),this.QPb=null)}static main(){Object(Eq.a)()&&ca.a.instance.Pc(new Xr)}}Object(f.a)(Xr,"ModernFontPickerPackage",null,[1,2]);var km=d(128),Um=d(6),xf=d(278),Ap=d(41),Ok=d(20),Li=d(1063);class Gk{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we,Rd,yf,rg,vi=null){this.UX=eb;this.Xc=Q;this.Hc=wa;this.Kh=ec;this.xFa=Tc;this.$X=Ad;this.Svg=we;this.Rvg=Rd;this.hx=yf;this.Byj=vi||Gk.iw}get vh(){return this.hx?this.hx.vh:!1}Z6h(Q){return this.uBa(Q,
0)}a3l(Q){return this.uBa(Q,1)}uBa(Q,wa){let eb=null;if(this.vh&&this.$X&&(this.Rvg.instance&&this.Rvg.instance.GEa(Q),wa?1===wa&&(eb=this.$X.GSh(Q.node)):eb=this.$X.jbf(Q.node,Q.cpBegin,Q.Fb),eb&&!eb.ia(Lk.a.o6,!1)))return ja.ULS.shipAssertTag(24749379,368,!1,"Try to insert page break to inconvertible inline content control"),2;const Lb=Um.GraphIterator.nW(this.Xc.Ck());Lb.set(Q.node);Lb.Bb(10);const ec=this.Hc.Rc(15);ec.Ju(Lb);wa?Ap.OutlineElementNavigator.ae(Lb):(this.splitParagraph(Lb,Q),this.UX.xgc(Q.node,
pg.a.Ks));Q=Qj.ParagraphReader.Ym(Lb.currentNode);this.l4l(Lb);this.vh&&eb&&this.Svg&&(wa=new ha.a,wa.add(Lb.currentNode),this.Svg.W5g(wa,eb.id));this.YIn(Q);ec.dispose();return 32}YIn(Q){Q=uh.SelectionFactory.xe(Q,0);ue.a.instance.setSelection(Q)}l4l(Q){this.Kh.XC(Q,!0,!0,null,!1,!1);Q=Ap.OutlineElementNavigator.He(Q);this.b3l(Q)}splitParagraph(Q,wa){const eb=Ap.OutlineElementNavigator.ae(Q);if(wa.cpBegin||this.vh&&(!this.vh||-1!==wa.Fb)){Ok.a.instance.J(4)&&qe.App.rd.Kp&&wa.cpBegin!==Qj.ParagraphReader.textLength(wa.node)&&
qe.App.rd.Jq.sG(wa.node);this.Kh.XC(Q,!1,!0,null,!1,!0);var Lb=Um.GraphIterator.nW(this.Xc.Ck());Lb.set(eb);this.Kh.dba(Lb,Q,wa,!0,!0,!0)}}b3l(Q){Q=this.Byj(Q);this.xFa.v7h(Q)}static YD(){return new Gk(new Se.a,new Ae.a,ea.a.instance.resolve("Box4.IAutoCorrectScheduler"),Li.a.instance,ea.a.instance.resolve("Box4.IOutlineElementEditor"),ea.a.instance.resolve("Box4.IBlobEditor"),ea.a.instance.Pa("Box4.IContentControlReader"),ea.a.instance.Pa("Box4.IContentControlEditor"),ea.a.instance.Za("Box4.IContentControlConverter"),
ea.a.instance.Pa("Box4.ContentControlConfigSettings"),ea.a.instance.resolve("Box4.List.IListReader"))}static get instance(){return null!=Gk.clg?Gk.clg:Gk.clg=Gk.YD()}static iw(Q){return Zp.a.iw(Q)}}Object(f.a)(Gk,"PageBreakInserter",null,[1844]);class ah{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we){this.o4l=(Rd,yf,rg,vi)=>{var Rk=yf.view,Ij=Rk.Cb.Rg;if(!Ij)return 2;if(!this.RUe(yf))return 8;if(1===rg)return 32;let Sl=!0;rg=8;const hk=this.mue(Ij);Ij=this.Hc.Rc(15);Ij.Db(Rk.ud);Ij.zl=Rd;hk||(rg=this.ga.Qf(yf,
jg.a.hka,2,!0,vi,null),Rd=32===rg,ja.ULS.shipAssertTag(4208012,314,Rd),Sl=Rd);Sl&&(Rk=Rk.Cb.Rg,Rd=this.mue(Rk),ja.ULS.shipAssertTag(4208013,314,Rd,"{0}",{["ContextId"]:yf.contextId}),rg=8,Rd&&(rg=this.Rre.Z6h(Rk),ja.ULS.shipAssertTag(4208014,314,32===rg)));Ij.dispose();32===rg&&this.Hd.us(10);return rg};this.n4l=(Rd,yf,rg)=>{if(!yf||yf.contextId!==th.a.Wc)return 8;if(1===rg)return yf.contextId===th.a.Wc?32:8;if(2===rg){if(!this.RUe(yf))return 8;Rd=this.Rre.Z6h(yf);32===Rd&&this.Hd.us(10);return Rd}return 32};
this.m4l=(Rd,yf,rg)=>{if(!yf||yf.contextId!==th.a.table)return 8;if(1===rg)return 32;if(2===rg){if(!this.RUe(yf))return 8;Rd=this.Rre.a3l(yf);32===Rd&&this.Hd.us(10);return Rd}return 32};this.ga=Q;this.Rre=wa;this.Hc=eb;this.Cm=Lb;this.mue=ec;this.Ok=Tc;this.EHj=Ad;this.Hd=we}Vb(){this.ga.pa(mf.a.uBa,th.a.view,this.o4l);this.ga.pa(mf.a.uBa,th.a.Wc,this.n4l);this.ga.pa(mf.a.uBa,th.a.table,this.m4l);this.ga.Vc(mf.a.uBa,4)}c3(){const Q=ai.FocusManager.instance().pe(km.AppFrame.iF);ye.AFrame.pi(Q,Wd.KeyInputManager.mc(pg.a.Ks,
Wd.KeyInputManager.Mh),mf.a.uBa)}qdm(Q){return this.Tw(Q.iterator)}Vgm(Q){Q=Q.J(0);const wa=Wg.SelectionEditor.ak(Q,!0,!1);if(this.Tw(wa.Qa.iterator))return!0;Q=Wg.SelectionEditor.ak(Q,!1,!1);return this.Tw(Q.Qa.iterator)}Tw(Q){return Q.Bb(14)}RUe(Q){let wa=null,eb=Q;if(eb.contextId===th.a.view){wa=eb.view;if(!wa.features.$1f)return!1;eb=wa.Cb.Rg;if(!eb)return!1}else{const Lb=Um.GraphIterator.$a(eb.node);if(Lb.Bb(36)||Lb.Bb(38)||Lb.Bb(40)||Lb.Bb(14))return!1}return xf.a.Jla(Q)?!1:eb.contextId===th.a.table?
this.Ok.bdm(eb.node):!this.Ok.$cm(eb)||this.Cm&&this.Cm.instance&&this.Cm.instance.vT(eb)?!1:((Q=this.mue(eb))?this.qdm(eb):this.Vgm(wa.Cb.ib))||Q&&this.EHj(eb,!0)?!1:!0}static YD(){return new ah(H.AFrameworkApplication.ya,Gk.instance,new Ae.a,ea.a.instance.Za("Box4.IExternalSelectionManager"),Wg.SelectionEditor.xf,Bf.a.instance,Ym.HyperlinkReader.Lla,ea.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get instance(){return null!=ah.Wjg?ah.Wjg:ah.Wjg=ah.YD()}}Object(f.a)(ah,
"PageBreakActor",null,[1815]);class gr{constructor(){this.pAe=this.W=null}get name(){return"WordEditor.PageBreak"}zc(Q){this.W=Q}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Nm()})}Nm(){this.pAe=ah.instance;this.pAe.Vb();this.pAe.c3();qe.App.xa.updateCommandUI()}dispose(){}}Object(f.a)(gr,"PackageManager",null,[1,2]);var Yr=d(1446),Mo=d(1447),sn=d(233),Hf=d(167),ag=d(260),Bp=d(293),Cp=d(465);class No{constructor(Q,wa,eb,Lb,ec,Tc,Ad){this.Srb=null;this.sa=new l.a;this.Ike=
1;this.Xdd=-1;this.VSa=null;this.Cma=()=>{this.ETe()};this.hb=wa;this.Hb=eb;this.d9c=Lb;this.AH=ec;this.Yz=Tc;this.U8=Ad;this.enable()}get xCc(){return this.Ike}q_i(Q){this.Ike!==Q&&(this.Ike=Q,this.sa.raiseEvent("X"),this.$qf&&this.n7f())}get $qf(){const Q=ea.a.instance.Pa("WordEditor.Pagination.IPageEndMarkers");return Q?Q.$qf:!0}get gf(){return this.AH.value}get ej(){return Za.a.instance}f5j(Q){this.sa.addHandler("X",Q)}n7f(){this.ej.Pd(()=>{this.U8.FQ(Cp.a.SAi)},"CPC:UPN")}enable(){this.hb.OD(this.Cma);
this.ETe()}ETe(){if(!this.VSa||1>=this.VSa.count)this.q_i(1);else{var Q=this.hb.ib.kb;if(Q){var wa=Q.Wf?Q.Tc:Q.Qa;!wa||0>wa.cpBegin||(Q=wa.node)&&Qj.ParagraphReader.oc(Q)&&this.Kcm(Q)&&(this.Srb&&(this.Hb.ef(this.Srb),this.Srb=null),this.Srb=new Yb.a(2,1,400,eb=>{this.findCurrentPageFromIp(eb,wa)},62),this.Hb.$b(this.Srb))}}}Kcm(Q){Q=Um.GraphIterator.$a(Q);return Q.Bb(35)||Q.Bb(37)||Q.Bb(39)?!1:!0}igj(Q){this.VSa=Q;this.Pej()}Pej(){if(-1!==this.Xdd){var Q=this.Y6k(this.Xdd);-1!==Q&&this.q_i(Q)}}findCurrentPageFromIp(Q,
wa){this.Srb===Q&&(this.Srb=null,this.Xdd=this.fel(wa),-1!==this.Xdd&&this.Pej())}Y6k(Q){if(!this.VSa)return-1;for(let wa=0;wa<this.VSa.count;wa++){const eb=this.VSa.J(wa);if(Q>eb.O4g&&Q<eb.O4g+eb.height)return eb.yj}return-1}fel(Q){var wa=this.nBl(Q);if(!wa||!wa.htmlElement)return-1;const eb=wa.getBounds();Q=this.Oll(Q,wa);if(!Q)return-1;wa=ia.a.hYa(this.d9c.E0a,wa.htmlElement).y;return Q.y+Math.floor(Q.height/2)-eb.y+wa}nBl(Q){return Q.node.De(this.gf.Tb)}Oll(Q,wa){Q=this.Yz?this.Yz.Ada(Q,!0):Q.cpBegin;
return Bp.a.qq(wa,Q)}disable(){this.hb.ega(this.Cma)}}Object(f.a)(No,"CurrentPageCalculator",null,[1991,1986]);class rp{constructor(Q){rp.hY=Q}get j0e(){return rp.hY}get xCc(){return this.j0e.xCc}r_k(){this.j0e.enable()}zUk(){this.j0e.disable()}}rp.hY=null;Object(f.a)(rp,"CurrentPageManager",null,[1990]);var sq=d(110);class hr extends Sys.EventArgs{constructor(Q,wa){super();this.Gri=wa}}Object(f.a)(hr,"DocumentBottomChangeEventArgs",Sys.EventArgs,[]);class Ql extends Sys.EventArgs{constructor(Q,wa,
eb){super();this.delta=Q;this.Gri=eb}}Object(f.a)(Ql,"PageContentSizeChangeEventArgs",Sys.EventArgs,[]);class mj{constructor(Q,wa,eb){this.UUg=this.Xhd=-1;this.rsc=null;this.sa=new l.a;this.uye=!1;this.h_m=(Lb,ec)=>{this.uye=this.nsk();ec.hib||this.Jmc.value.measure(this.isk)};this.isk=()=>{const Lb=this.E0a.clientHeight;this.hsk(Lb);this.qsk(Lb)};this.eIf=(Lb,ec)=>{ec.property===sq.a.bI&&(Lb=ec.node)&&Lb.ia(sq.a.bI,!1)&&(Lb=Lb.De(this.gf.Tb))&&(Lb=Lb.htmlElement)&&this.SSa.add(Lb)};this.AH=Q;this.Jmc=
wa;this.SSa=new ha.a;this.gf.C8g(this.h_m);this.dkf();this.kaa=this.kaa.bind(this);eb.Qub(this.kaa)}get gf(){return this.AH.value}kaa(){this.rsc=null}get E0a(){this.rsc||(this.rsc=this.gf.ud.De(this.gf.Tb).E0a,ja.ULS.shipAssertTag(34136386,336,!!this.rsc));return this.rsc}q6j(Q){this.sa.addHandler("OnPageContentSizeChangeKey",Q)}hsk(Q){Q!==this.UUg&&(this.sa.raiseEvent("OnDocumentBottomChangeKey",new hr(Q,this.uye)),this.UUg=Q)}qsk(Q){Q!==this.Xhd&&(-1!==this.Xhd&&this.sa.raiseEvent("OnPageContentSizeChangeKey",
new Ql(Q-this.Xhd,Q,this.uye)),this.Xhd=this.E0a.clientHeight)}nsk(){let Q=!1;for(let wa=this.SSa.count-1;0<=wa;wa--)this.SSa.J(wa).hasChildNodes()&&(this.SSa.removeAt(wa),Q=!0);return Q}dkf(){qe.App.Wj.al.Te(23).jp(this.eIf)}}Object(f.a)(mj,"DocumentSizeManager",null,[]);var lm=d(58),Xn=d(261);class Hk{constructor(Q){this.AH=Q}get gf(){const Q=this.AH.value;ja.ULS.shipAssertTag(37820298,336,Q.Ji,"OutlineManager.PageView is not a PageView.");return Q}Q5d(Q,wa){const eb=lm.a.Ni(Hk.Sg.oA(Q),1);wa+=
eb;Q.De(this.gf.Tb).htmlElement.firstChild.style.minHeight=wa+"px"}rPh(){const Q=Um.GraphIterator.$a(this.gf.ud);Q.qo();Q.Wd();ja.ULS.shipAssertTag(37820299,336,10===Q.xn.type);return Q.xn}VRh(){const Q=Um.GraphIterator.$a(this.gf.ud);Q.qo();Q.n$();ja.ULS.shipAssertTag(37820300,336,10===Q.xn.type);return Q.xn}$Cl(Q){const wa=Um.GraphIterator.$a(this.gf.ud);wa.qo();wa.Wd();let eb=wa.xn,Lb=null;for(;Q!==eb&&wa.xj();)Lb=eb,eb=wa.xn;ja.ULS.shipAssertTag(37820301,336,10===wa.xn.type);return Lb}static get Sg(){return Xn.a.instance}}
Object(f.a)(Hk,"OutlineManager",null,[1988]);class jh{constructor(Q){this.qxa=0;this.b0=null;this.IZf=wa=>{for(let eb of wa.customData)this.showAdornmentText(eb)};this.Hb=Q}HXd(){this.b0||(this.b0=this.eCc())}hud(){this.b0&&0<jh.BGc(this.b0).length&&this.Hb.$b(this.b0);this.b0=null}eCc(){return Object.assign(new Yb.a(3,1,250,this.IZf,166),{customData:[]})}cXf(Q){this.qxa=Q}D_c(Q){if(Q){Q.style.width=this.qxa+"px";if(this.b0)var wa=this.b0;else wa=this.eCc(),this.Hb.$b(wa);jh.BGc(wa).push(Q)}}jKc(Q){Q&&
(Q.style.width="0px",this.Kjf(Q))}w2c(Q,wa){wa?this.D_c(Q):this.jKc(Q)}showAdornmentText(Q){Q.style.width===this.qxa+"px"&&(this.MGc(Q).style.visibility="visible")}Kjf(Q){Q&&(this.MGc(Q).style.visibility="hidden")}MGc(Q){Q=Q.childNodes;ja.ULS.shipAssertTag(24958351,336,1===Q.length,"Expected 1 child div in the page adornment, found "+Q.length);return Q[0]}static BGc(Q){return Q.customData}}Object(f.a)(jh,"PageAdornmentAnimationManager",null,[1989]);class Km{constructor(Q){this.Nl=Q;this.y8=new pb.a;
this.z8=new pb.a}eza(Q){Q=Um.GraphIterator.$a(Q);if(Q.qo()&&Q.Hp()){Q.Wd();do 10===Q.Se&&this.xKf(Q.currentNode),Q.zu();while(8!==Q.Se)}}DJb(Q){const wa=Q.yj;var eb=this.tAb(Q.VKb);if(!this.y8.xb(eb))return ja.ULS.sendTraceTag(24958352,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+eb),!1;Q=this.y8.J(eb);ja.ULS.shipAssertTag(24958353,336,this.z8.xb(eb),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");
eb=this.z8.J(eb);return this.Fjf(Q,wa,eb)}CJb(Q){const wa=Q.yj;var eb=this.tAb(Q.VKb);if(!this.y8.xb(eb))return ja.ULS.sendTraceTag(24958354,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+eb),!1;Q=this.y8.J(eb);ja.ULS.shipAssertTag(24958355,336,this.z8.xb(eb),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");eb=this.z8.J(eb);return this.U8e(Q,wa,eb)}Wgf(Q){if(!Q)return ja.ULS.sendTraceTag(24979136,
336,10,"Null container input into GetTemplateSelectionFromContainer."),0;var wa=Q.Yrd;if(!wa)return ja.ULS.sendTraceTag(24979137,336,10,String.format("Container of page number {0} has a null EndSectionNode.",Q.yj)),0;wa=this.Nl.Lzb(wa);if(!wa)return ja.ULS.sendTraceTag(24979138,336,10,"Header footer container node expected not to be null."),0;wa=this.Nl.gla(wa);const eb=1===Q.yj;Q=!(Q.yj%2);return 1===wa?1:2===wa?eb?2:1:3===wa?Q?3:4:eb?2:Q?3:4}xKf(Q){if(10===Q.type){var wa=new pb.a,eb=this.Nl.Lzb(Q);
ja.ULS.shipAssertTag(24958356,336,!!eb,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var Lb=this.Nl.gla(eb);Q=this.tAb(Q);this.A7f(Q,Lb);this.z7f(Q,wa);eb=Um.GraphIterator.$a(eb);if(eb.Hp()){eb.Wd();do Q=eb.currentNode,Lb=this.Nl.SEd(Q),Q=this.Nl.e3h(Q),wa.add(Lb,Q),eb.zu();while(36===eb.Se)}}}A7f(Q,wa){this.z8.xb(Q)?this.z8.Z(Q,wa):this.z8.add(Q,wa)}z7f(Q,wa){this.y8.xb(Q)?this.y8.Z(Q,wa):this.y8.add(Q,wa)}tAb(Q){ja.ULS.shipAssertTag(24958358,
336,10===Q.type,"Expected node of type Outline but received node of type "+Q.type);return Q.ia(Lk.a.nga,0)}Fjf(Q,wa,eb){const Lb=1===wa;wa=!(wa%2);switch(eb){case 2:if(Lb){if(Q.xb(2))return Q.J(2)}else if(Q.xb(0))return Q.J(0);break;case 3:if(wa){if(Q.xb(1))return Q.J(1)}else if(Q.xb(0))return Q.J(0);break;case 4:if(Lb){if(Q.xb(2))return Q.J(2)}else if(wa){if(Q.xb(1))return Q.J(1)}else if(Q.xb(0))return Q.J(0);break;case 1:if(Q.xb(0))return Q.J(0)}return!1}U8e(Q,wa,eb){const Lb=1===wa;wa=!(wa%2);
switch(eb){case 2:if(Lb){if(Q.xb(5))return Q.J(5)}else if(Q.xb(3))return Q.J(3);break;case 3:if(wa){if(Q.xb(4))return Q.J(4)}else if(Q.xb(3))return Q.J(3);break;case 4:if(Lb){if(Q.xb(5))return Q.J(5)}else if(wa){if(Q.xb(4))return Q.J(4)}else if(Q.xb(3))return Q.J(3);break;case 1:if(Q.xb(3))return Q.J(3)}return!1}}Object(f.a)(Km,"PageAdornmentContentManager",null,[1987]);var tq=d(1124);class Lm{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we,Rd){this.G8f(Q,wa,eb,Tc,Ad,we,Rd);this.yj=Q;this.oq=wa;this.Yq=eb;this.VKb=
Lb;this.Yrd=ec;this.Bab=Tc;this.V3b=Ad;this.h1b=we;this.iBi=Rd}get top(){return this.oq}get height(){return this.Yq}UZc(Q){this.oq!==Q&&(this.Bab.style.top=Q+"px",this.oq=Q)}IWf(Q){this.height!==Q&&(this.Bab.style.height=Q+"px",this.Yq=Q)}G8f(Q,wa,eb,Lb,ec,Tc,Ad){ja.ULS.shipAssertTag(37244961,336,0<Q,"PageAdornmentContainer: pageNumber parameter value {0} is unexpected value.",Q);ja.ULS.shipAssertTag(37244962,336,0<=wa,"PageAdornmentContainer: top parameter value {0} is unexpected value.",wa);ja.ULS.shipAssertTag(37244963,
336,0<=eb,"PageAdornmentContainer: height parameter value {0} is unexpected value.",eb,wa);ja.ULS.shipAssertTag(37244992,336,!!Lb,"PageAdornmentContainer: containerDomElement parameter is null.");ja.ULS.shipAssertTag(37244993,336,!!ec,"PageAdornmentContainer: headerLabelDomElement parameter is null.");ja.ULS.shipAssertTag(37244994,336,!!Tc,"PageAdornmentContainer: footerLabelDomElement parameter is null.");ja.ULS.shipAssertTag(37244995,336,!!Ad,"PageAdornmentContainer: pageNumberLabelDomElement parameter is null.")}}
Object(f.a)(Lm,"PageAdornmentContainer",null,[2008]);class mm{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we,Rd,yf,rg,vi,Rk){this.QFg="headerFooterTab";this.Bmd=null;this.ou=!0;this.iqe=0;this.Cve=null;this.HYa=!1;this.OFb=Ij=>{this.zMm(Ij.Bv);return!0};this.fD=()=>!0;this.eBb=()=>{this.GYe()&&(this.HYa=!1,this.Udo(),this.Cve=new Date)};this.QFb=Ij=>{this.HYa||this.CU.D_c(Ij.Bv);return!0};this.PFb=Ij=>{this.HYa||(Ij=Ij.Bv,this.rZf(Ij)||this.CU.jKc(Ij));return!0};this.Lin=()=>{let Ij=Array.dequeue(this.YCe);for(;Ij;)this.bU(Ij),
Ij=Array.dequeue(this.YCe);this.Bmd=null};this.AH=Q;this.gg=wa;this.xD=eb;this.uha=Lb;this.ga=ec;this.Kj=Tc;this.CU=Ad;this.Dwa=we;this.OGa=Rd;this.Hb=yf;this.Ma=rg;this.YCe=[];this.Z_=new Map;this.yH=vi;this.Dw=Rk;this.OGa.gqd(this.eBb);this.$v=!!H.AFrameworkApplication.ua&&H.AFrameworkApplication.ua.Sb.u6;if(this.wcd=(this.cse=!!this.Ma&&this.Ma.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&!!this.Ma&&this.Ma.$("DisableHeaderFooterTabForSmallScreenModeIsEnabled"))"Small"===qe.App.xa.tu.getLayoutBreakpoint()&&
(this.ou=!1),qe.App.xa.tu.registerLayoutBreakpointChanged(this.QFg,Ij=>{switch(Ij){case "Small":this.A3h();break;default:this.u3i()}})}get gf(){return this.AH.value}u3i(){try{this.LVn()}catch(Q){ja.ULS.shipAssertTag(37244997,336,!1,"Exception was caught in ShowPageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}A3h(){try{this.jWl()}catch(Q){ja.ULS.shipAssertTag(37244998,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}fon(){for(const Q of this.Z_.keys())this.b2d(Q)}eza(){try{this.nAk()}catch(Q){ja.ULS.shipAssertTag(37244999,
336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",Q.message,Q.stack)}}igj(Q){try{this.oio(Q)}catch(wa){ja.ULS.shipAssertTag(37245E3,336,!1,"Exception was caught in UpdatePageElements. Message: {0}",wa.message)}}dispose(){try{this.sco(),this.Yco(),this.OGa&&this.OGa.tNi(this.eBb)}catch(Q){ja.ULS.shipAssertTag(37245001,336,!1,"Exception was caught in PageAdornmentManager.Dispose. Message: {0} Stack: {1}",Q.message,Q.stack)}}zMm(Q){const wa=this.dNc(Q),eb=this.QMh(Q);eb?(Q=
this.Dwa.Wgf(eb),this.ga.Xb(wa?mf.a.sce:mf.a.J3c,2,Q),this.HYa=!0):(ja.ULS.sendTraceTag(37245002,336,10,"GetContainerFromElement returned a null container for element with id "+Q.id),this.ga.processAction(mf.a.xLd,2))}sco(){this.Z_.forEach(Q=>{this.fQa(Q)})}Yco(){this.$v&&(this.wcd&&(qe.App.xa.tu.unregisterLayoutBreakpointChanged(this.QFg),this.wcd=!1),this.$v=!1)}fQa(Q){if(Q){var wa=Q.V3b;Q=Q.h1b;Ci.a.gCa(wa)&&Ci.a.gCa(Q)?(this.Kj.sc(B.a.sQ,wa,this.QFb),this.Kj.sc(B.a.sQ,Q,this.QFb),this.Kj.sc(B.a.iK,
wa,this.PFb),this.Kj.sc(B.a.iK,Q,this.PFb),this.gg.sc(B.a.click,wa,this.OFb),this.gg.sc(B.a.click,Q,this.OFb),this.xD.sc(wa,mm.FFb),this.xD.sc(Q,mm.FFb),this.uha.sc(B.a.Vw,wa,this.fD),this.uha.sc(B.a.Vw,Q,this.fD)):ja.ULS.sendTraceTag(37245003,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}mbn(Q){this.YCe.push(Q);this.Bmd||(this.Bmd=new Yb.a(2,1,50,this.Lin),this.Hb.$b(this.Bmd))}bU(Q){if(Q){var wa=Q.V3b;Q=Q.h1b;Ci.a.gCa(wa)&&Ci.a.gCa(Q)?(this.Kj.mb(B.a.sQ,
wa,this.QFb),this.Kj.mb(B.a.sQ,Q,this.QFb),this.Kj.mb(B.a.iK,wa,this.PFb),this.Kj.mb(B.a.iK,Q,this.PFb),this.gg.mb(B.a.click,wa,this.OFb),this.gg.mb(B.a.click,Q,this.OFb),this.xD.mb(wa,mm.FFb),this.xD.mb(Q,mm.FFb),this.uha.mb(B.a.Vw,wa,this.fD),this.uha.mb(B.a.Vw,Q,this.fD)):ja.ULS.sendTraceTag(37245004,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}LVn(){if(!this.ou){for(let Q of this.Z_.values())Q.Bab.style.display="block";this.ou=!0}}jWl(){this.ou&&(this.Z_.forEach(Q=>
{Q.Bab.style.display="none"}),this.ou=!1)}nAk(){this.Dwa.eza(this.gf.ud)}oio(Q){this.CU.HXd();var wa=0;const eb=new ha.a;this.eza();const Lb=this.Nul();for(var ec of Q)Q=ec.yj,this.GZm(ec)||this.b2d(ec.yj),this.Z_.has(Q)?this.gfo(ec):this.CGk(ec),wa=Q,eb.add(Q);for(ec=1;ec<=wa;ec++)eb.contains(ec)||this.b2d(ec);for(wa+=1;wa<=Lb;wa++)this.b2d(wa);this.CU.hud()}GZm(Q){return this.Z_.has(Q.yj)?this.Z_.get(Q.yj).VKb.id===Q.VKb.id:!1}Nul(){let Q=0;this.Z_.forEach((wa,eb)=>{eb>Q&&(Q=eb)});return Q}CGk(Q){const wa=
Q.VKb.De(this.gf.Tb);if(wa){var eb=Q.yj;Q=this.SBc(eb,Q.top,Q.height,wa.M9,Q.VKb,Q.Yrd);this.mbn(Q);this.x6f(Q);this.O7f(Q);this.wcd&&!this.ou&&(Q.Bab.style.display="none");this.Z_.set(eb,Q)}}SBc(Q,wa,eb,Lb,ec,Tc){const Ad=pi.b("div","","PageAdornmentContainer");Ad.style.top=wa+"px";Ad.style.height=eb+"px";Lb.appendChild(Ad);this.FTe(Ad,WordEditorIntl.WordEditorStrings.l_Header,WordEditorIntl.WordEditorStrings.l_Footer);Lb=this.c_e(Q);Ad.appendChild(Lb);const we=this.zZe(Q);Ad.appendChild(we);const Rd=
this.qZe(Q);Ad.appendChild(Rd);H.AFrameworkApplication.isRtl&&(Ad.classList.add("Rtl"),we.classList.add("Rtl"),Rd.classList.add("Rtl"));return new Lm(Q,wa,eb,ec,Tc,Ad,we,Rd,Lb)}zZe(Q){Q=pi.b("div","h"+Q,this.Dw?"PageAdornmentHeaderLabelThemed":"PageAdornmentHeaderLabel");this.yH&&(this.Dw?Q.classList.add("PageAdornmentHeaderFooterBorderThemed"):Q.style.borderColor=tq.a.Ece);const wa=pi.b("span","","");wa.innerText=WordEditorIntl.WordEditorStrings.l_Header;wa.style.whiteSpace="nowrap";Q.appendChild(wa);
return Q}qZe(Q){Q=pi.b("div","f"+Q,this.Dw?"PageAdornmentFooterLabelThemed":"PageAdornmentFooterLabel");this.yH&&(this.Dw?Q.classList.add("PageAdornmentHeaderFooterBorderThemed"):Q.style.borderColor=tq.a.Ece);const wa=pi.b("span","","");wa.innerText=WordEditorIntl.WordEditorStrings.l_Footer;wa.style.whiteSpace="nowrap";Q.appendChild(wa);return Q}c_e(Q){const wa=pi.b("div","","PageAdornmentNumberLabel");wa.innerText=Q.toString();return wa}FTe(Q,wa,eb){if(!this.iqe){const Lb=pi.b("p","","");Lb.innerText=
wa;Lb.style.whiteSpace="nowrap";Lb.style.visibility="hidden";Q.appendChild(Lb);wa=pi.b("p","","");wa.innerText=eb;wa.style.whiteSpace="nowrap";wa.style.visibility="hidden";Q.appendChild(wa);this.iqe=Q.clientWidth;this.CU.cXf(this.iqe);Q.removeChild(Lb);Q.removeChild(wa)}}b2d(Q){if(this.Z_.has(Q)){var wa=this.Z_.get(Q);this.fQa(wa);Ci.a.dv(wa.Bab);this.Z_.delete(Q)}}gfo(Q){if(this.Z_.has(Q.yj)){var wa=this.Z_.get(Q.yj);wa.UZc(Q.top);wa.IWf(Q.height);this.x6f(wa);this.O7f(wa)}else ja.ULS.sendTraceTag(37245005,
324,15,"We called UpdateContainerForPage, but a container doesn't exist for the given page.")}Udo(){this.CU.HXd();this.eza();this.Z_.forEach(Q=>{this.x6f(Q);this.O7f(Q)});this.CU.hud()}x6f(Q){const wa=Q.V3b,eb=Q.h1b,Lb=this.Dwa.DJb(Q),ec=this.Dwa.CJb(Q);this.yko(Q,Lb,ec);this.CU.w2c(wa,Lb);this.CU.w2c(eb,ec)}yko(Q,wa=!0,eb=!0){const Lb=Q.V3b;Q=Q.h1b;3!==H.AFrameworkApplication.ya.mode?(Lb.title=WordEditorIntl.WordEditorStrings.l_OpenHeader,Q.title=WordEditorIntl.WordEditorStrings.l_OpenFooter):(Lb.title=
wa?WordEditorIntl.WordEditorStrings.l_EditHeader:WordEditorIntl.WordEditorStrings.l_AddHeader,Q.title=eb?WordEditorIntl.WordEditorStrings.l_EditFooter:WordEditorIntl.WordEditorStrings.l_AddFooter)}rZf(Q){const wa=this.QMh(Q);return wa?this.dNc(Q)?this.Dwa.DJb(wa):this.Dwa.CJb(wa):(ja.ULS.sendTraceTag(37245006,336,10,"GetContainerFromElement returned null."),!1)}QMh(Q){Q=Q.id;Q=Q.substring(1,Q.length);Q=Number.parseInvariant(Q);return this.Z_.has(Q)?this.Z_.get(Q):(ja.ULS.sendTraceTag(37245007,336,
10,"Adornment container map does not contain the page number "+Q),null)}dNc(Q){return Q.id.length?"h"===Q.id.substring(0,1):(ja.ULS.sendTraceTag(37245008,336,10,"Empty ID found for adornment"),!0)}O7f(Q){const wa=Q.height;wa<mm.SGm?(Q.V3b.classList.add(mm.keb),Q.h1b.classList.add(mm.keb)):(Q.V3b.classList.remove(mm.keb),Q.h1b.classList.remove(mm.keb));wa<mm.TGm?(Q.iBi.classList.add(mm.keb),Q.Bab.classList.add(mm.keb)):(Q.iBi.classList.remove(mm.keb),Q.Bab.classList.remove(mm.keb))}GYe(){return!this.Cve||
F.a.yjf(this.Cve,500)}static FFb(){return!0}}mm.keb="Hidden";mm.SGm=120;mm.TGm=50;Object(f.a)(mm,"PageAdornmentManager",null,[1985,10,1986]);class tj{constructor(Q,wa){this.uYd=new ha.a;this.uYd.add(Q);this.uYd.add(wa)}}Object(f.a)(tj,"PageElementManagerList",null,[]);var Yn=d(69);class Zi{constructor(Q,wa,eb){this.Hm=Q;this.ySb=[];this.zE=wa;this.yH=eb}oLi(){for(let Q=0,wa=this.ySb.length;Q<wa;Q++)Ci.a.dv(this.ySb[Q]);Array.clear(this.ySb)}pOh(Q,wa,eb,Lb,ec,Tc){let Ad=Math.min(Lb.x-Tc.x,ec.x-Tc.x);
Lb=Math.min(Tc.x+Tc.width-(Lb.x+Lb.width),Tc.x+Tc.width-(ec.x+ec.width));wa+=ec.y-Tc.y;({Jfa:wa,leftMargin:Ad,rightMargin:Lb}=this.H8j(wa,Ad,Lb));Q=this.qAl(Q,Ad,Lb,Ad,Lb,eb);Q.style.top=wa+"px";Q.style.zIndex="0";this.ySb.push(Q);Yn.c(Q,!0);return Q}$Fd(Q){return Q?Q.querySelector(".PageBreakBorderSpan"):null}qAl(Q,wa,eb,Lb,ec,Tc){return Q?this.sJl(wa,eb,Lb,ec,Tc):this.IAl(Lb,ec,Tc)}H8j(Q,wa,eb){wa/=this.Hm.instance.vj;eb/=this.Hm.instance.vj;Q/=this.Hm.instance.vj;return{Jfa:Q,leftMargin:wa,rightMargin:eb}}ccm(Q){return this.ghi(Q)&&
this.ZAi(Q)?(Q=this.kAb(Q))&&Q.offsetParent?!1:!0:!1}bcm(Q){return!this.ghi(Q)||this.ZAi(Q)?!1:!0}qQ(){}kAb(Q){if(!Q.dJf)return null;let wa=null;Q.xfb&&!Q.U$?(Q=this.$Fd(Q.dJf))&&(wa=Q):wa=Q.dJf;return wa}ghi(Q){return Q.xfb&&!Q.U$&&Q.paragraphNode?!0:!1}ZAi(Q){Q=Q.paragraphNode;return!!Q&&!!Q.anchor}Mhh(Q,wa){Q=ia.a.KKa(Q);wa=ia.a.KKa(wa);return(Q-wa)/this.Hm.instance.vj}ITe(Q,wa){Q=ia.a.KKa(Q);wa=ia.a.KKa(wa);return(Q-wa)/this.Hm.instance.vj}WSd(){this.kgj(!1)}VSd(){this.kgj(!0)}kgj(Q){for(let wa=
0,eb=this.ySb.length;wa<eb;wa++){const Lb=this.ySb[wa];"PageEndMarker.Para"===Lb.id?Zi.ngj(Lb,Q):"PageEndMarker.Table"===Lb.id&&Zi.fhj(Lb,Q)}}IAl(Q,wa,eb){if(!Zi.AVb){Zi.AVb=pi.b("div","PageEndMarker.Para","PageEndMarker");var Lb=pi.b("div","","Current FullWidth");this.yH&&(Lb.style.borderTopColor=this.zE.Isa());Zi.AVb.appendChild(Lb);Lb=pi.b("div","","Stale LeftWing");const ec=pi.b("div","","Stale RightWing");this.yH&&(Lb.style.borderTopColor=this.zE.Isa(),ec.style.borderTopColor=this.zE.Isa());
Zi.AVb.appendChild(Lb);Zi.AVb.appendChild(ec)}Lb=Zi.AVb.cloneNode(!0);Lb.childNodes[1].style.width=Q-10+"px";Lb.childNodes[2].style.width=wa-10+"px";Zi.ngj(Lb,eb);return Lb}sJl(Q,wa,eb,Lb,ec){if(!Zi.Qtb){Zi.Qtb=pi.b("div","PageEndMarker.Table","PageEndMarker");var Tc=pi.b("div","","Current LeftWing"),Ad=pi.b("div","","Current RightWing");this.yH&&(Tc.style.borderTopColor=this.zE.Isa(),Ad.style.borderTopColor=this.zE.Isa());Zi.Qtb.appendChild(Tc);Zi.Qtb.appendChild(Ad);Tc=pi.b("div","","Stale LeftWing");
Ad=pi.b("div","","Stale RightWing");this.yH&&(Tc.style.borderTopColor=this.zE.Isa(),Ad.style.borderTopColor=this.zE.Isa());Zi.Qtb.appendChild(Tc);Zi.Qtb.appendChild(Ad)}Tc=Zi.Qtb.cloneNode(!0);Tc.childNodes[0].style.width=Q+"px";Tc.childNodes[1].style.width=wa+"px";Tc.childNodes[2].style.width=eb-10+"px";Tc.childNodes[3].style.width=Lb-10+"px";Zi.fhj(Tc,ec);return Tc}static ngj(Q,wa){wa?Zi.YBm(Q):Zi.ZBm(Q)}static ZBm(Q){Q.childNodes[0].style.display="none";Q.childNodes[1].style.display="block";Q.childNodes[2].style.display=
"block"}static YBm(Q){Q.childNodes[0].style.display="block";Q.childNodes[1].style.display="none";Q.childNodes[2].style.display="none"}static fhj(Q,wa){wa?Zi.cCm(Q):Zi.dCm(Q)}static dCm(Q){Q.childNodes[0].style.display="none";Q.childNodes[1].style.display="none";Q.childNodes[2].style.display="block";Q.childNodes[3].style.display="block"}static cCm(Q){Q.childNodes[0].style.display="block";Q.childNodes[1].style.display="block";Q.childNodes[2].style.display="none";Q.childNodes[3].style.display="none"}}
Zi.AVb=null;Zi.Qtb=null;Object(f.a)(Zi,"PageEndDOMHelper",null,[]);class ap{constructor(Q,wa){this.$rb=this.$Ug=null;this.Hm=Q;this.Ih=wa}o1f(Q,wa){try{this.X0n(Q,wa)}catch(eb){ja.ULS.sendTraceTag(35005339,336,10,"Exception was caught in PageEndMarkerPositionComparer.StorePositions. Message: {0}",eb.message)}}Nzk(Q,wa,eb,Lb,ec,Tc,Ad){this.Ih.Pd(()=>{try{this.Ozk(Q,wa,eb,Lb,ec,Tc,Ad)}catch(we){ja.ULS.sendTraceTag(35005341,336,10,"Exception was caught in PageEndMarkerPositionComparer.ComparePositions. Message: {0}",
we.message)}},"PEMPC:CP")}X0n(Q,wa){this.$Ug=Q;this.$rb=wa}Ozk(Q,wa,eb,Lb,ec,Tc,Ad){var we=this.$Ug;if(we&&Q){var Rd=we.count,yf=Q.count;if(Rd&&yf){var rg=this.z7k(we,Q);if(rg.count){var vi=this.Hm.vj,Rk=this.$Yb(rg)/vi,Ij=this.noh(rg)/vi;Q=this.KBd(we,Q);if(Q.count){we=this.$Yb(Q)/vi;vi=this.noh(Q)/vi;var Sl=!0;for(var hk=0;hk<rg.count;hk++)if(rg.J(hk)){Sl=!1;break}var Yl=hk=0;this.$rb&&wa&&(hk=this.pnk(this.$rb,wa),Yl=wa.count-this.$rb.count);ja.ULS.sendTraceTag(35005343,336,50,"{0}",{["FlightEnabled"]:eb,
["HardPageBreakExists"]:ec,["EstimatedPageCount"]:Rd,["CalculatedPageCount"]:yf,["InOrderAverageDelta"]:Rk,["InOrderStandardDeviation"]:Ij,["ShortestAverageDelta"]:we,["ShortestStandardDeviation"]:vi,["PositionsShouldBeUpdated"]:Lb,["DocumentHeightChanged"]:Tc,["DeltasAllZero"]:Sl,["HeaderFooterOpenSinceLastResponse"]:Ad,["DeltaInViewport"]:hk,["ChangeInViewportMarkerCount"]:Yl});Tc||Ad||Sl||(ja.ULS.sendTraceTag(36557839,336,15,"Assumed redundant pagination request but there were changes in the page end marker positions."),
wa=rg.toArray().toString(),eb=Q.toArray().toString(),ja.ULS.sendTraceTag(35726603,336,50,"{0} {1}",wa,eb))}}}}else ja.ULS.sendTraceTag(35005342,336,10,"estimatedPositions or calculatedPositions are null in PageEndMarkerPositionComparer.ComparePositionsInternal.")}pnk(Q,wa){const eb=new ha.a;for(let Lb of Q)eb.add(Lb.top);if(!eb.count)return-1;Q=new ha.a;for(let Lb of wa)Q.add(Lb.top);if(!Q.count)return-1;wa=this.KBd(eb,Q);return this.$Yb(wa)/this.Hm.vj}$Yb(Q){if(!Q.count)return 0;let wa=0;for(let eb=
0;eb<Q.count;eb++)wa+=Q.J(eb);return wa/Q.count}noh(Q){if(!Q.count)return 0;const wa=this.$Yb(Q);let eb=0;for(let Lb=0;Lb<Q.count;Lb++){const ec=Q.J(Lb)-wa;eb+=ec*ec}return Math.sqrt(eb/Q.count)}z7k(Q,wa){const eb=new ha.a;if(!Q.count||!wa.count)return eb;Q.Sc((ec,Tc)=>ec-Tc);wa.Sc((ec,Tc)=>ec-Tc);const Lb=Math.min(Q.count,wa.count);for(let ec=0;ec<Lb;ec++){const Tc=Math.abs(Q.J(ec)-wa.J(ec));eb.add(Tc)}return eb}KBd(Q,wa){const eb=new ha.a;if(!Q.count||!wa.count)return eb;var Lb=Q.count<=wa.count;
const ec=Lb?Q:wa;Q=Lb?wa:Q;for(wa=0;wa<ec.count;wa++){Lb=ec.J(wa);let Ad=Math.abs(Lb-Q.J(0)),we=0;for(let Rd=1;Rd<Q.count;Rd++){var Tc=Q.J(Rd);Tc=Math.abs(Lb-Tc);Tc<Ad&&(Ad=Tc,we=Rd)}eb.add(Ad);Q.removeAt(we)}return eb}}Object(f.a)(ap,"PageEndMarkerPositionComparer",null,[1984]);var Rl=d(425),Rj=d(514);class Cj{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we,Rd,yf){this.oq=Q;this._pageNumber=wa;this.xfb=eb;this.U$=Lb;this.dJf=ec;this.outlineNode=Tc;this.outlineGroupNode=Ad;this.YSg=we;this.paragraphNode=Rd;this.ZT=
yf}get top(){return this.oq}get yj(){return this._pageNumber}get ZYm(){return this.YSg}UZc(Q){this.oq=Q}R5d(Q){this._pageNumber=Q}EYi(Q){this.YSg=Q}}Object(f.a)(Cj,"PageEndMarker",null,[]);class Qs{constructor(){this.qf=null;this.Ori=0}}Object(f.a)(Qs,"PageEndMarkerToRestore",null,[]);class ur{constructor(Q,wa,eb,Lb,ec,Tc,Ad){this.eIf=(we,Rd)=>{Rd.property===sq.a.bI&&(we=Rd.node)&&we.ia(sq.a.bI,!1)&&this.uod.contains(we.id)&&(Rd=we.De(this.gf.Tb))&&(Rd=Rd.htmlElement)&&(this.uod.remove(we.id),this.SSa.add(Rd))};
this.AH=Q;this.Hm=wa;this.LHa=eb;this.rx=Lb;this.tAe=ec;this.CY=Tc;this.Dm=Ad;this.kt=new ha.a;this.zSb=new ha.a;this.Ptb=new pb.a;this.uod=new Rj.a(new Rl.a);this.SSa=new ha.a;this.CSb=!!ec;this.dkf()}get gf(){const Q=this.AH.value;ja.ULS.shipAssertTag(37052750,336,Q.Ji,"PageEndMarkerPositionUpdater.PageView is not a PageView.");return Q}K2c(Q){try{this.Qho(Q)}catch(wa){this.rx.qQ(wa.message+" "+wa.stack),ja.ULS.sendTraceTag(38405270,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateMarkers. Exception: {0}",
wa.message)}}T2j(Q){try{this.U2j(Q)}catch(wa){this.rx.qQ(wa.message+" "+wa.stack),ja.ULS.sendTraceTag(38405271,336,10,"Exception caught in PageEndMarkerPositionUpdater.AddRenderedMarker. Exception: {0}",wa.message)}}nok(Q){try{return this.ook(Q)}catch(wa){this.rx.qQ(wa.message+" "+wa.stack),ja.ULS.sendTraceTag(37052752,336,10,"Exception caught in PageEndMarkerPositionUpdater.CalculatePositions. Exception: {0}",wa.message)}return!1}$vn(){try{this.awn()}catch(Q){this.rx.qQ(Q.message+" "+Q.stack),ja.ULS.sendTraceTag(37052753,
336,10,"Exception caught in PageEndMarkerPositionUpdater.RestorePositions. Exception: {0}",Q.message)}}HIc(){try{return this.oEl()}catch(Q){return this.rx.qQ(Q.message+" "+Q.stack),ja.ULS.sendTraceTag(38405273,336,10,"Exception caught in PageEndMarkerPositionUpdater.GetRenderedPageEndMarkers. Exception: {0}",Q.message),null}}y7f(){try{this.qjo()}catch(Q){this.rx.qQ(Q.message+" "+Q.stack),ja.ULS.sendTraceTag(37820302,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateSectionLastPageHeight. Exception: {0}",
Q.message)}}hVe(){try{return this.Htk()}catch(Q){return this.rx.qQ(Q.message+" "+Q.stack),ja.ULS.sendTraceTag(38405274,336,10,"Exception caught in PageEndMarkerPositionUpdater.CheckVirtualizedHardBreaks. Exception: {0}",Q.message),!1}}d4l(Q){try{this.e4l(Q)}catch(wa){this.rx.qQ(wa.message+" "+wa.stack),ja.ULS.sendTraceTag(38916953,336,10,"Exception caught in PageEndMarkerPositionUpdater.InsertOrDeleteRenderedMarkers. Exception: {0}",wa.message)}}Qho(Q){if(Q){this.kvk();for(let wa=0;wa<Q.length;wa++){const eb=
wa+1,Lb=this.zBk(Q[wa],eb);this.kt.add(Lb);this.Ptb.add(eb,Lb)}}}e4l(Q){let wa=!1;for(let eb of Q)if(eb)if(0<eb.OB)for(let Lb of eb.Vmf)wa=this.Opd(Lb,eb.outlineGroupNode)||wa;else if(0>eb.OB){wa=!0;for(let Lb of eb.$xd)this.$Qk(Lb.yj)}wa&&this.ORf()}U2j(Q){const wa=this.SMh(Q.paragraphNode);this.Opd(Q,wa)&&this.ORf()}$Qk(Q){const wa=Q-1;0>wa||this.kt.count<=wa||(this.kt.removeAt(wa),this.Ptb.xb(Q)&&this.Ptb.remove(Q))}oEl(){const Q=new ha.a;for(let wa of this.kt)this.x6b(wa)&&Q.add(wa);return Q}Opd(Q,
wa){if(!Q)return ja.ULS.sendTraceTag(38385033,336,15,"pageEndDetails is null in PageEndMarkerPositionUpdater.AddRenderedMarkerInternal."),!1;wa=this.wBk(Q,wa);Q=Q.J8l?-1:Q.yj;let eb=!1,Lb;this.Ptb.xb(Q)?(Lb=this.Ptb.J(Q).yj,wa.R5d(Lb),this.kt.Z(Lb-1,wa),this.Ptb.remove(Q)):(Lb=wa.yj,this.kt.insert(Lb-1,wa),eb=!0);return eb}zBk(Q,wa){return new Cj(0,wa,Q.HardBreak,!1,null,null,null,0,null,null)}wBk(Q,wa){const eb=Q.lib,Lb=Q.yj,ec=Q.ZT,Tc=!!ec&&ec.HardBreak,Ad=Q.U$,we=Q.paragraphNode,Rd=this.eUh(wa),
yf=Q.outlineNode;var rg=this.Tef(yf);if(!rg)return ja.ULS.sendTraceTag(37782370,336,15,"Given an outline node with a null DOM element in ConstructPageEndMarker."),null;let vi=null;Tc&&(vi=this.rx.$Fd(Q.lib));Q=this.rx.Mhh(vi||eb,Rd);rg=this.rx.ITe(vi||eb,rg);return new Cj(rg,Lb,Tc,Ad,eb,yf,wa,Q,we,ec)}ook(Q){this.zSb=new ha.a;this.CSb&&this.tAe.reset();this.cnn();this.nYn();this.I8j();this.cok(Q);return 0<this.zSb.count}cnn(){for(let Q=0;Q<this.kt.count;Q++){const wa=this.kt.J(Q);this.rx.ccm(wa)?
this.uAm(wa):(this.rx.bcm(wa)||this.x6b(wa)&&!this.Tef(wa.outlineNode))&&this.tMi(wa)}}I8j(){let Q=0,wa=null;var eb=0;let Lb=0;for(let ec=0;ec<this.kt.count;ec++){const Tc=this.kt.J(ec);this.x6b(Tc)&&(Tc.xfb&&(Lb+=this.Ihh(Tc,eb,Lb)),wa&&wa.id===Tc.outlineNode.id||(wa=Tc.outlineNode,Lb=Q=0),Tc.xfb&&!Tc.U$&&(Q=this.aok(Tc)),eb=Tc.top+Q+Lb,Tc.UZc(eb))}this.Ihh(null,eb,Lb);this.Vmn()}Ihh(Q,wa,eb){let Lb=null;this.CSb&&(Lb=this.tAe.dok(Q,wa,eb));return Lb?Lb.delta:0}awn(){if(this.zSb){for(let Q=0;Q<this.zSb.count;Q++){const wa=
this.zSb.J(Q);Ci.a.$Gn(wa.qf,wa.Ori)}this.CSb&&this.tAe.Xvn()}}qjo(){if(!this.CSb){var Q=this.LHa.VRh();if(this.kt.count){var wa=this.LHa.rPh();for(let ec=0;ec<this.kt.count;ec++){var eb=this.kt.J(ec);if(this.x6b(eb)&&eb.U$){eb=this.LHa.$Cl(eb.outlineNode);var Lb=0<ec?this.kt.J(ec-1).outlineNode:wa;Lb=ec&&eb.id===Lb.id?this.kt.J(ec-1).top:0;this.LHa.Q5d(eb,Lb)}}wa=this.kt.J(this.kt.count-1);wa.U$?this.LHa.Q5d(Q,0):this.LHa.Q5d(Q,wa.top)}else this.LHa.Q5d(Q,0)}}nYn(){this.kt.Sc((Q,wa)=>Q.yj-wa.yj)}ORf(){for(let Q=
0;Q<this.kt.count;Q++)this.kt.J(Q).R5d(Q+1)}aok(Q){return Q?this.Lhh(Q)-Q.top:(ja.ULS.sendTraceTag(37306776,336,15,"CalculatePageEndMarkerDelta called with a null PageEndMarker."),0)}lok(Q){if(!Q)return 0;const wa=this.eUh(Q.outlineGroupNode);return wa?this.rx.Mhh(this.rx.kAb(Q),wa):0}Lhh(Q){if(!Q)return 0;const wa=this.rx.kAb(Q);Q=this.Tef(Q.outlineNode);return Q?this.rx.ITe(wa,Q):(ja.ULS.sendTraceTag(37782371,336,50,"The given pageEndMarker contains an outline node with a null DOM element in CalculatePageEndMarkerPosition."),
0)}Vmn(){let Q=0,wa=!1,eb=null,Lb=!1;for(let ec=this.kt.count-1;0<=ec;ec--){const Tc=this.kt.J(ec);this.x6b(Tc)&&(eb&&eb.id===Tc.outlineNode.id||(wa=!eb,eb=Tc.outlineNode,Q=this.Yzl(eb)),Tc.xfb?(wa=!1,Q=Tc.top):this.CSb&&wa||!(Tc.top>Q)||(this.tMi(Tc),Ci.a.dv(this.rx.kAb(Tc)),Lb=!0))}Lb&&this.ORf()}tMi(Q){this.kt.contains(Q)&&(this.CSb&&this.CY.gon(Q),this.kt.remove(Q))}x6b(Q){return Q?(Q=this.rx.kAb(Q))&&Q.offsetParent?!0:!1:(ja.ULS.sendTraceTag(38385035,324,50,"PageEndMarker is null in IsPageEndMarkerRendered."),
!1)}Htk(){let Q=!1;for(let wa=this.SSa.count-1;0<=wa;wa--)this.SSa.J(wa).hasChildNodes()&&(this.SSa.removeAt(wa),Q=!0);return Q}uAm(Q){(Q=this.SMh(Q.paragraphNode))&&(this.uod.contains(Q.id)||this.uod.add(Q.id))}dkf(){this.Dm&&this.Dm.Te(23).jp(this.eIf)}cok(Q){for(let wa=this.kt.count-1;0<=wa;wa--){const eb=this.kt.J(wa);this.x6b(eb)&&this.bok(eb,Q)}}bok(Q,wa){const eb=this.Lhh(Q),Lb=this.lok(Q);Q.xfb?(Q.UZc(eb),Q.EYi(Lb)):(wa=wa?eb-Q.top:Lb-Q.ZYm,Q.UZc(eb-wa),Q.EYi(Lb-wa),1<Math.abs(wa)&&this.FLn(this.rx.kAb(Q),
wa))}Tef(Q){if(!Q)return null;Q=Q.De(this.gf.Tb);return Q?Q.htmlElement:(ja.ULS.sendTraceTag(37782401,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeTop."),null)}eUh(Q){return Q?(Q=Q.De(this.gf.Tb))?Q.htmlElement:null:null}SMh(Q){Q=Um.GraphIterator.$a(Q);return Q.Bb(23)?Q.kd(23):null}Xzl(Q){if(!Q)return null;Q=Q.De(this.gf.Tb);return Q?ia.a.getElementBounds(Q.htmlElement):(ja.ULS.sendTraceTag(37888197,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeBounds."),null)}Yzl(Q){return(Q=
this.Xzl(Q))?Q.height/this.Hm.vj:0}FLn(Q,wa){wa=(Ci.a.Iol(Q)-wa)*this.Hm.vj;this.zSb.add(Object.assign(new Qs,{qf:Q,Ori:wa}))}kvk(){this.kt=new ha.a;this.Ptb=new pb.a}}Object(f.a)(ur,"PageEndMarkerPositionUpdater",null,[1983]);var Uq=d(385),it=d(38),Ik=d(870),aq=d(370),Cn=d(23);class Dn{constructor(Q,wa,eb,Lb,ec,Tc,Ad=!1,we=!1,Rd=!1,yf=!1,rg=!1){this.G8f(wa,eb,Lb,ec,Tc,Rd,rg);this.position=Q;this.yj=wa;this.paragraphNode=eb;this.ZT=Lb;this.lib=ec;this.outlineNode=Tc;this.QZa=Ad;this.Hgi=we;this.J8l=
Rd;this.U$=yf;this.irf=rg}R5d(Q){this.yj=Q}G8f(Q,wa,eb,Lb,ec,Tc,Ad){Ad||(ja.ULS.shipAssertTag(38326881,336,!!ec,"PageEndDetails: outlineNode parameter value is null."),ja.ULS.shipAssertTag(24126528,336,0<=Q,"PageEndDetails: pageNumber parameter value {0} is unexpected value.",Q),ja.ULS.shipAssertTag(24126529,336,!!wa||Tc,"PageEndDetails: paragraphNode parameter is null for a page that is not client-only."),ja.ULS.shipAssertTag(24126530,336,!!eb||Tc,"PageEndDetails: pageEnd parameter is null for a page that is not client-only."),
ja.ULS.shipAssertTag(24126531,336,!!Lb||Tc,"PageEndDetails: pageEndDomElement parameter is null for a page that is not client-only."))}static AIk(Q,wa){return Dn.ZYe(0,Q,null,wa,!0,!1)}static BIk(Q){return Dn.ZYe(0,0,null,Q,!1,!0)}static ZYe(Q,wa,eb,Lb,ec,Tc){return new Dn(Q,wa,null,null,eb,Lb,ec,Tc,!0)}static IZb(Q,wa){return new Dn(0,Q,null,wa,null,null,void 0,void 0,void 0,void 0,!0)}}Object(f.a)(Dn,"PageEndDetails",null,[]);class Xj{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we,Rd,yf,rg,vi,Rk,Ij,Sl,hk,Yl,
Sj,eg,yq,bs){this.Upa=!0;this.kke=0;this.Tgd=this.jqe=this.kqe=this.mme=this.rAe=this.Upe=!1;this.Xid=this.xsb=null;this.Ate=!0;this.EFb=()=>{this.WSd()};this.kFf=()=>{this.kqe=!1};this.lFf=()=>{this.jqe=this.kqe=!0};this.$Sm=($i,xk)=>{1>=Math.abs(xk.delta)||(this.mme=!0,this.jgj(!xk.Gri))};this.ihn=$i=>{$i===this.xsb&&(this.xsb=null);if(this.Upa){var xk=$i.customData;if($i=this.TSa.get(xk.id))for(this.TSa.Z(xk.id,new ha.a),ja.ULS.sendTraceTag(6558539,336,50,"PageEndMarkers: Redraw page ends for Outline Group [Count: {0}] [Outline group: {1}]",
$i.count,xk.id),this.A8&&this.A8.eza(),xk=0;xk<$i.count;xk++){const cs=$i.J(xk),Zl=cs.ZT;Zl.HardBreak||(Ci.a.dv(cs.lib),this.ARf(Zl))}}};this.hhn=()=>{this.Xid=null;this.Upa&&this.Kfa&&0<this.Kfa.count&&(ja.ULS.sendTraceTag(6579856,336,50,"PageEndMarkers: Redraw all page ends in the document"),this.K2c(this.Kfa.toArray(),this.Upa))};this.AH=Q;this.zi=wa;this.A8=eb;this.VM=Lb;this.hTg=ec;this.i8a=Tc;Xj.rx=we;this.FEg=Rd;this.DH=yf;this.Hb=rg;this.lDj=vi;this.le=Ij;this.CY=hk;this.vAe=Yl;this.FSb=Sj;
this.hY=eg;this.dSb=new Uq.a;this.ASb=new ha.a;this.Kfa=new ha.a;this.TSa=new Uq.a;this.EM=Rk;this.yY=bs;this.yYd=this.yYd.bind(this);this.AYd=this.AYd.bind(this);this.J1d=this.J1d.bind(this);this.kaa=this.kaa.bind(this);this.EM.eqd(this.EFb);this.sAe=!1;this.iTg=yq;Sl&&(Sl.g9g(this.lFf),Sl.gqd(this.kFf));Ad&&Ad.q6j(this.$Sm);this.yY.Qub(this.kaa)}get $qf(){return this.Ate}get gf(){return this.AH.value}get Qi(){return this.zi.value}K2c(Q,wa){const eb=this.le.fg("Task","UpdateMarkers");this.V0n();
this.Upa=wa;Xj.rx.oLi();this.dSb=new Uq.a;this.ASb.clear();this.Kfa.clear();this.TSa=new Uq.a;this.Ate=this.Upe=!1;this.VM&&this.VM.K2c(Q);this.g1k();this.kke=Q.length;this.CY&&this.CY.reset(Q);this.A8&&this.A8.eza();for(let Lb of Q)this.Kfa.add(Lb),this.ARf(Lb);wa&&this.VM&&this.vAe&&this.vAe.isEnabled&&(Q=this.VM.HIc(),this.vAe.vVa(Q));this.Mzk();this.mme=this.rAe=!1;this.jqe=this.kqe;cj.WoncaApp.instance.Beb&&Xj.Vkf&&this.VM.y7f();this.i8a.nio(this.VM.HIc(),this.Kfa.count);this.Ate=!0;this.hY.n7f();
eb.stop();ja.ULS.sendTraceTag(25048922,336,50,"UpdateMarkers stopwatch stopped: {0}",{["DurationInMs"]:eb.ni,["RenderedLineCount"]:this.kke,["AvgDurationPerPageInMs"]:eb.ni/this.mUh()})}pUh(){const Q=this.VM.HIc();if(!Q)return null;const wa=Ci.a.e2(),eb=new ha.a;for(let Lb of Q)this.Dfm(Lb,wa)&&eb.add(Lb);return eb}Dfm(Q,wa){if(!Q)return!1;Q=Xj.rx.kAb(Q);if(!Q)return!1;Q=ia.a.KKa(Q);return 0<=Q&&Q<=wa}VJh(){const Q=new ha.a;if(!this.TSa)return ja.ULS.sendTraceTag(35005382,336,10,"_outlineGroupsWithPageEndDetails is null in PageEndMarkers.GetAbsolutePageEndMarkerPositions."),
Q;const wa=this.TSa.keys;for(let ec=0;ec<wa.length;ec++){var eb=wa.J(ec);if(eb=this.TSa.J(eb))for(let Tc=0;Tc<eb.count;Tc++){var Lb=eb.J(Tc);Lb.ZT.HardBreak||Lb.lib.classList.contains("Hidden")||(Lb=ia.a.KKa(Lb.lib),Q.add(Lb))}}return Q}V0n(){const Q=this.VJh(),wa=this.pUh();this.hTg.o1f(Q,wa);this.FSb&&this.FSb.isEnabled&&this.FSb.o1f(wa)}Mzk(){if(!(25<this.mUh())){var Q=this.VJh(),wa=this.pUh();this.hTg.Nzk(Q,wa,this.iTg,this.rAe,this.Upe,this.mme,this.jqe);this.FSb&&this.FSb.isEnabled&&this.FSb.vVa(wa)}}kaa(){this.A8.fon();
this.Cxh()}Cxh(){this.Tgd&&(this.gf.ppn(this.yYd),this.gf.aqn(this.AYd),this.gf.Hpn(this.J1d),this.Tgd=!1)}g1k(){this.Tgd||(this.gf.C8g(this.yYd),this.gf.Y6j(this.AYd),this.gf.a9g(this.J1d),this.Tgd=!0)}ARf(Q){if(this.sAe)return!0;Q=this.frn(Q);if(!Q)return!1;this.CY&&this.CY.TRl(Q);this.VM&&(this.VM.T2j(Q),this.i8a.fgj(this.VM.HIc()),cj.WoncaApp.instance.Beb&&Xj.Vkf&&this.VM.y7f());return!0}frn(Q){let wa=this.i$(Q.ParaId);if(!wa)return null;if(!wa.anchor||!wa.Ti)return this.T7g(Q,wa),null;let eb,
Lb;if(Q.HardBreak){var ec=Qj.ParagraphReader.Vg(wa,!0,!0,!0);this.K_m(ec)&&(wa=ec);if(!({Jfa:ec,outlineGroupNode:eb,kib:Lb}=this.J$n(Q,wa)).returnValue)return null;this.Upe=!0}else if(!({vYd:ec,outlineGroupNode:eb,kib:Lb}=this.grn(Q,wa)).returnValue)return null;return this.Opd(wa,Q,ec,eb,Lb)}K_m(Q){return Q?(Q=Q.De(this.gf.Tb))?!!Xj.rx.$Fd(Q.htmlElement):!1:!1}grn(Q,wa){var eb=Q.PageEndType;let Lb,ec=0,Tc=null;if(!eb){if(!({Jfa:Q,OIf:Lb}=this.qUh(Q,wa)).returnValue)return{returnValue:!1,vYd:ec,outlineGroupNode:Tc,
kib:null}}else if(!({Jfa:Q,N9d:Lb}=this.rAl(Q,wa)).returnValue)return{returnValue:!1,vYd:ec,outlineGroupNode:Tc,kib:null};var Ad=Um.GraphIterator.$a(wa);Ad.vd();Tc=Ad.kd(23);wa=Tc.De(this.gf.Tb).getBounds();Ad=Ad.IOa().De(this.gf.Tb);if(!Ad)return ja.ULS.sendTraceTag(50997218,314,50,"outlineGroupViewElement is null for ViewId: {0}.",this.gf.Tb),{returnValue:!1,vYd:ec,outlineGroupNode:Tc,kib:null};const we=Ad.getBounds();ec=Q-wa.y;eb=Xj.rx.pOh(eb,ec,this.Upa,Lb,wa,we);Ad.M9.appendChild(eb);return{returnValue:!0,
vYd:ec,outlineGroupNode:Tc,kib:eb}}J$n(Q,wa){let eb=null;const Lb=wa.De(this.gf.Tb);var ec=0;let Tc=null;if(this.KPd(Q,Lb,wa))return{returnValue:!1,Jfa:ec,outlineGroupNode:eb,kib:Tc};eb=Xj.jri(wa);const Ad=eb.De(this.gf.Tb);if(!Ad)return ja.ULS.sendTraceTag(50446550,314,15,"outlineGroupViewElement is null for ViewId: {0}.",this.gf.Tb),{returnValue:!1,Jfa:ec,outlineGroupNode:eb,kib:Tc};ec=Ad.getBounds();ec=Bp.a.qq(Lb,Q.CP).y-ec.y;Tc=this.Trl(wa);return{returnValue:!0,Jfa:ec,outlineGroupNode:eb,kib:Tc}}Trl(Q){return Q.De(this.gf.Tb).htmlElement}i$(Q){const wa=
this.DH.udb(Q);if(wa!==tf.a.nil){const eb=this.Qi.Eb(wa);if(eb)return eb}ja.ULS.sendTraceTag(6398172,336,10,"PageEndMarkers: Cannot find graph node for para Id {0} objectId {1}",Q,wa);return null}qUh(Q,wa){const eb=Q.CP;let Lb=0,ec=null;const Tc=wa.De(this.gf.Tb);if(this.KPd(Q,Tc,wa))return{returnValue:!1,Jfa:Lb,OIf:ec};ec=Tc.getBounds();Lb=eb?this.FEg(Object(Ca.a)(80,Tc),eb):ec.y-this.lDj(Tc);return{returnValue:!0,Jfa:Lb,OIf:ec}}rAl(Q,wa){let eb=null,Lb=0;var ec=Q.PageEndType;let Tc=Um.GraphIterator.$a(wa);
Tc.vd();if(!it.TableReader.Tw(Tc))return ja.ULS.sendTraceTag(6398173,336,50,"PageEndMarkers: Para {0} has moved out from inside the table, treating as normal paragraph.",Q.ParaId),{returnValue:({Jfa:Lb,OIf:eb}=this.qUh(Q,wa)).returnValue,Jfa:Lb,N9d:eb};if(1===ec){Cn.returnToContainingRow(Tc);ec=Tc.currentNode.De(this.gf.Tb);if(this.KPd(Q,ec,wa))return{returnValue:!1,Jfa:Lb,N9d:eb};Lb=ec.getBounds().y}else{ec=wa.De(this.gf.Tb);if(this.KPd(Q,ec,wa))return{returnValue:!1,Jfa:Lb,N9d:eb};Lb=this.FEg(Object(Ca.a)(80,
ec),Q.CP)}--Lb;wa=null;do Q=wa,wa=Tc.kd(14);while(wa);Tc=Um.GraphIterator.$a(Q);Tc.vd();Cn.moveToFirstRow(Tc);eb=Tc.currentNode.De(this.gf.Tb).getBounds();return{returnValue:!0,Jfa:Lb,N9d:eb}}KPd(Q,wa,eb){if(!wa||wa.lNa(16))return this.T7g(Q,eb),!0;wa=wa.getBounds();return wa.width||wa.height?!1:(this.j7g(Q),!0)}j7g(Q){this.ASb.contains(Q)||this.ASb.add(Q)}T7g(Q,wa){wa=wa.id;let eb;({value:eb}=this.dSb.Dc(wa)).returnValue||(eb=new ha.a,this.dSb.Z(wa,eb));eb.add(Q)}yYd(){const Q=new ha.a;for(let wa=
this.ASb.count-1;0<=wa;wa--){const eb=this.ASb.J(wa);this.ARf(eb)||Q.add(eb)}this.ASb=Q;this.hVe()}hVe(){this.VM&&this.VM.hVe()&&this.jgj(!1)}jgj(Q){this.VM&&(this.VM.nok(Q)&&(this.rAe=!0),this.iTg&&this.VM.$vn(),this.i8a.fgj(this.VM.HIc()),cj.WoncaApp.instance.Beb&&Xj.Vkf&&this.VM.y7f())}AYd(Q,wa){try{const eb=wa.id;if(this.dSb.xb(eb)){const Lb=this.dSb.J(eb);for(Q=0;Q<Lb.count;Q++)this.j7g(Lb.J(Q));this.dSb.remove(eb)}}catch(eb){}}WSd(){this.Upa&&(this.Upa=!1,Xj.rx.WSd())}VSd(){this.Upa||(this.Upa=
!0,Xj.rx.VSd())}MVn(){this.sAe=!1;this.Kfa&&this.K2c(this.Kfa.toArray(),this.Upa);this.A8&&this.A8.u3i()}kWl(){this.sAe=!0;Xj.rx.oLi();this.A8&&this.A8.A3h();this.CY&&this.CY.lWl()}Opd(Q,wa,eb,Lb,ec){const Tc=this.Kfa.indexOf(wa)+1;if(0>Tc)return null;const Ad=ag.WordSectionNavigator.instance.RL(Q),we=this.U$(wa,Q);Q=new Dn(eb,Tc,Q,wa,ec,Ad,!Q||!wa||!ec,!1,!1,we);this.TSa.xb(Lb.id)||this.TSa.Z(Lb.id,new ha.a);this.TSa.J(Lb.id).add(Q);return Q}U$(Q,wa){if(!Q||!Q.HardBreak)return!1;Q=Um.GraphIterator.$a(wa);
Q.Bb(7);if(Q.QG())return!1;Q.kd(23);return Q.QG()?!1:!0}JJi(Q){this.Upa&&(Q.anchor&&Q.Ti?!(Q=Xj.jri(Q))||this.xsb&&this.xsb.customData&&this.xsb.customData.id===Q.id||(this.xsb=Object.assign(new Yb.a(3,1,500,this.ihn),{customData:Q}),this.Hb.$b(this.xsb)):ja.ULS.sendTraceTag(6607198,336,10,"PageEndMarkers: Invalid node while redrawing page ends for outline group"))}J1d(){this.Upa&&!this.Xid&&this.Kfa&&0<this.Kfa.count&&(this.Xid=new Yb.a(3,1,500,this.hhn),this.Hb.$b(this.Xid))}dispose(){this.gf&&
this.Cxh();this.yY.jRf(this.kaa);this.EM.kRf(this.EFb)}static get Vkf(){null==Xj.kre&&(Xj.kre=H.AFrameworkApplication.K.$("ImageOverflowUpdateHeightIsEnabled"));return Xj.kre}static Prl(Q){let wa=0;try{const eb=Q.htmlElement,Lb=Ci.a.ZL(eb.firstChild.style.marginTop);Q=0;const ec=Xj.xff(eb.parentNode);if(ec){const Tc=ec.firstChild;Tc&&Tc.classList.contains("ParaWrappingDiv")&&(Q=Ci.a.ZL(Tc.firstChild.style.marginBottom))}wa=Math.max(Lb,Q)/2}catch(eb){}return wa}static xff(Q){let wa=Q.previousSibling;
if(!wa){var eb=Q.parentNode;Ci.a.qqf(eb)&&(eb=eb.parentNode)&&(wa=eb.previousSibling)}if(!wa&&(Q=Q.parentNode,Q.classList.contains(Ik.a.yAi)||ja.ULS.sendTraceTag(19711369,314,15,"Expected OutlineGroup but encountered a {0} element with classname {1}.",Q.tagName,Q.className),(Q=Q.previousSibling)&&Q.hasChildNodes())){wa=Q.lastChild;do{if(wa.classList.contains("OutlineElement")||Ci.a.qqf(wa)&&wa.classList.contains(aq.a.h8b))break;wa=wa.previousSibling}while(wa)}if(wa){if(wa.classList.contains(aq.a.h8b))return wa.lastChild.lastChild;
if(Ci.a.qqf(wa))return wa.lastChild}return wa}static jri(Q){Q=Um.GraphIterator.$a(Q);return Q.Bb(23)?Q.kd(23):null}mUh(){return this.kke+1}}Xj.rx=null;Xj.kre=null;Object(f.a)(Xj,"PageEndMarkers",null,[1973,1974,10]);var Yj=d(113);class Mm{constructor(Q,wa,eb){this.XYm=".Outline";this.AH=Q;this.Hm=wa;this.rx=eb}get gf(){const Q=this.AH.value;ja.ULS.shipAssertTag(38416594,336,Q.Ji,"Invalid PageView.");return Q}O1b(Q){return(Q=Q.outlineNode)?this.cUh(Q):(ja.ULS.shipAssertTag(38336522,336,!0,"Error getting last Outline DOM."),
null)}cUh(Q){let wa,eb;return(wa=Q.De(this.gf.Tb))&&(eb=wa.htmlElement)?eb.querySelector(this.XYm):(ja.ULS.shipAssertTag(39662425,336,!0,"Error getting last Outline DOM."),null)}RMh(Q){Q=Ap.OutlineElementNavigator.Uk(Q.paragraphNode);let wa;return Q&&(wa=Q.De(this.gf.Tb))?wa.htmlElement:(ja.ULS.shipAssertTag(38336525,336,!0,"Error calculating containing OE DOM."),null)}zhh(Q,wa){const eb=this.sNl(Q);return this.hok(Q,wa)-eb}jOh(Q){return this.iUh(Q.outlineNode,Q.yj)}iUh(Q,wa){if(!Q)return-1;var eb=
Q.ia(Lk.a.Xx,-1);eb=lm.a.Ni(eb,1);var Lb=Q.ia(Lk.a.marginTop,-1);Lb=lm.a.Ni(Lb,1);Q=Q.ia(Lk.a.marginBottom,-1);Q=lm.a.Ni(Q,1);return 1===wa?eb-Q:eb-(Lb+Q)}YQk(Q){Q&&Ci.a.dv(Q.lib)}rff(Q){if(Q.Hgi||Q.U$)return 0;if(Q.QZa)return Q=this.O1b(Q),ia.a.getElementBounds(Q).height/this.Hm.vj;const wa=this.O1b(Q);return this.rx.ITe(this.oUh(Q),wa)}nGk(Q,wa,eb){eb=eb.De(this.gf.Tb).getBounds();Q=Q.De(this.gf.Tb);const Lb=Q.getBounds();eb.y=Lb.y;wa=this.rx.pOh(0,wa*this.Hm.vj,!1,eb,eb,Lb);Q.M9.appendChild(wa);
return wa}J7h(Q,wa){if(Q&&!Q.irf)if(Q.QZa){if(Q=this.O1b(Q))Q.style.paddingBottom=wa+"px"}else if(Q.ZT&&Q.ZT.HardBreak)if(Q.U$){if(Q=this.AVh(Q))Q.style.paddingBottom=wa+"px"}else{if(Q=this.RMh(Q))Q.style.paddingTop=wa+"px"}else ja.ULS.shipAssertTag(39077394,336,!1,"Applying blank space on a page which is not hard break or last page.")}X9g(Q,wa){wa=this.O1b(wa);Q=this.O1b(Q);return ia.a.KKa(wa)-ia.a.KKa(Q)}BVh(Q){Q=Um.GraphIterator.$a(Q.outlineNode);Q.Bb(7);return Q.QG()}Pdi(Q){if(!Q||Q.irf)return!1;
if(Q.QZa||Q.Hgi)return!0;Q=this.oUh(Q);return!!Q&&Ci.a.P9(Q)}qQ(Q){this.rx.qQ(Q)}AVh(Q){return(Q=this.BVh(Q))?(Q=Q.Ui(this.gf.Tb).htmlElement,Q?Q:(ja.ULS.shipAssertTag(39126080,336,!0,"Section dom is null."),null)):null}oUh(Q){return Q.ZT&&Q.ZT.HardBreak&&!Q.U$?this.rx.$Fd(Q.lib):Q.lib}sNl(Q){if(Q.QZa){Q=this.O1b(Q);if(!Q)return ja.ULS.shipAssertTag(38336528,336,!0,"Last outline dom is null."),-1;Q=Yj.a.yB(Q);return Ci.a.vea(Q.paddingBottom)}if(Q.ZT&&Q.ZT.HardBreak){if(Q.U$)return(Q=this.AVh(Q))?
Ci.a.vea(Q.style.paddingBottom):-1;Q=this.RMh(Q);return Q?Ci.a.vea(Q.style.paddingTop):(ja.ULS.shipAssertTag(38336529,336,!0,"Containing outline element Dom is null."),-1)}return 0}hok(Q,wa){return this.rff(Q)-wa}}Object(f.a)(Mm,"PageFullHeightDOMHelper",null,[]);class Fq{constructor(){this.delta=this.Kjj=this.OB=0;this.Ifa=null;this.sKa=this.EEi=0;this.outlineGroupNode=null;this.iza=0;this.Vmf=new ha.a;this.$xd=new ha.a;this.sJm=new ha.a}}Object(f.a)(Fq,"PageFullHeightInfo",null,[]);class sp{constructor(Q,
wa){this.Bxa=Q;this.ux=wa}Jhh(Q,wa){try{return this.eok(Q,wa)}catch(eb){return this.ux.qQ(eb.message+" "+eb.stack),ja.ULS.sendTraceTag(38416595,336,10,"Exception caught in CalculatePageFullHeightInfo. Exception: {0}",eb.message),null}}eok(Q,wa){ja.ULS.shipAssertTag(38416596,336,Q.QZa||Q.ZT.HardBreak);const eb=this.ux.rff(Q),Lb=this.ux.zhh(Q,wa),ec=this.Bxa.whh(Q,Lb);Q=Object.assign(new Fq,{iza:Lb,sKa:ec,Ifa:Q});this.cho(Q);Q.Kjj=Q.sKa-Q.iza;Q.delta=wa+ec+Q.delta-eb;return Q}cho(Q){Q.iza>Q.sKa?this.dho(Q):
0>Q.iza&&this.c7f(Q)}c7f(Q){let wa=Q.Ifa.yj;for(;0>Q.iza;)Q.OB--,Q.delta-=this.Bxa.nHc(wa),Q.iza+=this.Bxa.nHc(wa-1),wa--;Q.sKa=this.Bxa.nHc(wa)}dho(Q){const wa=this.ux.jOh(Q.Ifa);Q.OB=Math.floor((Q.iza-Q.sKa)/wa)+1;Q.delta=Q.OB*wa;Q.iza-=Q.sKa+(Q.OB-1)*wa;Q.sKa=wa}}Object(f.a)(sp,"PageFullHeightInfoCalculator",null,[]);class Gq{constructor(Q,wa,eb,Lb){this.oUa=0;this.IIa=null;this.Bxa=Q;this.Erb=wa;this.IV=eb;this.ux=Lb;this.pWg=new ha.a}get xX(){return this.pWg}TRl(Q){try{this.Lif(Q)}catch(wa){this.ux.qQ(wa.message+
" "+wa.stack),ja.ULS.sendTraceTag(38148114,336,10,"Exception caught in HandlePageFullHeight. Exception: {0}",wa.message)}}reset(Q){try{this.pun(Q)}catch(wa){this.ux.qQ(wa.message+" "+wa.stack),ja.ULS.sendTraceTag(38637723,336,10,"Exception caught in PageFullHeightManager.Reset. Exception: {0}",wa.message)}}lWl(){try{this.mWl()}catch(Q){this.ux.qQ(Q.message+" "+Q.stack),ja.ULS.sendTraceTag(39153856,336,10,"Exception caught in PageFullHeightManager.HidePageFullHeights. Exception: {0}",Q.message)}}f4l(Q){try{this.g4l(Q)}catch(wa){this.ux.qQ(wa.message+
" "+wa.stack),ja.ULS.sendTraceTag(38916954,336,10,"Exception caught in PageFullHeightManager.InsertOrDeleteRenderedPages. Exception: {0}",wa.message)}}gon(Q){try{this.hon(Q)}catch(wa){this.ux.qQ("Pagination: "+wa.message+" "+wa.stack),ja.ULS.sendTraceTag(39387716,336,10,"Exception caught in PageFullHeightManager.RemovePageEndDetails. Exception: {0}",wa.message)}}e1l(){var Q=this.IV.Ccf(),wa=this.IV.LRh();Q=Dn.BIk(Q);wa=Dn.AIk(this.oUa,wa);this.xX.Z(0,Q);this.Lif(wa)}vun(){var Q=ag.WordSectionNavigator.instance.LRh();
(Q=this.ux.cUh(Q).parentNode)&&""!==Q.style.minHeight&&(Q.style.minHeight="")}$1l(Q){this.pWg=new ha.a;this.xX.add(null);for(let wa=0;wa<Q.length;wa++){const eb=Dn.IZb(wa+1,Q[wa]);this.xX.add(eb)}this.xX.add(Dn.IZb(Q.length+1,null))}L1l(Q){this.Bxa.Cun(Q)}$un(){if(this.xX)for(let Q of this.xX)Q&&this.Gbi(Q)&&this.ux.J7h(Q,0)}Lif(Q){const wa=this.UCl(Q);if(this.ux.Pdi(wa)){let eb=this.ux.rff(wa);Q.outlineNode!==wa.outlineNode&&(eb+=this.ux.X9g(Q,wa));this.nnk(Q,eb);this.Gbi(Q)&&this.BRf(Q,eb)}else this.IIa.add(Q),
20<this.IIa.count&&ja.ULS.sendTraceTag(39982428,336,15,"Count of _waitingForPreviousPage is "+this.IIa.count);this.xX.Z(Q.yj,Q);this.LRl(Q)}mWl(){this.$un()}pun(Q){this.oUa=Q.length+1;this.IIa=new ha.a;this.$1l(Q);this.L1l(this.oUa);this.e1l();this.vun()}g4l(Q){this.Bxa.qio(Q);for(let wa of Q){if(!wa){ja.ULS.sendTraceTag(38916955,336,10,"info is null.");return}if(0<wa.OB){Q=wa.Ifa.yj;for(let eb of wa.Vmf)this.xX.insert(Q,eb),Q++}else if(0>wa.OB)for(let eb of wa.$xd)this.xX.remove(eb),this.IIa.contains(eb)&&
this.IIa.remove(eb)}this.uOi()}hon(Q){Q=Q.yj;this.Bxa.ion(Q);this.xX.removeAt(Q);for(let wa of this.IIa)wa.yj===Q&&this.IIa.remove(wa);this.uOi()}nnk(Q,wa){wa=this.ux.zhh(Q,wa);this.Bxa.whh(Q,wa)}BRf(Q,wa){Q.ZT&&Q.ZT.HardBreak||this.Erb.BRf(Q,wa)}LRl(Q){Q=Q.yj+1;for(let wa of this.IIa)if(wa&&wa.yj===Q){this.Lif(wa);this.IIa.remove(wa);break}}uOi(){for(let Q=0;Q<this.xX.count;Q++){const wa=this.xX.J(Q);wa&&wa.R5d(Q)}}Gbi(Q){Q=this.jAl(Q);return 2===Q||1===Q}UCl(Q){return this.xX.J(Q.yj-1)}jAl(Q){return Q.QZa?
2:Q.ZT&&Q.ZT.HardBreak?1:0}}Object(f.a)(Gq,"PageFullHeightManager",null,[2007]);class bq{constructor(Q,wa,eb,Lb){this.Erb=Q;this.Bxa=wa;this.IV=eb;this.ux=Lb}create(){return new Gq(this.Bxa,this.Erb,this.IV,this.ux)}}Object(f.a)(bq,"PageFullHeightManagerFactory",null,[]);var bp=d(1054),Zr=d(587);class Zm{constructor(Q,wa,eb,Lb,ec){this.BSb=null;this.CY=Q;this.VM=wa;this.tsc=eb;this.Erb=Lb;this.ux=ec}reset(){this.BSb=new ha.a}dok(Q,wa,eb){try{return this.fok(Q,wa,eb)}catch(Lb){return ja.ULS.sendTraceTag(38897350,
336,10,"Exception caught in PageFullHeightPositionUpdater.CalculatePageFullHeight. Exception: {0}",Lb.message),null}}Xvn(){try{this.Yvn()}catch(Q){ja.ULS.sendTraceTag(38897351,336,10,"Exception caught in PageFullHeightPositionUpdater.RestorePageFullHeights. Exception: {0}",Q.message)}}fok(Q,wa,eb){if(!this.CY.xX.count)return null;const Lb=this.pAl(Q,!Q);if(!Lb||Lb.irf)return ja.ULS.sendTraceTag(38897352,336,10,"PageEndDetail is null for the given PageEndMarker"),null;if(Lb.ZT&&Lb.ZT.HardBreak)return null;
var ec=this.CY.xX.J(Lb.yj-1);return this.ux.Pdi(ec)&&(wa-=eb,Lb.outlineNode!==ec.outlineNode&&(wa+=this.ux.X9g(Lb,ec)),(ec=this.tsc.Jhh(Lb,wa))&&1<Math.abs(ec.delta))?(ec.EEi=wa,ec.outlineGroupNode=this.Wzl(Q,Lb),this.BSb.add(ec),this.c7f(ec),ec):null}Wzl(Q,wa){return wa&&wa.QZa?(Q=Object(Ca.a)(Zr.a,Qj.ParagraphReader.TJ(wa.outlineNode)),Q=Um.GraphIterator.$a(Q),Q.qo(),Object(Ca.a)(bp.a,Q.kd(23))):Q&&Q.xfb?Q.outlineGroupNode:null}Yvn(){this.BSb.Sc((Q,wa)=>wa.Ifa.yj-Q.Ifa.yj);for(let Q of this.BSb)this.Erb.bOi(Q);
this.tio()}tio(){this.VM.value.d4l(this.BSb);this.CY.f4l(this.BSb)}pAl(Q,wa){return wa?this.CY.xX.J(this.CY.xX.count-1):this.CY.xX.J(Q.yj)}c7f(Q){let wa=Q.Ifa.yj;const eb=-Q.OB;for(let Lb=0;Lb<eb;Lb++)wa--,Q.$xd.add(this.CY.xX.J(wa))}}Object(f.a)(Zm,"PageFullHeightPositionUpdater",null,[2006]);class Kn{constructor(Q,wa,eb,Lb,ec){this.CY=Q;this.VM=wa;this.tsc=eb;this.Erb=Lb;this.ux=ec}create(){return new Zm(this.CY,this.VM,this.tsc,this.Erb,this.ux)}}Object(f.a)(Kn,"PageFullHeightPositionUpdaterFactory",
null,[]);class Vq{constructor(Q,wa){this.ux=Q;this.tsc=wa}BRf(Q,wa){try{this.jrn(Q,wa)}catch(eb){this.ux.qQ(eb.message+" "+eb.stack),ja.ULS.sendTraceTag(38285912,336,10,"Exception caught in RenderPageFullHeight. Exception: {0}",eb.message)}}bOi(Q){try{this.irn(Q)}catch(wa){this.ux.qQ(wa.message+" "+wa.stack),ja.ULS.sendTraceTag(38855577,336,10,"Exception caught in RenderPageFullHeightInfo. Exception: {0}",wa.message)}}jrn(Q,wa){ja.ULS.shipAssertTag(38285913,336,Q.QZa||Q.ZT.HardBreak);Q=this.tsc.Jhh(Q,
wa);this.bOi(Q)}irn(Q){this.hrn(Q);this.$qn(Q)}$qn(Q){0<Q.OB?this.p4l(Q):0>Q.OB&&this.ZQk(Q)}hrn(Q){this.ux.J7h(Q.Ifa,Q.Kjj)}p4l(Q){let wa=Q.EEi+Q.sKa;for(let Lb=0;Lb<Q.OB;Lb++){var eb=Q.Ifa.yj+Lb;const ec=Q.Ifa.U$?this.ux.BVh(Q.Ifa):Q.Ifa.outlineNode;eb=this.mGk(ec,Q.outlineGroupNode,wa,eb);Q.Vmf.add(eb);Q.sJm.add(wa);wa+=Q.sKa}}ZQk(Q){for(let wa of Q.$xd)this.ux.YQk(wa)}mGk(Q,wa,eb,Lb){wa=this.ux.nGk(Q,eb,wa);return Dn.ZYe(eb,Lb,wa,Q,!1,!1)}}Object(f.a)(Vq,"PageFullHeightRenderer",null,[]);class Hq{constructor(Q){this.qOf=
Q}}Object(f.a)(Hq,"PageHeightDeltaResult",null,[1843]);class nm{constructor(Q,wa,eb){this.Sp=null;this.ux=Q;this.Ih=wa;eb.execute(Lb=>{Lb.register(this)})}get Dyf(){return"PageHeightDelta"}get result(){return this.Sp}get ECf(){return 1}get EUf(){return 500}get isEnabled(){return!0}KCf(){this.Sp=null}vVa(Q){this.Ih.Pd(()=>{try{this.rzc(Q)}catch(wa){ja.ULS.sendTraceTag(39188045,324,10,"Exception caught in PageHeightDeltaMetric.Calculate. Exception: {0}",wa.message)}},"PHDM:C")}rzc(Q){this.Sp=null;Q=
this.szc(Q);-1!==Q&&(this.Sp=new Hq(Q))}szc(Q){if(!Q.count)return-1;let wa=0,eb=0;for(let Lb of Q)Q=this.gok(Lb),-1!==Q&&(wa+=Q,eb++);return eb?wa/eb:-1}gok(Q){if(!Q.Ham)return-1;const wa=this.ux.iUh(Q.Yrd,Q.yj);return-1===wa?-1:Math.abs(Q.height-wa)}}Object(f.a)(nm,"PageHeightDeltaMetric",null,[1812]);class cp{constructor(Q){this.LRa=null;this.ux=Q}nHc(Q){return this.LRa.J(Q-1)}Cun(Q){this.LRa=new ha.a;for(let wa=0;wa<Q;wa++)this.LRa.add(-1)}whh(Q,wa){if(this.Efm(Q))return this.LRa.J(Q.yj-1);wa=
this.Enk(Q,wa);this.W0n(Q,wa);return wa}qio(Q){for(let wa of Q)this.pio(wa)}W0n(Q,wa){this.LRa.Z(Q.yj-1,wa)}ion(Q){this.LRa.removeAt(Q-1)}pio(Q){if(Q)if(0<Q.OB){var wa=Q.Ifa.yj;for(var eb=0;eb<Q.OB;eb++)this.LRa.insert(wa,Q.sKa)}else if(0>Q.OB)for(wa=-Q.OB,Q=Q.Ifa.yj-wa,eb=0;eb<wa;eb++)this.LRa.removeAt(Q)}Efm(Q){return-1!==this.LRa.J(Q.yj-1)}Enk(Q,wa){if(Q.QZa||Q.ZT.HardBreak)Q=this.ux.jOh(Q),wa=wa<Q?Q:wa;return wa}}Object(f.a)(cp,"PageHeightStorage",null,[]);var ln=d(120);class ml{constructor(Q){this.qOf=
Q}}Object(f.a)(ml,"PageLevelDeltaResult",null,[1843]);class tp{constructor(Q,wa,eb,Lb){this.Sp=null;this.AH=Q;this.wqa=wa;this.Ih=eb;Lb.execute(ec=>{ec.register(this)})}get gf(){const Q=this.AH.value;ja.ULS.shipAssertTag(39081438,336,Q.Ji,"PageLevelDeltaMetric.PageView is not a PageView.");return Q}get Dyf(){return"PageLevelDelta"}get result(){return this.Sp}get ECf(){return 0}get EUf(){return 60}get isEnabled(){return!0}KCf(){this.Sp=null}vVa(Q){this.Ih.Pd(()=>{try{this.rzc(Q)}catch(wa){ja.ULS.sendTraceTag(39081440,
324,10,"Exception caught in PageLevelDeltaMetric.Calculate. Exception: {0}",wa.message)}},"PLDM:C")}rzc(Q){this.Sp=null;Q=this.szc(Q);-1!==Q&&(this.Sp=new ml(Q))}szc(Q){if(!Q.count)return-1;let wa=0,eb=0;for(let Lb of Q)Q=this.iok(Lb),-1!==Q&&(wa+=Q,eb++);return eb?wa/eb:-1}iok(Q){if(Q.xfb)return-1;var wa=Q.ZT.CP;Q=Q.paragraphNode;ja.ULS.shipAssertTag(39081441,336,!!Q);Q=Q.De(this.gf.Tb);ja.ULS.shipAssertTag(39081442,324,Object(ln.a)(80,Q));let eb;({Tqh:wa,eji:Q,yRi:eb}=this.Vnk(Q,Ci.a.Iz(Q.htmlElement).length,
wa));return Q&&eb?Math.min(wa.x-Q.x,eb.x-wa.x):(ja.ULS.sendTraceTag(39081443,336,50,"There was a problem calculating the line boundaries in PageLevelDeltaMetric.CalculatePageLevelDelta."),-1)}Vnk(Q,wa,eb){let Lb,ec,Tc,Ad=ec=eb,we=Tc=Lb=null;if(eb>wa)return ja.ULS.sendTraceTag(39081472,336,50,"cp > paragraph text length in FidelityTelemetryManager.CalculatePageLevelDelta."),{Tqh:we,epm:Ad,eji:Tc,Ixn:ec,yRi:Lb};we=this.wqa.qq(Q,eb);for(var Rd=0,yf=eb;Rd<=yf;){let rg=Math.floor((Rd+yf)/2),vi=this.wqa.qq(Q,
rg);if(Rd===yf){Ad=rg;Tc=vi;break}vi.y+vi.height<=we.y?Rd=rg+1:yf=rg}for(;eb<=wa;){Rd=Math.ceil((eb+wa)/2);yf=this.wqa.qq(Q,Rd);if(eb===wa){ec=Rd;Lb=yf;break}yf.y>=we.y+we.height?wa=Rd-1:eb=Rd}return{Tqh:we,epm:Ad,eji:Tc,Ixn:ec,yRi:Lb}}}Object(f.a)(tp,"PageLevelDeltaMetric",null,[1812]);class Dp{constructor(Q,wa,eb,Lb,ec,Tc,Ad){this.yj=Q;this.top=wa;this.O4g=eb;this.height=Lb;this.VKb=ec;this.Yrd=Tc;this.Ham=Ad}}Object(f.a)(Dp,"Page",null,[]);class U{constructor(Q,wa,eb,Lb,ec){this.tSb=null;this.F0g=
0;this.AH=Q;this.d9c=wa;this.gTg=eb;this.LHa=Lb;this.jTg=ec;this.VSa=new ha.a}get gf(){const Q=this.AH.value;ja.ULS.shipAssertTag(37007393,336,Q.Ji,"PageManager.PageView is not a PageView.");return Q}get pages(){return this.VSa}fgj(Q){Q=this.JIi(Q);this.hgj(Q)}nio(Q,wa){this.F0g=wa;Q=this.JIi(Q);this.hgj(Q);this.jTg.isEnabled&&this.jTg.vVa(Q)}JIi(Q){this.VSa=new ha.a;this.tSb=new Uq.a(0);const wa=new ha.a;if(!Q)return this.pages;var eb=0,Lb=null;for(let ec=0;ec<Q.count;ec++){const Tc=Q.J(ec);eb=Tc.yj;
Lb=this.Iwd(eb,Lb,Tc);this.pages.add(Lb);!U.tye&&0>Lb.height&&wa.add(Lb);Lb=Tc}Q=this.Iwd(eb+1,Lb,null);this.pages.add(Q);!U.tye&&0>Q.height&&wa.add(Q);for(let ec of wa)U.tye=!0,ja.ULS.shipAssertTag(50968670,336,!1,"Page: height parameter value is negative for page "+ec.yj);return this.pages}Iwd(Q,wa,eb){const Lb=wa?wa.outlineNode:this.LHa.rPh(),ec=eb?eb.outlineNode:this.LHa.VRh();var Tc=this.jUh(Lb);const Ad=this.jUh(ec),we=wa?this.Hhh(wa):0;Tc=we+Tc;const Rd=eb?this.Hhh(eb):this.d9c.E0a.clientHeight-
Ad;return new Dp(Q,we,Tc,Lb.id===ec.id?Rd-we:Rd+Ad-Tc,Lb,ec,(eb?eb.yj:this.F0g+1)===(wa?wa.yj:0)+1)}Hhh(Q){return Q.U$?0:Q.top}hgj(Q){if(this.gTg.uYd)for(let wa of this.gTg.uYd)wa&&wa.igj(Q)}jUh(Q){this.tSb||(this.tSb=new Uq.a(0));if(this.tSb.xb(Q.id))return this.tSb.J(Q.id);var wa=Q.De(this.gf.Tb);if(!wa)return ja.ULS.sendTraceTag(37052758,336,15,"OutlineViewElement is null in PageManager.GetOutlineTop."),0;wa=ia.a.hYa(this.d9c.E0a,wa.htmlElement).y;this.tSb.Z(Q.id,wa);return wa}}U.tye=!1;Object(f.a)(U,
"PageManager",null,[1813]);var la=d(625);class gb{constructor(Q,wa,eb,Lb,ec,Tc,Ad){this.r8f=this.G0a=!1;this.ga=Q;this.U8=wa;this.jRa=eb;this.kt=Lb;this.xi=ec;this.lTg=Tc;this.xE=Ad;this.G0a=0===this.xE.Hx?!0:!1;this.JDf=this.JDf.bind(this);this.xE.E8g(this.JDf)}Vb(){this.ga.gb(mf.a.MVc,th.a.application,this.MVc.bind(this),96);this.ga.gb(mf.a.P0d,th.a.application,this.P0d.bind(this),96);this.ga.gb(mf.a.L$d,th.a.application,this.L$d.bind(this),96);this.ga.gb(mf.a.I$d,th.a.application,this.I$d.bind(this),
8)}L$d(Q,wa,eb){return 1===eb?32:this.ga.processAction(mf.a.XPa,2)}I$d(Q,wa,eb,Lb){if(1===eb)return 0===this.xE.Hx?32:8;this.G0a?(this.vyh(),this.r8f=!0):(this.KBh(),this.r8f=!1);this.xi.updateCommandUI();Lb.Jr=this.G0a?1:0;return 32}MVc(Q,wa,eb,Lb,ec){if(1===eb)return 32;Q=this.lTg.dJc();-1===Q?Q="":this.G0a||1===this.xE.Hx?(wa=this.lTg.Aml(),wa>Q&&(Q=wa),Q=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,wa,Q)):Q=1===Q?String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,
Q):String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,Q);ec[la.a.Visible]=!0;ec[la.a.LabelText]=Q;return 32}P0d(Q,wa,eb,Lb,ec){if(1===eb)return 32;ec[wl.a.On]=this.G0a;return 32}JDf(Q,wa){0!==wa.t9b||this.r8f?this.vyh():this.KBh()}KBh(){this.G0a||(this.jRa.r_k(),this.kt.MVn(),this.G0a=!0)}vyh(){this.G0a&&(this.jRa.zUk(),this.kt.kWl(),this.G0a=!1)}}Object(f.a)(gb,"PaginationActor",null,[]);class Kb{constructor(Q){this.qOf=Q}}Object(f.a)(Kb,"PaginationDeltaResult",null,[1843]);class ub{constructor(Q,
wa){this.$rb=this.h$c=null;this.Ih=Q;wa.execute(eb=>{eb.register(this)})}get Dyf(){return"PaginationDelta"}get result(){return this.h$c}get ECf(){return 1}get EUf(){return 200}get isEnabled(){return!0}KCf(){this.h$c=null}vVa(Q){this.Ih.Pd(()=>{try{this.rzc(Q)}catch(wa){ja.ULS.sendTraceTag(39686615,324,10,"Exception caught in PaginationDeltaMetric.Calculate. Exception: {0}",wa.message)}},"PDM:C")}o1f(Q){this.$rb=Q}rzc(Q){this.h$c=null;Q=this.szc(this.$rb,Q);-1!==Q&&(this.h$c=new Kb(Q))}szc(Q,wa){if(!(Q&&
wa&&Q.count&&wa.count))return-1;const eb=new ha.a;for(let Lb of Q)eb.add(Lb.top);Q=new ha.a;for(let Lb of wa)Q.add(Lb.top);wa=this.KBd(eb,Q);return this.$Yb(wa)}$Yb(Q){if(!Q.count)return 0;let wa=0;for(let eb=0;eb<Q.count;eb++)wa+=Q.J(eb);return wa/Q.count}KBd(Q,wa){const eb=new ha.a;if(!Q.count||!wa.count)return eb;var Lb=Q.count<=wa.count;const ec=Lb?Q:wa;Q=Lb?wa:Q;for(wa=0;wa<ec.count;wa++){Lb=ec.J(wa);let Ad=Math.abs(Lb-Q.J(0)),we=0;for(let Rd=1;Rd<Q.count;Rd++){var Tc=Q.J(Rd);Tc=Math.abs(Lb-
Tc);Tc<Ad&&(Ad=Tc,we=Rd)}eb.add(Ad);Q.removeAt(we)}return eb}}Object(f.a)(ub,"PaginationDeltaMetric",null,[1812]);var Cc=d(404),nd=d(1371),wd=d(1893);class Le extends Cc.a{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we=null){super();this.OM=null;this.jke=0;this.oUa=-1;this.opb=!1;this.P6=()=>{ja.ULS.sendTraceTag(7422755,336,50,"PaginationReplicator: disabling replication as user kicked out");this.xyh()};this.hFf=()=>{if(0==this.yY.Hx){var Rd=this.OM.$t;tf.a.Dp(Rd,this.ARb)||(this.ARb=Rd,this.URm(this.nHa,this.ARb))}};
this.yY=Q;this.kaa=this.kaa.bind(this);this.yY.Qub(this.kaa);this.ga=wa;this.kt=eb;this.hY=Lb;this.Fia=ec;this.owe=we||zp.a.instance;this.ARb=this.nHa=tf.a.nil;this.qJj=Ad;Tc.CWR(()=>Tc.result.QA.TUa(this.P6));this.A_b();this.Vj=new nd.a(1E3);this.Vj.vWa();this.Fia.register(this)}get tma(){return"Pagination"}get O_b(){return this.qJj.value}get Znm(){return this.nHa}get $$i(){return this.oUa}tOn(Q){this.oUa!==Q&&(this.oUa=Q,this.hY.n7f())}kaa(){this.nHa=this.ARb=tf.a.nil;this.A_b()}Mhb(Q){this.OM=
Q;this.OM.xWb(this.hFf);this.hWb(this.OM.node)}URm(Q,wa){tf.a.Dp(Q,wa)?(this.kt.VSd(),this.A_b()):(this.kt.WSd(),this.P_n())}x_k(){this.enabled=2}A_b(){this.enabled=0}P_n(){this.jke=0;this.x_k();this.bE(null,null,null)}nla(){return qe.App.lostSession||qe.App.rd.QA.io?!1:!!(this.enabled&2)&&this.Vj.zW()}bE(){this.Vj.vcb();this.Fia.gU()}forceOutbound(){}f2(){return 0===this.enabled?!1:this.he&&2===this.he.status?!0:this.nla()}wOa(){if(1===this._state)this.he.Vr=wd.a.A9(H.AFrameworkApplication.rootQuerySignature,
this.nHa),this.he.WG="Pagination",this.he.status=1,this._state=3;else if(3===this._state&&this.he&&2===this.he.status)if(H.AFrameworkApplication.Dk)this._state=4;else if(this.Vj.O_(),this.Vj.i6(),this._state=1,this.jke++,2!==this.he.statusCode)this.B_b();else if(1!==(this.he.hk?this.he.hk.length:0))this.B_b();else{var Q=this.he.hk[0];this.owe.Ulb(Q);104===Q.StatusCode?this.xyh():101===Q.StatusCode?this.B_b():3===Q.StatusCode?this.B_b():Q.StatusCode?this.B_b():Q.PageEnds?(this.tOn(Q.PageEnds.length+
1),this.nHa=Bj.b(Q.LastKnownPaginationRevision),ja.ULS.sendTraceTag(7479449,336,50,"PaginationReplicator: Start rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.oUa,this.nHa),this.kt.K2c(Q.PageEnds,tf.a.Dp(this.nHa,this.ARb)),this.O_b.Kfa=Q.PageEnds,this.hY.ETe(),ja.ULS.sendTraceTag(5870302,336,50,"PaginationReplicator: Finished rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.oUa,this.nHa),
this.IUk()):this.B_b()}}xyh(){this.OM&&this.OM.PHb(this.hFf);this.A_b()}B_b(){60<this.jke&&this.A_b()}IUk(){tf.a.Dp(this.nHa,this.ARb)&&this.A_b()}dispose(){this.OM&&(this.OM.PHb(this.hFf),this.OM.node&&this.RWc(this.OM.node),this.OM=null);this.yY.jRf(this.kaa)}hWb(Q){Q&&(Q.addListener(this),this.opb=!0)}RWc(Q){this.opb&&Q&&(Q.removeListener(this),this.opb=!1)}NFb(Q){this.RWc(Q)}onBeforeLoadContent(){}onAfterLoadContent(Q){(Q=Q.Ad.Im)&&this.UOm(this.nHa,Q.id)}onAfterFirstSaveContent(){}UOm(Q,wa){tf.a.Dp(Q,
wa)&&this.kt.VSd()}}Object(f.a)(Le,"PaginationReplicator",Cc.a,[1811,10,42]);class kf{constructor(){this.A8=this.kt=this.hY=this.jRa=this.Pu=null;this.Kpa=!1;this.T$j=()=>{this.X$g()}}get name(){return"WordEditor.Pagination"}get $po(){return H.AFrameworkApplication.K.$("WordEditorPageEndMarkerPositionUpdaterIsEnabled")}zc(Q){this.W=Q;this.wc=this.W.resolve("Box4.IFeatureHelper");this.W.ha("WordEditor.Pagination.PageElementManagerList",()=>new tj(this.W.resolve("WordEditor.Pagination.PageAdornmentManager"),
this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.OutlineManager",()=>new Hk(new kb.a(()=>qe.App.xa.jb.Jc))).as("WordEditor.Pagination.IOutlineManager").singleInstance();this.W.ha("WordEditor.Pagination.PageManager",()=>new U(new kb.a(()=>qe.App.xa.jb.Jc),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),this.W.resolve("WordEditor.Pagination.PageElementManagerList"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageHeightDeltaMetric"))).as("WordEditor.Pagination.IPageManager").singleInstance();
this.W.ha("WordEditor.IPaginationReplicator",()=>new Le(this.W.resolve("WordEditor.IMainViewModeManager"),H.AFrameworkApplication.ya,this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"),Ji.App.z_,qe.App.jla(),new kb.a(()=>this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings")))).singleInstance();this.W.ha("WordEditor.ICurrentPageManager",()=>new rp(this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).singleInstance();
this.W.ha("WordEditor.Pagination.PageLevelDeltaMetric",()=>new tp(new kb.a(()=>qe.App.xa.jb.Jc),this.W.resolve("Box4.ITextMetricsAdapter"),Za.a.instance,this.W.Za("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PageHeightDeltaMetric",()=>new nm(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),Za.a.instance,this.W.Za("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PaginationDeltaMetric",
()=>new ub(Za.a.instance,this.W.Za("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PageHeightStorage",()=>new cp(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightDOMHelper",()=>new Mm(new kb.a(()=>qe.App.xa.jb.Jc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightInfoCalculator",
()=>new sp(this.W.resolve("WordEditor.Pagination.PageHeightStorage"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightRenderer",()=>new Vq(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory",()=>new Kn(this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),
this.W.Ye("WordEditor.Pagination.PageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"),this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightPositionUpdater",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory").create()).singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkerPositionUpdater",
()=>new ur(new kb.a(()=>qe.App.xa.jb.Jc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),qe.App.Wj.al)).as("WordEditor.Pagination.IPageEndMarkerPositionUpdater").singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightManagerFactory",()=>new bq(this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),
this.W.resolve("WordEditor.Pagination.PageHeightStorage"),ag.WordSectionNavigator.instance,this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightManager",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightManagerFactory").create()).singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkerPositionComparer",()=>new ap(this.W.resolve("Common.IZoomManager"),Za.a.instance)).as("WordEditor.Pagination.IPageEndMarkerPositionComparer").singleInstance();
this.W.ha("WordEditor.Pagination.PaginationActor",()=>new gb(H.AFrameworkApplication.ya,this.W.resolve("WordEditor.IStatusBarUser"),this.W.resolve("WordEditor.ICurrentPageManager"),this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),H.AFrameworkApplication.ua,this.W.resolve("WordEditor.IPageNumberFinder"),this.W.resolve("WordEditor.IMainViewModeManager"))).singleInstance();this.W.ha("WordEditor.Pagination.DocumentSizeManager",()=>new mj(new kb.a(()=>qe.App.xa.jb.Jc),Yr.a.get_instance(),this.W.resolve("WordEditor.IMainViewModeManager"))).singleInstance();
this.W.ha("WordEditor.Pagination.CurrentPageCalculator",()=>new No(H.AFrameworkApplication.ya,ue.a.instance,Tf.a.instance,this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),new kb.a(()=>qe.App.xa.jb.Jc),this.W.Pa("Box4.CpConversionManagerImpl"),this.W.resolve("WordEditor.IStatusBarUser"))).as("Common.ICurrentPageCalculator").singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkers",()=>this.kt=new Xj(new kb.a(()=>qe.App.xa.jb.Jc),new kb.a(()=>qe.App.xa.jb.Zc.Ad),this.W.resolve("WordEditor.Pagination.IPageAdornmentManager"),
this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionComparer"),this.W.resolve("WordEditor.Pagination.IPageManager"),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),Bp.a.mIc,this.W.resolve("WordEditor.ParagraphWordIdMapping"),Tf.a.instance,Xj.Prl,this.W.resolve("Box4.ContentEditableViewEventSource"),new Mo.a,this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),
this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),null,this.W.resolve("WordEditor.Pagination.PaginationDeltaMetric"),this.W.resolve("Common.ICurrentPageCalculator"),this.$po,this.W.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.Pagination.IPageEndMarkers").as("Box4.IPaginationRefreshHelper").singleInstance();this.W.ha("WordEditor.Pagination.PageEndDOMHelper",()=>new Zi(this.W.Za("Common.IZoomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),
!!qe.App.instance&&qe.App.instance.yA)).singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentAnimationManager",()=>new jh(H.AFrameworkApplication.uc)).as("WordEditor.Pagination.IPageAdornmentAnimationManager").singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentContentManager",()=>new Km(this.W.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Pagination.IPageAdornmentContentManager").singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentManager",
()=>this.A8=new mm(new kb.a(()=>qe.App.xa.jb.Jc),kk.a.instance,sn.a.instance,bd.a.instance,H.AFrameworkApplication.ya,Hf.a.instance,this.W.resolve("WordEditor.Pagination.IPageAdornmentAnimationManager"),this.W.resolve("WordEditor.Pagination.IPageAdornmentContentManager"),this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),Tf.a.instance,H.AFrameworkApplication.K,!!qe.App.instance&&qe.App.instance.yA,!!qe.App.instance&&qe.App.instance.Rla)).as("WordEditor.Pagination.IPageAdornmentManager").singleInstance()}init(){this.wc.Yk.continueWith(()=>
{this.Nm()})}Nm(){const Q=qe.App.xa.jb;Q.fta?this.X$g():Q.Zca(this.T$j)}X$g(){this.Kpa||(this.Kpa=!0,this.jRa=ea.a.instance.resolve("WordEditor.ICurrentPageManager"),this.hY=ea.a.instance.resolve("Common.ICurrentPageCalculator"),this.Pu=ea.a.instance.resolve("WordEditor.IPaginationReplicator"),ea.a.instance.resolve("WordEditor.Pagination.PaginationActor").Vb())}dispose(){this.A8&&(this.A8.dispose(),this.A8=null);this.kt&&(this.kt.dispose(),this.kt=null);this.Pu&&(this.Pu.dispose(),this.Pu=null);this.hY&&
(this.hY.disable(),this.hY=null);this.jRa&&(this.jRa=null)}}Object(f.a)(kf,"PackageManager",null,[1,2]);class ng{constructor(){this.W=null}zc(Q){this.W=Q||ea.a.instance}dispose(){}}Object(f.a)(ng,"TellMePackage",null,[1,2]);var bg=d(1457),Xf=d(1460),Ih=d(282),sg=d(1456),bh=d(1359);class Ag{constructor(Q=null,wa=null,eb=null,Lb,ec=null){this.Rfe=null;this.Lsg=!1;this.VCg=this.hNb=null;this.ITj=this.DZg=this.muj=this.WCg=!1;this.Q7c=null;this.Buj=null==wa?H.AFrameworkApplication.nvb:wa;this.cGj=null==
eb?H.AFrameworkApplication.yZ:eb;this.qUj=null==ec?H.AFrameworkApplication.D2a:ec;this.HEj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMeHelpOnHelpIsEnabled");this.aWj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled");this.rOn(!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMeIgnoreQueryForHelp"));this.SVj=!!H.AFrameworkApplication.ua&&H.AFrameworkApplication.ua.Sb.JOc;this.TVj=!sg.a.K$()&&!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMePeopleSuggestionIsEnabled");
this.RVj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMeFileSuggestionIsEnabled");this.vBj=!!H.AFrameworkApplication.ua&&H.AFrameworkApplication.ua.Sb.EJb;this.UVj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.kTj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("HelpShowsTopSearchResult");this.BNj=this.q_c||this.p_c;this.zNj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("OnlineCommandSuggestionsIsEnabled");
this.ANj=this.Eqf;this.uIj=!!H.AFrameworkApplication.K&&this.OPa&&H.AFrameworkApplication.K.$("StyledHeaderInLabelIsEnabled");this.cDj=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.MDj=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.RCj=H.AFrameworkApplication.K?parseFloat(H.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold",
"-0.6")):-.6;this.rIj=!!H.AFrameworkApplication.K&&(H.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.$Uj=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.QDj=H.AFrameworkApplication.K?
H.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.lTj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.bUj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",!1);this.ETj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("ShowFindInDocumentInZeroTermSearchBox")||
this.PQ;this.EIj=!!H.AFrameworkApplication.K&&(H.AFrameworkApplication.K.$("TellMeTemplateProviderIsEnabled")||H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.PHj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);this.kIj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMeIsRuleBasedSortingEnabled")&&"en-US"===
H.AFrameworkApplication.uiCulture;this.BIj=!!H.AFrameworkApplication.K&&(H.AFrameworkApplication.K.$("TellMeFeedbackProviderIsEnabled")||H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.PIj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMeZeroTermContextualCommandSuggestionsEnabled");this.ouj=this.OPa&&!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",
!1);this.qEj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.hUj=!!H.AFrameworkApplication.K&&(H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==H.AFrameworkApplication.K.lb("Application"));this.Ovj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",
!1);this.LXj=!!H.AFrameworkApplication.K&&(H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UsePerformanceMarker",!1)||H.AFrameworkApplication.K.$("TellMePerformanceMarkerEnabled"));this.yGj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.HGj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",
!1);this.lIj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchDescriptionEnabled",!1);this.bSj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SearchAddinByKeywords",!1);this.utj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinSearchKeywordsContainDescription",!1);this.LDj=H.AFrameworkApplication.K?
H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.DIj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMeNotesSuggestionIsEnabled")||this.Ujm;this.SDj=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreRequestTimeOut",4E3):4E3;this.RDj=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreDelayRequestTimeOut",
1E3):1E3;this.TDj=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeQueryAddinStoreAddinCount",5):5;this.BDj=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.OfficeAddinStoreEndPointUrl","https://api.addins.store.office.com"):"https://api.addins.store.office.com";this.DGj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchCheckTitleEnabled",
!1);this.zGj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchCheckTitleEnabled",!1);this.CGj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchCheckRatingEnabled",!1);this.AGj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchCheckNumberOfVotesEnabled",!1);this.NCj=H.AFrameworkApplication.K?
H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchCheckAddinMinCount",1):1;this.PCj=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchQueryTextMinLength",1):1;this.OCj=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchQueryTextMaxLength",100):100;this.FDj=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchRatingBarForAddinSearch",
1):1;this.zDj=H.AFrameworkApplication.K?H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchNumberOfVotesBarForAddinSearch",5):5;this.BGj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchCheckQueryTextEnabled",!1);this.FGj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.GGj=
!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",!1);this.EGj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.VVj=this.ygi&&(this.KHf||this.LHf||this.hTc||this.OPa&&sg.a.bCa()&&!!H.AFrameworkApplication.K&&(this.Vdc||this.IJb||this.JJb||this.KJb||this.MJb||H.AFrameworkApplication.K.$("ShowAnswerSearchResults")||
H.AFrameworkApplication.K.$("ShowDefinitionSearchResults")||H.AFrameworkApplication.K.$("ShowEntitySearchResults")||H.AFrameworkApplication.K.$("ShowWolframSearchResults")));this.vtj=!!H.AFrameworkApplication.K&&!H.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&H.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&H.AFrameworkApplication.jvb;this.wtj=!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("AppsForOfficePrivateCatalogIsEnabled");this.O0l(Q||{});this.OEe=
"2918242107";this.NEe="1454393937";this.Nrb={};this.L9a=[];this.fDk=[sg.a.Bae]}get application(){return this.hNb}get nvb(){return this.Buj}get fBn(){return this.OEe}get eBn(){return this.NEe}get M7e(){return this.VCg}get eGh(){return this.WCg}get yZ(){return this.cGj}get D2a(){return this.qUj}get gvb(){return this.muj}get RVl(){return this.HEj}get h5n(){return this.aWj}get ygi(){return!0}get Y4n(){return this.VVj}get lRn(){return this.DZg}rOn(Q){this.DZg=Q}get OPa(){return this.SVj}get f1c(){return this.TVj}get d1c(){return this.RVj}get I5k(){return this.vBj}get W4n(){return this.UVj}get gae(){return!1}get hTc(){return this.BNj}get KHf(){return this.zNj}get LHf(){return this.ANj}get d_a(){return!1}get oPd(){return!1}get nsf(){return this.uIj}get Z6d(){return this.ITj}get Vdc(){return!1}get GSn(){return!1}get dpm(){return""}get $df(){return 2}get JDl(){return 4}get KDl(){return 5}get qXh(){return""}get xpl(){return this.cDj}get HXh(){return this.MDj}get sXh(){return 1E3}get rXh(){return 1E-6}get D1n(){return this.$Uj}get L1f(){return!1}get A7i(){return!1}get Khm(){return this.kIj}get $Od(){return!1}get aPd(){return!1}get cdi(){return!1}get bdi(){return!1}get Ujm(){return!1}get zgi(){return!1}get yBd(){return!1}get okb(){return!1}get IJb(){return!1}get JJb(){return!1}get KJb(){return!1}get MJb(){return!1}get q_c(){return this.kTj}get Qdc(){return this.lTj}get p_c(){return!1}get rbf(){return null}get VOd(){return!1}get R6d(){return this.ETj}get HTh(){return 0}get xjl(){return this.RCj}get lYh(){return this.QDj}get Qim(){return this.rIj}get Pxl(){return-3.9}get PQ(){return this.bUj}get KOc(){return this.EIj}get Oqf(){return this.PHj}get Dsf(){return this.BIj}get A$a(){return this.ouj}get Vlm(){return this.PIj}get VAa(){return this.qEj}get w4i(){return this.hUj}get sik(){return this.Ovj}get bce(){return this.LXj}get hMc(){return this.yGj}get k9h(){return this.HGj}get Whm(){return this.lIj}get TTi(){return this.bSj}get b8j(){return this.utj}get Hv(){return this.LDj}get egb(){return this.DIj}get RJl(){return this.SDj}get QJl(){return this.RDj}get TJl(){return this.TDj}get jzl(){return this.BDj}get i9h(){return this.CGj}get f7l(){return this.AGj}get NDl(){return this.FDj}get dzl(){return this.zDj}get h9h(){return this.BGj}get g7l(){return this.DGj}get e7l(){return this.zGj}get Qel(){return this.NCj}get Sel(){return this.PCj}get Rel(){return this.OCj}get h7l(){return this.FGj}get i7l(){return this.GGj}get j9h(){return this.EGj}get c8j(){return this.vtj}get d8j(){return this.wtj}get eDb(){return!!H.AFrameworkApplication.ua&&
H.AFrameworkApplication.ua.Sb.aq}get aq(){return!!H.AFrameworkApplication.ua&&H.AFrameworkApplication.ua.Sb.aq}get xem(){return!!H.AFrameworkApplication.ua&&H.AFrameworkApplication.ua.Sb.Tdc}get MJm(){return ud.getImageClass("OfficeAssistant_32x32x32")}AEd(){return Promise.reject("GetFindMatchCount method is not overridden")}DPd(Q){return Array.contains(appChrome.selectors.getVisibleControlIds(),Q)}ZMd(){return!1}get kOd(){return!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMeModelRankerEnabled")}get q9i(){return H.AFrameworkApplication.K?
H.AFrameworkApplication.K.lb("TellMeServiceHelpClassifierModelName"):""}get Eqf(){return!!H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("TellMeMultiLingualCommandModelEnabled")}get dBb(){return"NoOpHeaderUi"}get ZCk(){return this.Q7c}get parameterData(){return this.Nrb}get Bao(){return this.L9a}J1k(){if(this.Rfe&&!this.Lsg&&(this.Lsg=!0,this.ekb(this.Rfe),this.aq)){var Q=ea.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");Q=(new bh.a(Q)).YCd(this.Rfe.WF);appChrome.api.dispatch(Q)}}get LUf(){return""}ekb(){}rTk(Q){const wa=
[];for(let eb=0;eb<Q.length;++eb)Q[eb].DTn?wa.push(new Ih.a(Q[eb].alternate,sg.a.wcj+eb.toString())):wa.push(new Ih.a(Q[eb].standard,sg.a.Bae+eb.toString()));return wa}O0l(Q){const wa={};for(let eb in Q){const Lb=eb,ec=Q[eb];for(let Tc in ec){const Ad=Tc,we=ec[Tc];(wa[Ad]||(wa[Ad]={}))[Lb]=we}}this.Q7c=wa}get s9i(){return""}get r9i(){return""}get r3i(){return!1}}Object(f.a)(Ag,"TellMeApplicationData",null,[1068]);class pl{constructor(Q,wa=null,eb=!1){this.standard=Q;this.alternate=wa;this.DTn=eb}}
Object(f.a)(pl,"TryQuerySet",null,[]);class yl{constructor(){this.GPg=this.HPg=null}get vHm(){return this.GPg}Gda(Q){this.HPg=Q;return this.UZe(Q)}NKm(){this.GPg=this.HPg}qFd(Q){return 8===Q.type?String.format(CommonUIStrings.l_FindInDocumentText,Q.RB):Q.RB}Paf(Q){return Q.RB}}Object(f.a)(yl,"ParameterizedCommand",null,[]);class vo extends yl{constructor(Q){super();this.yOc=Q}get commandId(){return this.yOc?"DefinitionsParameterized":"DefinitionButton"}get aJf(){return"Definition"}UZe(Q){const wa=
Vb.a.If(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.RB));return wc.a(sg.a.J_e(Q.value),Na.a.o1e.toString(),wa,sg.a.Xmf,null,Vb.a.If(sg.a.exb(Q.RB)),wa,null,null)}qFd(Q){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.RB)}Paf(Q){return sg.a.exb(Q.RB)}}Object(f.a)(vo,"DefinitionsParameterizedCommand",yl,[]);class tn extends yl{constructor(Q){super();this.yOc=Q}get commandId(){return this.yOc?H.AFrameworkApplication.ua.Sb.Yam?
"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get aJf(){return"Find"}UZe(Q){const wa=Vb.a.If(String.format(WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle,Q.RB));return wc.a(sg.a.J_e(Q.value),Na.a.findInDocument.toString(),wa,"Find_16x16x32",null,Vb.a.If(Q.RB),wa,null,null)}qFd(Q){return String.format(CommonUIStrings.l_TextWithQuotation,Q.RB)}}Object(f.a)(tn,"FindParameterizedCommand",yl,[]);class om extends yl{constructor(Q){super();this.yOc=Q}get commandId(){return this.yOc?
"SynonymsParameterized":"SynonymButton"}get aJf(){return"Synonym"}UZe(Q){const wa=Vb.a.If(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,Q.RB));return wc.a(sg.a.J_e(Q.value),Na.a.o1e.toString(),wa,sg.a.Xmf,null,Vb.a.If(sg.a.exb(Q.RB)),wa,null,null)}qFd(Q){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,Q.RB)}Paf(Q){return sg.a.exb(Q.RB)}}Object(f.a)(om,"SynonymsParameterizedCommand",yl,[]);var Oo=d(1902),$m=d(1824),Pk=d(1921),
zo=d(1897),ej=d(1898),pm=d(1532);class Ch extends Oo.a{constructor(){super(...arguments);this.WR=null;this.kUa=$m.FindManager.createInstance(this,Pk.a.instance,pm.a.instance,!0,!0)}static get instance(){return Ch._instance}S0b(){this.WR(this.kUa.Ej.Vga);this.kUa.xVa(!0)}AEd(Q){const wa=new Promise((eb,Lb)=>{this.WR=eb;setTimeout(()=>{Lb("Find manager execution timed out");this.kUa.xVa(!0)},500)});Q=zo.a.createQuery(Q,ej.a.none);this.kUa.find(Q);return wa}}Ch._instance=new Ch;Object(f.a)(Ch,"TellMeFindStatusSpy",
Oo.a,[]);class Mi extends Ag{constructor(Q){super({});this.hNb="Word";this.pDj=Q;H.AFrameworkApplication.K.$("TellMeFindInDocumentIsEnabled")&&(this.WCg=!0,this.VCg=this.yBd?"FindWithMatchesParameterized":"FindParameterized");Q=new vo(this.eDb);const wa=new om(this.eDb);this.parameterData[Q.commandId]=Q;this.parameterData[wa.commandId]=wa;H.AFrameworkApplication.K.$("WordEditorTellMeParameterizedFindIsEnabled")&&(Q=new tn(this.eDb),this.parameterData[Q.commandId]=Q);H.AFrameworkApplication.K.$("TellMeTryQueriesIsEnabled")&&
(Q=[new pl(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,"",!1),new pl(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",!1),new pl(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,"",!1),new pl(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,"",!1),new pl(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",!1)],this.L9a=this.rTk(Q))}AEd(Q){return Ch.instance.AEd(Q)}get J1a(){return km.AppFrame.qna}get dBb(){return km.AppFrame.zLa}get LUf(){return"Microsoft.Office.Web.SessionSettings.IWacWordSharedHeaderSearchBoxSettings"}ekb(Q){var wa=
H.AFrameworkApplication.K;Q=Q.WF;Q.WordCountFlyout=!this.pDj();Q.SelectAllButton=!wa.$("TellMeSelectAllResultIsEnabled");const eb=wa.$("TellMeDesktopUpSellIsEnabled");let Lb=H.AFrameworkApplication.Wjm;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",!Lb));Lb=!1;Q.TextBoxUpSellButton=!eb||Lb;Q.TableOfContentsUpSellButton=!eb||Lb;Q.SmartArtUpSellButton=!eb||Lb;Q.WordArtUpSellButton=!eb||Lb;Q.MultiColumnLayoutUpSellButton=!eb||Lb;Q.InsertEquationUpSellButton=!eb||
Lb;Q.TrackChangesUpSellButton=!eb||Lb;Q.ShapesUpSellButton=!eb||Lb;Q.LabelsUpSellButton=!eb||Lb;Q.InsertCitationUpSellButton=!eb||Lb;Q.TextBoxUpSellButtonEnterprise=!eb||!Lb;Q.TableOfContentsUpSellButtonEnterprise=!eb||!Lb;Q.SmartArtUpSellButtonEnterprise=!eb||!Lb;Q.WordArtUpSellButtonEnterprise=!eb||!Lb;Q.MultiColumnLayoutUpSellButtonEnterprise=!eb||!Lb;Q.InsertEquationUpSellButtonEnterprise=!eb||!Lb;Q.TrackChangesUpSellButtonEnterprise=!eb||!Lb;Q.ShapesUpSellButtonEnterprise=!eb||!Lb;Q.LabelsUpSellButtonEnterprise=
!eb||!Lb;Q.InsertCitationUpSellButtonEnterprise=!eb||!Lb;wa=!wa.$("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!H.AFrameworkApplication.yZ;Q.SynonymButton=wa;Q.DefinitionButton=wa}get s9i(){return H.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermModelName","")}get r9i(){return H.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName","")}get L1f(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",
!1)}get q9i(){return H.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName","")}get Vdc(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",!1)}get Eqf(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",!1)}get $df(){return H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get r3i(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",
!1)}get oPd(){return H.AFrameworkApplication.K.$("TellMeRankerLoggingIsEnabled")&&H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",!1)}get kOd(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",!1)}get $Od(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierEnabled",!1)}get aPd(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierSwapLogicEnabled",
!1)}get sXh(){return H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",1E3)}get rXh(){return 1E-6*H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerSuppressionScore",1)}get cdi(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get bdi(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",
!1)}get qXh(){return H.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName","")}get zgi(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",!1)}get HTh(){return H.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get ygi(){return H.AFrameworkApplication.K.$("TellMeServiceForSearchIsEnabled")}get gae(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",
!1)}get d_a(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",!1)}get Z6d(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",!1)}get A7i(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get VOd(){return H.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",
!1)}get IJb(){return H.AFrameworkApplication.K.$("ShowAnswerSearchResults")}get JJb(){return H.AFrameworkApplication.K.$("ShowDefinitionSearchResults")}get KJb(){return H.AFrameworkApplication.K.$("ShowEntitySearchResults")}get MJb(){return H.AFrameworkApplication.K.$("ShowWolframSearchResults")}get rbf(){return H.AFrameworkApplication.K.$("ModernFontPickerIsEnabled")?{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}Object(f.a)(Mi,"WordEditorTellMeApplicationData",Ag,[]);var Iq=d(1518),uq;
(function(Q){Q[Q.none=0]="none";Q[Q.waitAll=1]="waitAll";Q[Q.synchronizeFast=2]="synchronizeFast";Q[Q.synchronizeSlow=3]="synchronizeSlow"})(uq||(uq={}));Object(f.b)("ProviderSynchronizationType",uq);var Ln;(function(Q){Q[Q.immediate=0]="immediate";Q[Q.waitAll=1]="waitAll";Q[Q.synchronizeAndWaitAll=2]="synchronizeAndWaitAll";Q[Q.synchronizeAndWaitForRanker=3]="synchronizeAndWaitForRanker"})(Ln||(Ln={}));Object(f.b)("MenuUpdatePolicy",Ln);var cq=d(1463),wf=d(1461),Jq=d(1581),Ao=d(1464),vq=d(1487),
wk=d(102),wo=d(248);class un extends Oo.a{constructor(Q){super();this.LYj=Q}S0b(){this.LYj.update()}}Object(f.a)(un,"TellMeFindStatusManager",Oo.a,[]);class lh{constructor(Q){this.C9a=this.nvg=null;this.Fi=0;this.acd="TellMeWAC.";const wa=Q.M7e;this.jc=Q;this.p$c=wa;this.fwe=Object.assign(new Iq.a,{landingTab:"Indoc",data:null});Q=new un(this);this.kUa=$m.FindManager.createInstance(Q,Pk.a.instance,pm.a.instance,!0,!0)}WJ(){return"WordFindInDocument"}wW(){return this.jc.$df?this.jc.$df===Ln.waitAll?
uq.waitAll:uq.synchronizeSlow:uq.none}uI(Q,wa){this.klm(Q)?(this.C9a=Q,this.nvg=wa,Q=zo.a.createQuery(Q.ng,ej.a.none),this.Fi=window.performance.now(),this.kUa.find(Q)):wa.resultsUpdated(new cq.a(Q))}update(){this.PDn(Math.round(window.performance.now()-this.Fi));var Q=String.format(CommonUIStrings.l_TextWithQuotation,this.C9a.ng);var wa=H.AFrameworkApplication.ua&&H.AFrameworkApplication.ua.Sb.okb?sg.a.mWa(this.C9a.ng,15,this.fwe):Vb.a.If(this.C9a.ng);const eb=[];eb.push(appChrome.actions.setControlLabel(this.p$c,
Q));eb.push(appChrome.actions.setCompoundButtonCommandValueId(this.p$c,wa));eb.push(appChrome.actions.updateCompoundButtonDescription(this.p$c,this.rhf()));appChrome.api.dispatch(eb);Q=new wf.a(this.p$c,Jq.a.FindInDocument,this.C9a.ng,this.kUa.Ej.Vga.toString());wa=new Ao.a(vq.a.FindInDocument);wa.displayName=WordEditorIntl.WordEditorStrings.L_FindInDocument;wa.zy(Q);const Lb=new cq.a(this.C9a);Lb.wv(wa);window.requestAnimationFrame(()=>{this.nvg.resultsUpdated(Lb)});this.kUa.xVa(!0);this.QDn(Math.round(window.performance.now()-
this.Fi))}rhf(){const Q=this.kUa.Ej.Vga.toString();return"1"===Q?String.format(CommonUIStrings.l_SearchResultText,Q):String.format(CommonUIStrings.l_SearchResultsText,Q)}klm(Q){return!!Q&&!!Q.ng&&""!==Q.ng.trim()}PDn(Q){const wa={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.C9a.ng.length};this.sendActivityEvent(wa,Q)}QDn(Q){const wa={["Time"]:(new Date).getTime(),["Event"]:"Latency",
["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.C9a.ng.length};this.sendActivityEvent(wa,Q)}sendActivityEvent(Q,wa){Q=wk.a.KJ(Q);cm.a.MDa(Object.assign(new wo.a,{name:"Latency",dataFields:Q,durationMs:wa}),this.acd)}}Object(f.a)(lh,"WordFindInDocumentWithMatchesProvider",null,[1093]);class Wq{constructor(Q,wa){this.Ac=Q;this.TLd=wa}iZa(Q,wa,eb){return this.TLd.iZa(0,Q,wa,eb)}insertHtmlText(Q){return Q?32===this.wmf(Q):!1}wmf(Q){return this.executeCommand(jg.a.Eya,
Q)}executeCommand(Q,wa){const eb=new Lo.DictionaryPropertySet;eb.setValue(ij.a.$T,wa);eb.setValue(ij.a.JDa,!1);wa=this.Ac.processAction(Q,1);32===wa&&(wa=this.Ac.Xb(Q,2,eb));return wa}}Object(f.a)(Wq,"WordInsertContentHandler",null,[1657]);class Bo extends ng{constructor(){super();this.Ww=()=>{if(H.AFrameworkApplication.k3f){var Q=qe.App.xa.Sb.ngf(Na.a.tellMe);Q.NMc?this.zDi():Q.MV(this.MAn);var wa=new Mi(()=>!1);bg.TellMeActor.instance.initialize(wa,null,null,null,null,null,Object(a.a)(qe.App.xa,
qe.App.xa.GCd,"forceUpdateRibbonControls"),H.AFrameworkApplication.K,this.W.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.W.Za("Common.IActionContextProvider"),this.W.Za("Common.ISystemInitiatedFeedback"));bg.TellMeActor.instance.Nhn(Q);bg.TellMeActor.instance.Mjn(new Wq(H.AFrameworkApplication.ya,this.W.Pa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor")));wa.eGh&&wa.yBd&&bg.TellMeActor.instance.HH(new lh(wa),Xf.a.tellMe)}};this.MAn=()=>{this.zDi()}}get name(){return"WordEditor.TellMe"}init(){H.AFrameworkApplication.K.yq(this.Ww)}zDi(){qe.App.xa.updateCommandUI()}}
Object(f.a)(Bo,"WordEditorTellMePackage",ng,[]);class up{constructor(){this.W=null;this.t9i=(Q,wa,eb)=>{2===eb&&(Q=new Ec.StandardDialog,Q.Ed=0,Q.Bga(WordEditorIntl.WordEditorStrings.L_WordTestFeature,WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,null));return 32}}get name(){return"WordEditor.TestFeature"}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Nm()})}dispose(){}Nm(){if(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(138)){H.AFrameworkApplication.ya.gb(mf.a.wordTestFeature,
th.a.view,this.t9i,96);var Q=ai.FocusManager.instance().pe(km.AppFrame.iF);ye.AFrame.pi(Q,Wd.KeyInputManager.mc(pg.a.u4a,5|Wd.KeyInputManager.Mh),mf.a.wordTestFeature)}}zc(Q){this.W=Q}static main(){ca.a.instance.Pc(new up)}}Object(f.a)(up,"WordEditorTestFeaturePackage",null,[1,2]);var an=d(117);class Po{constructor(Q,wa){this.dSi=Q;this.Ac=wa;this.J4d=(eb,Lb,ec,Tc,Ad)=>{if(1===ec)return 32;this.dSi.kO(9,Ad,!1);return 32};this.taa=(eb,Lb)=>{if(9===Lb.type){var ec;(eb=Lb.WI)?("string"===typeof eb?ec=
eb:"data"===eb.type&&(ec=an.a.Lth(eb.m6m,eb.newState,eb.uOn)),ec&&Po.Dxc(ec)):ja.ULS.sendTraceTag(556103040,376,15,"TrackChangeSettingUpdateNotificationEventArgs is null")}};this.vWc()}vWc(){this.Ac.pa(mf.a.J4d,Aa.a.frame,this.J4d);this.dSi.j1(this.taa)}dispose(){}static Dxc(Q){Q=qe.App.xa.notificationBar.qza(Q,!1);Q.image=5;Q.ula="CoAuth_AuthorStatus_16x16x32";qe.App.xa.notificationBar.eB(Q)}}Object(f.a)(Po,"TrackChangeNotificationActor",null,[]);class vn{constructor(){this.ij=this.zJe=this.W=null;
this.aTc=()=>{if(this.ij=qe.App.THd().result)this.W.ha("WordEditor.TrackChange.TrackChangeNotificationActor",()=>new Po(this.ij,H.AFrameworkApplication.ya)).singleInstance(),this.zJe=this.W.resolve("WordEditor.TrackChange.TrackChangeNotificationActor")}}get name(){return"WordEditor.TrackChangeNotificationActor"}zc(Q){this.W=Q}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Nm()})}Nm(){qe.App.THd().continueWith(this.aTc)}dispose(){this.zJe&&this.zJe.dispose()}}Object(f.a)(vn,
"WordEditorTrackChangeNotificationActorPackageManager",null,[1,2]);var Np=d(78),$r=d(1441),dp=d(1891);class Qk{}Qk.m6f="UnsavedChanges";Qk.n6f="UnsavedChangesThemed";Qk.bAn="SavedChanges";Qk.Gdj="UnsavedChangesOpenPipe";Qk.qdo="UnsavedChangesOpenPipeCssClassNameThemed";Qk.Fdj="UnsavedChangesClosePipe";Qk.ndo="UnsavedChangesClosePipeThemed";Qk.odo="UnsavedChanges";Qk.pdo="UnsavedChangesThemed";Qk.o6f="UnsavedChangesIndicatorPositionRef";Object(f.a)(Qk,"UnsavedChangesHighlightUtils",null,[]);class ir extends $r.a{constructor(Q,
wa){super();this.bca=Q;this.Dw=wa;this.spa=[this.Dw?new dp.a(Qk.n6f,Qk.pdo):new dp.a(Qk.m6f,Qk.odo)]}get qla(){return!0}get nBb(){return 4}get oeb(){return this.spa}BNa(Q,wa){if(this.bca){var eb=this.bca.Wyf;if(eb&&eb.count&&eb.contains(Q.id))for(Q=wa.h1a("span"),wa=0;wa<Q.length;wa++)eb=Q[wa],wa||eb.classList.add(this.Dw?Qk.qdo:Qk.Gdj),wa===Q.length-1&&eb.classList.add(this.Dw?Qk.ndo:Qk.Fdj),eb.classList.add(this.Dw?Qk.n6f:Qk.m6f)}}ydb(){}}Object(f.a)(ir,"UnsavedChangesHighlightActor",$r.a,[]);var vr=
d(994);class wq{constructor(Q){this.Kke=null;this.bca=Q;this.dte=!1}get key(){return"UnsavedChangesHighlight"}get hw(){return"UnsavedChanges"}reset(Q){if(this.bca){Q=Q.node;if(Qj.ParagraphReader.oc(Q)){const wa=this.bca.Wyf;if(wa&&wa.contains(Q.id)){this.dte=!0;this.Kke=Q.id;return}}this.dte=!1;this.Kke=tf.a.nil}}DEa(){let Q=null;return this.dte?(Q=Object.assign(new vr.a,{IF:this.key,contentObject:this.Kke,description:null}),{returnValue:!0,KE:Q}):{returnValue:!1,KE:Q}}}Object(f.a)(wq,"UnsavedChangesHighlightCpContentDetailsProvider",
null,[226,227]);var Gr=d(1442);class Hr{constructor(Q,wa,eb,Lb,ec,Tc,Ad){this.EPg=null;this.b4=Q;this.kf=wa;this.qV=eb;this.G4=Lb;this.V1g=ec;this.HTb=Tc;this.Dw=Ad;this.kf.TUa(this.P6.bind(this))}get Wyf(){return this.EPg}GWl(){if(this.b4){if(1===this.b4.sWe){if(0===this.b4.fuf&&this.b4.Gzi()){this.EPg=this.b4.NTd;const Q=this.b4.u2c;this.b4.cAn.forEach(this.nUk.bind(this));Q.forEach(this.HWl.bind(this));0<Q.length&&this.UVk(this.qV);return 0}return this.een(this.b4.fuf)}return 2}return 1}een(Q){switch(Q){case 0:return this.b4.N2h()?
5:6;case 3:case 12:case 5:case 11:return 4;default:return 6}}F3h(Q,wa,eb){if(wa)if(eb){eb=wa.querySelectorAll("span");for(let Lb=0;Lb<eb.length;Lb++){const ec=eb[Lb];Lb||ec.classList.add(Qk.Gdj);Lb===eb.length-1&&ec.classList.add(Qk.Fdj);ec.classList.add(this.Dw?Qk.n6f:Qk.m6f)}wa.classList.add(Qk.o6f);Q&&this.G4.Jgc(Q)}else wa.classList.add(Qk.bAn)}e4b(Q,wa){const eb=this.NKl(Q);if(Q&&(Q=Q.De(Ji.App.xa.jb.Jc.Tb)))if(Q.Ag&&Q.Ag.Hi&&0!==Q.Ag.Hi.count)for(let Lb of Q.Ag.Hi)this.F3h(eb,Lb,wa);else this.F3h(eb,
Q.htmlElement,wa)}NKl(Q){return this.V1g&&(Q=this.V1g.CHd(Q))&&Q&&(Q=Q.De(Ji.App.xa.jb.Jc.Tb))?Q:null}HWl(Q){this.e4b(Q,!0);return!0}nUk(Q){this.e4b(Q,!1);return!0}UVk(Q){Q&&Q.continueWith(()=>{Q.result.logActivity("UnsavedChangesHighlightEnableSurvey","WordUnsavedChangesHighlightingSurveyGateIsEnabled",0)})}P6(Q,wa){if(wa===Sys.EventArgs.Empty)ja.ULS.sendTraceTag(572364513,306,50,"HighlightUnsavedChanges Not Run: Empty Event Args");else if(wa&&wa.errorCode){if(Hr.XRn?!this.HTb.$W:Gr.a.XJ.XJ())Q=
this.GWl(),ja.ULS.sendTraceTag(576528923,306,15,"HighlightUnsavedChanges Run Result: {0}",Q),Ga.Health.instance.recordKpiUsage("UnsavedChangesHighlight",0,"wwrelfc",null),0!==Q&&4!==Q&&this.F8n(Q)}else ja.ULS.sendTraceTag(572364514,306,50,"HighlightUnsavedChanges Not Run: No {0}",wa?"Error Code":"Kickout Event Args")}static get XRn(){if(null!=Hr.Iog)var Q=Hr.Iog;else{var wa,eb;Q=null!==(eb=null===(wa=H.AFrameworkApplication.K)||void 0===wa?void 0:wa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldReportCSDLUsingRevisionSequencing",
!1))&&void 0!==eb?eb:!1;Q=Hr.Iog=Q}return Q}F8n(Q){let wa;const eb=new Ie.a;eb.extendedProperties=new Map;eb.extendedProperties.set("HighlightUnsavedChangesResult",Q.toString());eb.extendedProperties.set("UnsavedChangesCollectionResult","-1");switch(Q){case 1:case 2:case 6:wa="HighlightInternalError";break;case 5:wa="ChangeOutsideCanvas"}6!==Q&&5!==Q||eb.extendedProperties.set("UnsavedChangesCollectionResult",this.b4.fuf.toString());wa&&(Ga.Health.instance.recordQosError(wa,["UnsavedContentNotHighlighted"],
!0,!0,!1,!1,eb),Ga.Health.instance.recordKpiFailure("UnsavedChangesHighlight",wa,!0,!0,eb))}dispose(){this.kf.Gbc(this.P6.bind(this))}}Object(f.a)(Hr,"UnsavedChangesHighlighter",null,[10]);var bn=d(684),Nm=d(516),Xq=d(1439);class cn extends Xq.a{constructor(Q,wa){super();this.bca=Q;this.Dw=wa}AJb(Q){if(!this.bca)return!1;const wa=this.bca.Wyf;return wa?wa.contains(Q.zb.id)||Q.htmlElement.querySelector(".UnsavedChanges")?!0:!1:!1}Unk(Q,wa){wa=Q.oBa?Q.oBa[wa]?Q.oBa[wa].style?Q.oBa[wa].style.marginLeft:
null:null:null;var eb=Q.leftMargin;Q=1440<=eb?-(eb/1440*96):Q.Pvb(0,96,this.zoom);eb=0;wa&&(wa=wa.match(/^(\d+)px/))&&wa[1]&&(eb=Number(wa[1]));return Q-eb}yok(Q,wa,eb){return Sys.UI.DomElement.getBounds(Q).y-eb.w$[wa].y}Jnk(Q){return Sys.UI.DomElement.getBounds(Q).height}cth(Q,wa,eb,Lb){let ec;ec=this.Unk(eb,wa);wa=this.yok(Q,wa,eb);Q=this.Jnk(Q);Lb=bn.a.createElement(Lb,Nm.a.div);Lb.className=this.Dw?"UnsavedChangesIndicatorThemed":"UnsavedChangesIndicator";Lb.style.left=ec+"px";Lb.style.top=wa+
"px";Lb.style.height=Q+"px";return Lb}ssh(Q,wa,eb,Lb){const ec=[];let Tc=Q.querySelectorAll("."+Qk.o6f);if(0===Tc.length&&Q.classList.contains(Qk.o6f))eb=this.cth(Q,wa,eb,Lb),eb.SVa=wa,ec.push(eb);else for(Q=0;Q<Tc.length;Q++){let Ad=this.cth(Tc[Q],wa,eb,Lb);Ad.SVa=wa;ec.push(Ad)}return ec}Swb(Q){let wa=[];var eb=Q.S6;const Lb=eb.Ig.ownerDocument;if(eb.Tj){let ec=0;for(let Tc of eb.Ag.Hi)(eb=this.ssh(Tc,ec,Q,Lb))&&(wa=wa.concat(eb)),ec+=1}else wa=this.ssh(eb.htmlElement,0,Q,Lb);return wa}}Object(f.a)(cn,
"UnsavedChangesIndicatorActor",Xq.a,[]);class ps{constructor(){this.E4=this.nv=this.GGa=this.G4=this.Mbd=this.bca=null}get name(){return"WordEditor.UnsavedChangesHighlight"}zc(){}init(){this.G4=ea.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance;this.bca=new Hr(ea.a.instance.resolve("Wonca.UnsavedChangesCollection.IUnsavedChangesCollector"),af.SessionStatusManager.instance,vl.a.Iq(ea.a.instance.Za("Common.ISystemInitiatedFeedbackWithTimeLapse")),this.G4,ea.a.instance.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),
ea.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager"),!!qe.App.instance&&qe.App.instance.Rla);this.GGa=ea.a.instance.Za("Box4.Accessibility.IAccessibilityContextManager");this.E4=ea.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance;this.Mbd=new cn(this.bca,!!qe.App.instance&&qe.App.instance.Rla);this.G4.Yib(this.Mbd);this.GGa&&this.GGa.execute(Q=>{Q.a3(new wq(this.bca))});this.nv=new ir(this.bca,!!qe.App.instance&&qe.App.instance.Rla);this.E4.Xib(this.nv)}dispose(){this.G4&&
this.Mbd&&this.G4.abe(this.Mbd);this.E4&&this.nv&&this.E4.h6f(this.nv);Np.a.LA(this.bca)}static main(){ca.a.instance.Pc(new ps)}}Object(f.a)(ps,"WordEditorUnsavedChangesHighlightPackage",null,[1,2,10]);var Co=d(347);class wr{constructor(Q,wa,eb,Lb){eb=new wordVersionHistory.AppBootSettings;eb.logger=new Co.a;eb.forcePdfDevEnv=!1;eb.userSessionId=H.AFrameworkApplication.userSessionId;eb.wacCluster=Lb;eb.publicScriptPath=H.AFrameworkApplication.r_;eb.userType=H.AFrameworkApplication.userType;eb.shouldUseBaseForCaching=
Q.shouldUseBaseForCaching;this.pce=new wordVersionHistory.AppVersionControllerImpl(eb,wa)}onVersionSelected(Q,wa,eb,Lb){this.pce.onVersionSelected(Q,wa,eb,Lb)}onDownloadTokenReady(Q,wa){this.pce.onDownloadTokenReady(Q,wa)}getRenderFailureEvent(){return this.pce.getRenderFailureEvent()}getLoadFinishEvent(){return this.pce.getLoadFinishEvent()}}Object(f.a)(wr,"AppVersionControllerImplWrapper",null,[1683]);class Kq{create(Q,wa,eb,Lb){return new wr(Q,wa,eb,Lb)}}Object(f.a)(Kq,"AppVersionControllerImplWrapperFactory",
null,[1665]);class Mn{getVersionHistoryControllerInstance(Q){return versionHistory?versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Q):null}}Object(f.a)(Mn,"VersionHistoryControllerFactory",null,[1663]);class Do{static addAppPLTEventToLog(Q){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(Q)}catch(wa){}}static setIsPageLoadForFirstTime(Q){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(Q)}catch(wa){}}}Object(f.a)(Do,"VersionHistoryLogConnector",
null,[]);var Da=d(519),Ua=d(1424),qb=d(1616);class ac{constructor(){this.revisionId=null;this.bTf=0}}Object(f.a)(ac,"ForceSaveData",null,[]);class tc extends Fm.a{constructor(){super();this.ExclusiveLockId=this.VersionToken=this.FileId=null}Wl(){return 106}static construct(Q,wa,eb){const Lb=new tc;Lb.FileId=Q;Lb.VersionToken=wa;Lb.ExclusiveLockId=Bj.a(eb);return Lb}}Object(f.a)(tc,"RestoreVersionRequest",Fm.a,[]);class Fc{static hla(){return(new Date).getTime()}static rBk(Q){const wa=new Ie.a;wa.durationMs=
Q;wa.extendedProperties=new Map;return wa}}Object(f.a)(Fc,"VersionHistoryUtils",null,[]);var id=d(315);class Hd{constructor(Q,wa,eb,Lb,ec,Tc,Ad,we,Rd,yf,rg,vi,Rk,Ij,Sl){this.Ac=Q;this.Ai=wa;this.QS=eb;this.mbl=Lb;this.Qs=ec;this.rki=Tc;this.f4c=Ad;this.isd=we;this.Mno=Rd;this.K=yf;this.gak=rg;this.vRe=vi;this.qmb=Rk;this.jf=Ij;this.R8f=Sl;this.pQa=this.CFc=this.F_c=this.x7d=this.n_f=this.R5f=this.perfTelemetryInfos=this.baseVersion=this.currentVersion=this.controller=null;this.e4d=0;this.YWb=this.oce=
null;this.T8f=Ua.b.None;this.K6b=!1;this.V8f="";this.d4k={0:"GeneralSaveError",1:"InvalidFileName",2:"EmptyFileName",3:"InvalidPermission",4:"OverwriteTarget",5:"TargetFileLocked",6:"InvalidFileNameDisallowPercentOctothorpe"};this.S3i=(hk,Yl,Sj)=>{if(1===Sj)return af.SessionStatusManager.instance.Qj?8:32;if(2===Sj){this.oce=kd.a.create().toString();ja.ULS.sendTraceTag(592196993,3005,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",this.oce);H.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IDocsWordVersionHistorySaveACopyOverFlowMenuSettings");
H.AFrameworkApplication.F6("WoVer882;WoVer882cf");Object(qb.a)();this.jf.logKpiUsage("WordVersionHistory",0,{isForAlertableKpi:!0});this.jf.KB(mf.a.oYm,{succeeded:!0});this.g9i.ShowVersionHistoryDialog=(new Date).getTime().toString();this.ev.VersionHistoryLaunchSessionId=this.oce;this.perfTelemetryInfos=[];this.controller||(this.V8f=this.K.lb("WacCluster"),this.controller=this.Mno.getVersionHistoryControllerInstance({ulsLogger:new Co.a,serviceBase:this.K.appSettings.VersionHistoryWebServiceBase,docId:H.AFrameworkApplication.um,
appSettings:{appName:Ua.a.Word,wdEnableDownloadTokens:this.f4c.Kkj,wdEnableSaveACopy:!0,wdEnableRestore:this.f4c.Ikj,userSessionId:H.AFrameworkApplication.userSessionId,wacCluster:this.V8f,uiLocale:H.AFrameworkApplication.uiCulture?H.AFrameworkApplication.uiCulture:"en-us",wdEnableHiddenButtonsUntilVersionLoadComplete:!0,wdEnableShowVersionChanges:!0,disabledChangeGates:H.AFrameworkApplication.K.lb("VHSDisabledChangeGates"),wdEnableSaveACopyOverFlowMenu:this.f4c.Jkj,isRtl:H.AFrameworkApplication.isRtl,
wdEnableAppColorUpdate:this.K.$("AppColorUpdateIsEnabled"),useXhr:ua.a.K$,retryCount:0,wdEnableDeleteVersions:!1,wdEnableIterator:!1,viewerRootPositionRelative:!1,disableSaveACopy:!1},perfTelemetryInfos:this.perfTelemetryInfos}));if(!this.controller)return this.jf.logKpiFailure("WordVersionHistory","scriptDependencyUnavailable",{isIntentional:!1},{name:Hd.vetoName,errorNameOverride:"VersionHistoryLaunchFailed",isIntentional:!1}),8;this.controller.setDisableSaveACopy(this.vQn()||this.sQn());this.SWn()}return 32};
this.gtn=(hk,Yl,Sj)=>{if(1===Sj)return af.SessionStatusManager.instance.dK?32:8;2===Sj&&(hk=this.zab(this.e4d),this.jf.logKpiSuccess("WordVersionHistorySaveACopy",{additionalValues:hk}),this.WOf());return 32};this.ftn=(hk,Yl,Sj,eg,yq)=>{var bs,$i,xk;if(1===Sj)return af.SessionStatusManager.instance.dK?32:8;2===Sj&&(hk="Unknown",Yl="",yq&&(hk=null!==(bs=yq.FailureReason)&&void 0!==bs?bs:hk,yq=null!==($i=yq.ExtraInfo)&&void 0!==$i?$i:"",Yl=null!==(xk=this.d4k[yq])&&void 0!==xk?xk:yq),$i=this.zab(this.e4d),
""!==Yl&&$i.extendedProperties.set("ExtraInfo",Yl),xk=this.qmb.Ndb(hk,3,Yl),this.jf.logKpiFailure("WordVersionHistorySaveACopy",hk,{isIntentional:xk.isIntentional,additionalValues:$i},xk),ja.ULS.sendTraceTag(592197004,3005,10,"Save failed with {0} {1}",hk,Yl));return 32};this.uQd=()=>{this.Vsi();this.WOf();this.Qs&&this.Qs.refreshDocument({STn:!0})};this.obl=hk=>{ja.ULS.sendTraceTag(592197010,3005,50,"DocumentSavedSuccessfully");var Yl=hk.revisionId;const Sj=tf.a.create();Yl=tc.construct(H.AFrameworkApplication.rootQuerySignature,
Yl,Sj);const eg=Object.assign(new ek.a,{Vr:Yl,status:1,WG:"RestoreVersion"});Yl=this.vRe.Jka(0,()=>{this.qSl(eg,hk.bTf)});Yl.CJ(eg);Yl.gW()};this.yIh=(hk,Yl)=>{this.K6b=!1;const Sj=this.zab(hk.bTf);Sj.extendedProperties.set("status",Da.a[Yl]);const eg=this.qmb.Ndb("ForceSaveFailed",5);this.jf.logKpiFailure("WordVersionHistoryRestore","forceSaveFailed",{isIntentional:eg.isIntentional,additionalValues:Sj},eg);this.jf.KB(mf.a.pAc,{succeeded:!1});ja.ULS.sendTraceTag(592197011,3005,10,"ForceSaveFailed with status"+
Da.a[Yl]+" for version "+hk);this.controller.setRestoreFailedAtServer(this.uQd)};this.g9i={};this.ev={};this.RWn=!1;this.u6=!!H.AFrameworkApplication.ua&&H.AFrameworkApplication.ua.Sb.u6}utd(){null===this.CFc&&(this.CFc=Fc.hla())}zab(Q){const wa=new Ie.a;null===Q?ja.ULS.sendTraceTag(541693581,3005,10,"constructKpiAdditionalValuesWithDurationFromStartTime called with null startTime"):(wa.durationMs=Fc.hla()-Q,wa.extendedProperties=new Map);return wa}m2l(){null===this.pQa&&(this.pQa=Fc.hla());this.jf.logKpiUsage("WordVersionHistorySelectVersion",
0,{isForAlertableKpi:!0})}WOf(){const Q=[],wa=Object.assign(new Ie.a,{extendedProperties:new Map});if(null!=this.x7d&&null!=this.n_f){var eb=this.x7d-this.n_f;Q.push(Object.assign(new Uj.a,{name:"showPaneDuration",string:eb.toString()}));wa.extendedProperties.set("showPaneDuration",eb.toString())}null!=this.CFc&&null!=this.F_c&&(eb=this.CFc-this.F_c,Q.push(Object.assign(new Uj.a,{name:"firstActionDuration",string:eb.toString()})),wa.extendedProperties.set("firstActionDuration",eb.toString()));(eb=
this.T8f===Ua.b.None)?this.jf.logKpiSuccess("WordVersionHistory",{additionalValues:wa}):this.jf.logKpiFailure("WordVersionHistory",Ua.b[this.T8f],{isIntentional:!1,additionalValues:wa},{name:Hd.vetoName,errorNameOverride:"VersionHistoryLaunchFailed",isIntentional:!1});this.jf.KB(mf.a.Swk,{succeeded:eb,customData:Q})}Vb(){this.Ac.pa(Na.a.F_f,Aa.a.frame,this.S3i);this.Ac.pa(Na.a.GXc,Aa.a.frame,this.gtn);this.Ac.pa(Na.a.$2d,Aa.a.frame,this.ftn)}SWn(){this.n_f=Fc.hla();this.CFc=this.F_c=this.x7d=null;
if(document.getElementById("VersionHistoryOverlay"))this.tG();else{this.jjn();this.ijn();this.Tin();this.Yin();this.gjn();this.Xin();this.f4c.Lkj&&this.Win();this.fjn();this.hjn();const Q=document.createElement("div");let wa=Q.id="VersionHistoryOverlay",eb=null;this.Zin(Q);if(this.u6&&(eb=Object(id.a)("Header"))){const Lb=document.getElementById("AppHeaderPanel");wa=Lb&&"none"===Lb.style.display?String.format("{0} {1} {2}",wa,"RegionComposer","NoAppHeader"):String.format("{0} {1}",wa,"RegionComposer")}eb||
(eb=document.getElementById("WACInnerFrame"));Q.className=wa;eb.appendChild(Q);this.R5f=this.controller.createVersionHistoryDialog(Q);this.Aga()}document.getElementById("VersionHistoryOverlay").style.display="block";this.controller.getVersions("")}vQn(){if(H.AFrameworkApplication.fO)return ja.ULS.sendTraceTag(570770272,3005,15,"Version History is disabling Save a Copy because this is a protected file."),!0;const Q=32==this.Ac.processAction(Na.a.ycc,1);let wa=32==this.Ac.processAction(Na.a.Acc,1);
return Q||wa?!1:(ja.ULS.sendTraceTag(545403476,3005,15,"Version History is disabling Save a Copy because the save commands are disabled."),!0)}sQn(){return H.AFrameworkApplication.fO?(ja.ULS.sendTraceTag(545387291,3005,15,"Version History is disabling download version because this is a protected file."),!0):32!=this.Ac.processAction(Na.a.downloadACopy,1)?(ja.ULS.sendTraceTag(545403477,3005,15,"Version History is disabling download version because the download command is disabled."),!0):!1}Yin(){this.controller.getFullAppErrorEvent().addListener(Q=>
{let wa=Q?Ua.b[Q]:"";this.ev[Hd.Q4n]=wa;this.T8f=Q;ja.ULS.sendTraceTag(592196994,3005,10,"Full App Error Event: {0}, VersionHistoryLaunchSessionId: {1}",wa,this.oce)})}jjn(){this.controller.getVersionsReadyEvent().addListener(Q=>{this.x7d=Fc.hla();this.Xtn(Q.containerDiv);this.R8f.initialize(this.YWb);this.tG()})}ijn(){this.controller.getVersionSelectedEvent().addListener(Q=>{null===this.pQa&&(this.pQa=Fc.hla());this.R8f.display(Q)})}Win(){this.controller.getDownloadTokenReadyEvent().addListener(Q=>
{try{ja.ULS.sendTraceTag(592196998,3005,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),this.hRl(Q)}catch(wa){ja.ULS.sendTraceTag(592197002,3005,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",wa)}})}hRl(Q){Q&&Q.versionSelected?(this.currentVersion=Q.versionSelected.currentVersion,this.baseVersion=Q.versionSelected.baseVersion,this.m2l(),this.YWb.onVersionSelected(this.currentVersion,this.baseVersion,this.g9i,!this.RWn)):ja.ULS.sendTraceTag(591697922,
3005,10,"handleGetDownloadTokenReadyEvent: downloadTokenReadyObject.versionSelected was null")}Tin(){this.controller.getCloseSelectedEvent().addListener(()=>{this.Twk();this.Gom()})}H1l(Q){const wa={};wa.FileDownloadUrl=Q;wa.SaveEntryPoint="VersionHistory";return wa}GFl(Q){let wa="Dialog Failure - ActionResponse "+Q.toString();2===Q?wa="DialogNotHandled":8===Q&&(wa="DialogFailed");return wa}gjn(){this.controller.getSaveACopySelectedEvent().addListener(Q=>{this.e4d=Fc.hla();this.jf.logKpiUsage("WordVersionHistorySaveACopy",
0);this.utd();ja.ULS.sendTraceTag(592197003,3005,50,"VersionHistoryPaneActor: RegisterForSaveACopySelectedEvent");this.Vsi();var wa=this.H1l(Q);Q=32==this.Ac.processAction(Na.a.ycc,1);wa=this.Ac.Xb(Q?Na.a.ycc:Na.a.Acc,2,wa);const eb=this.zab(this.e4d),Lb=32===wa;if(!Lb){const ec=this.GFl(wa),Tc=this.qmb.Ndb(ec,2);this.jf.logKpiFailure("WordVersionHistorySaveACopy",ec,{isIntentional:Tc.isIntentional,additionalValues:eb},Tc);ja.ULS.sendTraceTag(578033103,3005,10,Q?"SaveACopy":"SaveToSharePoint failed with ActionResponse: "+
wa.toString())}this.jf.KB(mf.a.Pvk,{succeeded:Lb})})}Xin(){this.controller.getDownloadVersionSelectedEvent().addListener(Q=>{var wa=Fc.hla();this.jf.logKpiUsage("WordVersionHistoryDownloadVersion",0);this.utd();Q=new Zg.QueryStringBuilder(Q);Q.Me("fn",H.AFrameworkApplication.fileName);Q=this.Ac.Xb(Na.a.downloadACopy,2,{["FileDownloadUrl"]:Q.toString()});wa=this.zab(wa);const eb=32===Q;eb?this.jf.logKpiSuccess("WordVersionHistoryDownloadVersion",{additionalValues:wa}):(this.jf.logKpiFailure("WordVersionHistoryDownloadVersion",
Q.toString(),{isIntentional:!1,additionalValues:wa},{name:Hd.vetoName,errorNameOverride:"DownloadVersionFailed"}),ja.ULS.sendTraceTag(592197005,3005,10,"Download version failed with result: "+Q.toString()));this.jf.KB(mf.a.Ovk,{succeeded:eb})})}qSl(Q,wa){this.K6b=!1;if(2===Q.statusCode&&Q.hk&&0<Q.hk.length&&Q.hk[0])if(Q=Q.hk[0],wa=this.zab(wa),this.rki&&Q.ShouldAvoidLockRelease&&this.rki.Mjb(!1,"VersionHistory"),191===Q.StatusCode)Q=this.qmb.Ndb("MultipleClientsInCoauthSession",5),this.jf.logKpiFailure("WordVersionHistoryRestore",
"multipleClientsInCoauthSession",{isIntentional:!0,additionalValues:wa},Q),this.jf.KB(mf.a.pAc,{succeeded:!1}),ja.ULS.sendTraceTag(592197006,3005,10,"RestoreVersionRequest failed with MultipleClientsInCoauthSession"),this.controller.setCoauthRestoreError(),Hd.Hom();else if(Q.StatusCode){wa.extendedProperties.set("status",Da.a[Q.StatusCode]);const eb=this.qmb.Ndb("ServerOperationFailed",5);this.jf.logKpiFailure("WordVersionHistoryRestore","restoreVersionResponseFailed",{isIntentional:!1,additionalValues:wa},
eb);this.jf.KB(mf.a.pAc,{succeeded:!1});ja.ULS.sendTraceTag(592197007,3005,10,"RestoreVersionRequest failed with "+Da.a[Q.StatusCode]);this.controller.setRestoreFailedAtServer(this.uQd)}else this.jf.logKpiSuccess("WordVersionHistoryRestore",{additionalValues:wa}),this.jf.KB(mf.a.pAc,{succeeded:!0}),ja.ULS.sendTraceTag(592197008,3005,50,"Restore Version Successful."),this.uQd();else wa=this.qmb.Ndb("ServerOperationFailed",5),this.jf.logKpiFailure("WordVersionHistoryRestore","serverOperationFailed",
{isIntentional:wa.isIntentional},wa),ja.ULS.sendTraceTag(592197009,3005,10,"serverOperation failed with "+Kg.a[Q.statusCode]),this.controller.setRestoreFailedAtServer(this.uQd)}fjn(){this.controller.getRestoreVersionSelectedEvent().addListener(Q=>{if(this.K6b)ja.ULS.sendTraceTag(536998742,3005,50,"restore already in progress");else{this.K6b=!0;this.utd();var wa=Fc.hla();this.jf.logKpiUsage("WordVersionHistoryRestore",0);var eb=null;Q&&(eb=Q.split("-")[0]);eb&&""!==eb?(Q=Object.assign(new ac,{revisionId:eb,
bTf:wa}),ja.ULS.sendTraceTag(592197013,3005,50,"VersionHistoryPaneActor: RegisterForRestoreVersionSelectedEvent: {0}",eb),this.controller.setRestoreInProgress(),this.mbl(19,!1,this.obl,this.yIh,Q,null,null)):(eb=this.qmb.Ndb("InvalidRevisionId",5),this.jf.logKpiFailure("WordVersionHistoryRestore","invalidRevisionId",{isIntentional:eb.isIntentional},eb),this.jf.KB(mf.a.pAc,{succeeded:!1}),ja.ULS.shipAssertTag(592197012,3005,!1),this.K6b=!1)}})}kjn(){this.YWb.getRenderFailureEvent().addListener(Q=>
{const wa=this.qmb.Ndb(Q,1),eb=this.zab(this.pQa);this.pQa=null;this.jf.logKpiFailure("WordVersionHistorySelectVersion",Q,{isIntentional:wa.isIntentional,additionalValues:eb},wa);try{this.ev.ViewerErrorCode="ViewerErrorCode"in this.ev?this.ev.ViewerErrorCode+("; "+Q):Q,this.controller.setViewerError(!0),ja.ULS.sendTraceTag(592197014,3005,10,"Versions viewer error code: {0}",Q)}catch(Lb){ja.ULS.sendTraceTag(592197015,3005,10,"Failed to set viewer error: {0}",Lb)}})}$in(){this.YWb.getLoadFinishEvent().addListener(()=>
{null==this.F_c&&(this.F_c=Fc.hla());const Q=this.zab(this.pQa);this.pQa=null;this.jf.logKpiSuccess("WordVersionHistorySelectVersion",{additionalValues:Q});this.controller.setVersionLoadComplete()})}hjn(){this.controller.getShowVersionChangesToggledEvent().addListener(()=>{null===this.pQa&&(this.pQa=Fc.hla());this.R8f.s7n()})}allowKeytips(Q){vg.a("allowKeytips")&&appChrome.api.allowKeytips(Q)}tG(){this.QS.Hw(km.AppFrame.qna);this.allowKeytips(!1);this.QS.Hw(ye.AFrame.Xp);this.QS.Hw(km.AppFrame.Sna);
this.Ai.nK("VersionHistoryViewer",!1);this.QS.tG("VersionHistoryViewer");this.Ai.nK("VersionHistoryHeader",!0);this.QS.tG("VersionHistoryHeader");this.Ai.nK("VersionHistoryOverlay",!0);this.QS.tG("VersionHistoryOverlay")}Hw(){this.QS.tG(km.AppFrame.qna);this.allowKeytips(!0);this.QS.tG(ye.AFrame.Xp);this.QS.tG(km.AppFrame.Sna);this.QS.Hw("VersionHistoryOverlay");this.Ai.GQ("VersionHistoryOverlay");this.QS.Hw("VersionHistoryHeader");this.Ai.GQ("VersionHistoryHeader");this.QS.Hw("VersionHistoryViewer");
this.Ai.GQ("VersionHistoryViewer")}Twk(){this.K6b&&ja.ULS.sendTraceTag(536998743,3005,10,"restore did not complete!");this.WOf();document.getElementById("VersionHistoryOverlay").style.display="none";this.ev.browser=ua.a.WE;ua.a.l2&&(this.ev.electronBrowserVersion=ua.a.AZk);this.Hw();ja.ULS.sendTraceTag(592197017,3005,50,Pa.c(this.ev))}Xtn(Q){try{if(this.YWb)Do.setIsPageLoadForFirstTime(!1);else{Do.setIsPageLoadForFirstTime(!0);const wa=this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsVersionHistoryBadGatewayFixEnabled",
!1)?this.V8f:"";this.YWb=this.gak.create(this.f4c,Q,this.isd,wa);this.kjn();this.$in()}}catch(wa){ja.ULS.sendTraceTag(592197018,3005,10,"WordVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",wa)}}pZe(Q){const wa=this.Ai.pe(Q);wa.parent=ye.AFrame.Lp;this.QS.tya(Q);wa.LL=!0;return wa}Aga(){this.pZe("VersionHistoryOverlay").Vca((Q,wa)=>{try{null!=Q&&"dialog/modal"==Q.name?this.controller.setSaveACopyCanceled():"VersionHistoryOverlay"===wa.name&&this.R5f.then(eb=>
{eb.enterFocusTrapZone();return null})}catch(eb){ja.ULS.sendTraceTag(592197019,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",eb)}});this.pZe("VersionHistoryHeader").Vca((Q,wa)=>{try{"VersionHistoryHeader"===wa.name&&this.R5f.then(eb=>{eb.enterHeaderFocusTrapZone();return null})}catch(eb){ja.ULS.sendTraceTag(592197020,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",eb)}});this.pZe("VersionHistoryViewer").Vca((Q,wa)=>{try{"VersionHistoryViewer"===
wa.name&&ai.FocusManager.uK(document.getElementById("vhViewer"))}catch(eb){ja.ULS.sendTraceTag(592197021,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",eb)}})}Gom(){const Q=ea.a.instance.Pa("Common.ISystemInitiatedFeedback");Q?(Q.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"),Q.logActivity("VersionHistoryCheckExited","WordVersionHistoryFGIsEnabled")):ja.ULS.sendTraceTag(592197022,3005,10,"ISystemInitiatedFeedback was null")}Vsi(){const Q=ea.a.instance.Pa("Common.ISystemInitiatedFeedback");
Q?Q.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"):ja.ULS.sendTraceTag(592197023,3005,10,"ISystemInitiatedFeedback was null")}static Hom(){const Q=ea.a.instance.Pa("Common.ISystemInitiatedFeedback");Q?Q.logActivity("VersionHistoryRestoreCoauthFailed","VersionHistoryRestoreSurveyEnabled"):ja.ULS.sendTraceTag(578359496,3005,10,"LaunchVHRestoreFailedDuringCoauthFloodgateSurvey::ISystemInitiatedFeedback was null")}Zin(Q){Q&&Q.addEventListener("keydown",wa=>{wa.ctrlKey&&"KeyC"===wa.code&&
(this.utd(),this.jf.logKpiUsage("WordVersionHistoryCopyText",0));wa.ctrlKey&&"KeyF"===wa.code&&this.jf.logKpiUsage("WordVersionHistorySearchText",0)})}}Hd.Q4n="ErrorCode";Hd.vetoName="VersionHistoryExperienceDegraded";Object(f.a)(Hd,"VersionHistoryPaneActor",null,[1664]);class re{constructor(){this.shouldUseBaseForCaching=this.Jkj=this.Ikj=this.Lkj=this.Kkj=!1}}Object(f.a)(re,"WordVersionHistorySettings",null,[]);class df{Ndb(Q,wa,eb){let Lb={name:"VersionHistoryExperienceDegraded",isIntentional:!1};
0==wa?Lb.errorNameOverride="VersionHistoryLaunchFailed":1==wa?Q.includes("Failed to fetch")?Lb.errorNameOverride="SelectVersionFailedBecauseFetchFailed":Q.includes("Unexpected server response (500) while retrieving PDF")?Lb.errorNameOverride="SelectVersionFailedServerResponseInternalError":Q.includes("Unexpected server response (502) while retrieving PDF")?Lb.errorNameOverride="SelectVersionFailedServerResponseBadGateway":Q.includes("Unexpected server response (415) while retrieving PDF")?(Lb.errorNameOverride=
"SelectVersionFailedServerResponseUnsupportedMediaType",Lb.isIntentional=!0):Q.includes("Unexpected server response (408) while retrieving PDF")?Lb.errorNameOverride="SelectVersionFailedServerResponseRequestTimeout":Q.includes("Unexpected server response (400) while retrieving PDF")?Lb.errorNameOverride="SelectVersionFailedServerResponseBadRequest":Q.includes("Unexpected server response (413) while retrieving PDF")?(Lb.errorNameOverride="SelectVersionFailedServerResponseRequestEntityTooLarge",Lb.isIntentional=
!0):Lb.errorNameOverride="SelectVersionFailed":5==wa?(Lb.errorNameOverride="RestoreVersionFailed"+Q,Lb.isIntentional="MultipleClientsInCoauthSession"===Q):4==wa?Lb.errorNameOverride="DownloadVersionFailed"+Q:2==wa?Lb.errorNameOverride=df.qUf+Q:3==wa&&(eb?(Lb.errorNameOverride=df.qUf+eb,Lb.isIntentional="OverwriteTarget"===eb||"TargetFileLocked"===eb):(Q=this.Ksl(Q),Lb.errorNameOverride=Q?"SaveVersionFailedServerResponse"+Q:df.qUf));return Lb}Ksl(Q){switch(Q){case "400":return"BadRequest";case "401":return"Unauthorized";
case "403":return"Forbidden";case "404":return"NotFound";case "408":return"Timeout";case "500":return"InternalError";default:return""}}}df.qUf="SaveVersionFailed";Object(f.a)(df,"WordVersionHistoryVetoHelper",null,[1662]);var hh=d(997),fk=d(990);class cg{constructor(Q,wa){this.Bce=Q;this.jf=wa;this.xPe=null;this.vOc=!0}initialize(Q){this.xPe=Q}s7n(){this.vOc=!this.vOc;this.display(this.q3e)}display(Q){this.q3e=Q;this.Fwf(Q);if(this.xPe){var wa=this.Bce.mNl(Q,this.vOc);if(2==wa)this.Bce.dXm(Q.currentVersion.RevisionID);
else{1==wa&&this.jf.logKpiFailure("WordVersionHistoryShowChanges","BaseNotAvailable",{isIntentional:!1},{name:"VersionHistoryExperienceDegraded"});this.Bce.FPm(Q.currentVersion.RevisionID);try{this.xPe.onVersionSelected(this.q3e.currentVersion,this.q3e.baseVersion,null,this.vOc)}catch(eb){ja.ULS.sendTraceTag(524957267,3005,10,"Exception thrown by onVersionSelected: {0}",eb)}}}else this.bAm()}Fwf(Q){this.Bce.Q7l(Q.currentVersion.RevisionID)||(this.jf.logKpiUsage("WordVersionHistorySelectVersion",0,
{isForAlertableKpi:!0}),this.vOc&&!Q.noBaseToCompareTo&&this.jf.logKpiUsage("WordVersionHistoryShowChanges",0))}bAm(){this.jf.logKpiFailure("WordVersionHistorySelectVersion","VersionDisplayActorUninitialized",{isIntentional:!1},{name:"VersionHistoryExperienceDegraded"});ja.ULS.sendTraceTag(524957266,3005,10,"AppVersionController was not initialized!")}}Object(f.a)(cg,"VersionDisplayActor",null,[1661]);var Xg;(function(Q){Q[Q.notStarted=0]="notStarted";Q[Q.inProgress=1]="inProgress";Q[Q.complete=2]=
"complete"})(Xg||(Xg={}));Object(f.b)("WaitForBaseState",Xg);class Kh{constructor(Q,wa){this.revisionId=Q;this.jf=wa;this.state=Xg.notStarted}get LNk(){return this.revisionId}begin(){this.state==Xg.notStarted&&(this.startTime=Fc.hla(),this.state=Xg.inProgress,this.jf.logKpiUsage("WordVersionHistoryWaitForBase",1),ja.ULS.sendTraceTag(524957265,3005,50,"WaitForBaseOperation.begin"))}end(Q){if(this.state==Xg.inProgress){this.state=Xg.complete;this.endTime=Fc.hla();const wa=Fc.rBk(this.endTime-this.startTime);
this.revisionId==Q?this.jf.logKpiSuccess("WordVersionHistoryWaitForBase",{additionalValues:wa}):this.jf.logKpiFailure("WordVersionHistoryWaitForBase","WaitForBaseTimedOut",{additionalValues:wa},{name:"VersionHistoryExperienceDegraded"})}}}Object(f.a)(Kh,"WaitForBaseOperation",null,[]);class Rh{constructor(Q){this.jf=Q}mNl(Q,wa){return Q.noBaseToCompareTo||!wa?0:Q.baseVersion?Q.baseVersion.DownloadUrl&&0<Q.baseVersion.DownloadUrl.length?0:void 0===Q.baseVersion.DownloadUrl||null===Q.baseVersion.DownloadUrl?
1:0==Q.baseVersion.DownloadUrl.length?2:1:1}Q7l(Q){return this.aMb?this.aMb.LNk==Q:!1}FPm(Q){this.aMb&&this.S6i(Q)}dXm(Q){this.aMb&&this.S6i(Q);this.aMb=new Kh(Q,this.jf);this.aMb.begin()}S6i(Q){this.aMb.end(Q);this.aMb=null}}Object(f.a)(Rh,"WaitForBaseController",null,[1658]);class Xe{constructor(){this.zlo={crewAlias:"webasynccollabeng",featureName:"VersionHistory",topLevelKpiName:"VersionHistoryFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.VersionHistory"}init(){H.AFrameworkApplication.Zsf()?
(ja.ULS.sendTraceTag(39966528,3005,50,"WordVersionHistoryPackage:init - Initializing the React VersionHistory package"),ab.a.get_instance().sl(7,()=>{const Q=this.container.resolve("Common.IDynamicScriptLoaderProvider").tE;(H.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("wordVersionHistory"):Q.loadScript("wordVersionHistory")).catch(wa=>ja.ULS.sendTraceTag(39966529,3005,10,"Failed to load the resources for the versionHistory feature: {0}",wa)).then(()=>this.XWm()).catch(wa=>
ja.ULS.sendTraceTag(39966530,3005,10,"Failed to initialize the versionHistory feature: {0}",wa))})):ja.ULS.sendTraceTag(39966498,3005,50,"WordVersionHistoryPackage:init - Not initializing the React VersionHistory package because the feature is disabled")}XWm(){ja.ULS.sendTraceTag(541942913,3005,50,"Finished loading resources for the versionHistory feature");this.container.resolve("IVersionHistoryPaneActor").Vb();return null}dispose(){}zc(Q){this.container=Q;this.K=this.container.resolve("Common.IAppSettingsManager");
if(this.K.$("AppSupportsVersionHistory")){var wa=this.container.resolve("Common.IBrowserUtils"),eb=new re;eb.Kkj=this.K.$("WordWdDownloadTokenIsEnabled");eb.Lkj=this.K.$("WordWdDownloadTokenRegisterIsEnabled");eb.Ikj=this.K.$("WordVersionHistoryEnableRestore");eb.Jkj=this.K.$("WordVersionHistorySaveACopyOverFlowMenuIsEnabled");eb.shouldUseBaseForCaching=this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsVersionHistoryCacheFixEnabled",!1);this.container.ha("IFeatureUsageAndHealthLogger",()=>
new hh.a(Ga.Health.instance,new fk.a,this.zlo)).singleInstance();this.container.ha("IWaitForBaseController",()=>new Rh(this.container.resolve("IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("IVersionDisplayActor",()=>new cg(this.container.resolve("IWaitForBaseController"),this.container.resolve("IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("IVersionHistoryPaneActor",()=>new Hd(H.AFrameworkApplication.ya,ai.FocusManager.instance(),on.a.instance,ic.a.HP,qe.App.xa,
qe.App.A_,eb,wa,new Mn,H.AFrameworkApplication.K,new Kq,new ji.a,new df,this.container.resolve("IFeatureUsageAndHealthLogger"),this.container.resolve("IVersionDisplayActor"))).singleInstance()}}static main(){let Q=!1;H.AFrameworkApplication.K&&H.AFrameworkApplication.K.$("IsOnDemandVersionHistoryEnabled")&&H.AFrameworkApplication.Zsf()&&(Q=!0);ca.a.instance.Pc(new Xe,0,Q)}}Object(f.a)(Xe,"WordVersionHistoryPackage",null,[1,2]);var Be=d(104);class te{constructor(Q,wa,eb){this.ga=Q;this.Hm=wa;this.Ma=
eb}Vb(){this.Ma.$("ZoomPopupDialogIsEnabled")&&(this.ga.pa(Na.a.sec,Aa.a.frame,Object(a.a)(this.Hm,this.Hm.sec,"showZoomDialog")),this.ga.gb(Na.a.ibn,Aa.a.frame,Object(a.a)(this.Hm,this.Hm.Mxi,"onQueryZoomText"),96),this.ga.pa(Na.a.l4c,Aa.a.frame,Object(a.a)(this.Hm,this.Hm.Ykj,"zoomDialogTabFocusHandler")),this.ga.pa(Na.a.k4c,Aa.a.frame,Object(a.a)(this.Hm,this.Hm.Ykj,"zoomDialogTabFocusHandler")));this.Ma.$("ZoomSliderIsEnabled")&&(this.ga.gb(Na.a.gHi,Aa.a.frame,Object(a.a)(this.Hm,this.Hm.TTm,
"onQueryZoomPercentage"),96),this.ga.gb(Na.a.blj,Aa.a.frame,Object(a.a)(this.Hm,this.Hm.oXm,"onZoomToPercentage"),96),this.ga.pa(Na.a.rto,Aa.a.frame,Be.ActionManager.Nf))}}Object(f.a)(te,"CommonZoomActor",null,[915]);class Nf extends te{constructor(Q,wa,eb){super(Q,wa,eb);this.Rca=wa}Vb(){super.Vb();this.Ma.$("ZoomPopupDialogIsEnabled")&&(this.ga.pa(mf.a.r$f,Aa.a.frame,Be.ActionManager.Nf),this.ga.pa(mf.a.jde,Aa.a.frame,Object(a.a)(this.Rca,this.Rca.qto,"zoomTo100")));this.ga.pa(mf.a.zoomToPageWidth,
Aa.a.frame,Object(a.a)(this.Rca,this.Rca.zoomToPageWidth,"zoomToPageWidth"));this.ga.pa(Na.a.Ieb,Aa.a.frame,Object(a.a)(this.Rca,this.Rca.Ieb,"increaseZoom"));this.ga.pa(Na.a.hbb,Aa.a.frame,Object(a.a)(this.Rca,this.Rca.hbb,"decreaseZoom"));this.ga.pa(mf.a.WUf,Aa.a.frame,Object(a.a)(this.Rca,this.Rca.fOn,"setZoomLevelFromRibbon"));this.ga.gb(mf.a.Nib,Aa.a.frame,Object(a.a)(this.Rca,this.Rca.Mxi,"onQueryZoomText"),96);this.ga.gb(mf.a.W0d,th.a.application,Object(a.a)(this.Rca,this.Rca.STm,"onQueryZoomLevelLabelText"),
96);this.ga.pa(jg.a.Guh,Aa.a.frame,Be.ActionManager.Nf);this.ga.pa(jg.a.Fuh,Aa.a.frame,Be.ActionManager.Nf);this.ga.pa(jg.a.Kuh,Aa.a.frame,Be.ActionManager.Nf);this.ga.pa(jg.a.Huh,Aa.a.frame,Be.ActionManager.Nf);this.ga.pa(mf.a.eha,Aa.a.frame,Be.ActionManager.Nf)}}Object(f.a)(Nf,"WordEditorZoomActor",te,[]);class kg{constructor(Q,wa){this.zoom=Q;this.M9j=wa}}Object(f.a)(kg,"SetCustomZoomArgs",null,[]);var gk=d(1117);class Lh{constructor(Q,wa){this.VOk=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,
"200%","150%","100%","75%","50%"];this.WOk=[Lh.k2e,Lh.oyd,"200","150","100","75","50"];this.eka=3;this.HM=0;this.delta=.1;this.Vuf=0;this.fe=new l.a;this.ig=null;this.K=Q;this.Ac=wa;this.s_i(1)}get vj(){return this.HM}s_i(Q){this.HM=Q}get BCc(){return Math.round(100*this.vj)}get AJm(){return Math.floor(this.BCc/10)/10+this.delta}get zJm(){return Math.ceil(this.BCc/10)/10-this.delta}get ga(){return H.AFrameworkApplication.ya}Q7j(Q){this.fe.addHandler("ZoomChanged",Q)}oqn(Q){this.fe.removeHandler("ZoomChanged",
Q)}b7(Q){this.Q7j(Q)}ejb(Q){this.oqn(Q)}JKi(){}yMi(){}IKi(){}xMi(){}m4c(Q){this.Zkj(Q,this.vj)}Zkj(Q,wa){null!==Q&&Yj.a.XLn(Q,wa)}fYf(Q,wa=!0){let eb=Q*=100;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(eb=new kg(Q,wa));this.TWi(eb)}eOn(Q,wa=!1){this.eha(Q,3|(wa?0:4))}mXm(Q,wa,eb){if(1===Q)return 32;Q=eb/100;Q<this.oRc?Q=this.oRc:Q>this.ZQc&&(Q=this.ZQc);this.eha(Q,1);wa&&(wa.Jr=Math.floor(100*Q));return 32}Mxi(Q,wa,eb,Lb,ec){if(1===eb)return 32;Q=Vb.a.rAa(this.BCc,6,H.AFrameworkApplication.numberFormat);
ec.Value=Q;ec.LabelText=Q;return 32}oXm(Q,wa,eb,Lb,ec){return 1===eb?32:this.mXm(eb,Lb,ec.value)}TTm(Q,wa,eb,Lb,ec){ec.MinValue=100*this.oRc;ec.MaxValue=100*this.ZQc;ec.value=this.BCc;return 32}J_h(){return this.VOk}K_h(){return this.WOk}Gml(){let Q=Math.floor(100*this.vj).toString();1===this.eka?Q=Lh.k2e:2===this.eka&&(Q=Lh.oyd);return Q}Ieb(Q,wa,eb){if(1===eb)return 32;this.zQc(this.Ac?this.Ac.yG:0,"IncreaseZoom");this.eka=0;this.eha(this.AJm);return 32}hbb(Q,wa,eb){if(1===eb)return 32;this.zQc(this.Ac?
this.Ac.yG:0,"DecreaseZoom");this.eka=0;this.eha(this.zJm);return 32}fOn(Q,wa,eb,Lb,ec){if(1===eb)return 32;this.zQc(this.Ac?this.Ac.yG:0,"SetZoomLevelFromRibbon");Q=ec.Value;if(Q.toLowerCase().startsWith("fit"))return Q=new Yb.a(0,1,0,()=>{this.zoomToPageWidth(0,null,2,null,null)},138,void 0,!0),Tf.a.instance.$b(Q),32;Q=parseInt(Q)/100;if(isNaN(Q))return 2;this.eka=0;this.eha(Q);return 32}zQc(Q,wa){ja.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",
Q,wa,H.AFrameworkApplication.ua.Sb.aq)}sec(Q,wa,eb){if(1===eb)return 32;ja.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();return 32}showDialog(){const Q=this.Gml();this.ig=new gk.a(this.J_h(),this.K_h(),Object(a.a)(this,this.oTl,"handleZoomDialogResult"),ai.FocusManager.instance(),!0);this.ig.sec(CommonUIStrings.l_ZoomDialogTitle,Q)}D$l(Q){return Q.toLowerCase()===Lh.k2e.toLowerCase()}E$l(Q){return Q.toLowerCase()===Lh.oyd.toLowerCase()}oTl(Q){if(Q){if(this.D$l(Q)){this.eka=
1;var wa=32}else if(this.E$l(Q))this.eka=2,wa=this.zoomToPageWidth(0,null,2,null,null);else if(wa=Number.parseInvariant(Q)){this.eka=0;let eb=wa;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(eb=new kg(wa,!0));wa=this.TWi(eb)}else wa=8;32===wa?ja.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:Q}):ja.ULS.sendTraceTag(7156360,353,10,"Failed to Zoom: {0}",{["DialogResult"]:Q})}else ja.ULS.sendTraceTag(529290753,353,10,"Failed to Zoom: {0}",{["DialogResult"]:Q})}ddn(){this.fe.raiseEvent("ZoomChanged",
null)}MHi(){}lOf(){}Ykj(Q){if(!this.ig)return 2;var wa=this.ig.Ai.Cs().Uj.G1;if(wa===this.ig.gz&&Q===Na.a.l4c||wa===this.ig.aG&&Q===Na.a.k4c)this.ig.tub||this.ig.LBn(),this.ig.Ai.Cs().Uj.hy(this.ig.tub);else if(wa.id.startsWith(this.ig.TVc)||wa.className.startsWith(this.ig.rHi))wa=null,Q===Na.a.l4c?wa=this.ig.aG:Q===Na.a.k4c&&(wa=this.ig.gz),this.ig.Ai.Cs().Uj.hy(wa),Sys.UI.DomElement.removeCssClass(this.ig.tub.parentNode,this.ig.cOf);else if(Q===Na.a.l4c)this.ig.Ai.Cs().g9b();else if(Q===Na.a.k4c)this.ig.Ai.Cs().e9b();
else return 2;return 32}}Lh.k2e="FullPage";Lh.oyd="PageWidth";Object(f.a)(Lh,"ZoomManager",null,[822]);var wj;(function(Q){Q[Q.manual=0]="manual";Q[Q.fitToFullPage=1]="fitToFullPage";Q[Q.fitWidth=2]="fitWidth";Q[Q.onBoot=3]="onBoot"})(wj||(wj={}));Object(f.b)("ZoomStatus",wj);d(1017);var kj;(function(Q){Q[Q.normal=0]="normal";Q[Q.quiet=1]="quiet";Q[Q.disableScrollUpdate=2]="disableScrollUpdate";Q[Q.disableUiControlUpdate=4]="disableUiControlUpdate"})(kj||(kj={}));Object(f.b)("ZoomUpdateFlags",kj);
var If=d(257),jr=d(353),kr=d(1172);class Dt extends Lh{constructor(Q,wa,eb,Lb,ec,Tc,Ad){super(Q,wa);this.Xpo=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%","75%","50%"];this.Ypo=[Lh.oyd,"200","150","125","100","75","50"];this.tKe=this.jQi=!1;this.Ztg="AutoFitForAdaptiveLayout";this.ZBj="FitPageWidthFailure";this.BXj="UpdateZoomFailure";this.ZYj="wwf";this.JLe=null;this.rPf=()=>{this.eka===wj.fitWidth&&this.p8e()};this.mNk=we=>{if(we.ctrlKey&&(H.AFrameworkApplication.ya.processAction(jg.a.Huh,
2),this.XYj)){we=we.cpo;if(!we)return!1;this.eha(this.vj-(0<we?.1:-.1));this.zQc(6,"CtrlScroll");return!0}return!1};this.nXm=()=>{ja.ULS.sendTraceTag(42341578,353,50,"Click event detected on Zoom Label. IsSLR: {0}",!0);return!0};this.IV=eb;this.Kj=Lb;this.Wb=ec;this.gg=Tc;this.tnc=Ad;this.FLg=Q.$("KeepViewAfterZoomIsEnabled");this.$Yj=Q.$("ZoomShortCutIsEnabled");this.XYj=Q.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableZoomScroll",!1);this.PXj=Q.$("DoNotAutoScrollAfterPinchIsEnabled");
this.OGj=(this.cse=Q.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&Q.$("AutoFitForSmallScreenModeIsEnabled");this.Zzj=Q.$("DoNotProcessUpdateZoomActionIsEnabled");this.aZj=Q.$("ZoomSliderIsEnabled");this.Uy()}get appName(){return"WordEditor"}get ZQc(){return 4}get oRc(){return.1}get nNk(){return wacBoot.CtrlWheelMetrics}e7j(Q){this.fe.addHandler("PinchStart",Q)}dqn(Q){this.fe.removeHandler("PinchStart",Q)}d7j(Q){this.fe.addHandler("PinchEnd",Q)}cqn(Q){this.fe.removeHandler("PinchEnd",Q)}get MI(){return null!=
this.Xog?this.Xog:this.Xog=ea.a.instance.Pa("WordEditor.IStatusBarUser")}phj(Q){Q=!(Q&kj.disableUiControlUpdate);const wa=ab.a.get_instance().isCompleted(7);return Q&&wa?(Q={SelectZoomOption:"ComboBoxModel"},qe.App.xa&&qe.App.xa.ZF(Q),this.Pko(),!0):!1}eha(Q,wa=kj.normal){let eb=!0;this.Zzj||H.AFrameworkApplication.ya.processAction(mf.a.eha,2);if(this.vj===Q)return this.tKe||(this.tKe=this.phj(wa)),eb;Q>this.ZQc?Q=this.ZQc:Q<this.oRc&&(Q=this.oRc);var Lb=!!(wa&kj.quiet);1===Q||Lb||H.AFrameworkApplication.ya.processAction(mf.a.r$f,
2);try{Lb=null;qe.App.xa&&Object(ln.a)(kr.PageView,qe.App.xa.jb.Jc)&&(Lb=qe.App.xa.jb.Jc);let ec=-1,Tc=-1,Ad=-1;const we=!(wa&kj.disableScrollUpdate);this.FLg&&we&&(ec=Wg.SelectionEditor.SMl(ue.a.instance.ib.kb,Lb),Tc=Lb.qK.scrollLeft,Ad=Lb.qK.scrollTop);const Rd=this.vj;this.s_i(Q);this.ddn();this.tKe=this.phj(wa);we&&this.njo(Lb,ec,Tc,Ad,Rd)}catch(ec){eb=!1,ja.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",ec)}return eb}njo(Q,wa,eb,Lb,ec){Q&&Q.isActive?this.FLg?0<=wa&&100>=wa?Q.Cx.Naa(100-
wa,!0,!0):Q.Cx.Kmm(eb,Lb,ec,this.vj):Q.Cx.Naa():ja.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}qto(Q,wa,eb){2===eb&&(this.zQc(this.Ac?this.Ac.yG:0,"ZoomTo100"),this.eka=wj.manual,this.eha(1));return 32}TWi(Q){this.eka=wj.manual;let wa,eb=!0;if(this.PXj){if(!Object(ln.a)(kg,Q))return ja.ULS.sendTraceTag(51644238,353,10,"actiondata is not a SetCustomZoomArgs"),8;wa=Q.zoom/100;eb=Q.M9j}else wa=Number.parseInvariant(String.format("{0}",Q))/100;ja.ULS.sendTraceTag(7410915,
353,50,"Word Editor - Zoom to custom value: {0}",wa);Q=kj.normal;eb||(Q=kj.disableScrollUpdate);this.eha(wa,Q);return 32}zoomToPageWidth(Q,wa,eb){if(1===eb)return 32;ja.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");Object(Sf.a)("ZoomToPageWidth",!0);this.eka=wj.fitWidth;this.o1k();return this.p8e()}STm(Q,wa,eb,Lb,ec){if(1===eb)return 32;Q=Vb.a.rAa(this.BCc,6,H.AFrameworkApplication.numberFormat);ec[If.a.labelText]=Q;return 32}J_h(){return this.Xpo}K_h(){return this.Ypo}o1k(){this.jQi||
(qe.App.xa?(qe.App.xa.i1(this.rPf),this.jQi=!0):ja.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}p8e(){var Q=qe.App.xa?qe.App.xa.jb.Jc:null;if(Q&&qe.App.xa.eC){var wa=null;(Q=this.Dml(Q))&&(wa=this.IV.RL(Q));wa||(wa=this.IV.Ccf());if(null!==wa)return wa=Xn.a.instance.Gv(wa),wa=lm.a.Ni(wa,0),Q=this.tnc(),wa+=Q&&Q.G6d()?wacBoot.ShiftUtils.getFloatingObjectsContainerWidth():0,wa+=2*jr.a.T9f,this.eha(qe.App.xa.eC.offsetWidth/wa),32;ja.ULS.sendTraceTag(7185433,
353,10,"Zoom to page width: cannot find word section node.")}else ja.ULS.sendTraceTag(7185434,353,10,"Zoom to page width: cannot find editing view node.");return 8}Dml(Q){return Q&&Q.Cb&&Q.Cb.ib.kb&&Q.Cb.ib.kb.Qa&&Q.Cb.ib.kb.Qa.node?Q.Cb.ib.kb.Qa.node:null}Pko(){this.MI&&(this.aZj?(this.MI.FQ(Cp.a.mto),this.MI.FQ(Cp.a.nto)):this.MI.FQ(Cp.a.oto))}A0n(Q){Q||(Q=window.self.CtrlWheelMetrics);if(Q){var wa=Q.ctrlWheelOccurred;if("boolean"!==typeof wa)ja.ULS.sendTraceTag(594346948,353,15,"ctrlWheelMetrics module not found");
else{ja.ULS.sendTraceTag(594346947,353,50,"ctrlWheelOccurred: {0}",wa);try{Q.stop()}catch(eb){ja.ULS.sendTraceTag(594346946,326,15,"Exception: {0}",eb)}}}else ja.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}Uy(){this.A0n(this.nNk);if(this.Kj){var Q=document.getElementById(km.AppFrame.Syd);Q&&this.Kj.mb(B.a.ehb,Q,this.mNk)}this.Wb&&(Q=this.Wb.pe(km.AppFrame.iF),this.$Yj&&(Q.bindAction(Wd.KeyInputManager.mc(pg.a.chc,Wd.KeyInputManager.Mh),Na.a.Ieb),Q.bindAction(Wd.KeyInputManager.mc(pg.a.v3c,
Wd.KeyInputManager.Mh),Na.a.Ieb),Q.bindAction(Wd.KeyInputManager.mc(pg.a.dhc,Wd.KeyInputManager.Mh),Na.a.hbb),Q.bindAction(Wd.KeyInputManager.mc(pg.a.ehc,Wd.KeyInputManager.Mh),Na.a.hbb),Q.bindAction(Wd.KeyInputManager.mc(pg.a.b5c,Wd.KeyInputManager.Mh),mf.a.jde)));this.gg&&(this.JLe=document.getElementById("LabelShowZoomValue-MediumCompact"))&&this.gg.mb(B.a.click,this.JLe,this.nXm);this.OGj&&(qe.App.xa.tu.registerLayoutBreakpointChanged("canvas",wa=>{this.dRe(wa)}),qe.App.xa.tu.registerBoundingWindowRectsChanged("canvas",
()=>{this.dRe(qe.App.xa.tu.getLayoutBreakpoint())}))}dRe(Q){let wa=!0,eb="";if(this.eka!==wj.onBoot)return wa;Ga.Health.instance.recordKpiUsage(this.Ztg,0,this.ZYj,null);switch(Q){case "Small":8===this.p8e()&&(eb=this.ZBj,wa=!1);break;default:1===this.vj||this.eha(1)||(eb=this.BXj,wa=!1)}wa||Ga.Health.instance.recordKpiFailure(this.Ztg,eb,!0,!0,null);return wa}JKi(Q){this.e7j(Q)}yMi(Q){this.dqn(Q)}IKi(Q){this.d7j(Q)}xMi(Q){this.cqn(Q)}MHi(){this.fe.raiseEvent("PinchStart",null)}lOf(){this.fe.raiseEvent("PinchEnd",
null)}}Object(f.a)(Dt,"WordEditorZoomManager",Lh,[1638,822]);class xo{constructor(){this.W=null}get name(){return"WordEditor.Zoom"}init(){if(H.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")){const Q=this.W.resolve("WordEditor.Zoom.WordEditorZoomActor"),wa=this.W.resolve("WordEditor.Zoom.WordEditorZoomManager");Q.Vb();Sys.UI.DomElement.overrideGetBounds=!0;H.AFrameworkApplication.K.$("AdaptiveLayoutForSmallScreenModeIsEnabled")&&H.AFrameworkApplication.K.$("AutoFitForSmallScreenModeIsEnabled")&&
wa&&ab.a.get_instance().sl(4,()=>{wa.dRe(qe.App.xa.tu.getLayoutBreakpoint())||ja.ULS.sendTraceTag(578326819,353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}zc(Q){this.W=Q;H.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")&&(this.W.ha("WordEditor.Zoom.WordEditorZoomManager",()=>new Dt(H.AFrameworkApplication.K,H.AFrameworkApplication.ya,ag.WordSectionNavigator.instance,Hf.a.instance,ai.FocusManager.instance(),kk.a.instance,()=>Q.Pa("Box4.IFloatingObjectUpdater"))).singleInstance().as("Common.IZoomManager").as("WordEditor.IWordEditorZoomManager"),
this.W.ha("WordEditor.Zoom.WordEditorZoomActor",()=>new Nf(H.AFrameworkApplication.ya,this.W.resolve("WordEditor.Zoom.WordEditorZoomManager"),H.AFrameworkApplication.K)).singleInstance())}static main(){ca.a.instance.Pc(new xo)}}Object(f.a)(xo,"ZoomPackage",null,[1,2]);var rk=window.FormatPictureTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",
ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",
attrs:{Id:"GroupFormatPictureControlsSection"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",LabelText:"STR@L_Properties"}},{name:"Button",attrs:{Id:"btnPicture",Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",
IsStretched:"true",TextAlign:"Right"},children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextTitle",Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",
MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",LabelText:"STR@l_AlternativeTextDescriptionCaption",Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",
IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",
attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},
children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",
attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},
children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",
attrs:{Id:"RotateCollapsibleSection",Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",
attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]},xq=window.InteractivePerfTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InteractivePerfTaskPane",
Title:"Interactive Perf TaskPane",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"TypingSpeedMeterGroup"}},{name:"Group",attrs:{Id:"CpuMeterGroup"}},{name:"Group",attrs:{Id:"RenderGroup"}}]}]}]};class Lu extends ld.a{constructor(Q){super(!1,!1,!0);this.q5c=Q}start(){const Q={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.q5c.ukf}};this.Zh("",Object(a.a)(this,this.ewn,"resultHandler"),Q)}ewn(Q,wa){1===Q&&(this.q5c.ukf=wa.tooltipPersistenceEnabled)}}
Object(f.a)(Lu,"AccessibilitySettingsDialog",ld.a,[]);class Rs{constructor(Q,wa){this.ga=Q;this.q5c=wa}Vb(){this.ga.pa(Na.a.WTn,Aa.a.frame,Object(a.a)(this,this.XTn,"showAccessibilitySettingsDialogHandler"))}XTn(){(new Lu(this.q5c)).start();return 32}}Object(f.a)(Rs,"AccessibilitySettingsDialogActor",null,[1660]);const as=Q=>{const wa=new u.a;H.AFrameworkApplication.Ze.Lj(Yq(Q),1,null,null,!0,2,eb=>{200===eb.data.mf?wa.Gg("true"===eb.data.Ee.toLowerCase()):wa.Gg(!1)},()=>{wa.Gg(!1)},null,void 0,void 0,
void 0,void 0,"7");return wa.task},Yq=Q=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",H.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",Q,H.AFrameworkApplication.um);class Qo{constructor(){this.qQb=null}get ukf(){return!!this.qQb}set ukf(Q){Q!==this.qQb&&(this.qQb=Q,vg.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(Q),this.Xei()&&H.AFrameworkApplication.Ze.Lj(Yq("saveHoverableRibbonTooltipIsEnabled"),2,Q.toString().toLowerCase(),
null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}Vqm(){const Q=new u.a;if(this.qQb)Q.Gg(this.qQb);else if(this.Xei()){const wa=as("getHoverableRibbonTooltipIsEnabled");wa.continueWith(()=>{this.qQb=wa.result;vg.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(wa.result);Q.Gg(wa.result)},8)}else Q.Gg(!1)}Xei(){const Q=H.AFrameworkApplication.K.$("IsRoamingServiceEnabled"),wa=H.AFrameworkApplication.K.$("IsAnonymousUser");return Q&&!wa}}Object(f.a)(Qo,"AccessibilitySettingsInfo",
null,[1659]);class zl{constructor(){this.W=null}get name(){return"Common.App.AccessibilitySettings"}zc(Q){this.W=Q;this.W.register(Qo,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Xd(()=>new Qo).singleInstance();this.W.register(Rs,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Xd(()=>new Rs(H.AFrameworkApplication.ya,this.W.Pa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).singleInstance()}init(){const Q=
this.W.Pa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),wa=this.W.Pa("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");Q&&wa?(wa.Vb(),Q.Vqm()):w.b(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){ca.a.instance.Pc(new zl)}}Object(f.a)(zl,"AccessibilitySettingsPackage",null,[1,2]);class Zn{constructor(){this.events=[];this.qSf=!1}static Itf(Q){return Q.ctrlKey&&
"Control"!==Q.key||Q.altKey&&"Alt"!==Q.key||!!Zn.Rmm[Q.key]}static Ekk(Q,wa){let eb;eb=Zn.Itf(Q)?Q.key:" "===Q.key?"Space":"CharacterKey";return null!=wa?(wa.altPressed=(!!Q.altKey).toString(),wa.ctrlPressed=(!!Q.ctrlKey).toString(),wa.key=eb,wa.repeat=(!!Q.repeat).toString(),wa.shiftPressed=(!!Q.shiftKey).toString(),wa):{["altPressed"]:(!!Q.altKey).toString(),["ctrlPressed"]:(!!Q.ctrlKey).toString(),["key"]:eb,["repeat"]:(!!Q.repeat).toString(),["shiftPressed"]:(!!Q.shiftKey).toString()}}static gei(Q){return window.performance&&
window.performance.now&&Q.timeStamp<performance.now()}static EDh(Q){return!!Q&&Zn.gei(Q)&&Zn.Itf(Q)}static FDh(Q){return!!Q&&Zn.gei(Q)&&!Zn.Itf(Q)}keyPressedEventHandlerStart(Q,wa){Zn.FDh(Q)&&this.n6i(Q,wa)}keyPressedEventHandlerEnd(Q){Zn.FDh(Q)&&this.R6i(Q)}keyDownEventHandlerStart(Q,wa){Zn.EDh(Q)&&this.n6i(Q,wa)}keyDownEventHandlerEnd(Q){Zn.EDh(Q)&&this.R6i(Q)}n6i(Q,wa){Q={["metadata"]:Zn.Ekk(Q,wa),["timeStamp"]:this.lgc(Q.timeStamp),["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:this.lgc(performance.now()-
Q.timeStamp),["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0};this.events.push(Q);this.Ukn()}R6i(Q){if(0!==this.events.length){var wa=this.lgc(Q.timeStamp);for(let eb=this.events.length-1;0<=eb;--eb){const Lb=this.events[eb];if(Lb.timeStamp===wa){Lb.timeToHandlerFinishMs=this.lgc(performance.now()-Q.timeStamp);Lb.eventDurationMs=this.lgc(Lb.timeToHandlerFinishMs-Lb.timeToHandlerStartMs);break}}}}lgc(Q){return Number(Q.toFixed(2))}Ukn(){if(!this.qSf){const Q=document.createEvent("CustomEvent");
Q.initCustomEvent("aggregateeventtimingstart",!1,!1,null);dispatchEvent(Q);requestAnimationFrame(()=>{this.qSf=!1;const wa=performance.now();this.events.forEach(Lb=>{Lb.timeToRequestAnimationFrameMs=this.lgc(wa-Lb.timeStamp)});var eb=document.createEvent("CustomEvent");eb.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent(eb);this.events=[];eb=document.createEvent("CustomEvent");eb.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent(eb)});this.qSf=!0}}}
Zn.Rmm={["ArrowDown"]:!0,["ArrowLeft"]:!0,["ArrowRight"]:!0,["ArrowUp"]:!0,["Backspace"]:!0,["Delete"]:!0,["End"]:!0,["Enter"]:!0,["Escape"]:!0,["Home"]:!0,["PageDown"]:!0,["PageUp"]:!0,["Tab"]:!0};class Op{constructor(){this.a3d=this.Q_a=this.JMa=this.L8b=null;this.b7b=!1;this.Lbc=null;this.$Fc=[];this.L2c=()=>{Op.Ffm()&&null==this.Q_a?(this.JMa=null,this.Q_a=requestAnimationFrame(this.aRc)):null!=this.Q_a&&(cancelAnimationFrame(this.Q_a),this.Q_a=null)};this.aRc=Q=>{if(null!=this.JMa){const wa=
Q-this.JMa;if(null==this.L8b||this.L8b<wa)this.L8b=wa;for(let eb=0;eb<Op.ranges.length;++eb)if(wa<Op.ranges[eb]){++this.$Fc[eb];break}}this.JMa=Q;this.Q_a=requestAnimationFrame(this.aRc)};this.VOi=()=>{if(null!=this.L8b){var Q={};for(var wa=0;wa<Op.ranges.length;++wa)Q[Op.ranges[wa]]=this.$Fc[wa],this.$Fc[wa]=0;wa=performance.now();Q={["intervalStart"]:this.Lbc,["intervalEnd"]:wa,["maxFrameLengthMs"]:this.L8b,["frameData"]:Q};var eb=document.createEvent("CustomEvent");eb.initCustomEvent("reportframetiming",
!1,!1,Q);dispatchEvent(eb);this.L8b=null;this.Lbc=wa}}}static grf(){return!!window.performance&&!!window.performance.now}start(Q){!this.b7b&&Op.grf()&&(this.AOn(),this.a3d=setInterval(this.VOi,1E3*Q),this.Lbc=performance.now(),this.L2c(),document.addEventListener("visibilitychange",this.L2c),this.b7b=!0)}stop(){this.b7b&&(document.removeEventListener("visibilitychange",this.L2c),null!=this.a3d&&(clearInterval(this.a3d),this.a3d=null),null!=this.Q_a&&(cancelAnimationFrame(this.Q_a),this.Q_a=null),
this.VOi(),this.b7b=!1)}get nOc(){return this.b7b}AOn(){this.$Fc=[];for(let Q=0;Q<Op.ranges.length;++Q)this.$Fc.push(0)}}Op.Ffm=()=>"visible"===document.visibilityState;Op.ranges=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];Type.registerNamespace("B4RT");Type.registerNamespace("Box4.AccessibilityChecker");Type.registerNamespace("Box4.Symbols");Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");Type.registerNamespace("WordEditor.AccessibilityChecker");
Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");Type.registerNamespace("WordEditor.FirstRunExperience");Type.registerNamespace("WordEditor.FrameTiming");Type.registerNamespace("WordEditor.GraphMerge");Type.registerNamespace("WordEditor.InteractivePerfTaskPane");Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");
Type.registerNamespace("WordEditor.TrackChange");Type.registerNamespace("WordEditor.Zoom");Type.registerNamespace("Common.App.VersionHistory");Type.registerNamespace("WordEditor.VersionHistory");ca.a.instance.Pc(new Xe);nh.main();Type.registerNamespace("Common.App.AccessibilityChecker");Type.registerNamespace("Common.App.Assistance");m;Type.registerNamespace("CACPU");da.main();Type.registerNamespace("CAEventTimingMeter");ka.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Ia.main();
Type.registerNamespace("Common.App.GestureInput");Qa.main();Type.registerNamespace("Common.App.GestureManager");db.main();Type.registerNamespace("Common.ModernFontPicker");Type.registerNamespace("Common.App.OfflineLogger");ca.a.instance.Pc(new Xc);Type.registerNamespace("Common.App.O365Shell");gc.main();Type.registerNamespace("Common.App.PhoneLink");bf.main();Type.registerNamespace("Common.App.SensitiveLogging");In.main();Type.registerNamespace("Common.App.Rename");ca.a.instance.Pc(new Ue,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");
ca.a.instance.Pc(new fe);Type.registerNamespace("Common.App.SaveAsToHost");gn.main();Type.registerNamespace("Common.App.SaveToCloudStorage");gg.main();Type.registerNamespace("Common.App.SaveACopy");tl.main();Type.registerNamespace("Common.App.SaveToSharePoint");Ug.main();Type.registerNamespace("Common.App.SharedFilePicker");um.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");
Type.registerNamespace("CATypingSpeedMeter");uk.main();Dd;Ol.main();ca.a.instance.Pc(new kf);kn.main();rk;Mf.main();ca.a.instance.Pc(new to);Xr.main();Db.a.prototype.toString=$f.a.prototype.toString;Jh.a.E0h=new Ai.a;ca.a.instance.Pc(new Xl);xo.main();ca.a.instance.Pc(new Ml);ca.a.instance.Pc(new gr);ca.a.instance.Pc(new Bo);up.main();ll.main();Sm.main();ps.main();Type.registerNamespace("NLRT");ca.a.instance.Pc(new Pj);Type.registerNamespace("Common.App.AccessibilitySettings");zl.main();xq;pp.main();
ca.a.instance.Pc(new vn);window.EventTiming={EventTimingMeter:Zn,FrameTimingMeter:Op}}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16261146/wdjs/WordEditorDS.box4.dll2.js.map