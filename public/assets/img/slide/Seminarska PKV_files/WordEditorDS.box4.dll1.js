'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1007:function(D,M,d){function m(I,R=self){R.addEventListener("message",function W(P){if(P&&P.data){var {id:X,type:V,path:Y}=Object.assign({path:[]},P.data),ca=(P.data.och||[]).map(v);try{const sa=Y.slice(0,-1).reduce((ea,da)=>ea[da],I),ia=Y.reduce((ea,da)=>ea[da],I);switch(V){case "GET":var fa=ia;break;case "SET":sa[Y.slice(-1)[0]]=v(P.data.value);fa=!0;break;case "APPLY":fa=ia.apply(sa,ca);break;case "CONSTRUCT":const ea=
new ia(...ca);fa=Object.assign(ea,{[B]:!0});break;case "ENDPOINT":const {port1:da,port2:ja}=new MessageChannel;m(I,ja);fa=r(da,[da]);break;case "RELEASE":fa=void 0;break;default:return}}catch(sa){fa={value:sa,[K]:0}}Promise.resolve(fa).catch(sa=>({value:sa,[K]:0})).then(sa=>{const [ia,ea]=w(sa);R.postMessage(Object.assign(Object.assign({},ia),{id:X}),ea);"RELEASE"===V&&(R.removeEventListener("message",W),"MessagePort"===R.constructor.name&&R.close())})}});R.start&&R.start()}function f(I){if(I)throw Error("Proxy has been released and is not useable");
}function a(I,R=[],C=function(){}){let P=!1;const W=new Proxy(C,{get(X,V){f(P);if(V===F)return()=>u(I,{type:"RELEASE",path:R.map(Y=>Y.toString())}).then(()=>{"MessagePort"===I.constructor.name&&I.close();P=!0});if("then"===V){if(0===R.length)return{then:()=>W};X=u(I,{type:"GET",path:R.map(Y=>Y.toString())}).then(v);return X.then.bind(X)}return a(I,[...R,V])},set(X,V,Y){f(P);const [ca,fa]=w(Y);return u(I,{type:"SET",path:[...R,V].map(sa=>sa.toString()),value:ca},fa).then(v)},apply(X,V,Y){f(P);X=R[R.length-
1];if(X===G)return u(I,{type:"ENDPOINT"}).then(v);if("bind"===X)return a(I,R.slice(0,-1));const [ca,fa]=l(Y);return u(I,{type:"APPLY",path:R.map(sa=>sa.toString()),och:ca},fa).then(v)},construct(X,V){f(P);const [Y,ca]=l(V);return u(I,{type:"CONSTRUCT",path:R.map(fa=>fa.toString()),och:Y},ca).then(v)}});return W}function l(I){I=I.map(w);return[I.map(R=>R[0]),Array.prototype.concat.apply([],I.map(R=>R[1]))]}function r(I,R){J.set(I,R);return I}function w(I){for(const [R,C]of H)if(C.mih(I)){const [P,
W]=C.serialize(I);return[{type:"HANDLER",name:R,value:P},W]}return[{type:"RAW",value:I},J.get(I)||[]]}function v(I){switch(I.type){case "HANDLER":return H.get(I.name).deserialize(I.value);case "RAW":return I.value}}function u(I,R,C){return new Promise(P=>{const W=z();I.addEventListener("message",function Y(V){V.data&&V.data.id&&V.data.id===W&&(I.removeEventListener("message",Y),P(V.data))});I.start&&I.start();I.postMessage(Object.assign({id:W},R),C)})}function z(){return Array(4).fill(0).map(()=>
Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}D=d(0);const B=Symbol("Comlink.proxy"),G=Symbol("Comlink.endpoint"),F=Symbol("Comlink.releaseProxy"),K=Symbol("Comlink.thrown"),N=I=>"object"===typeof I&&null!==I||"function"===typeof I,H=new Map([["proxy",{mih:I=>N(I)&&I[B],serialize(I){const {port1:R,port2:C}=new MessageChannel;m(I,R);return[C,[C]]},deserialize(I){I.start();return a(I,[],void 0)}}],["throw",{mih:I=>N(I)&&K in I,serialize({value:I}){return[I instanceof Error?
{Rea:!0,value:{message:I.message,name:I.name,stack:I.stack}}:{Rea:!1,value:I},[]]},deserialize(I){if(I.Rea)throw Object.assign(Error(I.value.message),I.value);throw I.value;}}]]),J=new WeakMap;d.d(M,"a",function(){return L});class L{static jsj(I){L.i6a=I;L.TYj=a(I,[],void 0)}static get Endpoint(){return L.i6a}static get ksj(){return L.TYj}}Object(D.a)(L,"WorkerUtils",null,[])},1023:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{}Object(D.a)(m,"WaterlineOverrideSettings",null,[])},
1024:function(D,M,d){function m(z){return{scriptUrl:z,insideInitName:"window.UlsWorkerService.ulsWorkerInsideInit"}}d.r(M);d.d(M,"UlsWorkerService",function(){return v});d.d(M,"ulsWorkerInsideInit",function(){return u});d.d(M,"ulsWorkerInsideScript",function(){return m});D=d(0);var f=d(840),a=d(967),l=d(22),r=d(2),w=d(847);class v{constructor(z,B,G,F,K){this.dXj=new a.a(z,B,G,F,K)}yW(z){this.dXj.yW(z)}}Object(D.a)(v,"UlsWorkerService",null,[]);const u=({config:z,connection:B})=>{"Thread"===B.createMode&&
f.setConfig(z);z=l.a.instance.Pa("Common.IRefreshableAppSettings");const G=new v(w.a.Exd,!0,r.AFrameworkApplication.Ze,null!==z&&void 0!==z?z:r.AFrameworkApplication.K,z);return f.Endpoint.LZe(B,()=>G)}},1025:function(D,M,d){D=d(0);var m=d(444),f=d(534),a=d(674),l=d(245);class r extends l.a{constructor(){super();this.LowWaterline=this.HighWaterline=this.FileId=null}Wl(){return 97}static A9(G,F,K){const N=new r;N.FileId=G;N.HighWaterline=F;N.LowWaterline=K;return N}}Object(D.a)(r,"GetActivitiesRequest",
l.a,[]);class w extends l.a{constructor(G,F,K){super();this.Settings=this.Waterline=this.FileId=null;this.FileId=G;this.Waterline=F;this.Settings=K}Wl(){return 107}static A9(G,F,K){return new w(G,F,K)}}Object(D.a)(w,"GetRelevantActivitiesRequest",l.a,[]);class v extends l.a{constructor(G,F){super();this.WaterlineOverrideSettings=this.FileId=null;this.FileId=G;this.WaterlineOverrideSettings=F}Wl(){return 96}static A9(G,F){return new v(G,F)}}Object(D.a)(v,"GetWywaActivitiesRequest",l.a,[]);class u{}
Object(D.a)(u,"RelevantActivitiesSettings",null,[]);class z extends l.a{constructor(){super();this.FileId=null}Wl(){return 109}static A9(G){const F=new z;F.FileId=G;return F}}Object(D.a)(z,"UpdateWaterlineRequest",l.a,[]);d.d(M,"a",function(){return B});class B{constructor(G,F,K,N,H){this.yLj=G;this.Ijd=F;this.pDe=K;this.Ymb=N;this.Qvg=H}requestWYWAActivities(G){G=v.A9(this.Ijd(),G);return m.a.then(this.O9(G,"wywa"),F=>F)}requestActivities(G,F){G=r.A9(this.Ijd(),G,F);return m.a.then(this.O9(G,"activities"),
K=>K)}Htn(){const G=z.A9(this.Ijd());return m.a.then(this.O9(G,"waterline"),F=>F)}requestRelevantActivities(G,F){F=Object.assign(new u,{FirstDocumentOpen:F,MockDataEnabled:!1});G=w.A9(this.Ijd(),G,F);return m.a.then(this.O9(G,"relevant"),K=>K)}updateActivityState(G){return m.a.p1c(this.Qvg,F=>F.Qdo(G.itemIds,G.activityStatesToSet,G.activityStatesToReset,G.resetUnseenCount))}requestActivityFeed(){return m.a.p1c(this.Qvg,G=>G.getActivityFeed(null))}O9(G,F){const K={"Content-Type":"application/json; charset=utf-8"};
return m.a.then(m.a.p1c(this.yLj,N=>N.$x(this.pDe,K,f.a.Joh(G,this.Ymb),F)),N=>{if(!(N&&N.args&&N.args.data&&N.args.data.Ee))return null;({group:N}=a.a.G7(N.args.data.Ee));return N&&N.Responses&&N.Responses.length?N.Responses[0]:null})}}Object(D.a)(B,"SharedActivityRepository",null,[])},1179:function(D,M,d){D.exports=d(1180)()?globalThis:d(1181)},1180:function(D){D.exports=function(){return"object"===typeof globalThis&&globalThis?globalThis.Array===Array:!1}},1181:function(D){function M(){if("object"===
typeof self&&self)return self;if("object"===typeof window&&window)return window;throw Error("Unable to resolve global `this`");}D.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(d){return M()}try{return __global__?__global__:M()}finally{delete Object.prototype.Exo}}()},1182:function(D,M,d){Object.defineProperty(M,"__esModule",{value:!0});M.Jni=void 0;var m=d(911);M.Jni=function(f){return function(a){var l=
f[a];switch(typeof l){case "boolean":return(0,m.getBooleanFeatureGate)(a,l);case "number":return(0,m.FTh)(a,l);case "string":return(0,m.getStringFeatureGate)(a,l);default:throw Error("Wrong defaultValue type");}}}},1183:function(D,M,d){Object.defineProperty(M,"__esModule",{value:!0});M.Oni=void 0;var m=d(912);M.Oni=function(){return function(f){return(0,m.isChangeGateEnabled)(f)}}},1184:function(D,M,d){function m(l){var r=(0,a.fWf)(void 0);(0,a.fWf)(function(){var w=void 0!==r?r():{};return f.__assign(f.__assign({},
w),l)});return r}Object.defineProperty(M,"__esModule",{value:!0});M.pZm=M.nZm=void 0;var f=d(75),a=d(912);M.nZm=m;M.pZm=function(l,r){return m(r)}},1185:function(D,M,d){function m(l){function r(){return{}}for(var w,v,u={},z=0,B=Object.keys(l);z<B.length;z++){var G=B[z];u[G]=null===(w=l[G])||void 0===w?void 0:w.toString()}var F=null!==(v=(0,a.xWf)(void 0))&&void 0!==v?v:r;(0,a.xWf)(function(){return f.__assign(f.__assign({},F()),u)});return F}Object.defineProperty(M,"__esModule",{value:!0});M.qZm=
M.oZm=void 0;var f=d(75),a=d(911);M.oZm=m;M.qZm=function(l,r){return m(r)}},1381:function(D,M,d){d.d(M,"a",function(){return f});var m;(function(a){a[a.Unknown=0]="Unknown";a[a.Wuo=1]="Inference"})(m||(m={}));var f;(function(a){a[a.Unknown=0]="Unknown";a[a.Vwo=1]="VoiceDictationBadge";a[a.Wwo=2]="VoiceDictationPhrase"})(f||(f={}))},1476:function(D,M,d){d.r(M);d.d(M,"Box4PasteSteward",function(){return ca});D=d(0);var m=d(22),f=d(2),a=d(16),l=d(130),r=d(58),w=d(5),v=d(8),u=d(31),z=d(79),B=d(9),G=d(139),
F=d(11),K=d(3),N=d(20),H=d(6),J=d(64),L=d(231),I=d(41),R=d(92),C=d(42),P=d(48),W=d(33),X=d(469),V=d(468),Y=d(1682);class ca extends Y.a{constructor(fa,sa,ia,ea,da,ja,Ga,ya=null,ta=null){super(fa,Ga,ya,ta);this._formatting=null;this.EGa=!1;this.xpb=null;this.rQb=-1;this.erb=0;this.Mvc=new z.a;this.WDm=4294967295;u.a(4223754,307,C.OutlineElementReader.Nh(fa));this.Epb=sa;this.Epb.zXb(this);this.VK=ia;this.VK.zXb(this);this.np=ea;this.Jo=da;this.aBm=ja;this.cBe=J.ListReader.$h(this.Bc);ca.O1l();ca.B1l();
ca.i2l()}get eta(){return null!=this.ylg?this.ylg:this.ylg=m.a.instance.Pa("Box4.IInternalLinkManager")}get fxd(){return this._formatting}get oZb(){return this.cBe&&!this.VK.Fza}get txb(){return 0<this.erb}reset(){super.reset();this._formatting=this.Obf(!1)}zPe(fa){u.a(4223762,307,C.OutlineElementReader.Nh(this.Bc)||R.OutlineReader.rw(this.Bc));this.j9b(!1);var sa=new H.GraphIterator;sa.fd(this.Bc);fa=Y.a.eh.uN(this.Bc,this.$Hc(fa));this.brd(sa,!1);u.a(4223763,307,fa===this.Bc.currentNode);u.a(4223764,
307,F.ParagraphReader.oc(fa));-1!==this._formatting.Ws&&ca.paragraphEditor.lD(fa,this._formatting.Ws);if(ca.paragraphEditor.np&&!this.c0.d2i){if(this._formatting.textIndent){({unit:da,returnValue:ea}=ca.YTc(this._formatting.textIndent));var ia=!1;if(ea||!J.ListReader.lZ){if(0>ea){ia=!0;var ea=-1*ea}var da=ca.Nvd(ea,da);ia?ca.paragraphEditor.np.Rjb(fa,da):ca.paragraphEditor.np.Raa(fa,da)}}!this._formatting.marginLeft||ca.Zd.WCb||J.ListReader.$h(sa)||({unit:sa,returnValue:ia}=ca.YTc(this._formatting.marginLeft),
sa=ca.Nvd(ia,sa),ca.paragraphEditor.np.Bna(fa,1,sa))}(ca.Rd.wg||N.a.instance.J(3)&&B.App.Av.bgc)&&fa.setValue(w.a.JCb,!0);this._formatting.lineSpacing&&ca.paragraphEditor.$B(fa,this._formatting.lineSpacing);if(this._formatting.efc){sa=[];ia=[];da=[];ea=this._formatting.efc.split(" ");let ya=1,ta=0;for(let ua=0;ua<ea.length;ua++){var ja=ca.UDk(ea[ua]),Ga=ca.TDk(ea[ua]);if(-1!==ja)ya=ja;else if(-1!==Ga)ta=Ga;else{({unit:ja,returnValue:Ga}=ca.YTc(ea[ua]));ja=ca.Nvd(Ga,ja);if(0<=ja&&ja<=this.WDm)sa.push(ja),
ia.push(ya),da.push(ta);else{u.b(555103310,307,15,"Invalid custom tab value. tabStops: "+this._formatting.efc+" index: "+ua);break}ya=1;ta=0}}0<sa.length&&ca.paragraphEditor.D0j(fa,sa,ia,da)}this._formatting.paragraph=fa;this.EGa=!0}brd(fa,sa){u.a(8128518,307,!sa);this.aU&&(0<this.aU&&this.np.bDc(fa,this.aU),0>this.aU&&this.np.XNa(fa,this.aU,0));fa&&this.Jo.J5d(fa,this.txb);this.aU=0}Z$d(fa){this.Mvc.add(fa)}AVe(){this.aU=0}saa(fa,sa=null){u.a(4223772,307,F.ParagraphReader.wh(this.Bc));const ia=this.Bc.currentNode;
this._formatting.k5f(ia);if(!this.c0.t5f(this.Bc,sa,!1)){var ea=ia.qa.last,da=W.a.iw(ia);this.EGa&&(ea.formatting=this._formatting.IP.Yf(ea),N.a.instance.J(6)&&ia.qn(),this.EGa=!1);fa=this.c0.Nif(fa,sa);this.c0.TDa(this.Bc.currentNode,this._formatting.zaa,sa);this.characterPropertiesEditor.replaceTextRange(da,fa,void 0,void 0,K.a.paste)}}HCa(fa){this.c0.yOd&&this.c0.ANd(fa)?(this.EF(),this.FF(fa)):(u.a(4223773,307,F.ParagraphReader.wh(this.Bc)),fa=W.a.iw(this.Bc.currentNode),this.characterPropertiesEditor.Iea(fa,
sa=>new X.a(sa)))}Xhb(){this.c0.Sif(this.Bc)}lua(fa){if(ca.SXk(fa)){const sa=this.Bc.currentNode;F.ParagraphReader.oc(sa)&&(sa.dac=fa.U6e)}else this.Epb.lua(fa)}DCa(fa){this._formatting=fa;this.EGa=!0}uNa(fa){u.a(4223774,307,F.ParagraphReader.wh(this.Bc));u.a(4223775,307,!this.xpb);u.a(4223776,307,0>this.rQb);this.xpb=fa;this.rQb=F.ParagraphReader.textLength(this.Bc.currentNode)}tNa(){u.a(4223777,307,F.ParagraphReader.wh(this.Bc));u.a(4223778,307,!!this.xpb);u.a(4223779,307,0<=this.rQb);let fa=W.a.createTextRange(this.Bc.currentNode,
this.rQb,F.ParagraphReader.textLength(this.Bc.currentNode)),sa="",ia="";this.eta&&({dQf:sa,TIh:ia}=this.eta.m5f(G.HyperlinkReader.kLa(this.xpb))).returnValue&&(this.xpb=sa,ia&&(this.characterPropertiesEditor.replaceTextRange(fa,ia),fa=W.a.createTextRange(this.Bc.currentNode,this.rQb,F.ParagraphReader.textLength(this.Bc.currentNode))));ca.hyperlinkEditor.DG(fa,this.xpb,!1);this.EGa=!0;this.xpb=null;this.rQb=-1}FF(fa){this.zPe(fa);this._formatting.nae(this.Bc.currentNode);this.c0.TDa(this.Bc.currentNode,
this._formatting.zaa,fa)}EF(){u.a(4223808,307,F.ParagraphReader.wh(this.Bc));ca.hyperlinkEditor.R0k(this.Bc.currentNode);I.OutlineElementNavigator.ae(this.Bc)}Uhb(){}Thb(){}zNa(){}r0a(){}KCa(){u.a(4223809,307,C.OutlineElementReader.Nh(this.Bc)||R.OutlineReader.rw(this.Bc));let fa=!1;this.txb||(fa=this.oZb||!0);fa||(this.aU+=1);this.erb++}ICa(){this.erb--;let fa=!1;this.txb||(fa=this.oZb||!0,this.Jo.HQf(this.Mvc));fa||--this.aU}yNa(fa){u.a(4223810,307,C.OutlineElementReader.Nh(this.Bc)||R.OutlineReader.rw(this.Bc));
u.a(4223811,307,!!fa.listStyleType);this.Jo.I5d(this.Qpm(fa))}JCa(){u.a(4223813,307,C.OutlineElementReader.Nh(this.Bc));f.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");if(ca.Zd.WCb&&J.ListReader.$h(this.Bc)){const fa=F.ParagraphReader.Ym(this.Bc.currentNode),sa=this.aBm.aAb(this.Bc);V.a.Zd.KL||this.Jo.H5d(sa,fa,null)}}u0a(fa){this.Epb.u0a(fa)}raa(fa){this.VK.raa(fa)}oaa(){this.VK.oaa()}qaa(fa){this.VK.qaa(fa)}paa(){this.VK.paa()}naa(fa){this.VK.naa(fa)}maa(){this.VK.maa()}static get paragraphEditor(){return null!=
ca.Ong?ca.Ong:ca.Ong=m.a.instance.resolve("Box4.IParagraphEditor")}static get hyperlinkEditor(){return null!=ca.zjg?ca.zjg:ca.zjg=m.a.instance.resolve("Box4.IHyperlinkEditor")}static get Rd(){return null!=ca.Mqg?ca.Mqg:ca.Mqg=m.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get i9f(){return null!=ca.nrg?ca.nrg:ca.nrg=m.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get Xec(){return ca.zHe}static set Xec(fa){ca.zHe=fa}static get Zd(){return L.a.getInstance()}static O1l(){const fa=
N.a.instance.J(8);ca.J0a[1]=fa?P.StyleReader.wordStyleIdHeading1:P.StyleReader.styleIdHeading1;ca.J0a[2]=fa?P.StyleReader.wordStyleIdHeading2:P.StyleReader.styleIdHeading2;ca.J0a[3]=fa?P.StyleReader.wordStyleIdHeading3:P.StyleReader.styleIdHeading3;ca.J0a[4]=fa?P.StyleReader.$3a:P.StyleReader.uva;ca.J0a[5]=fa?P.StyleReader.a4a:P.StyleReader.yPa;ca.J0a[6]=fa?P.StyleReader.b4a:P.StyleReader.zPa;ca.J0a[7]=fa?null:P.StyleReader.P2a}static B1l(){ca.Nta.unspecified=0;ca.Nta.defaultUnordered=1;ca.Nta.defaultOrdered=
1;ca.Nta.none=0;ca.Nta.disc=1;ca.Nta.circle=2;ca.Nta.square=3;ca.Nta.decimal=1;ca.Nta.lowerAlpha=2;ca.Nta.lowerRoman=3;ca.Nta.upperAlpha=4;ca.Nta.upperRoman=5}static i2l(){ca.zHe=ca.i9f.Ip()}static UDk(fa){let sa=-1;if(!fa)return sa;fa=fa.toLowerCase();switch(fa){case "left":sa=1;break;case "center":sa=3;break;case "right":sa=4;break;case "decimal":sa=6;break;case "bar":sa=7}return sa}static TDk(fa){let sa=-1;if(!fa)return sa;fa=fa.toLowerCase();switch(fa){case "blank":sa=0;break;case "dotted":sa=
1;break;case "dashed":sa=2;break;case "lined":sa=3}return sa}static Iwb(fa){const sa=a.a.substring(fa,0,2),ia=a.a.substring(fa,2,4);return a.a.substring(fa,4,6)+ia+sa}static YTc(fa){let sa=0;const ia=fa.length;var ea=a.a.substring(fa,0,ia-2);ea=parseFloat(ea);fa=a.a.substr(fa,ia-2,2);switch(fa){case "in":sa=3;break;case "px":sa=7;break;case "cm":sa=1;break;case "pt":sa=5;break;default:v.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",
fa),ea=0}return{returnValue:ea,unit:sa}}static Nvd(fa,sa){let ia=0;switch(sa){case 3:ia=l.a.wF(fa);break;case 7:ia=r.a.Ty(fa,0);break;case 1:ia=l.a.BUe(fa);break;case 5:ia=l.a.wF(l.a.iKf(fa));break;default:v.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",fa,sa)}return ia}static SXk(fa){return!!fa&&!!fa.U6e&&""!==fa.U6e}}ca.J0a=Array(8);ca.Nta={};ca.zHe=null;Object(D.a)(ca,"Box4PasteSteward",Y.a,[])},1500:function(D,M,d){D=
d(0);var m=d(2),f=d(1886),a=d(8);const l=(w,v)=>{const u={};let z=null;switch(w){case 0:z="HtmlProcessor";var B=v.a;null!=B&&(u.SessionID=B);var G=v.b.toString();null!=G&&(u.Elements=G);var F=v.c.toString();null!=F&&(u.PrunedElements=F);var K=v.d.toString();null!=K&&(u.TransparentElements=K);var N=v.e.toString();null!=N&&(u.VoidElements=N);var H=v.f.toString();null!=H&&(u.UnknownElements=H);break;case 1:z="WordConverter";var J=v.a;null!=J&&(u.SessionID=J);var L=v.b.toString();null!=L&&(u.BulletsConverted=
L);var I=v.c.toString();null!=I&&(u.NumberedConverted=I);break;case 2:z="FormattingSteward";var R=v.a;null!=R&&(u.SourceApp=R);var C=v.b;null!=C&&(u.Browser=C);var P=v.c;null!=P&&(u.OperationId=P);var W=v.d.toString();null!=W&&(u.Lang=W);var X=v.e.toString();null!=X&&(u.TextDir=X);var V=v.f.toString();null!=V&&(u.Bold=V);var Y=v.g.toString();null!=Y&&(u.Math=Y);var ca=v.h.toString();null!=ca&&(u.Italics=ca);var fa=v.i.toString();null!=fa&&(u.Underline=fa);var sa=v.j.toString();null!=sa&&(u.Strikethrough=
sa);var ia=v.k.toString();null!=ia&&(u.Subscript=ia);var ea=v.l.toString();null!=ea&&(u.Superscript=ea);var da=v.m.toString();null!=da&&(u.Fontsize=da);var ja=v.n.toString();null!=ja&&(u.Fontface=ja);var Ga=v.o.toString();null!=Ga&&(u.GrowFontsize=Ga);var ya=v.p.toString();null!=ya&&(u.ShrinkFontsize=ya);var ta=v.q.toString();null!=ta&&(u.FontColor=ta);var ua=v.r.toString();null!=ua&&(u.FontHighlight=ua);var Sa=v.s.toString();null!=Sa&&(u.ParagraphStyle=Sa);var ka=v.t.toString();null!=ka&&(u.TextAlign=
ka);var ha=v.u.toString();null!=ha&&(u.TextIndent=ha);var Ca=v.v.toString();null!=Ca&&(u.MarginLeft=Ca);var Pa=v.w.toString();null!=Pa&&(u.ParagraphSpaceBefore=Pa);var Xa=v.x.toString();null!=Xa&&(u.ParagraphSpaceAfter=Xa);var qa=v.y.toString();null!=qa&&(u.LineSpace=qa);var Ea=v.z.toString();null!=Ea&&(u.CellShadingColor=Ea);var Ia=v.ba.toString();null!=Ia&&(u.StyleDefinition=Ia);var na=v.bb.toString();null!=na&&(u.TabStops=na);break;case 3:z="SemanticEvents";var Na=v.a;null!=Na&&(u.SessionID=Na);
var Oa=v.b.toString();null!=Oa&&(u.Text=Oa);var Ra=v.c.toString();null!=Ra&&(u.LineBreak=Ra);var ab=v.d.toString();null!=ab&&(u.Image=ab);var zb=v.e.toString();null!=zb&&(u.File=zb);var Qa=v.f.toString();null!=Qa&&(u.FormattingChange=Qa);var yb=v.g.toString();null!=yb&&(u.Anchor=yb);var lb=v.h.toString();null!=lb&&(u.Paragraph=lb);var Eb=v.i.toString();null!=Eb&&(u.Math=Eb);var bc=v.j.toString();null!=bc&&(u.List=bc);var Pb=v.k.toString();null!=Pb&&(u.ListItem=Pb);var Va=v.l.toString();null!=Va&&
(u.RenderAugmentation=Va);var oa=v.m.toString();null!=oa&&(u.Span=oa);break;case 4:z="SemanticTableEvents";var pa=v.a;null!=pa&&(u.SessionID=pa);var Ya=v.b.toString();null!=Ya&&(u.Tables=Ya);var Ja=v.c.toString();null!=Ja&&(u.TableRow=Ja);var nb=v.d.toString();null!=nb&&(u.TableCell=nb);var Bb=v.e.toString();null!=Bb&&(u.TablePart=Bb);break;case 5:z="HtmlEvents";var mb=v.a;null!=mb&&(u.OperationId=mb);var Qb=v.b;null!=Qb&&(u.SourceApp=Qb);var Vb=v.c;null!=Vb&&(u.Browser=Vb);var mc=null==v.d?null:
v.d.toString();null!=mc&&(u.Text=mc);var ob=null==v.e?null:v.e.toString();null!=ob&&(u.A=ob);var cb=null==v.f?null:v.f.toString();null!=cb&&(u.Abbr=cb);var db=null==v.g?null:v.g.toString();null!=db&&(u.Acronym=db);var kb=null==v.h?null:v.h.toString();null!=kb&&(u.Address=kb);var Wb=null==v.i?null:v.i.toString();null!=Wb&&(u.Applet=Wb);var Fb=null==v.j?null:v.j.toString();null!=Fb&&(u.Area=Fb);var nc=null==v.k?null:v.k.toString();null!=nc&&(u.B=nc);var gc=null==v.l?null:v.l.toString();null!=gc&&(u.Base=
gc);var Jc=null==v.m?null:v.m.toString();null!=Jc&&(u.Basefont=Jc);var tb=null==v.n?null:v.n.toString();null!=tb&&(u.Bdo=tb);var dc=null==v.o?null:v.o.toString();null!=dc&&(u.Big=dc);var Yb=null==v.p?null:v.p.toString();null!=Yb&&(u.Blockquote=Yb);var pb=null==v.q?null:v.q.toString();null!=pb&&(u.Body=pb);var Gb=null==v.r?null:v.r.toString();null!=Gb&&(u.Br=Gb);var hb=null==v.s?null:v.s.toString();null!=hb&&(u.Button=hb);var Ib=null==v.t?null:v.t.toString();null!=Ib&&(u.Caption=Ib);var Ob=null==v.u?
null:v.u.toString();null!=Ob&&(u.Center=Ob);var kc=null==v.v?null:v.v.toString();null!=kc&&(u.Cite=kc);var Ac=null==v.w?null:v.w.toString();null!=Ac&&(u.Code=Ac);var Nc=null==v.x?null:v.x.toString();null!=Nc&&(u.Col=Nc);var kd=null==v.y?null:v.y.toString();null!=kd&&(u.Colgroup=kd);var Jd=null==v.z?null:v.z.toString();null!=Jd&&(u.Dd=Jd);var ge=null==v.ba?null:v.ba.toString();null!=ge&&(u.Del=ge);var Oc=null==v.bb?null:v.bb.toString();null!=Oc&&(u.Dfn=Oc);var qc=null==v.bc?null:v.bc.toString();null!=
qc&&(u.Dir=qc);var Xc=null==v.bd?null:v.bd.toString();null!=Xc&&(u.Div=Xc);var xe=null==v.be?null:v.be.toString();null!=xe&&(u.Dl=xe);var Ge=null==v.bf?null:v.bf.toString();null!=Ge&&(u.Dt=Ge);var bf=null==v.bg?null:v.bg.toString();null!=bf&&(u.Em=bf);var xd=null==v.bh?null:v.bh.toString();null!=xd&&(u.Fieldset=xd);var ke=null==v.bi?null:v.bi.toString();null!=ke&&(u.Font=ke);var Rf=null==v.bj?null:v.bj.toString();null!=Rf&&(u.Form=Rf);var pd=null==v.bk?null:v.bk.toString();null!=pd&&(u.Frame=pd);
var fe=null==v.bl?null:v.bl.toString();null!=fe&&(u.Frameset=fe);var Ec=null==v.bm?null:v.bm.toString();null!=Ec&&(u.H=Ec);var rd=null==v.bn?null:v.bn.toString();null!=rd&&(u.Head=rd);var Ld=null==v.bo?null:v.bo.toString();null!=Ld&&(u.Hr=Ld);var Gf=null==v.bp?null:v.bp.toString();null!=Gf&&(u.Html=Gf);var ld=null==v.bq?null:v.bq.toString();null!=ld&&(u.I=ld);var Pc=null==v.br?null:v.br.toString();null!=Pc&&(u.Iframe=Pc);var cd=null==v.bs?null:v.bs.toString();null!=cd&&(u.Img=cd);var Aa=null==v.bt?
null:v.bt.toString();null!=Aa&&(u.Input=Aa);var Wa=null==v.bu?null:v.bu.toString();null!=Wa&&(u.Ins=Wa);var $b=null==v.bv?null:v.bv.toString();null!=$b&&(u.Isindex=$b);var xc=null==v.bw?null:v.bw.toString();null!=xc&&(u.Kbd=xc);var bd=null==v.bx?null:v.bx.toString();null!=bd&&(u.Label=bd);var Wd=null==v.by?null:v.by.toString();null!=Wd&&(u.Legend=Wd);var vf=null==v.bz?null:v.bz.toString();null!=vf&&(u.Li=vf);var uf=null==v.ca?null:v.ca.toString();null!=uf&&(u.Link=uf);var oe=null==v.cb?null:v.cb.toString();
null!=oe&&(u.Map=oe);var Pe=null==v.cc?null:v.cc.toString();null!=Pe&&(u.Math=Pe);var We=null==v.cd?null:v.cd.toString();null!=We&&(u.Menu=We);var Xi=null==v.ce?null:v.ce.toString();null!=Xi&&(u.Meta=Xi);var zf=null==v.cf?null:v.cf.toString();null!=zf&&(u.Noframes=zf);var sf=null==v.cg?null:v.cg.toString();null!=sf&&(u.Noscript=sf);var Ye=null==v.ch?null:v.ch.toString();null!=Ye&&(u.Object=Ye);var Bh=null==v.ci?null:v.ci.toString();null!=Bh&&(u.Ol=Bh);var Sg=null==v.cj?null:v.cj.toString();null!=
Sg&&(u.Optgroup=Sg);var Ti=null==v.ck?null:v.ck.toString();null!=Ti&&(u.Option=Ti);var ig=null==v.cl?null:v.cl.toString();null!=ig&&(u.P=ig);var Tg=null==v.cm?null:v.cm.toString();null!=Tg&&(u.Param=Tg);var af=null==v.cn?null:v.cn.toString();null!=af&&(u.Pre=af);var qf=null==v.co?null:v.co.toString();null!=qf&&(u.Q=qf);var gj=null==v.cp?null:v.cp.toString();null!=gj&&(u.S=gj);var Fe=null==v.cq?null:v.cq.toString();null!=Fe&&(u.Samp=Fe);var $e=null==v.cr?null:v.cr.toString();null!=$e&&(u.Script=$e);
var Ff=null==v.cs?null:v.cs.toString();null!=Ff&&(u.Select=Ff);var ye=null==v.ct?null:v.ct.toString();null!=ye&&(u.Small=ye);var Sf=null==v.cu?null:v.cu.toString();null!=Sf&&(u.Span=Sf);var vg=null==v.cv?null:v.cv.toString();null!=vg&&(u.Strike=vg);var Tf=null==v.cw?null:v.cw.toString();null!=Tf&&(u.Strong=Tf);var wg=null==v.cx?null:v.cx.toString();null!=wg&&(u.Style=wg);var rf=null==v.cy?null:v.cy.toString();null!=rf&&(u.Sub=rf);var sh=null==v.cz?null:v.cz.toString();null!=sh&&(u.Sup=sh);var si=
null==v.da?null:v.da.toString();null!=si&&(u.Tables=si);var Dg=null==v.db?null:v.db.toString();null!=Dg&&(u.Tbody=Dg);var ai=null==v.dc?null:v.dc.toString();null!=ai&&(u.Td=ai);var Ue=null==v.dd?null:v.dd.toString();null!=Ue&&(u.Textarea=Ue);var ed=null==v.de?null:v.de.toString();null!=ed&&(u.Tfoot=ed);var Dl=null==v.df?null:v.df.toString();null!=Dl&&(u.Th=Dl);var Hi=null==v.dg?null:v.dg.toString();null!=Hi&&(u.Thead=Hi);var tk=null==v.dh?null:v.dh.toString();null!=tk&&(u.Title=tk);var ok=null==v.di?
null:v.di.toString();null!=ok&&(u.Tr=ok);var se=null==v.dj?null:v.dj.toString();null!=se&&(u.Tt=se);var bi=null==v.dk?null:v.dk.toString();null!=bi&&(u.U=bi);var sl=null==v.dl?null:v.dl.toString();null!=sl&&(u.Ul=sl);var El=null==v.dm?null:v.dm.toString();null!=El&&(u.Var=El);var ci=null==v.dn?null:v.dn.toString();null!=ci&&(u.Unknown=ci);break;case 6:z="List";var Kk=v.a;null!=Kk&&(u.SessionID=Kk);var pf=v.b.toString();null!=pf&&(u.MaxListLevel=pf)}u.Table=z;return Sys.Serialization.JavaScriptSerializer.serialize(u)};
d.d(M,"a",function(){return r});class r{static get Ola(){null==r.fqb&&(r.fqb=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("UsageEditorLoggingIsDisabled"));return r.fqb}static get Rci(){null==r.pte&&(r.pte=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("WordUsageEditorLoggingIsEnabled"));return r.pte}static LZ(w){a.ULS.sendTraceTag(524038472,307,50,w)}static BQh(w){const v={};v.a=w;v.b=0;v.c=0;v.d=0;v.e=0;v.f=0;return v}static awm(w){r.Ola||r.LZ(l(0,w))}static VLh(w){const v=
{};v._sessionID=w;return v}static Qhf(w){const v={};v.a=w;v.b=0;v.c=0;return v}static FAm(w){r.Ola||r.LZ(l(1,w))}static AQh(w,v){const u={};u.c=f.a[w];u.a=v;return u}static $vm(w,v){r.Rci&&w&&(w.b=v,r.LZ(l(5,w)))}static lXh(w){const v={};v.a=w;v.b=0;v.c=0;v.d=0;v.e=0;v.f=0;v.g=0;v.h=0;v.i=0;v.j=0;v.k=0;v.l=0;v.m=0;return v}static gzm(w){r.Ola||r.LZ(l(3,w))}static mXh(w){const v={};v.a=w;v.b=0;v.c=0;v.d=0;v.e=0;return v}static hzm(w){r.Ola||r.LZ(l(4,w))}static Ocf(w,v){const u={};u.b=f.a[w];u.c=v;
u.d=0;u.e=0;u.f=0;u.g=0;u.h=0;u.i=0;u.j=0;u.k=0;u.l=0;u.m=0;u.n=0;u.o=0;u.p=0;u.q=0;u.r=0;u.s=0;u.t=0;u.w=0;u.x=0;u.y=0;u.z=0;u.u=0;u.v=0;u.ba=0;u.bb=0;return u}static Evm(w,v){r.Rci&&w&&(w.a=v,r.LZ(l(2,w)))}static hwl(w){const v={};v.a=w;v.b=-1;return v}static Cwm(w){!r.Ola&&w&&0<=w.b&&r.LZ(l(6,w))}}r.fqb=null;r.pte=null;Object(D.a)(r,"UsageEditor",null,[])},1516:function(D,M,d){d.d(M,"a",function(){return a});D=d(0);var m=d(2),f=d(6);class a{static get hlb(){return!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("WordDesignerTelemetryPerConstructIsEnabled")}static Xcb(l,
r=!1){const w=f.GraphIterator.$a(l);w.vd();return(r?w.Rb(4):w.e6(4))?4:f.GraphIterator.$a(l).Bb(36)?16:f.GraphIterator.$a(l).Bb(14)?2:f.GraphIterator.$a(l).Bb(38)?32:1}}Object(D.a)(a,"ConstructTypeHelper",null,[])},1529:function(D,M,d){d.d(M,"a",function(){return W});D=d(0);var m=d(79),f=d(127),a=d(22),l=d(170),r=d(2),w=d(205),v=d(5),u=d(96),z=d(65),B=d(9),G=d(49),F=d(586),K=d(228),N=d(247),H=d(11),J=d(64),L=d(278),I=d(21),R=d(14),C=d(297),P=d(3);class W{static get Tg(){return K.ContextSetEditor.instance}static get Zf(){return N.a.instance}static get Lc(){return f.a.instance}static mw(){return W.Cm||
(W.Cm=a.a.instance.Za("Box4.IExternalSelectionManager"))}static get Yx(){return null!=W.Rng?W.Rng:W.Rng=a.a.instance.resolve("Box4.IParagraphIndentationReader")}static CKl(){this.cN||(this.cN=new m.a,this.cN.add(P.a.Pv),this.cN.add(P.a.font),this.cN.add(P.a.zX),this.cN.add(P.a.Gja),this.cN.add(P.a.bold),this.cN.add(P.a.setItalic),this.cN.add(P.a.superscript),this.cN.add(P.a.subscript),this.cN.add(P.a.CVa),this.cN.add(P.a.Uya),this.cN.add(P.a.lJa),this.cN.add(P.a.DUe),this.cN.add(P.a.mJa),this.cN.add(P.a.BVa),
this.cN.add(P.a.BL),this.cN.add(P.a.kM),this.cN.add(P.a.clearFormatting),this.cN.add(P.a.kab),this.cN.add(P.a.jAc));return this.cN}static r5b(X){return W.CKl().contains(X)?!0:!1}static yv(X,V,Y,ca,fa){var sa=!0;if(!V.view.Be)return 2;var ia=V.view,ea=ia.Cb;ea&&ea.ib.kb||(W.Lc.Yb(u.a.zf,{["Reason"]:z.a.noSelection}),sa=!1);W.Tg.jza(I.ImageReader.kNc,ia.Cb.Rg)&&(W.Lc.Yb(u.a.zf,{["Reason"]:z.a.KXe}),sa=!1);if(W.Tg.jza(I.ImageReader.pZa,ia.Cb.Rg))return W.Lc.Yb(u.a.zf,{["Reason"]:z.a.fBc}),8;var da=!W.r5b(X);
W.Zf.z5b(ia.Cb.Rg,da)&&(W.Lc.Yb(u.a.zf,{["Reason"]:z.a.UD}),sa=!1);W.Tg.jza(I.ImageReader.vNd,ia.Cb.Rg)&&(W.Lc.Yb(u.a.zf,{["Reason"]:z.a.FXe}),sa=!1);W.Tg.jza(C.c,ia.Cb.Rg)&&(W.Lc.Yb(u.a.zf,{["Reason"]:z.a.GXe}),sa=!1);W.Tg.jza(L.a.opf,ia.Cb.Rg)&&(W.Lc.Yb(u.a.zf,{["Reason"]:z.a.EXe}),sa=!1);W.Tg.Wva(H.ParagraphReader.KW,ia.Cb.Rg)&&(W.Lc.Yb(u.a.zf,{["Reason"]:z.a.pN}),sa=!1);W.mw()&&W.mw().instance&&W.mw().instance.vT(ia.Cb.Rg)&&(W.Lc.Yb(u.a.zf,{["Reason"]:z.a.externalSelection}),sa=!1);var ja=null;
ea&&ea.ib.kb&&(ja=ea.ib.kb);X===P.a.h8d&&ja&&ja.VD&&H.ParagraphReader.cK(ja.Qa.node)&&!J.ListReader.pr&&(sa=!1);if(1===Y||!sa||!ja)return sa?32:8;sa=X===P.a.d8b||X===P.a.uYb||X===P.a.lcc||X===P.a.t1b;ia=X===P.a.XGb||X===P.a.Ixb||X===P.a.Abc;da=X===P.a.cPa||X===P.a.dPa||X===P.a.$B;const Ga=new G.GraphTransaction(15);Ga.Db(ja.Qa.node);ja=new m.a;let ya=!1;if(sa||ia||da)l.a.mark(7121),V=W.Tg.mJh(V.tk);else{l.a.mark(7119);V=F.OutlineElementGeneralizer.Hka(ea.ib,!0);if(!V)return W.Lc.Yb(u.a.Aka,{["Reason"]:z.a.TAd}),
Ga.dispose(),8;ea=X===P.a.WYa||X===P.a.Jeb;V.Rw&&ea&&(ya=W.xUl(ja,V))}(X===P.a.leftJustify||X===P.a.d8b||X===P.a.centerJustify||X===P.a.uYb||X===P.a.rightJustify||X===P.a.lcc||X===P.a.fullJustify||X===P.a.t1b)&&V.Rw&&1<V.length&&W.yUl(V)&&(fa||(fa={}),Object.getType(fa)===Object&&(fa.InContextSet=!0));r.AFrameworkApplication.ya.Qf(V,X,Y,!0,ca,fa);ya&&W.hKm(ja,V,fa);Ga.dispose();B.App.xa.updateCommandUI();sa||ia||da?l.a.mark(7122):l.a.mark(7120);return 32}static xUl(X,V){if(!V.Rw)return!1;let Y=!1,
ca=!1;for(let sa=0;sa<V.length;sa++)if(V.getContext(sa).ul){var fa=V.getContext(sa).node;fa&&(fa=W.Yx.mdb(fa),2===fa.specialIndentType?(Y=!0,X.add(sa)):1!==fa.specialIndentType&&fa.specialIndentType||(ca=!0))}return ca&&Y}static hKm(X,V,Y){if(V.Rw)for(let fa=0;fa<X.count;fa++){var ca=V.getContext(X.J(fa));if(!ca.ul)continue;ca=ca.node;const sa=W.Yx.mdb(ca);2!==sa.specialIndentType||w.a.DZ(Y.value,sa.tA)||ca.setValue(v.a.ge,sa.tA-sa.bba)}}static QYf(X,V){let Y=!0;V.contextId!==R.a.paragraph?Y=!1:W.Zf.VZa(V)?
(W.Lc.Yb(u.a.Mm,{["Reason"]:z.a.UD}),Y=!1):W.mw()&&W.mw().instance&&W.mw().instance.vT(V)?(W.Lc.Yb(u.a.Mm,{["Reason"]:z.a.externalSelection}),Y=!1):V.ul&&(V=V.node,H.ParagraphReader.oc(V)&&V.rP&&(W.Lc.Yb(u.a.Mm,{["Reason"]:z.a.pN}),Y=!1));return{returnValue:1!==X&&Y,zx:Y?32:8}}static yUl(X){if(!X.Rw)return!1;let V=1;for(let ca=0;ca<X.length;ca++){var Y=X.getContext(ca);if(Y&&Y.ul&&Y.contextId===R.a.paragraph&&(Y=Y.node))if(Y=H.ParagraphReader.Ev(Y),!ca)V=Y;else if(Y!==V)return!0}return!1}}W.Cm=null;
W.cN=null;Object(D.a)(W,"FormattingActionHelper",null,[])},1531:function(D,M,d){d.d(M,"a",function(){return f});d.d(M,"b",function(){return a});var m=d(2);const f=l=>{switch(l){case 2:return WordEditorIntl.WordEditorStrings.L_ResultTypeHeader;case 4:return WordEditorIntl.WordEditorStrings.L_ResultTypeFooter;case 8:return WordEditorIntl.WordEditorStrings.L_ResultTypeFootnote;case 16:return WordEditorIntl.WordEditorStrings.L_ResultTypeEndnote;case 32:return WordEditorIntl.WordEditorStrings.L_ResultTypeComment}return""},
a=()=>{var l;return null===(l=m.AFrameworkApplication.K)||void 0===l?void 0:l.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}},1540:function(D,M,d){d.r(M);D=d(0);var m=d(8),f=d(1884),a=d(1552),l;(function(ua){ua[ua.external=0]="external";ua[ua.msa=1]="msa";ua[ua.aad=2]="aad"})(l||(l={}));Object(D.b)("AuthorityType",l);class r{}Object(D.a)(r,"OAuthResult",null,[]);class w{constructor(ua){this.gLj=ua}initialize(){return Promise.resolve(0)}QRd(){return Promise.resolve(0)}aoa(){m.ULS.sendTraceTag(574239257,
3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new r,{IsSuccess:!0,Token:this.gLj}))}yae(){return Promise.resolve(Object.assign(new r,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}o9d(){return!1}OIc(){return"MockAuthTokenStrategy"}}Object(D.a)(w,"MockAuthTokenStrategy",null,[240]);var v=d(1592);class u{static get(ua,Sa,ka){if(!ka)return ua;
let ha=0;return Promise.race([ua,new Promise(Ca=>{ha=window.setTimeout(()=>{Ca(Sa)},ka)})]).then(Ca=>{window.clearTimeout(ha);return Promise.resolve(Ca)}).catch(()=>{window.clearTimeout(ha);return Promise.resolve(Sa)})}}Object(D.a)(u,"PromiseWithTimeout",null,[]);var z=d(2),B=d(1480);class G{constructor(ua,Sa,ka,ha,Ca){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=ua;this.scope=Sa;this.silentLogin=ka;this.options=ha;this.correlationId=Ca}}Object(D.a)(G,
"TokenRequestParameters",null,[265]);var F=d(15),K=d(22);class N{constructor(){this.i4g=null;let ua=z.AFrameworkApplication.K.lb(z.AFrameworkApplication.Zga),Sa=z.AFrameworkApplication.K.lb(z.AFrameworkApplication.Kae);this.FUb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",ua&&""!==ua?ua:"Unspecified",Sa&&""!==Sa?Sa:"Unspecified")}initialize(){return new Promise(ua=>{K.a.instance.Za("Common.App.WopiIdentity.IWopiIdentity").execute(Sa=>{this.i4g=Sa;ua(0)})})}pe(ua){const Sa=
["HTTPS:","API:"];let ka=!1;const ha=ua.toLocaleUpperCase();for(const Ca of Sa)if(ha.startsWith(Ca)){ka=!0;break}return ka||this.$bm(ua)?ua+"/.default":ua}$bm(ua){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(ua)}QRd(){return Promise.resolve(0)}aoa(ua,Sa,ka,ha,Ca,Pa,Xa){if(F.a.vMa){Ca=B.a.uoo;if(!Ca)return Sa=Object.assign(new r,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Sa);if(!Array.contains(Ca,
ua))return Sa=Object.assign(new r,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+ua}),Promise.resolve(Sa)}ua=this.pe(ka);ka=new G(ka,ua,!ha,null,z.AFrameworkApplication.userSessionId);return this.i4g.getAccessToken(ka,Sa,Xa).then(qa=>Object.assign(new r,{IsSuccess:!0,Token:qa.accessToken}),qa=>Object.assign(new r,{IsSuccess:!1,ErrorCode:qa}))}yae(){return Promise.resolve(Object.assign(new r,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}o9d(){return!1}OIc(){return this.FUb}}
Object(D.a)(N,"ParentFrameTokenStrategy",null,[240]);var H=d(43),J=d(1499),L=d(79);class I{constructor(){this.reject=this.resolve=null;this.startTime=0;this.$Fi=this.Kdh=null}}Object(D.a)(I,"PromiseWrapper",null,[]);class R{constructor(ua=0){this.jx=0;this.Osc=!1;this.vx=new L.a;this._timeout=ua}enqueue(ua){return new Promise((Sa,ka)=>{this.vx.add(Object.assign(new I,{$Fi:ua,resolve:Sa,reject:ka}));this.process()})}process(){if(this.Osc||this.jx===this.vx.count)return!1;const ua=this.vx.J(this.jx++);
try{this.Osc=!0,ua.$Fi().then(Sa=>{this.Osc=!1;this.$We(ua,Sa,null,!0)}).catch(Sa=>{this.Osc=!1;this.$We(ua,null,Sa,!1)})}catch(Sa){this.Osc=!1,this.$We(ua,null,Sa,!1)}return!0}$We(ua,Sa,ka,ha){if(ha){const Ca=()=>{ua.resolve(Sa);this.process()};0<this._timeout?window.setTimeout(()=>{Ca()},this._timeout):Ca()}else{const Ca=()=>{ua.reject(ka);this.process()};0<this._timeout?window.setTimeout(()=>{Ca()},this._timeout):Ca()}}}Object(D.a)(R,"PromiseQueue",null,[]);class C{constructor(){this.correlationId=
this.resolve=null}}Object(D.a)(C,"ResolveWithCorrelation",null,[]);var P=d(72),W=d(153),X=d(920),V=d(86);class Y extends W.a{constructor(ua,Sa,ka,ha,Ca,Pa,Xa){super(!1,!1,!0);this.Wzg=this.Ewa=null;this.mqa=ua;this.EPj=ka;this.Jt=ha;this.XWj=Ca;this.Tpb=Pa;this.pG=document.createElement("iframe");this.pG.id="SharedAuthInteractiveFrame";this.pG.setAttribute("name","SharedAuthInteractiveFrame");this.pG.setAttribute("title","SharedAuthInteractiveFrame");this.pG.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");
this.pG.style.border="0";this.pG.style.height="48px";this.pG.style.width="190px";$addHandler(this.pG,"error",Object(H.a)(this,this.xVm,"onSharedAuthFrameError"));ua=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.mqa,Sa,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",z.AFrameworkApplication.userType);Xa&&(ua+="&vnext=1");this.pG.src=ua;this.Dzj=new Promise(qa=>{this.Wzg=qa});this.Xzg=!1}nPa(){this.Ewa={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.EPj,
["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:z.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(H.a)(this,this.NHk,"createFrame"),["resolveDialogStyles"]:this.Wzg}};this.Ed=5;this.Zh(CommonUIStrings.l_SignIn,Object(H.a)(this,this.rPn,"sharedAuthConsentDialogHandler"),this.Ewa)}Cgj(ua=!1,Sa=5){this.Ewa&&this.Ewa.bodyControls&&(!0!==Object(P.a)(Object,this.Ewa.bodyControls).frameLoaded&&(Object(P.a)(Object,this.Ewa.bodyControls).frameLoaded=!0),ua!==Object(P.a)(Object,
this.Ewa.bodyControls).frameLoadSuccess&&(Object(P.a)(Object,this.Ewa.bodyControls).frameLoadSuccess=ua),Sa!==this.Ewa.dialogButtonsOption&&(this.Ewa.dialogButtonsOption=null,this.Ed=Sa),this.update(this.Ewa))}pWn(ua,Sa){const ka=new X.a(V.a.vPn);ka.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:z.AFrameworkApplication.isRtl,["messageCorrelationId"]:ua,["dialogStyles"]:Sa};this.Jt.X1a(ka,this.pG.contentWindow,this.mqa)}AIh(){this.Cgj(!1,6)}get W_i(){return this.pG}get LTk(){return this.Dzj.then(ua=>
{this.Xzg=!0;return ua})}get MTk(){return this.Xzg}xVm(){this.AIh()}NHk(){return this.pG}rPn(ua){0===ua&&(this.XWj.reject(Object.assign(new r,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.Tpb(null))}}Object(D.a)(Y,"SharedAuthConsentDialog",W.a,[264]);var ca=d(925),fa=d(84),sa=d(112),ia=d(37),ea=d(121),da=d(166);class ja{constructor(){this.pG=null;this.dbd=0;this.SRb=this.mVb=this.Sge=this.Tpb=this.S8=this.p2g=null;this.Jt=new ca.a(null,null);this.eod=
z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthVNext",!1);this.FUb="SharedAuthTokenStrategy "+(this.eod?"BrowserAuth 1.20210701.2/MSAL 2.11.0":"BrowserAuth 1.20210426.1/MSAL 2.11.0");this.mqa=B.a.tPn;this.sZg=B.a.sPn;this.vBg=B.a.enableConsoleLogging;this.JAj=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.jUj=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",
this.eod);this.C8a={};this.kGj=new R(1500)}OIc(){return this.FUb}initialize(){var {OAuthManager:ua}=d(1540);if("loadFrame"in this.C8a)return this.C8a.loadFrame.Kdh;if(!this.mqa)return fa.Health.instance.recordKpiFailure(ua.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),m.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);ua=this.R8d("loadFrame");this.dbd=ia.a.lf();var Sa=this.mqa+this.sZg+"?replyUrl="+window.location.protocol+
"//"+window.location.host+"&usid="+z.AFrameworkApplication.userSessionId+"&WacUserType="+z.AFrameworkApplication.userType;this.eod&&(Sa+="&vnext=1");this.pG=document.createElement("iframe");this.Ylf(this.pG);this.pG.style.cssText="height:0;width:0;display:none;";this.pG.id="SharedAuthFrame";this.pG.setAttribute("name","SharedAuthFrame");this.pG.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.pG.setAttribute("title","SharedAuthFrame");this.pG.src=Sa;document.body.appendChild(this.pG);
Sa=ia.a.lf()-this.dbd;m.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",Sa,this.pG.src);return ua}QRd(ua){this.Sge=ua;const Sa=new X.a(V.a.Z_i);Sa.Values=this.odh(ua);ua=this.R8d("initFrame");this.Jt.X1a(Sa,this.pG.contentWindow,this.mqa);m.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return ua}aoa(ua,Sa,ka,ha,Ca,Pa){const Xa=new X.a(V.a.wPn),qa=this.uWh();Xa.Values=
this.ccj(ua,Sa,ka,ha,Ca,Pa,qa);ua=this.R8d(qa);ha&&z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.kGj.enqueue(()=>new Promise(Ea=>{this.W$n(Pa,Xa,Ea,qa)})):(this.Jt.X1a(Xa,this.pG.contentWindow,this.mqa),m.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Sa));return ua}W$n(ua,Sa,ka,ha){const Ca=this.C8a[ha];Ca&&(this.mVb=Sa,this.Tpb=Object.assign(new C,{resolve:ka,correlationId:ha}),
this.S8=new Y(this.mqa,this.sZg,ua,this.Jt,Ca,ka,this.eod),this.S8.nPa())}uWh(){return ea.a.create().toString()}ccj(ua,Sa,ka,ha,Ca,Pa,Xa){const qa={};qa.appName=ua;qa.appId=Sa;qa.target=ka;qa.withPopup=ha;qa.claims=Ca;qa.promptMessage=Pa;qa.messageCorrelationId=Xa;return qa}Ylf(ua){$addHandler(ua,"load",Object(H.a)(this,this.jRm,"onIFrameLoaded"));$addHandler(ua,"error",Object(H.a)(this,this.Nhb,"onIFrameError"));this.Jt.LUa(this.mqa);this.Jt.vv(V.a.b0i);this.Jt.VB(V.a.b0i,Object(H.a)(this,this.ZUm,
"onScriptLoaded"));this.Jt.vv(V.a.a0i);this.Jt.VB(V.a.a0i,Object(H.a)(this,this.YUm,"onScriptInitialized"));this.Jt.vv(V.a.X_i);this.Jt.VB(V.a.X_i,Object(H.a)(this,this.NQm,"onGetTokenResponse"));this.Jt.vv(V.a.c0i);this.Jt.VB(V.a.c0i,Object(H.a)(this,this.hSm,"onLoginResponse"));this.Jt.vv(V.a.$_i);this.Jt.VB(V.a.$_i,Object(H.a)(this,this.FRm,"onInteractiveFlowReady"));this.Jt.vv(V.a.Y_i);this.Jt.VB(V.a.Y_i,Object(H.a)(this,this.WQm,"onHideDialog"));this.Jt.vv(V.a.V_i);this.Jt.VB(V.a.V_i,Object(H.a)(this,
this.sEf,"onCloseDialog"))}R8d(ua){const Sa=new I;Sa.startTime=ia.a.lf();const ka=new Promise((ha,Ca)=>{Sa.resolve=ha;Sa.reject=Ca});Sa.Kdh=ka;this.C8a[ua]=Sa;return ka}jRm(){const ua=ia.a.lf()-this.dbd;m.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",ua)}Nhb(ua){const {OAuthManager:Sa}=d(1540),ka=ia.a.lf()-this.dbd,ha=Object.assign(new da.a,{durationMs:ka});fa.Health.instance.recordKpiFailure(Sa.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,ha);m.ULS.sendTraceTag(572346567,
3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",ka,this.vBg?JSON.stringify(ua):"")}ZUm(ua){const {OAuthManager:Sa}=d(1540),ka=this.C8a.loadFrame;var ha=ia.a.lf()-ka.startTime,Ca=ua.Values.AuthLibrary.toString();ua=ua.Values.Success.toString();m.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",ua,Ca,ha);Ca&&(this.FUb="SharedAuthTokenStrategy "+Ca);Ca=Boolean.parse(ua);Ca||(ua=sa.a.aF(),void 0!==ua&&null!==ua&&(ua.set("AuthLibrary",
this.OIc()),ha=Object.assign(new da.a,{durationMs:ha,extendedProperties:ua}),fa.Health.instance.recordKpiFailure(Sa.kpiName,"SharedAuthStrategyInitFailed",!1,!0,ha)));ka.resolve(Ca?0:1)}YUm(ua){if(ua.Values.interactive&&this.mVb&&this.mVb.Values.messageCorrelationId){const ka=this.mVb.Values.messageCorrelationId.toString();if(ua.Values.interactive&&this.S8){this.S8.LTk.then(ha=>{this.Jt.X1a(this.mVb,this.S8.W_i.contentWindow,this.mqa);this.S8.pWn(ka,ha);this.S8.Cgj(!0);this.mVb=null});return}}ua=
this.C8a.initFrame;const Sa=ia.a.lf()-ua.startTime;m.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Sa);ua.resolve(0)}NQm(ua){if(ua.Values.messageCorrelationId&&ua.Values.messageCorrelationId.toString()){var Sa=ua.Values.messageCorrelationId.toString(),ka=this.C8a[Sa];if(ka){var ha=ia.a.lf()-ka.startTime;m.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",ha);ua.Values.isSuccess&&ua.Values.isSuccess?ka.resolve(ua.Values.response):
ka.reject(ua.Values.response);this.ycj(Sa)}else m.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else m.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}FRm(){if(this.S8.MTk)this.S8.AIh();else if(this.Sge&&this.S8){const ua=new X.a(V.a.Z_i);ua.Values=this.odh(this.Sge,!0);this.Jt.X1a(ua,this.S8.W_i.contentWindow,this.mqa)}}WQm(){this.S8&&this.S8.fKd()}sEf(ua){ua.Values.cancelled&&
ua.Values.cancelled&&ua.Values.messageCorrelationId&&this.ycj(ua.Values.messageCorrelationId.toString());this.S8&&this.S8.hide()}odh(ua,Sa=!1){const ka={};ka.appIds=this.sgl();ka.upn=ua.loginHint;ka.authority=ua.authority;ka.authorityType=Object(f.a)(l,ua.authorityType);ka.tenantId=ua.tenantId;ka.correlationId=z.AFrameworkApplication.userSessionId;ka.enableConsoleLogging=this.vBg;ka.enablePopupFlash=this.JAj;ka.skipUpnCheck=this.jUj;ka.interactive=Sa;return ka}sgl(){const ua=[],Sa=B.a.pPe;for(let ka in Sa)Array.add(ua,
Sa[ka]);return ua}yae(ua,Sa,ka,ha,Ca,Pa){const Xa=new X.a(V.a.uPn),qa=this.uWh();Xa.Values=this.ccj(ua,Sa,ka,ha,Ca,Pa,qa);this.p2g=Xa;ua=this.R8d(qa);m.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",Sa);this.eUn();return ua}o9d(){return!0}eUn(){this.SRb||(this.SRb=new J.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.SRb.id=16,this.SRb.mOd=!1,this.SRb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,
()=>{m.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.Jt.X1a(this.p2g,this.pG.contentWindow,this.mqa)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),z.AFrameworkApplication.ua.Sb.OUa(this.SRb,!0)||m.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}hSm(ua){if(ua.Values.messageCorrelationId&&ua.Values.messageCorrelationId.toString()){var Sa=this.C8a[ua.Values.messageCorrelationId.toString()];
if(Sa){var ka=ia.a.lf()-Sa.startTime;m.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",ka);ua.Values.isSuccess&&ua.Values.isSuccess?Sa.resolve(ua.Values.response):Sa.reject(ua.Values.response)}else m.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else m.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}ycj(ua){this.Tpb&&
this.Tpb.correlationId===ua&&(this.Tpb.resolve(null),this.Tpb=null)}}Object(D.a)(ja,"SharedAuthTokenStrategy",null,[240]);class Ga{constructor(ua){this.Y4=ua;this.FUb="UnsupportedAuthTokenStrategy Reason="+a.a[this.Y4]}initialize(){return Promise.resolve(0)}QRd(){return Promise.resolve(0)}aoa(){return Promise.resolve(Object.assign(new r,{IsSuccess:!1,ErrorCode:a.a[this.Y4],ErrorMessage:"Unable to get a token. Reason: ["+a.a[this.Y4]+"]"}))}yae(){return Promise.resolve(Object.assign(new r,{IsSuccess:!1,
ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}o9d(){return!1}OIc(){return this.FUb}}Object(D.a)(Ga,"UnsupportedAuthTokenStrategy",null,[240]);var ya=d(1468);d.d(M,"OAuthManager",function(){return ta});class ta{constructor(ua=null){this.tha=0;this.Gba=null;this.zsb=0;const Sa=ia.a.lf();this.RFj=this.RSk(ua).then(ka=>ka?this.p_l():(m.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",
this.RJ(),Math.floor(ia.a.lf()-Sa)),ka=sa.a.aF(),void 0!==ka&&null!==ka&&(ka.set("AuthLibrary",this.RJ()),ka=Object.assign(new da.a,{durationMs:Math.floor(ia.a.lf()-Sa),extendedProperties:ka}),fa.Health.instance.recordKpiFailure(ta.kpiName,"StrategyPickFailed",!1,!0,ka)),Promise.resolve(1))).then(ka=>0!==ka?Promise.resolve(ka):this.vqm())}SSk(){var ua=B.a.YGm;ua&&0<ua.length?(this.tha=1,this.Gba=new w(ua)):z.AFrameworkApplication.K.$("IsO365ConsumerHost")||z.AFrameworkApplication.K.$("IsO365CommercialHost")?
z.AFrameworkApplication.K.$("IsAnonymousUser")?(this.tha=2,this.Gba=new Ga(this.tha)):(ua=v.a.getAuthContext().loginHint)&&ua.length?B.a.vKc?(this.tha=1,this.Gba=new N):(this.tha=1,this.Gba=new ja):(this.tha=3,this.Gba=new Ga(this.tha)):(this.tha=4,this.Gba=new Ga(this.tha))}RJ(){return this.Gba?this.Gba.OIc()||"Unknown":"None"}RSk(ua=null){m.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const Sa=ia.a.lf();return z.AFrameworkApplication.K.nrl().then(ka=>{ka?(this.SSk(),ua&&(this.Gba=
ua),m.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",B.a.clientVersion,B.a.appVersion,B.a.mXk,this.RJ(),Math.floor(ia.a.lf()-Sa))):m.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(ia.a.lf()-Sa));return Promise.resolve(ka)},()=>{m.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",
Math.floor(ia.a.lf()-Sa));return Promise.resolve(!1)})}p_l(){m.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.RJ());const ua=ia.a.lf();return u.get(this.Gba.initialize(),2,B.a.zMf).then(Sa=>{if(0===Sa)m.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.RJ(),Math.floor(ia.a.lf()-ua));else if(1===Sa){m.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.RJ(),Math.floor(ia.a.lf()-ua));
var ka=sa.a.aF();void 0!==ka&&null!==ka&&(ka.set("AuthLibrary",this.RJ()),ka=Object.assign(new da.a,{durationMs:Math.floor(ia.a.lf()-ua),extendedProperties:ka}),fa.Health.instance.recordKpiFailure(ta.kpiName,"StrategyInitFailed",!1,!0,ka))}else 2===Sa&&(m.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.RJ(),Math.floor(ia.a.lf()-ua)),ka=sa.a.aF(),void 0!==ka&&null!==ka&&(ka.set("AuthLibrary",this.RJ()),ka=Object.assign(new da.a,
{durationMs:Math.floor(ia.a.lf()-ua),extendedProperties:ka}),fa.Health.instance.recordKpiFailure(ta.kpiName,"StrategyInitTimedOut",!1,!0,ka)));return Promise.resolve(Sa)},()=>{m.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.RJ(),Math.floor(ia.a.lf()-ua));return Promise.resolve(1)})}vqm(){m.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.RJ());const ua=ia.a.lf();return u.get(this.Gba.QRd(v.a.getAuthContext()),2,
B.a.zMf).then(Sa=>{if(0===Sa)m.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.RJ(),Math.floor(ia.a.lf()-ua));else if(1===Sa){m.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.RJ(),Math.floor(ia.a.lf()-ua));var ka=sa.a.aF();void 0!==ka&&null!==ka&&(ka.set("AuthLibrary",this.RJ()),ka=Object.assign(new da.a,{durationMs:Math.floor(ia.a.lf()-ua),extendedProperties:ka}),fa.Health.instance.recordKpiFailure(ta.kpiName,
"StrategyLoadFailed",!1,!0,ka))}else 2===Sa&&(m.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.RJ(),Math.floor(ia.a.lf()-ua)),ka=sa.a.aF(),void 0!==ka&&null!==ka&&(ka.set("AuthLibrary",this.RJ()),ka=Object.assign(new da.a,{durationMs:Math.floor(ia.a.lf()-ua),extendedProperties:ka}),fa.Health.instance.recordKpiFailure(ta.kpiName,"StrategyLoadTimedOut",!1,!0,ka)));return Promise.resolve(Sa)},()=>{m.ULS.sendTraceTag(562128584,
3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.RJ(),Math.floor(ia.a.lf()-ua));return Promise.resolve(1)})}aoa(ua,Sa,ka=null){return this.rgc(ua,Sa,!1,null,"",ka)}dcj(ua,Sa,ka,ha,Ca=null){return this.rgc(ua,Sa,!0,ka,ha,Ca)}rgc(ua,Sa,ka,ha,Ca,Pa,Xa=0){Xa+=1;m.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",ua,this.yIb(ua,Sa),this.RJ(),Xa);var qa=sa.a.aF();void 0!==qa&&null!==qa&&
(qa.set("AuthLibrary",this.RJ()),qa.set("AppName",ua),qa.set("Target",this.yIb(ua,Sa)),fa.Health.instance.recordKpiUsage(ta.kpiName,0,"WacOAuthFC",qa));if(!B.a.isEnabled){var Ea;return this.Yvf((Ea=new r,Ea.IsSuccess=!1,Ea.Token=null,Ea.ErrorCode="NotEnabled",Ea.ErrorMessage="OAuthManager is disabled.",Ea),ua)}const Ia=B.a.pPe[ua];if(void 0===Ia||null===Ia){m.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",ua);
var na;return this.Yvf((na=new r,na.IsSuccess=!1,na.Token=null,na.ErrorCode="DisallowedApp",na.ErrorMessage="Disallowed appName: "+ua,na),ua)}const Na=ia.a.lf(),Oa=this;qa=this.RFj.then(Qa=>Oa.H6l(ua,Ia,Sa,ka,ha,Ca,Pa,Qa));Ea=ka?0:B.a.zMf;let Ra;na=(Ra=new r,Ra.IsSuccess=!1,Ra.Token=null,Ra.ErrorCode="authTokenStrategy_timeout",Ra.ErrorMessage="Auth Strategy timed out after ["+Ea+"] ms when fetching token",Ra);let ab=this,zb=this;return u.get(qa,na,Ea).then(Qa=>Xa<=ta.qEm&&(Qa.ErrorCode===ta.g$i||
Qa.ErrorCode===ta.b1n)?(m.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",Xa,Math.floor(ia.a.lf()-Na)),ab.rgc(ua,Sa,ka,ha,Ca,Pa,Xa)):Qa.ErrorCode===ta.Bhi&&!ka&&(m.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",Xa,ta.JBh),ta.t_k&&ab.Gba.o9d()&&ab.Gba.yae(ua,Ia,Sa,ka,ha,Ca).then(yb=>Promise.resolve(ab.qSd(yb,ua,Sa,Ia,Na))).catch(()=>{let yb;const lb=(yb=new r,yb.IsSuccess=!1,yb.Token=
null,yb.ErrorCode="authTokenStrategy_failure",yb.ErrorMessage="LoginPopup failed, GetToken could not be called",yb);return Promise.resolve(ab.qSd(lb,ua,Sa,Ia,Na))}),ta.JBh)?ab.rgc(ua,Sa,!0,ha,Ca,Pa,Xa):Promise.resolve(ab.qSd(Qa,ua,Sa,Ia,Na))).catch(()=>{let Qa;const yb=(Qa=new r,Qa.IsSuccess=!1,Qa.Token=null,Qa.ErrorCode="authTokenStrategy_failure",Qa.ErrorMessage="Auth Strategy failed with an unknown error",Qa);return Promise.resolve(zb.qSd(yb,ua,Sa,Ia,Na))})}H6l(ua,Sa,ka,ha,Ca,Pa,Xa,qa){return 1===
qa||2===qa?this.Yvf(Object.assign(new r,{IsSuccess:!1,Token:null,ErrorCode:1===qa?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),ua):this.Gba.aoa(ua,Sa,ka,ha,Ca,Pa,Xa).then(Ea=>Promise.resolve(this.Asi(Ea,!0,ua))).catch(Ea=>Promise.resolve(this.Asi(Ea,!1,ua)))}qSd(ua,Sa,ka,ha,Ca){const Pa={};Ca=ia.a.lf()-Ca;Pa.IsSuccess=ua.IsSuccess;Pa.ErrorCode=ua.IsSuccess?"Success":ua.ErrorCode||"";Pa.ErrorMessage=ua.IsSuccess?"Success":this.yIb(Sa,ua.ErrorMessage||"");Pa.Target=
this.yIb(Sa,ka||"");Pa.TimeInMS=Math.floor(Ca);Pa.AuthLibrary=this.RJ();Pa.AppName=Sa;Pa.AuthorityType=Object(f.a)(l,v.a.hDd());Pa.UserType=this.zMl(v.a.getAuthContext());Pa.IsAuthSupportedInSession=a.a[this.tha];Pa.RequestCount=++this.zsb;Pa.AppId=ha;m.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(Pa));ua.IsSuccess||(ka=sa.a.aF(),void 0!==ka&&null!==ka&&(ka.set("AppName",Sa),ka.set("AuthLibrary",this.RJ()),ka.set("ErrorCode",ua.ErrorCode),ka.set("ErrorMessage",this.yIb(Sa,ua.ErrorMessage)),Sa=
Object.assign(new da.a,{durationMs:Ca,extendedProperties:ka}),fa.Health.instance.recordKpiFailure(ta.kpiName,"TryGetTokenFailure",!1,!0,Sa)));return ua}Yvf(ua,Sa){m.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",Sa,this.yIb(Sa,ua.ErrorMessage));const ka=sa.a.aF();void 0!==ka&&null!==ka&&(ka.set("AppName",Sa),ka.set("AuthLibrary",this.RJ()),ka.set("ErrorCode",ua.ErrorCode),ka.set("ErrorMessage",this.yIb(Sa,ua.ErrorMessage)),Sa=Object.assign(new da.a,
{extendedProperties:ka}),fa.Health.instance.recordKpiFailure(ta.kpiName,"FailureBeforeGetToken",!1,!0,Sa));return Promise.resolve(ua)}rbi(ua){return ua===ya.a.s$d}yIb(ua,Sa){return this.rbi(ua)&&Sa?"REDACTED":Sa}zMl(ua){return z.AFrameworkApplication.K.$("IsAnonymousUser")?"anonymous":!ua.loginHint||1>ua.loginHint.length?"empty":-1<ua.loginHint.indexOf("guest#")?"guest":-1<ua.loginHint.indexOf("ext#")?"external":0>ua.upn.indexOf("@")?"no-at":"supported"}M7l(){return 1===this.tha}Asi(ua,Sa,ka){let ha=
null,Ca=null,Pa=null,Xa=null;ua?ua.ErrorCode||ua.ErrorMessage?(Ca=ua.ErrorCode?ua.ErrorCode:ta.JDh,Pa=ua.ErrorMessage?ua.ErrorMessage:"No message"):ua.Token?Sa?ha=ua.Token:(Ca=ta.Tln,Pa="A rejected promise returned a token."):(Ca=ta.JDh,Pa=JSON.stringify(ua)):(Ca=ta.LJm,Pa="No result came from Auth Token Strategy");ua&&ua.Telemetry&&!this.rbi(ka)&&(Xa=ua.Telemetry,m.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(Xa)));if(Ca===ta.uHm||Ca===ta.A7n)Ca=ta.g$i,Pa="Auth Library Timed Out";Ca===ta.Cek&&
-1<Pa.indexOf(ta.cZj)&&(Ca=ta.Bhi);if(Ca||Pa)ha=null;return Object.assign(new r,{IsSuccess:!!ha,Token:ha,ErrorCode:Ca,ErrorMessage:Pa,Telemetry:Xa})}static get JBh(){return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get t_k(){return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}ta.A7n="token_renewal_error";ta.JDh="Exception";ta.LJm="NoResult";ta.Tln="RejectToken";
ta.uHm="monitor_window_timeout";ta.g$i="Timeout";ta.b1n="authTokenStrategy_timeout";ta.Cek="login_required";ta.cZj="AADSTS50058";ta.Bhi="Cookies Disabled";ta.kpiName="OAuthManager";ta.qEm=2;Object(D.a)(ta,"OAuthManager",null,[142])},1541:function(D,M,d){d.r(M);D=d(0);var m=d(2),f=d(104),a=d(22),l=d(58),r=d(372),w=d(43),v=d(49),u=d(6);class z{J1e(Yb,pb,Gb){return 1===Gb?32:z.XQk(pb.node)}static XQk(Yb){const pb=new u.GraphIterator;pb.set(Yb);pb.qo();Yb=new v.GraphTransaction(7);Yb.Ju(pb);pb.Fg();Yb.dispose();
return 32}}Object(D.a)(z,"DeleteOutlineLevelContentStrategy",null,[]);var B=d(106),G=d(180),F=d(68),K=d(228),N=d(19),H=d(24),J=d(11),L=d(108),I=d(41),R=d(211),C=d(92),P=d(33);class W{constructor(Yb){this.sm=null;this.aja=Yb}get qvb(){return null!=this.ffg?this.ffg:this.ffg=a.a.instance.Pa("Box4.IAutoCorrectRules")}get QV(){return null!=this.hfg?this.hfg:this.hfg=a.a.instance.Pa("Box4.IAutoCorrectScheduler")}get XL(){return null!=this.ung?this.ung:this.ung=a.a.instance.Pa("Box4.Pages.IPageContentEditor")}get lK(){return null!=
this.Rmg?this.Rmg:this.Rmg=a.a.instance.Pa("Box4.IOutlineEditor")}get vi(){return this.sm||(this.sm=this.aja())}cji(Yb,pb,Gb){if(this.lK&&W.ui){var hb=K.ContextSetEditor.Bdf(pb);Yb=hb.node;N.SelectionEditor.sk(hb)&&(hb=P.a.Uc(Yb,J.ParagraphReader.textLength(Yb)));var Ib=L.FormattingReader.language(L.FormattingReader.Ds(hb));hb=u.GraphIterator.$a(Gb.ud);W.oh.$Xc(hb);var Ob=Yb=null;if(hb)for(let kc=hb.Rb(1);kc&&!Ob;kc=hb.Vi(1))C.OutlineReader.tta(kc)&&(Ob=kc);if(hb&&!Ob){if(!this.XL||!this.lK)return;
Yb=new v.GraphTransaction(7);Yb.Ju(hb);Ob=this.XL.Gwd(hb);this.lK.m5(hb,!0);Ib&&(I.OutlineElementNavigator.He(hb),hb=P.a.Uc(hb.currentNode,0),W.ui.C5d(L.FormattingReader.Ds(hb),Ib))}Ib=H.SelectionFactory.wo(Ob,!0);Gb.Cb.setSelection(Ib);N.SelectionEditor.xf(pb)&&(Gb=u.GraphIterator.$a(pb.node),Gb.qo(),R.OutlineNavigator.xTf(Gb),this.qvb&&this.QV&&C.OutlineReader.Mz(Gb,pb,!0)&&(pb=this.qvb.K7e(pb,-1,!1,F.a.fx))&&this.QV.rTi(pb));this.vi&&this.vi.xF();Yb&&Yb.dispose()}}static get ui(){return null!=
W.Yig?W.Yig:W.Yig=a.a.instance.Pa("Box4.IFormattingEditor")}static get instance(){return null!=W.vlg?W.vlg:W.vlg=W.Fl()}static Fl(){return new W(()=>a.a.instance.Pa("Box4.IUndoManager"))}static get oh(){return G.PageNavigator.instance}}Object(D.a)(W,"TitleViewEditor",null,[]);var X=d(54),V=d(438),Y=d(637),ca=d(23),fa=d(14),sa=d(297),ia=d(3);class ea{constructor(){this.tzj=new z}Vb(Yb){const pb=Object(w.a)(this.dxh,this.dxh.O1e,"deleteView"),Gb=Object(w.a)(this,this.J1e,"deleteOutlineLevelContent"),
hb=Object(w.a)(this.Rwh,this.Rwh.bRk,"deleteParagraphContent");this.BPf(Yb,pb,Gb,hb);Yb.pa(ia.a.backspace,fa.a.Wc,hb);Yb.pa(ia.a.backspace,fa.a.Fd,hb);Yb.pa(ia.a.backspace,fa.a.endOfParagraph,f.ActionManager.jZ);Yb.pa(ia.a.backspace,fa.a.outline,Gb);Yb.pa(ia.a.backspace,fa.a.view,pb);Yb.Vc(ia.a.backspace,1124);Yb.pa(ia.a.Nra,fa.a.Wc,f.ActionManager.jZ);Yb.pa(ia.a.Nra,fa.a.Fd,hb);Yb.pa(ia.a.Nra,fa.a.endOfParagraph,f.ActionManager.jZ);Yb.pa(ia.a.Nra,fa.a.outline,Gb);Yb.pa(ia.a.Nra,fa.a.view,pb);Yb.gb(ia.a.cxd,
fa.a.view,pb,1124);Yb.pa(ia.a.HG,fa.a.Wc,hb);Yb.pa(ia.a.HG,fa.a.Fd,hb);Yb.pa(ia.a.HG,fa.a.endOfParagraph,f.ActionManager.jZ);Yb.pa(ia.a.HG,fa.a.outline,Gb);Yb.pa(ia.a.HG,fa.a.view,pb);Yb.Vc(ia.a.HG,1124);Yb.gb(ia.a.X_e,fa.a.view,pb,1124);Yb.gb(ia.a.hka,fa.a.view,ea.hka,1028)}BPf(){}J1e(Yb,pb,Gb,hb,Ib){return this.tzj.J1e(Yb,pb,Gb,hb,Ib)}static get oh(){return G.PageNavigator.instance}static get eh(){return null!=ea.Umg?ea.Umg:ea.Umg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get XL(){return null!=
ea.rng?ea.rng:ea.rng=a.a.instance.resolve("Box4.Pages.IPageContentEditor")}static get lK(){return null!=ea.Qmg?ea.Qmg:ea.Qmg=a.a.instance.resolve("Box4.IOutlineEditor")}static get Pb(){return null!=ea.fig?ea.fig:ea.fig=a.a.instance.Pa("Box4.IFeatureHelper")}static hka(Yb,pb,Gb,hb,Ib){hb=pb.view;if(!hb.Cb||!hb.Cb.ib.kb||N.SelectionEditor.Km(hb.Cb.ib.kb))return 8;if(1===Gb)return 32;Gb=hb.Cb.ib;const Ob=Gb.kb;var kc=Ob.Qa,Ac=null,Nc=!1;if(Gb.rI){if(kc.contextId===fa.a.outline&&1===Gb.length){for(Yb=
u.GraphIterator.$a(kc.node);Yb.Wd();)Yb.Fg();ea.lK.m5(Yb,!0);I.OutlineElementNavigator.He(Yb);Yb=H.SelectionFactory.xe(Yb.currentNode,0);hb.Cb.setSelection(Yb);return 32}var kd=kc.node;Ac=null;if(sa.c(kc)){var Jd=kd.De(hb.Tb);Jd&&(Jd=Jd.uGo)&&0<=Jd.width&&0<=Jd.height&&(Ac=new V.a(l.a.jn(Jd.x,0),l.a.jn(Jd.y,1)));Ac||(Ac=Y.a(kd))}else Ac=Y.a(kc.node);kc=u.GraphIterator.$a(kc.node);kc.qo();ea.oh.$Xc(kc);kd=ea.XL.Gwd(kc);Y.b(kd,Ac.x,Ac.y);ea.lK.m5(kc,!0);Ac=H.SelectionFactory.wo(kd,!0)}else if(1===Gb.length){Nc=
Gb.last;kc=X.a.Xwb(Nc);if(ea.Pb&&ea.Pb.isFeatureEnabled(26)&&K.ContextSetEditor.instance.H_f(kc).returnValue)return 2;Nc=Nc.Tc;Nc=!Gb.tw&&(N.SelectionEditor.sk(Nc)||J.ParagraphReader.gm(Nc)||N.SelectionEditor.p6(Nc))}Nc&&(Nc=N.SelectionEditor.ak(Ob,!1,!1,void 0,!1),hb.Cb.setSelection(Nc),m.AFrameworkApplication.ya.Qf(pb,ia.a.MB,2,!1,null,Ib),Ac=hb.Cb.ib.kb,hb.Cb.setSelection(Ob));Ib||(Ib=new r.DictionaryPropertySet);Ib.setValue(B.a.GDc,!0);m.AFrameworkApplication.ya.Qf(pb,ia.a.HG,2,!0,null,Ib);if(Ac&&
Ac.Qa.Qd)return hb.Cb.setSelection(Ac),32;Gb.rI&&W.instance.cji(Yb,pb.tk,hb);N.SelectionEditor.Km(hb.Cb.ib.kb)||m.AFrameworkApplication.ya.Qf(pb,ia.a.MB,2,!1,null,Ib);return 32}static WQk(Yb,pb){if(1===pb)return 32;pb=new v.GraphTransaction(7);pb.Db(Yb);ea.eh.t1a(Yb);pb.dispose();return 32}}Object(D.a)(ea,"ADeleteActor",null,[]);var da=d(9),ja=d(247),Ga=d(254),ya=d(20),ta=d(158),ua=d(1471);class Sa{kQk(Yb,pb,Gb){({DeleteActor:Yb}=d(1541));if(1===Gb)return 32;Gb=da.App.xa.iq.fg("ModelUpdate","DeleteAnchoredObject");
pb=pb.node;const hb=new u.GraphIterator;hb.set(pb);hb.Bb(12);const Ib=hb.rp(12);if(Sa.Zf.PNc(Ib))return 2;Yb.RVb(Ib);Yb=new v.GraphTransaction(7);Yb.Db(pb);hb.Fg();Yb.dispose();Gb.stop();return 32}static get Zf(){return ja.a.instance}}Object(D.a)(Sa,"DeleteAnchoredObjectStrategy",null,[]);var ka=d(59),ha=d(16),Ca=d(120),Pa=d(72),Xa=d(110),qa=d(681),Ea=d(142);class Ia{get Zf(){return ja.a.instance}bRk(Yb,pb,Gb,hb,Ib){if(1===Gb)return 32;hb=Yb===ia.a.backspace;if(this.Zf.vh){if(this.Zf.Cbi(pb)&&Ia.Ara&&
(Gb=pb.clone(),Gb.Ub+=1,--Gb.Fb,this.Zf.g7b(Gb)))return Ia.Ara.dLi([Gb]),32;if(this.Zf.uqf(pb,hb))return 2}if(Ia.mw()&&Ia.mw().instance&&Ia.mw().instance.vT(pb))return 4;var Ob=pb.node;let kc=pb.cpBegin;Gb=pb.cpEnd;let Ac=pb.Fb,Nc=pb.Ub;const kd=J.ParagraphReader.text(Ob),Jd=kd.length;let ge=!1;if(kc===Gb){if(hb&&!kc||!hb&&kc===Jd)return 2;hb?({cp:kc,returnValue:ge}=this.Zf.yqi(Ob,kc),ge||({cp:kc,Dja:Ac,returnValue:ge}=this.Zf.xqi(pb,kc,Ac)),ge||(kc--,ha.a.Ky(kd,kc)&&kc--),Yb=ia.a.nRe):({cp:Gb,returnValue:ge}=
this.Zf.PHm(Ob,Gb),ge||({cp:Gb,Dja:Nc,returnValue:ge}=this.Zf.OHm(pb,Gb,Nc)),ge||(Gb++,ha.a.Ky(kd,Gb)&&Gb++),Yb=ia.a.Cwh)}pb=kc===Gb?P.a.Uc(Ob,kc):P.a.createTextRange(Ob,kc,Gb);ge&&this.Zf.vh&&(hb?pb.Fb=Ac:pb.Ub=Nc);if(!this.Zf.g7b(pb))return 2;this.RVb(Ob);hb=new v.GraphTransaction(15);hb.zl=Yb;hb.Db(Ob);Ob=Object(Ca.a)(qa.a,Ib)&&Ib.qXa;if(Ia.Rd.wg&&!Ob){Ob=Ia.Rd.jVa();try{const Oc=Ia.Ph.f0c(pb);let qc;if(({type:qc}=Oc.KHd()).returnValue){const Xc=Object(Pa.a)(87,Ib);Xc&&Xc.ia(Xa.a.Dof,!1)||!Ea.a.HJ&&
4===qc?Ia.Rd.N0a=qc:Ia.Rd.us(qc)}Ib=0;for(let Xc=Oc.length-1;0<=Xc;--Xc){let xe;const Ge=({wPd:xe}=Oc.getContext(Xc)).returnValue;xe?(Ia.hyperlinkEditor.rhb(Ge,null),Ib+=Ia.Hk.dkb(Ge,2),Ia.Hk.fwd=Gb+Ib):this.Swh(Ge)}}finally{Ob&&Ob.dispose()}}else this.Swh(pb);hb.dispose();return 32}RVb(){}static get Rd(){return null!=Ia.wqg?Ia.wqg:Ia.wqg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Hk(){return null!=Ia.iqg?Ia.iqg:Ia.iqg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Ph(){return null!=
Ia.Qqg?Ia.Qqg:Ia.Qqg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get hyperlinkEditor(){return null!=Ia.Ajg?Ia.Ajg:Ia.Ajg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static mw(){return Ia.Cm||(Ia.Cm=a.a.instance.Za("Box4.IExternalSelectionManager"))}static get Ara(){Ia.cpb||(Ia.cpb=a.a.instance.Za("Box4.ContentControl.IContentControlOperator"));return Ia.cpb.instance}}Ia.Cm=null;Ia.cpb=null;Object(D.a)(Ia,"ADeleteParagraphContentStrategy",null,[]);var na=d(182),
Na=d(782),Oa=d(235),Ra=d(89),ab=d(79),zb=d(82);class Qa extends Ia{constructor(){super()}get characterPropertiesEditor(){return null!=this.Bfg?this.Bfg:this.Bfg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get rq(){return null!=this.sfg?this.sfg:this.sfg=a.a.instance.Za("Box4.ContentControlConfigSettings")}get a9b(){return null!=this.Emg?this.Emg:this.Emg=a.a.instance.resolve("Box4.Proofing.IModifiedRangeEditor")}get vda(){return null!=this.Xfg?this.Xfg:this.Xfg=a.a.instance.resolve("Box4.IContentControlChpHelper")}Swh(Yb){this.qQk(Yb)}J8j(Yb,
pb,Gb,hb){this.rq.instance&&this.rq.instance.vh&&(Yb.cpBegin===pb.cpBegin?Yb.Fb=pb.Fb:Gb&&(Yb.Fb=Gb.Mb&&Gb.Mb.length?0:-1),Yb.Ub=hb)}RVb(Yb){const {DeleteActor:pb}=d(1541);pb.RVb(Yb)}qQk(Yb){var pb=Yb.node;const Gb=Oa.b([new na.a(Yb.cpBegin,Yb.cpEnd)],this.LLl(Yb));var hb=new zb.a,Ib=[];Qa.xxk(pb,Gb,hb,Ib);for(let Ob of hb.keys)1<hb.J(Ob)&&Na.a.Zti(ka.a.Of(Ob));this.ann(pb,Ib);this.a9b.lAc(pb);pb=Yb.Ub;hb=!!this.rq.instance&&this.rq.instance.vh;for(Ib=Gb.length-1;0<=Ib;Ib--)pb=this.deleteRange(Yb,
Gb[Ib],pb,hb)}LLl(Yb){const pb=[],Gb=Yb.node;var hb=Ra.f(Gb,kc=>kc.Cja);for(var Ib of hb)hb=Ib.Ob.cp,pb.push(new na.a(hb,hb+1));Ib=J.ParagraphReader.ZKa(Gb);for(var Ob of Ib)Ob.BS&&Qa.Tam(Ob,Yb)||pb.push(Ob);Ob=!!this.rq.instance&&this.rq.instance.Gla;this.rq.instance&&this.rq.instance.vh||!Ob||!Gb.ow||(Qa.uph&&Qa.uph.bmn(Yb),this.vda&&pb.push(...this.vda.hbf(Gb).toArray()));return Oa.a(pb)}ann(Yb,pb){const Gb=new ab.a;for(let hb of pb)for(pb=0;pb<hb.length;){pb=this.VQh(hb,pb,0);if(-1===pb)break;
let Ib=this.VQh(hb,pb+1,3);if(-1===Ib)break;if(hb.J(pb).BS)for(;Ib>=pb;){const Ob=hb.J(Ib);Gb.add(Ob.Fe);hb.remove(Ob);Ib--}pb=Ib+1}Yb.cga(ya.a.instance.J(6),Gb)}VQh(Yb,pb,Gb){for(;pb<Yb.length;pb++){const hb=Yb.J(pb);if(1===hb.uQ&&hb.Yl===Gb)return pb}return-1}deleteRange(Yb,pb,Gb,hb){let Ib=pb.begin,Ob=pb.end;pb=null;hb&&(pb=Yb.node.qa.ji(Ib));Ib<Ob&&(hb=P.a.createTextRange(Yb.node,Ib,Ob),this.J8j(hb,Yb,pb,Gb),this.characterPropertiesEditor.replaceTextRange(hb,"",void 0,void 0,ia.a.Gyc));return Gb=
pb&&pb.Mb&&pb.Mb.length?pb.Mb.length:-1}static get uph(){return null!=Qa.ggg?Qa.ggg:Qa.ggg=a.a.instance.Pa("WordEditor.ContentControl.IContentControlOperator")}static Tam(Yb,pb){return Yb.begin>=pb.cpBegin&&Yb.end<=pb.cpEnd}static xxk(Yb,pb,Gb,hb){let Ib=0;Yb=Yb.qa;for(let Ob of pb)for(;Ib<Yb.length;){pb=Yb.J(Ib);if(pb.cp>=Ob.begin&&pb.cp<Ob.end&&(pb.af&&pb.af.OBk&&hb.push(pb.af),pb.Lh))for(let kc=0;kc<pb.Lh.length;kc++){const Ac=pb.Lh.J(kc).kn.toString();Gb.xb(Ac)?Gb.Z(Ac,Gb.J(Ac)+1):Gb.Z(Ac,1)}++Ib}}}
Object(D.a)(Qa,"DeleteParagraphContentStrategy",Ia,[]);class yb{static get XF(){return Ga.a.instance}static xRk(Yb,pb,Gb){if(1===Gb)return 32;Yb=pb.node;return yb.XF.Esd(Yb)?ea.WQk(Yb,Gb):32}}Object(D.a)(yb,"DeleteUnsupportedObjectStrategy",null,[]);var lb=d(170),Eb=d(334),bc=d(127),Pb=d(299),Va=d(8),oa=d(987),pa=d(42),Ya=d(131),Ja=d(645),nb=d(437),Bb=d(539),mb=d(586),Qb=d(824),Vb=d(183),mc=d(148),ob=d(291),cb=d(520),db=d(38),kb=d(134);class Wb{constructor(Yb,pb,Gb,hb){this.Yno=Yb;this.e7=Gb;this.Bd=
hb;this.actionId=pb}}Object(D.a)(Wb,"DeleteActionData",null,[]);var Fb=d(969),nc=d(231);class gc{constructor(Yb,pb,Gb,hb,Ib,Ob,kc,Ac,Nc){this.Twh=Yb;this.Zf=pb;this.XF=Gb;this.hyperlinkEditor=hb;this.nI=Ib;this.ko=Ob;this.HBi=kc;this.characterPropertiesEditor=Ac;this.Rd=Nc}A8n(Yb){return!N.SelectionEditor.Ek(Yb)&&!N.SelectionEditor.z$(Yb)}GGl(Yb,pb,Gb){let hb,Ib,Ob,kc;if(!pb&&Yb&&Yb.VD&&(hb=Yb.Qa)&&N.SelectionEditor.xf(hb)&&this.ko.oc(hb.node)&&(Ib=hb.node.qa.ji(hb.cpBegin))&&Ib.vl&&(Ob=this.vjl(Ib))&&
Ob.hyperlink.zF&&(kc=this.wGl(Yb,Ob.cp)))return kc;if(!Yb)return null;if(!Gb)return Yb;pb=N.SelectionEditor.gXa(Yb,!pb,{XB:!1,Us:!0,aE:!0,VF:!0});return H.SelectionFactory.MC(Yb,pb.Qa,!1)}vjl(Yb){const pb=Yb.paragraph.qa;let Gb=null;Yb=Yb.cp;for(let hb=0;hb<pb.length;hb++){const Ib=pb.J(hb);if(Ib.cp>=Yb)break;Ib.vl&&(Gb=null);Ib.hyperlink&&(Gb=Ib)}return Gb}wGl(Yb,pb){var Gb=N.SelectionEditor.lAa(Yb,{XB:!1,Us:!1,aE:!0,VF:!0});if(!Gb||!Gb.VD||Gb.Qa.node!==Yb.Qa.node)return null;Gb=Gb.Qa;if(Gb.cpBegin!==
Gb.cpEnd)return null;const hb=this.ko.text(Gb.node);for(let Ib=Gb.cpBegin-1;Ib>=pb;Ib--)if(!ha.a.Yu(hb.charCodeAt(Ib)))return H.SelectionFactory.MC(Yb,P.a.Uc(Gb.node,Ib+1),!1);return H.SelectionFactory.MC(Yb,P.a.Uc(Gb.node,pb),!1)}O1e(Yb,pb,Gb,hb,Ib){if(1===Gb)return 32;var Ob=!1;Yb===ia.a.X_e?(Yb=ia.a.HG,Ob=!0):Yb===ia.a.cxd?(Yb=ia.a.backspace,Ob=!0):Yb===ia.a.Nra&&(pb=new Bb.a(da.App.xa.jb.Jc));if(!pb.view.Be)return 2;mc.GrippersManager.instance.NA(!1);Gb=Yb===ia.a.HG;const kc=ob.a.oPh(pb);if(Ob&&
this.Zf.vh&&kc&&N.SelectionEditor.Km(kc)&&this.Zf.uqf(kc.Qa,!Gb,!0))return 2;Ob=this.GGl(kc,Gb,Ob);return this.zRk(Yb,pb,hb,Ib,Ob,Gb)}zRk(Yb,pb,Gb,hb,Ib,Ob){const kc=pb.view,Ac=kc.Cb;var Nc=hb,kd=hb;Yb===ia.a.Nra&&(kd=Nc=null,Ib=new Vb.Selection(hb,!0));if(!Ib)return 32;const Jd=new Wb(pb,Yb,Gb,kd),ge=this.oQn(Nc,Ob);if(this.Zf.vh&&gc.Ara&&1===Ac.ib.length&&N.SelectionEditor.Km(Ib)&&Ib.VD&&gc.Ara.xBn(Ib.Qa,Ob))return 32;let Oc;Ob?lb.a.mark(Oc=5009):lb.a.mark(Oc=5011);Nc=new v.GraphTransaction(15);
Nc.zl=Yb;Nc.Db(kc.ud);let qc=null,Xc=({dAn:qc}=this.qll(Yb,hb,Ac,Ib,qc)).returnValue;kd=null;({O7d:kd}=K.ContextSetEditor.instance.H_f(Xc)).returnValue&&(Xc=kd);if(!Xc)return Nc.dispose(),32;this.Zf.vh&&gc.Ara&&(kd=K.ContextSetEditor.instance.kP(Xc),gc.Ara.dLi(kd));this.Caj(Xc);const xe=this.afl(Xc,Ib,Ob);let Ge=null;Ob?Ge=new Qb.a(Ib):xe&&(Ge=new Qb.a(xe));let bf=!1;kd=gc.ej;if(N.SelectionEditor.xf(Xc)){const xd=Fb.a.SFd(kc.ud,ge);kd.Pd(()=>{this.lQk(pb,Gb,hb,Xc,Ob,Ge,Ib,xd,Ac,ge,Jd,xe)},"DVS:DAIPC")}else this.Rd.wg?
(kd.Pd(()=>{this.z8n(Yb,kc.ud,Xc,Ob,Ib,Ac,ge,Jd,Ge)},"DVS:TCDC"),bf=!0):kd.Pd(()=>{bf=this.QCi(Yb,kc.ud,Xc,Ac,ge,Jd,Ge,qc)},"DVS:PUD");this.J9k(Ac);this.XPi(Xc);Nc.dispose();lb.a.mark(Oc+1);return Yb===ia.a.Nra?bf?32:8:32}QCi(Yb,pb,Gb,hb,Ib,Ob,kc,Ac){pb=Fb.a.SFd(pb,Ib);this.A8n(Gb)&&pb.p3a(Gb);Yb=gc.Lc.oo(Yb);Yb.properties.Z("CountOfParagraphsDeleted",this.ko.HYe(Gb).toString());Gb=this.DVk(Gb,hb,Ib,pb,Ob,kc,Ac);Yb.end();return Gb}z8n(Yb,pb,Gb,hb,Ib,Ob,kc,Ac,Nc){var kd=0,Jd=null;const ge=K.ContextSetEditor.instance.kP(Gb),
Oc=ge[ge.length-1];if(Oc.contextId===fa.a.paragraph||Oc.contextId===fa.a.endOfParagraph){var qc=u.GraphIterator.$a(Oc.node);qc.vd();I.OutlineElementNavigator.ae(qc);I.OutlineElementNavigator.Rr(qc,!0,!1)&&(Jd=I.OutlineElementNavigator.He(qc))&&(kd=this.ko.textLength(Jd))}else kd=this.ko.textLength(Oc.node)-Oc.cpEnd;qc=Object(Pa.a)(87,Ac.Bd);if(qc=!!qc&&qc.ia(Xa.a.Dof,!1))this.OCi(Yb,pb,Gb,Ob,kc,Ac,Nc,!1,qc);else{qc=this.Rd.jVa();try{this.OCi(Yb,pb,Gb,Ob,kc,Ac,Nc,!0)}finally{qc&&qc.dispose()}}if(hb){if(Gb.Rw){Yb=
ge.length-1;do Ib=ge[Yb],Yb--;while(!Ib.node.isConnected&&0<=Yb)}else Ib=Gb;if(!this.ko.oc(Ib.node))return;switch(Oc.contextId){case fa.a.paragraph:case fa.a.endOfParagraph:kd=Jd&&Jd.isConnected?0:kd;break;case fa.a.Wc:case fa.a.Fd:break;default:kd=0}kd=H.SelectionFactory.xe(Ib.node,this.ko.textLength(Ib.node)-kd);Ib.gl===kd.Qa.cpBegin&&(kd.Qa.Fb=Ib.Fb)}else{kd=Ib.Qa.node;if(!this.ko.oc(kd))return;Jd=Ib.Qa.contextId===fa.a.paragraph?0:Ib.Qa.contextId===fa.a.endOfParagraph?this.ko.textLength(kd):Ib.Qa.cpBegin;
kd=H.SelectionFactory.xe(kd,Jd)}X.a.instance.setSelection(kd)}OCi(Yb,pb,Gb,hb,Ib,Ob,kc,Ac,Nc=!1){Gb=this.Lcl(hb,Gb);Gb=gc.Ph.f0c(Gb);({type:Jd}=Gb.KHd()).returnValue&&(Ac&&4!==Jd?this.Rd.us(Jd):Ea.a.HJ||(this.Rd.N0a=Jd));for(Ac=Gb.length-1;0<=Ac;--Ac){var kd=void 0;var Jd=({wPd:kd}=Gb.getContext(Ac)).returnValue;kd?(kd=Nc&&Jd.contextId===fa.a.endOfParagraph&&Ac===Gb.length-1,this.hyperlinkEditor.rhb(Jd,2),kd||gc.Hk.dkb(Jd,2)):this.QCi(Yb,pb,Jd,hb,Ib,Ob,kc,null)}}Lcl(Yb,pb){if(Object(Ca.a)(nb.a,pb)){Yb=
mb.OutlineElementGeneralizer.Hka(Yb.ib,!0);for(let Gb=0;Gb<Yb.length;Gb++)if(Yb.getContext(Gb).contextId===fa.a.table)return Yb}return pb}qll(Yb,pb,Gb,hb,Ib){Yb===ia.a.Nra?(Yb=Eb.a.tza(pb),Ib=cb.SelectionReferenceFactory.instance.bxb()):(Ib=null,Yb=1===Gb.ib.length?X.a.Xwb(hb):Gb.Rg);return{returnValue:Yb,dAn:Ib}}npk(Yb){return!Yb.ul||Yb.contextId!==fa.a.paragraph||!this.ko.oc(Yb.node)||this.Rd.wg||this.Zf.vOd(Yb)?!1:!0}Caj(Yb){if(Yb.Rw)for(let pb=0;pb<Yb.length;pb++)this.Caj(Yb.getContext(pb));else this.npk(Yb)&&
(Yb.node.Fsd=!0)}XPi(Yb){if(Yb.Rw)for(let pb=0;pb<Yb.length;pb++)this.XPi(Yb.getContext(pb));else Yb.ul&&(Yb=Yb.node)&&this.ko.oc(Yb)&&(Yb.Fsd=!1)}afl(Yb,pb,Gb){if(Yb.ul&&N.SelectionEditor.xf(Yb)&&!Gb){const hb=Yb.node;let Ib=Yb.cpBegin,Ob=-1;if(({cp:Ib}=this.Zf.yqi(hb,Ib)).returnValue)return H.SelectionFactory.xe(hb,Ib);if(({cp:Ib,Dja:Ob}=this.Zf.xqi(Yb,Ib,Ob)).returnValue)return pb=H.SelectionFactory.xe(hb,Ib),pb.Qa.Fb=Ob,pb.Qa.Ub=Ob,pb}pb=N.SelectionEditor.gXa(pb,!Gb,{XB:!0,Us:!1,aE:!1,VF:!0});
this.Zf.vh&&N.SelectionEditor.Ek(Yb)&&(pb.Qa.Ub=pb.Qa.Fb=Gb?Yb.Ub:Yb.Fb);return pb}lQk(Yb,pb,Gb,hb,Ib,Ob,kc,Ac,Nc,kd,Jd,ge){const Oc=gc.ej;!N.SelectionEditor.Mz(hb.node,hb,Ib)||this.Zf.vh&&this.Zf.Cbi(hb)?Oc.Pd(()=>{this.QQk(hb,Ib,Ob,kc,Ac,Nc,kd,Jd)},"DVS:IPM"):Oc.Pd(()=>{let qc,Xc;({response:qc,DX:Xc}=this.PQk(Yb,pb,Gb,hb,Ib,kc,Ac,Nc,Jd,ge));gc.zsi(Ac,32===qc);Xc&&gc.nna(Nc,Ob)},"DVS:ISE")}DRl(Yb,pb){nc.a.SW&&(pb.Bd||(pb.Bd=new r.DictionaryPropertySet),pb.Bd.setValue(Xa.a.hma,"delete"),pb.Bd.setValue(Xa.a.efa,
"backspace"));var Gb=Yb.aW;let hb=gc.hd.QN(Gb);const Ib=Ja.a.Vnm;if(null===Ib||void 0===Ib?0:Ib.fhm(Gb,hb)){nc.a.SW&&pb.Bd.setValue(Xa.a.efa,"backspace-autocorrect");Gb=Ib.ibj+" ";let Ob=P.a.Uc(Yb,0);this.characterPropertiesEditor.replaceTextRange(Ob,Gb);Yb=H.SelectionFactory.xe(Yb,Gb.length);X.a.instance.setSelection(Yb);Va.ULS.sendTraceTag(540386467,393,50,"Unlisted list with trigger string: {0}",Ib.ibj)}return m.AFrameworkApplication.ya.Qf(pb.Yno,hb.qr?ia.a.gH:ia.a.Uz,2,!1,pb.e7,pb.Bd)}cRl(Yb,
pb,Gb,hb,Ib){let Ob=!1;0<this.HBi.Z1(Yb).gt&&(Ib=m.AFrameworkApplication.ya.Qf(pb,ia.a.Abc,2,!1,Gb,hb),Ob=!0);return{kT:Ob,response:Ib}}jRl(Yb,pb,Gb,hb,Ib){let Ob=!1;0<this.HBi.pF(Yb).gt&&(Ib=m.AFrameworkApplication.ya.Qf(pb,ia.a.SWc,2,!1,Gb,hb),Ob=!0);return{kT:Ob,response:Ib}}jSl(Yb,pb,Gb,hb,Ib){let Ob=!1;gc.np.Uvb(Yb)&&(Ib=m.AFrameworkApplication.ya.Qf(pb,ia.a.HF,2,!1,Gb,hb),Ob=!0);return{kT:Ob,response:Ib}}PPl(Yb,pb,Gb,hb,Ib,Ob,kc,Ac,Nc){const kd=new Ya.a;kd.fd(pb);let Jd=!1;if(I.OutlineElementNavigator.xCa(kd,
!1,!Yb,!1)){Nc=!0;Ac=32;Jd=!0;(new u.GraphIterator).fd(kd);I.OutlineElementNavigator.He(kd);const Oc=kd.currentNode;var ge=new u.GraphIterator;ge.set(Ob);(ge=this.ko.isEmpty(ge))&&hb&&N.SelectionEditor.p6(hb.Qa)?(Gb.p3a(Ib),I.OutlineElementNavigator.He(pb),gc.eh.t1a(pb.currentNode)):Oc.pI?(Gb.p3a(Ib),I.OutlineElementNavigator.ae(kd),kd.Fg()):Yb&&ge?this.Zf.Wdi(Ob)&&!({DX:Nc}=this.sFi(Yb,Ob,Oc,hb,Nc)).returnValue&&(Gb.p3a(Ib),gc.Jo.vDa(pb),this.Twh.v5m(Ob),pb.Fg()):db.TableReader.isTable(kd)?(Gb.p3a(Ib),
Yb&&(ca.moveToFirstRow(kd),ca.moveToFirstColumn(kd),R.OutlineNavigator.K6(kd),I.OutlineElementNavigator.He(kd),kc.setSelection((new Qb.a(H.SelectionFactory.xe(kd.currentNode,0))).restore())),Ac=2,Nc=!1):this.ko.oc(Oc)&&(1==this.ko.textLength(Oc)&&(kc=Ra.e(Oc),1==kc.length&&8==kc[0].ri&&(kc=P.a.createTextRange(Oc,0,1),this.characterPropertiesEditor.replaceTextRange(kc,"",void 0,void 0,ia.a.Gyc))),({DX:Nc}=this.sFi(Yb,Ob,Oc,hb,Nc)).returnValue||this.Twh.mQk(Yb,Gb,Ib,pb,Ob,kd))}return{kT:Jd,response:Ac,
DX:Nc}}sFi(Yb,pb,Gb,hb,Ib){if(this.Rd.wg){if(gc.Bra){const Ob=Object(Ca.a)(kb.AParagraphNode,Gb)?gc.Bra.z6b(Gb):!1,kc=Object(Ca.a)(kb.AParagraphNode,pb)?gc.Bra.z6b(pb):!1;if(Ob!==kc)return{returnValue:!1,DX:Ib};if(!Ea.a.HJ&&kc)return this.Zf.vh&&gc.hdk(pb,Gb,Yb)&&this.Rd.us(4),{returnValue:!1,DX:Ib}}Yb=Yb?pb:Gb;if(!Object(Ca.a)(kb.AParagraphNode,Yb))return{returnValue:!1,DX:Ib};pb=Yb.qa.last;Gb=m.AFrameworkApplication.userName;if(!pb.Yi||pb.Yi.authorName!==Gb)return gc.Hk.sJb(Yb,2),hb&&(X.a.instance.setSelection(hb),
Ib=!1),{returnValue:!0,DX:Ib}}return{returnValue:!1,DX:Ib}}xRl(Yb,pb,Gb,hb,Ib,Ob,kc,Ac){pa.OutlineElementReader.gbm(pb,Yb)||({response:kc,DX:Ac}=gc.wWk(Gb,hb,Yb,Ob,Ib,kc,Ac));return{kT:!1,response:kc,DX:Ac}}PQk(Yb,pb,Gb,hb,Ib,Ob,kc,Ac,Nc,kd){let Jd=!1,ge=2;const Oc=hb.node;let qc=void 0,Xc=!1;const xe=gc.ej;if(!Ib){if(Oc.aW)return xe.Pd(()=>{ge=this.DRl(Oc,Nc)},"DVS:HLOE"),{response:ge,DX:Jd};xe.Pd(()=>{({response:ge,kT:Xc}=this.cRl(Oc,Yb,pb,Gb,ge))},"DVS:HIOD");if(Xc)return{response:ge,DX:Jd};xe.Pd(()=>
{({response:ge,kT:Xc}=this.jRl(Oc,Yb,pb,Gb,ge))},"DVS:HWPF");if(Xc)return{response:ge,DX:Jd};qc=this.ARh(Oc);xe.Pd(()=>{({response:ge,kT:Xc}=this.jSl(qc,Yb,pb,Gb,ge))},"DVS:HPOB");if(Xc)return{response:ge,DX:Jd}}null!==qc&&void 0!==qc?qc:qc=this.ARh(Oc);xe.Pd(()=>{({response:ge,kT:Xc,DX:Jd}=this.PPl(Ib,qc,kc,kd,hb,Oc,Ac,ge,Jd))},"DVS:HAOE");if(Xc)return{response:ge,DX:Jd};xe.Pd(()=>{({response:ge,kT:Xc,DX:Jd}=this.xRl(Ib,qc,pb,Gb,kc,Ob,ge,Jd))},"DVS:HFLOE");return{response:ge,DX:Jd}}xQn(Yb){return N.SelectionEditor.Ek(Yb)||
this.XF.Ygi(Yb)||N.SelectionEditor.z$(Yb)}oQn(Yb,pb){return Yb&&Yb.hasProperty(B.a.GDc)?!Yb.ia(B.a.GDc,!1):!pb}static get hd(){return null!=gc.nmg?gc.nmg:gc.nmg=a.a.instance.resolve("Box4.List.IListReader")}static get Jo(){return null!=gc.dmg?gc.dmg:gc.dmg=a.a.instance.resolve("Box4.List.IListEditor")}static get eh(){return null!=gc.cng?gc.cng:gc.cng=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get np(){return oa.a.gAb}static get Hk(){return null!=gc.mqg?gc.mqg:gc.mqg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Ph(){return null!=
gc.Sqg?gc.Sqg:gc.Sqg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Lc(){return bc.a.instance}static get Ara(){gc.cpb||(gc.cpb=a.a.instance.Za("Box4.ContentControl.IContentControlOperator"));return gc.cpb.instance}static get Bra(){return null!=gc.kgg?gc.kgg:gc.kgg=a.a.instance.Pa("Box4.IContentControlReader")}static get ej(){return Pb.a.instance}J9k(Yb){if(1===Yb.ib.length&&(Yb=Yb.ib.J(0),N.SelectionEditor.Km(Yb))){var pb=Yb.Qa;Yb=pb.node;pb=pb.cpBegin;var Gb=
this.ko.text(Yb);pb<Gb.length&&0<pb&&" "===Gb.charAt(pb-1)&&" "===Gb.charAt(pb)&&this.characterPropertiesEditor.replaceTextRange(P.a.createTextRange(Yb,pb-1,pb),"\u00a0")}}yfk(Yb,pb){if(!pb.hyperlink.Bfb){const Gb=new v.GraphTransaction(15);try{Gb.Db(Yb.node),this.nI.LQ(Yb,pb)}finally{Gb&&Gb.dispose()}pb.hyperlink.zF&&this.Rd.us(2)}}static wWk(Yb,pb,Gb,hb,Ib,Ob,kc){if(Gb=N.SelectionEditor.gXa(hb,!Gb,{XB:!1,Us:!1,aE:!1,VF:!0})){hb=H.SelectionFactory.MC(hb,Gb.Qa);Ob=32;for(Gb=0;Gb<hb.length;++Gb){Ib.p3a(hb.J(Gb));
const Ac=m.AFrameworkApplication.ya.Qf(hb.J(Gb),ia.a.HG,2,!0,Yb,pb);2!==Ac&&(Ob=Ac)}32===Ob&&(kc=!0)}return{response:Ob,DX:kc}}DVk(Yb,pb,Gb,hb,Ib,Ob,kc){let Ac=!1;this.yQn(Yb)?(Ac=gc.f3e(Yb,!0,pb,Gb,hb,Ib))&&gc.UEa(Ob,pb,kc):this.xQn(Yb)?(Ac=gc.f3e(Yb,!1,pb,Gb,hb,Ib))&&gc.UEa(Ob,pb,kc):(hb.normalize(),gc.UEa(Ob,pb,kc));return Ac}static UEa(Yb,pb,Gb){Gb&&Gb.nna()||gc.nna(pb,Yb)}static f3e(Yb,pb,Gb,hb,Ib,Ob){hb||C.OutlineReader.jMa(Yb)||(Gb=gc.j2c(Gb))&&Ib.UMn(Gb);Yb=32===m.AFrameworkApplication.ya.Qf(Yb,
Ob.actionId,2,pb,Ob.e7,Ob.Bd);gc.zsi(Ib,Yb);return Yb}static zsi(Yb,pb){pb?Yb.normalize():Yb.cancel()}static nna(Yb,pb){pb&&gc.ej.Pd(()=>{const Gb=pb.restore();Gb&&Yb.setSelection(Gb)},"DVS:RS")}QQk(Yb,pb,Gb,hb,Ib,Ob,kc,Ac){let Nc;!pb&&({hyperlink:Nc}=this.nI.e6b(Yb)).returnValue?(Gb=new Qb.a(hb),this.yfk(Yb,Nc),Ib.normalize(),gc.nna(Ob,Gb)):gc.f3e(Yb,!1,Ob,kc,Ib,Ac)&&(pb&&this.Rd.wg?(pb=gc.Hk.fwd)?(Ob.setSelection(H.SelectionFactory.xe(Yb.node,pb)),gc.Hk.fwd=null):gc.nna(Ob,Gb):gc.nna(Ob,Gb))}static hdk(Yb,
pb,Gb){Gb?(Gb=Yb,Yb=pb):Gb=pb;pb=gc.Bra.C6b(Gb,!1);Yb=gc.Bra.C6b(Yb,!0);return!(pb&&Yb)}yQn(Yb){return Yb.Rw||C.OutlineReader.jMa(Yb)||this.ko.gm(Yb)}static j2c(Yb){return(Yb=mb.OutlineElementGeneralizer.Hka(Yb.ib,!0))&&1===Yb.length&&(Yb=Yb.getContext(0).node,db.TableReader.XW(Yb))?Yb:null}ARh(Yb){const pb=new u.GraphIterator;pb.set(Yb);pb.vd();I.OutlineElementNavigator.ae(pb);return pb}}gc.cpb=null;Object(D.a)(gc,"ADeleteViewStrategy",null,[]);class Jc{mQk(Yb,pb,Gb,hb,Ib,Ob){const kc=Ob.currentNode;
I.OutlineElementNavigator.ae(Ob);Yb?(pb.Daj(Ob.currentNode),Jc.Zf.Nci(Gb,Ib,kc,!1)||Jc.eh.merge(hb,Ob,!1,!1)):Jc.Zf.Nci(Gb,kc,Ib,!0)||Jc.eh.merge(Ob,hb,!1,!1)}v5m(Yb){Yb&&J.ParagraphReader.oc(Yb)&&(ua.a.MWc(Yb),Jc.IYk.wOe(Yb))}static get eh(){return null!=Jc.Ymg?Jc.Ymg:Jc.Ymg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get IYk(){return null!=Jc.Tgg?Jc.Tgg:Jc.Tgg=a.a.instance.resolve("Box4.IDynamicRangeEditor")}static get Zf(){return ja.a.instance}}Object(D.a)(Jc,"DeleteParagraphNodeStrategy",
null,[642]);class tb extends gc{constructor(Yb,pb,Gb,hb,Ib,Ob,kc,Ac){super(new Jc,Yb,pb,Gb,hb,Ib,Ob,kc,Ac)}}Object(D.a)(tb,"DeleteViewStrategy",gc,[]);d.d(M,"DeleteActor",function(){return dc});class dc extends ea{constructor(Yb,pb,Gb,hb,Ib,Ob,kc,Ac,Nc,kd,Jd){super();this.deleteParagraph=(ge,Oc)=>{ge=Oc.node;ua.a.MWc(ge);this.Kme.wOe(ge);this.ml&&this.ml.instance&&ta.App.Kce&&this.ml.instance.mGf(ge);ge.ow&&(this.Qm.amn(ge,!this.vh),this.vh&&this.bEg.instance&&this.bEg.instance.Gej(ge));return 0};
this.Txd=(ge,Oc,qc)=>{2==qc&&(ge=m.AFrameworkApplication.breadcrumbFolderUrl,ge&&0!=ge.length||(ge=m.AFrameworkApplication.breadcrumbBrandUrl),da.App.Xyb(ge));return 32};this.uzj=new Qa;this.xzg=new Sa;this.vzj=new tb(ja.a.instance,Ga.a.instance,Ob,kc,Ac,Nc,kd,Jd);this.Qm=Yb;this.qnc=pb;this.bEg=Gb;this.Kme=hb;this.ml=Ib}get vh(){return this.qnc.instance?this.qnc.instance.vh:!1}get dxh(){return this.vzj}get Rwh(){return this.uzj}BPf(Yb,pb,Gb,hb){const Ib=yb.xRk,Ob=Object(w.a)(this.xzg,this.xzg.kQk,
"deleteAnchoredObject");Yb.pa(ia.a.backspace,fa.a.anchoredObject,Ob);Yb.pa(ia.a.backspace,fa.a.unsupportedObject,Ib);Yb.pa(ia.a.HG,fa.a.anchoredObject,Ob);Yb.pa(ia.a.HG,fa.a.unsupportedObject,Ib);Yb.pa(ia.a.backspace,fa.a.paragraph,this.deleteParagraph);Yb.pa(ia.a.HG,fa.a.paragraph,this.deleteParagraph);Yb.pa(ia.a.Nra,fa.a.paragraph,this.deleteParagraph);Yb.pa(ia.a.Txd,fa.a.view,this.Txd);Yb.Vc(ia.a.Nra,64);super.BPf(Yb,pb,Gb,hb)}static RVb(Yb){ya.a.instance.J(4)&&da.App.rd.Kp&&da.App.rd.Jq.sG(Yb)}}
Object(D.a)(dc,"DeleteActor",ea,[])},1545:function(D,M,d){D=d(0);class m{constructor(w,v,u,z){this.tyj=w;this.qRj=v;this.oRj=u;this.rRj=z}get hYe(){return this.tyj}get hTf(){return this.qRj}get eTf(){return this.oRj}get resultType(){return this.rRj}}Object(D.a)(m,"SearchContext",null,[1100]);class f{m_e(w,v,u,z){var B=u-v;let G;if(100<=B)B=v,G=u;else{B=Math.max(0,v+Math.ceil(B/2)-50);G=Math.min(w.length,B+100);B=Math.max(0,G-100);let K;if(B&&" "!==w.charAt(B-1)){K=Math.min(v,B+10);for(var F=B;F<K;++F)if(" "===
w.charAt(F)){B=F+1;break}}if(G!==w.length&&" "!==w.charAt(G))for(K=Math.max(u,G-10),F=G-1;F>=K;--F)if(" "===w.charAt(F)){G=F;break}}w=w.substring(B,G);return new m(w,v-B,u-B,z)}Owd(w){return this.m_e(w.$Th(),w.begin,w.end,"")}}Object(D.a)(f,"SearchContextFactory",null,[1077]);var a=d(134),l=d(1531);d.d(M,"a",function(){return r});class r extends f{constructor(){super()}Owd(w){let v=w.begin,u=w.end;const z=({begin:v,end:u}=r.JAl(w,v,u)).returnValue;w=l.a(w.type);return this.m_e(z,v,u,w)}static get instance(){return null!=
r.zkg?r.zkg:r.zkg=new r}static JAl(w,v,u){w=w.$Th();return r.NLi(w,v,u)}static NLi(w,v,u){const z=a.AParagraphNode.dU(w);if(z.length<w.length){w=w.substring(0,v);const B=a.AParagraphNode.dU(w);w=w.length-B.length;v-=w;u-=w}return{returnValue:z,begin:v,end:u}}}Object(D.a)(r,"EditorSearchContextFactory",f,[])},1547:function(D,M,d){D=d(0);var m=d(2),f=d(22),a=d(310),l=d(701),r=d(24),w=d(9),v=d(133),u=d(54),z=d(648),B=d(211),G=d(260),F=d(92),K=d(33),N=d(11),H=d(3),J=d(5),L=d(585),I=d(1005);class R{create(){return new I.a}}
Object(D.a)(R,"FootnoteEndnoteContainerNodeFactory",null,[200]);var C=d(540);d.d(M,"a",function(){return P});class P{constructor(W,X,V,Y,ca,fa,sa,ia,ea){this.Nnd=null;P.ga=W;this.uE=V;this.yAe=Y;this.Xxj=fa;this.Xc=sa;this.hb=ca;this.uLj=ia;this.ezj=ea;P.Dh=X}dUd(W,X){this.J0k(W);W.Rb(7);this.uE.pbi(W,X)||W.wf(7)}J0k(W){if(this.yAe.Rdi(W)){var X=!1,V=!1;if(W.Rb(7)){do{const Y=W.currentNode;if(37===Y.type)switch(Y.getValue(J.a.U5)){case 0:V=!0;break;case 1:X=!0}}while(W.Vi(7))}V||this.i6g(W,0);X||
this.i6g(W,1)}}i6g(W,X){const V=this.Xxj.create(1074135124);V.setValue(J.a.U5,X);W.Sf(V,7)}MBn(W){W&&this.rUi(W.Fka)}rUi(W){W&&(W=r.SelectionFactory.xe(W.Ob.paragraph,W.Ob.cp+1),this.hb.setSelection(W))}NIm(W){let X=this.uLj(W);void 0!==X&&null!==X?this.uE.Ila(X)&&(X=this.uE.zUh(X)):X=W;return this.ezj(X)}PWn(){this.Nnd?P.Dh.notificationBar.removeEntry(this.Nnd):this.Nnd=P.Dh.notificationBar.qza(WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingUnsupportedNotification,!1);P.Dh.notificationBar.eB(this.Nnd)}rbk(W,
X){W=this.Xc.AAa(W,37,37);let V=!1;if(W.Wd()){do{const Y=W.currentNode;this.uE.rsf(Y)?this.gbh(Y,X):V=!0}while(W.xj())}V&&this.PWn()}gbh(W,X){L.e(W,V=>{P.Bbl(V,X);return!0},12)}eUl(W,X){W=this.uE.IEd(W,X);return W?(W=this.Xc.pg(W))?W.RC():!1:!1}fPh(W,X){W=this.uE.IEd(W,X);W=this.Xc.pg(W);if(W.Wd()){do if(X=W.currentNode,1===X.getValue(J.a.Gka))return X;while(W.xj())}return null}static uHc(){return new P(m.AFrameworkApplication.ya,w.App.xa,C.a.instance,v.PageReader.instance,u.a.instance,new R,new z.a,
B.OutlineNavigator.LIm,G.WordSectionNavigator.f1e)}static get instance(){return null!=P.Jkg?P.Jkg:P.Jkg=P.uHc()}static get paragraphEditor(){return null!=P.Mng?P.Mng:P.Mng=f.a.instance.resolve("Box4.IParagraphEditor")}static Bbl(W,X){X.beb?P.paragraphEditor.np.Raa(W,F.OutlineReader.rL(W)):P.paragraphEditor.np.Raa(W,0);W=K.a.createTextRange(W,0,N.ParagraphReader.textLength(W));P.ga.Qf(W,H.a.font,2,!0,new a.a,new l.a(X.fontName));P.ga.Qf(W,H.a.Pv,2,!0,new a.a,new l.a(X.fontSize))}}P.ga=null;P.Dh=null;
Object(D.a)(P,"FootnoteEndnoteEditor",null,[304])},1552:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);var m;(function(f){f[f.unknown=0]="unknown";f[f.supported=1]="supported";f[f.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";f[f.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";f[f.hostUnsupported=4]="hostUnsupported"})(m||(m={}));Object(D.b)("SupportStatus",m)},1562:function(D,M,d){d.d(M,"a",function(){return N});D=d(0);var m=d(372),f=d(59),a=d(22),l=d(106),r=d(8),w=d(120),
v=d(72),u=d(14),z=d(108),B=d(539),G=d(134),F=d(139),K=d(11);class N{constructor(H,J,L,I,R,C=null,P="",W=!0,X=!1){this.fXa=this.C8d=this.sjb=this.gGi=this.U2d=null;this.oNc=!1;this.wlf=null;this.fDf=0;this.context=H;this.ve=H.view;this.iA=J;this.Bd=R;this.zQ=L;this.e7=I;this.JDa=this.failed=!1;this.dYd=null;this.zZa=this.v6b=!1;this.CXn=N.dYe(H);this.browserName=P;this.Shj=W;this.Gsf=X;this.lQa=!1;this.tZb=0;if(H=Object(w.a)(87,R)?R:null){this.gGi=new m.DictionaryPropertySet;this.gGi.ys(H);L=H.ia(l.a.$Tc,
f.a.nil);this.tAc=L!=f.a.nil?L.toString():f.a.create().toString();if(H.ia(l.a.yCi,!1)){this.v6b=!0;this.zZa=H.ia(l.a.zZa,!1);this.dYd=C;for(C=this.ve.Cb.Rg;C.Rw;)C=C.getContext(0);if(R=Object(v.a)(G.AParagraphNode,C.node)){L=0;I=K.ParagraphReader.textLength(R);switch(C.contextId){case u.a.Fd:L=C.cpBegin;I=C.cpEnd;break;case u.a.endOfParagraph:L=I}this.U2d=z.FormattingReader.EEd(C.node,L,C.Fb);r.ULS.shipAssertTag(6305503,307,!!this.U2d);R=F.HyperlinkReader.FHc(R);for(const V of R)V.cpEnd<=L||V.cpBegin>=
I||N.hyperlinkEditor.LQ(C.node,V.hyperlink)}}this.JDa=H.ia(l.a.JDa,!1);this.lQa=H.ia(l.a.lQa,!1);this.sjb=H.ia(l.a.sjb,null)}else this.tAc=f.a.create().toString();J&64&&(this.JDa=!0)}static get hyperlinkEditor(){return null!=N.qjg?N.qjg:N.qjg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static dYe(H){if(H){if(H.Rw){for(let J=0;J<H.length;J++)if(N.dYe(H.getContext(J)))return!0;return!1}if(Object(w.a)(B.a,H))return N.dYe(H.tk);if(K.ParagraphReader.oc(H.node)&&H.node.qN)return!0}return!1}}Object(D.a)(N,
"ClipboardActionArguments",null,[])},1563:function(D,M,d){d.d(M,"a",function(){return L});D=d(0);var m=d(22),f=d(59),a=d(49),l=d(641),r=d(133),w=d(648),v=d(180),u=d(20),z=d(9),B=d(114),G=d(5),F=d(852),K=d(752),N=d(540),H=d(1504),J=d(1547);class L{constructor(I,R,C,P,W,X){this.uE=I;this.DGa=C;this.yAe=P;this.gle=W;this.Xc=X}V3l(I,R,C){const P=this.zRh(R,I.node),W=I.node.Nc;if(!W)return null;const X=new a.GraphTransaction(15);X.Db(I.node);X.zl=C;C=this.W3l(P,R);L.X3l(C,W,I,R);X.dispose();return C}zRh(I,
R){const C=this.Xc.Ck();C.set(R);C.Bb(7);C.kd(7);this.DGa.dUd(C,I);return C}W3l(I,R){const C=K.a.createNode();C.properties.setValue(G.a.U5,R);I.Sf(C,8);this.gle.RGk(C,R);return C}static get characterPropertiesEditor(){return null!=L.Afg?L.Afg:L.Afg=m.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Aba(){return L.xC||(L.xC=new l.WACStyleSet)}static set Aba(I){L.xC=I}static uHc(){const {FootnoteEndnoteDefaultContentInserter:I}=d(1622);return new L(N.a.instance,H.a.instance,J.a.instance,
r.PageReader.instance,I.instance,new w.a)}static get instance(){return null!=L.nlg?L.nlg:L.nlg=L.uHc()}static get oh(){return L.aB||(L.aB=v.PageNavigator.instance)}static set oh(I){L.aB=I}static X3l(I,R,C,P){u.a.instance.J(4)&&z.App.rd.Kp&&z.App.rd.Jq.sG(C.node);const W=new B.a;W.setValue(G.a.i1b,I.id);W.setValue(G.a.U5,P);const X=R.Gu(W,f.a.create());L.characterPropertiesEditor.Iea(C,V=>F.a.getInstance(V,X,I.id),L.TLh(C.node,P))}static TLh(I,R){let C=null;(I=L.oh.gu(I))&&(I=L.Aba.SN(I))&&(C=I.Lsa(R?
Box4Intl.Box4Strings.L_StyleWordFootnoteReference:Box4Intl.Box4Strings.L_StyleWordEndnoteReference));return C}}L.xC=null;L.aB=null;Object(D.a)(L,"FootnoteEndnoteInserter",null,[429])},1568:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{static Urn(f,a){m.Zze=f;m.kDe=a}static Rrn(f,a){m.iDe=f;m.nUa=a}static sWh(){return m.iDe===m.nUa?String.format(WordEditorIntl.WordEditorStrings.l_ReplacedAllMessage,m.nUa,m.Zze,m.kDe):String.format(WordEditorIntl.WordEditorStrings.l_ReplacedSomeMessage,
m.iDe,m.nUa,m.Zze,m.kDe)}}m.iDe=0;m.nUa=0;m.Zze=null;m.kDe=null;Object(D.a)(m,"ReplaceAllContext",null,[])},1585:function(D,M,d){d.r(M);D=d(0);var m=d(1894),f=d(59),a=d(2),l=d(332),r=d(22),w=d(1824),v=d(9),u=d(8),z=d(244),B=d(1896),G=d(13),F=d(18),K=d(1545);class N{constructor(ob="",cb="",db=!1,kb=!1){this.Bem=db;this.Yhm=kb;this.actionId=ob;this.cEa=cb}}Object(D.a)(N,"SearchEntryPointContext",null,[]);class H{constructor(ob){this.Gca=null;this.ou=!1;this.zM=ob}initialize(){this.VY();this.Uy();this.x5(0)}Uy(){this.Gca.Uy()}dispose(){this.zM=
null}IIc(){return!1}get dF(){return this.Gca?this.Gca.dF:0}x5(ob){this.Gca.x5(ob)}get isVisible(){return this.ou}sNe(ob){this.Gca&&this.Gca.Vxo(ob)}KMi(ob){this.Gca&&this.Gca.tGo(ob)}Qgj(ob){this.Gca&&this.Gca.GJo(ob)}jlh(){this.Gca&&this.Gca.czo()}u4d(ob){this.Gca&&this.Gca.u4d(ob)}}Object(D.a)(H,"FindReplacePane",null,[325,10]);var J=d(56),L=d(1377),I=d(80),R=d(1017),C=d(160),P=d(190),W=d(1006),X=d(83),V=d(84),Y=d(57),ca=d(27),fa=d(435),sa=d(1474),ia=d(407),ea=d(1484),da=d(687),ja=d(82),Ga=d(1045);
class ya{constructor(ob){this.r1j=(cb,db)=>{this.Ond.xb(cb)?this.Ond.Z(cb,db):this.Ond.add(cb,db);(cb=this.dgl(cb))&&this.Q8h(db,cb,this.Qph(ia.a.getTypeName()))};this.Ond=new ja.a;this.DU=new ja.a;this.annotationType=sa.RoleDetectionAnnotation.getTypeName();ob.Xhn(this.r1j)}mI(ob,cb){let db;const kb=ob.parentPath.substr(ob.parentPath.lastIndexOf("\\")+1),Wb=ob.content;if(!Wb||this.Ehm(Wb))""!==kb&&({value:db}=this.Ond.Dc(kb,db)).returnValue&&this.Q8h(db,ob,this.Qph(cb)),cb===ia.a.getTypeName()?(cb=
null,({value:cb}=this.DU.Dc(kb,cb)).returnValue?this.DU.Z(kb,ob):this.DU.add(kb,ob)):cb===ea.a.getTypeName()&&this.DU.remove(kb)}Q8h(ob,cb,db){const kb=this.jvl(cb);cb=this.egl(cb);0<cb&&ob(db,kb,cb)}egl(ob){try{return Number.parseInvariant(ob.id.substr(2))}catch(cb){u.ULS.sendTraceTag(554747009,367,10,cb.toString())}return-1}dgl(ob){let cb;return({value:cb}=this.DU.Dc(ob,cb)).returnValue?cb:null}uUc(ob){if(ob)for(const cb of ob)this.mI(cb,"AugLoop_Core_AddOperation")}jvl(ob){if(ob=ob.content)switch(ob.roleType){case sa.RoleType.Heading1:return 1;
case sa.RoleType.Heading2:return 2;case sa.RoleType.Heading3:return 3;case sa.RoleType.Heading4:return 4;case sa.RoleType.Heading5:return 5;case sa.RoleType.Heading6:return 6;case sa.RoleType.Heading7:return 7;case sa.RoleType.Heading8:return 8;case sa.RoleType.Heading9:return 9}return-1}Ehm(ob){ob=ob.roleType;return ob===sa.RoleType.Heading1||ob===sa.RoleType.Heading2||ob===sa.RoleType.Heading3||ob===sa.RoleType.Heading4||ob===sa.RoleType.Heading5||ob===sa.RoleType.Heading6||ob===sa.RoleType.Heading7||
ob===sa.RoleType.Heading8||ob===sa.RoleType.Heading9}Qph(ob){if(ob===ia.a.getTypeName()||ob===da.a.getTypeName())return Ga.a.aNe;if(ob===ea.a.getTypeName())return Ga.a.Vxd;throw Error.create("Invalid operation type");}}Object(D.a)(ya,"RoleDetectionAnnotationHandler",null,[179]);var ta=d(164),ua=d(76),Sa=d(1110),ka=d(54),ha=d(79),Ca=d(43),Pa=d(188),Xa=d(180),qa=d(547);class Ea extends Pa.a{constructor(ob,cb){super(ob,cb,v.App.sba);this.gQd=null;this.geb=this.EXb=0;this.headingsReady=!1;this.aOa=this.G$a=
0;this.nmi=!1;this.cQg=this.TFg=this.bCg=null;this.j1e=!1}get LPd(){return!0}get lEh(){return this.bCg}get qUd(){return this.cQg}Wij(){this.headingsReady&&(this.TFg.style.display="none",this.geb||this.EXb?(this.lEh.style.display="none",this.container.style.display="block"):(this.container.style.display="none",this.lEh.style.display="block"))}get BZ(){return super.BZ|240}static k_e(ob,cb,db){var kb=v.App.xa.jb.Zc;if(kb&&(kb=Xa.PageNavigator.instance.hT(kb))){const Wb=new Ea(new qa.a,r.a.instance.resolve("Box4.IHtmlViewRootFactory"));
Wb.geb=0;Wb.EXb=0;Wb.gQd=null;Wb.L$a(ob);Wb.bCg=cb;Wb.TFg=db;Wb.iB(kb);Wb.headingsReady=!0;Wb.Wij();Wb.cQg=null;return Wb}return null}}Object(D.a)(Ea,"WordNavigationPaneHeadingsView",Pa.a,[353,235,123,10]);class Ia{constructor(ob){this.DU=new ja.a;this.rRg=ob}mI(ob,cb){cb===ia.a.getTypeName()?(cb=null,({value:cb}=this.DU.Dc(ob.id,cb)).returnValue?this.DU.Z(ob.id,ob):this.DU.add(ob.id,ob)):cb===ea.a.getTypeName()&&this.DU.remove(ob.id);this.rRg&&this.rRg()}uUc(ob){if(ob)for(const cb of ob)this.mI(cb,
ia.a.getTypeName())}x1b(){var ob;let cb=[];if(0<(null===(ob=this.DU)||void 0===ob?void 0:ob.count))for(const db of this.DU.values)cb.push(db);return cb}}Object(D.a)(Ia,"ContractEntityAnnotationHandler",null,[179]);var na=d(3);class Na{constructor(ob){this.ga=ob}hOm(){this.cancelSearch()}mQm(ob){this.ga.Xb(F.a.VHd,2,ob)}kGf(){this.cancelSearch()}cancelSearch(){this.ga.processAction(na.a.Wvb,2)}aVm(){this.ga.processAction(na.a.findOnPage,2)}onSearchQueryChanged(ob){this.ga.Xb(na.a.CBd,2,ob)}GWm(){this.ga.processAction(F.a.replace,
2)}HWm(){this.ga.processAction(F.a.replaceAll,2)}CWm(){this.ga.processAction(G.a.P7e,2)}DWm(){this.ga.processAction(G.a.d8e,2)}FWm(){this.ga.processAction(na.a.k_d,2)}EWm(){this.ga.processAction(na.a.FUd,2)}cbc(ob){this.ga.Xb(F.a.cbc,2,ob)}}Object(D.a)(Na,"FindReplaceActions",null,[352]);var Oa=d(335);class Ra{}Ra.sO=Oa.a.kcb;Ra.M$b=0;Ra.Lra="FindReplaceTaskPaneData";Ra.QQ=WordEditorIntl.WordEditorStrings.L_NavigationPaneTitle;Object(D.a)(Ra,"FindReplaceConstants",null,[]);var ab=d(749);class zb{Xbj(ob){var cb,
db,kb;return fa.a.qdb(null===(kb=null===(db=null===(cb=v.App.xa)||void 0===cb?void 0:cb.jb)||void 0===db?void 0:db.Zc)||void 0===kb?void 0:kb.Ad,ob)}clearSelection(){if(this.Rve){const ob=this.Xbj(this.Rve);ob&&ob.Hja()}this.Rve=this.tYg=null}DBn(ob){this.clearSelection();if(ob){const cb=this.Xbj(ob.parentPath);if(cb){const db=ob.content;db&&(this.tYg=ob.id,cb.ZOa([new ab.a(db.range.start,db.range.start+db.range.length)]),cb.zxf(0,1));this.Rve=ob.parentPath}}}}Object(D.a)(zb,"RangeAnnotationContentSelector",
null,[]);var Qa=d(1568);class yb{constructor(ob){this.FJj=ob}get Ej(){return this.FJj.value}zyl(ob){ob=this.Ej.$Xa(ob);return this.lbm(ob)?null:ob}lbm(ob){return ob.id===this.Ej.mAa.id}static get instance(){return null!=yb.ckg?yb.ckg:yb.ckg=yb.YD()}static YD(){const ob=new z.a(()=>w.FindManager.instance.Ej);return new yb(ob)}}Object(D.a)(yb,"SearchResultOrder",null,[]);var lb=d(11),Eb=d(291);class bc{constructor(ob){this.kwe=ob}get UOa(){return this.kwe.value}getSelectedText(){var ob=this.UOa.osa;
if(ob){const cb=ob.cpBegin,db=ob.cpEnd-cb;if(0<db&&(ob=ob.node,lb.ParagraphReader.oc(ob)))return ob.characterData.substr(cb,db)}return null}static getInstance(){return bc.Fl()}static Fl(){const ob=new z.a(()=>Eb.a.instance);return new bc(ob)}}Object(D.a)(bc,"SelectionHelper",null,[]);var Pb=d(36),Va=d(166),oa=d(433),pa=d(835),Ya=d(230),Ja=d(432),nb=d(1775),Bb=d(389);class mb extends Pa.a{constructor(ob,cb,db){super(ob,cb,v.App.sba);this.l1a=db;this.p2h=!1}get LPd(){return!0}get BZ(){return super.BZ|
248}static k_e(ob){var cb=v.App.xa.jb.Zc;const db=Bb.a.instance.Rc(3);return cb&&(cb=Xa.PageNavigator.instance.hT(cb))?(ob=new mb(new qa.a,r.a.instance.resolve("Box4.IHtmlViewRootFactory"),ob),db.Fdc(ob.Tb),ob.iB(cb),db.dispose(),ob.p2h=!0,ob):null}}Object(D.a)(mb,"WordNavigationPaneReactHeadingsView",Pa.a,[235,123,10]);class Qb extends H{constructor(ob,cb,db,kb,Wb,Fb,nc,gc,Jc,tb,dc,Yb,pb,Gb){var hb,Ib,Ob,kc;super(ob);this.Rob=Ra.sO;this.OVj="FindReplaceTaskPaneProps";this.Wb=J.FocusManager.instance();
this.$Qa=this.eIa=this.zY=this.xHe=null;this.nNb=a.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled");this.b6c=a.AFrameworkApplication.K.$("AutoDetectedHeadingsIsEnabled");this.vfd=(null===(hb=a.AFrameworkApplication.K)||void 0===hb?void 0:hb.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactHeadings",!1))||(null===(Ib=a.AFrameworkApplication.K)||void 0===Ib?void 0:Ib.$("NavPaneReactHeadings"));this.sLj=null===(Ob=a.AFrameworkApplication.K)||void 0===Ob?void 0:Ob.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactEntities",
!1);this.Efj=()=>{this.isVisible&&this.gxd===B.a.intelligentPlaceholder&&this.Vn()};this.fA=new L.a;this.KEg=cb;this.ZFa=B.a.headings;this.Lwc=m.a.initial;this.ipa=new ha.a;this.HO="";this.Umc={matchCase:!1,matchWholeWord:!1};this.jDe="";this.$Ee=null;this.fP=db;this.e_g=!1;this.Nsb=kb;this.hb=Wb;this.ILj=Fb;this.hya=nc;this.jG=gc;this.ogd=!0;this.O4=this.N4=!1;this.Jf=Jc;this.lme=tb;this.N0=dc;this.Hb=Yb;this.U3=pb;this.Nxg=Gb;this.Mge&&this.hya.Fln(()=>{this.Vn()});(null===(kc=a.AFrameworkApplication.K)||
void 0===kc?0:kc.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenNavPaneOnBoot",!1))&&this.A3j()}A3j(){this.Hb.$b(new I.a(5,1,0,()=>{const ob=this.lme.lQh();null!=ob&&6<ob.count&&(a.AFrameworkApplication.ya.processAction(F.a.XPa,2),this.q6c=window.performance.now(),Y.a("DefaultNavigationPaneOpened"))}))}get fIe(){return 1}get Mge(){return this.nNb&&this.b6c&&!!this.Jf}get Nge(){return this.nNb&&this.sLj&&!!this.Jf}get headingsReady(){return this.vfd?this.N0.headingsReady:this.upb?this.upb.headingsReady:
!1}set headingsReady(ob){this.vfd?this.N0.headingsReady=ob:this.upb&&(this.upb.headingsReady=ob)}get gxd(){return this.ZFa}V2i(){this.ZFa=B.a.headings;this.Vn()}tUn(){this.ZFa=B.a.contracts;this.Vn()}O2i(){this.ZFa=B.a.find;Y.a("NavigationPaneFind");this.Vn()}D3i(){this.ZFa=B.a.replace;this.Vn()}h3i(){this.ZFa=B.a.intelligentPlaceholder;this.Vn()}G_c(ob){this.e_g=ob;this.Vn()}IIc(){return this.gxd===B.a.replace}get dF(){return this.Lwc}x5(ob){this.Lwc=ob;this.Vn()}sNe(ob){this.q3j(ob);this.Vn()}q3j(ob){const cb=
this.ILj(ob[ob.length-1]);if(cb){let db=-1;for(let kb=0;kb<this.ipa.count;kb++)if(cb.id===this.ipa.J(kb).id){db=kb;break}-1===db?u.ULS.sendTraceTag(40776785,313,50,"Taskpane AddSearchResult gave illegal -1 index"):this.ipa.uA(db,this.oqh(ob))}else this.ipa.addRange(this.oqh(ob))}KMi(ob){for(let cb of ob)for(ob=this.ipa.count-1;0<=ob;ob--)if(this.ipa.J(ob).id===cb.id){this.ipa.removeAt(ob);break}this.Vn()}Qgj(ob){for(let cb of ob)for(ob=this.ipa.count-1;0<=ob;ob--)if(this.ipa.J(ob).id===cb.id){this.ipa.Z(ob,
this.nqh(cb));break}this.Vn()}jlh(){this.ipa.clear();this.$Ee=null;this.Vn()}u4d(ob){this.$Ee=ob?ob.id:null;this.Vn()}oqh(ob){if(!ob)return new ha.a;const cb=new ha.a;for(let db of ob)cb.add(this.nqh(db));return cb}nqh(ob){const cb=this.Nsb.Owd(ob);return{id:ob.id,searchBeginIndex:cb.hTf,searchEndIndex:cb.eTf,searchResult:cb.hYe}}tbe(){}Wjo(){var ob={};this.zM.cbc(ob);ob=ob[R.a.Value];this.xHe=ca.c(ob)?"":ob;this.Vn()}XKa(){return this.HO}qAb(){return this.jDe}zWf(ob){this.HO=ob;this.Vn()}clearSearch(){}initialize(){this.eld=
window.performance.now();const ob=this.Wb.pe(this.Rob);ob.parent=C.AFrame.Lp;ob.LL=!0;this.VY();this.x5(m.a.initial)}mO(){this.isVisible?(u.ULS.sendTraceTag(527237715,312,50,"Navpane is already open, so making it the selected task pane."),P.UISurfaces.Xt().then(ob=>{ob.setSelectedTaskPane(this.Rob,this.fIe);this.k7();this.ogd&&this.iZi(!0);return null}).catch(ob=>{Qb.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],ob)})):(this.L_c(),this.ogd&&this.iZi(!1))}iZi(ob){const cb=
this.KEg();cb?this.HO=cb:ob&&this.HO||(this.HO="");this.zM.onSearchQueryChanged(this.HO)}pla(){P.UISurfaces.Xt().then(ob=>{ob.hideTaskPane(this.Rob,this.fIe);return null}).catch(ob=>{Qb.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],ob)})}VY(){this.fP.PJa();this.zY=this.fP.PZb(this.Wb);this.e1j()}L_c(){P.UISurfaces.Xt().then(ob=>{this.eld=window.performance.now();ob.showTaskPane(this.Rob,this.nB());ob=[Object.assign(new Pb.a,{name:"Tab",string:this.ZFa})];const cb=window.performance.now()-
this.eld;Y.a("NavigationPaneOpen",!0,cb,ob);return null}).catch(ob=>{Qb.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],ob)})}Vn(){P.UISurfaces.Xt().then(ob=>{ob.updateTaskPane(this.Rob,this.nB());return null}).catch(ob=>{Qb.recordQosError("NavPaneUpdateActionFailure",["NavPaneInteractionFailed"],ob)})}nB(){const ob={activeTab:B.a.initial};this.fA.fJb(ob);return Object.assign(new W.a,{title:Ra.QQ,hideHeader:!1,width:320,location:this.fIe,contentProps:ob,onOpen:()=>{this.ou=
!0;this.dln();this.jin();this.ogd&&this.k7();v.App.xa.updateCommandUI();v.App.xa.SUa(this.Efj)},onClose:()=>{try{const cb=window.performance.now();null!=this.q6c&&(5E3>window.performance.now()-this.q6c&&Y.a("DefaultNavigationPaneClosed"),this.q6c=null,this.upb?this.upb.j1e=!1:this.yOj=!0);this.Saa();this.ou=!1;this.wco();this.Zco();this.zM.kGf();this.xHe="";this.Lwc=m.a.initial;v.App.xa.Fbc(this.Efj);v.App.xa.updateCommandUI();const db=window.performance.now()-cb;Y.a("NavigationPaneClose",!0,db)}catch(cb){Qb.recordQosError("NavPaneCloseActionFailure",
["NavPaneInteractionFailed"],cb)}},enableResize:!1,minResizeWidth:280,maxResizeWidth:920,isModernPane:!0})}dln(){this.Mge&&!this.eIa&&fa.a.zn().then(()=>{this.eIa=new ya(this.hya);this.Jf.mb(this.eIa,this.eIa.annotationType);this.Jf.getAnnotationsByType(this.eIa.annotationType).then(ob=>{this.eIa.uUc(ob)})})}Zco(){this.Mge&&this.eIa&&(this.Jf.sc(this.eIa,this.eIa.annotationType),this.eIa=null)}t9n(){if(this.Nge){var ob=new nb.ContractEntitySignal;ob=Object.assign(new pa.a,{parentPath:["Signal",Ya.a.getTypeNameFor(ob)],
items:[Object.assign(new Ja.a,{body:ob})]});this.U3.getAugLoopRuntimeManager().submitOperation(Object.assign(new oa.a,{operation:ob}))}}jin(){this.Nge&&!this.$Qa&&fa.a.zn().then(()=>{this.$Qa=new Ia(this.Vn);this.Jf.mb(this.$Qa,nb.ContractEntityAnnotation.getTypeName());this.t9n();this.Jf.getAnnotationsByType(nb.ContractEntityAnnotation.getTypeName()).then(ob=>{this.$Qa.uUc(ob)})})}wco(){this.Nge&&this.$Qa&&(this.Jf.sc(this.$Qa,nb.ContractEntityAnnotation.getTypeName()),this.$Qa=null)}e1j(){this.fA.oK(this.Upl());
this.fA.oK(this.Wpl());this.fA.oK(this.msl());this.fA.oK(this.vll());this.fA.oK(this.bul());this.fA.oK(this.Ael());this.fA.oK(this.onLinkExecute());this.fA.oK(this.onPivotTabExecute());this.fA.oK(this.jHl());this.fA.oK(this.NJl());this.fA.oK(this.Ktl());this.fA.oK(this.FKl());this.fA.oK(this.qEl())}FKl(){return ob=>{ob.autoDetectedHeadingsToggleDisabled=this.hya?!this.hya.Wek():!0}}NJl(){return ob=>{ob.type=this.OVj}}onLinkExecute(){return ob=>{ob.onLinkExecute=()=>{this.zM.aVm()}}}onPivotTabExecute(){return ob=>
{ob.onPivotTabExecute=cb=>{switch(cb){case B.a.headings:this.V2i();break;case B.a.replace:this.D3i();break;case B.a.contracts:this.tUn();break;case B.a.intelligentPlaceholder:this.h3i();break;default:this.O2i()}ca.b(this.HO)&&(this.HO=this.KEg(),this.HO||(this.HO=""),ca.b(this.HO)||(this.zM.onSearchQueryChanged(this.HO),this.Vn()))}}}jHl(){return ob=>{ob.showOutOfSyncNotification=this.e_g}}Wpl(){return ob=>{ob.findSearchBoxContent={onSearchQueryChanged:cb=>{this.HO=cb;this.Vn();this.zM.onSearchQueryChanged(cb)},
findOptions:this.Umc,matchCase:this.N4,matchWholeWord:this.O4,findSearchText:this.HO,onClearButtonExecute:()=>{void 0!==this.HO&&null!==this.HO&&""!==this.HO&&(this.HO="",this.hb.setSelection(null),this.zM.hOm())},onMatchCaseExecute:()=>{this.Umc.matchCase=!this.Umc.matchCase;this.N4=!this.N4;this.Vn();this.zM.CWm()},onMatchWholeWordExecute:()=>{this.Umc.matchWholeWord=!this.Umc.matchWholeWord;this.O4=!this.O4;this.Vn();this.zM.DWm()},onMenuClose:()=>{if(this.zY)this.zY.onMenuClose()},onMenuOpen:()=>
{if(this.zY)this.zY.onMenuOpen()}}}}Ael(){return ob=>{ob.activeTab=this.gxd}}Ktl(){return ob=>{ob.autoDetectedHeadingsToggleState=this.hya?this.hya.cJa:!1;!ob.autoDetectedHeadingsToggleState&&this.hya&&this.hya.Rfc(!1)}}Upl(){return ob=>{const cb={onReplaceAllExecute:()=>{this.zM.HWm()},onReplaceExecute:()=>{this.zM.GWm()},onReplaceQueryChanged:db=>{this.jDe=db;this.Vn()},replaceSearchText:this.jDe};ob.findReplaceContent={searchResults:this.ipa.toArray(),replaceSearchBoxContent:cb,onNextSearchResultExecute:()=>
{this.zM.EWm()},onPrevSearchResultExecute:()=>{this.zM.FWm()},onSearchResultSelected:db=>{const {FindReplaceUIManager:kb}=d(1585);this.zM.mQm(db);kb.Rli(1)},selectedResultId:this.$Ee,summaryLabel:this.xHe,explanationText:this.opl(this.Lwc),haveTooManySearchResults:this.Lwc===m.a.tooManyResults}}}opl(ob){switch(ob){case m.a.initial:return WordEditorIntl.WordEditorStrings.l_LandingMessage;case m.a.noMatchesFound:return WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;case m.a.replaceAllComplete:return Qa.a.sWh();
case m.a.tooManyResults:return WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage;default:return""}}qEl(){return ob=>{ob.replaceFollowUpsWithCommentsIsEnabled=!0}}bul(){return ob=>{var cb=this.jG.sfl();const db=[];for(let kb of cb)cb=this.jG.bDd(kb.Nc,kb.id),db.push({id:kb.id.toString(),intelligentPlaceholderAnchorText:cb});ob.intelligentPlaceholderContent={intelligentPlaceholderContentEntry:db,onIntelligentPlaceholderInputExecute:kb=>{this.HO=kb;this.ZFa=B.a.find;this.Vn();this.zM.onSearchQueryChanged(kb)},
onSearchResultSelected:kb=>{this.Vn();kb=f.a.Of(kb);this.jG.NBn(kb)}}}}msl(){return ob=>{let cb=()=>{};this.hya&&(cb=Object(Ca.a)(this.hya,this.hya.Rfc,"toggleAutoDetectedHeadings"));ob.headingsContent={onHeaderInputExecute:db=>{this.HO=db;this.ZFa=B.a.find;this.Vn();Y.a("NavigationPaneFind");this.zM.onSearchQueryChanged(db)},renderHeadingContent:(db,kb,Wb)=>{this.Hb.$b(new I.a(0,1,100,()=>{var Fb=window.performance.now()-this.eld;if(this.vfd){var nc=this.N0.Qma;this.headingsReady=!0;this.Vn();Wb.style.display=
"none";nc.first&&(db.style.display="block");this.Hb.$b(new I.a(1,1,0,()=>{mb.k_e(this)}))}else this.upb=Ea.k_e(db,kb,Wb),this.Vn();null==this.q6c||this.yOj||(this.upb.j1e=!0);nc=window.performance.now()-this.eld;Y.a("NavigationPaneHeadingsLoaded",!0,nc,[Object.assign(new Pb.a,{name:"NavPaneReactHeadings",boolean:this.vfd})]);Fb=[Object.assign(new Pb.a,{name:"HeadingFetchStart",double:Fb}),Object.assign(new Pb.a,{name:"HeadingFetchFinished",double:nc})];Y.a("NavigationPaneHeadingsLoadDetails",!0,void 0,
Fb)}))},autoDetectedHeadingsToggle:cb,onHeadingsUnmounted:()=>{this.headingsReady=!1},headingsReady:this.headingsReady,headingsList:this.N0.Qma,onHeadingChevronClick:db=>{this.Hb.$b(new I.a(0,1,0,()=>{this.N0.r3k(db);this.Vn()}))},onClickHeading:db=>{this.Hb.$b(new I.a(0,1,0,()=>{this.N0.onClickHeading(db);this.Vn()}))},onClickBookmark:db=>{this.Hb.$b(new I.a(0,1,0,()=>{this.N0.onClickBookmark(db);this.Vn()}))},bookmarkIconUrl:ta.a.Sh("BookmarkDefault.png")}}}ull(){var ob,cb=null===(ob=this.$Qa)||
void 0===ob?void 0:ob.x1b();if(cb){ob=Array(cb.length);let db=0;for(const kb of cb)(cb=kb.content)&&(ob[db++]={id:kb.id,type:cb.type,value:cb.value});return ob}return null}vll(){return ob=>{ob.contractsContent={onHeaderInputExecute:cb=>{this.HO=cb;this.ZFa=B.a.find;this.Vn();Y.a("NavigationPaneFind");this.zM.onSearchQueryChanged(cb)},contractEntities:this.ull(),selectedEntityId:this.Nxg.tYg,onEntitySelected:cb=>{var db;const kb=null===(db=this.$Qa)||void 0===db?void 0:db.x1b();if(kb)for(const Wb of kb)if(Wb.id===
cb){this.Nxg.DBn(Wb);break}this.Vn()}}}}AYi(ob){this.ogd=ob}dio(ob){this.Hb.$b(new I.a(0,1,0,()=>{this.N0.k7f(ob)&&this.Vn()}))}GQl(ob){this.Hb.$b(new I.a(0,1,0,()=>{this.N0.UQk(ob)&&this.Vn()}))}y6f(ob,cb){this.Hb.$b(new I.a(0,1,0,()=>{this.N0.y6f(ob,cb)&&this.Vn()}))}oQk(ob){this.Hb.$b(new I.a(0,1,0,()=>{this.N0.pQk(ob)&&this.Vn()}))}qNn(ob){this.N0.cJa=ob;this.Hb.$b(new I.a(0,1,0,()=>{this.N0.i7n(ob);this.Vn()}))}X6f(ob){this.N0.X6f(ob)&&this.Vn()}H1e(ob){this.N0.H1e(ob)&&this.Vn()}r$m(){return 0<
this.N0.q$m}k7(){this.Wb.Jg(this.Rob);u.ULS.sendTraceTag(40469190,312,50,"Taskpane now visible with focus on SearchBox")}Saa(){if(this.c_a()){var ob;(ob=ua.InteractiveViewManager.instance.xd)?(ob=ob.aI,u.ULS.sendTraceTag(40469191,312,50,"Taskpane now hidden with focus on previous selection view.")):(ob=this.Wb.AS,u.ULS.sendTraceTag(40469192,312,50,"Taskpane now hidden with focus on default scope."));this.Wb.Jg(ob)}}c_a(){return!!this.Wb.xg&&this.Wb.xg.name===this.Rob}static getInstance(){return Qb.Fl()}static Fl(){return new Qb(new Na(a.AFrameworkApplication.ya),
Object(Ca.a)(bc.getInstance(),bc.getInstance().getSelectedText,"getSelectedText"),Sa.a.instance,K.a.instance,ka.a.instance,Object(Ca.a)(yb.instance,yb.instance.zyl,"getNextSearchResult"),r.a.instance.Pa("Box4.NavigationPaneViewElementManager.INavigationPaneViewElementManager"),r.a.instance.Pa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),r.a.instance.Pa("Box4.AugmentationLoop.IAnnotationStorage"),r.a.instance.resolve("WordEditor.TableOfContents.IDocumentHeadings"),r.a.instance.resolve("WordEditor.FindReplace.NavPaneHeadingsManager"),
X.a.instance,r.a.instance.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),new zb)}static recordQosError(ob,cb,db){const kb=Object.assign(new Va.a,{extendedProperties:new Map});db&&kb.extendedProperties.set("exception",db);V.Health.instance.recordQosError(ob,cb,!1,!0,!1,!1,kb)}}Object(D.a)(Qb,"ReactFindReplacePane",H,[324,325,10]);var Vb=d(1531);d.d(M,"FindReplaceUIManager",function(){return mc});class mc{constructor(ob,cb,db=null,kb=null,Wb=null,Fb=null){this.l8c=this.E0=0;this.O4=this.N4=this.utb=
!1;this.Sl=this.CQg=this.oha=null;this.TBa=this.aue=!1;this.hh=ob;this.xp=db;this.Nsb=kb;this.fNg=Wb;this.le=Fb;mc.ZXb=new N}get Mrf(){return this.aue}set Mrf(ob){ob!==this.aue&&(this.aue=ob,this.dkh())}p6d(ob){this.E0=ob;this.update();this.E0||this.dF!==m.a.searchComplete&&this.dF!==m.a.tooManyResults?0<this.E0&&this.dF===m.a.noMatchesFound?this.x5(m.a.searchComplete):this.E0>mc.L$i&&this.dF!==m.a.tooManyResults&&(u.ULS.sendTraceTag(4065350,312,50,"Shifting to TooManyResults UI"),this.x5(m.a.tooManyResults)):
this.x5(m.a.noMatchesFound)}T4d(ob){this.l8c=ob;this.TBa&&this.update();this.fNg&&!this.fNg.value.tXc&&this.VVf()}reset(){}b8e(){this.le&&(this.Sl=this.le.fg("UserAction","Find"));if(this.TBa||!this.dF)this.TBa=!1,u.ULS.sendTraceTag(4065351,312,50,"FindStarted");this.x5(m.a.searching)}S0b(){var ob;this.TBa=!0;let cb=this.E0?m.a.searchComplete:m.a.noMatchesFound;if(this.dF!==m.a.tooManyResults&&w.FindManager.instance){const db=w.FindManager.instance.Ej;0<db.Vga&&(db.Vga>mc.L$i?cb=m.a.tooManyResults:
this.djo(db))}this.x5(cb);this.update();this.Sl&&(this.Sl.stop(),this.Sl=null);mc.XTi=f.a.create().toString();mc.Rli(0,this.cbb,this.XKa().length,this.E0);Object(Vb.b)()&&(null===(ob=this.hh)||void 0===ob?0:ob.isVisible)&&(ob={},a.AFrameworkApplication.ya.Xb(G.a.O0d,2,ob),ob[l.a.On]&&a.AFrameworkApplication.ya.Xb(G.a.hMd,2,{CommandValueId:{query:this.XKa(),matchCase:this.N4,matchWholeWordOnly:this.O4,totalResultLimit:-1}}))}djo(ob){const cb=ob.mAa;let db=cb;const kb=[];do kb[kb.length]=db,db=ob.$Xa(db);
while(cb!==db);this.hh.sNe(kb);this.oha&&this.hh.u4d(this.oha)}update(){this.hh&&this.hh.Wjo()}get dF(){return this.hh.dF}get cbb(){return this.hh.gxd}Yjb(ob){this.Mrf=ob}dkh(){if(this.Mrf)switch(this.dF){case m.a.searchComplete:case m.a.noMatchesFound:case m.a.tooManyResults:this.hh.G_c(!0)}else this.hh.G_c(!1)}x5(ob){if(this.hh.isVisible){switch(ob){case m.a.noMatchesFound:case m.a.searchComplete:this.dF===m.a.tooManyResults&&(ob=m.a.tooManyResults)}this.hh&&(this.hh.x5(ob),this.dkh());this.update();
this.VVf()}}BKa(ob,cb){const db=this.TBa&&this.dF!==m.a.tooManyResults;switch(ob){case 0:db&&this.hh.sNe(cb);break;case 1:db&&this.hh.KMi(cb);break;case 4:db&&this.hh.Qgj(cb);break;case 2:this.hh.jlh();break;case 3:this.oha=cb[0],db&&0<this.E0&&this.hh.u4d(this.oha)}}get matchCase(){return this.N4}set matchCase(ob){this.N4!==ob&&(this.N4=ob,this.ifj())}get matchWholeWord(){return this.O4}set matchWholeWord(ob){this.O4!==ob&&(this.O4=ob,this.ifj())}ifj(){this.hh.tbe()}XKa(){return this.hh.XKa()}qAb(){return this.hh.qAb()}zWf(ob){this.hh.zWf(ob)}clearSearch(){this.hh.clearSearch()}get E3i(){return 0<
this.E0&&this.dF!==m.a.replaceAllInProgress&&this.dF!==m.a.replaceAllComplete}lFn(ob){let cb="";ob?cb=0<this.E0?String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplacedAndMoveToNextResult,this.XKa(),this.qAb()):String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplaceWithNoMoreResults,this.XKa(),this.qAb()):ob||0<this.E0&&(cb=WordEditorIntl.WordEditorStrings.l_ReadoutReplaceSkippedAndMoveToNextResult);this.VVf(cb)}dispose(){this.hh.dispose()}IIc(){return this.hh.IIc()}bKn(ob,cb=!0){ob!==
this.cbb&&(ob===B.a.headings?(u.ULS.sendTraceTag(9056651,367,50,""),this.hh.V2i()):ob===B.a.find?this.hh.O2i():ob===B.a.replace?this.hh.D3i():ob===B.a.intelligentPlaceholder&&(cb||this.hh.AYi(cb),this.hh.h3i()))}NA(ob,cb=!0){this.hh.AYi(cb);ob?(this.utb||this.hmf(),this.hh.mO(),this.E0||this.dF===m.a.noMatchesFound?a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("WordEditorFindReplaceCancelButtonFixIsEnabled")&&this.hh.x5(m.a.searchComplete):this.x5(m.a.initial)):this.hh.pla()}hmf(){this.utb||
(this.hh.initialize(),this.utb=!0)}VVf(ob=""){var cb=this.EEl();cb&&(ob=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,ob,cb));this.Nsb&&cb&&this.oha&&this.dF!==m.a.tooManyResults&&this.dF!==m.a.replaceAllInProgress&&(cb=this.Nsb.Owd(this.oha),ob=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,ob,cb.hYe));(cb=this.npl())&&(ob=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,
ob,cb));this.xp&&ob&&this.CQg!==ob&&(this.CQg=ob,this.xp.sendNotification(ob,!0))}EEl(){let ob="";switch(this.dF){case m.a.startSearch:ob=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case m.a.searchComplete:ob=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.l8c,this.E0);break;case m.a.tooManyResults:this.TBa&&(ob=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.l8c,this.E0));break;case m.a.noMatchesFound:ob=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;
break;case m.a.replaceAllInProgress:ob=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgressReadout;break;case m.a.replaceAllComplete:ob=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}return ob}npl(){let ob="";switch(this.dF){case m.a.initial:ob=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,WordEditorIntl.WordEditorStrings.l_LandingMessage,this.Opl());break;case m.a.noMatchesFound:ob=WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;break;
case m.a.replaceAllComplete:ob=Qa.a.sWh();break;case m.a.tooManyResults:ob=WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage}return ob}Opl(){let ob="";this.N4&&this.O4?ob=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOptions,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):this.N4?ob=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchCase):this.O4&&(ob=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,
WordEditorIntl.WordEditorStrings.l_MatchWholeWord));return ob}static getInstance(ob){return mc.Fl(ob)}static Fl(ob){const cb=Qb.getInstance();return new mc(cb,ob,r.a.instance.resolve("Common.Utils.IAriaNotifier"),K.a.instance,new z.a(()=>w.FindManager.instance.SHb),v.App.xa.iq)}static Rli(ob,cb=-1,db=-1,kb=-1){u.ULS.sendTraceTag(4065352,312,50,"{0}",{["SearchOp"]:ob,["SearchComplete.ResultsCount"]:kb,["SearchOpsCorrelation"]:mc.XTi,["ActionId"]:mc.ZXb.actionId,["SourceControlId"]:mc.ZXb.cEa,["IsNavPanOpenedAlready"]:mc.ZXb.Bem,
["IsSearchFromNavPane"]:mc.ZXb.Yhm,["CurrentTab"]:cb,["QueryLength"]:db})}static $mk(ob,cb,db){cb=void 0!==cb&&null!==cb?void 0===cb.SourceControlId||null===cb.SourceControlId?"Unknown":cb.SourceControlId:ob===F.a.rkb?"FindKeyboardShorcut":ob===F.a.tkb?"ReplaceKeyboardShorcut":"Unknown";switch(ob){case F.a.fec:ob="ShowHeadingsPane";break;case F.a.rkb:ob="ShowFindPane";break;case F.a.tkb:ob="ShowReplacePane";break;case F.a.jec:ob="ShowIntelligentPlaceholderPane";break;case F.a.XPa:ob="ToggleNavigationPane";
break;default:ob="Unknown"}mc.ZXb=new N(ob,cb,db,!0)}}mc.L$i=100;mc.XTi=null;mc.ZXb=null;Object(D.a)(mc,"FindReplaceUIManager",null,[294,280,10])},1586:function(D,M,d){d.r(M);D=d(0);var m=d(160),f=d(85),a=d(68),l=d(2),r=d(22),w=d(56),v=d(1049),u=d(128),z=d(9),B=d(8),G=d(18),F=d(335),K=d(492),N=d(1504),H=d(1743),J=d(29),L=d(289),I=d(7),R=d(471),C=d(19),P=d(272),W=d(54),X=d(540),V=d(1623);class Y{constructor(zb,Qa,yb,lb,Eb,bc,Pb,Va){this.oQg=this.OUg=this.RDg=this.gG=this.y4a=this.MMb=this.Goe=this.Cke=
this.kme=this.MM=this.R4=this.V4=null;this.gbe=()=>{const oa=this.Bia.Jzb(this.gG),pa=this.Bia.Yql(this.gG);this.Cke.innerText=oa.toString();this.Goe.innerText=pa.toString();H.a.TIb(this.V4,1===oa?!1:!0);H.a.TIb(this.R4,oa===pa?!1:!0)};this.EHn=()=>{const oa=this.Wb.getRegion(F.a.oXa);let pa;if(this.nqb)if(this.MM&&!this.MM.disabled)pa=this.MM;else if(this.V4.disabled){if(this.R4.disabled)return;pa=this.R4}else pa=this.V4;else if(this.R4.disabled)if(this.V4.disabled)if(this.MM&&!this.MM.disabled)pa=
this.MM;else return;else pa=this.V4;else pa=this.R4;pa.focus();oa.Uj.hy(pa)};this.cna=(oa,pa)=>{(oa=pa.kl.kb)&&this.MM&&H.a.TIb(this.MM,C.SelectionEditor.Km(oa)?!0:!1)};this.OVe=()=>{if(!this.R4.disabled){const oa=this.Bia.ufb(this.gG)?G.a.GBf:G.a.FBf;this.ga.processAction(oa,2)}return!0};this.PVe=()=>{if(!this.V4.disabled){const oa=this.Bia.ufb(this.gG)?G.a.IBf:G.a.HBf;this.ga.processAction(oa,2)}return!0};this.NVe=()=>{this.MM&&!this.MM.disabled&&this.ga.processAction(G.a.Nii,2);return!0};this.Wb=
zb;this.ga=lb;this.gg=Eb;this.re=bc;this.hb=Pb;this.Bia=yb;this.H5=document.createElement("div");this.H5.classList.add("FootnoteEndnoteActionBarControl");this.nqb=Va;this.H5.style.zIndex=String(P.a.lzd);this.H5.style.position="relative";this.Mlc=document.createElement("div");this.Mlc.classList.add("FootnoteEndnoteActionBarControlDividerElement");this.nqb=Va;this.H5.appendChild(this.Mlc);this.nFk();this.H5.appendChild(this.MMb);this.H5.appendChild(this.y4a);this.oY=f.KeyInputManager.mc(a.a.L3,0);this.j1l();
this.i1l()}Vda(zb){B.ULS.shipAssertTag(4520065,308,this.Bia.Ila(zb));if(this.gG!==zb){this.gG=zb;this.gbe();zb=this.Bia.ufb(this.gG);this.MHk(zb);this.gG.U8g(this.gbe);let Qa,yb;this.nqb&&(Qa=this.Bia.Jzb(this.gG)-1,yb=this.Bia.Jzb(this.gG)+1);zb?(this.R4.title=this.nqb&&!this.R4.disabled?String.format(WordEditorIntl.WordEditorStrings.L_NextFootnoteWithNumber,yb.toString()):WordEditorIntl.WordEditorStrings.L_NextFootnote,this.V4.title=this.nqb&&!this.V4.disabled?String.format(WordEditorIntl.WordEditorStrings.L_PrevFootnoteWithNumber,
Qa.toString()):WordEditorIntl.WordEditorStrings.L_PrevFootnote):(this.R4.title=this.nqb&&!this.R4.disabled?String.format(WordEditorIntl.WordEditorStrings.L_NextEndnoteWithNumber,yb.toString()):WordEditorIntl.WordEditorStrings.L_NextEndnote,this.V4.title=this.nqb&&!this.V4.disabled?String.format(WordEditorIntl.WordEditorStrings.L_PrevEndnoteWithNumber,Qa.toString()):WordEditorIntl.WordEditorStrings.L_PrevEndnote);this.rDa()}}Lxb(){this.gG&&(this.MM&&this.MM.parentNode===this.MMb&&this.MMb.removeChild(this.MM),
this.aha(),this.gG.Fpn(this.gbe),this.gG=null)}dispose(){this.Wb.pe(F.a.oXa).Ar(this.oY)}MHk(zb){3===this.ga.mode&&(zb=zb?WordEditorIntl.WordEditorStrings.L_FormatFootnotes:WordEditorIntl.WordEditorStrings.L_FormatEndnotes,this.MM=this.NYe("FootnoteEndnoteFormattingOptionButton","FootnoteEndnoteActionBarFormattingButton",zb,null),J.a.Gq(this.MM,J.a.cda,zb),this.MMb.appendChild(this.MM))}nFk(){this.MMb=document.createElement("div");this.MMb.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarLeftDiv");
this.y4a=document.createElement("div");this.y4a.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarRightDiv");this.V4=this.NYe("FootnoteEndnotePreviousButton","FootnoteEndnoteActionBarNavigationButton","","LeftPageArrow_20x20x32");this.y4a.appendChild(this.V4);this.Cke=R.b("span","FootnoteEndnoteActionBarCurrentCount","FootnoteEndnoteActionBar");this.y4a.appendChild(this.Cke);this.kme=R.b("span","FootnoteEndnoteActionBarDivider","FootnoteEndnoteActionBar");this.kme.innerText=
" / ";this.y4a.appendChild(this.kme);this.Goe=R.b("span","FootnoteEndnoteActionBarTotalCount","FootnoteEndnoteActionBar");this.y4a.appendChild(this.Goe);this.R4=this.NYe("FootnoteEndnoteNextButton","FootnoteEndnoteActionBarNavigationButton","","RightPageArrow_20x20x32");this.y4a.appendChild(this.R4)}NYe(zb,Qa,yb,lb){zb=H.a.cWa(zb,Qa,yb,lb,void 0===lb||null===lb);zb.setAttribute(J.a.Ah,J.a.n1);return zb}j1l(){const zb=this.Wb.pe(F.a.oXa);zb.parent=u.AppFrame.Lp;zb.bindAction(this.oY,G.a.L9);zb.Wca(this.EHn)}i1l(){var zb=
new L.DOMFocusListing(()=>this.H5);zb.uDa=!1;zb.Go(2);zb.Go(1);zb=this.Wb.eTe(this.H5,this.Wb.pe(F.a.oXa),zb);zb.oOa();zb.dX=!0}rDa(){this.MM&&(this.gg.mb(I.a.click,this.MM,this.NVe),this.RDg=this.re.Wib(this.MM,this.NVe,a.a.Ks));this.gg.mb(I.a.click,this.V4,this.PVe);this.OUg=this.re.Wib(this.V4,this.PVe,a.a.Ks);this.gg.mb(I.a.click,this.R4,this.OVe);this.oQg=this.re.Wib(this.R4,this.OVe,a.a.Ks);this.hb.OD(this.cna)}aha(){this.MM&&(this.gg.sc(I.a.click,this.MM,this.NVe),this.re.Klb(this.MM,this.RDg));
this.gg.sc(I.a.click,this.V4,this.PVe);this.re.Klb(this.V4,this.OUg);this.gg.sc(I.a.click,this.R4,this.OVe);this.re.Klb(this.R4,this.oQg);this.hb.ega(this.cna)}static Tql(){return Y.Uql()}static Uql(){return new Y(w.FocusManager.instance(),V.a.instance,X.a.instance,l.AFrameworkApplication.ya,z.App.xa.Zy,z.App.xa.$y,W.a.instance,!!z.App.instance&&z.App.instance.kgb)}}Object(D.a)(Y,"FootnoteEndnoteActionBarControl",null,[432]);var ca=d(204),fa=d(13),sa=d(1547),ia=d(1702);class ea{constructor(zb,Qa,
yb,lb,Eb,bc,Pb,Va,oa,pa,Ya,Ja){this.FD=null;this.DR=!1;this.mv=null;this.onClick=()=>{this.dismiss(!1,!0);return!0};this.LSb=zb;this.Y_b=Qa;this.nic=yb;this.iNj=lb;this.oze=Eb;this.Ql=bc;this.F6a=Pb;this.gg=Va;this.qTg=oa;this.Tzj=Ya;this.Wq=this.LSb.ownerDocument.createElement("div");this.Wq.id="FootnoteEndnoteControlOverlay";this.Wq.className="EditingSurfaceOverlay";this.nH=this.wll();this.j_(!1);this.LSb.appendChild(this.Wq);this.LSb.appendChild(this.nH);this.Y_b.bind();this.ig=null;this.ga=Ja;
this.DGa=pa}Dun(){const zb=this.qTg();zb&&zb.Ji&&(zb.Ajb=0,zb.tqd())}jej(zb){if(this.Dyc){const Qa=this.Dyc.Fka;Qa&&(Qa.vpf=zb)}}get qI(){return this.DR}get Dyc(){return this.FD}get dialog(){return this.ig}get Bn(){return null!=this.fjg?this.fjg:this.fjg=r.a.instance.Za("Common.IZoomManager")}rZe(){this.ig=ia.a.brl()}MXc(){this.ig=null}show(zb=!0){this.DR||(this.jej(!0),this.Tzj(),this.j_(!0),this.Uy(),zb&&this.setFocus())}setFocus(){this.DR&&(this.Y_b.setInitialSelection(),this.iNj())}update(){this.DR&&
(this.FD.isConnected?this.nic.gbe():this.dismiss())}dismiss(zb=!1,Qa=!1){this.DR&&(this.jej(!1),this.J7(),this.Dun(),this.j_(!1),this.oze(Qa),this.ig&&(this.ga.processAction(fa.a.kDc,2),this.ig=null),!zb&&this.FD&&this.FD.isConnected&&this.DGa.MBn(this.FD),this.Lxb())}jtn(zb){const Qa=null!==this.Bn.instance?this.Bn.instance.vj:1;this.nH.style.width=zb.Yoh*Qa+"px";this.mv.style.width=zb.sBc*Qa+"px";this.nH.style.marginLeft=zb.cZb*Qa+"px";this.Ql?this.mv.style.marginRight=zb.aYe*Qa+"px":this.mv.style.marginLeft=
zb.kZb*Qa+"px";if(zb=this.qTg())zb=zb.qK,this.nH.style.bottom=zb.offsetHeight-zb.clientHeight+"px"}Vda(zb){B.ULS.shipAssertTag(4520073,308,this.F6a.Ila(zb));this.FD!==zb&&(this.FD=zb,this.Y_b.Vda(zb),this.nic.Vda(this.FD))}dispose(){this.dismiss();this.Y_b.dispose();this.nic.dispose()}Uy(){this.gg&&this.gg.mb(I.a.click,this.Wq,this.onClick)}J7(){this.gg&&this.gg.sc(I.a.click,this.Wq,this.onClick)}wll(){let zb;zb=document.createElement("div");zb.classList.add("FootnoteEndnoteControl");this.mv=document.createElement("div");
this.mv.classList.add("FootnoteEndnoteContent");this.mv.appendChild(this.Y_b.H5);this.mv.appendChild(this.nic.H5);zb.appendChild(this.mv);return zb}j_(zb){zb=(this.DR=zb)?"":"none";this.Wq.style.display=zb;this.nH.style.display=zb}Lxb(){this.FD&&(this.Y_b.Lxb(),this.nic.Lxb(),this.FD=null)}static cGd(){const zb=z.App.xa.jb.Jc;return zb&&zb.Ji?zb:null}static Xql(zb,Qa,yb,lb,Eb){return new ea(zb,Qa,yb,lb,Eb,l.AFrameworkApplication.isRtl,X.a.instance,ca.a.instance,ea.cGd,sa.a.instance,ea.wVk,l.AFrameworkApplication.ya)}static wVk(){l.AFrameworkApplication.ya.Xb(fa.a.leb,
2,!0)}}Object(D.a)(ea,"FootnoteEndnoteControl",null,[431]);var da=d(790),ja=d(6),Ga=d(211),ya=d(41),ta=d(11),ua=d(24),Sa=d(89),ka=d(1622),ha=d(369),Ca=d(936),Pa=d(572),Xa=d(1421),qa=d(76),Ea=d(120);class Ia extends ha.a{constructor(zb,Qa,yb,lb,Eb,bc,Pb,Va,oa,pa,Ya,Ja,nb,Bb,mb,Qb,Vb){super(F.a.cea,yb,lb,Eb,Pb,Va,oa,pa,Ya,Ja,nb,Bb,mb,Qb,Vb);this.Qxg=zb;this.zTa=bc;this.zTa.$0c=this;Qa(this);this.features.Y1f=!0}get qbi(){return!0}Khf(){const zb=this.Qxg.f$e(this);return Ca.ViewReference.lF(this,zb)}$2e(zb){Object(Ea.a)(Ia,
zb)||this.Qxg.X2e()}LIc(){return Pa.a.Ypi}onResize(){super.onResize();this.zTa.TCh()}iB(zb,Qa=null){super.iB(zb,Qa);this.zTa.GCh(this.ud.Ti)}detach(){this.zTa.SCh();super.detach()}BCd(){this.onResize()}static aWa(){const {FootnoteEndnoteControlManager:zb}=d(1586);return new Ia(zb.instance,Xa.a.qXe,z.App.xa.jb,qa.InteractiveViewManager.instance,()=>r.a.instance.resolve("Box4.IUndoManager"),r.a.instance.resolve("WordEditor.SectionAlignedViewRepositioner"),l.AFrameworkApplication.ya,r.a.instance.resolve("Box4.IHtmlViewRootFactory"),
r.a.instance.resolve("Box4.IInteractiveEventNotifier"),r.a.instance.Za("Box4.ITextMetricsAdapter"),r.a.instance.resolve("Box4.IRotatingCoordinateConverter"),r.a.instance.Za("Common.IZoomManager"),r.a.instance.Pa("Box4.IContentControlViewElementManager"),r.a.instance.Pa("Box4.CpConversionManagerImpl"),r.a.instance.Pa("Box4.ContentControlConfigSettings"),r.a.instance.Pa("Box4.IContentControlReader"),r.a.instance.Pa("Box4.IContentControlBoundaryNavigator"))}}Object(D.a)(Ia,"FootnoteEndnoteEditView",
ha.a,[]);class na{constructor(zb,Qa,yb,lb=!1){this.Xob=null;this.Pse=this.Iug=!1;this.Sal=()=>{const Eb=String.format("{0} {1}",this.Pse?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText);this.fw.sendNotification(Eb,!0)};this.Wb=zb;this.Bia=Qa;this.Xba=yb();this.fcd=lb;this.H5=document.createElement("div");this.H5.classList.add("FootnoteEndnoteEditControl");
this.Mlc=document.createElement("div");this.Mlc.classList.add("FootnoteEndnoteEditControlDividerElement");this.$tb=(new da.a(this.H5,"WACViewPanel_FootnoteEndnoteEditControl")).pE;this.H5.appendChild(this.Mlc);this.H5.appendChild(this.$tb)}get fw(){return null!=this.Zeg?this.Zeg:this.Zeg=r.a.instance.resolve("Common.Utils.IAriaNotifier")}Vda(zb){B.ULS.shipAssertTag(4520077,308,this.Bia.Ila(zb));this.Xob!==zb&&(this.Xob=zb,this.SQe(this.Xob),this.Pse=this.Bia.ufb(this.Xob),this.fcd?(this.Xba.WIb(J.a.krd),
this.Wb.pe(F.a.cea).Vca(this.Sal)):this.Xba.bXi(this.Pse?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,J.a.krd))}Lxb(){const zb=X.a.instance.ufb(this.Xob)?"Footnote":"Endnote";B.ULS.sendTraceTag(4006494,308,50,"{0}",{["Type"]:zb,["CalloutHeight"]:this.H5.scrollHeight});this.qbb();this.Xob=null}bind(){this.Iug||(this.Xba.L$a(this.$tb),this.Iug=!0)}setInitialSelection(){const zb=this.tGl();
zb?this.Xba.setSelection(zb):this.Xba.LZc()}dispose(){this.qbb()}SQe(zb){this.qbb();this.Xba.iB(zb,zb.Ti)}qbb(){this.Xba.detach()}tGl(){let zb=0;var Qa=null,yb=ja.GraphIterator.$a(this.Xob);Ga.OutlineNavigator.K6(yb);if((yb=ya.OutlineElementNavigator.He(yb))&&ta.ParagraphReader.oc(yb)){if(Qa=na.Oul(yb)){zb=Qa.Ob.cp+1;Qa=ka.FootnoteEndnoteDefaultContentInserter.hwh;const lb=Qa.length;zb+lb<=ta.ParagraphReader.textLength(yb)&&yb.characterData.substr(zb,lb)===Qa&&(zb+=lb)}Qa=ua.SelectionFactory.xe(yb,
zb)}return Qa}static Zql(){return na.$ql()}static $ql(){return new na(w.FocusManager.instance(),X.a.instance,()=>Ia.aWa(),l.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}static Oul(zb){zb=Sa.i(zb,10);return 0<zb.length?zb[zb.length-1]:null}}Object(D.a)(na,"FootnoteEndnoteEditControl",null,[430]);var Na=d(1147);class Oa{constructor(zb,Qa){this.Hxa=zb;this.Ql=Qa}$2b(zb,Qa){zb=this.Hxa.$2b(zb);var yb=Qa.clientWidth;const lb=Qa.scrollLeft,Eb=zb.Yoh;let bc=zb.cZb,Pb=zb.cZb,
Va=Oa.Jyf,oa=Oa.Kyf,pa=Eb,Ya=zb.sBc;this.Ql?oa=zb.aYe-Pb:Va=zb.kZb-bc;yb<Eb&&(bc=Math.max(bc-lb,0),pa=yb-bc,this.Ql?(yb=Qa.scrollWidth-lb-yb,Pb=Qa.scrollWidth-zb.cZb-Eb,oa=Math.max(zb.aYe-yb-Pb,Oa.Kyf),Ya=pa-oa-Oa.Jyf):(Va=Math.max(zb.kZb-lb-bc,Oa.Jyf),Ya=pa-Va-Oa.Kyf));return new Na.a(bc,pa,Va,oa,Ya)}}Oa.Jyf=25;Oa.Kyf=50;Object(D.a)(Oa,"FootnoteEndnoteViewPositionProvider",null,[]);class Ra{constructor(zb,Qa=0,yb=0){this.clientWidth=zb;this.scrollLeft=Qa;this.scrollWidth=yb?yb:zb}}Object(D.a)(Ra,
"PageViewScrollContainerSizeInfo",null,[]);d.d(M,"FootnoteEndnoteControlManager",function(){return ab});class ab{constructor(zb,Qa,yb,lb,Eb,bc,Pb,Va){this.yD=null;this.k7=()=>{this.Mo.tG(F.a.cea);this.Mo.tG(F.a.oXa);this.Mo.Hw(m.AFrame.Xp);this.Wb.kxc(F.a.cea);this.Wb.Jg(F.a.cea)};this.MHn=oa=>{this.Mo.Hw(F.a.cea);this.Mo.Hw(F.a.oXa);this.Mo.tG(m.AFrame.Xp);this.Wb.ICc(F.a.cea);(oa||this.Wb.xg&&(this.Wb.xg.name===F.a.cea||this.Wb.xg.name===F.a.oXa))&&this.Wb.Jg(m.AFrame.Xp)};this.Wb=zb;this.Mo=Qa;
this.gDj=yb;this.hDj=lb;this.fDj=Eb;this.Hxa=bc;this.lpa=Pb;this.JD=Va;this.oY=f.KeyInputManager.mc(a.a.L3,0);this.$lf();this.kS()}get control(){return this.yD}get dialog(){return this.control.dialog}get M$h(){return this.control.qI}rZe(){this.control.rZe()}MXc(){this.control.MXc()}bind(zb){this.lBk(zb)}MZf(zb){if(this.control.Dyc!==zb.WVa)this.control.dismiss();else if(this.M$h)return;this.D_b();this.control.Vda(zb.WVa);this.control.show(zb.H6d)}D_b(){if(this.JD){const zb=new v.a(!0);this.JD.mDa(zb)}}yX(){this.control.setFocus()}B2c(){this.control.update()}X2e(zb,
Qa=!1){this.D_b();this.control.dismiss(zb,Qa)}htn(zb){const Qa=ab.cGd().qK;zb=this.Hxa.$2b(zb,new Ra(Qa.clientWidth,Qa.scrollLeft,Qa.scrollWidth));this.control.jtn(zb)}dispose(){this.control.dispose();this.Wb.pe(F.a.cea).Ar(this.oY)}f$e(zb){B.ULS.shipAssertTag(4520074,308,!!this.control);B.ULS.shipAssertTag(4520075,308,!!this.control.Dyc);return this.g$e(this.control.Dyc.id,zb)}lBk(zb){const Qa=this.hDj(),yb=this.fDj();this.yD=this.gDj(zb,Qa,yb,this.k7,this.MHn)}$lf(){const zb=this.Wb.pe(F.a.cea);
zb.parent=3===l.AFrameworkApplication.ya.mode?u.AppFrame.iF:u.AppFrame.gWc;this.Wb.JMe(F.a.cea);zb.bindAction(this.oY,G.a.L9)}kS(){this.Mo.kS(F.a.cea);this.Mo.kS(F.a.oXa)}g$e(zb,Qa){return()=>{const yb=ab.cGd().ud.Nc.Eb(zb);this.lpa.u0b();if(!yb.isConnected)return B.ULS.sendTraceTag(4520076,308,10,"{0}",{["Error"]:"Unable to restore footnoteEndnote control"}),null;this.MZf(new K.a(yb,!0));return Qa}}static Fl(){const zb=new Oa(r.a.instance.resolve("Box4.SectionAlignedViewPositionProvider"),l.AFrameworkApplication.isRtl);
return new ab(w.FocusManager.instance(),z.App.xa.gv,ea.Xql,na.Zql,Y.Tql,zb,N.a.instance,r.a.instance.resolve("Box4.IPasteFloatieEventSource"),r.a.instance.resolve("Common.IAppSettingsManager"))}static cGd(){const zb=z.App.xa.jb.Jc;return zb&&zb.Ji?zb:null}static get instance(){return null!=ab.flg?ab.flg:ab.flg=ab.Fl()}}Object(D.a)(ab,"FootnoteEndnoteControlManager",null,[398])},1609:function(D,M,d){d.d(M,"a",function(){return f});d.d(M,"b",function(){return a});d.d(M,"c",function(){return l});var m=
d(2);const f=(r,w)=>{const v=RegExp("mailto:(.*)").exec(r.url);w.email=v&&2===v.length?v[1]:r.url;w.resolveState=r.Bx.charAt(35)===d(1691).ACommentFormatTranslator.bek?1:0},a=(r,w)=>{w.contentId=r.Bx},l=(r,w,v)=>{w.contentId=r.Bx;w.isCurrentUser=v.email===m.AFrameworkApplication.K.lb("UserPrincipalName")}},1615:function(D,M,d){d.d(M,"a",function(){return f});D=d(0);M=d(174);var m=d(111);class f extends M.a{constructor(){super();this.documentTypeConfidences=null;this.H_=Object.assign(new m.a,{T_:f.getTypeName(),
B_:f.getBaseTypes()})}static getTypeName(){return"AugLoop_DocumentTypeClassifier_DocumentTypeClassifierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(D.a)(f,"DocumentTypeClassifierAnnotation",M.a,[])},1618:function(D,M,d){d.d(M,"a",function(){return u});D=d(0);var m=d(2),f=d(84),a=d(8),l=d(43),r=d(96),w=d(65),v=d(633);class u{constructor(z,B,G,F,K,N){this.XAe=null;this.HUg=0;this.ld=F;this.te=B;this.d4=K;this.Iqe=G;this.Rjc=m.AFrameworkApplication.zZf();this.Nie=z.appSettings.ChromeClipboardAccessOperationTimeout;
this.rH=0;this.Vwj=N;this.fBj=z.$("EnableExternalPasteSupportOnMobileIsEnabled")}get PNa(){return this.d4.PNa}process(z,B){if(!this.rH)return this.s1m(B);if(1===this.rH)return this.prepareForPaste(z,B);if(2===this.rH)return this.rH=3,this.XAe(z,B);3===this.rH&&this.d4.mZi(z,B);return!1}s1m(z){let B=!0;this.fBj&&(B=!(z.iA&1));this.te.p2&&B||z.iA&512?(this.XAe=z.iA&2?Object(l.a)(this.d4,this.d4.paste,"paste"):Object(l.a)(this.d4,this.d4.lCi,"pasteInternal"),this.rH=2):(this.Rjc?(this.rH=1,this.HUg=
Date.now()):this.rH=2,this.XAe=Object(l.a)(this.d4,this.d4.paste,"paste"));v.a.Xxm(z);return!0}prepareForPaste(z,B){z=!0;if(this.Iqe.value.pEi())this.rH=2;else{const G=Date.now()-this.HUg;G>this.Nie&&(a.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",G),this.ld.Yb(r.a.Aka,{["Reason"]:w.a.dAi}),B.zQ&&(B.zQ.fail("Prepare for paste timed out",!1),f.Health.instance.recordQosError("PreparePasteTimedOut",[v.a.fZd],!1,!0,!0,!1,null)),B.failed=!0,z=!1,this.Vwj.Uun())}return z}}Object(D.a)(u,"ClipboardOperationPasteProcessor",
null,[565])},1619:function(D,M,d){d.d(M,"a",function(){return P});D=d(0);M=d(239);var m=d(2),f=d(84),a=d(57),l=d(106),r=d(8),w=d(120),v=d(72),u=d(1884),z=d(43),B=d(20),G=d(3),F=d(96),K=d(65),N=d(1051),H=d(19),J=d(54),L=d(1562),I=d(1620),R=d(633),C=d(166);class P extends M.a{constructor(W,X,V,Y,ca,fa,sa,ia,ea,da,ja,Ga,ya,ta,ua,Sa,ka,ha,Ca,Pa,Xa,qa,Ea,Ia,na,Na,Oa,Ra=!0){super();this.yha=this.dB=null;this.EK=this.nz=0;this.A9a=this.aFe=this.w8=this.Ef=null;this.NO=!1;this.XR=!0;this.wFg=!1;this.init(W);
this.ll("ClipboardOperation");this.Neb(ea,X,ca,fa,sa);this.ld=da;this.Ge=ja;this.te=Ga;this.Hc=ya;this.Hwg=ta;this.Jwg=ua;this.Iwg=Sa;this.$ie=ka;this.QNb=ha;this.aje=Ca;this.Rjc=ia;this.Gjc=Pa;this.oIa=Xa;this.OXj=Ra;this.vC=qa;this.Hd=Ea;this.sm=Ia;this.JD=na;this._context=Y;this.Kca=Na;this.mUb=Oa;sa&&Object(w.a)(87,sa)&&(this.w8=Object(v.a)(570,sa.ia(l.a.pra,null)));this.w8||(this.w8=this.Kca.o0c());this.Hmb=void 0===V||null===V?"NotAvailable":Object(u.a)(I.a,V);this.w8.xak(this.Hmb.split(", "));
W=this._context;if(this.mUb){if(!P.jih(W,this.$ie,this.ld,this.w8,Ra)){this.$q=8;this.finish();return}this.Ef=W.view;this.NO=3===this.Ef.JDb;this.nz=0;this.EK=V;this.A9a=ka.PNa}else{if(!W.view.Be){this.ld.Yb(F.a.zf,{["Reason"]:K.a.nFb});this.w8.fail("Not in interactive view",!0);this.$q=8;this.finish();return}this.Ef=W.view;if(!this.Ef.Cb){this.ld.Yb(F.a.zf,{["Reason"]:K.a.noSelection});this.w8.fail("No selection manager",!0);this.$q=8;this.finish();return}this.NO=3===this.Ef.JDb;this.nz=0;this.EK=
V;this.A9a=ka.PNa;if(Ra&&!(this.A9a&&this.A9a.kb&&this.A9a.length)){this.ld.Yb(F.a.zf,{["Reason"]:K.a.noSelection});this.w8.fail("No selection when one required",!0);this.$q=8;this.finish();return}}ka=H.SelectionEditor.Km(this.A9a.kb);ka=!(this.EK&16&&ka);ka=Ca.M8l(V,this.Rg)&&ka;1!==this.behavior&&ka||(ka||this.w8.fail("Clipboard operation disabled for selection",!0),this.$q=ka?32:8,this.Cna());!this.wFg&&this.te.ki&&(a.b("IPadCCP"),this.wFg=!0)}get Rg(){this.aFe||(this.aFe=J.a.UXb(this.A9a));return this.aFe}Faa(){super.Faa();
this.A9a=null}run(){this.nz||this.setup();1===this.nz&&this.process();2===this.nz&&this.teardownSync();3===this.nz&&this.teardownAsync();4===this.nz&&this.finish()}setup(){if(this.EK&256&&this.Rjc){this.YE||this.QNb.otk(this,this.EK,this.Hmb);this.YE.run();if(this.YE.inProgress)return;this.XR=this.YE.Ffa;this.Otd();if(!this.XR){this.w8.fail("No access to system clipboard",!0);this.$q=8;this.nz=4;this.dSd();return}}else r.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}; {3}",
this.EK,this.Hmb,this.te.WE,this.actionId);this.EK&32&&!this.Ge.eNd(this.Ef.Cb.Rg)?(r.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.ld.Yb(F.a.zf,{["Reason"]:K.a.E0e}),this.w8.fail("Cut not allowed",!0),this.Gjc.show(),this.$q=8,this.nz=4):(this.EK&16||this.EK&32)&&B.a.instance.J(3)&&this.vC.XOd(this.Ef.Cb.ib.kb)?(this.w8.fail("Selected content deleted in coauthoring",!0),this.Hd.SJb(),this.$q=8,this.nz=4):(this.EK&4096&&(this.JD.kbc(Object.assign(new N.a,{XMc:!0,DQ:this.Hmb})),this.sm.undo()),
this.aje.C5m(this.EK),!this.Ef.ud&&m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("WordEditorPasteFailuresImprovementIsEnabled")?(this.w8.fail("Interactive view has null target node",!0),this.$q=8,this.nz=4):(this.dB=this.Hc.Rc(15),this.dB.zl=this.actionId,this.dB.Db(this.Ef.ud),this.nz=1))}process(){if(!this.YE){r.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.EK,this.Hmb,this.te.WE);r.ULS.shipAssertTag(6305507,307,!this.yha);this.yha=new L.a(this._context,
this.EK,this.w8,this.e7,this.rD,void 0,this.te.WE,this.OXj,this.NO);let W;W=this.EK&65536?Object(z.a)(this.Hwg,this.Hwg.process,"process"):this.EK&64?Object(z.a)(this.Jwg,this.Jwg.process,"process"):this.EK&1?Object(z.a)(this.$ie,this.$ie.process,"process"):Object(z.a)(this.Iwg,this.Iwg.process,"process");this.EK&16&&this.Ef.Cb.Dva.xIh();this.oIa.create(this,W,this.yha).ll("ClipboardAction")}r.ULS.shipAssertTag(6305536,307,!!this.YE);this.YE.run();this.YE.inProgress||(this.Otd(),this.nz=this.ah?2:
3)}teardownSync(){this.yha.v6b&&(this.dB.zl=G.a.typing);this.yha.oNc&&this.dB.tCa(this.yha.wlf,this.yha.fDf);this.dB.dispose();this.$q=this.yha.failed?8:32;this.nz=4}teardownAsync(){if(this.YE){if(this.YE.run(),this.YE.inProgress)return}else if(this.yha.v6b&&(this.dB.zl=G.a.typing),this.dB.ODa(this),this.yha.oNc&&this.dB.tCa(this.yha.wlf,this.yha.fDf),this.dB.dispose(),this.cMe)return;this.$q=this.yha.failed?8:32;this.nz=4}finish(){this.JD.kbc(Object.assign(new N.a,{XMc:!1}));this.Cna();32===this.response?
r.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.EK,this.Hmb,this.te.WE):r.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.EK,this.Hmb,this.te.WE);this.Kca.Tda(this.w8);P.Wen&&this.Eum()}dSd(){const W=!!(this.EK&1),X=this._context.view;X&&R.a.dSd(W,X.Cb,this.te.WE)}Eum(){if(!(this.EK&4||this.EK&64)){var W=new Map;W.set("isCopy",
String.format("{0}",!!(this.EK&16)));W.set("isIPad",String.format("{0}",this.te.ki));f.Health.instance.recordKpiUsage(R.a.tjh,0,R.a.sUe,W);this.XR||(W=Object.assign(new C.a,{extendedProperties:W}),f.Health.instance.recordKpiFailure(R.a.tjh,R.a.Oqk,!0,!0,W))}}static get Wen(){null==P.QCe&&(P.QCe=!!m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("RecordCcpErrorDialogKpiIsEnabled"));return P.QCe}static LOf(W,X,V,Y){W&&W.Yb(F.a.zf,{["Reason"]:V});X&&X.fail(Y,!0)}static jih(W,X,V=null,Y=null,ca=
!0){return W.view.Be?W.view.Cb?!ca||X.PNa&&X.PNa.kb&&X.PNa.length?!0:(P.LOf(V,Y,K.a.noSelection,"Paste target is invalid"),!1):(P.LOf(V,Y,K.a.noSelection,"No selection manager"),!1):(P.LOf(V,Y,K.a.nFb,"Not in interactive view"),!1)}}P.QCe=null;Object(D.a)(P,"ClipboardOperation",M.a,[])},1620:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);var m;(function(f){f[f.paste=1]="paste";f[f.textOnly=2]="textOnly";f[f.overtype=4]="overtype";f[f.copy=16]="copy";f[f.deleteSelection=32]="deleteSelection";
f[f.move=64]="move";f[f.useSystemClipboard=256]="useSystemClipboard";f[f.forceInternalClipboard=512]="forceInternalClipboard";f[f.reformatPastedContent=4096]="reformatPastedContent";f[f.pasteAsPlainText=8192]="pasteAsPlainText";f[f.showPlaceholderGlossary=65536]="showPlaceholderGlossary";f[f.reformatPastedContentWithDesignerPaste=131072]="reformatPastedContentWithDesignerPaste"})(m||(m={}));Object(D.b)("ClipboardActionFlags",m)},1621:function(D,M,d){var m=this&&this.xO||(Object.create?function(a,
l,r,w){void 0===w&&(w=r);var v=Object.getOwnPropertyDescriptor(l,r);if(!v||("get"in v?!l.kH:v.writable||v.configurable))v={enumerable:!0,get:function(){return l[r]}};Object.defineProperty(a,w,v)}:function(a,l,r,w){void 0===w&&(w=r);a[w]=l[r]}),f=this&&this.__exportStar||function(a,l){for(var r in a)"default"===r||Object.prototype.hasOwnProperty.call(l,r)||m(l,a,r)};Object.defineProperty(M,"__esModule",{value:!0});f(d(1766),M);f(d(1767),M);D.exports.IntentIds||Object.defineProperty(D.exports,"IntentIds",
{enumerable:!0,get:function(){return D.exports.IntentIds}});D.exports.ObjectSchemaType||Object.defineProperty(D.exports,"ObjectSchemaType",{enumerable:!0,get:function(){return D.exports.ObjectSchemaType}});D.exports.ObjectSemantic||Object.defineProperty(D.exports,"ObjectSemantic",{enumerable:!0,get:function(){return D.exports.ObjectSemantic}});D.exports.SearchSuggestionAnnotation||Object.defineProperty(D.exports,"SearchSuggestionAnnotation",{enumerable:!0,get:function(){return D.exports.SearchSuggestionAnnotation}});
D.exports.SearchSuggestionSignal||Object.defineProperty(D.exports,"SearchSuggestionSignal",{enumerable:!0,get:function(){return D.exports.SearchSuggestionSignal}});D.exports.SequenceType||Object.defineProperty(D.exports,"SequenceType",{enumerable:!0,get:function(){return D.exports.SequenceType}})},1622:function(D,M,d){d.r(M);d.d(M,"FootnoteEndnoteDefaultContentInserter",function(){return K});D=d(0);var m=d(22),f=d(59),a=d(2),l=d(41),r=d(648),w=d(33),v=d(5),u=d(17),z=d(43),B=d(1160),G=d(856),F=d(1563);
class K{constructor(N,H,J,L,I=null){this.Xc=N;this.Owj=H;this.Ql=J;K.Kh=L;this.pyg=I||K.EIk}get lK(){return null!=this.Nmg?this.Nmg:this.Nmg=m.a.instance.resolve("Box4.IOutlineEditor")}RGk(N,H){var J=this.Xc.Ck();J.set(N);this.lK.Seb(J,null,!0);K.Kh.jJb(J.currentNode,this.Ql);N=l.OutlineElementNavigator.He(J);K.B7.e6d(H?Box4Intl.Box4Strings.L_StyleWordFootnoteText:Box4Intl.Box4Strings.L_StyleWordEndnoteText,N);J=this.pyg(J.currentNode);K.characterPropertiesEditor.replaceTextRange(J,K.hwh);this.Y3l(N,
H)}Y3l(N,H){var J=this.Owj(131073);J.setValue(v.a.gq,1===H?36:35);J.setValue(v.a.Cja,!0);J.setValue(u.a.E7,!0);const L=N.Nc.Gu(J,f.a.create());J=this.pyg(N);K.characterPropertiesEditor.Iea(J,I=>G.a.getInstance(I,L,!0),F.a.TLh(N,H))}static Fl(){return new K(new r.a,Object(z.a)(B.a.instance,B.a.instance.createInstance,"createInstance"),a.AFrameworkApplication.isRtl,m.a.instance.resolve("Box4.IOutlineElementEditor"))}static get B7(){return null!=K.Yog?K.Yog:K.Yog=m.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get characterPropertiesEditor(){return null!=
K.Ifg?K.Ifg:K.Ifg=m.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get instance(){return null!=K.slg?K.slg:K.slg=K.Fl()}static EIk(N){return w.a.Uc(N,0)}}K.hwh=" ";K.Kh=null;Object(D.a)(K,"FootnoteEndnoteDefaultContentInserter",null,[458])},1623:function(D,M,d){d.d(M,"a",function(){return r});D=d(0);var m=d(648),f=d(540),a=d(1504),l=d(1563);class r{constructor(w,v){this.lpa=v}aId(w,v,u){return(w=this.lpa.hTh(w.node,u?w.cpBegin:w.cpEnd,v))?w.a2():null}x0h(w,v){return(w=this.lpa.PCl(w.node,
w.cpBegin,v))?w.a2():null}static uHc(){return new r(f.a.instance,a.a.instance,new m.a,l.a.instance)}static get instance(){return null!=r.Rkg?r.Rkg:r.Rkg=r.uHc()}}Object(D.a)(r,"FootnoteEndnoteNavigator",null,[428])},1633:function(D,M,d){d.d(M,"a",function(){return r});D=d(0);var m=d(1684),f=d(2),a=d(40),l=d(22);class r{constructor(w,v,u,z,B,G){this.Ppa=w;this.Qpa=v;this.Lqe=u;this.XX=z;this.R8c=B;this.hNb=G}get W2i(){return!this.Qpa&&!this.Lqe}get uti(){return 2===this.hNb?CommonUIStrings.l_OICErrorC2ROneNoteOffer:
CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get nDh(){return CommonUIStrings.l_OICErrorMessageNoOffice}get M4h(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get heb(){return CommonUIStrings.l_OICErrorHelpLink}get m3h(){return"OICFailure"}get icon(){return 3}get Uod(){return 2===this.hNb?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get YJa(){return CommonUIStrings.l_DefaultDialogTitle}Hdn(w){this.Eti(w)}npm(w){this.Eti(w)}Eti(w){let v=
10;1===w?(l.a.instance.resolve("Common.IOfficeTrialExperience").wuf(this.hNb),v=3):2===w&&((!this.Lqe||this.Lqe(this.XX))&&this.Qpa&&m.a.instance.PJk(this.Qpa,this.Ppa,this.XX),v=5);(0===w||1===w)&&this.Ppa&&this.Ppa(this.XX);f.AFrameworkApplication.CXc(a.a.Szi,this.R8c,v);this.dispose()}dispose(){this.XX=this.Qpa=this.Ppa=null}}Object(D.a)(r,"AOICErrorDialogWithTrial",null,[10])},1682:function(D,M,d){D=d(0);var m=d(2),f=d(15),a=d(22),l=d(584),r=d(1500),w=d(1382),v=d(31);class u{constructor(na,Na=
null){this.JLj=na;this.FV=Na||r.a.Ocf(f.a.Evb,"")}get Wx(){return this.JLj}get Ic(){return this.FV}SWf(na){this.Ic.d++;return this.Wx.SWf(na)}Cdc(na){this.Ic.e++;return this.Wx.Cdc(na)}KF(na){this.Ic.f++;return this.Wx.KF(na)}Tjb(na){this.Ic.h++;return this.Wx.Tjb(na)}o3(na){this.Ic.i++;return this.Wx.o3(na)}r7(na){this.Ic.j++;return this.Wx.r7(na)}Gna(na){this.Ic.k++;return this.Wx.Gna(na)}Uaa(na){this.Ic.l++;return this.Wx.Uaa(na)}o5d(na){this.Ic.m++;return this.Wx.o5d(na)}c2a(na,Na=!1){this.Ic.n++;
return this.Wx.c2a(na,Na)}uif(){this.Ic.o++;return this.Wx.uif()}J_f(){this.Ic.p++;return this.Wx.J_f()}Is(na){this.Ic.q++;return this.Wx.Is(na)}kva(na){this.Ic.r++;return this.Wx.kva(na)}qdc(na){this.Ic.g++;return this.Wx.qdc(na)}SZc(na){return this.Wx.SZc(na)}Vjb(na){this.Ic.s++;return this.Wx.Vjb(na)}T5d(na){this.Ic.s++;return this.Wx.T5d(na)}v_e(na){this.Ic.ba++;return this.Wx.v_e(na)}Z4d(na){this.Ic.s++;return this.Wx.Z4d(na)}Ujb(na){this.Ic.s++;return this.Wx.Ujb(na)}pJb(na){this.Ic.t++;return this.Wx.pJb(na)}j6d(na){this.Ic.u++;
return this.Wx.j6d(na)}uga(na){this.Ic.v++;return this.Wx.uga(na)}JXf(na){this.Ic.bb++;return this.Wx.JXf(na)}TDa(na){return this.Wx.TDa(na)}j7(na){this.Ic.z++;return this.Wx.j7(na)}ISf(){return this.Wx.ISf()}vga(na,Na){this.Ic.w++;this.Ic.x++;return this.Wx.vga(na,Na)}$B(na){this.Ic.y++;return this.Wx.$B(na)}clearFormatting(){return this.Wx.clearFormatting()}clone(){return new u(this.Wx.clone(),this.Ic)}}Object(D.a)(u,"FormattingStewardUsageCollector",null,[619]);class z extends u{constructor(na,
Na=null){super(na,Na)}get M6(){return this.Wx}get Ws(){return this.M6.Ws}set Ws(na){this.M6.Ws=na}get textIndent(){return this.M6.textIndent}get marginLeft(){return this.M6.marginLeft}get efc(){return this.M6.efc}get $Ca(){return this.M6.$Ca}get lineSpacing(){return this.M6.lineSpacing}get LI(){return this.M6.LI}get leftIndent(){return this.M6.leftIndent}get zaa(){return this.M6.zaa}get paragraph(){return this.M6.paragraph}set paragraph(na){this.M6.paragraph=na}get IP(){return this.M6.IP}get kfc(){return this.M6.kfc}nae(na){return this.M6.nae(na)}k5f(na){return this.M6.k5f(na)}clone(){const na=
this.Wx.clone();return new z(na,this.Ic)}}Object(D.a)(z,"FormattingStewardUsageCollector",u,[620,619]);var B=d(11),G=d(64),F=d(312),K=d(845),N=d(41),H=d(211),J=d(92),L=d(42),I=d(59),R=d(372),C=d(147),P=d(16),W=d(84),X=d(58),V=d(17),Y=d(5),ca=d(44),fa=d(166),sa=d(514),ia=d(373),ea=d(20),da=d(116),ja=d(48),Ga=d(61),ya=d(194),ta=d(1556),ua=d(173),Sa=d(33),ka=d(1306),ha=d(675);class Ca{constructor(na,Na,Oa,Ra,ab,zb,Qa,yb,lb,Eb,bc=null){this.wD=this._paragraph=null;this.chd=0;this.$vg=this.dhd=null;this.s8=
0;this.Mrb=this.kfc=this.leftIndent=this.LI=this.jqc=this.$Ca=this._tabStops=this._marginLeft=this._textIndent=null;this.paragraph=na;this.og=Na;this.cS=Oa;this.tC=Ra;this.mx=ab;this.XPb=zb;this.Zha=Qa;this.EOb=yb;this.HRa=lb;this.Vob=Eb;bc?(v.a(4223818,307,!!bc.wD),this.wD=bc.wD.qra(this.paragraph),this.chd=bc.T$b,this.dhd=bc.YIf,bc.$Ca&&(this.$Ca=new ka.a,this.$Ca.afterSpacing.value=bc.$Ca.afterSpacing.value,this.$Ca.beforeSpacing.value=bc.$Ca.beforeSpacing.value),bc.lineSpacing&&(this.jqc=bc.lineSpacing.clone()),
this.s8=bc.s8,this.kfc=bc.kfc.clone(),this._textIndent=bc.textIndent,this._marginLeft=bc.marginLeft,this._tabStops=bc.efc,this.LI=bc.LI,this.leftIndent=bc.leftIndent,bc.zaa&&(this.Mrb=bc.zaa)):(this.wD=new ya.a(this.paragraph,0),this.wD.formatting=new ua.a(this.wD,I.a.nil),Na=Sa.a.iw(na),Na=this.mx.Ds(Na),this.HGn(Na),this.ITn(na)?(this.XPb.cIn(this.wD.formatting,Na),na.hasProperty(V.a.ai)?this.s8=na.getValue(V.a.ai):this.s8=0):this.s8=-1,this.chd=0,this.$Ca=this.dhd=null,this.Vob&&(this.$Ca=this.XPb.JAa(na),
this.jqc=this.XPb.eLa(na),this.LI=this.XPb.c3b(na),this.leftIndent=this.XPb.eT(na)),this.kfc=new R.DictionaryPropertySet)}get paragraph(){return this._paragraph}set paragraph(na){v.a(4223816,307,!!na&&B.ParagraphReader.oc(na));this._paragraph=na}get IP(){return this.wD.formatting}get T$b(){return this.chd}get YIf(){return this.dhd}get kB(){return this.$vg}get Ws(){return this.s8}set Ws(na){v.a(4223817,307,1===na||2===na||3===na||6===na);this.s8=na}get textIndent(){return this._textIndent}get marginLeft(){return this._marginLeft}get efc(){return this._tabStops}get lineSpacing(){return this.jqc}get zaa(){return this.Mrb}get pc(){return this.tC}HGn(na){const Na=
this.mx.language(na);Na&&this.og.TWf(this.wD.formatting,Na,0,na.cache.LCb,!1)}ITn(na){if(!ea.a.instance.J(10))return!0;na=this.pc.tf(this.pc.yo(na));return na===ja.StyleReader.d4c||na===ja.StyleReader.wordStyleIdNormal||na===ja.StyleReader.nmb||na===ja.StyleReader.styleIdNormal}SWf(na){(na=l.a.lg(na))&&this.og.C5d(this.wD.formatting,na.LCID);return!0}Cdc(){return!1}KF(na){this.og.KF(this.wD.formatting,na);return!0}Tjb(na){this.og.setItalic(this.wD.formatting,na);return!0}o3(na){this.og.o3(this.wD.formatting,
na);return!0}r7(na){this.og.r7(this.wD.formatting,na);return!0}Gna(na){this.og.Gna(this.wD.formatting,na);return!0}Uaa(na){this.og.Uaa(this.wD.formatting,na);return!0}o5d(na){if(0>=na)return!1;this.og.Pv(this.wD.formatting,na);return!0}c2a(na,Na){if(!na||""===na)return!1;if(({YHh:Oa}=C.FontUtils.Gcj(na)).returnValue)return this.og.k_(this.wD.formatting,Oa.fontName),!0;var Oa=!1;const Ra=C.FontUtils.qNa(na);Na&&this.bgb(Ra,this.Zha)&&(this.Zha.Fda(na),Oa=!0);if(this.bgb(Ra,this.EOb)||this.bgb(Ra,this.HRa))Oa=
!0;Oa&&this.og.k_(this.wD.formatting,Ra);return Oa}bgb(na,Na){return!!Na&&Na.isEnabled&&Na.bgb(na)}uif(){this.og.V0h(this.wD.formatting);return!0}J_f(){this.og.X3i(this.wD.formatting);return!0}Is(na){var {Box4PasteSteward:Na}=d(1476);if(null===na||""===na)return!1;na=Na.Iwb(na);Na=null;this.zaa&&this.zaa.hasOwnProperty(Y.a.listLevel.id.toString())&&(Na=this.zaa[Y.a.listLevel.id.toString()]);this.og.Is(this.wD.formatting,na,Na);return!0}kva(na){const {Box4PasteSteward:Na}=d(1476);if(!na||""===na||
!Ca.yOl().contains(na))return!1;this.og.kva(this.wD.formatting,Na.Iwb(na));return!0}qdc(na){this.og.qdc(this.wD.formatting,na);return!0}SZc(na){let Na=0;switch(P.a.mh(na)){case "small-caps":Na=1;break;case "uppercase":Na=2}this.og.$l(this.wD.formatting,ca.a.capitalization,Na);return!0}j7(na){const {Box4PasteSteward:Na}=d(1476);if(!na||""===na)return!1;this.kfc.setValue(V.a.NH,parseInt(Na.Iwb(na),16));return!0}Ujb(na){return 0>=na?!1:this.T5d(this.pc.fYh(na))}Vjb(na){this.clearFormatting();this.chd=
na;return!0}v_e(na){var {Box4PasteSteward:Na}=d(1476),Oa=new Map;Oa.set("Source","CreateStyleCCP_FormattingSteward");W.Health.instance.recordKpiUsage(da.a.kkj,0,da.a.vB,Oa);Oa=Ga.a.mIl(na);na=[];na.push(Oa);(na=Ga.a.zMe(na,this.paragraph))?(Na.Xec=this.pc.Ip(),v.b(593078085,3017,50,"Custom style created via paste.")):(Na=new Map,Na.set("Source","CreateStyleCCP_FormattingSteward"),Na.set("IsStyleNull",(!Oa).toString()),Na=Object.assign(new fa.a,{extendedProperties:Na}),W.Health.instance.recordKpiFailure(da.a.kkj,
"UnableToCreateStyle",!1,!0,Na));return na}T5d(na){const {Box4PasteSteward:Na}=d(1476);return na&&0<na.length&&Na.Xec&&Na.Xec.uh(na)?(this.dhd=na,!0):!1}Z4d(na){const {Box4PasteSteward:Na}=d(1476);return na&&0<na.length&&Na.Xec&&Na.Xec.uh(na)?(this.$vg=na,!0):!1}k5f(na){if(this.kB){na=this.pc.Nx(na);if(!na)return v.a(41968715,307,!1),!1;(na=na.uh(this.kB))&&this.og.gkb(this.wD.formatting,na);return!0}return!1}vga(){return!1}$B(na){if(!na)return!1;const Na=parseFloat(P.a.substring(na,0,P.a.mh(na).indexOf("px")));
if(!isNaN(Na))return this.jqc=new ha.a(3,X.a.Ty(Na,1)),!0;na=parseFloat(P.a.substring(na,0,P.a.mh(na).indexOf("%")));return isNaN(na)?!1:(this.jqc=new ha.a(2,na/100),!0)}pJb(na){let Na=0;if(!na||""===na)return!1;switch(na){case "left":Na=1;break;case "center":Na=2;break;case "right":Na=3;break;case "justify":Na=6}if(!Na)return!1;this.Ws=Na;return!0}j6d(na){this._textIndent=na;return!0}uga(na){this._marginLeft=na;return!0}JXf(na){this._tabStops=na;return!0}TDa(na){this.Mrb=JSON.parse(na);return this.zaa?
!0:!1}clearFormatting(){this.wD.formatting=new ua.a(this.wD,I.a.nil);return!0}ISf(){this.s8=0;return!0}nae(na){var {Box4PasteSteward:Na}=d(1476);if(!ea.a.instance.J(10))return!1;if(0<this.T$b&&Na.J0a[this.T$b]){v.a(4223819,307,1<=this.T$b);v.a(4223820,307,7>=this.T$b);Na=this.pc.Nx(na);if(!Na)return v.a(4223821,307,!1),!1;Na=Na.uh(d(1476).Box4PasteSteward.J0a[this.T$b]);this.cS.hM(Na,na,!1);return!0}if(this.YIf){Na=this.pc.Nx(na);if(!Na)return v.a(41968716,307,!1),!1;Na=Na.uh(this.YIf);this.cS.hM(Na,
na,!1);return!0}return!1}clone(){return new Ca(this.paragraph,this.og,this.cS,this.tC,this.mx,this.XPb,this.Zha,this.EOb,this.HRa,this.Vob,this)}static yOl(){Ca.OY||(Ca.OY=new sa.a(ia.a.Pj()),Ca.OY.add(ta.a.yellow),Ca.OY.add(ta.a.oji),Ca.OY.add(ta.a.Zbh),Ca.OY.add(ta.a.$Ih),Ca.OY.add(ta.a.blue),Ca.OY.add(ta.a.red),Ca.OY.add(ta.a.sri),Ca.OY.add(ta.a.teal),Ca.OY.add(ta.a.green),Ca.OY.add(ta.a.purple),Ca.OY.add(ta.a.eoi),Ca.OY.add(ta.a.Oti),Ca.OY.add(ta.a.gray),Ca.OY.add(ta.a.F4i),Ca.OY.add(ta.a.black));
return Ca.OY}}Ca.OY=null;Object(D.a)(Ca,"FormattingSteward",null,[620,619]);class Pa{t5f(){return!1}Nif(na){return na}Sif(){}TDa(){}I5d(){}ANd(){return!1}get yOd(){return!1}$B(){}vga(){}b6d(){}get d2i(){return!1}}Object(D.a)(Pa,"NoOpPasteStewardBridge",null,[591]);var Xa=d(79);class qa{constructor(na,Na){this.zKm=na;this.AKm=Na||"Normal"}}Object(D.a)(qa,"NoteTagInfoBox4",null,[]);const Ea=na=>{const Na=new Xa.a;for(const Oa of na)na=new qa(Oa.zKm,Oa.AKm),Na.add(na);return Na};d.d(M,"a",function(){return Ia});
class Ia{constructor(na,Na,Oa=null,Ra=null){this.oal=m.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.bUg=0;this.Bc=na;this.I4=Na;this.c0=Ra||new Pa;this.Ic=Oa||r.a.Ocf(f.a.Evb,"")}get characterPropertiesEditor(){return null!=this.zfg?this.zfg:this.zfg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get fontService(){return null!=this.wig?this.wig:this.wig=a.a.instance.Pa("Box4.IFontService")}get Hza(){return null!=this.Agg?this.Agg:this.Agg=a.a.instance.Pa("Box4.CustomFontService")}get XZk(){return null!=
this.$gg?this.$gg:this.$gg=a.a.instance.Pa("Box4.IEmbeddedFontService")}reset(){}get PCc(){return this.Obf(!1)}Obf(na){v.a(4223770,307,L.OutlineElementReader.Nh(this.Bc));const Na=N.OutlineElementNavigator.He(this.Bc);N.OutlineElementNavigator.ae(this.Bc);v.a(4223771,307,!!Na&&B.ParagraphReader.oc(Na));na=new Ca(Na,Ia.ui,Ia.ZQ,Ia.pc,Ia.E9e,Ia.Nbl,this.fontService,this.Hza,this.XZk,this.oal,void 0,na);return new z(na,this.Ic)}saa(){}HCa(){}Xhb(){}lua(){}DCa(){}uNa(){}tNa(){}FF(){}EF(){}Uhb(){}Thb(){}zNa(){}r0a(){}KCa(){}ICa(){}yNa(){}JCa(){}u0a(){}j9b(na){L.OutlineElementReader.Nh(this.Bc)?
(Ia.eh.cta(this.Bc,!0),N.OutlineElementNavigator.Rr(this.Bc,!1,!1)):J.OutlineReader.rw(this.Bc)?H.OutlineNavigator.K6(this.Bc)?na?(this.Bc.Fg(),Ia.lK.m5(this.Bc,!1)):Ia.eh.MHb(this.Bc):Ia.lK.m5(this.Bc,!1):v.a(8128524,307,!1,"Unexpected node type {0} encountered",this.Bc.Se)}$Hc(na){let Na=null;if(na&&na.T6&&na.cultureName)try{Na=Object.assign(new K.a,{languageId:l.a.lg(na.cultureName).LCID})}catch(Oa){v.a(8128526,307,!1,"Setting up culture {0} encountered {1}",na.cultureName,Oa)}Na||null==this.I4||
(Na=Object.assign(new K.a,{languageId:this.I4}));return Na}get aU(){return this.bUg}set aU(na){this.bUg=na}brd(){}Z$d(){}AVe(){}get oZb(){return!1}get txb(){return!1}Qpm(na){let Na=1;if(na.Gci){var Oa=0;switch(na.listStyleType){case 1:Na=0;break;case 7:Na=1;break;case 8:Na=2;break;case 9:Na=3;break;case 10:Na=4;break;case 11:Na=5}}else switch(Oa=1,na.listStyleType){case 1:Na=0;break;case 3:Na=1;break;case 4:Na=2;break;case 5:Na=3}let Ra;Oa=(Ra=G.ListReader.lZ)?F.a.wP(Oa,Na,Ea(na.Jma),na.listId,na.listLevel,
na.levelText,na.font):F.a.wP(Oa,Na,Ea(na.Jma));3!==na.sr&&(Oa.G3=na.sr);na.Gci&&!na.K9h&&(Oa.Qz=Ra&&0<na.listId&&0<=na.listLevel&&!na.aac?na.Iec:na.zNk);!Oa.qr||3!==Oa.listStyle&&5!==Oa.listStyle||(Oa.Ws="right");w.a.yNc&&((na=na.hvf)&&Oa.propertySet.ys(na),Oa.r1b=!0);this.c0.I5d(this.Bc);return Oa}raa(){}oaa(){}qaa(){}paa(){}naa(){}maa(){}static get eh(){return null!=Ia.eng?Ia.eng:Ia.eng=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get lK(){return null!=Ia.Tmg?Ia.Tmg:Ia.Tmg=a.a.instance.resolve("Box4.IOutlineEditor")}static get ui(){return null!=
Ia.$ig?Ia.$ig:Ia.$ig=a.a.instance.resolve("Box4.IFormattingEditor")}static get ZQ(){return null!=Ia.lrg?Ia.lrg:Ia.lrg=a.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get pc(){return null!=Ia.Rrg?Ia.Rrg:Ia.Rrg=a.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get E9e(){return null!=Ia.bjg?Ia.bjg:Ia.bjg=a.a.instance.resolve("Box4.IFormattingReader")}static get Nbl(){return null!=Ia.cjg?Ia.cjg:Ia.cjg=a.a.instance.resolve("Box4.Actors.IFormattingStewardBridge")}}Ia.Cf=null;Object(D.a)(Ia,
"Box4PasteStewardBase",null,[600,601,577])},1684:function(D,M,d){D=d(0);var m=d(43),f=d(8),a=d(2),l=d(40),r=d(355),w=d(22);class v{constructor(L,I,R,C){this.ixe=null;this.R8c=C;this.Ppa=L;this.Qpa=I;this.XX=R;this.IZg=this.FEb.zRn;L=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.uKj=L[0];this.tKj=L[1]}get FEb(){return this.ixe||(this.ixe=w.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get heb(){return CommonUIStrings.l_OICErrorHelpLink}get s_c(){return this.IZg}get Eni(){return this.uKj}get Dni(){return this.tKj}get Cni(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.IZg?
3:2}get LEc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get mvd(){return!!this.Qpa}get MEc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get YJa(){return CommonUIStrings.l_DefaultDialogTitle}uOf(L){this.jSc(L)}Xuf(L){this.jSc(L)}jSc(L){let I=10;this.Qpa&&1===L&&(this.Qpa(this.XX),I=1);this.Ppa&&this.Ppa(this.XX);this.MQ(I)}vFb(){r.Redirect.showHelp("OICFailure");this.MQ(2)}rDf(){this.FEb.Oii();this.MQ(4)}MQ(L){f.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.R8c,L);a.AFrameworkApplication.CXc(l.a.Qzi,this.R8c,L)}dispose(){this.XX=this.Ppa=this.Qpa=null}}Object(D.a)(v,"AOICErrorDialog",null,[10]);var u=d(28),z=d(141);class B extends v{constructor(L,I,R,C){super(L,I,R,C);this.L7a=this.wE=null;L=document.createElement("span");L.id="errorMessageText";L.innerText=this.errorMessage;L.appendChild(document.createElement("br"));L.appendChild(document.createElement("br"));this.wE=document.createElement("a");this.wE.href="#";this.wE.innerText=this.heb;L.appendChild(this.wE);
u.a.addHandler(this.wE,"click",Object(m.a)(this,this.vFb,"oicErrorHelpLinkHandler"));I=new z.StandardDialog;I.kg=this.id;this.s_c?(R=document.createElement("span"),C=document.createElement("span"),R.innerText=this.Eni,C.innerText=this.Dni,this.L7a=document.createElement("a"),this.L7a.href="#",this.L7a.innerText=this.Cni,L.appendChild(document.createElement("br")),L.appendChild(R),L.appendChild(this.L7a),L.appendChild(C),u.a.addHandler(this.L7a,"click",Object(m.a)(this,this.rDf,"oicErrorMacOfferLinkHandler"))):
this.mvd&&(L.appendChild(document.createElement("br")),L.appendChild(document.createElement("br")),R=document.createElement("span"),R.innerText=this.LEc,L.appendChild(R));this.mvd?(I.Ed=1,I.We(1,this.MEc)):I.Ed=0;I.Lv(this.YJa,null,this.icon,Object(m.a)(this,this.Xuf,"legacyOICErrorDialogHandler"),L);I.m3("errorMessageText")}dispose(){this.wE&&(u.a.removeHandler(this.wE,"click",Object(m.a)(this,this.vFb,"oicErrorHelpLinkHandler")),this.wE=null);this.L7a&&(u.a.removeHandler(this.L7a,"click",Object(m.a)(this,
this.rDf,"oicErrorMacOfferLinkHandler")),this.L7a=null);super.dispose()}}Object(D.a)(B,"OICErrorDialog",v,[]);class G{constructor(L,I,R){this.Ppa=I;this.Qpa=L;this.XX=R}get id(){return"OICErrorDialogWithDownload"}get oDh(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get heb(){return CommonUIStrings.l_OICErrorHelpLink}get LEc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get MEc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get YJa(){return CommonUIStrings.l_DefaultDialogTitle}uOf(L){this.jSc(L)}Xuf(L){this.jSc(L)}jSc(L){let I=
10;1===L&&(this.Qpa(this.XX),I=1);this.Ppa&&this.Ppa(this.XX);this.MQ(I)}vFb(){r.Redirect.showHelp("OICFailure");this.MQ(2)}MQ(L){a.AFrameworkApplication.CXc(l.a.Rzi,3,L)}dispose(){this.XX=this.Qpa=this.Ppa=null}}Object(D.a)(G,"AOICErrorDialogWithDownload",null,[10]);class F extends G{constructor(L,I,R){super(L,I,R);this.wE=null;L=document.createElement("span");L.id="errorMessageText";L.innerText=this.oDh;L.appendChild(document.createElement("br"));L.appendChild(document.createElement("br"));this.wE=
document.createElement("a");this.wE.href="#";this.wE.innerText=this.heb;L.appendChild(this.wE);u.a.addHandler(this.wE,"click",Object(m.a)(this,this.vFb,"oicErrorHelpLinkHandler"));L.appendChild(document.createElement("br"));L.appendChild(document.createElement("br"));I=document.createElement("span");I.innerText=this.LEc;L.appendChild(I);I=new z.StandardDialog;I.kg=this.id;I.Ed=1;I.We(1,this.MEc);I.Lv(this.YJa,null,this.icon,Object(m.a)(this,this.Xuf,"legacyOICErrorDialogHandler"),L);I.m3("errorMessageText")}dispose(){this.wE&&
(u.a.removeHandler(this.wE,"click",Object(m.a)(this,this.vFb,"oicErrorHelpLinkHandler")),this.wE=null);super.dispose()}}Object(D.a)(F,"OICErrorDialogWithDownload",G,[]);var K=d(153);class N extends v{constructor(L,I,R,C){super(L,I,R,C);I={["errorMessage"]:this.errorMessage};I.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.heb,["onExecute"]:P=>{this.vFb(P)}};this.s_c?(I.macOfficePreLinkText=this.Eni,I.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.Cni,
["onExecute"]:P=>{this.rDf(P)}},I.macOfficePostText=this.Dni):this.mvd&&(I.errorFileDownloadOffer=this.LEc);L=new K.a(!1,!1,!0);this.mvd?(L.Ed=1,L.We(1,this.MEc)):L.Ed=0;L.kg=this.id;I={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:I};L.Zh(this.YJa,Object(m.a)(this,this.uOf,"reactOICErrorDialogHandler"),I)}}Object(D.a)(N,"ReactOICErrorDialog",v,[]);class H extends G{constructor(L,I,R){super(L,I,R);I={["errorMessage"]:this.oDh,["errorFileDownloadOffer"]:this.LEc};I.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.heb,["onExecute"]:C=>{this.vFb(C)}};L=new K.a(!1,!1,!0);L.Ed=1;L.We(1,this.MEc);L.kg=this.id;I={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:I};L.Zh(this.YJa,Object(m.a)(this,this.uOf,"reactOICErrorDialogHandler"),I)}}Object(D.a)(H,"ReactOICErrorDialogWithDownload",G,[]);d.d(M,"a",function(){return J});class J{constructor(){this.Hpa=!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Sb.zA}OJk(L,I,R){this.Hpa?new N(L,I,null,R):new B(L,I,null,R)}PJk(L,
I,R){this.Hpa?new H(L,I,R):new F(L,I,R)}QJk(L,I,R,C,P){const {ReactOICErrorDialogWithTrial:W}=d(1782),{OICErrorDialogWithTrial:X}=d(1783);this.Hpa?new W(L,I,R,null,C,P):new X(L,I,R,null,C,P)}static get instance(){return J._instance||(J._instance=new J)}}J._instance=null;Object(D.a)(J,"OICErrorDialogFactory",null,[984])},1685:function(D,M,d){d.r(M);D=d(0);var m=d(332),f=d(1764),a=d(922),l=d(372),r=d(2),w=d(59),v=d(22),u=d(104),z=d(85),B=d(68),G=d(1412),F=d(127),K=d(37),N=d(15),H=d(274),J=d(106),L=
d(8),I=d(244),R=d(120),C=d(72),P=d(320),W=d(14),X=d(33),V=d(3),Y=d(9),ca=d(128),fa=d(539),sa=d(54),ia=d(1619),ea=d(1618),da=d(633),ja=d(239);class Ga extends ja.a{constructor(qa,Ea,Ia,na,Na,Oa){super();this.init(qa);this.ll("DummyClipboardOperation");this.Neb(r.AFrameworkApplication.ya,Ea,na,Na,Oa);this._context=Ia;this.$q=8;this.Cna()}run(){this.e7a=!0;this.iZc(this._context);this.Y0a();this.$q=32}}Object(D.a)(Ga,"DummyClipboardOperation",ja.a,[]);ja=d(1528);class ya extends ja.a{constructor(qa,
Ea,Ia,na,Na){super(qa,Ea,Na);this.Xj=Ia;this.JFe=na}ugc(qa){let Ea;if(this.cP&&!qa)return L.ULS.sendTraceTag(594408836,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,Ura:null};Ea=null;if(this.JFe&&!this.cP){const Ia=this.properties.ia(J.a.rCi,"");Ia&&(Ea=this.Xj.rib(Ia))}Ea||(Ea=this.Xj.rib(qa));return{returnValue:!0,Ura:Ea}}}Object(D.a)(ya,"HtmlStringImportStrategy",ja.a,[]);var ta=d(1765);class ua extends ta.a{constructor(qa,Ea,Ia,na,Na){super(qa,Ea,Ia,na,Na)}RUh(){return this.properties.ia(J.a.eac,
"")}ugc(qa){r.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IWacWordUseClipboardDataHelperInMultiLineImportSettings");if(this.YZg){if(this.Xj)return qa=this.Xj.kJf(qa,!0),{returnValue:!0,Ura:qa};L.ULS.sendTraceTag(592269660,307,10,"_clipboardDataHelper should not be null")}return super.ugc(qa)}WPc(qa){qa=super.WPc(qa);return qa.length&&" "!==qa?qa:"\u00a0"}}Object(D.a)(ua,"MultiLinePlainTextImportStrategy",ta.a,[]);class Sa extends ja.a{constructor(qa,Ea,Ia){super(qa,Ea,Ia)}ugc(qa){({ClipboardActor:Ea}=
d(1685));if(this.cP&&!qa)return L.ULS.sendTraceTag(594408834,307,10,"No htmlDomContent"),{returnValue:!1,Ura:null};var Ea=Ea.t1m;Ea.innerText=qa;return{returnValue:!0,Ura:Ea}}}Object(D.a)(Sa,"PlainTextImportStrategy",ja.a,[]);var ka=d(96),ha=d(65);class Ca{constructor(qa){this.zta=this.qrf=!1;this.Ica=qa}pEi(){this.qrf||(this.qrf=!0,this.zta=!1,this.Ica.prepareForPaste(()=>{this.zta=!0}));return this.zta}Rbj(){this.qrf=!1;const qa=this.Ica.paste();return qa?qa.hasChildNodes()?{returnValue:!0,xvd:qa}:
(L.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),Ca.Lc.Yb(ka.a.J_,{["Reason"]:ha.a.J6e}),{returnValue:!1,xvd:qa}):(L.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),Ca.Lc.Yb(ka.a.zyb,{["Reason"]:ha.a.q2f}),{returnValue:!1,xvd:qa})}static get Lc(){return F.a.instance}}Object(D.a)(Ca,"SystemClipboardImportStrategy",null,[571]);var Pa=d(278);d.d(M,"ClipboardActor",function(){return Xa});class Xa{constructor(qa,Ea,Ia,na,Na,Oa,Ra,ab,zb,Qa,yb,lb,Eb,bc,Pb,Va,oa,pa){this.D6c=null;
this.lHa=0;this.wad=this.Awc=!1;this.mnb=m.a.On;this.K_c=()=>{const Ya=Array(1);Ya.push("PasteRecoveryFloatie");var Ja=this.Exa.$Ka();Ja=Object.assign(new f.a,{x:Ja.x,y:Ja.y});this.Wv.showFloatie(Ja,Ya,1);return 32};this.iBb=()=>{this.Wv.EZ&&this.Wv.Vu();return 32};this.VGi=(Ya,Ja,nb,Bb,mb)=>{if(1===nb)return 32;mb[a.a.On]=!1;return 32};this.rYk=(Ya,Ja,nb,Bb,mb,Qb)=>{L.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var Vb=Qb.DataTransfer;Qb=Vb.getData("text/html");Vb=Vb.getData("text/plain");
let mc=!1;const ob=new l.DictionaryPropertySet;0<Qb.length?(L.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),ob.setValue(J.a.$T,Qb),mc=!0):0<Vb.length&&(L.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),ob.setValue(J.a.eac,Vb),mc=!0);if(mc){const cb=this.iz.J(Ja);return this.dud.create(Ya,Ja,cb,new I.a(()=>this.hDc(cb,ob)),nb,Bb,mb,ob)}return null};this.INf=(Ya,Ja,nb,Bb,mb)=>{if(Ja="object"===typeof mb?mb:null)this.nUb?this.FFn(Ya,this.lHa,
Ja):Ya===V.a.u0d?(Ya=this.lHa!==V.a.reformatPastedContent&&this.lHa!==V.a.jOa&&this.lHa!==V.a.Pua,Ja[this.mnb]=this.lHa===V.a.reformatPastedContent||Ya):Ya===V.a.v0d?Ja[this.mnb]=this.lHa===V.a.jOa:Ya===V.a.ENf&&(Ja[this.mnb]=this.lHa===V.a.Pua);return 32};this.XV=(Ya,Ja,nb,Bb,mb,Qb)=>{if(r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)){if((r.AFrameworkApplication.protectFile||r.AFrameworkApplication.fO)&&!r.AFrameworkApplication.j0b)return new Ga(Ya,
Ja,nb,Bb,mb,Qb)}else if(r.AFrameworkApplication.protectFile)return new Ga(Ya,Ja,nb,Bb,mb,Qb);if(Pa.a.Jla(nb)&&Pa.a.rCb())return new Ga(Ya,Ja,nb,Bb,mb,Qb);let Vb=this.iz.J(Ja);1!==Bb&&Vb&1&&(this.lHa=Ja);if(1!==Bb){var mc=Object(R.a)(87,Qb)?Qb:null;Qb?(Vb&1&&(this.D6c=mc),mc=mc?mc.ia(J.a.DQ,0):0,Ja===V.a.paste&&mc===V.a.wVa?Vb=this.iz.J(V.a.u1):Ja===V.a.V6&&mc===V.a.aab&&(Vb=this.iz.J(V.a.gZd))):!Qb&&Vb&4096&&(Qb=this.D6c,mc=Object(R.a)(87,Qb)?Qb:null)&&(mc=mc.ia(J.a.$Tc,w.a.nil),L.ULS.sendTraceTag(575255109,
307,50,"Reformatting operation occurred. CorrelationId: {0}",mc))}return this.dud.create(Ya,Ja,Vb,new I.a(()=>this.hDc(Vb,Qb)),nb,Bb,mb,Qb)};this.y7m=(Ya,Ja,nb,Bb,mb)=>this.KTe(Ya,Ja,nb,mb);this.x7m=(Ya,Ja,nb,Bb,mb)=>this.KTe(Ya,Ja,nb,mb);this.w7m=(Ya,Ja,nb,Bb,mb)=>this.KTe(Ya,Ja,nb,mb);this.$Td=(Ya,Ja,nb,Bb,mb,Qb)=>{Qb=X.a.Uc(sa.a.instance.ib.kb.Qa.node,Qb);return this.XV(Ya,Ja,nb,Bb,mb,Qb)};this.Zwj=qa;this.Ica=Ea;this.ld=Ia;this.Xj=na;this.ga=Oa;this.a7c=Qa;this.QNb=yb;this.Ud=lb;this.$f=Eb;this.Wb=
zb;this.mUb=bc;this.nUb=Pb;this.Exa=Va;this.Wv=oa;this.fHa=pa;ab&&(this.Awc=ab.$("UseClipboardDataHelperInMultiLineImportIsEnabled"),this.wad=this.nUb&&ab.$("HandleCtrlShiftVAsPasteTextOnlyIsEnabled"));this.iz=new P.a;this.iz.Z(V.a.paste,257);this.iz.Z(V.a.V6,8449);this.iz.Z(V.a.u1,1);this.iz.Z(V.a.cZa,1);this.iz.Z(V.a.cvb,1);this.iz.Z(V.a.Bya,1);this.iz.Z(V.a.XLd,513);this.iz.Z(V.a.reformatPastedContent,4097);this.iz.Z(V.a.jOa,12289);this.iz.Z(V.a.Pua,131073);this.iz.Z(V.a.rJf,7);this.iz.Z(V.a.jCi,
1);this.iz.Z(V.a.gZd,8193);this.iz.Z(V.a.copy,272);this.iz.Z(V.a.$yc,16);this.iz.Z(V.a.cut,304);this.iz.Z(V.a.PSe,48);this.iz.Z(V.a.ZTd,64);this.iz.Z(V.a.$Td,64);this.iz.Z(V.a.showPlaceholderGlossary,65536);this.iz.Z(V.a.a4e,1);this.wad&&this.iz.Z(V.a.wib,this.iz.J(V.a.gZd))}get nii(){return this.lHa}set nii(qa){this.lHa=qa}get EPa(){return null!=this.rpg?this.rpg:this.rpg=v.a.instance.Pa("Box4.Clipboard.ISystemClipboardAccessManager")}get telemetry(){return null!=this.Lpg?this.Lpg:this.Lpg=v.a.instance.Pa("Common.Utils.Telemetry.ITelemetry")}get dud(){return this.Zwj.value}get $2n(){return this.Ica}Vb(){this.ga.gb(V.a.dan,
W.a.application,this.VGi,97);this.ga.gb(V.a.ean,W.a.application,this.VGi,97);this.ga.gb(V.a.u0d,W.a.application,this.INf,97);this.ga.gb(V.a.v0d,W.a.application,this.INf,97);this.ga.gb(V.a.ENf,W.a.application,this.INf,97);this.ga.jS(V.a.PSe,W.a.view,this.XV,1028);this.ga.d$a(V.a.$yc,W.a.view,this.XV);this.ga.jS(V.a.a4e,W.a.view,this.rYk,1028);this.ga.jS(V.a.u1,W.a.view,this.XV,1028);this.ga.jS(V.a.cZa,W.a.view,this.XV,1028);this.ga.jS(V.a.cvb,W.a.view,this.XV,1028);this.ga.jS(V.a.Bya,W.a.view,this.XV,
1028);this.mUb&&this.ga.gb(V.a.wVa,W.a.view,this.w7m,1028);this.nUb&&this.ga.gb(V.a.aab,W.a.view,this.x7m,1028);this.ga.jS(V.a.paste,W.a.view,this.XV,1028);this.ga.jS(V.a.V6,W.a.view,this.XV,1028);this.ga.jS(V.a.gZd,W.a.view,this.XV,1028);this.ga.jS(V.a.jCi,W.a.view,this.XV,1028);this.ga.jS(V.a.rJf,W.a.view,this.XV,1028);this.ga.jS(V.a.reformatPastedContent,W.a.view,this.XV,1028);this.ga.jS(V.a.jOa,W.a.view,this.XV,1028);this.ga.pa(V.a.XHb,W.a.view,u.ActionManager.Nf);this.ga.pa(V.a.xCi,W.a.view,
u.ActionManager.Nf);this.ga.pa(V.a.uCi,W.a.view,u.ActionManager.Nf);this.ga.pa(V.a.vCi,W.a.view,u.ActionManager.Nf);this.ga.pa(V.a.wCi,W.a.view,u.ActionManager.Nf);this.ga.pa(V.a.tCi,W.a.view,u.ActionManager.Nf);this.ga.d$a(V.a.ZTd,W.a.view,this.XV);this.ga.d$a(V.a.$Td,W.a.view,this.$Td);this.ga.d$a(V.a.XLd,W.a.view,this.XV);this.ga.d$a(V.a.showPlaceholderGlossary,W.a.view,this.XV);this.wad&&(this.ga.gb(V.a.cYb,W.a.view,this.y7m,1028),this.ga.jS(V.a.wib,W.a.view,this.XV,1028));this.ga.pa(V.a.Iuh,
W.a.view,u.ActionManager.Nf);this.ga.pa(V.a.hvh,W.a.view,u.ActionManager.Nf);this.fHa&&(this.ga.gb(V.a.K_c,W.a.view,this.K_c,96),this.ga.gb(V.a.iBb,W.a.view,this.iBb,96))}c3(){if(this.Wb){const qa=this.Wb.pe(ca.AppFrame.iF);this.wad&&qa.bindAction(z.KeyInputManager.mc(B.a.Dmb,z.KeyInputManager.Mh|4),V.a.cYb)}else L.ULS.sendTraceTag(592196489,307,10,"Null focus manager and fail to register clipboard shortcuts.")}FFn(qa,Ea,Ia){switch(Ea){case V.a.jOa:case V.a.V6:case V.a.wib:Ea=V.a.v0d;break;case V.a.Pua:Ea=
V.a.ENf;break;default:Ea=V.a.u0d}Ia[this.mnb]=qa===Ea}NBl(){const qa=Object(R.a)(87,this.D6c)?this.D6c:null;return qa?qa.ia(J.a.$Tc,w.a.nil):w.a.nil}KTe(qa,Ea,Ia,na){if(1===Ia){if(!Object(R.a)(fa.a,Ea)||!this.a7c||Pa.a.Jla(Ea)&&Pa.a.rCb())return 8;Ia=new I.a(()=>this.hDc(this.iz.J(V.a.u1),na));const Na=this.a7c.create(Ia,Object(C.a)(87,na));Ia=new ea.a(r.AFrameworkApplication.K,G.a.instance,Ia,F.a.instance,Na,this.QNb);return ia.a.jih(Ea,Ia)?32:8}if(2===Ia){if(this.GQn(Y.App.GUa))return this.wVa(qa);
Y.App.rbc(()=>{this.wVa(qa)});return 32}return 2}wVa(qa){if(!this.Ud)return L.ULS.sendTraceTag(592454657,307,10,"No _editingDomManager"),8;var Ea=this.Ud.UKa();if(!Ea)return L.ULS.sendTraceTag(592454658,307,10,"No ownerDocument"),8;Ea=Ea.yn;if(!Ea)return L.ULS.sendTraceTag(592454659,307,10,"No document"),8;L.ULS.sendTraceTag(592454660,307,50,"Calling execCommand. Command: {0}",qa);this.$f.m_k(qa);qa=K.a.tyb(Ea,"paste");Ea=this.$f.uUk();L.ULS.sendTraceTag(573388233,307,50,"PasteEventHandled: {0}",
Ea);if(qa)return L.ULS.sendTraceTag(592454661,307,50,"execCommand succeeded"),32;this.WQl();L.ULS.sendTraceTag(592454662,307,10,"execCommand failed");return 8}WQl(){this.EPa&&(this.EPa.UJb(),da.a.dSd(!0,sa.a.instance,N.a.WE));if(this.telemetry){const qa=this.telemetry.o0c();qa.$Wb("CallExecCommandPasteOperation");qa.fail("call to execCommand('paste') failed",!0);this.telemetry.Tda(qa)}}GQn(qa){let Ea=!1;this.Wb?this.Wb.xg?Ea=!this.Wb.Pof(this.Wb.xg.name):L.ULS.sendTraceTag(573388235,307,10,"No CurrentScope"):
L.ULS.sendTraceTag(573388234,307,10,"No _focusManager");if(Ea){L.ULS.sendTraceTag(573388236,307,50,"CurrentScope: {0}",this.Wb.xg.name);if(1>qa)return L.ULS.sendTraceTag(573388237,307,10,"Action callbacks will not execute"),!0;this.Wb.JHh();return!1}return!0}hDc(qa,Ea){return qa&256?new Ca(this.$2n):qa&2?qa&4096?new ya(Ea,this.ld,this.Xj,Y.App.instance.hNc,Y.App.instance.jPa):new Sa(Ea,this.ld,Y.App.instance.jPa):Ea.hasProperty(J.a.eac)?new ua(Ea,this.ld,this.Xj,this.Awc,Y.App.instance.jPa):new ya(Ea,
this.ld,this.Xj,Y.App.instance.hNc,Y.App.instance.jPa)}static get t1m(){return H.a.XGd("Box4PasteScratchPad")}iih(qa,Ea,Ia,na){const Na=r.AFrameworkApplication.protectFile||r.AFrameworkApplication.fO;return r.AFrameworkApplication.K&&r.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)&&Na&&!r.AFrameworkApplication.j0b?8:(qa=this.XV(null,qa?V.a.cut:V.a.copy,Ea,1,Ia,na))?qa.response:8}}Object(D.a)(Xa,"ClipboardActor",null,[])},1691:function(D,
M,d){d.r(M);D=d(0);var m=d(16),f=d(1888),a=d(1744);class l extends a.a{constructor(){super();this.isCurrentUser=!1}}Object(D.a)(l,"IsMeAtMentionOptionalAttributes",a.a,[]);class r{constructor(){this.atmention=this.altText=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.paragraph=this.color=this.highlight=null}}Object(D.a)(r,"DeltaAttributes",null,[]);var w=d(1557),v=d(11),u=d(74),z=d(17),B=d(8),G=d(1609);d.d(M,"ACommentFormatTranslator",function(){return F});
class F{constructor(K){this.Xe=K}yak(K,N){const H=v.ParagraphReader.text(N);let J=null,L=null,I=null,R=0;var C=0,P=!1;let W="";for(N.qa||H&&H.length&&"\n"!==H||B.ULS.sendTraceTag(50870150,327,10,"paragraph chps are null and paragraph text is null or empty");R<N.qa.length;){const V=N.qa.J(R),Y=V.cp;var X=V.formatting?V.formatting.Xm:null;W+=m.a.substring(H,P?C+1:C,Y);V.vl&&J&&(C=new f.a,C.fullName=W.startsWith("@")?W.substr(1):W,G.a(J,C),P=new l,G.c(J,P,C),K.smf(W,C,P,!0),W="",J=null);V.vl&&L&&(C=
I||new r,C.link=L.url,K.m7h(W,C),W="",L=null);J&&L||""===W||(this.Xe.uvb&&I?(K.y7h(W,I),I=null):K.Kea(W),W="");V.hyperlink&&(V.hyperlink.Bx?J=V.hyperlink:V.hyperlink.url&&(L=V.hyperlink));this.Xe.uvb&&X&&(I=new r,I.weight=X.ia(z.a.bold,!1)?w.a.Iyf:0,I.italic=X.ia(z.a.italic,!1),I.underline=X.ia(z.a.underline,!1),I.strikethrough=X.ia(z.a.strikethrough,!1),this.Xe.wCb&&(X.hasProperty(z.a.highlight)&&(C=X.getValue(z.a.highlight),I.highlight=u.a.BC(C)),X.hasProperty(z.a.fontColor)&&(X=X.getValue(z.a.fontColor),
I.color=u.a.BC(X))));C=Y;P=!!V.blob;R++}}}F.aek="_@_";F.bek="Z";Object(D.a)(F,"ACommentFormatTranslator",null,[239])},1702:function(D,M,d){D=d(0);var m=d(153),f=d(16),a=d(29),l=d(22),r=d(2),w=d(236),v=d(158);class u{static get ug(){return m.a.Lx(u.rl,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsFont,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsIndent)}}u.rl="<div class='FootnoteEndnoteDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='FontPlaceholder'></div> </div> <div class='FootnoteEndnoteDialogIndentTitle UIFontBold' id='IndentTitle'> <label id='IndentTitleLabel' class='WACDialogLabel' for='IndentControl' >{1}</label> </div> <div class='normal' id='IndentControl'> <div id='IndentPlaceholderStyles' class='FootnoteEndnoteDialogIndentPlaceholder'></div> </div>";
Object(D.a)(u,"FootnoteEndnoteFormattingOptionsDialogHtml",null,[]);var z=d(18),B=d(3);d.d(M,"a",function(){return G});class G extends m.a{constructor(F,K,N){super();this.oFg=!1;this.VU=null;this.Pal=H=>{switch(H){case 1:this.ga.processAction(z.a.hIh,2);break;case 2:this.ga.processAction(z.a.iIh,2);break;case 0:this.ga.processAction(z.a.jIh,2)}};this.hp=K;this.HK=!1;this.RPb=G.ual;this.Dh=F;this.ga=N;this.kg="FootnoteEndnoteFormattingOptionsDialog";this.Ed=2;this.ug=u.ug;this.We(1,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyButton);
this.We(2,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyAllButton);this.Zh(WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogTitle,this.Pal,null);this.beb=!1;document.getElementById("FontStyleComboBox").focus()}get fontName(){return this.VU}set fontName(F){this.VU=F;if(F=document.getElementById("FontSizeComboBox"))F.focus(),this.Dh.updateCommandUI()}get fontSize(){return this.RPb}get beb(){return this.oFg}set beb(F){this.oFg=F;this.n3m()}UT(){this.jsd("FontStyleComboBox",
"FontPlaceholder",z.a.rCd.toString(),z.a.EGi.toString(),z.a.oUc.toString(),WoncaIntl.WoncaStrings.L_FontName,"100px");this.jsd("FontSizeComboBox","FontPlaceholder",z.a.sCd.toString(),B.a.hVc.toString(),z.a.pUc.toString(),WoncaIntl.WoncaStrings.L_FontSize,"32px");const F=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',
f.a.vZ(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),""),K=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',f.a.vZ(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),"&nbsp;&nbsp;&nbsp;&nbsp;");this.dzc("NoStyle","IndentPlaceholderStyles",
z.a.lIh.toString(),z.a.FGi.toString(),F,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesNoIndentButtonTitle,"Size110by75");this.dzc("FirstLineIndent","IndentPlaceholderStyles",z.a.kIh.toString(),z.a.kNf.toString(),K,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesFirstLineIndentButtonTitle,"Size110by75")}jsd(F,K,N,H,J,L,I){N=w.c(F,N,!0,!0,H,J,f.a.If(L),!0,I);this.swd(F,K,N,"Medium")}dzc(F,K,N,H,J,L,I){N=w.g(F,N,H,f.a.If(J),f.a.If(L),I);this.swd(F,K,N,"Large",L)}swd(F,K,N,H,J=null){K=document.getElementById(K);
this.hp.rya(F,N);N=this.hp.EXa(F,H);J&&a.a.Qqd(N,String.format("{0}Label",F),J);K.appendChild(N);this.hp.aM(F)}n3m(){this.hp.aM("NoStyle");this.hp.aM("FirstLineIndent")}dispose(){this.HK||(this.hp.IA("FontStyleComboBox"),this.hp.IA("FontSizeComboBox"),this.hp.IA("NoStyle"),this.hp.IA("FirstLineIndent"),this.HK=!0);this.Dh.updateCommandUI();super.dispose()}static get TPa(){return l.a.instance.resolve("Common.IStandaloneRootController").q3}static crl(){return new G(v.App.fm,G.TPa,r.AFrameworkApplication.ya)}static brl(){return G.crl()}}
G.ual=-1;Object(D.a)(G,"FootnoteEndnoteFormattingOptionsDialog",m.a,[])},1731:function(D,M,d){var m=this&&this.xO||(Object.create?function(a,l,r,w){void 0===w&&(w=r);var v=Object.getOwnPropertyDescriptor(l,r);if(!v||("get"in v?!l.kH:v.writable||v.configurable))v={enumerable:!0,get:function(){return l[r]}};Object.defineProperty(a,w,v)}:function(a,l,r,w){void 0===w&&(w=r);a[w]=l[r]}),f=this&&this.__exportStar||function(a,l){for(var r in a)"default"===r||Object.prototype.hasOwnProperty.call(l,r)||m(l,
a,r)};Object.defineProperty(M,"__esModule",{value:!0});f(d(1732),M);f(d(1733),M);f(d(1734),M);f(d(1735),M);D.exports.TableCell||Object.defineProperty(D.exports,"TableCell",{enumerable:!0,get:function(){return D.exports.TableCell}});D.exports.TableCellVerticalAlignment||Object.defineProperty(D.exports,"TableCellVerticalAlignment",{enumerable:!0,get:function(){return D.exports.TableCellVerticalAlignment}});D.exports.TableRow||Object.defineProperty(D.exports,"TableRow",{enumerable:!0,get:function(){return D.exports.TableRow}});
D.exports.WordTable||Object.defineProperty(D.exports,"WordTable",{enumerable:!0,get:function(){return D.exports.WordTable}})},1732:function(D,M){Object.defineProperty(M,"__esModule",{value:!0})},1733:function(D,M){Object.defineProperty(M,"__esModule",{value:!0});M.TableCellVerticalAlignment=void 0;D=M.TableCellVerticalAlignment||(M.TableCellVerticalAlignment={});D[D.Top=0]="Top";D[D.Center=1]="Center";D[D.Bottom=2]="Bottom"},1734:function(D,M,d){Object.defineProperty(M,"__esModule",{value:!0});M.OOXmlTableDesign=
M.TableDesign=void 0;var m=d(203);D=function(){function f(a){m.SchemaObject.assign(f,this,a)}Object.defineProperty(f.prototype,"metadata",{get:function(){return this.M_},set:function(a){this.M_=a},enumerable:!1,configurable:!0});f.getTypeName=function(){return"AugLoop_Table_TableDesign"};f.getBaseTypes=function(){return["AugLoop_Core_Annotation"]};f.typeGuard=function(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();M.TableDesign=
D;D=function(){function f(a){m.SchemaObject.assign(f,this,a)}Object.defineProperty(f.prototype,"metadata",{get:function(){return this.M_},set:function(a){this.M_=a},enumerable:!1,configurable:!0});f.getTypeName=function(){return"AugLoop_Table_OOXmlTableDesign"};f.getBaseTypes=function(){return["AugLoop_Table_TableDesign","AugLoop_Core_Annotation"]};f.typeGuard=function(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();M.OOXmlTableDesign=
D},1735:function(D,M,d){Object.defineProperty(M,"__esModule",{value:!0});M.WordOOXmlTableTile=M.WordTable=M.Table=M.TableCell=M.TableRow=void 0;var m=d(203);D=function(){function f(a){m.SchemaObject.assign(f,this,a)}f.getTypeName=function(){return"AugLoop_Table_TableRow"};f.getBaseTypes=function(){return[]};f.typeGuard=function(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();M.TableRow=D;D=function(){function f(a){m.SchemaObject.assign(f,
this,a)}f.getTypeName=function(){return"AugLoop_Table_TableCell"};f.getBaseTypes=function(){return[]};f.typeGuard=function(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();M.TableCell=D;D=function(){function f(a){m.SchemaObject.assign(f,this,a)}f.getTypeName=function(){return"AugLoop_Table_Table"};f.getBaseTypes=function(){return[]};f.typeGuard=function(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};f.H_={T_:f.getTypeName(),
B_:f.getBaseTypes()};return f}();M.Table=D;D=function(){function f(a){m.SchemaObject.assign(f,this,a)}f.getTypeName=function(){return"AugLoop_Table_WordTable"};f.getBaseTypes=function(){return["AugLoop_Table_Table"]};f.typeGuard=function(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();M.WordTable=D;D=function(){function f(a){m.SchemaObject.assign(f,this,a)}f.getTypeName=function(){return"AugLoop_Table_WordOOXmlTableTile"};f.getBaseTypes=
function(){return["AugLoop_Table_WordTable","AugLoop_Table_Table"]};f.typeGuard=function(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();M.WordOOXmlTableTile=D},1744:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(){this.contentId=""}}Object(D.a)(m,"AtMentionOptionalAttributes",null,[])},1766:function(D,M){Object.defineProperty(M,"__esModule",{value:!0});M.ObjectSchemaType=M.ObjectSemantic=M.SequenceType=
M.InputMethod=M.CommandSurface=M.IntentIds=void 0;(function(d){d.Logging="Logging";d.KeyPhrases="KeyPhrases";d.ZeroTermMenu="ZeroTermMenu"})(M.IntentIds||(M.IntentIds={}));(function(d){d.Canvas="Canvas";d.KeyboardShortcut="KeyboardShortcut";d.ClassicRibbon="ClassicRibbon";d.SimplifiedRibbon="SimplifiedRibbon";d.ContextMenu="ContextMenu";d.Floatie="Floatie";d.SearchBox="SearchBox";d.QuickAccessToolbar="QuickAccessToolbar"})(M.CommandSurface||(M.CommandSurface={}));(function(d){d.Unknown="Unknown";
d.Keyboard="Keyboard";d.Mouse="Mouse";d.Touch="Touch";d.Pen="Pen";d.Voice="Voice"})(M.InputMethod||(M.InputMethod={}));(function(d){d.CommandId="CommandId";d.ControlId="ControlId"})(M.SequenceType||(M.SequenceType={}));(function(d){d.CommandIdHistory="CommandIdHistory";d.ControlIdHistory="ControlIdHistory";d.FilteredCommandIdHistory="FilteredCommandIdHistory";d.CanvasContext="CanvasContext"})(M.ObjectSemantic||(M.ObjectSemantic={}));(function(d){d.CommandExecutionSequence="CommandExecutionSequence";
d.WordCanvasContext="WordCanvasContext"})(M.ObjectSchemaType||(M.ObjectSchemaType={}))},1767:function(D,M,d){Object.defineProperty(M,"__esModule",{value:!0});M.SearchSuggestionAnnotation=M.SearchSuggestionSignal=void 0;const m=d(203);class f{constructor(l){m.SchemaObject.assign(f,this,l)}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[f.getTypeName()])}}
M.SearchSuggestionSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[a.getTypeName()])}}M.SearchSuggestionAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1775:function(D,M,d){var m=
this&&this.xO||(Object.create?function(a,l,r,w){void 0===w&&(w=r);var v=Object.getOwnPropertyDescriptor(l,r);if(!v||("get"in v?!l.kH:v.writable||v.configurable))v={enumerable:!0,get:function(){return l[r]}};Object.defineProperty(a,w,v)}:function(a,l,r,w){void 0===w&&(w=r);a[w]=l[r]}),f=this&&this.__exportStar||function(a,l){for(var r in a)"default"===r||Object.prototype.hasOwnProperty.call(l,r)||m(l,a,r)};Object.defineProperty(M,"__esModule",{value:!0});f(d(1776),M);f(d(1777),M);f(d(1778),M);f(d(1779),
M);D.exports.ContractEntityAnnotation||Object.defineProperty(D.exports,"ContractEntityAnnotation",{enumerable:!0,get:function(){return D.exports.ContractEntityAnnotation}});D.exports.ContractEntitySignal||Object.defineProperty(D.exports,"ContractEntitySignal",{enumerable:!0,get:function(){return D.exports.ContractEntitySignal}})},1776:function(D,M){Object.defineProperty(M,"__esModule",{value:!0})},1777:function(D,M){Object.defineProperty(M,"__esModule",{value:!0})},1778:function(D,M,d){Object.defineProperty(M,
"__esModule",{value:!0});M.ContractEntityAnnotation=void 0;const m=d(203);class f{constructor(a){m.SchemaObject.assign(f,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntityAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}M.ContractEntityAnnotation=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},
1779:function(D,M,d){Object.defineProperty(M,"__esModule",{value:!0});M.ContractEntitySignal=void 0;const m=d(203);class f{constructor(a){m.SchemaObject.assign(f,this,a)}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntitySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return m.SchemaObject.matchesTypesFor(a,[f.getTypeName()])}}M.ContractEntitySignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},1782:function(D,M,d){d.r(M);d.d(M,"ReactOICErrorDialogWithTrial",
function(){return l});D=d(0);var m=d(43);M=d(1633);var f=d(355),a=d(153);class l extends M.a{constructor(r,w,v,u,z,B){super(r,w,v,u,z,B);w={["errorMessage"]:this.nDh,["offerString"]:this.uti};r=new a.a(!1,!1,!0);this.W2i?(r.Ed=1,w.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.heb,["onExecute"]:()=>{f.Redirect.showHelp(this.m3h)}}):(r.Ed=4,r.We(2,this.M4h));r.We(1,this.Uod);r.kg=this.id;w={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:w};r.Zh(this.YJa,Object(m.a)(this,
this.Hdn,"reactOICErrorDialogWithTrialHandler"),w)}}Object(D.a)(l,"ReactOICErrorDialogWithTrial",M.a,[])},1783:function(D,M,d){d.r(M);d.d(M,"OICErrorDialogWithTrial",function(){return a});D=d(0);var m=d(43);M=d(1633);var f=d(141);class a extends M.a{constructor(l,r,w,v,u,z){super(l,r,w,v,u,z);l=document.createElement("span");l.innerText=this.nDh;l.appendChild(document.createElement("br"));l.appendChild(document.createElement("br"));r=document.createElement("span");r.innerText=this.uti;l.appendChild(r);
r=new f.StandardDialog;this.W2i?(r.Ed=1,r.QMe(this.heb,this.m3h)):(r.Ed=4,r.We(2,this.M4h));r.We(1,this.Uod);r.kg=this.id;r.Lv(this.YJa,null,this.icon,Object(m.a)(this,this.npm,"legacyOICErrorDialogWithTrialHandler"),l)}}Object(D.a)(a,"OICErrorDialogWithTrial",M.a,[])},1785:function(D,M,d){var m=this&&this.xO||(Object.create?function(a,l,r,w){void 0===w&&(w=r);Object.defineProperty(a,w,{enumerable:!0,get:function(){return l[r]}})}:function(a,l,r,w){void 0===w&&(w=r);a[w]=l[r]}),f=this&&this.__exportStar||
function(a,l){for(var r in a)"default"===r||Object.prototype.hasOwnProperty.call(l,r)||m(l,a,r)};Object.defineProperty(M,"__esModule",{value:!0});f(d(1786),M);f(d(1787),M);D.exports.SearchProviderAnnotation||Object.defineProperty(D.exports,"SearchProviderAnnotation",{enumerable:!0,get:function(){return D.exports.SearchProviderAnnotation}});D.exports.SearchProviderSignal||Object.defineProperty(D.exports,"SearchProviderSignal",{enumerable:!0,get:function(){return D.exports.SearchProviderSignal}})},
1786:function(D,M){Object.defineProperty(M,"__esModule",{value:!0})},1787:function(D,M,d){Object.defineProperty(M,"__esModule",{value:!0});M.SearchProviderAnnotation=M.SearchProviderSignal=void 0;const m=d(203);class f{constructor(l){m.SchemaObject.assign(f,this,l)}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[f.getTypeName()])}}M.SearchProviderSignal=f;f.H_=
{T_:f.getTypeName(),B_:f.getBaseTypes()};class a{constructor(l){m.SchemaObject.assign(a,this,l)}get metadata(){return this.M_}set metadata(l){this.M_=l}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(l){return m.SchemaObject.matchesTypesFor(l,[a.getTypeName()])}}M.SearchProviderAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1833:function(D,M,d){D=d(0);var m=d(2),f=d(104),a=d(59),l=d(205),
r=d(22),w=d(16),v=d(84),u=d(127),z=d(17),B=d(44),G=d(5),F=d(8),K=d(72),N=d(57),H=d(36),J=d(320),L=d(20),I=d(14),R=d(6),C=d(64),P=d(108),W=d(21),X=d(41),V=d(260),Y=d(42),ca=d(261),fa=d(23),sa=d(89),ia=d(173),ea=d(853),da=d(468),ja=d(3),Ga=d(96),ya=d(65),ta=d(9),ua=d(105),Sa=d(49),ka=d(497),ha=d(586),Ca=d(228),Pa=d(19),Xa=d(24),qa=d(54),Ea=d(38),Ia=d(247),na=d(11),Na=d(1516),Oa=d(1529),Ra=d(239),ab=d(170),zb=d(56),Qa=d(520);class yb extends Ra.a{constructor(pa,Ya,Ja,nb,Bb,mb,Qb,Vb){super();this.zYg=
this.dB=null;this.init(pa);this.ll("FormattingViewOperation");this.Neb(m.AFrameworkApplication.ya,Ya,nb,Bb,mb);this._context=Ja;this.w4a=0;this.Pl=!0;this.SBj=Qb;this.Cm=Vb}get S9(){return this.Cm.instance}run(){const pa=this._context.view;var Ya=null;pa.Be&&(Ya=pa.Cb);if(Ya){var Ja=Ya.ib.kb,nb=!Oa.a.r5b(this.actionId);!Ja||yb.Zf.Xrf(Ja,nb)?(yb.Lc.Yb(Ga.a.zf,{["Reason"]:ya.a.UD}),this.Pl=!1):this.S9&&this.S9.M5b(Ja)?(yb.Lc.Yb(Ga.a.zf,{["Reason"]:ya.a.externalSelection}),this.Pl=!1):yb.Tg.Wva(na.ParagraphReader.KW,
Ya.Rg)&&(yb.Lc.Yb(Ga.a.zf,{["Reason"]:ya.a.pN}),this.Pl=!1)}else yb.Lc.Yb(Ga.a.zf,{["Reason"]:ya.a.sfa}),this.Pl=!1;1!==this.behavior&&this.Pl||(this.Pl&&(Ja=Ya.ib.kb,1===Ya.ib.length&&1===Ja.length&&Pa.SelectionEditor.Ek(Ja.Qa)&&sa.b(Ja.Qa)&&(yb.Lc.Yb(Ga.a.zf,{["Reason"]:ya.a.hBc}),this.Pl=!1)),(Ja=this.Pl)&&this.actionId===ja.a.m7&&((Ja=Array.from(Ya.ib.kb).some(P.FormattingReader.eph))||yb.Lc.Yb(Ga.a.zf,{["Reason"]:ya.a.P3e})),this.$q=Ja?32:8,this.w4a=3);this.w4a||(ab.a.mark(5730),this.zYg=Qa.SelectionReferenceFactory.instance.bxb(),
Ja=Ya.ib.kb.Qa,this.dB=new Sa.GraphTransaction(15),this.dB.Db(Ja.node),this.dB.zl=this.actionId,this.w4a=1);if(1===this.w4a){this.YE||this.iZc(this._context.tk);if(1===this.Y0a())return;this.w4a=2}if(2===this.w4a){if(this.actionId===ja.a.m7)if(Ya=Ya.Rg,Ya.Rw)for(Ja=0;Ja<Ya.length;Ja++)nb=Ya.getContext(Ja),this.Fcj(nb);else this.Fcj(Ya);this.zYg.nna(this.actionId===ja.a.zX||this.actionId===ja.a.Gja);(Ya=Object(K.a)(27,this.Bd))&&!Ya.q2a||zb.FocusManager.instance().Jg(pa.aI);this.dB.dispose();this.dB=
null;ta.App.xa.updateCommandUI();ab.a.mark(5731);this.w4a=3;this.$q=32}3===this.w4a&&(this.SBj.process(this.actionId,this._context,this.behavior,this.response),this.Cna())}Fcj(pa){(Pa.SelectionEditor.Zt(pa)||Pa.SelectionEditor.sk(pa))&&ta.App.tK.cba(pa.node)}static get Zf(){return Ia.a.instance}static get Tg(){return Ca.ContextSetEditor.instance}static get Lc(){return u.a.instance}}Object(D.a)(yb,"FormattingViewOperation",Ra.a,[]);var lb=d(988),Eb=d(751),bc=d(74),Pb=d(142);d.d(M,"a",function(){return oa});
const Va=new Set([ja.a.BL,ja.a.kM,ja.a.clearFormatting,ja.a.lJa,ja.a.mJa,ja.a.BVa,ja.a.Uya,ja.a.CVa]);class oa{constructor(pa,Ya,Ja=null,nb){this.kpiName="ChangeCaseCommandUsage";this.S5="wwaengidc";this.GT=new Map;this.fOg=new Set;this.dzb=()=>new ea.a(2);this.yGi=(Bb,mb,Qb,Vb,mc)=>{Vb=!0;mb.contextId!==I.a.view&&(Vb=!1);if(1===Qb&&!Vb)return 8;if(Bb===ja.a.iVc)Bb=mc.formatting,mc=mc.b0f;else{if(!mb.view||!mb.view.Be)return 2;mb=mb.view;if(!mb.Cb||!mb.Cb.ib.kb)return 8;Bb=mc;mc=mb.Cb.ib}this.mAk(mc,
Bb);return 32};this.FPe=(Bb,mb,Qb,Vb,mc,ob)=>new yb(Bb,mb,Qb,Vb,mc,ob,this.CCj,oa.mw());this.Wqd=(Bb,mb,Qb,Vb,mc)=>{var ob,cb,db;let kb=!0,Wb=mb;const Fb=!Oa.a.r5b(Bb);mb.contextId!==I.a.Fd&&mb.contextId!==I.a.Wc?kb=!1:(oa.Zf.L$(Wb,!1,Fb)&&(oa.Lc.Yb(Ga.a.Mm,{["Reason"]:ya.a.UD}),kb=!1),oa.mw()&&oa.mw().instance&&oa.mw().instance.vT(Wb)&&(kb=!1),kb&&Pa.SelectionEditor.Ek(mb)&&sa.b(Wb)&&(oa.Lc.Yb(Ga.a.Mm,{["Reason"]:ya.a.hBc}),kb=!1),na.ParagraphReader.KW(mb)&&(oa.Lc.Yb(Ga.a.zf,{["Reason"]:ya.a.pN}),
kb=!1));if(1===Qb||!kb)return kb?32:8;if(mb.contextId===I.a.Wc)return 2;Pb.a.UXe&&(mb=null===(ob=this.Co)||void 0===ob?void 0:ob.gVh(Wb))&&(Wb=mb);this.nTn(Bb)&&(ob=Pa.SelectionEditor.dLb(Wb),Pa.SelectionEditor.xf(ob)||(Wb=ob));ob="boolean"===typeof mc&&mc;mb=oa.Rd.wg;(null===(cb=this.Yba)||void 0===cb?0:cb.annotateRange)&&(ob||!mb)&&(null===(db=this.Yba)||void 0===db?0:db.TCb(Wb.node))?this.m1(Wb,Bb,mc):oa.f3a.m1(Wb,nc=>{this.gdc(nc,Bb,mc,Wb.cpEnd)},ob);Wb.node.Pr&&(cb=[Object.assign(new H.a,{name:"Source",
string:"CharacterFormatting"})],N.a("TOCFormatting",!0,void 0,cb));this.A8l(Bb)&&this.itd(Wb,Bb);Vb&&Na.a.hlb&&(Vb.Jr|=Na.a.Xcb(Wb.node));return 32};this.z1c=(Bb,mb,Qb)=>1!==Qb&&2===Qb?(this.GT.set("Source","Shortcut"),Bb=mb.node.characterData.substr(mb.cpBegin,mb.cpEnd-mb.cpBegin),oa.psf(Bb,0,Bb.length)?this.itd(mb,ja.a.lJa):oa.ejm(Bb,Bb.length)?this.itd(mb,ja.a.Uya):this.itd(mb,ja.a.mJa)):32;this.kab=(Bb,mb,Qb)=>{let Vb=!0;Bb=!Oa.a.r5b(Bb);mb.contextId!==I.a.Fd&&mb.contextId!==I.a.Wc?Vb=!1:(oa.Zf.L$(mb,
!1,Bb)&&(oa.Lc.Yb(Ga.a.Mm,{["Reason"]:ya.a.UD}),Vb=!1),Vb&&Pa.SelectionEditor.Ek(mb)&&sa.b(mb)&&(oa.Lc.Yb(Ga.a.Mm,{["Reason"]:ya.a.hBc}),Vb=!1),Vb&&na.ParagraphReader.KW(mb)&&(oa.Lc.Yb(Ga.a.zf,{["Reason"]:ya.a.pN}),Vb=!1));if(1===Qb||!Vb)return Vb?32:8;mb=mb.node;oa.paragraphEditor.DYb(mb,!1);mb.Pr&&(mb=[Object.assign(new H.a,{name:"Source",string:"ClearFormatting"})],N.a("TOCFormatting",!0,void 0,mb));return 32};this.jAc=(Bb,mb,Qb,Vb,mc)=>{Bb={};Bb[lb.a.eFa]=6168;Bb[lb.a.dFa]=6169;const ob=mb.view;
var cb=null;ob.Ji&&(cb=ob);var db=!0;let kb=32;cb&&(cb=cb.Cb.ib.kb)&&(oa.Zf.Xrf(cb)?(oa.Lc.Yb(Ga.a.zf,{["Reason"]:ya.a.UD}),kb=8,db=!1):1===Qb&&(kb=32,db=!1));db&&(db=new Sa.GraphTransaction(1===Qb?3:15),db.Db(ob.root),kb=lb.a.Tma(ja.a.kab,mb,Qb,Vb,mc,Bb,12),db.dispose());return kb};this.NPe=(Bb,mb,Qb,Vb,mc)=>{var ob,cb=!0,db=32;const kb=!Oa.a.r5b(Bb);mb.contextId!==I.a.Wc?cb=!1:oa.Zf.L$(mb,!1,kb)&&(oa.Lc.Yb(Ga.a.Mm,{["Reason"]:ya.a.UD}),cb=!1);if(1===Qb||!cb)return cb?32:8;Qb=mb.node;L.a.instance.J(8)&&
Bb===ja.a.clearFormatting&&(oa.Jo.kAc(Qb),oa.paragraphEditor.Plh(Qb),cb=oa.nKb.Nx(Qb).uh(oa.nKb.wordStyleIdNormal),oa.B7.hM(cb,Qb,!0));Qb=oa.Rj.egf(mb);Pb.a.UXe&&!Qb&&(cb=null===(ob=this.Co)||void 0===ob?void 0:ob.gVh(mb))&&(mb=cb,Qb=Xa.SelectionFactory.Kn(mb));if(Qb)db=qa.a.Xwb(Qb),db=m.AFrameworkApplication.ya.Qf(db,Bb,2,!1,Vb,mc);else{Vb=Object(K.a)(27,mc);ob=P.FormattingReader.Ds(mb);if(!ob)return 16;ob=ob.cache;switch(Bb){case ja.a.font:if(Vb&&Vb.Bd){const {fontName:Wb,F7:Fb,bold:nc,italic:gc}=
oa.Jcf(Vb.Bd);oa.Rj.n5d(Wb);oa.Rj.Ddc(Fb);Object(ka.a)()&&(Bb=1==nc,mc=1==gc,Bb||mc)&&(oa.Rj.KF(Bb),oa.Rj.setItalic(mc))}break;case ja.a.Is:F.ULS.sendTraceTag(595153824,340,50,"Font color is selected from Standard/Theme colors.");oa.Rj.Is(mc);break;case ja.a.tga:oa.Rj.Is(mc);this.recentColors.g$a(mc)||F.ULS.sendTraceTag(594899723,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ja.a.B5:oa.Rj.B5();break;case ja.a.zX:F.ULS.sendTraceTag(594899722,340,50,"Font background color is selected from Standard colors.");
oa.Rj.kva(mc);break;case ja.a.l7:oa.Rj.kva(mc);this.recentColors.g$a(mc)||F.ULS.sendTraceTag(594899720,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ja.a.Gja:oa.Rj.Std();break;case ja.a.Pv:oa.Rj.Pv(Vb.Bd);break;case ja.a.BL:Bb=oa.Rj.xL(z.a.fontSize,ob.fontSize);oa.Rj.Pv(oa.ui.BL(Bb));break;case ja.a.kM:Bb=oa.Rj.xL(z.a.fontSize,ob.fontSize);oa.Rj.Pv(oa.ui.kM(Bb));break;case ja.a.bold:Bb=oa.Rj.xL(z.a.bold,ob.isBold);oa.Rj.KF(!Bb);break;case ja.a.setItalic:Bb=oa.Rj.xL(z.a.italic,
ob.isItalic);oa.Rj.setItalic(!Bb);break;case ja.a.underline:Bb=oa.Rj.xL(z.a.underline,ob.isUnderline);oa.Rj.o3(!Bb);break;case ja.a.yga:oa.Rj.yga(mc);break;case ja.a.superscript:Bb=oa.Rj.xL(z.a.superscript,ob.isSuperscript);oa.Rj.Uaa(!Bb);break;case ja.a.subscript:Bb=oa.Rj.xL(z.a.subscript,ob.isSubscript);oa.Rj.Gna(!Bb);break;case ja.a.strikethrough:Bb=oa.Rj.xL(z.a.strikethrough,ob.isStrikethrough);oa.Rj.r7(!Bb);break;case ja.a.As:Bb=oa.Rj.xL(B.a.As,ob.isDoubleStrikethrough);oa.Rj.kdc(!Bb);break;
case ja.a.clearFormatting:oa.Rj.C1a();break;case ja.a.m7:mc.hasProperty(z.a.eE)&&oa.Rj.m7(mc.getValue(z.a.eE));mc.hasProperty(G.a.noProof)&&(Bb=mc.getValue(G.a.noProof),oa.Rj.iKn(Bb));break;default:this.fOg.has(Bb)||(this.fOg.add(Bb),(mc=f.ActionManager.Sca(Bb))&&mc.length||(mc="UnknownAction"),F.ULS.sendTraceTag(523120736,324,15,`TextFormattingActor.applyFormattingIp received unexpected command: ${mc} (${Bb})`))}}ta.App.xa.updateCommandUI();return db};this.nS=(Bb,mb,Qb,Vb,mc)=>{Vb=oa.Lc.oo(ja.a.eHn);
var ob=!0;mb.contextId!==I.a.endOfParagraph&&(ob=!1);if(1===Qb||!ob)return ob?32:8;Qb=mb.node;ob=R.GraphIterator.$a(mb.node);ob.vd();var cb=ob.e6(4);if((ob=!!cb&&oa.hd.N$(cb))&&!ta.App.Lgb)return 8;var db=!na.ParagraphReader.textLength(Qb);Vb.properties.Z("Action",Bb.toString());Vb.properties.Z("ListContext",ob.toString());Vb.properties.Z("IsEmptyParagraph",db.toString());F.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",Bb,ob,db);ob&&!da.a.Zd.KL&&
this.Pfj(Bb,mc,cb);ob=Qb.qa.last;this.von(Qb,Bb);db=!!ob.formatting;const kb=Qb.getValue(G.a.endOfParagraphFormatting);cb=oa.characterPropertiesEditor.lKa(Qb);db=!db&&kb&&kb.equals(a.a.nil)?new ia.a(ob,a.a.nil):cb.Yf(cb.Ob);this.gdc(cb,Bb,mc,ob.cp);L.a.instance.J(3)&&oa.Hk.XIb(Qb,ob,mb.cpBegin,mb.cpEnd,db,cb,oa.Rd.wg);Vb.end();return 32};this.oja=(Bb,mb,Qb,Vb,mc)=>{Vb=!0;const ob=R.GraphIterator.$a(mb.node);ob.vd();mb.contextId===I.a.endOfParagraph&&ob.e6(4)||(oa.Lc.Yb(Ga.a.Mm,{["Reason"]:ya.a.nvf}),
Vb=!1);mb=ob.currentNode;if(!oa.hd.N$(mb))return 8;if(1===Qb||!Vb)return Vb?32:8;da.a.Zd.KL||this.Pfj(Bb,mc,mb);return 32};this.ena=(Bb,mb,Qb,Vb,mc)=>{Bb=!0;mb.contextId!==I.a.paragraph&&(Bb=!1);if(1===Qb&&!Bb)return 8;Qb=mb.node;-1!==mc.ai?mc.ai!==na.ParagraphReader.Ev(Qb)&&(mc.ai=0):mc.ai=na.ParagraphReader.Ev(Qb);L.a.instance.J(7)&&(Bb=oa.Yx.mdb(Qb),mc.Ts?(!mc.wUl&&this.zUl(mc.Ts,Bb)&&2===mc.Ts.specialIndentType&&(mc.Ts.specialIndentType=0),mc.Ts.zBb===Bb.zBb&&l.a.DZ(mc.Ts.tA,Bb.tA)||(mc.Ts.tA=
Number.MAX_VALUE),mc.Ts.ABb===Bb.ABb&&l.a.DZ(mc.Ts.wla,Bb.wla)||(mc.Ts.wla=Number.MAX_VALUE)):mc.Ts=Bb,mb=oa.Tg.$ch(mb.tk),void 0!==mb&&null!==mb&&(mb=mb.node,void 0!==mb&&null!==mb&&(mb=V.WordSectionNavigator.instance.RL(mb),void 0!==mb&&null!==mb&&(mb=oa.Sg.Gv(mb)-(oa.Sg.vL(mb)+oa.Sg.wL(mb)+ta.App.Zva),Bb.lLc=mb-Bb.tA,Bb.kLc=mb-Bb.wla,mc.Ts.kLc=Math.min(mc.Ts.kLc,Bb.kLc),mc.Ts.lLc=Math.min(mc.Ts.lLc,Bb.lLc)))));L.a.instance.J(7)&&(mb=oa.JT.JAa(Qb),mc.oM?(mc.oM.beforeSpacing=oa.U9g(mb.beforeSpacing,
mc.oM.beforeSpacing),mc.oM.afterSpacing=oa.U9g(mb.afterSpacing,mc.oM.afterSpacing),mc.oM.lineSpacing.unit===mb.lineSpacing.unit&&l.a.DZ(mc.oM.lineSpacing.value,mb.lineSpacing.value)||(mc.oM.lineSpacing.unit=0,mc.oM.lineSpacing.value=0)):mc.oM=mb);mb=new R.GraphIterator;mb.set(Qb);mb.Bb(11);if(Qb=mb.kd(11))mc.isRtl=Y.OutlineElementReader.hm(Qb);Qb=oa.hd.Es(mb);mb=16;void 0!==Qb&&null!==Qb&&(mb=Qb.listType);mc.listType=oa.oml(mc.listType,mb);mc.uw=16===mc.listType?null:Qb;return 32};this.ban=(Bb,mb,
Qb,Vb,mc)=>{mc.isRtl=Y.OutlineElementReader.hm(X.OutlineElementNavigator.Uk(mb.node));return 32};this.Obh=(Bb,mb,Qb)=>{if(Bb===ja.a.rJb)Bb=!0;else if(Bb===ja.a.qJb)Bb=!1;else return 2;Bb&&this.Qli(mb);if(1===Qb)return 32;oa.eh.iJb(X.OutlineElementNavigator.Uk(mb.node),Bb);return 32};this.U$m=(Bb,mb,Qb,Vb,mc)=>{Bb=mb.node;mc.isRtl=Y.OutlineElementReader.isRtl(X.OutlineElementNavigator.Uk(Bb));mc.ai=W.ImageReader.Ev(Bb);return 32};this.$an=(Bb,mb,Qb,Vb,mc)=>{Bb=mb.node;mc.isRtl=Y.OutlineElementReader.isRtl(X.OutlineElementNavigator.Uk(Bb));
mc.ai=Ea.TableReader.Ev(Bb);-1!==mc.ai&&mc.ai||(mc.ai=mc.isRtl?3:1);return 32};this.VPe=(Bb,mb,Qb,Vb,mc)=>{let ob;if(!({zx:ob}=Oa.a.QYf(Qb,mb)).returnValue)return ob;const cb=mb.node;switch(Bb){case ja.a.qJb:oa.eh.Cdc(cb,!1);break;case ja.a.rJb:this.Qli(mb);oa.eh.Cdc(cb,!0);break;case ja.a.m7:ob=m.AFrameworkApplication.ya.Qf(mb.tk,Bb,Qb,!0,Vb,mc),32===ob&&na.ParagraphReader.gm(mb)&&oa.SUc&&oa.SUc.cba(cb)}return 32};this.Huk=(Bb,mb,Qb,Vb,mc)=>{const ob={};ob[lb.a.eFa]=6168;ob[lb.a.dFa]=6169;var cb=
mb.view;const db=new Sa.GraphTransaction(1===Qb?3:15);db.Db(cb.root);let kb=lb.a.Tma(Bb,mb,Qb,Vb,mc,ob,0),Wb=null;cb.Ji&&(Wb=cb);cb=!0;let Fb=null;Wb&&(Fb=Wb.Cb.ib.kb)&&(Bb=!Oa.a.r5b(Bb),oa.Zf.Xrf(Fb,Bb)?(oa.Lc.Yb(Ga.a.zf,{["Reason"]:ya.a.UD}),kb=8,cb=!1):1===Qb&&(kb=32,cb=!1),oa.Tg.Wva(na.ParagraphReader.KW,Wb.Cb.Rg)&&(oa.Lc.Yb(Ga.a.zf,{["Reason"]:ya.a.pN}),kb=8,cb=!1));cb&&this.ijm(Fb)&&(kb=lb.a.Tma(ja.a.kab,mb,Qb,Vb,mc,ob,12));db.dispose();return kb};this.Guk=(Bb,mb,Qb)=>{Bb=!0;mb.contextId!==
I.a.paragraph&&mb.contextId!==I.a.Wc?Bb=!1:oa.Zf.VZa(mb)&&(oa.Lc.Yb(Ga.a.Mm,{["Reason"]:ya.a.UD}),Bb=!1);if(1===Qb||!Bb)return Bb?32:8;mb=mb.node;Qb=new Sa.GraphTransaction(15);Qb.Db(mb);oa.Jo.kAc(mb);oa.paragraphEditor.DYb(mb,!0);oa.B7.FVe(mb);Qb.dispose();return 2};this.hQl=(Bb,mb,Qb)=>{Bb=!0;mb.contextId!==I.a.view&&(Bb=!1);if(1===Qb&&!Bb)return 8;if(!mb.view||!mb.view.Be)return 2;mb=mb.view;if(!mb.Cb||!mb.Cb.ib.kb)return 8;if(oa.Tg.Wva(na.ParagraphReader.KW,mb.Cb.Rg))return oa.Lc.Yb(Ga.a.zf,{["Reason"]:ya.a.pN}),
8;mb=mb.Cb.ib;for(const Vb of mb)for(const mc of Vb)if(mc&&mc.contextId!==I.a.Fd&&mc.contextId!==I.a.Wc&&mc.contextId!==I.a.paragraph&&mc.contextId!==I.a.endOfParagraph)return 2;return 32};this.g1a=(Bb,mb,Qb,Vb,mc)=>{Bb=!0;mb.contextId!==I.a.paragraph&&(Bb=!1);if(1===Qb&&!Bb)return 8;mc.Ts||(mb=mb.node,Qb=oa.Yx.mdb(mb),mc.Ts=Qb,mb=X.OutlineElementNavigator.Uk(mb),mc.isRtl=mb?Y.OutlineElementReader.hm(mb):!1);return 32};this.abn=(Bb,mb,Qb,Vb,mc)=>{mb=mb.node;Bb=X.OutlineElementNavigator.Uk(mb);mc.Ts||
(mb=this.aBl(mb),mb=oa.Yx.mdb(mb),mc.Ts=mb,mc.isRtl=Y.OutlineElementReader.isRtl(Bb));return 32};this.CCj=pa;this.Yba=Ya;this.z4=Ja;this.Co=nb}get recentColors(){return null!=this.iog?this.iog:this.iog=r.a.instance.Pa("Box4.UI.RecentColorsSectionHandler")}get nCd(){return!!this.z4&&this.z4.enabled}Vb(){const pa=m.AFrameworkApplication.ya,Ya=this.ban;(oa.Pb?oa.Pb.Sw(44):m.AFrameworkApplication.K&&m.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled"))?(pa.pa(ja.a.font,I.a.endOfParagraph,
this.nS),pa.pa(ja.a.Pv,I.a.endOfParagraph,this.nS),pa.pa(ja.a.BL,I.a.endOfParagraph,this.nS),pa.pa(ja.a.kM,I.a.endOfParagraph,this.nS),pa.pa(ja.a.Is,I.a.endOfParagraph,this.nS),pa.pa(ja.a.tga,I.a.endOfParagraph,this.nS),pa.pa(ja.a.B5,I.a.endOfParagraph,this.nS),pa.pa(ja.a.zX,I.a.endOfParagraph,this.nS),pa.pa(ja.a.l7,I.a.endOfParagraph,this.nS),pa.pa(ja.a.Gja,I.a.endOfParagraph,this.nS),pa.pa(ja.a.bold,I.a.endOfParagraph,this.nS),pa.pa(ja.a.setItalic,I.a.endOfParagraph,this.nS),pa.pa(ja.a.underline,
I.a.endOfParagraph,this.nS),pa.pa(ja.a.yga,I.a.endOfParagraph,this.nS),pa.pa(ja.a.superscript,I.a.endOfParagraph,this.nS),pa.pa(ja.a.subscript,I.a.endOfParagraph,this.nS),pa.pa(ja.a.strikethrough,I.a.endOfParagraph,this.nS),pa.pa(ja.a.As,I.a.endOfParagraph,this.nS),pa.pa(ja.a.m7,I.a.endOfParagraph,this.nS),pa.pa(ja.a.clearFormatting,I.a.endOfParagraph,this.nS)):ta.App.Lgb&&(pa.pa(ja.a.font,I.a.endOfParagraph,this.oja),pa.pa(ja.a.Pv,I.a.endOfParagraph,this.oja),pa.pa(ja.a.Is,I.a.endOfParagraph,this.oja),
pa.pa(ja.a.tga,I.a.endOfParagraph,this.oja),pa.pa(ja.a.B5,I.a.endOfParagraph,this.oja),C.ListReader.pr&&(pa.pa(ja.a.bold,I.a.endOfParagraph,this.oja),pa.pa(ja.a.setItalic,I.a.endOfParagraph,this.oja),pa.pa(ja.a.superscript,I.a.endOfParagraph,this.oja),pa.pa(ja.a.subscript,I.a.endOfParagraph,this.oja),pa.pa(ja.a.strikethrough,I.a.endOfParagraph,this.oja),pa.pa(ja.a.As,I.a.endOfParagraph,this.oja)),pa.pa(ja.a.BL,I.a.endOfParagraph,this.oja),pa.pa(ja.a.kM,I.a.endOfParagraph,this.oja));const Ja=ta.App.h3a.pwd(nb=>
ha.OutlineElementGeneralizer.Hka(nb.ib,!0));pa.gb(ja.a.DUe,I.a.view,this.hQl,100);pa.gb(ja.a.z1c,I.a.Fd,this.z1c,1028);pa.pa(ja.a.c1a,I.a.view,this.yGi);pa.pa(ja.a.iVc,I.a.view,this.yGi);pa.pa(ja.a.ena,I.a.view,Ja);pa.pa(ja.a.ena,I.a.paragraph,this.ena);pa.pa(ja.a.ena,I.a.image,this.U$m);pa.pa(ja.a.ena,I.a.unsupportedObject,Ya);pa.pa(ja.a.ena,I.a.table,this.$an);pa.pa(ja.a.g1a,I.a.view,Ja);pa.pa(ja.a.g1a,I.a.paragraph,this.g1a);pa.pa(ja.a.g1a,I.a.table,this.abn);pa.Vc(ja.a.c1a,99);pa.Vc(ja.a.iVc,
1127);pa.Vc(ja.a.ena,97);pa.Vc(ja.a.g1a,97);this.$K(pa,ja.a.font);this.$K(pa,ja.a.Pv);this.$K(pa,ja.a.BL);this.$K(pa,ja.a.kM);pa.d$a(ja.a.WHh,I.a.view,this.FPe);pa.Vc(ja.a.WHh,1092);this.$K(pa,ja.a.Is);this.$K(pa,ja.a.tga);this.$K(pa,ja.a.B5);this.$K(pa,ja.a.zX);this.$K(pa,ja.a.l7);this.$K(pa,ja.a.BVa);this.$K(pa,ja.a.lJa);this.$K(pa,ja.a.mJa);this.$K(pa,ja.a.Uya);this.$K(pa,ja.a.CVa);this.$K(pa,ja.a.Gja);this.$K(pa,ja.a.bold);pa.OIb(ja.a.bold,this.dzb);this.$K(pa,ja.a.setItalic);pa.OIb(ja.a.setItalic,
this.dzb);this.$K(pa,ja.a.underline);pa.OIb(ja.a.underline,this.dzb);this.$K(pa,ja.a.yga);this.$K(pa,ja.a.superscript);pa.OIb(ja.a.superscript,this.dzb);this.$K(pa,ja.a.subscript);pa.OIb(ja.a.subscript,this.dzb);this.$K(pa,ja.a.strikethrough);pa.OIb(ja.a.strikethrough,this.dzb);this.$K(pa,ja.a.As);pa.OIb(ja.a.As,this.dzb);pa.gb(ja.a.nZa,I.a.Fd,this.Wqd,96);pa.d$a(ja.a.m7,I.a.view,this.FPe);pa.pa(ja.a.m7,I.a.paragraph,this.VPe);pa.pa(ja.a.m7,I.a.Fd,this.Wqd);pa.pa(ja.a.m7,I.a.Wc,this.NPe);pa.pa(ja.a.clearFormatting,
I.a.view,this.Huk);pa.pa(ja.a.clearFormatting,I.a.paragraph,this.Guk);pa.pa(ja.a.clearFormatting,I.a.Fd,this.Wqd);pa.pa(ja.a.clearFormatting,I.a.Wc,this.NPe);pa.Vc(ja.a.clearFormatting,1036);pa.pa(ja.a.kab,I.a.Fd,this.kab);pa.pa(ja.a.kab,I.a.Wc,this.kab);pa.pa(ja.a.jAc,I.a.view,this.jAc);pa.pa(ja.a.qJb,I.a.view,Oa.a.yv);pa.pa(ja.a.qJb,I.a.paragraph,this.VPe);pa.pa(ja.a.qJb,I.a.unsupportedObject,this.Obh);pa.Vc(ja.a.qJb,1028);pa.pa(ja.a.rJb,I.a.view,Oa.a.yv);pa.pa(ja.a.rJb,I.a.paragraph,this.VPe);
pa.pa(ja.a.rJb,I.a.unsupportedObject,this.Obh);pa.Vc(ja.a.rJb,1028)}$K(pa,Ya){pa.d$a(Ya,I.a.view,this.FPe);pa.pa(Ya,I.a.Fd,this.Wqd);pa.pa(Ya,I.a.Wc,this.NPe);pa.Vc(Ya,1036)}mAk(pa,Ya){for(const Vb of pa)for(const mc of Vb){pa=null;if(mc.contextId===I.a.Fd){if(sa.b(mc))continue;pa=[];var Ja=mc.node.qa;if(Ja){var nb=Ja.length-1;const ob=mc.cpBegin,cb=mc.cpEnd;let db=!1;const kb=mc.node.characterData;if(kb&&""!==kb){var Bb=kb.substr(ob,cb-ob);Bb&&""!==Bb&&w.a.QXe(Bb,0,Bb.length)&&(db=!0)}Bb=!1;for(let Wb=
0;Wb<nb;Wb++){var mb=Ja.J(Wb).cp,Qb=Ja.J(Wb+1).cp;if(Ja.J(Wb).formatting&&Math.max(mb,ob)<Math.min(Qb,cb)){if(kb&&""!==kb&&(mb=mb<ob?ob:mb,Qb=kb.substr(mb,(Qb<cb?Qb:cb)-mb),!db&&w.a.QXe(Qb,0,Qb.length)))continue;Bb=!0;pa.push(Ja.J(Wb).formatting)}else if(Bb)break}Ja.J(nb).formatting&&mc.cpEnd>Ja.J(nb).cp&&pa.push(Ja.J(nb).formatting)}}else if(mc.contextId===I.a.paragraph&&!na.ParagraphReader.KW(mc)){if(pa=[],Ja=mc.node.qa)for(nb=0;nb<Ja.length;nb++)Ja.J(nb).formatting&&pa.push(Ja.J(nb).formatting)}else if(mc.contextId===
I.a.endOfParagraph)pa=[P.FormattingReader.Ds(mc)];else if(mc.contextId===I.a.Wc){this.C$m(mc,Ya);return}if(pa&&0<pa.length)for(const ob of pa)if(P.FormattingReader.D6f(Ya,ob.cache,mc))return}}C$m(pa,Ya){if(pa=P.FormattingReader.Ds(pa)){pa=pa.cache;var Ja=oa.Rj.xL(z.a.bold,pa.isBold);Ya.bold=Ja?1:0;Ja=oa.Rj.xL(z.a.italic,pa.isItalic);Ya.italic=Ja?1:0;Ja=oa.Rj.xL(z.a.underline,pa.isUnderline);Ya.underline=Ja?1:0;Ya.underlineType=oa.Rj.xL(z.a.underlineType,pa.underlineType);Ja=oa.Rj.xL(z.a.superscript,
pa.isSuperscript);Ya.superscript=Ja?1:0;Ja=oa.Rj.xL(z.a.subscript,pa.isSubscript);Ya.subscript=Ja?1:0;Ja=oa.Rj.xL(z.a.strikethrough,pa.isStrikethrough);Ya.strikethrough=Ja?1:0;Ja=oa.Rj.xL(B.a.As,pa.isDoubleStrikethrough);Ya.As=Ja?1:0;Ja=oa.Rj.xL(z.a.font,pa.KG);Ya.fontName=ua.a.LXa(Ja);Ya.F7=pa.we;Ya.fontSize=oa.Rj.xL(z.a.fontSize,pa.fontSize);Ya.fontColor=oa.Rj.xL(z.a.fontColor,pa.fontColor);Ya.highlight=oa.Rj.xL(z.a.highlight,pa.highlight)}}nTn(pa){return pa===ja.a.underline||pa===ja.a.yga||pa===
ja.a.strikethrough||pa===ja.a.As||pa===ja.a.zX}static Jcf(pa){return"string"===typeof pa?{fontName:pa,F7:-1,bold:2,italic:2}:pa}m1(pa,Ya,Ja){var nb;const Bb=pa.cpBegin,mb=pa.cpEnd,Qb=pa.node;let Vb=P.FormattingReader.Ds(pa),mc=Bb;const ob=null===(nb=m.AFrameworkApplication.K)||void 0===nb?void 0:nb.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);if(Va.has(Ya))for(const cb of Qb.qa)if(!(cb.cp<=Bb)){if(cb.cp>=mb)break;cb.formatting&&cb.formatting.cache.fontSize!=Vb.cache.fontSize&&
(nb=this.JPh(pa.node,Vb,Ya,Ja),this.Yba.annotateRange(pa.node,ob?Qb.qa.NWa(mc):mc,ob?Qb.qa.NWa(cb.cp):cb.cp,nb),mc=cb.cp,Vb=cb.formatting)}Ya=this.JPh(pa.node,Vb,Ya,Ja);this.Yba.annotateRange(pa.node,ob?Qb.qa.NWa(mc):mc,ob?Qb.qa.NWa(mb):mb,Ya)}JPh(pa,Ya,Ja,nb){const Bb={},mb=Object(K.a)(27,nb),Qb=Ya.cache;switch(Ja){case ja.a.bold:2===nb.value&&(nb.value=Qb.isBold?0:1);Bb[z.a.bold.id]=1===nb.value;break;case ja.a.setItalic:2===nb.value&&(nb.value=Qb.isItalic?0:1);Bb[z.a.italic.id]=1===nb.value;break;
case ja.a.underline:2===nb.value&&(nb.value=Qb.isUnderline?0:1);Bb[z.a.underline.id]=1===nb.value;break;case ja.a.yga:Bb[z.a.underlineType.id]=nb.number;break;case ja.a.superscript:2===nb.value&&(nb.value=Qb.isSuperscript?0:1);Bb[z.a.superscript.id]=1===nb.value;break;case ja.a.subscript:2===nb.value&&(nb.value=Qb.isSubscript?0:1);Bb[z.a.subscript.id]=1===nb.value;break;case ja.a.strikethrough:6!==m.AFrameworkApplication.ya.yG?F.ULS.sendTraceTag(529090079,340,50,"User used strikethrough from ribbon"):
F.ULS.sendTraceTag(529090080,340,50,"User used strikethrough from keyboard shortcut");2===nb.value&&(nb.value=Qb.isStrikethrough?0:1);Bb[z.a.strikethrough.id]=1===nb.value;break;case ja.a.As:2===nb.value&&(nb.value=Qb.isDoubleStrikethrough?0:1);Bb[B.a.As.id]=1===nb.value;break;case ja.a.font:if(mb&&mb.Bd){const {fontName:mc,F7:ob,bold:cb,italic:db}=oa.Jcf(mb.Bd);nb=mc.substr(0,oa.toi);this.nCd&&(Bb[G.a.q5.id]=nb,Bb[G.a.hF.id]=nb,Bb[G.a.z9.id]=nb,Bb[G.a.r$.id]=nb,Bb[G.a.Ne.id]=ob,Bb[G.a.$e.id]=ob,
Bb[G.a.Oe.id]=ob,Bb[G.a.Pe.id]=ob);Bb[z.a.font.id]=nb;Bb[G.a.we.id]=ob;if(Object(ka.a)()){nb=1==cb;var Vb=1==db;if(nb||Vb)Bb[z.a.bold.id]=nb,Bb[z.a.italic.id]=Vb}}break;case ja.a.Is:nb=Eb.a.instance.Zya(pa,nb);Bb[z.a.fontColor.id]=nb;break;case ja.a.tga:Vb=Eb.a.instance.Zya(pa,nb);Bb[z.a.fontColor.id]=Vb;this.recentColors.g$a(nb)||F.ULS.sendTraceTag(529006977,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ja.a.B5:Bb[z.a.fontColor.id]=bc.a.auto;break;case ja.a.zX:Bb[z.a.highlight.id]=
parseInt(nb,16);break;case ja.a.l7:Bb[z.a.highlight.id]=parseInt(nb,16);this.recentColors.g$a(nb)||F.ULS.sendTraceTag(529006978,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ja.a.Gja:Bb[z.a.highlight.id]=bc.a.auto;break;case ja.a.Pv:Bb[z.a.fontSize.id]=oa.ui.aZb(mb.Bd);break;case ja.a.BL:Bb[z.a.fontSize.id]=this.wtl(Qb.fontSize);break;case ja.a.kM:Bb[z.a.fontSize.id]=this.enl(Qb.fontSize);break;case ja.a.nZa:if(nb=null===(Vb=oa.Cw)||void 0===Vb?void 0:Vb.nZa)for(const mc of nb.Mj())Bb[mc.id]=
nb.Og(mc);break;case ja.a.clearFormatting:if(nb=Ya.Xm)for(const mc of nb.Mj())Bb[mc.id]=null;Bb[G.a.jwb.id]=!0;break;case ja.a.lJa:case ja.a.mJa:case ja.a.BVa:case ja.a.Uya:case ja.a.CVa:Qb.uLa&&2===Qb.capitalization&&(Bb[B.a.capitalization.id]=0)}return Bb}wtl(pa){pa=oa.ui.BL(pa);return oa.ui.aZb(pa)}enl(pa){pa=oa.ui.kM(pa);return oa.ui.aZb(pa)}gdc(pa,Ya,Ja,nb){var Bb=pa.cache;const mb=Object(K.a)(27,Ja);switch(Ya){case ja.a.bold:2===Ja.value&&(Ja.value=Bb.isBold?0:1);oa.ui.KF(pa,1===Ja.value);break;
case ja.a.setItalic:2===Ja.value&&(Ja.value=Bb.isItalic?0:1);oa.ui.setItalic(pa,1===Ja.value);break;case ja.a.underline:2===Ja.value&&(Ja.value=Bb.isUnderline?0:1);oa.ui.o3(pa,1===Ja.value);break;case ja.a.yga:oa.ui.yga(pa,Ja);break;case ja.a.superscript:2===Ja.value&&(Ja.value=Bb.isSuperscript?0:1);oa.ui.Uaa(pa,1===Ja.value);break;case ja.a.subscript:2===Ja.value&&(Ja.value=Bb.isSubscript?0:1);oa.ui.Gna(pa,1===Ja.value);break;case ja.a.strikethrough:6!==m.AFrameworkApplication.ya.yG?F.ULS.sendTraceTag(539305613,
340,50,"User used strikethrough from ribbon"):F.ULS.sendTraceTag(539305614,340,50,"User used strikethrough from keyboard shortcut");2===Ja.value&&(Ja.value=Bb.isStrikethrough?0:1);oa.ui.r7(pa,1===Ja.value);break;case ja.a.As:2===Ja.value&&(Ja.value=Bb.isDoubleStrikethrough?0:1);oa.ui.kdc(pa,1===Ja.value);break;case ja.a.font:if(mb&&mb.Bd){const {fontName:Qb,F7:Vb,bold:mc,italic:ob}=oa.Jcf(mb.Bd);oa.ui.k_(pa,Qb.substr(0,oa.toi));oa.ui.Ddc(pa,Vb);Object(ka.a)()&&(Ja=1==mc,nb=1==ob,Ja||nb)&&(oa.ui.KF(pa,
Ja),oa.ui.setItalic(pa,nb))}break;case ja.a.Is:F.ULS.sendTraceTag(595153825,340,50,"Font color is selected from Standard/Theme colors.");oa.ui.Is(pa,Ja,null);break;case ja.a.tga:oa.ui.Is(pa,Ja,null);this.recentColors.g$a(Ja)||F.ULS.sendTraceTag(594899727,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ja.a.B5:oa.ui.B5(pa);break;case ja.a.zX:F.ULS.sendTraceTag(594899726,340,50,"Font background color is selected from Standard colors.");oa.ui.kva(pa,Ja);break;case ja.a.l7:oa.ui.kva(pa,
Ja);this.recentColors.g$a(Ja)||F.ULS.sendTraceTag(594899724,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ja.a.Gja:oa.ui.Std(pa);break;case ja.a.Pv:oa.ui.Pv(pa,mb.Bd);break;case ja.a.BL:oa.ui.V0h(pa);break;case ja.a.kM:oa.ui.X3i(pa);break;case ja.a.m7:Bb=Ja.ia(G.a.noProof,!1);oa.ui.TWf(pa,Ja.getValue(z.a.eE),nb,Bb);break;case ja.a.nZa:oa.ui.p5d(pa);break;case ja.a.clearFormatting:oa.ui.Fja(pa);break;case ja.a.lJa:case ja.a.mJa:case ja.a.BVa:case ja.a.Uya:case ja.a.CVa:Bb.uLa&&
2===Bb.capitalization&&oa.ui.wuk(pa)}}von(pa,Ya){ja.a.clearFormatting===Ya&&X.OutlineElementNavigator.Uk(pa).properties.removeProperty(z.a.oX)}Pfj(pa,Ya,Ja){const nb=Object(K.a)(27,Ya);switch(pa){case ja.a.Is:oa.jma.Is(Ja,Ya);break;case ja.a.tga:oa.jma.Is(Ja,Ya);break;case ja.a.Pv:oa.jma.Pv(Ja,nb.Bd);break;case ja.a.B5:oa.jma.B5(Ja);break;case ja.a.BL:oa.jma.BL(Ja);break;case ja.a.kM:oa.jma.kM(Ja);break;case ja.a.font:oa.jma.UHn(Ja,nb.Bd);break;case ja.a.bold:pa=this.Vbc(Ya,z.a.bold,Ja);oa.jma.KF(Ja,
pa);break;case ja.a.setItalic:pa=this.Vbc(Ya,z.a.italic,Ja);oa.jma.setItalic(Ja,pa);break;case ja.a.subscript:pa=this.Vbc(Ya,z.a.subscript,Ja);oa.jma.Gna(Ja,pa);break;case ja.a.superscript:pa=this.Vbc(Ya,z.a.superscript,Ja);oa.jma.Uaa(Ja,pa);break;case ja.a.strikethrough:pa=this.Vbc(Ya,z.a.strikethrough,Ja);oa.jma.r7(Ja,pa);break;case ja.a.As:pa=this.Vbc(Ya,B.a.As,Ja),oa.jma.kdc(Ja,pa)}}Vbc(pa,Ya,Ja){2===pa.value&&(pa.value=Ja?Ja.ia(Ya,!1)?0:1:0);return 1===pa.value}zUl(pa,Ya){return this.hch(pa,
Ya)||this.hch(Ya,pa)}hch(pa,Ya){return(1===pa.specialIndentType||!pa.specialIndentType)&&2===Ya.specialIndentType}aBl(pa){pa=R.GraphIterator.$a(pa);pa.Bb(11);fa.moveToCell(pa,0,0);pa.Wd();pa.n$();return pa.currentNode}ijm(pa){return!pa||Pa.SelectionEditor.Km(pa)||1===pa.length&&Pa.SelectionEditor.Ek(pa.Qa)&&!Pa.SelectionEditor.sfb(pa.Qa)?!1:!0}Qli(pa){oa.KXg.xb(pa.contextId)||(F.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",pa.contextId),oa.KXg.Z(pa.contextId,!0))}A8l(pa){return pa===ja.a.BVa||
pa===ja.a.lJa||pa===ja.a.mJa||pa===ja.a.Uya||pa===ja.a.CVa}itd(pa,Ya){const Ja=pa.node,nb=Ja.characterData.substr(pa.cpBegin,pa.cpEnd-pa.cpBegin);this.GT.set("Command",Ya.toString());v.Health.instance.recordKpiUsage(this.kpiName,1,this.S5,this.GT);Ya=oa.n5n(nb,Ya);Ja.iva(Ja.characterData.substr(0,pa.cpBegin)+Ya+Ja.characterData.substr(pa.cpEnd));return 32}static get ui(){return null!=oa.Uig?oa.Uig:oa.Uig=r.a.instance.resolve("Box4.IFormattingEditor")}static get characterPropertiesEditor(){return null!=
oa.Jfg?oa.Jfg:oa.Jfg=r.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get paragraphEditor(){return null!=oa.Png?oa.Png:oa.Png=r.a.instance.resolve("Box4.IParagraphEditor")}static get JT(){return null!=oa.Xlg?oa.Xlg:oa.Xlg=r.a.instance.resolve("Box4.ILineSpacingHelper")}static get nKb(){return null!=oa.epg?oa.epg:oa.epg=r.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get B7(){return null!=oa.apg?oa.apg:oa.apg=r.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get eh(){return null!=
oa.gng?oa.gng:oa.gng=r.a.instance.resolve("Box4.IOutlineElementEditor")}static get Rj(){return oa.Cw||(oa.Cw=r.a.instance.resolve("Box4.IInsertionPointFormatting"))}static get jma(){return null!=oa.jmg?oa.jmg:oa.jmg=r.a.instance.resolve("Box4.List.IListFormattingEditor")}static get Yx(){return null!=oa.Wng?oa.Wng:oa.Wng=r.a.instance.resolve("Box4.IParagraphIndentationReader")}static mw(){return oa.Cm||(oa.Cm=r.a.instance.Za("Box4.IExternalSelectionManager"))}static get Tg(){return Ca.ContextSetEditor.instance}static get Zf(){return Ia.a.instance}static get Lc(){return u.a.instance}static get Pb(){return null!=
oa.Rhg?oa.Rhg:oa.Rhg=r.a.instance.Pa("Box4.IFeatureHelper")}static get SUc(){return ta.App.tK}static get Rd(){return null!=oa.Aqg?oa.Aqg:oa.Aqg=r.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Hk(){return null!=oa.eqg?oa.eqg:oa.eqg=r.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get f3a(){return null!=oa.Qpg?oa.Qpg:oa.Qpg=r.a.instance.resolve("Box4.TextFormattingHelper")}static get hd(){return null!=oa.rmg?oa.rmg:oa.rmg=r.a.instance.resolve("Box4.List.IListReader")}static get Jo(){return null!=
oa.bmg?oa.bmg:oa.bmg=r.a.instance.resolve("Box4.List.IListEditor")}static get Sg(){return ca.a.instance}static oml(pa,Ya){return 42===pa?Ya:pa!==Ya||16===pa?16:pa}static U9g(pa,Ya){pa.XMd||(Ya.XMd?Ya=pa:Ya.unit===pa.unit&&l.a.DZ(Ya.value,pa.value)||(Ya.value=-1));return Ya}static n5n(pa,Ya){switch(Ya){case ja.a.lJa:return pa.toLowerCase();case ja.a.mJa:return 6!==m.AFrameworkApplication.ya.yG?F.ULS.sendTraceTag(539305615,340,50,"User changed the case via ribbon"):F.ULS.sendTraceTag(539305616,340,
50,"User changed the case from keyboard shortcut"),pa.toUpperCase();case ja.a.BVa:case ja.a.Uya:return oa.qrk(pa,Ya===ja.a.Uya);case ja.a.CVa:return oa.t7n(pa);default:return pa}}static t7n(pa){let Ya="";for(let Ja=0;Ja<pa.length;Ja++)Ya=pa.charAt(Ja)===pa.charAt(Ja).toUpperCase()?Ya+pa.charAt(Ja).toLowerCase():Ya+pa.charAt(Ja).toUpperCase();return Ya}static qrk(pa,Ya){let Ja,nb,Bb=!0,mb=pa.length,Qb=0,Vb=oa.psf(pa,Qb,mb);for(;0<mb;){nb=Ja=!1;var mc=mb;let cb;var ob=void 0;for(ob=0;0<mc&&oa.Itk(pa.charAt(Qb+
ob));ob++,mc--)nb=oa.ZOd(pa.charAt(Qb+ob));for(cb=ob;0<mc&&!(Ja=oa.ZOd(pa.charAt(Qb+ob)))&&" "!==pa.charAt(Qb+ob)&&"/"!==pa.charAt(Qb+ob);ob++,mc--);mc=ob-cb;if(0>=mc)break;Qb+=cb;ob=pa.substr(Qb,mc);ob=ob===ob.toUpperCase();if(Vb||!ob)pa=Bb||nb||Ya?pa.substr(0,Qb)+pa.charAt(Qb).toUpperCase()+pa.substr(Qb+1,mc-1).toLowerCase()+pa.substr(Qb+mc):pa.substr(0,Qb)+pa.substr(Qb,mc).toLowerCase()+pa.substr(Qb+mc);mb-=mc+cb;Qb+=mc;if(Bb=Ja)Qb++,mb--,Vb=oa.psf(pa,Qb,mb)}return pa}static psf(pa,Ya,Ja){for(;0<
Ja&&!oa.ZOd(pa.charAt(Ya));){if(pa.charAt(Ya)!==pa.charAt(Ya).toUpperCase())return!1;Ya++;Ja--}return!0}static ejm(pa,Ya){for(var Ja=0;0<Ya&&!oa.ZOd(pa.charAt(Ja));){if(pa.charAt(Ja)!==pa.charAt(Ja).toLowerCase())return!1;Ja++;Ya--}return!0}static ZOd(pa){return"."===pa||"!"===pa||"?"===pa?!0:!1}static Itk(pa){return-1==="0123456789".indexOf(pa)&&pa.toUpperCase()===pa.toLowerCase()}}oa.KXg=new J.a;oa.Cw=null;oa.Cm=null;oa.toi=31;Object(D.a)(oa,"TextFormattingActor",null,[])},1884:function(D,M,d){d.d(M,
"a",function(){return m});const m=(f,a)=>{var l=f.Msj;if(!l){l=[];for(var r in f)"string"===typeof r&&l.push({key:r,value:f[r]});l.sort((w,v)=>w.value-v.value);f.Msj=l}l=[];for(r=1;0<a;)a&1&&f[r]&&l.push(f[r]),r<<=1,a>>=1;if(l.length&&0===a)return l.reverse().join(", ")}},1886:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);var m;(function(f){f[f.chrome=0]="chrome";f[f.edge=1]="edge";f[f.firefox=2]="firefox";f[f.IE=3]="IE";f[f.safari=4]="safari";f[f.others=5]="others";f[f.unknown=6]="unknown";
f[f.electron=7]="electron";f[f.chromiumEdge=8]="chromiumEdge";f[f.teamsElectron=9]="teamsElectron"})(m||(m={}));Object(D.b)("BrowserCode",m)},1888:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(D.a)(m,"AtMentionAttributes",null,[])},1894:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);var m;(function(f){f[f.initial=0]="initial";f[f.startSearch=1]="startSearch";f[f.searching=2]="searching";f[f.searchComplete=
3]="searchComplete";f[f.replaceAllInProgress=4]="replaceAllInProgress";f[f.replaceAllComplete=5]="replaceAllComplete";f[f.tooManyResults=6]="tooManyResults";f[f.noMatchesFound=7]="noMatchesFound"})(m||(m={}));Object(D.b)("FindReplaceViewType",m)},1896:function(D,M,d){d.d(M,"a",function(){return m});var m;(function(f){f[f.initial=0]="initial";f[f.headings=1]="headings";f[f.find=2]="find";f[f.replace=3]="replace";f[f.intelligentPlaceholder=4]="intelligentPlaceholder";f[f.contracts=5]="contracts"})(m||
(m={}))},1910:function(D,M,d){function m(b,h){h=Object.assign(new ca.a,{name:"LinkType",string:h});f(Db.a.G3l,b,[h])}function f(b,h,n,x=!0){h&&h.UILocation&&Object(Pe.d)(b,x,Pe.e,0,h.UILocation,0,n)}function a(b,h){var n;return b===fs.none?"none":null===(n=Vv[b])||void 0===n?void 0:n[h]}function l(b,h,n){return{type:"ShortcutDiscoverySettingsModel",actionId:b,B0i:h,label:n}}d.r(M);var r=d(0),w=d(8),v=d(43),u=d(2),z=d(35),B=d(16),G=d(163),F=d(86);class K{constructor(b){this.a4f=0;this.pBb=this.Kac=
this.N2a=null;this.HX=u.AFrameworkApplication.ua.iq;this.EW=b;this.EW.vv(F.a.SWi);this.EW.VB(F.a.SWi,Object(v.a)(this,this.$Tm,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.pBb)return w.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.pBb;this.N2a=this.HX.fg("ComponentAttach","getCustomAuthConfig");return this.pBb=new Promise((b,h)=>{const n={};let x=!1,E=!1,S=0;this.a4f=window.setInterval(()=>{4>S?(S++,this.EW.sendMessage(F.a.getCustomAuthConfig,n)):(window.clearInterval(this.a4f),
x=!0,w.ULS.sendTraceTag(588087303,344,10,z.c({["error"]:"Request timeout after 4 retries."})),h("Request timeout."))},1E3);this.Kac=(ma,Fa)=>{window.clearInterval(this.a4f);x||E||(E=!0,ma?(w.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),b(ma)):(w.ULS.sendTraceTag(589050654,369,10,z.c({["error"]:Fa.toString()})),h(Fa)))};this.EW.sendMessage(F.a.getCustomAuthConfig,n)})}$Tm(b){try{const h=z.a(b.Values[G.a.Pmk]);let n=u.AFrameworkApplication.K.lb("Application")||"";n=B.a.mh(n);
h.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+n+"%3Facctsw%3D1&prompt=select_account";h.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+n+"%3Facctsw%3D1";h.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+n+"%3Facctsw%3D1&prompt=select_account";h.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+n+"%3Facctsw%3D1";this.N2a&&(this.N2a.stop(),this.N2a=null);this.Kac(h,"")}catch(h){w.ULS.sendTraceTag(589050655,344,10,z.c({["error"]:h.message,["stack"]:h.stack})),
this.Kac(null,h.message)}}}Object(r.a)(K,"AccountSwitchingManager",null,[140]);var N=d(177);class H{get name(){return"Common.App.AccountSwitching"}zc(b){b.register(K,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").singleInstance().Xd(()=>new K(b.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){N.a.instance.Pc(new H)}}Object(r.a)(H,"AccountSwitchingPackage",null,[1,2]);var J;(function(b){b[b.generalException=0]=
"generalException";b[b.invalidArgument=1]="invalidArgument";b[b.notAllowed=2]="notAllowed";b[b.apiNotAvailable=3]="apiNotAvailable";b[b.unresolvedPendingRequest=4]="unresolvedPendingRequest";b[b.timeout=5]="timeout";b[b.adalTimeout=6]="adalTimeout";b[b.userNotSignedIn=7]="userNotSignedIn";b[b.userAborted=8]="userAborted";b[b.silentSignInFailed=9]="silentSignInFailed";b[b.invalidResourceUrl=10]="invalidResourceUrl";b[b.invalidGrant=11]="invalidGrant";b[b.connectionLost=12]="connectionLost";b[b.clientError=
13]="clientError";b[b.serverError=14]="serverError"})(J||(J={}));Object(r.b)("ErrorCodes",J);d(1727);class L{constructor(b,h){this.requestCallback=this.requestParameters=null;this.requestParameters=b;this.requestCallback=h}}Object(r.a)(L,"OutstandingRequest",null,[]);class I{}I.RJm="AADSTS50058";I.invalidResourceUrl="AADSTS50001";I.KJm="AADSTS65001";I.rKm="AADSTS70011";I.userAborted="13002";I.n4m="Popup Window is null";I.m4m="Popup Window closed";I.adalTimeout="Token renewal operation failed due to timeout";
I.B7n="tokenRevoked";Object(r.a)(I,"WopiHostErrorType",null,[]);var R=d(1480),C=d(59),P=d(1726);class W{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(r.a)(W,"WopiIdentityInfo",null,[717]);class X{constructor(b,h,n){this.expiration=this.authority=this.accessToken=null;this.accessToken=b;this.authority=h;this.expiration=n}}Object(r.a)(X,"WopiIdentityToken",null,[715]);var V=d(15),Y=d(137),ca=d(36),fa=d(178);class sa{constructor(b){this._initialized=
!1;this.H$b={};this.Q8d={};this.HX=u.AFrameworkApplication.ua.iq;this.pkf=b}M5e(b){this._initialized||(b.vv(F.a.QDi),b.VB(F.a.QDi,Object(v.a)(this,this.ZTm,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(b,h,n=null){this.rCa(b,h);return new Promise((x,E)=>{if(this.Gnf(h))if(h in this.H$b)E("unresolvedPendingRequest");else{var S=window.setTimeout(()=>{w.ULS.sendTraceTag(37856032,344,10,z.c({["error"]:"Request timeout.",["callerId"]:h}));E("timeout")},12E4);this.x$e(b,h,n,(ma,Fa)=>{window.clearTimeout(S);
ma?x(ma):(w.ULS.sendTraceTag(37856033,369,15,z.c({["error"]:J[Fa]})),E(Fa))})}else w.ULS.sendTraceTag(37856034,344,10,z.c({["error"]:"Caller is not allowed."})),E("notAllowed")})}getPrimaryIdentityInfo(b){return new Promise((h,n)=>{this.Gnf(b)?this.bDl((x,E)=>{x?h(x):(w.ULS.sendTraceTag(37856064,369,10,z.c({["error"]:E.toString()})),n(E))}):(w.ULS.sendTraceTag(37856065,344,10,z.c({["error"]:"Caller is not allowed."})),n("notAllowed"))})}getAuthContext(b){return new Promise((h,n)=>{const x=this.getAuthContextSync(b);
x?h(x):n("notAllowed")})}getAuthContextSync(b){if(this.Gnf(b)){const h=new P.a;h.upn=u.AFrameworkApplication.K.lb("UserPrincipalName");h.userId=u.AFrameworkApplication.K.lb("LoggableUserId");h.authority=u.AFrameworkApplication.K.lb("HostAuthAuthority");h.tenantId=u.AFrameworkApplication.K.lb("TenantId");h.isAnonymous=u.AFrameworkApplication.K.$("IsAnonymousUser");h.supportsAuthToken=this.oXl(b);b=u.AFrameworkApplication.K.lb("HostAuthType");h.authorityType="aad"===b.toLowerCase()?2:"msa"===b.toLowerCase()?
1:0;return h}w.ULS.sendTraceTag(40751647,344,10,z.c({["error"]:"Caller is not allowed."}));return null}oXl(b){const h=R.a.vKc;return V.a.vMa?h&&R.a.e9i?Array.contains(R.a.e9i,b.toLowerCase()):!1:h}x$e(b,h,n,x){var E=[];Array.add(E,Object.assign(new ca.a,{name:"CallerId",string:h}));Array.add(E,Object.assign(new ca.a,{name:G.a.F0f,string:b.correlationId}));Y.a.sendTelemetryEvent(Object.assign(new fa.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:E}));E=C.a.create().toString();
const S="getAccessToken_"+E,ma=this.HX.fg("ComponentAttach",S);this.Q8d[S]=ma;const Fa={};Fa[G.a.G0f]=E;Fa[G.a.VZn]=b.resource;Fa[G.a.WZn]=b.scope;Fa[G.a.H5i]=u.AFrameworkApplication.K.lb("HostAuthType");Fa[G.a.ZZn]=u.AFrameworkApplication.K.lb("UserPrincipalName");Fa[G.a.XZn]=b.silentLogin;Fa[G.a.SZn]=b.options;Fa[G.a.F0f]=b.correlationId;Fa[G.a.TZn]=h;n&&(Fa[G.a.addinName]=n.AddinName,Fa[G.a.RZn]=n.AddinTrustId);this.pkf.execute($a=>{this.M5e($a);$a.sendMessage(F.a.getAuthToken,Fa)});this.H$b[E]=
new L(b,x)}bDl(b){const h=u.AFrameworkApplication.K.lb("UserName"),n=u.AFrameworkApplication.K.lb("UserPrincipalName"),x=u.AFrameworkApplication.K.lb("LoggableUserIdSpace"),E=new W;E.email=n;E.displayName=h;switch(x){case "OrgIdPuid":E.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":E.authority="MicrosoftAccount";break;default:E.authority=x}b(E,null)}ZTm(b){let h=null;try{let x=b.Values[G.a.G0f];const E=b.Values[G.a.QZn],S=b.Values[G.a.H5i],ma=b.Values[G.a.YZn];let Fa=null,
$a=null;const sb=this.H$b[x];if("undefined"!==typeof sb&&sb){var n=[];Array.add(n,Object.assign(new ca.a,{name:G.a.F0f,string:sb.requestParameters.correlationId}));Y.a.sendTelemetryEvent(Object.assign(new fa.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:n}));h=sb.requestCallback;delete this.H$b[x];"undefined"!==typeof E&&E&&E.length?$a=new X(E,S,ma):Fa=J[this.sCm(b)];n="getAccessToken_"+x;n in this.Q8d&&(this.Q8d[n].stop(),delete this.Q8d[n]);h($a,Fa)}else w.ULS.sendTraceTag(37856066,
344,10,z.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:x}))}catch(x){b=b.Values[G.a.G0f],b in this.H$b&&delete this.H$b[b],this.XRd(),w.ULS.sendTraceTag(37856067,344,10,z.c({["error"]:x.message,["stack"]:x.stack})),h&&h(null,"generalException")}}Gnf(b){var h=u.AFrameworkApplication.vOl();b=b.toLowerCase();for(const n of h)if(b===n.toLowerCase())return!0;h=R.a.pPe;for(let n in h)if(b===h[n].toLowerCase())return!0;return!1}sCm(b){b=b.Values[G.a.UZn];this.XRd();w.ULS.sendTraceTag(39068821,
344,15,z.c({["error"]:b}));return b?-1<b.indexOf(I.RJm)?9:-1<b.indexOf(I.n4m)||-1<b.indexOf(I.m4m)?12:-1<b.indexOf(I.invalidResourceUrl)?10:-1<b.indexOf(I.userAborted)?8:-1<b.indexOf(I.rKm)||-1<b.indexOf(I.KJm)||b===I.B7n?11:-1<b.indexOf(I.adalTimeout)?6:0:13}rCa(b,h){b=this.ohn(b.resource);w.ULS.sendTraceTag(39921882,344,50,z.c({["callerId"]:h,["resource"]:b}))}XRd(){w.ULS.sendTraceTag(39068822,344,50,z.c({["userAgent"]:window.navigator.userAgent}))}ohn(b){return(b?b:"").replace("://","__").replace(RegExp("\\.",
"g"),"_dot_").replace("/","\\")}}Object(r.a)(sa,"WopiIdentityManager",null,[694]);class ia{constructor(){this.W=null}get name(){return"Common.App.WopiIdentity"}zc(b){this.W=b;b.register(sa,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").singleInstance().Xd(()=>new sa(b.Za("Postmessage.IHostPostmessenger")))}init(){u.AFrameworkApplication.K&&u.AFrameworkApplication.K.yq(Object(v.a)(this,this.Ww,"onFullAppSettingsReady"))}Ww(){try{this.W.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(b){w.ULS.sendTraceTag(571074327,
383,10,"Failed to initialize WopiIdentityPackage with exception: "+b)}}dispose(){}static main(){N.a.instance.Pc(new ia)}}Object(r.a)(ia,"WopiIdentityPackage",null,[1,2]);var ea=d(536),da=d(373),ja=d(72),Ga;(function(b){b[b.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";b[b.cloudPolicySettings=1]="cloudPolicySettings";b[b.alternateAuthToken=2]="alternateAuthToken"})(Ga||(Ga={}));Object(r.b)("ApplicationFeatureHelperRequestType",Ga);class ya{constructor(){this.message=null;this.httpStatusCode=
0}}Object(r.a)(ya,"HttpRequstToPromiseRejectData",null,[]);var ta=d(84),ua=d(184);class Sa{constructor(b,h){this.Ma=b;this.hg=h}FZe(b,h,n,x=null,E=null,S=null,ma=null,Fa=null){const $a=Ga[n],sb=$a+"RequestFailure";ta.Health.instance.recordKpiUsage(sb,0,"jpittsdirects",null);return new Promise((Jb,Sb)=>{w.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",$a);const oc=null!=ma?ma:this.Ma.rc("ApplicationFeatureHelperRequestQueueTimeout",
15E3),Ic=null!=Fa?Fa:this.Ma.rc("ApplicationFeatureHelperRequestSentTimeout",3E4);this.hg.oWb(b,1,null,this.bsl(n,x),S,1,gd=>{w.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",$a);try{if(void 0===gd||null===gd||void 0===gd.data||null===gd.data||void 0===gd.data.Ee||null===gd.data.Ee){ta.Health.instance.recordKpiFailure(sb,"Invalid RequestSucceededEventArgs",!1,!0,null);let vd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
$a);Sb(this.GIc(vd,gd))}else if(gd.data.mf!==ua.a.qD){ta.Health.instance.recordKpiFailure(sb,"HttpStatusCode_"+gd.data.mf.toString(),!1,!0,null);let vd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",gd.data.mf,$a);Sb(this.GIc(vd,gd))}else{void 0!==E&&null!==E&&void 0!==gd.data.qj&&null!==gd.data.qj&&E(gd.data.qj);var Gd=h(gd.data.Ee);if(Gd)w.ULS.sendTraceTag(50622690,3004,50,
"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",$a),Jb(Gd);else{ta.Health.instance.recordKpiFailure(sb,"Parse Failure",!1,!0,null);let vd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",$a);Sb(this.GIc(vd,gd))}}}catch(vd){ta.Health.instance.recordKpiFailure(sb,"Unexpected Failure",!1,!0,null),Gd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
vd,$a),Sb(this.GIc(Gd,gd))}},gd=>{let Gd;gd.data?(ta.Health.instance.recordKpiFailure(sb,"HttpStatusCode_"+gd.data.mf.toString(),!1,!0,null),Gd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",gd.data.mf,gd.data.Ee||"No Data",$a)):(ta.Health.instance.recordKpiFailure(sb,"Invalid RequestFailedEventArgs",!1,!0,null),Gd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
$a));Sb(this.GIc(Gd,gd))},void 0,void 0,oc,Ic)})}GIc(b,h){const n=new ya;n.message=b;n.httpStatusCode=h&&h.data?h.data.mf:-1;return n}bsl(b,h){const n={};n["x-UserDataSignature"]=this.Ma.lb("UserDataSignature");n["x-LicensingIsEnabled"]=this.Ma.$("LicensingIsEnabled").toString();n["x-CacheIsEnabled"]=this.Ma.$("LicensingRedisIsEnabled").toString();n["x-OcpsIsEnabled"]=this.Ma.$("OcpsIsEnabled").toString();n["x-LicensingAADIdIsEnabled"]=this.Ma.$("LicensingAadIdIsEnabled").toString();0===b&&(n["x-LicenseCheckOnTenantEnabled"]=
this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksLicenseCheck",!1).toString(),n["x-SupportUserConsentDependentFeatures"]=this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",!1).toString(),n["x-AFHUserConsentGroupValue"]=this.Ma.getIntFeatureGate("Microsoft.Office.SharedOnline.AFHUserConsentGroupValue",0).toString(),n["x-UseShellServiceForUserConsentGroup"]=this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseShellServiceForUserConsentGroup",
!1).toString(),n["x-SMBUserLicensingEnabled"]=this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SMBUserLicensingEnabled",!1).toString());if(h)for(let x of h.keys)n[x]=h.J(x);return n}}Object(r.a)(Sa,"HttpRequestToPromiseUtility",null,[]);var ka;(function(b){b[b.loki=0]="loki";b[b.augloopACLP=1]="augloopACLP"})(ka||(ka={}));Object(r.b)("AlternateAuthSupportApp",ka);class ha{constructor(){this.Token=null;this.ExpirationTime=0}}Object(r.a)(ha,"WacAlternateAuthToken",null,[]);class Ca{constructor(b,
h){this.z7n=3E5;if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ma=b;this.M5c=new ea.a(da.a.Pj());this.boc=new Sa(b,h);void 0!==R.a.Lwf&&null!==R.a.Lwf&&void 0!==R.a.ySd&&null!==R.a.ySd&&0<R.a.ySd&&(b=new ha,b.Token=R.a.Lwf,b.ExpirationTime=R.a.ySd,this.M5c.Z("loki",b))}Tfl(){let b=null;this.M5c.xb(ka[0])&&(b=this.M5c.J(ka[0]));return void 0===b||null===b||this.isTokenExpired(b)?this.x5k():Promise.resolve(b.Token)}isTokenExpired(b){return b.ExpirationTime-
Date.now()<this.z7n}x5k(){const b=new ea.a(da.a.Pj());b.Z("X-AlternateAuthApp",ka[0]);return this.boc.FZe(this.cdb("/afhs/AlternateAuthHelperHandler.ashx"),Object(v.a)(this,this.o0m,"parseAlternateAuthTokenResponse"),2,b).then(h=>{w.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",ka[0]);this.M5c.Z(ka[0],h);return h.Token},h=>{h=Object(ja.a)(ya,h);w.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",
h.message,h.httpStatusCode);return null})}o0m(b){let h=null;({Dv:h}=z.d(b));w.ULS.sendTraceTag(545821457,3004,h?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",b);return h}cdb(b){return String.format("{0}{1}?{2}",this.Ma.lb("WebServiceBase"),b,u.AFrameworkApplication.um)}}Object(r.a)(Ca,"AlternateAuthHelper",null,[675]);var Pa=d(476);class Xa{constructor(b,h,n){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=b;this.isEnabled=h;this.tierName=
n}}Object(r.a)(Xa,"FeatureStateChangeArgs",null,[]);var qa=d(112),Ea=d(192),Ia=d(81),na=d(121),Na;(function(b){b[b.Enabled=0]="Enabled";b[b.Disabled=1]="Disabled"})(Na||(Na={}));Object(r.b)("FeatureState",Na);var Oa=d(22),Ra=d(13),ab=d(166);class zb{constructor(b,h,n=null,x=null,E=null){this.hcb=this.eqa=this.JWg=this.A7a=this.Jld=null;this.boc=new Sa(b,h);this.Ma=b;this.RJj=b.rc("LicensingMaxRetryAttempts",0);this.yte=b.$("IsO365ConsumerHost");this.xte=b.$("IsO365CommercialHost");this.Mcd=b.$("PremiumUpsellIsEnabled");
this.Mwg=n;this.A3g=x;this.ga=E;this.z7a=b.$("LicensingIsEnabled");this.mrb=b.$("OcpsIsEnabled")&&this.xte;this.BKe=b.$("ShowPrivacyDialog")&&!!x;this.Loc=b.$("IsAnonymousUser");this.d7e=new Promise(S=>{S(!1)});this.Clb=new Promise(S=>{S(!0)});this.gcb=new ea.a(da.a.Pj());this.god=this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",!1);this.oNg=this.rvl();this.Nqf()&&!this.Loc?(void 0!==u.AFrameworkApplication.ua&&null!==u.AFrameworkApplication.ua&&(this.Jld=
u.AFrameworkApplication.ua.iq,void 0!==this.Jld&&null!==this.Jld&&(this.A7a=this.Jld.aNa("WebServiceCall","ApplicationFeatureHelperService"))),this.hcb=this.v5f()):this.hcb=new Promise(S=>{S({})});this.hcb.catch(S=>{w.ULS.sendTraceTag(42513088,3004,10,JSON.stringify(S))});this.god&&(this.Mcd=!1,this.isFeatureEnabled("FreemiumUpsell",!0).then(S=>{this.Mcd=this.Ma.$("PremiumUpsellIsEnabled")&&S;return null}))}rvl(){const b=this.Ma.vu("AllLicensedFeatures")?this.Ma.AB("AllLicensedFeatures"):[],h=new Pa.a;
for(let n=0;n<b.length;n++)h.add(b[n]);return h}Nqf(){return this.xte||this.yte}v5f(b=0,h=!1){w.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",h);const n=qa.a.aF();n&&(n.set("retryAttempt",b.toString()),n.set("forceRefresh",h.toString()),n.set("isO365ConsumerHost",this.yte.toString()),n.set("isO365CommercialHost",this.xte.toString()),n.set("isFreemiumUpsellEnabled",this.Mcd.toString()));ta.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest",
"waclicensing",n);ta.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",n);void 0!==this.A7a&&null!==this.A7a&&this.A7a.start();let x=null;h&&(x=new ea.a(da.a.Pj()),x.Z("x-LicensingForceRefresh","true"));this.JWg=new Date;return(this.z7a?this.boc.FZe(this.cdb("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(v.a)(this,this.s0m,"parseApplicationFeatureHelperResponse"),0,x,Object(v.a)(this,this.q7m,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(E=>
{const S=Object.assign(new ab.a,{durationMs:this.B6i()});S.extendedProperties=n;S.extendedProperties&&E&&(S.extendedProperties.set("featureCount",Ia.a.count(E).toString()),S.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in E).toString()),S.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in E).toString()),this.eqa&&S.extendedProperties.set("fromCache",(this.eqa<this.JWg).toString()));ta.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",
S);return E},E=>{const S=Object.assign(new ab.a,{durationMs:this.B6i()}),ma=Object(ja.a)(ya,E);if(!ma)return w.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),ta.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,S),new Promise((Fa,$a)=>{$a(E)});S.extendedProperties=n;S.extendedProperties&&S.extendedProperties.set("status",ma.httpStatusCode.toString());
ta.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,S);return 408===ma.httpStatusCode&&++b<=this.RJj?this.v5f(b):new Promise((Fa,$a)=>{$a(ma)})})}s0m(b){(b=z.b(b))?(w.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),w.ULS.sendTraceTag(50938594,3004,50,"{0}",b)):w.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return b.Features}cdb(b){var h=
String.format("{0}{1}",this.Ma.lb("WebServiceBase"),b);this.Ma.vu("ApplicationFeatureHelperHttpCachingEnabled")&&this.Ma.$("ApplicationFeatureHelperHttpCachingEnabled")&&(b=zb.FFd(this.Ma))&&0<b.length&&(this.god&&(b+="ucbf"),h=new Ea.QueryStringBuilder(h),h.Me("afhskey",b),h=h.toString());return h}isFeatureEnabled(b,h){if(!this.mrb&&!this.BKe&&!this.z7a)return this.Clb;w.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
b);if("ConnectedServices"===b){var n=this.mrb?this.Mwg.Mka("ControllerConnectedServicesEnabled"):this.Clb;const S=this.BKe?this.A3g.getSettings().then(ma=>2!==ma.RH,()=>h):this.Clb;return n.then(ma=>ma?S:this.d7e)}n=null;n=this.mrb?this.Mwg.isFeatureEnabled(b):this.Clb;let x=null;x=this.z7a?this.Pam(b,h):this.Clb;let E=null;E=this.BKe?this.A3g.isFeatureEnabled(b):this.Clb;return n.then(S=>S?E.then(ma=>ma?x:this.d7e):this.d7e).then(S=>{this.Tki(b,S,!0);return S},()=>{this.Tki(b,h,!1);return h})}Tki(b,
h,n){w.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",b,h,n)}getFeatureTier(b,h){if(!this.z7a)return new Promise(n=>{n(2)});w.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",b);return this.hcb.then(n=>this.zHd(b,n,h),()=>h)}isFreemiumUpsellEnabled(){return this.Mcd&&this.yte&&!this.Loc}launchUpsellExperience(b,h=null){w.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",
b));var n=qa.a.aF();n&&(n.set("experienceId",b),h&&n.set("campaignId",h));ta.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",n);if(n=Oa.a.instance.Pa("Common.IInProductMessagingUIManager")){const x=Object(v.a)(this,this.JQl,"handleDimeTaskComplete");n.Iii(b,x,h)}else w.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),ta.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.ga.Xb(Ra.a.OCd,
2,{["experience"]:b})}Rua(b,h){if(!this.z7a)return null;if(!b||!h)return w.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const n=na.a.create().toString();this.gcb.xb(b)||this.gcb.Z(b,new ea.a(da.a.Pj()));this.gcb.J(b).add(n,h);w.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",n,b));return n}zbc(b,h){this.z7a&&(b&&this.gcb.xb(b)?
h&&na.a.Qd(h)?this.gcb.J(b).xb(h)?(w.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",h,b)),this.gcb.J(b).remove(h)):w.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",h,b)):w.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",
h,b)):w.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",b)))}zHd(b,h,n){return this.god?b in h?h[b].LicenseTier:n:b in h?this.c1m(h[b],n):n}c1m(b,h){switch(b.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return h}}JQl(){w.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.hcb.then(b=>{this.QJi(b)}).catch(()=>
{this.QJi({})})}QJi(b){w.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const h=this.v5f(0,!0);h.then(n=>{this.hcb=h;Ia.a.count(n)>Ia.a.count(b)?ta.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):ta.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let x of this.gcb.keys)if(x in n){const E=this.zHd(x,n,0);x in b?this.zHd(x,b,0)!==E&&this.PCf(x,!0,E):this.PCf(x,!0,E)}else x in
b&&this.PCf(x,!1,this.zHd(x,b,0))}).catch(n=>{ta.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);w.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(n))})}PCf(b,h,n){w.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",b,h,n);h=new Xa(b,h,n);n=this.gcb.J(b);for(let x of n)try{x.value(h)}catch(E){w.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",
b,x.key,E.message))}}Oam(b,h){if(this.z7a){const n=this.oNg.contains(b);let x=!0,E="",S=!1;return this.hcb.then(ma=>{b in ma?(ma=ma[b],E=Na[ma.FeatureState],x=1!==ma.FeatureState):x=!n;this.ili(b,n,E,S,h,x);return x},()=>{S=!0;n&&(x=h);this.ili(b,n,E,S,h,x);return x})}return this.Clb}ili(b,h,n,x,E,S){w.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",b,h,x,n,E,S)}Pam(b,h){if(this.god)return this.Oam(b,
h);if(this.z7a){if(this.oNg.contains(b))return this.hcb.then(n=>b in n,()=>h);w.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",b)}return this.Clb}q7m(b){try{b&&"Date"in b&&(this.eqa=new Date(b.Date),w.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.eqa.toString()))}catch(h){w.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",
h)}}B6i(){if(void 0!==this.A7a&&null!==this.A7a){const b=this.A7a.ni;this.A7a.stop();return b}return null}static FFd(b){try{if(V.a.p9d){const h=b.lb("UserDataSignature").split(".");if(1<h.length){const n=window.self.atob(h[1]),x=JSON.parse(n).LocalStorageKey;if(void 0!==x&&null!==x&&0<x.length)return x}}}catch(h){w.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",h.toString())}return null}}Object(r.a)(zb,"ApplicationFeatureHelper",null,[676]);var Qa=d(79);class yb{constructor(b,
h){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=b.PolicySettings;b=new Date;b.setMinutes(b.getMinutes()+h);this.ExpirationTime=b.getTime()}}Object(r.a)(yb,"CloudPolicySettingsCacheData",null,[]);var lb=d(1349),Eb=d(376),bc=d(238);class Pb{static c4i(){return u.AFrameworkApplication.K.$("SideCarIsEnabled")?Pb.n4d&&Pb.NMc?new Promise(b=>{b(!0)}):new Promise((b,h)=>{Pb.n4d=bc.a.create(u.AFrameworkApplication.K.lb("SideCarUrl"));Eb.a.KS(Pb.n4d);Pb.n4d.MV((n,x)=>{(Pb.NMc=x.succeeded)?
b(x.succeeded):h(x.succeeded)})}):new Promise(b=>{b(!1)})}}Pb.NMc=!1;Pb.n4d=null;Object(r.a)(Pb,"SideCarLoader",null,[]);class Va{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(r.a)(Va,"CloudPolicySettingsData",null,[]);class oa{constructor(b,h){this.yie=0;this.nud=null;this.boc=new Sa(b,h);this.Ma=b;h=b.lb("HostAuthType");this.mrb=b.$("OcpsIsEnabled")&&b.$("IsO365CommercialHost")&&!(void 0===h||null===h)&&"aad"===h.toLowerCase();this.bRg=z.b(b.lb("OcpsDefaultSettings")||
"{}");this.uqc=this.FFd();h=this.Ma.vu("ServicesControlsMicrosoftControllerServicesList")?this.Ma.AB("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.U7c=new Pa.a;for(let n=0;n<h.length;n++)this.U7c.add(h[n]);this.mrb&&!b.$("IsAnonymousUser")&&b.$("SideCarIsEnabled")?this.nud=this.aao():this.nud=this.u5f(this.mrb,this.cdb("/afhs/CloudPolicySettings.ashx"),Object(v.a)(this,this.w0m,"parseCloudPolicySettingsResponse"));this.nud.then(()=>null).catch(n=>{w.ULS.sendTraceTag(50622685,3004,
10,JSON.stringify(n))})}Mka(b,h=!0){if(!this.mrb){const S=this;return new Promise(ma=>{ma(S.gIc(b))})}let n=this,x=this;const E=this.nud.then(S=>{try{let ma=null;S.PolicySettings&&"unknown"in S.PolicySettings&&(ma=S.PolicySettings.unknown);if(ma){if(b in ma&&void 0!==ma[b]&&null!==ma[b])return new Promise($a=>{$a("0"!==ma[b])});const Fa=b.toLowerCase();if(Fa in ma&&void 0!==ma[Fa]&&null!==ma[Fa])return new Promise($a=>{$a("0"!==ma[Fa])});w.ULS.sendTraceTag(51512667,3004,50,"Policy"+b+" not found, using default");
return new Promise($a=>{$a(n.gIc(b))})}return new Promise(Fa=>{Fa(n.gIc(b))})}catch(ma){return w.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+b+" policy value. Error Message: {0}",ma.message),n.handleError(ma.toString(),h,n.gIc(b))}},S=>x.handleError(S,h,x.gIc(b)));E.then(S=>{w.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",b,S);return null});return E}isFeatureEnabled(b,h=!0){if(this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1))return this.Ram(b,h);let n=new Promise(E=>{E(!0)}),x="";this.U7c.contains(b)&&(x="ControllerConnectedServicesEnabled",n=this.Mka(x,h));n.then(E=>{w.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",b,E,x);return null});return n}Ram(b,h=!0){let n=new Promise(E=>{E(!0)}),x="";"mso_sendASmile"===b?x="Enabled":"Survey"===b||"FloodgateSurvey"===b?x="SurveyEnabled":this.U7c.contains(b)&&(x="ControllerConnectedServicesEnabled");
""!==x&&(n=this.Mka(x,h));n.then(E=>{w.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",b,E,x);return null});return n}handleError(b,h,n){return h?new Promise(x=>{x(n)}):new Promise((x,E)=>{E(b)})}u5f(b,h,n){if(!b)return Promise.resolve(new Va);let x=!1,E=null;ta.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let S=this.SYe("GetCloudPolicySettings");return(new Promise((ma,Fa)=>{if(void 0!==
this.uqc&&null!==this.uqc&&0<this.uqc.length){const $a=this.E$n();if(void 0!==$a&&null!==$a){x=!0;ma($a);return}}this.boc.FZe(h,n,1,null,Object(v.a)(this,this.C7m,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.Ma.rc("CloudPolicySettingsRequestQueueTimeout",15E3),this.Ma.rc("CloudPolicySettingsRequestSentTimeout",3E4)).then($a=>{w.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.Lao($a);ma($a);return $a},$a=>{Fa($a);return null})})).then(ma=>
{({$w:S,returnValue:E}=this.M8d(S));var Fa=qa.a.aF();Fa&&Fa.set("FromCache",x.toString());Fa=Object.assign(new ab.a,{durationMs:E,extendedProperties:Fa});ta.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Fa);return ma})}aao(){return Pb.c4i().then(()=>{w.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}cdb(b){return String.format("{0}{1}",this.Ma.lb("WebServiceBase"),
b)}w0m(b){let h=null;({Dv:h}=z.d(b));w.ULS.sendTraceTag(50622687,3004,h?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",b);return h}C7m(b){try{if(void 0!==b&&null!==b&&"CheckIn-Interval"in b){const h=parseInt(b["CheckIn-Interval"]);void 0!==h&&null!==h&&0<h&&(this.yie=h)}}catch(h){w.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",h)}}gIc(b){return b in this.bRg?"0"!==this.bRg[b]:!0}E$n(){try{const b=lb.a.instance.getItem(this.uqc);
if(void 0===b||null===b)return w.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;w.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",b);const h=JSON.parse(b);if(void 0===h||null===h)return w.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===h.ExpirationTime||null===h.ExpirationTime)return w.ULS.sendTraceTag(51662939,
3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(h.ExpirationTime)).getTime()<Date.now())return w.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const n=new Va;n.PolicySettings=h.PolicySettings;n.ControllerConnectedServicesFeatureNames=new Qa.a;this.Ma.vu("ServicesControlsMicrosoftControllerServicesList")&&this.Ma.AB("ServicesControlsMicrosoftControllerServicesList");for(let x of this.U7c)n.ControllerConnectedServicesFeatureNames.add(x);
w.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return n}catch(b){return w.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",b.toString()),null}}Lao(b){try{if(void 0===b||null===b||void 0===b.PolicySettings||null===b.PolicySettings)w.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.yie)w.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");
else{const h=new yb(b,this.yie),n=JSON.stringify(h);w.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",n);lb.a.instance.setItem(this.uqc,n);w.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(h){w.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",h.toString())}}FFd(){const b=zb.FFd(this.Ma);return b&&0<b.length?"OCPS"+b:null}SYe(b){const h=Oa.a.instance.Pa("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");
return void 0!==h&&null!==h?h.fg("WebServiceCall",b):null}M8d(b){if(void 0!==b&&null!==b){const h=b.ni;b.stop();return{returnValue:h,$w:null}}return{returnValue:null,$w:b}}}Object(r.a)(oa,"CloudPolicySettingsHelper",null,[673]);class pa{constructor(){this.mAh=this.aij=this.RH=0;this.nAh=this.bij=this.Fwb="";this.IGe=this.mQa=2}clone(){const b=new pa;b.RH=this.RH;b.aij=this.aij;b.mAh=this.mAh;b.Fwb=this.Fwb;b.bij=this.bij;b.nAh=this.nAh;b.mQa=this.mQa;b.IGe=this.src;return b}get src(){return this.IGe}serialize(b=
null){const h={};if(!b||b.contains(pa.rFb))h[pa.rFb]=this.RH;if(!b||b.contains(pa.hSc))h[pa.hSc]=this.Fwb;if(!b||b.contains(pa.iSc))h[pa.iSc]=this.mQa;return JSON.stringify(h)}static create(b,h=null){const n=new pa;n.IGe=b;void 0!==h&&null!==h&&(pa.rFb in h&&(n.RH=h[pa.rFb]),pa.hSc in h&&(n.Fwb=h[pa.hSc]),pa.iSc in h&&(n.mQa=h[pa.iSc]));return n}static deserialize(b,h){try{const n=JSON.parse(b);if(void 0!==n&&null!==n)return pa.create(h,n);w.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",
b);throw Error.argument("settingsData");}catch(n){throw w.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",n.toString()),n;}}}pa.rFb="CCS";pa.hSc="CCSTime";pa.iSc="OfficePrivacyRoamedNoticeShown";Object(r.a)(pa,"UserPrivacySettings",null,[]);var Ya=d(140);class Ja{constructor(b,h){if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ma=b;this.hg=h;this.yFe=this.Md=null}cdb(b){var h=String.format("{0}RoamingServiceHandler.ashx?action=",
this.Ma.appSettings.RoamingServiceHandlerWebServiceBase||"");h=new Sys.StringBuilder(h);h.append(b);h.append("&");h.append(u.AFrameworkApplication.um);return h.toString()}executeRequest(b,h,n,x=null){return this.hg.pWb(b,h,x,null,n,"33",!1,null,6E4)}saveSettings(b){return new Promise((h,n)=>{try{if(void 0===this.Md||null===this.Md||void 0===b||null===b)w.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),n("Can't determine setting changes to save");
else{var x=this.Md.RH!==b.RH;if(2===this.Md.src&&x)this.Vzn(b),h(!0);else{var E=this.wEn(b);if(void 0===E||null===E||!E.length)w.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),n("No changes to save");else if(1===this.Md.src)h(this.Acj(E));else if(0===this.Md.src){w.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",E);const S=this.executeRequest(this.cdb("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",
E);S.continueWith(()=>{if(S.ho||S.Ii)w.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),h(!1);else{var ma=S.result;void 0!==ma.args&&null!==ma.args&&void 0!==ma.args.data&&null!==ma.args.data&&ma.args.data.mf===ua.a.qD?(w.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),h(!0)):(w.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),h(!1))}})}}}}catch(S){w.ULS.sendTraceTag(50860930,
3004,10,"SaveUserPrivacySettings: Exception = {0}",S.toString()),h(!1)}})}wEn(b){if(void 0===this.Md||null===this.Md||void 0===b||null===b)throw Error.invalidOperation("User Privacy settings have not been initialized");const h=new Qa.a;0===b.src?(this.Md.RH!==b.RH&&(h.add(pa.rFb),h.add(pa.hSc)),this.Md.mQa!==b.mQa&&h.add(pa.iSc)):1===b.src&&this.Md.RH!==b.RH&&h.add(pa.rFb);return h.count?b.serialize(h):(w.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),
null)}getSettings(){if(!this.yFe){const b=this;this.yFe=new Promise(h=>{try{b.Md?h(b.Md.clone()):b.V$n().then(n=>{b.Md=n;h(b.Md.clone());return null},()=>{b.T$n().then(n=>{b.Md=n;h(b.Md.clone());return null},()=>{b.U$n().then(n=>{b.Md=n;h(b.Md.clone());return null},()=>{w.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");b.Md=new pa;h(b.Md.clone());return null});return null});return null})}catch(n){w.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",
n.toString()),b.Md=new pa,h(b.Md.clone())}})}return this.yFe}V$n(){return new Promise((b,h)=>{try{const x=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Ma.$("PrivacyDialogShouldCheckRoaming")||x){var n=this.executeRequest(this.cdb("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");n.continueWith(()=>{try{if(n.ho||n.Ii)w.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const E=n.result;if(E&&E.args&&E.args.data)if(E.args.data.mf!==
ua.a.qD)w.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",E.args.data.mf);else{if(E.args.data.Ee){b(Ja.parse(E.args.data.Ee,0));w.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",E.args.data.Ee);return}w.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else w.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");
h("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(E){w.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",E.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else w.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),h("Roaming should not be used")}catch(x){w.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",
x.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}T$n(){return new Promise((b,h)=>{try{const n=Ya.a.get("WacUPToggleState");let x=null;void 0!==n&&null!==n&&0<n.length&&(x=decodeURIComponent(n));if(void 0!==x&&null!==x&&0<x.length){const E=Ja.parse(x,1);w.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",E.toString());b(E)}else{const E=pa.create(1),S=new Qa.a;S.add(pa.rFb);const ma=E.serialize(S);this.Acj(ma)?(w.ULS.sendTraceTag(51258449,
3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",ma),b(E)):(w.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",ma),h("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(n){w.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",n.toString()),h("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}U$n(){return new Promise(b=>
{try{var h=-1!==window.location.href.indexOf("&wdccsoff=1");let n=pa.create(2);h?(n.RH=2,u.AFrameworkApplication.ryh(),w.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",n.toString())):(n.RH=1,w.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",n.toString()));b(n)}catch(n){w.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",n.toString()),
h=pa.create(2),h.RH=1,b(h)}})}Vzn(b){w.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===b.RH?u.AFrameworkApplication.ryh():u.AFrameworkApplication.q_k();w.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",b)}Acj(b){try{w.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",b);const h=this.Ma.lb("PrivacyCookieDomain")||"";if(!h||!h.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");
w.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",b);return Ya.a.k_i("WacUPToggleState",b,Ya.a.eNa,h)}catch(h){return w.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",h.toString()),!1}}isFeatureEnabled(b){return this.getSettings().then(h=>{const n=this.Ma.vu("ServicesControlsMicrosoftControllerServicesList")?this.Ma.AB("ServicesControlsMicrosoftControllerServicesList"):[],x=new Pa.a;for(let E=0;E<n.length;E++)x.add(n[E]);return x.contains(b)?
2!==h.RH:!0},()=>{w.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",b);return!0})}static parse(b,h){try{return w.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",b,h),pa.deserialize(b,h)}catch(n){throw w.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",n.toString()),n;}}}Object(r.a)(Ja,"UserPrivacySettingsHelper",null,[674]);class nb{constructor(){this.W=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}zc(b){this.W=
b;this.W.register(673,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").singleInstance().Xd(()=>new oa(u.AFrameworkApplication.K,u.AFrameworkApplication.Ze));this.W.register(674,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").singleInstance().Xd(()=>new Ja(u.AFrameworkApplication.K,u.AFrameworkApplication.Ze));this.W.register(675,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").singleInstance().Xd(()=>new Ca(u.AFrameworkApplication.K,u.AFrameworkApplication.Ze));
this.W.register(676,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").singleInstance().Xd(()=>new zb(u.AFrameworkApplication.K,u.AFrameworkApplication.Ze,this.W.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.W.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),u.AFrameworkApplication.ya))}init(){u.AFrameworkApplication.K.yq(()=>{const b=this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");u.AFrameworkApplication.K.$("LicensingIsEnabled")&&
(b.isFeatureEnabled("LicensingTestFeature",!1).then(h=>{w.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",h,u.AFrameworkApplication.K.lb("IsAnonymousUser"));return null}),b.getFeatureTier("LicensingTestFeature",0).then(h=>{w.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",h,u.AFrameworkApplication.K.lb("IsAnonymousUser"));
return null}));this.W.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.c5n()})}dispose(){}c5n(){try{u.AFrameworkApplication.K.$("SideCarIsEnabled")&&Pb.c4i().then(b=>{w.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",b);return b})}catch(b){}}static main(){N.a.instance.Pc(new nb)}}Object(r.a)(nb,"ApplicationFeatureHelperPackage",null,[1,2]);var Bb=d(182);class mb{KFd(b,h){let n;const x=[];for(;n=h.exec(b);){const E=n.index;
x.push(new Bb.a(E,E+n[0].length))}return x}isEndPuncSpecialCase(b){const h=this.KFd(b,mb.NYn);for(const n of h)if(n.end===b.length)return!0;return!1}VEc(b){for(const h of mb.w3k){const n=this.KFd(b,h);if(0<n.length&&!n[0].begin)return n[0].end-1}return 0}findBeginBoundary(b,h,n){var x=b.substring(n,h);b=this.KFd(x,mb.dCh);for(h=b.length-1;0<=h;h--){const E=x.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(E))return x=x.substring(b[h].begin,x.length),n+b[h].end+this.VEc(x)}return n}findEndBoundary(b,
h,n){var x=b.substring(h,n);b=this.KFd(x,mb.dCh);for(n=0;n<b.length;n++){const E=x.substring(0,b[n].end);if(!this.isEndPuncSpecialCase(E))return x=x.substring(b[n].begin,x.length),h+b[n].end+this.VEc(x)}return-1}}mb.F6e="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b]|[\u00bb\u2019\u201d\u203a\"']|[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])*[\u2028\u2029\n\r])";
mb.G6e="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])+)";mb.H6e="([\u3002\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*)";mb.w3k=
[new RegExp(mb.F6e,"ig"),new RegExp(mb.G6e,"ig"),new RegExp(mb.H6e,"ig")];mb.h0f="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";mb.k0f="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";mb.j0f="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";
mb.i0f=mb.k0f+"|"+mb.j0f;mb.l0f="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";mb.m0f="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";mb.n0f="(([A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]|[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]|[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45])[.])+|(([\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d])[.\ufe52\uff0e])+";
mb.o0f="([\uff21-\uff3a\uff41-\uff5a])[.\ufe52\uff0e]";mb.BVf="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f])("+
mb.i0f+"|"+mb.l0f+"|"+mb.m0f+")";mb.AVf="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]|[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]|[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a])("+
mb.n0f+")";mb.yCf=mb.h0f+"|"+mb.o0f;mb.g0f=mb.yCf+"|"+mb.BVf+"|"+mb.AVf;mb.dCh=RegExp("[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]|[\u3002\uff61]","ig");mb.NYn=new RegExp(mb.g0f,"g");Object(r.a)(mb,"ProofingSentenceSeparatorScriptSharp",null,[662]);class Qb{F4c(b,h){const n=[];let x;for(;null!=(x=h.exec(b));){const E=x.index;n.push({begin:E,end:E+x[0].length})}return n}isEndPuncSpecialCase(b){return this.F4c(b,Qb.uqj).some(h=>
h.end==b.length)}VEc(b){for(const h of Qb.pnj){const n=this.F4c(b,h);if(0<n.length&&0==n[0].begin)return n[0].end-1}return 0}findBeginBoundary(b,h,n){var x=b.substring(n,h);b=this.F4c(x,Qb.mag);for(h=b.length-1;0<=h;h--){const E=x.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(E))return x=x.substring(b[h].begin,x.length),n+b[h].end+this.VEc(x)}return n}findEndBoundary(b,h,n){var x=b.substring(h,n);b=this.F4c(x,Qb.mag);for(n=0;n<b.length;n++){const E=x.substring(0,b[n].end);if(!this.isEndPuncSpecialCase(E))return x=
x.substring(b[n].begin,x.length),h+b[n].end+this.VEc(x)}return-1}}Qb.hmj="[)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]";Qb.pqj="[\u2639\u263a\u263b]";Qb.tcg="[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]";Qb.dnj="[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]";
Qb.rpj="[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a]";Qb.Zcg="[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]";
Qb.Symbol="[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]";
Qb.scg="[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]";Qb.xoj="[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]";Qb.woj="[\uff21-\uff3a\uff41-\uff5a]";Qb.uoj="[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]";
Qb.toj="[\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d]";Qb.voj="[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45]";Qb.Cde="[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]";Qb.lag="[\u3002\uff61]";Qb.Z4c="[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]";Qb.vnj="[\u00bb\u2019\u201d\u203a\"']";Qb.Vde=Qb.hmj+"|"+Qb.pqj;Qb.yoj="[\u2028\u2029\n\r]";Qb.soj="("+Qb.Z4c+"|"+Qb.tcg+"|"+Qb.Zcg+"|"+Qb.scg+
")";Qb.roj="("+Qb.Z4c+"|"+Qb.tcg+"|"+Qb.Zcg+"|"+Qb.Symbol+"|"+Qb.scg+"|"+Qb.dnj+"|"+Qb.rpj+")";Qb.F6e="("+Qb.Cde+"("+Qb.Vde+"|"+Qb.vnj+"|"+Qb.Z4c+")*"+Qb.yoj+")";Qb.G6e="("+Qb.Cde+"("+Qb.Vde+")*("+Qb.Z4c+")+)";Qb.H6e="("+Qb.lag+"("+Qb.Vde+")*)";Qb.pnj=[new RegExp(Qb.F6e,"ig"),new RegExp(Qb.G6e,"ig"),new RegExp(Qb.H6e,"ig")];Qb.h0f="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";Qb.k0f="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";
Qb.j0f="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";Qb.i0f=Qb.k0f+"|"+Qb.j0f;Qb.l0f="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";Qb.m0f="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";
Qb.n0f="(("+Qb.xoj+"|"+Qb.uoj+"|"+Qb.voj+")[.])+|(("+Qb.toj+")[.\ufe52\uff0e])+";Qb.o0f="("+Qb.woj+")[.\ufe52\uff0e]";Qb.BVf=Qb.soj+"("+Qb.i0f+"|"+Qb.l0f+"|"+Qb.m0f+")";Qb.AVf=Qb.roj+"("+Qb.n0f+")";Qb.yCf=Qb.h0f+"|"+Qb.o0f;Qb.g0f=Qb.yCf+"|"+Qb.BVf+"|"+Qb.AVf;Qb.mag=new RegExp(Qb.Cde+"|"+Qb.lag,"ig");Qb.uqj=new RegExp(Qb.g0f,"g");Object(r.a)(Qb,"ProofingSentenceSeparator",null,[662]);class Vb{constructor(){this.W=null}get name(){return"Box4.ProofingGrammarCheck"}zc(b){this.W=b;u.AFrameworkApplication.K.$("ProofingSentenceSeparatorTypeScriptIsEnabled")?
b.ha("Box4.Proofing.IProofingSentenceSeparator",()=>new Qb).singleInstance():b.ha("Box4.Proofing.IProofingSentenceSeparator",()=>new mb).singleInstance()}init(){this.W.resolve("Box4.Proofing.IProofingSentenceSeparator")}dispose(){}static main(){N.a.instance.Pc(new Vb)}}Object(r.a)(Vb,"Box4GrammarCheckPackage",null,[1,2]);var mc=d(85),ob=d(9),cb=d(76),db=d(68),kb=d(7);class Wb{constructor(b,h,n,x){var E;this.BDe=this.Ddd=this.Jre=this.re=null;this.JLg=this.Rpb=this.hia=this.Gpa=this.lhe=!1;this.oca=
0;this.vZf=!1;this.ZFb=()=>{this.reset()};this.I$a=S=>{this.oca=S.Ib.keyCode;if(this.S0i){var ma=S.Ib.rawEvent.key;ma&&ma!==Wb.EJ||(this.vZf=!0)}return this.hia&&this.Ddd?S.Ib.keyCode===db.a.L3||S.Ib.keyCode===db.a.Ks||S.Ib.keyCode===db.a.fx?(ma=!1,S.Ib.keyCode===db.a.L3?(w.ULS.sendTraceTag(41178049,324,50,"@ mention People Picker dismissed via escape"),ma=!0):S.Ib.keyCode===db.a.Ks?w.ULS.sendTraceTag(41178050,324,50,"@ mention People Picker enter pressed while picker is up"):S.Ib.keyCode===db.a.fx&&
w.ULS.sendTraceTag(51451662,324,50,"@ mention People Picker tab pressed while picker is up"),this.Ddd(S),ma&&this.reset(),!0):S.Ib.keyCode===db.a.gha||S.Ib.keyCode===db.a.N7||S.Ib.keyCode===db.a.Q_||S.Ib.keyCode===db.a.R_||S.Ib.keyCode===db.a.M3||S.Ib.keyCode===db.a.yK?(this.Ddd(S),!0):!1:!1};this.Xna=S=>{if(!this.S0i||this.vZf||this.hia){this.vZf=!1;var ma=this.sIc(),Fa=this.bHc(S.Ib.target),$a=S.Ib.rawEvent.inputType;return(void 0!==$a&&null!==$a||this.oca!==db.a.dC&&this.oca!==db.a.K3)&&"deleteContentBackward"!==
$a&&"deleteContentForward"!==$a?this.O1h(ma,Fa,S.Ib.target):!1}};this.Rdh=S=>{if(1!==S.Ib.rawEvent.key.length)return!1;const ma=this.sIc(),Fa=this.bHc(S.Ib.target);return this.O1h(ma,Fa,S.Ib.target)};this.FMa=S=>{if(!this.hia)return!1;const ma=this.sIc(),Fa=this.bHc(S.Ib.target);(S.Ib.keyCode===db.a.dC||S.Ib.keyCode===db.a.K3||(S.Ib.keyCode===db.a.DQa||S.Ib.keyCode===db.a.fic)&&S.Ib.ctrlKey)&&this.Jif(ma,Fa,S.Ib.target);return!1};this.oRe=(S,ma)=>{this.oca=ma.Nnf?db.a.dC:ma.isDelete?db.a.K3:this.oca;
this.hia&&(ma.Nnf?this.ZPl(ma.Ohi):ma.isDelete&&this.BQl(ma.Ohi))};this.Ud=b;this.rj=h;this.$ic=n;this.Yc=x;this.S0i=null===(E=u.AFrameworkApplication.K)||void 0===E?void 0:E.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfEarlyExitAtMentions",!1);this.reset()}Lyc(b,h){this.Gpa||(this.Gpa=!0,b.fta?this.J$a(h):b.Zca(()=>{this.Gpa||this.J$a(h)}))}dispose(){this.Rpb&&(ob.App.xa.Hfc.sc(kb.a.input,this.Yc.editingView.editingElement,this.Xna),this.Rpb=!1);this.lhe&&(this.re.sc(kb.a.Iyc,
this.Yc.editingView.editingElement,this.Rdh),this.lhe=!1);this.JLg&&(this.re.sc(kb.a.KH,this.Yc.editingView.editingElement,this.I$a),this.re.sc(kb.a.Bh,this.Yc.editingView.editingElement,this.FMa));ob.App.xa.dga(this.ZFb);this.C6i()}AKi(b){this.Jre=b}NKi(b){this.BDe=b}BKi(b){this.Ddd=b}cgk(){this.hia=!0;u.AFrameworkApplication.Hf("ContextIQAtMentionEntryPoint-Treatment;ContextIQAtMentionEntryPoint-Control")}C6i(){this.hia=!1}YN(){return this.hia}J$a(b){this.re=b;this.Yc.xd?this.Yc.xd.Ji&&(ob.App.Zyc&&
V.a.l9d||V.a.Vs?(ob.App.xa.Hfc.mb(kb.a.input,this.Yc.editingView.editingElement,this.Xna,null),this.Rpb=!0):this.re&&V.a.zk&&(this.re.mb(kb.a.Iyc,this.Yc.editingView.editingElement,this.Rdh),this.lhe=!0),this.re&&(this.re.mb(kb.a.KH,this.Yc.editingView.editingElement,this.I$a),this.re.mb(kb.a.Bh,this.Yc.editingView.editingElement,this.FMa),this.JLg=!0),this.$ic.G8g(this.oRe),ob.App.xa.i1(this.ZFb)):w.ULS.sendTraceTag(593376530,324,10,"SelectionView is null. AtMentions will not work in this session")}O1h(b,
h,n){if(1>h)return!1;b=b.replace(new RegExp(Wb.MB,"g"),"");const x=b.charAt(h-1);this.hia&&x!==Wb.EJ?this.Jif(b,h,n):this.hia||x!==Wb.EJ?this.hia&&x===Wb.EJ&&w.ULS.sendTraceTag(41178052,324,50,"Tried to type @ while already in at mention mode"):this.Jre&&(this.reset(),this.H6m(h,b)&&(this.cgk(),this.Jif(b,h,n),w.ULS.sendTraceTag(41178051,324,50,"@ typed.  Beginning of paragraph?: {0}",1===h?"true":"false")));return this.hia}reset(){this.Gpa=!1;this.C6i();this.BDe&&this.BDe()}bHc(b){return this.rj.D1b(2,
b)}sIc(){return this.Ud.lp().innerText}H6m(b,h){return 0>b-2||this.vrk(h.charAt(b-2))?!0:!1}vrk(b){return B.a.V$(b)||"("===b}Jif(b,h,n){if(!b||""===b||0>h)this.reset();else{const {ZTi:x,urd:E}=this.enm(b,h);this.Jre(x,n,E)}}enm(b,h){let n=this.Egl(b,h);if(0<=n&&h<=b.length)return{ZTi:b.substring(n,h),urd:n};this.reset();return{ZTi:"",urd:n}}Egl(b,h){let n=-1;for(let x=h;0<=x&&63>=h-x;x--)if(b.charAt(x)===Wb.EJ){n=x;break}return n}ZPl(b){b=this.bHc(b.Ib.target);b=this.sIc().charAt(b-1);this.hia&&b===
Wb.EJ&&this.reset()}BQl(b){b=this.bHc(b.Ib.target);b=this.sIc().charAt(b);this.hia&&b===Wb.EJ&&this.reset()}}Wb.EJ="@";Wb.MB="\n";Object(r.a)(Wb,"AtMentionsListener",null,[664]);class Fb{constructor(){this.W=null}get name(){return"Box4.AtMentions"}zc(b){this.W=b;this.W.ha("Box4.AtMentions.IAtMentionsListener",()=>new Wb(this.W.resolve("Box4.IEditingDomManager"),this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.BackspaceDeleteEventSource"),cb.InteractiveViewManager.instance)).singleInstance()}init(){u.AFrameworkApplication.K.$("CanvasAtMentionDetectionIsEnabled")&&
u.AFrameworkApplication.K.yq(()=>{this.W.resolve("Box4.AtMentions.IAtMentionsListener").Lyc(ob.App.xa.jb,mc.KeyInputManager.instance)})}dispose(){this.W.resolve("Box4.AtMentions.IAtMentionsListener").dispose()}static main(){N.a.instance.Pc(new Fb)}}Object(r.a)(Fb,"Box4AtMentionsPackage",null,[1,2]);class nc{get name(){return"Box4.Workers"}zc(){}init(){}dispose(){}static main(){N.a.instance.Pc(new nc)}}Object(r.a)(nc,"Box4WorkersPackage",null,[1,2]);var gc=d(320),Jc=d(82);class tb{constructor(){this.rFa=
new Jc.a}l3(b,h){this.rFa.Z(b,h)}B$e(b){({value:b}=this.rFa.Dc(b));return b}}Object(r.a)(tb,"AggregationMethodsForActivityName",null,[]);var dc=d(249);class Yb{constructor(){this.Zhd=new gc.a;this.rFa=new gc.a}l3(b,h,n){this.rFa.xb(b)&&this.rFa.J(b)||this.rFa.Z(b,new tb);this.rFa.J(b).l3(h,n)}B$e(b,h){return this.rFa.xb(b)&&this.rFa.J(b)?this.rFa.J(b).B$e(h):null}AIc(b){this.Zhd.xb(b)&&this.Zhd.J(b)||this.Zhd.Z(b,new dc.a);return this.Zhd.J(b)}tvh(b,h){this.AIc(b).add(h)}}Object(r.a)(Yb,"ActivityAggregationInfo",
null,[699]);var pb=d(120),Gb=d(953),hb=d(970);class Ib extends Gb.a{constructor(b,h){super(b);this.XJe=(this.ftj=h)?h.zql():hb.a.n$e()}get pya(){return this.ftj}get activityName(){return this.pya.name}get startTime(){return this.pya.startTime}get endTime(){return this.pya.endTime}end(){}cancel(){}f9e(){}sgo(){this.q1b.Z("AM",this.pya.mode.toString());this.q1b.Z("C",this.pya.count.toString());this.q1b.Z("DA",this.pya.zAh.toFixed(2));this.q1b.Z("DV",this.pya.DYk.toFixed(2))}yff(b){return this.pya.yff(b)}Yff(){return this.pya.Yff()}sWb(){for(let b of this.pya.qya)b.sWb()}}
Object(r.a)(Ib,"AggregatedActivity",Gb.a,[]);class Ob{constructor(b,h){this.Zfe=0;this.ewa=b;this.FQa=h}k9j(b,h){this.Zfe=h;for(h=0;h<b.count;h++){const n=b.J(h);this.l9j(n)}}l9j(b){const h=Object(ja.a)(Ib,b);if(h)if(1===this.Zfe)this.j9j(h);else if(2===this.Zfe){this.m9j(h);for(let n of this.FQa.AIc(this.ewa)){const x=h.pya.qya.J(0);x.properties.xb(n)&&b.properties.Z(n,x.properties.J(n))}}}j9j(b){for(let h of this.FQa.AIc(this.ewa))this.kSi(b,h)}m9j(b){for(let h of b.Yff())this.kSi(b,h)}kSi(b,h){const n=
this.FQa.B$e(this.ewa,h);if(n){const x=b.yff(h);b.properties.Z(h,n(x))}}}Object(r.a)(Ob,"PropertyAggregationHelper",null,[]);var kc=d(1042);class Ac{constructor(b,h,n,x,E){this.ZMb=b;this.FQa=h;this.pxg=E;this.Hfe=x;this.kJj=n}get A5g(){return this.kJj.value}PAc(b){if(Object(pb.a)(kc.a,b))b.PAc();else if(Object(pb.a)(Ib,b)&&this.Hfe.pih(b.activityName.toString())){b=Object(ja.a)(Ib,b);b.sgo();b=b.Mni();var h=[];Array.add(h,b);b=z.c(h);w.ULS.sendTraceTag(6907266,213,50,b)}}zya(b,h){const n=(new Date).getTime();
var x=this.pxg.list.J(b);const E=({o9j:x}=this.efl(x)).returnValue;this.pxg.list.Z(b,new Qa.a);h&&(x=this.PEk(x,n,this.ZMb.y0h));0<x.count&&(new Ob(b,this.FQa)).k9j(x,E)}PEk(b,h,n){const x=new Qa.a;for(let E=0;E<b.count;E++){const S=b.J(E);S.startTime>h-n?S.sWb():x.add(S)}return x}efl(b){const h=this.A5g.d$i(b);b=this.A5g.p6n(b);const n=this.p9j(h,b);return{returnValue:n,o9j:1===n?h:b}}p9j(b,h){return b.count*this.ZMb.aqi<h.count?1:2}get enabled(){return this.ZMb.enabled}sWb(){}}Object(r.a)(Ac,"ActivityAggregationManager",
null,[698]);class Nc{constructor(b){this.enabled=!1;this.xoi=500;this.Fpi=2;this.aqi=5;this.y0h=3E4;this.cFc(b.appSettings)}cFc(b){this.enabled=Boolean.parse(b[Nc.c5e]||"false");this.xoi=parseInt(b[Nc.XDm]||"500");this.Fpi=parseInt(b[Nc.DGm]||"2");this.aqi=parseInt(b[Nc.$Gm]||"5");this.y0h=parseInt(b[Nc.QOl]||"30000")}}Nc.c5e="ActivityAggregationEnabled";Nc.XDm="ActivityAggregationMaxInterval";Nc.DGm="ActivityAggregationMinChain";Nc.$Gm="ActivityAggregationModeFactor";Nc.QOl="ActivityAggregationGraceWindow";
Object(r.a)(Nc,"ActivityAggregationParams",null,[]);class kd{constructor(b,h){this.FQa=b;this.Csg=h}d$i(b,h=1){if(!b||!b.count)return b;const n=new Qa.a;var x=null;for(let E=0;E<b.count;E++){const S=b.J(E);if(!S)continue;const ma=S.activityName;x?x.Ilm(S)?x.add(S):(x=x.process(),n.addRange(x),x=this.Csg(ma,h),x.add(S)):(x=this.Csg(ma,h),x.add(S))}x&&(b=x.process(),n.addRange(b));return n}p6n(b){if(!b||!b.count)return b;const h={};var n=null;for(let E=0;E<b.count;E++){const S=b.J(E);if(S){if(!n){n=
new Qa.a;var x=this.FQa.AIc(S.activityName);for(let ma of x)n.add(ma)}x=this.xDl(S,n);null!==x&&(x in h&&h[x]||(h[x]=new Qa.a),h[x].add(S))}}b=new Qa.a;for(const E of Ia.a.ON(h))n=this.d$i(h[E],2),b.addRange(n);return b}xDl(b,h){let n="";for(let x of h)n+=x,n=b.properties.xb(x)&&void 0!==b.properties.J(x)&&null!==b.properties.J(x)?n+b.properties.J(x):n+"null";return n}}Object(r.a)(kd,"ActivityAggregationSchemes",null,[697]);class Jd{constructor(b,h,n,x,E){this.Dr=this.Fi=0;this.ZMb=n;this.xic=x;this.FQa=
E;this.name=b;this.qy=h;this.qya=new Qa.a}get mode(){return this.qy}get count(){return this.qya.count}get startTime(){return this.Fi}get endTime(){return this.Dr}get zAh(){if(!this.count)return 0;let b=0;for(let h of this.qya)b+=h.endTime-h.startTime;return b/this.count}get DYk(){if(!this.count)return 0;let b=0;const h=this.zAh;for(let n of this.qya){const x=n.endTime-n.startTime;b+=(x-h)*(x-h)}return b/this.count}add(b){this.count?this.Dr=b.endTime>this.endTime?b.endTime:this.endTime:(this.Fi=b.startTime,
this.Dr=b.endTime);this.qya.add(b)}Ilm(b){return 0>=this.count?!1:b.startTime-this.endTime<=this.ZMb.xoi}process(){if(this.count>=this.ZMb.Fpi){const b=new Qa.a,h=this.xic(this);b.add(h);return b}return this.qya}yff(b){const h=new Qa.a;for(let n of this.qya)if(n.properties.xb(b)){const x=n.properties.J(b);h.add(x)}else h.add(null);return h}Yff(){const b=this.FQa.AIc(this.name),h=new dc.a;for(let n of this.Gfl())b.contains(n)||h.add(n);return h}Gfl(){const b=new dc.a;if(!this.qya)return b;for(let h of this.qya)for(let n of h.properties.keys)b.add(n);
return b}zql(){return this.qya.J(0).uniqueID}}Object(r.a)(Jd,"ActivityCollection",null,[696]);class ge{constructor(){this.Bnb=new gc.a}get list(){return this.Bnb}add(b){const h=b.activityName;if(this.Bnb.xb(h)&&this.Bnb.J(h)){const n=this.ytl(this.Bnb.J(h),b);this.Bnb.J(h).insert(n,b)}else this.Bnb.Z(h,new Qa.a),this.Bnb.J(h).add(b)}ytl(b,h){for(let n=b.count-1;0<=n;n--)if(h.startTime>b.J(n).startTime)return n+1;return 0}}Object(r.a)(ge,"CompletedActivitiesHelper",null,[695]);class Oc{constructor(){this.W=
null}get name(){return"Common.App.ActivityAggregator"}init(){u.AFrameworkApplication.rK(()=>{this.W.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}zc(b){this.W=b;const h=x=>new Ib(()=>b.Pa("Common.App.Activities.IActivityAggregationManager"),x),n=(x,E)=>new Jd(x,E,b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),h,b.resolve("Common.IActivityAggregationInfo"));b.register(Ac,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").singleInstance().Xd(()=>
new Ac(b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b.resolve("Common.IActivityAggregationInfo"),b.Ye("Common.App.ActivityAggregator.IActivityAggregationSchemes"),b.resolve("Common.App.Activities.IActivityThrottler"),b.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));b.register(Nc,"Common.App.ActivityAggregator.ActivityAggregationParams").singleInstance().Xd(()=>new Nc(u.AFrameworkApplication.K));b.register(Yb,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").singleInstance().Xd(()=>
new Yb);b.register(kd,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").singleInstance().Xd(()=>new kd(b.resolve("Common.IActivityAggregationInfo"),n));b.register(ge,"Common.App.ActivityAggregator.CompletedActivitiesHelper").singleInstance().Xd(()=>new ge)}static main(){N.a.instance.Pc(new Oc)}}Object(r.a)(Oc,"ActivityAggregatorPackage",null,[1,2]);var qc=d(463),Xc=d(1358);class xe{constructor(b){this.ZUg=0;this.vie=null;this.nQj=
b}get chat(){return window.swc}get isInitialized(){return!!this.chat}get yYf(){return this.nQj.value}Vb(){this.isInitialized?this.qbc():this.jkn(Object(v.a)(this,this.qbc,"registerActionsInternal"))}qbc(){w.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(b=>{b.getChatsContainer(Object(v.a)(this,this.ZNm,"onChatContainerReady"))}).catch(b=>{w.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",b)}),
this.chat.getChatsCounter().then(b=>{b.onChatsCountChange(Object(v.a)(this,this.Ark,"chatCountChanged"))}).catch(b=>{w.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",b)}),this.chat.getKeyboard().then(b=>{b.onKeyDown(Object(v.a)(this,this.bOm,"onChatKeyPress"))}).catch(b=>{w.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",b)}))}catch(b){w.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",b)}}Ark(b){w.ULS.sendTraceTag(50595970,
333,50,"Chat count:{0}",b);if(!b)this.yYf.YNm();else if(1===b&&!this.ZUg){const h=document.getElementById(this.vie?this.vie:Xc.a.ewb);h?this.yYf.cOm(h,Object(v.a)(this,this.R8n,"transferFocusToChat")):w.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.ZUg=b}ZNm(b){this.vie=b}bOm(b){b.ctrlKey&&"f6"===b.key.toLowerCase()&&this.Q8n(b.shiftKey)}jkn(b){qc.a.instance.mb(kb.a.C2n,window.self,()=>{b();return!0})}R8n(){w.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&
this.chat.getFocuser().then(b=>{b.focusConversationInput()}).catch(b=>{w.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",b)})}catch(b){w.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",b)}}Q8n(b){w.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.yYf.$Nm(b)}}Object(r.a)(xe,"ChatManager",null,[686]);var Ge=d(67);class bf{constructor(){this.sa=new Ge.a;this.FWj=!1}Q6j(b){this.sa.addHandler("OnTopRowControlsCreatedEvent",b)}z6j(b){this.sa.addHandler("OnRenameTextboxStatusChangedEventKey",
b)}get R7n(){return this.FWj}PHi(b){this.sa.raiseEvent("OnRenameTextboxStatusChangedEventKey",b?"true":"false")}}Object(r.a)(bf,"HeaderEventSource",null,[]);var xd=d(160),ke=d(289);class Rf{constructor(b,h,n,x,E){this.pnd=null;this.Wb=b;this.Mo=h;this.Kj=n;this.IWj=x;this.ga=E}qKi(b,h,n,x=null){const E=this.Wb.pe(h);E.parent=n;E.LL=!0;x&&E.Vca(x);this.Kj.sya(h,b,!1);this.IWj.sya(h,b,!1);h=new ke.DOMFocusListing(()=>b);h.Go(2);h.Go(1);h.Go(8);h.Go(5);h.Go(3);h.Go(6);this.Wb.yja(()=>b,E,h).dX=!0;h=
mc.KeyInputManager.mc(db.a.fx,0);n=mc.KeyInputManager.mc(db.a.fx,4);E.Ar(h);E.Ar(n)}onFlexPaneOpen(b){this.qKi(b,Xc.a.P8b,Xc.a.zLa);this.Wb.Jg(Xc.a.P8b);this.Mo.tya(Xc.a.P8b)}onFlexPaneClose(){this.Mo.Hw(Xc.a.P8b);this.Wb.Jg(Xc.a.zLa)}cOm(b,h){this.pnd||(this.pnd=h,this.qKi(b,Xc.a.ewb,xd.AFrame.dL,Object(v.a)(this,this.aOm,"onChatFocus")));this.Wb.Jg(Xc.a.ewb);this.Mo.tya(Xc.a.ewb)}aOm(){this.pnd&&this.pnd()}YNm(){this.Mo.Hw(Xc.a.ewb);this.Wb.CCd(xd.AFrame.Xp)}$Nm(b){this.ga.processAction(b?Ra.a.Y6e:
Ra.a.Ede,2)}}Object(r.a)(Rf,"ReactSharedHeaderFocusManager",null,[685]);var pd=d(104),fe=d(1003),Ec=d(46),rd=d(37),Ld=d(60);class Gf{constructor(b){this.ga=b}Vb(){this.ga.pa(Ra.a.OCd,Ld.a.frame,Object(v.a)(this,this.mri,"navigateToUpsellPage"));this.ga.pa(Ra.a.qcl,Ld.a.frame,Object(v.a)(this,this.launchUpsellExperience,"launchUpsellExperience"));this.ga.pa(Ra.a.Tsn,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(Ra.a.SOi,Ld.a.frame,pd.ActionManager.Nf)}mri(b,h,n,x,E){if(1===n)return 32;b=8;2===n&&(n=this.Naf(E,
"experience","gopremiumribbon"),E=Ec.a.c6("2116536"),E=Ec.a.Jn(E,"ocid",fe.b(u.AFrameworkApplication.ua.Sb.jo,u.AFrameworkApplication.ua.Sb.wfa,n)),rd.a.ym(E,"_blank",void 0,"NavigateToUpsellPage"),b=32,this.ga.processAction(Ra.a.SOi,2),w.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return b}launchUpsellExperience(b,h,n,x,E){if(1===n)return 32;var S=8;2===n&&(w.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(S=Oa.a.instance.Pa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?
(b=this.Naf(E,"experience","gopremium"),E=this.Naf(E,"dimeCampaignId",null),S.launchUpsellExperience(b,E),S=32):(w.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),S=this.mri(b,h,n,x,E)));return S}Naf(b,h,n){b&&b[h]&&(n=Object(ja.a)(String,b[h]));return n}}Object(r.a)(Gf,"UpsellActor",null,[684]);class ld{constructor(){this.W=null}get name(){return"Common.App.Header"}init(){Oa.a.instance.resolve("Common.App.Header.IUpsellActor").Vb();Oa.a.instance.resolve("Common.App.Header.IChatManager").Vb()}dispose(){}zc(b){this.W=
b;this.W.register(bf,"Common.App.Header.HeaderEventSource").singleInstance();this.W.register(Gf,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").singleInstance().Xd(()=>new Gf(u.AFrameworkApplication.ya));this.W.register(Rf,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").singleInstance().Xd(()=>new Rf(u.AFrameworkApplication.ua.Yo,u.AFrameworkApplication.ua.gv,u.AFrameworkApplication.ua.C_,u.AFrameworkApplication.ua.l$d,
u.AFrameworkApplication.ya));this.W.register(xe,"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").singleInstance().Xd(()=>new xe(this.W.Ye("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){N.a.instance.Pc(new ld)}}Object(r.a)(ld,"CommonAppHeaderPackage",null,[1,2]);var Pc=d(1499);class cd{static KKh(b,h){switch(b){case 3:return cd.LNl(h);case 2:return cd.hAl(h);case 1:return cd.kpl(h)}return""}static LNl(b){switch(b){case 1:return u.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString();
case 2:return u.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static hAl(b){switch(b){case 1:return u.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return u.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static kpl(b){switch(b){case 1:return u.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return u.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(b,
h,n){if(V.a.ki||V.a.FL)window.setTimeout(()=>{cd.IJi(n,cd.NHd())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(cd.lah(n),b,0,!1)}static Wvk(b,h,n,x){h&&x&&x();cd.openInClient(b,h,n)}static NHd(){return V.a.ki?1:V.a.FL?2:V.a.h_a?3:V.a.wl?4:0}static wNl(b){switch(b){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static xNl(b){switch(b){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";
case 1:return"WildFireExcelBizBarFlight";default:return""}}static get tqf(){return"zh-CN"===window.navigator.language}static IJi(b,h){1===h?(w.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),b=cd.KKh(b,h),8<V.a.OYa?rd.a.ym(b,void 0,void 0,"RedirectToAppStore"):rd.a.Wyb(b)):document.hidden||(cd.tqf?(b=u.AFrameworkApplication.K.appSettings.WildFireUrlChinaStoreAndroid.toString())?(w.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),rd.a.Wyb(b)):w.ULS.sendTraceTag(18088019,
306,50,"Empty Url in China Proxy Page BRS Setting"):(w.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(cd.KKh(b,h),null,null)))}static lah(b){switch(b){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get X6d(){return(V.a.h_a||V.a.wl)&&V.a.So}static get OSn(){return V.a.ki||V.a.FL}static bLh(b){switch(b){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static Mci(b){return(b=
cd.pul(b))&&""!==b?Boolean.parse(b):!1}static UXf(b){cd.aJn(b)}static pul(b){try{return localStorage.getItem(b)}catch(h){return w.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+h.message),null}}static aJn(b){try{localStorage.setItem(b,"true")}catch(h){w.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+h.message)}}}cd.Pkh="ChromeExtensionBarDismiss";Object(r.a)(cd,"WildFireUtilities",null,[]);var Aa=d(385);
class Wa{constructor(){this.nge=new Aa.a;this.lge=new Aa.a;this.kge=new Aa.a;this.cjk(this.nge);this.bjk(this.lge);this.ajk(this.kge);this.Oqe=new Aa.a;this.Nqe=new Aa.a;this.Mqe=new Aa.a;this.hmk(this.Oqe);this.gmk(this.Nqe);this.fmk(this.Mqe);this.Oie=new Aa.a;this.ojk(this.Oie);this.wub(this.Oie);this.wub(this.kge);this.wub(this.lge);this.wub(this.nge);this.wub(this.Nqe);this.wub(this.Oqe);this.wub(this.Mqe)}hHd(b,h){switch(b){case 1:return this.AOl(h);case 2:return this.bgl(h)}return cd.X6d?this.Oie:
null}cjk(b){b.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}bjk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}ajk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);
b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}hmk(b){b.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);
b.add("OverlayBig","Get the Word app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1","Discover Word");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}ojk(b){b.add("Headline","Get the Office Online extension for Chrome");b.add("UseAppButton","Get the extension");b.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}gmk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);
b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);b.add("OverlayBig","Get the PowerPoint app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1","Discover PowerPoint");b.add("OverlaySmallSplit2",
"designed for the iPad.");b.add("SkipButton","Skip for now")}fmk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}wub(b){b.add("Corporation","Microsoft Corporation")}AOl(b){switch(b){case 3:return this.Oqe;
case 2:return this.Nqe;case 1:return this.Mqe}return null}bgl(b){switch(b){case 3:return this.nge;case 2:return this.lge;case 1:return this.kge}return null}static get instance(){Wa._instance||(Wa._instance=new Wa);return Wa._instance}}Wa._instance=null;Object(r.a)(Wa,"WildFireStringFactory",null,[]);class $b{constructor(b,h,n,x,E=null,S=null){this.Pze=null;this._id=b;this.wBe=h;this.VDj=E;this.Xoc=x;this.puc=S;this.N4a=null;this.Fwc=n;this.yvc=Wa.instance.hHd(h,b)}dGk(){this.N4a=new Pc.a(this.title,
this.message,null);this.N4a.addButton(this.vmk,Object(v.a)(this,this.HNm,"onButtonOneClick"),"");this.Fwc&&this.N4a.E7g(this.Bmk,Object(v.a)(this,this.MNm,"onButtonTwoClick"));this.N4a.Kja=Object(v.a)(this,this.cVk,"dismissBar");this.N4a.image=3;this.N4a.id=16;this.N4a.closeable=!0}get title(){return this.yvc.J("Headline")}get message(){return this.yvc.J("CallToAction")}get vmk(){return this.Fwc?this.yvc.J("InstallButton"):this.yvc.J("UseAppButton")}get Bmk(){return this.Fwc?this.yvc.J("OpenAppButton"):
""}HNm(){this.Fwc?this.b5l():this.Alo()}MNm(){this.Fwc&&this.BXm()}get zgh(){return this.N4a}get A0a(){this.Pze||(this.Pze=this.VDj());return this.Pze}b5l(){w.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.Xoc&&this.puc&&this.puc();cd.IJi(this._id,this.wBe)}BXm(){this.A0a&&(w.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Xoc&&this.puc&&this.puc(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(cd.lah(this._id),this.A0a,
0,!1))}Alo(){cd.X6d?this.rmk():(w.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),cd.UXf("BizBarClicked"),1!==this.wBe&&2!==this.wBe||cd.Wvk(this.A0a,this.Xoc,this._id,this.puc))}rmk(){this.Xoc?w.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):w.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");rd.a.Wyb(u.AFrameworkApplication.K.appSettings.WildFireChromeExtensionUrl.toString())}dVk(){this.Xoc?w.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):w.ULS.sendTraceTag(17571977,
301,50,"ChromeExtBannerDismissed");cd.UXf(cd.Pkh)}cVk(){cd.X6d?this.dVk():(cd.UXf(cd.bLh(this._id)),w.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static F_e(){const b=u.AFrameworkApplication.ua.Sb;new $b(b.jo,cd.NHd(),8<V.a.OYa,1===b.wfa,()=>b.pda,b.mUf());w.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}}Object(r.a)($b,"WildFireBusinessBar",null,[]);class xc{get name(){return"Common.App.WildFire"}tMe(b){const h=u.AFrameworkApplication.ua.Sb;let n=!1;b&&(b.dGk(),b.zgh&&
(n=h.OUa(b.zgh,!0)));return n}kGk(){var b=u.AFrameworkApplication.ua.Sb;b=new $b(b.jo,cd.NHd(),!1,1===b.wfa);this.tMe(b)&&w.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}F_e(b,h,n,x,E,S){b=new $b(b,n,x,h,E,S);this.tMe(b)&&w.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}JMk(){const b=u.AFrameworkApplication.ua.Sb;var h=u.AFrameworkApplication.K;const n=b.jo,x=1===b.wfa;if(h.$(cd.wNl(n))){var E=cd.NHd(),S=8<V.a.OYa;if(2!==n||2!==E||!x){h=h.$(cd.xNl(n));var ma=b.mUf(),Fa=
()=>b.pda;h&&!cd.Mci(cd.bLh(n))&&this.F_e(n,x,E,S,Fa,ma)}}}init(){var b=u.AFrameworkApplication.K;const h=b.$("WildFireChromeExtensionEnabled");b=b.$("WildFireChromeExtensionBar")&&h;cd.X6d&&b&&!cd.Mci(cd.Pkh)?this.kGk():(document.body&&cd.OSn&&this.JMk(),u.AFrameworkApplication.ya.pa(Ra.a.zuf,Ld.a.frame,Object(v.a)(this,this.zuf,"launchWildFireBusinessBar")))}zuf(b,h,n,x,E){if(1===n)return 32;if(!E)return 8;this.F_e(E.app,E.mode,E.platform,E.useTwoButton,null,null);return 32}dispose(){}zc(){}static main(){N.a.instance.Pc(new xc)}}
Object(r.a)(xc,"PackageManager",null,[1,2]);class bd{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=
!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(r.a)(bd,"BrowserInfo",null,[]);class Wd{constructor(){this.Version=this.Name=null}}Object(r.a)(Wd,"PluginInfo",null,[]);class vf{static oCa(){if(u.AFrameworkApplication.K.$("LogBrowserInfoIsEnabled")){var b=vf.Hcl();try{const h=JSON.stringify(b);w.ULS.sendTraceTag(6903563,102,50,h)}catch(h){w.ULS.sendTraceTag(6903564,102,15,h.message)}}else w.ULS.sendTraceTag(6903562,102,
50,"Detailed browser info logging is turned off")}static kCl(){const b=window.navigator.plugins;if(!b||!b.length)return null;const h=[];for(let n=0;n<b.length;n++){const x=b[n].name,E=b[n].version;Array.add(h,Object.assign(new Wd,{Name:x,Version:E}))}return h}static Hcl(){const b=new bd,h=new Sys.StringBuilder;vf.NG(n=>{b.DocElemClientHeight=n},()=>document.documentElement.clientHeight,h);vf.NG(n=>{b.DocElemClientWidth=n},()=>document.documentElement.clientWidth,h);vf.NG(n=>{b.DocElemOffsetHeight=
n},()=>document.documentElement.offsetHeight,h);vf.NG(n=>{b.DocElemOffsetWidth=n},()=>document.documentElement.offsetWidth,h);vf.NG(n=>{b.ScreenAvailHeight=n},()=>window.screen.availHeight,h);vf.NG(n=>{b.ScreenAvailWidth=n},()=>window.screen.availWidth,h);vf.NG(n=>{b.ScreenWidth=n},()=>window.screen.width,h);vf.NG(n=>{b.ScreenHeight=n},()=>window.screen.height,h);vf.NG(n=>{b.ScreenLogicalXdpi=n},()=>window.screen.logicalXDPI,h);vf.NG(n=>{b.ScreenLogicalYdpi=n},()=>window.screen.logicalYDPI,h);vf.NG(n=>
{b.ScreenDeviceXdpi=n},()=>window.screen.deviceXDPI,h);vf.NG(n=>{b.ScreenDeviceYdpi=n},()=>window.screen.deviceYDPI,h);vf.NG(n=>{b.WinInnerHeight=n},()=>window.self.innerHeight,h);vf.NG(n=>{b.WinInnerWidth=n},()=>window.self.innerWidth,h);vf.NG(n=>{b.WinOuterHeight=n},()=>window.self.outerHeight,h);vf.NG(n=>{b.WinOuterWidth=n},()=>window.self.outerWidth,h);vf.NG(n=>{b.WinOrientation=n},()=>window.self.orientation,h);vf.NG(n=>{b.WinDevicePixelRatio=n},()=>window.self.devicePixelRatio,h);vf.NG(n=>{b.SupportsTouch=
n},()=>V.a.I0c,h);vf.NG(n=>{b.NavAppName=n},()=>window.navigator.appName,h);vf.NG(n=>{b.NavAppVersion=n},()=>window.navigator.appVersion,h);vf.NG(n=>{b.NavLanguage=n},()=>window.navigator.browserLanguage||window.navigator.language,h);vf.NG(n=>{b.NavUserAgent=n},()=>window.navigator.userAgent,h);vf.NG(n=>{b.NavPlatform=n},()=>window.navigator.platform,h);vf.NG(n=>{b.NavPlugins=n},vf.kCl,h);vf.NG(n=>{b.CalculatedDevicePixelRatio=n},()=>vf.devicePixelRatio,h);b.Error=h.toString();return b}static get devicePixelRatio(){const b=
window.devicePixelRatio;return isNaN(b)?window.screen.deviceXDPI/window.screen.logicalXDPI:b}static NG(b,h,n){try{const x=h();b(x)}catch(x){n.isEmpty()||n.append(" | "),n.append(x.message||"null")}}}Object(r.a)(vf,"BrowserInfoLogger",null,[]);class uf{get name(){return"Common.App.BrowserInfoLogger"}zc(){}init(){vf.oCa()}dispose(){}static main(){N.a.instance.Pc(new uf)}}Object(r.a)(uf,"BrowserInfoLoggerPackage",null,[1,2]);class oe{constructor(){this.sa=new Ge.a}Rub(b){this.sa.addHandler("OnEditHappenedEvent",
b)}y2d(b){this.sa.removeHandler("OnEditHappenedEvent",b)}Ubn(){this.sa.raiseEvent("OnEditHappenedEvent")}}Object(r.a)(oe,"EditNotificationEventSource",null,[]);var Pe=d(57),We=d(80);class Xi{constructor(b,h,n,x,E,S,ma=0){this.Nme=!1;this.Mme=this.krb=null;this.w3g=!1;this.Hb=h;this.Nfd=b;this.R6a=n;this.q4=x;this.u3g=E;this.qAj=S;this.p9c=0;this.xad=!1;try{0<ma&&(this.p9c=ma,3E5>this.p9c&&(this.p9c=3E5),this.Hb&&!this.Mme&&(this.Mme=new We.a(3,2,this.p9c,Object(v.a)(this,this.Nsn,"reportEditDocumentUserActionTelemetryIfNecessary")),
this.Hb.$b(this.Mme)))}catch(Fa){w.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+Fa)}}get fij(){return this.w3g}jzd(){this.fij?this.xad=!0:(this.w3g=!0,ta.Health.instance.addQosPillar("Save"),ta.Health.instance.addQosPillar("ContentCreation"),Pe.c(Ra.a.editDocument));this.Nme=!0;this.u3g&&this.u3g.D5g();this.q4&&this.q4.Ubn();u.AFrameworkApplication.jh&&u.AFrameworkApplication.jh.ICm();this.qAj&&!this.krb&&(this.WYc(null),
this.krb=new We.a(3,2,this.Nfd,Object(v.a)(this,this.WYc,"sendPostMessageIfNecessary"),113),this.Hb.$b(this.krb))}WYc(){this.Nme&&(this.R6a.CWR(()=>this.R6a.result.sendMessage(F.a.editNotification,null)),w.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.Nme=!1)}Nsn(){try{this.xad&&(Pe.c(Ra.a.editDocument),this.xad=!1)}catch(b){this.xad=!1,w.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+b)}}}
Object(r.a)(Xi,"EditNotificationManager",null,[730]);class zf{constructor(b,h,n,x,E){this.Ppe=this.krb=null;this.XRa=this.Dfe=!1;this.Hb=h;this.Nfd=b;this.R6a=n;this.Kj=x;this.jze=E;this.wKi(null)}wKi(){const b=document.getElementById(u.AFrameworkApplication.bXb);!this.XRa&&this.Kj&&b&&(this.Kj.mb(kb.a.iX,b,Object(v.a)(this,this.azf,"mouseActivityHandler"),null),this.XRa=!0);this.jze(()=>{this.dispose()})}azf(){this.XRa&&(this.Kj.sc(kb.a.iX,document.getElementById(u.AFrameworkApplication.bXb),Object(v.a)(this,
this.azf,"mouseActivityHandler")),this.XRa=!1);this.D5g();return!1}D5g(){this.Dfe=!0;this.Ppe||(this.Ppe=new We.a(3,2,this.Nfd,Object(v.a)(this,this.wKi,"registerHandlerTask"),112),this.Hb.$b(this.Ppe));this.krb||(this.WYc(null),this.krb=new We.a(3,2,this.Nfd,Object(v.a)(this,this.WYc,"sendPostMessageIfNecessary"),111),this.Hb.$b(this.krb))}WYc(){this.Dfe&&(this.R6a.CWR(()=>this.R6a.result.sendMessage(F.a.Ylo,null)),w.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),
this.Dfe=!1)}dispose(){this.XRa&&(this.Kj.sc(kb.a.iX,document.getElementById(u.AFrameworkApplication.bXb),Object(v.a)(this,this.azf,"mouseActivityHandler")),this.XRa=!1)}}Object(r.a)(zf,"UserActivityHostNotificationManager",null,[729,10]);var sf=d(167),Ye=d(83),Bh=d(730);class Sg{constructor(){this.W=null}get name(){return"Common.App.EditNotification"}init(){u.AFrameworkApplication.K&&u.AFrameworkApplication.K.yq(Object(v.a)(this,this.Ww,"onFullAppSettingsReady"))}Ww(){Sg.UYk&&0<Sg.u4e&&(this.W.register(oe,
"Common.App.HostNotification.EditNotificationEventSource").singleInstance(),this.W.register(zf,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").singleInstance().Xd(()=>new zf(6E4,Ye.a.instance,Bh.a.Iq(this.W.Za("Postmessage.IHostPostmessenger")),sf.a.instance,u.AFrameworkApplication.rK)),this.W.register(Xi,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").singleInstance().Xd(()=>
new Xi(Sg.u4e,Ye.a.instance,Bh.a.Iq(this.W.Za("Postmessage.IHostPostmessenger")),this.W.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.W.Pa("Common.Interface.IUserActivityHostNotificationManager"),Sg.VYk,Sg.QYk)),this.W.resolve("Common.Interface.IEditNotificationManager"),w.ULS.shipAssertTag(38086291,209,0<Sg.u4e,"EditNotification Interval is less than or equal to 0."))}zc(b){this.W=b}dispose(){}static get u4e(){return u.AFrameworkApplication.K?parseInt(u.AFrameworkApplication.K.appSettings.EditNotificationTimeIntervalMs||
"300000"):3E5}static get QYk(){return u.AFrameworkApplication.K?parseInt(u.AFrameworkApplication.K.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get UYk(){return!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("EditNotificationIsEnabled")}static get VYk(){return!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("EditNotificationPostMessageIsEnabled")}static main(){N.a.instance.Pc(new Sg)}}Object(r.a)(Sg,"CommonHostNotificationPackage",null,
[1,2]);class Ti{constructor(b,h,n){this.btb=null;this.Hb=b;this.ga=h;this.sDg=n.create()}$ib(){this.btb?w.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(w.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.btb=new We.a(2,1,3E4,Object(v.a)(this,this.h7d,"showFloatPane"),67),this.Hb.$b(this.btb))}h7d(){this.btb=null;w.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.sDg.display()}lOa(){this.ga.pa(Ra.a.h7d,
Ld.a.frame,Object(v.a)(this,this.XUn,"showFloatPaneHandler"))}XUn(b,h,n,x,E){return b!==Ra.a.h7d?2:1===n?32:2===n&&E?(w.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",E),E?this.$ib():(this.btb?(w.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.Hb.ef(this.btb)):(w.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.sDg.remove(null)),this.btb=null),32):8}}Object(r.a)(Ti,"FloatPaneActor",null,[683]);
var ig=d(90),Tg=d(98),af=d(28),qf=d(29);class gj{constructor(b,h,n,x,E){this.ywe=this.Rnc=this.Vid=this.vTa=this.vca=this.RQa=this.Fhe=this.B8=this.Asc=this.pqc=this.qqc=this.xoe=null;this.Hb=h;this.Ma=b;this.gg=n;this.W=E;this.jwa=x}Irh(){this.B8=document.createElement("div");this.B8.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.B8.style.width=this.vca.width+"px";(this.ywe=this.fzl(this.jwa))?(this.vTa=document.createElement("a"),this.vTa.setAttribute(qf.a.Ah,qf.a.xz),
this.gg.mb(kb.a.click,this.vTa,Object(v.a)(this,this.Oxi,"onRedirectClick")),this.vTa.href=this.ywe,this.vTa.target="_blank",this.vTa.appendChild(this.vca),this.B8.appendChild(this.vTa)):this.B8.appendChild(this.vca);this.RQa=document.createElement("a");this.RQa.setAttribute(qf.a.Ah,qf.a.n1);this.RQa.className="StandardButton WACFloatPaneCloseButton";this.RQa.title=CommonUIStrings.l_Close;this.RQa.tabIndex=-1;this.Fhe=Tg.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",
!0,null);this.Fhe.setAttribute(qf.a.Ah,qf.a.xz);this.RQa.appendChild(this.Fhe);this.gg.mb(kb.a.click,this.RQa,Object(v.a)(this,this.onClose,"onClose"));this.B8.appendChild(this.RQa);this.Asc.appendChild(this.B8)}itl(b){const h=this.Ma.$("O365PromotionHasStarted");switch(b){case 2:return ig.a.y9(String.format("adppt{0}.png",h?"sale":""));case 1:return ig.a.y9(String.format("adxls{0}.png",h?"sale":""));case 3:return ig.a.y9(String.format("addoc{0}.png",h?"sale":""))}return null}fzl(b){const h=this.Ma.lb("O365AdPaneRedirectedURL");
switch(b){case 1:return String.format(h,"Excel");case 2:return String.format(h,"PowerPoint");case 3:return String.format(h,"Word")}return null}hide(b=null){this.Rnc=null;this.B8&&!this.Vid&&(b?w.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):w.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.B8.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.B8.style.height="0px",this.Vid=new We.a(2,1,1E3,Object(v.a)(this,
this.remove,"remove"),67),this.Hb.$b(this.Vid))}remove(){this.B8&&this.Asc&&(this.vTa&&this.gg.sc(kb.a.click,this.vTa,Object(v.a)(this,this.Oxi,"onRedirectClick")),this.gg.sc(kb.a.click,this.RQa,Object(v.a)(this,this.onClose,"onClose")),this.Asc.removeChild(this.B8),this.B8=null);this.Vid=null}display(){if(this.xoe=this.W.Pa("Common.IFloatPaneContainer"))if(this.Asc=this.xoe.container){var b=this.itl(this.jwa);b?(w.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",b),this.vca=
document.createElement("img"),this.vca.className="WACFloatPaneImage",this.qqc=Object(v.a)(this,this.gSm,"onLoadImageFinish"),af.a.addHandler(this.vca,kb.a.load,this.qqc),this.pqc=Object(v.a)(this,this.fSm,"onLoadImageError"),af.a.addHandler(this.vca,kb.a.error,this.pqc),this.vca.src=b):w.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else w.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else w.ULS.sendTraceTag(23674905,
207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}gSm(){const b=this.Ma.rc("O365AdPaneShowingDuration",60);this.Irh();this.B8.style.display="block";this.B8.style.height=this.vca.height+"px";this.Rnc=new We.a(2,1,1E3*b,Object(v.a)(this,this.hide,"hide"),67);this.Hb.$b(this.Rnc);this.bMi()}fSm(){w.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.bMi();this.vca=null}bMi(){this.qqc&&this.vca&&af.a.removeHandler(this.vca,
kb.a.load,this.qqc);this.qqc=null;this.pqc&&this.vca&&af.a.removeHandler(this.vca,kb.a.error,this.pqc);this.pqc=null}Oxi(){w.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.Rnc&&this.Hb.ef(this.Rnc);this.hide();return!0}dispose(){this.hide()}}Object(r.a)(gj,"FloatPane",null,[711]);class Fe{constructor(b,h,n,x,E){this.Hb=h;this.Ma=b;this.gg=n;this.W=E;this.jwa=x}create(){return new gj(this.Ma,this.Hb,this.gg,this.jwa,this.W)}}
Object(r.a)(Fe,"FloatPaneFactory",null,[682]);var $e=d(204);class Ff{constructor(){this.W=null}get name(){return"Common.App.FloatPane"}get ibi(){return u.AFrameworkApplication.K.$("O365AdvertisementIsEnabled")&&u.AFrameworkApplication.K.$("IsShowAdvertisementPaneEnabled")}init(){this.ibi&&(w.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").$ib(),w.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),
this.W.resolve("Common.App.FloatPane.IFloatPaneActor").lOa())}zc(b){this.W=b;this.ibi&&(this.W.register(Fe,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Xd(()=>new Fe(u.AFrameworkApplication.K,u.AFrameworkApplication.uc,$e.a.instance,u.AFrameworkApplication.ua.Sb.jo,this.W)).singleInstance(),this.W.register(Ti,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Xd(()=>new Ti(u.AFrameworkApplication.uc,u.AFrameworkApplication.ya,
this.W.resolve("Common.App.FloatPane.IFloatPaneFactory"))).singleInstance())}dispose(){}static main(){N.a.instance.Pc(new Ff)}}Object(r.a)(Ff,"FloatPanePackage",null,[1,2]);var ye=d(1592);class Sf{}Object(r.a)(Sf,"LokiTokenResult",null,[]);class vg{constructor(b){this.Ufd=b}Vdf(){const b=this.swl();return b?vg.Nqf?new Promise((h,n)=>{this.Ufd.continueWith(()=>{this.Ufd.ho||this.Ufd.Ii?n(Error.create("Error downloading auth library")):this.Ufd.result.aoa("Loki",b).then(x=>{x=u.AFrameworkApplication.K.$("ForceLokiFallbackToACLPTokenIsEnabled")?
this.vwl():x.IsSuccess&&x.Token?Object.assign(new Sf,{isSuccess:!0,token:x.Token,errorMessage:null}):Object.assign(new Sf,{isSuccess:!1,token:null,errorMessage:JSON.stringify(x)});h(x);return x})})}):Promise.resolve(Object.assign(new Sf,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new Sf,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",ye.a.RKh())}))}vwl(){const b=
u.AFrameworkApplication.K.lb("LokiUserDataSignature")||"";return Object.assign(new Sf,{isSuccess:!0,token:b,errorMessage:null})}swl(){let b=null;const h=ye.a.hDd();2===h?b=u.AFrameworkApplication.K.lb("LokiAADAppId"):1===h&&(b=u.AFrameworkApplication.K.lb("LokiMSAAppId"));return b}static get Nqf(){return u.AFrameworkApplication.K.$("IsO365CommercialHost")||u.AFrameworkApplication.K.$("IsO365ConsumerHost")}}Object(r.a)(vg,"LokiTokenManager",null,[680]);class Tf{get name(){return"Common.App.LivePersonaUtils"}init(){Oa.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}zc(b){b.register(vg,
"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").singleInstance().Xd(()=>new vg(Bh.a.Iq(b.Za("Common.App.OAuth.IOAuthManager"))))}static main(){N.a.instance.Pc(new Tf)}}Object(r.a)(Tf,"LivePersonaUtilsPackage",null,[1,2]);class wg{constructor(b){this.gge=b}vai(b){if(!this.gge)return!0;b=Ec.a.cdf(b);if(!b)return!1;b=b.toLowerCase();for(let h=0;h<this.gge.length;h++)if(b.endsWith(this.gge[h]))return!0;return!1}}Object(r.a)(wg,"DomainAllowListManager",null,[]);class rf{constructor(b,
h){this.A0e=null;this.UIe=b;this.url=h}get W7f(){return Ec.a.Tua(this.url)}get zr(){return this.UIe}k4f(){const b={},h=this.zr;b.a=this.W7f;b.b=this.round(h.navigationStart);b.c=this.round(h.unloadEventStart);b.d=this.round(h.unloadEventEnd);b.e=this.round(h.redirectStart);b.f=this.round(h.redirectEnd);b.g=this.round(h.fetchStart);b.h=this.round(h.domainLookupStart);b.i=this.round(h.domainLookupEnd);b.j=this.round(h.connectStart);b.k=this.round(h.connectEnd);b.l=void 0!==h.secureConnectionStart&&
null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.m=this.round(h.requestStart);b.n=this.round(h.responseStart);b.o=this.round(h.responseEnd);b.q=this.round(h.domInteractive);b.r=this.round(h.domContentLoadedEventStart);b.s=this.round(h.domContentLoadedEventEnd);b.t=this.round(h.domComplete);b.u=this.round(h.loadEventStart);b.v=this.round(h.loadEventEnd);b.w=this.A0e;return b}round(b){return Math.round(1E3*b)/1E3}}Object(r.a)(rf,"PerformanceTimingEntry",null,[]);const sh=(b,h)=>
{const n={};let x=null;switch(b){case 0:x="ResourceTiming";b=h.a;null!=b&&(n.Url=b);b=h.b;null!=b&&(n.InitiatorType=b);b=null==h.c?null:h.c.toString();null!=b&&(n.RedirectStart=b);b=null==h.d?null:h.d.toString();null!=b&&(n.RedirectEnd=b);b=null==h.e?null:h.e.toString();null!=b&&(n.FetchStart=b);b=null==h.f?null:h.f.toString();null!=b&&(n.DomainLookupStart=b);b=null==h.g?null:h.g.toString();null!=b&&(n.DomainLookupEnd=b);b=null==h.h?null:h.h.toString();null!=b&&(n.ConnectStart=b);b=null==h.i?null:
h.i.toString();null!=b&&(n.ConnectEnd=b);b=null==h.j?null:h.j.toString();null!=b&&(n.SecureConnectionStart=b);b=null==h.k?null:h.k.toString();null!=b&&(n.RequestStart=b);b=null==h.l?null:h.l.toString();null!=b&&(n.ResponseStart=b);b=null==h.m?null:h.m.toString();null!=b&&(n.ResponseEnd=b);b=h.n;null!=b&&(n.CustomText=b);b=null==h.o?null:h.o.toString();null!=b&&(n.DecodedBodySize=b);b=null==h.p?null:h.p.toString();null!=b&&(n.EncodedBodySize=b);h=null==h.q?null:h.q.toString();null!=h&&(n.TransferSize=
h);break;case 1:x="PerformanceTiming",b=h.a,null!=b&&(n.Url=b),b=null==h.b?null:h.b.toString(),null!=b&&(n.NavigationStart=b),b=null==h.c?null:h.c.toString(),null!=b&&(n.UnloadEventStart=b),b=null==h.d?null:h.d.toString(),null!=b&&(n.UnloadEventEnd=b),b=null==h.e?null:h.e.toString(),null!=b&&(n.RedirectStart=b),b=null==h.f?null:h.f.toString(),null!=b&&(n.RedirectEnd=b),b=null==h.g?null:h.g.toString(),null!=b&&(n.FetchStart=b),b=null==h.h?null:h.h.toString(),null!=b&&(n.DomainLookupStart=b),b=null==
h.i?null:h.i.toString(),null!=b&&(n.DomainLookupEnd=b),b=null==h.j?null:h.j.toString(),null!=b&&(n.ConnectStart=b),b=null==h.k?null:h.k.toString(),null!=b&&(n.ConnectEnd=b),b=null==h.l?null:h.l.toString(),null!=b&&(n.SecureConnectionStart=b),b=null==h.m?null:h.m.toString(),null!=b&&(n.RequestStart=b),b=null==h.n?null:h.n.toString(),null!=b&&(n.ResponseStart=b),b=null==h.o?null:h.o.toString(),null!=b&&(n.ResponseEnd=b),b=null==h.p?null:h.p.toString(),null!=b&&(n.DomLoading=b),b=null==h.q?null:h.q.toString(),
null!=b&&(n.DomInteractive=b),b=null==h.r?null:h.r.toString(),null!=b&&(n.DomContentLoadedEventStart=b),b=null==h.s?null:h.s.toString(),null!=b&&(n.DomContentLoadedEventEnd=b),b=null==h.t?null:h.t.toString(),null!=b&&(n.DomComplete=b),b=null==h.u?null:h.u.toString(),null!=b&&(n.LoadEventStart=b),b=null==h.v?null:h.v.toString(),null!=b&&(n.LoadEventEnd=b),h=h.w,null!=h&&(n.CustomText=h)}n.Table=x;return Sys.Serialization.JavaScriptSerializer.serialize(n)};var si=d(39),Dg=d(198),ai=d(156);class Ue{constructor(b,
h=null,n=null){this.Mg=b;this.V7f=this;this.WCj=h||(()=>window.location.href);this.vme=new wg(n)}run(){if(Ue.V$a(window.performance))try{const E=this.WCj();if(Ue.QWj.exec(E)&&this.vme.vai(E)){var b=new rf(window.performance.timing,E);ai.a.instance.Uen(b.zr.fetchStart);ai.a.instance.Ven(b.zr.navigationStart);ai.a.instance.gX(si.a.$bl,"connectStart","requestStart");ai.a.instance.gX(si.a.hcl,"requestStart","responseStart");ai.a.instance.gX(si.a.kcl,"responseStart","responseEnd");this.V7f.rEb(1,b.k4f());
this.Mg.Tf(si.a.zcb,b.zr.fetchStart);this.Mg.Tf(si.a.ecl,b.zr.domainLookupStart);this.Mg.Tf(si.a.dcl,b.zr.domainLookupEnd);this.Mg.Tf(si.a.bcl,b.zr.connectStart);this.Mg.Tf(si.a.mcl,b.zr.secureConnectionStart);this.Mg.Tf(si.a.acl,b.zr.connectEnd);this.Mg.Tf(si.a.icl,b.zr.requestStart);this.Mg.Tf(si.a.H9e,b.zr.responseStart);this.Mg.Tf(si.a.fcl,b.zr.responseEnd-b.zr.responseStart);this.Mg.Tf(si.a.jcl,b.zr.responseStart-b.zr.requestStart);var h=0,n=0,x=0;({transferSize:h,d5e:n,W0e:x}=this.rao(E)).returnValue&&
(this.Mg.Tf(si.a.ocl,h),this.Mg.Tf(si.a.ccl,x),this.Mg.Tf(si.a.gcl,n));this.Mg.Tf(si.a.G9e,b.zr.navigationStart)}}catch(E){w.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",E)}}rao(b){let h,n,x;x=n=h=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:h,d5e:n,W0e:x};b=window.performance.getEntriesByName(b,"navigation");if(void 0===b||null===b||1!==b.length)return{returnValue:!1,transferSize:h,
d5e:n,W0e:x};b=b[0];var E=b.transferSize;void 0!==h&&null!==h&&(h=E);E=b.decodedBodySize;void 0!==E&&null!==E&&(x=E);b=b.encodedBodySize;void 0!==b&&null!==b&&(n=b);return{returnValue:!0,transferSize:h,d5e:n,W0e:x}}rEb(b,h){w.ULS.sendTraceTag(4551815,306,50,sh(b,h))}static get instance(){return Ue._instance||(Ue._instance=new Ue(Dg.a.instance,null,u.AFrameworkApplication.K.$("PerfTimingLoggerFilterDomainsIsEnabled")?u.AFrameworkApplication.K.AB("ResourceLoggerDomainAllowList"):null))}static V$a(b){return!(void 0===
b||null===b)&&!(void 0===b.timing||null===b.timing)}}Ue._instance=null;Ue.QWj=RegExp("^https?://.*","i");Object(r.a)(Ue,"PerformanceTimingLogger",null,[679]);class ed{constructor(b,h){this.A0e=null;this.UIe=b;this.behavior=h;this.url=this.zr.name}get W7f(){return 2===this.behavior?this.url:Ec.a.Tua(this.url)}get zr(){return this.UIe}k4f(){const b={},h=this.zr;b.a=this.W7f;b.b=h.initiatorType;b.c=this.round(h.redirectStart);b.d=this.round(h.redirectEnd);b.e=this.round(h.fetchStart);b.f=this.round(h.domainLookupStart);
b.g=this.round(h.domainLookupEnd);b.h=this.round(h.connectStart);b.i=this.round(h.connectEnd);b.j=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.k=this.round(h.requestStart);b.l=this.round(h.responseStart);b.m=this.round(h.responseEnd);b.o=this.round(ed.P2b(h,"decodedBodySize"));b.p=this.round(ed.P2b(h,"encodedBodySize"));b.q=this.round(ed.P2b(h,"transferSize"));b.n=this.A0e;return b}round(b){return Math.round(1E3*b)/1E3}static P2b(b,h){return b[h]}}
Object(r.a)(ed,"ResourceTimingEntry",null,[720]);class Dl{constructor(b,h=null,n=100){this.stg=b;this.Gld=h;this.Fic={};this.mwj=n}$9n(b){var h=b.name.toLowerCase();const n=Ec.a.Wef(h);this.Hvn(n,h)&&(n in this.Fic?w.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",n):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.kkm(b),h.encodedsize=ed.P2b(b,"encodedBodySize"),h.decodedsize=ed.P2b(b,"decodedBodySize"),this.Fic[n]=h))}Hvn(b,
h){if(this.stg)return Array.contains(this.stg,b);if(this.Gld)for(b=Ec.a.b2(h),h=0;h<this.Gld.length;h++)if(this.Gld[h]&&b.endsWith(this.Gld[h]))return!0;return!1}kkm(b){try{const h=ed.P2b(b,"transferSize");if(void 0!==h&&null!==h)return!h;w.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return b.responseEnd-b.fetchStart<this.mwj}catch(h){w.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",
h.message)}return!1}Tgn(){if(Ia.a.nf(this.Fic))w.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var b=u.AFrameworkApplication.S1?u.AFrameworkApplication.S1.split(";"):[],h=Object.assign(new ab.a,{extendedProperties:qa.a.aF()});h.extendedProperties.set("Flights",z.c(b));this.kli(h,this.Fic,ta.Health.instance)}}kli(b,h,n){if(h){var x=0,E=0,S=0,ma=0,Fa=0,$a=0,sb=0,Jb=0,Sb=0,oc=0,Ic=0;for(let Gd in h){var gd=h[Gd];try{const vd=Object(ja.a)(Object,
gd);if(!vd)continue;const ce=vd.iscached?Boolean.parse(vd.iscached.toString()):!1,od=vd.fetchstart?this.parseFloat(vd.fetchstart.toString()):0,Yd=(vd.responseend?this.parseFloat(vd.responseend.toString()):0)-od,ne=vd.encodedsize?this.parseFloat(vd.encodedsize.toString()):0,Df=vd.decodedsize?this.parseFloat(vd.decodedsize.toString()):0;x+=Yd;ma+=ne;sb+=Df;oc++;ce?(S+=Yd,$a+=ne,Sb+=Df,Ic++):(E+=Yd,Fa+=ne,Jb+=Df)}catch(vd){w.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",
vd.message)}}b.extendedProperties.set("StaticResources",z.c(h));b.extendedProperties.set("TotalResourceDownloadLatency",x.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",E.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",S.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",ma.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Fa.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",
$a.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",sb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Jb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",Sb.toString());b.extendedProperties.set("TotalNumberOfResourcesDownloaded",oc.toString());b.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Ic.toString());n.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",
null);n.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",b)}}parseFloat(b){if(!b)return 0;b=parseFloat(b);return isNaN(b)?0:b}}Object(r.a)(Dl,"AppStaticResourceManager",null,[]);class Hi extends Sys.EventArgs{constructor(b){super();this.entries=b}}Object(r.a)(Hi,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class tk{constructor(b,h,n=null,x=null,E=100){this.Gue=!1;this.$n=null;this.Nkc=0;this.sa=new Ge.a;this.Pic=null;this.uY=!1;this.L1g=0;this.Hb=b;this.hzg=0;this.V7f=this;this.vme=new wg(n);
this.wJ=h;x&&(this.Pic=new Dl(null,x,E))}get Dfh(){try{return!(void 0===this.wJ||null===this.wJ)&&!(void 0===this.wJ.getEntriesByType||null===this.wJ.getEntriesByType)}catch(b){return w.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",b),!1}}get POk(){return this.hzg}get isActive(){return this.uY}get c4f(){return this.L1g}q8g(b){this.sa.addHandler(tk.a6e,b)}hNi(b){this.sa.removeHandler(tk.a6e,b)}zc(b,h){const n=this.c4f!==b;this.L1g=
b;this.isActive&&this.Hb&&n&&(this.ef(),this.$b());this.hzg=h}activate(){!this.isActive&&this.Dfh&&(this.$b(),this.uY=!0)}deactivate(b){this.isActive&&(this.ef(),b&&this.flush(),this.uY=!1)}flush(){if(this.isActive&&this.Dfh)try{var b=window.performance.getEntriesByType("resource");0<b.length-this.Nkc&&w.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",b.length-this.Nkc);const h=!(void 0===window.performance.clearResourceTimings||
null===window.performance.clearResourceTimings);h&&(window.performance.clearResourceTimings(),this.Nkc=0);const n=[];for(let x=this.Nkc;x<b.length;x++)this.vme.vai(b[x].name)&&(this.Pic&&this.Pic.$9n(b[x]),n.push(new ed(b[x],this.POk)));h||(this.Nkc=b.length);this.sa.raiseEvent(tk.a6e,new Hi(n));for(b=0;b<n.length;b++)0!==n[b].behavior&&2!==n[b].behavior||this.V7f.rEb(0,n[b].k4f());0<n.length&&w.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",
n.length)}catch(h){w.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",h)}}rEb(b,h){w.ULS.sendTraceTag(4310804,306,50,sh(b,h))}Nen(){this.Pic.Tgn()}$b(){this.Hb&&0<this.c4f&&(this.$n=new We.a(3,2,1E3*this.c4f,()=>{this.flush()},5),this.Hb.$b(this.$n),this.Gue=!0)}ef(){this.Gue&&(this.Hb.ef(this.$n),this.$n=null,this.Gue=!1)}}tk.a6e="EntriesAvailable";Object(r.a)(tk,"ResourceTimingLogger",null,[658,679]);class ok{constructor(){this.W=null}get name(){return"Common.ResourceTiming"}init(){this.W.resolve("Common.NetworkTiming.IResourceTimingLogger");
Ue.instance.run()}dispose(){}zc(b){this.W=b;let h=null;if(u.AFrameworkApplication.K.$("ResourceLoggerFilterDomainsIsEnabled"))try{h=u.AFrameworkApplication.K.AB("ResourceLoggerDomainAllowList")}catch(E){w.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const n=[];n.push(Ec.a.b2(ig.a.y7).toLowerCase());n.push(Ec.a.b2(ig.a.g_c).toLowerCase());const x=u.AFrameworkApplication.K.rc("AppStaticResourceMonitorCacheThresholdInMs",100);b.register(658,"Common.NetworkTiming.IResourceTimingLogger").singleInstance().Xd(()=>
new tk(u.AFrameworkApplication.uc,window.performance,h,n,x))}static main(){N.a.instance.Pc(new ok)}}Object(r.a)(ok,"ResourceTimingPackage",null,[1,2]);var se=d(244);class bi{constructor(){this.zfe={}}XZj(b){this.zfe[b.id.toString()]=b}KKm(b){const h=this.zfe;for(let n in h)h[n].notify(b,!1);this.zfe={}}N$m(b,h){h&&this.XZj(h);return this.$xi(b,h)}P4e(b){this.KKm(b)}qBh(b,h){b.notify(h,!0)}}Object(r.a)(bi,"AEventEmitter",null,[562]);var sl;(function(b){b[b.notStarted=0]="notStarted";b[b.waiting=1]=
"waiting";b[b.shouldRetry=2]="shouldRetry";b[b.complete=3]="complete"})(sl||(sl={}));Object(r.b)("EventResultState",sl);class El{constructor(){this._state=0}get state(){return this._state}set state(b){w.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:sl[this._state],["NewState"]:sl[b]},"ResultType",this.AWh());this._state=b}}Object(r.a)(El,"AEventResult",null,[561]);class ci extends El{constructor(){super();this.lHe=this.Vsc=null;this.state=0;this.Zre=this.IHg=!1}get Aaa(){return this.Vsc}get O2a(){return this.lHe}get h5l(){return this.IHg}AWh(){return"GetMoreInfo Result"}}
Object(r.a)(ci,"GetMoreInfoResult",El,[740,561]);var Kk=d(1351),pf=d(1512),$l=d(1004);class qd{constructor(b,h,n,x,E,S,ma,Fa){this.ga=b;this.hg=h;this.Dh=n;this.jwa=x;this.Hb=E;this.aA=S;this.sEj=ma;this.amd=Fa}din(){this.p9b.pa(Ra.a.B$b,Ld.a.frame,Object(v.a)(this,this.B$b,"openUrlInNewTab"));this.p9b.pa(Ra.a.NHf,Ld.a.frame,Object(v.a)(this,this.NHf,"openDocumentUrl"));u.AFrameworkApplication.Nda?this.qli():this.p9b.gb(Ra.a.Pyd,Ld.a.frame,Object(v.a)(this,this.Pyd,"documentLoaded"),96)}B$b(b,h,n,
x,E){E&&E.MenuItemId&&(w.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:E.SourceControlId,["AppType"]:$l.a[this.oNa]}),rd.a.ym(E.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}NHf(b,h,n,x,E){if(E&&E.MenuItemId){const S=u.AFrameworkApplication.K.$("WacInTabOpenMRUIsEnabledForUiHost"),ma=u.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");w.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",
S,ma);if(S&&ma){w.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:E.SourceControlId,["AppType"]:$l.a[this.oNa]});b=E.MenuItemId.toString();const Fa={};Fa[G.a.obc]="1";Fa[G.a.documentUrl]=b;Fa[G.a.reason]=pf.a.open;w.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");u.AFrameworkApplication.WP().execute($a=>{$a.sendMessage(F.a.Vxb,Fa)})}else this.B$b(b,h,n,x,E)}return 32}Pyd(){this.qli();return 32}TMa(b,h,n=""){if(h&&h.TG){const x=Kk.a[h.status];
h=h.TG.getTime();const E=this.lw()-h;w.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:b,["RequestStatus"]:x,["ElapsedMs"]:E,["StartTime"]:h,["Notes"]:n})}else w.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:b})}qli(){var b=u.AFrameworkApplication.K.$("QPGVCI"),h=Ec.a.jT(document.URL,"wdNewAndOpenCt",b);if(h){h=parseInt(h);var n=Ec.a.jT(document.URL,"wdPreviousSession",b);b=Ec.a.jT(document.URL,
"wdPreviousCorrelation",b);var x=u.AFrameworkApplication.K.$("NAOPLP");if(u.AFrameworkApplication.Nda){var E=u.AFrameworkApplication.Nda.getTime();!h||h>E?w.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:h,["DocumentLoadedTime"]:E,["SessionId"]:n,["Correlation"]:b}):w.ULS.sendTraceTag(5849683,202,x?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:E-h,["ClickTimestamp"]:h,
["SessionId"]:n,["Correlation"]:b})}else w.ULS.sendTraceTag(5849681,202,x?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:h,["SessionId"]:n,["Correlation"]:b})}}get p9b(){return this.ga.value}get HRc(){return this.hg.value}get Bri(){return this.Dh.value}get oNa(){return this.jwa.value}get vUd(){return this.Hb.value}get lw(){return this.aA}get nNa(){return this.sEj.value}get S2a(){return this.amd.value}static get instance(){return qd._instance||
(qd._instance=qd.lr())}static lr(){return new qd(new se.a(()=>u.AFrameworkApplication.ya),new se.a(()=>u.AFrameworkApplication.Ze),new se.a(()=>u.AFrameworkApplication.ua),new se.a(()=>u.AFrameworkApplication.ua.Sb.jo),new se.a(()=>u.AFrameworkApplication.uc),()=>(new Date).getTime(),new se.a(()=>u.AFrameworkApplication.ua.Sb.nNa),new se.a(()=>u.AFrameworkApplication.S2a))}}qd._instance=null;Object(r.a)(qd,"NewAndOpenCommonHelpers",null,[556]);class Ak{constructor(b,h,n){this.ykd=this.$n=null;this.ODe=
0;this.wSj=b;this.Hb=h;this.Izg=n}T8j(){this.ODe=this.ccc+1}NSf(b){this.$n&&(this.Hb.ef(this.$n),this.$n=null);b&&(this.ODe=0)}H_n(b){const h=this.A6n;0<=h?(this.T8j(),this.NSf(!1),this.$n=new We.a(4,1,h,b,107),this.Hb.$b(this.$n)):(this.NSf(!0),w.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.Izg}))}get ccc(){return this.ODe}get A6n(){return this.ccc>=this.IVi.length?-1:this.IVi[this.ccc]}get IVi(){if(!this.ykd){const b=(this.wSj.value||"0").split(",");this.ykd=[];for(let h=
0;h<b.length;h++){const n=parseInt(b[h]);isNaN(n)?w.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.Izg,["Entry"]:b[h]}):Array.add(this.ykd,n)}}return this.ykd}}Object(r.a)(Ak,"RetryHelper",null,[]);class tl extends bi{constructor(b,h){super();this.uxa=b;this.Ztc=new Ak(h,this.sRc.vUd,"GetMoreInfo");this.Sp=new ci}TBm(){this.yxf("Document opened")}dJk(b){return()=>{this.yxf(b,!0)}}$xi(b,h=null){w.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",
{["Trigger"]:b});3===this.Sp.state?(h&&this.qBh(h,this.Sp),w.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:b})):this.yxf(b);return this.Sp}yxf(b,h=!1){this.Ztc.NSf(!h);1===this.Sp.state?w.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:b,["RetryIndex"]:this.Ztc.ccc}):(w.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:b,["RetryIndex"]:this.Ztc.ccc}),this.Sp.state=1,h=String.format("{0}GetMoreInfoHandler.ashx?{1}",
this.sRc.nNa,u.AFrameworkApplication.um),this.sRc.HRc.oWb(h,1,null,null,[tl.mUg,tl.f0g],5,this.YHk(),this.XHk(b)))}YHk(){return b=>{var h=!1;let n=!1;var x=!1,E;u.AFrameworkApplication.K.$("GetMoreInfoDataFromResponseBody")&&(b.data.Ee?({Dv:E}=z.d(b.data.Ee)).returnValue?E?(x=!0,this.Sp.lHe=E.StorageServiceDisplayName,this.Sp.Vsc=tl.lhi(E.PersonalFileStorageUrl)?E.PersonalFileStorageUrl:"",""===this.Sp.Aaa&&"SharePointOnlineConsumer"===u.AFrameworkApplication.K.lb("FileSource")&&(this.Sp.Vsc=Ec.a.Tua(u.AFrameworkApplication.breadcrumbFolderUrl)),
h=""===this.Sp.Aaa&&""!==this.Sp.O2a):w.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):w.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):w.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));x||((E=b.data.qj)?(this.Sp.lHe=
(E[tl.f0g]||"").toString(),h=(E[tl.mUg]||"").toString(),this.Sp.Vsc=tl.lhi(h)?h:"",""===this.Sp.Aaa&&"SharePointOnlineConsumer"===u.AFrameworkApplication.K.lb("FileSource")?(this.Sp.Vsc=Ec.a.Tua(u.AFrameworkApplication.breadcrumbFolderUrl),h=""===this.Sp.Aaa&&""!==this.Sp.O2a):h=""===h&&""!==this.Sp.O2a):(w.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),n=!0));x=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.Ztc.ccc,n,h,x);this.sRc.TMa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",b.data,x);this.YVi(3,h,n)}}XHk(b){return h=>{this.sRc.TMa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",h.data,"Failure");this.YVi(2);this.Ztc.H_n(this.dJk(b))}}YVi(b,h=!1,n=!1){this.Sp.state=b;this.Sp.IHg=h;this.Sp.Zre=n;this.P4e(this.Sp)}get sRc(){return this.uxa.value}static get instance(){return tl._instance||(tl._instance=tl.lr())}static lr(){return new tl(new se.a(()=>qd.instance),
new se.a(()=>u.AFrameworkApplication.Bxl))}static lhi(b){if(!b)return w.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(B.a.mh(b).startsWith("https://"))return!0;w.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}tl.mUg="PersonalFileStorageUrl";tl.f0g="StorageServiceDisplayName";tl._instance=null;Object(r.a)(tl,"GetMoreInfoActor",bi,[]);class Ek{constructor(b,h,n,x,E){this.DFj=6E4;this.x5h="inactive";this.u5g="active";
this.uY=!0;this.Hb=b;this.vDj=h;this.aA=n;this.Wmd=x;this.sa=new Ge.a;E&&this.y_n();this.ULg=this.WRh()}qMe(b){this.sa.addHandler(this.u5g,b)}d2j(b){this.sa.addHandler(this.x5h,b)}y_n(){const b=new We.a(5,2,this.DFj,Object(v.a)(this,this.tZl,"inactiveLoop"),108);this.uZl.$b(b)}tZl(){const b=this.WRh(),h=this.lw()-b;h>this.w$d&&this.uY&&(w.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:h}),this.uY=!1,this.sa.raiseEvent(this.x5h));b-this.ULg>this.w$d&&(this.uY=!0,
this.sa.raiseEvent(this.u5g));this.ULg=b}get uZl(){return this.Hb.value}get WRh(){return this.vDj}get lw(){return this.aA}get w$d(){return this.Wmd.value}static get instance(){return Ek._instance||(Ek._instance=Ek.lr())}static lr(){return new Ek(new se.a(()=>Ye.a.instance),()=>u.AFrameworkApplication.muf.getTime(),()=>(new Date).getTime(),new se.a(()=>u.AFrameworkApplication.w$d),!0)}}Ek._instance=null;Object(r.a)(Ek,"InactivityManager",null,[]);var Fl=d(1610);class Sn extends El{constructor(){super();
this.nLj=this.UPg=this.TPg=null;this.state=this.M1g=0;this.Zre=!1}get wzf(){return this.TPg}get Pqi(){return this.UPg}get E6n(){return this.M1g}AWh(){return"MruActor Result"}}Object(r.a)(Sn,"MruResult",El,[560,561]);class hm{constructor(b,h,n){this.task=null;this.DBb=b;this.maxRetries=h;this.taskManager=n;this.retryCount=this.$Lc=0;this.ZBe=this.rPc=null}egm(b,h){return b===ua.a.k1b||20===h||18===h||3===h}zhm(b){return 3===b||5===b||6===b||7===b||9===b||10===b||11===b||12===b||13===b||14===b||15===
b||16===b||23===b||26===b||27===b||28===b}get j_d(){return this.ZBe}reset(){this.$Lc=this.retryCount=0;this.ZBe=this.rPc=null;this.task&&(this.taskManager.ef(this.task),this.task=null)}E2l(b,h,n,x){this.ZBe=String.format("{0}_{1}",n,x);if(this.retryCount>=this.maxRetries)return w.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.egm(n,x))return w.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.zhm(x)&&1<=this.$Lc)return this.rPc=n,!1;h=
Math.max(h,this.DBb*Math.pow(2,this.$Lc));if(26===x)h=Math.max(h,3E4);else if(27===x||28===x)h=Math.max(h,6E4);9===x||412===n&&(null==this.rPc||412!==this.rPc)?h=500:this.$Lc+=1;this.rPc=n;this.retryCount+=1;this.task&&this.taskManager.ef(this.task);w.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",h);this.task=new We.a(2,1,h,b,107);this.taskManager.$b(this.task);return!0}}Object(r.a)(hm,"RetryManager",null,[]);var Mg=d(159);class Xo{constructor(){this.mruItemId=this.app=this.documentExt=
this.documentName=this.folderName=this.documentUrl=null}}Object(r.a)(Xo,"WriteOptions",null,[]);var vj=d(584);class Zf extends bi{constructor(b,h,n,x,E,S,ma){super();this.uxa=b;this.eKj=h;this.L8a=new hm(u.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),u.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.WL.vUd);this.W9a=new hm(u.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",
15E3),u.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.WL.vUd);this.qQj=n;this.B4g=x;this.UYj={};this.qia=new Sn;this.SCj=E;this.sfd="";this.IK=S;this.ABg=ma;this.Iid="";this.vQj=u.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.recentLinksCount",25)}get fde(){return this.UYj}Lln(){this.WL.p9b.pa(Ra.a.NNi,Ld.a.frame,Object(v.a)(this,this.uqn,"renameMruEntry"))}uqn(){return this.m$f("Rename")}gCm(){this.Pni("File Opened")}hCm(){this.Pni("IntervalUpdate")}Pni(b){w.ULS.sendTraceTag(5849670,
202,50,"Starting update of MRU entry {0}",{["Trigger"]:b});this.m$f(b)}WKa(b){(b=B.a.WKa(b))&&b.startsWith(".")&&(b=b.substring(1,b.length));return b}GKh(){switch(this.WL.oNa){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}FMl(b){var h=this.SCj();if(!h)return null;const n=new Xo;n.documentUrl=this.ABg.value?encodeURI(h):h;n.mruItemId=this.sfd;n.app=this.GKh();if(h=this.IK())n.folderName=h.breadcrumbFolderName,
h=h.yz,n.documentName=B.a.eI(h),n.documentExt=this.WKa(h);b&&(n.documentName?n.documentName.length?255<=n.documentName.length?b.set("DocumentNameLength","Long"):2084<=n.documentName.length&&b.set("DocumentNameLength","VeryLong"):b.set("DocumentNameLength","0"):b.set("DocumentNameLength","Null"));return JSON.stringify(n)}m$f(b,h=!1){if(4===this.WL.oNa&&!u.AFrameworkApplication.LDc)return 2;var n=qa.a.aF();n&&(n.set("Trigger",b),n.set("IsRetry",h?"true":"false"),n.set("MruIdSent",this.sfd?"true":"false"),
n.set("URLEncoded",this.ABg.value?"true":"false"));ta.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",n);b=this.FMl(n);if(!b)return h=!u.AFrameworkApplication.eMb,n&&(n.set("WebEditingIsEnabled",u.AFrameworkApplication.eMb?"true":"false"),n.set("ProtectedFile",u.AFrameworkApplication.protectFile?"true":"false")),ta.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",h,!1,Object.assign(new ab.a,{extendedProperties:n})),2;this.W9a&&!h&&this.W9a.reset();n=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",
this.WL.nNa,this.Lvf);this.B4g?this.fde["X-FileId"]=u.AFrameworkApplication.um:n+=String.format("&{0}",u.AFrameworkApplication.um);u.AFrameworkApplication.sessionStartInfoSettings&&(this.fde["X-Office-AudienceGroup"]=Object(ja.a)(String,u.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");this.fde["X-Timeout"]=15E3;return this.WL.HRc.Lj(n,2,b,this.fde,!0,5,Object(v.a)(this,this.Rso,"writeMruV2EntryOnServerSuccessCallback"),Object(v.a)(this,this.OMk,"createWriteMruV2EntryOnServerFailureCallback"),
null,void 0,void 0,void 0,void 0,"4")}Rso(b){this.s1h(b.data)}s1h(b){const h=qa.a.aF();this.W9a&&(h&&this.W9a.j_d&&(h.set("LastError",this.W9a.j_d),h.set("NumRetries",this.W9a.retryCount.toString())),this.W9a.reset());const n=Fl.c(b.Ee);n&&n.diagnostics_data&&(this.sfd=n.diagnostics_data.mru_id);b=+b.uS-+b.TG;h&&h.set("RequestDuration",b.toString());ta.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new ab.a,{extendedProperties:h}))}OMk(b){if(b.data.mf===ua.a.rCc)this.s1h(b.data);else{var h=
b.data.mf===ua.a.Vfa,n=qa.a.aF();this.B1h(this.W9a,b,this.wMk(),n);n&&(n.set("StatusCode",b.data.mf.toString()),h||this.FMe(b.data,n));ta.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",b.data.mf),h,!1,Object.assign(new ab.a,{extendedProperties:n}))}}wMk(){return()=>{this.m$f("Retry",!0)}}Jxl(){this.D8b("Polling")}Ixl(){this.D8b("Retry",!0)}WBm(){this.D8b("Open")}VBm(){this.D8b("Activity")}UBm(){this.D8b("OpenRecentLinks",!1,!0)}Ini(){this.D8b("ActivityRecentLinks",!1,
!0)}D8b(b,h=!1,n=!1){w.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:b});const x=qa.a.aF();x&&(x.set("Trigger",b),x.set("IsRetry",h?"true":"false"),n&&x.set("RecentLinks","true"));ta.Health.instance.recordKpiUsage("GetMru",0,"smartfio",x);this.L8a&&!h&&this.L8a.reset();n?this.ish(Object(v.a)(this,this.Kxl,"getMruV2ForRecentLinksFromServerSuccessCallback"),Object(v.a)(this,this.Fxl,"getMruForRecentLinksFromServerFailureCallback"),!0):this.ish(Object(v.a)(this,this.Lxl,"getMruV2FromServerSuccessCallback"),
Object(v.a)(this,this.Hxl,"getMruFromServerFailureCallback"))}FMe(b,h){b&&b.qj&&(b=b.qj["X-CorrelationId"])&&h.set("ServerCorrelationId",b)}Lvm(b,h){b&&(h&&h.set("RequestDuration",(+b.uS-+b.TG).toString()),ta.Health.instance.recordKpiSuccess("GetMru",Object.assign(new ab.a,{extendedProperties:h})))}Lxl(b){this.ZSh(b)}ZSh(b,h=!1){var n="";let x=null,E=null,S=null;const ma=Fl.c(b.data.Ee);ma&&(x=ma.places?ma.places.items:[],E=ma.documents?ma.documents.items:[],(S=Fl.a(ma,h))&&(n=z.c(S)));u.AFrameworkApplication.ua&&
u.AFrameworkApplication.ua.Sb.mMa&&Mg.c()&&(h?this.Iid=n:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(n,!0)));n=qa.a.aF();this.L8a&&(n&&this.L8a.j_d&&(n.set("LastError",this.L8a.j_d),n.set("NumRetries",this.L8a.retryCount.toString())),this.L8a.reset());h&&n&&n.set("RecentLinks","true");S||x||E?(h?this.WL.TMa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Success"):this.WL.TMa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Success"),this.Bbe(3,S,x,E),this.Lvm(b.data,
n)):(h?this.WL.TMa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Failure: Invalid JSON"):this.WL.TMa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Failure: Invalid JSON"),n&&this.FMe(b.data,n),ta.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new ab.a,{extendedProperties:n})),this.Bbe(3,null,null,null,!0));this.P4e(this.qia)}Kxl(b){this.ZSh(b,!0)}B1h(b,h,n,x){let E=0,S=0;const ma=Fl.c(h.data.Ee);ma&&(null!=ma.response_code&&(E=ma.response_code,
x&&x.set("MruResponseCode",E.toString()),9===E&&(this.sfd="")),ma.error_data&&null!=ma.error_data.retry_after_ms&&(S=ma.error_data.retry_after_ms,x&&x.set("ExpectedRetryAfter",S.toString())));b&&(h=b.E2l(n,S,h.data.mf,E),x&&(x.set("CurrentRetryCount",b.retryCount.toString()),x.set("RetryScheduled",h?"true":"false")))}Hxl(b){this.YSh(b)}YSh(b,h=!1){const n=b.data.mf===ua.a.Vfa,x=qa.a.aF();x&&(x.set("StatusCode",b.data.mf.toString()),h&&x.set("RecentLinks","true"),n||this.FMe(b.data,x));h?this.WL.TMa("MruActor.GetMruForRecentLinksFromServerFailureCallback",
b.data,"Failure"):this.WL.TMa("MruActor.GetMruFromServerFailureCallback",b.data,"Failure");this.Bbe(2);this.B1h(this.L8a,b,Object(v.a)(this,this.Ixl,"getMruFromServerRetryTask"),x);ta.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",b.data.mf),n,!1,Object.assign(new ab.a,{extendedProperties:x}));this.P4e(this.qia);u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.mMa&&Mg.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),h?this.Iid=null:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",
!1)))}Fxl(b){this.YSh(b,!0)}Bbe(b,h=null,n=null,x=null,E=!1){if(3!==this.qia.state||3===b)this.qia.TPg=h,this.qia.UPg=n,this.qia.nLj=x,this.qia.state=b,this.qia.Zre=E,this.qia.M1g=this.WL.lw()}$xi(b,h){w.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:b,["ResultState"]:this.qia.state});h&&3===this.qia.state&&this.qBh(h,this.qia);return this.qia}ish(b,h,n=!1){this.Bbe(1);let x;const E={};x=n?String.format(this.WL.nNa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",
this.vQj,"OfficeSuite",this.Lvf,"ClassicMru"):String.format(this.WL.nNa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.GKh(),this.Lvf);this.qQj.value||(x+="&entity=docs");u.AFrameworkApplication.sessionStartInfoSettings&&(E["X-Office-AudienceGroup"]=Object(ja.a)(String,u.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");n&&(E["X-Office-Application"]="147");this.B4g?E["X-FileId"]=u.AFrameworkApplication.um:x+=String.format("&{0}",u.AFrameworkApplication.um);
this.WL.HRc.Lj(x,1,null,E,!0,5,b,h,null)}get WL(){return this.uxa.value}get Lvf(){return this.eKj.value}static get instance(){return Zf._instance||(Zf._instance=Zf.lr())}static lr(){return new Zf(new se.a(()=>qd.instance),new se.a(()=>vj.a.lg(u.AFrameworkApplication.lcid).name),new se.a(()=>u.AFrameworkApplication.ua.Sb.zA),u.AFrameworkApplication.K.$("MruWriteFileIdInHeader"),()=>u.AFrameworkApplication.ua.Sb.pda,()=>u.AFrameworkApplication.ut,new se.a(()=>u.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled")))}}
Zf._instance=null;Object(r.a)(Zf,"MruActor",bi,[]);class bl{constructor(){this.xwc=this.KVg=this.W=null;this.qh=!1}get name(){return"Common.App.NewAndOpen.Core"}zc(b){this.W=b;b.register(556,"Common.INewAndOpenCommonHelpers").singleInstance().Xd(()=>qd.instance);b.register(562,"Common.IEventEmitter<Common.IGetMoreInfoResult>").singleInstance().Xd(()=>tl.instance);b.register(562,"Common.IEventEmitter<Common.IMruResult>").singleInstance().Xd(()=>Zf.instance)}init(){u.AFrameworkApplication.K.yq(()=>
{this.YYa()})}YYa(){this.W.resolve("Common.INewAndOpenCommonHelpers");this.W.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.W.resolve("Common.IEventEmitter<Common.IMruResult>");var b=!1;qd.instance.din();u.AFrameworkApplication.zCa&&(b=!0);u.AFrameworkApplication.zOf&&(Zf.instance.WBm(),u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&Zf.instance.UBm(),0<u.AFrameworkApplication.Qqi&&this.G6g(),this.VOn(),b=!0);u.AFrameworkApplication.S2a&&
b&&tl.instance.TBm();u.AFrameworkApplication.aio&&(b=Zf.instance,b.Lln(),b.gCm(),Ye.a.instance.$b(this.bio))}VOn(){Ek.instance.qMe(Object(v.a)(Zf.instance,Zf.instance.VBm,"makeGetMruRequestActivityTrigger"));u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&Ek.instance.qMe(Object(v.a)(Zf.instance,Zf.instance.Ini,"makeGetMruForRecentLinksRequestActivityTrigger"));Ek.instance.qMe(Object(v.a)(this,this.G6g,"addGetMruFromServerTask"));Ek.instance.d2j(Object(v.a)(this,
this.RQk,"deleteGetMruFromServerTask"))}RQk(){Ye.a.instance.ef(this.Rqi)}G6g(){Ye.a.instance.$b(this.Rqi)}get Rqi(){return this.KVg||(this.KVg=new We.a(5,2,u.AFrameworkApplication.Qqi,Object(v.a)(Zf.instance,Zf.instance.Jxl,"getMruFromServerTask"),109))}get bio(){return this.xwc||(this.xwc=new We.a(2,2,6E4*u.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(v.a)(Zf.instance,Zf.instance.hCm,"makeUpdateMruTask"),197))}dispose(){this.qh||
(this.qh=!0,this.xwc&&(Ye.a.instance.ef(this.xwc),this.xwc=null))}}Object(r.a)(bl,"CorePackageManager",null,[1,2,10]);var gn=d(1509),Vl=d(107);class Zg{static B_k(b){return Zg.ngh("New",b)}static C_k(b){return Zg.ngh("Open",b)}static Tfh(b,h){return Zg.sVa("LoadingMenuSection",Zg.utm,b,Zg.fzc("lblLoading",h))}static gzc(b,h,n=null,x=null){return Zg.sVa("MessageMenuSection",Zg.Oqi,h,Zg.fzc("lblMessage",b,n,x))}static Lkk(b){return Zg.Tfh(b,CommonUIStrings.l_VoicedLoadingText)}static Mkk(b,h){return Zg.gzc(CommonUIStrings.l_NewCreationLocationMessage,
b.labelText,h.Aaa,h.O2a)}static Kkk(b,h){return Zg.gzc(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,h.O2a,"\n\n"),b.labelText)}static Xfh(b){return Zg.gzc(CommonUIStrings.l_NewGenericErrorMessage,b.labelText)}static Ikk(b,h,n){return Zg.sVa("menuNewBlank",Zg.sVl,n?b.labelText:null,Zg.czc(b.Z2h,b.$2h,b.a3h,null,b.PYa,b.NKc,h,"blank"))}static Olk(){return Zg.fzc("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static lgh(){return Zg.fzc("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static Plk(b,
h){return Zg.sVa("menuNewTemplates",b,null,h)}static Gkk(b,h){return Zg.sVa("menuNewMoreTemplates",Zg.fIh,null,Zg.czc("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,b,h))}static gjk(b,h,n){let x="";n&&h&&(x=Zg.sVa("BrowseMoreMenuSection",Zg.fIh,null,Zg.czc("btnBrowseMore",h,h,null,null,null,b||"1959943459",n)));return x}static fzc(b,h,n=null,x=null){let E=x;h&&0<h.length&&(E=Zg.Mri.P0a(h).trimEnd(),E=0<=E.indexOf("{0}")?String.format(E,
x):String.format("{0} {1}",E,x));n=n&&x?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',B.a.If(n),B.a.If(x),B.a.If(E)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',B.a.If(b||""),Zg.Mri.P0a(B.a.If(h||"")),n)}static czc(b,h,n,x,E,S,ma,Fa){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',
B.a.If(b||""),B.a.If(h||""),B.a.If(n||""),x||"32by32",B.a.If(E||""),B.a.If(S||""),ma,B.a.If(Fa||""))}static ngh(b,h){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',b,h)}static sVa(b,h,n,x){n=n?String.format('Title="{0}"',B.a.If(n)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
B.a.If(b||""),B.a.If(h||""),n,x)}}Zg.Oqi="MenuMru";Zg.utm="MenuLoading";Zg.sVl="MenuHeader";Zg.fIh="MenuFooter";Zg.Mri=Vl.a.mB("\n","&#10;");Object(r.a)(Zg,"NewAndOpenXmlUtilities",null,[]);class ni{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(r.a)(ni,"HostInformation",null,[]);class pk{constructor(b,h,n,x,E,S){this.mIe=this.Tv=this.F6c=null;this.gld=this.fGe=!1;this.ePg=0;this.LFe=this.Ste=!1;this.uxa=b;this.Omc=h;this.URa=new se.a(()=>new gn.a(n.value,Object(v.a)(this,
this.bAb,"getMoreInfoEventReceived")));this.lLj=x;this.W7a=E;this.FTj=S;this.Yuc=this.T6d;2===this.L6.oNa&&(this.LFe=!0)}get bda(){switch(this.L6.oNa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}Vb(){const b=this.L6.p9b;b.pa(Ra.a.newDocument,Ld.a.frame,Object(v.a)(this,this.newDocument,"newDocument"));b.gb(Ra.a.LZd,Ld.a.frame,Object(v.a)(this,this.LZd,"populateNewMenu"),96)}newDocument(b,h,n,x,E){return 1===n?32:2===n&&E&&E.MenuItemId&&
E.SourceControlId?this.fCc(E.MenuItemId,E.SourceControlId):8}fCc(b,h){var n=this.AUd.Nsh;if(null===n)return 8;var x=u.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(u.AFrameworkApplication.tDb&&x){w.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const E={};E[G.a.template]=b;E[G.a.bda]=this.bda;E[G.a.lcid]=u.AFrameworkApplication.lcid.toString();E[G.a.reason]=pf.a.XZe;u.AFrameworkApplication.WP().execute(S=>
{S.sendMessage(F.a.fCc,E)})}else x=(new Date).getTime(),h=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",n,B.a.Ij(this.zCa),B.a.Ij(b),B.a.Ij(this.bda),B.a.Ij(u.AFrameworkApplication.lcid.toString()),B.a.Ij(x.toString()),B.a.Ij(h),B.a.Ij(u.AFrameworkApplication.canary),u.AFrameworkApplication.um),(n=u.AFrameworkApplication.K.lb("ScenarioId"))&&""!==n&&(h+="&wdscenarioid="+B.a.Ij(n)),h+="&"+u.AFrameworkApplication.$Gd(),u.AFrameworkApplication.SZa&&
(h+="&"+u.AFrameworkApplication.HFd()),(n=this.Tv?this.Tv.Aaa:null)&&(h+="&DestinationUrl="+B.a.Ij(n)),rd.a.ym(h,"_blank",void 0,"CreateNewDocument");2===this.L6.oNa&&w.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:$l.a[this.L6.oNa],["Template"]:b});return 32}Gzm(b){let h=Number.MAX_VALUE,n=Number.MIN_VALUE;const x=window.performance;if(x&&"undefined"!==typeof x.getEntriesByName){for(let S=0;S<b.length;S++){var E=x.getEntriesByName(b[S]);E&&0<E.length&&(E=E[0],
h=Math.min(parseInt(String(E.fetchStart)),h),n=Math.max(parseInt(String(E.responseEnd)),n))}n>h&&w.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:n-h,["MinFetchStart"]:h,["MaxResponseEnd"]:n})}}LZd(b,h,n,x,E){if(1===n)return this.LFe&&(u.AFrameworkApplication.eaa("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.LFe=!1),32;2!==n||this.Ste||(this.ePg=(new Date).getTime(),w.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",
{["ShouldShowTemplates"]:this.T6d,["CachedNewMenuXmlExists"]:!!this.F6c,["ShouldCallGetMoreInfo"]:this.L6.S2a}));return this.a4m(E)}a4m(b){b&&(this.F6c?b.PopulationXML=this.F6c:(this.L6.S2a&&!this.Tv&&this.pJm.fk("Opened New menu",!0),b.PopulationXML=this.Ydl(this.getTemplateListJson())));return 32}Iei(){return!this.L6.S2a||!!this.Tv&&3===this.Tv.state&&!!this.Tv.O2a&&!!this.Tv.Aaa}$gm(){return u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.mMa?!0:this.Iei()}getTemplateListJson(){if(!this.T6d||
!this.$gm())return null;if(this.Yuc&&!this.gld){var b="9";const h=u.AFrameworkApplication.K.appSettings;"NumberOfTemplatesInBackstage"in h&&(b=h.NumberOfTemplatesInBackstage);let n=this.bda;"TemplateCollectionId"in h&&(n=h.TemplateCollectionId);b=String.format(this.L6.nNa+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",B.a.Ij(u.AFrameworkApplication.lcid.toString()),B.a.Ij(n),b);Boolean.parse(h.AppendOriginQueryParam||"false")&&(b+="&org=backstage");b+="&"+u.AFrameworkApplication.$Gd();u.AFrameworkApplication.SZa&&
(b+="&"+u.AFrameworkApplication.HFd());this.L6.HRc.Lj(b,1,null,null,!1,2,x=>{this.L6.TMa("CreateNewActor.GetTemplateListJson",x.data);this.b5n(x.data.Ee)},x=>{this.L6.TMa("CreateNewActor.GetTemplateListJson",x.data);this.a5n()},null,void 0,void 0,void 0,void 0,"5");this.Yuc=!1}return this.mIe}b5n(b){this.mIe=b;this.Yuc=!1;this.uWc();if(u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.mMa&&Mg.c()){b=u.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const h=
u.AFrameworkApplication.tDb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.mIe,!0,b&&h))}}a5n(){this.gld=this.Yuc=!0;this.uWc();u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.mMa&&Mg.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));ta.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}ihf(b){var h=0;for(var n=0;n<b.length;n++)if("ST"===b[n].ImageType){h=n;break}const x=b.length?
b[h]:null;b=x?x.Url||"":"";var E;let S=n=h=!1;if(x&&(E=x.AspectRatio))E=parseFloat(E),1>E?h=!0:1.5<E?n=!0:1===E&&(S=!0);else switch(w.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:b}),this.L6.oNa){case 3:h=!0;break;case 2:n=!0;break;case 5:S=!0}return{returnValue:b,bZl:h?"95by123":n?"123by69":S?"100by100":"123by95"}}Ydl(b){b=({F6d:h}=this.Jkk(b,this.AUd,this.AUd.jzc||"1056925771")).returnValue;if(h){this.F6c=b;var h=(new Date).getTime()-this.ePg;w.ULS.sendTraceTag(5849604,
202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:h})}return b}bAb(b,h){w.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Tv||3!==b.state?2===b.state&&(w.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.fGe=!0,this.uWc()):(this.Tv=b,h||this.uWc(),u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.mMa&&Mg.c()&&Mg.d("setFileMenuHostInformation")&&(b=Object.assign(new ni,{hostUrl:this.Tv.Aaa,hostName:this.Tv.O2a,
folderUrl:u.AFrameworkApplication.breadcrumbFolderUrl,folderName:u.AFrameworkApplication.breadcrumbFolderName}),w.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(b))))}Jkk(b,h,n){let x;x=!1;const E=this.Iei();let S="";this.L6.S2a&&(this.fGe?(S=Zg.Xfh(h),this.fGe=!1,w.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Tv?E?S=Zg.Mkk(h,this.Tv):this.Tv.h5l?
(x=!0,this.Yuc=!1,S=Zg.Kkk(h,this.Tv),w.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(x=!0,S=Zg.Xfh(h),w.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.Tv.Aaa,["StorageServiceDisplayNameIsSet"]:!!this.Tv.O2a})):(S=Zg.Lkk(h.labelText),w.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));E&&(S+=Zg.Ikk(h,n,!S)+({F6d:x}=
this.Nlk(b,n)).returnValue);return{returnValue:Zg.B_k(S),F6d:x}}Nlk(b,h){let n;n=!1;if(!this.T6d)return n=!0,w.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",F6d:n};let x="",E="",S="MenuTemplate";if(this.gld)x=Zg.lgh(),this.gld=!1,w.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(b){try{const ma=Sys.Serialization.JavaScriptSerializer.deserialize(b,!0);x=this.Mlk(ma,h);w.ULS.sendTraceTag(5849612,202,
50,"Rendering File>New with template buttons");u.AFrameworkApplication.Nri&&"OneDrive"===this.zCa&&(E=Zg.Gkk(this.qJm,u.AFrameworkApplication.Nri))}catch(ma){w.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:b}),x=Zg.lgh()}n=!0}else S="MenuLoading",x=Zg.Olk(),w.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:Zg.Plk(S,x)+E,F6d:n}}Mlk(b,h){let n="";const x=[];for(let S=0;S<b.length;S++){var E=
b[S];let ma="";if(E){const Fa=E.Title,$a=E.AssetId;E=E.Thumbnails;$a&&Fa&&E&&({bZl:E,returnValue:ma}=this.ihf(E),n+=Zg.czc("jbtnNewTemplate"+S,Fa,null,E,null,ma,h,$a))}x[S]=ma}b=new We.a(4,1,5E3,()=>{this.Gzm(x)},106);this.L6.vUd.$b(b);return n}uWc(){this.Ste=!0;this.L6.Bri.SEa(this.AUd.QFc);this.Ste=!1}get L6(){return this.uxa.value}get AUd(){return this.Omc.value}get pJm(){return this.URa.value}get qJm(){return this.lLj.value}get zCa(){return this.W7a.value}get T6d(){return this.FTj.value}}Object(r.a)(pk,
"CreateNewActor",null,[]);class Nj{constructor(){this._initialized=!1;this.pHe={}}getString(b){this.WCh();return this.get(b)}contains(b){this.WCh();return b.toString()in this.pHe}WCh(){this._initialized||(this.N3j(),this._initialized=!0)}h$a(b,h){this.pHe[b.toString()]=h}get(b){return this.pHe[b.toString()]}}Object(r.a)(Nj,"AIntlHelper",null,[]);class Uk extends Nj{constructor(){super()}N3j(){this.h$a(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.h$a(1,CommonUIStrings.l_OpenMenuServerErrorMessage);
this.h$a(2,CommonUIStrings.l_Open);this.h$a(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.h$a(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.h$a(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return Uk._instance||(Uk._instance=new Uk)}static dYm(b){return Uk.instance.getString(b)}}Uk._instance=null;Object(r.a)(Uk,"MruActorIntlHelper",Nj,[]);var gg;(function(b){b[b.success=0]="success";b[b.failure=1]="failure";b[b.spinner=2]="spinner";b[b.none=3]="none"})(gg||(gg={}));Object(r.b)("DisplayState",
gg);class le{constructor(b,h,n,x,E,S,ma,Fa){this.Rhe=null;this.aLe=!0;this.E6c="";this.zWj=0;this.BRb=null;this.Dve=3;this.Ma=Fa;this.uxa=b;this.rqa=h;this.ABj=n;this.Qvj=x;this.Pvj=E;this.URa=new se.a(()=>new gn.a(S.value,null));this.yDj=new se.a(()=>new gn.a(ma.value,Object(v.a)(this,this.mIm,"mruEventResultReceived")));this.Ma.$("WacInTabOpenMRUIsEnabledForUiHost");this.Ma.$("UiHostSupportsDocRebootFeatures")}mIm(b,h){this.BRb=b;h||this.UJi()}Qkn(){this.WL.p9b.gb(Ra.a.EKf,Ld.a.frame,Object(v.a)(this,
this.EKf,"populateMruMenu"),96)}EKf(b,h,n,x,E){return 1!==n&&E?this.$3m(E):32}$3m(b){this.i0k();this.h0k();b.PopulationXML=Zg.C_k(this.E6c+this.Rhe);return 32}i0k(){var b=3;let h=!1;if(this.E6c&&this.zWj===this.BRb.E6n)w.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),b=this.Dve;else{w.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var n=this.WL.lw();this.BRb=
this.lIm.fk("File Open opened",!0);this.E6c&&2!==this.Dve&&3!==this.BRb.state?h=!0:(b=this.MGl(this.BRb),u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.mMa&&Mg.c()&&b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,!0)),this.E6c=({hJm:b}=this.Zdl(this.BRb)).returnValue);n=this.WL.lw()-n;w.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:n})}2!==b&&(n={["DisplayState"]:gg[b]},1!==b&&(n.IsStale=h),
w.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",n));this.Dve=b}MGl(b){let h;try{h=z.c(b.wzf)}catch(n){h=null,w.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",n)}return h}h0k(){this.aLe?(w.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.Rhe=({Joo:this.aLe}=this.PBm()).returnValue):w.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");w.ULS.sendTraceTag(5849633,
202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.aLe,["NotDisplayingLink"]:!this.Rhe})}Zdl(b){let h;1===b.state||0===b.state?(w.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),b=2,h=Zg.Tfh(this.nYa(2),this.nYa(5))):3===b.state&&b.wzf?(h=this.Hkk(b.wzf),b=0):(w.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),h=Zg.gzc(this.nYa(1),this.nYa(2)),b=1);return{returnValue:h,hJm:b}}Hkk(b){let h;const n=this.hRc.jzc||
"2155708348";if(b.length){h=Zg.fzc("lblRecentDocuments",this.nYa(3));let x=0;for(let E=0;E<b.length;E++){const S=b[E];"FileName"in S&&"DocumentUrl"in S&&"Path"in S&&(h+=Zg.czc("MruButton"+E,S.FileName.toString(),S.Path.toString(),null,this.hRc.PYa,this.hRc.NKc,n,S.DocumentUrl.toString()),S.IsPinned&&x++)}h=Zg.sVa("RecentDocumentsMenuSection",Zg.Oqi,this.nYa(2),h);w.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:b.length,["NumPinnedDocuments"]:x})}else h=
Zg.gzc(this.nYa(0),this.nYa(2)),w.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return h}PBm(){let b;b=!0;let h=this.wik;var n=this.vik;if(h&&n||!this.WL.S2a)b=!1;else{const x=this.MFd.fk("File Open",!1);3===x.state&&(h=x.Aaa,n=x.O2a,b=!1)}n=n?String.format(this.nYa(4),n):null;return{returnValue:Zg.gjk(this.hRc.jzc,n,h),Joo:b}}UJi(){this.WL.Bri.SEa(this.hRc.QFc)}get WL(){return this.uxa.value}get nYa(){return this.rqa.value}get hRc(){return this.ABj.value}get wik(){return this.Qvj.value}get vik(){return this.Pvj.value}get MFd(){return this.URa.value}get lIm(){return this.yDj.value}}
Object(r.a)(le,"MruRenderer",null,[]);var Od=d(1513);class pg{constructor(b,h,n,x,E,S,ma){this.Tv=null;this.jYg=!1;this.hpa=this.d0=0;this.ALj=b;this.bSb=h;this.yfd=n;this.Omc=x;this.W7a=E;this.uxa=S;this.URa=new se.a(()=>new gn.a(ma.value,Object(v.a)(this,this.bAb,"getMoreInfoEventReceived")))}fCc(){!this.Tv&&this.$Bf.S2a?this.MFd.fk("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}bAb(b){if(!this.Tv&&3===b.state)this.Tv=b;else if(2===b.state){this.jYg?w.ULS.sendTraceTag(24904471,202,
10,"After second try GetMoreResult still fail."):(this.MFd.fk("NewDocumentFromStream",!0),this.jYg=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.d0=(new Date).getTime();var b=this.S5k.Nsh;if(null===b)this.bSb(null);else{var h=this.yfd.menuItemId,n=this.yfd.cEa,x=this.yfd.c1n,E=this.yfd.$5k;this.hpa="streamBase64"===x?E.length/1024:0;w.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.bda,this.hpa);var S=(new Date).getTime();b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
b,B.a.Ij(this.zCa),B.a.Ij(h),B.a.Ij(this.bda),B.a.Ij(u.AFrameworkApplication.lcid.toString()),B.a.Ij(S.toString()),B.a.Ij(n),B.a.Ij(u.AFrameworkApplication.canary),u.AFrameworkApplication.um,B.a.Ij(x));b+="&"+u.AFrameworkApplication.$Gd();u.AFrameworkApplication.SZa&&(b+="&"+u.AFrameworkApplication.HFd());(h=this.Tv?this.Tv.Aaa:null)&&(b+="&DestinationUrl="+B.a.Ij(h));this.$Bf.HRc.Lj(b,2,E,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(v.a)(this,this.kJm,"newDocumentFromStreamSuccessHandler"),
Object(v.a)(this,this.jJm,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}kJm(b){if(b&&b.data&&b.data.Ee)if(({Dv:h}=z.d(b.data.Ee)).returnValue)if(b=h,b.StatusCode!==ua.a.qD&&b.StatusCode!==ua.a.rCc)w.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.bda,this.hpa,b.StatusCode),this.bSb(null);else if(b.NewDocumentUrl&&""!==b.NewDocumentUrl){var h=(new Date).getTime()-this.d0;w.ULS.sendTraceTag(35156359,
202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.bda,this.hpa,h);this.ALj(b.NewDocumentUrl)}else w.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.bda,this.hpa),this.bSb(null);else w.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.bda,this.hpa,{["ResponseData"]:Od.a.b2c(b.data.Ee)}),this.bSb(null);else w.ULS.sendTraceTag(24904473,
202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.bda,this.hpa),this.bSb(null)}jJm(b){b&&b.data&&w.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.bda,this.hpa,b.data.status);this.bSb(null)}get bda(){switch(this.$Bf.oNa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get S5k(){return this.Omc.value}get zCa(){return this.W7a.value}get $Bf(){return this.uxa.value}get MFd(){return this.URa.value}}
Object(r.a)(pg,"NewDocumentFromStreamOperation",null,[]);class Oi{constructor(b,h,n,x){this.Omc=b;this.W7a=h;this.uxa=n;this.xDj=x}create(b,h,n){return new pg(b,h,n,this.Omc,this.W7a,this.uxa,this.xDj)}}Object(r.a)(Oi,"NewDocumentFromStreamOperationFactory",null,[722]);var aj=d(122);class Lj{get name(){return"Common.App.NewAndOpen.UX"}zc(b){b.register(Oi,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").singleInstance().Xd(()=>
new Oi(new se.a(()=>u.AFrameworkApplication.ua.Sb.vcf()),new se.a(()=>u.AFrameworkApplication.zCa),new se.a(()=>b.Pa("Common.INewAndOpenCommonHelpers")),new se.a(()=>b.Pa("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){u.AFrameworkApplication.K.yq(()=>{this.YYa()})}YYa(){const b=Bh.a.Iq(Oa.a.instance.Za("Common.INewAndOpenCommonHelpers")),h=Bh.a.Iq(Oa.a.instance.Za("Common.IEventEmitter<Common.IGetMoreInfoResult>"));u.AFrameworkApplication.zCa&&aj.Task.WAA.call(null,b,h).continueWith(()=>
{const n=new pk(new se.a(()=>b.result),new se.a(()=>u.AFrameworkApplication.ua.Sb.vcf()),new se.a(()=>h.result),new se.a(()=>u.AFrameworkApplication.ua.Sb.wcf().jzc||"1959943459"),new se.a(()=>u.AFrameworkApplication.zCa),new se.a(()=>u.AFrameworkApplication.Fem));n.Vb();n.uWc()});if(u.AFrameworkApplication.zOf){const n=Bh.a.Iq(Oa.a.instance.Za("Common.IEventEmitter<Common.IMruResult>"));aj.Task.WAA.call(null,b,h,n).continueWith(()=>{const x=new le(new se.a(()=>b.result),new se.a(()=>Uk.dYm),new se.a(()=>
u.AFrameworkApplication.ua.Sb.wcf()),new se.a(()=>u.AFrameworkApplication.cYm),new se.a(()=>u.AFrameworkApplication.bYm),new se.a(()=>h.result),new se.a(()=>n.result),u.AFrameworkApplication.K);x.Qkn();x.UJi()})}}dispose(){}}Object(r.a)(Lj,"UXPackageManager",null,[1,2,10]);var yd=d(141);class dg extends yd.StandardDialog{constructor(){super();this.Ed=0;this.We(1,CommonUIStrings.l_DialogClose)}FS(b){this.fy(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}p3e(b){this.fy(b,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(r.a)(dg,"ErrorDialog",yd.StandardDialog,[732]);var Nb=d(430);class Ii{BKh(){w.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const b=new Nb.a;b.Gg("api.onedrive.com");return b.task}}Object(r.a)(Ii,"OneDriveConsumerEndpointHelper",null,[657]);var Ie=d(40);class $g{constructor(b,h,n,x){this.rrb=this.CCa=null;this.xFe=this.zFe=!1;this.pSb=null;this.Ma=b;this.W5c=h;this.Bqb=n;this.fG=x}get U$g(){return this.W5c}get K(){return this.Ma}B2b(){this.pSb||
(this.pSb=this.z$b?bc.a.create(this.z$b,null,null,null,!1):null);return this.pSb}setup(b){this.rrb=b;this.zFe||this.xFe?this.zFe&&this.rrb&&this.rrb(!0):(b=this.B2b())?(this.xFe=!0,b.A_a.continueWith(h=>{this.QSm(h)}),Eb.a.KS(b)):(w.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.rrb(!1))}IFf(b){w.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.")}QSm(b){this.xFe=
!1;if(b.Ii)this.IFf(b),this.rrb(!1);else try{this.zFe=!0,w.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Qlf(),w.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.rrb(!0)}catch(h){w.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",h.toString()),this.rrb(!1)}}q0c(b){this.CCa=b;this.Bqb?w.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(w.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(v.a)(this,this.ODf,"onApiReady")))}ODf(b){b?this.rQd():this.qp()}qp(){this.fG().FS(Ie.a.qXm)}onSuccess(b){w.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.CCa&&this.CCa(!0,b)}dispose(){this.pSb&&this.pSb.dispose()}}Object(r.a)($g,"AOneDriveFilePickerApiManager",null,[743,10]);class fh extends $g{constructor(b,h,n,x,E,S){super(h,n,x,S);this.Fm=null;this.nqa=b;this.NTj=E}get z$b(){return this.K.lb("OneDriveApiUrl")}start(b,h){this.Fm=b;
this.q0c(h)}Qlf(){WL.init(1===this.U$g||2===this.U$g?{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}q0c(b){this.CCa=b;!this.Bqb&&this.nqa.lMc?(w.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(v.a)(this,this.ODf,"onApiReady"))):(w.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.NTj())}rQd(){try{w.ULS.sendTraceTag(17909027,
352,50,"Launching file dialogue"),WL.fileDialog(this.Fm).then(Object(v.a)(this,this.onSuccess,"onSuccess"),Object(v.a)(this,this.onFailure,"onFailure"))}catch(b){w.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",b,b.stack),this.qp()}}onFailure(b){if(b&&b.error){if("user_canceled"===b.error.code){w.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}w.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",b.error.code,
b.error.message)}else w.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.CCa&&this.CCa(!1,b);this.qp()}}Object(r.a)(fh,"OneDriveFilePickerApiManagerV5",$g,[]);class Pi extends $g{constructor(b,h,n,x,E){super(b,h,n,x);this.Rad=this.rSg=null;this.LAj=E;this.options={};this.options.clientId=this.K.lb("OneDriveApiV7ClientId");this.options.cancel=Object(v.a)(this,this.H$d,"toggleHostDivVisibility")}get z$b(){return this.K.lb("OneDriveApiV72Url")}start(b,h){this.Rad=h;const n=
this.LAj.BKh();n.continueWith(()=>{w.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.rSg=n.result;this.q0c((x,E)=>{this.H$d();b(x,E)})},3);n.continueWith(()=>{w.ULS.sendTraceTag(24134242,352,15,n.exception.message);this.H$d()},5)}Qlf(){this.options.success=b=>{const h={};h.data=b;this.onSuccess(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=
this.rSg;this.options.advanced.iframeParentDiv=this.Rad}rQd(){try{w.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.H$d(),OneDrive.open(this.options)}catch(b){w.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",b.message),this.qp()}}onFailure(b){this.CCa&&this.CCa(!1,b);this.qp()}H$d(){this.Rad.style.visibility="hidden"===this.Rad.style.visibility?"":"hidden"}}Object(r.a)(Pi,"OneDriveFilePickerApiManagerV7",$g,[]);class jk extends $g{constructor(b,
h,n,x){super(b,h,n,x);this.guj=b;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.K.lb("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get z$b(){return this.K.lb("OneDriveApiV72Url")}start(b,h,n,x){this.options.advanced.iframeParentDiv=n;this.options.advanced.endpointHint=x;this.options.cancel=h;this.guj.$("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive=
{},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.q0c(b)}q0c(b){this.CCa=b;this.Bqb?w.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(w.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(v.a)(this,this.ODf,"onApiReady")))}Qlf(){this.options.success=b=>{const h={};h.data=b;this.onSuccess(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)}}rQd(){try{w.ULS.sendTraceTag(23881879,
216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(b){w.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.qp()}}IFf(b){w.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.");Eb.a.won(this.z$b);this.pSb=null}qp(){this.fG().p3e(Ie.a.ozn)}onFailure(b){this.CCa&&this.CCa(!1,b)}}Object(r.a)(jk,"OneDriveFilePickerApiManagerV72",
$g,[]);class Cf{constructor(b){this.olsSessionId=this.value=this.key=null;this.olsSessionId=b}}Object(r.a)(Cf,"IExtraData",null,[]);class im extends jk{constructor(b,h,n,x){super(b,h,n,x);this.options.advanced.filter=b.lb("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=u.AFrameworkApplication.fah;b.$("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=b.lb("OneDriveApiV72CommandMode")||"none");b.$("OneDriveApiV72QosExtraDataEnabled")&&
(this.options.qosExtradata=new Cf(u.AFrameworkApplication.userSessionId))}get z$b(){return this.K.lb("OneDriveApiV72Url")}rQd(){try{w.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",u.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(b){w.ULS.sendTraceTag(26071183,
352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.qp()}}}Object(r.a)(im,"OneDriveFilePickerApiOpenManagerV72",jk,[]);class ch{constructor(b){this.er=null;this.hg=b;this.MDe=3}BKh(){this.er=new Nb.a;w.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.kVf();return this.er.task}kVf(b=null){const h=String.format("GetMoreInfoHandler.ashx?{0}",u.AFrameworkApplication.jxb);this.hg.oWb(h,1,null,b,["PersonalFileStorageUrl",
"X-NewKey"],2,Object(v.a)(this,this.Cxl,"getMoreInfoSucceeded"),Object(v.a)(this,this.Axl,"getMoreInfoFailed"),void 0,void 0,void 0,void 0,"21")}Axl(b){if(b.data.mf===ua.a.Vfa&&"X-NewKey"in b.data.qj){w.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const h={};h["X-Key"]=b.data.qj["X-NewKey"];this.kVf(h)}else 0<this.MDe?(w.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",
this.MDe),this.MDe--,this.kVf()):(w.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.er.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}Cxl(b){"PersonalFileStorageUrl"in b.data.qj&&""!==b.data.qj.PersonalFileStorageUrl?(w.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.er.Gg(b.data.qj.PersonalFileStorageUrl)):(w.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),
this.er.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(r.a)(ch,"OneDriveForBusinessEndpointHelper",null,[657]);var Oj=d(733);class Kg{constructor(){this.W=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}zc(b){this.W=b;this.W.register(fh,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").singleInstance().Xd(()=>new fh(Oj.a.instance,u.AFrameworkApplication.K,
u.AFrameworkApplication.uka,u.AFrameworkApplication.Kta,u.AFrameworkApplication.u_f,()=>new dg));u.AFrameworkApplication.Y6b?this.W.register(657,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").singleInstance().Xd(()=>new Ii):this.W.register(657,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").singleInstance().Xd(()=>new ch(u.AFrameworkApplication.Ze));this.W.register(Pi,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").singleInstance().Xd(()=>new Pi(u.AFrameworkApplication.K,
u.AFrameworkApplication.uka,u.AFrameworkApplication.Kta,()=>new dg,this.W.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.W.register(jk,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").singleInstance().Xd(()=>new jk(u.AFrameworkApplication.K,u.AFrameworkApplication.uka,u.AFrameworkApplication.Kta,()=>new dg));this.W.register(im,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").singleInstance().Xd(()=>new im(u.AFrameworkApplication.K,
u.AFrameworkApplication.uka,u.AFrameworkApplication.Kta,()=>new dg))}static main(){N.a.instance.Pc(new Kg)}}Object(r.a)(Kg,"PackageManager",null,[1,2]);class ul{constructor(b,h,n,x,E,S){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=b;this.WebAffinitizedUrl=h;this.PolicyCookie=n;this.PolicyCookieTTL=x;this.WasServiceDown=E;this.AffinitizedUrl=S}}Object(r.a)(ul,"SafeLinksData",null,
[]);class vl{constructor(b,h){this.X9d=b;this.$w=h}}Object(r.a)(vl,"SafeLinksGetUrlReputationRequestData",null,[]);class am{constructor(b,h,n,x){this.Ma=b;this.hg=h;this.WDj=n;am.le=x}tgc(b,h,n){try{var x=null;am.le&&(x=am.le.fg("WebServiceCall","SafeLinksGetUrlReputation"));const E=new vl(h,x);x={};x.AffinitizedUrl=b;x.TargetUrl=h;x.PolicyCookie=n;const S=z.c(x);this.hg.Lj(this.WDj,2,S,null,!1,2,Object(v.a)(this,this.PQm,"onGetUrlReputationSuccessCallback"),Object(v.a)(this,this.OQm,"onGetUrlReputationFailureCallback"),
E,void 0,void 0,3E3,3E3,"36");return!0}catch(E){w.ULS.sendTraceTag(588788033,378,10,E.message)}return!1}PQm(b){let h="OnGetUrlReputationSuccessCallback: ",n=10;const x=b.data.state;try{const E=z.b(b.data.Ee).reputationResults[0],S=E.navigateUrl.length,ma=x.X9d.length,Fa=E.navigateUrl===x.X9d;E.navigateUrl&&0<E.navigateUrl.length&&(x.X9d=E.navigateUrl);h+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",b.data.mf,E.verdict,ma.toString(),
S.toString(),Fa.toString());n=50}catch(E){h+=String.format("Exception {0}",E.message)}this.m1h(x,h,n)}OQm(b){let h="OnGetUrlReputationFailureCallback: ";const n=b.data.state;try{h+=String.format("HttpStatus {0}",b.data.mf)}catch(x){h+=String.format("Exception {0}",x.message)}this.m1h(n,h,10)}m1h(b,h,n){b.$w&&(b.$w.stop(),b.$w=null);w.ULS.sendTraceTag(588788034,378,n,h);rd.a.ym(b.X9d,void 0,"noopener,noreferrer","SafeLinksNav")}}am.le=null;Object(r.a)(am,"SafeLinksNavigationHelper",null,[]);var Ug;
(function(b){b[b.enabledByPolicy=0]="enabledByPolicy";b[b.disabledByPolicy=1]="disabledByPolicy";b[b.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";b[b.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(Ug||(Ug={}));Object(r.b)("SafeLinksNavigationState",Ug);class xh{constructor(b,h,n,x=!1,E=null,S=null){this.kpb=this.jpb=0;this.bNc=this.lad=!1;this.r8a=null;this.iRb=!0;this.zkd=null;w.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");this.Ma=b;this.hg=
h;this.$mb=n;xh.le=S;this.CYj=x?this.Ma.lb("SafeLinksHandlerWebServiceBase"):this.Ma.lb("WebServiceBase");this.TXj=this.Ma.lb("SafeLinksHashedUserId");this.Gso=this.Ma.lb("SafeLinksWorkloadIdHeaderValue");this.Ped=this.Ma.rc("SafeLinksMaxGetPolicyBootRetries",2);this.Qed=this.Ma.rc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.Ccd=this.Nhm();this.Bcd=this.Mhm();w.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.Ccd,this.Bcd);if(this.Ccd&&
this.Bcd){h=(b=this.C1b())?b.IsSafeLinksEnabled.toLowerCase():"";n=this.lrf();w.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",h,n);var ma=!b||"unknown"===h||b.WasServiceDown||n,Fa=qa.a.aF();Fa&&(Fa.set("shouldGetSafeLinksDataFromServer",ma.toString()),Fa.set("isSafeLinksEnabledCacheValue",h.toString()));this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksLicenseCheck",!1)&&E?(this.iRb=!1,E.execute($a=>{$a.isFeatureEnabled("MsoUrlreputation",
!0).then(sb=>{this.iRb=sb;Fa.set("isUserLicensedForSafeLinks",this.iRb.toString());ta.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Fa);this.iRb&&ma&&this.UGd(!0);return null})})):(ta.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Fa),ma&&this.UGd(!0))}}get appName(){return this.$mb}get Cce(){return this.CYj}get userId(){return this.TXj}get mCl(){const b=this.Cce?this.Cce+"/":"",h=new Ea.QueryStringBuilder("SafeLinksHandler.ashx");h.Me("app",this.appName);
this.Ma.$("SafeLinksUseDebugHeader")&&h.Me("action","debug");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.Me("s2satpop","1");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&h.Me("s2saat","1");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&h.Me("s2se03","1");return String.format("{0}{1}&{2}",b,h.toString(),u.AFrameworkApplication.um)}get iMl(){const b=this.Cce?this.Cce+
"/":"",h=new Ea.QueryStringBuilder("SafeLinksHandler.ashx");h.Me("app",this.appName);this.Ma.$("SafeLinksUseDebugHeader")&&h.Me("action","debug");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.Me("s2satpop","1");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&h.Me("s2saat","1");this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&h.Me("s2se03","1");h.Me("slrt","GetUrlReputation");
return String.format("{0}{1}&{2}",b,h.toString(),u.AFrameworkApplication.um)}get PIm(){xh.yEe||(xh.yEe=new am(this.Ma,this.hg,this.iMl,xh.le));return xh.yEe}tgc(b){if(!b)return w.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var h=this.pcm(b);w.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",h,this.Ccd,this.Bcd,this.iRb);if(!(h&&
this.Ccd&&this.Bcd&&this.iRb))return!1;h=0;const n=({state:h}=this.oTn()).returnValue;w.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",Ug[h]);const x=qa.a.aF();x&&x.set("SafeLinksNavigationState",Ug[h]);ta.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",x);if(!n)return 2!==h&&3!==h||ta.Health.instance.recordKpiFailure("SafeLinksNavigations",Ug[h],!1,!0,null),!1;w.ULS.sendTraceTag(26019601,378,50,"Using safelinks to navigate hyperlink");
if(this.OTn())return this.lrf()?!1:this.PIm.tgc(this.dfl(),b,this.iVh());if(!this.lrf())return this.ocj(b),!0;this.r8a=b;w.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.bNc=!1;this.UGd();return!0}pcm(b){b=b.toLowerCase();const h=this.Ma.AB("SafeLinksUnsupportedProtocols");if(h)for(let n=0;n<h.length;n++)if(b.startsWith(h[n]))return!1;return!0}UGd(b=!1){var h=qa.a.aF();h&&h.set("isOnBootRequest",b.toString());ta.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",
1,"jpittsdirects",h);ta.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",h);h=this.SYe("SafeLinksGetPolicy");this.hg.Lj(this.mCl,1,null,null,!0,2,Object(v.a)(this,this.EFl,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(v.a)(this,this.DFl,"getSafeLinksDataFromServer_OnFailureCallback"),h,void 0,void 0,void 0,void 0,"23");this.bNc=b;this.lad=!0;b?this.jpb++:this.kpb++}EFl(b){let h=ua.a.pKm,n="";try{this.lad=this.bNc=!1;var x=b.data.state;const oc=({$w:x}=this.M8d(x)).returnValue,
Ic=Object.assign(new ab.a,{durationMs:oc});ta.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",Ic);w.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",b.data.mf,b.data.Ee.length,oc);if(b.data.mf!==ua.a.qD)n="Unexpected httpStatus: "+b.data.mf.toString();else{x=null;try{x=z.b(b.data.Ee)}catch(gd){n="Exception:"+gd.toString()+" deserializing response";return}if(x){var E=x.IsSafeLinksEnabled;if(void 0===
E||null===E||0>=E.length)n="Invalid isSafeLinksEnabledString";else{w.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",E);var S=xh.pJf(E);if(void 0===x.WebAffinitizedUrl||null===x.WebAffinitizedUrl||0>=x.WebAffinitizedUrl.length)n="Invalid WebAffinitizedUrl";else if(void 0===x.PolicyCookie||null===x.PolicyCookie||0>=x.PolicyCookie.length)n="Invalid PolicyCookie";else if(void 0===x.PolicyCookieTTL||null===x.PolicyCookieTTL)n="Invalid PolicyCookieTTL";else{var ma=x.WebAffinitizedUrl,
Fa=x.PolicyCookie,$a=x.AffinitizedUrl,sb=new Date;sb.setMinutes(sb.getMinutes()+(5<x.PolicyCookieTTL?x.PolicyCookieTTL-5:0));var Jb=sb.getTime(),Sb=new ul(E,ma,Fa,Jb,!1,$a);this.oWi(Sb);h=b.data.mf;this.r8a&&(S?(this.ocj(this.r8a),this.kpb=this.jpb=0):(w.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),ta.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),rd.a.Wyb(this.r8a)),this.r8a=null)}}}else n="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(oc){n=
"GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+oc.toString()}finally{h!==ua.a.qD&&this.l1h(h,n)}}DFl(b){this.lad=!1;let h=500,n="";try{let x=b.data.state;const E=({$w:x}=this.M8d(x)).returnValue,S=Object.assign(new ab.a,{durationMs:E});h=b.data.mf;ta.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+h.toString(),!1,!0,S);n="Request Failed, Status="+Kk.a[b.data.status]+" Duration: "+E}catch(x){n="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+
x.toString()}finally{this.l1h(h,n)}}l1h(b,h=""){try{if(w.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",b,h),this.jpb<this.Ped&&this.kpb<this.Qed)this.UGd(this.bNc);else{this.bNc=!1;w.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",this.jpb,this.kpb,b,h);h=null;const n=qa.a.aF();n&&(n.set("HttpStatus",b.toString()),h=Object.assign(new ab.a,{extendedProperties:n}));
ta.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,h);const x=new ul("false","","",0,!0,"");this.oWi(x);this.r8a&&(w.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),ta.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",!1,!0,null),rd.a.Wyb(this.r8a),this.r8a=null)}}catch(n){w.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",
n.toString())}}ocj(b){const h=this.iVh(),n=this.pNl(),x={};x.Url=b;x.SafeLinksCookie=h;x.CorrelationId=na.a.create().toString();x.WorkloadId=this.Gso;x.UserAgentInfo=V.a.WE+"|"+this.appName;w.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",x.CorrelationId);rd.a.PKf(rd.a.poa(4),n,x)}Nhm(){const b=this.Ma.lb("IsSafeLinksEnabledForUser");return b?xh.pJf(b):!1}Mhm(){const b=this.Ma.AB("SafeLinksDisabledBrowsers");if(V.a.l2){if(this.Ma.vu("SafeLinksForTeamsIsEnabled")&&
this.Ma.$("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(b,"Electron"))return!1}else if(Array.contains(b,V.a.WE))return!1;return"officecomhwa"===(this.Ma.lb(u.AFrameworkApplication.Zga)||"").toLowerCase()?!1:!0}OTn(){return-1!==window.location.href.indexOf("&wd_slnh=1")?!0:V.a.l2}oTn(){let b;b=0;const h=this.C1b(),n=h?h.IsSafeLinksEnabled:"";if(""!==n)return h.WasServiceDown?(w.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===n.toLowerCase()?
(w.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):{returnValue:xh.pJf(n),state:b};if(this.lad)return b=3,w.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:b};if(this.jpb>=this.Ped||this.kpb>=this.Qed)return b=2,w.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.jpb,this.Ped,this.kpb,this.Qed),{returnValue:!1,state:b};w.ULS.sendTraceTag(23900182,
378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",this.Ped+this.Qed-(this.jpb+this.kpb));return{returnValue:!0,state:b}}iVh(){const b=this.C1b();return b?b.PolicyCookie:""}pNl(){const b=this.C1b();return b?b.WebAffinitizedUrl:""}dfl(){const b=this.C1b();return b?b.AffinitizedUrl:""}mpl(){const b=new Date;try{const h=this.C1b();b.setTime(h?h.PolicyCookieTTL:0)}catch(h){w.ULS.sendTraceTag(24462658,
378,10,"Exception occured while fetching expiration time from cache: {0}",h)}return b}lrf(){const b=this.mpl();return!!b&&b.getTime()<Date.now()}C1b(){if(!this.zkd){const b=lb.a.instance.getItem(this.userId);if(!b||""===b)return null;this.zkd=JSON.parse(b)}return this.zkd}oWi(b){if(void 0===b||null===b)throw Error.argumentNull("safeLinksData");if(void 0===b.IsSafeLinksEnabled||null===b.IsSafeLinksEnabled||0>=b.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");
this.zkd=b;b.WasServiceDown||this.Uso(b)}Uso(b){b=JSON.stringify(b);lb.a.instance.setItem(this.userId,b)}SYe(b){return void 0!==xh.le&&null!==xh.le?xh.le.fg("WebServiceCall",b):null}M8d(b){if(void 0!==b&&null!==b){const h=b.ni;b.stop();return{returnValue:h,$w:null}}return{returnValue:null,$w:b}}static pJf(b){return"false"!==b.toLowerCase()?!0:!1}}xh.le=null;xh.yEe=null;Object(r.a)(xh,"SafeLinksManager",null,[681]);const Ed=b=>{switch(b){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";
case 4:return"OneNote";case 5:return"Visio";default:return"Unknown"}},bm=b=>{switch(b){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};class In{constructor(){this.W=null}get name(){return"Common.App.SafeLinks"}zc(b){this.W=b}init(){u.AFrameworkApplication.K&&u.AFrameworkApplication.K.yq(Object(v.a)(this,this.Ww,"onFullAppSettingsReady"))}dispose(){}Ww(){u.AFrameworkApplication.K.$("WACSafeLinksIsEnabled")&&(this.W.register(xh,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").singleInstance().Xd(()=>
new xh(u.AFrameworkApplication.K,u.AFrameworkApplication.Ze,String.format("{0}-{1}",Ed(u.AFrameworkApplication.ua.Sb.jo),bm(u.AFrameworkApplication.ua.Sb.wfa)),!1,this.W.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),u.AFrameworkApplication.ua.iq)),this.W.Pa("Common.App.SafeLinks.ISafeLinksManager"))}static main(){N.a.instance.Pc(new In)}}Object(r.a)(In,"SafeLinksPackage",null,[1,2]);var nf=d(181);class Ph{constructor(b){this.sa=new Ge.a;this.Dh=b}i$a(b){this.sa.addHandler(Ph.fva,
b)}jXc(b){this.sa.removeHandler(Ph.fva,b)}j$a(b){this.sa.addHandler(Ph.YPa,b)}Hbc(b){this.sa.removeHandler(Ph.YPa,b)}dOe(b){this.sa.addHandler(Ph.Tfc,b)}QZf(){this.sa.raiseEvent(Ph.fva)}ujf(){return nf.a.instance.pMa(u.AFrameworkApplication.xy)}}Ph.fva="SE";Ph.bZc="SEP";Ph.YPa="SER";Ph.Tfc="TRP";Object(r.a)(Ph,"NullSessionExpirationManager",null,[654,655]);class um{constructor(){this.Ruc=this.h9a=!1;const b=u.AFrameworkApplication.xy;0>=b||(this.xy=b,w.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",
{["AccessTokenTtl"]:this.xy,["NowGetTime"]:(new Date).getTime(),["BootTime"]:u.AFrameworkApplication.SV}),nf.a.instance.s9g(Object(v.a)(this,this.p$b,"onSessionExpiredDetected")),nf.a.instance.r9g(Object(v.a)(this,this.gXd,"onSessionExpiringDetected")))}p$b(){nf.a.instance.JNi(Object(v.a)(this,this.p$b,"onSessionExpiredDetected"));w.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.Rif()}gXd(){nf.a.instance.jqn(Object(v.a)(this,this.gXd,"onSessionExpiringDetected"));this.Ruc||this.h9a||
(w.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.Ruc=!0,this.v_f())}Rif(){this.h9a||(u.AFrameworkApplication.MQ(Ie.a.Zcc),this.h9a=!0,this.C7d())}}Object(r.a)(um,"ASessionExpirationManager",null,[]);var Kc=d(153),dk=d(264);class oi{constructor(b,h,n,x){this.P3f="";this.o5c=b;this.YYg=n;this.UYg=x;this.aJg=h;b=(new Date(this.o5c)).format(u.AFrameworkApplication.A0i);this.P3f=this.aJg?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,
b)}$cc(b){1===b?this.YYg&&this.YYg(this.aJg):0===b&&u.AFrameworkApplication.ya.Xb(Ra.a.close,2,dk.g)}dispose(){this.UYg&&this.UYg()}}oi.id="SessionExpirationDialog";Object(r.a)(oi,"SessionExpirationDialogSharedProperties",null,[]);class Bd{}Bd.ug="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(r.a)(Bd,"SessionExpirationDialogHtml",null,[]);class uk extends Kc.a{constructor(b,h,n,x){super(h);
const E={};this.UTa=new oi(b,h,n,x);this.kg=oi.id;u.AFrameworkApplication.lih?(this.Ed=1,this.We(0,CommonUIStrings.l_DialogClose)):(this.Ed=0,this.yt=!1);h||1===u.AFrameworkApplication.ua.mode?this.We(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.We(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.ug=Bd.ug;E.WACSessionExpirationText=this.UTa.P3f;this.Zh(CommonUIStrings.l_DefaultDialogTitle,Object(v.a)(this,this.$cc,"sessionExpirationDialogHandler"),E);this.m3(this.pj("WACSessionExpirationText"))}$cc(b){this.UTa.$cc(b)}Njf(){this.hide()}dispose(){super.dispose();
this.UTa&&this.UTa.dispose()}}Object(r.a)(uk,"LegacySessionExpirationDialog",Kc.a,[789]);class cl extends yd.StandardDialog{constructor(b,h,n,x){super(h);this.UTa=new oi(b,h,n,x);this.kg=oi.id;u.AFrameworkApplication.lih?(this.Ed=1,this.We(0,CommonUIStrings.l_DialogClose)):(this.Ed=0,this.yt=!1);h||1===u.AFrameworkApplication.ua.mode?this.We(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.We(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Lv(CommonUIStrings.l_DefaultDialogTitle,
this.UTa.P3f,0,Object(v.a)(this,this.$cc,"sessionExpirationDialogHandler"))}$cc(b){this.UTa.$cc(b)}Njf(){this.hide()}dispose(){super.dispose();this.UTa&&this.UTa.dispose()}}Object(r.a)(cl,"SessionExpirationDialog",yd.StandardDialog,[789]);const qe=(b,h,n,x)=>u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.zA&&u.AFrameworkApplication.K.$("ReactStandardSessionExpirationDialogIsEnabled")?new cl(b,h,n,x):new uk(b,h,n,x);var Wf=d(154);class dl extends um{constructor(b){super();this.cld=this.pUb=
!0;this.GY=null;this.sa=new Ge.a;this.Dh=b}i$a(b){this.sa.addHandler(dl.fva,b)}jXc(b){this.sa.removeHandler(dl.fva,b)}j$a(b){this.sa.addHandler(dl.YPa,b)}Hbc(b){this.sa.removeHandler(dl.YPa,b)}dOe(b){this.sa.addHandler(dl.Tfc,b)}ujf(){return nf.a.instance.pMa(u.AFrameworkApplication.xy)}QZf(b){this.pUb=b}v_f(){if(!this.GY&&!Wf.a.kL){if(this.cld){const b=Object(v.a)(this,this.F_b,"disposeCallback");this.GY=qe(this.xy,!1,Object(v.a)(this,this.adc,"sessionExpirationHandler"),b)}this.sa.raiseEvent(dl.bZc)}}C7d(){this.GY&&
(this.GY.cCa&&this.GY.Njf(),this.GY=null);if(this.pUb){const b=Object(v.a)(this,this.F_b,"disposeCallback");this.GY=qe(this.xy,!0,Object(v.a)(this,this.adc,"sessionExpirationHandler"),b)}this.sa.raiseEvent(dl.fva)}F_b(){this.GY=null}adc(b){(b||this.Dh.Kyc())&&this.Dh.refreshDocument(null)}}dl.fva="SE";dl.bZc="SEP";dl.YPa="SER";dl.Tfc="TRP";Object(r.a)(dl,"SessionExpirationManager",um,[654,655]);class Ne{}Ne.gZj="Aborting";Ne.kpd="ActivityDuration";Ne.error="Error";Ne.j2k="Errors";Ne.failed="Failed";
Ne.Nyb="FirstActivity";Ne.initialized="Initialized";Ne.kickedOut="KickedOut";Ne.Bnm="LastActivity";Ne.Nwn="RetryOverride";Ne.c3d="RequestGroups";Ne.B1a="Requests";Ne.n3d="Responses";Ne.O4d="SessionDuration";Ne.status="Status";Ne.success="Success";Ne.F1n="Successful";Ne.tokens="Tokens";Ne.pKf="PollingDuration";Object(r.a)(Ne,"SessionExpirationStrings",null,[]);class rj{constructor(b){this.VA={};this.pha={};this.v8a={};this.gli=15;this.ZKg=!1;this.ySj=new Date;this.Odd=new Date;this.Hb=b;this.DE=new We.a(2,
2,6E4*this.gli,Object(v.a)(this,this.Rkj,"writeMeasures"),135,"SL",!1);this.Hb.$b(this.DE);this.D1l()}Rkj(){w.ULS.sendTraceTag(41964821,217,50,w.ULS.jPc({["Aggregate"]:this.pha,["Current"]:this.VA}))}D1l(){this.pha[Ne.c3d]=0;this.pha[Ne.B1a]=0;this.pha[Ne.n3d]=0;this.pha[Ne.status]=Ne.initialized;this.pha[Ne.Nyb]=new Date;this.pha[Ne.O4d]=0;this.pha[Ne.kpd]=0;this.pha[Ne.O4d]=0;this.VA[Ne.O4d]=0;this.pha[Ne.kpd]=0;this.VA[Ne.kpd]=0}get v3m(){this.v8a[Ne.pKf]=+new Date-+this.v8a[Ne.Nyb];return this.v8a}vlf(b,
h){var n=b[h];n=n?n:0;n++;b[h]=n;this.UWf(b)}UWf(b){const h=new Date;b[Ne.kpd]=+h-+this.Odd;this.Odd=h;b[Ne.O4d]=+this.Odd-+this.ySj;b[Ne.Bnm]=this.Odd}aPa(b,h){this.VA[b]=h;this.UWf(this.VA)}NWi(b,h){this.VA[b]=h;this.UWf(this.VA)}C4b(b){this.vlf(this.VA,b);this.vlf(this.pha,b);this.vlf(this.v8a,b)}flush(){this.ZKg||(this.pha[Ne.status]=this.VA[Ne.status],this.Rkj(this.DE),this.Hb.e3(this.DE,6E4*this.gli))}mun(){const b=this.VA[Ne.status];b&&(this.pha[Ne.status]=b);this.VA={}}Fun(){this.v8a={};this.v8a[Ne.pKf]=
0;this.v8a[Ne.Nyb]=new Date}stop(){w.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.ZKg=!0;this.Hb.ef(this.DE)}}Object(r.a)(rj,"SessionLogger",null,[650]);class vk{constructor(b,h){this.cnd=b;this.k6a=h}get tokens(){return this.cnd}get errors(){return this.k6a}}Object(r.a)(vk,"TokenRefreshArgs",null,[745]);var Vh=d(388);class zd extends Sys.EventArgs{constructor(b,h,n,x,E,S,ma){super();this.v8a=b;this.xDi=h;this.c3d=x;this.failed=E;this.B1a=S;this.n3d=
ma}}Object(r.a)(zd,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);class Za{constructor(b,h=null,n=null){this.Ruc=this.h9a=!1;this.cld=this.pUb=!0;this.sa=new Ge.a;this.Tuc=this.Rdd=this.Kid=!1;this.Vrb=null;this.wUg=10;this.edd=!1;this.bJe=b;this.Iue=u.AFrameworkApplication.Klm;this.Hb=Ye.a.instance;w.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:u.AFrameworkApplication.xy,["NowGetTime"]:(new Date).getTime(),["BootTime"]:u.AFrameworkApplication.SV});
this.ke=h||new rj(Ye.a.instance);this.Qia=n;nf.a.instance.s9g(Object(v.a)(this,this.bZj,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));nf.a.instance.r9g(Object(v.a)(this,this.M4g,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));Vh.SessionStatusManager.instance.G6j(Object(v.a)(this,this.M4g,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));Vh.SessionStatusManager.instance.g7j(Object(v.a)(this,this.b5m,"preemptiveTokenRefresh"));this.rMg=new Date;u.AFrameworkApplication.Jlm&&
(nf.a.instance.kUe=Object(v.a)(this,this.phn,"refreshAccessTokenWhenSessionExpired"));u.AFrameworkApplication.K&&(u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.wUg=u.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1))}i$a(b){this.sa.addHandler(Za.fva,b)}jXc(b){this.sa.removeHandler(Za.fva,
b)}j$a(b){this.sa.addHandler(Za.YPa,b)}Hbc(b){this.sa.removeHandler(Za.YPa,b)}dOe(b){this.sa.addHandler(Za.Tfc,b)}ujf(){return nf.a.instance.pMa(u.AFrameworkApplication.xy)}phn(){this.yJd(!1);return!nf.a.instance.pMa(u.AFrameworkApplication.xy)}bZj(b,h){nf.a.instance.cPd?this.p$b(b,h):this.Iue?(this.Rdd=!1,this.yJd(!1)):(this.h9a||w.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),this.p$b(b,h))}M4g(b,h){nf.a.instance.$rf?this.gXd(b,h):this.yJd(!0)}yJd(b){if(!this.Kid&&
!this.Rdd)if(this.Qia&&this.Qia.io)this.Tuc=!0,this.ke.aPa(Ne.status,Ne.kickedOut),this.ke.flush(),this.ke.stop();else if(w.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",b,this.Tuc),this.Tuc)this.C7d();else{this.ke.flush();this.ke.mun();this.ke.C4b(Ne.c3d);this.Kid=!0;this.edd||(this.ke.Fun(),this.edd=!0,this.HFk());const h=this.bJe.Fhn(b);h.continueWith(()=>{if(this.bJe.Z8m(h))this.ke.C4b(Ne.F1n),this.ke.aPa(Ne.status,Ne.success),this.cld=!1,this.Iue&&(this.pUb=
!1),this.Rdd=!1,this.rMg=new Date,this.K0n(),this.sa.raiseEvent(Za.YPa,new vk(h.result.tokens,null));else{const n=h.result.errors;this.ke.C4b(Ne.failed);this.ke.aPa(Ne.status,Ne.failed);b||(this.Tuc=this.bJe.AOd(n));this.Tuc&&(this.ke.aPa(Ne.gZj,JSON.stringify(n)),w.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.Rdd=!0;this.sa.raiseEvent(Za.YPa,new vk(null,n))}this.ke.flush();this.Kid=!1})}}p$b(){this.Iue||nf.a.instance.JNi(Object(v.a)(this,this.p$b,"onSessionExpiredDetected"));
w.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.Rif(nf.a.instance.cPd)}gXd(){this.Ruc||this.h9a||(w.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.Ruc=!0,this.v_f(nf.a.instance.$rf))}Rif(b){if(!this.h9a){var h=b?Ie.a.FEn:Ie.a.Zcc;const n=Object.assign(new ab.a,{extendedProperties:new Map});n.extendedProperties.set("ErrorCode",String.format("{0}",h));u.AFrameworkApplication.MQ(h,void 0,["SessionExpired"],n);b||(b=new Date,h=new Date(u.AFrameworkApplication.SV),
w.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",h,b,+b-+h),864E5>+b-+h&&ta.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,n),2592E5>+b-+h&&ta.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,n));this.h9a=!0;this.C7d()}}K0n(){this.edd&&(this.Hb.ef(this.Vrb),this.edd=!1)}HFk(){this.Vrb=new We.a(2,2,1E3*this.wUg,Object(v.a)(this,this.y7n,
"tokenRefreshPolling"),135);this.Hb.$b(this.Vrb)}y7n(){const b=this.ke.v3m;w.ULS.sendTraceTag(555255521,217,50,"{0}",z.c(b));this.sa.raiseEvent(Za.Tfc,new zd(b,b[Ne.pKf],b[Ne.Nyb],b[Ne.c3d],b[Ne.failed],b[Ne.B1a],b[Ne.n3d]))}b5m(){3E5<+new Date-+this.rMg?(w.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.yJd(!1)):w.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}Za.fva="SE";Za.bZc="SEP";Za.YPa="SER";
Za.Tfc="TRP";Object(r.a)(Za,"ASessionExpirationManagerWithRefresh",null,[]);class Cb extends Za{constructor(b,h,n=null,x=null){super(h,n,x);this.GY=null;this.Dh=b}QZf(b){this.pUb=b}v_f(b){if(!this.GY&&!Wf.a.kL){if(b){var h=Object(v.a)(this,this.F_b,"disposeCallback");this.GY=qe(u.AFrameworkApplication.zjb,!1,Object(v.a)(this,this.adc,"sessionExpirationHandler"),h)}else if(this.cld){if(this.Kid)return;h=Object(v.a)(this,this.F_b,"disposeCallback");this.GY=qe(u.AFrameworkApplication.xy,!1,Object(v.a)(this,
this.adc,"sessionExpirationHandler"),h)}w.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",Za.bZc,b);this.sa.raiseEvent(Za.bZc)}}C7d(){this.GY&&(this.GY.cCa&&this.GY.Njf(),this.GY=null);if(this.pUb){this.ke.stop();if(this.Qia&&this.Qia.io)return;const b=Object(v.a)(this,this.F_b,"disposeCallback");this.GY=qe(u.AFrameworkApplication.xy,!0,Object(v.a)(this,this.adc,"sessionExpirationHandler"),b)}w.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",Za.fva);this.sa.raiseEvent(Za.fva)}F_b(){this.GY=
null}adc(b){(b||this.Dh.Kyc())&&this.Dh.refreshDocument(null)}}Object(r.a)(Cb,"SessionExpirationManagerWithRefresh",Za,[654,655]);class Rb{constructor(b,h,n=null,x=null){this.h3g=!1;this._instance=null;this._frame=b;this.qm=h;this.ke=n||new rj(Ye.a.instance);this.Qia=x}create(){this.h3g=u.AFrameworkApplication.i_a;if(!this.h3g)return new dl(this._frame);u.AFrameworkApplication.Gl("WOPITokenRefreshIsEnabled");w.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");
if(!this._instance)switch(u.AFrameworkApplication.spo){case 1:w.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");this._instance=new Ph(this._frame);break;case 2:w.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this._instance=new Cb(this._frame,this.qm,this.ke,this.Qia);break;default:w.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this._instance=new dl(this._frame)}w.ULS.sendTraceTag(39408089,217,
50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this._instance).getName());return this._instance}}Object(r.a)(Rb,"SessionExpirationManagerFactory",null,[653]);class pc{}Object(r.a)(pc,"Error",null,[]);class Rc{}Object(r.a)(Rc,"NamedResult",null,[]);class wb extends Rc{}Object(r.a)(wb,"ErrorInfo",Rc,[]);var Td=d(1027),sd=d(31);class Me{constructor(b,h,n,x=null,E=!1,S=null,ma=!1){this.ETa=0;this.B9a=this.$n=null;this.cnd=new Qa.a;this.k6a=new Qa.a;this.er=null;this.Hue=!1;
this.Hb=b;this.AUg=h;this.AUg.execute(Fa=>{Fa.VB(F.a.qkf,Object(v.a)(this,this.cRm,"onHostResponseReceived"))});this.ZHa=n;this.S1g=new Td.a("WebServiceCall","TokenRefresh");this.ke=x||new rj(b);this.rSj=E;this.kf=S?S:Vh.SessionStatusManager.instance;this.xBg=ma}cRm(b){if(b.MessageId!==F.a.qkf)sd.b(39408099,306,15,"Unexpected message.");else{var h=new Qa.a,n=new Qa.a;this.ke.C4b(Ne.n3d);var x=b.Values[G.a.OVi];if(!x||0>=x.length)sd.b(40122317,306,15,"Found no tokens in the dictionary"),x=b.Values;
sd.b(40122318,306,100,"The Tokens array contains {0} tokens",x.length);this.ke.aPa("Correlation",b.CorrelationId);var E="";for(let Fa=0;Fa<x.length;Fa++){this.ke.NWi(Ne.tokens,x.length);var S=x[Fa],ma=S;if(!ma||!ma.Name)continue;this.ke.C4b(ma.Name);const $a=S;if($a&&$a.Value)sd.b(39408128,306,100,"Received token with name: {0}",$a.Name),h.add($a),this.cnd.add($a),this.ke.aPa(Ne.status,Ne.success),this.xBg&&this.kf&&this.kf.Xun();else if(S=this.QFl(S),sd.b(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",
ma.Name,JSON.stringify(S),this.B9a),n.add(S),this.k6a.add(S),E=JSON.stringify(S),this.ke.aPa(Ne.error,JSON.stringify(S)),this.ke.aPa(Ne.status,Ne.failed),this.xBg)for(const sb of S.Errors)ma=this.dpl(sb),this.kf&&this.kf.q4j(ma)}0<n.count&&""!==E?(x=Object.assign(new ab.a,{extendedProperties:new Map}),x.extendedProperties.set("Errors",E),ta.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,x)):ta.Health.instance.recordKpiSuccess("WACTokenRefresh",null);sd.b(39408130,306,
50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",h.count,n.count,b.CorrelationId,this.B9a);0<n.count&&!this.AOd(n)?(b=this.ZHa.HEl(n),b!==this.ZHa.qTf&&(this.ke.NWi(Ne.Nwn,b),this.Hb.e3(this.$n,b))):(this.ke.flush(),this.$n&&(sd.b(39408131,306,100,"Deleting task {0} from task manager",this.$n.name),this.Hb.ef(this.$n)),this.er&&!this.er.task.isCompleted&&this.er.Gg(new vk(h,n)))}}QFl(b){if(!b)return null;const h=Object.assign(new wb,{Name:b.Name,Errors:[]});
for(const n of b.Errors)b=new pc,b.Id=n.Id,b.Details=this.PFl(n.Details),h.Errors.push(b);return h}PFl(b){if(!b)return"";const h=b.toString().toLowerCase();return 0<h.indexOf("<!doctype")?this.Fff("Seems to contain HTML - Contains <!DOCTYPE"):0<h.indexOf("<html")?this.Fff("Seems to contain HTML - Contains <html>"):500<h.length?this.Fff(String.format("Error details content too long: Length: {0}",h.length)):b}Fff(b){return String.format("{0} - Reason: [{1}]","### REDACTED ###",b)}requestTokensOnce(){this.EPi()}EPi(){u.AFrameworkApplication.Hf("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");
this.ETa>=this.ZHa.Xxf?(sd.b(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.B9a),this.tHk(this.er)):(ta.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.CCn())}CCn(){const b={};b[G.a.OVi]=this.ZHa.tokens;const h=na.a.create().toString();sd.b(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.ZHa.tokens),this.ETa+1,h,this.B9a);this.AUg.execute(n=>{n.sendMessage(F.a.uPe,b,h)});this.ETa++;this.ke.C4b(Ne.B1a)}tHk(b){const h=
new Qa.a;for(let n=0;n<this.ZHa.tokens.length;n++){const x=Object.assign(new wb,{Name:this.ZHa.tokens[n],Errors:[Object.assign(new pc,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});h.add(x);this.k6a.add(x)}this.Hb.ef(this.$n);this.ke.aPa(Ne.j2k,JSON.stringify(this.k6a));this.ke.aPa(Ne.status,Ne.failed);b&&!b.task.isCompleted&&b.Gg(new vk(new Qa.a,this.k6a))}Fhn(b){this.S1g.start();this.Hue=b;this.B9a=na.a.create().toString();
sd.b(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.B9a,this.Hue);this.ETa=0;this.k6a.clear();this.cnd.clear();this.er=new Nb.a;this.$n=new We.a(this.ZHa.priority,2,this.ZHa.qTf,Object(v.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,F.a.uPe,!0);this.rSj&&this.EPi();this.Hb.$b(this.$n);return this.er.task}Z8m(b){this.S1g.stop();const h=this.$Tl(b.result.errors);w.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!h,this.B9a,this.Hue,this.ETa,this.k6a.count,0<b.result.errors.count?b.result.errors.J(0).Name:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Id:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Details:"");return h?!1:this.Y8m(b.result.tokens)}AOd(b){return this.ZHa.AOd(b)}Y8m(b){for(let h=0;h<b.count;h++){const n=b.J(h);if(n.Name===G.a.accessToken){const x=(new Date).getTime();n.Expiry>u.AFrameworkApplication.xy?
(w.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:n.Expiry,["NowGetTime"]:x,["BootTime"]:u.AFrameworkApplication.SV},"PreviousAccessTokenTtl",u.AFrameworkApplication.xy),u.AFrameworkApplication.accessToken=n.Value,u.AFrameworkApplication.xy=Math.floor(n.Expiry),u.AFrameworkApplication.C9f=x,u.AFrameworkApplication.LIa=Math.floor(n.Expiry)):w.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:n.Expiry,
["NowGetTime"]:x,["BootTime"]:u.AFrameworkApplication.SV},"PreviousAccessTokenTtl",u.AFrameworkApplication.xy)}}return!0}$Tl(b){let h=!1;for(let n=0;n<b.count;n++){h=!0;const x=b.J(n);w.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",x.Name,JSON.stringify(x.Errors),this.B9a)}return h}dpl(b){let h=Ie.a.Zcc;b=parseInt(b.Id);if(isNaN(b))h=Ie.a.Xjj;else{switch(b){case 401:h=Ie.a.D9f;break;case 403:h=Ie.a.Vjj;break;case 500:h=Ie.a.Wjj;break;case 503:h=Ie.a.Zjj}h===
Ie.a.Zcc&&(h=500<b?Ie.a.Yjj:Ie.a.Ujj)}return h}}Object(r.a)(Me,"TokenRefreshManager",null,[652]);class tf{constructor(){this.qTf=u.AFrameworkApplication.vpo;this.Xxf=u.AFrameworkApplication.tpo;this.tokens=u.AFrameworkApplication.xOl();this.priority=u.AFrameworkApplication.wpo;this.aXg=this.HLn();this.nLe=u.AFrameworkApplication.wOl()}AOd(b){b=JSON.stringify(b);if(this.nLe&&0<this.nLe.length)for(const h of this.nLe)if(0<h.length&&0<=b.indexOf(h))return!0;return!1}HEl(b){try{if(b)for(let h of b)if(h.Errors)for(const n of h.Errors)if(n.Id in
this.aXg)return Number.parseInvariant(this.aXg[n.Id].toString())}catch(h){w.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",h.toString())}return this.qTf}HLn(){const b={};try{if(!u.AFrameworkApplication.UHd()||0>=u.AFrameworkApplication.UHd().length||""===u.AFrameworkApplication.UHd()[0])return b;for(const h of u.AFrameworkApplication.UHd())0<h.length&&(b[h]=u.AFrameworkApplication.upo)}catch(h){w.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",
h.toString())}return b}}Object(r.a)(tf,"TokenRefreshPolicy",null,[651]);class Pf{constructor(){this.W=null}get name(){return"Common.App.SessionExpiration"}init(){u.AFrameworkApplication.K.yq(()=>{this.YYa()})}YYa(){this.W.resolve("Common.ISessionExpirationManagerFactory");this.W.resolve("Common.ISessionExpirationManager");this.W.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}zc(b){this.W=b;b.register(650,"Common.App.SessionExpiration.ISessionLogger").singleInstance().Xd(()=>new rj(Ye.a.instance));
b.register(651,"Common.App.SessionExpiration.ITokenRefreshPolicy").singleInstance().Xd(()=>new tf);b.register(652,"Common.App.SessionExpiration.ITokenRefreshManager").singleInstance().Xd(()=>new Me(Ye.a.instance,u.AFrameworkApplication.WP(),b.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),u.AFrameworkApplication.K.$("WopiTokenRefreshSendTokenRequestWithoutTasks"),b.Pa("Common.ISessionStatus"),u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",
!1)));b.register(653,"Common.ISessionExpirationManagerFactory").singleInstance().Xd(()=>new Rb(u.AFrameworkApplication.ua,b.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),b.Pa("Common.ISessionStatus")));b.register(654,"Common.ISessionExpirationManagerWithDialog").singleInstance().Xd(()=>b.resolve("Common.ISessionExpirationManagerFactory").create());b.register(655,"Common.ISessionExpirationManager").singleInstance().Xd(()=>b.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){N.a.instance.Pc(new Pf)}}
Object(r.a)(Pf,"SessionExpirationPackage",null,[1,2]);var Yh=d(736),ti=d(439),Fh=d(359),Pg=d(213);class za extends Pg.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(r.a)(za,"PersonaButtonProps",Pg.a,[]);class rb{JZb(b,h){if(b&&!(1>b.length)&&h){var n=Object.assign(new Fh.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.HHk(b,n.ControlList);h.push(n)}}HHk(b,h){const n=Object.assign(new Yh.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,
Menu:Object.assign(new ti.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(h,n);h=Object.assign(new Fh.a,{Title:"",ControlList:[]});Array.add(n.Menu.MenuSectionList,h);this.sKk(b,h.ControlList)}sKk(b,h){for(let n=0;n<b.length;n++){const x=Object.assign(new za,{ExternalId:String.format("CoauthorPersona_{0}",n),Command:"336231556",DisplayName:b[n].userName,LabelText:b[n].userName,ImageBackColor:b[n].color,PersonaId:b[n].email,IsAnonymous:b[n].isAnonymous});
Array.add(h,x)}}}Object(r.a)(rb,"PresenceContextMenuSectionBuilder",null,[731]);var Zb=d(78);class yc{constructor(b,h,n,x){this.Coa=this.Zr=this.$n=this.ig=this.BFa=null;this.jld=b;this.KTj=x;this.jld.lMc&&(this.$n=new We.a(3,2,5E3,Object(v.a)(this,this.Dek,"authenticationCheckTask"),2),u.AFrameworkApplication.uc.$b(this.$n),this.Vb(h,n));this.jld.T4j(()=>{this.yFb()});this.jld.l8g(()=>{this.zFb()})}get mP(){return this.Zr||(this.Zr=Oa.a.instance.Pa("CommonUI.IBusinessBar"))}get Agh(){return this.Coa||
(this.Coa=Oa.a.instance.Pa("CommonUI.IBusinessBarEntryFactory"))}Vb(b,h){const n=u.AFrameworkApplication.ya;n.gb(Ra.a.qdh,Ld.a.frame,b,96);n.gb(Ra.a.rdh,Ld.a.frame,h,96);n.pa(Ra.a.Mih,Ld.a.frame,pd.ActionManager.jZ);n.pa(Ra.a.Nih,Ld.a.frame,pd.ActionManager.jZ);n.pa(Ra.a.yuf,Ld.a.frame,pd.ActionManager.jZ)}yFb(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);u.AFrameworkApplication.ya.processAction(Ra.a.qdh,2)}zFb(){this.M4n();u.AFrameworkApplication.ya.processAction(Ra.a.rdh,2)}Dek(){this.jld.authenticationCheck()}M4n(){this.ig&&
(this.ig.hide(),this.ig.dispose(),this.ig=null);this.BFa&&this.mP&&(u.AFrameworkApplication.Dk||this.mP.removeEntry(this.BFa),this.BFa.dispose(),this.BFa=null)}showDialog(b){Zb.a.LA(this.ig);this.ig=new yd.StandardDialog;this.KTj||(this.ig.yt=!1,this.ig.Ed=0);this.ig.We(1,CommonUIStrings.l_SignIn);this.ig.nU(CommonUIStrings.l_DefaultDialogTitle,b,Object(v.a)(this,this.K9,"dialogHandler"))}K9(b){1===b?(Oj.a.oZd(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),u.AFrameworkApplication.ya.processAction(Ra.a.yuf,
2)):(this.dUn(),u.AFrameworkApplication.ya.processAction(Ra.a.Nih,2))}dUn(){this.mP&&this.Agh&&(this.BFa=this.Agh.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.BFa.closeable=!0,this.BFa.addButton(CommonUIStrings.l_SignIn,yc.Ivb,""),this.BFa.Kja=Object(v.a)(this,this.nmk,"businessBarEntryCloseHandler"),this.mP.eB(this.BFa,!1))}nmk(){this.NUk();u.AFrameworkApplication.ya.processAction(Ra.a.Mih,2)}NUk(){this.$n&&(u.AFrameworkApplication.uc.ef(this.$n),
this.$n=null)}dispose(){this.$n=this.ig=this.BFa=null}static Ivb(){Oj.a.oZd();u.AFrameworkApplication.ya.processAction(Ra.a.yuf,2)}}Object(r.a)(yc,"SignOutResponseUI",null,[10]);class Vc{get name(){return"Common.App.UI"}zc(b){b.register(rb,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").singleInstance()}init(){}dispose(){Zb.a.LA(Vc.nqa);Vc.nqa=null}static main(){N.a.instance.Pc(new Vc)}static X_l(b,h,n){Vc.RTn()&&(Vc.nqa=new yc(Oj.a.instance,
b,h,n))}static RTn(){return u.AFrameworkApplication.sUd&&!u.AFrameworkApplication.$La}}Vc.nqa=null;Object(r.a)(Vc,"CommonAppUIPackage",null,[1,2]);class Sd{get name(){return"Common.App.DialogWithLinkToResource"}zc(){}init(){}dispose(){}static main(){N.a.instance.Pc(new Sd)}}Object(r.a)(Sd,"CommonAppDialogWithLinkToResourcePackage",null,[1,2]);var de=d(56);class jf{constructor(b){this.yx=b;this.jx=Array.indexOf(this.yx,this.bea)}dispose(){this.yx=null}get G1(){return this.yx[this.jx]}hy(b){this.hZc(b,
!1);return!0}m1b(b){this.hZc(b,!0)}hZc(b,h){b&&(this.G1!==b||h)&&(b.tabIndex=0,de.FocusManager.uK(b));Array.contains(this.yx,b)&&(this.jx=Array.indexOf(this.yx,b))}get LEi(){let b=this.jx;do if(b)if(0<b&&b<this.yx.length)b--;else break;else b=this.yx.length-1;while(!ke.DOMFocusListing.RWa(this.yx[b])&&b!==this.jx);return this.yx[b]}get Wri(){let b=this.jx;do if(b===this.yx.length-1)b=0;else if(0<=b&&b<this.yx.length-1)b++;else break;while(!ke.DOMFocusListing.RWa(this.yx[b])&&b!==this.jx);return this.yx[b]}get bea(){let b=
0;for(;!ke.DOMFocusListing.RWa(this.yx[b])&&b<this.yx.length;)b++;return ke.DOMFocusListing.RWa(this.yx[b])?this.yx[b]:null}get P7b(){let b=this.yx.length-1;for(;!ke.DOMFocusListing.RWa(this.yx[b])&&0<b;)b--;return ke.DOMFocusListing.RWa(this.yx[b])?this.yx[b]:null}}Object(r.a)(jf,"DialogFocusListing",null,[135]);var Ke=d(51);class Je extends yd.StandardDialog{constructor(b,h,n,x=null){super();this.wca=this.aw=this.p6a=null;this.yx=[];this.mhd=h;this.Kj=b;this.JEj=n;this.wkd=x;this.Sl=new Td.a("LoadResource",
"LoadPrintablePdf")}Uza(){this.Ed=5;this.width=40;const b=document.createElement("span");b.id=this.pj("DirectPrintHeaderContent");const h=document.createElement("span");h.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(h,"DirectPrintHeader");this.wca=document.createElement("iframe");this.wca.name="pdfObjectFrame";this.wca.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.wca.onload=Object(v.a)(this,this.P6m,"printablePdfLoaded");if(this.wkd&&0<this.wkd.count){var n=
Ec.a.eff(this.mhd,this.wkd);const x=Ec.a.MQf(this.mhd,this.wkd);this.aw=document.createElement("form");this.aw.id="printPreviewPostForm";this.aw.method="POST";this.aw.target=this.wca.name;this.aw.action=x;for(let E of n)n=document.createElement("input"),n.type="hidden",n.name=E.key,n.value=E.value,this.aw.appendChild(n)}else this.wca.setAttribute("src",this.mhd);Sys.UI.DomElement.addCssClass(this.wca,Wf.a.ZQg);this.JEj?(Sys.UI.DomElement.addCssClass(this.wca,"DirectPrintPdfObjectHidden"),h.innerText=
CommonUIStrings.l_DirectPrintDialogSuccessText,qf.a.Gq(this.wca,qf.a.wz,qf.a.Ho)):(Sys.UI.DomElement.addCssClass(this.wca,"DirectPrintPdfObject"),this.yx.push(this.wca));b.appendChild(h);b.appendChild(document.createElement("br"));b.appendChild(this.wca);this.aw&&b.appendChild(this.aw);b.appendChild(document.createElement("br"));b.appendChild(this.hBk(this.aw?"#":this.mhd));this.Sl.start();this.ahb(CommonUIStrings.l_AppTitle,null,null,null,null,b);this.m3(this.pj("DirectPrintHeaderContent"));this.aw&&
this.aw.submit();this.IHk();w.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}hBk(b){const h=document.createElement("span");var n=document.createElement("span");n.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;h.appendChild(n);u.AFrameworkApplication.K&&(2===u.AFrameworkApplication.ua.Sb.jo&&u.AFrameworkApplication.K.$("PPTDisableDirectPrintDialogDownloadPDFLink")||1===u.AFrameworkApplication.ua.Sb.jo&&u.AFrameworkApplication.K.$("XLODisableDirectPrintDialogOpenPDFLink"))?
(b=document.createElement("span"),2===u.AFrameworkApplication.ua.Sb.jo?b.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===u.AFrameworkApplication.ua.Sb.jo&&(b.innerText=CommonUIStrings.l_InternalError_Directive,w.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.p6a=b,h.appendChild(document.createElement("br")),h.appendChild(b)):(n=document.createElement("a"),n.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,n.href=b,n.target=
"_blank",n.id="PrintPDFLink",n.className="AllowBrowserClick",this.p6a=n,h.appendChild(document.createElement("br")),h.appendChild(n),this.aw&&af.a.addHandler(n,"click",Object(v.a)(this,this.RVm,"onSubmit")),this.Kj.mb(kb.a.click,this.p6a,Object(v.a)(this,this.qAh,"downloadPDFLinkClicked"),null));this.yx.push(this.p6a);return h}RVm(b){this.aw&&(this.aw.target="_blank",this.aw.submit());b.preventDefault()}IHk(){if(0<this.yx.length){const b=new jf(this.yx),h=de.FocusManager.instance().Cs();h&&(this.p6a.focus(),
h.Uj=b,h.dX=!0)}}qAh(){w.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}rQc(){w.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}P6m(){w.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Sl&&this.Sl.stop()}dispose(){this.p6a&&(this.Kj.sc(kb.a.click,this.p6a,Object(v.a)(this,this.qAh,"downloadPDFLinkClicked")),this.p6a=null);Ke.a.dv(this.wca);this.wca=null;super.dispose()}}Object(r.a)(Je,"DirectPrintDialog",
yd.StandardDialog,[739]);class Sh{constructor(b){this.Kj=b}Qnl(b,h,n=null){return new Je(this.Kj,b,h,n)}}Object(r.a)(Sh,"DirectPrintDialogFactory",null,[723]);class sc{constructor(b,h){this._url=b;this.FNj=h}fzh(){this.FNj?rd.a.downloadFile(this._url):rd.a.ym(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(r.a)(sc,"OpenUrlInTabDialogDownloadBehavior",null,[741,10]);class mg extends yd.StandardDialog{constructor(b,h=!0,n=!1,x=null,E=null,S=!1){super();
this.WPb=this.VPb=this.aw=this.J0=null;var ma=this.f4f?this.f4f:CommonUIStrings.l_DefaultDialogTitle;mg.a4b=S;this.zme=x||new sc(b,!0);const Fa=[],$a=[];mg.xK&&(this.rqd&&this.rqd.forEach(Sb=>{Array.add(Fa,Sb)}),this.K9g&&this.K9g.forEach(Sb=>{Array.add($a,Sb)}));h?n?(this.Ed=4,this.We(1,this.buttonText),this.We(2,CommonUIStrings.l_DialogClose)):(this.Ed=6,this.We(0,CommonUIStrings.l_DialogClose)):this.Ed=5;S=document.createElement("span");this.sCc&&(S.className=this.sCc);x=document.createElement("a");
x.innerText=this.g8b;x.href=b;x.target="_blank";x.id=this.$Pc;x.className=xd.AFrame.UOe;var sb=!V.a.l2&&!!E&&0<E.count;if(sb){const Sb=Ec.a.eff(b,E);E=Ec.a.MQf(b,E);x.href="#";x.target="_self";this.aw=document.createElement("form");this.aw.id="printPreviewPostForm1";this.aw.method="post";this.aw.target="_blank";this.aw.action=E;for(var Jb of Sb)E=document.createElement("input"),E.type="hidden",E.name=Jb.key,E.value=Jb.value,this.aw.appendChild(E)}else this.aw=null;this.aw||mg.a4b?mg.a4b||Array.add($a,
{["type"]:"AppLinkProps",["id"]:this.$Pc,["text"]:this.g8b,["onExecute"]:()=>{this.oIi()}}):Array.add($a,{["type"]:"AppLinkProps",["id"]:this.$Pc,["text"]:this.g8b,["handler"]:{["href"]:sb?"#":b,["target"]:sb?"_self":"_blank"}});this.V_a&&Array.add(Fa,this.V_a);n?(b=document.createElement("span"),b.innerText=this.V_a.replace("{0}",""),S.appendChild(b)):this.vpi?(b=document.createElement("span"),b.id=this.pj("message"),Jb=document.createElement("span"),E=document.createElement("span"),sb=this.V_a.split("{0}"),
Jb.innerText=sb[0],E.innerText=sb[1],b.appendChild(Jb),b.appendChild(x),b.appendChild(E),S.appendChild(b)):(b=document.createElement("span"),b.innerText=this.V_a,S.appendChild(b),S.appendChild(document.createElement("br")),S.appendChild(document.createElement("br")),S.appendChild(x),mg.a4b||Array.add(Fa,"{0}"));this.aw&&S.appendChild(this.aw);mg.xK&&(this.Cgb&&(this.JPc?this.u6g(this.Cgb,this.JPc):(Array.add(Fa,"{0}"),Array.add($a,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.Cgb,
["onExecute"]:()=>{}}))),this.sxc(Fa,$a));this.ahb(ma,null,this.Akf,null,Object(v.a)(this,this.K9,"dialogHandler"),mg.xK?null:S);this.m3(this.pj("message"));!mg.xK&&this.JPc&&this.Cgb&&(ma=document.createElement("div"),ma.className="WACDialogLearnMoreLinkContainer",this.J0=document.createElement("a"),this.J0.innerText=this.Cgb,this.J0.href=this.JPc,this.J0.target="_blank",this.J0.id=this.pj("LearnMoreLinkId"),this.J0.className=xd.AFrame.UOe,ma.appendChild(this.J0),h?this.ed.insertBefore(ma,this.ed.lastChild):
this.ed.appendChild(ma),this.m3(String.format("{0} {1}",this.pj("message"),this.pj("LearnMoreLinkId"))));this.Xlc=x;n?this.mU(this.aG):this.mU(this.Xlc);this.Wvf();u.AFrameworkApplication.ua.C_.mb(kb.a.click,this.Xlc,Object(v.a)(this,this.pAh,"downloadLinkClicked"),null);this.J0&&u.AFrameworkApplication.ua.C_.mb(kb.a.click,this.J0,Object(v.a)(this,this.aji,"learnMoreLinkClicked"),null);this.sR=!1}get Akf(){return null}get f4f(){return null}get V_a(){return null}get JPc(){return null}get Cgb(){return null}get vpi(){return!1}get buttonText(){return CommonUIStrings.l_Open}get sCc(){return null}get rqd(){return null}get K9g(){return null}tja(){this.aw&&
(this.VPb||(this.VPb=Object(v.a)(this,this.sMm,"onActionButtonClicked"),this.lq.mb(kb.a.click,this.aG,this.VPb)),this.WPb||(this.WPb=Object(v.a)(this,this.tMm,"onActionButtonKeyUp"),this.re.mb(kb.a.Bh,this.aG,this.WPb)));super.tja()}sMm(b){this.RDh(b);return!0}tMm(b){return this.lPc(b,Object(v.a)(this,this.RDh,"executeDismissActionButtonFromArgs"))}RDh(b){this.aw&&this.aw.submit();this.syb(b.Af)}rQc(){}pAh(){this.Xvf();this.aw?this.aw.submit():this.zme.fzh();return!0}aji(){return!1}dispose(){this.zme.dispose();
this.Xlc&&(u.AFrameworkApplication.ua.C_.sc(kb.a.click,this.Xlc,Object(v.a)(this,this.pAh,"downloadLinkClicked")),this.Xlc=null);this.J0&&(u.AFrameworkApplication.ua.C_.sc(kb.a.click,this.J0,Object(v.a)(this,this.aji,"learnMoreLinkClicked")),this.J0=null);this.lq&&this.VPb&&(this.lq.sc(kb.a.click,this.aG,this.VPb),this.VPb=null);this.re&&this.WPb&&(this.re.sc(kb.a.Bh,this.aG,this.WPb),this.WPb=null);super.dispose()}oIi(){this.aw&&(document.body.appendChild(this.aw),this.aw.submit(),document.body.removeChild(this.aw))}K9(b){1===
b&&(this.rQc(),this.aw?mg.xK&&this.oIi():this.zme.fzh());this.dispose()}static get xK(){return u.AFrameworkApplication.ua.Sb.zA&&u.AFrameworkApplication.ua.Sb.Eei}static get a4b(){return mg.ZFg}static set a4b(b){mg.ZFg=b}}mg.ZFg=!1;Object(r.a)(mg,"ADialogWithLinkToResource",yd.StandardDialog,[]);class Lc extends mg{constructor(b,h,n=null,x=!0,E=!1){super(b,!0,!(Lc.Xlb&&x),new sc(b,h),n,E);Lc.Xlb=Lc.Xlb&&x;if(Lc.Xlb){h=document.createElement("iframe");x=null;E=this.ITk;h.name="pdfObjectFrame";h.id=
"pdfObjectIFrame";if(n&&0<n.count){const S=Ec.a.eff(b,n);b=Ec.a.MQf(b,n);x=document.createElement("form");x.id="printPreviewPostForm";x.method="POST";x.target=h.name;x.action=b;for(let ma of S)b=document.createElement("input"),b.type="hidden",b.name=ma.key,b.value=ma.value,x.appendChild(b)}else h.src=b;E.appendChild(h);x&&(E.appendChild(x),x.submit());Sys.UI.DomElement.addCssClass(h,"DirectPrintPdfObjectHidden");qf.a.Gq(h,qf.a.wz,qf.a.Ho)}}get Akf(){return"Print_32x32x32"}get f4f(){return Lc.Xlb?
CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get V_a(){return Lc.Xlb?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get rqd(){const b=[];Array.add(b,CommonUIStrings.l_PrintDialogCanCloseDocument);if(mg.a4b){let h=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==u.AFrameworkApplication.ua.Sb.bvh&&(h=u.AFrameworkApplication.ua.Sb.bvh);Array.add(b,h)}return Lc.Xlb?b:null}get g8b(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get $Pc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get sCc(){return u.AFrameworkApplication.AWa?
"UIFontDialogTextLarge":null}Wvf(){w.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}Xvf(){u.AFrameworkApplication.km.UYa(9540);w.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}rQc(){w.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get Xlb(){return!!u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.zA&&u.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")&&!(V.a.l2||V.a.zk||V.a.fj||V.a.N6b)&&!u.AFrameworkApplication.SOc&&
u.AFrameworkApplication.K.$("ShouldHostDefaultToNativeBrowserPrintExperience")}static set Xlb(b){}}Object(r.a)(Lc,"PrintDialogWithLinkToPdf",mg,[]);class Pj{constructor(b){this.isEnabled=Boolean.parse(b.DirectPrintIsEnabled||"false");this.Agm=Boolean.parse(b.DirectPrintProbeIsEnabled||"false");this.idm=Boolean.parse(b.DirectPrintEnabledForInternetExplorer||"false");this.pKb=(b.DirectPrintSupportedMimeTypes||"").split(Pj.K2e);this.Okb=(b.DirectPrintSupportedPlugins||"").split(Pj.K2e);this.kZl=(b.DirectPrintImmersivePreviewPlugins||
"").split(Pj.K2e);this.Cai=Boolean.parse(b.DirectPrintEnabledForEdge||"false");this.G8l=Boolean.parse(b.ChromePrintLayoutFixIsEnabled||"false");this.Mtk=parseInt(b.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.Myf=14;this.Ipi=14394;if(b=b.DirectPrintMinimalSupportedEdgeVersion){const h=b.split(".");2===h.length?(this.Myf=parseInt(h[0]),this.Ipi=parseInt(h[1])):w.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",b)}else w.ULS.sendTraceTag(20734113,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}Pj.K2e=",";Object(r.a)(Pj,"DirectPrintBrsSettings",null,[]);class Vk{constructor(b,h){this.S1f=b;this.Okb=h}}Object(r.a)(Vk,"DirectPrintProbeResults",null,[]);var th=d(195);class Wh{constructor(b,h,n,x,E,S,ma,Fa,$a,sb){this.dod=null;this.Jzj=b;this.prc=h;this.nye=n;this.lHj=x;this.vIj=E;this.jtc=new se.a(Object(v.a)(this,this.fDl,"getProbeResults"));this.ylc=S;this.mNg=$a;this.sV=ma;this.qpc=Fa;this.OIj=sb}get yP(){return this.Jzj}start(){}k7m(){this.yP.Agm&&
this.nym()}Wan(){const b=Array(this.yP.pKb.length);if(void 0!==this.prc&&null!==this.prc)for(let h=0;h<this.yP.pKb.length;h++)b[h]=this.yP.pKb[h]in this.prc&&this.lHj(this.prc[this.yP.pKb[h]]);return b}Xan(){const b=Array(this.yP.Okb.length),h=!(void 0===this.nye||null===this.nye);for(let n=0;n<this.yP.Okb.length;n++){const x=this.yP.Okb[n];b[n]=h&&x in this.nye?!0:this.vIj(x)}return b}KIl(){const b=this.Wan(),h=Array(b.length);for(let n=0;n<b.length;n++)h[n]=b[n]?this.v4k(this.prc[this.yP.pKb[n]]):
null;return h}v4k(b){if(void 0===b||null===b)return null;b=b.enabledPlugin;return void 0===b||null===b?null:b.name}nym(){w.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.jtc.value.S1f,this.jtc.value.Okb)}fDl(){var b=this.KIl();const h=this.Xan(),n={},x={};for(let E=0;E<this.yP.pKb.length;E++)n[this.yP.pKb[E]]=b[E];for(b=0;b<this.yP.Okb.length;b++)x[this.yP.Okb[b]]=h[b];return new Vk(n,x)}HTn(){return this.OIj||!this.yP.isEnabled||u.AFrameworkApplication.SOc?!1:this.R1n()}NTn(){if(null!=
this.dod)return this.dod;const b=Wh.Bai(this.yP);return this.dod=this.yP.Cai&&b||this.F8l()}F8l(){return V.a.So&&this.yP.G8l&&V.a.Ltk>=this.yP.Mtk?!0:!1}R1n(){if(!this.qpc(this.yP))return!1;var b=Ia.a.getValues(this.jtc.value.S1f);for(const h of b)if(void 0!==h&&null!==h)return!0;b=Ia.a.getValues(this.jtc.value.Okb);for(const h of b)if(h)return!0;return!1}kUl(){const b=Ia.a.getValues(this.jtc.value.S1f);for(const h of b)if(th.a.contains(this.yP.kZl,h))return!0;return!1}$Vn(b,h=null){u.AFrameworkApplication.ua&&
u.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")?this.mNg(b,h):this.HTn()?this.PVk(b,this.kUl()&&!0,h):this.mNg(b,h)}PVk(b,h,n=null){const x=this.sV.fg("UserAction","OpenDirectPrintDialog");this.ylc.Qnl(b,h,n).Uza();x.stop()}static jjm(b){try{return new ActiveXObject(b),!0}catch(h){w.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",b)}return!1}static wam(b){return void 0===b||null===b?!1:!(void 0===b.enabledPlugin||null===b.enabledPlugin)}static create(b){const h=
new Pj(u.AFrameworkApplication.K.appSettings);let n=null;try{n=window.navigator.mimeTypes}catch(sb){w.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let x=null;try{x=window.navigator.plugins}catch(sb){w.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const E=Wh.wam,S=Wh.jjm;b=b.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const ma=u.AFrameworkApplication.ua.iq,Fa=Wh.ljm,$a=!!u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.zA&&
!u.AFrameworkApplication.K.$("PrintDialogFallbackLinkEnabled");return new Wh(h,n,x,E,S,b,ma,Fa,(sb,Jb)=>new Lc(sb,!1,Jb,!0,$a),u.AFrameworkApplication.$La)}static ljm(b){return V.a.So||V.a.zk&&b.idm||b.Cai&&Wh.Bai(b)?!0:!1}static Bai(b){var h=V.a.X_b;if(h){var n=h.split(".");if(2===n.length)return h=parseInt(n[0]),n=parseInt(n[1]),h>b.Myf||h===b.Myf&&n>=b.Ipi}return!1}}Object(r.a)(Wh,"DirectPrintManager",null,[678]);class jg{constructor(){this.oob=this.W=null}get name(){return"Common.App.DirectPrint"}zc(b){this.W=
b;b.register(Sh,"Common.App.DirectPrint.DirectPrintDialogFactory").singleInstance().Xd(()=>new Sh(u.AFrameworkApplication.ua.C_));b.register(678,"Common.App.DirectPrint.IDirectPrintManager").singleInstance().Xd(()=>Wh.create(this.W))}init(){this.oob=this.W.resolve("Common.App.DirectPrint.IDirectPrintManager");this.oob.start()}dispose(){}}Object(r.a)(jg,"PackageManager",null,[1,2]);class Ui{constructor(b,h=3E4){this.u4f=9E5;this.w4f=1E4;this.Smi=this.C8b=null;this.$wf=0;this.gbb=Date.now;this.BHd=
b;this.P$d=h;this.dDd()}DZh(b=!0){const h=this.gbb();if(h<this.$wf+this.u4f)return h>this.$wf+this.w4f&&this.dDd(),this.Smi;b&&this.dDd();return null}getToken(b=!0){return(b=this.DZh(b))?Promise.resolve(b):this.dDd()}dDd(){return this.C8b=this.C8b||new Promise(b=>{this.BHd().then(h=>{this.C8b=null;""!==h&&h&&(this.Smi=h,this.$wf=this.gbb(),b(h));b(null)}).catch(()=>{this.C8b=null;b(null)});window.setTimeout(()=>{this.C8b=null;b(null)},this.P$d)})}}Object(r.a)(Ui,"OAuthCacheManager",null,[]);class Wl{static usa(b){return""!==
b&&b?Wl.X$j[b.toLowerCase()]:""}static IKl(b,h){const n=Date.now();var x=Wl.xBk();const E=u.AFrameworkApplication.K.lb("UserPrincipalName"),S=Wl.usa(b);w.ULS.sendTraceTag(593862986,1300,50,"Begin SSO Request for app: "+b);if(""===E||!E)return w.ULS.sendTraceTag(593862985,1300,10,"Missing login hint for silent oAuth"),Promise.resolve("");if(""===S||!S)return w.ULS.sendTraceTag(593862984,1300,10,"Missing AAD appId for appName: "+b),Promise.resolve("");const ma=na.a.create().toString();x=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&login_hint={3}&redirect_uri={4}&state={5}&prompt=none",
"https://login.microsoftonline.com",S,encodeURIComponent(h),encodeURIComponent(E),encodeURIComponent(x),ma);const Fa=document.createElement("iframe");Fa.style.display="none";Fa.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin");Fa.src=x;document.body.appendChild(Fa);return new Promise($a=>{Wl.tHm(Fa.contentWindow).then(sb=>{document.body.removeChild(Fa);const Jb=new Jc.a,Sb=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let oc;for(;oc=Sb.exec(sb);)3!==oc.length&&(w.ULS.sendTraceTag(593862983,
1300,10,"Unexpected Hash respones in OAuth header! Match length: {0}",oc.length),$a("")),Jb.Z(oc[1],oc[2]);Jb.xb("access_token")?(w.ULS.sendTraceTag(593862982,1300,50,"SSO Request successful for resource: {0} for app: {1} Latency: {2}",h,b,Date.now()-n),$a(Jb.J("access_token"))):(w.ULS.sendTraceTag(526668183,1300,10,"SSO Request failure for resource: {0} for app: {1}. Latency: {2}",h,b,(Date.now()-n).toString()),$a(""))}).catch(sb=>{try{document.body.removeChild(Fa)}catch(Jb){}w.ULS.sendTraceTag(593862980,
1300,10,"SSO Request failure for resource: {0} for app: {1} Error: {2} Latency: {3}",h,b,JSON.stringify(sb),(Date.now()-n).toString());$a("")})})}static xBk(){const b=window.location.protocol,h=window.location.host;var n=u.AFrameworkApplication.K.lb("OAuthManagerHostPathOverride");if(void 0===n||null===n){n=window.location.pathname;const x=n.lastIndexOf("/");n=0<=x?n.substring(0,x+1):""}return b+"//"+h+n+"WacOAuth.html"}static tHm(b){return new Promise((h,n)=>{let x=0,E=0;E=window.setInterval(()=>
{if(200<x++)window.clearInterval(E),n("Exceeded 10000ms timeout after 200 polls");else{var S=null,ma=null;try{if(!b||b.closed){window.clearInterval(E);n("Window or Frame is closed before completion");return}S=b.location.href;ma=b.location.hash}catch(Fa){}S&&"about:blank"!==S&&ma&&""!==ma&&(window.clearInterval(E),h(ma))}},50)})}}Wl.X$j={["smartlookup"]:"4d5c2d63-cf83-4365-853c-925fd1a64357",["search"]:"a9b49b65-0a12-430b-9540-c80b3332c127"};Object(r.a)(Wl,"OAuthHelper",null,[]);class ef{constructor(b,
h){this.token=b;this.source=h}}Object(r.a)(ef,"TokenResult",null,[]);var Wg=d(102),uh=d(248);class Qj{constructor(){this.I6=null;this.FBg={};this.tokenCache=new ea.a(da.a.Pj())}getToken(b,h,n=!1){if(this.tokenCache.xb(h))return this.tokenCache.J(h).getToken();const x=new Ui(()=>n?this.EZh(b,h):this.BHd(b,h));this.tokenCache.Z(h,x);return x.getToken()}GKl(b,h,n=!1){if(this.tokenCache.xb(h))return this.tokenCache.J(h).DZh();const x=new Ui(()=>n?this.EZh(b,h):this.BHd(b,h));this.tokenCache.Z(h,x);return null}BHd(b,
h){const n=Date.now();return Wl.IKl(b,h).then(x=>new ef(x,"SSOStack")).then(x=>new Promise(E=>{x.token&&""!==x.token?(w.ULS.sendTraceTag(593862979,1300,50,"{0}: SSO Token resolved from {1}. Latency: {2}",b,x.source,Date.now()-n),this.Gjb("GetTokenInternal",!0,Date.now()-n,b,"","",h),E(x.token)):(w.ULS.sendTraceTag(593862978,1300,50,"{0}: SSO Token provider failed! Latency: {1}",b,Date.now()-n),this.Gjb("GetTokenInternal",!1,Date.now()-n,b,"GetTokenSilent Failed","SSO Token provider failed!",h),E(""))}))}EZh(b,
h){if(!this.I6)try{this.I6=Oa.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(n){w.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+n)}return this.I6?new Promise(n=>{const x=Date.now();this.I6.aoa(b,h).then(E=>{const S=E.Token;!E.IsSuccess||this.mkm(S)?(this.Gjb("GetTokenInternalImplicitJS",!1,Date.now()-x,b,E.ErrorCode,E.ErrorMessage,h),n(null)):(this.Gjb("GetTokenInternalImplicitJS",!0,Date.now()-x,b,E.ErrorCode,E.ErrorMessage,h),n(S))}).catch(E=>{E=E?z.c(E):"";this.Gjb("GetTokenInternalImplicitJS",
!1,Date.now()-x,b,"Caught Exception",E,h);n(null)})}):new Promise(n=>{this.Gjb("GetTokenInternalImplicitJS",!1,0,b,"Null OAuthManager","OAuthManager not set");n(null)})}Gjb(b,h,n,x,E="",S="",ma=""){var Fa="Search"===x;const $a=[];b=Wg.a.iea(Fa?"Event":"EventName",b,2);x=Wg.a.iea("AppName",x,2);Array.add($a,b);Array.add($a,x);Fa&&(x=Wg.a.iea("LatencyType","FetchToken",2),Array.add($a,x));E&&""!==E&&(E=Wg.a.iea("ErrorCode",E,2),Array.add($a,E));S&&""!==S&&(S=Wg.a.iea("ErrorMessage",S,2),Array.add($a,
S));ma&&""!==ma&&(S=!(ma in this.FBg),this.FBg[ma]=S,S=Wg.a.iea("WarmUpCall",S.toString(),1),Array.add($a,S),ma=Wg.a.iea("Service",this.QGl(ma),2),Array.add($a,ma));Fa=Fa?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";h=Object.assign(new uh.a,{name:Fa,samplingPolicy:2,dataFields:$a,succeeded:h,durationMs:n});Y.a.sendActivityEvent(h)}QGl(b){return b===u.AFrameworkApplication.Mwf?"Loki":b===u.AFrameworkApplication.K1f?"Substrate":u.AFrameworkApplication.K&&b===u.AFrameworkApplication.K.lb("SmartLookupShredderServiceEndpoint")?
"Shredder":"Other"}mkm(b){return!b||!b.length}}Object(r.a)(Qj,"SearchOAuthManager",null,[656]);class zg{constructor(){this.W=null}get name(){return"Common.App.SearchOAuthManager"}zc(b){this.W=b;this.W.register(656,"Common.App.SearchCommon.ISearchOAuthManager").singleInstance().Xd(()=>new Qj)}init(){}dispose(){}static main(){N.a.instance.Pc(new zg)}}Object(r.a)(zg,"SearchOAuthPackage",null,[1,2]);var qk=d(216),md=d(6),Pd=d(21),Kd=d(19),Cd=d(11);class hn{constructor(b,h,n){this.fze=this.usb=this.cze=
this.tsb=this.Sve=null;this.OQl=x=>{try{this.NQl(x)}catch(E){x=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",E.message,E.stack),w.ULS.sendTraceTag(5285580,334,10,x)}};this.xp=b;this.uAj=h;this.hb=n;this.init()}init(){this.uAj.mb(this.OQl);this.tsb=new Aa.a;this.cze=new Aa.a;this.usb=new Aa.a;this.fze=new qk.a}a3(b){this.tsb.add(b.key,b)}ubc(b){this.usb.add(b.key,b)}NQl(b){let h;({m0e:h}=hn.X$n(this.hb.ib.kb)).returnValue&&(b=hn.rll(b,this.Sve,
h),this.E7m(b,h),this.Sve=h)}E7m(b,h){b=this.hfl(b,h);let n;({notification:n}=hn.O$n(b)).returnValue&&this.xp.sendNotification(n,!1)}hfl(b,h){const n=new Aa.a;n.Z(1,new qk.a);n.Z(0,new qk.a);b.forEach(x=>{3===x?(hn.eZf(h.node)||this.Utn(h),this.YAl(n,h)):x||this.Rll(n,h);return!0});return n}Utn(b){this.tsb.forEach((h,n)=>{n.reset(b);return!0})}Rll(b,h){let n=new Aa.a;hn.eZf(h.node)||(n=this.Pll(h.cpBegin));this.Qll(b,this.cze,n,hn.NUi(this.Sve,h));this.cze=n}Pll(b){const h=new Aa.a;this.tsb.forEach((n,
x)=>{n=null;({KE:n}=x.DEa(b)).returnValue&&h.Z(x.key,n);return!0});return h}Qll(b,h,n,x){const E=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;h.forEach((S,ma)=>{const Fa=this.tsb.J(S).hw||ma.title;let $a;({value:$a}=n.Dc(S)).returnValue?x&&$a.contentObject!==ma.contentObject&&(Fa&&b.J(1).add(Fa),S=this.tsb.J(S).hw,S=String.format(E,$a.title,S),$a.description&&(S+=", "+$a.description),b.J(0).add(S)):Fa&&b.J(1).add(Fa);return!0});n.forEach((S,ma)=>{h.xb(S)||(S=this.tsb.J(S).hw,S=String.format(E,
ma.title,S),ma.description&&(S+=", "+ma.description),b.J(0).add(S));return!0})}YAl(b,h){h=this.dIl(h.node);h=this.oxk(h);this.eIl(b,this.fze,h);this.fze=h}dIl(b){const h=new md.GraphIterator;h.set(b);if(!h.Bb(1))return null;const n=new qk.a;for(;1!==h.Se;)this.usb.forEach((x,E)=>{let S;({Sja:S}=E.qgc(h)).returnValue&&n.add(S);return!0}),h.nc();n.reverse();return n}oxk(b){b=b.toArray();let h=0;for(;h<b.length-1;){var n=b[h];if(n.IF===b[h+1].IF&&(this.usb.J(n.IF),({rxk:n}={returnValue:!1,rxk:null}).returnValue)){b.splice(h,
2,n);continue}h++}return new qk.a(b)}eIl(b,h,n){var x;for(x=0;x<Math.min(n.length,h.length)&&n.J(x).contentId.equals(h.J(x).contentId);x++){var E=this.usb.J(n.J(x).IF).Azb(n.J(x),h.J(x));E&&(n.J(x).description&&(E+=", "+n.J(x).description),b.J(0).add(E))}for(E=x;E<n.length;E++){let S=this.usb.J(n.J(E).IF).Azb(n.J(E),null);S&&(n.J(E).description&&(S+=", "+n.J(E).description),b.J(0).add(S))}for(n=x;n<h.length;n++)(x=this.usb.J(h.J(n).IF).hw)&&b.J(1).add(x)}static rll(b,h,n){const x=new qk.a;(b=b||hn.qCn(h,
n))?(x.add(3),x.add(0)):hn.NUi(h,n)&&x.add(0);return x}static qCn(b,h){return!b||!b.node.id.equals(h.node.id)}static NUi(b,h){return!b||!b.equals(h)}static X$n(b){let h=null;if(!b||!(Kd.SelectionEditor.Km(b)||(b=Kd.SelectionEditor.ak(b,!0,!1),Kd.SelectionEditor.Km(b)||b.Qa&&hn.eZf(b.Qa.node))))return{returnValue:!1,m0e:h};h=b.Qa;return{returnValue:!!h,m0e:h}}static O$n(b){const h=new qk.a;b.J(1).forEach(n=>{n=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,n);h.add(n);return!0});
b.J(0).forEach(n=>{n=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,n);h.add(n);return!0});b=h.toArray().join(" ");return{returnValue:0<h.length,notification:b}}static eZf(b){return Pd.ImageReader.qw(b)||Cd.ParagraphReader.zra(b)}}Object(r.a)(hn,"AccessibilityContextManager",null,[648]);class Xm{constructor(b,h){this.DKg=!1;this.vuc=null;this.skd=this.Vnd=!1;this.aBg=null;this.vqd=(n,x)=>{(x.WQ||x.wna)&&this.UKm(x.WQ,x.wna)};this.Hb=b;this.EM=h}get VUl(){return!!this.vuc}mb(b){this.DKg||
(this.EM.D8g(this.vqd),this.DKg=!0);this.aBg=b}UKm(b,h){this.VUl&&this.Hb.ef(this.vuc);this.Vnd=this.Vnd||b;this.skd=this.skd||h;this.vuc=new We.a(5,1,Xm.z2k,()=>{this.aBg(this.Vnd,this.skd);this.reset()},126);this.Hb.$b(this.vuc)}reset(){this.vuc=null;this.skd=this.Vnd=!1}}Xm.z2k=100;Object(r.a)(Xm,"EditingViewOnAfterValidateEventsConsolidator",null,[646]);var kh=d(54);class dd{constructor(){this.W=null}get name(){return"Box4.Accessibility"}init(){ob.App.zch&&this.W.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}zc(b){this.W=
b;b.ha("Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator",()=>new Xm(u.AFrameworkApplication.uc,b.resolve("Box4.ContentEditableViewEventSource"))).as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").singleInstance();b.ha("Box4.Accessibility.AccessibilityContextManager",()=>new hn(b.resolve("Common.Utils.IAriaNotifier"),b.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),kh.a.instance)).as("Box4.Accessibility.IAccessibilityContextManager").singleInstance()}static main(){N.a.instance.Pc(new dd)}}
Object(r.a)(dd,"Box4AccessibilityPackage",null,[1,2]);var vb=d(127),wc=d(1009),ud=d(1583),ve=d(866),ue=d(170),Bf=d(1490),Se=d(49),Ae=d(24),nh=d(139),Dd=d(33),Db=d(3);class $f extends Bf.a{get eta(){return null!=this.xlg?this.xlg:this.xlg=Oa.a.instance.Pa("Box4.IInternalLinkManager")}get TDi(){return null!=this.dog?this.dog:this.dog=Oa.a.instance.Pa("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy")}get GB(){return!0}get commandId(){return Db.a.Mek}lka(b){ue.a.mark(7012);const h=new Se.GraphTransaction(15);
h.Db(b);var n=this.CF,x=this.PZ,E=Cd.ParagraphReader.text(b),S=E.substring(n,x);const ma=({LRc:Fa}=B.a.t1f(S)).returnValue;S!==ma&&(n+=Fa,x=n+ma.length);S=Dd.a.createTextRange(b,n,x);var Fa=E.substring(n,x);$f.cdm(E,n,x)&&(this.Vd.replaceTextRange(Dd.a.createTextRange(b,n-1,x+1),Fa,!0,!1),--n,--x,S=Dd.a.createTextRange(b,n,x),n=Ae.SelectionFactory.xe(b,x),kh.a.instance.setSelection(n));n=nh.HyperlinkReader.kLa(Fa);$f.hyperlinkEditor.DG(S,n,!1);E=Fa="";x=!1;this.eta&&({dQf:Fa,TIh:E}=this.eta.m5f(n)).returnValue&&
(n=Fa,x=!0,Fa=nh.HyperlinkReader.NC(S,!1),$f.hyperlinkEditor.LQ(Fa[0].paragraph,Fa[0].hyperlink),""!==E&&(this.Vd.replaceTextRange(S,E,!0,!1),S=Dd.a.createTextRange(b,this.CF,this.CF+E.length),b=Ae.SelectionFactory.xe(b,this.CF+this.CF+E.length),kh.a.instance.setSelection(b)),$f.hyperlinkEditor.DG(S,n,!1));h.dispose();!x&&this.TDi&&this.TDi.D4m(S,n);ue.a.mark(7013)}set GB(b){super.GB=b}static get hyperlinkEditor(){return null!=$f.yjg?$f.yjg:$f.yjg=Oa.a.instance.resolve("Box4.IHyperlinkEditor")}static cdm(b,
h,n){n=n!==b.length&&('"'===b.charAt(n)||"\u201d"===b.charAt(n));return!!h&&('"'===b.charAt(h-1)||"\u201c"===b.charAt(h-1))&&n}}Object(r.a)($f,"HyperlinkAction",Bf.a,[]);class Jh{constructor(b){this.Vd=b}kIk(b,h,n){return new $f(null,b,h,n,this.Vd)}}Object(r.a)(Jh,"HyperlinkActionFactory",null,[643]);var Ai=d(247);class kk{constructor(){this.W=null}get name(){return"Box4.AutoCorrect"}zc(b){this.W=b;b.ha("Box4.AutoCorrect.AutoCorrectRules",()=>new ud.a(b.resolve("Box4.IHyperlinkActionFactory"),b.resolve("Box4.ICharacterPropertiesEditor"),
Ai.a.instance,u.AFrameworkApplication.ya,u.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)).as("Box4.IAutoCorrectRules").singleInstance();b.ha("Box4.AutoCorrect.AutoCorrectOptionsInfo",()=>new wc.a(b.resolve("Box4.IRoamingServiceRequestManager"),u.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled"))).as("Box4.IAutoCorrectOptionsInfo").singleInstance();b.ha("Box4.AutoCorrect.AutoCorrectScheduler",()=>new ve.a(b.resolve("Box4.IAutoCorrectRules"),
kh.a.instance,vb.a.instance,u.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"))).as("Box4.IAutoCorrectScheduler").singleInstance();b.ha("Box4.AutoCorrect.HyperlinkAction.Factory",()=>new Jh(b.resolve("Box4.ICharacterPropertiesEditor"))).as("Box4.IHyperlinkActionFactory").singleInstance()}init(){this.W.resolve("Box4.IAutoCorrectRules").Fqm();const b=
u.AFrameworkApplication.K;b.$("AutoCorrectOptionSettingIsEnabledForWordOnline")&&b.$("IsRoamingServiceEnabled")&&this.W.resolve("Box4.IAutoCorrectOptionsInfo").Jgl()}dispose(){}static main(){N.a.instance.Pc(new kk)}}Object(r.a)(kk,"Box4AutoCorrectPackage",null,[1,2]);class on{get name(){return"Box4.Clipboard"}init(){}dispose(){}zc(){}static main(){N.a.instance.Pc(new on)}}Object(r.a)(on,"Box4ClipboardPackage",null,[1,2]);class Bi{get name(){return"Box4.ImageEditors"}zc(){}init(){}dispose(){}static main(){N.a.instance.Pc(new Bi)}}
Object(r.a)(Bi,"Box4ImageEditorsPackage",null,[1,2]);class oh{t1i(){return{s1i:!0,Pjj:!1}}}Object(r.a)(oh,"CursorMovementValidator",null,[649]);class ei{nFi(b,h,n,x,E,S){return b?u.AFrameworkApplication.ya.Qf(b,h,n,!0,E,S):8}}Object(r.a)(ei,"ListContextManager",null,[647]);class Qg{get name(){return"Box4.ListEditors"}zc(b){b.ha("Box4.ListEditors.CursorMovementValidator",()=>new oh).as("Box4.List.ICursorMovementValidator").singleInstance();b.ha("Box4.ListEditors.ListContextManager",()=>new ei).as("Box4.ListEditors.IListContextManager")}init(){}dispose(){}static main(){N.a.instance.Pc(new Qg)}}
Object(r.a)(Qg,"Box4ListEditorsPackage",null,[1,2]);class pi{get name(){return"Box4.NotebookLevelEditors"}zc(){}init(){}dispose(){}static main(){N.a.instance.Pc(new pi)}}Object(r.a)(pi,"Box4NotebookLevelEditorsPackage",null,[1,2]);var Ci=d(1502),Qe=d(128),Bk=d(759),cc=d(14);const cm=(b,h,n,x,E)=>{if(h.contextId===cc.a.view)switch(b){case Db.a.search:return ob.App.xa.jb.Wta.o$n(),ob.App.rM.uYi(),32;case Db.a.findOnPage:return 1!==n&&(ob.App.xa.jb.Wta.o$n(),ob.App.rM.fXf()),32;case Db.a.YPi:return ob.App.xa.jb.Jc&&
ob.App.xa.jb.Jc.Ji?(1!==n&&(Bk.a.DIb?ob.App.rM.zun():ob.App.rM.fXf()),b=32):b=8,b;case Db.a.Wvb:case Db.a.Fih:return 1===n?b=Bk.a.DIb?32:8:(ob.App.rM.zun(),b=32),b;case Db.a.k_d:return 1!==n&&ob.App.rM.ZHd(),32;case Db.a.NEi:return(b=rd.a.HKa(document.body.ownerDocument))&&b.id===Qe.AppFrame.UTi&&ob.App.rM.ZHd(),32;case Db.a.FUd:return 1!==n&&ob.App.rM.YHd(),32;case Db.a.Yri:return(b=rd.a.HKa(document.body.ownerDocument))&&b.id===Qe.AppFrame.UTi&&ob.App.rM.YHd(),32;case Db.a.pXi:return ob.App.rM.uHo(),
32;case Db.a.UXc:return ob.App.rM.UXc(),32;case Db.a.rkf:return 1!==n&&"string"===typeof E&&ob.App.rM.rkf(E),32;case Db.a.BTi:return 1!==n&&ob.App.rM.fXf(),32;case Db.a.CTi:return 1!==n&&ob.App.rM.uYi(),32;case Db.a.z5g:return ob.App.rM.qCo(),32;case Db.a.WTi:return ob.App.rM.uYi(),"string"===typeof E&&(ob.App.rM.B$m(E),Bk.a.DIb=!0),32;case Db.a.CBd:return ob.App.rM.fXf(),"string"===typeof E&&(ob.App.rM.B$m(E),Bk.a.DIb=!0),32}return 2};class Uj{get name(){return"Box4.Search"}zc(b){b.ha("Box4.Search.FindManagerHelper",
()=>Ci.FindManagerHelper.instance).as("Box4.Search.IFindManagerHelper").singleInstance()}init(){Eb.a.wWc(cm)}dispose(){}}Object(r.a)(Uj,"PackageManager",null,[1,2]);class Fd{get name(){return"Box4.TableEditors"}zc(){}init(){}dispose(){}static main(){N.a.instance.Pc(new Fd)}}Object(r.a)(Fd,"Box4TableEditorsPackage",null,[1,2]);class he{get name(){return"Box4.TextLevelEditors"}zc(){}init(){}dispose(){}static main(){N.a.instance.Pc(new he)}}Object(r.a)(he,"Box4TextLevelEditorsPackage",null,[1,2]);var hi=
d(103),qi=d(372),ad=d(106),Vj=d(615),bj=d(1514);class Uc{constructor(b,h,n){this.ov=this.qGa=this.rIa=null;this.sD=this.Vke=this.IFa=0;this.lia=this.Pcd=this.QRa=this.PRa=!1;this.zbd=this.XGg=this.$Gg=0;this.fxa=b;this.ga=h;this.Hm=n}WN(b){return!ob.App.xa.jb.isEditingAllowed||Vh.SessionStatusManager.instance.Qj?!1:""!==this.BHc(b.Af)}kK(b){if(!this.WN(b))return!1;this.NIn(b);this.sD=this.fxa.T1b();this.ALn(b);this.BLn();({W5b:this.Pcd,t7b:this.lia}=this.XYi(this.Vke));this.CLn();this.rIa=b.YG;this.ov=
new Sys.UI.Point(0,0);[this.$Gg,this.XGg]=this.fxa.getDimensions();w.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}RT(b){this.qGa=b.YG;this.fnk();this.zbd=bj.b(this.ov.x,this.ov.y,this.$Gg,this.XGg,this.Pcd,this.lia,this.zbd,u.AFrameworkApplication.K.$("SmoothImageHelperGetScaleIsEnabled"));this.fxa.t7f(this.zbd,this.Pcd,this.lia);return!0}eD(){this.setSize();w.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}lX(){this.fxa.MSf();w.ULS.sendTraceTag(16802337,
322,50,"Image resize drag canceled")}NIn(b){this.fxa=hi.a.Eb(b.Af,Vj.a)}BLn(){this.Vke=(Math.floor((this.sD+22)/45)%8+this.IFa)%8}XYi(b){let h,n;if(this.sD&&90!==this.sD&&180!==this.sD&&270!==this.sD&&360!==this.sD||this.fdm(b))return{W5b:!0,t7b:!0};h=n=!1;switch(b){case 1:case 5:h=!0;break;case 3:case 7:n=!0}return{W5b:n,t7b:h}}CLn(){this.QRa=this.PRa=!1;switch(this.Vke){case 0:this.QRa=this.PRa=!0;break;case 1:case 2:this.QRa=!0;break;case 7:case 6:this.PRa=!0}}fdm(b){return!(b%2)}BHc(b){var h=
b.classList.toString();-1===h.indexOf("WACImageResizeHandle")&&b.parentNode&&(h=b.parentNode.classList.toString());b=h.split(" ");for(h=0;h<b.length;h++){const n=b[h].toString();if(n.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==n)return n}return""}ALn(b){switch(this.BHc(b.Af)){case "WACImageResizeHandleNW":this.IFa=0;break;case "WACImageResizeHandleN":this.IFa=1;break;case "WACImageResizeHandleNE":this.IFa=2;break;case "WACImageResizeHandleE":this.IFa=3;break;case "WACImageResizeHandleSE":this.IFa=
4;break;case "WACImageResizeHandleS":this.IFa=5;break;case "WACImageResizeHandleSW":this.IFa=6;break;case "WACImageResizeHandleW":this.IFa=7}}fnk(){var b=1;this.Hm.instance&&(b=this.Hm.instance.vj);const h=(this.qGa.x-this.rIa.x)/b;b=(this.qGa.y-this.rIa.y)/b;this.ov.x=this.PRa?-h:h;this.ov.y=this.QRa?-b:b}setSize(){const b=new qi.DictionaryPropertySet;b.setValue(ad.a.dLc,100*this.zbd);b.setValue(ad.a.k5h,!0);if(90===this.sD||270===this.sD){let h,n;({W5b:h,t7b:n}=this.XYi(this.IFa));b.setValue(ad.a.Xkf,
h);b.setValue(ad.a.Ykf,n)}else b.setValue(ad.a.Xkf,this.Pcd),b.setValue(ad.a.Ykf,this.lia);this.ga.Xb(Db.a.w4b,2,b)}}Object(r.a)(Uc,"ImageResizeDragAdapter",null,[136]);var Jf=d(130),ui=d(855);class zn{constructor(b,h,n,x){this.qre=this.qGa=this.rIa=this.Ljd=null;this.Dgd=this.Dod=0;this.Gb=null;this.ga=b;this.hb=h;this.Hm=n;this.BNg=this.Pxa=0;this.Yc=x}WN(b){return ob.App.xa.jb.isEditingAllowed&&!Vh.SessionStatusManager.instance.Qj&&b&&this.Hhm(b.Af)?(this.Ljd=this.hb.Rg)?!0:!1:!1}ZBd(){}Off(){return null}kK(b){if(!this.WN(b))return!1;
this.fxa=hi.a.Eb(b.Af,Vj.a);if(!this.fxa)return!1;this.kkd=this.fxa.i7;if(!this.kkd)return!1;this.Ljd=this.hb.Rg;this.Gb=Pd.ImageReader.Xl(this.Ljd);if(!this.Gb)return!1;this.rIa=this.OKa(b);this.qre=Sys.UI.DomElement.getBounds(this.kkd);this.Dod=0<Pd.ImageReader.bFd(this.Gb)?Pd.ImageReader.bFd(this.Gb):0;this.Dgd=Pd.ImageReader.mdf(this.Gb);return!0}RT(b){this.qGa=this.OKa(b);this.onk();if(this.fxa)return this.fxa.Kbe(this.Pxa,this.BNg),!0;w.ULS.sendTraceTag(538809933,322,50,"Image rotate drag move aborted because img presenter is null.");
return!1}eD(){this.Dod=this.Pxa=bj.c(this.Pxa);this.BX()}lX(){this.fxa.Kbe(this.Dgd,0)}Hhm(b){return b.classList.contains(ui.c)||b.classList.contains(ui.b)||b.classList.contains(ui.a)||!!b.parentElement&&b.parentElement.classList.contains(ui.a)}OKa(b){return this.Yc.xd.yXa(b)}onk(){var b=1;this.Hm&&this.Hm.instance&&(b=this.Hm.instance.vj);var h=new Sys.UI.Point(this.qre.x+this.kkd.clientWidth/2*b,this.qre.y+this.kkd.clientHeight/2*b);b=bj.a(this.rIa,h);h=bj.a(this.qGa,h);this.Pxa=Math.round(Jf.a.zbn(h-
b));0<this.Dod&&(this.Pxa+=this.Dod-this.Dgd);this.BNg=this.Pxa;this.Pxa+=this.Dgd}BX(){const b=new qi.DictionaryPropertySet;b.setValue(ad.a.aLc,0);b.setValue(ad.a.YJ,this.Pxa);this.ga.Xb(Db.a.imageRotate,2,b)}}Object(r.a)(zn,"ImageRotateDragAdapterSimplified",null,[639,136]);class jn{constructor(){this.W=null}get name(){return"Box4.Images"}zc(b){this.W=b;this.W.ha("Box4.Images.ImageResizeDragAdapter",()=>new Uc(null,u.AFrameworkApplication.ya,Oa.a.instance.Za("Common.IZoomManager"))).as("Box4.Images.IImageResizeDragAdapter").singleInstance();
this.W.ha("Box4.Images.ImageRotateDragAdapterUpdated",()=>new zn(u.AFrameworkApplication.ya,kh.a.instance,Oa.a.instance.Za("Common.IZoomManager"),cb.InteractiveViewManager.instance)).as("Box4.Images.IImageRotateDragAdapter").singleInstance()}init(){this.W.resolve("Box4.Images.IImageResizeDragAdapter");this.W.resolve("Box4.Images.IImageRotateDragAdapter")}dispose(){}static main(){N.a.instance.Pc(new jn)}}Object(r.a)(jn,"Box4ImagesPackage",null,[1,2]);var Yp=d(285),Ji=d(110),ic=d(5),Ve=d(619),Qi=d(311),
wl=d(674),Of=d(20),jl=d(263),Ll=d(256),Zp=d(1693),Ym=d(1747),pn=d(1173);class vm extends Ym.a{constructor(b,h,n){super(b,h,n);this.Bhd=this.O9a=null}get HX(){return u.AFrameworkApplication.ua.iq}sEd(b){switch(b){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}}C3c(b){return vm.Vva(b,this.i_h())}i_h(){return vm.EKe}Vva(b,h=null){b=this.C3c(b);return 0!==b?(h&&h.Apd(),2===b&&(h=this.sEd(b),this.qp(this.GOh(b),
h)),!1):!0}AKa(b,h){w.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.yHf=h;ue.a.mark(5576);this.Bhd=this.HX.fg("LoadResource","PictureUploadTime");this.GLd()?this.W2d(b):this.eTc()}qp(b,h){const n=new yd.StandardDialog;n.Ed=0;n.fy(b,CommonUIStrings.l_ImageUploadFailedTitle,h,null)}eTc(){w.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.eTc();this.Bhd&&(this.Bhd.stop(),this.Bhd=null)}WJb(){this.O9a=(new pn.a).create();this.O9a.message=CommonUIStrings.l_ImageUploadWait;
this.O9a.Ed=5;this.O9a.yt=!1;this.O9a.jM(null,null,null)}kud(){this.O9a&&(this.O9a.close(),this.O9a=null)}static jVl(b,h){b=B.a.mh(b);for(let n=0;n<h.length;++n)if(b.endsWith(h[n]))return!0;return!1}static Vva(b,h=null){h||(h=vm.EKe);return b?vm.jVl(b,h)?0:2:1}}vm.EKe=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(r.a)(vm,"PictureUploader",Ym.a,[]);var Lk;(function(b){b[b.validPicture=0]="validPicture";b[b.noPictureSpecified=1]="noPictureSpecified";b[b.invalidExtension=2]="invalidExtension";
b[b.pictureTooLarge=3]="pictureTooLarge"})(Lk||(Lk={}));Object(r.b)("PictureValidationResult",Lk);var mf=d(58),ie=d(17),Th=d(44);class An{constructor(){this.US=null}}Object(r.a)(An,"ImageData",null,[]);var ri=d(53),kl=d(1694),ek=d(1559),Fm=d(1588);class fo extends Kc.a{constructor(b,h=!0){super(!1,!1,fo.xK);this.lTb=null;this.NCg=!1;this.yx=[];this.Xr=null;this.Q9a=b;this.FSj=h;this.i8=this.K0g=!1;this.wUa=null;this.Zne=!1;this.ug=this.GTk;this.kg="InsertFileDialog";this.We(1,this.Uod);fo.xK?(this.lTb=
{["id"]:this.kg,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,["onExecute"]:Object(v.a)(this,this.SWm,"onUploadButtonClick")}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:Object(v.a)(this,this.BQm,"onFrameReady")},this.Zh(this.titleText,Object(v.a)(this,this.wLd,"insertDialogHandler"),this.lTb),this.sR=!0):(this.showDialog(this.titleText,Object(v.a)(this,this.wLd,"insertDialogHandler")),h&&this.HNn(),(b=this.kDd(1))&&this.yx.push(b),
(b=this.kDd(0))&&this.yx.push(b),this.Vfj(),this.sR=!1)}get Dhj(){return this.Q9a}validate(){this.Xr.US||w.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.Xr.US.value?!0:(fo.fy(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}BQm(b){this.FSj&&(this.Xr=this.ZZi(b,this.Q9a))}SWm(){this.Xr&&this.Xr.US&&(this.NCg||(this.Xr.lkn(Object(v.a)(this,this.WEf,"onFileChosen")),this.NCg=!0),this.Xr.uFh())}WEf(b){this.lTb.uploadStatusLabel=b;this.K7(this.titleText,Object(v.a)(this,
this.wLd,"insertDialogHandler"),this.lTb)}wLd(b){1===b&&this.isEnabled()?fo.xK&&this.Xr.US&&!this.Xr.US.value?(this.lTb.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.K7(this.titleText,Object(v.a)(this,this.wLd,"insertDialogHandler"),this.lTb)):(this.fKd(),this.Q9a.AKa(this.Xr,Object(v.a)(this,this.dispose,"dispose"))):0===b&&this.hide()}HNn(){this.Zne=!1;this.Xr=this.ZZi(document.getElementById("uploadFrameContainer"),this.Q9a);u.AFrameworkApplication.K.$("InsertPictureDialogFocusLoopFixIsEnabled")&&
(this.wUa=Object(v.a)(this,this.zHf,"onUploadFrameLoad"),af.a.addHandler(this.Xr.iFrame,"load",this.wUa));this.Xr.US||w.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.uFi()}zHf(){this.uFi()}uFi(){if(this.Xr&&!this.Zne){var b=this.Xr.US;b&&(af.a.addHandler(b,kb.a.Di,Object(v.a)(this,this.onKeyDown,"onKeyDown")),b=[b],this.yx=b.concat.apply(b,this.yx),this.Vfj(),this.Zne=!0)}}dispose(){if(this.Xr&&!fo.xK){const b=this.Xr.US;b&&af.a.removeHandler(b,kb.a.Di,Object(v.a)(this,
this.onKeyDown,"onKeyDown"));this.wUa&&af.a.removeHandler(this.Xr.iFrame,"load",this.wUa)}this.Xr=null;super.dispose()}Vfj(){if(0<this.yx.length){const b=new jf(this.yx),h=de.FocusManager.instance().Cs();h&&(this.yx[0].focus(),h.Uj=b,h.dX=!0)}}onKeyDown(b){4!==de.FocusManager.instance().yFi(b)&&b.preventDefault()}static get xK(){return u.AFrameworkApplication.ua.Sb.zA&&u.AFrameworkApplication.ua.Sb.Gei}static fy(b){const h=document.getElementById("errorText");h.innerText=b;h.style.display="inline-block"}}
Object(r.a)(fo,"InsertFileDialog",Kc.a,[]);class tg{static get ug(){return Kc.a.Lx(tg.rl,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}tg.rl="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(r.a)(tg,"InsertImageDialogHtml",null,[]);class Wk extends fo{constructor(b,
h=!0){super(b,h)}get Uod(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get GTk(){return tg.ug}validate(){this.Xr.US||w.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var b=Object(ja.a)(vm,this.Dhj);const h=b.C3c(this.Xr.US.value);return 0!==h?(b=b.sEd(h),fo.fy(b),!1):!0}}Object(r.a)(Wk,"InsertImageDialog",fo,[]);class Tn extends Wk{constructor(b){super(b)}ZZi(b,h){const n=u.AFrameworkApplication.ua.Sb.zA&&u.AFrameworkApplication.ua.Sb.Gei;
return new Fm.a(b,Object(v.a)(h,h.v$b,"onUploadFrameInitialized"),Object(v.a)(h,h.Ova,"uploadResponseReceived"),u.AFrameworkApplication.K,!n)}isEnabled(){return Tn.qT.mda(this.Dhj.context)}static get qT(){return null!=Tn.Jjg?Tn.Jjg:Tn.Jjg=Oa.a.instance.resolve("Box4.Images.IImageEditor")}}Object(r.a)(Tn,"Box4InsertImageDialog",Wk,[]);class Un{jDk(b){return new Promise((h,n)=>{this.kDk(b).then(x=>{h(x)},x=>{n(x)})})}Rph(b){return new Promise((h,n)=>{const x=new FileReader;x.addEventListener("load",
()=>{h(x.result)},!1);x.addEventListener("error",()=>{n("FileReader exception ("+x.error.name+")")});x.readAsDataURL(b)})}kDk(b){return new Promise((h,n)=>{this.Rph(b).then(x=>{this.pYe(x,"image/jpeg").then(E=>{h(E)},E=>{n(E)})},x=>{n(x)})})}pYe(b,h){return new Promise((n,x)=>{let E=new Image;E.addEventListener("load",()=>{const S=document.createElement("canvas"),ma=S.getContext("2d");S.width=E.width;S.height=E.height;ma.drawImage(E,0,0);n(S.toDataURL(h))});E.addEventListener("error",()=>{x("Image failed to load")});
E.src=b})}}Object(r.a)(Un,"ImageFormatConverter",null,[]);const Xk=["ImageInsertFailed"];class Yk extends vm{constructor(b,h,n,x,E,S,ma=!0){super(b,h,n);this.bxa=this.em=this.$F=this.Re=null;this.L0b="wwaengidc";this.kpiName="ImageFileExtension";this.Hpc="LocalDeviceUpload";this.GT=new Map;this.BFh=0;this.P9a=null;this.Xne="";this.hpa=0;this.xp=null;this.Dpb="";this.EOg=50;this.kEg=this.Cmc=this.jvc=this.Erc=!1;this.GOg=19922944;this.VQg=0;this.aoe=[];this.MCg=[];this.Sye=0;this.Ecd=!1;this.ff=x;
this.sm=E;this.ga=S;this.CNg=n.$("WACLocalRenderingForInsertLocalImageIsEnabled");this.UOg=n.rc("ImageUploadMaxByteSize",Number.MAX_VALUE);this.Ecd=!!n&&n.getBooleanFeatureGate("Microsoft.Office.WordOnline.PictureUploadSupportsWebp",!1);ma&&this.showDialog();ob.App.Ffc.addHandler(this)}get rci(){return this.K.$("JfifImageInsertIsEnabled")}get A2(){return this.Hpc}get fileExtension(){return this.Xne}get fileSize(){return this.hpa}get Chj(){return this.P9a}get fw(){return this.xp||(this.xp=Oa.a.instance.resolve("Common.Utils.IAriaNotifier"))}get Amf(){return this.A2===
this.Hpc}showDialog(){ek.a(this.K)?(this.y_b=!1,this.Xr=new Fm.a(document.body,Object(v.a)(this,this.v$b,"onUploadFrameInitialized"),Object(v.a)(this,this.Ova,"uploadResponseReceived"),this.K,!1,void 0,!0)):ek.b()||this.fFb&&V.a.UG?(this.y_b=!1,this.Xr=new Fm.a(document.body,Object(v.a)(this,this.v$b,"onUploadFrameInitialized"),Object(v.a)(this,this.Ova,"uploadResponseReceived"),this.K,!1)):(this.y_b=!0,this.Xr=(new Tn(this)).Xr)}GOh(b){switch(b){case Lk.noPictureSpecified:return ri.a.noPictureSpecified;
case Lk.invalidExtension:return ri.a.v4l;case Lk.pictureTooLarge:return ri.a.iki}return Ie.a.unknown}W2d(b){this.Amf||(this.Re.Bi()?(w.ULS.sendTraceTag(36783362,322,50,"Box4PictureUploader.ReplicatePlaceholder"),kl.a.instance.T7f(this.Re.Bi()),this.Re.Bi().contentReplicator.forceOutbound(Object(v.a)(this,this.tGf,"onPlaceholderNodeSaved"),Object(v.a)(this,this.Z0a,"processFailure"),b)):this.Z0a(b,157))}ngm(){return ek.c(this.Re)}tGf(b){w.ULS.sendTraceTag(36783363,322,50,"Box4PictureUploader.OnPlaceholderNodeSaved");
if(b){var h={},n=this.$F?this.$F.properties.Qc.toString():this.Re.Qc.toString();h[Qi.a.nodeId]=this.$F?this.$F.id.toString():this.Re.id.toString();h[Qi.a.classId]=n;this.ff.hasProperty(ic.a.imageType)&&(h[Ve.a.imageType]=this.ff.getValue(ic.a.imageType));this.ff.hasProperty(ic.a.pT)&&(h[Ve.a.pT]=this.ff.getValue(ic.a.pT));this.ff.hasProperty(Ji.a.Qda)&&(h[Ve.a.Qda]=this.ff.getValue(Ji.a.Qda));Of.a.instance.J(4)&&this.ff.hasProperty(ic.a.Pgb)&&(h[Ve.a.Pgb]=this.ff.getValue(ic.a.Pgb));ek.d(b,this.Re,
this.em,h)&&(this.B0c(b),Yk.F9b++)}else w.ULS.sendTraceTag(16869584,352,15,"InsertPicture:UploadFrame is null")}B0c(b){b.B0c();this.P9a=b.P9a}Ova(b){this.BFh=+new Date-+this.Chj;this.fSd();w.ULS.sendTraceTag(36783364,322,50,"Box4PictureUploader.UploadResponseReceived");ek.e(this,b,this.Re)}Yko(){w.ULS.sendTraceTag(36783365,322,50,"Box4PictureUploader.UploadComplete");this.eTc();Yk.F9b--;this.ga.processAction(Ra.a.K3a,2);this.Re?kl.a.instance.Rgc(this.Re.Bi(),0):w.ULS.sendTraceTag(42468439,339,50,
"Not able to notify upload notifier for completion");this.fw.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)}Z0a(b,h){if(this.Own(b))w.ULS.sendTraceTag(16798870,352,50,"InsertPicture:OutboundRetry:Retry={0}:Error={1}",this.retryCount,h.toLocaleString());else{b=Object.assign(new ab.a,{extendedProperties:new Map});b.extendedProperties.set("result",h.toLocaleString());ta.Health.instance.recordQosError("PictureFromLocalUploadRequestFailed",Xk,!1,!0,!1,!1,b);b=this.i6e(h);w.ULS.sendTraceTag(16798871,
352,10,"InsertPicture:Failure:Retries={0}:Error={1}",this.retryCount,h.toLocaleString());var n=this.Re.MG(),x=new Se.GraphTransaction(15,Db.a.fQ);x.Db(this.Re);Yk.qT.$Oa(this.ff,b);Yk.qT.wMi(this.Re,this.$F);Pd.ImageReader.MXi(this.ff);x.dispose();this.j3i(b);this.sm.FYb(n,!1);this.eTc();Yk.F9b--;kl.a.instance.Rgc(this.Re.Bi(),h)}}j3i(b){const h=new yd.StandardDialog;h.Ed=0;h.fy(ri.a.invalidImageFile,CommonUIStrings.l_ImageUploadFailedTitle,b,null)}i6e(b){switch(b){case 23:return Box4Intl.Box4Strings.l_ImageUploadSizeError;
default:return Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord}}Bpj(b){return new Promise(h=>{const n=new FileReader;n.addEventListener("load",()=>{n.result.length>this.GOg?this.ali():(this.Dpb+=String.format('<img src="{0}"></img>',n.result),this.Sye++);h()},!1);n.addEventListener("error",()=>{w.ULS.sendTraceTag(545093780,322,10,"Box4PictureUploader.PopulateImagePasteHTML fileReader error {0}",n.error);h()});n.readAsDataURL(b)})}Vnj(){if(this.Dpb&&0<this.Dpb.length){const b=new qi.DictionaryPropertySet;
b.setValue(ad.a.$T,this.Dpb);b.setValue(ad.a.H$,!0);this.ga.Xb(Db.a.u1,2,b)}this.NUn()}NUn(){let b="";this.kEg?b=Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord:this.Erc&&this.Cmc&&this.jvc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatSizeAndMaxNumberExceededError:this.Erc&&this.Cmc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatAndMaxNumberExceededError:this.Erc&&this.jvc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndMaxNumberExceededError:this.jvc&&this.Cmc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndFormatError:
this.jvc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeError:this.Cmc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatError:this.Erc&&(b=Box4Intl.Box4Strings.l_MultipleImageUploadMaxNumberExceededError);""!==b&&(this.j3i(b),this.Eoj())}h4j(b){this.Dpb+=String.format('<img src="{0}"></img>',b);this.Sye++}ali(){this.jvc=!0;w.ULS.sendTraceTag(524873990,322,10,"Image too large");const b=Object.assign(new ab.a,{extendedProperties:new Map});b.extendedProperties.set("type","Image too large");ta.Health.instance.recordQosError("PictureFromLocalInvalid",
Xk,!0,!0,!1,!1,b)}$ki(){this.Cmc=!0;w.ULS.sendTraceTag(545093781,322,10,"Image filetype not supported");const b=Object.assign(new ab.a,{extendedProperties:new Map});b.extendedProperties.set("type","Filetype invalid");ta.Health.instance.recordQosError("PictureFromLocalInvalid",Xk,!0,!0,!1,!1,b)}Wki(b){this.kEg=!0;w.ULS.sendTraceTag(524873991,322,15,"Something went wrong during paste with format conversion: {0}",b)}j_n(b){const h=new Un;if(this.C3c(b.name)===Lk.validPicture)return h.Rph(b);if(vm.Vva(b.name,
Fm.a.FKe)===Lk.validPicture)return h.jDk(b)}sDk(b){return new Promise(h=>{const n=this.j_n(b);void 0===n&&(this.Wki("Failed starting conversion work"),h());n.then(x=>{x.length>this.GOg?this.ali():this.h4j(x);h()},x=>{this.Wki(x);h()})})}Ykm(b){return this.C3c(b.name)===Lk.validPicture||vm.Vva(b.name,Fm.a.FKe)===Lk.validPicture}K3l(){const b=[];if(this.Xr.US.files){this.VQg=this.Xr.US.files.length;this.Xr.US.files.length>this.EOg&&(this.Erc=!0);this.Ecd&&this.WJb();for(let h=0;h<this.Xr.US.files.length&&
this.EOg;h++){const n=this.Xr.US.files[h];this.aoe.push(n.name);this.MCg.push(n.size);n&&(this.Ecd?this.Ykm(n)?b.push(this.sDk(n)):this.$ki():this.C3c(n.name)!=Lk.validPicture?this.$ki():b.push(this.Bpj(n)))}}Promise.all(b).then(()=>{this.Ecd&&this.kud();this.Vnj()});return!0}x4l(){this.em=na.a.create();this.ff||(this.ff=new qi.DictionaryPropertySet);this.CNg&&this.bxa&&this.ff.setValue(Ji.a.pki,this.bxa);var b=480;let h=320;var n=this.context.view;this.K.$("WordEditorAutoResizeImageIsEnabled")&&
(n=n.Ug.editingElement.clientWidth,0<n&&n<b&&(h=Math.floor(1*n/b*h),b=n,this.ff.setValue(Ji.a.Qda,n)));this.ff.setValue(ie.a.cfa,mf.a.jn(b,0));this.ff.setValue(ie.a.fma,mf.a.jn(h,1));this.ff.setValue(Th.a.wZ,1);this.ff.setValue(ad.a.H$,!0);Of.a.instance.J(4)&&this.ff.setValue(ic.a.Pgb,Box4Intl.Box4Strings.l_Picture);b=Yk.qT.hzh(this.context,this.ff,this.em);if(!b)return!1;this.Re=b.node;this.ff=(this.$F=b.blob)?this.$F.properties:this.Re.properties;Of.a.instance.J(4)&&ob.App.rd.Kp&&ob.App.rd.Jq.sG(this.Re);
return!0}GLd(){return this.Amf?this.K3l():this.x4l()}Eoj(){this.GT.set("FileExtensions",this.ykl());this.GT.set("FileSizeInBytes",this.MCg.toString());this.GT.set("Source",this.A2);this.GT.set("NumberOfImagesAttemptedToInsert",this.VQg.toString());this.GT.set("NumberOfImagesPasted",this.Sye.toString());ta.Health.instance.recordKpiUsage("MultipleImageInsert",0,this.L0b,this.GT)}ykl(){let b="";for(let h=0;h<this.aoe.length;++h)b=b+this.XOh(this.aoe[h])+",";return b}AKa(b,h){this.CNg&&(this.bxa=new An,
this.bxa.US=b.US);super.AKa(b,h)}v$b(b){this.Xr=b;if(!this.y_b){if(this.Zbe){if(ek.a(this.K)||this.fFb&&V.a.UG){b.Iyd(Object(v.a)(this,this.lQm,"onFileChosen$2"));return}const h=b.Iyd(null),n=this.YOh(b);n&&(this.Xne=n.name,this.hpa=n.size);if(!this.Vva(h,b)||!this.I8f(n,b)){b=Object.assign(new ab.a,{extendedProperties:new Map});b.extendedProperties.set("type",this.Vva(h,this.Xr)?"Image too large":"FileType invalid");ta.Health.instance.recordQosError("PictureFromLocalInvalid",Xk,!0,!0,!1,!1,b);this.fSd();
return}}this.AKa(b,null)}}lQm(b){if(!this.Amf){var h=this.YOh(this.Xr);h&&(this.Xne=h.name,this.hpa=h.size);if(!this.Vva(b,this.Xr)||!this.I8f(h,this.Xr)){h=Object.assign(new ab.a,{extendedProperties:new Map});h.extendedProperties.set("type",this.Vva(b,this.Xr)?"Image too large":"FileType invalid");ta.Health.instance.recordQosError("PictureFromLocalInvalid",Xk,!0,!0,!1,!1,h);this.fSd();return}}this.AKa(this.Xr,null)}TJd(){return!!Yk.F9b}fSd(){this.GT.set("FileExtension",this.XOh(this.fileExtension));
this.GT.set("Source",this.A2);this.GT.set("FileSizeInBytes",this.fileSize.toString());this.GT.set("RequestTimeInMs",this.BFh.toString());ta.Health.instance.recordKpiUsage(this.kpiName,0,this.L0b,this.GT)}XOh(b){return b&&(b=b.split("."),1<b.length)?b[b.length-1].substring(0,4):""}i_h(){return this.rci?Fm.a.D3g:vm.EKe}YOh(b){return(b=b.US)?b.files[0]:null}I8f(b,h){return b&&b.size>this.UOg?(h&&h.Apd(),b=this.sEd(Lk.pictureTooLarge),this.qp(this.GOh(Lk.pictureTooLarge),b),!1):!0}sEd(b){switch(b){case Lk.noPictureSpecified:return CommonUIStrings.l_ImageUploadNoFileSpecified;
case Lk.invalidExtension:return this.rci?CommonUIStrings.l_WordImageUploadUnsupportedFileType:CommonUIStrings.l_ImageUploadUnsupportedFileType;case Lk.pictureTooLarge:return String.format(CommonUIStrings.l_ImageUploadSizeErrorWithLimit,Math.round(this.UOg/1E6));default:return""}}static get qT(){return null!=Yk.Ijg?Yk.Ijg:Yk.Ijg=Oa.a.instance.resolve("Box4.Images.IImageEditor")}}Yk.F9b=0;Object(r.a)(Yk,"Box4PictureUploader",vm,[725,573]);var Gm=d(811),Gl=d(164);class go{constructor(){this.Yq=this.zp=
this.Zrb=this.A1g=this.g6c=this.Twj=null;this.FDe=0;this.Voa=this.Oye=this.nsb=null;this.Gxg=0;this.Lge=this.I8=this.kve=null;this.jIg=!1;this.Ufe=this.Qfe=this.Vfe=null}get assetId(){return this.g6c}get thumbnailUrl(){return this.A1g}get G6m(){return this.Zrb}get displayName(){return this.Voa}get dimensions(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,this.zp,this.Yq)}get i8j(){if(this.Qfe&&this.Ufe&&this.Vfe){const b=document.createElement("a");b.setAttribute("href",this.Vfe);
b.setAttribute("target","_blank");b.innerText=this.Ufe;return b}return null}get I9g(){return this.Qfe}get fileSize(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this.Gxg)}get kdn(){const b=document.createElement("span");var h=0;if(this.nsb&&0<this.nsb.length){var n=this.nsb.indexOf("."),x=0>n?this.nsb:this.nsb.substring(0,n);for(x=Number.parseInvariant(x);h<x&&5>h;h++)b.appendChild(Tg.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Gl.a.Sh("box42.png"),"","",
!0,""));0<n&&(n=Number.parseInvariant(this.nsb.substr(n+1)),3>n?b.appendChild(Tg.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Gl.a.Sh("box42.png"),"","",!0,"")):8>n?b.appendChild(Tg.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",Gl.a.Sh("box42.png"),"","",!0,"")):b.appendChild(Tg.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Gl.a.Sh("box42.png"),"","",!0,"")),h++)}for(;5>h;h++)b.appendChild(Tg.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8",
"box42",Gl.a.Sh("box42.png"),"","",!0,""));this.Oye&&(h=document.createElement("span"),h.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this.Oye),b.appendChild(h));return b}get ivn(){return 0<this.FDe?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this.FDe):""}get Aek(){if(this.jIg){var b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity;return b}if(this.Lge&&this.I8)return go.PIk(this.Lge,this.I8);b=document.createElement("span");
b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft;return b}get keywords(){let b;if(this.kve){const h=this.kve.split(",");b=Array(h.length);for(let n=0;n<h.length;n++)b[n]=h[n].trim()}else b=[];return b}static zcl(b){const h=new go;for(let n=0;n<b.childNodes.length;n++){const x=b.childNodes[n];if(1===x.nodeType)try{const E=x.firstChild.nodeValue;switch(x.nodeName){case "src":h.Twj=E;break;case "assetid":h.g6c=E;break;case "thumb":"64x64"===x.attributes.getNamedItem("size").nodeValue?h.A1g=
go.rbj(E):"192x192"===x.attributes.getNamedItem("size").nodeValue&&(h.Zrb=go.rbj(E));break;case "imagedim":if(E){const ma=E.indexOf("x");0<ma&&ma<E.length&&(h.zp=E.substr(0,ma),h.Yq=E.substr(ma+1))}break;case "resolution":h.FDe=Number.parseInvariant(E);break;case "rating":h.nsb=E;break;case "numofratings":h.Oye=E;break;case "displayname":h.Voa=E;break;case "contentlength":h.Gxg=Number.parseInvariant(E)/1024;break;case "subject":h.kve=E;break;case "provider":h.I8=E;break;case "attributionlink":h.Lge=
E;break;case "iscsc":h.jIg=1===Number.parseInvariant(E);break;case "additional":const S=x.firstChild;if(x.hasChildNodes()&&S&&"id"===S.nodeName&&1===Number.parseInvariant(S.text))for(let ma=0;ma<x.childNodes.length;ma++){const Fa=x.childNodes[ma];switch(Fa.nodeName){case "caption":h.Qfe=Fa.text;break;case "value":h.Vfe=Fa.text;break;case "string":h.Ufe=Fa.text}}}}catch(E){}}return h}static PIk(b,h){const n=document.createElement("a");n.setAttribute("href",b);n.setAttribute("target","_blank");n.innerText=
h;return n}static rbj(b){let h;return b&&0<(h=b.indexOf("://"))?b.substr(h+1):b}}Object(r.a)(go,"ClipArtSearchResult",null,[]);class Dq{static get ug(){return Kc.a.Lx(Dq.rl,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)}}Dq.rl="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>";
Object(r.a)(Dq,"InsertClipartDialogHtml",null,[]);class Yo extends Kc.a{constructor(b){super();this.$wa=this.Apb=0;this.PUg=null;this.SBe=!1;this.WSb=this.mTa=this.QM=null;this.ryi=h=>{const n=this.yV.value;n&&0<n.trim().length&&(this.search(this.yV.value),this.rga(1,!1));h.preventDefault();h.stopPropagation()};this.dVm=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.ryi(h),h.preventDefault(),h.stopPropagation())};this.syi=h=>{100<=this.yV.value.length&&(h.preventDefault(),h.stopPropagation())};
this.LTm=h=>{h=Number.parseInvariant(h.target.parentNode.id.substr(4));this.IEi(h);this.BWf(h)};this.onScroll=()=>{if(this.ar&&this.ar.children&&!(2>this.ar.children.length)){var h=this.ar.children[0].children[0],n=this.ar.clientHeight-(h.clientHeight-h.children[0].clientHeight+2)+this.ar.scrollTop,x=h.clientHeight+2,E=parseInt(String(this.ar.scrollTop/x));h=parseInt(String(n/x));var S=parseInt(String(this.ar.clientWidth/x));h<n/x&&h<parseInt(String(this.QM.length/S))&&h++;for(n=E;n<h;n++)for(x=0;x<
S;x++){var ma=n*S+x;E=this.QM[ma];(ma=document.getElementById("clip"+ma))&&!ma.childNodes.length&&(E=this.guh(E),ma.appendChild(E))}}};this.iWm=h=>{h.target.setAttribute("src",Gl.a.Sh("phthumb.64x64x32.png"))};this.MTm=h=>{h.target.setAttribute("src",Gl.a.Sh("phpreview.96x96x32.png"))};this.$vi=h=>{rd.a.ym(h.target.attributes.getNamedItem("href").value,h.target.attributes.getNamedItem("target").value,void 0,"InsertClipartDialog");h.stopPropagation();h.preventDefault()};this.iRm=h=>{(h?h.keyCode:window.event.keyCode)===
Sys.UI.Key.enter&&this.$vi(h)};this.swi=h=>{const n=h.target.innerText;this.yV&&(this.yV.value=n);this.search(n);h.stopPropagation();h.preventDefault();this.rga(1,!1)};this.RRm=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.swi(h)};this.uyi=h=>{this.QM&&(this.lBn(this.QM[this.Apb]),h.stopPropagation(),h.preventDefault(),this.yV.value="",this.rga(1,!1))};this.eVm=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.uyi(h)};this.onKeyDown=h=>{if(h.keyCode>=Sys.UI.Key.left&&
h.keyCode<=Sys.UI.Key.down){let n=0;switch(h.keyCode){case Sys.UI.Key.up:n=-5;break;case Sys.UI.Key.down:n=5;break;case Sys.UI.Key.left:n=-1;break;case Sys.UI.Key.right:n=1}this.$wa=this.$wa+n<this.ar.children.length-1?0>this.$wa+n?0:this.$wa+n:this.ar.children.length-1;this.BWf(this.$wa);h.preventDefault();h.stopPropagation()}else h.keyCode===Sys.UI.Key.enter?(h=Number.parseInvariant(h.target.id.substr(4)),0<=h&&h<this.ar.children.length&&this.xUi(h)):h.keyCode===Sys.UI.Key.tab&&(this.$wa=h.shiftKey?
Math.max(0,this.$wa-1):Math.min(this.$wa+1,this.ar.children.length-1))};this.onError=()=>{this.ar&&(this.ar.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)};this.PFi=h=>{if(this.ar)if(h.data.gga){var n=h.data.gga.lastChild.childNodes;this.QM||(this.QM=[]);for(h=0;h<n.length&&100>this.QM.length;h++){var x=n[h];1===x.nodeType&&"image"===x.nodeName&&(x=go.zcl(x),this.QM.push(x))}this.Uyh();this.QM.length||(this.ar.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(h.data.Ee){h=B.a.d7i(h.data.Ee);
try{n=parseInt(h)}catch(E){n=14}this.ar.innerText=26===n?Box4Intl.Box4Strings.l_ClipartCannotConnect:Box4Intl.Box4Strings.l_ClipartNoResultsFound}};this.Uyh=()=>{if(this.QM){Ke.a.YY(this.ar);this.mTa&&(this.mTa.dispose(),this.mTa=null);this.ar.focus();this.ar.classList.remove("ClipartSearchInProgress");for(let n=0;n<this.QM.length;n++){var h=document.createElement("a");h.setAttribute("href","#");h.id="itab"+n;const x=document.createElement("span");x.id="clip"+n;x.classList.add("ClipartImageContainer");
h.appendChild(x);this.ar.appendChild(h);n<parseInt(String(this.ar.clientHeight/x.clientHeight))*parseInt(String(this.ar.clientWidth/x.clientWidth))&&(h=this.guh(this.QM[n]),x.appendChild(h))}this.SBe&&(this.xUi(this.Apb),this.BWf(this.Apb))}};this.f3l=h=>{1===h&&this.QM&&Yo.qT.mda(this.Ewg.context)&&(h=this.QM[this.Apb])&&this.Ewg.gEa(h)};this.Ewg=b;this.ug=Dq.ug;this.kg="InsertClipartDialog";this.We(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText);this.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,
this.f3l);this.ar=document.getElementById("clipartsearchresults");this.ekd=this.onKeyDown;af.a.addHandler(this.ar,"keydown",this.ekd);this.dkd=this.onScroll;af.a.addHandler(this.ar,"scroll",this.dkd);this.yV=document.getElementById("textInput");this.Gmd=this.dVm;af.a.addHandler(this.yV,"keydown",this.Gmd);this.Hmd=this.syi;af.a.addHandler(this.yV,"keypress",this.Hmd);this.Imd=this.syi;af.a.addHandler(this.yV,"paste",this.Imd);this.ojc=document.getElementById("btnSearch");this.ojc.setAttribute("src",
Gl.a.Sh("search.16x16x32.png"));this.bkd=this.ryi;af.a.addHandler(this.ojc,"click",this.bkd);this.bPb=document.getElementById("clipartpreviewimage");this.fme=document.getElementById("clipartattributedisplayname");this.$5a=document.getElementById("clipartseesimilar");this.eme=document.getElementById("clipartdimensions");this.Llc=document.getElementById("clipartadditionalvalue");this.ime=document.getElementById("clipartratingvalue");this.vRa=document.getElementById("clipartattributionvalue");this.wRa=
document.getElementById("clipartkeywords");this.cme=document.getElementById("clipartadditionalname");this.jme=document.getElementById("clipartratingname");this.dme=document.getElementById("clipartattributionname");this.UBe=this.LTm;this.HIe=this.iWm;this.bbd=this.$vi;this.cbd=this.iRm;this.ive=this.swi;this.jve=this.RRm;this.hkd=this.uyi;this.ikd=this.eVm;this.yV.focus();this.rga(1,!1)}dispose(){this.ar&&this.glh();this.ar&&this.ekd&&(af.a.removeHandler(this.ar,"keydown",this.ekd),this.ekd=null);
this.ar&&this.dkd&&(af.a.removeHandler(this.ar,"scroll",this.dkd),this.dkd=null);this.ar=null;this.yV&&this.Gmd&&(af.a.removeHandler(this.yV,"keydown",this.Gmd),this.Gmd=null);this.yV&&this.Hmd&&(af.a.removeHandler(this.yV,"keypress",this.Hmd),this.Hmd=null);this.yV&&this.Imd&&(af.a.removeHandler(this.yV,"paste",this.Imd),this.Imd=null);this.yV=null;this.ojc&&this.bkd&&(af.a.removeHandler(this.ojc,"click",this.bkd),this.ojc=this.bkd=null);this.dme=this.jme=this.cme=this.wRa=this.vRa=this.ime=this.Llc=
this.eme=this.$5a=this.fme=this.bPb=this.ikd=this.hkd=this.jve=this.ive=this.cbd=this.bbd=this.WSb=this.HIe=this.UBe=null;this.mTa&&(this.mTa.dispose(),this.mTa=null);super.dispose()}nO(){super.nO();document.getElementById(this.pj("WACDialogPanel")).style.width=String.format("{0}px",656)}search(b){this.LIb(b,!1,this.PFi)}LIb(b,h,n){this.$wa=this.Apb=0;this.glh();if(this.QM&&b===this.PUg&&this.SBe===h)window.setTimeout(this.Uyh,500);else{this.QM&&(Array.clear(this.QM),this.QM=null);this.PUg=b;this.SBe=
h;var x=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');x.append("<query>");x.append(B.a.If(b));x.append("</query>");x.append("<mediatype>Illustration</mediatype>");x.append("<mediatype>Photo</mediatype>");x.append("<filetype>jpg</filetype>");x.append("<filetype>jpeg</filetype>");x.append("<filetype>gif</filetype>");x.append("<filetype>bmp</filetype>");x.append("<filetype>tif</filetype>");x.append("<filetype>tiff</filetype>");x.append("<filetype>png</filetype>");x.append("</search>");
b=u.AFrameworkApplication.lcid.toString(16).toUpperCase();for(let E=b.length;4>E;E++)b="0"+b;u.AFrameworkApplication.Ze.Lj(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",ob.App.webServiceBase,b,Ve.a.gXn,h.toString()),2,x.toString(),{"Content-Type":"text/xml; charset=utf-8"},!0,2,n,this.onError,null)}}lBn(b){this.LIb(b.assetId,!0,this.PFi);this.QM||(this.QM=[],this.QM.push(b))}guh(b){const h=document.createElement("img");h.classList.add("ClipartThumbImage");h.setAttribute("src",
b.thumbnailUrl);b=b.displayName?b.displayName:Box4Intl.Box4Strings.l_ClipartImageAltNoCaption;h.setAttribute("title",b);h.setAttribute("alt",b);af.a.addHandler(h,"click",this.UBe);af.a.addHandler(h,"error",this.HIe);return h}wRk(b){1===b.childNodes.length&&(b=b.childNodes[0],af.a.removeHandler(b,"click",this.UBe),af.a.removeHandler(b,"error",this.HIe))}IEi(b){const h=this.QM[b];var n=h.G6m;this.elh();this.WSb=this.MTm;var x=document.createElement("img");x.setAttribute("src",n);if(h.displayName)n=
String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,h.displayName);else{n=new Sys.StringBuilder;for(let E=0;E<h.keywords.length&&5>E;E++)E&&n.append(", "),n.append(h.keywords[E]);n=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,n.toString())}x.setAttribute("title",n);x.setAttribute("alt",n);af.a.addHandler(x,"error",this.WSb);this.bPb.appendChild(x);x=document.getElementById("clip"+this.Apb);x.classList.remove("ClipartSelectedImage");x=document.getElementById("clip"+
b);x.classList.add("ClipartSelectedImage");this.Apb=b;h.displayName&&(this.fme.innerText=h.displayName);b=document.createElement("a");b.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink;b.setAttribute("href",'""');af.a.addHandler(b,"click",this.hkd);af.a.addHandler(b,"keydown",this.ikd);this.$5a.appendChild(b);this.eme.innerText=String.format("{0} | {1} | {2}",h.dimensions,h.ivn,h.fileSize);(b=h.i8j)&&h.I9g?(this.Llc.parentNode.style.display="block",this.cme.innerText=h.I9g,this.Llc.appendChild(b)):
this.Llc.parentNode.style.display="none";this.ime.appendChild(h.kdn);Ke.a.YY(this.vRa);if(b=h.Aek)this.vRa.appendChild(b),"a"===b.nodeName.toLowerCase()&&(af.a.addHandler(b,"click",this.bbd),af.a.addHandler(b,"keydown",this.cbd));this.wRa.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(b=0;b<h.keywords.length;b++)x=h.keywords[b],n=document.createElement("a"),n.innerText=x,n.setAttribute("href",'""'),af.a.addHandler(n,"click",this.ive),af.a.addHandler(n,"keydown",this.jve),this.wRa.appendChild(n),
b<h.keywords.length-1&&(x=document.createElement("span"),x.innerText=", ",this.wRa.appendChild(x));this.jme.innerText=Box4Intl.Box4Strings.l_ClipartRating;this.dme.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy;this.rga(1,!0)}elh(){this.bPb&&1===this.bPb.childNodes.length&&(this.WSb&&(af.a.removeHandler(this.bPb.childNodes[0],"error",this.WSb),this.WSb=null),Ke.a.YY(this.bPb));this.vRa&&0<this.vRa.childNodes.length&&"a"===this.vRa.childNodes[0].nodeName.toLowerCase()&&(this.bbd&&af.a.removeHandler(this.vRa.childNodes[0],
"click",this.bbd),this.cbd&&af.a.removeHandler(this.vRa.childNodes[0],"keydown",this.cbd));this.$5a&&0<this.$5a.children.length&&"a"===this.$5a.children[0].nodeName.toLowerCase()&&(this.hkd&&af.a.removeHandler(this.$5a.children[0],"click",this.hkd),this.ikd&&af.a.removeHandler(this.$5a.children[0],"keydown",this.ikd),Ke.a.YY(this.$5a));if(this.wRa){for(let b=0;b<this.wRa.childNodes.length;b++){const h=this.wRa.childNodes[b];"a"===h.nodeName.toLowerCase()&&(af.a.removeHandler(h,"click",this.ive),af.a.removeHandler(h,
"keydown",this.jve))}Ke.a.YY(this.wRa)}this.fme.innerText="";this.eme.innerText="";Ke.a.YY(this.Llc);Ke.a.YY(this.ime);Ke.a.YY(this.vRa);this.wRa.innerText="";this.cme.innerText="";this.jme.innerText="";this.dme.innerText=""}xUi(b){if(!(this.ar.children.length<=b||0>b)){var h=this.ar.children[b],n=this.ar.children[0];n=n.clientHeight-n.children[0].clientHeight+2;this.ar.scrollTop+this.ar.clientHeight<h.offsetTop+h.clientHeight?this.ar.scrollTop=h.offsetTop-3*h.clientHeight-n:this.ar.scrollTop>h.offsetTop&&
(this.ar.scrollTop=h.offsetTop-n/2);this.IEi(b)}}validate(){return!0}glh(){if(de.FocusManager.YI()){var b=de.FocusManager.instance().getRegion(this.PJ);b&&b.Uj.hy(this.yV)}else this.yV.focus();for(b=0;b<this.ar.childNodes.length;b++){const h=this.ar.childNodes[b];1===h.childNodes.length&&this.wRk(h.childNodes[0])}Ke.a.YY(this.ar);this.elh();this.rga(1,!1);this.mTa=new Gm.a(Box4Intl.Box4Strings.l_ClipartSearching);this.mTa.Gfi=!1;this.ar.appendChild(this.mTa.element);this.ar.classList.add("ClipartSearchInProgress")}BWf(b){this.$wa=
b;b=this.ar.children[this.$wa];de.FocusManager.YI()?de.FocusManager.instance().getRegion(this.PJ).Uj.hy(b):b.focus()}static get qT(){return Yo.hj=Yo.hj||Oa.a.instance.resolve("Box4.Images.IImageEditor")}}Yo.hj=null;Object(r.a)(Yo,"InsertClipartDialog",Kc.a,[]);class Ml extends Yk{constructor(b,h,n,x,E,S){super(b,h,n,x,E,S,!1);this.ATm=ma=>{if(this.ngm()){var Fa=this.Re.Bi(),$a=Fa.contentReplicator.$t.toString(),sb=new Sys.Net.WebRequest;sb.set_url("ClipArtUpload.ashx");sb=new Sys.StringBuilder(sb.getResolvedUrl());
this.KV(sb,Ve.a.assetId,ma.assetId,!0);this.KV(sb,Qi.a.lcid,u.AFrameworkApplication.lcid.toString());this.KV(sb,Qi.a.nodeId,this.$F?this.$F.id.toString():this.Re.id.toString());this.KV(sb,Qi.a.cellId,Fa.Zl.toString());this.KV(sb,Qi.a.fileId,Fa.Bs);this.KV(sb,Qi.a.gra,$a);this.KV(sb,Qi.a.K1,this.em.toString());ma=Ll.a.Bq;Of.a.instance.J(4)&&(ma=this.Re.ia(Ji.a.gK,Ll.a.Bq));this.KV(sb,Qi.a.gK,ma.toString());this.KV(sb,Qi.a.kmb,"1");Fa.YH&&this.KV(sb,Qi.a.YH,Fa.YH);this.KV(sb,Qi.a.classId,this.$F?this.$F.properties.Qc.toString():
this.Re.Qc.toString());this.ff.hasProperty(ic.a.imageType)&&this.KV(sb,Ve.a.imageType,this.ff.getValue(ic.a.imageType).toString());jl.a.instance.p4j(sb);u.AFrameworkApplication.Ze.Lj(sb.toString(),2,"",{},!1,2,this.Zko,this.uploadFailed,null);Yk.F9b++}};this.Zko=ma=>{if(({group:Fa}=wl.a.G7(ma.data.Ee)).returnValue){var Fa=Fa.Responses[0];Fa.jjb=ma.data.TG;Fa.Rt=ma.data.qj?ma.data.qj[Yp.a.I5]:"";this.Ova(Fa)}else this.uploadFailed(null)};this.uploadFailed=()=>{const ma=new Zp.a;ma.StatusCode=14;this.Ova(ma)};
new Yo(this)}gEa(b){this.GLd()&&this.Re.Bi().contentReplicator.forceOutbound(this.ATm,null,b)}KV(b,h,n,x){b.append(x?"?":"&");b.append(B.a.Ij(h));b.append("=");b.append(B.a.Ij(n))}i6e(b){switch(b){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;default:return super.i6e(b)}}Ova(b){super.Ova(b);Yk.F9b--}}Object(r.a)(Ml,"ClipartUploader",Yk,[]);class Mj{constructor(b,h,n){this.g3l=(x,E,S,ma,Fa)=>{if(!this.hj||!this.hj.value)return w.ULS.sendTraceTag(524109267,
306,15,"ImageEditor not available"),8;x=this.hj.value.mda(E);return 2===S&&x?(new Ml(E,Ye.a.instance,u.AFrameworkApplication.K,Fa,this.sm,this.ga),32):1===S?x&&ob.App.Wlh?32:8:2};this.hj=b;this.sm=h;this.ga=n}Vb(){this.ga.gb(Db.a.b7h,cc.a.view,this.g3l,260)}}Object(r.a)(Mj,"ClipArtActor",null,[]);class ll{constructor(){this.W=null}get name(){return"Box4.ClipArt"}zc(b){this.W=b;b.ha("Box4.ClipArt.ClipArtActor",()=>new Mj(b.Ye("Box4.Images.IImageEditor"),b.resolve("Box4.IUndoManager"),u.AFrameworkApplication.ya)).singleInstance()}init(){this.W.resolve("Box4.ClipArt.ClipArtActor").Vb();
const b=ob.App.xa;b&&b.updateCommandUI()}dispose(){}}Object(r.a)(ll,"ClipartPackage",null,[1,2]);class qo{constructor(b){this.ITa=this.sTa=this.NTa=this.MTa=null;this.zFg=this.kMg=this.zh=this.q8=!1;this.sDe=this.PMg=null;this.BMg=0;this.Ma=this.KMg=null;this.q4=b;this.dR=3;this.Roc=!0}initialize(b,h,n){this.MTa=this.Wff(b,h);this.NTa=CommonUIStrings.l_SavingStatus;this.sTa=CommonUIStrings.l_ReadOnlyStatus;this.ITa=CommonUIStrings.l_ReviewModeStatus;this.q4&&this.q4.execute(x=>{x.Rub(Object(v.a)(this,
this.X2c,"updateToSavingStatus"))});this.zh=!0;this.Ma=n;return!0}Vlb(b,h){this.q8=b;this.dR=h;this.jQa(this.Roc)}jQa(b){!this.Roc&&b&&(this.KMg=new Date);this.Roc=b;b=null;3===this.dR&&(b=this.Roc?this.MTa:this.NTa);this.EVk(b)}Wff(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}X2c(){this.jQa(!1)}mxl(){switch(this.dR){case 1:return this.sTa;case 2:return this.ITa;
default:return null}}N$l(b){return this.kMg===this.q8&&this.BMg===this.dR&&this.PMg===b}d3e(b){appChrome.getHeaderApi().then(h=>{h.updateDocumentTitleStatus(this.q8,b,this.mxl(),this.KMg,this.Roc);this.zFg=!0;return null});this.sDe=null}EVk(b){this.zh&&Mg.c()&&!this.N$l(b)&&(!this.zFg&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.d3e(b):rd.a.vSf()?(this.sDe&&w.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),
this.sDe=window.requestIdleCallback(()=>{this.d3e(b)})):window.requestAnimationFrame(()=>{this.d3e(b)}),this.kMg=this.q8,this.PMg=b,this.BMg=this.dR)}}Object(r.a)(qo,"ReactSaveStatusUIHandler",null,[724]);class wm{constructor(b,h){this.EW=null;this.MTa=CommonUIStrings.l_SavedStatus;this.NTa=CommonUIStrings.l_SavingStatus;this.sTa=CommonUIStrings.l_ReadOnlyStatus;this.ITa=CommonUIStrings.l_ReviewModeStatus;this.Q6a=h;this.q4=b;this.dR=3;this.Z8a=!0}HA(){this.q4&&this.q4.execute(b=>{b.Rub(Object(v.a)(this,
this.X2c,"updateToSavingStatus"))});this.Q6a.execute(b=>{this.EW=b})}Vlb(b,h){this.dR=h;3===h?this.jQa(this.Z8a):2===h?this.I5f(this.ITa):this.I5f(this.sTa)}X2c(){this.jQa(!1)}jQa(b){this.Z8a=b;this.I5f(this.Z8a?this.MTa:this.NTa)}I5f(b){this.EW&&this.EW.sendMessage(F.a.lbo,this.uBk(b))}uBk(b){const h={};h.StatusText=b;return h}}Object(r.a)(wm,"SaveStatusPostMessageHandler",null,[724]);var Vn=d(221),Hm=d(113);class Sm{constructor(b,h,n,x){this.ITa=this.sTa=this.NTa=this.MTa=null;this.Sqb=0;this.FY=
this.EEe=this.Zmb=this.xge=this.VIe=null;this.sg=b;this.L6a=h;this.q4=n;this.Ql=x;this.jJg=!0;this.q8=!1;this.dR=3;this.Z8a=!0}initialize(b,h){if(!this.sg)return!1;this.MTa=this.Wff(b,h);this.NTa=CommonUIStrings.l_SavingStatus;this.sTa=CommonUIStrings.l_ReadOnlyStatus;this.ITa=CommonUIStrings.l_ReviewModeStatus;this.HA();return!0}Wff(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}HA(){this.L6a&&
this.L6a.execute(b=>{b.Q6j(Object(v.a)(this,this.Pth,"createStatusAndModeElements"));b.z6j(Object(v.a)(this,this.mVn,"showHideSaveStatusElement"));b.R7n&&this.Pth(null,null)});this.q4&&this.q4.execute(b=>{b.Rub(Object(v.a)(this,this.X2c,"updateToSavingStatus"))})}$ga(){this.FY&&this.sg&&this.sg.Lva(this.FY)}mVn(b,h){this.Vlb("true"===h,this.dR)}Vlb(b,h){this.q8=b;this.dR=h;this.xge&&(this.xge.style.display=this.q8||3===this.dR||!this.VIe?"none":"");this.Zmb&&(this.Zmb.style.display=this.q8||3===this.dR?
"none":"",this.Zmb.innerText=1===this.dR?this.sTa:this.ITa,this.Zmb.title=1===this.dR?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.EEe&&(this.EEe.style.display=this.q8||1===this.dR||!this.VIe&&!this.Zmb?"none":"");this.FY&&(this.FY.style.display=this.q8||1===this.dR?"none":"",this.jQa(this.Z8a),this.FY.title=CommonUIStrings.l_SaveStatusTooltip)}Pth(b,h){b=document.getElementById(Vn.CuiHelper.tVl);h&&h.mpo||!b||""===this.MTa||""===this.NTa||""===this.sTa||
""===this.ITa||(this.VIe=document.getElementById(Vn.CuiHelper.LSe),this.xge=Vn.CuiHelper.lwd(b,"BreadcrumbAppModeDash","-"),this.Zmb=Vn.CuiHelper.lwd(b,"BreadcrumbAppModeStatus",1===this.dR?this.sTa:this.ITa),this.ffj(this.Zmb),this.EEe=Vn.CuiHelper.lwd(b,"BreadcrumbSaveStatusDash","-"),this.FY=Vn.CuiHelper.lwd(b,"BreadcrumbSaveStatus",this.MTa),this.ffj(this.FY),this.Vlb(this.q8,this.dR))}X2c(){this.jQa(!1)}jQa(b){this.Z8a=b;this.mjo(this.Z8a?this.MTa:this.NTa)}mjo(b){!this.FY||3!==this.dR&&2!==
this.dR||(this.jJg&&!this.Z8a?(this.Sqb=this.FY.offsetWidth<this.Sqb?this.Sqb:this.FY.offsetWidth,this.Ydo(this.NTa),this.jJg=!1):this.FY.innerText=b)}ffj(b){b.style.direction=this.Ql?"rtl":"ltr";b.style.width="auto";b.style.textAlign=this.Ql?"right":"left";b.style.display=this.q8?"none":"";b.setAttribute("Unselectable","on")}Ydo(b){this.FY&&(this.FY.style.width="",this.FY.innerText=b,this.Sqb=this.FY.offsetWidth<this.Sqb?this.Sqb:this.FY.offsetWidth,b=Hm.a.yB(this.FY),this.FY.style.width=this.Sqb-
Ke.a.ZL(b.paddingLeft)-Ke.a.ZL(b.paddingRight)+1+"px")}}Object(r.a)(Sm,"SaveStatusUIHandler",null,[724]);var ho=d(73);class Hj{constructor(){this.FEe=this.ICe=this.iIa=this.W=null}get name(){return"Common.App.SaveStatus"}zc(b){this.W=b;u.AFrameworkApplication.K.$("PostMessageEmbedded")&&u.AFrameworkApplication.ZP?this.W.register(wm,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Xd(()=>new wm(this.W.Za("Common.App.HostNotification.EditNotificationEventSource"),
this.W.Za("Postmessage.IHostPostmessenger"))):u.AFrameworkApplication.ua.Sb.tsf||(u.AFrameworkApplication.ua.Sb.sI?this.W.register(qo,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Xd(()=>new qo(this.W.Za("Common.App.HostNotification.EditNotificationEventSource"))):this.W.register(Sm,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Xd(()=>new Sm(ho.EventHandlerManager.instance,
this.W.Za("Common.App.Header.HeaderEventSource"),this.W.Za("Common.App.HostNotification.EditNotificationEventSource"),u.AFrameworkApplication.isRtl)))}init(){u.AFrameworkApplication.K.yq(Object(v.a)(this,this.Ww,"onFullAppSettingsReady"))}Ww(){const b=u.AFrameworkApplication.K,h=!!u.AFrameworkApplication.ua.Sb&&4===u.AFrameworkApplication.ua.Sb.jo;if(b.$("WordEditorAutoSaveImprovementIsEnabled")||b.$("PptEditorSaveStatusInHeaderEnabled")||h&&b.$("SimplifiedReactRibbonUxIsEnabled")||b.$("ExcelSaveStatusInHeaderEnabled")||
b.$("VisioSaveStatusInHeaderEnabled"))u.AFrameworkApplication.K.$("PostMessageEmbedded")&&u.AFrameworkApplication.ZP?(this.FEe=this.W.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.FEe.HA():u.AFrameworkApplication.ua.Sb.tsf||(u.AFrameworkApplication.ua.Sb.sI?(this.ICe=this.W.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.ICe.initialize(b.$("IsSkyDrive"),b.lb("HostNameToIncludeInSavedStatus"),u.AFrameworkApplication.K):(this.iIa=this.W.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&
this.iIa.initialize(b.$("IsSkyDrive"),b.lb("HostNameToIncludeInSavedStatus")))}dispose(){this.iIa&&this.iIa.$ga()}}Object(r.a)(Hj,"PackageManager",null,[1,2]);var xm=d(1590);class zp{get name(){return"Common.App.EventsCachePackage"}zc(){}init(){xm.a.instance.init()}dispose(){}static main(){N.a.instance.Pc(new zp)}}Object(r.a)(zp,"EventsCachePackage",null,[1,2]);var cj=d(124),Xh=d(144),$k=d(95),nl=d(625),Qf=d(332),Hl=d(470),Im=d(304),ff=d(27),Bj=d(257),Vf=d(25);class Ri{constructor(b){this.sIg=!1;
this.u5c=this.am=null;this.yfe=!1;this.yD=b}get control(){return this.yD}get Nd(){return this.control.Nd}get root(){return this.control.root}get VG(){return this.control.VG}get HUa(){return this.control.HUa}get kk(){return this.control.kk}get XD(){return this.control.XD}JH(){}initialize(){}jw(b,h,n){this.control.xWk(b,h,n)}xl(){ff.c(this.control.Gh.Command)||this.Et(this.control.Gh.Command,null,null)}Et(b,h,n){let x=0;this.root&&(x=this.root.Xma(b,h,n));this.control.enabled=0<(x&1);return x}N3a(){let b=
this.control.visible;this.root.CPa&&(b=this.Nd[Bj.a.visible],b!==this.control.visible&&(this.control.visible=b,this.root.o9b=!0));return b}f7f(){const b=Vf.a.koa(this.Nd[Bj.a.labelText],this.control.Gh.LabelText);this.B5d(b)}B5d(b){this.control.labelText!==b&&(this.XD.forEach(h=>{h.B5d(b)}),this.control.labelText=b,this.root.a0a=!0)}ELb(){const b=Vf.a.koa(this.Nd[Bj.a.alt],this.control.Gh.Alt);this.Edc(b)}Edc(b){this.control.tooltip!==b&&(this.XD.forEach(h=>{h.Edc(b)}),this.control.tooltip=b)}dha(){const b=
Vf.a.koa(this.Nd[nl.a.Image16by16Class],this.control.Gh.Image16by16Class),h=Vf.a.koa(this.Nd[nl.a.Image32by32Class],this.control.Gh.Image32by32Class);var n=Vf.a.koa(this.Nd[nl.a.Image48by48Class],this.control.Gh.Image48by48Class);n=ff.b(n)?h:n;this.kyc(this.XD.small,b);this.kyc(this.XD.medium,b);this.kyc(this.XD.large,h);this.kyc(this.XD.ZXn,b);this.kyc(this.XD.N7b,n)}kyc(b,h){!b||ff.c(b.zP)||ff.c(h)||b.zP.className===h||(b.zP.className=h)}Ifo(b){if(!ff.b(b)&&this.root.W1f){for(const h of this.control.eXe){const n=
h.GS===b;n&&(this.control.dMe=h);this.control.visible&&(h.Vz=n)}this.control.visible&&(this.root.a0a=!0)}}C8j(){if(this.XD.N7b&&this.XD.N7b.FN&&this.XD.N7b.Hbb){const b=this.XD.N7b.FN,h=Vf.a.koa(this.Nd[Qf.a.Description],this.control.Gh.Description);ff.b(h)&&(b.style.position="relative",b.style.top=(b.parentNode.offsetHeight-b.offsetHeight)/2+"px",b.style.padding="0px")}}onFocus(){const b=this.kk;Object(pb.a)(Hl.a,b)?this.VG.Olb(b):this.root.Ewb=this.control;return!1}onBlur(){const b=this.kk;this.control.iDb()&&
Vf.a.Hu(b.Kc,"cui-ctl-menu-hovered-without-focus");this.root.Ewb=null;return!1}mX(b){if(this.control.iDb()){var h=this.VG.Rna;const n=h===this.root.QEb-1;h=n?null:this.root.LB[h+1];this.aWe(!1);n||this.control===h||Vf.a.Hu(h.UDb,Im.MenuLauncher.fRc);this.control.enabled&&this.control.Wt?n?this.control.yX():(Vf.a.Pf(this.kk.Kc,"cui-ctl-menu-hovered-without-focus"),h.Rda=this.control.Wt):n?this.VG.setFocus(b.eg):(h.Rda=this.VG.Kc,this.VG.mna())}return!1}cO(){this.control.iDb()&&Vf.a.Hu(this.kk.Kc,"cui-ctl-menu-hovered-without-focus");
return!1}onKeyDown(b){let h=!1;if(!ff.c(b.Ib)&&!ff.c(b.Ib.rawEvent)){const n=b.Ib.keyCode;b=b.Ib.rawEvent.shiftKey;n===Sys.UI.Key.enter&&(h=!0);if(Object(pb.a)(Hl.a,this.kk)){const x=this.VG;if(!ff.c(x)){const E=x.Rna,S=0===this.root.x_,ma=!ff.c(this.control.j0m);if(n!==Sys.UI.Key.tab&&n!==Sys.UI.Key.left&&n!==Sys.UI.Key.right&&n!==Sys.UI.Key.up&&n!==Sys.UI.Key.down&&n!==Sys.UI.Key.esc)return h;rd.a.CVe();n!==Sys.UI.Key.tab||b?n===Sys.UI.Key.tab&&b?(x.OJ(1),h=!0):n===Sys.UI.Key.left&&S||n===Sys.UI.Key.right&&
!S?(ma?x.OJ(2):0<E&&this.root.MVa(E,!0,!1),h=!0):n===Sys.UI.Key.right&&S||n===Sys.UI.Key.left&&!S?(ma&&x.OJ(4),h=!0):n===Sys.UI.Key.up?(x.OJ(5),h=!0):n===Sys.UI.Key.down?(x.OJ(6),h=!0):n===Sys.UI.Key.esc&&(this.root.MVa(E,!0,!1),h=!0):(x.OJ(0),h=!0)}}}return h}Xw(b){let h=!1;if(!ff.c(b.Ib)&&!ff.c(b.Ib.rawEvent)){const n=b.Ib.keyCode;mc.KeyInputManager.s2h(b)||n!==Sys.UI.Key.enter&&n!==Sys.UI.Key.space||(h=this.Cif(b),h||(this.jw(b.Af,1,b.Ib),h=!0))}return h}NB(b){this.TWe();if(this.HUa){let h=!0;
2===b.eg&&(h=b.gaa===Sys.UI.MouseButton.leftButton);h&&this.kk&&this.fpd(this.kk.Kc)}(b.Ib.type.toLowerCase()!==kb.a.uO||this.HUa)&&b.Ib.preventDefault();return!1}get eof(){return this.sIg}o_k(){this.sIg=!0}TWe(){this.eof&&this.control.root.wab()}nua(b){Object(pb.a)(Hl.a,this.kk)&&!this.HUa&&2===b.eg&&b.gaa===Sys.UI.MouseButton.leftButton?(this.jw(b.Af,b.eg,b.Ib),b=!0):b=this.control.Mra(b);return b}onClick(b){let h=!1;Object(pb.a)(Hl.a,this.kk)&&!this.HUa&&3===b.eg&&(this.jw(b.Af,b.eg,b.Ib),h=!0);
return V.a.ki?!1:h}$hb(b){return this.lVd(b)}PCa(b){this.Mra(b);return!1}lVd(b){return ff.c(this.am)?!1:(this.MVf(rd.a.BOd(this.x5g,b.clientPoint)),!0)}a$b(b){let h=!1;this.Mra(b)&&(h=!0);3!==b.eg&&(b=!0,!this.root&&Ri.WCf&&(w.ULS.sendTraceTag(588084884,207,50,"Root is null"),b=!1),b&&this.root.qda(),h=!0);return h}d$b(b){return this.Mra(b)}b$b(b){return this.lVd(b)}c$b(b){return this.Mra(b)}Z9b(b){return 3===b.eg?(this.root.qda(),!0):!1}$9b(){return!1}get x5g(){!ff.c(this.am)&&ff.c(this.u5c)&&(this.u5c=
rd.a.getElementBounds(this.am));return this.u5c}MVf(b){this.yfe!==b&&(this.yfe=b,this.eMe(this.yfe))}eMe(b){ff.c(this.am)||Vf.a.B3(this.am,$k.Control.ipd,b)}fpd(b){this.control.enabled&&(this.am=b,this.root.oxc=this.control,this.MVf(!0),this.root.gda(this.control,!1))}Mra(b){if(!ff.c(this.am)){this.MVf(!1);let h=!!this.root;if(Ri.WCf){const n=pd.ActionManager.Sca(parseInt(this.control.Gh.Command))||"";w.ULS.sendTraceTag(588084885,207,50,"Root not null: {0}, Action: {1}",h,n)}h&&this.root.Q9(this.control,
!1);ff.c(b)||rd.a.BOd(this.x5g,b.clientPoint)&&this.jw(this.am,b.eg,b.Ib);h=!!this.root;Ri.WCf&&w.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",h);h&&(this.root.oxc=null);this.u5c=this.am=null;return!0}return!1}OJ(b){return Object(pb.a)(Hl.a,this.kk)&&2!==b&&4!==b&&!rd.a.b5b(this.control.Wt)?this.yX():!1}yX(){try{if(this.control.visible){const b=this.control.Wt;if(!ff.c(b))return b.focus(),!0}}catch(b){}return!1}aWe(b){const h=this.VG;ff.c(h)||this.root.MVa(h.Rna+1,b)}zma(){}Cif(){return!1}xea(b){let h=
null;b&&b.rawEvent&&(h={},h[Ri.triggerTime]=b.rawEvent.timeStamp);return h}static get WCf(){null==Ri.Jye&&(Ri.Jye=!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("NullCheckRootInOnModalBodyPointerDownIsEnabled"));return Ri.Jye}}Ri.triggerTime="TriggerTime";Ri.Jye=null;Object(r.a)(Ri,"ControlBehavior",null,[347]);var dj=d(138);class Zo extends Ri{constructor(b){super(b)}get button(){return this.control}get properties(){return this.control.Gh}JH(b){const h=b.wm;b=b.GS;ff.c(h)||(qc.a.instance.mb(kb.a.focus,
h,Object(v.a)(this,this.onFocus,"onFocus")),qc.a.instance.mb(kb.a.blur,h,Object(v.a)(this,this.onBlur,"onBlur")),Xh.a.instance.mb(kb.a.pointerOver,h,Object(v.a)(this,this.mX,"onPointerOver")),Xh.a.instance.mb(kb.a.pointerOut,h,Object(v.a)(this,this.cO,"onPointerOut")),mc.KeyInputManager.instance.jE(kb.a.Di,h,Object(v.a)(this,this.onKeyDown,"onKeyDown"),b),mc.KeyInputManager.instance.jE(kb.a.At,h,Object(v.a)(this,this.DF,"onKeyPress"),b),mc.KeyInputManager.instance.jE(kb.a.Bh,h,Object(v.a)(this,this.Xw,
"onKeyUp"),b),Xh.a.instance.mb(kb.a.pointerDown,h,Object(v.a)(this,this.NB,"onPointerDown")),Xh.a.instance.mb(kb.a.$L,h,Object(v.a)(this,this.nua,"onPointerUp")),$e.a.instance.mb(kb.a.click,h,Object(v.a)(this,this.onClick,"onClick")),dj.a.instance.mb(kb.a.tO,h,Object(v.a)(this,this.$hb,"onTouchMove")),dj.a.instance.mb(kb.a.QI,h,Object(v.a)(this,this.PCa,"onTouchEnd")))}jw(b,h,n){this.control.enabled&&(b=null,this.kk&&this.kk.BNc()&&this.VG&&(b=this.root.LB[this.VG.Rna])&&!this.eof&&(b.SOa(this.button),
b=null),this.executeCommand(this.control.Gh.Command,h,!0,n),b&&b.SOa(this.button))}executeCommand(b,h,n,x){if(!ff.c(b)){const E=this.Nd;E.CommandValueId=this.button.szb();E.MenuItemId=this.button.Gh.MenuItemId;E.SourceControlId=this.control.id;this.root.executeCommand(b,E,this.kk,h,n,null,this.xea(x))}}xl(){ff.c(this.control.Gh.Command)||0<(this.Et(this.properties.Command,this.properties.QueryCommand,this.Nd)&2)&&this.N3a()&&this.iQa()}iQa(){this.f7f();this.ELb();this.dha()}onFocus(b){super.onFocus(b);
this.R0f();return!1}onBlur(b){super.onBlur(b);this.i5e();return!1}onKeyDown(b){let h=super.onKeyDown(b);ff.c(b.Ib)||this.LYf(b.vp,b.Ib.keyCode)&&(h=!1);return h}DF(b){let h=!1;ff.c(b.Ib)||ff.c(b.Ib.rawEvent)||(this.LYf(b.vp,b.Ib.rawEvent.keyCode)?(this.jw(b.Af,b.eg,b.Ib),h=!0):b.Ib.preventDefault());return h}LYf(b,h){if(V.a.zk&&h===Sys.UI.Key.enter)switch(b){case "MenuMru":case "MenuTemplate":case "MenuHeader":case "MenuFooter":return!0}return!1}Xw(b){let h=!1;ff.c(b.Ib)||this.LYf(b.vp,b.Ib.keyCode)||
(h=super.Xw(b));return h}R0f(){this.control.enabled&&this.executeCommand(this.properties.CommandPreview,0,!1,null)}i5e(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)}}Object(r.a)(Zo,"ButtonBehavior",Ri,[]);var Vg=d(945);class Jm{}Jm.Color="Color";Jm.IndexColorSelected="ColorSelected";Object(r.a)(Jm,"ColorPickerCommandProperties",null,[]);class ro extends Ri{constructor(b){super(b);this.Fuc=this.Ou=-1}get colorPicker(){return this.control}get yJa(){return this.colorPicker.Lxk.yJa}get properties(){return this.colorPicker.Gh}jw(b,
h,n){if(this.control.enabled){const x=this.Nd;x.Color=ro.OFd(b)[Vg.ColorPicker.zud];b=null;Vf.a.rr(this.properties.Stateful)&&this.kk&&this.kk.BNc()&&this.VG&&(b=this.root.LB[this.VG.Rna]);this.root.executeCommand(this.properties.Command,x,this.kk,h,!0,null,this.xea(n));b&&b.SOa(this.colorPicker)}}xl(){var b=this.Nd;b.SourceControlId=this.properties.Id;if(0<(this.Et(this.properties.Command,this.properties.QueryCommand,b)&2)&&(b=-1,Jm.IndexColorSelected in this.Nd&&(b=this.Nd[Jm.IndexColorSelected]),
b!==this.Fuc)){const h=this.yJa;0<=b&&b<h.length&&this.wej(h[b],!0);0<=this.Fuc&&this.Fuc<h.length&&this.wej(h[this.Fuc],!1);this.Fuc=b}}wej(b,h){h?Vf.a.Pf(b,"cui-colorpicker-selected"):Vf.a.Hu(b,"cui-colorpicker-selected")}JH(b){for(let h=0;h<b.KLe.length;++h){const n=b.KLe[h];qc.a.instance.mb(kb.a.focus,n,Object(v.a)(this,this.kEf,"onCellFocus"));qc.a.instance.mb(kb.a.blur,n,Object(v.a)(this,this.UNm,"onCellBlur"));mc.KeyInputManager.instance.mb(kb.a.Di,n,Object(v.a)(this,this.onKeyDown,"onKeyDown"));
mc.KeyInputManager.instance.mb(kb.a.Bh,n,Object(v.a)(this,this.Xw,"onKeyUp"));$e.a.instance.mb(kb.a.click,n,Object(v.a)(this,this.VNm,"onCellClick"));Xh.a.instance.mb(kb.a.$L,n,Object(v.a)(this,this.mEf,"onCellPointerUp"));Xh.a.instance.mb(kb.a.pointerOver,n,Object(v.a)(this,this.lEf,"onCellPointerOver"));Xh.a.instance.mb(kb.a.pointerDown,n,Object(v.a)(this,this.WNm,"onCellPointerDown"))}}kEf(b){b=ro.OFd(b.Af);this.VG.Olb(this.kk);this.lbe(b,!0);return!0}UNm(b){this.lbe(ro.OFd(b.Af),!1);return!0}lbe(b,
h){h?(this.Ou=parseInt(b.getAttribute("arrayPosition")),Vf.a.Pf(b,"cui-colorpicker-hoveredOver"),this.R0f(b)):(this.Ou=-1,this.i5e(b),Vf.a.Hu(b,"cui-colorpicker-hoveredOver"))}VNm(b){3===b.eg&&this.jw(b.Af,b.eg,b.Ib);return!0}mEf(b){3!==b.eg&&this.jw(b.Af,b.eg,b.Ib);return!0}lEf(b){this.aWe(!1);b=parseInt(ro.OFd(b.Af).getAttribute("arrayPosition"));this.nZc(b);return!0}WNm(){return!1}R0f(b){if(this.control.enabled){const h=this.properties.CommandPreview;if(!ff.b(h)){const n=this.Nd;n.Color=b[Vg.ColorPicker.zud];
this.root.executeCommand(h,n,this.kk,0,!1)}}}i5e(b){if(this.control.enabled){const h=this.properties.CommandRevert;if(!ff.b(h)){const n=this.Nd;n.Color=b[Vg.ColorPicker.zud];this.root.executeCommand(h,n,this.kk,0,!1)}}}OJ(b){b=$k.Control.L8e(this.Ou,this.colorPicker.width,this.yJa.length,b);if(b!==this.Ou&&this.nZc(b))return!0;this.lbe(this.yJa[this.Ou],!1);return!1}yX(){return this.nZc(0)}nZc(b){return this.yJa&&this.yJa.length>b&&(b=this.yJa[b],b.firstChild)?(b.firstChild.focus(),!0):!1}zma(){-1!==
this.Ou&&this.lbe(this.yJa[this.Ou],!1)}static OFd(b){return ro.Rxl(b)}static Rxl(b){var h=["td"];const n=h.length;if(!b)return null;for(var x=0;x<n;x++)if(b.tagName.toLowerCase()===h[x].toLowerCase())return b;for(b=b.parentNode;b;){for(x=0;x<n;x++)if(b.tagName.toLowerCase()===h[x].toLowerCase())return b;b=b.parentNode}return null}}Object(r.a)(ro,"ColorPickerBehavior",Ri,[]);var $o=d(277),so=d(280),Lg=d(1611),$p=d(679),Fk=d(391),kn=d(1090);class Nl{constructor(b,h){this.cWj=b;this.aIg=h}l5d(b,h,n,
x){if(ff.c(b)||ff.c(h))return null;const E=new kn.a;const S=x.x;var ma=x.y;const Fa=x.width;var $a=x.height;let sb;Nl.z_b(h,"flyoutWidth");x=Nl.z_b(h,"flyoutRealHeight");const Jb=Nl.z_b(h,"viewportWidth");var Sb=Nl.z_b(h,"viewportHeight"),oc=Nl.z_b(h,"viewableLeft");const Ic=Nl.z_b(h,"viewableTop"),gd=this.cWj;let Gd=!1,vd=!1;const ce=1===n,od=4===n,Yd=this.aIg;b.style.maxHeight="none";b.style.top="0px";b.style.overflowY="visible";b.style.width="auto";sb=this.Roi(b);E.hjj=Sb;E.Z8f=Jb;if(ce)gd?h=S+
Fa:(h=S-sb,E.Agb=!0),$a=ma;else{var ne="";Fa>sb&&(sb=Fa,ne=(sb-2*Fk.Menu.wTd).toString());gd?h=S:(h=S+Fa-sb,E.Agb=!0);$a=ma+$a;""!==ne&&(b.style.minWidth=ne+"px")}Yd&&($a+=Ic,h+=oc);b.style.top=$a+"px";b.style.left=h+"px";let Df=!1;ne=!1;sb<=Jb?h+sb>oc+Jb?(ce&&gd&&S-sb>oc||od&&S-sb>oc?(h=S-sb,Yd&&(h+=oc),ne=E.Agb=!0):(h=oc+Jb-sb,Gd=!0),Df=!0):h<oc&&(ce&&!gd&&S+Fa+sb<oc+Jb?(h=S+Fa,Yd&&(h+=oc),E.Agb=!1,ne=!0):(h=oc,vd=!0,E.Agb=!0),Df=!0):gd?(h=oc,Df=!0,E.Agb=!0):(h=oc+Jb-sb,Df=!0,E.Agb=!1);Df&&(b.style.left=
h+"px");E.d1b=$a;$a+x<=Ic+Sb&&3!==n||(E.Buf=!0,{mJm:n,V$k:ma,nbm:Sb,Vhm:oc}=this.o8e(n,$a,x,ma,Ic,Sb),$a!==n&&(b.style.top=n+"px",E.d1b=n),-1<ma&&(b.style.maxHeight=ma+"px"),Sb&&(b.style.bottom="0px",b.style.height="auto"),oc&&this.SBm(b,gd,ce,ne,vd,Gd,Jb,S,Fa));E.RFc=h;E.K8e=sb;E.H8e=x;return E}o8e(b,h,n,x,E,S){let ma,Fa,$a;ma=-1;$a=Fa=!1;const sb=h,Jb=E+S-h;h=x-n;const Sb=this.aIg;let oc=!1;0>h&&(h=E);Sb||(x-=E);n<=x&&1!==b||(4===b||1===b?n<S?(h=S-n,Fa=!0):(h=E,oc=$a=Fa=!0):(x<Jb&&3!==b?(h=sb,Fa=
!0):ma=x,$a=!0));Sb&&(Fa=!1,oc?ma=S:h+=E);return{mJm:h,V$k:ma,nbm:Fa,Vhm:$a}}SBm(b,h,n,x,E,S,ma,Fa,$a){b.style.overflowY="scroll";b.style.width="auto";if(h){if(S||x)b.style.left="",b.style.right=(S?0:ma-Fa)+"px"}else E||x||(b.style.left="",b.style.right=(n?ma-Fa:ma-Fa-$a)+"px")}Pnl(b){const h={};if(ff.c(b))return h;h.viewportWidth=Ke.a.HAb();h.viewportHeight=Ke.a.e2();ff.c(h.viewportWidth)&&(h.viewportWidth=document.documentElement.clientWidth,h.viewportHeight=document.documentElement.clientHeight);
ff.c(h.viewportWidth)&&(h.viewportWidth=document.body.clientWidth,h.viewportHeight=document.body.clientHeight);h.viewableTop=window.pageYOffset;h.viewableLeft=window.pageXOffset;ff.c(h.viewableTop)&&(h.viewableTop=document.documentElement.scrollTop,h.viewableLeft=document.documentElement.scrollLeft);ff.c(h.viewableTop)&&(h.viewableTop=document.body.scrollTop,h.viewableLeft=document.body.scrollLeft);h.flyoutRealHeight=b.scrollHeight!==b.offsetHeight?b.scrollHeight+2*Fk.Menu.wTd:b.scrollHeight;const n=
b.style.overflowY;b.style.overflowY="visible";h.flyoutWidth=this.Roi(b);b.style.overflowY=n;return h}Roi(b){return b.offsetWidth}static z_b(b,h){return ff.c(b)?0:b[h]}}Object(r.a)(Nl,"MenuPositioner",null,[]);var ol=d(522),Bn=d(608),to=d(1092),qn=d(1091),Ko=d(1088),Lo=d(1089),ij=d(1094),jm=d(409),jj=d(943);class Tm extends Ri{constructor(b){super(b);this.Gxe=0;this.fMg=null;this.fBe=-1;this.s9c=null;this.oKf=this.hFg=!1;this.WKj=new Nl(0===this.root.x_,Vf.a.rr(this.root.properties.DivSyndicated))}get epi(){return this.WKj}get fu(){return this.control}get properties(){return this.control.Gh}get menu(){return this.fu.menu}set menu(b){this.fu.menu=
b}get hK(){return this.fu.hK}set hK(b){this.fu.hK=b}get Gdh(){ff.c(this.s9c)&&(this.s9c=Tm.fIk());return this.s9c}get M1i(){let b=!this.root.jlf;Object(pb.a)(282,this.root)&&1===this.root.QEb&&(b=!0);return b}jw(b,h){Object(pb.a)(282,this.root)&&this.root.B5e();this.fu.IZ(h)}IZ(b){if(this.fu.enabled&&!this.hK){var h=vb.a.instance.oo(Ra.a.IZ);h.properties.add("Id",this.fu.Gh.Id);h.properties.add("InputMethod",$o.a[b]);h.end();ue.a.mark(10326);rd.a.sTd(this.fu.Gh.Id,"MenuOpen");this.fu.Wt&&(this.fu.Rda=
rd.a.HKa(this.fu.Wt.ownerDocument));this.Gxe=b;this.CDi(b);this.I4d();this.fu.D3a(this.fu.Wt,!0)}}I4d(){ff.c(this.properties.PopulateAsyncTriggerCommand)||this.hFg||(this.LKm(),this.hFg=!0)}LKm(){const b={};b[Lg.a.Callback]=Object(v.a)(this,this.SJi,"refreshMenuCallback");this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,b,this.kk,0,!1)}SJi(){this.fu.kOa()}kOa(){this.hK&&this.CDi(this.Gxe,!0)}CDi(b,h=!1){var n=!0;if(Vf.a.rr(this.properties.PopulateDynamically)){n=!1;const x=this.hUc(b);
x!==this.fMg&&(n=this.DKf(x,h));n=n||!this.hK}n&&(h=u.AFrameworkApplication.ua.iq,n=null,h&&(n=h.fg("LoadResource","Menu Initialization")),this.$Ya(b),n&&n.stop(),this.yWd())}$Ya(b){if(!ff.c(this.menu)){if(this.fu.K0a){var h=this.fu.kk;if(h&&h.keytip){var n=h.keytip.key.toLocaleLowerCase();this.menu.NKn(String.format("{0} {1}",this.fu.K0a,h.keytip.H4e),this.fu.ONa&&""!==this.fu.ONa?String.format("{0}-{1}",this.fu.ONa,n):n)}}this.menu.tka();Vf.a.Pf(this.menu.Kc,this.fu.vOe);Vf.a.B3(this.menu.Kc,"cui-touch",
3===b||this.root.U$d);if(this.menu.hasItems()){this.menu.JH();h=this.kk;h.vCh();h.LKc=!0;h.Sf(this.menu);h.LKc=!1;this.menu.ADi();n=Object(pb.a)(jj.a,this.root);var x=null,E=!1;n&&(x=this.root,E=x.r2a,x.r2a=!1);var S=this.menu.Kc;S.style.visibility="hidden";S.style.position="absolute";S.style.top="0px";S.style.left="0px";V.a.zk&&!V.a.Efb&&(S.style.maxHeight="100px",S.style.overflowY="scroll");document.body.appendChild(S);this.F8j();this.t4m(S);Sys.Browser.agent===Sys.Browser.InternetExplorer&&this.m_j();
Vf.a.Pf(this.fu.UDb,Im.MenuLauncher.fRc);var ma=this.root.QEb;this.eRn&&this.root.gda(this.control,!0);S.style.zIndex=String(u.AFrameworkApplication.ua.Nqa);this.root.O1j(this.fu);this.menu.Rna=ma;S.style.visibility="visible";ma=this.aMh();if(Object(pb.a)(Lo.a,this.menu)){S.style.position="fixed";const Fa=this.root.LB[0];Fa&&Fa.menu&&Fa.menu.Kc?100!==rd.a.iIc(this.root.LB[0].menu.Kc)&&so.a.h_f(S,ma,Object(v.a)(this,this.FOe,"afterShowMenu")):so.a.h_f(S,ma,Object(v.a)(this,this.FOe,"afterShowMenu"))}else so.a.h_f(S,
ma,Object(v.a)(this,this.FOe,"afterShowMenu"));this.hK=!0;this.menu.Auf=!0;!V.a.ki&&this.fu.YCn&&this.menu.setFocus(b);n&&(x.r2a=E);n=this.properties.CommandMenuOpen;ff.b(n)||this.root.executeCommand(n,null,h,b,!1)}}ue.a.mark(10327)}yWd(){}m_j(){this.fBe=Vf.a.Xvb(this.fBe);this.fBe=window.setTimeout(Object(v.a)(this,this.n_j,"addAndPositionBackFrameInternal"),50)}n_j(){this.menu&&this.menu.Kc&&(document.body.appendChild(this.Gdh),this.p4m())}p4m(){const b=this.Gdh;var h=this.menu.Kc;b.style.position=
"absolute";b.style.visibility="hidden";b.style.left=h.style.left;b.style.right=h.style.right;b.style.top=h.style.top;b.style.bottom=h.style.bottom;let n=h.offsetWidth;h=h.offsetHeight;V.a.Efb&&(n-=4,h-=4);b.style.width=n.toString()+"px";b.style.height=h.toString()+"px";b.style.visibility="visible"}get eRn(){return this.root.QEb?!1:!0}FOe(b){b.element&&(b.element.style.filter="",b.element.style.opacity="",this.menu&&this.menu.Kc===b.element&&Object(pb.a)(Ko.a,this.menu)&&so.a.b$j(this.aMh()))}aMh(){const b=
this.menu.children,h=[];if(Object(pb.a)(Ko.a,this.menu))for(let n=0;n<b.count;n++){const x=b.J(n);Array.add(h,x.separator);for(let E=0;E<x.children.count;E++){const S=x.children.J(E);Array.add(h,S.Kc)}}return h}F8j(){var b=this.menu.children;for(let n=0;n<b.count;n++){const x=b.J(n).children;for(let E=0;E<x.count;E++){var h=x.J(E);if(Object(pb.a)(Hl.a,h)){const S=h;if("Menu32"===S.GS||"Menu48"===S.GS)h=h.control,h.behavior&&(Object(pb.a)(Bn.a,h)||Object(pb.a)(qn.a,h))&&h.behavior.C8j()}}}0<b.count&&
(b=b.J(0),ff.c(b.separator)||(b.separator.style.display="none"),ff.c(b.z$d)||Vf.a.Pf(b.z$d,"cui-menusection-titleAtTop"))}t4m(b){if(!ff.c(b)){b.style.top="0px";b.style.left="0px";b.style.bottom="";b.style.right="";b.style.width="";b.style.minWidth="";var h=$p.a.create();try{const n=this.epi.Pnl(b),x=this.SHc();let E=this.root.l5d(b,n,this.fu.xTd,x);E||(E=this.epi.l5d(b,n,this.fu.xTd,x));this.root.fpi=E}finally{h&&h.dispose()}}}SHc(){const b=rd.a.getElementBounds(this.fu.UDb);var h=this.VG;ff.c(h)||
ff.c(h.Kc)||(h=rd.a.getElementBounds(h.Kc),b.x=h.x+Fk.Menu.wTd,b.width=h.width-2*Fk.Menu.wTd);Object(pb.a)(jm.a,this.fu.vQd)&&(b.height=0);return b}sra(){if(this.fu.hK){w.ULS.sendTraceTag(6688860,207,50,"Menu closing {0}",{["Id"]:this.fu.Gh.Id});this.menu.zma();this.nMi();this.hK=!1;this.menu.Auf=!1;this.root.Q9(this.control,!0);this.M1i?u.AFrameworkApplication.ua.WXc(this.fu.Rda,this.Gxe):this.Tvn();this.fu.Rda=null;var b=this.fu.UDb;Vf.a.Hu(b,Im.MenuLauncher.fRc);this.fu.D3a(this.fu.Wt,!1);Vf.a.Hu(b,
"cui-ctl-menu-hovered-without-focus");this.menu.mna();ff.b(this.properties.CommandMenuClose)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.kk,0,!1);this.mMi()}}Tvn(){const b=this.fu.Rda;if(b)try{b.focus()}catch(h){}}mMi(){Ke.a.dv(this.menu.Kc);Ke.a.dv(this.s9c);Vf.a.Lva(this.menu.Kc)}hUc(b){if(this.oKf&&Vf.a.rr(this.properties.PopulateOnlyOnce)||ff.c(this.properties.PopulateQueryCommand))return null;if(void 0===b||null===b)b=0;const h=this.fu.Oaf();return 0<(this.root.Xma(this.properties.PopulateQueryCommand,
this.properties.PopulateQueryCommand,h,b)&1)?h.PopulationXML:null}DKf(b,h=!1){if(this.oKf&&Vf.a.rr(this.properties.PopulateOnlyOnce))return!0;let n=null;this.fMg=b;ff.c(b)||(n=this.iJk(b));ff.c(n)||(this.oKf=!0);if(h){this.root.Wuk(this.fu);if(ff.c(n)||!n.hasItems())return this.sra(),!1;this.nMi();this.mMi()}this.RJn(n);return!0}rvi(){}iJk(b){b=ol.Builder.pqh(b);if(!ff.c(b)){const h=new ij.a;h.bmh=!0;h.parentId=this.control.id;let n;n=Object(pb.a)(to.a,this.control);return this.root.lN.rVa(b,h,n)}return null}RJn(b){ff.c(b)||
(ff.c(this.menu)||this.menu.dispose(),this.menu=b,this.rvi())}nMi(){const b=this.menu.parent;b?(b.LKc=!0,b.removeChild(this.menu.id),b.LKc=!1):w.ULS.sendTraceTag(572330335,207,10,"Parent not found for the Menu component {0}",this.menu.id)}onKeyDown(b){let h=!1;ff.c(b.Ib)||ff.c(b.Ib.rawEvent)||Object(pb.a)(Hl.a,this.kk)||!b.Ib.rawEvent.altKey||b.Ib.keyCode!==Sys.UI.Key.down||(this.jw(b.Af,1,b.Ib),h=!0);h||(h=super.onKeyDown(b));return h}NB(b){this.TWe();2===b.eg&&b.gaa!==Sys.UI.MouseButton.leftButton||
this.jw(b.Af,b.eg,b.Ib);b.Ib.preventDefault();return!1}Cif(b){if(!this.VG||!this.VG.inKeytipMode||!this.fu.Dwi)return!1;this.fu.Dwi(this.kk,b);return!0}static fIk(){const b=Vf.a.createElement("iframe");b.style.position="absolute";b.style.visibility="hidden";b.style.borderWidth="0px";return b}}Object(r.a)(Tm,"MenuLauncherBehavior",Ri,[358,347]);var yi=d(893);class Mf extends Tm{constructor(b){super(b)}get Gs(){return this.VDc.properties}get VDc(){return this.control}get bKa(){return this.VDc.bKa}JH(){Xh.a.instance.mb(kb.a.pointerDown,
this.bKa.wm,Object(v.a)(this,this.NB,"onPointerDown"));mc.KeyInputManager.instance.mb(kb.a.Di,this.bKa.wm,Object(v.a)(this,this.onKeyDown,"onKeyDown"));mc.KeyInputManager.instance.mb(kb.a.Bh,this.bKa.wm,Object(v.a)(this,this.Xw,"onKeyUp"))}xl(){const b=this.Nd[yi.a.SelectedItemId];if(0<(this.Et(this.Gs.Command,this.Gs.QueryCommand,this.Nd)&2)){const h=this.Nd[yi.a.SelectedItemId];ff.c(h)||b===h||this.VDc.IYc(h)||(this.Nd[yi.a.SelectedItemId]=null)}}}Object(r.a)(Mf,"DropDownBehavior",Tm,[]);var Ol=
d(533),lk=d(689);class ji extends Mf{constructor(b){super(b);this.FRa=null;this.oye=this.Qpb=this.rxa=!1;this.Nsc=null;this.Lsc=-1}get z1(){return this.control}get oP(){return this.z1.oP}get wG(){return this.z1.wG}get BNd(){return this.Nd[Ol.a.IsFreeForm]}set BNd(b){this.Nd[Ol.a.IsFreeForm]=b}JH(b){Xh.a.instance.mb(kb.a.pointerDown,b.wm,Object(v.a)(this,this.NB,"onPointerDown"));const h=b.Sq;qc.a.instance.mb(kb.a.focus,h,Object(v.a)(this,this.Ohb,"onInputFocus"));qc.a.instance.mb(kb.a.blur,h,Object(v.a)(this,
this.mua,"onInputBlur"));mc.KeyInputManager.instance.mb(kb.a.Di,h,Object(v.a)(this,this.xRm,"onInputKeyDown"));mc.KeyInputManager.instance.mb(kb.a.At,h,Object(v.a)(this,this.yRm,"onInputKeyPress"));sf.a.instance.mb(kb.a.iaa,h,Object(v.a)(this,this.vFf,"onInputMouseUp"));Xh.a.instance.mb(kb.a.pointerDown,h,Object(v.a)(this,this.ARm,"onInputPointerDown"));Xh.a.instance.mb(kb.a.pointerDown,b.bBh,Object(v.a)(this,this.UFf,"onMenuButtonPointerDown"))}xl(){0<(this.Et(this.wG.Command,this.wG.QueryCommand,
this.Nd)&2)&&(this.Qpb||this.rhj(),this.kgo())}rvi(){this.z1.menuItems=null;var b;var h=b=null;if(!ff.c(this.menu)){this.V4d();for(let x of this.menu.children)for(let E of x.children)if(Object(pb.a)(Hl.a,E)){var n=E;n=n.control;Object(pb.a)(350,n)&&(b=n,b=b.Gh.MenuItemId);Object(pb.a)(344,n)&&(h=n,h=h.mYa());ff.c(b)||ff.c(h)||(this.z1.menuItems[h]=b,b=h=null)}}}ARm(b){Object(pb.a)(282,this.root)&&2===b.eg&&(this.FRa=rd.a.HKa(this.control.Wt.ownerDocument),this.control.Wt.focus());return!1}NB(b){this.TWe();
let h=!1;3===b.eg&&(h=super.NB(b),this.V4d());h&&b.Ib.preventDefault();return!1}UFf(b){let h=!1;if(2!==b.eg||b.gaa===Sys.UI.MouseButton.leftButton)this.jw(b.Af,b.eg,b.Ib),this.V4d(),h=!0;h&&b.Ib.preventDefault();return!1}xRm(b){let h=!1;if(!ff.c(b.Ib)&&!ff.c(b.Ib.rawEvent)){const n=b.Ib.keyCode;b=b.Ib.rawEvent.shiftKey;Vf.a.rr(this.wG.AutoComplete);if(n===Sys.UI.Key.enter)this.tS(),this.YSf(),Object(pb.a)(lk.Ribbon,this.root)&&this.root.hZ(),h=!0;else if(n===Sys.UI.Key.tab){if(this.tS(),this.YSf(),
Object(pb.a)(lk.Ribbon,this.root)&&(h=this.root.Zce(this.kk.Kc,!b)),Object(pb.a)(282,this.root))return!0}else n===Sys.UI.Key.backspace||n===Sys.UI.Key.del?this.control.enabled?(this.hUe(),this.Nsc=null):h=!0:n===Sys.UI.Key.esc?(this.cTf(),this.YSf(),Object(pb.a)(lk.Ribbon,this.root)&&this.root.hZ(),h=!0):n===Sys.UI.Key.down&&(this.IZ(1),this.V4d(),h=!0)}return h}yRm(b){if(!this.control.enabled)return!0;!ff.c(b.Ib)&&b.Ib.charCode&&this.PPk();return!1}vFf(){return this.rxa?!1:this.rxa=!0}H2k(){this.Lsc=
-1;const b=this.oP.Sq,h=b.value,n=this.jql(h);if(n){b.value=n.key;if(b.setSelectionRange)b.setSelectionRange(h.length,b.value.length);else if(b.createTextRange){const x=b.createTextRange();x.moveStart("character",h.length);x.moveEnd("character",b.value.length);x.select()}this.Nsc=n.value}else this.Nsc=null}jql(b){const h=this.z1.menuItems;for(let n in h){const x={key:n,value:h[n]};if(x.key.toLowerCase().startsWith(b.toLowerCase()))return x}return null}PPk(){Vf.a.rr(this.wG.AutoComplete)&&-1===this.Lsc&&
(this.oye&&(this.hUc(0),this.oye=!1),this.Lsc=window.setTimeout(Object(v.a)(this,this.H2k,"executeAutoComplete"),this.z1.Hek))}hUe(){Vf.a.rr(this.wG.AutoComplete)&&(this.Lsc=Vf.a.Xvb(this.Lsc))}Ohb(b){if(this.hK)return this.menu.setFocus(0),!0;Object(pb.a)(282,this.root)&&(de.FocusManager.instance().YB("ribbon"),this.root.aKc=!1);this.onFocus(b);this.Qpb=!0;Vf.a.Pf(this.oP.wm,"cui-cb-focus");Vf.a.rr(this.wG.PopulateDynamically)&&(this.oye=!0);rd.a.EYc(this.oP.Sq);ff.c(this.menu)||this.menu.jm();return this.rxa=
!1}mua(){this.Qpb=!1;this.tS();Vf.a.Hu(this.oP.wm,"cui-cb-focus");return!1}YSf(){Object(pb.a)(282,this.root)&&(void 0!==this.FRa&&null!==this.FRa&&u.AFrameworkApplication.ua.WXc(this.FRa,2),this.FRa=null)}tS(){if(this.control.enabled){this.hUe();var b=this.oP.Sq;if(void 0===this.Nd[Ol.a.Value]||null===this.Nd[Ol.a.Value]||b.value!==this.Nd[Ol.a.Value].toString())if(this.z1.IYc(this.Nsc))this.BNd=!1,this.Nd[Ol.a.Value]=b.value,b={["IsFreeForm"]:!1,["CommandValueId"]:this.z1.NYc.szb(),["MenuItemId"]:this.z1.NYc.Gh.MenuItemId},
this.root.executeCommand(this.wG.Command,b,this.kk,0,!1);else{if(!Vf.a.rr(this.wG.AutoComplete)){var h=this.z1.menuItems[b.value];if(!ff.b(h)&&this.z1.IYc(h)){this.BNd=!1;this.Nd[Ol.a.Value]=b.value;b={["IsFreeForm"]:!1,["CommandValueId"]:this.z1.NYc.szb(),["MenuItemId"]:h};this.root.executeCommand(this.wG.Command,b,this.kk,0,!1);return}}h=!ff.b(b.value)&&""!==B.a.Uua(b.value);this.z1.s$g&&h?(this.BNd=!0,this.Nd[Ol.a.Value]=b.value,this.root.executeCommand(this.wG.Command,{["IsFreeForm"]:!0,["Value"]:b.value},
this.kk,0,!1)):this.cTf()}}else this.cTf()}cTf(){this.hUe();this.Nsc=null;this.rhj()}rhj(){const b=this.Nd[Ol.a.Value]||"";b!==this.oP.Sq.value&&(this.oP.Sq.value=b);this.z1.IYc(this.z1.menuItems[b])}kgo(){const b=this.Nd[Ol.a.FontStyle]||"normal";b!==this.oP.Sq.style.fontStyle&&(this.oP.Sq.style.fontStyle=b)}V4d(){this.control.Wt&&this.menu&&this.control.Wt.setAttribute(qf.a.Bch,this.menu.id)}}Object(r.a)(ji,"ComboBoxBehavior",Mf,[]);class ki extends Tm{constructor(b){super(b)}get Bvd(){return this.control}SHc(){let b=
0;this.menu&&this.menu.Kc&&2===this.menu.horizontalAlignment&&(b=this.menu.Kc.clientWidth);return new Sys.UI.Bounds(this.Bvd.x-b,this.Bvd.y,this.Bvd.Duf,this.Bvd.Cuf)}}Object(r.a)(ki,"ContextMenuLauncherBehavior",Tm,[]);class ym extends Tm{constructor(b){super(b)}get lyd(){return this.control}SHc(){return new Sys.UI.Bounds(this.lyd.x,this.lyd.y,this.lyd.Duf,this.lyd.Cuf)}}Object(r.a)(ym,"DialogMenuLauncherBehavior",Tm,[]);var Ki=d(607);class Rg extends Tm{constructor(b){super(b);this.rye=!1;this.zTj=
!Vf.a.Sea(this.Gs.ShouldRefreshWhenDropped)}get oAa(){return this.control}get Gs(){return this.control.Gh}JH(b){b=b.wm;ff.c(b)||(qc.a.instance.mb(kb.a.focus,b,Object(v.a)(this,this.onFocus,"onFocus")),qc.a.instance.mb(kb.a.blur,b,Object(v.a)(this,this.onBlur,"onBlur")),Xh.a.instance.mb(kb.a.pointerOver,b,Object(v.a)(this,this.mX,"onPointerOver")),mc.KeyInputManager.instance.mb(kb.a.Di,b,Object(v.a)(this,this.onKeyDown,"onKeyDown")),mc.KeyInputManager.instance.mb(kb.a.Bh,b,Object(v.a)(this,this.Xw,
"onKeyUp")),Xh.a.instance.mb(kb.a.pointerDown,b,Object(v.a)(this,this.NB,"onPointerDown")))}xl(){ff.c(this.control.Gh.Command)||(this.oAa.hK&&!this.zTj?this.rye=!0:(0<(this.Et(this.Gs.Command,this.Gs.QueryCommand,this.Nd)&2)&&this.N3a()&&this.iQa(),Vf.a.rr(this.Gs.RefreshableMenu)&&this.hK&&this.menu.p3m()))}iQa(){this.hgo();this.dha();this.Vgo();this.oAa.Skf=this.Nd[Ki.a.ImageIsVisible]}hgo(){const b=Vf.a.koa(this.Nd[Ki.a.LabelText],this.Gs.LabelText),h=this.Nd[Ki.a.LabelTextUserGeneratedPlaceholderReplacements];
if(this.control.labelText!==b||this.Gs.LabelTextUserGeneratedPlaceholderReplacements!==h)this.XD.medium&&this.igo(this.XD.medium.FN,b,h),this.root.a0a=!0,this.control.labelText=b,this.Gs.LabelTextUserGeneratedPlaceholderReplacements=h}igo(b,h,n){const x=b.lastChild;Vf.a.MWi(b,h+" ",n);h=ff.c(x);w.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",h?"":x.nodeType.toString());h||b.appendChild(x)}Vgo(){const b=this.Nd[Ki.a.ImageBackColor];this.XD.forEach(h=>
{Rg.bbk(h.zP,b)})}IZ(b){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&(u.AFrameworkApplication.eaa("Microsoft.Office.Web.SessionSettings.IWacWordPrintToWebSettings"),u.AFrameworkApplication.ya.processAction(Ra.a.ryd,2));"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||u.AFrameworkApplication.ya.processAction(Ra.a.ryd,2);Object(pb.a)(Hl.a,this.kk)&&(this.hK||this.aWe(!0),this.control.enabled&&
this.yX());super.IZ(b)}sra(){super.sra();this.rye&&(this.rye=!1,this.xl())}mX(b){return this.control.iDb()?(this.oAa.hK?(this.root.Hih(),Vf.a.Pf(this.oAa.UDb,Im.MenuLauncher.fRc),this.oAa.Rda=this.control.Wt):(super.mX(b),this.jw(b.Af,b.eg,b.Ib)),!1):super.mX(b)}onKeyDown(b){let h=!1;if(!ff.c(b.Ib)&&!ff.c(b.Ib.rawEvent)){if(Object(pb.a)(Hl.a,this.kk)){const n=b.Ib.rawEvent,x=b.Ib.keyCode,E=0===this.root.x_;n.shiftKey||n.ctrlKey||!(x===Sys.UI.Key.right&&E||x===Sys.UI.Key.left&&!E)||(h=this.Cif(b),
h||(this.jw(b.Af,1,b.Ib),h=!0))}h||(h=super.onKeyDown(b))}return h}static bbk(b,h){ff.c(b)||ff.c(h)||b.style.backgroundColor===h||(b.style.backgroundColor=h)}}Object(r.a)(Rg,"FlyoutAnchorBehavior",Tm,[]);var Vi=d(922);class Jn extends Ri{constructor(b){super(b)}get u1b(){return this.control}get properties(){return this.u1b.properties}get uda(){return this.u1b.uda}JH(b){b=b.iyb;qc.a.instance.mb(kb.a.focus,b,Object(v.a)(this,this.onFocus,"onFocus"));qc.a.instance.mb(kb.a.blur,b,Object(v.a)(this,this.onBlur,
"onBlur"));Xh.a.instance.mb(kb.a.pointerOver,b,Object(v.a)(this,this.mX,"onPointerOver"));Xh.a.instance.mb(kb.a.pointerOut,b,Object(v.a)(this,this.cO,"onPointerOut"));mc.KeyInputManager.instance.mb(kb.a.Di,b,Object(v.a)(this,this.onKeyDown,"onKeyDown"));mc.KeyInputManager.instance.mb(kb.a.Bh,b,Object(v.a)(this,this.Xw,"onKeyUp"));Xh.a.instance.mb(kb.a.pointerDown,b,Object(v.a)(this,this.NB,"onPointerDown"));Xh.a.instance.mb(kb.a.$L,b,Object(v.a)(this,this.nua,"onPointerUp"));dj.a.instance.mb(kb.a.tO,
b,Object(v.a)(this,this.$hb,"onTouchMove"));dj.a.instance.mb(kb.a.QI,b,Object(v.a)(this,this.PCa,"onTouchEnd"))}xl(){const b=this.Nd[Vi.a.On],h=this.Nd[Vi.a.IsRtl];this.ahj();if(0<(this.Et(this.properties.Command,this.properties.QueryCommand,this.Nd)&2)){var n=!ff.c(this.Nd[Vi.a.InnerHTML])||!ff.c(this.properties.InnerHTML),x=!ff.c(this.properties.Image);n||x||(this.control.enabled=!1);x=this.uda.iyb;if(!ff.c(x)){if(n){n=Vf.a.koa(this.Nd[Vi.a.InnerHTML],this.properties.InnerHTML);if(null===x.innerHTML||
null===n||B.a.mh(x.innerHTML)!==B.a.mh(n))x.innerHTML=n;""===n&&(this.control.enabled=!1)}n=x.title;const E=Vf.a.koa(this.Nd[Vi.a.Alt],this.properties.Alt);E===n||this.control.XYf||(x.title=E)}x=this.Nd[Vi.a.IsRtl];b===this.Nd[Vi.a.On]&&h===x||this.control.XFb()}}ahj(){const b=this.Nd;b[Vi.a.CommandValueId]=this.control.szb();b.MenuItemId=this.control.Gh.MenuItemId;b.SourceControlId=this.properties.Id}jw(b,h,n){if((b=this.kk)&&this.control.enabled){const x=this.root;if(u.AFrameworkApplication.K&&
u.AFrameworkApplication.K.$("ExcelBorderMenuCompactionEnabled")&&b.BNc()&&this.VG){const E=x.LB[this.VG.Rna];E?E.SOa(this.u1b):w.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.ahj();this.Nd[Vi.a.On]||(this.Nd[Vi.a.On]=!0,this.control.XFb());"Menu"===b.GS&&Vf.a.Hu(this.uda.wm,"cui-gallerybutton-focused");x.executeCommand(this.properties.Command,this.Nd,b,h,!0,null,this.xea(n))}}onFocus(b){super.onFocus(b);Vf.a.Pf(this.uda.wm,
"cui-gallerybutton-focused");return!1}onBlur(b){super.onBlur(b);Vf.a.Hu(this.uda.wm,"cui-gallerybutton-focused");return!1}}Object(r.a)(Jn,"GalleryButtonBehavior",Ri,[]);var zm=d(1095),ib=d(1361),fc=d(640);class Hc extends Ri{constructor(b){super(b);this.PSa=-1}get Q4b(){return this.control}get properties(){return this.Q4b.Gh}get GAc(){return this.Q4b.GAc}get nkf(){var b=null;if(this.kk&&(b=this.kk.parent,!Object(pb.a)(fc.a,b)))throw Error.create("InsertTable must live inside of a MenuSection.");return b}get HBb(){return this.Q4b.ILd.HBb}get qTc(){return this.Q4b.ILd.qTc}jw(b,
h,n){if(this.control.enabled){b=this.qdf(this.E1b(b));const x=this.vDd(b);this.GAc[ib.a.Rows]=this.RGd(b)+1;this.GAc[ib.a.Columns]=x+1;this.root.executeCommand(this.properties.Command,this.GAc,this.kk,h,!0,null,this.xea(n))}}JH(b){var h=b.wm;const n=b.ujh;b=b.cells;Xh.a.instance.mb(kb.a.pointerOut,h,Object(v.a)(this,this.$Om,"onControlPointerOut"));dj.a.instance.mb(kb.a.tO,h,Object(v.a)(this,this.bPm,"onControlTouchMove"));dj.a.instance.mb(kb.a.QI,h,Object(v.a)(this,this.aPm,"onControlTouchEnd"));
for(h=0;h<b.length;++h)this.eek(n[h],b[h])}eek(b,h){qc.a.instance.mb(kb.a.focus,b,Object(v.a)(this,this.kEf,"onCellFocus"));Xh.a.instance.mb(kb.a.pointerOver,h,Object(v.a)(this,this.lEf,"onCellPointerOver"));Xh.a.instance.mb(kb.a.$L,h,Object(v.a)(this,this.mEf,"onCellPointerUp"));mc.KeyInputManager.instance.mb(kb.a.Di,h,Object(v.a)(this,this.onKeyDown,"onKeyDown"));mc.KeyInputManager.instance.mb(kb.a.Bh,h,Object(v.a)(this,this.Xw,"onKeyUp"));dj.a.instance.mb(kb.a.uO,h,Object(v.a)(this,this.XNm,"onCellTouchStart"))}qdf(b){return parseInt(b.id.substr(this.Q4b.id.length+
1))}o1h(b){this.n1h(this.qdf(b))}RGd(b){return Math.floor(b/zm.a.$Rc)}vDd(b){return b%zm.a.$Rc}n1h(b){if(b!==this.PSa){var h=this.vDd(b),n=this.RGd(b),x=-1;let E=-1;-1!==this.PSa&&(x=this.RGd(this.PSa),E=this.vDd(this.PSa));for(;x!==n||E!==h;)x<n?this.cZi(++x,E,!0):x>n?(this.cZi(x,E,!1),x--):E<h?this.BWi(++E,x,!0):E>h&&(this.BWi(E,x,!1),E--);this.nkf?this.nkf.RZi(this.LLh(n+1,h+1)):(n=(h=this.control.eXe)&&0<h.length?h[0]:null,x=this.kk,w.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",
{["CtrlComps"]:!!h,["FirstComp"]:!!n,["FirstCompPar"]:!!n&&!!n.parent,["DispComp"]:!!x,["DispCompPar"]:!!x&&!!x.parent}));this.PSa=b}}cZi(b,h,n){for(let x=0;x<=h;x++)this.sWi(b,x,n)}BWi(b,h,n){for(let x=0;x<=h;x++)this.sWi(x,b,n)}sWi(b,h,n){h=b*zm.a.$Rc+h;b=this.HBb[h];h=this.qTc[h];n?(b.className="cui-it-activeCell",h.className="cui-it-activeCellOuter"):(b.className="cui-it-inactiveCell",h.className="cui-it-inactiveCellOuter")}mEf(b){this.jw(b.Af,b.eg,b.Ib);return!0}E1b(b){for(;b.hasChildNodes();)b=
b.childNodes[0];return ff.c(b.tagName)||"a"!==b.tagName.toLowerCase()?null:b.parentNode.parentNode}SZi(b){const h=this.qdf(b);b.childNodes[0].childNodes[0].title=this.LLh(this.RGd(h)+1,this.vDd(h)+1)}LLh(b,h){let n=this.properties.Alt;ff.c(n)&&(n=this.properties.MenuSectionTitle);return n=String.format(n,h.toString(),b.toString())}Obc(){if(this.kk){for(var b=0;b<zm.a.B9b;b++)this.HBb[b].className="cui-it-inactiveCell",this.qTc[b].className="cui-it-inactiveCellOuter";this.PSa=-1;b=this.properties.MenuSectionInitialTitle;
ff.c(b)&&(b="");this.nkf.RZi(b)}}lEf(b){this.control.enabled&&(b=this.E1b(b.Af),this.nZc(b),this.v3e(b));return!1}v3e(b){this.SZi(b);this.o1h(b)}kEf(b){if(!this.control.enabled)return!1;b=this.E1b(b.Af);this.SZi(b);this.o1h(b);return!1}$Om(b){rd.a.krf(this.Q4b.ILd.wm,b.clientPoint)||this.Obc();return!1}XNm(b){if(!this.control.enabled)return!1;b=this.E1b(b.Af);this.v3e(b);return!0}bPm(b){if(!this.control.enabled)return!1;b=rd.a.mEd(b.clientPoint);if(!b||"table"===b.tagName.toLowerCase())return!1;(b=
this.E1b(b))?this.v3e(b):this.Obc();return!0}aPm(b){if(!this.control.enabled)return!1;var h=rd.a.mEd(b.clientPoint);if(!h||"table"===h.tagName.toLowerCase())return this.Obc(),!0;(h=this.E1b(h))?this.jw(h,3,b.Ib):this.Obc();return!0}OJ(b){b=$k.Control.L8e(this.PSa,zm.a.$Rc,zm.a.B9b,b);if(b!==this.PSa)return this.HBb[b].firstChild.focus(),this.n1h(b),!0;this.Obc();this.PSa=-1;return!1}yX(){const b=this.HBb[0];if(ff.c(b))return!1;b.firstChild.focus();return!0}nZc(b){if(ff.c(b))return!1;b.firstChild.firstChild.focus();
return!0}zma(){this.Obc()}}Object(r.a)(Hc,"InsertTableBehavior",Ri,[]);class hd extends Tm{constructor(b){super(b)}xl(){this.control.enabled=!!this.menu}jw(b,h,n){u.AFrameworkApplication.ya.Xb(Ra.a.LMa,2,h,this.xea(n))}}Object(r.a)(hd,"JewelMenuLauncherBehavior",Tm,[]);var Ud=d(1017);class aa extends Ri{constructor(b){super(b)}get properties(){return this.control.Gh}xl(){0<(this.Et(this.properties.Command,this.properties.QueryCommand,this.Nd)&2)&&this.N3a()&&this.iQa()}iQa(){this.jko();this.dha();
this.ELb()}jko(){const b=this.control.labelText;let h=this.Nd[Ud.a.Value];ff.c(h)&&(h=this.properties.LabelText,ff.c(h)&&(h=""));h!==b&&this.B5d(h)}JH(b){b=b.wm;ff.c(b)||(Xh.a.instance.mb(kb.a.pointerDown,b,Object(v.a)(this,this.NB,"onPointerDown")),Xh.a.instance.mb(kb.a.pointerOver,b,Object(v.a)(this,this.mX,"onPointerOver")),Xh.a.instance.mb(kb.a.pointerOut,b,Object(v.a)(this,this.cO,"onPointerOut")))}}Object(r.a)(aa,"LabelBehavior",Ri,[]);var La=d(849),jb=d(217),Tb=d(319);class jc extends Tm{constructor(b){super(b);
this.rre=this.eje=!1;this.wQb=this.TMb=null;if(this.WQb=u.AFrameworkApplication.K.$("TellMeRedesignIsEnabled"))this.TMb=this.Ft.lga.LightImage16by16Class,this.wQb=this.Ft.lga.DarkImage16by16Class}get Ft(){return this.control}PUd(b,h,n,x){h&&(this.Ft.Rda=n,u.AFrameworkApplication.ua.Qjb());if(Object(pb.a)(jb.a,b)&&x){n=new La.a;n.CommandLocation=this.root.f7;n.InvocationMethod=0;const E={};(b=b.control)&&b.Gh&&(E.CommandId=b.Gh.Command,E.ControlId=b.Gh.Id,E.CloseAllMenus=h,b.VG&&b.VG.parent&&b.VG.parent.id&&
(E.ParentControlId=b.VG.parent.id.split("-")[0]),this.root.kE&&this.root.kE.rKa(x,E,n))}}sra(){this.Ft.Rda||(this.Ft.Rda=this.Ft.Qx);!this.Ft.xHm&&this.WQb&&(Vf.a.Hu(this.Ft.Qx,"cui-sb-focus"),Vf.a.Hu(this.Ft.G_,"cui-sb-focus"),Vf.a.Hu(this.Ft.cva,this.TMb),Vf.a.Pf(this.Ft.cva,this.wQb));this.eje=!0;super.sra();this.eje=!1;this.hOf()}get M1i(){return!this.Ft.WNa}yWd(){this.Ft.yWd()}l1d(){this.rre||this.eje||(this.rre=!0,this.Ft.raiseEvent(Tb.a.mZa,null))}hOf(){this.hK||this.Ft.omf||(this.rre=!1,this.Ft.raiseEvent(Tb.a.YBb,
null))}sFf(b){Vf.a.Hu(this.Ft.Qx,"cui-sb-focus");Vf.a.Hu(this.Ft.G_,"cui-sb-focus");this.WQb&&!this.Ft.hK&&(Vf.a.Hu(this.Ft.cva,this.TMb),Vf.a.Pf(this.Ft.cva,this.wQb));this.Ft.raiseEvent(Tb.a.blur,b);this.hOf();this.Ft.Rda=this.Ft.Qx;return!1}tFf(b){Vf.a.Pf(this.Ft.Qx,"cui-sb-focus");Vf.a.Pf(this.Ft.G_,"cui-sb-focus");this.WQb&&(Vf.a.Hu(this.Ft.cva,this.wQb),Vf.a.Pf(this.Ft.cva,this.TMb));this.Ft.raiseEvent(Tb.a.focus,b);this.l1d();return!1}VGf(){this.WQb&&(Vf.a.Pf(this.Ft.G_,"cui-sb-hover"),Vf.a.Pf(this.Ft.Qx,
"cui-sb-hover"),Vf.a.Hu(this.Ft.cva,this.wQb),Vf.a.Pf(this.Ft.cva,this.TMb));return!1}UGf(){this.WQb&&(Vf.a.Hu(this.Ft.G_,"cui-sb-hover"),Vf.a.Hu(this.Ft.Qx,"cui-sb-hover"),this.Ft.hK||this.Ft.omf||(Vf.a.Hu(this.Ft.cva,this.TMb),Vf.a.Pf(this.Ft.cva,this.wQb)));return!1}}Object(r.a)(jc,"SearchBoxBehavior",Tm,[349,347]);class zc{}zc.Value="value";zc.MinValue="MinValue";zc.MaxValue="MaxValue";zc.Text="Text";Object(r.a)(zc,"SliderCommandProperties",null,[]);class Sc extends Ri{constructor(b){super(b)}get Y_f(){return this.control}get s3(){return this.Y_f.s3}get properties(){return this.control.Gh}initialize(){}jw(){}JH(b){b=
b.Sq;qc.a.instance.mb(kb.a.focus,b,Object(v.a)(this,this.onFocus,"onFocus"));qc.a.instance.mb(kb.a.blur,b,Object(v.a)(this,this.onBlur,"onBlur"));qc.a.instance.mb(kb.a.change,b,Object(v.a)(this,this.laa,"onChange"));qc.a.instance.mb(kb.a.input,b,Object(v.a)(this,this.laa,"onChange"))}onFocus(b){this.s3.wm&&Sys.UI.DomElement.addCssClass(this.s3.wm,"cui-sldr-onfocus");return super.onFocus(b)}onBlur(b){this.s3.wm&&Sys.UI.DomElement.removeCssClass(this.s3.wm,"cui-sldr-onfocus");return super.onBlur(b)}laa(){this.zzk(this.s3.Sq.value);
return!0}zzk(b){this.Nd[zc.Value]=parseFloat(b);this.root.executeCommand(this.properties.Command,this.Nd,this.kk,0,!1)}xl(){const b=this.Nd[zc.Value],h=this.Nd[zc.MaxValue],n=this.Nd[zc.Text];var x=this.Et(this.properties.Command,this.properties.QueryCommand,this.Nd);this.s3&&this.s3.Sq&&(this.s3.Sq.disabled=!this.control.enabled);if(0<(x&2)){x=this.Nd[zc.Value];const E=this.Nd[zc.MaxValue],S=this.Nd[zc.Text];(E!==h||x!==b||n!==S)&&this.s3&&this.s3.Sq&&(this.s3.Sq.setAttribute(qf.a.prd,String.format("{0}",
E)),this.s3.Sq.setAttribute("max",String.format("{0}",E)),this.s3.Sq.value=x,this.s3.FN.innerText=this.Nd[zc.Text])}}}Object(r.a)(Sc,"SliderBehavior",Ri,[]);var rc=d(1354);class ee extends Ri{constructor(b){super(b);this.Sfd=0;this.M9a=null;this.rdd=!1;this.F3g=null;this.GGe=!1;this.ajd=this.ohd=-1;this.rxa=!1}get spinner(){return this.control}get MF(){return this.spinner.MF}get properties(){return this.control.Gh}initialize(){const b=this.spinner.C8f;this.F3g=this.cco(b);this.Sfd=b[0].min;this.M9a=
b[0];this.rdd=!1}jw(){}JH(b){const h=b.Sq,n=b.h0b;b=b.eEc;qc.a.instance.mb(kb.a.focus,h,Object(v.a)(this,this.onFocus,"onFocus"));qc.a.instance.mb(kb.a.blur,h,Object(v.a)(this,this.onBlur,"onBlur"));mc.KeyInputManager.instance.mb(kb.a.Di,h,Object(v.a)(this,this.onKeyDown,"onKeyDown"));mc.KeyInputManager.instance.mb(kb.a.At,h,Object(v.a)(this,this.DF,"onKeyPress"));mc.KeyInputManager.instance.mb(kb.a.Bh,h,Object(v.a)(this,this.Xw,"onKeyUp"));qc.a.instance.mb(kb.a.change,h,Object(v.a)(this,this.laa,
"onChange"));sf.a.instance.mb(kb.a.iaa,h,Object(v.a)(this,this.vFf,"onInputMouseUp"));Xh.a.instance.mb(kb.a.pointerDown,n,Object(v.a)(this,this.jui,"onArrowPointerDown"));Xh.a.instance.mb(kb.a.pointerDown,b,Object(v.a)(this,this.jui,"onArrowPointerDown"));Xh.a.instance.mb(kb.a.$L,n,Object(v.a)(this,this.kui,"onArrowPointerUp"));Xh.a.instance.mb(kb.a.$L,b,Object(v.a)(this,this.kui,"onArrowPointerUp"));dj.a.instance.mb(kb.a.tO,n,Object(v.a)(this,this.mui,"onArrowTouchMove"));dj.a.instance.mb(kb.a.tO,
b,Object(v.a)(this,this.mui,"onArrowTouchMove"));dj.a.instance.mb(kb.a.QI,n,Object(v.a)(this,this.lui,"onArrowTouchEnd"));dj.a.instance.mb(kb.a.QI,b,Object(v.a)(this,this.lui,"onArrowTouchEnd"))}onFocus(b){super.onFocus(b);Vf.a.Pf(this.MF.wm,"cui-spn-focus");this.control.enabled&&rd.a.EYc(this.MF.Sq);return this.rxa=!1}onBlur(b){super.onBlur(b);Vf.a.Hu(this.MF.wm,"cui-spn-focus");return!1}onKeyDown(b){let h=!1;if(!ff.c(b.Ib)&&!ff.c(b.Ib.rawEvent)){const n=b.Ib.keyCode,x=b.Ib.rawEvent.shiftKey;if(n===
Sys.UI.Key.up||n===Sys.UI.Key.down)this.root.xof(this.control)||this.k6i(n===Sys.UI.Key.up,b.eg),h=!0;else if(n===Sys.UI.Key.enter)this.tS(),Object(pb.a)(lk.Ribbon,this.root)&&this.root.hZ(),h=!0;else if(n===Sys.UI.Key.tab)this.tS(),Object(pb.a)(lk.Ribbon,this.root)&&(h=this.root.Zce(this.kk.Kc,!x));else if(n===Sys.UI.Key.esc)this.Qbc(),Object(pb.a)(lk.Ribbon,this.root)&&this.root.hZ(),h=!0;else if(n===Sys.UI.Key.backspace||n===Sys.UI.Key.del)h=!this.control.enabled}return h}DF(){return!this.control.enabled}Xw(){this.AOk();
return!1}laa(){this.tS();return!1}vFf(){return this.rxa?!1:this.rxa=!0}jui(b){var h=!1;let n=!0;2===b.eg&&(n=b.gaa===Sys.UI.MouseButton.leftButton);n&&(h=b.Af,this.k6i(h===this.MF.h0b||h===this.MF.mBh||h===this.MF.lBh,b.eg),h=!0);return h}kui(b){return this.Mra(b)}mui(b){return this.lVd(b)}lui(b){return this.Mra(b)}yZl(b){if(this.control.enabled){var h=!1;if(!this.rdd){var n=this.vtl(b);n=b?n+this.M9a.step:n-this.M9a.step;n=Math.min(n,this.M9a.max);n=Math.max(n,this.M9a.min);n!==this.Sfd&&(this.SWe(n,
this.M9a),this.root.executeCommand(this.properties.Command,this.Nd,this.kk,0,!1),h=!0)}h||(h=this.properties.SpinCommand,n=this.Nd,n.Increment=b,ff.c(h)||this.root.executeCommand(h,n,this.kk,0,!1))}}vtl(b){const h=Math.pow(10,u.AFrameworkApplication.numberFormat.WUd),n=Math.round(this.M9a.step*h);let x=Math.round(this.Sfd*h)/n;x=b?Math.floor(x):Math.ceil(x);return x*n/h}k6i(b,h){if(this.control.enabled){this.tS();const n=b?this.MF.h0b:this.MF.eEc;switch(h){case 2:case 3:this.GGe=b;this.fpd(n);break;
case 1:this.GGe=b,this.WZj(n)}}}O6i(){this.Iih();this.iqk()}swh(){-1===this.ohd&&(this.ohd=window.setTimeout(Object(v.a)(this,this.Qrn,"repeatSpin"),500))}Iih(){this.ohd=Vf.a.Xvb(this.ohd)}Qrn(){this.Iih();-1===this.ajd&&(this.m8d(),this.ajd=window.setInterval(Object(v.a)(this,this.m8d,"spin"),50))}iqk(){this.ajd=Vf.a.eqk(this.ajd)}m8d(){this.yZl(this.GGe)}WZj(b){this.root.gda(this.control,!1);Vf.a.Pf(b,$k.Control.ipd);this.m8d();this.swh()}AOk(){this.root.Q9(this.control,!1);this.O6i();Vf.a.Hu(this.MF.h0b,
$k.Control.ipd);Vf.a.Hu(this.MF.eEc,$k.Control.ipd)}ndc(b){this.MF.Sq.value!==b&&(this.MF.Sq.value=b)}Qbc(){this.ndc(this.Nd[rc.a.Text])}QWi(b){this.ndc(b);this.Nd[rc.a.Text]=b;this.rdd=!0}xGn(b,h,n){this.ndc(n);this.Nd[rc.a.Text]=n;this.Nd[rc.a.Number]=b;this.Nd[rc.a.UnitType]=h.type;this.Sfd=b;this.M9a=h;this.MF.Sq.setAttribute(qf.a.HQe,n);this.MF.Sq.setAttribute(qf.a.Ich,String.format("{0}",h.min));this.MF.Sq.setAttribute(qf.a.prd,String.format("{0}",h.max));this.rdd=!1}Pnh(b){var h;if(({oKm:h}=
this.Sim(b)).returnValue)this.QWi(h);else{({number:b,z3a:h}=B.a.YBi(b,this.F3g,u.AFrameworkApplication.numberFormat));let n=this.Wae(h);0===h&&ff.c(n)&&(n=this.Wae(this.Nd[rc.a.UnitType]));this.SWe(b,n)}}SWe(b,h){b=this.FCf(b,h);if(isNaN(b)||ff.c(h))this.Qbc();else{const n=u.AFrameworkApplication.numberFormat;let x;x=B.a.rAa(b,h.type,n);x=x.replace(6===h.type?n.XUd:n.MJf,"");this.xGn(b,h,x)}}Sim(b){let h,n=!1;h="";b=b.trim();const x=this.spinner.wij;if(!ff.c(x))for(let E=0;E<x.length;E++)if(x[E].toLowerCase()===
b.toLowerCase()){h=x[E];n=!0;break}return{returnValue:n,oKm:h}}FCf(b,h){return isNaN(b)||ff.c(h)?Number.NaN:h.FCf(b)}Wae(b){let h=null;const n=this.spinner.C8f;for(let x=0;x<n.length;x++)if(n[x].type===b){h=n[x];break}return h}cco(b){const h=b.length,n=Array(h);for(let x=0;x<h;x++)n[x]=b[x].type;return n}tS(){if(this.control.enabled){const b=this.Nd[rc.a.Text],h=this.MF.Sq.value;h!==b&&(this.Pnh(h),this.Nd[rc.a.Text]!==b&&this.root.executeCommand(this.properties.Command,this.Nd,this.kk,0,!1))}else this.Qbc()}xl(){var b=
this.Nd[rc.a.Text],h=this.Nd[rc.a.Number];const n=this.Nd[rc.a.UnitType],x=this.Nd[rc.a.MaxValue];if(0<(this.Et(this.properties.Command,this.properties.QueryCommand,this.Nd)&2)){const E=this.Nd[rc.a.Text],S=this.Nd[rc.a.Number],ma=this.Nd[rc.a.UnitType],Fa=this.Nd[rc.a.MaxValue];Fa!==x&&(this.Wae(ma).max=Fa,this.MF.Sq.setAttribute(qf.a.prd,String.format("{0}",Fa)));E!==b?""===E?this.QWi(E):this.Pnh(E):isNaN(S)||S===h&&ma===n||this.SWe(S,this.Wae(ma));b=this.MF.wm.title;h=Vf.a.koa(this.Nd[rc.a.Alt],
this.properties.Alt);h!==b&&(this.MF.Sq.title=h,this.MF.h0b.title=h,this.MF.eEc.title=h)}}eMe(b){super.eMe(b);b?(this.m8d(),this.swh()):this.O6i()}}Object(r.a)(ee,"SpinnerBehavior",Ri,[348,347]);var me=d(323),ae=d(860);class cf extends Tm{constructor(b){super(b);this.VRb=!0;this.onb=!1}get t3(){return this.control}get Gs(){return this.t3.properties}JH(b){const h=b.wm,n=b.Gbb;b=b.gEc;qc.a.instance.mb(kb.a.focus,h,Object(v.a)(this,this.onFocus,"onFocus"));qc.a.instance.mb(kb.a.blur,h,Object(v.a)(this,
this.onBlur,"onBlur"));mc.KeyInputManager.instance.mb(kb.a.Di,h,Object(v.a)(this,this.onKeyDown,"onKeyDown"));mc.KeyInputManager.instance.mb(kb.a.Bh,h,Object(v.a)(this,this.Xw,"onKeyUp"));V.a.Vs&&16>this.xol()&&(Xh.a.instance.mb(kb.a.pointerDown,h,Object(v.a)(this,this.Oyi,"onSplitbuttonPointerDownPointerUp")),Xh.a.instance.mb(kb.a.$L,h,Object(v.a)(this,this.Oyi,"onSplitbuttonPointerDownPointerUp")));Xh.a.instance.mb(kb.a.pointerOver,n,Object(v.a)(this,this.JNm,"onButtonPointerOver"));Xh.a.instance.mb(kb.a.pointerOut,
n,Object(v.a)(this,this.INm,"onButtonPointerOut"));Xh.a.instance.mb(kb.a.pointerDown,n,Object(v.a)(this,this.Bui,"onButtonPointerDown"));Xh.a.instance.mb(kb.a.$L,n,Object(v.a)(this,this.Cui,"onButtonPointerUp"));dj.a.instance.mb(kb.a.tO,n,Object(v.a)(this,this.LNm,"onButtonTouchMove"));dj.a.instance.mb(kb.a.QI,n,Object(v.a)(this,this.KNm,"onButtonTouchEnd"));Xh.a.instance.mb(kb.a.pointerDown,b,Object(v.a)(this,this.UFf,"onMenuButtonPointerDown"));Xh.a.instance.mb(kb.a.pointerOver,b,Object(v.a)(this,
this.pSm,"onMenuButtonPointerOver"));Xh.a.instance.mb(kb.a.pointerOut,b,Object(v.a)(this,this.oSm,"onMenuButtonPointerOut"))}jw(b,h,n){Sys.UI.DomElement.containsCssClass(b,"cui-ctl-a1")?this.onb&&(this.t3.on=!this.t3.on,b=this.Nd,b.CommandValueId=this.control.szb(),this.root.executeCommand(this.Gs.Command,b,this.kk,h,!0,null,this.xea(n))):this.VRb&&super.jw(b,h,n)}Xw(b){const h=b.Ib.keyCode;return h===Sys.UI.Key.enter||h===Sys.UI.Key.space?(b=this.Nd,b.CommandValueId=this.control.szb(),this.root.executeCommand(this.Gs.Command,
b,this.kk,1,!0),!0):super.Xw(b)}xl(){const b=this.root.Xma(this.Gs.Command,this.Gs.QueryCommand,this.Nd),h=0<(b&1);let n=!0;n=ff.c(this.Gs.CommandMenuOpen)?h:0<(this.root.Xma(this.Gs.CommandMenuOpen,null,null)&1);if(n!==this.VRb||h!==this.onb||(n||h)!==this.control.enabled)this.control.enabled=n||h,h!==this.onb&&this.TPm(h),n!==this.VRb&&this.UPm(n),this.VRb=n,this.onb=h;if(0<(b&2)){this.dha();const x=Vf.a.koa(this.Nd[ae.a.LabelText],this.Gs.LabelText);this.Nd[ae.a.ApplyLabelTextToControlOnly]?this.t3.j1b(E=>
{E.wm.title=x;E.Gbb.removeAttribute("title");E.gEc.removeAttribute("title")}):this.t3.j1b(E=>{E.Gbb.title=x});this.Nd[ae.a.EnsureControlRoleIsButton]&&this.t3.j1b(E=>{qf.a.Gq(E.wm,qf.a.Ah,qf.a.n1)});ff.c(this.Nd[ae.a.Visible])||this.N3a()&&this.iQa()}this.t3.setState(this.t3.on&&h)}iQa(){this.f7f();this.ELb();this.dha()}UPm(b){this.t3.j1b(h=>{Vf.a.Pjb(h.gEc,b)});this.PWc();this.VRb=b}TPm(b){this.t3.j1b(h=>{Vf.a.Pjb(h.Gbb,b)});this.PWc();this.onb=b}PWc(){const b=this.t3.bdb();ff.c(b)||(Vf.a.Hu(b.childNodes[0],
"cui-ctl-split-hovered-primary"),Vf.a.Hu(b.childNodes[0],"cui-ctl-split-hovered-secondary"),Vf.a.Hu(b.childNodes[1],"cui-ctl-split-hovered-primary"),Vf.a.Hu(b.childNodes[1],"cui-ctl-split-hovered-secondary"))}Oyi(b){if(0!==me.a(b.Ib))return!1;let h=!1;b.eventName===kb.a.pointerDown?h=this.Bui(b):b.eventName===kb.a.$L&&(h=this.Cui(b));return h}Bui(b){let h=!1;const n=b.eg;switch(n){case 3:this.KTn()?this.jw(this.kk.Kc,n,b.Ib):this.fpd(this.t3.Wyh);h=!0;break;case 2:b.gaa===Sys.UI.MouseButton.leftButton&&
(this.fpd(this.t3.Wyh),h=!0)}h&&b.Ib.preventDefault();return!1}KTn(){const b=this.kk.GS;return"Small"===b||"Medium"===b||"Menu16"===b||"MenuTellMe"===b}Cui(b){return this.Mra(b)}LNm(b){return this.lVd(b)}KNm(b){return this.Mra(b)}onFocus(b){super.onFocus(b);this.$jf(!0,!0);return!1}onBlur(b){super.onFocus(b);this.PWc();return!1}JNm(){this.control.enabled&&this.onb&&this.$jf(!0,this.t3.on);return!1}INm(){this.control.enabled&&this.onb&&this.PWc();return!1}UFf(b){let h=!1;if(2!==b.eg||b.gaa===Sys.UI.MouseButton.leftButton)this.jw(b.Af,
b.eg,b.Ib),h=!0;h&&b.Ib.preventDefault();return!1}pSm(){this.control.enabled&&this.VRb&&this.$jf(this.t3.on,!0);return!1}oSm(){this.PWc();return!1}$jf(b,h){const n=this.control.bdb();ff.c(n)||(Vf.a.Pf(n.childNodes[0],b?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),Vf.a.Pf(n.childNodes[1],h?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))}xol(){var b=V.a.X_b;return b&&(b=b.split("."),2===b.length)?parseInt(b[0]):0}}Object(r.a)(cf,"SplitButtonBehavior",Tm,[]);
var qg=d(1360);class Gg extends Ri{constructor(b){super(b);this.Qpb=this.rxa=!1;this.YAj=!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("ExcelTableRenameEnabled")}get textBox(){return this.control}get rba(){return this.textBox.rba}get Z2f(){return this.textBox.Gh}JH(b){b=b.Sq;qc.a.instance.mb(kb.a.focus,b,Object(v.a)(this,this.onFocus,"onFocus"));qc.a.instance.mb(kb.a.blur,b,Object(v.a)(this,this.onBlur,"onBlur"));mc.KeyInputManager.instance.mb(kb.a.Di,b,Object(v.a)(this,this.onKeyDown,
"onKeyDown"));mc.KeyInputManager.instance.mb(kb.a.At,b,Object(v.a)(this,this.DF,"onKeyPress"));mc.KeyInputManager.instance.mb(kb.a.Bh,b,Object(v.a)(this,this.Xw,"onKeyUp"));qc.a.instance.mb(kb.a.change,b,Object(v.a)(this,this.laa,"onChange"));sf.a.instance.mb(kb.a.iaa,b,Object(v.a)(this,this.ANa,"onMouseUp"))}onFocus(b){super.onFocus(b);this.Qpb=!0;Vf.a.Pf(this.rba.wm,"cui-tb-focus");this.control.enabled&&rd.a.EYc(this.rba.Sq);return this.rxa=!1}onBlur(b){this.Qpb=!1;super.onBlur(b);Vf.a.Hu(this.rba.wm,
"cui-tb-focus");return!1}onKeyDown(b){let h=super.onKeyDown(b);if(!ff.c(b.Ib)&&!ff.c(b.Ib.rawEvent)){const n=b.Ib.keyCode,x=b.Ib.rawEvent.shiftKey;n===Sys.UI.Key.tab?(this.tS(),Object(pb.a)(lk.Ribbon,this.root)&&(h=this.root.Zce(this.kk.Kc,!x))):n===Sys.UI.Key.enter?this.YAj&&(this.tS(),Object(pb.a)(lk.Ribbon,this.root)&&this.root.hZ(),h=!0):n===Sys.UI.Key.esc?(this.Qbc(),Object(pb.a)(lk.Ribbon,this.root)&&this.root.hZ(),h=!0):n===Sys.UI.Key.backspace||n===Sys.UI.Key.del?h=!this.control.enabled:b.Nja&&
(af.a.Eih(b.Ib),h=!1)}return h}DF(){return!this.control.enabled}Xw(){return!1}laa(){this.tS();return!1}ANa(){return this.rba.isEditable?this.rxa?!1:this.rxa=!0:(rd.a.EYc(this.rba.Sq),!0)}ndc(b){this.rba.Sq.value!==b&&(this.rba.Sq.value=b)}Qbc(){this.ndc(this.Nd[qg.a.Text])}tS(){if(this.control.enabled&&this.rba.isEditable){const b=this.rba.Sq.value;b!==this.Nd[qg.a.Text]&&(this.Nd[qg.a.Text]=b,this.root.executeCommand(this.Z2f.Command,this.Nd,this.kk,0,!1))}else this.Qbc()}xl(){const b=this.Nd[qg.a.Text];
if(0<(this.Et(this.Z2f.Command,this.Z2f.QueryCommand,this.Nd)&2)&&!this.Qpb){const h=this.Nd[qg.a.Text];h!==b&&this.ndc(h)}}}Object(r.a)(Gg,"TextBoxBehavior",Ri,[346,347]);var Si=d(420);class li extends Ri{constructor(b){super(b)}get toggleButton(){return this.control}get properties(){return this.control.Gh}jw(b,h,n){this.control.enabled&&(Vf.a.Sea(this.properties.TogglesWhenExecuted)||this.toggle(),this.Nd.CommandValueId=this.toggleButton.szb(),this.Nd.MenuItemId=this.toggleButton.Gh.MenuItemId,
this.Nd.SourceControlId=this.control.id,this.root.executeCommand(this.properties.Command,this.Nd,this.kk,h,!Vf.a.Sea(this.properties.CloseMenuWhenExecuted),x=>{Vf.a.rr(this.properties.UpdateHtmlPostToggle)&&(32===x?this.J$i():this.H$i())},this.xea(n)))}H$i(){this.Nd[Qf.a.On]=!this.Nd[Qf.a.On]}J$i(){this.toggleButton.setState(this.Nd[Qf.a.On]);(this.toggleButton.Qva&&this.toggleButton.cce||Vf.a.rr(this.properties.UpdateHtmlPostToggle))&&this.iQa()}toggle(){this.H$i();Vf.a.rr(this.properties.UpdateHtmlPostToggle)||
this.J$i()}onKeyDown(b){const h=super.onKeyDown(b);if(!h&&!ff.c(b.Ib)&&this.VG){const n=b.Ib.keyCode;n!==Sys.UI.Key.enter&&n!==Sys.UI.Key.space||b.Ib.preventDefault()}return h}xl(){ff.c(this.properties.MenuItemId)||(this.Nd.MenuItemId=this.properties.MenuItemId);0<(this.Et(this.properties.Command,this.properties.QueryCommand,this.Nd)&2)&&this.N3a()&&this.iQa()}iQa(){this.toggleButton.setState(this.Nd[Qf.a.On]);this.Ifo(Vf.a.koa(this.Nd[Qf.a.DisplayMode],""));this.f7f();this.dha();this.pho();Qf.a.Alt in
this.Nd&&this.ELb()}pho(){const b=this.XD.N7b;if(b&&b.Hbb){var h=Vf.a.koa(this.Nd[Qf.a.Description],this.properties.Description);h!==b.Hbb.innerText&&(b.Hbb.innerText=h,b.FN&&!Object(pb.a)(Si.Jewel,this.root)&&(h=!ff.b(h),Vf.a.B3(b.FN,"UIFontBold",h),Vf.a.B3(b.FN,"cui-ctl-mediumlabel-nodescription",!h)))}}JH(b){b=b.wm;qc.a.instance.mb(kb.a.focus,b,Object(v.a)(this,this.onFocus,"onFocus"));qc.a.instance.mb(kb.a.blur,b,Object(v.a)(this,this.onBlur,"onBlur"));Xh.a.instance.mb(kb.a.pointerOver,b,Object(v.a)(this,
this.mX,"onPointerOver"));Xh.a.instance.mb(kb.a.pointerOut,b,Object(v.a)(this,this.cO,"onPointerOut"));mc.KeyInputManager.instance.mb(kb.a.Di,b,Object(v.a)(this,this.onKeyDown,"onKeyDown"));mc.KeyInputManager.instance.mb(kb.a.Bh,b,Object(v.a)(this,this.Xw,"onKeyUp"));Xh.a.instance.mb(kb.a.pointerDown,b,Object(v.a)(this,this.NB,"onPointerDown"));Xh.a.instance.mb(kb.a.$L,b,Object(v.a)(this,this.nua,"onPointerUp"));$e.a.instance.mb(kb.a.click,b,Object(v.a)(this,this.onClick,"onClick"));dj.a.instance.mb(kb.a.tO,
b,Object(v.a)(this,this.$hb,"onTouchMove"));dj.a.instance.mb(kb.a.QI,b,Object(v.a)(this,this.PCa,"onTouchEnd"))}}Object(r.a)(li,"ToggleButtonBehavior",Ri,[]);class Xl{constructor(b){this.Axj=b;this.Qne={["Button"]:h=>new Zo(h),["FileMenuButton"]:h=>new Zo(h),["ColorPicker"]:h=>new ro(h),["ComboBox"]:h=>new ji(h),["ContextMenuControl"]:h=>new ki(h),["ContextMenuLauncher"]:h=>new ki(h),["DialogMenuLauncher"]:h=>new ym(h),["DropDown"]:h=>new Mf(h),["FlyoutAnchor"]:h=>new Rg(h),["GalleryButton"]:h=>new Jn(h),
["StatefulColorFlyoutAnchor"]:h=>new Rg(h),["JewelMenuLauncher"]:h=>new hd(h),["Label"]:h=>new aa(h),["Placeholder"]:h=>new Ri(h),["SearchBox"]:h=>new jc(h),["Separator"]:h=>new Ri(h),["SplitButton"]:h=>new cf(h),["StatefulColorSplitButton"]:h=>new cf(h),["StatefulImageSplitButton"]:h=>new cf(h),["TextBox"]:h=>new Gg(h),["ToggleButton"]:h=>new li(h)}}IBh(){this.Qne[$k.Control.F7h]=b=>new Hc(b)}a5e(){this.Qne[$k.Control.h5i]=b=>new ee(b)}Zgl(b){const h=this.Qne[b.controlType];(b=h?h(b):null)&&this.Axj&&
b.o_k();return b}static get instance(){return Xl._instance||(Xl._instance=new Xl(!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("CUICommitChangeFixIsEnabled")))}}Xl._instance=null;Object(r.a)(Xl,"ControlBehaviorFactory",null,[321]);var Wn=d(944),Wj=d(168);class xl extends Im.MenuLauncher{constructor(b,h,n,x){super(b,h,n,x);this.bNg=null;this.KIa=this.Ywc=0;this.kE=null;this.eqc=this.dqc=0;this.ih("Menu");this.enabled=!0}get x(){return this.Ywc}get y(){return this.KIa}get Cuf(){return this.dqc}get Duf(){return this.eqc}get controlType(){return"DialogMenuLauncher"}e2a(){}D3a(){}Oaf(){const b=
{};b.MenuId=this.id;b.DialogMoveCommand=this.Gs.DialogMoveCommand;b.DialogCloseCommand=this.Gs.DialogCloseCommand;return b}hom(b,h){this.Ywc=b.x;this.KIa=b.y;this.dqc=b.height;this.eqc=b.width;this.IZ(h)}uP(b){this.bNg=Vf.a.createElement("span");return new Wj.a(b,this.bNg)}get Gs(){return this.Gh}yra(b,h,n){return new xl(b,this.id,h,n)}}Object(r.a)(xl,"DialogMenuLauncher",Im.MenuLauncher,[]);var pp=d(797);class gh extends Wn.a{constructor(b,h){super(b,h);this.E4a=null}get hMe(){return this.E4a}get Oxh(){return this.properties}get f7(){return 20}jm(){super.jm();
ff.c(this.Kc)&&this.uB();this.Kc=Vf.a.sOa(this.Kc);this.PV(this.Kc);this.dirty=!1}HN(b){if(!Object(pb.a)(pp.a,b))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot");}lZe(b,h,n,x){n=new Fk.Menu(this,h,n,x,null);b||(b={});b.CommandMenuOpen=this.Oxh.CommandMenuOpen;b.CommandMenuClose=this.Oxh.CommandMenuClose;b=new xl(this,h,b,n);this.fxb[h]=b;h=new pp.a(this,"dock"+h);h.Sf(b.vP("Menu"));this.Sf(h);this.refresh()}PZf(b,h,n,x){const E=this.fxb[b];if(ff.c(E))throw Error.create('The dialog menu "'+
b+'" does not exist');E.hom(new Sys.UI.Bounds(h,n,0,0),x);this.E4a=E.menu}bWe(b){b=this.fxb[b];ff.c(b)||(b.sra(),this.E4a=null)}zWd(){this.E4a=null}dispose(){const b=this.fxb;for(let h in b)b[h].dispose();super.dispose()}}Object(r.a)(gh,"DialogMenuRoot",Wn.a,[]);class Nk{constructor(){this.LabelText=this.TextDirection=this.ImageSpinner=this.ImageExpandedArrowClass=this.ImageExpandedArrow=this.ImageCollapsedArrowClass=this.ImageCollapsedArrow=this.ImageUncheckMarkClass=this.ImageUncheckMark=this.ImageCheckMarkClass=
this.ImageCheckMark=this.ImageUpArrow8by8Class=this.ImageUpArrow8by8=this.ImageUpArrowClass=this.ImageUpArrow=this.ImageSideArrowClass=this.ImageSideArrow=this.ImageDownArrow8by8Class=this.ImageDownArrow8by8=this.ImageDownArrowClass=this.ImageDownArrow=this.DivSyndicated=null}}Object(r.a)(Nk,"RootProperties",null,[]);class Eq extends Nk{constructor(){super()}}Object(r.a)(Eq,"StandaloneRootProperties",Nk,[]);class el extends Eq{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}
Object(r.a)(el,"DialogMenuRootProperties",Eq,[]);class Pl{constructor(){const b=new el;b.ImageSideArrow=u.AFrameworkApplication.mr;b.ImageSideArrowClass=Tg.getImageClass("SubmenuFlyoutArrow_13x13x32");b.TextDirection=u.AFrameworkApplication.isRtl?"rtl":"ltr";this.yd=new gh("DialogMenuRootId",b);this.yd.kE=this;this.yd.refresh();u.AFrameworkApplication.ya.gb(Ra.a.vKf,Ld.a.frame,Object(v.a)(this,this.vKf,"populateDialogMenu"),96)}get D_(){return this.yd}rKa(b,h,n,x,E=null){b=parseInt(b);x=u.AFrameworkApplication.ya;
n&&(x.yG=n.CommandLocation,x.k6=n.InvocationMethod);h=x.Xb(b,2,h,E);this.yd.refresh();return 32===h}ZBa(b){return b?32===u.AFrameworkApplication.ya.processAction(parseInt(b),1):!0}Et(){this.D_.root.xl()}lZe(b,h,n){const x={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};x.DialogMoveCommand=h;x.DialogCloseCommand=n;this.D_.lZe(x,b,"","")}PZf(b,h,n,x){this.D_.PZf(b,h,n,x)}bWe(b){this.D_.bWe(b)}vKf(b,h,n,x,E){if(1===n)return 32;b=new Sys.StringBuilder;
b.append('<Menu Id="dialogMenu">');b.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');b.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',E.DialogMoveCommand,CommonUIStrings.l_DialogMove));b.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',E.DialogCloseCommand,CommonUIStrings.l_DialogClose));b.append("</Controls></MenuSection>");b.append("</Menu>");E.PopulationXML=b.toString();return 32}dispose(){this.yd&&
(this.yd.dispose(),this.yd=null)}}Object(r.a)(Pl,"DialogMenuRootUser",null,[243,10,284]);class uo{constructor(b,h,n){this.Vnb=this.Cld=this.lrc=this.Tl=null;this.vre=this.Okd=!1;this.lnc=b;this.re=h;this.Er=n;this.VQb=u.AFrameworkApplication.isRtl}get klf(){return this.vre}P1k(b){b?(this.Tl=b,this.vre=!0,this.Okd=!1,this.re.capture(Object(v.a)(this,this.Smm,"keyEventHandler"),null),this.Er.mb(kb.a.pointerDown,this.lnc,Object(v.a)(this,this.oac,"pointerDownHandler")),this.lrc||this.rJk(),this.Tl.appendChild(this.lrc),
this.R0l()):w.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")}E6e(){this.vre=!1;this.Cld=this.Vnb=null;this.Xnn();this.fQf();this.Tl=null}fQf(){this.re.releaseCapture();this.Er.sc(kb.a.pointerDown,this.lnc,Object(v.a)(this,this.oac,"pointerDownHandler"))}R0l(){if(this.Tl.style.left.endsWith("px")&&this.Tl.style.right.endsWith("px"))this.Vnb=new Sys.UI.Point(Hm.a.rX(this.VQb?this.Tl.style.right:this.Tl.style.left),Hm.a.rX(this.Tl.style.top));else{const b=this.VQb?this.lnc.offsetWidth-
(this.Tl.offsetLeft+this.Tl.offsetWidth+Hm.a.rX(this.Tl.style.marginRight)):this.Tl.offsetLeft-Hm.a.rX(this.Tl.style.marginLeft),h=this.Tl.offsetTop-Hm.a.rX(this.Tl.style.marginTop);this.AZi(b,h);this.Vnb=new Sys.UI.Point(b,h)}this.Cld=this.Vnb}rJk(){this.lrc=Tg.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}Xnn(){this.lrc.parentNode===this.Tl&&this.Tl.removeChild(this.lrc)}Smm(b){if(!this.klf)return!1;b.Ib.preventDefault();if(b.eventName===kb.a.Di){const h=b.Ib.ctrlKey?
1:10;let n;switch(b.Ib.keyCode){case db.a.N7:this.f9b(0,-1*h);break;case db.a.gha:this.f9b(0,1*h);break;case db.a.PLb:n=this.VQb?1:-1;this.f9b(n*h,0);break;case db.a.QLb:n=this.VQb?-1:1;this.f9b(n*h,0);break;case db.a.R3a:this.qqi(this.Cld.x,this.Cld.y);this.Okd=!0;break;case db.a.Ks:this.Okd=!0}}b.eventName===kb.a.Bh&&this.Okd&&this.E6e();return!0}oac(b){if(!this.klf)return!1;b.Ib.preventDefault();this.E6e();return!0}f9b(b,h){this.qqi(this.Vnb.x+b,this.Vnb.y+h)}qqi(b,h){b=this.G8j(b,h);this.AZi(b.x,
b.y);this.Vnb=b}AZi(b,h){this.VQb?this.Tl.style.right=b+"px":this.Tl.style.left=b+"px";this.Tl.style.top=h+"px"}G8j(b,h){const n=this.VQb?Hm.a.rX(this.Tl.style.marginRight):Hm.a.rX(this.Tl.style.marginLeft),x=Hm.a.rX(this.Tl.style.marginTop);return new Sys.UI.Point(Math.min(Math.max(-n,b),this.lnc.offsetWidth-this.Tl.offsetWidth-n),Math.min(Math.max(-x,h),this.lnc.offsetHeight-this.Tl.offsetHeight-x))}}Object(r.a)(uo,"KeyMoveAdapter",null,[285]);var dm=d(1084),qp=d(558);class Xr{get name(){return"CUI.Behavior"}zc(b){u.AFrameworkApplication.K&&
u.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&(b.register(284,"Common.UI.IDialogMenuRootUser").singleInstance().Xd(()=>new Pl),b.register(285,"Common.IKeyMoveAdapter").singleInstance().Xd(()=>new uo(u.AFrameworkApplication.ua.Qka(),mc.KeyInputManager.instance,Xh.a.instance)));b.register(qp.a,"CommandUI.RootManager").as("Common.IRootManager").singleInstance().Xd(()=>qp.a.instance)}init(){dm.a.jYe=Xl.instance;const b=qp.a.instance.PRi;for(let h=0;h<b.length;++h){const n=Object(ja.a)(286,
b[h]);n&&n.kKa()}cj.a.get_instance().KI(6)}dispose(){}static main(){N.a.instance.Pc(new Xr,5)}}Object(r.a)(Xr,"CuiBehaviorPackage",null,[1,2]);class km{constructor(b){const h=new Eq;h.ImageUpArrow=h.ImageDownArrow=h.ImageSideArrow=h.ImageCheckMark=h.ImageUncheckMark=h.ImageDownArrow8by8=h.ImageUpArrow8by8=b;h.ImageUpArrowClass=Tg.getImageClass("RibbonUpArrow_5x3x32");h.ImageDownArrowClass=Tg.getImageClass("SplitButtonArrow_5x3x32");h.ImageUpArrow8by8Class=Tg.getImageClass("RibbonUpArrow_8x8x32");
h.ImageDownArrow8by8Class=Tg.getImageClass("SplitButtonArrow_8x8x32");h.ImageSideArrowClass=Tg.getImageClass("SubmenuFlyoutArrow_13x13x32");h.ImageCheckMarkClass=Tg.getImageClass("CheckboxChecked_16x16x32");h.ImageUncheckMarkClass=Tg.getImageClass("CheckboxUnchecked_16x16x32");h.TextDirection=u.AFrameworkApplication.isRtl?"rtl":"ltr";this.dw=Wn.a.GLk(h);this.dw.refresh()}get q3(){return this.dw}dispose(){this.dw.dispose()}}Object(r.a)(km,"StandaloneRootController",null,[837,10]);var Um=d(1110),xf=
d(236);class Ap{constructor(b){this.Ntc=b}create(b,h){const n=new Sys.StringBuilder;this.lCc(n,b,h);this.IZe(n,b);return n.toString()}Wwb(b,h){const n=[];this.s_e(n,b,h);this.JZe(n,b);return n}lCc(b,h,n){switch(h.errorType){case 0:b.append(this.Ntc.build());break;case 1:case 2:b.append(this.ZSe(h,n))}}s_e(b,h,n){switch(h.errorType){case 0:b.push(this.Ntc.dgh());break;case 1:case 2:b.push(this.Bjk(h,n))}}IZe(b,h){b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>');b.append(xf.a("btnIgrnoreSpellingError",
(2===h.errorType?Db.a.LEa:Db.a.Vsa).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null));b.append("</Controls></MenuSection>")}JZe(b,h){const n=Object.assign(new Fh.a,{ControlList:[]});h=2===h.errorType?"UnknownSpellingError":"IgnoreSpellingError";n.ControlList.push(Object.assign(new Pg.a,{ExternalId:h}));b.push(n)}ZSe(b,h){b=this.Hdl(b.suggestions,h);return 0<b.length?xf.h("msUnknownWord",xf.d(null,b),"Menu16"):xf.h("msUnknownWord",xf.d(null,[xf.a("btnNoSuggestions",Db.a.LEa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,
null)]),"Menu16")}Hdl(b,h){const n=[];if(b){const x=Math.min(h.length,b.length);for(let E=0;E<x;++E)b[E]&&n.push(xf.a("btnCorrectWord"+E,h[E].toString(),b[E]))}return n}Bjk(b,h){const n=Object.assign(new Fh.a,{Id:"Suggestions",ControlList:[]});this.Gdl(b.suggestions,h,n.ControlList);0>=n.ControlList.length&&(b=Object.assign(new Pg.a,{ExternalId:"NoSuggestions"}),n.ControlList.push(b));return n}Gdl(b,h,n){if(b){const x=Math.min(h.length,b.length);for(let E=0;E<x;++E){if(!b[E])continue;const S=Object.assign(new Pg.a,
{ExternalId:"btnCorrectWord"+E,Command:h[E].toString(),LabelText:b[E]});n.push(S)}}}}Object(r.a)(Ap,"DefaultProofingContextMenuCreator",null,[]);var Ok=d(693);class Li{constructor(b,h){this.izg=b;this.eBg=h;this.Tia=[Db.a.clb,Db.a.dlb,Db.a.elb,Db.a.DKb,Db.a.EKb]}create(b,h){return h?Object(pb.a)(Ok.a,h)?this.eBg.create(b,h,this.Tia):this.izg.create(h,this.Tia):""}JZb(b,h){return h?Object(pb.a)(Ok.a,h)?this.eBg.Wwb(b,h,this.Tia):this.izg.Wwb(h,this.Tia):null}}Object(r.a)(Li,"ProofingContextMenuSectionFactory",
null,[476]);class Gk{build(){const b=[xf.a("btnDeleteRepeatedWord",Db.a.Mza.toString(),Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return xf.h("msRepeatedWord",xf.d(null,b),"Menu16")}dgh(){const b=Object.assign(new Fh.a,{ControlList:[]}),h=Object.assign(new Pg.a,{ExternalId:"DeleteRepeatedWord"});b.ControlList.push(h);return b}}Object(r.a)(Gk,"ProofingRepeatedWordSectionBuilder",null,[475]);var ah=d(605);class gr{static get ug(){return Kc.a.Lx(gr.rl,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,
Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}gr.rl="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> </table> </div>";
Object(r.a)(gr,"AutoCorrectOptionsDialogHTML",null,[]);class Yr{static get ug(){return Kc.a.Lx(Yr.rl,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}Yr.rl="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='ReplaceQuoteWithSmartQuoteLabel' class='\"WACDialogInlineLabel\"' for='ReplaceQuoteWithSmartQuote'>{8}</label> </td> </tr> </table> </div>";
Object(r.a)(Yr,"AutoCorrectOptionsDialogHTML2",null,[]);class Mo extends Kc.a{constructor(b,h){super();this.oFn=(n,x)=>{Of.a.instance.J(9)&&(1!==n?w.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):x.ReplaceTextAsYouType!==this.EU.vOa||x.CapitalizeFirstLetterOfSentences!==this.EU.Qsd||x.ReplaceOrdianalsWithSuperscript!==this.EU.R2d||x.ReplaceHyphensWithDash!==this.EU.sXc||x.ReplaceFractionsWithFractionCharacter!==this.EU.Q2d||this.Bca&&x.ReplaceQuoteWithSmartQuote!==
this.EU.$Rf?(n={},n.ReplaceTextAsYouType=x.ReplaceTextAsYouType,n.CapitalizeFirstLetterOfSentences=x.CapitalizeFirstLetterOfSentences,n.ReplaceOrdianalsWithSuperscript=x.ReplaceOrdianalsWithSuperscript,n.ReplaceHyphensWithDash=x.ReplaceHyphensWithDash,n.ReplaceFractionsWithFractionCharacter=x.ReplaceFractionsWithFractionCharacter,this.Bca&&(n.ReplaceQuoteWithSmartQuote=x.ReplaceQuoteWithSmartQuote),this.EU.tzn(n),w.ULS.sendTraceTag(24523524,324,50,"User close the option dialog and trigger to save the setting: {0}"+
{["ReplaceTextAsYouType"]:x.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:x.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:x.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:x.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:x.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.Bca,["ReplaceQuoteWithSmartQuote"]:this.Bca&&x.ReplaceQuoteWithSmartQuote}),ob.App.xa.updateCommandUI(!0)):w.ULS.sendTraceTag(24523523,
324,50,"User close the option dialog or cancle it without do any changes."))};this.EU=b;this.Bca=h;this.kg="AutoCorrectOptionsDialog"}f_f(){w.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.ug=this.Bca?Yr.ug:gr.ug;const b={};b.ReplaceTextAsYouType=this.EU.vOa;b.CapitalizeFirstLetterOfSentences=this.EU.Qsd;b.ReplaceOrdianalsWithSuperscript=this.EU.R2d;b.ReplaceHyphensWithDash=this.EU.sXc;b.ReplaceFractionsWithFractionCharacter=this.EU.Q2d;this.Bca&&(b.ReplaceQuoteWithSmartQuote=
this.EU.$Rf);this.Zh(Box4Intl.Box4Strings.l_AutoCorrectOptions,this.oFn,b)}}Object(r.a)(Mo,"AutoCorrectOptionsDialog",Kc.a,[474]);class sn{static get ug(){return Kc.a.Lx(sn.rl,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}sn.rl="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(r.a)(sn,"AltTextDialogWithDescriptionHtml",null,[]);class Hf extends Kc.a{constructor(b=!1){super(!1,!1,b);this.ug=sn.ug;this.kg=b?"AltTextDialog":"BaseAltTextDialogWithDescription"}QYe(b){this.Zh(CommonUIStrings.l_AlternativeTextDialogTitle,Object(v.a)(this,this.R9j,"altTextDialogHandler"),this.Sbf(b));b=document.getElementById(Hf.$Oe);b.focus();b.select()}Sbf(b){const h={};h[Hf.$Oe]=this.M$e(b);h[Hf.ZOe]=this.ynl(b)||"";return h}L1(b){return b.Af.id===Hf.ZOe?!1:super.L1(b)}}Hf.$Oe="titleText";
Hf.ZOe="descriptionText";Object(r.a)(Hf,"BaseAltTextDialogWithDescription",Kc.a,[]);var ag=d(38);class Bp extends Hf{constructor(b,h,n,x,E){super();this.y9a=this.C7c=null;this.Gw=h;this.Yj=n;this.Hc=x;this.Hd=E;this.QYe(b)}ynl(b){this.C7c=b.node;this.y9a=ag.TableReader.HYh(b);return ag.TableReader.Kgf(this.y9a)}M$e(b){this.C7c=b.node;this.y9a=ag.TableReader.HYh(b);return ag.TableReader.Lgf(this.y9a)}R9j(b,h){if(1===b){b=ag.TableReader.Lgf(this.y9a);const n=ag.TableReader.Kgf(this.y9a),x=h[Hf.$Oe];
h=h[Hf.ZOe];this.hide();const E=this.Hc.Rc(15);try{E.Db(this.C7c),this.Gw.KXf(this.y9a,x),this.Gw.FZi(this.y9a,h)}finally{E&&E.dispose()}x===b&&h===n||this.Hd.us(16)}Of.a.instance.J(4)&&this.Yj.Kp&&this.Yj.Jq.sG(this.C7c)}}Object(r.a)(Bp,"TableAltTextDialog",Hf,[]);class Cp{constructor(b,h,n){this.Gw=b;this.Hc=h;this.Hd=n}create(b){return new Bp(b,this.Gw,ob.App.rd,this.Hc,this.Hd)}}Object(r.a)(Cp,"TableAltTextDialogFactory",null,[]);const No=()=>{ob.App.u$g=!0;return 32},rp=(b,h,n,x,E)=>{if(1===
n)return 32;if(!({point:b,Qw:h}=hr(E)).returnValue)return 16;ob.App.xa.$dc(b,h);return 32},sq=(b,h,n,x,E)=>{if(1===n)return 32;if(!({point:b,Qw:h}=hr(E)).returnValue)return 16;ob.App.xa.Zaa(b,h);return 32},hr=b=>{let h=null,n=0;if(!b)return{returnValue:!1,point:h,Qw:n};b=b.split(",");if(3>b.length)return{returnValue:!1,point:h,Qw:n};h=new Sys.UI.Point(parseInt(b[0]),parseInt(b[1]));n=parseInt(b[2]);return{returnValue:!0,point:h,Qw:n}};var Ql=d(1748);class mj extends Sys.EventArgs{constructor(b,h,
n,x,E,S=0,ma=0,Fa=null){super();this.controlId=b;this.commandId=x;this.time=E;this.commandSurface=S;this.Qw=ma;this.contentType=Fa}}Object(r.a)(mj,"CommandClickEventArgs",Sys.EventArgs,[]);class lm{constructor(b,h){this.tpa=b.Dbf();this.Kkc=b;this.z4a=h}rKa(b,h,n,x=null,E=null){n&&(this.z4a.yG=n.CommandLocation,this.z4a.k6=n.InvocationMethod,this.z4a.rab=n.CommandTabName);b=parseInt(b);let S=this.Kkc.KOh(b,h,n);S.EBf&&(S=this.Kkc.KOh(S.YK,h,n));if(void 0!==S.QWa&&null!==S.QWa)return S.QWa;if(S.cBb)E=
32;else{var ma=null;this.tpa&&this.tpa.QKf&&(ma=this.tpa.QKf(S,E));S.Zea||S.cOc?S.hAa?E=16:(E=this.z4a.Xb(S.YK,S.F6b?2:1,S.Bd,E),2===E&&(E=32)):S.hAa?E=this.z4a.bna(null,S.YK,S.Bd,Fa=>{x&&x(Fa.response)},E):(E=this.z4a.Xb(S.YK,2,S.Bd,E),x&&x(E));this.tpa&&this.tpa.LKf&&this.tpa.LKf(S,E,ma);if(h&&n&&-1!==n.InvocationMethod&&n.InvocationMethod){n=h.LegacyId;if(void 0===n||null===n)n="";ma=h.ParentMenuId;void 0!==ma&&null!==ma||!h.MenuId||(ma=h.MenuId);let Fa=h.SqmControlId;void 0!==Fa&&null!==Fa||!h.SourceControlId||
(Fa=h.SourceControlId);(void 0!==Fa&&null!==Fa||void 0!==ma&&null!==ma)&&Ql.a.Mbn(new mj(Fa,n,ma,pd.ActionManager.Sca(b),Date.now()))}}S.Zea&&32===E&&this.tpa&&this.tpa.Dya&&this.tpa.Dya(S,h);S.cOc&&32===E&&this.tpa&&this.tpa.bVa&&this.tpa.bVa(S,h);return 32===E||1===E}ZBa(b,h=null){if(u.AFrameworkApplication.Dk||Ye.a.instance.Iv)return!1;null!=h&&null!=h.UILocation&&(this.z4a.yG=h.UILocation);const n=parseInt(b);if(!b||n===pd.ActionManager.R4e)return!0;b=this.Kkc.BOh(n,h);b.EBf&&(b=this.Kkc.BOh(b.YK,
h));if(void 0!==b.QWa&&null!==b.QWa)return b.QWa;n===Ra.a.iWb&&h&&(b.Bd=h);return 32===this.z4a.Xb(b.YK,1,b.Bd)}clearCache(){this.Kkc.clearCache()}}Object(r.a)(lm,"GeneralCuiUser",null,[242,243]);var Xn=d(186),Hk=d(61),jh=d(48),Km=d(1369);class tq{constructor(b,h,n,x){this.xAg="DocumentProofingFailed";this.xIe=b;this.g1g=h;this.m6c=n;this.zH=x}get ZQ(){return null!=this.frg?this.frg:this.frg=Oa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}cGl(){let b=this.zH.kDl(this.xIe);return{returnValue:this.zH.VXa(this.xIe),
x9m:b}}oho(b,h){const n=Hk.a.Mx();if(n){var x=new Xn.ScriptSharpLegacyMap;x.add(ie.a.eE,b);x.add(ic.a.noProof,h);b=new Se.GraphTransaction(15);b.Db(n);this.ZQ.c9b(jh.StyleReader.wordStyleIdNormal,x,n)?Km.a.Zaj():(w.ULS.sendTraceTag(555775183,375,10,"Style could not be modified"),Km.a.recordQosError(this.xAg,[Km.a.mtc],"Style could not be modified"));b.dispose()}else w.ULS.sendTraceTag(555775182,375,10,"PageContentNode not found"),Km.a.recordQosError(this.xAg,[Km.a.mtc],"PageContentNode not found")}SGn(b,
h){this.oho(b,h)}dMn(b,h){if(this.g1g){var n=new qi.DictionaryPropertySet;this.m6c.execute(x=>{x.zEc(b)});n.setValue(ie.a.eE,b);n.setValue(ic.a.noProof,h);h=new Se.GraphTransaction(15);h.set(ob.App.Wj.al);this.g1g.m7(n);h.dispose()}}xf(){return Kd.SelectionEditor.xf(this.xIe)}}Object(r.a)(tq,"LanguageEditor",null,[473]);var Lm=d(609),mm=d(229),tj=d(91);class Yn{constructor(b=!1,h=0){this.languages=Yn.JXh(vj.a.nml());this.ked=new mm.a;this.fOa=[];this.nTb=new Lm.a;this.HIi=b;this.QVg=0>=h?7:h;this.PVg=
this.PCe=0;this.sFg=!1;b&&(this.Z1l(),u.AFrameworkApplication.rK(()=>{this.Kym()}))}Z1l(){for(var b of this.languages)this.ked.Z(b.LCID,b);b=[];try{const x=Ya.a.get("RecentlyUsedLcids");if(x&&""!==x){const E=decodeURIComponent(x).split(",").slice(0,this.QVg);for(const S of E){let ma;({value:ma}=this.ked.Dc(parseInt(S),ma)).returnValue&&b.push(ma)}}}catch(x){w.ULS.sendTraceTag(38385057,324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",x.message),Array.clear(b)}if(b.length)for(var h of b){var n=
h.LCID;this.nTb.contains(n)||(this.fOa.push(h),this.nTb.add(n))}else h=u.AFrameworkApplication.lcid,({value:n}=this.ked.Dc(h,n)).returnValue&&(this.fOa.push(n),this.nTb.add(h));this.SSi()}SSi(){const b=tj.toArray(tj.select(tj.asEnumerable(this.fOa),h=>h.LCID)).join(",");Ya.a.hPa("RecentlyUsedLcids",b,180)}Jul(b){let h,n=-1,x=null;var E=Yn.JXh(this.fOa);this.HIi&&0<E.length&&(x=tj.toArray(tj.Si(tj.asEnumerable(E),(Fa,$a)=>{b===Fa.LCID&&-1===n&&(n=$a);return{["key"]:$a,["text"]:Fa.displayName,["value"]:Fa.LCID.toString()}})));
let S=0;x&&(S=x.length);E=S;const ma=tj.toArray(tj.Si(tj.asEnumerable(this.languages),(Fa,$a)=>{b===Fa.LCID&&-1===n&&(n=S+$a);return{["key"]:S+$a,["text"]:Fa.displayName,["value"]:Fa.LCID.toString()}}));h=n;return 0<S?{returnValue:x.concat.apply(x,ma),selectedIndex:h,z5i:E}:{returnValue:ma,selectedIndex:h,z5i:E}}cJn(b,h){if(this.HIi&&({value:n}=this.ked.Dc(b,n)).returnValue){h=b!==h;if(this.nTb.contains(b))b=Array.indexOf(this.fOa,n),0<=b&&(Array.removeAt(this.fOa,b),this.fOa.push(n)),h&&this.PCe++;
else{this.nTb.add(b);this.fOa.push(n);if(this.fOa.length>this.QVg){var n=this.fOa.shift();this.nTb.remove(n.LCID)}h&&this.PVg++}this.SSi()}}Kym(){const b=this.PCe+this.PVg;!this.sFg&&0<b&&(w.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",100*this.PCe/b),this.sFg=!0)}static JXh(b){b=Array.clone(b);b.sort((h,n)=>h.displayName.localeCompare(n.displayName));return b}}Object(r.a)(Yn,"LanguageListHelper",null,[472]);var Zi=d(193);class ap extends Zi.a{constructor(){super();this.Type=
this.Number=0}get ControlType(){return 10}}Object(r.a)(ap,"NumberButtonProps",Zi.a,[]);var Rl=d(228);class Rj{static get FX(){return null!=Rj.Rog?Rj.Rog:Rj.Rog=Oa.a.instance.Pa("Box4.ISpacingCommands")}static get Tg(){return Rl.ContextSetEditor.instance}static get JT(){return null!=Rj.Vlg?Rj.Vlg:Rj.Vlg=Oa.a.instance.Pa("Box4.ILineSpacingHelper")}static get z1i(){return!!Rj.FX}static Vb(){const b=u.AFrameworkApplication.ya;b.pa(Db.a.uac,cc.a.view,Rj.uac);b.Vc(Db.a.uac,1124);b.pa(Db.a.uac,cc.a.paragraph,
Rj.uho)}static uac(b,h,n,x,E){if(1===n||!Rj.z1i)return Rj.z1i?32:8;if(!Rj.Zci){var S=[];S.push(Object.assign(new ap,{ExternalId:"LineSpacing1_00",Number:1,Type:0}));S.push(Object.assign(new ap,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0}));S.push(Object.assign(new ap,{ExternalId:"LineSpacing1_50",Number:1.5,Type:0}));S.push(Object.assign(new ap,{ExternalId:"LineSpacing2_00",Number:2,Type:0}));S.push(Object.assign(new ap,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0}));S.push(Object.assign(new ap,
{ExternalId:"LineSpacing3_00",Number:3,Type:0}));E.MenuItems=xf.f(S);Rj.Zci=!0}w.ULS.sendTraceTag(588394560,340,50,"Line Spacing Menu is opened");h=h.view.Cb;S=null;h&&h.ib.kb&&(S=h.ib.kb);h=Rj.Tg.mJh(S.Qa);u.AFrameworkApplication.ya.Qf(h,b,n,!0,x,E);return 32}static uho(b,h){let n=b=!0;h=Rj.JT.JAa(h.node);var x=h.beforeSpacing;let E=!1;1===x.unit&&(E=!0);if(E||0<x.value)b=!1;h=h.afterSpacing;x=!1;1===h.unit&&(x=!0);if(x||0<h.value)n=!1;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Rj.J3j,
!b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Rj.Jon,b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Rj.I3j,!n));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Rj.Ion,n));return 32}}Rj.J3j="AddSpaceBeforeParagraph";Rj.I3j="AddSpaceAfterParagraph";Rj.Jon="RemoveSpaceBeforeParagraph";Rj.Ion="RemoveSpaceAfterParagraph";Rj.Zci=!1;Object(r.a)(Rj,"LineSpacingRibbonMenu",null,[]);var Cj=d(190),Qs=d(1378),ur=d(1355);const Uq=(b,h,n)=>{if(1===
n)return 32;b=ob.App.xa.notificationBar.qza("Automation test",!1);b.image=3;ob.App.xa.notificationBar.eB(b);return 32},it=(b,h,n,x,E)=>{let S;if(!({Thj:S}=Ik(E)).returnValue)return 16;Cj.UISurfaces.UP().then(ma=>{let Fa=null;var $a=Object.assign(new Qs.a,{label:"OK",onExecute:()=>{Fa&&ma.removeNotification(Fa)}});$a=Object.assign(new ur.a,{target:"#"+Qe.AppFrame.LTf,content:"Here's the text for the callout",title:"Your title",primaryButtonProps:$a,useTeachingStyles:S});$a=ma.callout($a);Fa=ma.addNotification($a);
return null},ma=>{w.ULS.sendTraceTag(593352341,383,15,"Failed to GetNotificationsAPIAsync: {0}",ma);return null});return 32},Ik=b=>{let h=!1;if(!b)return{returnValue:!1,Thj:h};h=Boolean.parse(b);return{returnValue:!0,Thj:h}};var aq=d(1429);let Cn,Dn,Xj,Yj;class Mm{constructor(){this.Kxa=new Qa.a;this.CKg=!1}g$a(b){const h=this.Kxa.indexOf(b);let n=!0;if(-1!==h){n=!1;if(!h)return n;this.Kxa.removeAt(h)}this.Kxa.insert(0,b);w.ULS.sendTraceTag(594899716,340,50,"{0} is added at the start of recent color list.",
b);11===this.Kxa.count&&(w.ULS.sendTraceTag(594899715,340,50,"Removing {0} from the recent color list.",this.Kxa.J(10)),this.Kxa.removeAt(10));this.Tio();return n}Tio(){w.ULS.sendTraceTag(594899714,340,50,"Sending a redux action to populate the recent colors menu section");const b=[];for(let n=0;n<this.Kxa.count;n++){var h="#"+this.Kxa.J(n).substring(4,6)+this.Kxa.J(n).substring(2,4)+this.Kxa.J(n).substring(0,2);h=Object.assign(new aq.a,{Color:this.Kxa.J(n),Alt:h,DisplayColor:h});b.push(appChrome.api.colorPickerCell(h.Color,
h.DisplayColor,h.Alt))}for(const n of Mm.uQj)appChrome.api.dispatch(appChrome.actions.populateColorPickerCells(n,b));this.CKg||this.Sho();this.CKg=!0}Sho(){for(const b of Object.keys(Mm.fPg)){w.ULS.sendTraceTag(594899713,340,50,"Sending a redux action to update the {0} menu",b);const h=Mm.fPg[b],n=[];for(const x of h)n.push(appChrome.api.menuSection([x],x in Mm.Hxe?Mm.Hxe[x].toString():null));appChrome.api.dispatch(appChrome.actions.updateMenu(b,n,Mm.Hxe[b].toString()))}}}Mm.fPg={["FontColor"]:(Yj=
new Qa.a,Yj.add("AutomaticFontColor"),Yj.add("ThemeFontColorPickerMCU"),Yj.add("ThemeFontColorPicker"),Yj.add("StandardFontColorPicker"),Yj.add("RecentFontColorPicker"),Yj.add("MoreFontColors"),Yj),["CellShading"]:(Xj=new Qa.a,Xj.add("ThemeShadingColorPickerMCU"),Xj.add("ThemeShadingColorPicker"),Xj.add("StandardShadingColorPicker"),Xj.add("RecentCellShadingColorPicker"),Xj.add("ClearShadingColor"),Xj.add("MoreCellShadingColors"),Xj),["PictureBorders"]:(Dn=new Qa.a,Dn.add("ThemePictureBorderColorPickerMCU"),
Dn.add("ThemePictureBorderColorPicker"),Dn.add("StandardPictureBorderColorPicker"),Dn.add("RecentPictureBorderColorPicker"),Dn.add("MorePictureBorderColors"),Dn.add("NoPictureBorder"),Dn.add("PictureBorderWeightOptions"),Dn.add("PictureBorderStyleOptions"),Dn)};Mm.Hxe={["StandardFontColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["RecentFontColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentHighlighterColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,
["RecentCellShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPictureBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["FontColor"]:Box4Intl.Box4Strings.L_FontColor,["Highlighter"]:Box4Intl.Box4Strings.L_HighlightColor,["CellShading"]:Box4Intl.Box4Strings.L_CellShadingColor,["PictureBorders"]:"Picture Border"};Mm.uQj=(Cn=new Qa.a,Cn.add("RecentFontColorPicker"),Cn.add("RecentCellShadingColorPicker"),Cn.add("RecentPictureBorderColorPicker"),Cn);Object(r.a)(Mm,"RecentColorsSectionHandler",
null,[]);var Fq=d(1377),sp=d(1006);class Gq{constructor(b){this.xOj=b}O6(){}N6(b){this.xOj.HKm(b)}}Object(r.a)(Gq,"DataBuddyActionListener",null,[40]);class bq{constructor(){this.type="DataBuddyTaskPaneProps";this.onClearClick=this.clearButtonLabel=this.actions=null}}Object(r.a)(bq,"DataBuddyTaskPaneProps",null,[]);class bp{constructor(b){this.isVisible=!1;this.PX=new Qa.a;this.sfe=null;this.fP=b;this.fA=new Fq.a;this.Wb=de.FocusManager.instance()}initialize(){this.sfe=new Gq(this);this.fP.PJa();
this.fA.oK(this.M2j());this.fA.oK(this.X_j())}toggle(){this.isVisible?this.hide():this.show()}HKm(b){if(2===b.behavior){const h=pd.ActionManager.Sca(b.actionId)||b.actionId.toString();h.startsWith("Query")||(this.PX.add(h+": "+bp.uel(b.response)),this.Vn())}}hide(){Cj.UISurfaces.Xt().then(b=>{b.hideTaskPane(bp.gy,2);return null})}show(){Cj.UISurfaces.Xt().then(b=>{b.showTaskPane(bp.gy,this.nB());return null});this.isVisible&&Cj.UISurfaces.Xt().then(b=>{b.setSelectedTaskPane(bp.gy);return null})}M2j(){return b=>
{b.actions=this.PX.toArray();b.clearButtonLabel=CommonUIStrings.l_WAC_DataBuddyClearButtonLabel}}X_j(){return b=>{b.onClearClick=()=>{this.PX.clear();this.Vn()}}}Vb(){u.AFrameworkApplication.ya.b3(this.sfe)}A3a(){u.AFrameworkApplication.ya.Dgc(this.sfe)}nB(){const b=new bq;this.fA.fJb(b);return Object.assign(new sp.a,{title:"Data Buddy",hideHeader:!1,width:bp.width,location:2,contentProps:b,onOpen:()=>{this.k7();this.Vb();this.isVisible=!0;u.AFrameworkApplication.ua.updateCommandUI()},onClose:()=>
{this.Saa();this.A3a();this.isVisible=!1;this.Vn();u.AFrameworkApplication.ua.updateCommandUI()},isModernPane:!0})}Vn(){Cj.UISurfaces.Xt().then(b=>{b.updateTaskPane(bp.gy,this.nB());return null})}k7(){this.Wb.Jg(bp.gy)}Saa(){this.c_a()&&this.Wb.Jg(this.Wb.AS)}c_a(){return!!this.Wb.xg&&this.Wb.xg.name===bp.gy}static uel(b){switch(b){case 0:return"Unattempted";case 1:return"In Progress";case 2:return"Not Handled";case 4:return"Handle Externally";case 8:return"Failed";case 16:return"Error";case 32:return"Succeeded";
case 64:return"Delayed";default:return b.toString()}}}bp.gy="DataBuddyTaskPane";bp.width=300;Object(r.a)(bp,"Box4DataBuddyTaskPane",null,[277]);class Zr{constructor(b){this.Dh=b}OEa(b){this.Dh&&this.Dh.ZF(b)}B2c(){this.Dh&&this.Dh.R2c(void 0)}}Object(r.a)(Zr,"RibbonButtonUpdater",null,[276]);var Zm=d(389);class Kn{constructor(){this.LGe=this.W=null}get name(){return"Box4.UI"}zc(b){this.W=b;b.ha("Box4.IGeneralCuiUser",()=>new lm(b.resolve("Box4.UI.CuiActionBridge"),u.AFrameworkApplication.ya)).singleInstance();
b.ha("Box4.UI.TableAltTextDialogFactory",()=>new Cp(b.resolve("Box4.ITableEditor"),new Zm.a,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();b.ha("Box4.UI.ILanguageEditor",()=>new tq(kh.a.instance.Rg,b.Pa("Box4.ITextFormattingCommands"),b.Za("Box4.IAutoCorrectRules"),b.resolve("Box4.ILanguageReader")));b.ha("CommandUI.StandaloneRootController",()=>new km(u.AFrameworkApplication.mr)).as("Common.IStandaloneRootController").singleInstance();b.ha("Box4.UI.IAutoCorrectOptionsDialog",
()=>new Mo(b.resolve("Box4.IAutoCorrectOptionsInfo"),u.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled")));b.ha("Box4.UI.LanguageListHelper",()=>new Yn(u.AFrameworkApplication.K.$("RecentlyUsedLanguagesListIsEnabled"))).as("Box4.UI.ILanguageListHelper").singleInstance();b.register(Gk,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").singleInstance();b.ha("Box4.UI.DefaultProofingContextMenuCreator",()=>new Ap(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"))).singleInstance();
b.ha("Box4.UI.ProofingContextMenuSectionFactory",()=>new Li(b.resolve("Box4.UI.DefaultProofingContextMenuCreator"),b.resolve("Box4.UI.EditorServiceProofingContextMenuCreator"))).as("Box4.UI.IProofingContextMenuSectionFactory").singleInstance();b.ha("Box4.RibbonButtonUpdater",()=>new Zr(this.W.resolve("Box4.IAppFrame"))).as("Common.IRibbonButtonUpdater").singleInstance();b.ha("Box4.UI.RecentColorsSectionHandler",()=>new Mm).singleInstance();b.ha("Common.IDataBuddyTaskPane",()=>new bp(Um.a.instance)).singleInstance()}init(){var b=
ob.App.xa;const h=b.Sb;Vc.X_l(Object(v.a)(h,h.yFb,"onAuthenticationLost"),Object(v.a)(h,h.zFb,"onAuthenticationRestored"),b.Wpk);ah.a.Vb();b=u.AFrameworkApplication.ya;b.pa(Db.a.u6m,cc.a.application,No);b.gb(Db.a.rUn,cc.a.application,rp,96);b.gb(Db.a.YUn,cc.a.application,sq,96);b=u.AFrameworkApplication.ya;b.gb(Db.a.CWn,cc.a.application,Uq,96);b.gb(Db.a.jUn,cc.a.application,it,96);Rj.Vb();this.d2l();this.LGe=this.W.resolve("Common.IStandaloneRootController")}d2l(){this.W.Za("Box4.IGeneralCuiUser").execute(b=>
{this.W.Za("Common.IStandaloneRootController").execute(h=>{h.q3.kE=b})})}dispose(){this.LGe.dispose();this.LGe=null}static main(){N.a.instance.Pc(new Kn,6)}}Object(r.a)(Kn,"Box4UIPackage",null,[1,2]);var Vq=window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",
IsStretched:"true"}}]}]}]},Hq=d(1763);class nm{get name(){return"Box4.Insights"}init(){}dispose(){}zc(b){b.ha("Box4.Insights.Box4InsightsSelection",()=>new Hq.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").singleInstance()}}Object(r.a)(nm,"Box4InsightsPackage",null,[1,2]);const cp=b=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+b)};var ln=d(436),ml=d(347);class tp{constructor(b,h){this.Fi=this.ied=
0;this.NEg=h;this.GVj=b}khb(){return this.ied-this.Fi>=this.GVj}reset(){this.Fi=this.ied=this.NEg()}update(){this.ied=this.NEg()}}Object(r.a)(tp,"TimeBasedTaskYieldStrategy",null,[204]);class Dp{khb(){return!1}reset(){}update(){}}Object(r.a)(Dp,"NullTaskYieldStrategy",null,[204]);var U=d(1383);class la{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=
this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(r.a)(la,"CatchUpConfiguration",null,[]);class gb{constructor(){this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}Object(r.a)(gb,"SharedControllerFactoryParameters",null,[]);var Kb=d(158),ub=d(18);class Cc{constructor(b,
h,n,x){this.rWm=(E,S)=>{(this.gcd=!this.gcd)&&S.tk&&S.tk.contextId===cc.a.Wc&&this.rkh(S.tk.node,S.tk.gl);return 32};this.ix=b;this.xp=h;this.ga=n;this.Wb=x;this.Pdd=this.Qdd=null;this.gcd=!1;this.ga.pa(ub.a.q$i,cc.a.view,this.rWm);this.Wb.pe(xd.AFrame.Lp).bindAction(mc.KeyInputManager.mc(db.a.fic,6),ub.a.q$i)}VZ(b,h){this.gcd&&this.xp&&h&&h.kl&&h.kl.kb&&h.kl.kb.Qa&&h.kl.kb.Qa.node&&h.kl.kb.Qa.contextId===cc.a.Wc&&this.rkh(h.kl.kb.Qa.node,h.kl.kb.Qa.gl)}rkh(b,h){b&&(this.psi(b)?(this.Qdd&&this.Qdd.id.equals(b.id)||
(this.xp.sendNotification(WordEditorIntl.WordEditorStrings.L_CatchUpActivityParagraphAnnouncementTemplate,!1),this.Qdd=b),this.OBm(b,h)):this.Pdd=this.Qdd=null)}psi(b){return 0<this.ix.cAb(b).count}OBm(b,h){if(b){var n=-1,x=null,E=null;for(let S=0;S<b.qa.length;S++){const ma=b.qa.J(S);if(!(null==E||ma.changeStart&&ma.changeStart.equals(x))&&h>=n&&h<=ma.cp&&!x.equals(this.Pdd))if(this.ix.ICb(x)){(b=this.ix.mGc(x,b.id))&&0<b.actors.length&&b.displayTimestamp&&(b=String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityChangeAnnouncementTemplate,
b.actors[0].displayName,b.displayTimestamp.toLocaleString()),this.xp.sendNotification(b,!1),this.Pdd=x);break}else this.Pdd=null;ma.changeStart&&!ma.changeStart.equals(x)&&(n=ma.cp,x=ma.changeStart);E=ma.changeStart}}}}Object(r.a)(Cc,"ActivityAnnouncementManager",null,[]);var nd=d(1356),wd=d(735),Le=d(747),kf=d(514);class ng{constructor(){this.activityId=null;this.type=0;this.priorityId=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(r.a)(ng,"Activity",
null,[]);var bg=d(425);class Xf extends ng{constructor(){super();this.Su=this.objectId=null}static UF(b){const h=new kf.a(new bg.a);if(b.Su)for(let n of b.Su)h.add(n);return h}}Object(r.a)(Xf,"RevisionSetActivity",ng,[]);class Ih{constructor(b,h,n){this.Pje=null;this.dismiss=()=>{this.Isi.then(x=>{x.removeNotification(this.Pje);return this.Pje=null})};this.UV=b;this.Ac=h;this.Isi=n}sao(b){if(b)switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:this.Ac.Xb(Ra.a.d0a,2,null);break;
default:this.MKm()}else w.ULS.sendTraceTag(593049027,3012,10,"Null activity: TryNotifyContentDoesNotExist. Unable to notify.")}MKm(){this.Isi.then(b=>{var h=Object.assign(new ur.a,{target:'[data-unique-id~="CatchUpWithChanges"]',showCloseIcon:!0,content:CommonUIStrings.l_ChangeDoesNotExistNotification,calloutProps:Object.assign(new nd.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});h=b.callout(h);const n=Object.assign(new wd.a,{expirationOptions:Object.assign(new Le.a,{displayTimeoutSeconds:10,
onExpire:this.dismiss})});this.Pje=b.addNotification(h,n)})}doesContentExist(b){if(!b)return w.ULS.sendTraceTag(593049026,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!b.navigationId)return w.ULS.sendTraceTag(593049025,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;const h={};h.NavigationId=atob(b.navigationId);if(8===this.Ac.Xb(Ra.a.Yyd,2,h))return!1;break;case 1:return this.YWk(b)}return!0}YWk(b){b=
Xf.UF(b);return b?0<this.UV.QEd(b).count:(w.ULS.sendTraceTag(593049024,3012,10,"Null changeIds: DoRevisionsExist. Default to false."),!1)}}Object(r.a)(Ih,"ActivityContentManager",null,[391]);var sg=d(1441),bh=d(1891),Ag=d(1129),pl=d(688);class yl{constructor(){this.Su=this.BW=null}compare(b){if(!b)return!1;if(this.BW&&b.BW){if(this.BW.count!==b.BW.count)return!1;for(let h of this.BW)if(!b.BW.contains(h))return!1}else if(!b.BW&&this.BW||!this.BW&&b.BW)return!1;if(b.Su&&this.Su){if(b.Su.count!==this.Su.count)return!1;
for(let h of this.Su)if(!b.Su.contains(h))return!1}else if(!this.Su&&b.Su||!b.Su&&this.Su)return!1;return!0}}Object(r.a)(yl,"ActivityHighlightableObject",null,[]);class vo extends sg.a{constructor(b,h){super();this.XBe=this.$Sb=null;this.y5c=b;this.ix=h;this.spa=[new bh.a(Ag.a.gjh,Ag.a.fjh),new bh.a(Ag.a.djh,Ag.a.cjh),new bh.a(Ag.a.Vsd,Ag.a.Wsd),new bh.a(Ag.a.Xsd,Ag.a.pUe)]}get nBb(){return 1}get oeb(){return this.spa}get qla(){return!0}ydb(b,h){if(b=Object(ja.a)(yl,b))if(b.BW)for(let n of b.BW)h.add(n);
else w.ULS.sendTraceTag(594900750,377,15,"Activity Highlight: no highlightable paragraphs")}BNa(b,h){if(this.Gy.SJa){var n=this.y5c.U1a,x=this.y5c.qeb,E=!!n&&n.compare(x),S=this.Gy.SJa,ma=S.action,Fa=this.iRn(S,b),$a=!1;2!==ma&&ma&&($a=($a=this.Gy.kQd)?1===$a.type:!!n||!!x);h=h.h1a("*");for(let sb=0,Jb=h.length;sb<Jb;sb++){const Sb=h[sb],oc=this.Lol(Sb,Ag.a.Zsd);if(oc&&oc.rt)if(this.Ann(Sb),1===S.type)switch(ma){case 0:Fa&&n.Su.contains(oc.rt)&&this.$qd(Sb,2,oc,!1);break;case 2:Fa&&x.Su.contains(oc.rt)&&
this.$qd(Sb,E?2:1,oc,!1);break;default:this.e4b(b,Sb,oc,!1)}else $a?this.e4b(b,Sb,oc,!1):this.e4b(b,Sb,oc,!0)}this.$Sb&&(this.$Sb.classList.add(Ag.a.Xsd),this.XBe=this.$Sb=null)}}Lol(b,h){return hi.a.Eb(b,h)}iRn(b,h){if(b&&b.vF){const n=b.vF,x=b.action;if(1===b.type&&(2===x||!x)&&n.BW)return n.BW.contains(h);if(n.Su)for(let E of n.Su){b=this.ix.zHc(E);for(let S of b)if(S===h)return!0}}return!1}e4b(b,h,n,x){const E=this.y5c.U1a,S=this.y5c.qeb;E&&E.Su.contains(n.rt)&&(!E.BW||E.BW.contains(b))?this.$qd(h,
2,n,x):S&&S.Su.contains(n.rt)&&(!S.BW||S.BW.contains(b))&&this.$qd(h,1,n,x)}$qd(b,h,n,x){b&&pl.a(b)&&(b.classList.add(this.wsl(2===h,x)),this.rIn(b,n,x))}rIn(b,h,n){this.$Sb?-1!==h.cpEnd&&this.XBe.cpEnd!==h.cpBegin&&(this.$Sb.classList.add(n?Ag.a.pUe:Ag.a.Xsd),b.classList.add(n?Ag.a.Wsd:Ag.a.Vsd)):b.classList.add(n?Ag.a.Wsd:Ag.a.Vsd);b.classList.add(Ag.a.ejh);this.$Sb=b;this.XBe=h}Ann(b){this.Gy.s1a(b);this.wmn(b)}wmn(b){b.classList.remove(Ag.a.Vsd,Ag.a.Wsd,Ag.a.ejh,Ag.a.Xsd,Ag.a.pUe)}wsl(b,h){return h?
b?Ag.a.cjh:Ag.a.fjh:b?Ag.a.djh:Ag.a.gjh}}Object(r.a)(vo,"ActivityHighlightActor",sg.a,[]);var tn=d(1892),om=d(183);class Oo{constructor(b,h,n,x,E,S,ma,Fa){this.E4=b;this.$M=h;this.ix=n;this.qOj=E;this.hb=S;this.xp=Fa;this.Wb=ma;this.$M.FOd=!1}wyi(b,h,n){b?this.CWl(b,h,n):this.$M.U1a&&(b=Object.assign(new tn.a,{action:1,type:1,vF:null,eO:this.$M.U1a}),this.$M.U1a=null,this.E4.$G(b))}CWl(b,h,n){if(h){b=new kf.a(new bg.a);for(E of h){var x=this.ix.LGc(E);for(let S=0;S<x.length;S++){const ma=x[S];this.ix.ICb(ma)&&
b.add(ma)}}var E=this.ix.QEd(b);E=this.erh(E,b);x=this.$M.U1a;this.$M.U1a=E;E=Object.assign(new tn.a,{action:0,type:1,vF:this.$M.U1a,eO:x});this.E4.$G(E);n&&!this.UAn(h.J(0),b)||this.DCn(h.J(0),b)}else w.ULS.sendTraceTag(589345503,377,10,"HighlightActivity: no target nodes for activityId {0}",b.activityId)}UAn(b,h){if(!b)return w.ULS.sendTraceTag(587239560,377,10,"ScrollToHighlightParagraph: No target node from activity"),!1;if(12!==b.type)return w.ULS.sendTraceTag(587239561,377,10,"ScrollToHighlightParagraph: target node is not a paragraph"),
!1;h=this.Sll(b,h);return this.qOj.Ecc(b.id,h)?this.setSelection(b,h)?!0:!1:(w.ULS.sendTraceTag(587239563,377,10,"ScrollToHighlightParagraph: call to ScrollToParagraphMatchingNodeId failed"),!1)}DCn(b,h){b=this.xsl(b,h);h=new Sys.StringBuilder;for(let n=0;n<b.count;n++)h.append(String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityHighlightReadoutTemplate,n+1,b.count,b.J(n)));this.xp.sendNotification(h.toString(),!0)}setSelection(b,h){if(!b||!Cd.ParagraphReader.oc(b))return w.ULS.sendTraceTag(579396806,
377,10,"SetSelection: Invalid node provided"),!1;if(0>h)return w.ULS.sendTraceTag(579396807,377,10,"SetSelection: Invalid cp provided"),!1;this.$M.FOd=!0;b=Dd.a.Uc(b,h);b=new om.Selection([b],!0);this.hb.setSelection(b);de.FocusManager.YI()&&this.Wb.Jg(xd.AFrame.Xp);return!0}Sll(b,h){if(h&&0<h.count)for(let n=0;n<b.qa.length;n++){const x=b.qa.J(n);if(x.changeStart&&h.contains(x.changeStart))return x.cp}w.ULS.sendTraceTag(36824330,377,15,"Could not find the matching change in the paragraph, return default cp 0");
return 0}xsl(b,h){const n=new Qa.a;if(h&&0<h.count&&b){let x=-1;for(let E=0;E<b.qa.length;E++){const S=b.qa.J(E);if(-1!==x&&S.isChangeEnd)if(S.changeStart&&h.contains(S.changeStart))continue;else n.add(b.characterData.substring(x,S.cp)),x=-1;S.changeStart&&h.contains(S.changeStart)&&(x=S.cp)}}return n}Ixi(b,h){if(b)switch(b.type){case 1:if(h){b=new kf.a(new bg.a);for(var n of h){h=this.ix.LGc(n);for(let x=0;x<h.length;x++){const E=h[x];this.ix.ICb(E)&&b.add(E)}}}else b=Xf.UF(b);h=this.ix.QEd(b);this.$M.qeb=
this.erh(h,b);n=Object.assign(new tn.a,{action:2,type:1,vF:this.$M.qeb,eO:null});this.E4.$G(n)}else this.$M.qeb&&(n=Object.assign(new tn.a,{action:3,type:1,vF:null,eO:this.$M.qeb}),this.$M.qeb=null,this.E4.$G(n))}erh(b,h){var n=null;if(b){n=new Pa.a;for(let x of b)12===x.type&&n.add(x)}b=new yl;b.BW=n;b.Su=h?h:this.Xxl(n);return b}Xxl(b){const h=new kf.a(new bg.a);if(!b)return h;for(let n of b)for(let x of this.ix.cAb(n))h.add(x);return h}}Object(r.a)(Oo,"ActivityHighlightManager",null,[]);var $m=
d(684),Pk=d(516),zo=d(1439),ej=d(125),pm=d(69);class Ch{constructor(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}}Object(r.a)(Ch,"CreateIndicatorTooltipParameters",null,[]);class Mi{constructor(){this.clearSticky=!1}}Object(r.a)(Mi,"DismissIndicatorTooltipParameters",null,[]);class Iq{constructor(){this.target=null;this.isSticky=!1}}Object(r.a)(Iq,"UpdateIndicatorTooltipParameters",null,[]);class uq extends Sys.EventArgs{constructor(b,h,n){super();this.Nyb=b;
this.Q5h=h;this.gSn=n}}Object(r.a)(uq,"ActivityIndicatorEventArg",Sys.EventArgs,[]);class Ln{constructor(){this.R5h=new Map;this.S5h=new Set}G8n(b,h){this.S5h.add(b);this.R5h.set(b,h)}Pcm(b){return rd.a.Jai(b.htmlElement)}gNl(){let b=new Set;for(let h of this.S5h){const n=this.R5h.get(h);n&&this.Ocm(n)&&b.add(h)}return b}Ocm(b){return b.parentElement&&rd.a.Jai(b.parentElement)}}Object(r.a)(Ln,"IndicatorVisibilityTracker",null,[]);class cq extends zo.a{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb){super();
this.sa=new Ge.a;this.Npb=this.n8=null;this.ESl=(Sb,oc,Ic,gd,Gd)=>{if(!Gd)return w.ULS.sendTraceTag(592540299,377,50,"Null actionData: HandleShowIndicatorFlyoutForActivity"),8;oc=Xf.UF(Gd.Activity);Sb=null;if(Gd.NodeId&&(Gd=ej.b(Gd.NodeId),!C.a.Dp(Gd,C.a.nil)&&(Gd=this.ix.YPh(Gd),this.A5f(Gd,!1))))return 32;for(let vd of oc)if(this.ix.ICb(vd)){Gd=this.ix.d2b(vd);if(this.A5f(Gd,!0))return 32;Gd&&!Sb&&(Sb=Gd)}if(this.A5f(Sb,!1))return 32;w.ULS.sendTraceTag(589866521,377,15,"Unable to find indicator from ShowIndicatorFlyoutForActivity");
return 8};this.CSl=(Sb,oc,Ic,gd,Gd)=>{w.ULS.sendTraceTag(595126290,377,50,"User requested to Show Catch-Up Activities for a Paragraph from the Context Menu.");Gd&&oc&&oc.ul&&(Sb=oc.node)&&((Sb=this.yic.dFd(Sb))?this.epd(Sb,!1,!1):w.ULS.sendTraceTag(595126289,377,50,"Unable to obtain indicator container for node after context menu action."));return 32};this.EWn=Sb=>{(Sb=this.yic.dFd(Sb.customData))&&this.epd(Sb,!1,!1)};this.onMouseEnter=Sb=>this.Qwi(Sb.Bv,!0);this.Ama=Sb=>{Sb=Sb.Bv;if(Sb===this.n8)return!0;
this.MLi(Sb);return!0};this.k0a=Sb=>{this.Npb=null;return this.Qwi(Sb.Bv,!1)};this.TZ=()=>{this.L_f();this.Ttd(!0);return!1};this.Sr=()=>{this.sBi()};this.zYd=()=>{this.n8&&this.Dfj(this.n8);this.Npb&&this.MLi(this.Npb);this.uRm()};this.sBi=()=>{this.n8?this.Dfj(this.n8):this.tVe()};this.ix=b;this.Efe=h;this.lHg=n;this.PFj=x;this.qk=E;this.y4=null;this.Hb=ma;this.yic=Fa;this.zre=new Ln;this.Dw=$a;this.zE=sb;this.yH=Jb;this.gf&&(this.gf.jja(this.zYd),this.gf.a9g(this.sBi));S&&S.execute(Sb=>{Sb.b7(this.Sr)})}get gf(){return this.qk&&
this.qk.Ji?this.qk:(w.ULS.sendTraceTag(579396804,377,15,"Could not obtain valid PageView."),null)}iWa(b,h,n){if(this.n8){var x=pm.a(this.n8);if(b===x)return this.n8}const E=b.Ig.ownerDocument;x=$m.a.createElement(E,Pk.a.div);x.className=Ag.a.Eqk;x.style.left=h+"px";x.style.top=n+"px";h=$m.a.createElement(E,Pk.a.div);h.className=this.Dw?Ag.a.mjh:Ag.a.hjh;x.style.cursor="pointer";h.style.cursor="pointer";this.yH&&(h.style.backgroundColor=this.zE.zil(),h.style.outlineWidth="1px",h.style.outlineStyle=
"solid",h.style.outlineColor=this.zE.Ail());x.appendChild(h);sf.a.instance.mb(kb.a.sQ,x,this.onMouseEnter);sf.a.instance.mb(kb.a.iK,x,this.Ama);$e.a.instance.mb(kb.a.click,x,this.k0a);sf.a.instance.mb(kb.a.contextMenu,x,this.TZ);w.ULS.sendTraceTag(41457152,377,50,"An activity indicator has been created!");this.mwm(b);h=this.Oyl(b);this.zre.G8n(h,x);this.zre.Pcm(b)&&this.ewi(h);return x}AJb(b){return this.hQn(b)}Swb(b){const h=this.Onk(b),n=[];n.push(this.iWa(b.S6,h,b.I3c[0].y-b.w$[0].y));return n}Onk(b){let h=
Ag.a.f_l+(0>b.KPc?-b.KPc:0);const n=mf.a.Ni(b.leftMargin,0)/2;1>=n&&w.ULS.sendTraceTag(578082778,377,50,"Margin is too small to show indicators");h=h>n?n:h;h=h<Ag.a.ijh?Ag.a.ijh:h;return u.AFrameworkApplication.isRtl?b.w$[0].width/this.zoom+h:-h}M0i(b){if(b&&393230===b.Qc||393251===b.Qc){const h=this.ix.cAb(b);if(h)for(let n of h)if(b===this.ix.d2b(n))return!0}return!1}hQn(b){for(let h of Cd.ParagraphReader.Mw(b.zb,!0,!1))if(this.M0i(h))return!0;return!1}Vb(b){b.pa(ub.a.z2i,cc.a.Wc,this.CSl);b.pa(ub.a.b_f,
cc.a.Wc,this.ESl)}A5f(b,h){if(!b)return!1;const n=this.yic.dFd(b);if(n)return this.epd(n,!1,!0),!0;if(!h){let x;this.UVc((x=new Qa.a,x.add(b),x),!1,!0,!0);h=new We.a(3,1,0,this.EWn,181);h.customData=b;this.Hb.$b(h);return!0}return!1}rIk(b,h=!1){h&&this.Ttd(!0);if(b&&b.parentNode){var n=this.Ugf(b);n=this.Fel(n);this.y4||(this.y4=document.createElement("Div"),document.getElementById(u.AFrameworkApplication.bXb).appendChild(this.y4));this.Efe.createActivityIndicatorTooltip(Object.assign(new Ch,{target:b,
container:this.y4,activityIds:n,isSticky:h,dirHint:9}));h&&(this.n8=b)}else w.ULS.sendTraceTag(36794392,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}X_k(b){b&&b.classList.add(Ag.a.Ysd)}Qwi(b,h){return this.epd(b,h,!1)}epd(b,h,n){if(h&&b===this.n8)return!0;const x=this.Ugf(b);h||this.L_f();this.rIk(b,!h);this.X_k(b.getElementsByClassName(this.Dw?Ag.a.mjh:Ag.a.hjh)[0]);this.UVc(x,h,!0,n);this.cli(x,h?1:2);this.PFj.tSd();
h&&(this.Npb=b);return!0}Ttd(b=!1){this.Efe.dismissActivityIndicatorTooltips(Object.assign(new Mi,{clearSticky:b}));this.Npb=null;b&&(this.n8=null)}Y3i(b){b&&b.classList.remove(Ag.a.Ysd)}L_f(){this.n8&&this.Y3i(this.n8.getElementsByClassName(Ag.a.Ysd)[0])}MLi(b){const h=this.Ugf(b);this.UVc(h,!0,!1,!1);this.Y3i(b.getElementsByClassName(Ag.a.Ysd)[0]);this.Ttd(!1);this.Npb=null}Ugf(b){let h=null;(b=(b=pm.a(b))?b.zb:null)&&11===b.type&&(h=Cd.ParagraphReader.Mw(b,!0,!1));return h}tVe(){const b=!!this.Npb;
if(this.n8||b)this.L_f(),this.Ttd(!0),this.UVc(null,!1,!1,!1),this.UVc(null,!0,!1,!1)}J4j(b){this.sa.addHandler(cq.F5g,b)}K4j(b){this.sa.addHandler(cq.G5g,b)}UVc(b,h,n,x){let E=null;if(n&&b){for(let S of b)if(n=this.ix.LGc(S))for(let ma=0;ma<n.length;ma++){const Fa=n[ma];if(this.ix.ICb(Fa)){E=this.ix.mGc(Fa,S.id);break}}if(!E){w.ULS.sendTraceTag(36717344,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in this GraphNode.");return}}h?this.sa.raiseEvent(cq.F5g,new uq(E,
b,!1)):this.sa.raiseEvent(cq.G5g,new uq(E,b,x))}Fel(b){const h=[];if(b)for(let x of b){var n=this.ix.cAb(x);for(let E of n)(n=this.ix.mGc(E,x.id))&&h.push(n.activityId)}!h.length&&b&&b.count&&w.ULS.sendTraceTag(36844643,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in these Nodes.");return h}Dfj(b){b&&b.parentNode?(this.Efe.updateActivityIndicatorTooltip(Object.assign(new Iq,{target:b,isSticky:!0})),this.n8=b):w.ULS.sendTraceTag(40935511,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}uRm(){let b=
this.zre.gNl();for(let h of b)this.ewi(h)}ewi(b){this.lHg.bli(b,3)}Oyl(b){return(b=Cd.ParagraphReader.Mw(b.zb,!0,!1))&&b.count?b.J(0).id:null}mwm(b){b=Cd.ParagraphReader.Mw(b.zb,!0,!1);this.cli(b,0)}cli(b,h){b&&b.count&&this.lwm(b.J(0).id,h)}lwm(b,h){this.lHg.bli(b,h)}}cq.F5g="ActivityIndicatorPreviewed";cq.G5g="ActivityIndicatorSelected";Object(r.a)(cq,"ActivityIndicatorActor",zo.a,[]);var wf=d(41);class Jq{constructor(b,h,n){this.ix=b;this.Ymd=h;this.qk=n}get gf(){return this.qk&&this.qk.Ji?this.qk:
(w.ULS.sendTraceTag(555356833,377,15,"Could not obtain valid PageView."),null)}dFd(b){w.ULS.sendTraceTag(555356834,377,50,"Attempting to find the indicator container related to changes in a given node.");const h=this.YQh(b);if(!h){w.ULS.sendTraceTag(555356835,377,50,"Looking in different nodes to find the indicator container related to grouped changes on the desired node.");b=this.ix.cAb(b);for(let n of b)if(b=this.ix.d2b(n),b=this.YQh(b))return b}return h}YQh(b){if(!b||12!==b.type)return w.ULS.sendTraceTag(539779146,
377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid node provided."),null;if(!b)return w.ULS.sendTraceTag(539779147,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid paragraph node."),null;var h=this.Ymd.CHd(b);if(!h||11!==h.type)return w.ULS.sendTraceTag(539779148,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find top level outline element."),null;h=h.De(this.gf.Tb);if(!h||!h.htmlElement)return w.ULS.sendTraceTag(539779149,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid view element."),
null;var n=Ke.a.pzb(h.htmlElement,Jq.E5g);if(n)return n;h=h.O7e();if(!h)return w.ULS.sendTraceTag(539779150,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid list container wrapper."),null;h=Ke.a.qjl(h,Jq.E5g);if(!h)return w.ULS.sendTraceTag(539779151,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid indicators array."),null;for(n=0;n<h.length;n++){const x=pm.a(h[n]),E=wf.OutlineElementNavigator.Uk(b);if(x&&x.zb&&E&&x.zb.id.equals(E.id))return h[n]}w.ULS.sendTraceTag(539779152,
377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find indicator.");return null}Htl(b){b=this.ix.YPh(b);if(!b||12!==b.type)return w.ULS.sendTraceTag(555356864,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get paragraph node from node Id."),C.a.nil;b=this.dFd(b);if(!b)return w.ULS.sendTraceTag(541888733,377,15,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get indicator from paragraph node."),C.a.nil;b=pm.a(b);return b?b.zb.id:(w.ULS.sendTraceTag(555356865,
377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get view element from paragraph node."),C.a.nil)}}Jq.E5g="CatchUpActivityIndicatorContainer";Object(r.a)(Jq,"ActivityIndicatorHelper",null,[]);var Ao=d(1616);class vq{constructor(b,h,n,x,E,S,ma){this.XYa=b;this.pageContentNode=h;this.lMe=n;this.Ac=x;this.UV=E;this.jf=S;this.rMc=ma;this.JCm=(Fa,$a,sb)=>{if(1===sb)return this.v2h?32:8;2===sb&&(this.v2h&&(this.lMe.tVe(),this.nuk()),w.ULS.sendTraceTag(38138719,377,50,z.c({["MarkAsRead invoked"]:!0})));
ob.App.xa.updateCommandUI();return 8};this.XYa.Yib(this.lMe)}initialize(){this.Ac.pa(ub.a.Xni,Ld.a.frame,this.JCm)}get v2h(){return!!this.UV.vQ&&0<this.UV.vQ.count||!!this.UV.q9b&&0<this.UV.q9b.count}GHf(b){const h=b&&b.wywaActivities?b.wywaActivities.length:0;if(!this.rMc||0<h||!b){const n=new Map;n.set("activityCount",h.toString());this.jf.logKpiUsage("CatchUpActivitiesReady",0,{extendedProperties:n})}b?this.rMc&&0==b.wywaActivities.length||this.vMm(b.wywaActivities):(w.ULS.shipAssertTag(36538305,
377,!1),this.rMc||Object(Ao.a)(),this.jf.logKpiFailure("CatchUpActivitiesReady","CatchUpActivitiesPayloadIsInvalid",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}))}vMm(b){b?(w.ULS.sendTraceTag(36509256,377,50,"Catch-Up Activities are Ready and Indicators should be created."),this.DOn(b),b=this.UV.i4j(b),this.EOn(b)):w.ULS.sendTraceTag(50959501,377,10,"activities passed in is null!")}DOn(b){if(b){var h=new Qa.a;for(let n of b)switch(n.type){case 2:case 3:case 4:case 10:b=4===n.type?n.PBi:n.contentId,
h.add(b),this.UV.q9b.add(b)}0<h.count&&(w.ULS.sendTraceTag(51196435,377,50,"{0}",h.count),this.Ac.Xb(Ra.a.Dri,2,h.toArray()))}}EOn(b){const h=new kf.a(new bg.a),n=new Se.GraphTransaction(3);try{n.Db(this.pageContentNode);for(let x of b){const E=this.UV.d2b(x);E&&this.lMe.M0i(E)&&(h.add(E.id),this.XYa.X4b(E,!0))}}finally{n&&n.dispose()}0<b.count&&ob.App.xa.updateCommandUI();b={};b.highlightedNodeCount=h.count;w.ULS.sendTraceTag(36509257,377,50,"{0}",z.c(b))}nuk(){w.ULS.sendTraceTag(36509258,377,50,
"Catch-Up Activity Indicators requested to be cleared.");0<this.UV.q9b.count&&(this.Ac.Xb(Ra.a.Kyh,2,this.UV.q9b.toArray()),this.UV.q9b.clear());const b=this.jwk(this.UV.vQ);this.pmn(b)}pmn(b){w.ULS.sendTraceTag(36509259,377,50,"Catch-Up Activities some Indicators requested to be removed.");const h=new Se.GraphTransaction(3);try{h.Db(this.pageContentNode);for(let n of b){this.UV.vQ.remove(n);for(let x of this.UV.zHc(n))this.XYa.X4b(x,!0)}this.UV.Ykh()}finally{h&&h.dispose()}}jwk(b){const h=new kf.a(new bg.a);
for(let n of b)h.add(n);return h}}Object(r.a)(vq,"ActivityIndicatorManager",null,[]);class wk{constructor(){this.qeb=this.U1a=null;this.isFirstDocumentOpen=this.FOd=!1}}Object(r.a)(wk,"ActivityStateManager",null,[389]);class wo{constructor(b,h){this.R6c={};this.ENb=b;this.oz=h;this.q9b=new Qa.a}get vQ(){return this.ENb.vQ}cAb(b){const h=new kf.a(new bg.a);if(!b)return h;b=this.ENb.nDd(b);for(let n=0;n<b.length;n++){const x=b[n];this.ICb(x)&&h.add(x)}return h}zHc(b){return this.ENb.zHc(b)}QEd(b){const h=
new Qa.a;if(b)for(let n of b)h.addRange(this.zHc(n));return h}i4j(b){const h=new kf.a(new bg.a);if(b)for(let n of b)if(1===n.type&&(b=n))for(let x of b.Su){h.add(x);this.vQ.add(x);const E=x.toString();this.R6c[E]||(this.R6c[E]=new Qa.a);this.R6c[E].add(b)}this.Ykh();return h}ICb(b){return this.vQ&&b?this.vQ.contains(b):!1}mGc(b,h){if(b&&(b=this.R6c[b.toString()])&&0<b.count){for(let n of b)if(n.objectId.equals(h))return n;return b.J(0)}return null}d2b(b){return this.ENb.d2b(b)}Ykh(){this.ENb.Ztk()}LGc(b){return this.ENb.LGc(b)}YPh(b){if(!this.oz)return null;
const h=this.oz.Nc;return h?h.Eb(b):null}}Object(r.a)(wo,"ChangeIdCache",null,[]);var un=d(174),lh=d(111);class Wq extends un.a{constructor(){super();this.activityClassifications=this.inferences=this.correspondingRequest=null;this.H_=Object.assign(new lh.a,{T_:Wq.getTypeName(),B_:Wq.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(r.a)(Wq,"ChangeSummariesResponse",un.a,[]);var Bo=d(466);class up extends Bo.a{constructor(){super();
this.activityChanges=this.documentContent=this.requestId=null;this.H_=Object.assign(new lh.a,{T_:up.getTypeName(),B_:up.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(r.a)(up,"ChangeSummariesRequest",Bo.a,[]);var an=d(407),Po=d(432),vn=d(230),Np=d(433);class $r{constructor(){this.wbc=this.PXc=null}}Object(r.a)($r,"ActionPair",null,[]);class dp{constructor(b,h,n,x){this.Q_k=E=>{E=E.customData;
const S=this.lLi(E);S&&(w.ULS.sendTraceTag(579745163,377,15,"ChangeSummariesAugloopProvider.EndRequestWithTimeout: augloop request timed out, time since request = {0}",this.jef(E)),S.wbc("Request timeout"))};this.AJ=b;this.U3=h;this.Jf=n;this.Hb=x;this.Bre=null;this.hCe=new Jc.a;this.KWg=new Jc.a}z1n(b){const h=Object.assign(new an.a,{parentPath:["Signal",up.getTypeName()],items:[Object.assign(new Po.a,{body:b})]});return this.initialize().then(()=>{const n=new Promise((x,E)=>{this.hCe.Z(b.requestId,
Object.assign(new $r,{PXc:x,wbc:E}))});this.KWg.Z(b.requestId,new Date);w.ULS.sendTraceTag(561111456,377,50,"ChangeSummariesAugloopProvider.SubmitRequest: submitting request to aug-loop, timeout duration = {0}",dp.DPi);this.U3.getAugLoopRuntimeManager().submitOperation(Object.assign(new Np.a,{operation:h}));this.yLn(b.requestId);return n})}initialize(){this.Bre||(this.Bre=this.AJ.zn().then(()=>{this.Jf.mb(this,Wq.getTypeName())}));return this.Bre}mI(b,h){if(b&&vn.a.getTypeNameFor(b.content)===Wq.getTypeName())if(b=
b.content){var n=this.lLi(b.correspondingRequest);n?h!==an.a.getTypeName()?n.wbc("Invalid operation type"):(w.ULS.sendTraceTag(579745162,377,50,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: resolving augloop request, time since request = {0}",this.jef(b.correspondingRequest)),n.PXc(b)):w.ULS.sendTraceTag(589083081,377,15,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: cannot find action pair to resolve promise, time since request = {0}",this.jef(b.correspondingRequest))}else w.ULS.sendTraceTag(589083080,
377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: null response from ChangeSummariesRequest");else w.ULS.sendTraceTag(589600964,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: invalid annotation event")}yLn(b){const h=new We.a(3,1,dp.DPi,this.Q_k,176);h.Rod=0;h.customData=b;this.Hb.$b(h)}lLi(b){if(!b)return null;let h;if(!({value:h}=this.hCe.Dc(b,h)).returnValue)return null;this.hCe.remove(b);return h}jef(b){if(!b)return-1;let h;return({value:h}=this.KWg.Dc(b,h)).returnValue?
(new Date).getTime()-h.getTime():-1}static get DPi(){return u.AFrameworkApplication.K.rc("ChangeSummariesRequestTimeoutMs",5E3)}}Object(r.a)(dp,"ChangeSummariesAugloopProvider",null,[179]);class Qk{constructor(){this.activityGroups=null}}Object(r.a)(Qk,"FeaturedActivityGroupPayload",null,[]);class ir{constructor(b,h,n,x,E){this.cRj=b;this.Tuj=h;this.Gwj=n;this.fAj=x;this.Mmb=E}getFeaturedActivityGroups(b){return b&&b.wywaActivities&&b.wywaActivities.length?this.fAj.esb.then(()=>this.Epl(b)):ir.S4e}iQl(b,
h,n){if(!h)return w.ULS.sendTraceTag(574103583,377,15,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: response is null"),null;cp("TranslateFeaturedActivityGroups");n=this.Gwj.i9n(b,h,n.wywaActivities);w.ULS.sendTraceTag(542942800,377,50,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: sent changes to aug-loop = {0}, received inferences from aug-loop = {1}, provided items to the flyout = {2}",0<b.activityChanges.length,0<h.inferences.length,0<n.length);this.Mmb.set(h.correspondingRequest,
n);return Object.assign(new Qk,{activityGroups:n})}Epl(b){cp("BuildFeaturedActivityGroupRequest");const h=this.cRj.njk();if(!h||!h.documentContent||!h.activityChanges)return w.ULS.sendTraceTag(588379905,377,15,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummariesRequest is null"),ir.S4e;if(!h.documentContent.length||!h.activityChanges.length)return ir.S4e;w.ULS.sendTraceTag(578954499,377,50,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummaries Request Id: "+
h.requestId);cp("SubmitFeaturedActivityGroupRequest");return this.Tuj.z1n(h).then(n=>this.iQl(h,n,b))}}ir.S4e=Promise.resolve(Object.assign(new Qk,{activityGroups:[]}));Object(r.a)(ir,"ChangeSummariesDataProvider",null,[390]);class vr{constructor(b,h){this.ix=b;this.PVj=h}njk(){const b=new Qa.a,h=new Qa.a,n=new kf.a(new bg.a);var x=this.ix.vQ;if(!x||!x.count)return vr.V4e;x=this.ix.QEd(x);if(!x||!x.count)return w.ULS.sendTraceTag(592056450,377,15,"ChangeSummariesRequestBuilder.BuildChangeSummariesRequest: no GraphNodes exist for the new changeIds"),
vr.V4e;for(let E of x)n.contains(E.id)||(n.add(E.id),this.o8m(E,b,h));return h.count&&b.count?Object.assign(new up,{activityChanges:h.toArray(),documentContent:b.toArray(),requestId:ej.a(C.a.create())}):vr.V4e}o8m(b,h,n){if(Cd.ParagraphReader.oc(b)){var x=Cd.ParagraphReader.plainText(b);if(x&&x.length){h.add(x);x=this.ix.cAb(b);x=this.uPl(x);for(let E of x){x=new Qa.a;const S=this.getTextRanges(b,E);for(let ma of S)x.add({changeEnd:ma.endIndex,changeSpanId:ma.yEn,changeStart:ma.startIndex,contentIndex:h.count-
1,locationId:ej.a(b.id)});(x=this.qFk(E,x.toArray()))&&n.add(x)}}else w.ULS.sendTraceTag(591975071,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: no content available")}else w.ULS.sendTraceTag(592056452,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: node did not cast to AParagraphNode")}uPl(b){const h=new Jc.a;for(let n of b)(b=this.WUh(n))?(h.xb(b)||h.Z(b,new kf.a(new bg.a)),h.J(b).add(n)):w.ULS.sendTraceTag(579712270,377,15,"ChangeSummariesRequestBuilder.GroupChangeIdsByUser: unable to get person id from change id");
return h.values}qFk(b,h){const n=[];let x=null;for(let E of b)if(b=this.ix.mGc(E,C.a.nil)){if(!x){const S=this.WUh(E);if(!S||!S.length){w.ULS.sendTraceTag(579712272,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get person id from change id");continue}x=S}n.push(b)}else w.ULS.sendTraceTag(579712271,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get activity from change id");return n.length?x?h.length?{activityId:n[0].activityId,changes:h,personId:x,timestamp:n[0].displayTimestamp.toISOString()}:
(w.ULS.sendTraceTag(579712273,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no changes provided for ActivityChange"),null):(w.ULS.sendTraceTag(579605389,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: could not get personId for ActivityChange"),null):(w.ULS.sendTraceTag(579605388,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no activities exist for ActivityChange"),null)}WUh(b){b=this.ix.mGc(b,C.a.nil);if(!b)return w.ULS.sendTraceTag(579712274,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: unable to get activity from change id"),
null;b=b.actors;if(!b||!b.length||!b[0])return w.ULS.sendTraceTag(592056451,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: no people are associated with this Activity in ChangeSummariesRequest"),null;let h=b[0].id;h&&h.length||(h=b[0].email);return h}getTextRanges(b,h){const n=new Qa.a;if(!h||!h.count||!b)return n;let x=-1,E=new kf.a(new bg.a);for(let S=0;S<b.qa.length;S++){const ma=b.qa.J(S);if(-1!==x&&ma.isChangeEnd){if(ma.changeStart&&h.contains(ma.changeStart)){E.add(ma.changeStart);
continue}n.add({startIndex:x,endIndex:ma.cp,yEn:this.PVj.AVi(E)});x=-1;E=new kf.a(new bg.a)}ma.changeStart&&h.contains(ma.changeStart)&&(x=ma.cp,E.add(ma.changeStart))}return n}}vr.V4e=Object.assign(new up,{activityChanges:[],documentContent:[],requestId:ej.a(C.a.nil)});Object(r.a)(vr,"ChangeSummariesRequestBuilder",null,[]);class wq{constructor(){this.changes=this.content=null}}Object(r.a)(wq,"ContentChange",null,[]);class Gr{constructor(){this.ranking=0;this.reasons=this.contentChanges=this.locationId=
this.activities=null}}Object(r.a)(Gr,"FeaturedActivityGroup",null,[]);class Hr{constructor(){this.end=this.start=0}}Object(r.a)(Hr,"TextRange",null,[]);class bn{constructor(b){this.yic=b}i9n(b,h,n){if(!h)return w.ULS.sendTraceTag(588379906,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is null"),bn.wzd;if(!h.inferences)return w.ULS.sendTraceTag(588379907,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.Inferences is null"),
bn.wzd;if(!h.activityClassifications)return w.ULS.sendTraceTag(588379908,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.ActivityClassifications is null"),bn.wzd;if(!h.inferences.length||!h.activityClassifications.length)return w.ULS.sendTraceTag(561111455,377,50,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is empty"),bn.wzd;const x=[],E=new ea.a(new bg.a);for(let S of h.inferences){const ma=this.h9n(S,b,h,n);if(!ma)continue;
const Fa=this.yic.Htl(ej.b(ma.locationId));Fa.equals(C.a.nil)?x.push(ma):E.xb(Fa)?E.J(Fa).ranking>ma.ranking&&E.Z(Fa,ma):E.add(Fa,ma)}b=[...Array.from(E.values),...x];b.sort((S,ma)=>S.ranking-ma.ranking);return b.slice(0,bn.SDm)}h9n(b,h,n,x){if(!b||th.a.nf(b.activitiesInGroup))return w.ULS.sendTraceTag(588379909,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: inference is empty"),null;const E=new Qa.a,S=new Jc.a;let ma=null;for(let $a of b.activitiesInGroup){if(!$a){w.ULS.sendTraceTag(588379910,
377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity is null");continue}if(0>$a.activityIndex||$a.activityIndex>=n.activityClassifications.length){w.ULS.sendTraceTag(588379911,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity.ActivityIndex is invalid");continue}const sb=n.activityClassifications[$a.activityIndex];if(!sb||th.a.nf(sb.contents))w.ULS.sendTraceTag(588379912,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activityClassification is empty");
else{var Fa=this.J6k(x,sb.activityId);if(Fa){E.add(Fa);for(let Jb of $a.changes){if(!Jb){w.ULS.sendTraceTag(576251591,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef is null");continue}Fa=Jb.value;if(0>Fa||Fa>=sb.contents.length){w.ULS.sendTraceTag(576251592,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef index is invalid");continue}Fa=sb.contents[Fa];if(!Fa){w.ULS.sendTraceTag(576251593,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContent is null");
continue}const Sb=h.documentContent[Fa.contentIndex],oc=Object.assign(new Hr,{start:Fa.changeStart,end:Fa.changeEnd});if(S.xb(Sb))S.J(Sb).add(oc);else{let Ic;S.Z(Sb,(Ic=new Qa.a,Ic.add(oc),Ic))}ma||(ma=Fa.locationId)}}else w.ULS.sendTraceTag(588379913,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activity is null")}}if(!E.count)return w.ULS.sendTraceTag(588379914,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no activities for ActivityGroup"),null;h=this.xLl(S);
return h.count?Object.assign(new Gr,{ranking:b.ranking.value,reasons:[1],activities:E.toArray(),contentChanges:h.toArray(),locationId:ma}):(w.ULS.sendTraceTag(588379915,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no content change for ActivityGroup"),null)}J6k(b,h){for(let n of b)if(n&&n.activityId&&n.activityId===h)return n;return null}xLl(b){const h=new Qa.a;for(let x of b){b=x.key;const E=x.value;E.Sc((S,ma)=>S.start-ma.start);var n=E.J(0).start;if(n>bn.yoi){n-=bn.yoi;
b=b.substring(n,b.length);for(let S of E)S.start-=n,S.end-=n}h.add(Object.assign(new wq,{content:b,changes:E.toArray()}))}return h}}bn.wzd=[];bn.yoi=10;bn.SDm=4;Object(r.a)(bn,"ChangeSummariesResponseTranslator",null,[]);class Nm{constructor(){this.Mmb=new Jc.a;this.rDe=new Jc.a}set(b,h){if(h.length&&b){this.Mmb.Z(b,h);for(let n of h)if(n.activities)for(let x of n.activities)x&&x.activityId?this.rDe.Z(x.activityId,b):w.ULS.sendTraceTag(573920657,377,15,"FeaturedActivityGroupCache.Set: null activity in group");
else w.ULS.sendTraceTag(573920656,377,15,"FeaturedActivityGroupCache.Set: null activities for group")}}get(b){return b&&this.Mmb.xb(b)?this.Mmb.J(b):null}UAm(b){return b&&this.rDe.xb(b)?this.rDe.J(b):null}}Object(r.a)(Nm,"FeaturedActivityGroupCache",null,[]);class Xq{constructor(b){this.VRd=(h,n,x,E,S)=>{if(!S)return w.ULS.sendTraceTag(574103576,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null actionData"),8;h=S.Activity;if(!h)return w.ULS.sendTraceTag(574103577,377,
15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null activity"),8;n=this.Mmb.UAm(h.activityId);if(!n)return w.ULS.sendTraceTag(574103578,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: No matching request Id found"),8;x=Xf.UF(h);w.ULS.sendTraceTag(574103579,377,50,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: [RequestId={0};ActivityId={1};ChangeIds={2}]",n,h.activityId,this.AVi(x));return 32};this.Mmb=b;this.Wvg=new Map}Vb(b){b.pa(ub.a.VRd,
Ld.a.frame,this.VRd)}AVi(b){let h=0;const n=Array(b.count);for(let x of b)b=this.Ezl(x),n[h]=ej.a(b),h++;return n.join(",")}Ezl(b){let h=this.Wvg.get(b);if(h&&h!=C.a.nil)return h;h=C.a.create();this.Wvg.set(b,h);return h}}Object(r.a)(Xq,"FeaturedActivityGroupTelemetryActor",null,[]);var cn=d(93);class ps extends Sys.EventArgs{constructor(b){super();this.node=b}}Object(r.a)(ps,"OnParagraphVisitedArgs",Sys.EventArgs,[]);class Co{constructor(b,h,n){this.WR=null;this.o9n=x=>{this.DUa.reset();x=this.oLl(x.customData);
let E=null;for(;x.moveNext();){const S=x.currentNode;if(S&&(Cd.ParagraphReader.oc(S)&&this.sa.raiseEvent("OPV",new ps(S)),this.DUa.update(),this.DUa.khb())){E=S;break}}E?this.Y7g(E):this.WR(!0)};this.Hb=b;this.DUa=h;this.oz=n;this.sa=new Ge.a;this.esb=new Promise(x=>{this.WR=x})}s6j(b){this.sa.addHandler("OPV",b)}ggk(){this.Y7g(null)}Y7g(b){const h=new We.a(3,1,0,this.o9n,182);h.customData=b;this.Hb.$b(h)}oLl(b){if(!b)return cn.a.Vp(this.oz);b=md.GraphIterator.$a(b);b.Bb(7);return cn.a.Ir(b,this.oz)}}
Object(r.a)(Co,"DocumentTraverser",null,[]);class wr{constructor(b,h){this.fal=()=>{const n=document.getElementById("flyoutItem0");n&&(w.ULS.sendTraceTag(588129371,3012,50,"Focused on the catch-up flyout via ctrl+F6"),n.focus())};this.Mo=b;this.Wb=h}initialize(){const b=this.Wb.pe(xd.AFrame.oYb);b.LL=!0;b.parent=xd.AFrame.Lp;b.Wca(this.fal);this.Mo.kS(xd.AFrame.oYb)}enableF6Focus(){this.Mo.tG(xd.AFrame.oYb)}disableF6Focus(){this.Mo.Hw(xd.AFrame.oYb)}}Object(r.a)(wr,"FlyoutFocus",null,[387]);var Kq=
d(348);class Mn{constructor(b,h,n){this.Zug=this.jFg=this.apc=this.Icd=!1;this.Boe=this.B6c=null;this.RTm=(x,E,S,ma,Fa)=>{Fa[Qf.a.Visible]=!0;Fa[Qf.a.On]=this.apc&&this.Icd;return 32};this.sWm=(x,E,S)=>{if(1===S)return this.Icd?(this.jFg||(this.jFg=!0,w.ULS.sendTraceTag(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.B6c)return w.ULS.sendTraceTag(588129369,3012,10,"OnToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."),8;this.Zug=!0;this.B6c();
return 32};this.ga=b;this.tDg=h;this.Wb=n}get J8e(){return this.Boe?this.Boe:(w.ULS.sendTraceTag(578401728,3012,15,"Attempted to get _flyoutShowTimestamp before the value was set."),new Date)}set J8e(b){this.Boe=b}initialize(){this.Vb()}registerButtonClickedEvent(b){this.B6c&&w.ULS.sendTraceTag(588129366,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.B6c=b.buttonClickedCallback}onFlyoutInitialized(){var b;this.Icd&&w.ULS.sendTraceTag(588129367,
3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const h=(new Date).getTime()-this.J8e.getTime();w.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",h);this.Icd=!0;(null===(b=u.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1))||Kq.a.e0a("ribbon","catchUp");Pe.c(Ra.a.Gqk,!0,void 0,void 0,void 0,h)}onFlyoutVisibilityChanged(b){this.apc!==b.flyoutIsVisible&&
(this.apc=b.flyoutIsVisible,ob.App.xa&&ob.App.xa.updateCommandUI(!0),this.apc&&this.Zug&&this.Wb.Jg(xd.AFrame.oYb),this.apc||this.tDg&&this.tDg.num())}logFlightTriggers(b){b.hasFlyoutData&&u.AFrameworkApplication.Hf("WoCha187;WoCha187cf")}Vb(){this.ga.pa(Ra.a.u$i,Ld.a.frame,this.sWm);this.ga.gb(Ra.a.$Gi,Ld.a.frame,this.RTm,96)}}Object(r.a)(Mn,"FlyoutRibbonButton",null,[388]);var Do=d(151);class Da{constructor(b,h){this.vQ=null;this.oMd=this.cei=!1;this.UV=b;this.jf=h;this.cfb=new Do.a;this.VLd=new Map;
this.cfb.Z(1,new kf.a(new bg.a));this.cfb.Z(0,new kf.a(new bg.a));this.cfb.Z(2,new kf.a(new bg.a));this.cfb.Z(3,new kf.a(new bg.a));this.VLd.set(3,"CatchUpIndicatorVisible");this.VLd.set(1,"CatchUpIndicatorPreviewed");this.VLd.set(2,"CatchUpIndicatorSelected");this.L2d=0}bli(b,h){if(this.cfb.J(h).add(b)){this.nwm(h);switch(h){case 0:w.ULS.sendTraceTag(592545740,377,50,"LogIndicatorTelemetry: indicator rendered");break;case 1:w.ULS.sendTraceTag(592545739,377,50,"LogIndicatorTelemetry: indicator hovered");
break;case 2:w.ULS.sendTraceTag(592545738,377,50,"LogIndicatorTelemetry: indicator clicked");break;case 3:w.ULS.sendTraceTag(528593420,377,50,"LogIndicatorTelemetry: indicator visible")}this.nkh()}}pTm(b){this.a1k();b=this.UV.cAb(b);for(let h of b)if(this.vQ.remove(h)){this.L2d++;break}}a1k(){if(!this.vQ){this.vQ=new kf.a(new bg.a);for(let b of this.UV.vQ)this.vQ.add(b)}}B9j(){w.ULS.sendTraceTag(590890074,377,50,"Total number of renderable indicators: {0}",this.L2d);this.nkh()}nkh(){this.L2d&&(this.rsk(),
this.csk())}rsk(){!this.cei&&.5<=this.cfb.J(0).count/this.L2d&&(this.cei=!0,Pe.c(Ra.a.Iqk),w.ULS.sendTraceTag(590926531,377,50,"User started Catch Up Passive Session"))}csk(){if(!this.oMd){var b="";1<=this.cfb.J(1).count&&(this.oMd=!0,b="previews");1<=this.cfb.J(2).count&&(this.oMd=!0,b="selections");this.oMd&&(Pe.c(Ra.a.Aqk),w.ULS.sendTraceTag(590926532,377,50,"User started Catch Up Active Session due to {0}",b))}}nwm(b){(b=this.VLd.get(b))&&this.jf.logKpiUsage(b,0)}}Object(r.a)(Da,"IndicatorTelemetryActor",
null,[]);var Ua=d(501);d(1023);class qb{constructor(b,h){this.f_c=b;this.Fzc=h}iNl(){return this.Fzc.promise.then(b=>b.getWywaActivitiesResponse)}getActivities(b,h){return Ua.b(this.f_c.requestActivities(b,h))}getRelevantActivities(b,h){return this.Fzc.promise.then(n=>n.getWywaActivitiesResponse.WywaWaterline===b?Promise.resolve(n.getRelevantActivitiesResponse):Ua.b(this.f_c.requestRelevantActivities(b,h)))}updateActivityState(b){return Ua.b(this.f_c.updateActivityState(b))}getActivityFeed(){return this.Fzc.promise.then(b=>
void 0!==b.activityFeed?Promise.resolve(b.activityFeed):Ua.b(this.f_c.requestActivityFeed()))}updateWaterline(){return Ua.b(this.f_c.Htn())}}Object(r.a)(qb,"ActivityRepository",null,[]);var ac=d(1025);class tc{constructor(b){this.ql=b}get gf(){return this.ql&&this.ql.Ji?this.ql:null}Ecc(b,h){return this.gf?this.gf.XTe(b,!0)?this.gf.Ecc(b,h,!0,!0):(w.ULS.sendTraceTag(579396803,377,15,"ScrollToHighlightParagraph: unable to scroll to desired paragraph"),null):null}}Object(r.a)(tc,"PageViewWrapper",null,
[]);class Fc{constructor(b,h,n,x,E){this.activityContentManager=b;this.Ac=h;this.JXk=n;this.jf=x;this.g_l=E}Fwf(b){let h=new Map;h.set("activityType",b.type.toString());this.jf.logKpiUsage("CatchUpNavigateToActivity",0,{extendedProperties:h})}Zvf(b){this.jf.logKpiFailure("CatchUpNavigateToActivity",b,{},{name:"CatchUpExperienceDegraded",errorNameOverride:"NavigateToActivityFailed"})}IIm(b){try{const h=b.activity;this.Fwf(b.activity);1==h.type&&this.g_l.tSd();if(!this.activityContentManager.doesContentExist(h))return this.activityContentManager.sao(h),
this.Zvf("Content does not exist"),Promise.resolve(2);const n={};let x=0;switch(h.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:n.ActivityId=h.activityId;n.NavigationId=atob(h.navigationId);x=this.Ac.Xb(Ra.a.BWe,2,n);break;case 1:n.Activity=h,n.NodeId=b.locationId,x=this.Ac.Xb(ub.a.b_f,2,n),n.NodeId&&this.Ac.Xb(ub.a.VRd,2,n)}8==x&&this.Zvf("Action failed")}catch(h){return w.ULS.sendTraceTag(592237846,3012,10,"Exception thrown trying to navigate to an activity. {0}",h),this.Zvf("Exception was thrown"),
Promise.resolve(3)}return Promise.resolve(1)}navigateToActivity(b){return this.JXk.esb.then(()=>this.IIm(b))}}Object(r.a)(Fc,"WordActivityNavigationManager",null,[382]);var id;(function(b){b[b.default=0]="default";b[b.D48X48=1]="D48X48";b[b.D64X64=2]="D64X64";b[b.D96X96=3]="D96X96";b[b.D120X120=4]="D120X120";b[b.D240X240=5]="D240X240";b[b.D360X360=6]="D360X360";b[b.D432X432=7]="D432X432";b[b.D504X504=8]="D504X504";b[b.D648X648=9]="D648X648"})(id||(id={}));Object(r.b)("ProfilePhotoDimension",id);var Hd=
d(772),re=d(1440),df=d(519);class hh{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(r.a)(hh,"ActivityRequestPayload",null,[]);class fk{constructor(){this.color=this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(r.a)(fk,"Person",null,[]);class cg extends ng{constructor(){super();this.relationship=0}}Object(r.a)(cg,"TaskActivity",ng,[]);class Xg extends ng{constructor(){super();
this.contentId=null}}Object(r.a)(Xg,"CommentActivity",ng,[]);class Kh extends Xg{constructor(){super()}}Object(r.a)(Kh,"CommentReplyActivity",Xg,[]);class Rh extends Xg{constructor(){super();this.PBi=null}}Object(r.a)(Rh,"MentionActivity",Xg,[]);class Xe{constructor(b,h,n,x){this.Nmb=b;this.s8a=h;this.fCe=n;this.$M=x;this.$M.isFirstDocumentOpen=!1}requestWYWAActivities(){return this.Nmb.iNl().then(b=>{if(!b||b.StatusCode&&155!==b.StatusCode)throw this.WZe("GetWYWAActivities",b);155===b.StatusCode&&
(w.ULS.sendTraceTag(40433563,377,50,"No waterline is found on GetWywaActivities request."),this.$M.isFirstDocumentOpen=!0);const h=this.X4f(b.People);return Object.assign(new hh,{activities:this.bae(b.Activities,h),actors:h,hasMore:!b.AllWYWA,highWaterline:b.HighWaterline,lowWaterline:b.LowWaterline,wywaWaterline:b.WywaWaterline,isFirstDocumentOpen:155===b.StatusCode})})}requestActivities(b,h){return this.Nmb.getActivities(b,h).then(n=>{if(!n||n.StatusCode)throw this.WZe("GetActivities",n);const x=
this.X4f(n.People);return Object.assign(new hh,{activities:this.bae(n.Activities,x),actors:x,hasMore:!n.RequestedRetrieved,highWaterline:n.HighWaterline,lowWaterline:n.LowWaterline})})}requestRelevantActivities(b){return this.Nmb.getRelevantActivities(b,this.$M.isFirstDocumentOpen).then(h=>{if(!h||h.StatusCode)throw this.WZe("GetRelevantActivities",h);const n=this.X4f(h.People),x=this.bae(h.NewActivities,n,2);h=this.bae(h.OutstandingActivities,n,3);for(let E of h)x.push(E);return Object.assign(new hh,
{activities:x,actors:n})})}updateActivityState(b){return this.Nmb.updateActivityState(b)}requestActivityFeed(){return this.Nmb.getActivityFeed().then(b=>({activityFeedItems:b}))}bae(b,h,n=1){const x=[];if(!b)return x;for(let ma of b){var E=null;b=[];b.push(h[ma.CreatorIndex]);switch(ma.ActivityType){case 1:E=ma;var S=new Xf;S.Su=new Qa.a;for(let Fa of E.ChangeIds)S.Su.add(ej.b(Fa));S.objectId=ej.b(E.ObjectId);E=S;break;case 2:E=ma;S=new Xg;S.contentId=E.ContentId;S.navigationId=E.NavigationId;E=S;
break;case 4:E=ma;S=new Rh;b.push(h[E.MentioneeIndex]);S.PBi=E.ParentContentId;S.navigationId=E.NavigationId;E=S;break;case 3:case 10:E=ma;S=new Kh;b.push(h[E.RepliedIndex]);S.contentId=E.ContentId;S.navigationId=E.NavigationId;E=S;break;case 6:case 7:case 8:case 9:E=ma,S=new cg,b.push(h[E.MentioneeIndex]),S.navigationId=E.NavigationId,S.relationship=E.Relationship,E=S}E&&(E.actors=b,E.displayTimestamp=new Date(ma.DisplayTimestamp),E.activityId=ej.b(ma.ActivityId).toString(),E.type=ma.ActivityType,
1!==n&&(E.relevancy=n),x.push(E))}return x}ywn(b,h,n){return this.fCe&&!ff.b(b)&&this.fCe.CPd?this.fCe.QZb(h,n,u.AFrameworkApplication.um,id.default):b}X4f(b){if(!b)return null;const h=Array(b.length);for(let n=0;n<b.length;n++){if(!b[n])continue;const x=new fk;x.id=b[n].Id;x.provider=b[n].Provider;x.displayName=b[n].DisplayName;x.email=b[n].Email;x.imageUrl=this.ywn(b[n].PictureUrl,b[n].Email,b[n].Provider);this.s8a&&(x.color=this.s8a.gJc(new Hd.a(x.email,void 0,x.displayName),re.a.catchUpFlyout));
h[n]=x}return h}WZe(b,h){let n="null";h&&(n=df.a[h.StatusCode]);return Error.create(String.format("{0} failed with status code: {1}.",b,n))}}Object(r.a)(Xe,"WordActivityRequestManager",null,[383]);class Be{constructor(b,h,n){this.xfd=0;this.vtc=!1;this.lMg=null;this.updateWaterline=()=>{if(ob.App.lostSession)w.ULS.sendTraceTag(51217553,391,100,"The session is lost. Stop fetching new activities.");else if(this.vtc||3>=this.xfd){this.vtc?this.vtc=!1:this.xfd++;const x=Math.max(this.Ma.rc("WordEditorActivityManagementMaturityMiliSeconds",
30001)+5E3-(+new Date-+this.lMg),0);w.ULS.sendTraceTag(39396256,391,100,"Requesting new activities in {0}ms",x);aj.Task.delay(x).continueWith(()=>{this.Nmb.updateWaterline().then(()=>{this.i4d();return null}).catch(()=>{this.i4d();this.vtc=!0;this.xfd=0})})}else this.i4d()};this.Ma=b;this.Nmb=n;h.bOe(()=>{this.vtc=!0;this.lMg=new Date;this.xfd=0})}start(){this.i4d()}i4d(){window.setTimeout(this.updateWaterline,6E4)}}Object(r.a)(Be,"WordEditorActivityScheduler",null,[]);class te{constructor(){this.resolve=
null;this.promise=new Promise(b=>{this.resolve=b})}HFn(b){this.resolve(b)}}Object(r.a)(te,"CatchUpNetworkRequestWorkerCache",null,[]);class Nf{constructor(b,h,n){this.JNk=b;this.K=h;this.jf=n}GHf(b){b&&b.authors&&this.jwm(b.authors)}jwm(b){for(let h of b)h&&h.displayName===this.JNk&&(this.jf.logKpiFailure("CatchUpActivitiesReady","CatchUpShowsChangesFromCurrentAuthor",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}),w.ULS.sendTraceTag(571745507,377,15,"LogIfWywaAuthorMatchesCurrentUser: WYWA author has same name as current user [same id={0},same email={1}]",
h.id===this.K.lb("PresenceUserId"),h.email===this.K.lb("UserPrincipalName")))}}Object(r.a)(Nf,"WywaAuthorComparator",null,[]);class kg{constructor(b){this.o_=b}tSd(){this.o_&&this.o_.execute(b=>b.logActivity("CatchUpIndicatorSurveyNomination",null))}}Object(r.a)(kg,"IndicatorSurveyActor",null,[]);var gk=d(997),Lh=d(990);class wj{constructor(){this.Jqk={crewAlias:"webasynccollabeng",featureName:"CatchUp",topLevelKpiName:"CatchUpFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.CatchUpActivity"}get Cqk(){return u.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")}get Ynf(){return u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ChangeSummariesEnabled",
!1)}get yai(){return u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpDynamicEntryPointEnabled",!1)}get V$h(){return u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpCustomDynamicEntryPointEnabled",!1)}get Cnf(){return u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}get rMc(){return u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCatchUpActivitiesReadyTelemetryFixEnabled",
!1)}get Mkm(){return u.AFrameworkApplication.K.$("IsUserFromDifferentTenant")}zc(b){cp("Configure");this.container=b;b.ha("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache",()=>new te).singleInstance()}init(){cp("Init");this.Cqk&&(N.a.instance.registerOnPackageInit("WordEditor.Workers",()=>{this.container.resolve("Box4.Workers.IWebWorkerRouter").sendMessage(2,4,u.AFrameworkApplication.rootQuerySignature,ob.App.webServiceBase+"OneNote.ashx",2,this.Cnf)}),cp("HotStore"),ob.App.Tga.CBb.execute(()=>
{cp("ChromeReady");cj.a.get_instance().sl(7,()=>{cp("ScriptDownload");(u.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("catchUpActivity"):this.container.resolve("Common.IDynamicScriptLoaderProvider").tE.loadScript("catchUpActivity")).catch(b=>{w.ULS.sendTraceTag(592233361,377,10,"Failed to load the resources for the CatchUpActivity feature: {0}",b)}).then(()=>this.TNm()).catch(b=>{w.ULS.sendTraceTag(36548867,377,10,"Failed to initialize the CatchUpActivity feature: {0}",
b)})})}))}TNm(){cp("CreateObjectsAndInitializeState");this.mvm();this.EFk();return this.b1l()}mvm(){w.ULS.sendTraceTag(592217358,377,50,"CatchUpActivity feature enabled successfully");w.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");w.ULS.sendTraceTag(594401288,3012,50,"Tasks and outstanding data is enabled");this.Ynf&&w.ULS.sendTraceTag(588130079,3012,50,"ChangeSummaries is enabled");this.yai&&w.ULS.sendTraceTag(553911650,3012,50,"DynamicEntryPoint is enabled");
this.V$h&&w.ULS.sendTraceTag(553769042,3012,50,"CustomDynamicEntryPoint is enabled");w.ULS.sendTraceTag(545036493,3012,50,"IsUserFromDifferentTenant: {0}",this.Mkm);this.Cnf&&w.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")}b1l(){this.G1l();this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").J8e=new Date;cp("InitializeCatchUpApp");return this.nYb.initialize(Object.assign(new la,{featuredActivityGroupsEnabled:this.Ynf,summaryStringEnabled:!0,dynamicEntryPointEnabled:this.yai,
customDynamicEntryPointEnabled:this.V$h,activityFeedDataEnabled:this.Cnf})).then(()=>{this.container.resolve("WordEditor.CatchUpActivity.WordEditorActivityScheduler").start()})}EFk(){this.container.ha("WordEditor.CatchUpActivity.ChangeIdCache",()=>new wo(this.container.resolve("WordEditor.CatchUpActivity.IChangeIdObjectIdCache"),Kb.App.fm.jb.Jc.ud)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger",()=>new gk.a(ta.Health.instance,new Lh.a,this.Jqk)).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.IActivityStateManager",()=>new wk).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityContentManager",()=>new Ih(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),u.AFrameworkApplication.ya,Cj.UISurfaces.UP(),u.AFrameworkApplication.K.$("CatchUpFlyoutMockDataIsEnabled"))).as("Common.App.CatchUpActivity.IActivityContentManager").singleInstance();this.container.ha("WordEditor.CatchUpActivity.Network.ActivityRepository",
()=>new qb(new ac.a(Bh.a.p$i(this.container.Za("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper")),()=>u.AFrameworkApplication.rootQuerySignature,ob.App.webServiceBase+"OneNote.ashx",2,Bh.a.p$i(this.container.Za("Common.App.CatchUpActivity.ICatchUpRequestHandler"))),this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IActivityRequestManager",()=>new Xe(this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"),
this.container.resolve("Common.App.People.IPeopleColorUtils"),this.container.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),u.AFrameworkApplication.K.$("CatchUpFlyoutMockDataIsEnabled"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityHighlightManager",()=>new Oo(this.container.resolve("Box4.Highlight.IHighlightManager"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),
this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),Kb.App.fm.jb.Jc,new tc(Kb.App.fm.jb.Jc),kh.a.instance,de.FocusManager.instance(),this.container.resolve("Common.Utils.IAriaNotifier"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.DocumentTraverser",()=>{let b;b=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfYieldableDocumentTraversalIsEnabled",!1)?new tp(50,rd.a.lf):new Dp;return new Co(u.AFrameworkApplication.uc,b,Kb.App.fm.jb.Jc.ud)}).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.IndicatorSurveyActor",()=>new kg(this.container.Za("Common.ISystemInitiatedFeedback"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IActivityNavigationManager",()=>new Fc(this.container.resolve("WordEditor.CatchUpActivity.ActivityContentManager"),u.AFrameworkApplication.ya,this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),
u.AFrameworkApplication.K.$("CatchUpFlyoutMockDataIsEnabled"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.FlyoutRibbonButton",()=>new Mn(u.AFrameworkApplication.ya,this.container.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"),de.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutRibbonButton").singleInstance();this.container.ha("WordEditor.CatchUpActivity.FlyoutFocus",()=>new wr(ln.a.instance,de.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutFocus").singleInstance();
this.container.ha("WordEditor.CatchUpActivity.FeaturedActivityGroupCache",()=>new Nm).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorHelper",()=>new Jq(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),Kb.App.fm.jb.Jc)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor",()=>new Xq(this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"))).singleInstance();
this.container.ha("Common.App.CatchUpActivity.IChangeSummariesDataProvider",()=>new ir(new vr(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor")),new dp(this.container.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.container.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.container.resolve("Box4.AugmentationLoop.IAnnotationStorage"),u.AFrameworkApplication.uc),new bn(this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper")),
this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"),u.AFrameworkApplication.K.$("CatchUpFlyoutMockDataIsEnabled"))).singleInstance();this.nYb=catchUpActivity.FactoryGlobal.getWordCatchUpAppInstance(Object.assign(new gb,{activityContentManager:this.container.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.container.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),
activityRequestManager:this.container.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),appColorUpdateIsEnabled:u.AFrameworkApplication.K.$("AppColorUpdateIsEnabled"),changeSummariesDataProvider:this.container.resolve("Common.App.CatchUpActivity.IChangeSummariesDataProvider"),dataCulture:u.AFrameworkApplication.dataCulture,flyoutRibbonButton:this.container.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),flyoutFocus:this.container.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),
uiCulture:u.AFrameworkApplication.uiCulture,ulsLogger:new ml.a}));this.nYb.setWebpackPublicPath(u.AFrameworkApplication.r_);this.container.ha("WordEditor.CatchUpActivity.ActivityHighlightActor",()=>new vo(this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.WordEditorActivityScheduler",()=>new Be(u.AFrameworkApplication.K,U.a.instance,this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"))).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.IndicatorTelemetryActor",()=>new Da(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorActor",()=>new cq(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.nYb.getActivityIndicatorTooltipManager(),this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor"),
this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),Kb.App.fm.jb.Jc,this.container.Za("Common.IZoomManager"),u.AFrameworkApplication.uc,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper"),!!ob.App.instance&&ob.App.instance.Rla,this.container.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!ob.App.instance&&ob.App.instance.yA)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorManager",()=>new vq(this.container.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,
Kb.App.fm.jb.Jc.ud,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor"),u.AFrameworkApplication.ya,this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.rMc)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityAnnouncementManager",()=>new Cc(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("Common.Utils.IAriaNotifier"),
u.AFrameworkApplication.ya,de.FocusManager.instance())).singleInstance();this.container.ha("WordEditor.CatchUpActivity.WywaAuthorComparator",()=>new Nf(u.AFrameworkApplication.userName,u.AFrameworkApplication.K,this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).singleInstance()}G1l(){var b=this.container.resolve("Box4.Highlight.IHighlightManager"),h=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightActor");b.Xib(h);const n=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightManager");
b=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager");const x=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor");h=this.container.resolve("WordEditor.CatchUpActivity.ActivityAnnouncementManager");const E=this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),S=kh.a.instance,ma=this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser");S.OD(()=>{E.FOd?E.FOd=!1:(E.U1a&&n.wyi(null,null,!1),E.qeb&&n.Ixi(null,null),x.tVe())});
S.OD(Object(v.a)(h,h.VZ,"onSelectionChanged"));this.nYb.getWywaEvent().addListener(Object(v.a)(b,b.GHf,"onWywaActivityReady"));b=this.container.resolve("WordEditor.CatchUpActivity.WywaAuthorComparator");this.nYb.getWywaEvent().addListener(Object(v.a)(b,b.GHf,"onWywaActivityReady"));const Fa=this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor");ma.s6j(($a,sb)=>{sb&&Fa.pTm(sb.node)});ma.esb.then(()=>{Fa.B9j()});this.nYb.getWywaEvent().addListener(()=>{ma.ggk()});x.J4j(($a,sb)=>
{sb&&n.Ixi(sb.Nyb,sb.Q5h)});x.K4j(($a,sb)=>{sb&&n.wyi(sb.Nyb,sb.Q5h,sb.gSn)});x.Vb(u.AFrameworkApplication.ya);this.Ynf&&this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor").Vb(u.AFrameworkApplication.ya);this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").initialize();this.container.resolve("WordEditor.CatchUpActivity.FlyoutFocus").initialize();this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager").initialize();this.kWn()}kWn(){Mg.c()&&
(w.ULS.sendTraceTag(591673372,3012,50,"WordEditorCatchUpActivityPackageManager.ShowRibbonControls"),appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("MarkCatchUpChangeAsRead",!1)]))}dispose(){}}Object(r.a)(wj,"WordEditorCatchUpActivityPackageManager",null,[1,2]);var kj=d(149),If=d(435),jr=d(1467),kr=d(480),Dt=d(1560),xo=d(1474),rk=d(1612),xq=d(1613),Lu=d(638),Rs=d(1614),as=d(835),Yq=d(136),Qo=d(1481);class zl{constructor(){this.iu=this.annotation=null}}Object(r.a)(zl,"AnnotationChangedData",
null,[]);class Zn{constructor(b,h,n,x,E,S,ma,Fa=!1,$a){this.annotationType=b;this.ZUa=h;this.hq=n;this.Z8d=x;this.u3c=E;this.nmo=S;this.jb=ma;this.K0i=Fa;this.K=$a;this.$w=null;this.fei=!1;this.fe=new Ge.a;this.cSc=0}LE(b){this.fe.addHandler("AnnotationChangedEvent",b)}XG(b){this.fe.removeHandler("AnnotationChangedEvent",b)}register(){return this.u3c().then(()=>{0===this.cSc&&(this.K0i&&(this.$w=this.hq.fg("WebServiceCall",this.annotationType)),this.ZUa.mb(this,this.annotationType));this.cSc++})}unregister(){return this.u3c().then(()=>
(new Promise(b=>setTimeout(b,this.K.rc(Yq.a.LSk,3E3)))).then(()=>{0<this.cSc&&(this.cSc--,0===this.cSc&&this.ZUa.sc(this,this.annotationType))}))}x1b(){return this.u3c().then(()=>this.ZUa.getAnnotationsByType(this.annotationType))}AKh(b){b=If.a.VJ(b);return(b=this.ZUa.zKh(b))&&0<b.count?b.toArray().filter(h=>vn.a.matchesTypesFor(h.content,[this.annotationType])):[]}getParent(b){return b?b.parent?b.parent:b.parentPath?this.nmo(this.jb.Zc.Ad,b.parentPath):null:(w.ULS.shipAssertTag(575930380,3016,!1),
null)}Zra(b){b.timestamp||(b.timestamp=Date.now());b=Object.assign(new as.a,{parentPath:["Signal",vn.a.getTypeNameFor(b)],items:[Object.assign(new Po.a,{body:b})]});this.Z8d.submitOperation(b)}b_k(b,h,n,x){b=Object.assign(new an.a,{parentPath:["Signal",h,n,x],items:[Object.assign(new Po.a,{body:b})]});this.Z8d.submitOperation(b)}mI(b,h){b?h?(this.K0i&&!this.fei&&(this.$w.stop(),this.fei=!0),this.fe.Cea&&(b=new Qo.a(Object.assign(new zl,{annotation:b,iu:h})),this.fe.raiseEvent("AnnotationChangedEvent",
b))):w.ULS.shipAssertTag(575930382,3016,!1):w.ULS.shipAssertTag(575930381,3016,!1)}}Object(r.a)(Zn,"AnnotationManager",null,[336,179]);class Op{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb){this.WH=b;this.L3d=h;this.bzb=n;this.wcb=x;this.N5=E;this.K9i=S;this.y3=ma;this.LKb=Fa;this.Q_b=$a;this.ZGb=sb;this.c4n=Jb}}Object(r.a)(Op,"AnnotationManagerHolder",null,[335]);class Q{constructor(b,h){this.q9j=b;this.u3c=h}submitOperation(b){return this.u3c().then(()=>{this.q9j.getAugLoopRuntimeManager().submitOperation(Object.assign(new Np.a,
{operation:b}))})}}Object(r.a)(Q,"SubmitOperationHelper",null,[]);var wa=d(850),eb=d(1615),Lb=d(1021),ec=d(64),Tc=d(134),Ad=d(89);class we{constructor(b,h,n){this.N5=b;this.Nn=h;this.hBi=n;this.Vza={};this.xzh=!1;this.Ghb=(x,E)=>{E.data.iu===an.a.getTypeName()&&E.data.annotation&&E.data.annotation.annotationType===eb.a.getTypeName()&&(x=E.data.annotation.content)&&x.documentTypeConfidences.length&&(this.wzh=x.documentTypeConfidences[0].documentTypeLabel,w.ULS.sendTraceTag(541078657,3016,50,"Document type obtained: {0}",
this.wzh))};this.N5.LE(this.Ghb);this.N5.register();this.Vza={["docType"]:null,["characterCount"]:null,["paragraphCount"]:null,["imageCount"]:null,["tableCount"]:null,["listElementsCount"]:null,["blobsCount"]:null,["pageCount"]:null,["currentPage"]:null}}LHc(){this.xzh||(this.N5.Zra(new Lb.a),w.ULS.sendTraceTag(541078658,3016,50,"Document type classifier signal sent"),this.xzh=!0);this.RWk();this.Vza.docType=this.wzh;this.Vza.characterCount=this.characterCount;this.Vza.paragraphCount=this.$Z;this.Vza.imageCount=
this.cQ;this.Vza.tableCount=this.Una;this.Vza.listElementsCount=this.wji;this.Vza.blobsCount=this.beh;this.Vza.pageCount=this.hBi.dJc();this.Vza.currentPage=this.hBi.sUh();return this.Vza}RWk(){this.$Z=this.beh=this.wji=this.Una=this.cQ=this.characterCount=0;var b=this.Nn.AAa(Kb.App.fm.jb.Jc.ud,7,7).currentNode,h=md.GraphIterator.$a(b);for(b=cn.a.Ir(h,b);b.moveNext();)if(h=b.currentNode)if(Pd.ImageReader.qw(h))this.cQ++;else if(ag.TableReader.XW(h))this.Una++;else if(ec.ListReader.o2(h))this.wji++;
else if(Cd.ParagraphReader.oc(h)){var n=Ad.e(h);for(let x=0;x<n.length;x++)5===n[x].ri?this.cQ++:this.beh++;n=Tc.AParagraphNode.dU(h.characterData);n=n.trim();this.characterCount+=n.length;0<n.length&&!Cd.ParagraphReader.G$(h)&&!Cd.ParagraphReader.cK(h)&&this.$Z++}}}Object(r.a)(we,"LoggingDocumentInfo",null,[313]);class Rd{constructor(){this.sa=new Ge.a}N6j(b){this.sa.addHandler("OnTaskPaneReviewStateChanged",b)}Tpn(b){this.sa.removeHandler("OnTaskPaneReviewStateChanged",b)}L5j(b){this.sa.addHandler("BlueDotClickedEvent",
b)}Apn(b){this.sa.removeHandler("BlueDotClickedEvent",b)}a6j(b){this.sa.addHandler("OnFormattingMarkedForReview",b)}c6j(b){this.sa.addHandler("OnFormattingReviewCompleted",b)}$5j(b){this.sa.addHandler("OnFormattingAccept",b)}b6j(b){this.sa.addHandler("OnFormattingReject",b)}C6j(b){this.sa.addHandler("OnReviewInvalidated",b)}j9g(b){this.sa.addHandler("OnTraigeAction",b)}aOe(b){this.sa.addHandler("OnReviewVisibilityChanged",b)}Npn(b){this.sa.removeHandler("OnReviewVisibilityChanged",b)}J5j(b){this.sa.addHandler("OnBeforeReviewNavigation",
b)}y6j(b){this.sa.addHandler("OnRegisterEnhancement",b)}P6j(b){this.sa.addHandler("onTooltipVisibilityChanged",b)}Vpn(b){this.sa.removeHandler("onTooltipVisibilityChanged",b)}YVc(b){b?this.sa.raiseEvent("OnTaskPaneReviewStateChanged",new Qo.a(b)):w.ULS.shipAssertTag(575930374,3016,!1)}pcn(b){b?this.sa.raiseEvent("BlueDotClickedEvent",new Qo.a(b)):w.ULS.shipAssertTag(575930375,3016,!1)}scn(b){b?this.sa.raiseEvent("OnFormattingMarkedForReview",new Qo.a(b)):w.ULS.shipAssertTag(575930376,3016,!1)}GHi(b){b?
this.sa.raiseEvent("OnFormattingReviewCompleted",new Qo.a(b)):w.ULS.shipAssertTag(573850377,3016,!1)}rcn(b){b?this.sa.raiseEvent("OnFormattingAccept",new Qo.a(b)):w.ULS.shipAssertTag(575930377,3016,!1)}tcn(b){b?this.sa.raiseEvent("OnFormattingReject",new Qo.a(b)):w.ULS.shipAssertTag(575930378,3016,!1)}ucn(b){b?this.sa.raiseEvent("OnReviewInvalidated",new Qo.a(b)):w.ULS.shipAssertTag(575930379,3016,!1)}jOf(b){b?this.sa.raiseEvent("OnTraigeAction",new Qo.a(b)):w.ULS.shipAssertTag(573850378,3016,!1)}HHi(b){b?
this.sa.raiseEvent("OnReviewVisibilityChanged",new Qo.a(b)):w.ULS.shipAssertTag(573850379,3016,!1)}ocn(b){b?this.sa.raiseEvent("OnBeforeReviewNavigation",new Qo.a(b)):w.ULS.shipAssertTag(573687395,3016,!1)}jbc(b){b?this.sa.raiseEvent("OnRegisterEnhancement",new Qo.a(b)):w.ULS.shipAssertTag(555055117,3016,!1)}ZHi(b){b?this.sa.raiseEvent("onTooltipVisibilityChanged",new Qo.a(b)):w.ULS.shipAssertTag(540587343,3016,!1)}}Object(r.a)(Rd,"ReviewEvents",null,[317]);class yf{constructor(b){this.W=null;if(!b)throw kj.a.argument("Workspace is null");
this.mt=b}get name(){return"WordEditor.Designer.Common"}init(){}zc(b){b?(this.W=b,b.ha("WordEditor.Designer.Common.AL.ISubmitOperationHelper",()=>new Q(this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),If.a.zn)).singleInstance(),b.ha("WordEditor.Designer.IDesignerControl",()=>new wa.a(b.resolve("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager"),u.AFrameworkApplication.uiCulture)).singleInstance(),b.ha("WordEditor.Designer.Common.Review.IReviewEvents",()=>new Rd).singleInstance(),
b.ha("WordEditor.Designer.Common.AL.IAnnotationManagerHolder",()=>new Op(this.pza(xo.DocumentRoleDetectionAnnotation.getTypeName()),this.pza(xo.RoleDetectionAnnotation.getTypeName()),this.pza(jr.FormattingSuggestionsSummaryAnnotation.getTypeName(),!0),this.pza(jr.FormattingSuggestionsAnnotation.getTypeName()),this.pza(kr.DocumentTypeClassifierAnnotation.getTypeName()),this.pza(xq.ThemeExtractorAnnotation.getTypeName()),this.pza(Lu.ThemeGeneratorAnnotation.getTypeName()),this.pza(rk.TextToImageAnnotation.getTypeName()),
this.pza(Dt.DocumentPullQuoteAnnotation.getTypeName()),this.pza(Dt.PullQuoteAnnotation.getTypeName()),this.pza(Rs.TableTypeAnnotation.getTypeName()))).singleInstance(),b.ha("WordEditor.Designer.DocumentInfo",()=>new we(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").N5,b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("WordEditor.IPageNumberFinder"))).singleInstance()):w.ULS.shipAssertTag(575767060,3016,!1)}dispose(){}pza(b,h=!1){return new Zn(b,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
this.W.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),If.a.zn,If.a.qdb,this.mt,h,this.W.resolve("Common.IAppSettingsManager"))}}Object(r.a)(yf,"PackageManager",null,[1,2]);var rg=d(1484),vi=d(1466),Rk=d(1617);class Ij extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.lCf=h}}Object(r.a)(Ij,"RoleChangeArgs",Sys.EventArgs,[]);class Sl{constructor(b){this.qh=!1;this.ZO=b;this.ZO.ecd++}dispose(){this.qh||
(this.qh=!0,this.ZO.ecd--)}}Object(r.a)(Sl,"InvalidationSuspension",null,[10]);class hk{constructor(){this.L0c=null;this.role=this.LTd=0;this.ivb=this.OOd=this.Kla=this.o7b=!1;this.YSd=this.MQc=this.DKa=null;this.removed=this.placeholder=!1;this.Vqd=this.qCc=null;this.Uqd=0}get vfb(){return!this.role||!this.DKa||!this.DKa.length}P5l(){this.ivb=this.OOd=!0}alm(){return!!this.role||!!this.DKa||!!this.L0c}}Object(r.a)(hk,"RoleState",null,[426]);class Yl{constructor(b,h,n,x,E,S){this.zh=!1;this.cMd=null;
this.Dxf=new Aa.a;this.cGg=0;this.Pxn=(ma,Fa)=>{Fa.data.iu===an.a.getTypeName()&&(Fa=Fa.data.annotation,(ma=Fa.content)?(Fa=this.DTb.getParent(Fa))&&this.AZc(Fa,vi.e(ma.roleType),!1,void 0,null!=ma.listID?ma.listID:0,ma.listItemlevel,ma.listItemPrefix):w.ULS.shipAssertTag(575813856,3016,!1))};this.wXk=(ma,Fa)=>{if(Fa.data.iu===an.a.getTypeName())if(ma=Fa.data.annotation.content)for(w.ULS.sendTraceTag(556074199,3016,50,ma.confidence.toString()),this.Dxf=new Aa.a,Fa=0;ma.listInfos&&Fa<ma.listInfos.length;Fa++){const $a=
ma.listInfos[Fa];this.Dxf.Z($a.listID,$a)}else w.ULS.shipAssertTag(556323522,3016,!1)};this.Wci=(ma,Fa)=>{ma=ma.ZI;if(!ma||ma.ia(ic.a.qB,!1))return!1;ma=ma.getValue(ic.a.la);if(!ma)return!1;ma=vi.f(ma);return 1!=ma&&ma!=Fa.role};this.Pbl=(ma,Fa)=>{ma=Fa.data.annotation;const $a=this.X$c.getParent(ma);if($a)if(Fa.data.iu===an.a.getTypeName()){const sb=Fa.data.annotation.content;sb?this.Taa($a,Jb=>{this.cMd&&Jb.qCc&&this.cMd>Jb.qCc&&!Jb.ivb||Jb.role!==Jb.LTd||this.Wci($a,Jb)?(w.ULS.sendTraceTag(572301727,
3016,50,"InvalidationTimestamp: {0} | InvalidatedFlag: {1} | RlmRole==ModelRole: {2}",this.cMd,Jb.ivb,Jb.role===Jb.LTd),Jb.L0c=sb.suggestions):(Jb.DKa=sb.suggestions,Jb.ivb=!1)}):w.ULS.shipAssertTag(575813859,3016,!1)}else Fa.data.iu===rg.a.getTypeName()&&this.Taa($a,sb=>{sb.DKa=null;sb.L0c=null});else w.ULS.shipAssertTag(575813858,3016,!1,`Parent not found for annotation id: ${ma.id} parentPath: ${ma.parentPath}`)};this.xQm=(ma,Fa)=>{(ma=Fa.data.paragraphNode)?this.Taa(ma,$a=>{Fa.data.kij?($a.Vqd=
$a.DKa,$a.Uqd=$a.role):($a.Vqd=null,$a.Uqd=0);$a.Kla=!0}):w.ULS.shipAssertTag(575930368,3016,!1)};this.zQm=(ma,Fa)=>{(ma=Fa.data.paragraphNode)?this.Taa(ma,$a=>{$a.Kla=!1;$a.Vqd=null;$a.Uqd=0;5!==Fa.data.state&&($a.DKa=null)}):w.ULS.shipAssertTag(573850380,3016,!1)};this.vQm=(ma,Fa)=>{(ma=Fa.data.paragraphNode)?this.Taa(ma,$a=>{$a.Kla=!0}):w.ULS.shipAssertTag(575930369,3016,!1)};this.yQm=(ma,Fa)=>{(ma=Fa.data.paragraphNode)?this.AZc(ma,1,!0,!0):w.ULS.shipAssertTag(575930370,3016,!1)};this.qHf=(ma,
Fa)=>{(ma=Fa.data.paragraphNode)?this.AZc(ma,Fa.data.lCf,!0,!0):w.ULS.shipAssertTag(575484484,3016,!1)};this.XOl=(ma,Fa)=>{if(Fa.node){var $a=Fa.node;ma=this.qF($a);27==ma.role&&w.ULS.sendTraceTag(541435078,3016,50,"Pull Quote node deleted.");ma.Kla&&27!==ma.role&&28!==ma.role&&this.F_i(this.mcc-1);ma.vfb||27===ma.role||28===ma.role||this.y_i(this.inconsistenciesCount-1);this.Taa($a,sb=>{sb.removed=!0});this.rR.eai()||setTimeout(()=>this.removeNode($a),1E4)}else w.ULS.shipAssertTag(575930371,3016,
!1)};this.removeNode=ma=>{this.pMi(ma.id)};this.pMi=ma=>{let Fa;({value:Fa}=this.mq.Dc(ma));(null===Fa||void 0===Fa?0:Fa.removed)&&this.mq.remove(ma)};this.aon=()=>{const ma=this.mq.keys.toArray().filter(Fa=>this.mq.J(Fa).removed);ma.sort((Fa,$a)=>this.mq.J(Fa).qCc.getTime()-this.mq.J($a).qCc.getTime());ma.slice(0,10).forEach(Fa=>{this.pMi(Fa)})};this.WOl=(ma,Fa)=>{Fa.node?(ma=Fa.node,this.RNc(ma)?this.Taa(ma,$a=>{$a.removed=!1}):this.Taa(ma,$a=>{$a.ivb=!1})):w.ULS.shipAssertTag(540672206,3016,!1)};
this.YOl=(ma,Fa)=>{Fa.node?this.UYf(Fa.property,Fa.node)&&(ma=Fa.node,this.ecd||ma.c_d?this.Taa(ma,$a=>{$a.ivb=!1}):this.Taa(ma,$a=>{$a.P5l();$a.L0c&&($a.DKa=$a.L0c,$a.role=$a.LTd)}).Kla&&this.HTa.ucn(new Rk.a(Fa.node))):w.ULS.shipAssertTag(575930372,3016,!1)};this.gUm=(ma,Fa)=>{switch(Fa.data.role){case 27:const $a=Fa.data;this.Taa(Fa.data.paragraphNode,Jb=>{Jb.role=27;Jb.o7b=!0;Jb.placeholder=$a.placeholder});break;case 28:const sb=Fa.data;this.Taa(Fa.data.paragraphNode,Jb=>{Jb.role=28;Jb.o7b=!0;
Jb.placeholder=sb.placeholder;Jb.OKc=sb.OKc});break;case 2:this.Taa(Fa.data.paragraphNode,Jb=>{Jb.role=2})}};this.X$c=b;this.DTb=h;this.ome=n;this.rR=S;this.Dm=x;this.HTa=E;this.mq=new Aa.a;this.sa=new Ge.a;this.ecd=this.Ejd=this.Jbd=0}get j6l(){return this.ecd}e6j(b){this.sa.addHandler(Yl.dwi,b)}D6j(b){this.sa.addHandler(Yl.gyi,b)}f9g(b){this.sa.addHandler(Yl.MGf,b)}Opn(b){this.sa.removeHandler(Yl.MGf,b)}get inconsistenciesCount(){return this.Jbd}y_i(b){this.Jbd!==b&&(this.Jbd=b,this.sa.raiseEvent(Yl.dwi,
new Qo.a(this.Jbd)))}get mcc(){return this.Ejd}F_i(b){this.Ejd!==b&&(this.Ejd=b,this.sa.raiseEvent(Yl.gyi,new Qo.a(this.Ejd)))}get Zjf(){return this.cGg}RNc(b){return this.mq.xb(b.id)}Ewl(b){var h,n;return null===(n=null===(h=this.Dxf)||void 0===h?void 0:h.Dc(b))||void 0===n?void 0:n.value}IUh(b,h){var n,x,E;const S=new Map;for(const ma of h)if((h=ma)&&h.isConnected){const Fa=null!==(E=null===(x=null===(n=this.mq.Dc(h.id))||void 0===n?void 0:n.value)||void 0===x?void 0:x.role)&&void 0!==E?E:1;b.has(Fa)&&
(S.has(Fa)?S.get(Fa).add(h):S.set(Fa,new Qa.a([h])))}return S}qF(b){if(!b)return w.ULS.shipAssertTag(575813855,3016,!1),null;let h;return({value:h}=this.mq.Dc(b.id)).returnValue?h:Object.assign(new hk,{role:1,o7b:!1})}stn(){this.cMd=new Date;return new Sl(this)}register(){this.X$c.register();this.DTb.register();this.ome.register()}unregister(){this.X$c.unregister();this.DTb.unregister();this.ome.unregister()}initialize(){if(!this.zh){const b=this.Dm.Te(12);b.xv(this.XOl);b.rs(this.WOl);b.jp(this.YOl);
this.X$c.LE(this.Pbl);this.DTb.LE(this.Pxn);this.ome.LE(this.wXk);this.HTa.b6j(this.yQm);this.HTa.$5j(this.vQm);this.HTa.a6j(this.xQm);this.HTa.c6j(this.zQm);this.HTa.j9g(this.qHf);this.HTa.y6j(this.gUm);this.zh=!0}}qe(){}AZc(b,h,n,x=!1,E=0,S=0,ma){let Fa=0,$a=!1;this.Taa(b,sb=>{const Jb=sb.OOd||!sb.role||this.rR.Ckm()&&1==sb.role;n||(sb.LTd=h);if(x||Jb)$a=sb.role!==h,Fa=sb.role,sb.role=h,sb.o7b=n,sb.OOd=!1,sb.MQc=E,sb.YSd=S,sb.listItemPrefix=ma,sb.qCc=new Date});if($a){const sb=h-4;sb>this.Zjf&&
8>sb&&(this.cGg=sb);1===h&&this.Taa(b,Jb=>{Jb.DKa=null});this.sa.raiseEvent(Yl.MGf,new Qo.a(new Ij(b,h,Fa)))}}Taa(b,h){let n;if(({value:n}=this.mq.Dc(b.id)).returnValue){b=n.vfb;const x=n.Kla;h(n);if(27!==n.role&&28!==n.role){if(n.removed)return n;b!==n.vfb&&this.y_i(this.inconsistenciesCount+(b?1:-1));x!==n.Kla&&this.F_i(this.mcc+(x?-1:1))}}else h(n=new hk),n.alm()&&(this.rR.eai()&&this.mq.count>Yq.a.Rxn&&(w.ULS.sendTraceTag(525165656,3016,50,this.mq.count.toString()),this.aon()),this.mq.add(b.id,
n));return n}UYf(b,h){({value:h}=this.mq.Dc(h.id));return 28===(null===h||void 0===h?void 0:h.role)?!(null===h||void 0===h?0:h.placeholder)&&b===ie.a.lo:!(null===h||void 0===h?0:h.placeholder)&&(b===ie.a.lo||b===ie.a.Un||Array.contains(Tc.AParagraphNode.yea(),b))}}Yl.dwi="OnInconsistenciesChanged";Yl.gyi="OnRoleReviewCount";Yl.MGf="OnRoleChanged";Object(r.a)(Yl,"RoleLifecycleManager",null,[384,385,386]);class Sj{constructor(b,h,n,x,E){this.HTa=b;this.DTb=h;this.Jf=n;this.Dm=x;this.ZO=E;this.zh=!1;
this.qHf=(S,ma)=>{(S=ma.data.paragraphNode)?this.Uej(S,()=>!0,Fa=>Fa.userSetRole=vi.d(ma.data.lCf)):w.ULS.shipAssertTag(557057378,3016,!1)};this.mTm=(S,ma)=>{0<this.ZO.j6l||this.UYf(ma.property)&&this.Uej(ma.node,Fa=>!(Fa&&Fa.isInvalidated),Fa=>Fa.isInvalidated=!0)}}initialize(){this.zh||(this.HTa.j9g(this.qHf),this.Dm.Te(12).jp(this.mTm),this.zh=!0)}qe(){}Uej(b,h,n){if(b=(b=this.DTb.AKh(b))&&1===b.length&&b[0]){var x=b.content;x=x&&x.M_&&x.M_.customMetadata;h(x)&&(h=new xo.RoleDetectionCustomMetadata,
h.isInvalidated=x&&x.isInvalidated,h.userSetRole=x&&x.userSetRole,n(h),this.Jf.beo(b,h))}}UYf(b){return b===ie.a.lo||b===ie.a.Un||Array.contains(Tc.AParagraphNode.yea(),b)}}Object(r.a)(Sj,"RoleDetectionMetadataUpdater",null,[342]);var eg=d(1048);class yq{constructor(b,h){this.Z8d=b;this.Wxb=h;this.ESc=(n,x)=>{n=x.data;if(n.iu==eg.a.getTypeName()||n.iu==eg.n.getTypeName())if(n=n.annotation&&n.annotation.content)this.runId=n.runId};this.revisionId=0}initialize(){this.Wxb.LE(this.ESc)}qe(){this.Wxb.XG(this.ESc)}hNm(){if(void 0===
this.runId)Promise.resolve();else{var b=new xo.RoleDetectionSettings({acceptedRunId:this.runId});b=new eg.a({parentPath:["session","doc","main"],items:[{id:"RoleDetectionSettings",body:b,revId:(this.revisionId++).toString()}]});this.Z8d.submitOperation(b)}}}Object(r.a)(yq,"RoleDetectionSettingsUpdater",null,[]);class bs{constructor(b,h,n){this.e5l=b;this.ZUa=h;this.ze=n;this.N7h=this.initialized=!1;this.hui=()=>{this.k1i()&&(this.x6h(),this.ZUa.spn(this.hui))}}initialize(){this.initialized||(this.bmf(),
this.initialized=!0)}qe(){}bmf(){this.k1i()?this.x6h():this.ZUa.w5j(this.hui)}k1i(){return!this.N7h&&(this.ze.dai()||this.ZUa.d5b(xo.DocumentRoleDetectionAnnotation.getTypeName())||this.ZUa.d5b(xo.RoleDetectionAnnotation.getTypeName()))}x6h(){for(const b of this.e5l)b.initialize();this.N7h=!0}}Object(r.a)(bs,"RLMInitializer",null,[]);class $i{constructor(b,h,n){this.W3=b;this.mt=h;this.Z5c=n;this.W=null;this.Ega=()=>{this.YLc();this.mt.fjb(this.Ega)};if(!b)throw kj.a.argument("AppLifecycleManager is null");
if(!h)throw kj.a.argument("Workspace is null");if(!n)throw kj.a.argument("ApplicationInstance is null");}get name(){return"WordEditor.DocumentUnderstanding.RLM"}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>this.Nm())}zc(b){this.W=b;b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater",()=>new yq(this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").WH)).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater",
()=>new Sj(b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").L3d,b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager",()=>new Yl(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").wcb,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").L3d,
b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").WH,b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),b.resolve("WordEditor.Designer.IDesignerControl"))).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader",()=>b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager")).singleInstance();b.ha("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer",()=>new bs([this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),
this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater")],b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("WordEditor.Designer.IDesignerControl"))).singleInstance()}dispose(){}Nm(){this.Z5c.sI?this.W3.sl(16,()=>this.tLc()):this.tLc()}tLc(){this.mt.fta?this.YLc():this.mt.Zca(this.Ega)}YLc(){this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater").initialize();this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer").initialize()}}
Object(r.a)($i,"PackageManager",null,[1,2]);class xk{constructor(){this.ContractVersion=0;this.FileName=this.Paragraphs=null}static construct(b,h){const n=new xk;n.ContractVersion=b;n.FileName=h;n.Paragraphs=[];return n}}Object(r.a)(xk,"DocumentSwayPreviewContent",null,[]);class cs{constructor(){this.TextRuns=this.ParagraphFormatting=this.RawText=null;this.ParagraphIndex=0;this.IsRTL=!1}static gDk(b,h,n,x){const E=new cs;E.RawText=b;E.ParagraphFormatting=h;E.TextRuns=n;E.IsRTL=x;E.ParagraphIndex=
0;return E}}Object(r.a)(cs,"ParagraphContent",null,[]);var Zl=d(105),jt=d(1169);class Pp{constructor(){this.Name=null;this.Size=0}static construct(b,h){const n=new Pp;n.Name=b;n.Size=h;return n}}Object(r.a)(Pp,"FontData",null,[]);class Ss{constructor(){this.IsUppercase=this.IsUnderline=this.IsBold=!1;this.Font=null;this.LeftIndent=this.Alignment=0}static construct(b,h,n,x,E,S){const ma=new Ss;ma.IsBold=b;ma.IsUnderline=h;ma.IsUppercase=n;ma.Font=x;ma.Alignment=E;ma.LeftIndent=S;return ma}}Object(r.a)(Ss,
"TextFormatting",null,[]);class hg{constructor(){this.RunFormatting=this.RawText=null}static construct(b,h){const n=new hg;n.RawText=b;n.RunFormatting=h;return n}}Object(r.a)(hg,"TextRunContent",null,[]);var Mh=d(108),Kf=d(42);class zq{constructor(b,h){this.kOb=null;this.BJj=b;this.KM=h||""}get ZZm(){return this.BJj.value}o4k(){const b=Date.now(),h=xk.construct(2,this.KM);h.Paragraphs=this.Bfl();const n={};n.ExtractionDurationInMs=(Date.now()-b).toString();w.ULS.sendTraceTag(25268374,382,50,"{0}",
n);return h}Bfl(){const b=new Qa.a;var h=0;let n=0,x=!1;var E=new md.GraphIterator;E.set(this.ZZm);E=cn.a.Vp(E.currentNode);const S=new Aa.a(0);for(;E.moveNext()&&2100>n&&25>h;){var ma=E.currentNode;if(Cd.ParagraphReader.oc(ma)&&!Cd.ParagraphReader.G$(ma)){!x&&Cd.ParagraphReader.cK(ma)&&(x=!0);let Fa=Tc.AParagraphNode.dU(ma.characterData);Fa=Fa.trim();if(0<Fa.length){const $a=this.QAl(ma);$a.ParagraphIndex=h;h++;n+=Fa.length;b.add($a);this.nho(S,Cd.ParagraphReader.language(ma))}}}this.kOb=this.mml(S);
h={};h.documentHasList=x;w.ULS.sendTraceTag(25776736,382,50,"{0}",h);return b.toArray()}mml(b){let h=-1,n=1033;for(let x of b.keys.toArray())x&&b.J(x)>h&&(h=b.J(x),n=x);return vj.a.lg(n)}nho(b,h){b.xb(h)?b.Z(h,b.J(h)+1):b.Z(h,1)}QAl(b){const h=Tc.AParagraphNode.dU(b.characterData),n=this.UAl(b),x=this.hKl(b);b=this.Nfm(b);return cs.gDk(h,n,x,b)}UAl(b){const h=Cd.ParagraphReader.Ln(b,ie.a.bold,!1),n=Cd.ParagraphReader.Ln(b,ie.a.underline,!1);var x=Cd.ParagraphReader.Ln(b,ie.a.fontSize,Zl.a.IJ);const E=
Cd.ParagraphReader.Ln(b,ie.a.font,Zl.a.GG);var S=Cd.ParagraphReader.Ev(b);S=this.C$e(S);const ma=!!Cd.ParagraphReader.Ln(b,Th.a.capitalization,0);b=(new jt.a).eT(b).value/20;x=Pp.construct(E,x);return Ss.construct(h,n,ma,x,S,b)}hKl(b){const h=new Qa.a;for(let E=0;E<b.qa.length-1;E++){var n=b.qa.J(E),x=b.qa.J(E+1);n.formatting&&(x=Tc.AParagraphNode.dU(b.characterData.substr(n.cp,x.cp-n.cp)),n=this.iKl(n.formatting),n=hg.construct(x,n),h.add(n))}return h.toArray()}iKl(b){const h=Mh.FormattingReader.SIc(b,
ie.a.bold,!1),n=Mh.FormattingReader.SIc(b,ie.a.underline,!1);var x=Mh.FormattingReader.SIc(b,ie.a.fontSize,Zl.a.IJ);const E=Mh.FormattingReader.SIc(b,ie.a.font,Zl.a.GG);x=Pp.construct(E,x);b=!!Mh.FormattingReader.SIc(b,Th.a.capitalization,0);return Ss.construct(h,n,b,x,5,0)}C$e(b){switch(b){case 1:return 0;case 3:return 1;case 2:return 2;case 6:return 3;case 0:return 5;default:return 4}}Nfm(b){const h=new md.GraphIterator;h.set(b);h.Bb(11);return(b=h.kd(11))?Kf.OutlineElementReader.hm(b):!1}}Object(r.a)(zq,
"DocumentContentExtractor",null,[275]);class Ep{get name(){return"WordEditor.DocumentContentExtractor"}init(){}dispose(){}zc(b){b.ha("WordEditor.DocumentContentExtractor.DocumentContentExtractor",()=>new zq(new se.a(()=>Kb.App.fm.jb.Jc.ud),u.AFrameworkApplication.ut.yz)).as("Box4.DocumentContentExtractor.IDocumentContentExtractor").singleInstance()}static main(){N.a.instance.Pc(new Ep)}}Object(r.a)(Ep,"DocumentContentExtractorPackage",null,[1,2]);class xr{}xr.ug="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";
Object(r.a)(xr,"EmbedDialogHtml",null,[]);class eu{constructor(b,h,n,x){this.D$b=b;this.RYa=h;this.bYd=n;this.value=x}}Object(r.a)(eu,"OptionInfo",null,[]);class Kv{constructor(b,h,n){this.OUf=b;this.u4b=h;this.RYa=n}}Object(r.a)(Kv,"SectionInfo",null,[]);var Lv=d(233);class Yg extends Kc.a{constructor(b,h=!1){super(!1,!1,h);this.B9c=476;this.tPb=288;this.Ile=798;this.xPj=476;this.wPj=288;this.WTc={};this.Djb=[];this.TU=this.hTa=this.yrb=this.nob=this.Bgd=this.XSb=null;this.kmc=u.AFrameworkApplication.uKc;
this.Zrb=b;this.Uze=Object(v.a)(this,this.qYm,"optionClickHandler");this.gsc=Object(v.a)(this,this.rYm,"optionKeyHandler");this.Hge=Object(v.a)(this,this.Mdk,"arrowClickHandler");this.jNb=Object(v.a)(this,this.Ndk,"arrowKeyHandler");this.Fmd=Object(v.a)(this,this.l5n,"textAreaOnFocusHandler");this.dIj=h;this.ug=xr.ug;this.Ed=0;this.kg="EmbedDialog"}get Yq(){return this.tPb}set Yq(b){this.tPb=b}C3i(b){const h={["id"]:this.kg,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,
["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:Ec.a.Bp(this.Zrb,"wdPreview","1"),["initialEmbedUrl"]:this.kmc,["getEmbedCode"]:Yg.zOh,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const n of Object.keys(b))h[n]=b[n];this.Ed=1;this.We(1,CommonUIStrings.l_CopyAction);this.We(0,CommonUIStrings.l_Close);this.Zh(CommonUIStrings.l_Embed,null,h)}cec(){if(this.dIj)this.C3i({});
else{this.showDialog(CommonUIStrings.l_Embed,null);this.XSb=document.getElementById("embedpreviewpane");this.Bgd=document.getElementById("embedoptionpane");this.XSb.style.width=String.format("{0}px",this.xPj);this.hTa=document.createElement("iframe");this.hTa.className=Yg.vPj;this.hTa.frameBorder="0";this.hTa.style.height=String.format("{0}px",this.wPj);this.hTa.tabIndex=-1;this.XSb.appendChild(this.Pwd(CommonUIStrings.l_Preview,this.hTa,Yg.SUg,Yg.RUg,Yg.SUg,!0));this.TU=document.createElement("textarea");
this.TU.className=Yg.BAj;Sys.UI.DomElement.addCssClass(this.TU,Lv.a.VOe);this.TU.id=Yg.nBg;V.a.ki||(this.TU.readOnly=!0);this.TU.rows=4;this.TU.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.TU.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.TU.setAttribute(qf.a.dda,String.format("{0} {1}",Yg.mBg,Yg.lBg));this.XSb.appendChild(this.Pwd(CommonUIStrings.l_EmbedCode,this.TU,Yg.mBg));af.a.addHandler(this.TU,"focus",this.Fmd);var b=document.createElement("span");b.className=Yg.qCj;
b.innerText=CommonUIStrings.l_CopyText;b.id=Yg.lBg;this.XSb.appendChild(b);this.nob=document.createElement("div");this.nob.className=Yg.Izj;this.Bgd.appendChild(this.Pwd(CommonUIStrings.l_Dimensions,this.nob));this.yrb=document.createElement("div");this.Bgd.appendChild(this.sGk(Yg.BSg,this.yrb));this.Ed=0;this.We(1,CommonUIStrings.l_Close);this.M6f();this.Bgj();V.a.ki||this.TU.focus()}}dispose(){if(this.WTc){var b=this.WTc;for(let h in b){const n=b[h];this.lq.sc(kb.a.click,n.D$b,this.Uze);this.re.sc(kb.a.Di,
n.D$b,this.gsc);this.re.sc(kb.a.Bh,n.D$b,this.gsc)}this.gsc=this.Uze=this.WTc=null}if(this.Djb){for(b=0;b<this.Djb.length;++b)this.lq.sc(kb.a.click,this.Djb[b].u4b,this.Hge),this.re.sc(kb.a.Di,this.Djb[b].u4b,this.jNb),this.re.sc(kb.a.At,this.Djb[b].u4b,this.jNb),this.re.sc(kb.a.Bh,this.Djb[b].u4b,this.jNb);this.re=this.Hge=this.Djb=null}this.Fmd&&this.TU&&(af.a.removeHandler(this.TU,"focus",this.Fmd),this.Fmd=null);this.TU=this.hTa=this.yrb=this.nob=this.Bgd=this.XSb=null;super.dispose()}Yfa(){super.Yfa();
this.ed.style.width=String.format("{0}px",this.Ile);this.AVa()}Qfo(b,h){const n=Ec.a.Bp(this.kmc,b,h);return this.kmc!==n?(this.kmc=n,this.Zrb=Ec.a.Bp(this.Zrb,b,h),!0):!1}M6f(){this.TU&&(this.TU.innerText=Yg.zOh(this.kmc,this.B9c,this.tPb))}Bgj(){this.hTa&&this.hTa.contentWindow.location.replace(Ec.a.Bp(this.Zrb,"wdPreview","1"))}sbe(b,h){this.Qfo(b,h)&&(this.M6f(),this.Bgj())}Pwd(b,h,n=null,x=null,E=null,S=!1){const ma=document.createElement("div");ma.className=Yg.dSj;x&&(ma.id=x);E&&ma.setAttribute(qf.a.dda,
E);S&&(ma.tabIndex=0);x=document.createElement("span");x.className=Yg.eSj;x.innerText=b;n&&(x.id=n);ma.appendChild(x);ma.appendChild(h);return ma}sGk(b,h){const n=this.Pwd(CommonUIStrings.l_Interaction,h),x=this.Ik.createElement("div");x.className=Yg.yuj;x.id=Yg.Etg+b;x.setAttribute(qf.a.Ah,qf.a.n1);x.tabIndex=0;n.insertBefore(x,h);b=Tg.createClusteredImage(16,16,Yg.zuj,Yg.Auj,!0,"");x.appendChild(b);b=b.childNodes[0];b.className=Tg.getImageClass(Yg.EAg);b.title=CommonUIStrings.l_Expand;x.title=CommonUIStrings.l_Expand;
h.style.visibility="hidden";h=new Kv(h,x,b);Array.add(this.Djb,h);this.lq.jE(kb.a.click,x,this.Hge,h);this.re.jE(kb.a.Di,x,this.jNb,h);this.re.jE(kb.a.At,x,this.jNb,h);this.re.jE(kb.a.Bh,x,this.jNb,h);return n}Mdk(b){this.Cjh(b);return!0}Ndk(b){return this.lPc(b,Object(v.a)(this,this.Cjh,"changeArrowState"))}Cjh(b){b=b.vp;"visible"===b.OUf.style.visibility?(b.OUf.style.visibility="hidden",b.RYa.className=Tg.getImageClass(Yg.EAg),b.RYa.title=CommonUIStrings.l_Expand,b.u4b.title=CommonUIStrings.l_Expand):
(b.OUf.style.visibility="visible",b.RYa.className=Tg.getImageClass(Yg.pXj),b.RYa.title=CommonUIStrings.l_Collapse,b.u4b.title=CommonUIStrings.l_Collapse)}zrh(b,h){const n=document.createElement("div");n.className=Yg.ySg;n.id=b+Yg.zSg;var x=this.Ik.createElement("div");x.tabIndex=0;x.className=Yg.awg;x.id=b+Yg.Ojc;x.setAttribute(qf.a.Ah,qf.a.xQe);x.setAttribute(qf.a.Hya,qf.a.Ho);x.setAttribute(qf.a.dda,b+Yg.OOb);n.appendChild(x);n.setAttribute(qf.a.Ah,qf.a.xz);var E=Tg.createClusteredImage(16,16,Yg.gwg,
Yg.fwg,!0,"");x.appendChild(E);E=E.childNodes[0];E.id=b+Yg.ASg;E.className=Tg.getImageClass(Yg.Die);x=new eu(n,E,x,1);this.WTc[b]=x;this.lq.jE(kb.a.click,n,this.Uze,b);x=document.createElement("span");x.className=Yg.OOb;x.innerText=h;x.id=b+Yg.OOb;n.appendChild(x);this.re.jE(kb.a.Di,n,this.gsc,b);this.re.jE(kb.a.Bh,n,this.gsc,b);return n}qYm(b){this.gAi(b);return!0}rYm(b){return this.lPc(b,Object(v.a)(this,this.gAi,"optionHandler"))}gAi(b){const h=this.WTc[b.vp.toString()];h.value?(h.value=0,h.RYa.className=
Tg.getImageClass(Yg.SJe),h.bYd.setAttribute(qf.a.Hya,qf.a.eL)):(h.value=1,h.RYa.className=Tg.getImageClass(Yg.Die),h.bYd.setAttribute(qf.a.Hya,qf.a.Ho));this.sbe(b.vp.toString(),h.value.toString())}l5n(){this.TU.select()}static zOh(b,h,n){if(!Yg.Aye){const x=String.format('<a target="_blank" href="{0}">{1}</a>',B.a.BKc("https://office.com"),CommonUIStrings.l_Office),E=String.format('<a target="_blank" href="{0}">{1}</a>',B.a.BKc("https://office.com/webapps"),CommonUIStrings.l_WebAppName);Yg.Aye=String.format(CommonUIStrings.l_NoFrames,
x,E)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',B.a.BKc(b),h,n,Yg.Aye)}}Yg.Aye=null;Yg.Die="CheckboxChecked_16x16x32";Yg.SJe="CheckboxUnchecked_16x16x32";Yg.pXj="OutlookSearchChevronUp_16x16x32";Yg.EAg="OutlookSearchChevronDown_16x16x32";Yg.gwg="CommentChecked";Yg.zuj="UpArrowServer";Yg.OOb="EmbedDescription";Yg.dSj="EmbedSectionHeader";Yg.eSj="EmbedSectionName UIFontBold";Yg.qCj="EmbedCodeFooter";Yg.fwg="EmbedOptionImage";Yg.vPj="EmbedPreviewFrame";
Yg.BAj="EmbedCodeTextArea";Yg.ySg="EmbedOption";Yg.Izj="EmbedDimensionSection";Yg.Auj="EmbedArrowIcon";Yg.yuj="WACGlyph EmbedArrowHolder";Yg.awg="EmbedCheckBoxHolder";Yg.zSg="Option";Yg.ASg="OptionImage";Yg.nBg="EmbedCode";Yg.mBg="EmbedCodeHeader";Yg.SUg="Preview";Yg.RUg="PreviewHeader";Yg.BSg="Options";Yg.Etg="Arrow";Yg.Ojc="Check";Yg.lBg="EmbedCodeFooter";Object(r.a)(Yg,"EmbedDialog",Kc.a,[]);class iv extends eu{constructor(b,h,n,x,E){super(b,h,n,x);this.aZa=E}}Object(r.a)(iv,"OptionInputInfo",
eu,[]);class kt extends Yg{constructor(b,h){super(b,kt.xK);this.T8=null;this.Dlc=[];this.Bld=Object(v.a)(this,this.I_n,"startOnOptionClickHandler");this.AUb=Object(v.a)(this,this.J_n,"startOnOptionKeyHandler");this.Sgd=Object(v.a)(this,this.eTm,"onPageNumberChanged");this.Tle=Object(v.a)(this,this.APm,"onDimensionChanged");this.eG=h}cec(){if(kt.xK){var b=kt.Qdn,h=[];h.push({["id"]:"wdPrint",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.eG.REi,["urlTransformFunctionOnChange"]:b},{["id"]:"wdEmbedCode",
["checkboxInitialValue"]:!0,["checkboxLabel"]:this.eG.KJi,["urlTransformFunctionOnChange"]:b},{["id"]:"wdStartOn",["checkboxInitialValue"]:!1,["checkboxLabel"]:this.eG.f6i,["urlTransformFunctionOnChange"]:b,["textInputProps"]:{["title"]:this.eG.g6i}});this.C3i({["dimensionsOptions"]:{["isMultipleChoice"]:!1,["defaultWidth"]:this.B9c,["defaultHeight"]:this.tPb,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:this.eG.Njj,["heightLabel"]:this.eG.k3h},["interactionOptions"]:h})}else super.cec(),this.o6g(this.eG.Njj,
"EmbedWidthInput",this.B9c),this.o6g(this.eG.k3h,"EmbedHeightInput",this.tPb),this.yrb.appendChild(this.zrh("wdPrint",this.eG.REi)),this.yrb.appendChild(this.zrh("wdEmbedCode",this.eG.KJi)),this.S_j(this.eG.f6i),this.AVa(),de.FocusManager.YI()&&(b=de.FocusManager.instance(),h=[document.getElementById(Yg.nBg),document.getElementById("EmbedWidthInput"),document.getElementById("EmbedHeightInput"),document.getElementById(Yg.Etg+Yg.BSg),document.getElementById("wdPrint"+Yg.Ojc),document.getElementById("wdEmbedCode"+
Yg.Ojc),document.getElementById("wdStartOn"+Yg.Ojc),document.getElementById("wdStartOnText"),document.getElementById(Wf.a.s5c),document.getElementById(Yg.RUg)],h=new jf(h),b.Cs().Uj=h,V.a.ki?this.mU(document.getElementById(Wf.a.s5c)):this.TU.select())}dispose(){if(!kt.xK){if(this.Dlc){for(let b=0;b<this.Dlc.length;++b)af.a.removeHandler(this.Dlc[b],"change",this.Tle);this.Dlc=this.Tle=null}this.Sgd&&(af.a.removeHandler(this.T8.aZa,"change",this.Sgd),this.Sgd=null);this.Bld&&(this.lq.sc(kb.a.click,
this.T8.D$b,this.Bld),this.Bld=null);this.AUb&&(this.re.sc(kb.a.Di,this.T8.D$b,this.AUb),this.re.sc(kb.a.Bh,this.T8.D$b,this.AUb),this.AUb=null);this.T8=null}super.dispose()}o6g(b,h,n){const x=document.createElement("label");x.className="EmbedInputPrefix";x.innerText=b;this.nob.appendChild(x);b=document.createElement("input");b.className=h;b.id=h;b.value=n.toString();b.type="text";b.setAttribute("data-lpignore","true");x.setAttribute("for",h);this.nob.appendChild(b);this.Dlc.push(b);af.a.addHandler(b,
"change",this.Tle);this.nob.appendChild(document.createElement("br"))}APm(b){"EmbedWidthInput"===b.target.id?this.B9c=this.Uzd(b.target,375):this.tPb=this.Uzd(b.target,250);this.M6f()}Uzd(b,h){let n=parseInt(b.value);if(isNaN(n)||n<h)n=h;b.value=n.toString();return n}eTm(b){b=this.Uzd(b.target,1);1===this.T8.value&&this.sbe("wdStartOn",b.toString())}S_j(b){const h=document.createElement("div");h.className=Yg.ySg+" EmbedInlineOption";h.id="wdStartOn"+Yg.zSg;const n=this.Ik.createElement("div");n.tabIndex=
0;n.className=Yg.awg;n.id="wdStartOn"+Yg.Ojc;n.setAttribute(qf.a.Ah,qf.a.xQe);n.setAttribute(qf.a.Hya,qf.a.eL);n.setAttribute(qf.a.dda,"wdStartOn"+Yg.OOb);h.appendChild(n);h.setAttribute(qf.a.Ah,qf.a.xz);var x=Tg.createClusteredImage(16,16,Yg.gwg,Yg.fwg,!0,"");n.appendChild(x);x=x.childNodes[0];x.id="wdStartOn"+Yg.ASg;x.className=Tg.getImageClass(Yg.SJe);const E=document.createElement("span");E.className=Yg.OOb;E.innerText=b;E.id="wdStartOn"+Yg.OOb;h.appendChild(E);this.yrb.appendChild(h);b=document.createElement("input");
b.className="EmbedPageNumberInput";b.id="wdStartOnText";b.type="text";b.title=this.eG.g6i;b.setAttribute("data-lpignore","true");this.yrb.appendChild(b);af.a.addHandler(b,"change",this.Sgd);this.T8=new iv(h,x,n,0,b);this.sbe("wdStartOn","1");this.lq.mb(kb.a.click,h,this.Bld);this.re.mb(kb.a.Di,h,this.AUb);this.re.mb(kb.a.Bh,h,this.AUb)}I_n(b){this.d6i(b);return!0}J_n(b){return this.lPc(b,Object(v.a)(this,this.d6i,"startOnOptionHandler"))}d6i(){let b=1;this.T8.value?(this.T8.value=0,this.T8.RYa.className=
Tg.getImageClass(Yg.SJe),this.T8.bYd.setAttribute(qf.a.Hya,qf.a.eL)):(this.T8.value=1,this.T8.RYa.className=Tg.getImageClass(Yg.Die),b=this.Uzd(this.T8.aZa,1),this.T8.bYd.setAttribute(qf.a.Hya,qf.a.Ho));this.sbe("wdStartOn",b.toString())}static get xK(){return u.AFrameworkApplication.ua.Sb.zA}static Qdn(b,h,n,x=null){if("wdPrint"===h||"wdEmbedCode"===h)return Ec.a.Bp(b,h,n?"1":"0");if("wdStartOn"===h){let E="1";n&&x&&(x=parseInt(x),!isNaN(x)&&1<=x&&(E=x.toString()));return Ec.a.Bp(b,h,n?E:"1")}return b}}
Object(r.a)(kt,"WordEmbedDialog",Yg,[]);class Mu{constructor(b,h,n,x,E){this.cca=null;this.ga=b;this.Q6a=h;this.zO=n;this.eG=x;this.zoa=E}Vb(){this.ga.pa(this.zO,Ld.a.frame,Object(v.a)(this,this.IUn,"showEmbedCode"));this.Q6a.execute(Object(v.a)(this,this.oFf,"onHostPostmessengerCreated"))}oFf(b){w.ULS.shipAssertTag(4994850,332,!!b);this.cca=b;u.AFrameworkApplication.$La||(this.cca.vv(F.a.kih),this.cca.VB(F.a.kih,Object(v.a)(this,this.cec,"showEmbedDialog")))}cec(b){b=b.Values.HostEmbeddedViewUrl.toString();
u.AFrameworkApplication.uKc=b;this.zoa.O4e=b;(new kt(b,this.eG)).cec()}IUn(b,h,n){if(2===n)if(u.AFrameworkApplication.uKc)(new kt(this.zoa.O4e,this.eG)).cec();else return u.AFrameworkApplication.km.UYa(Mu.Tmj),u.AFrameworkApplication.$7f&&this.cca.sendMessage(F.a.O5k,null)?32:u.AFrameworkApplication.ua.K2(!0,u.AFrameworkApplication.p7e);return 32}}Mu.Tmj=10381;Object(r.a)(Mu,"EmbedActor",null,[]);class xa{}Object(r.a)(xa,"WordEmbedDialogStrings",null,[]);var Ma=d(267);class Ba extends Mu{constructor(b,
h){super(b,h,ub.a.UZf,Object.assign(new xa,{Njj:WordEditorIntl.WordEditorStrings.l_Width,k3h:WordEditorIntl.WordEditorStrings.l_Height,REi:WordEditorIntl.WordEditorStrings.l_PrintOption,KJi:WordEditorIntl.WordEditorStrings.l_ReembedOption,f6i:WordEditorIntl.WordEditorStrings.l_StartOnOption,g6i:WordEditorIntl.WordEditorStrings.l_StartPage}),Ma.WoncaApp.instance)}}Object(r.a)(Ba,"EmbedActor",Mu,[]);class va{constructor(){this.W=null}get name(){return"WordEditor.Embed"}zc(b){this.W=b;b.ha("WordEditor.Embed.EmbedActor",
()=>new Ba(u.AFrameworkApplication.ya,b.Za("Postmessage.IHostPostmessenger"))).singleInstance()}init(){this.W.resolve("WordEditor.Embed.EmbedActor").Vb()}dispose(){}}Object(r.a)(va,"EmbedPackage",null,[1,2]);class Ta{constructor(b,h,n){this.ov=this.qGa=this.rIa=null;this.dGa=0;this.ZQb=this.RQb=this.IQb=this.hRb=this.QRa=this.PRa=!1;this.hj=b;this.Hm=n}WN(b){return ob.App.xa.jb.isEditingAllowed?""!==this.BHc(b.Af):!1}kK(b){if(!this.WN(b))return!1;this.rGn(b);this.sGn();this.tGn();this.rIa=b.YG;this.ov=
new Sys.UI.Point(0,0);w.ULS.sendTraceTag(22381023,322,50,"Image Crop drag started");return!0}RT(b){this.qGa=b.YG;this.vnk();this.hj.Cfj(this.ov.x,this.ov.y,this.hRb,this.IQb,this.RQb,this.ZQb,!1);return!0}eD(){this.hj.Cfj(this.ov.x,this.ov.y,this.hRb,this.IQb,this.RQb,this.ZQb,!0);w.ULS.sendTraceTag(22381024,322,50,"Image Crop drag succeeded")}lX(){this.hj.kqk();w.ULS.sendTraceTag(22381025,322,50,"Image Crop drag canceled")}sGn(){this.ZQb=this.RQb=this.IQb=this.hRb=!1;switch(this.dGa){case 1:this.hRb=
!0;break;case 5:this.IQb=!0;break;case 3:this.ZQb=!0;break;case 7:this.RQb=!0;break;case 0:this.RQb=this.hRb=!0;break;case 2:this.ZQb=this.hRb=!0;break;case 6:this.RQb=this.IQb=!0;break;case 4:this.ZQb=this.IQb=!0}}tGn(){this.QRa=this.PRa=!1;switch(this.dGa){case 0:this.QRa=this.PRa=!0;break;case 1:case 2:this.QRa=!0;break;case 7:case 6:this.PRa=!0}}BHc(b){var h=b.className;-1===h.indexOf("WACImageCropHandle")&&b.parentNode&&(h=b.parentNode.className);b=h.split(" ");for(h=0;h<b.length;h++){const n=
b[h].toString();if(n.startsWith("WACImageCropHandle")&&"WACImageCropHandles"!==n)return n}return""}rGn(b){switch(this.BHc(b.Af)){case "WACImageCropHandleNW":this.dGa=0;break;case "WACImageCropHandleN":this.dGa=1;break;case "WACImageCropHandleNE":this.dGa=2;break;case "WACImageCropHandleE":this.dGa=3;break;case "WACImageCropHandleSE":this.dGa=4;break;case "WACImageCropHandleS":this.dGa=5;break;case "WACImageCropHandleSW":this.dGa=6;break;case "WACImageCropHandleW":this.dGa=7}}vnk(){var b=1;this.Hm.instance&&
(b=this.Hm.instance.vj);const h=(this.qGa.x-this.rIa.x)/b;b=(this.qGa.y-this.rIa.y)/b;this.ov.x=this.PRa?-h:h;this.ov.y=this.QRa?-b:b}}Object(r.a)(Ta,"ImageCropDragAdapter",null,[136]);class Ab{constructor(b,h){this.ga=b;this.Hm=h}Zsl(b){return new Ta(b,this.ga,this.Hm)}}Object(r.a)(Ab,"ImageCropDragAdapterFactory",null,[273]);var Mb=d(241),Ub=d(205),uc=d(461),vc=d(685),Gc=d(96),Mc=d(65),Yc=d(437),jd=d(940),pe=d(560),be=d(876),Nd=d(133),je=d(381),Ee=d(278),De=d(845),Te=d(211),gf=d(92),$d=d(23),Yf=
d(297),Nh=d(392),Lf=d(131);class og{constructor(b,h,n,x,E,S,ma,Fa,$a=null){this.Pb=$a;this.PLc=null;this.uJ=b;this.Kh=h;this.Hc=n;this.pu=x;this.Vd=E;this.hb=S;this.Cm=ma;this.hA=Fa}get VV(){return null!=this.ufg?this.ufg:this.ufg=Oa.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get pc(){return null!=this.Drg?this.Drg:this.Drg=Oa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Ue(){return Nd.PageReader.instance}FIn(b,h,n){const x=this.Hc.Rc(15);x.Db(h.node);this.$Oa(b,n);x.dispose()}EIn(b,
h,n){const x=this.Hc.Rc(15);x.Db(h.node);this.YIb(b,n);x.dispose()}$Oa(b,h){b.setValue(ie.a.imageAltText,h)}YIb(b,h){b.setValue(ic.a.GW,h)}MIn(b,h){b.setValue(ie.a.reb,h)}LXi(b,h){b.setValue(ic.a.HW,h)}IIn(b,h,n,x,E){let S=0;var ma=0;({width:S,height:ma}=Pd.ImageReader.Nzb(b));ma-=(h+n)/1E5*ma;this.RDa(b,S-(x+E)/1E5*S);this.QDa(b,ma);this.dYi(b);b.setValue(ic.a.VKc,h);b.setValue(ic.a.SKc,n);b.setValue(ic.a.TKc,x);b.setValue(ic.a.UKc,E)}tZi(b,h,n,x){const E=this.Hc.Rc(15);E.Db(h.node);this.g5d(b,n,
x);E.dispose()}g5d(b,h,n){this.RDa(b,h);this.QDa(b,n);this.dYi(b);b.removeProperty(ad.a.xZd);b.removeProperty(ad.a.wZd)}RDa(b,h){b.setValue(ie.a.cfa,h);b.setValue(ad.a.jBa,-1)}QDa(b,h){b.setValue(ie.a.fma,h);b.setValue(ad.a.iBa,-1)}lD(b,h){b.setValue(ic.a.pKc,h);b.setValue(ie.a.ai,h);b.setValue(ie.a.Aq,h)}lNn(b,h){b.setValue(ic.a.MKb,h)}rFn(b,h){b.setValue(ic.a.FRe,h)}oNn(b){if(!Pd.ImageReader.I$(b)&&b.ul){var h=b.node;if(Pd.ImageReader.m6(h)){const E=this.Hc.Rc(15);E.Db(b.node);b=md.GraphIterator.$a(h);
b.Bb(12);b=b.parentNode;var n=b.properties.Og(ic.a.Fq),x=h.properties.getValue(ic.a.runId);h.ia(ic.a.Mc,Ll.a.$Q);const S=b.qa;h.Qg.apply(h,[ic.a.pKc,ie.a.ai,ie.a.Aq,ic.a.FRe,ic.a.MKb,ic.a.m$a]);n=this.ubf(x,n,S);x=Dd.a.Uc(b,n);this.pu.nYe(h,x);(h=this.hA.wN(b,n,n+1))&&this.hb.setSelection(h);this.VV.zna(b,n,n+1);E.dispose()}}}RVf(b,h){if(b.properties.hasProperty(ic.a.l5)){const n=b.properties.Og(ic.a.l5);n.push(h);b.properties.setValue(ic.a.l5,Array.clone(n))}else b.properties.setValue(ic.a.l5,[h])}n6d(b,
h,n=0,x=!1){if(b.ul){var E=this.Hc.Rc(15),S=b.node;E.Db(S);if(Pd.ImageReader.I$(b)){const sb=this.Pb&&this.Pb.isFeatureEnabled(49)?new be.a:new pe.a;sb.ys(Pd.ImageReader.Xl(b));var ma=S.qa,Fa=this.x7k(b.cpBegin,ma);this.Zck(b.cpEnd,ma,Fa)&&w.ULS.sendTraceTag(594392136,322,50,"[ImageEditor][SetToAnchor]Comment will be lost");ma=ma.J(Fa).blob;Fa=ma.Fe;var $a=S.properties.Og(ic.a.Fq);$a=this.pdn($a);Fa=$a[Fa];$a=S.ia(ic.a.Mc,Ll.a.$Q);if(ma=Object(ja.a)(jd.ImageBlobObject,ma))ma.yJb=!1;this.Vd.replaceTextRange(b,
"");ma&&(ma.yJb=!0);sb.properties.setValue(ic.a.runId,Fa);sb.properties.setValue(ic.a.Mc,$a);b=md.GraphIterator.$a(S);b.Bb(12);b.Sf(sb,6);this.RVf(b.currentNode,sb.anchor.node.id);S=sb}n&&this.lD(S.properties,n);this.rFn(S.properties,x);this.lNn(S.properties,h);this.VV.fdc(S);(h=this.hA.ir(S))&&this.hb.setSelection(h);E.dispose()}}zUf(b,h){if(!(0>=h)){var n=mf.a.jn(h,0),x=Pd.ImageReader.nA(b),E=Pd.ImageReader.zB(b);x>n&&(E*=n/x,this.RDa(b,n),this.QDa(b,E),w.ULS.sendTraceTag(37843205,322,50,"Scale image width and height to fit constraining width {0} : ",
h))}}Zck(b,h,n){const x=h.length;if(n>=x||!h.J(n).Ff)return!1;const E=new Lm.a;for(;n<x;n++){const S=h.J(n);if(S.cp>b||!S.Ff)break;for(let ma=0;ma<S.Ff.length;ma++){if(E.contains(S.Ff.J(ma).Oj))return!0;E.add(S.Ff.J(ma).Oj)}}return!1}pdn(b){for(var h=0;h<b.length&&!b[h];)h++;if(h===b.length)for(var n=0;n<b.length;)b[n]=n+1,n++;else{var x=b[h];n=h-1;for(var E=x-1;0<=n;)b[n]=E,n--,E--;E=0;for(n=h+1;n<b.length;)(h=b[n])?h<x?(x=h+E,b[n]=x):x=h:(E+=2,x++,b[n]=x),n++}return b}$7e(b,h){let n=0;for(;n<h.length&&
!(b<h[n]);)n++;return n}ubf(b,h,n){let x=0;const E=this.$7e(b,h);let S=0;if(E===h.length)S=n.length-1;else for(;S<n.length;){h=n.J(S);if(h.formatting&&h.formatting.Fe===E)break;S++}S<n.length?x=n.J(S).cp:w.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",{["Index"]:S,["RunId"]:b,["CharacterPropertiesArrayLength"]:n.length});return x}x7k(b,h){let n=0;for(;n<h.length&&h.J(n).cp!==b;)n++;n===h.length&&w.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",
{["Index"]:n,["CharacterPropertiesArrayLength"]:h.length});return n}dYi(b){b.setValue(ie.a.Wea,!0)}$Zd(b,h,n,x=!1){h&&n?(h=Math.max(h,vc.a.Lpi),n=Math.max(n,vc.a.Lpi)):n=h=vc.a.Uvh;b.setValue(ie.a.cfa,mf.a.jn(h,0));b.setValue(ie.a.fma,mf.a.jn(n,1));b.setValue(ie.a.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading);b.setValue(Th.a.wZ,1);b.setValue(ic.a.Vea,x)}FLd(){return null}hzh(b,h,n){let x=null;h=({jFb:x}=this.izh(b,h,n)).returnValue;x&&b.view.Cb.setSelection(x);return h}izh(b,h,n){var x=
null;if(!this.mda(b))return{returnValue:null,jFb:x};var E=b.view;const S=this.Hc.Rc(15,Db.a.OBb);S.Db(E.ud);h||(h=new qi.DictionaryPropertySet);h.setValue(ad.a.aYk,!0);let ma=E.Cb.Rg;var Fa=new De.a;if(!Kd.SelectionEditor.xf(ma)){if(2===u.AFrameworkApplication.ya.processAction(Db.a.hka,2))return S.dispose(),{returnValue:null,jFb:x};ma=E.Cb.Rg}else if(ma.ul&&Cd.ParagraphReader.oc(ma.node)){Of.a.instance.J(4)&&ob.App.rd.Kp&&ob.App.rd.Jq.sG(ma.node);E=Mh.FormattingReader.Ds(ma);if(!E)return S.dispose(),
{returnValue:null,jFb:x};E.cache.xA&&(E=E.Yf(null),og.ui.vX(E));Fa.formatting=E.Aj;Fa.languageId=Mh.FormattingReader.language(E);Of.a.instance.J(10)&&(Fa.Xva=this.pc.yo(ma.node))}if(!ma.ul)return S.dispose(),{returnValue:null,jFb:x};if(!this.Nmf(b.tk,h))return S.dispose(),this.PLc=null,{returnValue:null,jFb:x};b=this.PLc;this.PLc=null;1===b.location?(x=b.node,h=Nh.a.instance.xhf(x),wf.OutlineElementNavigator.Rr(h,!1,!1)||(Te.OutlineNavigator.x3d(h),this.uJ.m5(h,!0,Fa)),wf.OutlineElementNavigator.He(h),
ag.TableReader.isTable(h)&&(Object(pb.a)(Lf.a,h)||Object(pb.a)(je.a,h)?(Fa=new md.GraphIterator,Fa.set(h.currentNode),$d.moveToCellContent(Fa,0,0),h.set(Fa.currentNode)):$d.moveToCellContent(h,0,0),Kf.OutlineElementReader.Nh(h)?wf.OutlineElementNavigator.He(h):h=Nh.a.instance.xhf(x)),x=Cd.ParagraphReader.uu(h.currentNode)?this.hA.xe(h.currentNode,0):this.hA.ir(h.currentNode)):b.location||(Fa=b.blob.Ob.cp+1,x=this.hA.wN(b.node,Fa-1,Fa));S.tCa(n,1);S.zl=Db.a.OBb;S.dispose();return{returnValue:b,jFb:x}}Nmf(){return!1}mda(b){b.contextId===
cc.a.view&&b.view.Be&&b.view.Cb&&(b=b.view.Cb.Rg);if(!b)return og.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.noSelection}),!1;if(og.Zf.bZ(b))return og.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.UD}),!1;if(og.Zf.ota(b))return og.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.q7h}),!1;if(this.Cm&&this.Cm.instance&&this.Cm.instance.vT(b))return og.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.externalSelection}),!1;if(this.Ue.k2)return og.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.compatMode}),!1;if(b.ul)return gf.OutlineReader.rOd(b)?(og.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.NXe}),
!1):Pd.ImageReader.vNd(b)?(og.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.FXe}),!1):Yf.c(b)?(og.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.GXe}),!1):Ee.a.opf(b)?(og.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.EXe}),!1):Cd.ParagraphReader.KW(b)||Pd.ImageReader.u7l(b)?(og.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.pN}),!1):!0;if(Yc.a.idi(b)){let h=!0;for(let n=0;n<b.length;++n){const x=b.getContext(n);if(!x.ul)return!1;h&&!Cd.ParagraphReader.KW(x)&&(h=!1)}return h?(og.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.pN}),!1):!0}return!1}wMi(b,h){const n=this.Hc.Rc(7);
n.Db(b);if(12===b.type){h=h.Ob.cp;var x=Cd.ParagraphReader.textLength(b);x=Dd.a.jL(h,h+1,h+1===x?!0:!1,b);this.Vd.replaceTextRange(x,"");b=Dd.a.Uc(b,h);this.hb.setSelection(Ae.SelectionFactory.Kn(b))}else this.Kh.t1a(b);n.dispose()}static get ui(){return null!=og.Wig?og.Wig:og.Wig=Oa.a.instance.resolve("Box4.IFormattingEditor")}static get Zf(){return Ai.a.instance}static get Lc(){return vb.a.instance}}Object(r.a)(og,"ImageEditor",null,[272]);class Dj{constructor(b,h,n,x=0){this.node=b;this.blob=h;
this.location=n;this.pT=x}}Object(r.a)(Dj,"InsertPictureResult",null,[]);var Bg=d(799),xj=d(298),em=d(1154);class Ej extends og{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic){super(b,h,n,x,E,S,ma,Fa,Ic);this.Hyj="WACImageCropHandleNW WACImageCropHandleN WACImageCropHandleNE WACImageCropHandleW WACImageCropHandleE WACImageCropHandleSW WACImageCropHandleS WACImageCropHandleSE".split(" ");this.E5a="WACImageCropInnerHandleTop WACImageCropInnerHandleTopBorder WACImageCropInnerHandleBottom WACImageCropInnerHandleBottomBorder WACImageCropInnerHandleLeft WACImageCropInnerHandleLeftBorder WACImageCropInnerHandleRight WACImageCropInnerHandleRightBorder".split(" ");
this.fJ=this.UGa=this.Mwa=null;this.Dha=Array(8);this.wbd=this.dxa=null;this.VGa=!1;this.vbd=this.lre=null;this.d8c=this.j9c=!1;this.IR=this.HR=this.GR=this.JR=this.QU=this.PU=this.OU=this.RU=this.fV=this.gV=0;this.VZ=()=>{this.VGa&&this.g5e()};this.iua=gd=>{this.VGa&&gd.Ib.keyCode!==db.a.Ks&&this.g5e(!0);return!1};this.VGg=oc;S.OD(this.VZ);this.re=Sb;this.r0=Mb.a.instance;this.ga=u.AFrameworkApplication.ya;this.Hd=sb;this.Tm=$a;this.wc=Ic}u5d(b,h,n,x,E){b.hasProperty(ad.a.QMa)&&b.removeProperty(ad.a.QMa);
const S=Array(4);S[0]=h;S[1]=n;S[2]=x;S[3]=E;b.setValue(ic.a.X2,S)}jnn(b){b.setValue(ic.a.kBa,0);b.setValue(ic.a.tGb,"");this.u5d(b,0,0,0,0)}NWf(b,h,n,x,E){b.setValue(ic.a.VKc,h);b.setValue(ic.a.SKc,n);b.setValue(ic.a.TKc,x);b.setValue(ic.a.UKc,E)}w5d(b,h,n,x){b.setValue(ic.a.YJ,h);b.setValue(ic.a.VJc,n);b.setValue(ic.a.dKc,x);b.setValue(ad.a.YJ,-1)}ELd(b,h){b=b.node;const n=md.GraphIterator.$a(b);if(Cd.ParagraphReader.oc(b)&&Cd.ParagraphReader.isEmpty(n)){var x=b.properties.Og(ic.a.Mc);h.setValue(ic.a.Mc,
x);h.setValue(ic.a.runId,1);x=new em.a;h&&x.ys(h);n.Sf(x,6);this.RVf(b,x.anchor.node.id);this.VV.fdc(x);return new Dj(x,null,3)}return null}FLd(b,h){var n=Bg.a.instance.L4c;h&&n.ys(h);n.setValue(ic.a.imageType,1);let x=0;Of.a.instance.J(5)&&(x=Ub.a.JF(),n.setValue(ic.a.pT,x));const E=b.node.Nc.Gu(n,n.id);n=this.Vd.Iea(b,S=>new jd.ImageBlobObject(S,E));xj.GraphTransactionManager.instance.XEf(b.node);if(this.Hd.wg){const S=new Se.GraphTransaction(15);S.Db(b.node);this.Tm.Hna(b.node,b.cpBegin,b.cpBegin+
1,1,null);S.dispose()}this.VV.jJa&&!h.ia(ic.a.Vea,!1)&&this.VV.zna(b.node,b.cpBegin,b.cpBegin+1);return new Dj(b.node,n,0,x)}Nmf(b,h){if(!this.mda(b))return!1;const n=this.Hc.Rc(7);n.Db(b.node);u.AFrameworkApplication.K.$("ContentAppIsEnabled")&&h.ia(ic.a.r9h,!1)?this.PLc=this.ELd(b,h):this.PLc=this.FLd(b,h);n.dispose();return!0}Bbc(b,h,n,x){if(!n.oc(b))return!1;n=this.Hc.Rc(7,Db.a.kPl);n.Db(b);var E=b.properties.ia(ie.a.zm,[]);E.push(0);for(let S of E)if((E=x.gaf(b,S))&&5===E.ri&&E.id.equals(h))return this.Vd.replaceTextRange(Dd.a.createTextRange(b,
S,S+1),""),n.dispose(),!0;n.dispose();w.ULS.sendTraceTag(588817112,3001,10,"RemoveInlineImageFromParagraph: Failed to remove image.");return!1}zmn(b,h,n,x){if(!Pd.ImageReader.m6(b))return!1;h.set(b);h.Bb(12);const E=h.rp(12);if(!E)return w.ULS.sendTraceTag(588817114,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image because unable to acquire containing graph node."),!1;if(n.PNc(E))return w.ULS.sendTraceTag(588817115,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image."),
!1;x(b);n=this.Hc.Rc(7);n.Db(b);h.Fg();n.dispose();return!0}isn(b,h,n,x){return Pd.ImageReader.pZa(b)?this.Vrn(b,n):Pd.ImageReader.I$(b)?this.ksn(b,h,n,x):null}ksn(b,h,n,x){const E=Bg.a.instance.L4c;n&&E.ys(n);n=0;Of.a.instance.J(5)&&(n=Ub.a.JF(),E.setValue(ic.a.pT,n));n=b.node.Nc;b=b.node;x=x.CGc(b,5);for(let S of x)if(S.id.equals(h)){this.Vd.replaceTextRange(Dd.a.createTextRange(b,S.Ob.cp,S.Ob.cp+1),"");const ma=n.Gu(E,E.id);h=Dd.a.Uc(b,S.Ob.cp);this.Vd.Iea(h,Fa=>new jd.ImageBlobObject(Fa,ma));
return E}return null}Vrn(b,h){if(!Pd.ImageReader.pZa(b))return null;Of.a.instance.J(5)&&h.setValue(ic.a.pT,Ub.a.JF());b=b.node;var n=b.anchor.node.id;b=md.GraphIterator.$a(b);b.Bb(12);const x=b.parentNode;let E;x.properties.hasProperty(ic.a.l5)?(E=x.properties.Og(ic.a.l5),n=C.a.indexOf(E,n),-1!==n&&Array.removeAt(E,n)):E=[];x.properties.setValue(ic.a.l5,Array.clone(E));b.Fg();n=this.wc&&this.wc.isFeatureEnabled(49)?new be.a:new pe.a;n.ys(h);b.Sf(n,6);this.RVf(x,n.anchor.node.id);return n}A1c(b,h){this.VGa?
this.g5e():this.l_n(b,h)}OIn(b,h){b.setValue(ad.a.YJ,h)}dtl(b){let h=null,n=null;if(!b)return w.ULS.sendTraceTag(22381026,322,15,"Unable to obtain Image Element Container for Crop due to null Context."),{returnValue:null,view:h,Qi:n};if(!cb.InteractiveViewManager.instance.xd)return w.ULS.sendTraceTag(22381027,322,15,"Unable to obtain Image Element Container for Crop due to null SelectionView."),{returnValue:null,view:h,Qi:n};const x=b.node;if(!x)return w.ULS.sendTraceTag(22381056,322,15,"Unable to obtain Image Element Container for Crop due to null Context Node."),
{returnValue:null,view:h,Qi:n};n=x.Nc;const E=x.De(cb.InteractiveViewManager.instance.xd.Tb);if(!E)return w.ULS.sendTraceTag(23961792,322,15,"Unable to obtain Image Element Container for Crop due to null Html View Element."),{returnValue:null,view:h,Qi:n};h=E.Ig;if(b.ul&&Pd.ImageReader.I$(b)){b=Pd.ImageReader.DAa(b);if(!b)return w.ULS.sendTraceTag(22381057,322,15,"Unable to obtain Image Element Container for Crop due to null Blob from Context."),{returnValue:null,view:h,Qi:n};b=b.dYa(h);if(!b)return w.ULS.sendTraceTag(22381058,
322,15,"Unable to obtain Image Element Container for Crop due to null Presenter from Blob."),{returnValue:null,view:h,Qi:n};b=b.element}else if(Pd.ImageReader.qw(x))b=E.htmlElement;else return w.ULS.sendTraceTag(22381059,322,15,"Unable to obtain Image Element Container for Crop due to context not being Image blob nor Image node."),{returnValue:null,view:h,Qi:n};return{returnValue:b,view:h,Qi:n}}IOn(b){for(let x=0;x<this.Dha.length;x++){this.Dha[x]=b.wk(Pk.a.span);this.Dha[x].className="WACImageCropHandles "+
this.Hyj[x];if(2>=x){var h=b.wk(Pk.a.span);h.className=this.E5a[0];var n=b.wk(Pk.a.span);n.className=this.E5a[1];this.Dha[x].appendChild(h);this.Dha[x].appendChild(n)}else 4<x&&(h=b.wk(Pk.a.span),h.className=this.E5a[2],n=b.wk(Pk.a.span),n.className=this.E5a[3],this.Dha[x].appendChild(h),this.Dha[x].appendChild(n));if(!x||3===x||5===x)h=b.wk(Pk.a.span),h.className=this.E5a[4],n=b.wk(Pk.a.span),n.className=this.E5a[5],this.Dha[x].appendChild(h),this.Dha[x].appendChild(n);else if(2===x||4===x||7===
x)h=b.wk(Pk.a.span),h.className=this.E5a[6],n=b.wk(Pk.a.span),n.className=this.E5a[7],this.Dha[x].appendChild(h),this.Dha[x].appendChild(n)}}l_n(b,h){w.ULS.sendTraceTag(22381060,322,50,"Starting Image Cropping Mode.");if(this.VGa)w.ULS.sendTraceTag(22381061,322,100,"Attempted to start Crop Mode when it was already On.");else{var n=null,x=null;if((this.dxa=({view:n,Qi:x}=this.dtl(h)).returnValue)&&n){this.dxa.classList.add("ImageCropMode");this.Mwa=n.wk(Pk.a.div);this.Mwa.className="WACImageCropMode";
this.UGa=n.wk(Pk.a.SYa);this.UGa.className="WACImageCropBase";this.fJ=n.wk(Pk.a.span);this.fJ.className="WACImageCropSrcRect";this.IOn(n);this.Mwa.appendChild(this.fJ);for(n=0;n<this.Dha.length;n++)this.fJ.appendChild(this.Dha[n]);this.Mwa.appendChild(this.UGa);this.UGa.style.visibility="";this.UGa.style.display="";this.dxa.appendChild(this.Mwa);this.s4m(b);x=Pd.ImageReader.LAa(b,x);n=Pd.ImageReader.F3(b,ad.a.Ima,null);this.UGa.src=n?n:Pd.ImageReader.Pzb(x);this.VGg&&this.VGg.execute(E=>{this.wbd||
(this.wbd=E.Zsl(this))});this.j9c||(this.r0.gO(this.dxa,this.wbd),this.j9c=!0);this.re&&this.re.mb(kb.a.KH,cb.InteractiveViewManager.instance.editingView.editingElement,this.iua);this.VGa=!0;this.lre=b;this.vbd=h;this.d8c=!1;b=new Se.GraphTransaction(4);b.Db(this.vbd.node);this.lre.setValue(ad.a.mta,this.VGa);b.dispose()}else w.ULS.sendTraceTag(22381062,322,15,"Unable to start Crop Mode because unable to obtain Image Element Container from given Context.")}}s4m(b){const h=mf.a.yf(Pd.ImageReader.nA(b),
0),n=mf.a.yf(Pd.ImageReader.zB(b),1),x=Math.max(Pd.ImageReader.Xka(b),0),E=Math.max(Pd.ImageReader.Uka(b),0),S=Math.max(Pd.ImageReader.Vka(b),0),ma=Math.max(Pd.ImageReader.Wka(b),0);this.gV=1E5*h/(1E5-(S+ma));this.fV=1E5*n/(1E5-(x+E));this.RU=Math.floor(x*this.fV/1E5);this.OU=Math.floor(E*this.fV/1E5);this.PU=Math.floor(S*this.gV/1E5);this.QU=Math.floor(ma*this.gV/1E5);this.fJ.style.top=this.RU+"px";this.fJ.style.bottom=this.OU+"px";this.fJ.style.left=this.PU+"px";this.fJ.style.right=this.QU+"px";
this.UGa.style.width=this.gV+"px";this.UGa.style.height=this.fV+"px";Pd.ImageReader.Sx(b)&&(this.Mwa.style.width=this.gV+"px",this.Mwa.style.height=this.fV+"px");this.JR=this.RU;this.GR=this.OU;this.HR=this.PU;this.IR=this.QU}g5e(b=!1){w.ULS.sendTraceTag(22381063,322,50,"Ending Image Cropping Mode.");this.VGa?(b||this.uzk(),this.UGa?Ke.a.jA(this.UGa):w.ULS.sendTraceTag(23961793,322,15,"Unable to clear imageCropBase dom element because it was already null."),this.dxa?(this.Mwa?this.Mwa.parentNode===
this.dxa?this.dxa.removeChild(this.Mwa):w.ULS.sendTraceTag(24174606,322,15,"Unable to Remove child divImageCropMode from imageElementContainer, because it was no longer a child of it."):w.ULS.sendTraceTag(23961794,322,15,"Unable to clear Crop mode div because it was already null."),this.dxa.classList.remove("ImageCropMode"),this.VGa=!1,b=new Se.GraphTransaction(4),b.Db(this.vbd.node),this.lre.setValue(ad.a.mta,this.VGa),b.dispose(),this.j9c&&(this.r0.vO(this.dxa,this.wbd),this.j9c=!1),this.re&&this.re.sc(kb.a.KH,
cb.InteractiveViewManager.instance.editingView.editingElement,this.iua),this.dxa=this.Mwa=null):w.ULS.sendTraceTag(22381065,322,15,"Unable to finish Image Crop clean-up because unable to obtain Image Element Container from Context.")):w.ULS.sendTraceTag(22381064,322,100,"Attempted to End Image Crop Mode when it was already off.")}Cfj(b,h,n,x,E,S,ma){if(n){n=Math.max(this.RU-h,0);let Fa=Math.floor(this.fV)-this.OU-n;5<=Fa?(this.JR=n,this.GR=this.OU):5>Fa&&0<=Fa||0>Fa&&!this.OU?(this.JR=n-(5-Fa),this.GR=
this.OU):0>Fa&&5>=Math.abs(Fa)?(this.JR=Math.floor(this.fV)-this.OU,this.GR=Math.max(this.OU-(n-(this.fV-this.OU))-(5-Math.abs(Fa)),0)):(this.JR=Math.floor(this.fV)-this.OU,this.GR=Math.max(this.OU-(n-(this.fV-this.OU)),0));this.fJ.style.top=this.JR+"px";this.fJ.style.bottom=this.GR+"px";ma&&(this.RU=this.JR,this.OU=this.GR)}x&&(h=Math.max(this.OU-h,0),x=Math.floor(this.fV)-this.RU-h,5<=x?(this.GR=h,this.JR=this.RU):5>x&&0<=x||0>x&&!this.RU?(this.GR=h-(5-x),this.JR=this.RU):0>x&&5>=Math.abs(x)?(this.GR=
Math.floor(this.fV)-this.RU,this.JR=Math.max(this.RU-(h-(this.fV-this.RU))-(5-Math.abs(x)),0)):(this.GR=Math.floor(this.fV)-this.RU,this.JR=Math.max(this.RU-(h-(this.fV-this.RU)),0)),this.fJ.style.top=this.JR+"px",this.fJ.style.bottom=this.GR+"px",ma&&(this.RU=this.JR,this.OU=this.GR));E&&(E=Math.max(this.PU-b,0),h=Math.floor(this.gV)-this.QU-E,5<=h?(this.HR=E,this.IR=this.QU):5>h&&0<=h||0>h&&!this.QU?(this.HR=E-(5-h),this.IR=this.QU):0>h&&5>=Math.abs(h)?(this.HR=Math.floor(this.gV)-this.QU,this.IR=
Math.max(this.QU-(E-(this.gV-this.QU))-(5-Math.abs(h)),0)):(this.HR=Math.floor(this.gV)-this.QU,this.IR=Math.max(this.QU-(E-(this.gV-this.QU)),0)),this.fJ.style.left=this.HR+"px",this.fJ.style.right=this.IR+"px",ma&&(this.PU=this.HR,this.QU=this.IR));S&&(b=Math.max(this.QU-b,0),S=Math.floor(this.gV)-this.PU-b,5<=S?(this.IR=b,this.HR=this.PU):5>S&&0<=S||0>S&&!this.PU?(this.IR=b-(5-S),this.HR=this.PU):0>S&&5>=Math.abs(S)?(this.IR=Math.floor(this.gV)-this.PU,this.HR=Math.max(this.PU-(b-(this.gV-this.PU))-
(5-Math.abs(S)),0)):(this.IR=Math.floor(this.gV)-this.PU,this.HR=Math.max(this.PU-(b-(this.gV-this.PU)),0)),this.fJ.style.left=this.HR+"px",this.fJ.style.right=this.IR+"px",ma&&(this.PU=this.HR,this.QU=this.IR));ma&&(this.d8c=!0,ob.App.xa.updateCommandUI())}kqk(){this.JR=this.RU;this.GR=this.OU;this.HR=this.PU;this.IR=this.QU;this.fJ.style.top=this.JR+"px";this.fJ.style.bottom=this.GR+"px";this.fJ.style.left=this.HR+"px";this.fJ.style.right=this.IR+"px"}uzk(){if(this.d8c){w.ULS.sendTraceTag(22381066,
322,50,"Commiting new Image Cropping Properties.");var b=Math.floor(1E5*this.RU/this.fV),h=Math.floor(1E5*this.OU/this.fV),n=Math.floor(1E5*this.PU/this.gV),x=Math.floor(1E5*this.QU/this.gV),E=new qi.DictionaryPropertySet;E.setValue(ad.a.Aeb,b);E.setValue(ad.a.xeb,h);E.setValue(ad.a.yeb,n);E.setValue(ad.a.zeb,x);this.ga.Qf(this.vbd,ub.a.e5h,2,!1,null,E)}else w.ULS.sendTraceTag(23070481,322,50,"No New Cropping Properties To Commit.")}mta(){return this.VGa}rml(){return{top:this.JR,bottom:this.GR,left:this.HR,
right:this.IR}}Xgo(b,h){if(0>b)w.ULS.sendTraceTag(22552777,322,15,"Unexpected negative value for new Crop properties.");else{switch(h){case 0:this.RU=this.JR=Math.min(Math.floor(this.fV)-this.GR-5,b);this.fJ.style.top=this.JR+"px";break;case 1:this.OU=this.GR=Math.min(Math.floor(this.fV)-this.JR-5,b);this.fJ.style.bottom=this.GR+"px";break;case 2:this.PU=this.HR=Math.min(Math.floor(this.gV)-this.IR-5,b);this.fJ.style.left=this.HR+"px";break;case 3:this.QU=this.IR=Math.min(Math.floor(this.gV)-this.HR-
5,b),this.fJ.style.right=this.IR+"px"}this.d8c=!0}}}Object(r.a)(Ej,"ImageEditor",og,[271,272]);class vh{constructor(){this.W=null}get name(){return"WordEditor.ImageEditors"}zc(b){this.W=b;this.W.ha("WordEditor.ImageEditors.ImageCropDragAdapterFactory",()=>new Ab(u.AFrameworkApplication.ya,Oa.a.instance.Za("Common.IZoomManager"))).as("WordEditor.IImageCropDragAdapterFactory").singleInstance();this.W.ha("WordEditor.ImageEditors.ImageEditor",()=>new Ej(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.ISelectionManager"),b.Za("Box4.IExternalSelectionManager"),b.resolve("Box4.ISelectionFactory"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),mc.KeyInputManager.instance,b.Za("WordEditor.IImageCropDragAdapterFactory"),b.Pa("Box4.IFeatureHelper"))).as("WordEditor.IImageEditor").as("Box4.Images.IImageEditor").singleInstance()}init(){this.W.resolve("WordEditor.IImageCropDragAdapterFactory")}dispose(){}static main(){N.a.instance.Pc(new vh)}}
Object(r.a)(vh,"WordEditorImageEditorsPackage",null,[1,2]);class Om{}Object(r.a)(Om,"FolderContentEditor",null,[1309]);class ep{}Object(r.a)(ep,"PageEditor",null,[1203]);var ql=d(180);class Al extends ep{constructor(){super()}get oh(){return ql.PageNavigator.instance}}Object(r.a)(Al,"PageEditor",ep,[]);class fp{get name(){return"WordEditor.NotebookLevelEditors"}zc(b){b.ha("Box4.NotebookLevelEditors.FolderContentEditor",()=>new Om).as("Box4.Folder.IFolderContentEditor").singleInstance();b.ha("WordEditor.NotebookLevelEditors.PageEditor",
()=>new Al).as("Box4.Pages.IPageEditor").singleInstance()}init(){}dispose(){}static main(){N.a.instance.Pc(new fp)}}Object(r.a)(fp,"WordEditorNotebookLevelEditorsPackage",null,[1,2]);class Am{get QGb(){return u.AFrameworkApplication.Fib}oda(){w.ULS.sendTraceTag(37034014,342,50,"User clicked on the Privacy statement.");rd.a.ym(this.QGb,"_blank",void 0,"SendUsYourFileDialog.PrivacyLink");return!0}}Object(r.a)(Am,"PrivacyLinkHandler",null,[788]);class Fp{constructor(b,h){this.pze=null;this.tSj=b;this.sSj=
h}showDialog(b){this.pze=b;this.sSj.create().Zh(Object(v.a)(this,this.IQl,"handleDialog"))}IQl(b){1===b&&this.tSj.rVi();this.pze();this.pze.prototype}}Object(r.a)(Fp,"SendUsYourFileController",null,[770]);class $n extends yd.StandardDialog{constructor(b,h,n){super();this.cTb=null;this.gg=b;this.itc=h;this.eG=n}Zh(b){this.Ed=1;this.We(1,this.eG.send);this.We(0,this.eG.QJm);w.ULS.shipAssertTag(37034013,342,!this.cTb,"privacy anchor should be null before initializing it.");const h=this.CTk();this.ahb(this.eG.dak,
null,"CancelRequest_32x32x32",null,b,h);this.m3(this.pj($n.yVi))}CTk(){const b=document.createElement("span");b.innerText=this.eG.l7m;const h=document.createElement("span");h.innerText=this.eG.Z4n;h.style.fontWeight=this.eG.hmo;const n=document.createElement("span");n.innerText=this.eG.dEn;const x=this.vBk(),E=document.createElement("span");E.id=this.pj($n.yVi);E.appendChild(b);E.appendChild(document.createElement("br"));E.appendChild(document.createElement("br"));E.appendChild(h);E.appendChild(document.createElement("br"));
E.appendChild(n);E.appendChild(document.createElement("br"));E.appendChild(document.createElement("br"));E.appendChild(document.createElement("br"));E.appendChild(x);return E}vBk(){const b=document.createElement("span"),h=document.createElement("a");h.innerText=this.eG.U6m;h.href=this.itc.QGb||"";b.appendChild(h);this.cTb=h;this.gg.mb(kb.a.click,this.cTb,Object(v.a)(this.itc,this.itc.oda,"clickHandler"));return b}dispose(){this.cTb&&(this.gg.sc(kb.a.click,this.cTb,Object(v.a)(this.itc,this.itc.oda,
"clickHandler")),this.cTb=null);super.dispose()}}$n.yVi="sendUsYourFileId";Object(r.a)($n,"SendUsYourFileDialog",yd.StandardDialog,[785]);class lr{create(){return Oa.a.instance.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialog")}}Object(r.a)(lr,"Factory",null,[787]);var Gp=d(581);class wn extends Gp.a{constructor(){super();this.FileId=null}Wl(){return 38}static construct(b){const h=new wn;h.FileId=b;return h}}Object(r.a)(wn,"CreateSendUsYourFileRequest",Gp.a,[]);var En=d(1044);class Ts{constructor(b,
h,n){this.Hba=b;this.AR=h;this.lKj=n}rVi(b=!1){if(this.AR){const h=wn.construct(this.AR()),n=new En.a;n.Vr=h;n.status=1;n.WG="BootErrorReport";b=b?this.Hba(null):this.Hba(x=>{this.SXc(n,x)});b.CJ(n);b.gW();this.lKj()}}SXc(b){5===b.statusCode&&this.rVi(!0)}}Object(r.a)(Ts,"SendUsYourFileManager",null,[769]);class dq{constructor(b,h){this.W=null;this.eG=b;this.AR=h}zc(b){this.W=b;this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings",()=>this.eG).singleInstance();this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileDialog",
()=>new $n($e.a.instance,new Am,this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings")));this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileManager",()=>new Ts(h=>this.Jka(0,h),this.AR,()=>{w.ULS.sendTraceTag(42022664,342,50,"send us your file request is now sent.")}));this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileController",()=>{const h=new lr;return new Fp(this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileManager"),h)}).singleInstance()}init(){this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileController")}dispose(){}}
Object(r.a)(dq,"SendUsYourFilePackageManager",null,[]);var Lq=d(555),Nu=d(984),Us;(function(b){b[b.none=0]="none";b[b.oneNote=1]="oneNote";b[b.word=2]="word";b[b.wordViewer=3]="wordViewer";b[b.powerPoint=4]="powerPoint"})(Us||(Us={}));Object(r.b)("AppMode",Us);class Ir{get dak(){return CommonUIStrings.l_AppTitle}get send(){return CommonUIStrings.l_Send}get QJm(){return CommonUIStrings.l_NoThanks}get l7m(){return WordEditorIntl.WordEditorStrings.L_ProblemOpeningDocument}get Z4n(){return WoncaIntl.WoncaStrings.l_SaveErrorReportTitle}get hmo(){return CommonUIStrings.l_UserInterfaceFontWeightBold}get dEn(){return WordEditorIntl.WordEditorStrings.L_SendUsYourFileDialogText}get U6m(){return CommonUIStrings.l_PrivacyStatement}}
Object(r.a)(Ir,"WordEditorSendUsYourFileDialogStrings",null,["__INTERFACE__@1js/wac-common:ISendUsYourFileDialogStrings"]);class yr extends dq{constructor(){super(new Ir,()=>u.AFrameworkApplication.rootQuerySignature)}Jka(b,h){return new Nu.a(b,h,"SendUsYourFile.ashx",Us.word,ob.App.webServiceBase,void 0,void 0,Lq.a.amIAlone,Lq.a.wQi,Lq.a.yPi)}get name(){return"WordEditor.SendUsYourFile"}static main(){N.a.instance.Pc(new yr)}}Object(r.a)(yr,"PackageManager",dq,["__INTERFACE__@1js/msoserviceplatform:IPackage",
"__INTERFACE__@1js/msoserviceplatform:IContainerConfiguration"]);var qm=d(648),ao=d(653),Qp=d(440);class qs extends Qp.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(r.a)(qs,"IconGalleryButtonProps",Qp.a,[]);var Bm=d(129),Fg=d(32),Zq=d(165),Eo=d(74),Aq=d(751),Uf=d(157),vp=d(961);class Hg{constructor(b,h,n,x,E,S){this.gJh=b;this.gallerySectionId=h;this.W3k=n;this.x9j=x;this.commandId=E;this.queryCommandId=S}}Object(r.a)(Hg,
"BorderStyleMenuPropsArguments",null,[]);class dh{constructor(b,h,n,x,E,S,ma){this.IXb=b;this.e7i=h;this.width=n;this.hti=x;this.height=E;this.qji=S;this.altText=ma}}Object(r.a)(dh,"TableBorderStyleProperties",null,[]);class hf{constructor(){this.Jeh=[new dh(hf.R4i,"","2",1,8,0,"Solid Line"),new dh(hf.mvh,"5,3","1",1,8,0,"Dashed Line"),new dh(hf.eAh,"1,1","1",1,8,0,"Dotted Line"),new dh(hf.gAh,"","1",2,8,3,"Double Line")];this.Keh=[new dh(hf.Reh,"","1",1,8,0,"0.25pt"),new dh(hf.Oeh,"","1",1,8,0,"0.5pt"),
new dh(hf.Ueh,"","2",1,8,0,"0.75pt"),new dh(hf.Peh,"","2",1,8,0,"1pt"),new dh(hf.Neh,"","3",1,8,0,"1.5pt"),new dh(hf.Veh,"","4",1,8,0,"2.25pt"),new dh(hf.Teh,"","4",1,8,0,"3pt"),new dh(hf.Meh,"","5",1,8,0,"4.5pt"),new dh(hf.Seh,"","6",1,8,0,"6pt")]}initialize(){this.Gjn()}jdl(){const b=new Hg("Line Style gallery","DefaultLineStyleOptions","LineStyleOptionsGallery",this.Jeh,Db.a.akb,Db.a.TNf);return this.AJh(b)}kdl(){const b=new Hg("Line Weight gallery","DefaultLineWeightOptions","LineWeightOptionsGallery",
this.Keh,Db.a.bkb,Db.a.UNf);return this.AJh(b)}kLh(b){switch(b){case hf.R4i:return Uf.a.JXb;case hf.mvh:return Uf.a.R$a;case hf.eAh:return Uf.a.Yyc;case hf.gAh:return Uf.a.t1;default:return Uf.a.hra}}lLh(b){switch(b){case hf.Reh:return Uf.a.Qeh;case hf.Oeh:return Uf.a.kSe;case hf.Ueh:return Uf.a.GXb;case hf.Peh:return Uf.a.Q$a;case hf.Neh:return Uf.a.wja;case hf.Veh:return Uf.a.Nya;case hf.Teh:return Uf.a.ida;case hf.Meh:return Uf.a.lVa;case hf.Seh:return Uf.a.Mya;default:return Uf.a.UE}}AJh(b){const h=
new ti.a,n=new Fh.a,x=Object.assign(new ao.a,{Id:b.gJh,ExternalId:b.gallerySectionId,ExternalGalleryId:b.W3k,Type:4,Width:1,GalleryItems:[]});for(let S of b.x9j){var E={};const ma={};ma.width=hf.Epm;ma.height=hf.Dpm;E.root=ma;E=Object.assign(new qs,{Id:S.IXb,ExternalId:String.format("{0}_GalleryButton",S.IXb),Icon:S.IXb,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:S.IXb,FullIconStyle:E,ShouldSetTitle:"true",Alt:S.altText});x.GalleryItems.push(E)}n.ControlList=
[];h.MenuSectionList=[];n.ControlList.push(x);h.MenuSectionList.push(n);h.UpdateDynamically=!0;return h}Gjn(){const b={};for(let h of this.Jeh)b[h.IXb]=appChrome.buildBorderStyleIcon(h.e7i,h.width,h.hti,h.height,h.qji);for(let h of this.Keh)b[h.IXb]=appChrome.buildBorderStyleIcon(h.e7i,h.width,h.hti,h.height,h.qji);appChrome.api.registerIconProvider(()=>b)}AFn(b,h,n){if(!b)return w.ULS.sendTraceTag(578073118,306,15,"table border context should not be null."),!1;if(b.contextId!==cc.a.v3)return w.ULS.sendTraceTag(577910617,
306,15,"Context should be of type table border. Getting context of type: {0}",b.contextId),!1;switch(b.border){case 2:this.n_(Bm.a.dT(b),b.node,5,n,h);break;case 0:this.n_(Bm.a.dT(b),b.node,3,n,h);break;case 1:this.n_(Bm.a.dT(b),b.node,4,n,h);break;case 3:this.n_(Bm.a.dT(b),b.node,0,n,h);break;case 7:this.n_(Bm.a.dT(b),b.node,1,n,h);break;case 8:this.n_(Bm.a.dT(b),b.node,2,n,h);break;case 6:this.n_(Bm.a.dT(b),b.node,1,n,h);this.n_(Bm.a.dT(b),b.node,2,n,h);break;case 5:this.n_(Bm.a.dT(b),b.node,3,
n,h);this.n_(Bm.a.dT(b),b.node,5,n,h);this.n_(Bm.a.dT(b),b.node,4,n,h);this.n_(Bm.a.dT(b),b.node,0,n,h);break;case 4:this.n_(Bm.a.dT(b),b.node,3,n,h),this.n_(Bm.a.dT(b),b.node,5,n,h),this.n_(Bm.a.dT(b),b.node,4,n,h),this.n_(Bm.a.dT(b),b.node,0,n,h),this.n_(Bm.a.dT(b),b.node,1,n,h),this.n_(Bm.a.dT(b),b.node,2,n,h)}return!0}bWf(b,h,n,x){if(!h)return w.ULS.sendTraceTag(578073119,306,15,"cell border context should not be null."),!1;if(h.contextId!==cc.a.u_)return w.ULS.sendTraceTag(577910656,306,15,"Context should be of type cell border. Getting context of type: {0}",
h.contextId),!1;var E=h.node;const S=new md.GraphIterator;S.set(E);S.Bb(14);E=Fg.TableCellReader.NKa(S);switch(h.border){case 2:this.VOa(b,h.node,5,x,n,E);this.O5d(h.node,5,n);this.U4d(b,h.vXa(),3,n,x,E);break;case 0:this.VOa(b,h.node,3,x,n,E);this.O5d(h.node,3,n);this.U4d(b,h.vXa(),1,n,x,E);break;case 1:this.VOa(b,h.node,4,x,n,E);this.O5d(h.node,4,n);this.U4d(b,h.vXa(),0,n,x,E);break;case 3:this.VOa(b,h.node,0,x,n,E),this.O5d(h.node,0,n),this.U4d(b,h.vXa(),2,n,x,E)}return!0}Yan(b,h){if(Kd.SelectionEditor.GOc(b)&&
h)switch(b=Object(ja.a)(Zq.TableNodeBorderContext,b),b.border){case 2:this.RN(b.node,hf.vo.zL(5),h);break;case 0:this.RN(b.node,hf.vo.zL(3),h);break;case 3:this.RN(b.node,hf.vo.zL(0),h);break;case 1:this.RN(b.node,hf.vo.zL(4),h);break;case 7:this.RN(b.node,hf.vo.zL(1),h);break;case 8:this.RN(b.node,hf.vo.zL(2),h);break;case 5:h=this.RN(b.node,hf.vo.zL(5),h);h=this.RN(b.node,hf.vo.zL(3),h);h=this.RN(b.node,hf.vo.zL(0),h);this.RN(b.node,hf.vo.zL(4),h);break;case 6:h=this.RN(b.node,hf.vo.zL(1),h);this.RN(b.node,
hf.vo.zL(2),h);break;case 4:h=this.RN(b.node,hf.vo.zL(5),h),h=this.RN(b.node,hf.vo.zL(3),h),h=this.RN(b.node,hf.vo.zL(0),h),h=this.RN(b.node,hf.vo.zL(4),h),h=this.RN(b.node,hf.vo.zL(1),h),this.RN(b.node,hf.vo.zL(2),h)}}z$m(b,h){if(Kd.SelectionEditor.HOc(b)&&h)switch(b=Object(ja.a)(Zq.TableNodeBorderContext,b),b.border){case 2:this.RN(b.node,hf.vo.LN(5),h);break;case 0:this.RN(b.node,hf.vo.LN(3),h);break;case 3:this.RN(b.node,hf.vo.LN(0),h);break;case 1:this.RN(b.node,hf.vo.LN(4),h)}}paf(b,h,n){n=
null;if(!b)return w.ULS.sendTraceTag(575980876,306,15,"Node should not be null"),n;b.properties.hasProperty(h.size)&&(n=new vp.a,n.weight=b.properties.ia(h.size,Uf.a.UE),n.style=b.properties.ia(h.style,Uf.a.hra),n.color=b.properties.ia(h.color,0));return n}aWf(b,h,n){b?n?(b.properties.setValue(h.size,n.weight),b.properties.setValue(h.style,n.style),b.properties.setValue(h.color,n.color)):w.ULS.sendTraceTag(575980878,306,15,"Property Value object should not be null"):w.ULS.sendTraceTag(575980877,306,
15,"Node should not be null")}LHb(b,h){b?(b.properties.removeProperty(h.size),b.properties.removeProperty(h.style),b.properties.removeProperty(h.color)):w.ULS.sendTraceTag(575980879,306,15,"Node should not be null")}n_(b,h,n,x,E){E=this.Zjo(b,h,n,x,E);this.cdc(h,hf.vo.zL(n),E);switch(n){case 5:this.rOa(h,2,x,E);break;case 4:this.rOa(h,1,x,E);break;case 0:this.rOa(h,3,x,E);break;case 3:this.rOa(h,0,x,E);break;case 1:this.rOa(h,7,x,E);break;case 2:this.rOa(h,8,x,E)}}Zjo(b,h,n,x,E){if(3!==x){var S=hf.Xg.kEd(b,
h,n,3);void 0!==S&&null!==S&&S!==Uf.a.TY&&(S=Eo.a.kcc(S),E.color=hf.Ifc.Zya(h,S))}1!==x&&(S=hf.Xg.kEd(b,h,n,1),void 0!==S&&null!==S&&S!==Uf.a.RE&&(E.weight=parseFloat(S)*Uf.a.HXb));2!==x&&(b=hf.Xg.kEd(b,h,n,2),void 0!==b&&null!==b&&b!==Uf.a.RE&&(E.style=b));return E}VOa(b,h,n,x,E,S){x&&(E=this.Feo(b,h,S,n,x,E));this.cdc(h,hf.vo.LN(n),E)}Feo(b,h,n,x,E,S){if(3!==E){var ma="",Fa=hf.Xg.Fzb(b,h,x,!1,!0,n,3);Fa&&(ma=Fa.Dvb);void 0!==ma&&null!==ma&&ma!==Uf.a.TY&&(ma=Eo.a.kcc(ma),S.color=hf.Ifc.Zya(h,ma))}if(1!==
E){ma="";if(Fa=hf.Xg.Fzb(b,h,x,!1,!0,n,1))ma=Fa.Dvb;void 0!==ma&&null!==ma&&ma!==Uf.a.RE&&(S.weight=parseFloat(ma)*Uf.a.HXb)}if(2!==E){E="";if(b=hf.Xg.Fzb(b,h,x,!1,!0,n,2))E=b.Dvb;void 0!==E&&null!==E&&E!==Uf.a.RE&&(S.style=E)}return S}qHm(b){let h=0,n=0;({QGm:h,wEm:n}=this.hxl(b.style,h,n));b.weight<h&&(b.weight=h);b.weight>n&&(b.weight=n);return b}hxl(b,h,n){switch(b){case Uf.a.JXb:case Uf.a.R$a:case Uf.a.Yyc:h=2;n=48;break;case Uf.a.t1:h=2;n=24;break;default:h=2,n=48}return{QGm:h,wEm:n}}U4d(b,
h,n,x,E,S){if(h)if(x)for(let ma=0;ma<h.length;ma++)switch(n){case 2:this.VOa(b,h[ma],5,E,x,S);break;case 0:this.VOa(b,h[ma],3,E,x,S);break;case 1:this.VOa(b,h[ma],4,E,x,S);break;case 3:this.VOa(b,h[ma],0,E,x,S)}else w.ULS.sendTraceTag(578073121,306,15,"tableBorderPropertyValue should not be null");else w.ULS.sendTraceTag(578073120,306,15,"Adjacent cell array should not be null")}O5d(b,h,n){const x=new md.GraphIterator;x.set(b);x.Bb(14);const E=Fg.TableCellReader.Ksa(b);b=Fg.TableCellReader.LP(b);
$d.forEachCell(x,E,b,(S,ma,Fa)=>{S=S.currentNode;Fg.TableCellReader.Or(S)&&0==Fa&&0<ma&&this.cdc(S,hf.vo.LN(h),n)})}cdc(b,h,n){b?(n=this.qHm(n),b.properties.setValue(h.color,n.color),b.properties.setValue(h.size,n.weight),b.properties.setValue(h.style,n.style)):w.ULS.sendTraceTag(578073122,306,15,"Graph node should not be null")}rOa(b,h,n,x){if(b){var E=ag.TableReader.ag(b),S=ag.TableReader.kh(b),ma=new md.GraphIterator,Fa=[];for(let $a=0;$a<E;$a++)for(let sb=0;sb<S;sb++)if(ma.set(b),$d.moveToCell(ma,
$a,sb),ma&&ma.currentNode&&!Fg.TableCellReader.qg(ma))switch(h){case 2:Fg.TableCellReader.Tea(ma)&&Fa.push(Zq.TableNodeBorderContext.J5(ma.currentNode,2));break;case 0:Fg.TableCellReader.Uea(ma)&&Fa.push(Zq.TableNodeBorderContext.J5(ma.currentNode,0));break;case 3:Fg.TableCellReader.iqf(b,ma.currentNode)&&Fa.push(Zq.TableNodeBorderContext.J5(ma.currentNode,3));break;case 1:Fg.TableCellReader.jqf(b,ma.currentNode)&&Fa.push(Zq.TableNodeBorderContext.J5(ma.currentNode,1));break;case 7:Fg.TableCellReader.jqf(b,
ma.currentNode)||Fa.push(Zq.TableNodeBorderContext.J5(ma.currentNode,1));break;case 8:Fg.TableCellReader.iqf(b,ma.currentNode)||Fa.push(Zq.TableNodeBorderContext.J5(ma.currentNode,3))}for(b=0;b<Fa.length;b++)switch(h=Fa[b],h.border){case 2:this.LWc(h.node,hf.vo.LN(5),n,x);this.a2d(h.vXa(),hf.vo.LN(0),n,x);break;case 0:this.LWc(h.node,hf.vo.LN(3),n,x);this.a2d(h.vXa(),hf.vo.LN(4),n,x);break;case 1:this.LWc(h.node,hf.vo.LN(4),n,x);this.a2d(h.vXa(),hf.vo.LN(3),n,x);break;case 3:this.LWc(h.node,hf.vo.LN(0),
n,x),this.a2d(h.vXa(),hf.vo.LN(5),n,x)}}else w.ULS.sendTraceTag(578073123,306,15,"Table node should not be null")}a2d(b,h,n,x){if(b)for(let E=0;E<b.length;E++)this.LWc(b[E],h,n,x);else w.ULS.sendTraceTag(578062292,306,15,"Adjacent cell array should not be null")}LWc(b,h,n,x){if(b){var E=b.ia(h.color,hf.$0e),S=b.ia(h.size,hf.b1e),ma=b.ia(h.style,hf.a1e),Fa=new vp.a;Fa.weight=x.weight;Fa.style=x.style;Fa.color=x.color;2!==n||E===hf.$0e&&S===hf.b1e?3!==n||ma===hf.a1e&&S===hf.b1e?1!==n||E===hf.$0e&&ma===
hf.a1e?(b.properties.removeProperty(h.color),b.properties.removeProperty(h.size),b.properties.removeProperty(h.style)):(Fa.color=E,Fa.style=ma,this.cdc(b,h,Fa)):(Fa.style=ma,Fa.weight=S,this.cdc(b,h,Fa)):(Fa.color=E,Fa.weight=S,this.cdc(b,h,Fa))}else w.ULS.sendTraceTag(578073152,306,15,"Graph node should not be null")}RN(b,h,n){var x=b.properties.ia(h.style,Uf.a.RE);x!==Uf.a.RE&&(n.lineStyle!==Uf.a.RE?n.lineStyle!==x&&(n.lineStyle=Uf.a.cik):n.lineStyle=x);x=b.properties.ia(h.size,Uf.a.UE);x!==Uf.a.UE&&
(n.XPc!==Uf.a.UE?n.XPc!==x&&(n.XPc=Uf.a.Vhk):n.XPc=x);b=b.properties.ia(h.color,0);b=Eo.a.BC(b);b!==Uf.a.TY&&(n.borderColor!==Uf.a.TY?n.borderColor!==b&&(n.borderColor=Uf.a.Nhk):n.borderColor=b);return n}static get vo(){return null!=hf.lfg?hf.lfg:hf.lfg=Uf.a.instance}static get Xg(){return null!=hf.Yrg?hf.Yrg:hf.Yrg=Oa.a.instance.Pa("WordEditor.IWACTableStyleReader")}static get Ifc(){return null!=hf.Ypg?hf.Ypg:hf.Ypg=Aq.a.instance}}hf.Epm="110px";hf.Dpm="20px";hf.R4i="SolidLineStyle";hf.mvh="DashedLineStyle";
hf.eAh="DottedLineStyle";hf.gAh="DoubleLineStyle";hf.Reh="BorderPointSizeOneQuarter";hf.Oeh="BorderPointSizeOneHalf";hf.Ueh="BorderPointSizeThreeQuarters";hf.Peh="BorderPointSizeOne";hf.Neh="BorderPointSizeOneAndHalf";hf.Veh="BorderPointSizeTwoAndQuarter";hf.Teh="BorderPointSizeThree";hf.Meh="BorderPointSizeFourAndHalf";hf.Seh="BorderPointSizeSix";hf.a1e="single";hf.b1e=4;hf.$0e=0;Object(r.a)(hf,"TableBorderManager",null,[267]);var Ze=d(899),al=d(63),mn=d(196);class Jr{constructor(b,h){this.YVg=this.yQg=
null;this.kJa=b;this.WSg=h}get wAi(){return this.WSg}get vma(){return this.yQg}get oPf(){return this.YVg}UYi(b,h){this.YVg=b;this.yQg=h}AKn(b){this.WSg=b}}Object(r.a)(Jr,"CellNodeAndOutlineElementInfoForInsertion",null,[]);var Zh=d(100),Oh=d(209),Zj=d(384),qh=d(152),Pm=d(261),Fn=d(585),fm=d(94),nk=d(441),gp=d(921);class ak extends Ze.a{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb=null,Sb=null){super(b,h,n,Sb,Jb);this.r5a=gp.a.instance;this.sa=new Ge.a;this.tUe=[ic.a.Zkb,ic.a.JPa,ic.a.$2a,ic.a.Xkb,ic.a.HPa,
ic.a.Y2a,ic.a.Wkb,ic.a.GPa,ic.a.X2a,ic.a.Ykb,ic.a.IPa,ic.a.Z2a];this.Ewj=[ic.a.va,ic.a.ta,ie.a.ai,ie.a.Aq];this.zi=x;this.otb=E;this.Xc=S;this.hb=ma;this.x4=Fa;this.Qm=$a;this.qnc=sb;this.e2g=Jb;this.JWj=Sb}get Qi(){return this.zi.value}get Mr(){return this.x4?this.x4.instance:null}$Ne(b){this.sa.addHandler("OnParagraphDelete",b)}get vh(){return!!this.qnc.instance&&this.qnc.instance.vh}MLc(b,h,n,x,E){h.setValue(ic.a.Mc,Ub.a.JF());h.setValue(ic.a.g9l,E);Fn.b(x,h,[ic.a.w_]);super.MLc(b,h,n,x,E)}qLd(b,
h,n,x,E){const S=this.KJc(h,n,x,E);this.Rvd(S,h,!1);return super.qLd(b,h,n,x,E)}qpd(b,h,n,x,E){const S=this.KJc(h,n,x,E);this.Rvd(S,h,!0);super.qpd(b,h,n,x,E);return S}AYe(b,h,n,x){h=this.KJc(b,h,n,x);this.Rvd(h,b,!0);return h}insertRows(b,h,n,x){const E=al.a.xt(b),S=new md.GraphIterator;S.fd(b);const ma=S.currentNode;S.Rb(1);let Fa;Fa=h?b.QC(1):b.currentNode;const $a=b.nc();if(!$a)throw Error.create("table row insertion cannot be performed on a null tableNode");const sb=ag.TableReader.ag($a),Jb=
$a.wS.Xg;let Sb=!1;try{$a.sna=1;const oc=this.r5a.Scb($a,Jb.Kz($a));this.fPa(b.currentNode);this.hoa(b);this.Z1j(n,b,Fa,S,ma,h,x);const Ic=this.r5a.Scb($a,Jb.Kz($a));this.m2a($a,ag.TableReader.ag($a)+n);Sb=!0;this.aMd($a,oc,Ic)}finally{$a.sna=0,Sb||this.m2a($a,ag.TableReader.ag($a)+n)}E+1!==sb||h?!E&&h&&ak.fnf($a,n):ak.fnf($a,E);h=E+n+(h?0:1);h<sb+n&&this.M8h($a,h);return b.currentNode}Z1j(b,h,n,x,E,S,ma){let Fa=null,$a=null;for(var sb=0;sb<b;++sb){var Jb=mn.a.instance.createInstance(393251);$a||
($a=Jb);Fa=Jb;this.MLc(h,Jb,n,E,S)}b=ag.TableReader.kh(h.currentNode);n=!0;do{n?(h.Ci(Fa),n=!1):h.wf(1);E=Array(b);for(sb=0;sb<b;++sb){Jb=this.QJa();const Sb=this.AYe(Jb,x.currentNode,S,!0);let oc=null;Sb.qg||(oc=ma(Sb));E[sb]=new Jr(Jb,oc);E[sb].UYi(Sb,null);x.wf(1)}for(sb=0;sb<b;++sb)Jb=E[sb].kJa,h.d1(Jb,1,Ze.a.KGa?Ze.a.KGa():null),Fg.TableCellReader.Or(Jb)||(this.bvb(h,Jb,E[sb].wAi),this.wqh(E[sb].oPf,Jb,!0));x.e6(1)}while(h.currentNode!==$a)}insertColumns(b,h,n,x,E){let S=b.currentNode,ma=!1,
Fa=ag.TableReader.kh(b.currentNode);const $a=Fa;try{this.fPa(b.currentNode);this.hoa(b);const sb=S.wS.Xg;S.sna=1;const Jb=this.r5a.Scb(S,sb.Kz(S));Fa=ag.TableReader.kh(b.currentNode);-1===h&&(h=Fa);this.X1j(b,x,n,h,E);S=b.currentNode;Fa+=x;this.IOf(b,Fa,x,h);ma=!0;const Sb=this.r5a.Scb(S,sb.Kz(S));this.aMd(S,Jb,Sb)}finally{S.sna=0,ma||this.IOf(b,Fa,x,h)}h!==$a||n?!h&&n&&ak.enf(S,x):ak.enf(S,h-1)}X1j(b,h,n,x,E){var S=b.currentNode;x=n?x:x-1;b.Rb(1);var ma=new Qa.a;do{var Fa=b.PC(x,1);b.nc();var $a=
Array(h);for(let Jb=0;Jb<h;++Jb){var sb=this.QJa();const Sb=this.Pyl(b,Fa,n),oc=this.AYe(sb,Fa,n,!1);sb=new Jr(sb,null);sb.UYi(oc,Sb);$a[Jb]=sb}ma.add($a)}while(b.Vi(1));n=ma.toArray();for(x=0;x<n.length;x++)for(ma=0;ma<h;ma++)Fa=n[x][ma],$a=Fa.oPf,$a.qg||Fa.AKn(E($a));b.set(S);b.Rb(1);E=0;do{for(S=0;S<h;++S)x=n[E][S],ma=x.kJa,b.KBb(ma,x.vma,1,Ze.a.KGa?Ze.a.KGa():null),Fg.TableCellReader.Or(ma)||(this.bvb(b,ma,x.wAi),this.wqh(x.oPf,ma,!1));E++}while(b.Vi(1))}aMd(b,h,n){if(h){var x=2===b.sna,E=[],
S=new md.GraphIterator;S.set(b);for(var ma=S.Rb(1);ma;){for(ma=S.Rb(1);ma;){const Fa=ma.id.toString();Fa in h&&h[Fa]===n[Fa]&&(!x||!Fg.TableCellReader.Uea(S)&&!Fg.TableCellReader.Tea(S))||E.push(ma);ma=S.Vi(1)}ma=S.Vi(1)}if(0<E.length){h=new Se.GraphTransaction(3);try{h.set(b.Ti);for(let Fa of E)Fa.ZLd()}finally{h&&h.dispose()}}}}deleteRows(b,h){const n=al.a.xt(b),x=n+h;let E=b.nc();const S=E.wS.Xg;let ma=!1;w.ULS.sendTraceTag(579479247,341,50,"Performing DeleteRows. Table node Id: {0}, Table Node Type: {1},  Row index: {2}, Row count to delete: {3}",
E.id.toString(),E.type,n,h);const Fa=ag.TableReader.ag(E);try{E.sna=2;const $a=this.r5a.Scb(E,S.Kz(E));this.fPa(b.currentNode);this.hoa(b);for(let Jb=x-1;Jb>=n;--Jb){b.PC(Jb,1);let Sb=b.Rb(1);for(;Sb;)this.wSc(Sb,!0),Sb=b.Vi(1);this.zYa(b);w.ULS.sendTraceTag(579479248,341,50,"Deleting table row node: ID:{0}, Type:{1}",b.currentNode.id.toString(),b.Se);b.Fg()}E=b.currentNode;const sb=this.r5a.Scb(E,S.Kz(E));this.m2a(E,ag.TableReader.ag(E)-h);this.NVd(b);ma=!0;this.aMd(E,$a,sb)}finally{E.sna=0,ma||
(this.m2a(b.currentNode,ag.TableReader.ag(b.currentNode)-h),this.NVd(b))}Fa===x&&0<=n-1&&ak.fnf(E,n-1);n<Fa-h&&this.M8h(E,n)}deleteColumns(b,h,n){b=Object(ja.a)(md.GraphIterator,b);let x=Object(ja.a)(nk.a,b.currentNode),E=ag.TableReader.kh(b.currentNode);const S=x.wS.Xg;let ma=!1;w.ULS.sendTraceTag(579479249,341,50,"Performing DeleteColumns. Table Node Id:{0}, Table Node type:{1}, Column Index: {2}, Column count to delete: {3}",x.id.toString(),x.type,h,n);const Fa=E;try{x.sna=2;const $a=this.r5a.Scb(x,
S.Kz(x));this.fPa(b.currentNode);this.hoa(b);-1===h&&(h=E-n);b.Rb(1);do for(let Jb=h+n-1;Jb>=h;--Jb)b.PC(Jb,1),this.wSc(b.currentNode,!1),this.zYa(b),b.Fg();while(b.Vi(1));E-=n;this.HOf(b,E,h,n);ma=!0;x=Object(ja.a)(nk.a,b.currentNode);const sb=this.r5a.Scb(x,S.Kz(x));this.aMd(x,$a,sb);this.MVd(b)}finally{x&&(x.sna=0),ma||(this.HOf(b,E,h,n),this.MVd(b))}Fa===h+n&&0<=h-1&&ak.enf(x,h-1)}mergeCells(b,h,n){if(b&&(1!==h||1!==n)){var x=new md.GraphIterator;x.fd(b);x.Bb(14);this.VZe(x,h,n);this.neo(x,h,
n);x.nc();x.nc();this.Ewi(x)}}u5i(b,h,n){if(b&&(1!==h||1!==n)){var x=new md.GraphIterator;x.fd(b);x.Bb(14);this.ELk(x,h,n);x.nc();x.nc();this.Nyi(x)}}wSc(b,h){w.ULS.sendTraceTag(579479250,341,50,"Table cell getting deleted. ID:{0}, Type:{1}",b.id.toString(),b.type);this.zQl(b,h,Object(v.a)(this,this.BMf,"promoteToNonGhostCellImpl"))}BMf(b,h){const n=b.currentNode;n.qg=!1;this.Rvd(h.currentNode,b.currentNode,!0);n.removeProperty(ic.a.skippedCell);n.removeProperty(ic.a.renderCell);1===n.colSpan&&1===
n.rowSpan&&n.iAc();Ze.a.uJ.m5(b,!0,Ze.a.dUh(h.currentNode));$d.returnToCell(b);this.vEk(h,b)}Gif(b,h,n){super.Gif(b,h,n);1===h.controlCell.colSpan&&1===h.controlCell.rowSpan?h.controlCell.iAc():!n&&h.N3d&&(b.vLa?1<b.colSpan&&(h=new md.GraphIterator,h.set(b),h.Bb(15),$d.moveToNextColumn(h),h.currentNode.colSpan=b.colSpan-1):(n=new md.GraphIterator,n.set(h.controlCell),n.Bb(15),h=fm.a(n),n=new md.GraphIterator,n.set(b),n.Bb(15),$d.moveToColumnByIndex(n,h),--n.currentNode.colSpan))}KJc(b,h,n,x){const E=
super.KJc(b,h,n,x);if(b.qg&&!x){var S=h.Vta;S.N3d&&(x=Ze.a.F1b(S.controlCell,x),!S.sud&&n||S.sud===x-1&&!n?b.colSpan=1:(n=new md.GraphIterator,n.set(S.controlCell),n.Bb(15),S=fm.a(n),n=new md.GraphIterator,n.set(h),n.Bb(15),$d.moveToColumnByIndex(n,S),n.currentNode.colSpan+=1))}E.ia(ic.a.skippedCell,!1)&&(b.qg=!0,b.v2=!0,b.qkb=!0);return E}NVd(b){this.zLb(b,ic.a.complexTable)}MVd(b){this.zLb(b,ic.a.complexTable)}Ewi(b){this.zLb(b,ic.a.complexTable)}Nyi(b){this.zLb(b,ic.a.complexTable)}vEk(b,h){if(b&&
h){let n;b=md.GraphIterator.$a(b.currentNode);Te.OutlineNavigator.K6(b)&&(b.Rb(2),b=b.currentNode,12==b.type&&(n=b.Og(ie.a.ai)));n&&(b=new md.GraphIterator,b.fd(h),Te.OutlineNavigator.K6(b)&&b.Rb(2)&&(h=b.currentNode,12==h.type&&h.lh(ie.a.ai,n)))}}Rvd(b,h,n){b&&(Fn.b(b,h,this.tUe),Fn.b(b,h,[ie.a.NH]),n&&Fn.b(b,h,[ic.a.pM,ic.a.rO,ic.a.nEa,ic.a.lEa,ic.a.Mga,ic.a.skippedCell,ic.a.renderCell]))}wqh(b,h,n){b&&(b=md.GraphIterator.$a(b),b.vd(),b.Wd(),h=md.GraphIterator.$a(h),h.vd(),h.Wd(),Kf.OutlineElementReader.Nh(b)&&
wf.OutlineElementNavigator.He(b)&&Kf.OutlineElementReader.Nh(h)&&wf.OutlineElementNavigator.He(h)&&Fn.b(b.currentNode,h.currentNode,this.Ewj),n&&(wf.OutlineElementNavigator.ae(b),wf.OutlineElementNavigator.ae(h),ec.ListReader.$h(b)&&(n=ak.iqm.Es(b),n.Qz=Zh.a.Xi,{pBa:n}=ak.Jo.Yqa(n.propertySet,h,n))))}zYa(b){this.vh&&this.Qm.cmn(b.currentNode);for(b=Oh.a.tq(b);b.moveNext();)if(Cd.ParagraphReader.oc(b.currentNode)){const h=Ad.e(b.currentNode);for(let n of h)n.Afa();this.sa.raiseEvent("OnParagraphDelete",
b.currentNode)}else ec.ListReader.$h(b.iterator)&&this.Mr&&this.Mr.vDa(b.iterator)}lD(b,h){let n=null;if(this.e2g.wg){const x=Object(ja.a)(nk.a,b);x&&(n=x.IQ())}ag.TableReader.hm(b)&&(1===h?h=3:3===h&&(h=1));super.lD(b,h);this.e2g.wg&&this.JWj.Vaa(b,n);Object(pb.a)(nk.a,b)&&Ze.a.Kh.IZi(Object(ja.a)(nk.a,b),(new Zj.a(1,0)).gt)}hXf(b,h){const n=Array(h),x=this.PYh(b)/h;for(let E=0;E<h;E++)n[E]=Math.max(mf.a.jn(qh.a.lba,0),x);b.setValue(ie.a.Yy,n)}yYi(b){b.setValue(ic.a.tableLayout,0)}S9g(b,h,n,x,E){const S=
Array(n);for(var ma=0,Fa=0;ma<x;++ma)S[ma]=h[ma],Fa+=S[ma];for(;ma<n;++ma)S[ma]=0>ma-E?h[0]:h[ma-E],Fa+=S[ma];ma=this.PYh(b.currentNode);if(Fa>ma)for(Fa=ma/Fa,ma=0;ma<n;++ma)S[ma]=Math.max(mf.a.jn(qh.a.lba,0),S[ma]*Fa);return S}PYh(b){var h=md.GraphIterator.$a(b);b=mf.a.jn(mf.a.Ni(ag.TableReader.AYh(h),0),0);if(h.Bb(16))return $d.returnToCell(h),h=qh.a.Zfc(h.currentNode),mf.a.jn(mf.a.Ni(h,0),0)-b;h=Pm.a.H1c(h);return mf.a.jn(mf.a.Ni(h,0),0)-b}LP(b,h,n){const x=new md.GraphIterator;x.set(b);$d.moveToCell(x,
h,n);return x.currentNode.ia(ic.a.colSpan,1)}hdc(b){var h=ob.App.xa.jb.uv;if(h.Be&&(h=b.De(h.Tb))){var n=!1,x=ag.TableReader.kh(b),E=b.ia(ie.a.Yy,Array(x));for(var S of E)if(!S){n=!0;break}if(n){E=th.a.clone(E);S=b.ia(ic.a.complexTable,!1);w.ULS.sendTraceTag(36726403,341,50,"Performing set column widths: columnCount {0} | columnWidths: {1} | isComplexTable: {2}",x,E,S);n=1;var ma=0;for(let $a=0;$a<x;)if(S&&(n=this.LP(b,0,$a)),1<n){for(var Fa=0;Fa<n;Fa++)E[$a]||(E[$a]=this.LSh(0)),$a++;ma+=n-1}else(Fa=
h.qml($a-ma))||w.ULS.sendTraceTag(36726404,341,50,"Got no width for graph column {0} (ghost cells {1})",$a,ma),E[$a]||(E[$a]=this.LSh(Fa)),$a++;b.setValue(ie.a.Yy,E)}}}LSh(b){return mf.a.jn(Math.max(b,qh.a.lba),0)}fPa(b){b=md.GraphIterator.$a(b);this.hdc(b.currentNode);b.Bb(14)&&($d.returnToContainingTable(b),this.hdc(b.currentNode))}FZi(b,h){h&&b.setValue(ic.a.D7,h)}KXf(b,h){h&&b.setValue(ic.a.gfc,h)}plh(b,h){const n=ag.TableReader.kh(b);Ze.a.zuk(b,h,n)}EGn(b,h,n){let x;if(!({tableNode:x}=this.f7b(b)).returnValue)return!1;
if(h&&n&&h.length===n.length){if(!this.tWk(x,h))return!1;for(let E=0;E<h.length;++E){const S=this.otb.kZc(b,h[E],n[E]);if(S)return w.ULS.sendTraceTag(17584922,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",S),!1}this.UTd(x);return!0}return!1}Cak(b,h){let n;if(!({tableNode:n}=this.f7b(b)).returnValue||ag.TableReader.wA(n))return!1;var x=Object(ja.a)(md.GraphIterator,this.Xc.pg(n));$d.moveToLastRow(x);var E=ag.TableReader.ag(n);if(h&&0<h.length){this.insertRows(x,
!1,h.length,()=>null);x=ag.TableReader.ag(n);var S=this.Xc.pg(n);E=this.wYh(S,E,x-1);for(x=0;x<E.length;++x){S=E[x];const ma=h[x];for(let Fa=0;Fa<S.length;++Fa){let $a;if($a=ma&&ma[Fa]?this.otb.kZc(b,S[Fa],ma[Fa].toString()):this.otb.kZc(b,S[Fa],""))return w.ULS.sendTraceTag(17584923,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",$a),!1}}}this.UTd(n);return!0}lak(b,h){let n;if(!({tableNode:n}=this.f7b(b)).returnValue||ag.TableReader.wA(n))return!1;var x=
this.Xc.pg(n),E=ag.TableReader.kh(n);if(h&&0<h.length){this.insertColumns(Object(ja.a)(md.GraphIterator,x),E,!1,h[1].length,()=>null);var S=ag.TableReader.kh(n);x=this.dJl(x,E,S-1);for(E=0;E<x.length;++E){S=h[E];const ma=x[E];for(let Fa=0;Fa<ma.length;++Fa){let $a;if($a=S&&S[Fa]?this.otb.kZc(b,ma[Fa],S[Fa].toString()):this.otb.kZc(b,ma[Fa],""))return w.ULS.sendTraceTag(17584924,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",$a),!1}}}this.UTd(n);return!0}hQk(b){let h;
if(!({tableNode:h}=this.f7b(b)).returnValue)return!1;let n=this.PXa(h);const x=ag.TableReader.ag(h);var E=this.Xc.pg(h);E=this.wYh(E,n,x-1);for(let S=0;S<E.length;++S){const ma=E[S];for(let Fa=0;Fa<ma.length;++Fa){const $a=this.otb.aLi(b,ma[Fa]);if($a)return w.ULS.sendTraceTag(17584925,341,10,"Unexpected failure to release content control in table cell. error code is {0}",$a),!1}}n=n?n:1;b=this.Xc.pg(h);b.kI(n)&&15===b.Se&&this.deleteRows(Object(ja.a)(md.GraphIterator,b),x-n);this.UTd(h);return!0}PXa(b){let h=
0;const n=this.Xc.pg(b);let x=n.Wd();for(;x&&x.ia(ic.a.cgb,!1);)h++,x=n.zu();return!h&&jh.StyleReader.b3a.fT(b)&32?1:h}neo(b,h,n){var x,E;const S=b.currentNode,ma=new md.GraphIterator;ma.fd(b);let Fa=null,$a=null,sb=null;const Jb=Uf.a.instance.LN(3),Sb=Uf.a.instance.LN(4),oc=Uf.a.instance.LN(5),Ic=Uf.a.instance.LN(0);$d.forEachCell(ma,h,n,(gd,Gd,vd)=>{gd=gd.currentNode;Gd||vd||(Fa=ak.Xy.paf(gd,Jb,Fa));Gd||vd!==n-1||($a=ak.Xy.paf(gd,Sb,$a));0<Gd&&!vd&&(Fa?ak.Xy.aWf(gd,Jb,Fa):ak.Xy.LHb(gd,Jb),$a?ak.Xy.aWf(gd,
Sb,$a):ak.Xy.LHb(gd,Sb),ak.Xy.LHb(gd,oc),Gd!==h-1&&ak.Xy.LHb(gd,Ic));vd||Gd!==h-1||(sb=ak.Xy.paf(gd,Ic,sb))});b=null===(E=null===(x=null===ob.App||void 0===ob.App?void 0:ob.App.xa)||void 0===x?void 0:x.jb)||void 0===E?void 0:E.uv;$a?(x=Zq.TableNodeBorderContext.J5(S,1),ak.Xy.bWf(Bm.a.Qo(b),x,$a,0)):ak.Xy.LHb(S,Sb);x=Zq.TableNodeBorderContext.J5(S,0);if(Fa)ak.Xy.bWf(Bm.a.Qo(b),x,Fa,0);else for(x=Object(ja.a)(Zq.TableNodeBorderContext,x).vXa(),E=0;E<x.length;E++)ak.Xy.LHb(x[E],Sb);sb?ak.Xy.aWf(S,Ic,
sb):ak.Xy.LHb(S,Ic)}tWk(b,h){for(let x=0;x<h.length;++x){var n=this.Xc.pg(h[x]);if(n.Bb(14)&&(n=n.kd(14),b.id===n.id))continue;return!1}return!0}f7b(b){let h=null;if(b&&b.ju.toString()!==b.Fz.toString())return{returnValue:!1,tableNode:h};h=this.Qi.Eb(b.ju);return 14===h.type&&this.otb.f7b(b)?{returnValue:!0,tableNode:h}:{returnValue:!1,tableNode:h}}wYh(b,h,n){const x=[];$d.forEachCellInTable(Object(ja.a)(md.GraphIterator,b),(E,S,ma)=>{if(S>=h&&S<=n)ma||x.push([]),Fg.TableCellReader.qg(E)||Array.add(x[S-
h],E.currentNode);else if(S>n)return!1;return!0});return x}dJl(b,h,n){const x=[];$d.forEachCellInTable(Object(ja.a)(md.GraphIterator,b),(E,S,ma)=>{ma>=h&&ma<=n&&(ma===h&&x.push([]),Fg.TableCellReader.qg(E)||Array.add(x[S],E.currentNode));return!0});return x}UTd(b){if(b&&14===b.type){b=Object(ja.a)(md.GraphIterator,this.Xc.pg(b));const h=new Qa.a;Cd.ParagraphReader.zdb(b,!0,!1,h);b=Ae.SelectionFactory.xe(h.J(h.count-1),0);this.hb.setSelection(b)}}static get characterPropertiesEditor(){return null!=
ak.yfg?ak.yfg:ak.yfg=Oa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Xy(){ak.uqa||(ak.uqa=Oa.a.instance.Pa("WordEditor.ITableBorderManager"));return ak.uqa}static get iqm(){return null!=ak.kmg?ak.kmg:ak.kmg=Oa.a.instance.resolve("Box4.List.IListReader")}static get Jo(){return null!=ak.emg?ak.emg:ak.emg=Oa.a.instance.resolve("Box4.List.IListEditor")}M8h(b,h){const n=new md.GraphIterator;n.set(b);$d.moveToFirstRow(n);$d.moveToRowByIndex(n,h);do n.currentNode.Sj(4,!0);while($d.moveToNextRow(n))}static fnf(b,
h){if(b){var n=ag.TableReader.ag(b),x=ag.TableReader.kh(b);if(!(!ob.App.xa.jb.uv.Be||0>h||h>=n))for(n=new md.GraphIterator,n.set(b),b=0;b<x;b++){b?$d.moveToNextColumn(n):$d.moveToCell(n,h,b);if(!n||!n.currentNode||16!==n.currentNode.type)continue;let E=n.currentNode;Fg.TableCellReader.Or(E)&&(E=Fg.TableCellReader.Dka(E));E&&E.Sj(4,!0)}}else w.ULS.sendTraceTag(577868247,306,15,"Can not invalidate row when there is no table node")}static enf(b,h){if(b){var n=ag.TableReader.ag(b),x=ag.TableReader.kh(b),
E=new md.GraphIterator;if(!(!ob.App.xa.jb.uv.Be||0>h||h>=x))for(x=0;x<n;x++){E.set(b);$d.moveToCell(E,x,h);if(!E||!E.currentNode)continue;let S=E.currentNode;Fg.TableCellReader.Or(S)&&(S=Fg.TableCellReader.Dka(S));S&&S.Sj(4,!0)}}else w.ULS.sendTraceTag(577868248,306,15,"Can not invalidate column when there is no table node")}}ak.uqa=null;Object(r.a)(ak,"TableEditor",Ze.a,[260,261]);class Rp{get name(){return"WordEditor.TableEditors"}zc(b){u.AFrameworkApplication.K.$("TableEditorsDelayInitializationEnabled")&&
(b.ha("WordEditor.TableEditors.TableEditor",()=>new ak(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("WordEditor.IWACTableStyleReader"),new se.a(()=>ob.App.xa.jb.Zc.Ad),b.resolve("WordEditor.ContentControl.ITableContentControlEditor"),new qm.a,kh.a.instance,b.Za("WordEditor.IFlatListEditor"),b.resolve("Box4.ContentControl.IContentControlOperator"),b.Za("Box4.ContentControlConfigSettings"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)).as("WordEditor.ITableEditor").as("Box4.ITableEditor").singleInstance(),
b.ha("WordEditor.TableEditors.TableBorderManager",()=>new hf).as("WordEditor.ITableBorderManager").singleInstance())}init(){}dispose(){}static main(){N.a.instance.Pc(new Rp)}}Object(r.a)(Rp,"WordEditorTableEditorsPackage",null,[1,2]);class lt{get name(){return"WordEditor.TextLevelEditors"}zc(){}init(){}dispose(){}static main(){N.a.instance.Pc(new lt)}}Object(r.a)(lt,"WordEditorTextLevelEditorsPackage",null,[1,2]);var wp=d(1825),eq=d(438),fu=d(750),Nn=d(223),hp=d(260);class fq{constructor(b){this.WNj=
b}bKk(){const b=mn.a.instance.createInstance(393228);b.setValue(ie.a.mK,Nn.a.first);b.setValue(ie.a.meh,0);b.setValue(ie.a.cfa,gf.OutlineReader.bwh);(new fu.OutlineIndentInfo(!0)).$Si(b);return b}m5(b,h,n=null){const x=b.currentNode;if(!b.dE(1))return this.Seb(b,null,h,n);Kf.OutlineElementReader.eK(b)&&wf.OutlineElementNavigator.uzf(b,!0);return Kf.OutlineElementReader.Nh(b)?fq.eh.XC(b,!1,h,n):(b.ZXc(x),null)}ypk(b){return gf.OutlineReader.Zqf(b.currentNode)||Kf.OutlineElementReader.Nh(b)||Kf.OutlineElementReader.eK(b)||
Fg.TableCellReader.isTableCell(b)}Seb(b,h=null,n=!1,x=null){if(!this.ypk(b))return null;const E=fq.eh.$wb();this.ULn(E,b);b.KBb(E,h,1,null);b.Ci(E);n&&(fq.eh.uN(b,x),wf.OutlineElementNavigator.ae(b));return E}ULn(b,h){if(h=this.pFl(h))switch(h.type){case 11:fq.eh.l4e(h,b,!0);break;case 8:h=fq.Ue.isRtl(h),fq.eh.jJb(b,h)}}pFl(b){return this.WNj.qFl(b)}iJb(b,h){b.setValue(ie.a.Aq,h?11:9)}KGn(b,h){const n=hp.WordSectionNavigator.instance.RL(b);return n?gf.OutlineReader.rL(b)!==h?(n.setValue(ic.a.m1e,
h),!0):!1:null}static get Ue(){return Nd.PageReader.instance}static get eh(){return fq.Kh||(fq.Kh=Oa.a.instance.resolve("Box4.IOutlineElementEditor"))}static set eh(b){fq.Kh=b}}fq.Kh=null;fq.og=null;Object(r.a)(fq,"OutlineEditor",null,[392]);const Ou=b=>{b.ha("Box4.OutlineLevelEditors.OutlineEditor",()=>new fq(b.resolve("Box4.IOutlineElementNodeIdFactory"))).as("Box4.IOutlineEditor").singleInstance();b.ha("Box4.OutlineLevelEditors.OutlineElementEditor",()=>new wp.a(b.Ye("Box4.IOutlineEditor"),b.Ye("Box4.List.IListEditor"),
b.Ye("Box4.List.IListReader"),b.resolve("Box4.ICreateParagraphStrategy"),b.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),b.resolve("Box4.IBox4GraphWriter"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.Styles.IWACStyleReader"))).as("Box4.IOutlineElementEditor").singleInstance()};class Pu{get name(){return"Box4.OutlineLevelEditors"}zc(b){Ou(b)}init(){}dispose(){}static main(){N.a.instance.Pc(new Pu)}}Object(r.a)(Pu,"Box4OutlineLevelEditorsPackage",
null,[1,2]);class jv{constructor(b){this.lxd=null;this.Ati=b.lb("OfficeOnlineChromeExtensionId");this.Gti=b.lb("ChromeClipboardAccessExtensionId");this.p8l=b.$("OfficeOnlineChromeExtensionIsEnabled");this.wZg=!this.dfm();this.lxd=this.lkb?this.Gti:this.Ati}hun(){this.lxd===this.Ati&&this.Kci&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.lxd=this.Gti;this.wZg=!0}get lkb(){return this.wZg}dfm(){if(this.p8l&&this.Kci){var b=localStorage.getItem("IsOfficeOnlineExtensionInstalled");
if(b&&"true"===b)return b=localStorage.getItem("IsCopyPasteSupported"),!!b&&"true"===b}return!1}get Kci(){let b=!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),b="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(h){w.ULS.sendTraceTag(19452045,307,50,h.toString())}return b}}Object(r.a)(jv,"ChromeExtensionHelper",null,[934]);var ds=d(1412),Mq=d(506),Bl=d(1370);
class Fo{create(b){return new Bl.a(b)}}Object(r.a)(Fo,"Factory",null,[553]);var jo=d(116);class gu{constructor(b,h,n){this.AXj=b;this.Ie=h;this.lUa=n}Vb(){this.lUa.gb(Db.a.OZd,cc.a.application,this.OZd.bind(this),96);this.lUa.pa(Db.a.Ngc,cc.a.view,this.Rjo.bind(this));this.lUa.gb(Db.a.dHi,cc.a.view,this.Sjo.bind(this),96)}OZd(b,h,n,x,E){if(1===n)return 32;b=Object.assign(new ti.a,{ExternalId:"StylesGalleryContextMenu",UpdateDynamically:!0,MenuSectionList:[]});h=[];n=Object.assign(new Fh.a,{ControlList:[]});
n.ControlList.push(Object.assign(new Pg.a,{ExternalId:"UpdateStyle",QueryCommand:"QueryUpdateStyle"}));h.push(n);Array.addRange(b.MenuSectionList,h);E.MenuItems=b;return 32}Sjo(b,h,n,x,E){if(1===n)return 32;b=Hk.a.n7i();null==b&&8;b=this.Ie.rF(b);E[nl.a.LabelText]=String.format(B.a.If(Box4Intl.Box4Strings.l_UpdateStyleCommand),b);return 32}Rjo(b,h,n){b=Hk.a.kDb(h);if(1===n||b)return b?8:32;n=new Map;n.set("Source","StyleContextMenuActor");n.set("Action","UpdateStyle");ta.Health.instance.recordKpiUsage(jo.a.omb,
0,jo.a.vB,n);this.AXj.Vjo(h)?sd.b(539842578,3018,50,"User Successfully Updated styles from UI"):(h=new Map,h.set("Source","StyleContextMenuActor"),h.set("Action","UpdateStyle"),h=Object.assign(new ab.a,{extendedProperties:h}),ta.Health.instance.recordKpiFailure(jo.a.omb,"UpdateStyleFailed",!1,!0,h),sd.b(539842780,3018,50,"User tried to update a style via UI, but we were unable to update it."));return 32}}Object(r.a)(gu,"StyleContextMenuActor",null,[]);var Ig=d(987),ko=d(1476),Et=d(469),Mv=d(1682);
class $q extends Mv.a{constructor(b,h,n,x,E,S,ma=null,Fa=null){super(b,S,ma,Fa);this._formatting=null;this.EGa=!1;this.Vob=u.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.erb=0;this.Mvc=new Qa.a;sd.a(8128527,307,Kf.OutlineElementReader.Nh(b));this.VK=h;this.VK.zXb(this);this.np=n;this.Jo=x;this.hd=E;this.FSe=Fa;this.cBe=ec.ListReader.$h(this.Bc)}get paragraphEditor(){return null!=this.Ing?this.Ing:this.Ing=Oa.a.instance.resolve("Box4.IParagraphEditor")}get fxd(){return null}get oZb(){return this.cBe&&
!this.VK.Fza}get txb(){return 0<this.erb}saa(b,h){if(!this.c0.t5f(this.Bc,h,!0)){sd.a(8701077,307,Cd.ParagraphReader.wh(this.Bc));var n=this.Bc.currentNode,x=Dd.a.iw(n);this.Vob&&this._formatting.IP&&(n=n.qa.last,this.EGa&&(n.formatting=this._formatting.IP.Yf(n),this.EGa=!1),b=this.c0.Nif(b,h),this.c0.TDa(this.Bc.currentNode,this._formatting.zaa,h));this.characterPropertiesEditor.replaceTextRange(x,b)}}HCa(){sd.a(8701078,307,Cd.ParagraphReader.wh(this.Bc));const b=Dd.a.iw(this.Bc.currentNode);this.characterPropertiesEditor.Iea(b,
h=>new Et.a(h))}Xhb(){this.c0.Sif(this.Bc)}DCa(){this.Vob&&(this.EGa=!0)}uNa(){sd.a(8701079,307,Cd.ParagraphReader.wh(this.Bc))}tNa(){sd.a(8701080,307,Cd.ParagraphReader.wh(this.Bc))}FF(b){this.VK.Fza||(this.Vob?(this.zPe(b),this._formatting.nae(this.Bc.currentNode),b&&"P"===b.T6.tKd&&this.FSe.vga(this.Bc.currentNode,this._formatting.$Ca),this.c0.TDa(this.Bc.currentNode,this._formatting.zaa,b)):this.igk(b))}EF(){this.VK.Fza||this.rEc()}zNa(){}r0a(){}KCa(){sd.a(8701081,307,Kf.OutlineElementReader.Nh(this.Bc)||
gf.OutlineReader.rw(this.Bc)||Cd.ParagraphReader.wh(this.Bc)&&this.VK.Fza);let b=!1;this.txb||(b=this.oZb||!0);b||(this.aU+=1);this.erb++}ICa(){this.erb--;let b=!1;this.txb||(b=this.oZb||!0,this.Jo.HQf(this.Mvc));b||--this.aU}yNa(b){sd.a(8701082,307,Kf.OutlineElementReader.Nh(this.Bc)||gf.OutlineReader.rw(this.Bc)||Cd.ParagraphReader.wh(this.Bc)&&this.VK.Fza);sd.a(8701083,307,!!b.listStyleType)}JCa(){sd.a(8701084,307,Kf.OutlineElementReader.Nh(this.Bc)||Cd.ParagraphReader.wh(this.Bc)&&this.VK.Fza);
this.VK.Fza||sd.a(8701085,307,this.Bc.Zp(2))}raa(b){this.VK.raa(b)}oaa(){this.VK.oaa()}Z$d(b){this.Mvc.add(b)}qaa(b){this.VK.qaa(b)}paa(){this.VK.paa()}naa(b){this.VK.naa(b)}maa(){this.VK.maa()}igk(b){this.j9b(!1);(new md.GraphIterator).fd(this.Bc);b=Mv.a.eh.uN(this.Bc,this.$Hc(b));sd.a(8128534,307,b===this.Bc.currentNode);sd.a(8128535,307,Cd.ParagraphReader.oc(b))}rEc(){sd.a(8128536,307,Cd.ParagraphReader.wh(this.Bc));wf.OutlineElementNavigator.ae(this.Bc)}reset(){this.Vob&&(super.reset(),this._formatting=
this.Obf(!0))}zPe(b){this.j9b(!1);(new md.GraphIterator).fd(this.Bc);b=Mv.a.eh.uN(this.Bc,this.$Hc(b));sd.a(36577367,307,b===this.Bc.currentNode);sd.a(36577368,307,Cd.ParagraphReader.oc(b));-1!==this._formatting.Ws&&this.paragraphEditor.lD(b,this._formatting.Ws);this._formatting.lineSpacing&&this.FSe.$B(b,this._formatting.lineSpacing);this._formatting.LI&&this.FSe.b6d(b,this._formatting.LI);this.EGa=!0;this._formatting.paragraph=b}static Nvd(b,h){let n=0;switch(h){case 3:n=Jf.a.wF(b);break;case 7:n=
mf.a.Ty(b,0);break;case 1:n=Jf.a.BUe(b);break;case 5:n=Jf.a.wF(Jf.a.iKf(b));break;default:w.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",b,h)}return n}}Object(r.a)($q,"TextOnlyBox4PasteSteward",Mv.a,[]);class Nv{constructor(b,h,n,x){this.Jgd=b;this.kG=h;this.Cf=n;this.c0=x}create(b,h,n,x,E=null,S=null,ma=null){return 1===b?new $q(h,x,this.Jgd,this.kG,this.Cf,E,S,this.c0):new ko.Box4PasteSteward(h,n,x,this.Jgd,this.kG,this.Cf,
E,S,this.c0,ma)}}Object(r.a)(Nv,"Box4PasteStewardFactory",null,[552]);var Vs=d(237),Qu=d(390),mr=d(697),gq=d(270),Ft=d(696),Nq=d(284),Oq=d(559);class Ng{static get DXl(){return Ng.YEj}static get KXl(){return Ng.bFj}static get IXl(){return Ng.aFj}static get Tg(){return null!=Ng.qgg?Ng.qgg:Ng.qgg=Rl.ContextSetEditor.instance}static get Gk(){return null!=Ng.Gpg?Ng.Gpg:Ng.Gpg=Oa.a.instance.resolve("Box4.ITableEditor")}static get aC(){return null!=Ng.xpg?Ng.xpg:Ng.xpg=Oa.a.instance.Pa("Box4.Styles.ITableCellspacingReader")}static d8m(b,
h){const n=b.currentNode;$d.forEachCell(b,h.rowSpan,h.colSpan,(x,E,S)=>{const ma=x.currentNode;ma!==n&&(ma.qg=!0,Ng.Axh(x),!S&&1<=h.colSpan&&(ma.colSpan=h.colSpan),Ng.wXi(x,h.Lga,E,S,h.rowSpan,h.colSpan))})}static N8m(b,h){$d.forEachCell(b,h.rowSpan,h.colSpan,n=>{Ng.mck(n);Ng.Axh(n)})}static mck(b){b=b.currentNode;b.qg=!0;b.v2=!0;b.qkb=!0}static Axh(b){b&&(b.Rb(1),Object(pb.a)(mr.a,b.currentNode)&&b.Fg())}static Qck(b,h,n){0<h&&(b=Object(ja.a)(Vs.TableCellNode,b.currentNode))&&(b.width=n?h:mf.a.jn(h,
0))}static vbk(b,h,n){if(b=Object(ja.a)(Qu.TableNode,b.currentNode))0<h&&(b.ge=mf.a.Ty(h,0)),0<n&&(b.Nv=mf.a.Ty(n,0))}static Ock(b,h){void 0!==h&&null!==h&&b.currentNode.properties.setValue(ic.a.Mga,Ng.KXl[h+""])}static lck(b,h){void 0!==h&&null!==h&&""!==h&&(h=parseInt(ko.Box4PasteSteward.Iwb(h),16),b.currentNode.properties.setValue(ie.a.NH,h))}static v8j(b){if(b){if(w.ULS.sendTraceTag(520890260,3022,50,"Adjusting column width after paste."),Object(Pe.a)("AdjustingColumnWidthAfterPaste",!0),16==
b.type){var h=new md.GraphIterator;h.set(b);if(h.Bb(14)){var n=fm.a(h),x=Fg.TableCellReader.LP(b);if(h.kd(14)){b=h.currentNode;var E=ag.TableReader.hea(h),S=Array.clone(E);h=ag.TableReader.LFd(h);var ma=0,Fa=0;for(var $a=0;$a<E.length;$a++)$a>=n&&$a<n+x?h[$a]>E[$a]&&(ma+=h[$a]-E[$a],S[$a]=h[$a]):Fa+=E[$a]>h[$a]?E[$a]-h[$a]:0;(null==Fa||0>=Fa||isNaN(Fa))&&w.ULS.sendTraceTag(521187336,3022,50,"spaceAvailableToShrink is invalid");(null==ma||0>=ma||isNaN(ma))&&w.ULS.sendTraceTag(521187335,3022,50,"spaceToShrink is invalid");
if(Fa<ma)for(n=0;n<E.length;n++)S[n]=h[n];else for($a=0;$a<E.length;$a++)if(($a<n||$a>=n+x)&&E[$a]>h[$a]){let sb=(E[$a]-h[$a])/Fa;S[$a]-=sb*ma;(null==S[$a]||0>=S[$a]||isNaN(S[$a]))&&w.ULS.sendTraceTag(521187334,3022,50,"Getting negative column width for scale {0}",sb)}n=qh.a.lba+(Ng.aC?Ng.aC.Jsa(b):0);for(E=0;E<S.length;E++)if(null==S[E]||0>=S[E]||isNaN(S[E]))w.ULS.sendTraceTag(521187333,3022,50,"Column width can not be negative."),S[E]=mf.a.jn(n,0);b.Fx=S}}}}else w.ULS.sendTraceTag(537997910,3022,
15,"Table cell should not be null")}static jMl(b){var h=new md.GraphIterator;h.fd(b);if((b=Te.OutlineNavigator.xTf(h))&&gf.OutlineReader.rw(h)){h=b.Og(ic.a.Ko);const n=b.Og(ic.a.marginLeft);b=b.Og(ic.a.marginRight);return h-n-b}return 0}static khm(b){return!(void 0===b||null===b||1===b)}static CFn(b,h,n,x,E){if(void 0===h||null===h||""!==h){switch(h){case "thin":h=Jf.a.EZd(.25);break;case "initial":case "medium":h=Jf.a.EZd(.5);break;case "thick":h=Jf.a.EZd(1);break;default:h=Ng.ZHl(h,n,x)}E.currentNode.properties.setValue(b,
h)}}static BFn(b,h,n){void 0!==h&&null!==h&&h&&n.currentNode.properties.setValue(b,Ng.IXl[h+""])}static zFn(b,h,n){void 0!==h&&null!==h&&""!==h&&(h=parseInt(ko.Box4PasteSteward.Iwb(h),16),n.currentNode.properties.setValue(b,h))}static ZHl(b,h,n){let x=0;const E=({unit:b}=ko.Box4PasteSteward.YTc(b)).returnValue;switch(b){case 5:x=Jf.a.EZd(E);break;case 1:x=Jf.a.ark(E);break;case 3:x=Jf.a.y5h(E);break;case 7:x=mf.a.V2m(E,n)}if(6===h||7===h||10===h)x/=3;return Math.round(x)}static $Hl(b,h){let n=0;const x=
({unit:b}=ko.Box4PasteSteward.YTc(b)).returnValue;switch(b){case 5:n=Jf.a.Fua(x);break;case 1:n=Jf.a.AUe(x);break;case 3:n=Jf.a.mBa(x);break;case 7:n=mf.a.jn(x,h)}return n}static X4d(b,h,n,x,E,S,ma){if(E&&(!ma||16===E.Se||ma||14!==E.Se)&&12!==n){if(ma)switch(x){case 5:x=ic.a.kba;var Fa=ic.a.Va;var $a=ic.a.Ta;var sb=0;break;case 4:x=ic.a.jba;Fa=ic.a.qb;$a=ic.a.ob;sb=1;break;case 0:x=ic.a.hba;Fa=ic.a.Ua;$a=ic.a.Sa;sb=0;break;case 3:x=ic.a.iba;Fa=ic.a.pb;$a=ic.a.nb;sb=1;break;default:return}else switch(x){case 5:x=
ic.a.$2a;Fa=ic.a.JPa;$a=ic.a.Zkb;sb=0;break;case 4:x=ic.a.Z2a;Fa=ic.a.IPa;$a=ic.a.Ykb;sb=1;break;case 0:x=ic.a.X2a;Fa=ic.a.GPa;$a=ic.a.Wkb;sb=0;break;case 3:x=ic.a.Y2a;Fa=ic.a.HPa;$a=ic.a.Xkb;sb=1;break;default:return}void 0!==E.currentNode&&null!==E.currentNode&&(Ng.khm(n)?(Ng.zFn(x,b,E),Ng.BFn(Fa,n,E),Ng.CFn($a,h,n,sb,E)):S||ma||E.currentNode.properties.setValue(Fa,"nil"))}}static wXi(b,h,n,x,E,S){x||(Ng.pbh(h,b,!1,!1),Ng.XPe(h,b,!0,!1));x===S-1&&Ng.XPe(h,b,!0,!1);n||Ng.Rbh(h,b,!0,!1);n===E-1&&
Ng.Yah(h,b,!0,!1)}static Xah(b,h,n,x){b&&(Ng.Rbh(b,h,n,x),Ng.XPe(b,h,n,x),Ng.Yah(b,h,n,x),Ng.pbh(b,h,n,x))}static Rbh(b,h,n,x){Ng.X4d(b.borderTopColor,b.borderTopWidth,b.borderTopStyle,5,h,n,x)}static XPe(b,h,n,x){Ng.X4d(b.borderRightColor,b.borderRightWidth,b.borderRightStyle,4,h,n,x)}static Yah(b,h,n,x){Ng.X4d(b.borderBottomColor,b.borderBottomWidth,b.borderBottomStyle,0,h,n,x)}static pbh(b,h,n,x){Ng.X4d(b.borderLeftColor,b.borderLeftWidth,b.borderLeftStyle,3,h,n,x)}static Y4d(b,h,n){if(n&&16===
n.Se&&""!==b){switch(h){case 3:h=ic.a.nEa;var x=0;break;case 2:h=ic.a.rO;x=1;break;case 0:h=ic.a.lEa;x=0;break;case 1:h=ic.a.pM;x=1;break;default:return}(b=Ng.$Hl(b,x))&&n.currentNode.properties.setValue(h,b)}}static Sak(b,h){h&&(Ng.Hck(h,b),Ng.gck(h,b),Ng.Yak(h,b),Ng.Gbk(h,b))}static Hck(b,h){Ng.Y4d(b.Vqk,3,h)}static gck(b,h){Ng.Y4d(b.Uqk,2,h)}static Yak(b,h){Ng.Y4d(b.Sqk,0,h)}static Gbk(b,h){Ng.Y4d(b.Tqk,1,h)}static cbk(b,h,n,x){var E=0;const S=Array(b.length);var ma=0;x&&(ma=(ma=Jf.a.P5f(Ng.jMl(h)))?
ma:1);for(x=0;x<b.length;x++)S[x]=0<ma?ma/100*b[x]:mf.a.jn(b[x],0),E+=S[x];b=n.getValue(ie.a.Yy);x=new md.GraphIterator;x.fd(h);h=0;if(Fg.TableCellReader.GZ(x)){if(b=$d.returnToContainingCell(x))h=b.width;ma=fm.a(x);x=$d.returnToContainingTable(x);if(-1!==ma&&ma<=x.Fx.length){let Fa=0;for(let $a=ma;$a<ma+b.colSpan&&$a<x.Fx.length;$a++)Fa+=x.Fx[$a];h=Math.min(h,Fa);h===Fa&&(h-=mf.a.jn(Ng.ZIm,0))}}else if(b)for(ma=0;ma<b.length;ma++)h+=b[ma];if(0<h&&E>h&&E)for(E=h/E,h=0;h<S.length;h++)S[h]*=E;n.setValue(ie.a.Yy,
S)}static hck(b,h){b.currentNode.setValue(ic.a.w_,mf.a.jn(h,1))}static oMn(b){var h,n;w.ULS.sendTraceTag(520890259,3022,50,"Setting selection info and bound");Object(Pe.a)("SettingTableSelectionBounds",!0);var x=b.ib,E=b.Rg;b=Ng.Tg.JP(E,16);if(E=Ng.Tg.oS(E,14))if(E=E.node,!E||14!==E.type)w.ULS.sendTraceTag(537507990,306,15,"Table node must be present");else if(!b)w.ULS.sendTraceTag(537507991,306,15,"Cell context must be present");else{if(!((null===(n=null===(h=null===x||void 0===x?void 0:x.kb)||void 0===
h?void 0:h.Ke)||void 0===n?0:n.Qa)&&x.kb.Ke.Qa.contextId===cc.a.u_&&gq.TableBorderSelectionCache.oLa()&&0<gq.TableBorderSelectionCache.oLa().length)){gq.TableBorderSelectionCache.yLc(E);h=gq.TableBorderSelectionCache.h7;h.leftMostColumnSelected=Number.MAX_SAFE_INTEGER;h.rightMostColumnSelected=Number.MIN_SAFE_INTEGER;h.topMostRowSelected=Number.MAX_SAFE_INTEGER;h.bottomMostRowSelected=Number.MIN_SAFE_INTEGER;for(n=0;n<b.length;n++){if(b.getContext(n).contextId!==cc.a.tableCell)return;x=b.getContext(n).node;
if(!Fg.TableCellReader.Or(x)){var S=new md.GraphIterator;S.set(x);if(S.Bb(14)&&$d.getContainingTable(S)===E){S.kd(14);S=Fg.TableCellReader.vAa(S,x);if(!S)return;Array.add(gq.TableBorderSelectionCache.oLa(),new Ft.a(x,S.rowIndex,S.ao,x.rowSpan,x.colSpan));h.leftMostColumnSelected=Math.min(h.leftMostColumnSelected,S.ao);h.rightMostColumnSelected=Math.max(h.rightMostColumnSelected,S.ao);h.topMostRowSelected=Math.min(h.topMostRowSelected,S.rowIndex);h.bottomMostRowSelected=Math.max(h.bottomMostRowSelected,
S.rowIndex)}}}gq.TableBorderSelectionCache.h7=h}}else w.ULS.sendTraceTag(537145810,306,15,"IP in table should be there")}static eTi(b){if(b&&14===b.type){w.ULS.sendTraceTag(520890258,3022,50,"Scaling Column Width");Object(Pe.a)("ScalingColumnWidthForCCP",!0);var h=new md.GraphIterator;h.set(b);if(h.vd()){var n=b.Fx,x=ag.TableReader.LFd(h),E=$d.returnToContainingCell(h),S=$d.getContainingTable(h);if(E&&S){var ma=fm.a(h),Fa=Fg.TableCellReader.LP(E);if(h.kd(14)){var $a=ag.TableReader.hea(h);h=0;for(let sb=
ma;sb<ma+Fa;sb++)h+=$a[sb];ma=qh.a.VP(E,S,ic.a.pM,ic.a.za,0);E=qh.a.VP(E,S,ic.a.rO,ic.a.Aa,0);h-=mf.a.jn(ma+E,0);(null==h||0>=h||isNaN(h))&&w.ULS.sendTraceTag(521187332,3022,50,"Containing cell width is invalid for cell margins {0} & {1}",ma,E);E=0;for(S=0;S<n.length;S++)E+=n[S];E=h/E;(null==E||0>=E||isNaN(E))&&w.ULS.sendTraceTag(521187331,3022,50,"scale is invalid");S=0;for(ma=0;ma<n.length;ma++)n[ma]*=E,n[ma]<x[ma]&&(n[ma]=x[ma]),S+=n[ma];S>h&&(n=Array.clone(x));x=qh.a.lba+(Ng.aC?Ng.aC.Jsa(b):0);
for(h=0;h<n.length;h++)if(null==n[h]||0>=n[h]||isNaN(n[h]))w.ULS.sendTraceTag(521187330,3022,50,"Column width is invalid for inner table"),n[h]=mf.a.jn(x,0);x=new Se.GraphTransaction(4);x.Db(b);b.Fx=n;x.dispose()}}}}else w.ULS.sendTraceTag(524932511,3022,15,"Table node should not be null")}static rsn(b){if(!b||!ag.TableReader.ysf(b)||1!=b.Hp())return w.ULS.sendTraceTag(525361986,3022,50,"Outline iterator should contain a single table"),null;w.ULS.sendTraceTag(525361987,3022,50,"Pasting table over cell selection");
Object(Pe.a)("ReplaceTableContentForExternalPaste",!0);let h=new md.GraphIterator;h.set(b.currentNode);h.Bb(14);wf.OutlineElementNavigator.He(h);let n=new md.GraphIterator;n.set(b.currentNode);n.Bb(14);if(!n.kd(14)||!h||14!=h.currentNode.type)return null;if(b=$d.getContainingTableCell(h))if(b=Fg.TableCellReader.vAa(n,b)){if(gq.TableBorderSelectionCache.oJc())var x=this.uGl();else{x=ag.TableReader.ag(h.currentNode)-(ag.TableReader.ag(n.currentNode)-b.rowIndex);var E=ag.TableReader.kh(h.currentNode)-
(ag.TableReader.kh(n.currentNode)-b.ao);this.j3j(n,x,E);x=new Nq.a(b.ao,ag.TableReader.kh(n.currentNode)-1,b.rowIndex,ag.TableReader.ag(n.currentNode)-1)}if(!x)return null;E=x.bottomMostRowSelected-x.topMostRowSelected+1;var S=x.rightMostColumnSelected-x.leftMostColumnSelected+1;E=Math.min(E,ag.TableReader.ag(h.currentNode));S=Math.min(S,ag.TableReader.kh(h.currentNode));for(let ma=0;ma<E;ma++){$d.moveToCell(n,ma+x.topMostRowSelected,x.leftMostColumnSelected);$d.moveToCell(h,ma,0);for(let Fa=0;Fa<
S;Fa++)ma==b.rowIndex-x.topMostRowSelected&&Fa==b.ao-x.leftMostColumnSelected||this.Aqi(h,n),$d.moveToNextColumn(n),$d.moveToNextColumn(h);n.at(14);h.at(14)}$d.moveToCell(n,b.rowIndex,b.ao);b.rowIndex-x.topMostRowSelected<ag.TableReader.ag(h.currentNode)&&b.ao-x.leftMostColumnSelected<ag.TableReader.kh(h.currentNode)?$d.moveToCell(h,b.rowIndex-x.topMostRowSelected,b.ao-x.leftMostColumnSelected):h=null;this.Aqi(h,n);n.at(14);$d.moveToCell(n,x.topMostRowSelected,x.leftMostColumnSelected);n.Wd();return n.currentNode}}static v1m(b){if(b&&
ag.TableReader.ysf(b)&&1==b.Hp()){w.ULS.sendTraceTag(520890257,3022,50,"Pasting table below table");Object(Pe.a)("PasteTableBelowTable",!0);var h=new md.GraphIterator;h.set(b.currentNode);b=Lf.a.$a(b.currentNode);h.qo()&&b.qo()&&(wf.OutlineElementNavigator.J2(b,!1,!0),Kf.OutlineElementReader.Nh(b)&&1==b.Hp()&&(wf.OutlineElementNavigator.He(h),wf.OutlineElementNavigator.He(b),h&&b&&h.currentNode!=b.currentNode&&ag.TableReader.isTable(h)&&ag.TableReader.isTable(b)&&this.QFm(h,b)&&(w.ULS.sendTraceTag(525361989,
3022,50,"Pasting table below table"),h.Fg(),h.Fg())))}else w.ULS.sendTraceTag(525361988,3022,50,"Outline iterator should contain a single table")}static Aqi(b,h){if(h&&Fg.TableCellReader.isTableCell(h)){var n=h.Hp();if(b&&Fg.TableCellReader.isTableCell(b)&&b.RC())for(;b.RC();)b.Wd(),h.Sf(b.currentNode,b.role),b.Fg();else n--;for(;0<n--;)h.Wd(),h.Fg()}}static QFm(b,h){if(!ag.TableReader.isTable(b)||!ag.TableReader.isTable(h))return!1;var n=ag.TableReader.kh(b.currentNode),x=ag.TableReader.kh(h.currentNode);
if(n!=x)return w.ULS.sendTraceTag(525361990,3022,50,"Number of columns in source and target table should be same"),!1;n=ag.TableReader.ag(b.currentNode);x=ag.TableReader.ag(h.currentNode);let E=new Se.GraphTransaction(4);E.Db(h.currentNode);h.currentNode.setValue(ie.a.wva,n+x);for(E.dispose();b.RC();){b.Wd();h.Sf(b.currentNode,1);n=new md.GraphIterator;n.set(b.currentNode);b.Fg();n.Wd();do n.currentNode&&16==n.currentNode.type&&(n.currentNode.oN=h.currentNode);while(n.zu())}return!0}static j3j(b,
h,n){Ng.Xwa=Oq.a.x2b;0<h&&($d.moveToLastRow(b),w.ULS.sendTraceTag(523896290,307,50,"Begin insert rows: "+h),this.Gk.insertRows(b,!1,h,this.Xwa),w.ULS.sendTraceTag(523896291,307,50,"Completed inserting rows."),b.kd(14));0<n&&(w.ULS.sendTraceTag(523896320,307,50,"Begin insert columns: "+n),this.Gk.insertColumns(b,ag.TableReader.kh(b.currentNode),!1,n,this.Xwa),w.ULS.sendTraceTag(523896321,307,50,"Completed inserting columns."))}static uGl(){return gq.TableBorderSelectionCache?gq.TableBorderSelectionCache.h7:
null}}Ng.ZIm=8;Ng.iwh="Table Grid";Ng.Xwa=null;Ng.YEj=Ia.a.z3("MsoNormalTable","Normal Table","MsoTableGrid",Ng.iwh,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3",
"Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5","MsoTable15Grid2Accent6",
"Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2","MsoTable15Grid4Accent3",
"Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5",
"MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6",
"MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1",
"List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3",
"MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4",
"MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3",
"MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5",
"List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6",
"List Table 7 Colorful Accent 6");Ng.bFj=Ia.a.z3("0","center","1","top","2","center","3","bottom");Ng.aFj=Ia.a.z3("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset");Object(r.a)(Ng,"Box4TableStewardHelper",null,[]);class hu{constructor(b,h,n){this.ly=null;this.frb=0;this.r8=null;this.Bc=b;this.Gk=n}zXb(b){this.ly=b}get Fza(){return 0<this.frb}raa(b){sd.a(7869459,307,!!this.ly);sd.a(7869460,307,Kf.OutlineElementReader.Nh(this.Bc)||
gf.OutlineReader.rw(this.Bc));sd.b(38563978,307,50,"Table pasting started");this.ly.j9b(!0);const h=new md.GraphIterator;h.fd(this.Bc);var n=Ng.DXl[b.styleId];n||(n=Ng.iwh);n=this.Gk.ghn(this.Bc,b.rowCount,b.qab,n,b.tableLook,this.ly.$Hc(b),b.U9h);b.v2f&&(sd.b(573691298,3022,100,"Applying table border properties"),Ng.Xah(b.v2f,this.Bc,!1,!0));b.dLd&&(sd.b(573691299,3022,100,"Applying indentation properties"),Ng.vbk(this.Bc,b.dLd.spaceBefore,b.dLd.spaceAfter));b.tud&&(sd.b(573691328,3022,100,"Applying column widths"),
Ng.cbk(b.tud,this.Bc,Object(ja.a)(Qu.TableNode,n),b.WZa));this.ly.brd(h,!1);this.frb++;ec.ListReader.$h(h)&&this.ly.Z$d(h.currentNode);sd.a(7869461,307,ag.TableReader.isTable(this.Bc))}oaa(){sd.a(7869462,307,!!this.ly);sd.a(7869463,307,al.a.isTableRow(this.Bc));sd.b(38563979,307,50,"Table pasting finished");this.z6&&this.Bc.at(14)&&Ng.eTi(this.Bc.xn);wf.OutlineElementNavigator.ae(this.Bc);this.frb--}qaa(b){sd.a(7869464,307,!!this.ly);sd.b(573691329,3022,100,"Table row pasting started");ag.TableReader.isTable(this.Bc)?
$d.moveToFirstRow(this.Bc):al.a.isTableRow(this.Bc)&&$d.moveToNextRow(this.Bc);b.height&&(sd.b(573691330,3022,100,"Applying table row height"),Ng.hck(this.Bc,b.height));sd.a(7869465,307,al.a.isTableRow(this.Bc))}paa(){sd.a(7869466,307,!!this.ly);sd.a(7869467,307,Fg.TableCellReader.isTableCell(this.Bc));$d.returnToContainingRow(this.Bc)}naa(b){sd.a(7869468,307,!!this.ly);sd.a(7869469,307,!this.ly.aU);al.a.isTableRow(this.Bc)?$d.moveToFirstColumn(this.Bc):Fg.TableCellReader.isTableCell(this.Bc)?$d.moveToNextColumn(this.Bc):
sd.a(7869471,307,!1);if(this.Bc.currentNode){sd.b(573691331,3022,100,"Table cell pasting started");var h=Object(ja.a)(Vs.TableCellNode,this.Bc.currentNode);sd.a(50689760,307,!h&&16!==this.Bc.currentNode.type||!!h&&16===this.Bc.currentNode.type);if(h){var n=new md.GraphIterator;n.fd(this.Bc);if(b.X6b)sd.b(573691332,3022,100,"Processing skipped cell"),Ng.N8m(n,b);else{if(1<b.colSpan||1<b.rowSpan){const x=$d.returnToContainingTable(n);if(!x)return;x.setValue(ic.a.complexTable,!0);n.fd(this.Bc);sd.b(573691333,
3022,100,"Processing merged cell");Ng.d8m(n,b);h.rowSpan=b.rowSpan;h.colSpan=b.colSpan}Ng.lck(this.Bc,b.shadingColor);Ng.Ock(this.Bc,b.verticalAlignment);Ng.Sak(this.Bc,b.E9d);Ng.Xah(b.Lga,this.Bc,!b.colSpan&&!b.rowSpan,!1);(new md.GraphIterator).fd(this.Bc);$d.forEachCell(n,b.rowSpan,b.colSpan,(x,E,S)=>{sd.b(573691334,3022,100,"Setting ghost cell borders");Ng.wXi(x,b.Lga,E,S,b.rowSpan,b.colSpan)});Ng.Qck(this.Bc,b.width,b.WZa);sd.a(7869472,307,gf.OutlineReader.rw(this.Bc))}}}}maa(){sd.a(7869473,
307,!!this.ly);sd.a(7869474,307,Kf.OutlineElementReader.Nh(this.Bc)||Fg.TableCellReader.isTableCell(this.Bc));$d.returnToCell(this.Bc);sd.a(7869475,307,0>=this.ly.aU);this.ly.AVe()}get z6(){null==this.r8&&(u.AFrameworkApplication.Hf("he991617;3eed2178"),this.r8=u.AFrameworkApplication.K?u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.r8}}Object(r.a)(hu,"Box4TableSteward",null,[576,577]);class Ws{constructor(b,h,n){this.ly=
null;this.frb=0;this.Bc=b;this.Gk=n}zXb(b){this.ly=b}get Fza(){return 0<this.frb}raa(){this.Fza&&(sd.a(8787101,307,Cd.ParagraphReader.wh(this.Bc)),wf.OutlineElementNavigator.ae(this.Bc));sd.a(8701086,307,!!this.ly);sd.a(8701087,307,Kf.OutlineElementReader.Nh(this.Bc)||gf.OutlineReader.rw(this.Bc));this.frb++}oaa(){sd.a(8701088,307,!!this.ly);wf.OutlineElementNavigator.ae(this.Bc);this.frb--;if(this.Fza){this.ly.j9b(!0);const b=Ws.eh.uN(this.Bc);sd.a(8787102,307,b===this.Bc.currentNode);sd.a(8787103,
307,Cd.ParagraphReader.wh(this.Bc))}}qaa(b){sd.a(8701089,307,!!this.ly);this.ly.j9b(!0);const h=new md.GraphIterator;h.fd(this.Bc);this.ly.brd(h,!1);ec.ListReader.$h(h)&&this.ly.Z$d(h.currentNode);b=Ws.eh.uN(this.Bc,this.ly.$Hc(b));sd.a(8701090,307,b===this.Bc.currentNode);sd.a(8701091,307,Cd.ParagraphReader.wh(this.Bc))}paa(){sd.a(8701120,307,!!this.ly);sd.a(8701121,307,Cd.ParagraphReader.wh(this.Bc));wf.OutlineElementNavigator.ae(this.Bc)}naa(){sd.a(8701122,307,!!this.ly);sd.a(8701123,307,Cd.ParagraphReader.wh(this.Bc));
sd.a(8701124,307,!this.ly.aU);var b=this.Bc.currentNode;Cd.ParagraphReader.textLength(b)&&(b=Dd.a.iw(b),this.ly.characterPropertiesEditor.replaceTextRange(b,", "))}maa(){sd.a(8701125,307,!!this.ly);sd.a(8701126,307,Cd.ParagraphReader.wh(this.Bc));sd.a(8701127,307,0>=this.ly.aU);this.ly.AVe()}static get eh(){return null!=Ws.Xmg?Ws.Xmg:Ws.Xmg=Oa.a.instance.resolve("Box4.IOutlineElementEditor")}}Object(r.a)(Ws,"TextOnlyBox4TableSteward",null,[576,577]);class yw{constructor(b,h,n=!1,x=!1){this.kG=b;this.Gw=
h;this.GOj=n;this.OOj=x}create(b,h){return 1===b?new Ws(h,this.kG,this.Gw):new hu(h,this.kG,this.Gw,this.GOj,this.OOj)}}Object(r.a)(yw,"Box4TableStewardFactory",null,[550]);class Gt{create(){return new Lf.a}}Object(r.a)(Gt,"Factory",null,[551]);class iu{constructor(b){this.ga=b}GHm(b){if(4===b)b=Db.a.kCa;else if(2===b)b=Db.a.jga;else if(1===b)b=Db.a.tLb;else if(3===b)b=Db.a.OWa;else return;this.ga.processAction(b,2)}Xbb(){this.ga.processAction(Db.a.Xbb,2)}}Object(r.a)(iu,"SelectionCommands",null,
[548]);var rs=d(262),kx=d(1053),fl=d(148),Gn=d(636);class nn{constructor(){this.dPc=!1;this.moo=u.AFrameworkApplication.K.lb("WordEditorVisiFontFileUri");this.ooo=u.AFrameworkApplication.K.lb("WordEditorVisiRtlFontFileUri");this.noo=u.AFrameworkApplication.K.lb("WordEditorVisiPilcrowFontFileUri");this.joo=u.AFrameworkApplication.K.lb("WordEditorVisiCarriageReturnFontFileUri");this.loo=u.AFrameworkApplication.K.lb("WordEditorVisiCarriageReturnRtlFontFileUri")}w7n(){this.dPc=!this.dPc}v7n(b){this.w7n();
let h=b.getElementsByClassName("VisiFontStyle")[0],n=b.getElementsByClassName("VisiFontRtlStyle")[0],x=b.getElementsByClassName("VisiFontPilcrowStyle")[0],E=b.getElementsByClassName("VisiFontCarriageReturnStyle")[0],S=b.getElementsByClassName("VisiFontCarriageReturnRtlStyle")[0];h||(h=document.createElement("Style"),h.className="VisiFontStyle",Ke.a.ey(h,""),b.appendChild(h));n||(n=document.createElement("Style"),n.className="VisiFontRtlStyle",Ke.a.ey(n,""),b.appendChild(n));x||(x=document.createElement("Style"),
x.className="VisiFontPilcrowStyle",Ke.a.ey(x,""),b.appendChild(x));E||(E=document.createElement("Style"),E.className="VisiFontCarriageReturnStyle",Ke.a.ey(E,""),b.appendChild(E));S||(S=document.createElement("Style"),S.className="VisiFontCarriageReturnRtlStyle",Ke.a.ey(S,""),b.appendChild(S));if(this.dPc)return w.ULS.sendTraceTag(593294047,324,50,"Formatting markers are inserted"),this.myc(h)&&this.myc(n)&&this.myc(x)&&this.myc(E)&&this.myc(S);w.ULS.sendTraceTag(593294046,324,50,"Formatting markers are removed");
return this.dXc(h)&&this.dXc(n)&&this.dXc(x)&&this.dXc(E)&&this.dXc(S)}myc(b){return""===Ke.a.Iz(b)?("VisiFontStyle"===b.className?Ke.a.ey(b,this.rHc("WordVisi_MSFontService",this.moo)):"VisiFontRtlStyle"===b.className?Ke.a.ey(b,this.rHc("WordVisiRtl_MSFontService",this.ooo)):"VisiFontPilcrowStyle"===b.className?Ke.a.ey(b,this.rHc("WordVisiPilcrow_MSFontService",this.noo)):"VisiFontCarriageReturnStyle"===b.className?Ke.a.ey(b,this.rHc("WordVisiCarriageReturn_MSFontService",this.joo)):"VisiFontCarriageReturnRtlStyle"===
b.className&&Ke.a.ey(b,this.rHc("WordVisiCarriageReturnRtl_MSFontService",this.loo)),!0):!1}dXc(b){return""!==Ke.a.Iz(b)?(Ke.a.ey(b,""),!0):!1}rHc(b,h){return"@font-face { font-family: "+b+"; src: url('"+h+"'); unicode-range: U+0020, U+00A0, U+200B, U+2003; font-display: swap; }"}}Object(r.a)(nn,"VisiMarkersOperation",null,[546]);var lo=d(477),Aj=d(393);class Dr extends lo.a{constructor(b,h){super(b,h);this.Dre=-1;this.Tob=0;this.yoe=null;this.bHg=!1;this.Ipe=[];this.Ycd=!1;this.fQg=!0;this.uze=this.Mad=
null;this.preventDismissOnScroll=this.e_d=this.Bac=!1;this.G5=null;this.nnd=!1;this.aKc=!0;this.ou=!1;this.mJg=u.AFrameworkApplication.K.$("FloatieLightDismissIsEnabled");Dr.eWg||(u.AFrameworkApplication.ya.pa(Ra.a.showFloatie,Ld.a.frame,pd.ActionManager.Nf),Dr.eWg=!0)}get oHh(){return this.lN}set oHh(b){this.lN=b}get eaj(){return this.nnd}get fLc(){return this.bHg}set fLc(b){this.bHg=b;this.Tob=0}get Vz(){return!0}get cssClass(){return u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.w6?
"cui-floatie MLRVisualRefresh":"cui-floatie"}get isVisible(){return this.ou}YOa(){for(let b of this.children)if(b.YOa())return!0;return!1}get f7(){return 9}Sf(b){this.Ipe[this.Ipe.length]=b;super.Sf(b)}jm(){super.jm();ff.c(this.Kc)&&this.uB();this.Kc=Vf.a.sOa(this.Kc);this.PV(this.Kc);this.dirty=!1}a$b(b){3===b.eg||this.e_d||this.Vu(b);return!1}d$b(){return!1}b$b(b){3!==b.eg&&this.aKc&&!this.Bac&&this.iio(b);return!1}c$b(){return!1}Z9b(b){3===b.eg&&this.Vu(b);return!1}$9b(b){void 0!==this.G5&&null!==
this.G5||this.preventDismissOnScroll||this.Vu(b);return!1}NB(){this.B5e();return!1}zWd(){this.fLc=!0}iio(b){if(b=Ub.a.G_b(b.clientPoint,this.yoe)){if(this.fLc){if(!this.Tob||b<this.Tob)this.Tob=b;b-=this.Tob}b-=this.Dre;0>b&&(b=0);const h=255-4*b;0>=h&&63.75<=b?this.Vu():V.a.setOpacity(this.Kc,Math.max(h/255,0))}else this.fLc=!1,this.Tob=0,V.a.setOpacity(this.Kc,1)}Ego(b){let h=null;void 0!==this.Mad&&null!==this.Mad&&(h=this.Mad(b));b=null;for(const n of this.Ipe){let x=!this.eaj&&n.Igi;if(!x&&void 0!==
h&&null!==h)for(let E=0;E<h.length;E++)if(n.id===h[E]){x=!0;break}n.Kc.style.display=x?"none":"";n.E_b=!x;x||(b=n)}b&&(b.E_b=!1)}uPh(){const b=this.Kc.style.top,h=this.Kc.style.left;this.Kc.style.top="0px";this.Kc.style.left="0px";const n=this.Izb();this.Kc.style.top=b;this.Kc.style.left=h;return n}Izb(){const b=this.Kc.style.visibility,h=this.Kc.style.display;this.Kc.style.visibility="hidden";this.Kc.style.display="";const n=rd.a.getElementBounds(this.Kc);this.Kc.style.display=h;this.Kc.style.visibility=
b;return n}OJi(b){3===b||this.U$d?(Sys.UI.DomElement.addCssClass(this.Kc,Aj.a.o3a),this.nnd=!0):(Sys.UI.DomElement.removeCssClass(this.Kc,Aj.a.o3a),this.nnd=!1);this.Ego(b)}x2a(b,h,n,x=!1){this.isVisible||(this.G5||!this.fQg&&this.preventDismissOnScroll||(this.fQg=!1,rd.a.sTd("ShowLegacyFloatie",""),u.AFrameworkApplication.ya.processAction(Ra.a.showFloatie,2)),this.OJi(n),this.aKc=!0,this.Tob=0,this.fLc=!1,!this.mJg||void 0!==this.G5&&null!==this.G5?(this.Ycd=!1,this.gda(this,!1)):(this.Ycd=!0,this.hgk(this)),
h=x?b:this.q4m(b,h),this.Kc.style.top=h.y.toString()+"px",this.Kc.style.left=h.x.toString()+"px",this.Et(),this.yoe=this.Izb(),this.Dre=Ub.a.G_b(b,this.yoe),V.a.setOpacity(this.Kc,1),this.Kc.style.zIndex=String(u.AFrameworkApplication.ua.Nqa),this.Kc.style.display="",this.ou=!0)}q4m(b,h){const n=this.eaj?30:17,x=this.uPh(),E=Ke.a.HAb(),S=Ke.a.e2();b=new Sys.UI.Point(b.x,b.y);1===h?b.y-=x.height:3===h?(b.y-=x.height,b.x-=x.width):2===h&&(b.x-=x.width);b.x+x.width>E&&(b.x=Math.floor(E-x.width));0>b.x&&
(b.x=0);b.y=3===h||1===h?b.y-n:b.y+n;0>b.y&&(b.y=0);b.y+x.height>S&&(b.y=S-x.height);return b}r4m(b,h){const n=b.fpi;if(n){this.OJi(h);var x=this.uPh();this.G5=b;b=n.Z8f-n.RFc>x.width;var E=n.RFc+n.K8e>x.width,S=n.d1b>x.height+17,ma=n.hjj-(n.d1b+n.H8e)>x.height+17;x=new Sys.UI.Point(n.RFc,n.d1b);E||b||(E=!0,x.x=n.Z8f);b=n.Agb?n.Buf?ma?E?2:0:E?3:1:S?E?3:1:E?2:0:n.Buf?ma?b?0:2:b?1:3:S?b?1:3:b?0:2;if(3===b||2===b)x.x=n.RFc+n.K8e;if(2===b||0===b)x.y=n.d1b+n.H8e;this.x2a(x,b,h);this.aKc=!1;h=this.G5.hMe.Kc;
void 0!==h&&null!==h&&(h.style.zIndex=String(u.AFrameworkApplication.ua.Nqa))}}M1(){let b=super.M1();this.Vu()&&(b=!0);return b}Vu(b=null){if(!this.isVisible)return!1;void 0!==this.oxc&&null!==this.oxc&&this.oxc.Mra(null);void 0!==this.G5&&null!==this.G5&&this.G5.qda();this.qda();this.mJg&&this.Ycd?this.K_k(this):this.Q9(this,!1);this.Ycd=!1;this.Dre=-1;this.G5=null;this.Kc.style.display="none";this.ou=!1;this.uze&&this.uze(b);return!0}B5e(){void 0!==this.G5&&null!==this.G5&&(this.G5.IUa=null,this.G5.qda(),
this.G5=null,this.KTd.style.zIndex=String(u.AFrameworkApplication.ua.oya),this.Kc.style.zIndex=String(u.AFrameworkApplication.ua.Nqa))}Ajn(b){this.Mad=b}mkn(b){this.uze=b}set Vz(b){super.Vz=b}}Dr.eWg=!1;Object(r.a)(Dr,"Floatie",lo.a,[341,282,283]);class yk{constructor(b,h){this.Nu=this.BGa=null;this.Cmi=b;this.gSi=h}get qHh(){return this.BGa}jOn(b){this.BGa=b}Izb(){return this.Nu.Izb()}EZ(){return this.Nu?this.Nu.isVisible:!1}Xdh(b){this.jOn(b)}showFloatie(b,h){this.x2a(h.location,h.Qw,h.isRtl)}x2a(b,
h,n){n=n?this.gSi:this.Cmi;this.Tzd();this.Nu&&this.Nu.x2a(b,n,h)}Vu(){this.Nu&&this.Nu.Vu()}Tzd(){this.BGa&&!this.Nu&&(this.Nu=Object(ja.a)(Dr,this.BGa()))}GAd(){}}Object(r.a)(yk,"AFloatieManager",null,[575]);class Sq extends yk{constructor(){super(1,3);this.u9i=!1;this.vxh="";this.fe=new Ge.a}Vu(){super.Vu();this.fe.raiseEvent("OnDismissedFloatie",new Sys.EventArgs)}W5j(b){this.fe.addHandler("OnDismissedFloatie",b)}Epn(b){this.fe.removeHandler("OnDismissedFloatie",b)}x2a(b,h,n){n=n?this.gSi:this.Cmi;
this.Tzd();this.Nu&&(this.Nu.isVisible&&this.Nu.Vu(),this.u9i||this.Nu.xl(),this.Nu.x2a(b,n,h,!0))}Tzd(){this.qHh&&!this.Nu&&(this.Nu=this.BGa())}GAd(){if(this.Nu&&this.Nu.isVisible){const b=Object(ja.a)($k.Control,this.Nu.controls["PasteFloatie.FlyoutAnchor"]);b.behavior.jw(b.bdb(),1,null)}}FXf(b){this.vxh=b}Jqn(b){b=b.Lbf("Menu16",null);Mg.a("renderIcon")&&b&&appChrome.api.renderIcon(Sq.yzj,b.firstElementChild)}Mgc(b,h,n){if(this.Nu){const x=this.Nu.controls[this.vxh];x&&(Sq.LIg||(this.Jqn(x),Sq.LIg=
!0),x.Nd[Bj.a.labelText]=b,x.Nd[Bj.a.alt]=h,n&&x.behavior.xl())}}}Sq.LIg=!1;Sq.yzj="Designer_20";Object(r.a)(Sq,"PasteFloatieManager",yk,[]);var zt=d(994);class pq{constructor(){this.Jd=null}get hw(){return null}getTitle(){return null}YNh(){return null}reset(b){this.Jd=b.node}DEa(b){b=Ad.d(this.Jd,b);let h=null;if(!b||b.ri!==this.ri)return{returnValue:!1,KE:h};h=Object.assign(new zt.a,{IF:this.key,contentObject:b,title:this.getTitle(b),description:this.YNh(b)});return{returnValue:!0,KE:h}}}Object(r.a)(pq,
"BlobDetailsProvider",null,[226,227]);class lj extends pq{constructor(){super()}get key(){return"EQUATION"}get ri(){return 11}get hw(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(r.a)(lj,"EquationDetailsProvider",pq,[]);class uw{constructor(){this.JGg=null}get key(){return"LINK"}get hw(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(b){this.JGg=nh.HyperlinkReader.FHc(b.node)}DEa(b){let h=null;for(const n of this.JGg)if(n.cpBegin<=b&&b<n.cpEnd)return h=Object.assign(new zt.a,
{IF:this.key,contentObject:n.hyperlink}),{returnValue:!0,KE:h};return{returnValue:!1,KE:h}}}Object(r.a)(uw,"HyperlinkDetailsProvider",null,[226,227]);var yg=d(1350),dx=d(878);class At{constructor(){this.wLg=!1}get key(){return"IFRAMENODE"}get hw(){return this.wLg?Box4Intl.Box4Strings.l_IFrameVideoTitle:Box4Intl.Box4Strings.l_IFrameWebContentTitle}qgc(b){let h=null;b=b?Cd.ParagraphReader.jdb(b.currentNode):null;if(!b)return{returnValue:!1,Sja:h};h=Object.assign(new yg.a,{IF:this.key,contentId:b.id,
contentObject:b});return{returnValue:!0,Sja:h}}Azb(b,h){b=b?Object(ja.a)(dx.a,b.contentObject):null;h=h?Object(ja.a)(dx.a,h.contentObject):null;let n="";h&&b.id===h.id||(this.wLg=b.g_a,n=String.format(Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,b.hw,this.hw));return n}}Object(r.a)(At,"IFrameDetailsProvider",null,[574,227]);class Xp extends pq{constructor(){super()}get key(){return"IMAGE"}get ri(){return 5}get hw(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(b){return Pd.ImageReader.tW(b.properties)}YNh(b){return Pd.ImageReader.dLa(b.properties)}}
Object(r.a)(Xp,"ImageDetailsProvider",pq,[]);class xg{get key(){return"IMAGENODE"}get hw(){return Box4Intl.Box4Strings.l_ImageContentTitle}qgc(b){let h=null;if(!b||!Pd.ImageReader.qw(b.currentNode))return{returnValue:!1,Sja:h};h=Object.assign(new yg.a,{IF:this.key,contentId:b.currentNode.id,contentObject:b.currentNode});return{returnValue:!0,Sja:h}}Azb(b,h){b=b.contentObject;const n=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;let x="";h&&b.id===h.contentObject.id||(x=String.format(n,Pd.ImageReader.tW(b.properties),
Box4Intl.Box4Strings.l_ImageContentTitle));return x}}Object(r.a)(xg,"ImageNodeDetailsProvider",null,[574,227]);let np,Er;class Em{constructor(b,h){this.NBg=null;this.Rm=h;this.nCe=b;this.key=Em.keys.J(b);this.hw=Em.ECk.J(b)}reset(b){this.NBg=this.Rm.Y1(b.node)}DEa(b){var h=Em.$8k(this.NBg||[],n=>this.M9l(b,n));h=this.KGk(h);return{returnValue:!!h,KE:h}}M9l(b,h){return h.begin<=b&&b<h.end&&(!h.errorDetails||this.nCe===h.errorDetails.proofingType)}KGk(b){return b?Object.assign(new zt.a,{IF:this.key,
contentObject:b.errorDetails,description:this.Zcb()}):null}Zcb(){return u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static $8k(b,h){for(const n of b)if(h(n))return n;return null}}Em.keys=(Er=new Do.a,Er.add(1,"SPELLINGERROR"),Er.add(2,"GRAMMATICALERROR"),Er.add(3,"ADVANCEDERROR"),Er);Em.ECk=(np=new Do.a,np.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),np.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),
np.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),np);Object(r.a)(Em,"ProofingDetailsProvider",null,[226,227]);class Bt{constructor(){this.tableNode=null;this.rud=this.M3d=this.columns=this.rows=0}}Object(r.a)(Bt,"TableInfo",null,[]);class vw{get key(){return"TABLE"}get hw(){return Box4Intl.Box4Strings.l_TableContentTitle}qgc(b){var h=null;if(!Fg.TableCellReader.isTableCell(b))return{returnValue:!1,Sja:h};h=new md.GraphIterator;h.fd(b);b=new Bt;b.M3d=al.a.xt(h)+1;b.rud=fm.a(h)+1;
$d.returnToContainingTable(h);b.tableNode=h.currentNode;b.columns=ag.TableReader.kh(b.tableNode);b.rows=ag.TableReader.ag(b.tableNode);h=Object.assign(new yg.a,{IF:this.key,contentId:b.tableNode.id,contentObject:b});return{returnValue:!0,Sja:h}}Azb(b,h){b=b.contentObject;const n=new qk.a;h||n.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,b.columns,b.rows));h&&h.contentObject.rud===b.rud||n.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,b.rud));h&&h.contentObject.M3d===
b.M3d||n.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,b.M3d));return n.toArray().join(" ")}}Object(r.a)(vw,"TableDetailsProvider",null,[574,227]);class bu{constructor(b,h){this.GGa=b;this.Rm=h}FPf(){this.GGa.execute(b=>{b.a3(new uw);b.a3(new Em(1,this.Rm));b.a3(new Em(2,this.Rm));b.a3(new Em(3,this.Rm));b.a3(new lj);b.a3(new Xp);b.ubc(new vw);b.ubc(new xg);b.ubc(new At)})}}Object(r.a)(bu,"AccessibilityActor",null,[]);class Gi{constructor(b,h,n){this.CXm=(x,E,S)=>{if(1===S)return 32;
this.Zuj().f_f();return 32};this.lUa=b;this.Zuj=n}Vb(){this.lUa.gb(Db.a.Izi,cc.a.view,this.CXm,1028)}}Object(r.a)(Gi,"AutoCorrectActor",null,[]);var Tk=d(1826);class eh{constructor(){this.pTd=!0}lua(){}u0a(){}zXb(){}oGf(){}v5d(){}get iac(){return!1}get uhb(){return 0}get Eoi(){return!1}get K1(){return na.a.nil}}Object(r.a)(eh,"TextOnlyBox4ImageSteward",null,[572]);class Ct{constructor(b,h,n,x,E,S,ma=!1,Fa=!1,$a=!1,sb=!1){this.hj=b;this.Hb=h;this.sm=n;this.voc=x;this.BY=E;this.n8a=ma;this.ZAe=Fa;this.dre=
$a;this.Twe=sb;this.wc=S}create(b,h,n,x){return 1===b?new eh:new Tk.a(h,this.hj,this.Hb,this.sm,this.wc,this.voc,this.BY,this.n8a,this.ZAe,this.dre,this.Twe,n,x)}}Object(r.a)(Ct,"Box4ImageStewardFactory",null,[545]);var Eh=d(45);class ex{constructor(b){this.yOd=b}Afm(b){if(!b||!b.sA||1>b.sA.count)return!1;const h=[Eh.a.Auh,Eh.a.zuh];return!!this.uDd(b.sA,1,n=>this.jvd(n,h))}zai(b){return!b||!b.sA||1>b.sA.count?!1:!!this.uDd(b.sA,1,h=>this.jvd(h,[Eh.a.ZH]))}Hcm(b){return!b||!b.sA||1>b.sA.count?!1:
!!this.uDd(b.sA,2,h=>this.jvd(h,[Eh.a.GQd]))}wh(b){return!b||!b.sA||1>b.sA.count?!1:!!this.uDd(b.sA,1,h=>this.jvd(h,[Eh.a.W2]))}ANd(b){if(!b||!b.sA)return!1;b=b.sA;for(let h=0;h<b.count;++h)if(!b.J(h)||0<b.J(h).zek)return!1;return!0}k2k(b,h){return this.zai(h)||this.Hcm(h)?"":b}uDd(b,h,n){if(b&&0<b.count)for(let x=b.count-1;0<=x;--x){if(n(b.J(x)))return b.J(x);if(b.count-x>=h)break}return null}jvd(b,h){b=b&&b.z4h?b.z4h.split(" "):null;if(!b)return!1;for(const n of h)if(0<=Array.indexOf(b,n))return!0;
return!1}}Object(r.a)(ex,"Box4PasteStewardUtils",null,[544]);var qq=d(709);class ms{constructor(){this.Mji={};this.kxd=-1}}Object(r.a)(ms,"LevelLists",null,[]);class ss{constructor(b,h,n){this.I7=this.level=0;this.QEh=null;this.aac=!1;this.level=b;this.vhc=h;this.nAi=n}}Object(r.a)(ss,"ListItemMetadata",null,[]);class ts{constructor(){this.I7=0;this.tagName="UL";this.EFc=null;this.ignore=!1;this.bSc=0}}Object(r.a)(ts,"ListMetadata",null,[]);class Yi{constructor(b){this.nodes=b;this.I1=0;this.lists=
{};this.lma=[];this.S7b=null;this.zza=[];this.zza[0]=new ms}}Object(r.a)(Yi,"WordConverterArguments",null,[]);var zk=d(1500);class Ul{constructor(b=null){this.Dfd=1;this.FV=b||zk.a.Qhf("")}get Ic(){return this.FV}process(b,h){b&&b.querySelectorAll&&(b=b.querySelectorAll("p"))&&0<b.length&&(b=new qq.a(h,Object(v.a)(this,this.$Lf,"processNodesDiscovery"),new Yi(b)),b.ll("Word Converter Operation"),b.ah=!h||h.ah,b.run())}$Lf(b,h){const n=h.nodes[h.I1];var x=Ul.Idf(n);if(x){let E=h.zza[x.level-1];E||
(E=new ms,h.zza[x.level-1]=E);h.S7b&&Ul.EIc(n)!==h.S7b&&Ul.cun(h);let S=E.Mji[x.vhc];if(!S)S=new ts,S.I7=this.Dfd++,S.EFc=Ul.qcf(n,5),S.ignore=!S.EFc||!S.EFc.length,S.tagName=Ul.wEd(S.EFc),E.Mji[x.vhc]=S,h.lists[S.I7.toString()]=S;else if(!S.ignore&&1===S.bSc){const ma=Ul.qcf(n,5);S.tagName=S.EFc===ma?"UL":"OL"}x.I7=S.I7;S.ignore||"OL"===S.tagName&&0<S.bSc&&E.kxd!==x.I7?(S.ignore=!0,h.zza[0].kxd=-1,h.zza=h.zza.slice(0,1)):(h.zza.length>x.level&&(h.zza=h.zza.slice(0,x.level)),E.kxd=x.I7,h.lma[h.lma.length]=
x,S.bSc++);h.S7b=n}else if((x=h.S7b)&&Ul.EIc(n)===x&&n.tagName===x.tagName&&n.className===x.className){x.appendChild(x.ownerDocument.createElement("BR"));for(x.appendChild(x.ownerDocument.createElement("BR"));n.firstChild;)x.appendChild(n.firstChild);n.parentNode.removeChild(n)}h.I1++;if(h.nodes.length<=h.I1){if(!h.lma.length)return!1;h.I1=0;b.si(Object(v.a)(this,this.ZLf,"processNodeConvert"))}return!0}ZLf(b,h){var n=h.lma[h.I1];b=n.nAi;const x=h.lists[n.I7.toString()];if(!x.ignore&&(n=Ul.Gzl(b,
n,x))){Ul.hAc(b,5);const E=b.ownerDocument.createElement("LI");for(;b.firstChild;)E.appendChild(b.firstChild);n.appendChild(E);b.parentNode.removeChild(b);"UL"===x.tagName?this.Ic.b++:this.Ic.c++}h.I1++;return h.I1<h.lma.length}static Gzl(b,h,n){let x=Ul.CJi(b,h.level,n);const E=hi.a.Eb(x,"UniqueListId");if(E&&E!==h.I7||!E&&x.firstChild)b=b.ownerDocument.createElement(n.tagName),x.parentNode.insertBefore(b,x.nextSibling),x=b;hi.a.Hl(x,"UniqueListId",h.I7);return Ul.tYe(x,n)}static tYe(b,h){if(h.tagName!==
b.tagName){h=b.ownerDocument.createElement(h.tagName);for(hi.a.Hl(h,"UniqueListId",hi.a.Eb(b,"UniqueListId"));b.firstChild;)h.appendChild(b.firstChild);b.parentNode.insertBefore(h,b);b.parentNode.removeChild(b);b=h}return b}static CJi(b,h,n){let x=null,E;1===h?E=Ul.EIc(b):(x=Ul.CJi(b,h-1,null),E=x.lastChild);if(E&&1===E.nodeType){const S=E.tagName.toUpperCase();if("UL"===S||"OL"===S)return E}n=b.ownerDocument.createElement(n?n.tagName:"UL");1===h?b.parentNode.insertBefore(n,b):x.appendChild(n);return n}static hAc(b,
h){for(let n=0;n<b.childNodes.length;n++){const x=b.childNodes[n];1===x.nodeType&&1<h&&Ul.hAc(x,h-1);if(Ul.Yof(x)||Ul.jNc(x))b.removeChild(x),n--}}static Idf(b){if(1===b.nodeType){const h=Ul.g3b(b,"mso-list");if(h&&0<h.length)try{const n=h.split(" ");if(3===n.length){const x=Number.parseInvariant(n[1].substr(5));return new ss(x,h,b)}}catch(n){}}return null}static wEd(b){return"o"!==b&&"\u00b7"!==b&&"\u00a7"!==b&&"-"!==b?"OL":"UL"}static qcf(b,h){let n=null;for(let x=0;!n&&x<b.childNodes.length;x++){const E=
b.childNodes[x];Ul.jNc(E)?(n="string"===typeof E.innerText?E.innerText.trim():E.textContent.trim(),n.length||(n="o")):1===E.nodeType&&1<h&&(n=Ul.qcf(E,h-1))}return n}static jNc(b){return 1===b.nodeType&&(b=Ul.g3b(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static Yof(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static g3b(b,h){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(h)){b=b.split(";");for(let n=0;n<b.length;n++){const x=b[n].split(":");
if(2===x.length&&x[0].trim()===h)return x[1].trim()}}return null}static EIc(b){do b=b.previousSibling;while(b&&Ul.QMc(b));return b}static QMc(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(Ul.wwe,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:Ul.QMc(b.firstChild):!0}static cun(b){for(let h=0;h<b.zza.length;h++){const n=b.zza[h];n&&(n.kxd=-1)}}}Ul.wwe=RegExp("[\n|\r]","gi");Object(r.a)(Ul,"WordConverter",null,[612]);class Dk{constructor(){this.I7=
0;this.k8b=Array(9)}}Object(r.a)(Dk,"FullListMetadata",null,[]);var Mp=d(1001);class fx{constructor(){this.level=0;this.tagName="UL";this.dhb=null;this.ignore=!1;this.bSc=0;this.listStyle="BulletListStyle1";this.lma=new Mp.a;this.font=this.levelText=""}}Object(r.a)(fx,"ListLevelMetadata",null,[]);var hv=d(1382),us=d(579);class Cm{constructor(b=null){this.FV=b||zk.a.Qhf("");this.Dfd=Number.parseInvariant((new Date).format("HHmmss"))}get Ic(){return this.FV}process(b,h){if(b&&b.querySelectorAll){const S=
b.querySelectorAll("p");if(S&&0<S.length){for(var n=0,x=!1,E=S[0].parentNode;5>n&&E&&E!==b;){n++;const ma=E.id.toLowerCase();if(ma&&ma.length&&-1!==ma.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(E,"WACEditing")&&Sys.UI.DomElement.containsCssClass(E,"EditingSurfaceBody")){x=!0;break}E=E.parentNode}if(x&&E!==b){n=b.firstChild;for(x=!1;0<E.children.length&&E.children[0]!==n;)b.insertBefore(E.children[0],n),x=!0;if(x)for(;n;)E=n.nextSibling,b.removeChild(n),n=E}b=new qq.a(h,Object(v.a)(this,
this.$Lf,"processNodesDiscovery"),new Yi(S));b.ll("Word Converter Operation");b.ah=!h||h.ah;b.run()}}}$Lf(b,h){const n=h.nodes[h.I1];var x=Cm.Idf(n);if(x){let S=x.vhc.replace(RegExp("level[0-9]"),"").trim();S=S&&S.length?S:x.vhc;let ma=h.lists[S];ma||(ma=new Dk,ma.I7=this.Dfd++);let Fa=ma.k8b[x.level-1];Fa||(Fa=new fx,Fa.level=x.level);var E=n.parentNode;if(E&&"li"===E.tagName.toLowerCase()){if(E=E.parentNode)!(E=E.tagName.toUpperCase())||"OL"!==E&&"UL"!==E||(Fa.tagName=E)}else Fa.dhb=Cm.ROh(n,5),
Fa.dhb&&Fa.dhb.length||(Fa.dhb=Cm.Egf(n,5)),Fa.ignore=!Fa.dhb||!Fa.dhb.length,Fa.tagName=Cm.wEd(Fa.dhb),"UL"===Fa.tagName&&(Fa.font=this.CPh(n,5));x.I7=ma.I7;Fa.bSc++;Fa.ignore||"li"===n.parentNode.tagName.toLowerCase()||(E=(E=Cm.Egf(n,5))?E:Fa.dhb)&&E.length&&(x.QEh=E,(E=Cm.HJn(n,E,Fa.listStyle,x.level-1))&&E.length&&(Fa.listStyle=E));h.lma[h.lma.length]=x;Fa.lma.contains(x)||Fa.lma.add(x);if(void 0===ma.k8b[x.level-1]||null===ma.k8b[x.level-1]||ma.k8b[x.level-1]!==Fa)ma.k8b[x.level-1]=Fa;h.lists[S]&&
h.lists[S]===ma||(h.lists[S]=ma);h.S7b=n}else if((x=h.S7b)&&Cm.EIc(n)===x&&n.tagName===x.tagName&&n.className===x.className){x.appendChild(x.ownerDocument.createElement("BR"));for(x.appendChild(x.ownerDocument.createElement("BR"));n.firstChild;)x.appendChild(n.firstChild);n.parentNode.removeChild(n)}h.I1++;if(h.nodes.length<=h.I1){if(!h.lma.length)return!1;h.I1=0;b.si(Object(v.a)(this,this.ZLf,"processNodeConvert"))}return!0}ZLf(b,h){b=h.lma[h.I1];var n=b.nAi,x=b.vhc.replace(RegExp("level[0-9]"),
"").trim();x=x&&x.length?x:b.vhc;x=h.lists[x];var E=x.k8b[b.level-1],S=n.parentNode.tagName.toLowerCase();if(!E.ignore&&n.parentNode&&"li"!==S){if(S=Cm.SIk(n,E)){Cm.hAc(n,5);const ma=n.ownerDocument.createElement("LI");ma.setAttribute("data-aria-level",String.format("{0}",b.level));ma.setAttribute(us.a.cQc,String.format("{0}",x.I7));"UL"===E.tagName&&(ma.setAttribute(us.a.PQd,String.format("{0}",b.QEh)),ma.setAttribute(us.a.ivf,String.format("{0}",E.font)));for(;n.firstChild;)ma.appendChild(n.firstChild);
S.appendChild(ma);n.parentNode.removeChild(n);"UL"===E.tagName?this.Ic.b++:this.Ic.c++}}else"li"===S&&(E=E.tagName,n=n.parentNode,b.aac&&(b=n.parentNode)&&b.tagName.toUpperCase()===E&&b.setAttribute("data-pasteFromRc","true"),n.setAttribute(us.a.cQc,String.format("{0}",x.I7)),"UL"===E?this.Ic.b++:this.Ic.c++);h.I1++;return h.I1<h.lma.length}CPh(b,h){let n=null;for(let x=0;!n&&x<b.childNodes.length;x++){const E=b.childNodes[x];n=Cm.Nql(E);!n&&1===E.nodeType&&1<h&&(n=this.CPh(E,h-1))}return n}static SIk(b,
h){b=Cm.QIk(b,h.tagName);return Cm.tYe(b,h)}static tYe(b,h){if(h.tagName!==b.tagName){for(h=b.ownerDocument.createElement(h.tagName);b.firstChild;)h.appendChild(b.firstChild);b.parentNode.insertBefore(h,b);b.parentNode.removeChild(b);b=h}return b}static QIk(b,h){h=b.ownerDocument.createElement(h?h:"UL");var n=b.getAttribute("start");n&&0<n.length&&(h.setAttribute("start",n),b.removeAttribute("start"));(n=b.className)&&0<n.length&&(n="OL"===h.tagName?hv.a.JHd(n,"NumberListStyle"):hv.a.JHd(n,"BulletListStyle"),
0<n.length&&(Sys.UI.DomElement.addCssClass(h,n),Sys.UI.DomElement.removeCssClass(b,n)));b.parentNode.insertBefore(h,b);return h}static hAc(b,h){for(let n=0;n<b.childNodes.length;n++){const x=b.childNodes[n];1===x.nodeType&&1<h&&Cm.hAc(x,h-1);if(Cm.Yof(x)||Cm.jNc(x))b.removeChild(x),n--}}static Idf(b){if(1===b.nodeType){var h=Cm.g3b(b,"mso-list");if(h&&0<h.length)try{var n=h.split(" ");if(3===n.length){const x=Number.parseInvariant(n[1].substr(5)),E=new ss(x,h,b);E.aac=!0;return E}}catch(x){}else if((n=
b.parentNode)&&"li"===n.tagName.toLocaleLowerCase()&&(h=n.getAttribute("data-"+qf.a.nrd),n=n.getAttribute(us.a.cQc),h&&n&&0<h.length&&0<n.length))return b=new ss(Number.parseInvariant(h),n+" level"+h,b),b.aac=!1,b}return null}static HJn(b,h,n,x){if("p"===b.tagName.toLowerCase()&&h&&h.length){if("UL"===Cm.wEd(h))return n=Cm.Yhl(h),Sys.UI.DomElement.addCssClass(b,n),n;var E=h.match(RegExp("^[0-9]+"));return E&&E.length?(n="NumberListStyle1",Sys.UI.DomElement.addCssClass(b,n),b.setAttribute("start",
E[0]),n):(E=h.match(RegExp("^[a-zA-Z]+")))&&E.length&&(E=E[0],x=(h=E.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&h.length?Cm.bFl(n,x):1,1!==x&&((n=Cm.Gvd(b,E,RegExp("^[ivxlcdm]+"),B.a.Xph,"NumberListStyle3"))||(n=Cm.Gvd(b,E,RegExp("^[IVXLCDM]+"),B.a.Xph,"NumberListStyle5")))||x&&((n=Cm.Gvd(b,E,RegExp("^[a-z]+"),B.a.Wph,"NumberListStyle2"))||(n=Cm.Gvd(b,E,RegExp("^[A-Z]+"),B.a.Wph,"NumberListStyle4"))))?n:"NumberListStyle1"}return null}static Yhl(b){switch(b){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";
default:return"BulletListStyle1"}}static bFl(b,h){b&&b.length||(b="");switch(b){case "NumberListStyle2":case "NumberListStyle4":b=1;break;case "NumberListStyle3":case "NumberListStyle5":b=0;break;default:b=-1}if(0>b)switch(h%3){case 0:b=0;break;case 1:b=1;break;case 2:b=0;break;default:b=0}return b}static Gvd(b,h,n,x,E){return(h=h.match(n))&&h.length?(x=x(h[0]),x=1>x?1:x,Sys.UI.DomElement.addCssClass(b,E),b.setAttribute("start",x+""),E):null}static wEd(b){return Cm.q8l(b)?"UL":"OL"}static q8l(b){return!b||
"\u00a7"===b||"\u00b7"===b||"o"===b||"-"===b||"\u00d8"===b||"v"===b||"\u00fc"===b||"\u2666"===b||"\u00a8"===b}static Egf(b,h){let n=null;var x;let E,S;for(let ma=-1;!n&&ma<b.childNodes.length;ma++){const Fa=-1===ma?b:b.childNodes[ma];if(Fa)if((x=Fa.innerHTML)&&0<x.length){if(E=x.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=E&&(S=x.indexOf("\x3c!--[endif]--\x3e"),0<=S)){x=x.substring(E,S+14);Fa.innerHTML=Fa.innerHTML.replace(x,"");if(x.length){b=b.ownerDocument.createElement("span");b.innerHTML=x;
n=b.innerText.trim();break}n&&n.length||(n="o")}}else 0<=ma&&1===Fa.nodeType&&1<h&&(n=Cm.Egf(Fa,h-1))}return n}static Nql(b){let h=null;1===b.nodeType&&((h=Cm.BPh(b,"font-family"))||(h=Cm.BPh(b,"mso-ascii-font-family")));return h}static BPh(b,h){return(b=Cm.g3b(b,h))&&0<b.length?b.trim():null}static ROh(b,h){let n=null;for(let x=0;!n&&x<b.childNodes.length;x++){const E=b.childNodes[x];Cm.jNc(E)?(n="string"===typeof E.innerText?E.innerText.trim():E.textContent.trim(),n.length||(n="o"),E.parentNode.removeChild(E)):
1===E.nodeType&&1<h&&(n=Cm.ROh(E,h-1))}return n}static jNc(b){return 1===b.nodeType&&(b=Cm.g3b(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static Yof(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static g3b(b,h){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(h)){b=b.split(";");for(let n=0;n<b.length;n++){const x=b[n].split(":");if(2===x.length&&x[0].trim()===h)return x[1].trim()}}return null}static EIc(b){do b=b.previousSibling;while(b&&
Cm.QMc(b));return b}static QMc(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(Cm.wwe,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:Cm.QMc(b.firstChild):!0}}Cm.wwe=RegExp("[\n|\r]","gi");Object(r.a)(Cm,"WacAndRichClientWordConverter",null,[612]);class Yx{constructor(b){this.lZ=b.$("ExternalPasteImprovementsEnabled")&&b.$("ListMarkerIsEnabled")}create(b=null){return this.lZ?new Cm(b):new Ul(b)}}Object(r.a)(Yx,"Box4WordConverterFactory",
null,[543]);var Sy=d(1685);class gx{constructor(b,h,n,x,E){this.HBg=0;this.Ioo=S=>{let ma=!0;const Fa=this.Ica.d1k;null!=Fa?(S.Ffa=Fa,ma=!1):Date.now()-this.HBg>this.Nie&&(w.ULS.sendTraceTag(18354843,307,50,null),this.ld.Yb(Gc.a.Aka,{["Reason"]:Mc.a.dAi}),ma=S.Ffa=!1);return ma};this.ld=b;this.te=h;this.Nie=E;this.Ica=n;this.oIa=x}otk(b,h,n){w.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",h,n,this.te.WE);b.ah&&this.te.So&&window.chrome&&w.ULS.sendTraceTag(18354842,
307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",h);this.Ica.GEc(!!(h&16));this.oIa.create(b,this.Ioo,null).ll("ClipboardPreProcess");this.HBg=Date.now()}Uun(){this.Ica.reset()}}Object(r.a)(gx,"ClipboardOperationClipboardAccessHelper",null,[542]);class ww{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd,Gd){this.lSa=null;this.ga=b;this.ld=h;this.jz=n;this.Kh=x;this.hb=E;this.Ica=S;this.fb=ma;this.Ge=Fa;this.un=$a;this.Xc=sb;this.g8a=Jb;this.dDe=
Sb;this.hA=oc;this.Xj=gd;this.vQb=Ic?Ic.$("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.ddd=Ic?Ic.$("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.wc=Gd}get eh(){return this.Kh}get Lc(){return this.ld}get GMc(){if(null==this.lSa)if(this.wc)if(this.wc.Yk.isCompleted)this.lSa=this.wc.isFeatureEnabled(33)&&this.wc.isFeatureEnabled(2);else return!1;else this.lSa=!1;return this.lSa}Doo(b){b.U_();return!0}zqh(b,h){b=h.iA;w.ULS.shipAssertTag(18130960,307,!!(b&16));if(b&256){let x=!1,E;V.a.aCa&&u.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");
this.GMc&&h.ve&&h.ve.Ug&&(x=this.Xj.Q6g(h.ve.Ug.editingElement));E=this.Xj.Vif(h.ve.Ug.editingElement,!1);var n=h.ve.Ug.editingElement;this.Xj.tnf(n,!1,1);this.vQb&&V.a.aCa?(n=h.ve.Ug.editingElement,this.Xj.YRf(n,"data-src","data-srcurl"),b=this.Ica.copy(),this.Xj.YRf(n,"data-srcurl","data-src")):this.ddd&&h.ve&&h.ve.Ug?(n=this.Xj.FUe(h.ve.Ug.editingElement,h.ve.Iw,!0),b=this.Ica.copy(),n&&this.Xj.FUe(h.ve.Ug.editingElement,h.ve.Iw,!1)):(this.Xj.cNi(h.ve.Ug.editingElement),b=this.Ica.copy());this.GMc&&
x&&this.Xj.Lon(h.ve.Ug.editingElement);E&&this.Xj.Vif(h.ve.Ug.editingElement,!0);n=h.ve.Ug.editingElement;this.Xj.tnf(n,!1,0);if(!b)return w.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),this.Lc.Yb(Gc.a.zyb,{["Reason"]:Mc.a.q2f}),h.zQ&&h.zQ.fail("SystemClipboard did not copy",!1),h.failed=!0,!1}return!0}DYe(b,h){const n=h.ve;w.ULS.shipAssertTag(18130961,307,!!(h.iA&16));h.CXn?this.jz.vlh():this.jz.Wvd(n,b);return!0}Mwh(b,h){var n=h.context,x=h.Bd;const E=h.e7;var S=!1;b=this.hb.ib.kb.Tc;
if(this.fb.gm(b)||this.Ge.sk(b)){const ma=this.Xc.pg(b.node),Fa=ma.vd();w.ULS.shipAssertTag(18130962,307,Fa);this.un.ae(ma);this.g8a.Gfb(ma)&&(S=!0)}x=h.iA&64?new qi.DictionaryPropertySet:x||new qi.DictionaryPropertySet;x.setValue(ad.a.GDc,!1);n=this.ga.Qf(n,Db.a.HG,2,!0,E,x);8===n&&(w.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Lc.Yb(Gc.a.Aka,{["Reason"]:Mc.a.Lwh}),h.zQ&&h.zQ.fail("DeleteKey failed",!1),h.failed=!0);32===n&&S&&(h=this.hb.ib.kb,this.Ge.Km(h)&&h.Qa.node===b.node&&!this.fb.textLength(h.Qa.node)&&
(h=this.Xc.pg(h.Qa.node),b=this.Ge.Gt(h),w.ULS.shipAssertTag(18130964,307,b),this.un.ae(h),this.g8a.qNd(h)||(b=this.dDe.create(),b.fd(h),this.un.J2(b,!1,!1),S=this.un.He(b),this.fb.oc(S)&&(this.un.ae(b),this.eh.merge(b,h,!1,!1),this.hb.setSelection(this.hA.xe(S,this.fb.textLength(S)))))));return!0}}Object(r.a)(ww,"ClipboardOperationCutCopy",null,[566]);class hx{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd,Gd){this.ga=b;this.ld=h;this.jz=n;this.Ica=S;this.hb=E;this.Kh=x;this.fb=ma;this.Ge=Fa;
this.un=$a;this.Xc=sb;this.g8a=Jb;this.dDe=Sb;this.hA=oc;this.Ma=Ic;this.Xj=gd;this.wc=Gd}create(){return new ww(this.ga,this.ld,this.jz,this.Kh,this.hb,this.Ica,this.fb,this.Ge,this.un,this.Xc,this.g8a,this.dDe,this.hA,this.Ma,this.Xj,this.wc)}}Object(r.a)(hx,"Factory",null,[541]);var Fv=d(1619);class Gv{constructor(b,h){this.F7c=null;this.oEk=(n,x)=>{if(!Object(pb.a)(87,x.Bd))return!1;const E=Object(ja.a)(87,x.Bd);if(!E.hasProperty(ad.a.Yhf))return!1;const S=E.getValue(ad.a.Yhf),ma=x.ve,Fa=ma.Cb;
this.jz.Vhj();Fa.wIb(()=>{Fa.setSelection(S,void 0,!0);this.jz.Wvd(ma,n)},!0);return!0};this.jz=b;this.d4=h;this.rH=0}process(b,h){this.rH||(this.F7c=[this.oEk,Object(v.a)(this.d4,this.d4.q1m,"pasteGlossaryPlaceholder")]);let n=!0;this.rH<this.F7c.length&&(n=this.F7c[this.rH++](b,h));return n?this.rH<this.F7c.length:!1}}Object(r.a)(Gv,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[569]);var cu=d(633);class Ry{constructor(b){this.$nb=null;this.f0=b;this.rH=-1}process(b,h){-1===this.rH&&
(this.cOk(b,h),this.rH=0);let n=!1;this.rH<this.$nb.length&&(n=this.$nb[this.rH++](b,h));return n?this.rH<this.$nb.length:!1}cOk(b,h){V.a.p2||h.iA&512?(this.$nb=[Object(v.a)(this.f0,this.f0.DYe,"copyInternal")],w.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):!b.ah&&h.iA&256?(this.$nb=[Object(v.a)(this.f0,this.f0.Doo,"waitBeforeCopy"),Object(v.a)(this.f0,this.f0.zqh,"copyExternal"),Object(v.a)(this.f0,this.f0.DYe,"copyInternal")],w.ULS.sendTraceTag(18158307,
307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.$nb=[Object(v.a)(this.f0,this.f0.zqh,"copyExternal"),Object(v.a)(this.f0,this.f0.DYe,"copyInternal")],w.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));h.iA&32&&(b=Object(v.a)(this.f0,this.f0.Mwh,"deleteForCut"),this.$nb.push(b),w.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));
cu.a.Dum(h)}}Object(r.a)(Ry,"ClipboardOperationCutCopyProcessor",null,[568]);class Id{constructor(b,h,n,x){this.qfd=null;this.rEk=(E,S)=>{S=S.ve;this.jz.Clo();this.jz.Wvd(S,E);return!0};this.uRc=(E,S)=>{S=new om.Selection([S.Bd],!0);this.hb.setSelection(S,E);return!0};this.jz=b;this.hb=h;this.f0=n;this.d4=x;this.rH=0}process(b,h){this.rH||(this.qfd=[this.rEk,Object(v.a)(this.f0,this.f0.Mwh,"deleteForCut"),this.uRc,Object(v.a)(this.d4,this.d4.lCi,"pasteInternal"),Object(v.a)(this.d4,this.d4.mZi,"setSelectionAfterPaste")]);
let n=!0;this.rH<this.qfd.length&&(n=this.qfd[this.rH++](b,h));return n?this.rH<this.qfd.length:!1}}Object(r.a)(Id,"ClipboardOperationMoveProcessor",null,[567]);var Hv=d(1618);class xi{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd,Gd,vd,ce){this.jz=b;this.ga=h;this.Rjc=n;this.ld=x;this.Ge=E;this.te=S;this.Hc=ma;this.a7c=Fa;this.Ywj=$a;this.QNb=sb;this.aje=Jb;this.Gjc=Sb;this.oIa=oc;this.vC=Ic;this.Hd=gd;this.sm=Gd;this.JD=vd;this.Kca=ce}create(b,h,n,x,E,S,ma,Fa,$a=!0){const sb=this.a7c.create(x,
Object(ja.a)(87,Fa));var Jb=this.Ywj.create();const Sb=new Gv(this.jz,sb),oc=new Id(this.jz,kh.a.instance,Jb,sb);Jb=new Ry(Jb);x=new Hv.a(u.AFrameworkApplication.K,ds.a.instance,x,vb.a.instance,sb,this.QNb);return new Fv.a(b,h,n,E,S,ma,Fa,this.Rjc,this.ga,this.ld,this.Ge,this.te,this.Hc,Sb,oc,Jb,x,this.QNb,this.aje,this.Gjc,this.oIa,this.vC,this.Hd,this.sm,this.JD,this.Kca,u.AFrameworkApplication.CZf(),$a)}}Object(r.a)(xi,"Factory",null,[540]);class Iv{constructor(b,h){this.PAb=b.Vcf(h);this.LYe=
b.Vll(h);this.gwb=b.Iaf(h);this.M$a=b.haf(h)}static lF(b){return Iv.lr(b)}static lr(b){return new Iv(Gn.a.instance,b)}}Object(r.a)(Iv,"CpUsageHelper",null,[]);class xw{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb){this.r8=null;this.ld=b;this.jz=h;this.Jsc=n;this.Fqa=x;this.hb=E;this.ga=S;this.Iqe=ma;this.TJe=$a;this.$Ae=Fa;this.rme=sb;this.Zie=Jb;this.Hd=Sb;this.UTg=!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("WordEditorPasteFailuresImprovementIsEnabled")}get vi(){return this.TJe.value}get ioa(){return this.Fqa}get Lc(){return this.ld}get PNa(){return this.$Ae.PNa}paste(b,
h){const n=this.Hd.jVa();try{const x=h.ve,E=h.iA;this.z6&&(this.hb&&this.hb.ib&&this.hb.ib.kb&&gq.TableBorderSelectionCache.mOn(this.hb.ib.kb.tw||this.hb.ib.kb.qDb),Ng.oMn(this.hb));w.ULS.shipAssertTag(18131010,307,!!(E&1));Object(pb.a)(87,h.Bd)&&h.Bd.setValue(Ji.a.Qda,x.Ug.editingElement.clientWidth);this.Zie.Oao(b,h);let S;if(!({xvd:S}=this.Iqe.value.Rbj()).returnValue)return this.vQc(h,"HTML import strategy failed",!1),ta.Health.instance.recordQosError("HtmlImportStrategyFailed",[cu.a.fZd],!1,
!0,!0,!1,null),!1;this.vi.xF();let ma=!0,Fa=null;const $a=this.rme.create(S),sb=h.Shj;if((!x||!x.Cb)&&this.UTg)return this.vQc(h,"Fail to set selection.",!1),ta.Health.instance.recordQosError("SetSelectionFailed",[cu.a.fZd],!1,!0,!0,!1,null),!1;x.Cb.wIb(()=>{sb&&2===this.ga.processAction(Db.a.hka,2)?ma=!1:(Fa=sb?this.hb&&this.hb.ib&&this.hb.ib.kb?this.hb.ib.kb.Qa:null:h.Bd)?(w.ULS.shipAssertTag(18158338,307,Kd.SelectionEditor.xf(Fa)),this.mli(Fa,"paste")):w.ULS.sendTraceTag(591958036,307,15,"ipContext is null. useSelection: {0}; ",
sb)},this.$Ae.eei);if(!ma)return this.vQc(h,"fail to deleteForReplace.",!0),!1;if(!Fa&&this.UTg)return this.vQc(h,"null ipContext after RunAgainstSelectionCollection.",!0),!1;if(!Fa.node||!Fa.node.isConnected)return this.vQc(h,"node is null or not connected in ip context.",!0),!1;x.editingView.disable(!0,25);$a.restore();this.Jsc.m1m(S,Fa,b);return!0}finally{n&&n.dispose()}}vQc(b,h,n){b.failed=!0;b.zQ&&b.zQ.fail(h,n)}q1m(b,h){const n=Object(ja.a)(87,h.Bd).getValue(ad.a.i0h);w.ULS.shipAssertTag(20492440,
307,Kd.SelectionEditor.xf(n));if(!this.Fkh(n,h))return!1;this.vi.xF();h=(new Zm.a).Rc(15);h.Db(this.jz.Sga);this.Jsc.r8h(n,b);this.jz.vlh();h.dispose();return!0}lCi(b,h){const n=this.hb.ib.kb.Qa;if(!this.Fkh(n,h))return!1;this.vi.xF();this.ga.processAction(Db.a.hka,2);this.mli(n,"intPaste");this.Jsc.r8h(n,b);return!0}Fkh(b,h){if(u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("AbortClipboardOperationForInvalidIpContext")){if(!b||!b.Qd)return w.ULS.sendTraceTag(595142426,307,15,"Invalid ip context. IsTouch: {0}",
!!h&&h.Gsf),h.zQ&&(h.zQ.fail("Invalid ipContext before InternalPasteAtIp",!0),h.failed=!0),!1;if(!Kd.SelectionEditor.xf(b))return w.ULS.sendTraceTag(587843167,307,15,"Ip context is not insertion point. IsTouch: {0}; contextId: {1}; ipContext.Node: {2}; ipContext.Node.Anchor: {3};",!!h&&h.Gsf,b.contextId,!!b.node,!!b.node&&!!b.node.anchor),h.zQ&&(h.zQ.fail("ipContext is not insertion point in InternalPasteAtIp",!0),h.failed=!0),!1}return!0}mli(b,h){h=Iv.lF(h);this.ioa.jfn(h,b.node,b.cpBegin);this.ioa.Fum(h.LYe);
this.ioa.fwf(h.PAb);this.ioa.Uvf(h.gwb);this.ioa.Svf(h.M$a)}mZi(b,h){if(!h.Shj)return!1;h.iA&64&&this.jz.Uhj();if(!h.fXa)return w.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Lc.Yb(Gc.a.J_,{["Reason"]:Mc.a.efb}),h.zQ&&h.zQ.fail("No selection after paste",!1),h.failed=!0,!1;this.$Ae.Wko(h);this.vi.xF();return!1}get z6(){null==this.r8&&(u.AFrameworkApplication.Hf("he991617;3eed2178"),this.r8=u.AFrameworkApplication.K?u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",
!1):!1);return this.r8}}Object(r.a)(xw,"ClipboardOperationPaste",null,[564]);class ix{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb){this.ld=b;this.jz=h;this.Jsc=n;this.Fqa=x;this.hb=E;this.ga=S;this.TJe=Fa;this.MOj=ma;this.rme=$a;this.Zie=sb;this.Hd=Jb}create(b,h){h=this.MOj.create(this.hb,h);return new xw(this.ld,this.jz,this.Jsc,this.Fqa,this.hb,this.ga,b,h,this.TJe,this.rme,this.Zie,this.Hd)}}Object(r.a)(ix,"Factory",null,[539]);var lp=d(1562);class Zx{constructor(b,h){this.n1n=b;this.m0m=h}}Object(r.a)(Zx,
"ParagraphFormatStore",null,[]);class Og{constructor(b,h,n,x){this.hb=b;this.fb=h;this.Ie=n;this.zue=x}Oao(b,h){if(h.v6b&&this.zue){h=b.Ffa;var n=this.hb.ib.kb.Qa.node,x=null;this.fb.oc(n)&&(x=this.Ie.yo(n),n=this.fb.cYa(n),x=new Zx(x,n));h=new lp.a(h.context,h.iA,h.zQ,h.e7,h.Bd,x);b.Ffa=h}}}Object(r.a)(Og,"ClipboardOperationPasteOvertypeStrategy",null,[538]);class zr{constructor(b){this.Kwe=null;this.hb=b;b.wIb(h=>{this.Kwe=h},!1)}get eei(){return!1}Wko(b){b=this.COe(b);this.setSelection(this.hb,
b)}COe(b){let h=b.fXa;(b.lQa||b.JDa)&&b.C8d&&(h=Ae.SelectionFactory.MC(b.C8d,h.Qa));return h}setSelection(b,h){b.setSelection(h)}}Object(r.a)(zr,"AClipboardOperationPasteStrategy",null,[587]);class ip extends zr{constructor(b){super(b)}get PNa(){return this.Kwe}}Object(r.a)(ip,"ClipboardOperationPasteToLiveSelectionStrategy",zr,[]);class On extends zr{constructor(b,h){super(b);this.WKe=null;this.$Kj=h;b.wIb(n=>{this.WKe=n},!0)}get eei(){return!0}get PNa(){return this.WKe}COe(b){let h=super.COe(b);
b.Bd.setValue(ad.a.pCi,h);return h=this.$Kj.TSh(this.Kwe.kb,this.WKe.kb,h)}}Object(r.a)(On,"ClipboardOperationPasteToVirtualSelectionStrategy",zr,[]);class zw{constructor(b){this.VKe=b.$("EnableVirtualSelectionInSelectionManager")}create(b,h){return h&&h.ia(ad.a.lQa,!1)&&this.VKe?new On(b,this.goo):new ip(b)}get goo(){return null!=this.erg?this.erg:this.erg=Oa.a.instance.Pa("Box4.Actors.IVirtualSelectionMerger")}}Object(r.a)(zw,"ClipboardOperationPasteStrategyFactory",null,[537]);class Ht{constructor(b,
h,n,x,E){this.ld=b;this.hb=h;this.Yj=n;this.Ok=x;this.NIj=E}C5m(b){this.NIj&&(b&1||b&32)&&this.Yj.Kp&&this.hb.SVb()}M8l(b,h){return b&1&&this.Ok.bZ(h,!0)?(this.ld.Yb(Gc.a.zf,{["Reason"]:Mc.a.UD}),!1):!0}}Object(r.a)(Ht,"ClipboardOperationWordStrategy",null,[]);class Aw{constructor(){}SDk(b,h){if(h)if(h=h.sheet)if(h=h.cssRules){var n=Array.clone(h);n.reverse();var x=h=0,E=0,S=0;for(const Fa of n){n=Fa.style;var ma=Fa.selectorText;n=n?n.cssText:null;ma=ma?ma.split(","):null;if(n&&ma&&Fa.type===Fa.STYLE_RULE){S+=
ma.length;for(const $a of ma){0<=$a.indexOf("#")&&h++;0<=$a.indexOf(".")&&x++;0>$a.indexOf("#")&&0>$a.indexOf(".")&&E++;ma=null;try{ma=b.querySelectorAll($a)}catch(sb){w.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",$a,sb.message)}if(ma)for(let sb=0;sb<ma.length;sb++)ma[sb].setAttribute("style",n+(ma[sb].getAttribute("style")||""))}}}w.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",
S,h,x,E)}else this.Wli();else this.Wli()}Wli(){w.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",V.a.WE)}}Object(r.a)(Aw,"ExternalPasteCssConverter",null,[534]);var xn=d(622),Kz=d(1066);class Lz{constructor(b){this.I1=0;this.Vlh=null;this.node=b}}Object(r.a)(Lz,"ChartConverterArguments",null,[]);class $x{constructor(b=null){this._imgNodesConverted=0;this.FV=b||zk.a.VLh("")}get Ic(){return this.FV}process(b,
h){b&&(this._imgNodesConverted=0,b.querySelectorAll&&(b=b.querySelectorAll("div"),1===b.length&&(b=new qq.a(h,this.i4k.bind(this),new Lz(b[0])),b.ll("Chart Converter Operation"),b.ah=!h||h.ah,b.run())))}i4k(b,h){var n=h.node;if(1<h.I1)return!1;if(1===n.nodeType&&"DIV"===n.tagName){const x=n.getAttribute(xn.a.vxd);if(x){const E=n.getAttribute(xn.a.M0e),S=n.getAttribute(xn.a.N0e),ma=n.getAttribute(xn.a.K0e),Fa=n.getAttribute(xn.a.L0e),$a=n.getAttribute(xn.a.GCc);n=n.getAttribute(xn.a.O0e);E&&Fa&&S&&
"chart"===S&&$a&&"XLO"===$a&&(h.Vlh=new Kz.a(x,E,S,ma,Fa,$a,n))}}b.si(this.jHm.bind(this));return!0}jHm(b,h){var n=h.node;if(b=h.Vlh)1===n.childElementCount&&1===n.firstChild.nodeType&&"IMG"===n.firstChild.tagName?(n=n.firstChild,n.setAttribute(xn.a.vxd,b.ccpId),n.setAttribute(xn.a.M0e,b.pKey),n.setAttribute(xn.a.N0e,b.type),n.setAttribute(xn.a.L0e,b.dc),n.setAttribute(xn.a.GCc,b.client),b.version&&n.setAttribute(xn.a.O0e,b.version),b.count&&n.setAttribute(xn.a.K0e,b.count),this._imgNodesConverted++):
w.ULS.sendTraceTag(541361690,307,15,"Invalid html received"),this.FV._imgNodesConverted=this._imgNodesConverted;h.I1++;return!1}}Object(r.a)($x,"ChartConverter",null,[]);var Kr=d(1149);class Ty{constructor(b,h=null,n=null){this.pf=b;this.FV=h||zk.a.lXh("");this.DVj=n||zk.a.mXh("")}get Ic(){return this.FV}get L2f(){return this.DVj}raa(b){this.L2f.b++;this.pf.raa(b)}oaa(){this.pf.oaa()}qaa(b){this.L2f.c++;this.pf.qaa(b)}paa(){this.pf.paa()}naa(b){this.L2f.d++;this.pf.naa(b)}maa(){this.pf.maa()}reset(){this.pf.reset()}get PCc(){return this.pf.PCc}saa(b,
h){this.Ic.b++;this.pf.saa(b,h)}HCa(b){this.Ic.c++;this.pf.HCa(b)}Xhb(b){this.Ic.b++;this.pf.Xhb(b)}lua(b){this.Ic.d++;this.pf.lua(b)}DCa(b){this.Ic.f++;this.pf.DCa(b)}uNa(b,h){this.Ic.g++;this.pf.uNa(b,h)}tNa(){this.pf.tNa()}FF(b){this.Ic.h++;this.pf.FF(b)}EF(){this.pf.EF()}Uhb(){this.pf.Uhb()}Thb(){this.pf.Thb()}zNa(b,h){this.Ic.i++;this.pf.zNa(b,h)}r0a(){this.pf.r0a()}KCa(b){this.Ic.j++;this.pf.KCa(b)}ICa(){this.pf.ICa()}yNa(b){this.Ic.k++;this.pf.yNa(b)}JCa(){this.pf.JCa()}u0a(b){this.Ic.l++;
this.pf.u0a(b)}}Object(r.a)(Ty,"SemanticEventUsageCollector",null,[601,577]);class rm{constructor(b,h=null,n=null,x=null){this.Exj="span p div br a img label b font i strong u em h1 h2 h3 h4 h5 h6 table tbody td tr li ol ul".split(" ");this.pf=b;this.FV=h||zk.a.AQh(V.a.Evb,"");this.nu=n;this.sTj=x?x.$("ParseStyleForHtmlTagEventIsEnabled"):!1;this.tTj=x?x.$("ParseStyleForUncommonHtmlTagEventIsEnabled"):!1;this.mxg=new kf.a(da.a.Pj());for(const E of this.Exj)this.mxg.add(E)}get Ic(){return this.FV}get Io(){return this.nu}Hh(b){return b?
b+1:1}reset(){this.pf.reset()}tVd(){this.pf.tVd()}zif(b){if(b&&this.Io&&(b.getAttribute&&(b.getAttribute(xn.a.rOk)&&(this.Io.NIh=!0),b.getAttribute(xn.a.vxd)&&(this.Io.Rbl=!0),b.getAttribute(xn.a.GCc)&&(this.Io.TVe=b.getAttribute(xn.a.GCc)),b.getAttribute(xn.a.vOk)&&(this.Io.OIh=!0)),b.id&&b.id.startsWith&&b.id.startsWith(xn.a.NOl)&&(this.Io.Tbl=!0),b.className&&b.className.split))for(const h of b.className.split(" ")){h.startsWith(xn.a.tXm)&&(this.Io.Vbl=!0);h.startsWith(xn.a.O4m)&&(this.Io.QIh=
!0);h.startsWith(xn.a.lqo)&&(this.Io.RIh=!0);if(h.startsWith(V.a.OSe)&&h.length===V.a.OSe.length+1){const n=parseInt(B.a.substring(h,h.length-1,h.length));isNaN(n)||(this.Io.DBc=n)}if(h===xn.a.tIm||h===xn.a.uIm)this.Io.LCd=!0}return this.pf.zif(b)}onClose(){this.pf.onClose()}saa(b,h){this.Io&&(this.Io.Wbl=!0);this.Ic.d=this.Hh(this.Ic.d);this.pf.saa(b,h)}kVd(b){this.Ic.e=this.Hh(this.Ic.e);this.hi(b);return this.pf.kVd(b)}vDf(b){this.Ic.f=this.Hh(this.Ic.f);this.hi(b);return this.pf.vDf(b)}wDf(b){this.Ic.g=
this.Hh(this.Ic.g);this.hi(b);return this.pf.wDf(b)}zDf(b){this.Ic.h=this.Hh(this.Ic.h);this.hi(b);return this.pf.zDf(b)}PDf(b){this.Ic.i=this.Hh(this.Ic.i);this.hi(b);return this.pf.PDf(b)}QDf(b){this.Ic.j=this.Hh(this.Ic.j);this.hi(b);this.pf.QDf(b)}sVd(b){this.Ic.k=this.Hh(this.Ic.k);this.hi(b);return this.pf.sVd(b)}RDf(b){this.Ic.l=this.Hh(this.Ic.l);this.hi(b);this.pf.RDf(b)}SDf(b){this.Ic.m=this.Hh(this.Ic.m);this.hi(b);this.pf.SDf(b)}TDf(b){this.Ic.n=this.Hh(this.Ic.n);this.hi(b);return this.pf.TDf(b)}wVd(b){this.Ic.o=
this.Hh(this.Ic.o);this.hi(b);return this.pf.wVd(b)}xVd(b){this.Ic.p=this.Hh(this.Ic.p);this.hi(b);return this.pf.xVd(b)}gEf(b){this.Ic.q=this.Hh(this.Ic.q);this.hi(b);return this.pf.gEf(b)}yVd(b){this.Ic.r=this.Hh(this.Ic.r);this.hi(b);this.pf.yVd(b)}iEf(b){this.Ic.s=this.Hh(this.Ic.s);this.hi(b);return this.pf.iEf(b)}AVd(b){this.Ic.t=this.Hh(this.Ic.t);this.hi(b);return this.pf.AVd(b)}BVd(b){this.Ic.u=this.Hh(this.Ic.u);this.hi(b);return this.pf.BVd(b)}EVd(b){this.Ic.v=this.Hh(this.Ic.v);this.hi(b);
return this.pf.EVd(b)}FVd(b){this.Ic.w=this.Hh(this.Ic.w);this.hi(b);return this.pf.FVd(b)}uEf(b){this.Ic.x=this.Hh(this.Ic.x);this.hi(b);this.pf.uEf(b)}vEf(b){this.Ic.y=this.Hh(this.Ic.y);this.hi(b);return this.pf.vEf(b)}KVd(b){this.Ic.z=this.Hh(this.Ic.z);this.hi(b);return this.pf.KVd(b)}LVd(b){this.Ic.ba=this.Hh(this.Ic.ba);this.hi(b);return this.pf.LVd(b)}PVd(b){this.Ic.bb=this.Hh(this.Ic.bb);this.hi(b);return this.pf.PVd(b)}QVd(b){this.Ic.bc=this.Hh(this.Ic.bc);this.hi(b);return this.pf.QVd(b)}SVd(b){this.Ic.bd=
this.Hh(this.Ic.bd);this.hi(b);return this.pf.SVd(b)}TVd(b){this.Ic.be=this.Hh(this.Ic.be);this.hi(b);return this.pf.TVd(b)}WVd(b){this.Ic.bf=this.Hh(this.Ic.bf);this.hi(b);return this.pf.WVd(b)}YVd(b){this.Ic.bg=this.Hh(this.Ic.bg);this.hi(b);return this.pf.YVd(b)}VEf(b){this.Ic.bh=this.Hh(this.Ic.bh);this.hi(b);return this.pf.VEf(b)}bWd(b){this.Ic.bi=this.Hh(this.Ic.bi);this.hi(b);return this.pf.bWd(b)}bFf(b){this.Ic.bj=this.Hh(this.Ic.bj);this.hi(b);return this.pf.bFf(b)}dFf(b){this.Ic.bk=this.Hh(this.Ic.bk);
this.hi(b);this.pf.dFf(b)}eFf(b){this.Ic.bl=this.Hh(this.Ic.bl);this.hi(b);return this.pf.eFf(b)}eWd(b){this.Ic.bm=this.Hh(this.Ic.bm);this.hi(b);return this.pf.eWd(b)}fWd(b){this.Ic.bm=this.Hh(this.Ic.bm);this.hi(b);return this.pf.fWd(b)}gWd(b){this.Ic.bm=this.Hh(this.Ic.bm);this.hi(b);return this.pf.gWd(b)}hWd(b){this.Ic.bm=this.Hh(this.Ic.bm);this.hi(b);return this.pf.hWd(b)}iWd(b){this.Ic.bm=this.Hh(this.Ic.bm);this.hi(b);return this.pf.iWd(b)}jWd(b){this.Ic.bm=this.Hh(this.Ic.bm);this.hi(b);
return this.pf.jWd(b)}jFf(b){this.Ic.bn=this.Hh(this.Ic.bn);return this.pf.jFf(b)}kWd(b){this.Ic.bo=this.Hh(this.Ic.bo);this.hi(b);this.pf.kWd(b)}pFf(b){this.Ic.bp=this.Hh(this.Ic.bp);return this.pf.pFf(b)}lWd(b){this.Ic.bq=this.Hh(this.Ic.bq);this.hi(b);return this.pf.lWd(b)}qFf(b){this.Ic.br=this.Hh(this.Ic.br);this.hi(b);return this.pf.qFf(b)}oWd(b){this.Io&&(this.Io.Ubl=!0);this.hi(b);this.Ic.bs=this.Hh(this.Ic.bs);this.pf.oWd(b)}wFf(b){this.Ic.bt=this.Hh(this.Ic.bt);this.hi(b);this.pf.wFf(b)}pWd(b){this.Ic.bu=
this.Hh(this.Ic.bu);this.hi(b);return this.pf.pWd(b)}CFf(b){this.Ic.bv=this.Hh(this.Ic.bv);this.hi(b);return this.pf.CFf(b)}sWd(b){this.Ic.bw=this.Hh(this.Ic.bw);this.hi(b);return this.pf.sWd(b)}tWd(b){this.Ic.bx=this.Hh(this.Ic.bx);this.hi(b);return this.pf.tWd(b)}vWd(b){this.Ic.by=this.Hh(this.Ic.by);this.hi(b);return this.pf.vWd(b)}wWd(b){this.Io&&(this.Io.LCd=!0);this.Ic.bz=this.Hh(this.Ic.bz);this.hi(b);return this.pf.wWd(b)}PFf(b){this.Ic.ca=this.Hh(this.Ic.ca);this.hi(b);this.pf.PFf(b)}SFf(b){this.Ic.cb=
this.Hh(this.Ic.cb);this.hi(b);return this.pf.SFf(b)}xWd(b){this.Io&&(this.Io.Sbl=!0);this.Ic.cc=this.Hh(this.Ic.cc);this.hi(b);return this.pf.xWd(b)}onMenuOpen(b){this.Ic.cd=this.Hh(this.Ic.cd);this.hi(b);return this.pf.onMenuOpen(b)}WFf(b){this.Ic.ce=this.Hh(this.Ic.ce);this.pf.WFf(b)}dGf(b){this.Ic.cf=this.Hh(this.Ic.cf);this.hi(b);return this.pf.dGf(b)}eGf(b){this.Ic.cg=this.Hh(this.Ic.cg);this.hi(b);return this.pf.eGf(b)}fGf(b){this.Ic.ch=this.Hh(this.Ic.ch);this.hi(b);return this.pf.fGf(b)}JWd(b){this.Io&&
(this.Io.LCd=!0);this.Ic.ci=this.Hh(this.Ic.ci);this.hi(b);return this.pf.JWd(b)}hGf(b){this.Ic.cj=this.Hh(this.Ic.cj);this.hi(b);return this.pf.hGf(b)}KWd(b){this.Ic.ck=this.Hh(this.Ic.ck);this.hi(b);return this.pf.KWd(b)}NWd(b){this.Ic.cl=this.Hh(this.Ic.cl);this.hi(b);return this.pf.NWd(b)}nGf(b){this.Ic.cm=this.Hh(this.Ic.cm);this.hi(b);this.pf.nGf(b)}TWd(b){this.Ic.cn=this.Hh(this.Ic.cn);this.hi(b);return this.pf.TWd(b)}xGf(b){this.Ic.co=this.Hh(this.Ic.co);this.hi(b);return this.pf.xGf(b)}$Wd(b){this.Ic.cp=
this.Hh(this.Ic.cp);this.hi(b);return this.pf.$Wd(b)}aXd(b){this.Ic.cq=this.Hh(this.Ic.cq);this.hi(b);return this.pf.aXd(b)}SGf(b){this.Ic.cr=this.Hh(this.Ic.cr);return this.pf.SGf(b)}YGf(b){this.Ic.cs=this.Hh(this.Ic.cs);this.hi(b);return this.pf.YGf(b)}jXd(b){this.Ic.ct=this.Hh(this.Ic.ct);this.hi(b);return this.pf.jXd(b)}kXd(b){this.Ic.cu=this.Hh(this.Ic.cu);this.hi(b);return this.pf.kXd(b)}mXd(b){this.Ic.cv=this.Hh(this.Ic.cv);this.hi(b);return this.pf.mXd(b)}nXd(b){this.Ic.cw=this.Hh(this.Ic.cw);
this.hi(b);return this.pf.nXd(b)}bHf(b){this.Ic.cx=this.Hh(this.Ic.cx);return this.pf.bHf(b)}oXd(b){this.Ic.cy=this.Hh(this.Ic.cy);this.hi(b);return this.pf.oXd(b)}qXd(b){this.Ic.cz=this.Hh(this.Ic.cz);this.hi(b);return this.pf.qXd(b)}sXd(b){this.Io&&(this.Io.p1b=!0);this.Ic.da=this.Hh(this.Ic.da);this.hi(b);return this.pf.sXd(b)}fHf(b){this.Io&&(this.Io.p1b=!0);this.Ic.db=this.Hh(this.Ic.db);this.hi(b);return this.pf.fHf(b)}cTc(b){this.Io&&(this.Io.p1b=!0);this.Ic.dc=this.Hh(this.Ic.dc);this.hi(b);
return this.pf.cTc(b)}hHf(b){this.Ic.dd=this.Hh(this.Ic.dd);this.hi(b);return this.pf.hHf(b)}iHf(b){this.Ic.de=this.Hh(this.Ic.de);this.hi(b);return this.pf.iHf(b)}vXd(b){this.Io&&(this.Io.p1b=!0);this.Ic.df=this.Hh(this.Ic.df);this.hi(b);return this.pf.vXd(b)}jHf(b){this.Io&&(this.Io.p1b=!0);this.Ic.dg=this.Hh(this.Ic.dg);this.hi(b);return this.pf.jHf(b)}mHf(b){this.Ic.dh=this.Hh(this.Ic.dh);this.hi(b);return this.pf.mHf(b)}zXd(b){this.Io&&(this.Io.p1b=!0);this.Ic.di=this.Hh(this.Ic.di);this.hi(b);
return this.pf.zXd(b)}AXd(b){this.Ic.dj=this.Hh(this.Ic.dj);this.hi(b);return this.pf.AXd(b)}BXd(b){this.Ic.dk=this.Hh(this.Ic.dk);this.hi(b);return this.pf.BXd(b)}CXd(b){this.Io&&(this.Io.LCd=!0);this.Ic.dl=this.Hh(this.Ic.dl);this.hi(b);return this.pf.CXd(b)}FXd(b){this.Ic.dm=this.Hh(this.Ic.dm);this.hi(b);return this.pf.FXd(b)}hi(b){const h=b.qf;if(h&&this.Io){var n=h.tagName.toLowerCase();if(this.sTj&&this.u$h(n)||this.tTj&&!this.u$h(n))if("font"===n&&this.b1m(b),h.style&&(b=h.style))for(const x of b)x&&
0<x.length&&this.Io.YKd(h.tagName,x)}}b1m(b){if((b=b.qf)&&"font"===b.tagName.toLowerCase()&&this.Io){var h=b.getAttribute("face");h&&0<h.length&&this.Io.YKd(b.tagName,"font-attr-face");(h=b.getAttribute("color"))&&0<h.length&&this.Io.YKd(b.tagName,"font-attr-color");(h=b.getAttribute("size"))&&0<h.length&&this.Io.YKd(b.tagName,"font-attr-size")}}u$h(b){return this.mxg.contains(b)}}Object(r.a)(rm,"HtmlEventUsageCollector",null,[618]);class Ov{constructor(b,h,n=!1){this.qf=b;this.sA=h;this.Pak=n}}Object(r.a)(Ov,
"TagEventParam",null,[]);class ay{constructor(b,h=null){this.e9c=this._prunedElements=this.GJe=this._voidElements=null;this.qd=b;this.FV=h||zk.a.BQh("");this.GNn()}get Ic(){return this.FV}kLm(b,h,n){this.GJe[h]?this.Usi():(this.Ic.e++,(h=this.e9c[h])&&h(new Ov(b,n,!1)),this.Ic.b++)}Usi(){this.Ic.d++}fLm(){this.Ic.c++}VKm(b,h,n){if(this.GJe[h])this.Usi();else{if(h=this.e9c[h])return this.Ic.b++,h(new Ov(b,n,!1));this.Ic.f++}return 2}GNn(){this._voidElements=Ia.a.z3("AREA",!0,"BASE",!0,"BASEFONT",!0,
"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.GJe=Ia.a.z3("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this._prunedElements=Ia.a.z3("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,
"TITLE",!0);const b=this.qd,h=this.qd,n=this.qd,x=this.qd,E=this.qd,S=this.qd,ma=this.qd,Fa=this.qd,$a=this.qd,sb=this.qd,Jb=this.qd,Sb=this.qd,oc=this.qd,Ic=this.qd,gd=this.qd,Gd=this.qd,vd=this.qd,ce=this.qd,od=this.qd,Yd=this.qd;this.e9c=Ia.a.z3("A",Object(v.a)(this.qd,this.qd.kVd,"onAOpen"),"ABBR",Object(v.a)(this.qd,this.qd.vDf,"onAbbrOpen"),"ACRONYM",Object(v.a)(this.qd,this.qd.wDf,"onAcronymOpen"),"ADDRESS",Object(v.a)(this.qd,this.qd.zDf,"onAddressOpen"),"APPLET",Object(v.a)(this.qd,this.qd.PDf,
"onAppletOpen"),"AREA",Object(v.a)(this.qd,this.qd.QDf,"onAreaTag"),"B",Object(v.a)(this.qd,this.qd.sVd,"onBOpen"),"BASE",Object(v.a)(this.qd,this.qd.RDf,"onBaseTag"),"BASEFONT",Object(v.a)(this.qd,this.qd.SDf,"onBasefontTag"),"BDO",Object(v.a)(this.qd,this.qd.TDf,"onBdoOpen"),"BIG",Object(v.a)(this.qd,this.qd.wVd,"onBigOpen"),"BLOCKQUOTE",Object(v.a)(this.qd,this.qd.xVd,"onBlockquoteOpen"),"BODY",Object(v.a)(this.qd,this.qd.gEf,"onBodyOpen"),"BR",Object(v.a)(this.qd,this.qd.yVd,"onBrTag"),"BUTTON",
Object(v.a)(this.qd,this.qd.iEf,"onButtonOpen"),"CAPTION",Object(v.a)(this.qd,this.qd.AVd,"onCaptionOpen"),"CENTER",Object(v.a)(this.qd,this.qd.BVd,"onCenterOpen"),"CITE",Object(v.a)(this.qd,this.qd.EVd,"onCiteOpen"),"CODE",Object(v.a)(this.qd,this.qd.FVd,"onCodeOpen"),"COL",Object(v.a)(this.qd,this.qd.uEf,"onColTag"),"COLGROUP",Object(v.a)(this.qd,this.qd.vEf,"onColgroupOpen"),"DD",Object(v.a)(this.qd,this.qd.KVd,"onDdOpen"),"DEL",Object(v.a)(this.qd,this.qd.LVd,"onDelOpen"),"DFN",Object(v.a)(this.qd,
this.qd.PVd,"onDfnOpen"),"DIR",Object(v.a)(this.qd,this.qd.QVd,"onDirOpen"),"DIV",Object(v.a)(this.qd,this.qd.SVd,"onDivOpen"),"DL",Object(v.a)(this.qd,this.qd.TVd,"onDlOpen"),"DT",Object(v.a)(this.qd,this.qd.WVd,"onDtOpen"),"EM",Object(v.a)(this.qd,this.qd.YVd,"onEmOpen"),"FIELDSET",Object(v.a)(this.qd,this.qd.VEf,"onFieldsetOpen"),"FONT",Object(v.a)(this.qd,this.qd.bWd,"onFontOpen"),"FORM",Object(v.a)(this.qd,this.qd.bFf,"onFormOpen"),"FRAME",Object(v.a)(this.qd,this.qd.dFf,"onFrameTag"),"FRAMESET",
Object(v.a)(this.qd,this.qd.eFf,"onFramesetOpen"),"H1",Object(v.a)(this.qd,this.qd.eWd,"onH1Open"),"H2",Object(v.a)(this.qd,this.qd.fWd,"onH2Open"),"H3",Object(v.a)(this.qd,this.qd.gWd,"onH3Open"),"H4",Object(v.a)(this.qd,this.qd.hWd,"onH4Open"),"H5",Object(v.a)(this.qd,this.qd.iWd,"onH5Open"),"H6",Object(v.a)(this.qd,this.qd.jWd,"onH6Open"),"HEAD",Object(v.a)(this.qd,this.qd.jFf,"onHeadOpen"),"HR",Object(v.a)(this.qd,this.qd.kWd,"onHrTag"),"HTML",Object(v.a)(this.qd,this.qd.pFf,"onHtmlOpen"),"I",
Object(v.a)(this.qd,this.qd.lWd,"onIOpen"),"IFRAME",Object(v.a)(this.qd,this.qd.qFf,"onIframeOpen"),"IMG",Object(v.a)(this.qd,this.qd.oWd,"onImgTag"),"INPUT",Object(v.a)(this.qd,this.qd.wFf,"onInputTag"),"INS",Object(v.a)(this.qd,this.qd.pWd,"onInsOpen"),"ISINDEX",Object(v.a)(this.qd,this.qd.CFf,"onIsindexOpen"),"KBD",Object(v.a)(this.qd,this.qd.sWd,"onKbdOpen"),"LABEL",Object(v.a)(this.qd,this.qd.tWd,"onLabelOpen"),"LEGEND",Object(v.a)(this.qd,this.qd.vWd,"onLegendOpen"),"LI",Object(v.a)(this.qd,
this.qd.wWd,"onLiOpen"),"LINK",Object(v.a)(this.qd,this.qd.PFf,"onLinkTag"),"MAP",Object(v.a)(this.qd,this.qd.SFf,"onMapOpen"),"MATH",Object(v.a)(this.qd,this.qd.xWd,"onMathOpen"),"MENU",Object(v.a)(this.qd,this.qd.onMenuOpen,"onMenuOpen"),"META",Object(v.a)(this.qd,this.qd.WFf,"onMetaTag"),"NOFRAMES",Object(v.a)(this.qd,this.qd.dGf,"onNoframesOpen"),"NOSCRIPT",Object(v.a)(this.qd,this.qd.eGf,"onNoscriptOpen"),"OBJECT",Object(v.a)(this.qd,this.qd.fGf,"onObjectOpen"),"OL",Object(v.a)(this.qd,this.qd.JWd,
"onOlOpen"),"OPTGROUP",Object(v.a)(this.qd,this.qd.hGf,"onOptgroupOpen"),"OPTION",Object(v.a)(this.qd,this.qd.KWd,"onOptionOpen"),"P",Object(v.a)(this.qd,this.qd.NWd,"onPOpen"),"PARAM",Object(v.a)(this.qd,this.qd.nGf,"onParamTag"),"PRE",Object(v.a)(this.qd,this.qd.TWd,"onPreOpen"),"Q",Object(v.a)(this.qd,this.qd.xGf,"onQOpen"),"S",Object(v.a)(this.qd,this.qd.$Wd,"onSOpen"),"SAMP",Object(v.a)(this.qd,this.qd.aXd,"onSampOpen"),"SCRIPT",Object(v.a)(this.qd,this.qd.SGf,"onScriptOpen"),"SELECT",Object(v.a)(this.qd,
this.qd.YGf,"onSelectOpen"),"SMALL",Object(v.a)(b,b.jXd,"onSmallOpen"),"SPAN",Object(v.a)(h,h.kXd,"onSpanOpen"),"STRIKE",Object(v.a)(n,n.mXd,"onStrikeOpen"),"STRONG",Object(v.a)(x,x.nXd,"onStrongOpen"),"STYLE",Object(v.a)(E,E.bHf,"onStyleOpen"),"SUB",Object(v.a)(S,S.oXd,"onSubOpen"),"SUP",Object(v.a)(ma,ma.qXd,"onSupOpen"),"TABLE",Object(v.a)(Fa,Fa.sXd,"onTableOpen"),"TBODY",Object(v.a)($a,$a.fHf,"onTbodyOpen"),"TD",Object(v.a)(sb,sb.cTc,"onTdOpen"),"TEXTAREA",Object(v.a)(Jb,Jb.hHf,"onTextareaOpen"),
"TFOOT",Object(v.a)(Sb,Sb.iHf,"onTfootOpen"),"TH",Object(v.a)(oc,oc.vXd,"onThOpen"),"THEAD",Object(v.a)(Ic,Ic.jHf,"onTheadOpen"),"TITLE",Object(v.a)(gd,gd.mHf,"onTitleOpen"),"TR",Object(v.a)(Gd,Gd.zXd,"onTrOpen"),"TT",Object(v.a)(vd,vd.AXd,"onTtOpen"),"U",Object(v.a)(ce,ce.BXd,"onUOpen"),"UL",Object(v.a)(od,od.CXd,"onUlOpen"),"VAR",Object(v.a)(Yd,Yd.FXd,"onVarOpen"))}}Object(r.a)(ay,"AHtmlProcessor",null,[]);class mt{constructor(b,h){this.childNodes=b.childNodes;this.sA=h;this.Y_e=0;this.bNd=!1}}
Object(r.a)(mt,"HtmlProcessorArguments",null,[]);var by=d(1E3);class ju extends ay{constructor(b,h=null){super(b,h);this.Fte=null}get Xfm(){null==this.Fte&&(this.Fte=u.AFrameworkApplication.K?u.AFrameworkApplication.K.$("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.Fte}process(b,h=null){b&&(this.qd.reset(),this.jFi(new mt(b,new Mp.a),h))}jFi(b,h){b.childNodes.length&&(b=new qq.a(h,Object(v.a)(this,this.B7m,"processChild"),b),b.ll("HTML Processing Operation"),h||(b.ah=!0),b.run())}B7m(b,
h){const n=h.childNodes[h.Y_e];if(3===n.nodeType)return this.qd.tVd(),this.qd.saa(n.nodeValue,new Ov(n,h.sA.kNh())),ju.ygc(h);if(1!==n.nodeType)return ju.ygc(h);if(!h.bNd){const E=B.a.Tz(n.tagName);if(!ju.HTl(n))if(this._prunedElements[E])this.fLm();else{ju.FCm(n);this.qd.tVd();var x=n.id;const S=n.tagName,ma=h.sA.kNh(),Fa=n.getAttribute?n.getAttribute("class"):null;x=new by.a(x,S,Fa?Fa:"",n.attributes?n.attributes.length:0);x.Qd&&ma.add(x);if(this._voidElements[E])return this.kLm(n,E,ma),ju.ygc(h);
x=!1;switch(this.VKm(n,E,ma)){case 1:x=!0;break;case 3:return ju.ygc(h)}switch(this.qd.zif(n)){case 1:x=!0}h.bNd=x;this.jFi(new mt(n,ma),b);if(!b.ah)return!0}}if(h.bNd){if(this.Xfm&&!this.e9c[B.a.Tz(n.tagName)])return ju.ygc(h);this.qd.onClose()}return ju.ygc(h)}static FCm(b){3!==b.nodeType&&hi.a.Hl(b,"alreadyPasted",!0)}static HTl(b){return 3!==b.nodeType&&hi.a.Eb(b,"alreadyPasted")}static ygc(b){b.Y_e++;b.bNd=!1;return b.Y_e<b.childNodes.length}}Object(r.a)(ju,"HtmlProcessor",ay,[]);var Uy=d(1886);
class Vy{constructor(){this.iA=0;this.DBc=6;this.Rbl=this.NIh=!1;this.TVe=null;this.RIh=this.QIh=this.Vbl=this.Tbl=this.OIh=!1;this.progId=null;this.Ubl=this.p1b=this.LCd=this.Sbl=this.Wbl=!1;this.C1m=this.Y$b=0;this.UHf=this.platform=null;this.ypb={}}get a0f(){if(null!==this.TVe)switch(this.TVe){case "XLO":return"Excel Online"}if(this.RIh)return"Word Online";if(this.QIh||this.OIh)return"PowerPoint Online";if(this.NIh)return"Excel Online";switch(this.progId){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";
case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}Yvm(){w.ULS.sendTraceTag(51406241,307,50,JSON.stringify(this.hkk()))}Zvm(){const b=this.ypb;for(const n in b){var h=n;const x=b[n];x&&(x.SourceApp=this.a0f,x.Browser=Uy.a[this.Y$b],x.TagName=h,x.OperationId=this.UHf,w.ULS.sendTraceTag(51406242,307,50,JSON.stringify(x)))}}YKd(b,h){b&&b.length&&h&&h.length&&(b=b.toLowerCase(),h=h.toLowerCase(),b in this.ypb||(this.ypb[b]={}),this.ypb[b][h]=this.jIl(b,h)+1)}jIl(b,
h){if(!(b&&b.length&&h&&h.length&&this.ypb&&b in this.ypb))return 0;b=b.toLowerCase();h=h.toLowerCase();return(b=this.ypb[b])&&h in b?b[h]:0}hkk(){const b={};b.ActionIdFlags=this.iA;b.SourceApp=this.a0f;b.CopySourceBrowser=this.DBc;b.PasteBrowser=this.Y$b;b.IsSameBrowserPaste=this.Ohm(this.DBc,this.Y$b);b.IsCrossBrowserPaste=this.Q9l(this.DBc,this.Y$b);b.IsUncategorizedBrowserPaste=this.zkm(this.DBc,this.Y$b);b.Platform=this.platform;b.OperationId=this.UHf;return b}Ohm(b,h){return 5===b||6===b?!1:
b===h}Q9l(b,h){return 6===b?!1:b!==h}zkm(b,h){return 5===b&&5===h}}Object(r.a)(Vy,"HtmlContentMetadata",null,[]);var Pv=d(1884),cy=d(1010),nr=d(312),bo=d(231),Ro=d(1620),vs=d(142);class sm{constructor(b,h,n,x,E,S){this.SKg=!1;this.P$i=this.Mse=null;this.JBa=b;this.P8e=this.TNa=null;this.Ri=h;this.transaction=n;this.fY=x;this.mt=E;this.B4=S}get Gj(){return null!=this.hpg?this.hpg:this.hpg=Oa.a.instance.Pa("Box4.Styles.StyleSettings")}get K(){return u.AFrameworkApplication.K}get aBe(){return!!this.K&&
this.K.$("PasteTextOnlyKeepDestinationStyleIsEnabled")}get sPj(){return!!this.K&&this.K.$("PreserveEopFormattingPasteIsEnabled")}get kF(){return null!=this.Eig?this.Eig:this.Eig=Oa.a.instance.resolve("Box4.IFontStylesGalleryCache")}get isProgressiveStyleEnabled(){return this.Gj&&this.Gj.isProgressiveStyleEnabled}get ZQ(){return null!=this.jrg?this.jrg:this.jrg=Oa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get pc(){return null!=this.Org?this.Org:this.Org=Oa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get paragraphEditor(){return null!=
this.Qng?this.Qng:this.Qng=Oa.a.instance.resolve("Box4.IParagraphEditor")}get hd(){return null!=this.ymg?this.ymg:this.ymg=Oa.a.instance.resolve("Box4.List.IListReader")}get Jo(){return null!=this.hmg?this.hmg:this.hmg=Oa.a.instance.resolve("Box4.List.IListEditor")}get xkb(){return null!=this.Mog?this.Mog:this.Mog=Oa.a.instance.Pa("Box4.List.ISingleLevelListEditor")}get Hk(){return null!=this.oqg?this.oqg:this.oqg=Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Ph(){return null!=
this.Uqg?this.Uqg:this.Uqg=Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}get Rd(){return null!=this.zqg?this.zqg:this.zqg=Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get VV(){return null!=this.vfg?this.vfg:this.vfg=Oa.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get xJf(){return null!=this.cog?this.cog:this.cog=Oa.a.instance.Pa("Box4.IPastedParagraphSpaceHandler")}get zCi(){return!1}get b1i(){return this.K.$("WordEditorAutoResizeImageIsEnabled")}ZDh(){}get TMc(){return!1}oCi(b){var h=
void 0===this.Ri.iA||null===this.Ri.iA?"not available":Object(Pv.a)(Ro.a,this.Ri.iA);w.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.Ri.iA,h);w.ULS.shipAssertTag(6305487,307,Kd.SelectionEditor.xf(this.JBa));if(this.OUd)return w.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.Ri.fXa=Ae.SelectionFactory.Kn(this.JBa),b.si(Object(v.a)(this,this.vib,"pasteTeardown")),!0;if(!this.JBa.node)return w.ULS.sendTraceTag(572330334,307,10,"Something's wrong! The IP is pointing to a null node. Aborting paste"),
!1;h=new md.GraphIterator;h.set(this.JBa.node);Kd.SelectionEditor.Gt(h);wf.OutlineElementNavigator.ae(h);this.P$i=h.origin;if(this.zCi)return h.at(10),this.ZDh(h,b),b.si(Object(v.a)(this,this.mMn,"setSelectionAfterPastingOutlines")),!0;this.fY&&this.fY.ANm(this.JBa);if(!this.GZn(this.JBa))return this.Ri.zQ&&(this.Ri.zQ.fail("SplitLine Failed",!0),this.Ri.failed=!0),this.Ri.fXa=Ae.SelectionFactory.Kn(this.JBa),b.si(Object(v.a)(this,this.vib,"pasteTeardown")),!0;const n=new Lf.a;n.fd(h);wf.OutlineElementNavigator.Rr(n,
!1,!1);this.TNa=new cy.a(h);this.P8e=new cy.a(n);b.si(Object(v.a)(this,this.p1m,"pasteExecution"));return!0}p1m(b){ue.a.mark(5568);this.YDh(b);let h=Object(v.a)(this,this.ZEm,"mergeAfterPaste");if(this.$ci){const n=this.a2i();n&&(h=Object(v.a)(this,this.vib,"pasteTeardown"));w.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",n)}b.si(h);return!0}a2i(){return!1}get $ci(){return this.K.$("PptCcpFix2IsEnabled")}get ZQn(){return this.K.$("CopyAndPasteOneParagraphIndentationFixIsEnabled")}ZEm(b){ue.a.mark(5569);
var h=new md.GraphIterator;this.TNa.restore(h);sm.z6||(this.TNa=null);var n=new md.GraphIterator;this.P8e.restore(n);this.P8e=null;w.ULS.shipAssertTag(6305489,307,Kf.OutlineElementReader.Nh(h));w.ULS.shipAssertTag(6305490,307,Kf.OutlineElementReader.Nh(n));wf.OutlineElementNavigator.He(h);var x=Cd.ParagraphReader.wh(h)?Cd.ParagraphReader.textLength(h.currentNode):0;wf.OutlineElementNavigator.ae(h);wf.OutlineElementNavigator.He(n);w.ULS.shipAssertTag(6305491,307,Cd.ParagraphReader.wh(n));var E=Cd.ParagraphReader.textLength(n.currentNode);
wf.OutlineElementNavigator.ae(n);let S=this.r_c;var ma=new Lf.a;ma.fd(h);wf.OutlineElementNavigator.Rr(ma,!1,!1);var Fa=ma.currentNode===n.currentNode,$a=!!this.Ri&&!!(this.Ri.iA&8192);let sb=!1;!$a&&this.Ri.Bd&&Object(pb.a)(qi.DictionaryPropertySet,this.Ri.Bd)&&($a=($a=this.Ri.Bd.Og(ad.a.eac))&&""!==$a?!0:!1);if(Fa){x=md.GraphIterator.$a(h.currentNode);Cd.ParagraphReader.uu(wf.OutlineElementNavigator.He(x))||(h=n);h.currentNode.id!==n.currentNode.id&&(w.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",
ec.ListReader.$h(h),ec.ListReader.$h(n)),$a=sm.eh.merge(h,n,!0,$a),w.ULS.shipAssertTag(6305492,307,$a));n=h;var Jb=!0}else{Fa=!!(this.Ri.iA&4);Jb=this.Rd.wg&&Fa&&this.Ri.zZa;this.xJf&&this.Ri&&!Fa&&(this.xJf.G1h(h,!1),this.xJf.G1h(n,!0));wf.OutlineElementNavigator.He(ma);Fa=Cd.ParagraphReader.wh(ma)?Cd.ParagraphReader.textLength(ma.currentNode):0;wf.OutlineElementNavigator.ae(ma);this.Jck(ma,h,n);var Sb=new Lf.a;Sb.fd(ma);wf.OutlineElementNavigator.Rr(Sb,!1,!1);sm.z6&&Sb.currentNode.id===n.currentNode.id&&
(this.SKg=!0);if(this.VV.jJa||this.ZQn)if(Sb.xn.id!==n.xn.id){for(;ma.currentNode.id!==n.currentNode.id;)wf.OutlineElementNavigator.He(ma,!1),this.VV.PDa(Dd.a.create(ma.currentNode)),ma.nc(),wf.OutlineElementNavigator.Rr(ma,!1,!1);ma.fd(h);wf.OutlineElementNavigator.Rr(ma,!1,!1)}else sb=!0;this.fY&&({r_c:S,psa:ma}=this.fY.t8m(h,n,S,ma));if(this.Ri.U2d&&(w.ULS.shipAssertTag(6305493,307,this.Ri.v6b),Sb=new md.GraphIterator,Sb.fd(ma),Sb=wf.OutlineElementNavigator.He(Sb))){var oc=this.Ri.U2d.Yf(Sb.qa.J(0));
Sb.qa.J(0).formatting=oc}Sb=0;$a&&this.aBe&&(Sb=1);oc=this.vRn(h,ma,Sb);this.Ri.C8d=null;if(this.Ri.JDa||this.Ri.lQa)this.Ri.C8d=this.QHl(oc?h.currentNode:ma.currentNode,oc);var Ic=!1;oc&&(Ic=ec.ListReader.$h(h),w.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",Ic,ec.ListReader.$h(n)),this.Mse=Ic=sm.eh.merge(h,ma,!0,$a,n,void 0,sb,Jb,this.aBe),this.wRn(h,Sb)&&this.wFm(h,n,Sb,$a));Sb=sm.B1m.Q1l(h,ma,n,x,Ic,this.TMc);var gd=!1;if(S){const Gd=
new Lf.a;Gd.fd(n);wf.OutlineElementNavigator.J2(Gd,!1,!1);gd=ec.ListReader.$h(Gd);const vd=ec.ListReader.$h(n);Jb=sm.eh.merge(Gd,n,!0,$a,void 0,!0,void 0,Jb,this.aBe,this.sPj);w.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",gd,vd,Jb?"True":"False, will cause IP to reset to zero.");n=(gd=Jb)?Gd:n}else Jb=!1,w.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero.");this.VV.jJa&&sb&&
(oc&&!this.kbm(Sb,Ic)?(ma=new md.GraphIterator,ma.fd(h),h=wf.OutlineElementNavigator.He(ma),this.VV.zna(h,x,x+Fa)):S&&!this.Edm(Sb,gd)?(h=new md.GraphIterator,h.fd(ma),h=wf.OutlineElementNavigator.He(h),this.VV.zna(h,0,Fa)):(h=new md.GraphIterator,h.fd(ma),h=wf.OutlineElementNavigator.He(h),this.VV.PDa(Dd.a.create(h))));this.F4m(Sb);this.isProgressiveStyleEnabled&&!$a&&this.kF.w8m(Sb)}w.ULS.shipAssertTag(6305494,307,n.Qd);$a=wf.OutlineElementNavigator.He(n);E=Jb?Cd.ParagraphReader.textLength($a)-
E:0;h=!1;Object(pb.a)(87,this.Ri.Bd)&&(h=this.Ri.Bd.ia(ad.a.H$,!1));this.Ri.fXa=h?Ae.SelectionFactory.wN($a,E-1,E):Ae.SelectionFactory.xe($a,E);Of.a.instance.J(10)&&this.Ri&&this.Ri.v6b&&Cd.ParagraphReader.oc($a)&&this.Ri.dYd&&((E=this.Ri.dYd.n1n)&&this.ZQ.hM(E,$a,!0),(E=this.Ri.dYd.m0m)&&this.paragraphEditor.Abh($a,E));b.si(Object(v.a)(this,this.vib,"pasteTeardown"));return!0}kbm(b,h){return!h&&!!b&&Kf.OutlineElementReader.Nh(b.psa)&&Kf.OutlineElementReader.Cab(b.psa)}Edm(b,h){return!h&&!!b&&Kf.OutlineElementReader.Nh(b.ugb)&&
Kf.OutlineElementReader.Cab(b.ugb)}F4m(b){sm.$Di&&b&&sm.$Di.r8m(b)}vRn(b,h,n){ec.ListReader.$h(b)?(sm.Zd.fDb&&this.xkb&&this.xkb.Blf(b),h=ec.ListReader.$h(h)?this.r1i:!0):Kf.OutlineElementReader.isEmpty(b,!0)&&!n?(sm.eh.HWa(b),h=!1):h=ec.ListReader.pr||!ec.ListReader.$h(h);this.fY&&(h=this.fY.gtk(b,h));return h}wRn(b,h){return ec.ListReader.$h(b)||1===h?!0:!1}wFm(b,h,n,x){const E=ec.ListReader.$h(b);if(E){if(x=new Lf.a,x.fd(b),wf.OutlineElementNavigator.Rr(x,!1,!1),x.xn.id!==h.xn.id){n=this.hd.Es(b);
this.hd.cD(b);var S=b.currentNode.ia(ic.a.listID,0);b.nc();var ma=this.hd.x4i,Fa=!0;for(n.Qz=Zh.a.Xi;x.currentNode.id!==h.currentNode.id;){if(!ma||!Kf.OutlineElementReader.VSn(x))if(!ec.ListReader.$h(x))({pBa:n}=this.Jo.Yqa(n.propertySet,x,n)),Fa=!1;else if(E){Fa=this.hd.Ldf(x);var $a=this.hd.Kw(b.currentNode,S,Fa);$a=$a?nr.a.F1($a,null):n;Fa=nr.a.wP($a.listType,n.listStyle,null,0,Fa,"","");Fa.xhb=b.currentNode;this.Jo.UKn(Fa);this.Jo.J5d(x,!0);Fa=!1}wf.OutlineElementNavigator.Rr(x,!1,!1)}ma&&Fa&&
this.Jo.wdh()}}else if(1===n)for(n=new Lf.a,n.fd(b),wf.OutlineElementNavigator.He(n),b=Cd.ParagraphReader.wh(n)?n.currentNode:null,S=this.pc.jHd(n),wf.OutlineElementNavigator.ae(n),wf.OutlineElementNavigator.Rr(n,!1,!1);n.currentNode.id!==h.currentNode.id;)wf.OutlineElementNavigator.He(n),ma=Cd.ParagraphReader.wh(n)?n.currentNode:null,wf.OutlineElementNavigator.ae(n),ma&&b&&x&&(S&&this.ZQ.hM(S,ma,!0),this.B4.qpi(b,ma,E),this.B4.S_a(b,ma,1,!0)),wf.OutlineElementNavigator.Rr(n,!1,!1)}Jck(b,h,n){var x=
!1;if(this.Rd.wg)if(vs.a.HJ)x=!0;else{var E=!1;this.fY&&(E=h.currentNode,E=this.fY.$fm(E)||this.fY.frf(E));E?this.Rd.N0a=4:x=!0}if(x){for(;b.currentNode!==n.currentNode;){wf.OutlineElementNavigator.He(b,!1);x=this.Ph.f0c(Dd.a.create(b.currentNode));let S;({type:S}=x.KHd()).returnValue&&this.Rd.us(S);for(E=0;E<x.length;E++){let ma;const Fa=({wPd:ma}=x.getContext(E)).returnValue;ma&&(sm.hyperlinkEditor.rhb(Fa,1),this.Hk.dkb(Fa,1,null,!0))}b.nc();wf.OutlineElementNavigator.Rr(b,!1,!1)}b.fd(h);wf.OutlineElementNavigator.Rr(b,
!1,!1)}}QHl(b,h){b=md.GraphIterator.$a(b);wf.OutlineElementNavigator.He(b);return Cd.ParagraphReader.oc(b.currentNode)?(h=h?Cd.ParagraphReader.textLength(b.currentNode):0,Ae.SelectionFactory.xe(b.currentNode,h)):ag.TableReader.XW(b.currentNode)?Ae.SelectionFactory.ir(b.currentNode):null}mMn(b){const h=md.GraphIterator.$a(this.P$i);h.dE(1);this.Ri.fXa=Ae.SelectionFactory.wo(h.currentNode,!1);b.si(Object(v.a)(this,this.vib,"pasteTeardown"));return!0}vib(){var b=void 0===this.Ri.iA||null===this.Ri.iA?
"not available":Object(Pv.a)(Ro.a,this.Ri.iA);w.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.Ri.iA,b);w.ULS.shipAssertTag(6305497,307,!!this.Ri.fXa);this.TMc?Object(Pe.a)("ExternalPasteAction",!0):Object(Pe.a)("InternalPasteAction",!0);sm.z6&&this.TNa&&(b=new md.GraphIterator,this.TNa.restore(b),this.TNa=null,this.VSl(b));this.transaction.dispose();b=this.mt.uv;if(!b.Be||!b.editingView.Cj)return!1;b.editingView.J4n();return!1}VSl(b){if(b){if(this.TMc&&ag.TableReader.Tw(b)&&this.SKg){if(null!=
this.Mse&&0==this.Mse){var h=new Lf.a;h.fd(b);wf.OutlineElementNavigator.Rr(h,!1,!1);b.fd(h)}h=Ng.rsn(b);let n=Cd.ParagraphReader.Ym(h);h&&n&&(this.Ri.fXa=Ae.SelectionFactory.xe(n,0),b=md.GraphIterator.$a(h))}else sm.Vfm&&Ng.v1m(b);b&&ag.TableReader.Tw(b)&&$d.returnToContainingCell(b)&&Ng.v8j(b.currentNode)}else w.ULS.sendTraceTag(525361991,3022,50,"Preceding iterator should not be null.")}cQn(b,h){const n=new md.GraphIterator;n.fd(b);b=wf.OutlineElementNavigator.He(n);h=Cd.ParagraphReader.oc(b)&&
h===Cd.ParagraphReader.textLength(b);w.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",h);return h}GZn(b){w.ULS.shipAssertTag(6305498,307,Kd.SelectionEditor.xf(b));const h=md.GraphIterator.$a(b.node);var n=h.vd();wf.OutlineElementNavigator.ae(h);n&&b.Qd||w.ULS.sendTraceTag(40425481,307,15,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:n,["ipContextNodeType"]:b.node.type,["isValidIpContext"]:b.Qd});if(!Kf.OutlineElementReader.Nh(h)&&(w.ULS.sendTraceTag(594072134,
307,10,"sourceOE is not an OutlineElement"),this.K.$("AbortClipboardOperationWhenFailToRootAtOEIsEnabled")))return!1;n=sm.eh.cta(h,!0);const x=this.cQn(h,b.cpBegin);sm.eh.dba(h,n,b,!1,!1,!0,x);return!0}static get hyperlinkEditor(){return null!=sm.sjg?sm.sjg:sm.sjg=Oa.a.instance.resolve("Box4.IHyperlinkEditor")}static get Ue(){return Nd.PageReader.instance}static get eh(){return null!=sm.bng?sm.bng:sm.bng=Oa.a.instance.resolve("Box4.IOutlineElementEditor")}static get Zd(){return bo.a.getInstance()}static get Pb(){return null!=
sm.Shg?sm.Shg:sm.Shg=Oa.a.instance.Pa("Box4.IFeatureHelper")}static get $Di(){return null!=sm.eog?sm.eog:sm.eog=Oa.a.instance.resolve("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste")}static get B1m(){return null!=sm.bog?sm.bog:sm.bog=Oa.a.instance.resolve("Box4.Actors.PastedContentsPostProcessorHelper")}static get z6(){null==this.r8&&(u.AFrameworkApplication.Hf("he991617;3eed2178"),this.r8=u.AFrameworkApplication.K?u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",
!1):!1);return this.r8}static get Vfm(){null==this.Ete&&(u.AFrameworkApplication.Hf("PasteTableBelowTableNewExperience;PasteTableBelowTableNewExperienceCf"),this.Ete=u.AFrameworkApplication.K?u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBelowTableNewExperienceIsEnabled",!1):!1);return this.Ete}}sm.r8=null;sm.Ete=null;Object(r.a)(sm,"APasteExecutionManager",null,[]);class Bw{constructor(b){this.Fj=b}reset(){this.Fj.reset()}get PCc(){return this.Fj.PCc}saa(b,
h){this.Fj.saa(b,h)}HCa(b){this.Fj.HCa(b)}Xhb(b){this.Fj.Xhb(b)}lua(b){this.Fj.lua(b)}DCa(b){this.Fj.DCa(b)}uNa(b,h){this.Fj.uNa(b,h)}tNa(){this.Fj.tNa()}FF(b){this.Fj.FF(b)}EF(){this.Fj.EF()}Uhb(){this.Fj.Uhb()}Thb(){this.Fj.Thb()}KCa(b){this.Fj.KCa(b)}ICa(){this.Fj.ICa()}yNa(b){this.Fj.yNa(b)}JCa(){this.Fj.JCa()}u0a(b){this.Fj.u0a(b)}raa(b){this.Fj.raa(b)}oaa(){this.Fj.oaa()}qaa(b){this.Fj.qaa(b)}paa(){this.Fj.paa()}naa(b){this.Fj.naa(b)}maa(){this.Fj.maa()}zNa(b,h){this.Fj.zNa(b,h)}r0a(){this.Fj.r0a()}}
Object(r.a)(Bw,"AHtmlNormalizer",null,[601,577]);class dy extends Bw{constructor(b){super(b);this.EI=!1}saa(b,h){this.EI?this.cM.pL(()=>{this.qMf(b,h)}):this.qMf(b,h)}qMf(b,h){this.Fj.saa(b,h)}HCa(b){this.EI?this.cM.pL(()=>{this.TLf(b)}):this.TLf(b)}TLf(b){this.Fj.HCa(b)}lua(b){this.EI?this.cM.pL(()=>{this.HUc(b)}):this.HUc(b)}HUc(b){this.Fj.lua(b)}DCa(b){this.EI?this.cM.pL(()=>{this.SLf(b)}):this.SLf(b)}SLf(b){this.Fj.DCa(b)}uNa(b,h){this.EI?this.cM.pL(()=>{this.OLf(b,h)}):this.OLf(b,h)}OLf(b,h){this.Fj.uNa(b,
h)}tNa(){this.EI?this.cM.pL(Object(v.a)(this,this.NLf,"processAnchorEnd")):this.NLf()}NLf(){this.Fj.tNa()}FF(b){this.EI?this.cM.pL(()=>{this.cMf(b)}):this.cMf(b)}cMf(b){this.Fj.FF(b)}EF(){this.EI?this.cM.pL(Object(v.a)(this,this.bMf,"processParagraphEnd")):this.bMf()}bMf(){this.Fj.EF()}Uhb(){this.EI?this.cM.pL(Object(v.a)(this,this.eMf,"processPreFormattedTextStart")):this.eMf()}eMf(){this.Fj.Uhb()}Thb(){this.EI?this.cM.pL(Object(v.a)(this,this.dMf,"processPreFormattedTextEnd")):this.dMf()}dMf(){this.Fj.Thb()}KCa(b){this.EI?
this.cM.pL(()=>{this.XLf(b)}):this.XLf(b)}XLf(b){this.Fj.KCa(b)}ICa(){this.EI?this.cM.pL(Object(v.a)(this,this.ULf,"processListEnd")):this.ULf()}ULf(){this.Fj.ICa()}yNa(b){this.EI?this.cM.pL(()=>{this.WLf(b)}):this.WLf(b)}WLf(b){this.Fj.yNa(b)}JCa(){this.EI?this.cM.pL(Object(v.a)(this,this.VLf,"processListItemEnd")):this.VLf()}VLf(){this.Fj.JCa()}raa(b){this.EI?this.cM.pL(()=>{this.pMf(b)}):this.pMf(b)}pMf(b){this.Fj.raa(b)}oaa(){this.EI?this.cM.pL(Object(v.a)(this,this.mMf,"processTableEnd")):this.mMf()}mMf(){this.Fj.oaa()}qaa(b){this.EI?
this.cM.pL(()=>{this.oMf(b)}):this.oMf(b)}oMf(b){this.Fj.qaa(b)}paa(){this.EI?this.cM.pL(Object(v.a)(this,this.nMf,"processTableRowEnd")):this.nMf()}nMf(){this.Fj.paa()}naa(b){this.EI?this.cM.pL(()=>{this.lMf(b)}):this.lMf(b)}lMf(b){this.Fj.naa(b)}maa(){this.EI?this.cM.pL(Object(v.a)(this,this.kMf,"processTableCellEnd")):this.kMf()}kMf(){this.Fj.maa()}zNa(b,h){this.EI?this.cM.pL(()=>{this.YLf(b,h)}):this.YLf(b,h)}YLf(b,h){this.Fj.zNa(b,h)}r0a(){this.EI?this.cM.pL(Object(v.a)(this,this.DFi,"processMathEnd")):
this.DFi()}DFi(){this.Fj.r0a()}}Object(r.a)(dy,"AQueuingHtmlNormalizer",Bw,[]);var It=d(1834);class ku{constructor(){this.zCe=new It.a}pL(b){this.zCe.enqueue(b)}flush(b=!1){for(b&&this.c5d();!this.zCe.isEmpty;)this.zCe.dequeue()();b&&this.g3d()}c5d(){}g3d(){}}Object(r.a)(ku,"QueuedEventManager",null,[]);class Jt extends ku{constructor(b){super();this.id=void 0;this.k0e=null;this.TNd=!1;this.zua="";this.SNd=this.COd=!1;this.a0e=this.YZb=null;this.FRc=0;this.xNc=this.QOc=this.Nsf=!1;this.table=null;
this.VBf=0;this.AY=b}get Zxc(){return!!this.table}c5d(){this.AY.G$b.push(this.AY.currentState);this.AY.currentState=this}g3d(){this.AY.currentState=this.AY.G$b.pop()}}Jt.nextId=void 0;Object(r.a)(Jt,"ContentState",ku,[]);var lx=d(314);class Ar{constructor(b,h,n){this.colSpan=b.colSpan;this.rowSpan=b.rowSpan;this.width=b.width;this.height=b.height;this.WZa=b.WZa;this.shadingColor=b.shadingColor;this.verticalAlignment=b.verticalAlignment;this.Lga=b.Lga;this.E9d=b.E9d;this.X6b=b.X6b;this.w5=b.w5;this.contents=
n;this.BOl=h}}Object(r.a)(Ar,"TableCell",null,[]);var ey=d(1064),ug=d(1065),Mz=d(1068),yA=d(1069),lu=d(1067);class Nz extends ku{constructor(b,h){super();this.AY=b;this.R0g=new Mp.a;this.Foa=new Mp.a;this.Ixe=[];this.Mjd=[];this.$Fa=-1;this.dRa=0;this.SGj=h.U9h;this.RGj=h.i8l;this.tVj=h.v2f;this.zp=h.width;this.EKg=h.WZa;this.dEj=new lx.a(new by.a(h.T6.C4h,h.T6.tKd),h.sA,h.Jma,h.cultureName,h.mya);this.LFj=h.dLd;this.rmd=h.styleId;this.zVj=h.tableLook}get Fj(){return this.AY.Fj}S5m(b){this.$Fa++;
this.R0g.add(b);this.Mjd[this.$Fa]=b.height;this.dRa=0}get sNk(){for(;this.dRa>=this.Foa.count;)this.Foa.add(Array(this.$Fa+1));return this.Foa.J(this.dRa)}O_j(b,h,n,x,E,S,ma){if(0>this.$Fa)return!1;for(;this.Ixe[this.dRa]>=this.$Fa;)this.dRa++;b=new Ar(b,new lx.a(h,n,x,E,S),ma);this.sNk[this.$Fa]=b;if(1<b.rowSpan)for(h=this.$Fa+b.rowSpan-1,x=this.dRa,n=this.dRa+b.colSpan-1;x<=n;x++)this.Ixe[x]>=h||(this.Ixe[x]=h);this.dRa+=b.colSpan;this.Mjd[this.$Fa]<b.height&&(this.Mjd[this.$Fa]=b.height);return!0}c5d(){this.AY.currentState.table=
this}g3d(){this.AY.currentState.table=null}BHh(){this.flush(!0);const b=this.$Fa+1;var h=Array(b);for(var n=0;n<b;n++)h[n]=Array(this.Foa.count);n=!0;var x=0;for(var E=0;E<this.Foa.count;E++){var S=this.Foa.J(E),ma=!0;for(var Fa=0;Fa<b;Fa++){var $a=S[Fa];$a&&(ma=!1,h[Fa][E+x]=new Mz.a($a.colSpan,$a.rowSpan,$a.width,$a.height,void 0,void 0,void 0,void 0,$a.WZa,$a.X6b))}ma?(this.Foa.removeAt(E),E--,++x):n=!1}if(!n){(h=this.EKg?this.AY.Phh(h,this.zp/100):this.AY.Phh(h))&&h.length!==this.Foa.count&&(h=
null);this.AY.Rbb(!0);this.AY.jud();this.Fj.raa(new lu.a(b,this.Foa.count,this.zp,this.EKg,h,this.SGj,this.RGj,this.tVj,this.LFj,this.rmd,this.zVj,this.dEj));for(h=0;h<b;h++){n=this.R0g.J(h);this.Fj.qaa(new yA.a(this.Mjd[h],new lx.a(n.T6,n.sA,n.Jma,n.cultureName,n.mya)));for(n=0;n<this.Foa.count;n++){x=this.Foa.J(n)[h];var sb=!!this.rmd&&""!==this.rmd&&"Custom"!==this.rmd;E=x?x.colSpan:0;S=x?x.rowSpan:0;ma=x?x.width:0;Fa=x?x.height:0;$a=x?x.w5:0;const Jb=x?x.WZa:!1,Sb=x&&(65536&$a||!sb)?x.shadingColor:
"",oc=x?x.verticalAlignment:0,Ic=x?x.X6b:!1;sb=x?this.AY.Wyl(x.Lga,n,h,this.Foa,sb,x.w5):new ey.a;const gd=x?x.E9d:new ug.a,Gd=x?x.BOl:null;this.Fj.naa(new Mz.a(E,S,ma,Fa,Sb,oc,sb,gd,Jb,Ic,$a,new lx.a(Gd?Gd.T6:null,Gd?Gd.sA:null,Gd?Gd.Jma:null,Gd?Gd.cultureName:null,Gd?Gd.mya:null)));x&&!x.X6b&&(x.contents.c5d(),x.contents.flush(),this.AY.Rbb(!1),this.AY.jud(),x.contents.g3d());this.Fj.maa()}this.Fj.paa()}this.Fj.oaa();this.AY.currentState.xNc=!1;this.AY.PCh(!1)}}}Object(r.a)(Nz,"NormalizedTable",
ku,[]);class mx{constructor(b=!1,h=!1){this.CHj=b;this.T0=h}get Tcm(){return this.CHj}get eba(){return this.T0}}Object(r.a)(mx,"HtmlNormalizerSettings",null,[617]);var Ru=d(810);class mu extends dy{constructor(b,h=null){super(b);this.G$b=new Ru.a;this.tQb=h||new mx}reset(){super.reset();this.currentState=new Jt(this);this.G$b.clear();this.EI=!1}get cM(){return this.currentState&&this.currentState.Zxc?this.currentState.table:this.currentState}Wzd(b=!1){this.currentState.TNd||(this.jud(),this.Fj.FF(this.currentState.k0e),
this.currentState.TNd=!0,this.currentState.xNc=!1);b||!this.currentState.YZb||this.currentState.SNd||(this.Fj.uNa(this.currentState.YZb,this.currentState.a0e),this.currentState.SNd=!0)}FEc(){this.currentState.SNd&&(this.Fj.tNa(),this.currentState.SNd=!1)}e1k(){this.currentState.TNd&&(this.Fj.EF(),this.currentState.TNd=!1,this.currentState.zua="")}PCh(b){this.currentState.QOc&&(this.currentState.xNc?b||(this.Fj.FF(null),this.Fj.EF(),this.Fj.JCa(),this.currentState.QOc=!1):(this.Fj.JCa(),this.currentState.QOc=
!1,this.currentState.xNc=!0))}Rbb(b){this.FEc();this.e1k();this.PCh(b)}eYm(b){this.Fj.KCa(new us.a(2,1,b));this.currentState.FRc++;this.currentState.Nsf=!0}jud(){!this.currentState.QOc&&this.currentState.Nsf&&(this.Fj.ICa(),this.currentState.FRc--,this.currentState.Nsf=!1)}qMf(b,h){b=this.nKm(b);if(""!==b)if(this.Wzd(),this.currentState.COd)this.rMf(b,h);else{b=b.split(mu.Lmk);for(let n=0;n<b.length-1;n++)this.rMf(b[n],h),this.Fj.Xhb(h);this.rMf(b[b.length-1],h)}}YLf(b,h){""!==b&&(this.Wzd(),this.Fj.zNa(b,
h))}TLf(b){this.tQb.eba||this.FEc();this.Wzd(!0);this.Fj.HCa(b)}SLf(b){this.currentState.Zxc||this.Fj.DCa(b)}HUc(b){this.currentState.YZb&&(b.href=this.currentState.YZb);super.HUc(b)}OLf(b,h){this.FEc();this.currentState.YZb=b;this.currentState.a0e=h}NLf(){this.FEc();this.currentState.YZb=null;this.currentState.a0e=null}cMf(b){this.currentState.k0e=b;this.Rbb(!0)}bMf(){this.currentState.k0e=null;this.Rbb(!0)}eMf(){this.currentState.COd=!0}dMf(){this.currentState.COd=!1}XLf(b){this.Rbb(!1);this.jud();
this.Fj.KCa(b);this.currentState.FRc++}ULf(){this.Rbb(!1);this.Fj.ICa();this.currentState.FRc--}WLf(b){this.Rbb(!1);this.currentState.FRc||this.eYm(b);this.Fj.yNa(b);this.currentState.QOc=!0;this.currentState.xNc=!0}VLf(){this.Rbb(!1)}raa(b){this.currentState.Zxc||(this.EI=!0,this.currentState.table=new Nz(this,b))}pMf(){}oaa(){if(this.currentState.table){var b=this.currentState.table;this.currentState.table=null;this.G$b.isEmpty?(this.EI=!1,b.BHh()):this.cM.pL(Object(v.a)(b,b.BHh,"flushTable"))}}mMf(){}qaa(b){this.currentState.Zxc&&
this.currentState.table.S5m(b)}oMf(){}paa(){}nMf(){}naa(b){let h=!1;if(this.currentState.Zxc){const n=new Jt(this);this.currentState.table.O_j(b,new by.a(b.T6.C4h,b.T6.tKd),b.sA,b.Jma,b.cultureName,b.mya,n)?(this.G$b.push(this.currentState),this.currentState=n):h=!0}else h=!0;h&&this.currentState.VBf++}lMf(){}maa(){0<this.currentState.VBf?this.currentState.VBf--:this.currentState=this.G$b.pop()}kMf(){}Phh(b,h=1){if(!b)return null;const n=b.length;if(!n)return null;const x=b[0].length;for(var E=1;E<
n;E++)if(b[E].length!==x)return null;E=Array(x+1);E[0]=0;const S=Array(x+1);for(var ma=0;ma<S.length;ma++)S[ma]=!1;ma=new Qa.a;for(let $a=0;$a<x;$a++){for(var Fa=0;Fa<n;Fa++){const sb=b[Fa][$a];if(sb&&0<sb.width){const Jb=Math.min($a+sb.colSpan,x);E[Jb]=E[$a]+sb.width*(sb.WZa?h:1);S[Jb]=!0}}if(S[$a+1]){Fa=E[$a+1]-E[$a];if(0>=Fa)return null;ma.add(Fa)}else E[$a+1]=E[$a]}return ma.toArray()}oDm(b,h){1&h||(b.borderTopStyle=12);16&h||(b.borderRightStyle=12);256&h||(b.borderBottomStyle=12);4096&h||(b.borderLeftStyle=
12);return b}Wyl(b,h,n,x,E,S){if(!b)return null;E&&(b=this.oDm(b,S));if(0>n||0>h||h>x.count-1)return b;0<=h-1&&n<=x.J(h-1).length-1&&1===b.borderLeftStyle&&(E=x.J(h-1)[n])&&1!==E.Lga.borderRightStyle&&(b.borderLeftStyle=E.Lga.borderRightStyle,b.borderLeftColor=E.Lga.borderRightColor,b.borderLeftWidth=E.Lga.borderRightWidth);0<=n-1&&n<=x.J(h).length-1&&1===b.borderTopStyle&&(h=x.J(h)[n-1])&&1!==h.Lga.borderBottomStyle&&(b.borderTopStyle=h.Lga.borderBottomStyle,b.borderTopColor=h.Lga.borderBottomColor,
b.borderTopWidth=h.Lga.borderBottomWidth);return b}nKm(b){this.currentState.COd||(b=this.tQb.Tcm?b.replace(mu.MXl," "):b.replace(mu.LXl," "));b.startsWith(" ")&&(this.currentState.zua.endsWith(" ")||""===this.currentState.zua)&&(b=B.a.substring(b,1,b.length));return b}rMf(b,h){""!==b&&(this.Fj.saa(b,h),this.currentState.zua+=b)}}mu.LXl=RegExp("[ \t\f\u200b\r\n]+","g");mu.MXl=RegExp("[ \f\u200b\r\n]+","g");mu.Lmk="\t";Object(r.a)(mu,"DefaultHtmlNormalizer",dy,[]);class nx extends mu{constructor(b,
h,n){super(b,n);this.PFg=!1;this.Epb=h}static v$l(b){return u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerImageUrl",!1)&&b?(b=nx.jSk.exec(b))&&0<b.length:!1}HUc(b){this.Epb.iac&&(u.AFrameworkApplication.Kta?this.PFg||(b=new yd.StandardDialog,b.Ed=0,b.We(1,CommonUIStrings.l_DialogClose),b.Lv(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,1,null),this.PFg=!0):this.Epb.Eoi?this.Epb.pTd=!0:b.src&&""!==b.src?Ec.a.h$(b.src)!==Ec.a.h$(window.location.href)||
nx.v$l(b.src)?b.src.startsWith("data:")&&19922944<b.src.length?u.AFrameworkApplication.ya.processAction(Db.a.uCi,2):b.src.startsWith("webkit-fake-url")?u.AFrameworkApplication.ya.processAction(Db.a.tCi,2):(this.FEc(),this.Wzd(!0),this.Fj.lua(b)):u.AFrameworkApplication.ya.processAction(Db.a.wCi,2):u.AFrameworkApplication.ya.processAction(Db.a.vCi,2))}}nx.jSk=RegExp(".\\/we\\/s\\/\\d+_resources\\/\\d+\\/\\D.+(.png|.jpg)");Object(r.a)(nx,"Box4HtmlNormalizer",mu,[]);class Qv{constructor(b,h,n,x,E,S,
ma,Fa,$a,sb,Jb){this.htmlProcessor=b;this.Zkf=h;this.yrk=n;this.dkj=x;this.Obl=E;this.vCn=S;this.wCn=ma;this.sKd=Fa;this.FXl=$a;this.HXl=sb;this.pqm=Jb}}Object(r.a)(Qv,"ExecutePasteArguments",null,[]);class hq extends sm{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd,Gd){super(h,n,x,sb,Sb,gd);this.gia=null;this.gKm=vd=>{this.Zad.aii(this.wia)&&u.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IWacWordRemoveSpacesAfterEndFragmentSettings");this.ATj&&this.Zad.S9n(this.wia);vd.si(this.W5m);
return!0};this.W5m=vd=>{if(this.MSj){const ce=this.wia.getElementsByTagName("style");if(ce&&0<ce.length){w.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let od=0;od<ce.length;od++)this.Kne.SDk(this.wia,ce[od]),ce[od]&&(ce[od].parentNode.removeChild(ce[od]),od--)}}vd.si(this.gEk);return!0};this.gEk=(vd,ce)=>{this.oLe.value.create(ce.dkj).process(this.wia,vd);(ce=Oa.a.instance.Pa("Box4.IFeatureHelper"))&&ce.isFeatureEnabled(11)?vd.si(this.lDk):
vd.si(this.wFi);return!0};this.lDk=(vd,ce)=>{(new $x(ce.yrk)).process(this.wia,vd);vd.si(this.wFi);return!0};this.wFi=(vd,ce)=>{ce.htmlProcessor.process(this.wia,vd);vd.si(ce.Zkf&&ce.Zkf.iac?this.XHb:this.bCh);return!0};this.XHb=(vd,ce)=>{if(ce=ce.Zkf){let od=!1,Yd=!1,ne=!1,Df=!1,Af=-1;const Wi=new qi.DictionaryPropertySet,gm=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');if(Object(pb.a)(87,this.Ri.Bd)){od=this.Ri.Bd.ia(ic.a.Vea,!1);const Ck=this.Ri.Bd.ia(ad.a.$T,"");ne=this.Ri.Bd.ia(ad.a.H$,
!1);Df=this.Ri.Bd.ia(ie.a.Wea,!1);gm.test(Ck)&&(Yd=!0);this.b1i&&(Af=this.Ri.Bd.ia(Ji.a.Qda,-1))}else this.Ri.iA&256&&this.wia&&(od=!0,gm.test(this.wia.innerHTML)&&(Yd=!0));Wi.setValue(ic.a.Vea,od);Wi.setValue(ad.a.WOc,Yd);Wi.setValue(ad.a.H$,ne);Wi.setValue(Ji.a.Qda,Af);Wi.setValue(ie.a.Wea,Df);ce.v5d(Wi);ce.oGf();ce.uhb&&(this.Ri.oNc=!0,this.Ri.wlf=ce.K1,this.Ri.fDf=ce.uhb,od&&!ne&&Pe.c(Db.a.b4k),u.AFrameworkApplication.ya.processAction(Db.a.XHb,2))}vd.si(this.bCh);return!0};this.bCh=(vd,ce)=>{zk.a.FAm(ce.dkj);
zk.a.awm(ce.HXl);zk.a.gzm(ce.vCn);zk.a.hzm(ce.wCn);zk.a.Cwm(ce.pqm);vd="Others";ce.sKd&&(ce.sKd.Yvm(),ce.sKd.Zvm(),vd=ce.sKd.a0f);zk.a.$vm(ce.FXl,vd);zk.a.Evm(ce.Obl,vd);return!1};this.wia=b;this.zhe=E;this.nre=S;this.ZHe=ma;this.oLe=Fa;this.aoc=$a;this.tQb=Ic;this.Ma=Jb;this.CGg=Object.assign(new Kr.a,{A5b:2===this.Ri.tZb||3===this.Ri.tZb});this.Kne=oc;this.Zad=Gd;this.jUb=Jb.$("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.MSj=Jb.$("ParseStyleFromRawHtmlHeadIsEnabled");this.ATj=Jb.$("RemoveSpacesAfterEndFragmentIsEnabled")}get OUd(){return!1}get TMc(){return!0}YDh(b){this.gia=
new md.GraphIterator;this.TNa.restore(this.gia);w.ULS.shipAssertTag(6305550,307,Kf.OutlineElementReader.Nh(this.gia));this.Ri.zQ&&this.Ri.zQ.$Wb("external");var h=this.Ri.iA&8192?1:0,n=this.nre.value.create(h,this.gia,this.Ri.tAc,this.Ri.sjb);const x=this.ZHe.value.create(h,this.gia),E=zk.a.VLh(u.AFrameworkApplication.userSessionId),S=zk.a.Qhf(u.AFrameworkApplication.userSessionId),ma=zk.a.Ocf(V.a.Evb,this.Ri.tAc),Fa=zk.a.lXh(u.AFrameworkApplication.userSessionId),$a=zk.a.mXh(u.AFrameworkApplication.userSessionId),
sb=this.jUb?this.w1l():null,Jb=zk.a.AQh(V.a.Evb,this.Ri.tAc),Sb=zk.a.BQh(u.AFrameworkApplication.userSessionId),oc=this.aoc.$0i?zk.a.hwl(u.AFrameworkApplication.userSessionId):null;h=this.zhe.value.create(h,this.gia,n,x,null,ma,this.Z9j);h=new Ty(h,Fa,$a);h=new nx(h,n,this.tQb);h=new hv.a(h,this.aoc,this.CGg,oc);h=new rm(h,Jb,sb,this.Ma);h=new ju(h,Sb);n=new Qv(h,n,E,S,ma,Fa,$a,sb,Jb,Sb,oc);n=new qq.a(b,this.gKm,n);n.ll("paste and request pictures");n.ah=!b||b.ah;n.run()}get Z9j(){return this.wia.getElementsByTagName("a").length}w1l(){const b=
new Vy;b.Y$b=V.a.Evb;this.Ri&&(b.iA=this.Ri.iA,b.UHf=this.Ri.tAc,this.Ri.Bd&&(b.progId=this.Ri.Bd.ia(ad.a.sCi,"")));this.wia&&this.wia.innerHTML&&(b.C1m=this.wia.innerHTML.length);u.AFrameworkApplication.sessionStartInfoSettings&&(b.platform=u.AFrameworkApplication.sessionStartInfoSettings.Platform);return b}get r1i(){return!0}get r_c(){w.ULS.shipAssertTag(6305551,307,!!this.gia);if(this.aoc.a1i(this.CGg)){let b=!1;Kf.OutlineElementReader.Nh(this.gia)&&(this.gia.n$(),b=!0);const h=Cd.ParagraphReader.wh(this.gia)&&
!this.gia.currentNode.ia(ad.a.Pai,!1);b&&this.gia.nc();return h}return Cd.ParagraphReader.wh(this.gia)}}Object(r.a)(hq,"ExternalPasteExecutionManager",sm,[]);class Oz{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb){this.zhe=b;this.nre=h;this.ZHe=n;this.oLe=x;this.aoc=E;this.fY=S;this.Ma=ma;this.Kne=Fa;this.tQb=$a;this.B4=sb;this.Zad=Jb}create(b,h,n,x){return new hq(b,h,n,x,this.zhe,this.nre,this.ZHe,this.oLe,this.aoc.value,this.fY,this.Ma,ob.App.xa.jb,this.Kne,this.tQb,this.B4,this.Zad)}}Object(r.a)(Oz,"Factory",
null,[535]);class Wy{aii(b){if(!b||!b.childNodes)return!1;const h=b.childNodes.length;return 2>h?!1:this.yam(b.childNodes[h-2])&&this.Glm(b.childNodes[h-1])}S9n(b){this.aii(b)&&(b.removeChild(b.lastChild),w.ULS.sendTraceTag(579371169,307,50,"Remove spaces after end fragment"))}a9l(b){return!!b&&8===b.nodeType}$jm(b){return!!b&&3===b.nodeType}yam(b){return this.a9l(b)&&"EndFragment"===b.nodeValue}Glm(b){if(!this.$jm(b))return!1;b=b.nodeValue;return!!b&&!b.trim().length}}Object(r.a)(Wy,"HtmlNormalizerHelper",
null,[533]);var wi=d(47),Lr=d(434),Cw=d(226),Xy=d(1059),ox=d(756);class px{constructor(b,h,n,x){this.ayd=this.Zxd=null;this.c0c=b;this.J9d=h;this.W4i=n;this.X4i=x}}Object(r.a)(px,"TableSimplificationInformation",null,[]);var Yy=d(254),Pz=d(897),ws=d(287);class Kt extends Sys.EventArgs{constructor(b){super();this.xo=b}}Object(r.a)(Kt,"AfterTrimCompleteOnCopyArgs",Sys.EventArgs,[]);var Vm=d(1692);class Ni extends Vm.a{constructor(b,h,n,x){super(b,h,{});this.TOa=[];for(b=0;b<n.length;b++)this.TOa.push(...n.J(b).toArray());
this.kza=0;this.Fy=x;this.xo={}}}Object(r.a)(Ni,"BasicInternalCopyArguments",Vm.a,[]);class Di extends Sys.EventArgs{constructor(b,h){super();this.xo=h;this.TOa=[];for(h=0;h<b.length;h++)this.TOa.push(...b.J(h).toArray())}}Object(r.a)(Di,"BeforeCopyArguments",Sys.EventArgs,[]);class So extends Sys.EventArgs{constructor(b){super();this.xo=b}}Object(r.a)(So,"BeforePasteArguments",Sys.EventArgs,[]);class nt extends Sys.EventArgs{constructor(b,h,n,x){super();this.paragraph=b;this.cpBegin=h;this.cpEnd=
n;this.xo=x}}Object(r.a)(nt,"BeforeTrimOnCopyArguments",Sys.EventArgs,[]);var fy=d(1737),xs=d(1738);class Qz{constructor(b,h,n,x,E,S,ma,Fa,$a){this.ifc=b;this.source=h;this.target=n;this.fIf=x;this.rowIndex=E;this.ao=S;this.Mzc=ma;this.mCi=Fa;this.ve=$a}}Object(r.a)(Qz,"CoreInternalTablePasteArguments",null,[]);class kv extends Sys.EventArgs{constructor(b,h,n,x,E){super();this.operation=b;this.cAi=h;this.original=n;this.clone=x;this.xo=E}}Object(r.a)(kv,"ParagraphCopyPasteArguments",Sys.EventArgs,
[]);class bk{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd){this.GV=this.Ns=null;this.Bye=!1;this.r8=this.Xwa=null;this.eSb=S;this.ep=ma;this.hj=b;this.VHe=h;this.uJ=n;this.Kh=x;this.kG=E;this.Ma=Fa;this.Hc=sb;this.fod=$a.create(2097162);this.DPf(this.fod);this.Eme=$a.create(2097162);this.DPf(this.Eme);this.UKe=$a.create(2097162);this.DPf(this.UKe);this.Kmd=this.fod;this.fY=Jb;this.X0=Sb;this.Hd=oc;this.Puc=Ic;this.uSj=Ic.substr(0,3);this.B4=gd}get paragraphEditor(){return null!=this.Jng?this.Jng:
this.Jng=Oa.a.instance.resolve("Box4.IParagraphEditor")}get Pb(){return null!=this.$hg?this.$hg:this.$hg=Oa.a.instance.Pa("Box4.IFeatureHelper")}get Iu(){return this.Ns?this.Ns.Iu:0}get zwb(){return this.Ns.kb.zwb}get dsa(){return this.Ns.kb.dsa}get Sga(){return this.Kmd}get H9i(){return this.UKe}get OXe(){return this.Ns.rI&&!this.Bye}n_i(){this.Bye=!0}get Fzi(){return!this.Ns.rI}get ioa(){return Gn.a.instance}get Wfm(){return this.Ma.$("InternalPasteTableWithReplacingCellIsEnabled")}DPf(b){var h=
new Pz.a(-1);this.eSb.al.QIa(h);const n=new md.GraphIterator;n.set(h);u.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IWacWordNoRenderGraphTransactionInternalClipboardSettings");h=3;this.Ma&&this.Ma.$("NoRenderGraphTransactionInternalClipboardIsEnabled")&&(h=0);h=this.Hc.Rc(h);h.Ju(n);n.Sf(b,80);h.dispose()}Wvd(b,h=null){b=b.Cb;this.Ns=b.ib.clone();this.Bye=!1;b=md.GraphIterator.$a(b.E_);const n=md.GraphIterator.$a(this.Sga),x=this.Hc.Rc(3,Db.a.internalCopy);x.Ju(n);b.Rb(82);do b.currentNode.TLb(null);
while(b.Vi(82));b=new qq.a(h,Object(v.a)(this,this.Puk,"clearInternalClipboard"),new Ni(b,n,this.Ns,x));b.ll("InternalCopy");b.ah=!h||h.ah;b.run()}Puk(b,h){ue.a.mark(5566);h=h.target;if(h.Wd())return h.Fg(),!0;b.si(Object(v.a)(this,this.SEc,"executeCopy"));return!0}SEc(b,h){h=new fy.a(h,null);const n=new qq.a(b,Object(v.a)(this,this.FBc,"coreCopySetup"),h);n.ll("ExecuteCoreCopyToInternalClipboard");this.s7m(h);n.run();b.si(Object(v.a)(this,this.Q9n,"trimNewText"));return!0}FBc(b,h){if(!h.source.Wd())return h.Ri&&
(h.Ri.Gtd=null),w.ULS.shipAssertTag(6305560,307,!1),!1;b.si(Object(v.a)(this,this.Hqh,"coreCopyIteration"));return!0}Hqh(b,h){const n=h.insertAfter,x=h.source,E=h.target,S=x.currentNode;var ma=this.Fzi;if(!S.Yea)return b.si(Object(v.a)(this,this.EBc,"coreCopyIncrement")),!0;h.Ri.zJb&&(h.zJb=!0);if(!this.Bsk(h))return h.fha.CBa.c++,b.si(Object(v.a)(this,this.EBc,"coreCopyIncrement")),!0;if(!h.zJb&&(S.C0b()&&h.fha.CBa.c++,S.C0b()||ma&&!S.Mfb(this.Iu)))return b.si(Object(v.a)(this,this.EBc,"coreCopyIncrement")),
!0;if(!h.zJb&&ma&&!S.Wy)return x.RC()&&(h.Vbe=!0,h=new qq.a(b,Object(v.a)(this,this.FBc,"coreCopySetup"),new fy.a(h,n)),h.ll("RecursiveCoreCopyToInternalClipboard"),h.run()),b.si(Object(v.a)(this,this.EBc,"coreCopyIncrement")),!0;ma=E.currentNode.Bi().Ad;ma=Fn.a(S,ma,!0);ma.B5b=!0;this.ioa.F1d(h.fha.PAb,ma);E.SG(ma,n,18===x.parentNode.type?1:x.role);E.Ci(ma);h.insertAfter=ma;Cd.ParagraphReader.oc(ma)&&(this.G7m(b,Object(v.a)(this,this.FBc,"coreCopySetup"),S,ma,h),this.F7m(b,S,ma));this.ZCh(S,ma);
x.RC()&&(w.ULS.shipAssertTag(6305562,307,!h.Vbe),h=new qq.a(b,Object(v.a)(this,this.FBc,"coreCopySetup"),new fy.a(h,null)),h.ll("RecursiveCoreCopyToInternalClipboard"),h.run());b.si(Object(v.a)(this,this.GEk,"coreCopyIterationPostProcessing"));return!0}GEk(b,h){var n=h.source;const x=h.target;var E=x.currentNode,S=n.currentNode;Cd.ParagraphReader.wh(x)&&(h.TIf[S.id.toString()]=E);if(Cd.ParagraphReader.oc(E)){if(0<Cd.ParagraphReader.vYh(S))if(0<this.ep.pF(S).gt)S.setValue(ic.a.MNa,0);else{const ma=
this.ep.Z1(S).gt;this.paragraphEditor.np.Raa(E,ma)}if(!this.AMc&&this.B4.nCi){n.nc();if(!ag.TableReader.Tw(x)&&n.XBa&&!this.dsa)for(const ma of this.B4.VIf)E.removeProperty(ma);n.Ci(S)}}if(Of.a.instance.J(6)&&Cd.ParagraphReader.oc(E)){for(S=0;S<E.wordRunProperties.length;S++)E.wordRunProperties.Fq.Z(S,ws.CharacterPropertiesEditor.wQ),E.wordRunProperties.Zs.Z(S,ws.CharacterPropertiesEditor.QT);w.ULS.shipAssertTag(6305564,307,Of.a.instance.J(4));w.ULS.shipAssertTag(6305565,307,!!ob.App.rd);(this.Hd.wg||
Of.a.instance.J(3)&&ob.App.Av.bgc)&&E.setValue(ic.a.JCb,!0);E.Qg(ic.a.Gyb,ic.a.wBi,ic.a.MIf);Of.a.instance.J(3)&&Cd.ParagraphReader.oc(E)&&E.Qg(ic.a.oMa)}this.Fzi&&(this.YCh(x),ag.TableReader.isTable(x)&&(E=this.Ns.vN(),E.moveNext(),(E=Fg.TableCellReader.vAa(n,E.current.node))||(E=new ox.a(0,0)),n=new px(E,x,ag.TableReader.hea(n),ag.TableReader.Qff(n)),this.VHe.value.Nun(n)));Kf.OutlineElementReader.Nh(x)&&!x.Zp(2)&&(this.Kh.uN(x),x.nc());x.nc();h.Ri&&(h.Ri.Gtd=h.insertAfter);b.si(Object(v.a)(this,
this.EBc,"coreCopyIncrement"));return!0}EBc(b,h){h.Vbe&&(h.insertAfter=h.Gtd,h.Vbe=!1);if(!h.source.zu()){h.Ri&&(h.Ri.Gtd=h.insertAfter);const n=h.source;11!==n.Se||n.bIc(-1)||this.i8m(b,n.currentNode,h.target.currentNode,h);return!1}b.si(Object(v.a)(this,this.Hqh,"coreCopyIteration"));return!0}Bsk(b){const h=b.source;if(Kf.OutlineElementReader.Nh(h)&&h.Zdb(12)){const n=h.Wd();if(Cd.ParagraphReader.oc(n)&&n.ia(ic.a.tM,null))return h.nc(),b.zJb=!1;h.nc()}else if(Cd.ParagraphReader.oc(h.xn)&&h.xn.ia(ic.a.tM,
null))return!1;return!0}F7m(b,h,n){h=Ad.e(h);n=Ad.e(n);for(let x=0;x<h.length;x++)h[x].eEf(n[x],b,Object(v.a)(this,this.FBc,"coreCopySetup"))}Q9n(b,h){if(h.kza>=h.TOa.length)return bk.sa.raiseEvent("AfterTrimCompleteOnCopy",new Kt(h.xo)),b.si(Object(v.a)(this,this.FEk,"copyTeardown")),!0;b=h.TOa[h.kza];var n=b.node,x=b.cpBegin;let E=b.cpEnd;if(!Kd.SelectionEditor.Zt(b))if(!h.kza&&Kd.SelectionEditor.sk(b))E=x=Cd.ParagraphReader.textLength(n);else if(Cd.ParagraphReader.gm(b))x=0,E=Cd.ParagraphReader.textLength(n);
else if(Kd.SelectionEditor.z$(b)){w.ULS.shipAssertTag(6305568,307,!h.kza);var S=md.GraphIterator.$a(n);x=S.Bb(12);w.ULS.shipAssertTag(6305569,307,x);n=S.origin;E=x=Cd.ParagraphReader.textLength(n)}else{if(gf.OutlineReader.rOd(b))for(b=Oh.a.Vp(b.node);b.moveNext();)S=b.currentNode,Cd.ParagraphReader.oc(S)&&h.TOa.push(Dd.a.createTextRange(S,0,Cd.ParagraphReader.textLength(S)));h.kza++;return!0}S=h.TIf[n.id.toString()];w.ULS.shipAssertTag(6305570,307,!!S);if(!S)return w.ULS.sendTraceTag(21041548,307,
15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:h.kza,["SelectedContextsLength"]:h.TOa.length,["SelectedNodeType"]:n.type,["ContextId"]:b.contextId}),h.kza++,!0;n=Ad.e(S);let ma,Fa=!1;for(ma=n.length-1;0<=ma;ma--)if(!n[ma].Sya)if(4===n[ma].ri)n[ma].Ob.blob=null,n[ma].Ob.blob=new Et.a(n[ma].Ob),h.fha.CBa.e++;else{n[ma].Ob.blob=null;if(Of.a.instance.J(6)&&-1!==n[ma].Fe){var $a=n[ma].Ob.formatting,sb=void 0,Jb=void 0;$a&&-1===$a.Fe?(Jb=n[ma].Fe+1,sb=n[ma].L2-1,$a.Fe=n[ma].Fe):(sb=n[ma].L2,
Jb=n[ma].Fe);for($a=0;$a<sb;$a++)S.wordRunProperties.removeAt(Jb,16);0<sb&&(Fa=!0)}sb="";Yf.f(n[ma])?(sb=" ",h.fha.CBa.f++):Yf.g(n[ma])&&(Jb=Yf.b(n[ma]))&&(sb=Yf.a(Jb),h.fha.CBa.g++);Jb=n[ma].Ob.cp;Jb>=x&&Jb<E&&(bk.characterPropertiesEditor.replaceTextRange(Dd.a.createTextRange(S,Jb,Jb+1),sb,void 0,void 0,void 0,void 0,!0),E=E-1+sb.length,h.fha.CBa.i++)}Fa&&S.qn();this.non(S);bk.sa.raiseEvent("BeforeTrimOnCopy",new nt(S,x,E,h.xo));n=Cd.ParagraphReader.textLength(S);E<n&&bk.characterPropertiesEditor.replaceTextRange(Dd.a.createTextRange(S,
E,n),"",void 0,void 0,void 0,void 0,!0);0<x&&bk.characterPropertiesEditor.replaceTextRange(Dd.a.createTextRange(S,0,x),"",void 0,void 0,void 0,void 0,!0);this.SPl(S,h.fha.CBa);Cd.ParagraphReader.textLength(S)||h.kza!==h.TOa.length-1||!Kd.SelectionEditor.Zt(b)||vs.a.OBa&&S.ow||(b=md.GraphIterator.$a(S),b.Bb(25)&&(wf.OutlineElementNavigator.ae(b),this.Kh.HWa(b),h.kza&&(this.Ns.kb.dsa=!0)));this.Pb.isFeatureEnabled(94)&&h.kza==h.TOa.length-1&&!this.dsa&&S.Qg(wi.a.U6,wi.a.Nfa,wi.a.Oma,wi.a.yua,wi.a.Nma);
this.ioa.mWc(h.fha.SYd,h.fha.gwb,h.fha.M$a,S);h.kza++;return!0}non(b){const h=b.qa;if(Of.a.instance.J(6)&&h){var n=new Qa.a,x=new Qa.a;for(let E=0;E<h.length;E++){const S=h.J(E);S.oj&&n.add(S);if(!vs.a.OBa&&S.Mb){for(let ma=0;ma<S.Mb.length;ma++)x.add(S.Mb.J(ma).Fe);S.Mb=null}}b.cga(!0,x);for(const E of n)E.oj=null}}FEk(b,h){this.Sga.TLb(null);h.Fy.dispose();ue.a.mark(5567);this.eKm();this.GV=h.fha;this.Cki("Copy");this.N8l&&w.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1}get N8l(){return!md.GraphIterator.$a(this.Sga).Wd()}Vhj(){this.Kmd=
this.UKe}Uhj(){this.Kmd=this.fod}Clo(){this.Kmd=this.Eme}get Lkm(){return this.Sga===this.fod}get V$l(){return this.Sga===this.Eme}vlh(){const b=md.GraphIterator.$a(this.Sga);for(;b.Wd();)b.Fg()}Cki(b){const h=this.GV.CBa.b;b+="-"+h;this.GV.CBa.b=b;this.GV.PAb.b=b;this.GV.SYd.b=b;this.GV.gwb.b=b;this.GV.M$a.b=b;this.ioa.pwm(this.GV.CBa);this.ioa.fwf(this.GV.PAb);this.ioa.Cli(this.GV.SYd);this.ioa.Uvf(this.GV.gwb);this.ioa.Svf(this.GV.M$a);this.GV.CBa.b=h;this.GV.PAb.b=h;this.GV.SYd.b=h;this.GV.gwb.b=
h;this.GV.M$a.b=h}iCi(b,h,n,x,E=null,S=null){this.Cki("Paste");h=md.GraphIterator.$a(h);const ma=md.GraphIterator.$a(this.Sga);var Fa=null;E&&(Fa=new eq.a(gf.OutlineReader.Tvh,gf.OutlineReader.FPk),Fa=E.equals(new eq.a(-1,-1))?new eq.a(0,0):E.a9d(Fa));if(this.k8h())if(ma.Wd(),Pd.ImageReader.qw(ma.currentNode))E=ma.currentNode,ma.nc(),ma.SG(this.Kh.$wb(),null,1),ma.Wd(),ma.SG(E,null,2),ma.nc(),ma.Ci(E),ma.Fg(),this.n_i();else if(Cw.isFloatingEmbeddedFileNode(ma.currentNode)){E=ma.currentNode;ma.nc();
ma.SG(this.Kh.$wb(),null,1);ma.Wd();var $a=this.Kh.uN(ma);$a=Dd.a.Uc($a,0);bk.characterPropertiesEditor.replaceTextRange($a,"<<"+Cw.getEmbeddedFileName(E)+">>",void 0,void 0,void 0,void 0,!0);ma.nc();ma.nc();ma.Ci(E);ma.Fg();this.n_i()}this.fY&&this.fY.frf(n)||!this.Wfm||!this.Egi(ma,h)?(ue.a.mark(5564),ma.currentNode.TLb(null),b={},b[bk.Wkf]=x,ec.ListReader.o2(n)&&(b[Xy.a.q8h]=!0),n=new xs.a(ma,h,n,Fa,b),x=new qq.a(S,Object(v.a)(this,this.HBc,"corePasteSetup"),n),x.ll("ExecuteCorePasteFromInternalClipboard"),
x.ah=!S||S.ah,this.t7m(n),x.run()):(ma.currentNode.TLb(null),w.ULS.sendTraceTag(7869376,307,50,"Begin internal paste table in table"),this.qsn(S,ma,h,Fa,b),w.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended."))}fgi(b){if(b&&b.Qd){const h=md.GraphIterator.$a(this.Sga);return this.Egi(h,b)}return!1}Egi(b,h){if(Fg.TableCellReader.tMa(h)&&1===b.Hp()){b.Rb(1);if(Kf.OutlineElementReader.Nh(b)){wf.OutlineElementNavigator.He(b);if(ag.TableReader.isTable(b)){ag.TableReader.wA(b.currentNode)&&
w.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table.");if(h.Bb(14)&&!ag.TableReader.wA($d.getContainingTable(h))){if(w.ULS.sendTraceTag(19269659,307,50,"Target table is not a complex table."),!this.z6)return!0}else if(w.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table."),this.AMc&&!this.z6)return!0;if(this.z6)return!0}wf.OutlineElementNavigator.ae(b)}b.nc()}return!1}qsn(b,h,n,x,E){let S,ma;let Fa;Object(Pe.a)("ReplaceTableCellsFromClipboardTable",!0);n.Bb(14);S=al.a.xt(n);
ma=fm.a(n);n.kd(14);var $a=ag.TableReader.ag(n.currentNode);Fa=ag.TableReader.kh(n.currentNode);const sb=ag.TableReader.ag(h.currentNode),Jb=ag.TableReader.kh(h.currentNode);w.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};  and target insert index: {5},{6}",$a,Fa,sb,Jb,S,ma);if(this.z6&&gq.TableBorderSelectionCache.oJc())this.dNn(),$a=Math.min(this.W9d+1,$a),Fa=Math.min(this.S2f+1,Fa),this.S2f-this.m4n==Fa-1&&(this.V8i==this.W9d?ma=0:
this.W9d-this.V8i==$a-1&&(n.Wd(),S=al.a.xt(n),ma=fm.a(n)));else{this.Xwa=Oq.a.x2b;var Sb=S+sb-$a;0<Sb&&($d.moveToLastRow(n),w.ULS.sendTraceTag(8716374,307,50,"Begin insert rows: "+Sb),this.VHe.value.insertRows(n,!1,Sb,this.Xwa),w.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),n.kd(14));Sb=ma+Jb-Fa;if(0<Sb){w.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+Sb);try{this.VHe.value.insertColumns(n,Fa,!1,Sb,this.Xwa)}catch(oc){throw w.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",
oc.toString()),oc;}w.ULS.sendTraceTag(8716377,307,50,"Completed inserting columns.")}}$a=this.Yil($a,Fa,sb,Jb,S,ma);w.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");b=new qq.a(b,Object(v.a)(this,this.x1m,"pasteTableOperationRun"),new Qz(null,h,n,x,S,ma,$a,null,E));b.ll("ExecuteCorePasteTableInTable");b.ah=!1;b.run()}x1m(b,h){if(h.ifc){if(h.ifc.inProgress)return!0;Fg.TableCellReader.isTableCell(h.source)||h.source.kd(16);if(this.WHm(h))return!1}else ag.TableReader.isTable(h.target)||
h.target.kd(14),ag.TableReader.isTable(h.source)||h.source.kd(14),$d.moveToCell(h.target,h.rowIndex,h.ao),$d.moveToCell(h.source,0,0);if(Fg.TableCellReader.qg(h.source)||Fg.TableCellReader.qg(h.target))return!0;this.n1m(h,b);return!0}eKm(){if(this.AMc){for(var b=md.GraphIterator.$a(this.Sga),h=b.currentNode;14!==b.Se;)if(h=b.Wd(),!h){w.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.Bsi(h)}}iKm(b){this.AMc&&this.Bsi(b)}P6n(b){const h=
md.GraphIterator.$a(b);this.uJ.Seb(h,null,!0);b.qg=!1;b.rowSpan=1;b.colSpan=1}Bsi(b){if(b&&14===b.type){w.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var h={},n=ag.TableReader.ag(b),x=ag.TableReader.kh(b),E=md.GraphIterator.$a(b);$d.forEachCellInTable(E,(S,ma,Fa)=>{const $a={};S=S.currentNode;if(16===S.type)if(S.qg)bk.ioh(ma,Fa)in h||(this.P6n(S),$a.IsGhostCell="->false");else{bk.shn(b,S,ma,Fa,n,(Jb,Sb,oc)=>{$a.rowSpan=String.format("{0}:{1}->{2}",Jb,Sb,oc)});bk.rhn(b,
S,Fa,ma,x,(Jb,Sb,oc)=>{$a.colSpan=String.format("{0}:{1}->{2}",Jb,Sb,oc)});const sb=String.format("{0},{1}-{2},{3}",ma,Fa,ma+S.rowSpan,Fa+S.colSpan);for(let Jb=0;Jb<S.rowSpan;Jb++)for(let Sb=0;Sb<S.colSpan;Sb++)if(Jb||Sb)h[bk.ioh(ma+Jb,Fa+Sb)]=sb}if(0<Lr.a($a).length){if(void 0===$a.IsGhostCell||null===$a.IsGhostCell){if(void 0===$a.rowSpan||null===$a.rowSpan)$a.rowSpan=S.rowSpan;if(void 0===$a.colSpan||null===$a.colSpan)$a.colSpan=S.colSpan}w.ULS.sendTraceTag(39175904,307,50,"NormalizeTable: [{0},{1}]: {2}.",
ma,Fa,$a)}return!0});bk.AYk(h)}}SPl(b,h){if(b&&Cd.ParagraphReader.oc(b)){var n=0,x=md.GraphIterator.$a(b);for(x.Rb(6);!x.nr;){var E=x.currentNode;x.Vi(6);Pd.ImageReader.qw(E)?Pd.ImageReader.Jrf(E)?md.GraphIterator.$a(E).Zdb(59)?w.ULS.sendTraceTag(590455048,307,50,"HandleAnchoredObjectsForInternalCopy: Not converting anchored image to inline."):(this.paragraphEditor.nYe(E,Dd.a.Uc(b,n)),h.d++,n++):(E=md.GraphIterator.$a(E),E.Bb(12),E.Fg(),h.h++):w.ULS.shipAssertTag(6305571,307,!1)}}}get AMc(){return!!this.Ma&&
this.Ma.$("ComplexTableCellPasteWithFormattingIsEnabled")}Yil(b,h,n,x,E,S){const ma=[];let Fa,$a,sb,Jb;this.z6&&gq.TableBorderSelectionCache.oJc()?(Fa=Math.min(b,E+n),$a=Math.min(h,S+x),Jb=E):(Jb=0,Fa=Math.max(E+n,b));for(;Jb<Fa;Jb++)for(this.z6&&gq.TableBorderSelectionCache.oJc()?sb=S:(sb=0,$a=S+x,Jb<E?sb=h:Jb>=E&&Jb<Math.min(E+n,b)?sb=S:Jb>=E+n&&Jb<b?sb=h:$a=Math.max(S+x,h));sb<$a;sb++)ma.push(Array(2)),ma[ma.length-1][0]=Jb,ma[ma.length-1][1]=sb;return ma}HBc(b,h){if(!h.source.Wd())return b.si(Object(v.a)(this,
this.vib,"pasteTeardown")),!0;b.si(Object(v.a)(this,this.Jqh,"corePasteIteration"));return!0}Bsn(b,h){if(this.AMc)if(!h||!b)w.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{["source"]:b,["table"]:h});else if(16===h.currentNode.type&&16===b.parentNode.type){h=h.currentNode;b=b.parentNode;var n={};h.qg!==b.qg&&(h.qg=b.qg,n.IsGhostCell=h.qg);h.v2!==b.v2&&(h.v2=b.v2,n.IsSkippedCell=h.v2);h.qkb!==b.qkb&&(h.qkb=b.qkb,n.ShouldRenderCell=h.qkb);h.colSpan!==b.colSpan&&(n.ColSpan=String.format("{0}<={1}.",
h.colSpan,b.colSpan),h.colSpan=b.colSpan);h.rowSpan!==b.rowSpan&&(n.RowSpan=String.format("{0}<={1}.",h.rowSpan,b.rowSpan),h.rowSpan=b.rowSpan);Lr.a(n)}}Jqh(b,h){const n=h.source,x=h.target,E=n.currentNode;if(!E.Yea||!E.hJa||this.WSn(n,x))return b.si(Object(v.a)(this,this.GBc,"corePasteIncrement")),!0;if(Of.a.instance.J(3)&&Kf.OutlineElementReader.Nh(n)){if(!wf.OutlineElementNavigator.He(n).hJa)return wf.OutlineElementNavigator.ae(n),b.si(Object(v.a)(this,this.GBc,"corePasteIncrement")),!0;wf.OutlineElementNavigator.ae(n)}w.ULS.shipAssertTag(6305608,
307,!E.C0b());var S=x.currentNode.Bi().Ad;S=Fn.a(E,S,!0);S.vNa();S.zOd=!0;this.Bsn(n,x);x.SG(S,h.insertAfter,n.role);x.Ci(S);h.insertAfter=S;Of.a.instance.J(4)&&ob.App.rd.Kp&&ob.App.rd.Jq.sG(S);this.ZCh(E,S);h=new qq.a(b,Object(v.a)(this,this.HBc,"corePasteSetup"),new xs.a(n,x,null,h.fIf,h.xo));h.ll("RecursiveCorePasteOperation");h.run();b.si(Object(v.a)(this,this.KEk,"corePasteIterationPostProcessing"));return!0}WSn(b,h){let n=!1;Kf.OutlineElementReader.Nh(b)&&(n=Kf.OutlineElementReader.rP(b)&&this.Qjm(h));
return n}Qjm(b){if(b)return b=b.Se,36===b||38===b||16===b;throw Error.argument("IsTargetNodeInValidForIFrameContent: target iterator is null for paste.");}q8m(b,h,n){h=Ad.e(h);const x=Ad.e(n);for(let E=h.length-1;0<=E;E--){if(!h[E].Udc(n)){const S=Dd.a.createTextRange(n,h[E].Ob.cp,h[E].Ob.cp+1);bk.characterPropertiesEditor.replaceTextRange(S,"",void 0,void 0,void 0,void 0,!0)}h[E].tSc(x[E],b,Object(v.a)(this,this.HBc,"corePasteSetup"),this.V$l)}}KEk(b,h){const n=h.target,x=n.currentNode,E=h.source,
S=E.currentNode;let ma=-1;h.xo[bk.Wkf]&&(ma=h.xo[bk.Wkf]);Cd.ParagraphReader.oc(x)&&(this.v8m(b,Object(v.a)(this,this.HBc,"corePasteSetup"),S,x,h),this.q8m(b,S,x));x.SZ();h.xo[Xy.a.q8h]?22===x.type&&(Fg.TableCellReader.GZ(E)||x.setValue(ic.a.listID,Number.MAX_VALUE)):this.kG.sOi(x);if(Cd.ParagraphReader.oc(x)&&(h=Ad.i(x,5),0<h.length)){for(const Fa of h)!Fa.properties.hasProperty(ic.a.tGb)&&Fa.properties.hasProperty(ic.a.rZd)&&(h=Fa.properties.getValue(ic.a.rZd),Fa.properties.setValue(ic.a.tGb,h)),
Pd.ImageReader.n5b()?Pd.ImageReader.uDb(Fa.properties)&&this.hj.zUf(Fa.properties,ma):Pd.ImageReader.Sx(Fa.properties)||this.hj.zUf(Fa.properties,ma);x.Bi().contentReplicator.forceOutbound(null,null,null)}this.YCh(n);this.eko(S,x);ag.TableReader.XW(x)&&w.ULS.sendTraceTag(524919814,3022,50,"TablePasted");this.z6&&Fg.TableCellReader.tMa(n)&&Ng.eTi(x);n.nc();b.si(Object(v.a)(this,this.GBc,"corePasteIncrement"));return!0}eko(b,h){if(Of.a.instance.J(3)&&ag.TableReader.XW(b)){let n=0;const x=ag.TableReader.ag(b);
for(const E of ag.TableReader.Nw(b,0,x-1))E.az&&n++;b=this.Hc.Rc(4);b.Db(h);h.properties.setValue(ie.a.wva,x-n);b.dispose()}}GBc(b,h){if(!h.source.zu())return b.si(Object(v.a)(this,this.vib,"pasteTeardown")),!0;b.si(Object(v.a)(this,this.Jqh,"corePasteIteration"));return!0}vib(){ue.a.mark(5565);return!1}get z6(){null==this.r8&&(u.AFrameworkApplication.Hf("he991617;3eed2178"),this.r8=u.AFrameworkApplication.K?u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",
!1):!1);return this.r8}OUd(){return!md.GraphIterator.$a(this.Sga).Wd()}k8h(){return this.OXe?1===md.GraphIterator.$a(this.Sga).Hp():!1}mNh(b){try{return this.Hll(b)}catch(h){return w.ULS.sendTraceTag(23643968,307,10,"GetCopySourceFromDOMTree failed with exception:{0}",h.message),0}}Hll(b){let h=0;if(b&&(h=this.Gll(b),!h&&b.childNodes))for(let n=0;n<b.childNodes.length&&!(h=this.mNh(b.childNodes[n]));n++);return h}Gll(b){if(1===b.nodeType&&b.getAttribute){b=(b.getAttribute("class")||"").split(" ");
for(const h of b)if(h.startsWith(this.uSj))return h.startsWith(this.Puc)?this.Iu&&h===this.Puc+this.Iu?3:2:1}return 0}G7m(b,h,n,x,E){E.xo||(E.xo={});bk.sa.raiseEvent("OnParagraphCopy",new kv(b,h,n,x,E.xo))}i8m(b,h,n,x){x.xo||(x.xo={});bk.sa.raiseEvent("OnCopyComplete",new kv(b,null,h,n,x.xo))}t7m(b){b.xo||(b.xo={});bk.sa.raiseEvent("BeforePaste",new So(b.xo))}s7m(b){b.xo||(b.xo={});bk.sa.raiseEvent("BeforeCopy",new Di(this.Ns,b.xo))}v8m(b,h,n,x,E){bk.sa.raiseEvent("OnParagraphPaste",new kv(b,h,n,
x,E.xo))}YCh(b){Fg.TableCellReader.isTableCell(b)&&(b.Rb(1)||this.uJ.m5(b,!0),b.nc())}ZCh(b,h){this.X0.Eta(h)&&(h.width=b.width)}static hqd(b){bk.sa.addHandler("OnParagraphCopy",b)}static Jxc(b){bk.sa.addHandler("OnParagraphPaste",b)}static Lpn(b){bk.sa.removeHandler("OnParagraphPaste",b)}static Q5j(b){bk.sa.addHandler("OnCopyComplete",b)}static Y4j(b){bk.sa.addHandler("BeforePaste",b)}static gpn(b){bk.sa.removeHandler("BeforePaste",b)}static W4j(b){bk.sa.addHandler("BeforeCopy",b)}static Z4j(b){bk.sa.addHandler("BeforeTrimOnCopy",
b)}static S4j(b){bk.sa.addHandler("AfterTrimCompleteOnCopy",b)}static get characterPropertiesEditor(){return null!=bk.Kfg?bk.Kfg:bk.Kfg=Oa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get XF(){return Yy.a.instance}static get Ue(){return Nd.PageReader.instance}static AYk(b){const h={};for(const n of Lr.a(b)){const x=b[n];h[x]=x in h?String.format("{0}|{1}",h[x],n):n}1<=Lr.a(h).length&&w.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",h)}static rhn(b,h,n,x,E,S){h.colSpan>
E-n&&(S&&S("A",h.colSpan,E-n),h.colSpan=E-n);b=bk.XWn(b,h,x,n);h.colSpan!==b&&(S&&S("B",h.colSpan,b),h.colSpan=b)}static shn(b,h,n,x,E,S){h.rowSpan>E-n&&(S&&S("A",h.rowSpan,E-n),h.rowSpan=E-n);b=bk.YWn(b,h,n,x);h.rowSpan!==b&&(S&&S("B",h.rowSpan,b),h.rowSpan=b)}static XWn(b,h,n,x){return bk.Z3i(b,h.colSpan,(E,S)=>{$d.moveToCell(E,n,x+S)})}static YWn(b,h,n,x){return bk.Z3i(b,h.rowSpan,(E,S)=>{$d.moveToCell(E,n+S,x)})}static Z3i(b,h,n){if(14!==b.type)throw Error.argument("tableNode is not a Table.");
if(!n)throw Error.argumentNull("MoveToCellAction");for(let E=1;E<h;E++){var x=md.GraphIterator.$a(b);n(x,E);x=x.currentNode;if(!x||16!==x.type||!x.qg)return E}return h}static ioh(b,h){return b+","+h}n1m(b,h){for(;b.target.Wd();)b.target.Fg();b.ifc=new qq.a(h,b.mCi?b.mCi:Object(v.a)(this,this.HBc,"corePasteSetup"),new xs.a(b.source,b.target,null,b.fIf));b.ifc.ll("ExecuteCorePasteCellContentInCell");b.ifc.ah=!1;b.ifc.run()}WHm(b){let h=!1;if(this.z6&&gq.TableBorderSelectionCache.oJc()){const n=fm.a(b.target),
x=al.a.xt(b.target),E=Math.min(this.W9d,b.Mzc[b.Mzc.length-1][0]),S=Math.min(this.S2f,b.Mzc[b.Mzc.length-1][1]);Fg.TableCellReader.fMa(b.target)||Fg.TableCellReader.fMa(b.source)||x==E&&n==S?h=!0:(Fg.TableCellReader.isTableCell(b.target)||b.target.kd(16),Fg.TableCellReader.M$(b.source)?(Fg.TableCellReader.fMa(b.target)||($d.moveToNextRow(b.target),$d.moveToColumnByIndex(b.target,b.ao),w.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")),$d.moveToNextOrPreviousCell(b.source,
!1,!1)):Fg.TableCellReader.M$(b.target)||n==S?($d.moveToNextRow(b.source),$d.moveToColumnByIndex(b.source,0),w.ULS.sendTraceTag(537519906,307,50,"Move to next row to replace cell contents"),$d.moveToNextRow(b.target),$d.moveToColumnByIndex(b.target,b.ao),w.ULS.sendTraceTag(537519907,307,50,"Move to next row to replace cell contents")):($d.moveToNextOrPreviousCell(b.target,!1,!1),$d.moveToNextOrPreviousCell(b.source,!1,!1)))}else Fg.TableCellReader.fMa(b.source)?h=!0:(Fg.TableCellReader.isTableCell(b.target)||
b.target.kd(16),Fg.TableCellReader.M$(b.source)?($d.moveToNextRow(b.target),$d.moveToColumnByIndex(b.target,b.ao),w.ULS.sendTraceTag(537716887,307,50,"Move to next row to replace cell contents")):$d.moveToNextOrPreviousCell(b.target,!1,!1),$d.moveToNextOrPreviousCell(b.source,!1,!1));h&&(this.fY&&this.fY.s8m(b.target,b.Mzc),ag.TableReader.isTable(b.target)||b.target.kd(14),this.iKm(b.target.currentNode),w.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"));return h}dNn(){this.W9d=
gq.TableBorderSelectionCache.h7.bottomMostRowSelected;this.S2f=gq.TableBorderSelectionCache.h7.rightMostColumnSelected;this.m4n=gq.TableBorderSelectionCache.h7.leftMostColumnSelected;this.V8i=gq.TableBorderSelectionCache.h7.topMostRowSelected}}bk.sa=new Ge.a;bk.Wkf="PasteConstrainingWidth";Object(r.a)(bk,"InternalClipboard",null,[]);var Zy=d(637);class Rz extends sm{constructor(b,h,n,x,E,S,ma,Fa){super(b,h,n,E,S,Fa);this.jz=x;this.AH=ma}get qk(){return this.AH.value}get OUd(){return this.jz.OUd()}get zCi(){const b=
this.jz;return b.OXe&&!b.k8h()}ZDh(b,h){w.ULS.shipAssertTag(6305616,307,gf.OutlineReader.rw(b));const n=Zy.a(b.currentNode);if(gf.OutlineReader.isEmpty(b)){var x=Dd.a.create(b.currentNode);b.at(8);u.AFrameworkApplication.ya.Qf(x,Db.a.HG,2,!0,null,null)}else b.at(8);(x=b.dE(1))&&b.nc();this.jz.iCi(this.Ri.ve,b.currentNode,x,-1,n,h)}YDh(b){const h=new md.GraphIterator;this.TNa.restore(h);w.ULS.shipAssertTag(6305618,307,Kf.OutlineElementReader.Nh(h));this.Ri.zQ&&this.Ri.zQ.$Wb("internal");let n=-1;if(this.b1i&&
Object(pb.a)(87,this.Ri.Bd))n=this.Ri.Bd.ia(Ji.a.Qda,-1);else{const x=this.Vml(h.currentNode);n=x?x.clientWidth:n}this.jz.iCi(this.Ri.ve,h.parentNode,h.currentNode,n,null,b);this.$ci&&(this.TNa.restore(h),Kf.OutlineElementReader.Nh(h)&&this.jz.fgi(h)&&(b=wf.OutlineElementNavigator.He(h)))&&(this.Ri.fXa=Ae.SelectionFactory.xe(b,0))}Vml(b){return b?(b=b?b.De(this.qk.Tb):null)?b.htmlElement:null:null}a2i(){const b=new md.GraphIterator;this.TNa.restore(b);return this.jz.fgi(b)}get r1i(){return ec.ListReader.pr}get r_c(){return!this.jz.dsa&&
!this.jz.OXe}}Object(r.a)(Rz,"InternalPasteExecutionManager",sm,[]);class zA{constructor(b,h,n,x){this.jz=b;this.fY=h;this.AH=n;this.B4=x}create(b,h,n){return new Rz(b,h,n,this.jz,this.fY,ob.App.xa.jb,this.AH,this.B4)}}Object(r.a)(zA,"Factory",null,[532]);var gy;(function(b){b[b.unknown=0]="unknown";b[b.differentBox4App=1]="differentBox4App";b[b.sameBox4AppDifferentSession=2]="sameBox4AppDifferentSession";b[b.sameBox4AppSameSession=3]="sameBox4AppSameSession"})(gy||(gy={}));Object(r.b)("CopySource",
gy);class Sp{constructor(b,h,n){this.jz=b;this.MHg=h;this.eBj=n}m1m(b,h,n){w.ULS.shipAssertTag(6305620,307,!!b);w.ULS.shipAssertTag(6305621,307,Kd.SelectionEditor.xf(h));w.ULS.shipAssertTag(6305622,307,!!n);w.ULS.shipAssertTag(6305623,307,Object(pb.a)(lp.a,n.Ffa));const x=n.Ffa;x.tZb=this.jz.mNh(b);this.owm(b,x);const E=this.hdm(x);var S=new Se.GraphTransaction(7,Db.a.paste);S.Db(h.node);h.node.MG().sF.p9(8);E?(w.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",x.iA,x.browserName),
b=this.MHg.create(h,x,S)):(w.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",x.iA,x.tZb,x.browserName),Sp.hwm(b),b=this.eBj.create(b,h,x,S));n=new qq.a(n,Object(v.a)(b,b.oCi,"pasteSetup"),null);n.ll("Paste");n.run()}hdm(b){return!this.Yfm(b)&&3===b.tZb}Yfm(b){return 1===(b.iA&8192?1:0)}r8h(b,h){w.ULS.shipAssertTag(6305624,307,Kd.SelectionEditor.xf(b));w.ULS.shipAssertTag(6305625,307,!!h);w.ULS.shipAssertTag(6305626,307,Object(pb.a)(lp.a,h.Ffa));const n=new Se.GraphTransaction(7,
Db.a.XLd);n.Db(b.node);b=this.MHg.create(b,h.Ffa,n);h=new qq.a(h,Object(v.a)(b,b.oCi,"pasteSetup"),null);h.ll("InternalPasteAtIp");h.run()}owm(b,h){if(b){let n=!1,x=!1;b.innerHTML&&0<=b.innerHTML.indexOf("mso-tab-count")?x=!0:b.innerText&&0<=b.innerText.indexOf("\t")&&(n=!0);(n||x)&&w.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",gy[h.tZb],n,x)}}static hwm(b){b&&Sp.DYj.test(b.innerText)&&w.ULS.sendTraceTag(6350173,
307,50,"External paste operation starts on WebUrl")}}Sp.DYj=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(r.a)(Sp,"PasteCoordinator",null,[]);class lv{constructor(b,h,n,x,E){this.psa=b;this.ugb=h;this.A1m=n;this.z1m=x;this.TMc=E}}Object(r.a)(lv,"PastedContentsPostProcessorParams",null,[]);class Lt{Q1l(b,h,n,x,E,S){b=this.uql(b,h,E);n=this.Vul(n);if(!b||!n)return null;x=this.SBl(b,x,E);E=this.RBl(n);return new lv(b,n,x,E,S)}uql(b,
h,n){b=n?b:h;if(!Kf.OutlineElementReader.Nh(b))return null;h=new Lf.a;h.fd(b);return h}Vul(b){if(!Kf.OutlineElementReader.Nh(b))return null;const h=new Lf.a;h.fd(b);wf.OutlineElementNavigator.J2(h,!1,!1);return h}SBl(b,h,n){wf.OutlineElementNavigator.He(b);let x=-1;Cd.ParagraphReader.wh(b)&&(x=n?h:0);wf.OutlineElementNavigator.ae(b);return x}RBl(b){wf.OutlineElementNavigator.He(b);const h=Cd.ParagraphReader.wh(b)?Cd.ParagraphReader.textLength(b.currentNode):-1;wf.OutlineElementNavigator.ae(b);return h}}
Object(r.a)(Lt,"PastedContentsPostProcessorHelper",null,[]);var ar=d(600),or=d(1049),Go=d(1047);class Mt{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb=null){this.rvh=100;this.m7b=!1;this.Fke=null;this.mte=!1;this.jhd=null;this.Bdd=this.dHa=!1;this.Xpa=b;this.JD=h;this.Yc=n;this.Nhd=x;this.xi=E;this.Exa=S;this.Ma=ma;this.IOj=Fa;this.pv=$a;this.YU=sb;this.Wv=Jb;this.fHa=Sb;this.s_n()}s_n(){this.JD.h9g(Object(v.a)(this,this.ZUn,"showFloatieHandler"));this.JD.P8g(Object(v.a)(this,this.x$k,"floatieDismissedHandler"))}FHk(b,
h){var n;this.Exa.dnf();1===this.IOj.SHk(h.aUc)?w.ULS.sendTraceTag(575255107,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId):this.showFloatie(b,h)?(this.dHa?this.dHa=!1:this.Hln(),this.xWc(),b="Box4 Paste floatie created."+String.format(" PasteCommand: {0}, CorrelationId: {1}",Db.a.gT(h.DQ)||"Unknown",h.correlationId),w.ULS.sendTraceTag(40379588,307,50,b),Pe.a("Box4PasteFloatieCreated",!0,void 0,[Object.assign(new ca.a,{name:"PasteCommand",int64:Db.a.gT(h.DQ)||"Unknown"}),
Object.assign(new ca.a,{name:"CorrelationId",string:null===(n=h.correlationId)||void 0===n?void 0:n.toString()})]),this.xLb()):w.ULS.sendTraceTag(575255108,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId)}Vu(b){var h;!this.mte&&(this.dHa||(this.fHa?null===(h=this.Wv)||void 0===h?0:h.EZ:this.Xpa.EZ()))&&(b&&(this.Exa.dnf(),this.Ddj(),w.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this.jhd)),this.dHa=!b,this.$ae(),
this.fHa?u.AFrameworkApplication.ya.processAction(Db.a.iBb,2):this.Xpa.Vu())}Hln(){this.Bdd||(this.Fke=this.Yc.xd,af.a.addHandler(this.Fke.container,"scroll",Object(v.a)(this,this.CIb,"scrollHandler")),this.xi.i1(Object(v.a)(this,this.fga,"resizeHandler")),this.Bdd=!0)}Ddj(){this.Bdd&&(af.a.removeHandler(this.Fke.container,"scroll",Object(v.a)(this,this.CIb,"scrollHandler")),this.xi.dga(Object(v.a)(this,this.fga,"resizeHandler")),this.Bdd=!1)}xLb(){if(this.fHa)this.Wv.EZ&&u.AFrameworkApplication.ya.processAction(Db.a.iBb,
2),u.AFrameworkApplication.ya.processAction(Db.a.K_c,2),this.m7b=!1;else{const b=new Go.a(0,u.AFrameworkApplication.isRtl);b.location=this.Exa.$Ka();this.Exa.rbm(b.location)?this.showFloatie(null,b):this.JD.mDa(new or.a(!1))}}fga(){this.fHa?(u.AFrameworkApplication.ya.processAction(Db.a.iBb,2),this.JCc()):this.xLb()}CIb(){this.fHa?(u.AFrameworkApplication.ya.processAction(Db.a.iBb,2),this.JCc()):this.xLb()}x$k(b,h){this.Vu(h.F6k)}ZUn(b,h){this.FHk(b,h)}xWc(){this.Nhd.g6j(Object(v.a)(this,this.axi,
"onOnlyKeyPressed"));this.JD.T8g(Object(v.a)(this.Xpa,this.Xpa.GAd,"expandFloatie"));this.JD.d9g(Object(v.a)(this,this.qCi,"pastedFloatieStatusChange"));this.pv.rs(Object(v.a)(this,this.Cfa,"onParagraphConnect"));this.pv.xv(Object(v.a)(this,this.SFb,"onParagraphDisconnected"));this.pv.jp(Object(v.a)(this,this.Q2,"onParagraphPropertyChanged"))}$ae(){this.Nhd.Ipn(Object(v.a)(this,this.axi,"onOnlyKeyPressed"));this.JD.vNi(Object(v.a)(this.Xpa,this.Xpa.GAd,"expandFloatie"));this.JD.CNi(Object(v.a)(this,
this.qCi,"pastedFloatieStatusChange"));this.pv.dM(Object(v.a)(this,this.Cfa,"onParagraphConnect"));this.pv.Iaa(Object(v.a)(this,this.SFb,"onParagraphDisconnected"));this.pv.wX(Object(v.a)(this,this.Q2,"onParagraphPropertyChanged"))}qCi(b,h){this.mte=h.XMc;h.DQ&&(this.jhd=h.DQ);h.wZf&&this.Xpa.EZ()&&this.xLb()}Q2(b,h){h.property===ie.a.lastModifiedTime?(w.ULS.sendTraceTag(520734533,307,50,"Last Modified Time was used "),this.YU.h0e.contains(Db.a.r7f)||this.fOf(h)):w.ULS.sendTraceTag(520734532,307,
50,"Last Modified Time was NOT used but theoretically would be if we remove Last Modified was removed.")}SFb(b,h){this.fOf(h)}Cfa(b,h){h.Cof||this.fOf(h)}fOf(b){b.node.loading||this.JD.mDa(new or.a(!0))}showFloatie(b,h){h||(h=new Go.a(0,u.AFrameworkApplication.isRtl));h.location||(h.location=this.Exa.$Ka());if(!h.location)return!1;this.dHa&&(this.dHa=!1,this.xWc());this.fHa?u.AFrameworkApplication.ya.processAction(Db.a.K_c,2):this.Xpa.showFloatie(b,h);return!0}JCc(){if(!this.m7b){const b=new We.a(3,
1,this.rvh,()=>{this.xLb()},215);Ye.a.instance.$b(b);this.m7b=!0}}axi(){ar.a.instance.keyCode===db.a.Uva&&this.JD.AHi()}}Object(r.a)(Mt,"PasteFloatieEventManager",null,[]);class Dw{constructor(b,h){this.Xj=b;this.mH=h}SHk(b){return tj.any(tj.where(tj.asEnumerable(Dw.T1n),h=>this.mH.lOc(h)))?(b=this.Xj.rib(b))&&(b=b.innerText)&&0<b.trim().length?0:1:1}}Dw.T1n=[Db.a.reformatPastedContent.toString(),Db.a.jOa.toString(),Db.a.Pua.toString()];Object(r.a)(Dw,"PasteFloatieFeatureSetBuilder",null,[]);class nu{constructor(){this.Cua=
null;this.cac=0}}Object(r.a)(nu,"PasteFloatieAnchorData",null,[]);class ou{constructor(b,h,n,x,E,S=!1){this.Orb=null;this.hb=b;this.wqa=h;this.Yc=n;this.aDj=x;this.Xpa=E;this.fHa=S}dnf(){this.Orb=null}$Ka(){const b=this.Fcf(this.Orb)||this.Ahh();if(!b){let h="null",n="null";if(this.Orb&&this.Orb.Cua){if(!this.Yc.xd)return w.ULS.sendTraceTag(51143187,307,15,"SelectoinView is null when we try to get floatie position"),null;h=Object.getType(this.Orb.Cua).getName();const x=this.Orb.Cua.Ui(this.Yc.xd.Tb);
x&&(n=Object.getType(x).getName())}w.ULS.shipAssertTag(40641054,307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",h,n)}return b}rbm(b){if(!b)return!1;const h=this.Xpa.Izb(),n=this.aDj(this.Yc.xd.container);b=new Sys.UI.Bounds(b.x,b.y,h.width,h.height);return b.y>=n.y&&b.y+b.height<=n.y+n.height}Ahh(){if(!this.hb||!this.hb.ib||!this.hb.ib.kb)return w.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),null;var b=this.hb.ib.kb.Qa,
h=!b.cpBegin&&!b.cpEnd;let n=b.node;if(n&&h){do n=this.vVh(n);while(n&&Object(pb.a)(Tc.AParagraphNode,n)&&!n.characterData.trim().length)}let x="";const E=Object(ja.a)(Tc.AParagraphNode,n);E&&(x=E.characterData.length===b.cpBegin||h?E.characterData.trimEnd():E.characterData.substring(0,b.cpBegin).trimEnd());h=E?x.length:b.cpBegin;b=Object.assign(new nu,{Cua:Object(ja.a)(62,(E?Object(ja.a)(62,E):Object(ja.a)(62,n))||b.node),cac:h});return this.Fcf(b)}vVh(b){const h=new md.GraphIterator;if(!b.anchor)return null;
h.set(b);if(!h.vd())return null;h.kd(11);return h.QG()?h.Rb(2):null}Fcf(b){if(!b||!b.Cua)return null;this.Orb=b;const h=this.Yc.xd;if(!h)return w.ULS.sendTraceTag(51143188,307,15,"SelectoinView is null when we try to get floatie position"),null;b=this.CQh(b,h);if(!b)return null;u.AFrameworkApplication.isRtl&&this.Xpa.EZ()&&(b.x-=this.Xpa.Izb().width);return new Sys.UI.Point(b.x+b.width,b.y+b.height)}CQh(b,h){h=Object(ja.a)(182,b.Cua.Ui(h.Tb));if(!h)return null;let n=null;if(Object(pb.a)(Tc.AParagraphNode,
b.Cua)){const x=Object(ja.a)(80,h);if(!x)return null;try{n=this.wqa.UY(b.cac,x,0<b.cac,!1,!1,!1),n.height+=this.fHa?ou.Bdn:ou.A$k}catch(E){w.ULS.sendTraceTag(40953486,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",E),n=null}}else Object(pb.a)(Qu.TableNode,b.Cua)&&(n=Object(ja.a)(394,h).Pgf());n||(n=h.getBounds());return n}}ou.A$k=2;ou.Bdn=60;Object(r.a)(ou,"PasteFloatiePositionProvider",null,[]);class uj{constructor(b,h){this.zlc=b;this.Uwj=h}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get MIh(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get F0e(){return CommonUIStrings.l_ClipboardCut}get vxf(){return CommonUIStrings.l_ClipboardCut_Mac}get FYe(){return CommonUIStrings.l_ClipboardCopy}get uxf(){return CommonUIStrings.l_ClipboardCopy_Mac}get uJf(){return CommonUIStrings.l_ClipboardPaste}get wxf(){return CommonUIStrings.l_ClipboardPaste_Mac}get V6(){return CommonUIStrings.l_ClipboardPasteText}get xxf(){return CommonUIStrings.l_ClipboardPasteText_Mac}get UVe(){return this.Uwj}get Xlh(){return CommonUIStrings.l_ClipboardExtensionLink}get nab(){return CommonUIStrings.l_ClipboardExtensionSuggestion}pEh(){w.ULS.sendTraceTag(8716421,
307,50,null);rd.a.ym(this.UVe,"_blank",void 0,"ClipboardAccessExtensionLink")}Jaa(b,h){let n=V.a.wl;u.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(n=V.a.ki||n);return n?String.format(h,"\u2318"):b}dispose(){this.zlc=null}tOf(b){this.Eqh(b)}hpm(b){this.Eqh(b)}Eqh(b){this.zlc&&this.zlc(b)}}uj.id="CopyPasteShortcutDialog";uj.v9i="CopyPasteText";Object(r.a)(uj,"ACopyPasteShortcutDialog",null,[10]);class pu extends uj{constructor(b,h,n){super(b,h);b=document.createElement("span");
b.className="WACCopyPasteShortcutDialogTextPanel";h=document.createElement("span");h.id=uj.v9i;var x=document.createElement("span");x.innerText=this.MIh;var E=document.createElement("span");E.className="UIFontBold";E.innerText=this.Jaa(this.F0e,this.vxf);const S=document.createElement("span");S.className="UIFontBold";S.innerText=this.Jaa(this.FYe,this.uxf);const ma=document.createElement("span");ma.className="UIFontBold";ma.innerText=this.Jaa(this.uJf,this.wxf);h.appendChild(x);h.appendChild(document.createElement("br"));
h.appendChild(E);h.appendChild(S);h.appendChild(ma);n.$("PasteTextOnlyShortcutDialogIsEnabled")&&(V.a.So||V.a.fj)&&(n=document.createElement("span"),n.className="UIFontBold",n.innerText=this.Jaa(this.V6,this.xxf),h.appendChild(n));b.appendChild(h);this.UVe?(w.ULS.sendTraceTag(8716420,307,50,null),n=document.createElement("span"),h=document.createElement("a"),h.href="#",h.innerText=this.Xlh,af.a.addHandler(h,"click",Object(v.a)(this,this.pEh,"extensionLinkHandler")),n.appendChild(h),E=this.nab.indexOf("{0}"),
-1!==E&&(x=this.nab.substring(0,E),E=this.nab.substring(E+3,this.nab.length),x=document.createTextNode(x),E=document.createTextNode(E),n.insertBefore(x,h),n.appendChild(E)),b.appendChild(document.createElement("br")),b.appendChild(n)):w.ULS.sendTraceTag(8716422,307,50,null);n=new yd.StandardDialog;n.Ed=0;n.kg=uj.id;n.Lv(this.titleText,null,0,Object(v.a)(this,this.hpm,"legacyCopyPasteShortcutDialogHandler"),b);n.m3(uj.v9i)}}Object(r.a)(pu,"CopyPasteShortcutDialog",uj,[]);class iq extends uj{constructor(b,
h){super(b,h);h={};b=this.d5l;h.extensionStartText=this.P3k;h.extensionLink=null;h.extensionEndText=null;h.shortcutsMessageText=this.LPn;h.cutText=this.Jaa(this.F0e,this.vxf);h.copyText=this.Jaa(this.FYe,this.uxf);h.pasteText=this.Jaa(this.uJf,this.wxf);4!==u.AFrameworkApplication.ua.Sb.jo&&(h.pasteTextOnly=this.Jaa(this.V6,this.xxf));h={["id"]:"CopyPasteInstallDialog",["bodyControls"]:h};const n=new Kc.a(!1,!1,!0);n.kg="CopyPasteInstallDialog";n.Ed=0;n.We(1,this.c5l);n.lU(1);n.Zh(b,Object(v.a)(this,
this.tOf,"reactCopyPasteShortcutDialogHandler"),h)}get LPn(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get c5l(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get d5l(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get P3k(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}static LTn(){var b=window.location.origin;return b?RegExp("^https:\\/\\/((.*?(word-edit|powerpoint|onenote|excel|visio)\\.(officeapps\\.live\\.com|partner\\.officewebapps\\.cn|gov\\.online\\.office365\\.us|dod\\.online\\.office365\\.us))|(project\\.microsoft\\.com))$",
"g").test(b):!1}}Object(r.a)(iq,"ReactCopyPasteInstallDialog",uj,[]);class hy extends uj{constructor(b){super(b,null);this.$ii="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";var h={};b=this.GJm;var n="";let x="";this.messageText&&(n=this.messageText.split(" {")[0],x=this.messageText.split("} ")[1]);h.startText=n;h.endText=x;h.cutText=this.dOk;h.copyText=this.qEk;h.pasteText=this.r1m;
h.cutShortcutText=this.Jaa(this.eOk,this.DBm);h.copyShortcutText=this.Jaa(this.BEk,this.CBm);h.pasteShortcutText=this.Jaa(this.u1m,this.FBm);h.imageSrc=ig.a.y9("NoClipboardAccessDialogImage.svg");h.imageAltText=this.imageAltText;h.primaryButtonLabel=this.L6m;this.$ii&&(w.ULS.sendTraceTag(527986756,307,50,"Learn more link is available"),h.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.Cgb,["onExecute"]:()=>{this.cpm()}});h={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:h};
n=new Kc.a(!1,!1,!0);n.Ed=0;n.kg="CopyPasteNoClipboardAccessDialog";n.Zh(b,Object(v.a)(this,this.tOf,"reactCopyPasteShortcutDialogHandler"),h)}get GJm(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get Cgb(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get imageAltText(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get L6m(){return CommonUIStrings.l_DialogOk}get dOk(){return CommonUIStrings.l_CutString}get eOk(){return CommonUIStrings.l_CutShortcut}get DBm(){return CommonUIStrings.l_CutShortcut_Mac}get qEk(){return CommonUIStrings.l_CopyString}get BEk(){return CommonUIStrings.l_CopyShortcut}get CBm(){return CommonUIStrings.l_CopyShortcut_Mac}get r1m(){return CommonUIStrings.l_PasteString}get u1m(){return CommonUIStrings.l_PasteShortcut}get FBm(){return CommonUIStrings.l_PasteShortcut_Mac}cpm(){w.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");rd.a.ym(this.$ii,"_blank",void 0,"learnMoreLink")}}Object(r.a)(hy,"ReactCopyPasteNoClipboardAccessDialog",uj,[]);class Xs extends uj{constructor(b,h,n){super(b,h);b={};b.forwardElementText=this.MIh;b.cutText=this.Jaa(this.F0e,this.vxf);b.copyText=this.Jaa(this.FYe,this.uxf);b.pasteText=this.Jaa(this.uJf,this.wxf);n.$("PasteTextOnlyShortcutDialogIsEnabled")&&(V.a.So||V.a.fj)&&(b.pasteTextOnly=this.Jaa(this.V6,this.xxf));this.UVe?(w.ULS.sendTraceTag(40726914,307,
50,null),b.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.Xlh,["onExecute"]:x=>{this.pEh(x)}},n=this.nab.indexOf("{0}"),-1!==n&&(b.suggestionPrefixElement=this.nab.substring(0,n),b.suggestionSuffixElement=this.nab.substring(n+3,this.nab.length))):w.ULS.sendTraceTag(40726915,307,50,null);n={["id"]:uj.id,["bodyControls"]:b};b=new Kc.a(!1,!1,!0);b.Ed=0;b.kg=uj.id;b.Zh(this.titleText,Object(v.a)(this,this.tOf,"reactCopyPasteShortcutDialogHandler"),n)}}Object(r.a)(Xs,"ReactCopyPasteShortcutDialog",
uj,[]);class Su{constructor(){this.Hpa=!!u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.zA}eZe(b,h,n=!1){w.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.Hpa,n));this.Hpa?n?new iq(b,h):new Xs(b,h,u.AFrameworkApplication.K):new pu(b,h,u.AFrameworkApplication.K)}static get instance(){return Su._instance||(Su._instance=new Su)}}Su._instance=null;Object(r.a)(Su,"CopyPasteShortcutDialogFactory",null,[938]);class Pn{constructor(b,h,n,x,
E,S,ma,Fa){this.GZg=this.FJg=this.dHe=!1;this.mVj=b;this.Yc=h;this.mt=n;this.Wb=x;this.Ud=E;this.$f=S;this.te=ma;Fa&&(this.GZg=Fa.$("ShouldLogExecCommandCopySuccess"))}get EPa(){return this.mVj}get OZa(){return this.FJg}set OZa(b){this.FJg=b;this.$f.ignoreClipboardEvents=b}GEc(b){this.EPa.GEc(b);b||this.g1c(!0)}get d1k(){return this.EPa.fTf}prepareForPaste(b){this.OZa=!0;this.EPa.prepareForPaste(b,this.Q2f)}reset(){this.OZa=!1}paste(){var b=null;let h=null;if(!this.EPa.fMb){(b=this.Yc.xd)&&this.Wb.Jg(b.aI);
var n=this.mt.uv;if(!n.Be||!n.editingView.Cj)return null;h=n.editingView;b=this.Ud.lp();this.OZa=!0;n.bFa()}n=null;try{h&&h.z5m(),n=b=this.EPa.TEc(this.Q2f,b)}catch(x){w.ULS.shipAssertTag(6305672,307,!1),this.$0h()}this.OZa=!1;return n}copy(){var b=this.Yc.xd;b&&this.Wb.Jg(b.aI);b=this.mt.uv;if(!b.Be||1!==b.editingView.mode)return!1;this.OZa=!0;let h;try{const n=new Map;n.set("View","ContentEditableView");ta.Health.instance.recordKpiUsage(cu.a.btd,0,cu.a.sUe,n);const x=this.EPa.x6e(this.Q2f);h=!0;
this.GZg&&w.ULS.sendTraceTag(558384097,307,50,"execCommandCopySuccess, {0}, browser: {1}",x,this.te.WE);if(!x){const E=Object.assign(new ab.a,{extendedProperties:n});ta.Health.instance.recordKpiFailure(cu.a.btd,cu.a.sjh,!0,!0,E)}}catch(n){w.ULS.shipAssertTag(6305673,307,V.a.fj),w.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",V.a.WE),h=!1}this.OZa=!1;return h?!0:!1}g1c(){if(this.dHe)return!0;var b=this.mt.uv;if(!b.Be||!b.editingView.Cj)return!1;
const h=b.editingView;b=this.Ud.lp();this.OZa=!0;const n=new Bl.a(b);let x=!1;try{x=this.EPa.g1c(b,()=>{h.Wtd()},()=>{h.HDa()})}catch(E){w.ULS.shipAssertTag(6305674,307,!V.a.zk)}n.restore();this.OZa=!1;x?this.dHe=!0:(w.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",V.a.WE),V.a.zk||this.$0h());return x}$0h(){this.dHe=!1;if(u.AFrameworkApplication.too)Su.instance.eZe(null,null);else{const b=new yd.StandardDialog;b.Ed=0;b.nU(CommonUIStrings.l_ClipboardAccessDeniedTitle,
CommonUIStrings.l_ClipboardAccessDenied,null)}}get Q2f(){const b=this.Ud.UKa();return b?b.yn:null}}Object(r.a)(Pn,"SystemClipboard",null,[529]);class mo{constructor(b,h,n){this.bod=!1;this.Eod=this.XR=this.AMg=this.Yie=this.$6c=null;this.l4m=x=>{1===x?(w.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.Mie)),this.BVb&&(w.ULS.sendTraceTag(594882642,307,50,String.format("_useInstallDialog={0}",this.BVb)),rd.a.ym(this.Cpe+this.aze,"_blank",void 0,"ChromeCCPInstallDialog"))):
x||w.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.Mie))};this.Mie=b.$("ChromeClipboardAccessExtensionSuggestionIsEnabled");this.Cpe=b.lb("ChromeClipboardAccessExtensionLink");this.m6a=h;this.Xj=n;this.aze=b.lb("ChromeClipboardAccessExtensionId");this.JXj=b.$("UseGetClipboardDataIsEnabled");this.SVg=b.$("RecordExtensionInstallStatusKpiIsEnabled");this.BVb=!1;b.$("CcpInstallDialogIsEnabled")&&u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.zA&&(this.BVb=iq.LTn()||
b.$("IgnoreDomainCheckCcpInstallDialog"),w.ULS.sendTraceTag(587314304,307,50,"_useInstallDialog: {0}",this.BVb));this.Bmc=null}GEc(b){b?this.XR=!0:(this.XR=null,chrome.runtime&&chrome.runtime.sendMessage?(this.Bmc=this.m6a.lxd,this.m6a.lkb?(this.bod=this.JXj,this.lkh()):(this.bod=!0,this.lkh(),w.ULS.sendTraceTag(19256732,307,50,C.a.create().toString()))):(this.UJb(),this.XR=!1))}get fTf(){return this.XR}get fMb(){return this.Eod}g1c(){return!0}x6e(b){w.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy");
(b=rd.a.tyb(b,"copy"))||w.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)));return b}Jaf(b){if(!b)return null;var h=b.img;const n=b.text;b=b.html;const x=this.Xj.pUi(!!h,!!n,b);let E=null;if(3===x){if(!b)return null;h=this.Xj.yEh(b);(h=this.Xj.FEh(h))&&(b+=h);E=this.Xj.rib(b)}else 2===x?E=this.Xj.kJf(n,!0):1===x&&(E=this.Xj.rib(h));return E}TEc(b,h){if(this.fMb)h=this.Jaf(this.Yie),this.Yie=null;else{if(!this.$6c)return h;
b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=this.$6c;h=b.body;this.$6c=null}return h}prepareForPaste(b){const h=C.a.create();this.AMg=h;this.m6a.lkb?w.ULS.sendTraceTag(7377737,307,50,h.toString()):w.ULS.sendTraceTag(19256735,307,50,h.toString());const n={};n.command=this.fMb?"getClipboardData":"paste";chrome.runtime.sendMessage(this.Bmc,n,x=>{h.equals(this.AMg)?this.fMb?this.Yie=x:this.$6c=x:w.ULS.sendTraceTag(7385868,307,50,null);w.ULS.sendTraceTag(7377738,307,50,h.toString());
chrome.runtime.lastError&&(this.tYk(),this.m6a.lkb?w.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):w.ULS.sendTraceTag(19256737,307,10,chrome.runtime.lastError.message));b()})}UJb(){w.ULS.sendTraceTag(8716423,307,50,null);let b=null;this.BVb?b=this.Cpe+this.aze:this.Mie&&(b=this.Cpe+this.Bmc);Su.instance.eZe(this.l4m,b,this.BVb)}tYk(){this.m6a.hun();this.UJb()}vVi(b,h){chrome.runtime.sendMessage(b,{command:"test",object:"ping"},h)}Krk(){const b=C.a.create();this.m6a.lkb?w.ULS.sendTraceTag(592491466,
307,50,b.toString()):w.ULS.sendTraceTag(591984031,307,50,b.toString());chrome.runtime.sendMessage(this.Bmc,{command:"getAvailableCommands"},h=>{w.ULS.sendTraceTag(592491467,307,50,b.toString());h?Object(pb.a)(Array,h)?(w.ULS.sendTraceTag(592491470,307,50,"Extension responded: {0}",h),this.Eod=-1!==Array.indexOf(h,"getClipboardData")):(w.ULS.sendTraceTag(592491469,307,15,"ChromeApi has non-string[] response. o: {0}",h),this.Eod=!1):(w.ULS.sendTraceTag(592491468,307,15,"ChromeApi has null response. ErrorMsg: {0}",
chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.Eod=!1)})}lkh(){const b=C.a.create();this.m6a.lkb?w.ULS.sendTraceTag(7726105,307,50,b.toString()):w.ULS.sendTraceTag(591984032,307,50,b.toString());this.bod&&this.Krk();this.vVi(this.Bmc,h=>{w.ULS.sendTraceTag(7726106,307,50,b.toString());h&&"ping"===h?this.XR=!0:(h?"ping"!==h&&w.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",h,chrome.runtime.lastError?chrome.runtime.lastError.message:null):
w.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.UJb(),this.XR=!1);this.bod&&!this.fMb&&w.ULS.sendTraceTag(592491471,307,50,"No response for CheckGetClipboardDataExistenceAsync")})}fli(b,h){const n={};n.OfficeOnlineExtensionInstallationStatus=b;n.OfficeClipboardExtensionInstallationStatus=h;w.ULS.sendTraceTag(51144839,307,50,JSON.stringify(n));this.SVg&&(b&&ta.Health.instance.recordKpiSuccess(mo.hRg,
null),h&&ta.Health.instance.recordKpiSuccess(mo.eRg,null))}fvm(){this.SVg&&(ta.Health.instance.recordKpiUsage(mo.hRg,1,mo.cCg,null),ta.Health.instance.recordKpiUsage(mo.eRg,1,mo.cCg,null));if(chrome.runtime&&chrome.runtime.sendMessage){var b=!this.m6a.lkb;this.vVi(this.aze,h=>{this.fli(b,!!h)})}else this.fli(!1,!1)}}mo.hRg="OfficeOnlineExtensionInstallationStatus";mo.eRg="OfficeClipboardExtensionInstallationStatus";mo.cCg="wwccp";Object(r.a)(mo,"ChromeSystemClipboardAccessManager",null,[563]);class mv{constructor(b,
h){this.XR=null;this.te=b;this.Ma=h;this.ovj=!this.Ma.$("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&this.Ma.$("BlockCopyCutOnFirefoxIsEnabled");this.ESj=h.$("SetResultForEnsureAccessOperationForElectronIsEnabled")}GEc(b){this.ovj&&b&&this.te.fj?(this.UJb(),this.XR=!1):this.XR=!0}get fTf(){return this.XR}get fMb(){return!1}x6e(b){return rd.a.tyb(b,"copy")}TEc(b,h){rd.a.tyb(b,"paste");return h}prepareForPaste(b){b()}g1c(b,h,n){if(this.te.l2)return this.ESj&&(this.XR=!1),!1;h();n();b=this.TEc(b.ownerDocument,
b);h=b.innerHTML;b.innerHTML=na.a.create().toString();n();b=this.TEc(b.ownerDocument,b);return this.XR=b=h===b.innerHTML}UJb(){Su.instance.eZe(null,null)}}Object(r.a)(mv,"DefaultSystemClipboardAccessManager",null,[563]);class Sz{constructor(b,h,n){this.XR=this.l8=this.NSb=this.xia=this.bTa=this.W6c=null;this.Xj=h;this.lTa=n;this.EKj=b.rc("ClipboardDataImageBlobLimitaton",10);b.$("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.jTj=b.$("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}GEc(b){this.jTj&&
b&&(this.XR=!0)}get fTf(){return this.XR}get fMb(){return!1}x6e(b){return b?rd.a.tyb(b,kb.a.copy):!1}TEc(b,h){this.bTa&&(h=this.bTa,this.bTa=null);return h}prepareForPaste(b,h=null){if(b&&h){this.W6c=b;this.NSb=h;$addHandler(this.NSb,kb.a.paste,Object(v.a)(this,this.qxi,"onPasteEvent"));this.l8=this.xia=null;if(this.ucj(this.NSb)){if(this.l8&&0<this.l8.length&&(!this.xia||this.Xj.$be(this.xia))){this.lTa.Yph(this.l8,Object(v.a)(this,this.kRm,"onImageConverted"));this.bTa&&!this.bTa.hasChildNodes()&&
w.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.xia&&this.xia.innerHTML&&((this.bTa=this.D4h(this.xia.innerHTML))&&!this.bTa.hasChildNodes()&&w.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),Ke.a.jA(this.xia))}this.JGh()}else b&&b()}g1c(b){return this.XR=b=this.ucj(b.ownerDocument)}qxi(b){try{b&&b.rawEvent&&((this.xia=b.rawEvent.target)&&this.xia.id&&-1<this.xia.id.indexOf("Paste")?(w.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+
this.xia.id),this.xia=null):this.l8=this.Wsl(b.rawEvent))}catch(h){w.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+h.toString())}}kRm(b){b&&(this.lTa.y1i&&(b=String.format('<img src="{0}">',b)),this.bTa=this.D4h(b));this.JGh()}JGh(){this.NSb&&($removeHandler(this.NSb,kb.a.paste,Object(v.a)(this,this.qxi,"onPasteEvent")),this.NSb=null);this.W6c&&(this.W6c(),this.W6c=null)}Wsl(b){let h=null;(b=this.Xj.oMh(b))&&({Qkf:h}=this.Xj.Ybj(b,this.EKj,this.lTa.voi));
return h}ucj(b){return rd.a.tyb(b,kb.a.paste)}D4h(b){const h=document.implementation.createHTMLDocument("doc");h.body.innerHTML=b;return h.body}UJb(){}}Object(r.a)(Sz,"EdgeSystemClipboardAccessManager",null,[563]);class zi{constructor(b,h,n,x){this.Ma=b;this.Lwj=h;this.Xj=n;this.te=x}create(){let b=null;u.AFrameworkApplication.zZf()&&this.te.So&&window.chrome?(w.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),b=new mo(this.Ma,this.Lwj,this.Xj),this.Ma.$("LogChromeExtensionInstallationStatusIsEnabled")&&
b.fvm()):this.Ma.$("EdgeContextMenuPasteFixIsEnabled")&&this.te.Vs?(w.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),b=new Sz(this.Ma,Oa.a.instance.resolve("Box4.IClipboardDataHelper"),Oa.a.instance.resolve("Box4.IProcessImageStrategy"),Oa.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(w.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),b=new mv(this.te,this.Ma));return b}}Object(r.a)(zi,"SystemClipboardAccessManagerFactory",
null,[528]);class A{E2k(b){return b}}Object(r.a)(A,"DeleteTableSegmentStrategy",null,[526]);var T=d(586),ba=d(988);class Ha{get np(){return Ig.a.gAb}get paragraphEditor(){return null!=this.Hng?this.Hng:this.Hng=Oa.a.instance.resolve("Box4.IParagraphEditor")}get a_(){return this.paragraphEditor.np}get Lc(){return vb.a.instance}get Yx(){return null!=this.Tng?this.Tng:this.Tng=Oa.a.instance.resolve("Box4.IParagraphIndentationReader")}lyc(b,h,n,x,E,S,ma){let Fa=2;if(!b.Be)return 2;const $a=b.Cb;if(!$a)return this.Lc.Yb(Gc.a.zf,
{["Reason"]:Mc.a.sfa}),8;if(u.AFrameworkApplication.K.$("Box4PartialPromoteDemoteIsEnabled")){b=this.rih(h===Db.a.HF,n,!0);if(1===x)return b?32:8;b&&(Fa=ba.a.gac(h,n,x,E,S,ma))}else Fa=ba.a.gac(h,n,1,E,S,ma),1!==x&&32===Fa?(b.Cb.eXd(),b=new Se.GraphTransaction(15),b.Db(n.view.ud),Fa=this.rih(h===Db.a.HF,n,!1)?ba.a.gac(h,n,x,E,S,ma):8,b.dispose()):1!==x&&8===Fa&&(b.Cb.eXd(),this.$zk(h,n,$a));return Fa}rih(b,h,n){h=h.view.Cb;if(!h||!h.ib.kb)return this.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.nFb}),!1;if(h.ib.rI)return this.Lc.Yb(Gc.a.zf,
{["Reason"]:Mc.a.NXe}),!1;h=T.OutlineElementGeneralizer.Hka(h.ib,!1);if(!h)return this.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.TAd}),!1;let x=!1;for(let E=0;E<h.length;E++){const S=h.getContext(E),ma=new md.GraphIterator;ma.set(S.node);Kd.SelectionEditor.Gt(ma);if(!Kf.OutlineElementReader.Nh(ma))if(n)continue;else return this.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.MWa}),!1;if(b?!this.np.Uvb(ma):!this.np.fYb(ma))if(n)continue;else return this.Lc.Yb(Gc.a.L_b,{["Reason"]:Mc.a.lUe}),!1;x=!0}return n?x:!0}$zk(b,h,n){const x=
new Se.GraphTransaction(15);try{x.Db(h.view.ud);h=!0;const E=T.OutlineElementGeneralizer.Hka(n.ib,!1);for(let S=0;S<E.length;S++){const ma=E.getContext(S),Fa=new md.GraphIterator;Fa.set(ma.node);Kd.SelectionEditor.Gt(Fa);if(!Kf.OutlineElementReader.Nh(Fa))h=!1;else if(b===Db.a.HF?this.np.Uvb(Fa):this.np.fYb(Fa))switch(h=!1,b){case Db.a.HF:this.np.XNa(Fa,-1,0);break;case Db.a.zN:this.np.bDc(Fa,1)}}if(h){const S=n.ib.kb;for(n=0;n<S.length;n++){const ma=S.J(n);if(ma.ul){const Fa=this.Yx.mdb(ma.node),
$a=Fa.bba;if(b===Db.a.HF?Fa.tA>$a:Fa.tA<18*$a){const sb=new md.GraphIterator;sb.set(ma.node);this.a_.mva(sb,1,b===Db.a.HF?Fa.tA>=2.5*$a?Fa.tA-2*$a:$a:Fa.tA<16*$a?Fa.tA+2*$a:18*$a)}}}}}finally{x&&x.dispose()}}}Object(r.a)(Ha,"IndentationActorExtension",null,[527]);var fb=d(727),Hb=d(1191);class hc{constructor(b,h){this.Eo=new qi.DictionaryPropertySet;this.cqb=!1;this.Dxa=this.Inb=null;this.z4=b;this.CDg=h}get jlb(){return null!=this.Mpg?this.Mpg:this.Mpg=Oa.a.instance.Pa("Box4.ITextFormattingCommands")}get ui(){return null!=
this.Tig?this.Tig:this.Tig=Oa.a.instance.resolve("Box4.IFormattingEditor")}get pc(){return null!=this.Grg?this.Grg:this.Grg=Oa.a.instance.resolve("Box4.Styles.IWACStyleReader")}C1a(){this.cqb||(this.Eo.mQf(),this.Inb=null,this.Mnn())}AEk(b){var h;const n=null!==(h=Mh.FormattingReader.Ds(b))&&void 0!==h?h:Mh.FormattingReader.EEd(b.node,b.cpBegin,-1);!n.cache.xA&&(b=n.Xm)&&(h=new qi.DictionaryPropertySet,h.ys(b),h.ys(this.Eo),h.hasProperty(Th.a.kB)&&(this.Inb=n.paragraph.Nc),this.Eo=h)}hasProperty(b){return this.Eo.hasProperty(b)}YJc(){return 0<
this.Eo.VH()}get nZa(){return this.Eo}freeze(){this.cqb=!0}qEa(){this.cqb=!1}xL(b,h){return this.nZa.ia(b,h)}Pv(b){this.Eo.setValue(ie.a.fontSize,this.ui.aZb(b));this.l_()}fontSize(){return this.Eo.ia(ie.a.fontSize,Zl.a.IJ)}n5d(b){this.Eo.setValue(ie.a.font,b);this.CDg&&this.CDg.execute(h=>{null==h?w.ULS.sendTraceTag(527029267,324,10,"IFontNameFormattingStrategy is null after future execution"):h.n5d(this.Eo)});this.z4&&this.z4.enabled&&(sd.b(40506690,306,50,"InsertionPointFomatting: Set font slot values"),
this.z4.XHn(this.Eo,b));this.l_()}Ddc(b){this.Eo.setValue(ic.a.we,b);this.z4&&this.z4.enabled&&(sd.b(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.z4.mNn(this.Eo,b));this.l_()}Is(b){b=Aq.a.instance.Zya(kh.a.instance.ib.kb.Qa.node,b);this.Eo.setValue(ie.a.fontColor,b);this.l_()}B5(){this.Eo.setValue(ie.a.fontColor,Eo.a.auto);this.l_()}fontColor(){return this.Eo.ia(ie.a.fontColor,Eo.a.nil)}kva(b){this.Eo.setValue(ie.a.highlight,parseInt(b,16));this.l_()}Std(){this.Eo.setValue(ie.a.highlight,
Eo.a.auto);this.l_()}isBold(){return this.Eo.ia(ie.a.bold,!1)}KF(b){this.Eo.setValue(ie.a.bold,b);this.l_()}isItalic(){return this.Eo.ia(ie.a.italic,!1)}setItalic(b){this.Eo.setValue(ie.a.italic,b);this.l_()}isUnderline(){return this.Eo.ia(ie.a.underline,!1)}o3(b){this.Eo.setValue(ie.a.underline,b);this.Eo.setValue(ie.a.underlineType,b?Zl.a.pLb:Zl.a.NX);this.l_()}underlineType(){return this.Eo.ia(ie.a.underlineType,Zl.a.NX)}yga(b){b<Zl.a.pLb||b>Zl.a.NX||(this.Eo.setValue(ie.a.underline,b!==Zl.a.NX),
this.Eo.setValue(ie.a.underlineType,b),this.l_())}isSuperscript(){return this.Eo.ia(ie.a.superscript,!1)}Uaa(b){this.Eo.setValue(ie.a.superscript,b);b&&this.isSuperscript()&&this.Eo.setValue(ie.a.subscript,!1);this.l_()}isSubscript(){return this.Eo.ia(ie.a.subscript,!1)}Gna(b){this.Eo.setValue(ie.a.subscript,b);b&&this.isSubscript()&&this.Eo.setValue(ie.a.superscript,!1);this.l_()}isStrikethrough(){return this.Eo.ia(ie.a.strikethrough,!1)}r7(b){this.Eo.setValue(ie.a.strikethrough,b);this.l_()}isDoubleStrikethrough(){return this.Eo.ia(Th.a.As,
!1)}kdc(b){this.Eo.setValue(Th.a.As,b);this.l_()}ULh(){return this.Eo.ia(Th.a.kB,null)}gkb(b,h){this.Eo.mQf();this.Eo.setValue(Th.a.kB,b.id);this.Inb=h.Nc;this.l_()}m7(b){let h=ie.a.eE;if(Of.a.instance.J(1)){const n=fb.a.BQd(b);switch(n){case 1:h=ic.a.GDb;break;case 2:h=ic.a.HDb}this.Eo.setValue(ic.a.languageHint,n)}this.Eo.setValue(h,b);this.l_()}language(){let b=ie.a.eE;if(Of.a.instance.J(1))switch(this.Eo.ia(ic.a.languageHint,0)){case 1:b=ic.a.GDb;break;case 2:b=ic.a.HDb}return this.Eo.ia(b,0)}iKn(b){this.Eo.setValue(ic.a.noProof,
b);this.l_()}LCb(){return this.Eo.ia(ic.a.noProof,!1)}Sem(){return this.Eo.hasProperty(ic.a.noProof)}Adm(){return Of.a.instance.J(1)?this.Eo.hasProperty(ie.a.eE)||this.Eo.hasProperty(ic.a.GDb)||this.Eo.hasProperty(ic.a.HDb):this.Eo.hasProperty(ie.a.eE)}l_(){if(V.a.$ec){var b=kh.a.instance.ib.kb.Qa,h=b.node;if(h===this.Dxa)this.Dxa.Sj(16,!0);else{this.Dxa=h;h=this.Dxa.IX();try{this.Dxa.R9(b.cpBegin).qta=!0}finally{h&&h.dispose()}}}}Mnn(){if(V.a.$ec&&this.Dxa){var b=0,h=this.Dxa.IX();try{for(let n=
this.Dxa.qa.length-1;0<=n;n--){const x=this.Dxa.qa.J(n);x.qta&&(x.qta=!1,b++,x.isEmpty&&this.Dxa.qa.removeAt(n))}}finally{h&&h.dispose()}this.Dxa=null}}HCk(b){if(b.cpBegin!==b.cpEnd)return!1;b=b.node.qa.ji(b.cpBegin);return!!b&&b.qta}PPe(b){if(this.jlb){this.freeze();var h=new Se.GraphTransaction(7);h.Db(b.node);this.jlb.p5d(b);this.qEa();this.C1a();h.dispose()}}egf(b){const h=Cd.ParagraphReader.text(b.node);return b.cpBegin&&b.cpBegin!==h.length&&!B.a.Yu(h.charCodeAt(b.cpBegin))&&Hb.a.instance.MXa(h,
b.cpBegin-1)!==b.cpBegin&&Kd.SelectionEditor.Yfb(b)?(b=Kd.SelectionEditor.Q1(b,!1))?1<b.length||Kd.SelectionEditor.Ek(b.Qa)?b:null:null:null}}Object(r.a)(hc,"InsertionPointFormatting",null,[525]);class Dc{constructor(b){this.ga=b}get Ac(){return this.ga}lmk(b,h,n=null){const x=new qi.DictionaryPropertySet;x.setValue(ad.a.Jv,b);x.setValue(ad.a.Mta,h);n&&x.ys(n);x.CommandSource="autobulleting";this.Ac.Xb(Db.a.Uz,2,x)}numbering(b,h,n,x,E){const S=new qi.DictionaryPropertySet;S.setValue(ad.a.Jv,b);S.setValue(ad.a.Mta,
h);S.setValue(ad.a.NMa,n);E&&S.setValue(Ji.a.jP,E);x&&S.setValue(ic.a.Qr,x);bo.a.SW&&(S.setValue(Ji.a.hma,"autocorrect"),E&&S.setValue(Ji.a.efa,E));S.CommandSource="autonumbering";return 32===this.Ac.Xb(Db.a.gH,2,S)}}Object(r.a)(Dc,"ListCommands",null,[524]);var Wc=d(239);class Qd extends Wc.a{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb){super();this.gTb=this.Fo=this.YFa=null;this.I7m=(Sb,oc)=>{oc=this.aqa.p_d(this.YFa,oc);Sb.si(this.xcl);return oc};this.xcl=(Sb,oc)=>{if(this.Fo.moveNext())return Sb=this.Fo.currentNode,
12!==Sb.type||Sb===this.YFa.node?!0:this.aqa.JUc(Sb,oc);this.Clk();Sb.si(this.ycl);return!0};this.ycl=(Sb,oc)=>{if(this.Fo.moveNext()){const Ic=this.Fo.currentNode;return 12!==Ic.type?!0:Ic===this.YFa.node?(Sb.si(this.J7m),!0):this.aqa.JUc(Ic,oc)}return!1};this.J7m=(Sb,oc)=>{this.aqa.q_d(this.YFa,oc);return!1};this.init(b);this.ll(Jb);this.Neb(Fa,h,x,E,S);this.rD=S;this._context=n;this.hb=$a;this.Ge=sb;this.aqa=ma;this.nz=0}run(){this.WUe();this.nz||this.XOn();1===this.nz&&this.O8m();2===this.nz&&
this.L4n();3===this.nz&&this.N8k()}WUe(){this.hb.ib&&this.hb.ib.kb?1===this.behavior&&(this.aqa.WUe(this._context)?this.$q=32:this.$q=2,this.nz=3):(w.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.$q=2,this.nz=3)}XOn(){this.Xkk();this.aqa.pYf(this.YFa)?(this.fkk(),this.nz=1):(this.$q=8,this.nz=3)}O8m(){this.YE||new qq.a(this,this.I7m,this.rD);do if(this.YE.run(),this.YE.inProgress&&!this.ah)return;while(this.YE.inProgress);this.Otd();this.nz=2}L4n(){this.aqa.b3f(this)?this.$q=
32:this.$q=8;this.nz=3}N8k(){this.Cna()}Xkk(){let b=this.hb.ib.kb;if(b=this.Ge.ak(b,!0,!1))this.YFa=b.Qa;this.YFa&&this.YFa.node&&(this.gTb=this.aqa.MVh(this.YFa.node))}fkk(){if(!this.gTb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Lf.a;b.set(this.YFa.node);b.Bb(this.gTb.type);this.Fo=Oh.a.Ir(b,this.gTb);this.Fo.Om(Object(v.a)(this.aqa,this.aqa.Bec,"spellErrorFilter"),null)}Clk(){if(!this.gTb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Lf.a;b.set(this.gTb);
this.Fo=Oh.a.tq(b);this.Fo.Om(Object(v.a)(this.aqa,this.aqa.Bec,"spellErrorFilter"),null)}}Object(r.a)(Qd,"ProofingWholeDocumentOperation",Wc.a,[]);var Md=d(293);class Re extends Eq{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}Object(r.a)(Re,"ContextMenuRootProperties",Eq,[]);var lg=d(1337);class Jg{constructor(b){const h=new Re;h.ImageSideArrow=u.AFrameworkApplication.mr;h.ImageSideArrowClass=Tg.getImageClass("SubmenuFlyoutArrow_13x13x32");h.TextDirection=Box4Intl.Box4Strings.L_RibbonOptionTextDirection;
h.CommandMenuOpen=Db.a.MZd.toString();this.r1g=new lg.ContextMenuRoot("ContextMenuRootName",h);b.execute(n=>{this.D_.kE=n});this.D_.refresh();u.AFrameworkApplication.ya.pa(Ra.a.showContextMenu,Ld.a.frame,pd.ActionManager.Nf);u.AFrameworkApplication.ya.pa(Ra.a.aec,Ld.a.frame,pd.ActionManager.Nf)}get D_(){return this.r1g}dispose(){this.D_&&(this.D_.dispose(),this.r1g=null)}showContextMenu(b,h){this.RJb(b,h.clientPoint,h.eg)}wZb(b,h,n,x,E){this.D_.wZb(b,h,n,x,E)}u2a(b,h,n){rd.a.sTd(this.D_.IUa?"ShowLegacyContextMenuAndFloatie":
"ShowLegacyContextMenu","");ob.App.xa.rbl();this.Et();this.D_.u2a(b,h,n);this.D_.IUa?u.AFrameworkApplication.ya.processAction(Ra.a.aec,2):u.AFrameworkApplication.ya.processAction(Ra.a.showContextMenu,2)}RJb(b,h,n){this.u2a(b,new Sys.UI.Bounds(h.x,h.y,0,0),n)}Et(){this.D_.root.xl()}M1(){return this.D_.M1()}aec(b,h,n,x){const E=this.D_;let S=!1;n=Object(ja.a)(Dr,n);E.IUa=n;x.ova(b,h);E.hMe?n&&(n.r4m(E,h),S=!0):(w.ULS.sendTraceTag(4801985,324,15,"Failed to launch the context menu!  Menu type:  {0}.",
x.FNk()),E.IUa=null);return S}}Object(r.a)(Jg,"AContextMenuController",null,[584,10]);class Uh{}Uh.Lac="faProofing";Uh.OAh="EditorMenuSection";Object(r.a)(Uh,"ContextMenuControlId",null,[]);var fi=d(539);class Qn{constructor(b){this.Ge=b}WUe(b){b=Object(ja.a)(fi.a,b);return!!b&&!!b.view&&b.view.Be}pYf(){return!0}p_d(){return!0}JUc(){return!0}q_d(){}b3f(){return!0}Bec(b){if(b.nr)return!0;b=b.role;return 1===b||2===b||3===b||4===b||5===b}MVh(b){if(!b||!this.Ge)return b;const h=new Lf.a;h.set(b);if(this.Ge.Gt(h)){for(;!h.nr;)h.nc();
return h.currentNode}return b}}Object(r.a)(Qn,"SimpleProofingWholeDocumentCallBacks",null,[326]);class mp{constructor(b){this.value=b}}Object(r.a)(mp,"RefBool",null,[]);class er{constructor(){this.NEc=this.kFb=null;this.gdj=new mp(!1)}}Object(r.a)(er,"FindNextErrorOperationParam",null,[]);var Tj=d(1544);class au extends Qn{constructor(b,h,n,x){super(h);this.Rm=b;this.Wuc=n;this.Ruj=x}p_d(b,h){return!this.Mvf(b.node,b.cpBegin,h)}JUc(b,h){return!this.Mvf(b,0,h)}q_d(b,h){this.Mvf(b.node,0,h);Object(ja.a)(er,
h)}Mvf(b,h,n){n=Object(ja.a)(er,n);if(Cd.ParagraphReader.oc(b)&&!b.pI)if(Mh.FormattingReader.Ds(Dd.a.Uc(b,h)).cache.LCb)n.gdj.value=!0;else{if(Tj.a.Jy())return h=this.Ruj.y5k(b,h,this.Wuc),null!=h?(n.kFb=h,n.NEc=b,!0):!1;const x=this.Rm.Y1(b);for(let E=0;E<x.length;E++){const S=x[E];if(S.begin>=h&&!S.errorDetails.JZa()&&(!this.Wuc||this.Wuc(S.errorDetails)))return n.kFb=S,n.NEc=b,!0}return!1}}}Object(r.a)(au,"FindNextErrorCallbackSteps",Qn,[]);var Rn=d(486);class Ys{constructor(b,h,n,x,E,S,ma,Fa,
$a,sb,Jb,Sb,oc,Ic,gd,Gd,vd){this.nxk=(ce,od,Yd,ne,Df)=>{od=this.hb.ib.kb;if(!od)return this.ld.Yb(Gc.a.zf,{["Reason"]:Mc.a.noSelection}),2;od=this.Ge.ak(od,!0,!1);return this.ga.Qf(od.Qa,ce,Yd,!1,ne,Df)};this.aYm=(ce,od,Yd)=>{if(1===Yd)return this.ga.processAction(Db.a.m7,1);this.fJj().f_f();return 32};this.Mza=(ce,od,Yd)=>{if(1===Yd)return 32;ue.a.mark(4670);Yd=this.Rm.Ska(od);if(this.wae(Yd))return 8;od=od.node;const ne=this.Hc.Rc(15);let Df=Yd.begin;" "===Cd.ParagraphReader.text(od).charAt(Df-
1)&&Df--;ne.Db(od);const Af=this.Vd.replaceTextRange(Dd.a.createTextRange(od,0<Yd.begin?Yd.begin-1:0,Yd.end),"",!0,!1);this.hb.setSelection(Ae.SelectionFactory.xe(od,Af+Df));ne.dispose();Yd.errorDetails.vlb(ce);ue.a.mark(4671);return 32};this.Vsa=(ce,od,Yd)=>{if(1===Yd)return 32;w.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");if(Tj.a.Jy())return this.R4a.Bif(od,null,Rn.b.IgnoreOnce),32;ue.a.mark(4670);Yd=this.Rm.Ska(od);if(this.wae(Yd))return 8;od=od.node;const ne=this.Hc.Rc(15);
ne.Db(od);this.Rm.cjb(od,[Yd],!0);od.setValue(ie.a.JXe,!0);ne.dispose();Yd.errorDetails.vlb(ce);ue.a.mark(4671);w.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.Lym(Yd);this.pTa.X4h(Yd,od,!0);return 32};this.OEk=(ce,od,Yd)=>{var ne=!this.Ok.L$(od);this.Cm&&this.Cm.instance&&this.Cm.instance.vT(od)&&(ne=!1);if(1===Yd||!ne)return ne?32:8;this.ga.processAction(Db.a.yva,2);ue.a.mark(4670);ne=this.Kll(ce);if(0>ne)return 8;if(Tj.a.Jy())return this.R4a.Bif(od,ne,Rn.b.Apply),
32;Yd=this.Rm.Ska(od);if(this.wae(Yd))return 8;od=od.node;var Df=Yd.errorDetails.suggestions;if(!Df)return this.ld.Yb(Gc.a.zyb,{["Reason"]:"NoSuggestionsFound"}),ue.a.mark(4671),8;ne=ne<Df.length?Df[ne]:null;if(!ne)return this.ld.Yb(Gc.a.zyb,{["Reason"]:"RequestedSuggestionIsNull"}),ue.a.mark(4671),8;this.Xmb.J(4)&&ob.App.rd.Kp&&ob.App.rd.Jq.sG(od);ne=ne.replace("  "," \u00a0");Df=this.Hc.Rc(15);Df.Db(od);const Af=this.Vd.replaceTextRange(Dd.a.createTextRange(od,Yd.begin,Yd.end),ne,!0,!1,Db.a.yva);
this.hb.setSelection(Ae.SelectionFactory.xe(od,Yd.begin+ne.length+Af));Df.dispose();Yd.errorDetails.vlb(ce);ue.a.mark(4671);this.Ktm(Yd);return 32};this.JCn=(ce,od)=>{od=this.Rm.Ska(od);if(this.wae(od))return 8;od.errorDetails.vlb(ce);return 32};this.T7k=(ce,od,Yd,ne,Df)=>{if(!od.view.Be)return 2;const Af=od.view;if(!this.hb.ib.kb)return this.ld.Yb(Gc.a.zf,{["Reason"]:Mc.a.noSelection}),2;if(1===Yd)return 32;const Wi=new er,gm=new au(this.Rm,this.Ge,this.Wuc,this.R4a);od=new Qd(null,ce,od,Yd,ne,Wi,
gm,this.ga,this.hb,this.Ge,null);od.ah=!0;od.run();if(od.isCompleted&&Wi.kFb){if(od=Ae.SelectionFactory.xe(Wi.NEc,Wi.kFb.begin),od=Ae.SelectionFactory.MC(od,Dd.a.Uc(Wi.NEc,Wi.kFb.end)),!this.lVg.instance||!this.lVg.instance.e6m(Wi.kFb,od,Af)){this.hb.setSelection(od);let Ck=0;Df&&(Ck=Df.Qw);Af.O6d=!1;Ye.a.instance.$b(new We.a(1,1,1,()=>{this.SAn(Af,Ck,Wi.NEc,Wi.kFb)}))}}else{const Ck=new yd.StandardDialog;Ck.Ed=0;ob.App.tK.AOc?Ck.Bga(CommonUIStrings.l_DefaultDialogTitle,Wi.gdj.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:
Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(Ck.Bga(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,null),ob.App.tK.Ppd(()=>{Ck.cCa&&(Ck.hide(),this.ga.processAction(ce,2))}))}return 32};this.MZd=(ce,od,Yd)=>{if(1===Yd)return 32;this.Pba&&this.Pba.D_&&(ce=this.Pba.D_.Ehf(Uh.Lac))&&!ce.hK&&(ce.IZ(0),ce.menu.OJ(0));return 32};this.ga=h;this.Rm=b;this.fJj=n;this.Vd=x;this.Hc=E;this.hb=S;this.Cm=ma;this.Ge=Fa;this.lSj=$a;this.Ok=sb;this.ld=Jb;this.R4a=vd;this.Pba=
Object(ja.a)(Jg,Sb);this.UQb=oc.aOc;this.lVg=Ic;this.Xmb=gd;this.pTa=Gd;this.m5c=new Do.a;this.m5c.Z(1,Db.a.t0f);this.m5c.Z(2,Db.a.fif);this.m5c.Z(3,Db.a.u1f);this.Pid=new Do.a;this.Pid.Z(1,Db.a.u0f);this.Pid.Z(2,Db.a.gif);this.Pid.Z(3,Db.a.v1f)}Vb(){const b=this.ga,h=this.OEk,n=this.nxk;b.gb(Db.a.PXd,cc.a.view,this.aYm,1028);b.pa(Db.a.Mza,cc.a.Wc,this.Mza);b.pa(Db.a.Vsa,cc.a.Wc,this.Vsa);b.pa(Db.a.clb,cc.a.Wc,h);b.pa(Db.a.dlb,cc.a.Wc,h);b.pa(Db.a.elb,cc.a.Wc,h);b.pa(Db.a.DKb,cc.a.Wc,h);b.pa(Db.a.EKb,
cc.a.Wc,h);b.pa(Db.a.Mza,cc.a.view,n);b.pa(Db.a.Vsa,cc.a.view,n);b.pa(Db.a.clb,cc.a.view,n);b.pa(Db.a.dlb,cc.a.view,n);b.pa(Db.a.elb,cc.a.view,n);b.pa(Db.a.DKb,cc.a.view,n);b.pa(Db.a.EKb,cc.a.view,n);b.Vc(Db.a.Mza,1028);b.Vc(Db.a.Vsa,1028);b.Vc(Db.a.clb,1028);b.Vc(Db.a.dlb,1028);b.Vc(Db.a.elb,1028);b.Vc(Db.a.DKb,1028);b.Vc(Db.a.EKb,1028);b.pa(Db.a.yva,Ld.a.frame,pd.ActionManager.Nf);this.UQb&&b.gb(Db.a.MZd,cc.a.view,this.MZd,1124);b.gb(Db.a.MRc,cc.a.view,this.T7k,1028);b.gb(Db.a.CMf,cc.a.Fd,this.JCn,
1124);this.Yjn([Db.a.l8d,Db.a.t0f,Db.a.u0f,Db.a.bId,Db.a.fif,Db.a.gif,Db.a.T8d,Db.a.u1f,Db.a.v1f,Db.a.dGi,Db.a.ari,Db.a.g5i])}Yjn(b){for(let h=0;h<b.length;h++)this.ga.gb(b[h],cc.a.view,pd.ActionManager.jZ,1028)}jln(b){this.Wuc=b}wae(b){return b?b.errorDetails?!1:(w.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.ld.Yb(Gc.a.zyb,{["Reason"]:"ErrorRangeMissingErrorDetails"}),ue.a.mark(4671),!0):(w.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),
this.ld.Yb(Gc.a.zyb,{["Reason"]:"RequestedErrorRangeNotFound"}),ue.a.mark(4671),!0)}Lym(b){let h;({value:h}=this.Pid.Dc(b.errorDetails.proofingType,0)).returnValue&&(this.ga.processAction(h,2),w.ULS.sendTraceTag(527799886,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b.errorDetails.proofingType))}Kll(b){switch(b){case Db.a.clb:return 0;case Db.a.dlb:return 1;case Db.a.elb:return 2;case Db.a.DKb:return 3;case Db.a.EKb:return 4;default:return-1}}Ktm(b){let h;({value:h}=this.m5c.Dc(b.errorDetails.proofingType,
0)).returnValue&&(this.ga.processAction(h,2),w.ULS.sendTraceTag(527799887,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b.errorDetails.proofingType))}SAn(b,h,n,x){b.Naa();(b=n.De(b.Tb))?(x=Md.a.qq(b,u.AFrameworkApplication.isRtl?x.begin:x.end),this.lSj.ova(new Sys.UI.Point(x.x,x.y+x.height),h)):w.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}}Object(r.a)(Ys,"ProofingActor",null,[]);var Nt=d(338),Bq=d(1516);class Tu{constructor(b,h,n,x,E,S,ma,Fa,$a,
sb){this.Sec=null;this.G$k="StyleUsageActivity";this.H$k="StylesFloodgateSurveyIsEnabled";this.aJa=(Jb,Sb,oc,Ic)=>{Jb=this.iIl(Jb);return 0>Jb||Jb>this.Sec.length?2:(Jb=this.Sec[Jb])?u.AFrameworkApplication.ya.Qf(Sb,Db.a.applyStyle,oc,!0,Ic,Jb):2};this.DGb=(Jb,Sb,oc,Ic,gd)=>{Jb=!0;Sb.contextId!==cc.a.paragraph&&Sb.contextId!==cc.a.Fd&&Sb.contextId!==cc.a.Wc&&(Jb=!1);if(1===oc||!Jb)return Jb?32:8;if(2===oc&&!gd)return 8;Sb=this.pc.Nx(Sb.node);oc=Of.a.instance.J(8);gd.MenuItems=Nt.a.Dxl(Sb,oc);return 32};
this.Tan=(Jb,Sb,oc,Ic,gd)=>{Jb=!0;Sb.contextId!==cc.a.paragraph&&(Jb=!1);if(1===oc&&!Jb)return 8;Sb=Sb.node;oc=this.pc.yo(Sb);if(!oc||!gd)return w.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",gd,Sb,oc),8;gd.APa.ys(oc.Yh());return 32};this.vck=(Jb,Sb,oc,Ic,gd)=>{if(Sb.contextId!==cc.a.paragraph)return 8;if(this.Zf.VZa(Sb,!1))return this.Lc.Yb(Gc.a.Mm,{["Reason"]:Mc.a.UD}),8;if(1===oc)return 32;oc=Sb.node;if(Cd.ParagraphReader.zra(oc)||!gd)return 8;const Gd=
this.Bgf(gd,oc);if(!Gd)return this.Lc.Yb(Gc.a.J_,{["Reason"]:Mc.a.Ayb}),8;if(2!==this.pc.Ow(Gd))return 2;Jb=new Se.GraphTransaction(15);this.Gj&&this.Gj.isProgressiveStyleEnabled&&this.kF.lec(gd);Jb.Db(oc);this.Rj.C1a();this.B7.hM(Gd,oc,!1);const vd=this.pc.Nx(oc);vd&&this.pc.me(Gd,vd)&&sd.b(593078098,3017,50,"Custom linked style applied by user");oc.Pr&&(oc=[Object.assign(new ca.a,{name:"Source",string:"ApplyStyle"})],Pe.a("TOCFormatting",!0,void 0,oc));Jb.dispose();gd=B.a.TV(gd);Ic.Jr=gd>>>16^gd&
65535;Ic&&Bq.a.hlb&&(Ic.pB|=Bq.a.Xcb(Sb.node));return 32};this.Uan=(Jb,Sb,oc,Ic,gd)=>{Jb=!0;Sb.contextId!==cc.a.Fd&&(Jb=!1);if(1===oc&&!Jb)return 2;Sb=Mh.FormattingReader.Ds(Sb);Sb=Mh.FormattingReader.Nsa(Sb);if(!Sb)return 2;if(!gd)return 8;gd.APa.ys(Sb.Yh());return 32};this.wck=(Jb,Sb,oc,Ic,gd)=>{if(Sb.contextId!==cc.a.Fd||!Of.a.instance.J(8))return 8;this.Zf.VZa(Sb);if(1===oc)return 32;Jb=Sb.node;if(!gd)return 8;const Gd=this.Bgf(gd,Sb.node);if(!Gd)return this.Lc.Yb(Gc.a.J_,{["Reason"]:Mc.a.Ayb}),
8;if(1!==this.pc.Ow(Gd))return 2;oc=this.pc.Nx(Jb);if(!oc)return this.Lc.Yb(Gc.a.J_,{["Reason"]:Mc.a.MEh}),8;if(!oc.uh(this.pc.tf(Gd)))return this.Lc.Yb(Gc.a.J_,{["Reason"]:Mc.a.Ayb}),8;const vd=new Se.GraphTransaction(7);try{if(this.Gj&&this.Gj.isProgressiveStyleEnabled&&this.kF.lec(gd),vd.Db(Jb),this.B7.D7f(Jb,oc),this.f3a.m1(Sb,ce=>{this.ui.Fja(ce);this.ui.gkb(ce,Gd)}),Jb.Pr){const ce=[Object.assign(new ca.a,{name:"Source",string:"ApplyStyle"})];Pe.a("TOCFormatting",!0,void 0,ce)}}finally{vd&&
vd.dispose()}oc&&this.pc.me(Gd,oc)&&sd.b(593078097,3017,50,"Custom linked style applied by user");gd=B.a.TV(gd);Ic.Jr=gd>>>16^gd&65535;Ic&&Bq.a.hlb&&(Ic.pB|=Bq.a.Xcb(Sb.node));return 32};this.San=(Jb,Sb,oc,Ic,gd)=>{Jb=!0;Sb.contextId!==cc.a.Wc&&(Jb=!1);if(1===oc&&!Jb)return 2;Sb=this.B7.nIl(Sb);if(!Sb)return 2;if(!gd)return 8;gd.APa.ys(Sb.Yh());return 32};this.uck=(Jb,Sb,oc,Ic,gd)=>{if(Sb.contextId!==cc.a.Wc||!Of.a.instance.J(8))return 8;if(this.Zf.VZa(Sb,!1))return this.Lc.Yb(Gc.a.Mm,{["Reason"]:Mc.a.UD}),
8;if(1===oc)return 32;var Gd=Sb.node;if(!gd)return 8;oc=this.Bgf(gd,Sb.node);if(!oc)return this.Lc.Yb(Gc.a.J_,{["Reason"]:Mc.a.Ayb}),8;const vd=this.pc.Ow(oc);if(1!==vd&&2!==vd)return 2;(Sb=this.Rj.egf(Sb))?(Sb=kh.a.Xwb(Sb),Jb=u.AFrameworkApplication.ya.Qf(Sb,Jb,2,!1,Ic,gd)):(Jb=new Se.GraphTransaction(7),this.Gj&&this.Gj.isProgressiveStyleEnabled&&this.kF.lec(gd),Jb.Db(Gd),this.B7.MMn(oc,Gd),Jb.dispose(),Jb=32);Gd.Pr&&(Sb=[Object.assign(new ca.a,{name:"Source",string:"ApplyStyle"})],Pe.a("TOCFormatting",
!0,void 0,Sb));(Gd=this.pc.Nx(Gd))&&this.pc.me(oc,Gd)&&sd.b(593078096,3017,50,"Custom linked style applied by user");gd=B.a.TV(gd);Ic.Jr=gd>>>16^gd&65535;return Jb};this.Van=(Jb,Sb,oc,Ic,gd)=>{if(Of.a.instance.J(8)){const Gd=this.H3c.Tma(Jb,Sb,oc,Ic,gd,null,0);if(2!==Gd)return Gd}return this.H3c.Tma(Jb,Sb,oc,Ic,gd,null,12)};this.xck=(Jb,Sb,oc,Ic,gd)=>{const Gd={};Gd[this.H3c.eFa]=6168;Gd[this.H3c.dFa]=6169;let vd=12;if(Of.a.instance.J(8)){if(!Sb.view.Be)return 2;var ce=Sb.view.Cb,od=ce?ce.Rg:null;
if(!od)return this.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.noSelection}),8;if(this.Tg.jza(Pd.ImageReader.pZa,od))return this.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.fBc}),8;if(this.Tg.Wva(Cd.ParagraphReader.KW,od))return this.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.pN}),8;if(this.Zf.z5b(od,!1))return this.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.UD}),8;od=this.pc.Ip();if(gd&&od){const Yd=od.uh(gd);if(Yd){const ne=this.pc.c2(Yd,od);let Df=this.pc.Ow(Yd);ne&&(ce=ce.ib.J(0),ce.VD&&ce.Qa.contextId===cc.a.Fd||2===ce.length&&ce.Qa.contextId===
cc.a.Fd&&ce.Tc.contextId===cc.a.endOfParagraph)&&(Df=1,gd=ne.getValue(Th.a.ja));1===Df?vd=0:3===Df&&(vd=14);!this.pc.me(Yd,od)&&this.pc.zd(Yd)&&(ce=this.pc.tf(Yd),sd.b(562317522,3017,50,String.format("{0}: style applied by user",ce)));this.E3(this.G$k,this.H$k)}}}return this.H3c.Tma(Jb,Sb,oc,Ic,gd,Gd,vd)};this.cS=h;this.og=n;this.FM=x;this.Cw=E;this.Ok=S;this.ld=ma;this.xV=Fa;this.oYj=$a;this.Ie=sb}get Gj(){return null!=this.kpg?this.kpg:this.kpg=Oa.a.instance.Pa("Box4.Styles.StyleSettings")}get B7(){return this.cS}get Tg(){return this.FM}get Rj(){return this.Cw}get ui(){return this.og}get Zf(){return this.Ok}get Lc(){return this.ld}get f3a(){return this.xV}get H3c(){return this.oYj}get pc(){return this.Ie}Vb(){const b=
u.AFrameworkApplication.ya,h=ob.App.h3a.Krh(12);Of.a.instance.J(8)&&(b.pa(Db.a.applyStyle,cc.a.Fd,this.wck),b.pa(Db.a.lDa,cc.a.Fd,this.Uan),b.pa(Db.a.applyStyle,cc.a.Wc,this.uck),b.pa(Db.a.lDa,cc.a.Wc,this.San));b.pa(Db.a.applyStyle,cc.a.paragraph,this.vck);b.pa(Db.a.applyStyle,cc.a.view,this.xck);b.Vc(Db.a.applyStyle,1036);b.pa(Db.a.lDa,cc.a.view,this.Van);b.pa(Db.a.lDa,cc.a.paragraph,this.Tan);b.Vc(Db.a.lDa,99);b.pa(Db.a.DGb,cc.a.view,h);b.pa(Db.a.DGb,cc.a.paragraph,this.DGb);b.Vc(Db.a.DGb,1127);
b.gb(Db.a.YPe,cc.a.view,this.aJa,4);b.gb(Db.a.ZPe,cc.a.view,this.aJa,4);b.gb(Db.a.$Pe,cc.a.view,this.aJa,4);b.gb(Db.a.aQe,cc.a.view,this.aJa,4);b.gb(Db.a.bQe,cc.a.view,this.aJa,4);b.gb(Db.a.cQe,cc.a.view,this.aJa,4);b.gb(Db.a.dQe,cc.a.view,this.aJa,4);b.gb(Db.a.Kbh,cc.a.view,this.aJa,4);b.gb(Db.a.Lbh,cc.a.view,this.aJa,4);b.gb(Db.a.Mbh,cc.a.view,this.aJa,4);this.Sec=Array(10);jh.StyleReader.d6d(this.Sec)}iIl(b){switch(b){case Db.a.YPe:return 0;case Db.a.ZPe:return 1;case Db.a.$Pe:return 2;case Db.a.aQe:return 3;
case Db.a.bQe:return 4;case Db.a.cQe:return 5;case Db.a.dQe:return 6;case Db.a.Kbh:return 7;case Db.a.Lbh:return 8;case Db.a.Mbh:return 9;default:return-1}}E3(b,h){u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const n=Oa.a.instance.Za("Common.ISystemInitiatedFeedback");n&&n.execute(x=>{x.logActivity(b,h)})},Tu.gka)}Bgf(b,h){if(b&&h&&Cd.ParagraphReader.oc(h))h=this.pc.Nx(h);else return null;return h.uh(b)}get kF(){return null!=this.Gig?this.Gig:this.Gig=Oa.a.instance.resolve("Box4.IFontStylesGalleryCache")}}
Tu.gka=5E3;Object(r.a)(Tu,"StyleActor",null,[]);var Ew=d(1833);class ys{constructor(b){this.ga=b}get Ac(){return this.ga}p5d(b,h=!1){this.Ac.Qf(b,Db.a.nZa,2,!0,null,h)}m7(b){this.Ac.Xb(Db.a.m7,2,b)}}Object(r.a)(ys,"TextFormattingCommands",null,[523]);class no{constructor(b,h,n,x){this.sJe=this.a2g=!1;this.e8n=(E,S,ma)=>{if(2!==ma)return 2;this.a2g||(this.a2g=!0);u.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");u.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");
return 32};this.V7m=(E,S,ma,Fa,$a)=>{if(2!==ma)return 2;this.xFi($a,!0);return 32};this.U7m=(E,S,ma,Fa,$a)=>{if(2!==ma)return 2;this.xFi($a,!1);return 32};this.P8m=(E,S,ma)=>{if(2!==ma)return 2;if(!this.I6a)return 8;this.I6a.eWl();return 32};this.Q7m=(E,S,ma)=>{if(2!==ma)return 2;if(!this.I6a)return 8;this.I6a.Uvn();return 32};this.Cma=(E,S)=>{3===S.Qw&&Kd.SelectionEditor.Km(S.kl.kb)&&(Pe.c(Db.a.$7n),u.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IWacWordExtendPageHeightInTouchSettings"),
this.sJe=!0)};this.ga=b;this.Ma=h;this.I6a=n;this.hb=x}get d8n(){return this.sJe}Vb(){this.ga.gb(Ra.a.uO,cc.a.view,this.e8n,4);this.ga&&this.Ma&&(this.Ma.$("TouchImageGrippiesResizedIsEnabled")&&(this.ga.gb(Db.a.L4f,cc.a.view,this.V7m,4),this.ga.gb(Db.a.N4f,cc.a.view,this.U7m,4)),this.Ma.$("HideGrippersWhenPinchingIsEnabled")&&(this.ga.gb(Ra.a.i6i,cc.a.application,this.P8m,4),this.ga.gb(Ra.a.m5e,cc.a.application,this.Q7m,4)),ho.EventHandlerManager.instance.qkn(()=>{this.yWm()}));ob.App.xa.jb.Jc&&
ob.App.xa.jb.Jc.Be&&ob.App.xa.jb.Jc.jja(()=>{this.VAn()});this.hb&&this.hb.OD(this.Cma)}hdn(){Pe.c(Db.a.c8n);this.sJe=!0}VAn(){const b=window.performance.now();no.$ve&&250>b-no.$ve&&1E3<b-no.LMg&&(Pe.c(Db.a.b8n),no.LMg=b);this.I6a&&no.Pb&&no.Pb.Sw(126)&&this.I6a.showFloatie()}M6l(b,h){if(h){var n=null;V.a.NI&&b&&(n=b.getSelection());b=null;n&&"Caret"===n.type&&(b=n.getRangeAt(0))&&this.I6a&&this.I6a.Cgo(b.getBoundingClientRect(),h)}}yWm(){no.$ve=window.performance.now()}xFi(b,h){if(b)for(b=b.firstChild;b;){if("SPAN"===
b.tagName&&b.classList.contains(no.$Yl)){for(b=b.firstChild;b;)this.B8j(b,h),b=b.nextSibling;break}b=b.nextSibling}}B8j(b,h){if(b.classList.contains(no.i5h)){const n="WACImageResizeHandleTouch"+this.Qrl(b);h?b.classList.add(no.j5h,n):b.classList.remove(no.j5h,n)}}Qrl(b){for(const h of b.className.split(" "))if(h.startsWith("WACImageResizeHandle")&&h!==no.i5h)return B.a.substring(h,20,h.length);return""}static get Pb(){return null!=no.Ehg?no.Ehg:no.Ehg=Oa.a.instance.Pa("Box4.IFeatureHelper")}}no.i5h=
"WACImageResizeHandles";no.j5h="WACImageResizeHandlesTouch";no.$Yl="WACImgSelection";no.$ve=0;no.LMg=0;Object(r.a)(no,"TouchInputActor",null,[521]);class Il{get eFa(){return ba.a.eFa}get dFa(){return ba.a.dFa}get mhc(){return ba.a.mhc}Tma(b,h,n,x,E,S,ma){return ba.a.Tma(b,h,n,x,E,S,ma)}gac(b,h,n,x,E,S){return ba.a.gac(b,h,n,x,E,S)}static get instance(){Il._instance||(Il._instance=new Il);return Il._instance}}Il._instance=null;Object(r.a)(Il,"ViewActionHandlerProxy",null,[520]);class Fw{constructor(b,
h){this.kpiName="VisiMarkersUsage";this.S5="wwaengidc";this.GT=new Map;this.TWn=(n,x,E,S,ma)=>{if(1===E)return 32;if(!ma)return 2;this.GT.set("Source",$o.a[this.ga.k6]);this.XKe.dPc?this.GT.set("Action","Removed"):this.GT.set("Action","Applied");ta.Health.instance.recordKpiUsage(this.kpiName,1,this.S5,this.GT);n=document.getElementsByTagName("head")[0];if(!this.XKe.v7n(n))return w.ULS.sendTraceTag(593294045,324,15,"Toggling Formatting markers failed"),8;ob.App.xa.ZF({ShowVisiMarkers:"ToggleButtonModel"});
return 32};this.lan=(n,x,E,S,ma)=>{if(1===E)return 32;ma[Qf.a.On]=this.XKe.dPc;return 32};this.ga=b;this.XKe=h}Vb(){this.ga.gb(Db.a.L7d,cc.a.application,this.TWn,1);this.ga.gb(Db.a.WGi,cc.a.application,this.lan,96)}}Object(r.a)(Fw,"VisiMarkersActor",null,[]);class tw{zc(b){b.ha("Box4.Actors.Box4PasteStewardFactory",()=>new Nv(Ig.a.gAb,b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Actors.IBox4PasteStewardBridge"))).as("Box4.Actors.IBox4PasteStewardFactory").singleInstance();
b.ha("Box4.Actors.Box4PasteStewardUtils",()=>new ex(u.AFrameworkApplication.K.$("WacPasteBrAsNewParagraphIsEnabled"))).as("Box4.Actors.IBox4PasteStewardUtils").singleInstance();b.ha("Box4.Actors.ClipboardActor",()=>new Sy.ClipboardActor(b.Ye("Box4.Actors.IClipboardOperationFactory"),b.resolve("Box4.Actors.ISystemClipboard"),vb.a.instance,b.resolve("Box4.IClipboardDataHelper"),kh.a.instance,u.AFrameworkApplication.ya,b.resolve("Box4.IUndoManager"),u.AFrameworkApplication.K,de.FocusManager.instance(),
b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),u.AFrameworkApplication.CZf(),u.AFrameworkApplication.q2i(),b.resolve("Box4.Actors.PasteFloatiePositionProvider"),Oa.a.instance.resolve("Common.IReactContextualUILauncher"),!!ob.App.instance&&ob.App.instance.YCb)).singleInstance();b.ha("Common.App.ChromeExtensionHelper.IChromeExtensionHelper",()=>new jv(u.AFrameworkApplication.K)).singleInstance();
b.ha("Box4.Clipboard.ISystemClipboardAccessManagerFactory",()=>new zi(u.AFrameworkApplication.K,b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Box4.IClipboardDataHelper"),ds.a.instance)).singleInstance();b.ha("Box4.Clipboard.ISystemClipboardAccessManager",()=>b.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create()).singleInstance();b.ha("Box4.Actors.ISystemClipboard",()=>new Pn(b.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),cb.InteractiveViewManager.instance,
ob.App.xa.jb,de.FocusManager.instance(),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),ds.a.instance,u.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IDeleteTableSegmentStrategy",()=>new A).singleInstance();b.ha("Box4.ISelectionFactory",()=>new kx.a).singleInstance();b.ha("Box4.IRenderOrderGraphIteratorFactory",()=>new Gt).singleInstance();b.ha("Common.IDomElementContentStateFactory",()=>new Fo).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteOvertypeStrategy",
()=>new Og(kh.a.instance,b.resolve("Box4.IParagraphReader"),b.resolve("Box4.Styles.IWACStyleReader"),Of.a.instance.J(10))).singleInstance();b.ha("Box4.Actors.PastedContentsPostProcessorHelper",()=>new Lt).singleInstance();b.ha("Box4.Actors.PasteFloatiePositionProvider",()=>new ou(kh.a.instance,b.resolve("Box4.ITextMetricsAdapter"),cb.InteractiveViewManager.instance,rd.a.getElementBounds,b.resolve("Box4.UI.PasteFloatieManager"),!!ob.App.instance&&ob.App.instance.YCb)).singleInstance();b.ha("Box4.Actors.PasteFloatieFeatureSetBuilder",
()=>new Dw(b.resolve("Box4.IClipboardDataHelper"),ob.App.Av.PH)).singleInstance();b.ha("Box4.Actors.PasteFloatieEventManager",()=>new Mt(b.resolve("Box4.UI.PasteFloatieManager"),b.resolve("Box4.IPasteFloatieEventSource"),cb.InteractiveViewManager.instance,Mq.a.instance(),u.AFrameworkApplication.ua,b.resolve("Box4.Actors.PasteFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),ob.App.Wj.al.Te(12),b.resolve("Box4.Graph.IGraphTransactionManager"),
b.resolve("Common.IReactContextualUILauncher"),!!ob.App.instance&&ob.App.instance.YCb)).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteFactory",()=>new ix(vb.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.Actors.PasteCoordinator"),Gn.a.instance,kh.a.instance,u.AFrameworkApplication.ya,b.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),b.Ye("Box4.IUndoManager"),b.resolve("Common.IDomElementContentStateFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),
b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();b.ha("Box4.Actors.IClipboardOperationCutCopyFactory",()=>new hx(u.AFrameworkApplication.ya,vb.a.instance,b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.IOutlineElementEditor"),kh.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),b.resolve("Box4.IParagraphReader"),rs.a.instance,b.resolve("Box4.IOutlineElementNavigator"),b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("Box4.IOutlineElementReader"),
b.resolve("Box4.IRenderOrderGraphIteratorFactory"),b.resolve("Box4.ISelectionFactory"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.IClipboardDataHelper"),b.Pa("Box4.IFeatureHelper"))).singleInstance();b.ha("Box4.Actors.IClipboardOperationClipboardAccessHelper",()=>new gx(vb.a.instance,ds.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),b.resolve("Common.ISimpleOperationFactory"),u.AFrameworkApplication.K.appSettings.ChromeClipboardAccessOperationTimeout)).singleInstance();b.ha("Box4.Actors.IClipboardOperationPasteStrategyFactory",
()=>new zw(u.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IClipboardOperationFactory",()=>new xi(b.resolve("Box4.Actors.InternalClipboard"),u.AFrameworkApplication.ya,u.AFrameworkApplication.zZf(),vb.a.instance,rs.a.instance,ds.a.instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.Actors.ClipboardOperationWordStrategy"),
b.resolve("Box4.ICannotCutDialog"),b.resolve("Common.ISimpleOperationFactory"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Common.Utils.Telemetry.ITelemetry"))).singleInstance();b.ha("Box4.Actors.IExternalPasteExecutionManagerFactory",()=>new Oz(b.Ye("Box4.Actors.IBox4PasteStewardFactory"),b.Ye("Box4.Actors.IBox4ImageStewardFactory"),
b.Ye("Box4.Actors.IBox4TableStewardFactory"),b.Ye("Box4.Actors.IBox4WordConverterFactory"),b.Ye("HtmlImport.IHtmlTranslatorSettings"),b.Pa("Box4.IContentControlCopyPasteHelper"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.IExternalPasteCssConverter"),b.resolve("HtmlImport.IHtmlNormalizerSettings"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Actors.IHtmlNormalizerHelper"))).singleInstance();b.ha("Box4.Actors.InternalClipboard",()=>new bk(b.resolve("Box4.Images.IImageEditor"),
b.Ye("Box4.ITableEditor"),b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.List.IListEditor"),ob.App.Wj,b.resolve("Box4.IParagraphIndentationReader"),u.AFrameworkApplication.K,b.resolve("Box4.Graph.IGraphNodeFactory"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.Pa("Box4.IContentControlCopyPasteHelper"),b.resolve("Box4.ITableCellReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IConstantsProvider").zVi,b.resolve("Box4.IFormattingPropertyTransitStrategy"))).singleInstance();
b.ha("Box4.Actors.IInternalPasteExecutionManagerFactory",()=>new zA(b.resolve("Box4.Actors.InternalClipboard"),b.Pa("Box4.IContentControlCopyPasteHelper"),new se.a(()=>ob.App.xa.jb.Jc),b.resolve("Box4.IFormattingPropertyTransitStrategy"))).singleInstance();b.ha("Box4.List.IListCommands",()=>new Dc(u.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.Actors.PasteCoordinator",()=>new Sp(b.resolve("Box4.Actors.InternalClipboard"),b.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),b.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"))).singleInstance();
b.ha("Box4.Actors.Box4ImageStewardFactory",()=>new Ct(b.resolve("Box4.Images.IImageEditor"),u.AFrameworkApplication.uc,b.resolve("Box4.IUndoManager"),b.Pa("Box4.Actors.IImageStewardBridge"),ob.App.xa.notificationBar,b.Pa("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager").$("WordEditorPastePictureFailedImprovementIsEnabled"),b.resolve("Common.IAppSettingsManager").$("NotificationBarImageErrorIsEnabled"),b.resolve("Common.IAppSettingsManager").$("ImageAccessibilityAltTextOnlyIsEnabled"),
b.resolve("Common.IAppSettingsManager").$("LogActionForFailedLocalImagePasteIsEnabled"))).as("Box4.Actors.IBox4ImageStewardFactory").singleInstance();b.ha("Box4.Actors.Box4TableStewardFactory",()=>new yw(Oa.a.instance.resolve("Box4.List.IListEditor"),Oa.a.instance.resolve("Box4.ITableEditor"),b.resolve("Common.IAppSettingsManager").$("PasteComplexTablesIsEnabled"),b.resolve("Common.IAppSettingsManager").$("PasteTableCellMarginImprovementsIsEnabled"))).as("Box4.Actors.IBox4TableStewardFactory").singleInstance();
b.ha("Box4.Actors.ClipboardOperationWordStrategy",()=>new Ht(vb.a.instance,kh.a.instance,ob.App.rd,Ai.a.instance,Of.a.instance.J(4))).singleInstance();b.ha("Box4.Actors.Box4WordConverterFactory",()=>new Yx(u.AFrameworkApplication.K)).as("Box4.Actors.IBox4WordConverterFactory").singleInstance();b.ha("Box4.Actors.IExternalPasteCssConverter",()=>new Aw(u.AFrameworkApplication.K)).singleInstance();b.ha("Box4.Actors.IHtmlNormalizerHelper",()=>new Wy).singleInstance();b.ha("Box4.ISelectionCommands",()=>
new iu(u.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.ITextFormattingCommands",()=>new ys(u.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.Actors.AccessibilityActor",()=>new bu(b.Za("Box4.Accessibility.IAccessibilityContextManager"),b.resolve("Box4.Proofing.IErrorRangeEditor"))).singleInstance();b.ha("Box4.Actors.InsertionPointFormatting",()=>new hc(b.Pa("Box4.IFontSlotProvider"),b.Za("Box4.Actors.IFontNameFormattingStrategy"))).as("Box4.IInsertionPointFormatting").singleInstance();
b.ha("Box4.UI.PasteFloatieManager",()=>new Sq).as("Box4.UI.IFloatieManager").singleInstance();b.ha("Box4.Actors.ProofingActor",()=>new Ys(Oa.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),u.AFrameworkApplication.ya,()=>Oa.a.instance.resolve("Box4.UI.ILanguageDialog"),Oa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Oa.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),kh.a.instance,Oa.a.instance.Za("Box4.IExternalSelectionManager"),rs.a.instance,Oa.a.instance.resolve("Box4.ISelectionContextMenuProvider"),
Ai.a.instance,vb.a.instance,Oa.a.instance.resolve("Box4.IContextMenuController"),Oa.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),Oa.a.instance.Za("Box4.Actors.IProofingErrorPresenter"),Of.a.instance,Oa.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),Oa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).singleInstance();b.ha("Box4.Actors.StyleActor",()=>new Tu(Oa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Oa.a.instance.resolve("Box4.Styles.IWACStyleEditor"),
Oa.a.instance.resolve("Box4.IFormattingEditor"),Rl.ContextSetEditor.instance,Oa.a.instance.resolve("Box4.IInsertionPointFormatting"),Ai.a.instance,vb.a.instance,Oa.a.instance.resolve("Box4.TextFormattingHelper"),Il.instance,Oa.a.instance.resolve("Box4.Styles.IWACStyleReader"))).singleInstance();b.ha("Box4.Actors.StyleContextMenuActor",()=>new gu(Oa.a.instance.resolve("Box4.IUpdateStyleManager"),Oa.a.instance.resolve("Box4.Styles.IWACStyleReader"),u.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.Actors.TextFormattingActor",
()=>new Ew.a(b.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),b.resolve("Box4.IBox4GraphWriter"),b.Pa("Box4.IFontSlotProvider"),b.Pa("Box4.IContentControlChpHelper"))).singleInstance();b.ha("Box4.Actors.AutoCorrectActor",()=>new Gi(u.AFrameworkApplication.ya,vb.a.instance,()=>Oa.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog"))).singleInstance();b.ha("Box4.Actors.TouchInputActor",()=>new no(u.AFrameworkApplication.ya,u.AFrameworkApplication.K,fl.GrippersManager.instance,
kh.a.instance)).as("Box4.ITouchInputActor").singleInstance();b.register(nn,"Box4.VisiMarkersOperation").as("Box4.IVisiMarkersOperation").singleInstance();b.ha("Box4.Actors.VisiMarkersActor",()=>new Fw(u.AFrameworkApplication.ya,b.resolve("Box4.IVisiMarkersOperation"))).singleInstance();b.ha("Box4.Actors.IndentationActorExtension",()=>new Ha).as("Box4.Actors.IIndentationActorExtension").singleInstance()}}Object(r.a)(tw,"Box4ActorsComponentConfiguration",null,[2]);var iy=d(1050);const ot=()=>{const b=
jy;u.AFrameworkApplication.ya.pa(Db.a.X3e,cc.a.embeddedFile,b);u.AFrameworkApplication.ya.pa(Db.a.X3e,cc.a.c1b,b);u.AFrameworkApplication.ya.pa(Db.a.W3e,cc.a.embeddedFile,ly);u.AFrameworkApplication.ya.pa(Db.a.W3e,cc.a.c1b,ly)},jy=(b,h,n)=>ob.App.wyd?8:2===n?(b=new yd.StandardDialog,b.Ed=4,b.lU(1),b.We(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),b.We(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),b.q_f(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,
ky),32):2,ky=b=>{1===b&&u.AFrameworkApplication.ya.processAction(Db.a.W3e,2)},ly=(b,h,n)=>{if(ob.App.wyd)return 8;if(1===n)return h.node.hasProperty(ie.a.embeddedFileContainer)?32:2;if(2===n&&(h.contextId===cc.a.view&&h.view.Cb&&(h=h.view.Cb.Rg),Cw.isEmbeddedFileOrFloatingEmbeddedFileContext(h))){b=iy.a.Npl(h.node);Ya.a.XNn();try{qx(b)}catch(x){w.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",x)}}return 32},qx=b=>{rd.a.ym(b,void 0,void 0,"EmbeddedFileActor.SaveFile")};var rx=
d(753),Br=d(499),Rv=d(1177),sx=d(1192);class es{constructor(b){this.JU=null;this.Efa=(h,n,x,E,S)=>{if(1===x)return 32;u.AFrameworkApplication.ya.Xb(Db.a.c1a,2,S);h=S&&0<=S.fontColor&&16777215>=S.fontColor?S.fontColor:0;ob.App.xa.Vu();(new Rv.a(es.Qmh,Db.a.tga)).E_c(h);return 32};this.CGb=(h,n,x,E,S)=>{if(1===x)return 32;if(2===x&&!S)return 8;h=es.Ue.aGd(n);n=new rx.a;x=null;32===u.AFrameworkApplication.ya.Xb(Db.a.c1a,2,n)&&n&&(x=n.fontColor);E="";x&&!n.g1b&&(E=Eo.a.BC(x)||"");this.VHh.Ncc=E;h=this.VHh.RCd(h,
ob.App.OYb);if(!h)return 8;S.MenuItems=h;w.ULS.sendTraceTag(595153826,340,50,"Font color dropdown menu is opened.");return 32};this.Exe=b}get VHh(){this.JU||(this.JU=new sx.a(es.Qmh),this.$Ya(this.JU));return this.JU}$Ya(b){b.Uca(1,Db.a.B5);b.Uca(3,Db.a.Is);b.Uca(4,Db.a.Is);b.Uca(5,Db.a.tga);b.Uca(6,Db.a.Efa);b.tWb(this.Exe,1)}Vb(){const b=u.AFrameworkApplication.ya;b.pa(Db.a.Efa,cc.a.view,this.Efa);b.pa(Db.a.CGb,cc.a.view,this.CGb);b.Vc(Db.a.CGb,1127)}static Jql(){return new es(Br.a.instance)}static get instance(){return null!=
es.ykg?es.ykg:es.ykg=es.Jql()}static get Ue(){return Nd.PageReader.instance}}es.Qmh="Font";Object(r.a)(es,"FontColorActor",null,[]);class qu{constructor(b){this.Efa=(h,n,x,E,S)=>{if(1===x)return 32;u.AFrameworkApplication.ya.Xb(Db.a.c1a,2,S);h=S&&0<=S.highlight&&16777215>=S.highlight?S.highlight:0;ob.App.xa.Vu();(new Rv.a("Highlighter",Db.a.l7)).E_c(h);return 32};this.ga=b}Vb(){this.ga.pa(Db.a.Vzi,cc.a.view,this.Efa)}static ysl(){return new qu(u.AFrameworkApplication.ya)}static get instance(){return null!=
qu.ilg?qu.ilg:qu.ilg=qu.ysl()}}Object(r.a)(qu,"HighlighterColorActor",null,[]);var oo=d(299),tx;(function(b){b.Heading="Heading";b.Bookmark="Bookmark";b.Url="Url";b.RecentLinks="RecentLinks"})(tx||(tx={}));Object(r.b)("InsertLinkUserActivitySource",tx);class rh{constructor(b,h,n){this.$ob=this.Tm=this.ml=null;this.Woc=!1;this.rD=null;this.Ef=cb.InteractiveViewManager.instance.xd;this.Wk=b;this.ml=n;this.rD=h;rh.g1&&Kd.SelectionEditor.Ek(b)&&(b=Kd.SelectionEditor.$1c(this.Wk),Kd.SelectionEditor.Ek(b)?
this.Wk=b:w.ULS.sendTraceTag(41522313,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak."));b=Kd.SelectionEditor.dLb(this.Wk);Kd.SelectionEditor.Ek(b)&&(this.Wk=b)}get eta(){return null!=this.wlg?this.wlg:this.wlg=Oa.a.instance.Pa("Box4.IInternalLinkManager")}get Hk(){return this.Tm||(this.Tm=Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get titleText(){return Box4Intl.Box4Strings.l_InsertLinkTitle}get $6h(){return Box4Intl.Box4Strings.l_InsertLinkButtonText}dispose(){}kEh(b,
h,n){if(h!==this.Wk.cpEnd||b!==this.Wk.cpBegin)b=Ae.SelectionFactory.wN(n,b,h),this.Ef.Cb.setSelection(b),this.Wk=Kd.SelectionEditor.dLb(b.Qa.clone())}cOh(b){const h=nh.HyperlinkReader.Y2b(this.Wk);let n=this.Wk.cpBegin,x=this.Wk.cpEnd,E="";if(!h.length)return this.$ob=b.substring(this.Wk.cpBegin,this.Wk.cpEnd),{returnValue:!0,x4d:E,EAd:n,FAd:x,yKd:h};if(h[0].hyperlink){let S,ma=0,Fa=Math.max(0,b.length-1),$a=0;for(let sb=0;sb<h.length;sb++)h[sb].cpBegin>=ma&&({cpBegin:S,cpEnd:ma}=rh.nI.c$(this.Wk,
h[sb]),Fa=Math.min(S,Fa),$a=Math.max(ma,$a));n=Math.min(Fa,n);x=Math.max($a,x);this.$ob=b.substring(n,x);n===Fa&&(E=h[0].hyperlink.url);return{returnValue:!0,x4d:E,EAd:n,FAd:x,yKd:h}}return{returnValue:!1,x4d:E,EAd:n,FAd:x,yKd:h}}g5f(b){Of.a.instance.J(3)&&rh.Rd.f5f(b)}BLd(b,h){if(this.Ef.Nr){var n=nh.HyperlinkReader.Y2b(this.Wk);var x=this.Ef.Cb.ib.kb;if(x){x=x.Qa;Cd.ParagraphReader.gm(x)&&(x=Dd.a.createTextRange(x.node,0,Cd.ParagraphReader.textLength(x.node)));if(rh.g1&&Kd.SelectionEditor.Ek(x)){var E=
Kd.SelectionEditor.$1c(x);Kd.SelectionEditor.Ek(E)?x=E:w.ULS.sendTraceTag(41522316,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak.")}E=Kd.SelectionEditor.dLb(x);Kd.SelectionEditor.Ek(E)&&(x=E);if(0!==b&&32===u.AFrameworkApplication.ya.Qf(x,Db.a.insertHyperlink,1,!0,null,null)&&this.Wk.equals(x)){ue.a.mark(5562);Of.a.instance.J(4)&&ob.App.rd&&ob.App.rd.Kp&&this.Ef.Cb.SVb();b=new Se.GraphTransaction(15);b.Db(this.Wk.node);this.Wk.node.MG().sF.p9(4);
x=h.txtDisplay;E=!1;if(null!=h.linkurl)if(E=!0,h.isHeading){m(this.rD,"Heading");const S=h.paragraphNode,ma=h.startCp,Fa=h.endCp;h=this.ml.hLh(S);this.ml.$Vb(h,ma,Fa,S,S,!1)}else m(this.rD,"Bookmark"),h=h.linkurl;else m(this.rD,"Url"),h=h.txtLink.trim();this.insertLink(x,h,n,E);b.zl=Db.a.insertHyperlink;b.dispose();ue.a.mark(5563);this.Wk.node.Sbb();this.pS()}else this.Ef.JX()}else w.ULS.sendTraceTag(41522314,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}}zaj(b,h,
n,x,E,S=!1){x?(x=Dd.a.createTextRange(this.Wk.node,this.Wk.cpBegin,this.Wk.cpBegin+b.length),rh.hyperlinkEditor.HAh(x,n,h),b=Ae.SelectionFactory.xe(this.Wk.node,this.Wk.cpBegin+b.length)):(rh.hyperlinkEditor.rhb(this.Wk,2),this.Hk.dkb(this.Wk,2),n=Dd.a.Uc(this.Wk.node,this.Wk.cpEnd),rh.characterPropertiesEditor.replaceTextRange(n,b,!0),x=Dd.a.createTextRange(this.Wk.node,this.Wk.cpEnd,this.Wk.cpEnd+b.length),rh.hyperlinkEditor.DG(x,h,E,!1,!0,S),b=Ae.SelectionFactory.xe(this.Wk.node,this.Wk.cpEnd+
b.length));b&&this.Ef.Cb.setSelection(b)}insertLink(b,h,n,x=!1){var E=null;b||(b=h,u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveLinkUrlLineBreak",!0)&&(b=b.replace(/[\r\n\v]/g,"")));if(h&&(!n.length||h!==n[0].hyperlink.url)&&!x){h=nh.HyperlinkReader.kLa(h);var S="";this.eta&&({dQf:S}=this.eta.m5f(h)).returnValue&&(h=S)}this.Woc||(b=rh.hyperlinkEditor.wsn(b));let ma=!1;S=!1;if(h){E=0<n.length;var Fa=!0;rh.vdm&&(Fa=Cd.ParagraphReader.text(this.Wk.node).substring(this.Wk.cpBegin,
this.Wk.cpEnd)!==b);if(rh.Rd.wg&&1===n.length&&!n[0].hyperlink.zF&&!(n[0].cpBegin>this.Wk.cpBegin&&n[0].cpEnd<=this.Wk.cpEnd)){this.zaj(b,h,n[0].hyperlink,!Fa,E,x);return}if(E)for(var $a=0;$a<n.length;$a++)n[$a].hyperlink.zF&&(S=!0),rh.hyperlinkEditor.LQ(this.Wk.node,n[$a].hyperlink,!1);Fa&&rh.characterPropertiesEditor.replaceTextRange(this.Wk,b,!S);Fa||!rh.Rd.wg||S||this.Hk.dkb(this.Wk,1);n=Dd.a.createTextRange(this.Wk.node,this.Wk.cpBegin,this.Wk.cpBegin+b.length);rh.hyperlinkEditor.DG(n,h,E,S,
!0,x);E=Ae.SelectionFactory.xe(this.Wk.node,this.Wk.cpBegin+b.length)}else if(0<n.length){Fa=n[0];const sb=({cpBegin:x,cpEnd:$a}=rh.nI.c$(this.Wk,Fa)).returnValue;Fa.hyperlink.zF&&(S=!0);h?Fa.hyperlink.aeb?(h!==Fa.hyperlink.url&&(rh.Rd.wg&&!S?(n=Dd.a.createTextRange(this.Wk.node,x,x+b.length),rh.hyperlinkEditor.HAh(n,Fa.hyperlink,h)):rh.nI.Sgo(h,sb)),b!==this.$ob&&(rh.characterPropertiesEditor.replaceTextRange(Dd.a.createTextRange(this.Wk.node,x,$a),b,!0),h=Dd.a.createTextRange(this.Wk.node,x,x+b.length),
this.g5f(h),E=Ae.SelectionFactory.xe(this.Wk.node,x+b.length),ma=!0)):rh.Rd.wg&&!S?(x=Cd.ParagraphReader.text(this.Wk.node).substring(this.Wk.cpBegin,this.Wk.cpEnd)===b,this.zaj(b,h,n[0].hyperlink,x,!1)):(rh.nI.FQf(this.Wk,sb),rh.characterPropertiesEditor.replaceTextRange(Dd.a.createTextRange(this.Wk.node,x,$a),b,!S),n=Dd.a.createTextRange(this.Wk.node,x,x+b.length),rh.hyperlinkEditor.DG(n,h,!1,S),E=Ae.SelectionFactory.xe(this.Wk.node,x+b.length)):rh.hyperlinkEditor.LQ(Fa.paragraph,Fa.hyperlink)}(ma||
S)&&rh.Rd.us(S?2:7);E&&this.Ef.Cb.setSelection(E);ob.App.H9n()}static get hyperlinkEditor(){return rh.mC||(rh.mC=Oa.a.instance.resolve("Box4.IHyperlinkEditor"))}static get characterPropertiesEditor(){return rh.Vd||(rh.Vd=Oa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Rd(){return rh.Hd||(rh.Hd=Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get nI(){return rh.KGg||(rh.KGg=Oa.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get vdm(){null==
rh.fte&&(rh.fte=u.AFrameworkApplication.K?u.AFrameworkApplication.K.$("KeepHyperlinkFormatFixIsEnabled"):!1);return rh.fte}static get yCb(){null==rh.eqb&&(rh.eqb=u.AFrameworkApplication.K?u.AFrameworkApplication.K.$("HyperlinkUrlValidationIsEnabled"):!1);return rh.eqb}static get g1(){null==rh.zU&&(rh.zU=u.AFrameworkApplication.K?u.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return rh.zU}}rh.mC=null;rh.Vd=null;rh.Hd=null;rh.KGg=null;rh.fte=null;rh.eqb=null;rh.zU=null;
rh.source="Source";rh.gnh="CommandingInterface";rh.Pxb="DisplayText";rh.url="Url";rh.id="InsertLinkDialog";Object(r.a)(rh,"AInsertLinkDialog",null,[10]);class nv{static get ug(){return Kc.a.Lx(nv.rl,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}nv.rl="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(r.a)(nv,"InsertLinkDialogHtml",null,[]);class my extends rh{constructor(b,h){super(b,h);this.ig=new Kc.a;this.ig.kg=rh.id;let n=this.$ob="";var x=Cd.ParagraphReader.text(this.Wk.node);let E=this.Wk.cpBegin,S=this.Wk.cpEnd;({x4d:n,EAd:E,FAd:S,yKd:x}=this.cOh(x));(h="object"===typeof h?h:null)&&(h[rh.source]&&h[rh.source]===rh.gnh||h[rh.url]&&h[rh.Pxb])?this.insertLink(h[rh.Pxb],h[rh.url],x):(x[0]&&this.kEh(E,S,x[0].paragraph),this.ig.ug=nv.ug,""===n.trim()&&this.ig.We(1,this.$6h),h={["txtLink"]:n,
["txtDisplay"]:this.$ob},this.ig.nyd=Object(v.a)(this,this.L1,"dialogDefaultEnterKeyHandler"),this.ig.myd=Object(v.a)(this,this.L1,"dialogDefaultEnterKeyHandler"),this.ig.Zh(this.titleText,Object(v.a)(this,this.BLd,"insertLinkDialogHandler"),h),rh.yCb&&(h=document.getElementById("txtLink"),af.a.addHandler(h,kb.a.input,Object(v.a)(this,this.q0a,"onLinkChanged")),af.a.addHandler(h,kb.a.change,Object(v.a)(this,this.q0a,"onLinkChanged"))),document.getElementById("txtLink").focus(),rh.g1?0<Ad.g(Dd.a.jL(E,
S,!1,this.Wk.node)).length&&(this.Woc=!0,document.getElementById("txtDisplay").disabled=!0):1>=x.length&&rh.nI.aph(b,x[0],1===x.length)&&(this.Woc=!0,document.getElementById("txtDisplay").disabled=!0))}q0a(){if(this.ig){const b=document.getElementById("txtLink");this.ig.rga(1,!b||!b.value.length||nh.HyperlinkReader.xMa(b.value))}}L1(b){return this.ig?rh.yCb?this.ig.tLh(this.ig.IOb)?this.ig.L1(b):!1:this.ig.L1(b):!1}pS(){if(rh.yCb){const b=document.getElementById("txtLink");b&&(af.a.removeHandler(b,
kb.a.change,Object(v.a)(this,this.q0a,"onLinkChanged")),af.a.removeHandler(b,kb.a.input,Object(v.a)(this,this.q0a,"onLinkChanged")))}this.ig&&(this.ig=null)}}Object(r.a)(my,"InsertLinkDialog",rh,[]);class Cr{constructor(b,h,n,x,E){this.linkurl=b;this.isHeading=h;this.startCp=n;this.endCp=x;this.paragraphNode=E}}Object(r.a)(Cr,"HeadingDataForLinkDialog",null,[]);class ov{constructor(b,h){this.linkurl=b;this.isHeading=h}}Object(r.a)(ov,"BookmarkDataForLinkDialog",null,[]);class Zs{constructor(b,h,n,
x,E,S){this.key=b;this.name=h;this.startIndex=n;this.count=x;this.level=E;this.isCollapsed=S}}Object(r.a)(Zs,"GroupHeaderDataForLinkDialog",null,[]);class ru{constructor(b,h){this.selectedIndex=b;this.selectedGroupId=h}}Object(r.a)(ru,"SelectedItemFromLinkDialogGroupedList",null,[]);class Uu extends rh{constructor(b,h,n,x,E){super(b,h,x);this.lme=n;this.Ih=E;const S=new Kc.a(!1,!1,!0);n={};n.displayTextLabel=Box4Intl.Box4Strings.l_InsertLinkDisplayText;n.addressLabel=Box4Intl.Box4Strings.l_InsertLinkAddress;
n.insertInternalLinkEnabled=!0;n.enterLinkTabLabel=Box4Intl.Box4Strings.l_EnterLinkText;n.thisDocumentTabLabel=Box4Intl.Box4Strings.l_ThisDocumentText;n.groupedList=this.Irl();var ma=this.$ob="";ma=Cd.ParagraphReader.text(this.Wk.node);x=this.Wk.cpBegin;E=this.Wk.cpEnd;let Fa;({x4d:ma,EAd:x,FAd:E,yKd:Fa}=this.cOh(ma));if((h="object"===typeof h?h:null)&&(h[rh.source]&&h[rh.source]===rh.gnh||h[rh.url]&&h[rh.Pxb]))this.insertLink(h[rh.Pxb],h[rh.url],Fa);else{Fa[0]&&this.kEh(x,E,Fa[0].paragraph);h=CommonUIStrings.l_DialogOk;
""===ma.trim()&&(h=this.$6h);S.We(1,h);ma&&ma.startsWith(B.a.N$a)?(h=this.jGl(ma,n.groupedList))?n.groupedList.selectedItem=h:n.txtLink=ma:n.txtLink=ma;n.txtDisplay=this.$ob;rh.g1?0<Ad.g(Dd.a.jL(x,E,!1,this.Wk.node)).length&&(this.Woc=!0,n.textDisplayDisabled=!0):1>=Fa.length&&rh.nI.aph(b,Fa[0],1===Fa.length)&&(this.Woc=!0,n.textDisplayDisabled=!0);var $a={["id"]:rh.id,["bodyControls"]:n};this.Ih.Pd(()=>{S.Zh(this.titleText,Object(v.a)(this,this.BLd,"insertLinkDialogHandler"),$a)},"RILD:IAS")}}jGl(b,
h){h=h.items;const n=b.substring(B.a.N$a.length),x=this.ml.Zef(n);b=-1;let E=0;for(let S=0;S<h.length;S++)if(h[S].isHeading&&0!=x.count&&h[S].paragraphNode.id==x.J(0).id){b=S;break}else if(!h[S].isHeading&&h[S].linkurl==n){b=S;E=1;break}h=new ru(b,E);return-1!=b?h:null}Irl(){const b={};let h=[],n=0,x=0;var E=this.lme.lQh();null!=E&&(n=E.count,h=h.concat(this.nsl(E)));E=this.ml.qGc(!1);null!=E&&(x=E.count,h=h.concat(this.xhl(E)));b.groups=this.dsl(n,x);b.items=h;return b}dsl(b,h){const n=[];let x=
new Zs("ThisDocumentTabHeadings",Box4Intl.Box4Strings.l_InsertLinkHeadings,0,b,0,!0);n.push(x);b=new Zs("ThisDocumentTabBookmarks",Box4Intl.Box4Strings.l_InsertLinkBookmarks,b,h,0,!0);n.push(b);return n}nsl(b){const h=[];for(const n of b)b=new Cr(n.characterData,!0,n.begin,n.end,n.paragraphNode),h.push(b);return h}xhl(b){const h=[];for(const n of b)b=n.Og(ic.a.Rs).toString(),b=new ov(b,!1),h.push(b);return h}pS(){}}Object(r.a)(Uu,"ReactInsertLinkDialog",rh,[]);class Vu{constructor(){this.Hpa=!!u.AFrameworkApplication.ua&&
u.AFrameworkApplication.ua.Sb.zA}vsh(b,h,n,x){this.Hpa?new Uu(b,h,n,x,oo.a.instance):new my(b,h)}static get instance(){return null!=Vu.dkg?Vu.dkg:Vu.dkg=new Vu}}Object(r.a)(Vu,"InsertLinkDialogFactory",null,[522]);class yn extends Kc.a{constructor(b){super();this.q0a=()=>{const h=document.getElementById("txtLink");this.rga(1,!h||!h.value.length||nh.HyperlinkReader.xMa(h.value))};this.BLd=(h,n)=>{if(this.Ef.Nr){var x=this.Ef.Cb.ib.kb;if(x)if(x.equals(this.Ms)&&0!==h){h=new Se.GraphTransaction(15);
h.Db(this.aS[0].node);for(x=0;x<this.aS.length;x++)this.aS[x].node.MG().sF.p9(4);x=n.txtLink.trim();n=this.iQk();x=this.H3l(x);(n||x)&&yn.Rd.us(7);this.hide();h.dispose()}else this.Ef.JX()}};this.aS=b;this.Ef=cb.InteractiveViewManager.instance.xd;this.Ms=this.Ef.Cb.ib.kb;this.g8e=b[0].cpBegin;this.Wtf=b[b.length-1].cpEnd;this.kg="InsertMultiParagraphLinkDialog";b=this.Zfo();this.showDialog("",b)}showDialog(b,h){w.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.ug=
nv.ug;""===h.trim()&&this.We(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);this.Zh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.BLd,{["txtLink"]:h,["txtDisplay"]:b});document.getElementById("txtLink").focus();document.getElementById("txtDisplay").disabled=!0;yn.yCb&&(b=document.getElementById("txtLink"),af.a.addHandler(b,kb.a.input,this.q0a),af.a.addHandler(b,kb.a.change,this.q0a))}hide(){if(yn.yCb){const b=document.getElementById("txtLink");b&&(af.a.removeHandler(b,kb.a.change,this.q0a),af.a.removeHandler(b,
kb.a.input,this.q0a))}super.hide()}L1(b){return yn.yCb?this.tLh(this.IOb)?super.L1(b):!1:super.L1(b)}Zfo(){let b;var h="";const n=this.aS.length,x=nh.HyperlinkReader.NC(this.aS[0],!1);0<x.length&&({cpBegin:E,cpEnd:b}=yn.nI.c$(this.aS[0],x[0]),E<=this.aS[0].cpBegin&&(h=x[0].hyperlink.url),this.g8e=Math.min(this.g8e,E));var E=nh.HyperlinkReader.NC(this.aS[n-1],!1);0<E.length&&({cpBegin:E,cpEnd:b}=yn.nI.c$(this.aS[n-1],E[E.length-1]),this.Wtf=Math.max(this.Wtf,b));this.n$n(this.g8e,this.Wtf);return h}n$n(b,
h){const n=this.aS.length;if(b!==this.aS[0].cpBegin||h!==this.aS[n-1].cpEnd){b=Dd.a.Uc(this.aS[0].node,b);b=Ae.SelectionFactory.Kn(b);h=Dd.a.Uc(this.aS[n-1].node,h);h=Ae.SelectionFactory.MC(b,h);b=this.mZh(h.Qa.clone());const x=this.mZh(h.Tc.clone());b&&x&&(this.aS[0]=b,this.aS[n-1]=x,this.Ef.Cb.setSelection(h),this.Ms=h)}}H3l(b){if(!b)return!1;b=nh.HyperlinkReader.kLa(b);for(let n=0;n<this.aS.length;n++){var h=this.aS[n];if(yn.g1&&Kd.SelectionEditor.Ek(h)&&(h=Kd.SelectionEditor.$1c(h),!Kd.SelectionEditor.Ek(h)))continue;
h=Dd.a.createTextRange(this.aS[n].node,h.cpBegin,h.cpEnd);this.g5f(h);yn.hyperlinkEditor.DG(h,b,!1)}return!0}g5f(b){Of.a.instance.J(3)&&yn.Rd.f5f(b)}mZh(b){return Cd.ParagraphReader.gm(b)&&!Kd.SelectionEditor.p6(b)&&Cd.ParagraphReader.textLength(b.node)?Dd.a.createTextRange(b.node,0,Cd.ParagraphReader.textLength(b.node)):Kd.SelectionEditor.Ek(b)?b:null}iQk(){let b=!1;for(const h of this.aS){const n=nh.HyperlinkReader.NC(h,!1);n&&(b=yn.nI.FQf(h,n)||b)}return b}static get nI(){return null!=yn.Ejg?yn.Ejg:
yn.Ejg=Oa.a.instance.resolve("Box4.IHyperlinkStrategy")}static get Rd(){return null!=yn.Bqg?yn.Bqg:yn.Bqg=Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get hyperlinkEditor(){return null!=yn.wjg?yn.wjg:yn.wjg=Oa.a.instance.resolve("Box4.IHyperlinkEditor")}static get g1(){null==yn.zU&&(yn.zU=u.AFrameworkApplication.K?u.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return yn.zU}static get yCb(){null==yn.eqb&&(yn.eqb=u.AFrameworkApplication.K?
u.AFrameworkApplication.K.$("HyperlinkUrlValidationIsEnabled"):!1);return yn.eqb}}yn.zU=null;yn.eqb=null;Object(r.a)(yn,"InsertMultiParagraphLinkDialog",Kc.a,[]);class Oe{static get bookmarkManager(){return null!=Oe.kfg?Oe.kfg:Oe.kfg=Oa.a.instance.Ye("WordEditor.Bookmark.FullBookmarkManager").value}static get O_b(){return null!=Oe.Rgg?Oe.Rgg:Oe.Rgg=Oa.a.instance.Ye("WordEditor.TableOfContents.StyleBasedDocumentHeadings").value}static get Zf(){return Ai.a.instance}static get vda(){return null!=Oe.Wfg?
Oe.Wfg:Oe.Wfg=Oa.a.instance.Pa("Box4.IContentControlChpHelper")}static get nI(){return null!=Oe.Gjg?Oe.Gjg:Oe.Gjg=Oa.a.instance.resolve("Box4.IHyperlinkStrategy")}static mw(){return Oe.Cm||(Oe.Cm=Oa.a.instance.Za("Box4.IExternalSelectionManager"))}static get Rd(){return null!=Oe.Nqg?Oe.Nqg:Oe.Nqg=Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Ph(){return null!=Oe.Tqg?Oe.Tqg:Oe.Tqg=Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Tg(){return Rl.ContextSetEditor.instance}static get Lc(){return vb.a.instance}static get xRc(){null==
Oe.Emb&&(Oe.Emb=u.AFrameworkApplication.K?u.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return Oe.Emb}static get g1(){null==Oe.zU&&(Oe.zU=u.AFrameworkApplication.K?u.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Oe.zU}static get hyperlinkEditor(){return null!=Oe.Cjg?Oe.Cjg:Oe.Cjg=Oa.a.instance.resolve("Box4.IHyperlinkEditor")}static get characterPropertiesEditor(){return null!=Oe.Ofg?Oe.Ofg:Oe.Ofg=Oa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get fOc(){u.AFrameworkApplication.Hf("recentLinks;recentLinkscf");
Oe.Qte||(Oe.Qte=u.AFrameworkApplication.K?u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&(u.AFrameworkApplication.K.$("IsO365CommercialHost")||u.AFrameworkApplication.K.$("IsO365ConsumerHost")):!1);return Oe.Qte}static get k6n(){Oe.E1g||(Oe.E1g=u.AFrameworkApplication.K?u.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.timeInMillisBetweenTwoMRUCalls",6E4):6E4);return Oe.E1g}static Vb(){const b=u.AFrameworkApplication.ya;
b.pa(Db.a.insertHyperlink,cc.a.view,Oe.rBb);b.pa(Db.a.insertHyperlink,cc.a.Wc,Oe.insertLink);b.pa(Db.a.insertHyperlink,cc.a.Fd,Oe.insertLink);b.Vc(Db.a.insertHyperlink,1028);b.pa(Db.a.Z_b,cc.a.view,Oe.rBb);b.pa(Db.a.Z_b,cc.a.Wc,Oe.insertLink);b.pa(Db.a.Z_b,cc.a.Fd,Oe.insertLink);b.Vc(Db.a.Z_b,1028);b.pa(Db.a.LQ,cc.a.view,Oe.rBb);b.pa(Db.a.LQ,cc.a.Wc,Oe.iMi);b.pa(Db.a.LQ,cc.a.Fd,Oe.iMi);b.Vc(Db.a.LQ,1028);b.pa(Db.a.s4d,cc.a.view,Oe.rBb);b.pa(Db.a.s4d,cc.a.Wc,Oe.tUi);b.pa(Db.a.s4d,cc.a.Fd,Oe.tUi);b.pa(Db.a.ENa,
cc.a.view,Oe.rBb);b.pa(Db.a.ENa,cc.a.Wc,Oe.Yzi);b.pa(Db.a.ENa,cc.a.Fd,Oe.Yzi);b.pa(Db.a.ENa,cc.a.image,Oe.OHf);b.pa(Db.a.ENa,cc.a.Ryb,Oe.OHf);Of.a.instance.J(5)&&b.pa(Db.a.ENa,cc.a.anchoredObject,Oe.OHf);b.pa(Db.a.nAc,cc.a.application,Oe.nAc);b.pa(Db.a.Uvd,cc.a.view,Oe.rBb);Oe.fOc&&(b.gb(Ra.a.m1a,cc.a.view,this.rBb.bind(this),1028),b.pa(Ra.a.m1a,cc.a.Wc,this.m1a.bind(this)),b.pa(Ra.a.m1a,cc.a.Fd,this.m1a.bind(this)),b.Vc(Ra.a.m1a,1028),b.pa(Ra.a.Cmf,cc.a.Wc,this.m1a.bind(this)),b.pa(Ra.a.Cmf,cc.a.Fd,
this.m1a.bind(this)),b.Vc(Ra.a.Cmf,1028),b.pa(Ra.a.FKf,cc.a.view,this.FKf.bind(this)),b.pa(Ra.a.zKf,cc.a.view,this.zKf.bind(this)),b.gb(Ra.a.Teb,cc.a.Wc,this.Teb.bind(this),1028),b.gb(Ra.a.Teb,cc.a.Fd,this.Teb.bind(this),1028))}static nAc(){return 32}static m1a(b,h){if(!Oe.fOc)return 2;b=Oe.Dij(h);return 32!=b?b:!Oe.wMa(h,!0).returnValue||Oe.eZb(h)?8:32}static FKf(b,h,n,x,E){if(!Oe.fOc)return 2;if(1===n)return 32;Oe.D1d(Oe.hPj,Oe.iPj,Oe.OVg);oo.a.instance.Pd(()=>{Oe.s7f();E.MenuItems=Object.assign(new ti.a,
{Id:"RecentLinksList",MenuSectionList:[],UpdateDynamically:!0});const S=this.uth();S?(w.ULS.sendTraceTag(526242130,324,50,"Recent Links data load success in ribbon"),E.MenuItems.MenuSectionList.push(S)):Oe.GDi(E,Oe.OVg)},"HA:PRLF");return 32}static zKf(b,h,n,x,E){if(!Oe.fOc)return 2;if(1===n)return 32;Oe.D1d(Oe.fPj,Oe.gPj,Oe.NVg);oo.a.instance.Pd(()=>{Oe.s7f();E.MenuItems=Object.assign(new ti.a,{Id:"InsertLinkFlyoutList",MenuSectionList:[],UpdateDynamically:!0});E.MenuItems.MenuSectionList.push(this.wIk());
const S=this.uth(!0);S?(w.ULS.sendTraceTag(526242132,324,50,"Recent Links data load success in context menu"),E.MenuItems.MenuSectionList.push(S)):Oe.GDi(E,Oe.NVg)},"HA:PILF");return 32}static GDi(b,h){w.ULS.sendTraceTag(524911777,324,50,"Recent Links could not load in "+h);Oe.D1d(Oe.MLj,Oe.NLj,h);b.MenuItems.MenuSectionList.push(this.NKk());Oe.s7f(!0)}static NKk(){const b=this.i_e("RecentLinksNoDataSection",!1);b.ControlList.push(Object.assign(new Pg.a,{ExternalId:"RecentLinksNoDataSection",LabelText:Box4Intl.Box4Strings.l_RecentLinksErrorString}));
return b}static wIk(){const b=this.i_e("InsertLinkSection");b.ControlList.push(Object.assign(new Pg.a,{ExternalId:"InsertLink"}));return b}static uth(b=!1){if(Zf.instance.Iid){var h=this.i_e("RecentLinksSection",b);b=JSON.parse(Zf.instance.Iid);this.Hid.clear();b.forEach((n,x)=>{this.Hid.set(x,[n.FileName,n.DocumentUrl]);const E=Oe.VDl(n.FileName);var S=Oe.grl(n.TimeStamp),ma=h.ControlList,Fa=ma.push,$a=Object,sb=$a.assign,Jb=new Pg.a,Sb=Ra.a.Teb,oc=Ra.a.Teb;S=E!==n.FileName?n.FileName+"\n"+S:S;var Ic=
n.FileName;let gd="SaveAsWordDocx_32";switch(n.App){case "Word":gd="SaveAsWordDocx_32";break;case "PowerPoint":gd="SaveAsPowerPointPptx_32";break;case "Excel":gd="SaveAsExcelXlsx_32"}Fa.call(ma,sb.call($a,Jb,{ExternalId:x,Command:Sb,CommandValueId:oc,LabelText:E,Alt:S,AriaDescription:Ic,ExternalImageId:gd,KeyTip:n.FileName}))});return h}}static i_e(b,h=!1){return Object.assign(new Fh.a,{Title:h?Box4Intl.Box4Strings.l_RecentLinks:"",Id:b,DisplayMode:"Menu",ShowMenuSectionSeparator:!1,ControlsId:"Ctrl_"+
b,ControlList:[]})}static Teb(b,h,n,x,E){if(!Oe.fOc)return 2;if(!E||E.CommandValueId!=Ra.a.Teb)return 32;Oe.D1d(Oe.$Fj,Oe.aGj,Oe.wQj);n=h;h=new Se.GraphTransaction(15);h.zl=b;h.Db(n.node);x=Oe.wMa(n,!0).hyperlink;n=Kd.SelectionEditor.dLb(n);if(x)Oe.VQf(n),b=Ae.SelectionFactory.wN(n.node,Math.min(n.cpBegin,x.cpBegin),Math.max(n.cpEnd,x.cpEnd)),kh.a.instance.setSelection(b),n=b.Qa;else if(Kd.SelectionEditor.xf(n)){var S;Kd.SelectionEditor.Yfb(n)&&(S=Kd.SelectionEditor.Q1(n,!1));S||(S=this.Hid.get(E.SourceControlId)[0],
Oe.characterPropertiesEditor.replaceTextRange(n,S,!0,void 0,b),S=Ae.SelectionFactory.wN(n.node,n.cpBegin,n.cpBegin+S.length));if(S&&(kh.a.instance.setSelection(S),n=S.Qa,Oe.eZb(n)))return Oe.Rd.SJb(!1),8}try{Oe.hyperlinkEditor.DG(n,this.Hid.get(E.SourceControlId)[1],0<nh.HyperlinkReader.Y2b(n).length);const ma=Ae.SelectionFactory.xe(n.node,n.cpEnd);ma&&kh.a.instance.setSelection(ma);m(E,"RecentLinks")}finally{h&&h.dispose()}w.ULS.sendTraceTag(526242134,324,50,"Recent Links inserted");return 32}static rBb(b,
h,n,x,E){if(Oe.xRc)return Oe.VXl(b,h,n,x,E);if(!h.view.Be)return 2;var S=h.view.Cb;if(!S||!S.ib||!S.ib.length)return 8;var ma=S.ib.kb;let Fa=ma.Qa.clone();if(2===ma.length){if(ma=ma.J(1),!Kd.SelectionEditor.Ek(Fa)||!Kd.SelectionEditor.sk(ma)||Fa.node!==ma.node)return 8}else if(2<ma.length)return 8;if(S.ib.rI)return 8;if(Oe.Tg.Wva(Cd.ParagraphReader.KW,S.Rg))return Oe.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.pN}),8;Cd.ParagraphReader.gm(Fa)&&!Kd.SelectionEditor.p6(Fa)&&(S=Fa.node,Fa=Dd.a.createTextRange(S,0,
Cd.ParagraphReader.textLength(S)));return b===Db.a.Uvd?Oe.Dqh(h,Fa,n,x):u.AFrameworkApplication.ya.Qf(Fa,b,n,!0,x,E)}static VXl(b,h,n,x,E){if(!h.view.Be)return 2;var S=h.view.Cb;if(!S||!S.ib||!S.ib.length||S.ib.rI)return 8;var ma=S.ib.kb;if(S=Oe.fsf(ma))ma=Oe.ahf(ma.Qa.clone(),!0);else{let Fa=ma.J(0).clone(),$a=1;for(;$a<ma.length&&(!Cd.ParagraphReader.textLength(Fa.node)||Kd.SelectionEditor.sk(Fa)||Oe.g1&&Ad.l(Fa));)Fa=ma.J($a).clone(),$a++;ma=Oe.ahf(Fa,!1)}return Oe.g1&&Kd.SelectionEditor.Ek(ma)&&
Ad.l(ma)||!Kd.SelectionEditor.Ek(ma)&&!S?8:b===Db.a.Uvd?Oe.Dqh(h,ma,n,x):u.AFrameworkApplication.ya.Qf(ma,b,n,!0,x,E)}static fsf(b){if(1===b.length)return!0;if(2===b.length){const h=b.Qa.clone();b=b.J(1);return Kd.SelectionEditor.Ek(h)&&Kd.SelectionEditor.sk(b)&&h.node===b.node?!0:!1}return!1}static hoh(b){let h=null;const n=[];for(let x=0;x<b.length;x++){const E=Oe.ahf(b.J(x).clone(),!1);if(Kd.SelectionEditor.Ek(E))Oe.g1&&Ad.l(E)||n.push(E);else if(!Kd.SelectionEditor.sk(E)&&!Cd.ParagraphReader.gm(E))return{returnValue:!1,
Iab:h}}h=n;return{returnValue:!Oe.g1||0<h.length?!0:!1,Iab:h}}static insertLink(b,h,n,x,E){if(Oe.xRc)return Oe.N3l(h,n,E);x=Oe.Dij(h);if(32!==x)return x;let S;if(!({hyperlink:S}=Oe.wMa(h,!0)).returnValue||Oe.eZb(h)||!S&&b==Db.a.Z_b)return 8;if(1===n)return 32;if(!S&&Kd.SelectionEditor.xf(h)&&Kd.SelectionEditor.Yfb(h)&&(b=Kd.SelectionEditor.Q1(h,!1))&&(kh.a.instance.setSelection(b),h=b.Qa,Oe.eZb(h)))return Oe.Rd.SJb(!1),8;S&&w.ULS.sendTraceTag(593875799,324,50,"Edit link");Vu.instance.vsh(h,E,Oe.O_b,
Oe.bookmarkManager);return 32}static Dij(b){return!Oe.TTe()||!Oe.Hsd(b)||b.node.Pr||kh.a.instance.ib.rI?8:Of.a.instance.J(5)&&Kd.SelectionEditor.I$(b)||Ee.a.lbi(b)?2:32}static N3l(b,h,n){var x=kh.a.instance.ib.kb;const E=Oe.fsf(x);if(E)b=[b];else if(!({Iab:b}=Oe.hoh(x)).returnValue)return 8;if(!Oe.TTe())return 8;for(x=0;x<b.length;x++)if(!Oe.Hsd(b[x]))return 8;if(kh.a.instance.ib.rI)return 8;x=Array(b.length);let S=null;for(let ma=0;ma<b.length;ma++)if(x[ma]=b[ma],!({hyperlink:S}=Oe.wMa(x[ma],!0)).returnValue||
Oe.eZb(x[ma]))return 8;if(1===h)return 32;if(!S&&1===x.length&&E&&Kd.SelectionEditor.xf(x[0])&&Kd.SelectionEditor.Yfb(x[0])&&(h=Kd.SelectionEditor.Q1(x[0],!1))&&(kh.a.instance.setSelection(h),x[0]=h.Qa,Oe.eZb(x[0])))return Oe.Rd.SJb(!1),8;E?Vu.instance.vsh(x[0],n,Oe.O_b,Oe.bookmarkManager):new yn(x,n);return 32}static iMi(b,h,n){if(Oe.xRc)return Oe.Nnn(b,h,n);if(!Oe.Hsd(h)||Of.a.instance.J(5)&&Kd.SelectionEditor.I$(h))return 2;let x;if(!({hyperlink:x}=Oe.wMa(h,!1)).returnValue)return 2;if(2===n){n=
new Se.GraphTransaction(15);try{n.zl=b,n.Db(x.paragraph),Oe.VQf(h)}finally{n&&n.dispose()}x.hyperlink.zF&&Oe.Rd.us(2)}return 32}static Nnn(b,h,n){var x=kh.a.instance.ib.kb;if(Oe.fsf(x))h=[h];else if(!({Iab:h}=Oe.hoh(x)).returnValue)return 8;if(!Oe.TTe())return 8;for(x=0;x<h.length;x++)if(!Oe.Hsd(h[x]))return 8;if(1===n&&!Oe.wMa(h[0],!1).returnValue)return 2;if(2===n){for(n=0;n<h.length;n++)if(!Oe.wMa(h[n],!0).returnValue)return 2;n=new Se.GraphTransaction(15);try{const E=h[0];n.zl=b;n.Db(E.node);
for(b=0;b<h.length;b++)Oe.VQf(h[b])}finally{n&&n.dispose()}Oe.Rd.us(7)}return 32}static VQf(b){const h=nh.HyperlinkReader.Y2b(b);let n=0;for(let x=0;x<h.length;x++)if(h[x].cpBegin>=n){const E=({cpEnd:n}=Oe.nI.c$(b,h[x])).returnValue;Oe.nI.FQf(b,E)}}static tUi(b,h,n){if(Of.a.instance.J(5)&&Pd.ImageReader.ifb(h)||!({hyperlink:b}=Oe.wMa(h,!1)).returnValue)return 2;2===n&&({cpBegin:h,cpEnd:n}=Oe.nI.c$(h,b),kh.a.instance.setSelection(Ae.SelectionFactory.wN(b.paragraph,h,n)));return 32}static Yzi(b,h,n){let x;
if(Of.a.instance.J(5)&&({hyperlink:x}=Oe.dlm(h)).returnValue)w.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!({hyperlink:x}=Oe.wMa(h,!1)).returnValue)return 2;2===n&&ob.App.Xyb(x.hyperlink.url);return 32}static OHf(b,h,n){b=Pd.ImageReader.c$(h.node);if(!b)return 2;2===n&&ob.App.Xyb(b);return 32}static Dqh(b,h,n,x){if(Of.a.instance.J(5)&&Pd.ImageReader.ifb(h)||!cb.InteractiveViewManager.instance.editingView.Cj)return 2;let E;if(!({hyperlink:E}=Oe.wMa(h,!1)).returnValue)return 2;
if(1===n)return 32;({cpBegin:h,cpEnd:n}=Oe.nI.c$(h,E));kh.a.instance.setSelection(Ae.SelectionFactory.wN(E.paragraph,h,n));h=cb.InteractiveViewManager.instance.Yya.ownerDocument.createElement("span");h.innerText=E.hyperlink.url;h.style.backgroundColor="rgb(255, 255, 255)";return u.AFrameworkApplication.ya.Qf(b,Db.a.Tvd,2,!0,x,h)}static wMa(b,h){if(Kd.SelectionEditor.Ek(b)){const n=Ad.g(b),x=th.a.all(n,E=>6===E.ri);if(0<n.length&&(!Oe.g1||!x)||Oe.Zf.vh&&Oe.vda&&0<Oe.vda.MDd(b).count)return{returnValue:!1,
hyperlink:null}}return Oe.Ukm(b,h)}static dlm(b){let h=null;return Pd.ImageReader.ifb(b)&&(h=nh.HyperlinkReader.m2b(b))?{returnValue:!0,hyperlink:h}:{returnValue:!1,hyperlink:h}}static Ukm(b,h){let n=null;const x=nh.HyperlinkReader.Y2b(b);return x.length?x[0].hyperlink?(n=x[0],b.cpBegin<x[0].cpBegin?{returnValue:h,hyperlink:n}:{returnValue:!0,hyperlink:n}):{returnValue:!1,hyperlink:n}:{returnValue:h,hyperlink:n}}static eZb(b){if(Of.a.instance.J(3)){b=Oe.Ph.nLa(b.node,b.cpBegin,b.cpEnd);for(let h=
0;h<b.count;++h)if(2===b.J(h).Od.changeType)return!0}return!1}static TTe(){return Of.a.instance.J(3)?!0:!Of.a.instance.J(3)||!ob.App.Av.bgc}static Hsd(b){return Oe.Zf.bZ(b)||Oe.Zf.ota(b)||Oe.mw()&&Oe.mw().instance&&Oe.mw().instance.vT(b)?!1:!0}static ahf(b,h){return Cd.ParagraphReader.gm(b)&&!Kd.SelectionEditor.p6(b)&&(Cd.ParagraphReader.textLength(b.node)||h)?Dd.a.createTextRange(b.node,0,Cd.ParagraphReader.textLength(b.node)):b}static VDl(b){return b&&b.length<=Oe.GIi?b:b.substring(0,Oe.GIi)+"..."}static grl(b){try{const h=
new Date(b);return String.format(Box4Intl.Box4Strings.l_RecentLinksTimeSeparator,h.toLocaleString(void 0,{weekday:"long"}),h.toLocaleString(void 0,{hour:"numeric",minute:"numeric"}))}catch(h){return""}}static s7f(b=!1){let h=Date.now();if(b||h-Oe.lii>Oe.k6n)Zf.instance.Ini(),Oe.lii=h}static D1d(b,h,n){const x=new Map;x.set("Source",n);x.set("Action",h);ta.Health.instance.recordKpiUsage(b,0,this.NRa,x)}}Oe.Cm=null;Oe.Emb=null;Oe.zU=null;Oe.Hid=new Map;Oe.Qte=null;Oe.GIi=35;Oe.lii=Date.now();Oe.NRa=
"wwaengidc";Oe.wQj="RecentLinks";Oe.OVg="RecentLinksRibbonOptions";Oe.NVg="RecentLinksContextMenuOptions";Oe.hPj="PopulateRecentLinksRibbon";Oe.iPj="PopulateRecentLinksRibbonAction";Oe.fPj="PopulateRecentLinksContextMenu";Oe.gPj="PopulateRecentLinksContextMenuAction";Oe.MLj="PopulateRecentLinksContextMenu";Oe.NLj="PopulateRecentLinksContextMenuAction";Oe.$Fj="InsertRecentLinks";Oe.aGj="InsertRecentLinksAction";Object(r.a)(Oe,"HyperlinkActor",null,[]);class pt{}pt.oPc=Object.freeze({UZl:"WordIndentationShortcutUsage"});
pt.vB="wwaengidc";Object(r.a)(pt,"IndentationConstants",null,[]);class Cl{static get np(){return Ig.a.gAb}static get Tg(){return Rl.ContextSetEditor.instance}static get Zf(){return Ai.a.instance}static get Lc(){return vb.a.instance}static get Du(){return cb.InteractiveViewManager.instance}static mw(){return Cl.Cm||(Cl.Cm=Oa.a.instance.Za("Box4.IExternalSelectionManager"))}static get TZl(){return null!=Cl.Mjg?Cl.Mjg:Cl.Mjg=Oa.a.instance.resolve("Box4.Actors.IIndentationActorExtension")}static Vb(){const b=
u.AFrameworkApplication.ya;b.pa(Db.a.HF,cc.a.view,Cl.lyc);b.pa(Db.a.HF,cc.a.outlineElement,Cl.Gbh);b.Vc(Db.a.HF,1036);b.pa(Db.a.zN,cc.a.view,Cl.lyc);b.pa(Db.a.zN,cc.a.outlineElement,Cl.Gbh);b.Vc(Db.a.zN,1036)}static Ufn(b){const h=new Map;b=b?b.ia(Ji.a.H5h,"Unknown"):"tab";h.set("actionCallSource",b);ta.Health.instance.recordKpiUsage(pt.oPc.UZl,1,pt.vB,h)}static lyc(b,h,n,x,E){const S=h.view;if(!S.Be)return 2;var ma=S.Cb;if(!ma)return Cl.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.sfa}),8;ma=ma.Rg;if(!ma)return Cl.Lc.Yb(Gc.a.zf,
{["Reason"]:Mc.a.noSelection}),8;if(Ee.a.Jla(h))return 8;if(u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Cl.Zf.z5b(ma))return Cl.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.UD}),8;if(1===n)return 32;if(Cl.Tg.jza(Cl.ePe,ma))return Cl.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.fBc}),8;if(Cl.Tg.Wva(Cd.ParagraphReader.KW,ma))return Cl.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.pN}),8;if(!u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Cl.Zf.z5b(ma))return Cl.Lc.Yb(Gc.a.zf,
{["Reason"]:Mc.a.UD}),8;if(Cl.mw()&&Cl.mw().instance&&Cl.mw().instance.vT(ma))return Cl.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.externalSelection}),8;ma={};ma[ba.a.eFa]=5794;ma[ba.a.dFa]=5795;return Cl.TZl.lyc(S,b,h,n,x,E,ma)}static Gbh(b,h,n,x,E){var S,ma;if(h.contextId!==cc.a.outlineElement)return 2;var Fa=h.clone().p0f();if(ag.TableReader.igi(Fa)){if(Cl.Zf.jgi(Fa))return Cl.Lc.Yb(Gc.a.Mm,{["Reason"]:Mc.a.UD}),8}else if(Cl.Zf.VZa(Fa))return Cl.Lc.Yb(Gc.a.Mm,{["Reason"]:Mc.a.UD}),2;Fa=new md.GraphIterator;
Fa.set(h.node);Kd.SelectionEditor.Gt(Fa);if(!Kf.OutlineElementReader.Nh(Fa))return 2;let $a;switch(b){case Db.a.HF:$a=Cl.np.Uvb(Fa);break;case Db.a.zN:$a=Cl.np.fYb(Fa);break;default:return 2}if(1===n||!$a)return $a?32:8;n=0;b===Db.a.zN&&E&&E.ia(ad.a.xdh,!1)&&(n|=2);if(Kf.OutlineElementReader.rP(Fa))return Cl.Lc.Yb(Gc.a.Mm,{["Reason"]:Mc.a.pN}),2;(null===(ma=null===(S=Cl.Du)||void 0===S?void 0:S.xd)||void 0===ma?0:ma.XN)&&Cl.Du.editingView&&(Cl.Du.editingView.cH=!0);switch(b){case Db.a.HF:Cl.np.XNa(Fa,
-1,n);break;case Db.a.zN:Cl.np.bDc(Fa,1)}x&&Bq.a.hlb&&(x.Jr|=Bq.a.Xcb(h.node,!0));Cl.Ufn(E);return 32}}Cl.Cm=null;Cl.ePe=Pd.ImageReader.pZa;Object(r.a)(Cl,"IndentationActor",null,[]);var Jl=d(1529);class Jj{static get paragraphEditor(){return null!=Jj.Fng?Jj.Fng:Jj.Fng=Oa.a.instance.resolve("Box4.IParagraphEditor")}static get Gk(){return null!=Jj.Hpg?Jj.Hpg:Jj.Hpg=Oa.a.instance.resolve("Box4.ITableEditor")}static get Zf(){return Ai.a.instance}static get Lc(){return vb.a.instance}static mw(){return Jj.Cm||
(Jj.Cm=Oa.a.instance.Za("Box4.IExternalSelectionManager"))}static Vb(){const b=u.AFrameworkApplication.ya;b.pa(Db.a.leftJustify,cc.a.view,Jl.a.yv);b.pa(Db.a.leftJustify,cc.a.paragraph,Jj.Cya);b.pa(Db.a.leftJustify,cc.a.table,Jj.eQe);b.Vc(Db.a.leftJustify,1036);b.pa(Db.a.centerJustify,cc.a.view,Jl.a.yv);b.pa(Db.a.centerJustify,cc.a.paragraph,Jj.Cya);b.pa(Db.a.centerJustify,cc.a.table,Jj.eQe);b.Vc(Db.a.centerJustify,1036);b.pa(Db.a.rightJustify,cc.a.view,Jl.a.yv);b.pa(Db.a.rightJustify,cc.a.paragraph,
Jj.Cya);b.pa(Db.a.rightJustify,cc.a.table,Jj.eQe);b.Vc(Db.a.rightJustify,1036);b.pa(Db.a.fullJustify,cc.a.view,Jl.a.yv);b.pa(Db.a.fullJustify,cc.a.paragraph,Jj.Cya);b.Vc(Db.a.fullJustify,1036);b.pa(Db.a.CDc,cc.a.view,Jl.a.yv);b.pa(Db.a.CDc,cc.a.paragraph,Jj.Cya);b.Vc(Db.a.CDc,1036);b.pa(Db.a.EDb,cc.a.view,Jl.a.yv);b.pa(Db.a.EDb,cc.a.paragraph,Jj.Cya);b.Vc(Db.a.EDb,1036);b.pa(Db.a.TZc,cc.a.view,Jl.a.yv);b.pa(Db.a.TZc,cc.a.paragraph,Jj.Cya);b.Vc(Db.a.TZc,1036);b.pa(Db.a.d8b,cc.a.view,Jl.a.yv);b.pa(Db.a.d8b,
cc.a.paragraph,Jj.Cya);b.Vc(Db.a.d8b,1036);b.pa(Db.a.uYb,cc.a.view,Jl.a.yv);b.pa(Db.a.uYb,cc.a.paragraph,Jj.Cya);b.Vc(Db.a.uYb,1036);b.pa(Db.a.lcc,cc.a.view,Jl.a.yv);b.pa(Db.a.lcc,cc.a.paragraph,Jj.Cya);b.Vc(Db.a.lcc,1036);b.pa(Db.a.t1b,cc.a.view,Jl.a.yv);b.pa(Db.a.t1b,cc.a.paragraph,Jj.Cya);b.Vc(Db.a.t1b,1036)}static eQe(b,h,n,x){let E=!0;if(!h)return 8;ag.TableReader.igi(h)?Jj.Zf.jgi(h)?(Jj.Lc.Yb(Gc.a.Mm,{["Reason"]:Mc.a.UD}),E=!1):Jj.mw()&&Jj.mw().instance&&Jj.mw().instance.vT(h)&&(Jj.Lc.Yb(Gc.a.Mm,
{["Reason"]:Mc.a.externalSelection}),E=!1):(Jj.Lc.Yb(Gc.a.Mm,{["Reason"]:Mc.a.Q3e}),E=!1);if(1===n||!E)return E?32:8;h=h.node;switch(b){case Db.a.leftJustify:Jj.Gk.lD(h,1);break;case Db.a.centerJustify:Jj.Gk.lD(h,2);break;case Db.a.rightJustify:Jj.Gk.lD(h,3)}x&&Bq.a.hlb&&(x.Jr|=2);return 32}static Cya(b,h,n,x,E){let S=!0;h.contextId!==cc.a.paragraph?S=!1:Jj.Zf.VZa(h)?(Jj.Lc.Yb(Gc.a.Mm,{["Reason"]:Mc.a.UD}),S=!1):Jj.mw()&&Jj.mw().instance&&Jj.mw().instance.vT(h)&&(Jj.Lc.Yb(Gc.a.Mm,{["Reason"]:Mc.a.externalSelection}),
S=!1);if(1===n||!S)return S?32:8;h=h.node;n=Cd.ParagraphReader.Ev(h);switch(b){case Db.a.leftJustify:case Db.a.d8b:Jj.paragraphEditor.lD(h,1===n&&Jj.tPd(E)?6:1);break;case Db.a.centerJustify:case Db.a.uYb:Jj.paragraphEditor.lD(h,2===n&&Jj.tPd(E)?1:2);break;case Db.a.rightJustify:case Db.a.lcc:Jj.paragraphEditor.lD(h,3===n&&Jj.tPd(E)?1:3);break;case Db.a.fullJustify:case Db.a.t1b:Jj.paragraphEditor.lD(h,6===n&&Jj.tPd(E)?1:6);break;case Db.a.EDb:Jj.paragraphEditor.lD(h,11);break;case Db.a.CDc:Jj.paragraphEditor.lD(h,
7);break;case Db.a.TZc:Jj.paragraphEditor.lD(h,13)}x&&Bq.a.hlb&&(x.Jr|=Bq.a.Xcb(h));return 32}static tPd(b){let h=!1;null!==b&&Object.getType(b)===Object&&b.hasOwnProperty("InContextSet")&&(h=b.InContextSet);return!h}}Jj.Cm=null;Object(r.a)(Jj,"JustificationActor",null,[]);const Sv=()=>{const b=u.AFrameworkApplication.ya;b.pa(Db.a.save,Ld.a.frame,ux);b.pa(Db.a.sync,Ld.a.frame,pr)},pr=(b,h,n)=>{if(1===n)return 32;u.AFrameworkApplication.ya.processAction(Db.a.Wvb,2);ob.App.Wj.y9d();return 32},ux=(b,
h,n)=>{if(1===n)return 2===ob.App.xa.mode?32:8;u.AFrameworkApplication.ya.processAction(Db.a.Wvb,2);if(2!==ob.App.xa.mode)return 32;ob.App.Wj.PSi(null,null);return 32};class Ot{constructor(){this.activateRibbonTab=(b,h,n,x,E)=>{ob.App.Av.PH.D3d(E.toString());return 32};this.yom=(b,h,n,x,E)=>{u.AFrameworkApplication.eaa("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");ob.App.Av.PH.Ehi(1,E.toString());return 32};this.vWm=(b,h)=>{if(h.contextId!==Ld.a.frame)return 2;appChrome.onRibbonModeToggle();
return 32}}Vb(){const b=u.AFrameworkApplication.ya;b.pa(Db.a.activateRibbonTab,cc.a.view,this.activateRibbonTab);b.Vc(Db.a.activateRibbonTab,5);b.pa(Db.a.Fhi,cc.a.view,this.yom);b.pa(Db.a.F$i,Ld.a.frame,this.vWm)}static get instance(){return null!=Ot.pkg?Ot.pkg:Ot.pkg=Ot.Fl()}static Fl(){return new Ot}}Object(r.a)(Ot,"RibbonActor",null,[]);class zs{constructor(b,h){this.sm=null;this.Obo=(n,x,E,S,ma)=>{let Fa;S=x.view;if(!S.Be)return zs.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.nFb}),8;Fa=n===Db.a.undo?this.vi.tZ:
this.vi.xLa;if(1===E)return Ee.a.Jla(x)&&Ee.a.rCb()?8:Fa?32:8;if(!Fa)return w.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",n===Db.a.undo?"undo":"redo"),this.MFa.value.jdj(),zs.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.Kbo}),2;x=new Se.GraphTransaction(3);x.Db(S.ud);x.XVf();n=n===Db.a.undo?this.vi.undo():this.vi.redo();x.dispose();ma&&fl.GrippersManager.instance.FLb(ma.Qw);if(n)return 32;zs.Lc.Yb(Gc.a.L_b,{["Reason"]:Mc.a.hsi});return 8};this.aja=b;this.MFa=h}get vi(){return this.sm||
(this.sm=this.aja())}Vb(){const b=u.AFrameworkApplication.ya,h=this.Obo;b.gb(Db.a.undo,cc.a.view,h,1028);b.gb(Db.a.redo,cc.a.view,h,1028)}static get instance(){return null!=zs.Yjg?zs.Yjg:zs.Yjg=zs.Fl()}static Fl(){const b=Oa.a.instance;return new zs(()=>b.resolve("Box4.IUndoManager"),b.Ye("Box4.ICoauthCashTelemetry"))}static get Lc(){return vb.a.instance}}Object(r.a)(zs,"UndoActor",null,[]);class Tv{constructor(){this.W=null}get name(){return"Box4.Actors"}zc(b){this.W=b;(new tw).zc(b)}init(){var b=
this.W.resolve("Box4.Actors.ClipboardActor");b.Vb();b.c3();ot();es.instance.Vb();Oe.Vb();Cl.Vb();Jj.Vb();this.W.resolve("Box4.Actors.TouchInputActor").Vb();qu.instance.Vb();this.W.resolve("Box4.ISelectAllHandlers").Vb();Sv();Of.a.instance.J(9)&&this.W.resolve("Box4.Actors.ProofingActor").Vb();Ot.instance.Vb();(b=this.W.Pa("Box4.IFeatureHelper"))?b.Yk.continueWith(()=>{this.LKi()}):this.LKi();Oq.a.Vb(ob.App.h3a);this.W.resolve("Box4.Actors.TextFormattingActor").Vb();zs.instance.Vb();this.W.resolve("Box4.Actors.AccessibilityActor").FPf();
this.W.resolve("Box4.IClipboardCommands");this.W.resolve("Box4.Actors.PasteFloatieEventManager");ob.App.xa.updateCommandUI()}LKi(){Of.a.instance.J(10)&&(u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsUpdateStyleContextMenuEnabled",!1)&&this.W.resolve("Box4.Actors.StyleContextMenuActor").Vb(),this.W.resolve("Box4.Actors.StyleActor").Vb())}dispose(){}static main(){N.a.instance.Pc(new Tv)}}Object(r.a)(Tv,"Box4ActorsPackage",null,[1,2]);class vx extends Qn{constructor(b,
h,n,x){super(b);this.vka=n;this.kga=x;this.d$f=0;this.$w=h.aNa("UserAction","WordOnlineAddToDictionary")}pYf(b){this.kAd=this.vka.Ska(b);if(!this.$rk())return!1;const h=this.kAd.errorDetails.token;this.kga.f8g(h);if(!this.kga.h1c(h))return w.ULS.sendTraceTag(541618644,375,10,"[Add to Dictionary]: Unable to save word to roaming dictionary."),!1;w.ULS.sendTraceTag(541618645,375,50,"[Add to Dictionary]: Starting ProofingWholeDocument operation.");this.$w.start();this.transaction=new Se.GraphTransaction(15);
this.transaction.Db(b.node);return!0}p_d(b){this.TGb(b.node);return!0}JUc(b){this.TGb(b);return!0}q_d(b){this.TGb(b.node)}b3f(b){this.transaction.dispose();this.kAd.errorDetails.vlb(b.actionId);this.kga.h4d("unused corelation id.");this.$w.stop();w.ULS.sendTraceTag(541618646,375,50,String.format("[Add to Dictionary]: Actual errors removed: {0}. Duration in milliseconds: {1}. Type: {2}",this.d$f,this.$w.ni,this.kAd.errorDetails.proofingType));return!0}Bec(b,h){const n=b.role;return super.Bec(b,h)||
9===n||10===n||13===n||7===n||8===n}TGb(b){if(b){var h=this.vka.Y1(b,n=>this.kga.h1c(n.errorDetails.token));this.vka.cjb(b,h,!0);this.d$f+=h.length}}$rk(){var b,h;return null!==(h=null===(b=this.kAd)||void 0===b?void 0:b.errorDetails)&&void 0!==h&&h.token?!0:(w.ULS.sendTraceTag(541618647,375,10,"[Add to Dictionary]: Was not able to get the token from the error range."),!1)}}Object(r.a)(vx,"AddToDictionaryCallbackSteps",Qn,[]);class Uv{constructor(b,h,n,x,E,S,ma){this.Ac=b;this.Cb=h;this.PYc=n;this.vka=
x;this.hq=E;this.kga=S;this.s9m=ma;this.MPl=(Fa,$a,sb,Jb,Sb,oc)=>{const Ic=new vx(this.PYc,this.hq,this.vka,this.kga);return new Qd(Fa,$a,sb,Jb,Sb,oc,Ic,this.Ac,this.Cb,this.PYc,"AddToDictionaryThroughProofingWholeDocumentOperation")}}Vb(){this.Ac.jS(Db.a.addToDictionary,cc.a.view,this.MPl,1124);this.s9m.cln(this.kga)}}Object(r.a)(Uv,"PersonalDictionaryOrchestrator",null,[]);class wx{get name(){return"Box4.PersonalDictionary"}zc(b){this.container=b;b.register(Uv,"Box4.PersonalDictionary.PersonalDictionaryOrchestrator").singleInstance().Xd(()=>
new Uv(u.AFrameworkApplication.ya,kh.a.instance,rs.a.instance,b.resolve("Box4.Proofing.IErrorRangeEditor"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("IRoamingDictionary"),b.resolve("Box4.Proofing.ProofingCheckOperator")))}init(){this.container.resolve("Box4.PersonalDictionary.PersonalDictionaryOrchestrator").Vb()}dispose(){}static main(){cj.a.get_instance().sl(7,()=>{N.a.instance.Pc(new wx)})}}Object(r.a)(wx,"PersonalDictionaryPackage",null,[1,2]);class As{constructor(b,
h,n,x,E,S){this.m5a=this.JU=null;this.Jzc=(ma,Fa,$a,sb,Jb)=>this.zfi(Fa,$a,Jb,!1)?32:8;this.NH=(ma,Fa,$a,sb,Jb)=>{if(!({zx:ma}=this.U0i(Fa,$a,Jb,!0)).returnValue)return ma;w.ULS.sendTraceTag(594899719,340,50,"Cell shading color is selected from Standard/Theme colors.");Jb=this.jWj.Zya(Fa.node,Jb);this.f2m(Fa.node,Jb);this.wO();return 32};this.iwb=(ma,Fa,$a,sb,Jb)=>{if(!({zx:ma}=this.U0i(Fa,$a,Jb,!1)).returnValue)return ma;this.b2m(Fa.node);return 32};this.A$m=(ma,Fa,$a,sb,Jb)=>{if(1===$a)return 32;
if(!Fa||!Fa.view.Be)return 2;ma=Fa.view.Cb;if(!ma)return 2;ma=ma.Rg;if(!ma)return 2;ma=As.Tg.JP(ma,16);if(!ma||!ma.length)return 2;Fa=null;for($a=0;$a<ma.length;$a++){sb=ma.getContext($a);if(!sb||sb.contextId!==cc.a.tableCell)return 2;const Sb={};this.A1h(sb,Sb);if(Sb.CellShading)if(Fa&&Fa!==Sb.CellShading){Fa=null;break}else Fa=Sb.CellShading;else{Fa=null;break}}Jb.CellShading=Fa;return 32};this.aHb=(ma,Fa,$a,sb,Jb)=>1===$a?32:this.A1h(Fa,Jb);this.AGb=(ma,Fa,$a,sb,Jb)=>{if(1===$a)return 32;ma=Fa.contextId===
cc.a.view?this.Cxa.aGd(Fa):this.Vef(Fa);$a={};Fa=null;32===u.AFrameworkApplication.ya.Xb(Db.a.aHb,2,$a)&&$a&&(Fa=$a.CellShading);$a="";Fa&&($a=Eo.a.BC(Fa)||"");this.R_i.Ncc=$a;ma=this.R_i.RCd(ma,ob.App.OYb);if(!ma)return 8;Jb.MenuItems=ma;w.ULS.sendTraceTag(592996034,340,50,"Cell Shading dropdown menu is opened.");return 32};this.Efa=(ma,Fa,$a,sb,Jb)=>{if(1===$a)return 32;ob.App.xa.Vu();u.AFrameworkApplication.ya.Xb(Db.a.aHb,2,Jb);this.m5a=new Rv.a("Shading",Db.a.edc);this.m5a.E_c(Jb&&Jb.CellShading?
Jb.CellShading:0);return 32};this.Wqk=(ma,Fa,$a,sb,Jb)=>{if(1===$a)return 32;u.AFrameworkApplication.ya.Xb(Db.a.j7,2,Jb);this.recentColors.g$a(Jb)||w.ULS.sendTraceTag(594899717,340,50,"Color selected from Recent Colors section. Menu: {0}","Shading");return 32};this.ga=b;this.jWj=h;this.Exe=n;this.Cxa=x;this.Hd=E;this.Tm=S}get recentColors(){return null!=this.kog?this.kog:this.kog=Oa.a.instance.Pa("Box4.UI.RecentColorsSectionHandler")}get R_i(){this.JU||(this.JU=new sx.a("Shading"),this.$Ya(this.JU));
return this.JU}$Ya(b){b.Uca(2,Db.a.iwb);b.Uca(3,Db.a.j7);b.Uca(4,Db.a.j7);b.tWb(this.Exe,1)}Vb(){this.ga.pa(Db.a.AGb,cc.a.view,this.AGb);this.ga.pa(Db.a.AGb,cc.a.tableCell,this.AGb);this.ga.Vc(Db.a.AGb,1126);this.ga.pa(Db.a.Jzc,cc.a.view,Oq.a.hGc);this.ga.pa(Db.a.Jzc,cc.a.tableCell,this.Jzc);this.ga.Vc(Db.a.Jzc,1028);this.ga.pa(Db.a.j7,cc.a.view,Oq.a.hGc);this.ga.pa(Db.a.j7,cc.a.tableCell,this.NH);this.ga.Vc(Db.a.j7,1028);this.ga.pa(Db.a.iwb,cc.a.view,Oq.a.hGc);this.ga.pa(Db.a.iwb,cc.a.tableCell,
this.iwb);this.ga.Vc(Db.a.iwb,1028);this.ga.pa(Db.a.aHb,cc.a.view,this.A$m);this.ga.pa(Db.a.aHb,cc.a.tableCell,this.aHb);this.ga.Vc(Db.a.aHb,1124);this.ga.pa(Db.a.edc,cc.a.view,Oq.a.hGc);this.ga.pa(Db.a.edc,cc.a.tableCell,this.Wqk);this.ga.Vc(Db.a.edc,1028);this.ga.pa(Db.a.QHf,cc.a.view,this.Efa);this.ga.Vc(Db.a.QHf,1028)}wO(){u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Oa.a.instance.Za("Common.ISystemInitiatedFeedback");
b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}U0i(b,h,n,x){return this.zfi(b,h,n,x)?{returnValue:2===h,zx:32}:(2==h&&Oq.a.recordQosError("CellShadingButtonClickNoResponse",["TableInteractionFailed"],Mc.a.N4k),{returnValue:!1,zx:8})}zfi(b,h,n,x){return b.contextId!==cc.a.tableCell||2===h&&(x&&!n||!b.node)?!1:!0}f2m(b,h){const n=new Se.GraphTransaction(15);n.Db(b);this.HZi(b);b.properties.setValue(ie.a.NH,h);n.dispose()}b2m(b){const h=
new Se.GraphTransaction(15);h.Db(b);this.HZi(b);b.properties.removeProperty(ie.a.NH);h.dispose()}Vef(b){return b.contextId!==cc.a.tableCell?null:(b=As.oh.gu(b.node))?b:null}HZi(b){if(this.Hd&&this.Hd.wg&&(b=Object(ja.a)(Vs.TableCellNode,b))){const h=b.IQ();this.Tm.RZc(b,h)}}A1h(b,h){if(b.contextId!==cc.a.tableCell)return 8;(b=b.node)&&b.hasProperty(ie.a.NH)&&(h.CellShading=b.getValue(ie.a.NH));return 32}static Mil(){return new As(u.AFrameworkApplication.ya,Aq.a.instance,Br.a.instance,Nd.PageReader.instance,
Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get oh(){return ql.PageNavigator.instance}static get Tg(){return null!=As.rgg?As.rgg:As.rgg=Rl.ContextSetEditor.instance}static get instance(){return null!=As.rlg?As.rlg:As.rlg=As.Mil()}}Object(r.a)(As,"CellShadingActor",null,[]);class Gw{constructor(){this.W=null}get name(){return"Box4.CellShading"}zc(b){this.W=b}init(){const b=this.W.Pa("Box4.IFeatureHelper");
b?b.Yk.continueWith(()=>{this.Nm()}):this.Nm()}Nm(){As.instance.Vb();ob.App.xa.updateCommandUI()}dispose(){}}Object(r.a)(Gw,"CellShadingPackage",null,[1,2]);var fs;(function(b){b[b.none=0]="none";b[b.style1=1]="style1";b[b.style2=2]="style2";b[b.style3=3]="style3";b[b.style4=4]="style4";b[b.style5=5]="style5";b[b.bullet=6]="bullet";b[b.invalid=42]="invalid"})(fs||(fs={}));Object(r.b)("ListStyle",fs);const Vv={[fs.style1]:{[1]:"disc",[0]:"decimal"},[fs.style2]:{[1]:"circle",[0]:"lower-alpha"},[fs.style3]:{[1]:"square",
[0]:"lower-roman"},[fs.style4]:{[0]:"upper-alpha"},[fs.style5]:{[0]:"upper-roman"},[fs.bullet]:{[1]:"bullet"}};var qt;(function(b){b[b.number=0]="number";b[b.bullet=1]="bullet";b[b.lim=13]="lim";b[b.nil=14]="nil";b[b.any=15]="any";b[b.noList=16]="noList";b[b.invalid=42]="invalid"})(qt||(qt={}));Object(r.b)("ListType",qt);var xx=d(645);class Tp{constructor(b,h){this.BA=this.RPc=null;this.levelText=b;this.font=h}get f_d(){return this.levelText}get listStyle(){return 6}get Ws(){return"left"}}Object(r.a)(Tp,
"ListMarkerBullet",null,[306]);class Hh{static get Jo(){return null!=Hh.$lg?Hh.$lg:Hh.$lg=Oa.a.instance.resolve("Box4.List.IListEditor")}static get hd(){return Hh.Cf||(Hh.Cf=Oa.a.instance.resolve("Box4.List.IListReader"))}static set hd(b){Hh.Cf=b}static get Rj(){return null!=Hh.Rjg?Hh.Rjg:Hh.Rjg=Oa.a.instance.resolve("Box4.IInsertionPointFormatting")}static mw(){return Hh.Cm||(Hh.Cm=Oa.a.instance.Za("Box4.IExternalSelectionManager"))}static get Tg(){return Rl.ContextSetEditor.instance}static get Zf(){return Ai.a.instance}static get Lc(){return vb.a.instance}static get Zd(){return bo.a.getInstance()}static get xkb(){return null!=
Hh.Log?Hh.Log:Hh.Log=Oa.a.instance.Pa("Box4.List.ISingleLevelListEditor")}static Vb(){const b=u.AFrameworkApplication.ya;b.pa(Db.a.Uz,cc.a.view,Hh.jyc);b.pa(Db.a.Uz,cc.a.outlineElement,Hh.Yqa);b.Vc(Db.a.Uz,1036);b.pa(Db.a.gH,cc.a.view,Hh.jyc);b.pa(Db.a.gH,cc.a.outlineElement,Hh.Yqa);b.Vc(Db.a.gH,1036);Hh.hd.ur&&(b.pa(Db.a.jaa,cc.a.view,Hh.jyc),b.pa(Db.a.jaa,cc.a.outlineElement,Hh.Yqa),b.Vc(Db.a.jaa,1036));b.pa(Db.a.TPe,cc.a.view,pd.ActionManager.Nf);b.pa(Db.a.xlh,cc.a.view,pd.ActionManager.Nf);b.pa(Db.a.joinList,
cc.a.view,Hh.Ytn);b.pa(Db.a.EPe,cc.a.view,pd.ActionManager.Nf);b.pa(Db.a.UPe,cc.a.view,pd.ActionManager.Nf);b.pa(Db.a.j2f,cc.a.view,pd.ActionManager.Nf);b.pa(Db.a.Z7i,cc.a.view,pd.ActionManager.Nf);b.pa(Db.a.Mae,cc.a.view,pd.ActionManager.Nf)}static Ytn(){xx.a.UPi();return 32}static jyc(b,h,n,x,E){var S,ma;if(!h.view.Be)return 2;const Fa=Hh.Lc.oo(Db.a.jyc);x.Jr=42;x.pB=42;const $a={[ba.a.eFa]:5796,[ba.a.dFa]:5797};var sb=h.view;if(Hh.Tg.jza(Hh.EYl,sb.Cb.Rg))return Hh.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.KXe}),
Fa.end(),8;if(Hh.Tg.jza(Hh.ePe,sb.Cb.Rg))return Hh.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.fBc}),Fa.end(),8;if(Hh.Tg.Wva(Cd.ParagraphReader.KW,sb.Cb.Rg))return Hh.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.pN}),Fa.end(),8;if(Hh.Zf.z5b(sb.Cb.Rg))return Hh.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.UD}),Fa.end(),8;if(null===(ma=null===(S=Hh.mw())||void 0===S?void 0:S.instance)||void 0===ma?0:ma.vT(h))return Hh.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.externalSelection}),Fa.end(),8;if(1===n)return Fa.end(),32;E||(E=new qi.DictionaryPropertySet);
S=null;if(2===n){S=new Se.GraphTransaction(15);S.Db(h.view.ud);Hh.FOc=!1;ma=T.OutlineElementGeneralizer.Hka(sb.Cb.ib,!1);if(!ma)return S.dispose(),Hh.Lc.Yb(Gc.a.Aka,{["Reason"]:Mc.a.TAd}),Fa.end(),8;1<ma.length&&E.setValue(ad.a.DBf,null);const Sb=E.ia(ad.a.vI,-1),oc=E.ia(ad.a.Jv,-1);Hh.Zd.fDb&&Hh.xkb&&Hh.xkb.qtk(ma);var Jb=Hh.$Pn(Sb,oc,ma);Jb&&(E.setValue(ad.a.Jv,16),E.setValue(ad.a.Mta,0));if(!Kd.SelectionEditor.xf(sb.Cb.Rg)&&!Jb&&0<ma.length&&Sb){sb=new md.GraphIterator;Jb=Array(ma.length);for(let Ic=
0;Ic<ma.length;Ic++)sb.set(ma.getContext(Ic).node),Jb[Ic]=Hh.hd.Es(sb);Hh.ZPn(Jb,E)&&(sb=new qi.DictionaryPropertySet,sb.setValue(ad.a.Jv,16),sb.setValue(ad.a.Mta,0),bo.a.SW&&(sb.setValue(Ji.a.hma,"clean-list-before-apply-new-list-style"),sb.setValue(Ji.a.efa,E.ia(Ji.a.hma,"unknown")+"@"+E.ia(Ji.a.efa,"undefined"))),ba.a.Tma(b,h,n,x,sb,$a,11),u.AFrameworkApplication.ya.processAction(Db.a.Z7i,2),w.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),Hh.FOc=!0)}sb=new md.GraphIterator;
sb.set(ma.getContext(0).node);sb=Hh.hd.Es(sb);Hh.Bwm(Sb,oc,sb,ma.length)}b=ba.a.Tma(b,h,n,x,E,$a,11);32===b&&E.ia(ad.a.xdh,!1)&&(b=ba.a.Tma(Db.a.zN,h,n,x,E,$a,11));S&&S.dispose();Fa.end();return b}static ZPn(b,h){let n=null;var x=!1;for(let E=b.length-1;0<=E&&(n?(x=b[E],x=-1!==h.ia(ad.a.vI,-3)?x?n.listType!==x.listType||n.listStyle!==x.listStyle:!0:x?n.listType!==x.listType:!0):n=b[E],!x);E--);return n&&(b=!1,x||(b=h.ia(ad.a.Jv,42),h=h.ia(ad.a.vI,-3),b=b!==n.listType||0<h),x||b)?!0:!1}static Bwm(b,
h,n,x){0>=x||Hh.FOc||(b?n?(n=n.listType,-1===b&&h===n?(u.AFrameworkApplication.ya.processAction(Db.a.Mae,2),w.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<b&&(!h||1===h)&&(u.AFrameworkApplication.ya.processAction(h?Db.a.EPe:Db.a.UPe,2),w.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering"))):(u.AFrameworkApplication.ya.processAction(h?Db.a.EPe:Db.a.UPe,2),Hh.I9n(),w.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",
h?"Bullet":"Numbering")):(u.AFrameworkApplication.ya.processAction(Db.a.Mae,2),w.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static $Pn(b,h,n){if(-1!==b&&b||!n.length)return!1;b=new md.GraphIterator;let x=null;for(let E=n.length-1;0<=E&&!(b.set(n.getContext(E).node),x=Hh.hd.Es(b));E--);return x&&h===x.listType?!0:!1}static Yqa(b,h,n,x,E){if(h.contextId!==cc.a.outlineElement)return 2;var S=h.clone().p0f();if(Hh.Zf.VZa(S))return Hh.Lc.Yb(Gc.a.Mm,{["Reason"]:Mc.a.UD}),
2;const ma=new md.GraphIterator;ma.set(h.node);Kd.SelectionEditor.Gt(ma);if(!Kf.OutlineElementReader.Nh(ma))return 2;if(1===n)switch(b){case Db.a.Uz:return 32;case Db.a.gH:return 32;case Db.a.jaa:return 32;default:return 2}if(Kf.OutlineElementReader.rP(ma))return Hh.Lc.Yb(Gc.a.Mm,{["Reason"]:Mc.a.pN}),2;h=Hh.hd.Es(ma);var Fa;bo.a.SW&&(Fa=Object.freeze(null===h||void 0===h?void 0:h.clone()));let $a=E;if(!$a)return 8;!ec.ListReader.pr&&b===Db.a.gH&&ma.QG()&&(ma.Zp(4)||$a.setValue(ad.a.NMa,1),ma.xj());
Hh.hd.ur?(b===Db.a.gH||b===Db.a.Uz||b===Db.a.jaa?($a=Hh.Jo.w0b(b,$a),S=nr.a.wP($a.getValue(ad.a.Jv),$a.getValue(ad.a.Mta))):S=null,Hh.LZ(b,$a),Hh.FJn(S,$a)):($a=Hh.Jo.w0b(b,$a),S=nr.a.wP($a.getValue(ad.a.Jv),$a.getValue(ad.a.Mta)));ec.ListReader.pr||(S.Qz=$a.ia(ie.a.bX,Zh.a.Xi));let sb=!1;b===Db.a.Uz&&$a&&($a.hasProperty(ic.a.Qr)&&(S.levelText=$a.ia(ic.a.Qr,"")),$a.hasProperty(ie.a.font)&&(S.font=$a.ia(ie.a.font,"")),$a.hasProperty(ad.a.i9e)&&(sb=$a.ia(ad.a.i9e,!1)));Hh.pLn($a,ma);S=Hh.Jo.Yqa($a,
ma,S,sb);if(!S.returnValue)return Hh.Lc.Yb(Gc.a.Mm,{["Reason"]:Mc.a.nvf}),2;S=S.pBa;bo.a.SW&&Hh.$fn(E,Fa,S);2===n&&(n=E.ia(ad.a.Jv,-1),S&&-1!==n&&((Fa=E.ia(ic.a.sr,"Invalid MultiLevel Type"),b===Db.a.gH&&w.ULS.sendTraceTag(540313232,393,50,"toggleNumberedList Info - {0}",JSON.stringify({["commandSource"]:(null===E||void 0===E?void 0:E.CommandSource)||"ribbon/keyboard",["autonumberedListsEnabled"]:!0,["listStyle"]:fs[null==(null===h||void 0===h?void 0:h.listStyle)?null===S||void 0===S?void 0:S.listStyle:
null===h||void 0===h?void 0:h.listStyle],["listType"]:qt[null==(null===h||void 0===h?void 0:h.listType)?null===S||void 0===S?void 0:S.listType:null===h||void 0===h?void 0:h.listType],["cleared"]:16===(null===S||void 0===S?void 0:S.listType)})),h)?S.listType&&1!==S.listType||Hh.FOc||(u.AFrameworkApplication.ya.processAction(Db.a.j2f,2),w.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",n?"Bullet":"Numbering",Fa)):16===S.listType?(u.AFrameworkApplication.ya.processAction(Db.a.xlh,
2),w.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",n?"Bullet":"Numbering",Fa)):S.listType&&1!==S.listType||Hh.FOc||(u.AFrameworkApplication.ya.processAction(Db.a.TPe,2),w.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",n?"Bullet":"Numbering",Fa))),(b=de.FocusManager.instance())&&b.xg&&b.xg.name===Qe.AppFrame.qna&&b.YB(xd.AFrame.Xp));x.Jr=S.listType;x.pB=S.listStyle;return 32}static $fn(b,h,n){var x,E,S,ma,Fa,$a,sb,Jb;const Sb=new Map;Sb.set("actionCallSource",
b.ia(Ji.a.hma,"unknown"));Sb.set("actionCallSourceTrigger",b.ia(Ji.a.efa,"undefined"));Sb.set("fromListType",qt[null!==(x=null===h||void 0===h?void 0:h.listType)&&void 0!==x?x:16]);Sb.set("fromListStyle",fs[null!==(E=null===h||void 0===h?void 0:h.listStyle)&&void 0!==E?E:0]);Sb.set("fromListMarkerType",null!==(Fa=a(null!==(S=null===h||void 0===h?void 0:h.listStyle)&&void 0!==S?S:0,null!==(ma=null===h||void 0===h?void 0:h.listType)&&void 0!==ma?ma:16))&&void 0!==Fa?Fa:"undefined");Sb.set("fromLevelText",
(null===h||void 0===h?0:h.Bea)?h.levelText:"undefined");Sb.set("toListType",null!==($a=qt[null===n||void 0===n?void 0:n.listType])&&void 0!==$a?$a:"undefined");Sb.set("toListStyle",null!==(sb=fs[null===n||void 0===n?void 0:n.listStyle])&&void 0!==sb?sb:"undefined");Sb.set("toListMarkerType",null!==(Jb=a(null===n||void 0===n?void 0:n.listStyle,null===n||void 0===n?void 0:n.listType))&&void 0!==Jb?Jb:"undefined");Sb.set("toLevelText",(null===n||void 0===n?0:n.Bea)?n.levelText:"undefined");ta.Health.instance.recordKpiUsage(Zh.a.oPc.sqm,
0,Zh.a.vB,Sb)}static pLn(b,h){var n=new md.GraphIterator;n.fd(h);(h=n.Rb(2))&&Cd.ParagraphReader.oc(h)&&(n=kh.a.instance.ib.kb)&&n.Qa&&n.Qa.node===h&&Kd.SelectionEditor.YOd(n)&&(Hh.WHn(b),Hh.THn(b))}static FJn(b,h){h.hasProperty(ic.a.sr)&&b.K5d(h.getValue(ic.a.sr));h.hasProperty(Ji.a.jP)&&(b.jP=h.getValue(Ji.a.jP));h.hasProperty(ic.a.Qr)&&(b.levelText=h.getValue(ic.a.Qr));b.vI=h.ia(ad.a.vI,-1);let n=null;b.Yla&&(n=Hh.Kvl(b,h));b.Yla&&n?Hh.kLn(b,n):(b.Yla?w.ULS.sendTraceTag(589091597,393,15,"List marker is null, falling back to default list info.List Style {0}, List multi level type {1}, List Ordered : {2}",
b.vI,b.sr,b.qr):w.ULS.sendTraceTag(589091596,393,50,"User has not selected a style choosing default properties"),Hh.IGn(b))}static IGn(b){if(b.qr)b.HJd&&-1===b.vI||(b.levelText="%1.",b.propertySet.hasProperty(ie.a.M2)||b.n7(0,1));else if(1===b.listType)b.HJd&&-1===b.vI||(b.font=Zh.a.NCc,b.levelText=Zh.a.Cxd,b.propertySet.hasProperty(ie.a.M2)||b.n7(1,6));else return;b.Ws="left"}static kLn(b,h){1===b.sr?Hh.$Jn(b,h):Hh.xIn(b,h)}static $Jn(b,h){(b.BA=h.BA)?b.G3=h.BA.G3:h.BA||w.ULS.sendTraceTag(588022422,
393,15,"Multi level def info is null for list markerList Style {0}, List multi level type {1}, List Ordered : {2}",b.vI,b.sr,b.qr)}static xIn(b,h){b.levelText=h.levelText;b.qr?b.n7(0,h.listStyle):(b.font=h.font,b.n7(1,1));b.Ws=h.Ws}static Kvl(b,h){let n=null;2===b.sr?n=b.qr?Oa.a.instance.Pa("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):Oa.a.instance.Pa("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===b.sr&&(n=Oa.a.instance.Pa("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let x=n.eEb.value;
const E=b.vI+"";E in x||(x=n.D6,w.ULS.sendTraceTag(588391454,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in default list marker dictionary",E,b.sr,b.qr));if(!(E in x)){w.ULS.sendTraceTag(588391455,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in document list marker dictionary",E,b.sr,b.qr);if(h.hasProperty(ie.a.font))return w.ULS.sendTraceTag(588391456,393,50,"User creating new list marker for List styleId {0} List Multi level type {1} and List Ordered : {2}",
E,b.sr,b.qr),b=h.ia(ie.a.font,""),new Tp(B.a.fromCharCode(parseInt(E)),b);w.ULS.sendTraceTag(588391457,393,15,"List styleId {0} List Multi level type {1} and List Ordered : {2} not found in any dictionary",E,b.sr,b.qr)}return x[E]}static THn(b){Hh.Rj.hasProperty(ie.a.fontColor)&&b.setValue(ie.a.fontColor,Hh.Rj.fontColor())}static WHn(b){Hh.Rj.hasProperty(ie.a.fontSize)&&b.setValue(ie.a.fontSize,Hh.Rj.fontSize())}static LZ(b,h){b=b===Db.a.Uz?0:b===Db.a.gH?1:b===Db.a.jaa?2:-1;h=h.ia(ad.a.vI,-1);w.ULS.sendTraceTag(22923024,
324,50,"ListType: {0}, ListStyleId: {1}",b,h)}static I9n(){const b=Oa.a.instance.Za("Common.ISystemInitiatedFeedback");if(b){var h=u.AFrameworkApplication.K.rc("WordDefaultToEditFloodgateDelayInMilliseconds",6E4);b.execute(n=>{window.setTimeout(()=>{n.logActivity("WordListsExperience","WordListsExperienceFloodgateIsEnabled")},h)})}else w.ULS.sendTraceTag(554796489,301,15,"Word lists floodgate instance SystemInitiatedFeedback was null")}}Hh.EYl=Pd.ImageReader.kNc;Hh.ePe=Pd.ImageReader.pZa;Hh.Cf=null;
Hh.Cm=null;Hh.FOc=!1;Object(r.a)(Hh,"ListActor",null,[]);class Bs{constructor(){this.eEb=new se.a(Object(v.a)(this,this.PZe,"createListMarkerDictionary"));this.D6={}}MJh(b){return b}}Object(r.a)(Bs,"AListMarkerGalleryLoader",null,[393]);var Qm=d(1352);class To extends Bs{constructor(){super();this.Gqb=new kf.a(da.a.Pj())}MJh(b){To.lP||this.EFn();b in To.lP&&(b=To.lP[b]);return b}PZe(){const b={};b["0"]=new Tp(Box4Intl.Box4Strings.L_ListStyleNone,Qm.a.z8h);b["1"]=new Tp(String.fromCharCode(61623),
"Symbol");b["2"]=new Tp(String.fromCharCode(111),"Courier New");b["3"]=new Tp(String.fromCharCode(61607),"Wingdings");b["4"]=new Tp(String.fromCharCode(9643),"Courier New");b["5"]=new Tp(String.fromCharCode(61611),"Wingdings");b["6"]=new Tp(String.fromCharCode(61614),"Symbol");b["7"]=new Tp(String.fromCharCode(61483),"Symbol");b["8"]=new Tp(String.fromCharCode(61485),"Symbol");b["9"]=new Tp(String.fromCharCode(9830),"Courier New");b["10"]=new Tp(String.fromCharCode(61664),"Symbol");b["11"]=new Tp(String.fromCharCode(61558),
"Wingdings");b["12"]=new Tp(String.fromCharCode(61656),"Wingdings");b["13"]=new Tp(String.fromCharCode(61514),"Wingdings");b["14"]=new Tp(String.fromCharCode(61516),"Wingdings");b["15"]=new Tp(String.fromCharCode(61692),"Wingdings");b["16"]=new Tp(String.fromCharCode(61691),"Wingdings");b["17"]=new Tp(String.fromCharCode(61553),"Wingdings");return b}zbe(b){b&&b.length&&this.cTe(b)}fLf(){if(this.D6){var b=Lr.a(this.D6),h=b.length;for(let n=0;n<h;n++){const x=this.D6[b[n]];this.Gqb.add(x.levelText+
"_"+x.font)}}}cTe(b){this.fLf();for(const h of b)if(h&&!h.qr&&h.Bea&&h.L3b&&(b=h.levelText+"_"+h.font,!this.Gqb.contains(b))){const n=Lr.a(this.D6).length+Lr.a(this.eEb.value).length+"";this.D6[n]=new Tp(h.levelText,h.font);this.Gqb.add(b)}}EFn(){To.lP={};To.lP["Symbol 0x00b7"]=Box4Intl.Box4Strings.L_SolidBullet;To.lP["Courier New 0x006f"]=Box4Intl.Box4Strings.L_HollowBullet;To.lP["Wingdings 0x00a7"]=Box4Intl.Box4Strings.L_SmallBlackSquare;To.lP["Courier New 0x25ab"]=Box4Intl.Box4Strings.L_SmallWhiteSquare;
To.lP["Wingdings 0x00ab"]=Box4Intl.Box4Strings.L_Star;To.lP["Symbol 0x00ae"]=Box4Intl.Box4Strings.L_RightArrow;To.lP["Symbol 0x002b"]=Box4Intl.Box4Strings.L_PlusSign;To.lP["Symbol 0x002d"]=Box4Intl.Box4Strings.L_Hyphen;To.lP["Courier New 0x2666"]=Box4Intl.Box4Strings.L_BlackDiamond;To.lP["Symbol 0x00e0"]=Box4Intl.Box4Strings.L_WhiteDiamond;To.lP["Wingdings 0x0076"]=Box4Intl.Box4Strings.L_BlackDiamondWithMinusX;To.lP["Wingdings 0x00d8"]=Box4Intl.Box4Strings.L_3DRightwards;To.lP["Wingdings 0x004a"]=
Box4Intl.Box4Strings.L_SmilingFace;To.lP["Wingdings 0x004c"]=Box4Intl.Box4Strings.L_frowningFace;To.lP["Wingdings 0x00fc"]=Box4Intl.Box4Strings.L_CheckMark;To.lP["Wingdings 0x00fb"]=Box4Intl.Box4Strings.L_BallotScriptX;To.lP["Wingdings 0x0071"]=Box4Intl.Box4Strings.L_ShadowedWhiteSquare}}To.lP=null;Object(r.a)(To,"ListMarkerBulletLoader",Bs,[]);class xp{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(r.a)(xp,"InfoAtLevel",null,[]);class Wu{constructor(b){this.BA=b}get font(){return"Calibri"}get listStyle(){return 42}get Ws(){return"left"}get f_d(){return this.BA?
this.A6m():this.C6m()}get RPc(){return this.BA?this.B6m():null}get levelText(){return""}mql(b){switch(b){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}A6m(){let b="";for(let h=0;3>h;h++)b+=this.yIc(h);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Wu.Abf(),b)}B6m(){const b=[];for(let h=0;3>h;h++)b.push(Object.assign(new xp,{textAtLevel:this.tVh(h),styleAtLevel:this.kIl(h)}));return b}C6m(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',
Wu.Bbf(),Box4Intl.Box4Strings.L_ListStyleNone)}tVh(b){b=this.BA.SPc[b];for(let h=0;9>h;h++)b=B.a.replaceAll(b,"%"+(h+1),this.mql(this.BA.gEb[h]));return b}kIl(b){const h={};h.fontFamily=6===this.BA.gEb[b]?this.BA.qAa[b]:this.font;return h}yIc(b){const h=this.tVh(b),n=new Sys.StringBuilder;6===this.BA.gEb[b]&&n.append(String.format("font-family:{0};",this.BA.qAa[b]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
b,n.toString(),h)}static Abf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static Bbf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(r.a)(Wu,"ListMarkerMultilevel",null,[306]);var yx=d(762);class zx extends Bs{constructor(){super()}PZe(){const b=new yx.a,h={};h["0"]=new Wu(null);h["1"]=new Wu(b.hZe());h["2"]=new Wu(b.a_e("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),
[1,2,3,1,2,3,1,2,3]));h["3"]=new Wu(b.urh([61558,61656,61607,61623,9830,61656,61607,61623,9830],"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";")));return h}zbe(){}}Object(r.a)(zx,"ListMarkerMultilevelLoader",Bs,[]);var Uo=d(147);class jq{constructor(b,h){this.BA=null;this.levelText=b;this.qed=h}get font(){return"Calibri"}get listStyle(){return this.qed}get Ws(){switch(this.qed){case 3:case 5:return"right";default:return"left"}}get f_d(){switch(this.qed){case 1:return this.Cac("1",
"2","3");case 2:return this.Cac("a","b","c");case 3:return this.Cac("i","ii","iii");case 4:return this.Cac("A","B","C");case 5:return this.Cac("I","II","III");case 0:return this.D6m();default:return this.Cac("1","2","3")}}get RPc(){const b=[],h={};h.fontFamily=Uo.FontUtils.nza(this.font);switch(this.qed){case 1:return b.push(Object.assign(new xp,{textAtLevel:this.vW("1"),styleAtLevel:h})),b.push(Object.assign(new xp,{textAtLevel:this.vW("2"),styleAtLevel:h})),b.push(Object.assign(new xp,{textAtLevel:this.vW("3"),
styleAtLevel:h})),b;case 2:return b.push(Object.assign(new xp,{textAtLevel:this.vW("a"),styleAtLevel:h})),b.push(Object.assign(new xp,{textAtLevel:this.vW("b"),styleAtLevel:h})),b.push(Object.assign(new xp,{textAtLevel:this.vW("c"),styleAtLevel:h})),b;case 3:return b.push(Object.assign(new xp,{textAtLevel:this.vW("i"),styleAtLevel:h})),b.push(Object.assign(new xp,{textAtLevel:this.vW("ii"),styleAtLevel:h})),b.push(Object.assign(new xp,{textAtLevel:this.vW("iii"),styleAtLevel:h})),b;case 4:return b.push(Object.assign(new xp,
{textAtLevel:this.vW("A"),styleAtLevel:h})),b.push(Object.assign(new xp,{textAtLevel:this.vW("B"),styleAtLevel:h})),b.push(Object.assign(new xp,{textAtLevel:this.vW("C"),styleAtLevel:h})),b;case 5:return b.push(Object.assign(new xp,{textAtLevel:this.vW("I"),styleAtLevel:h})),b.push(Object.assign(new xp,{textAtLevel:this.vW("II"),styleAtLevel:h})),b.push(Object.assign(new xp,{textAtLevel:this.vW("III"),styleAtLevel:h})),b;case 0:return null;default:return b.push(Object.assign(new xp,{textAtLevel:this.vW("1"),
styleAtLevel:h})),b.push(Object.assign(new xp,{textAtLevel:this.vW("2"),styleAtLevel:h})),b.push(Object.assign(new xp,{textAtLevel:this.vW("3"),styleAtLevel:h})),b}}Cac(b,h,n){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',jq.Abf(),this.yIc(b),this.yIc(h),this.yIc(n))}D6m(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',jq.Bbf(),Box4Intl.Box4Strings.L_ListStyleNone)}yIc(b){b=this.vW(b);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',
b)}vW(b){return B.a.replaceAll(this.levelText,"%1",b)}static Abf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static Bbf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(r.a)(jq,"ListMarkerNumbering",null,[306]);class Pt extends Bs{constructor(){super();this.Gqb=new kf.a(da.a.Pj())}Iim(b){b=b.match(RegExp("%[1-9]","g"));return!!b&&1===b.length}PZe(){const b=
{};b["0"]=new jq(Box4Intl.Box4Strings.L_ListStyleNone,0);b["1"]=new jq("%1.",5);b["2"]=new jq("%1.",4);b["3"]=new jq("%1.",1);b["4"]=new jq("%1.",2);b["5"]=new jq("%1.",3);b["6"]=new jq("%1)",5);b["7"]=new jq("%1)",4);b["8"]=new jq("%1)",1);b["9"]=new jq("%1)",2);b["10"]=new jq("%1)",3);b["11"]=new jq("(%1)",5);b["12"]=new jq("(%1)",4);b["13"]=new jq("(%1)",1);b["14"]=new jq("(%1)",2);b["15"]=new jq("(%1)",3);return b}zbe(b){b&&b.length&&this.cTe(b)}fLf(){if(this.D6){var b=Lr.a(this.D6),h=b.length;
for(let n=0;n<h;n++){const x=this.D6[b[n]];this.Gqb.add(x.levelText+"_"+x.listStyle)}}}cTe(b){this.fLf();for(const h of b)if(h&&h.qr&&h.Bea&&this.Iim(h.levelText)&&h.listStyle&&(b=Qm.a.Z9e(h.levelText))){const n=b+"_"+h.listStyle;if(!this.Gqb.contains(n)){const x=Lr.a(this.D6).length+Lr.a(this.eEb.value).length+"";this.D6[x]=new jq(b,h.listStyle)}this.Gqb.add(n)}}}Object(r.a)(Pt,"ListMarkerNumberingLoader",Bs,[]);class rt{constructor(){this.W=null}get name(){return"Box4.ListMarker"}init(){Hh.Vb()}dispose(){}zc(b){this.W=
b;this.W.ha("Box4.ListMarkerGallery.ListMarkerBulletLoader",()=>new To).singleInstance();this.W.ha("Box4.ListMarkerGallery.ListMarkerNumberingLoader",()=>new Pt).singleInstance();this.W.ha("Box4.ListMarkerGallery.ListMarkerMultilevelLoader",()=>new zx).singleInstance()}static main(){N.a.instance.Pc(new rt)}}Object(r.a)(rt,"Box4ListMarkerPackage",null,[1,2]);class Hw{static get ug(){return Kc.a.Lx(Hw.rl,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,
"")}}Hw.rl="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>";
Object(r.a)(Hw,"DefineNewBulletDialogHtml",null,[]);class Mr extends Kc.a{constructor(b,h,n,x){super();this.lqc=this.Cwe=this.zRb=this.rRb=null;this.nrb=0;this.zyc=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];this.j6h=!0;this.LPk=E=>{if(this.rRb&&E.target!==this.rRb){const S=this.Ai.Cs();S&&S.Uj&&(S.Uj.hy(E.target),this.rRb=E.target)}this.gVm(E.target.id)};this.$pm=E=>{E=E.Af;if(!this.ehi(E))return!1;this.Ai.Cs().Uj.hy(E);E.focus();return!0};this.aqm=E=>{var S=E.Af;if(!this.ehi(S))return!1;
var ma=S.id;ma=parseInt(ma.substr(ma.lastIndexOf("_")+1))-this.nrb;if(E.Ib.ctrlKey||E.Ib.altKey||E.Ib.keyCode>=db.a.FMb&&E.Ib.keyCode<=db.a.GMb)return!1;const Fa=E.Ib.keyCode;if(E.eventName===kb.a.Di){E=-1;if(Fa===Sys.UI.Key.enter)return this.Ai.Cs().Uj.hy(S),S.focus(),this.jwi(S.id),this.hide(),!0;Fa===Sys.UI.Key.up?E=ma-17:Fa===Sys.UI.Key.down?E=ma+17:Fa===Sys.UI.Key.left?E=u.AFrameworkApplication.isRtl?ma+1:ma-1:Fa===Sys.UI.Key.right&&(E=u.AFrameworkApplication.isRtl?ma-1:ma+1);0<=E&&(S=this.mSh(Mr.p_b+
"_"+(E+this.nrb)))&&S.focus()}return!0};this.KPk=E=>{1===E&&this.jwi(this.zRb);this.hide()};this.hp=b;this.Ai=h;this.ga=n;this.HK=!1;x&&(b=x.indexOf(","),-1!==b&&(x=x.substring(0,b)));this.fontName=x;this.kg="DefineNewBulletDialog";this.ug=Hw.ug;this.We(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.We(0,CommonUIStrings.l_DialogClose);this.Zh(Box4Intl.Box4Strings.L_SymbolSingle,this.KPk,null);this.i8=!1;this.oDa();document.getElementById(Mr.oCd).focus()}oDa(){this.Ai.Cs().scope.Ar(de.FocusManager.instance().uV);
this.Ai.Cs().scope.Ar(de.FocusManager.instance().vV);this.Ai.Cs().scope.bindAction(de.FocusManager.instance().uV,Db.a.Lxd);this.Ai.Cs().scope.bindAction(de.FocusManager.instance().vV,Db.a.Kxd)}UT(){this.jsd(Mr.oCd,"DefineNewBulletFontPlaceholder",Db.a.Jxd.toString(),Db.a.eHb.toString(),Db.a.lUc.toString(),Box4Intl.Box4Strings.L_FontName,"100px");this.Ejk()}nO(){super.nO();document.getElementById(this.pj("WACDialogPanel")).style.width="auto"}jsd(b,h,n,x,E,S,ma){n=xf.c(b,n,!0,!0,x,E,B.a.If(S),!0,ma);
this.swd(b,h,n,"Medium")}Ejk(){const b=document.getElementById(Mr.p_b);b&&(b.innerHTML=this.UNh(),this.vKi(b))}vKi(b){if(b=b.getElementsByClassName("DefineNewBulletTableCell"))for(let h=0;h<b.length;h++)af.a.addHandler(b[h],kb.a.focus,this.LPk)}jgo(){var b=document.getElementById(Mr.p_b);if(b){let h=this.fontName;const n=Qm.a.Knf(this.fontName);n&&61472!==this.nrb||!n&&32!==this.nrb?(b.innerHTML=this.UNh(),this.vKi(b)):(b=b.getElementsByTagName("table"))&&1===b.length&&h&&(h=this.r7g(h),b[0].style.fontFamily=
h)}}gVm(b){this.qYi(this.zRb,!1);this.zRb=b;this.qYi(b,!0);if((b=document.getElementById("CharacterCodeValueLabel"))&&this.zRb){let h=parseInt(this.zRb.substr(this.zRb.lastIndexOf("_")+1));-1!==h&&(h-=61472===this.nrb?61440:0,b.innerText=B.a.TH(h,4))}}qYi(b,h){(b=this.mSh(b))&&(h?b.setAttribute("selected","true"):b.removeAttribute("selected"))}mSh(b){const h=document.getElementById(Mr.p_b);return h?h.querySelector("#"+b):null}tja(){const b=document.getElementById(Mr.p_b);b&&(this.Cwe||(this.Cwe=this.$pm,
this.lq.mb(kb.a.click,b,this.Cwe)),this.lqc||(this.lqc=this.aqm,this.re.mb(kb.a.Di,b,this.lqc),this.re.mb(kb.a.At,b,this.lqc),this.re.mb(kb.a.Bh,b,this.lqc)));super.tja()}ehi(b){return b.classList.contains("DefineNewBulletTableCell")}jwi(b){if(b){b=b.split("_");const h=new qi.DictionaryPropertySet;h.setValue(ad.a.vI,parseInt(b[1]));h.setValue(ie.a.font,this.fontName);h.setValue(ad.a.Jv,1);bo.a.SW&&(h.setValue(Ji.a.hma,"command-ui"),h.setValue(Ji.a.efa,"define-new-bullet-dialog"));this.ga.Xb(Db.a.Uz,
2,h)}this.Ai.nK(this.PJ,!0)}UNh(){const b=new Sys.StringBuilder,h=Qm.a.Knf(this.fontName);let n=this.fontName;n=this.r7g(n);b.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',n));h?(this.nrb=61472,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')):
(this.nrb=32,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\u007f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\u0080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\u0081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\u0082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\u0083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\u0084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\u0086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\u0087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\u0088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\u0089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\u008a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\u008b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\u008c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\u008d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\u008e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\u008f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\u0090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\u0091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\u0092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\u0093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\u0094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\u0095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\u0096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\u0097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\u0098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\u0099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\u009a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\u009b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\u009c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\u009d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\u009e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\u009f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\u00a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\u00a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\u00a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\u00a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\u00a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\u00a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\u00a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\u00a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\u00a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\u00aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\u00ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\u00ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\u00ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\u00ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\u00af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\u00b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\u00b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\u00b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\u00b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\u00b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\u00b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\u00b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\u00b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\u00b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\u00b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\u00ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\u00bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\u00bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\u00bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\u00be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\u00bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\u00c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\u00c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\u00c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\u00c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\u00c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\u00c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\u00c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\u00c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\u00c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\u00c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\u00ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\u00cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\u00cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\u00cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\u00ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\u00cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\u00d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\u00d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\u00d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\u00d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\u00d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\u00d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\u00d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\u00d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\u00d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\u00d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\u00da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\u00db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\u00dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\u00dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\u00de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\u00df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\u00e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\u00e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\u00e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\u00e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\u00e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\u00e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\u00e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\u00e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\u00e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\u00e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\u00ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\u00eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\u00ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\u00ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\u00ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\u00ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\u00f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\u00f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\u00f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\u00f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\u00f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\u00f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\u00f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\u00f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\u00f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\u00f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\u00fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\u00fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\u00fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\u00fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\u00fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\u00ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>'));
b.append("</table>");return b.toString()}r7g(b){b&&-1!==b.indexOf(" ")&&(b="'"+b+"'");return b}swd(b,h,n,x){h=document.getElementById(h);this.hp.rya(b,n);n=this.hp.EXa(b,x);h.appendChild(n);this.hp.aM(b)}dispose(){this.HK||(this.hp.IA(Mr.oCd),this.HK=!0);super.dispose()}}Mr.oCd="DefineNewBulletFontStyleComboBox";Mr.p_b="DefineNewBulletTableContainer";Object(r.a)(Mr,"DefineNewBulletDialog",Kc.a,[]);class Ax{THc(){return Db.a.Vpm}xIc(){return Db.a.AKf}}Object(r.a)(Ax,"ListMarkerGalleryBulletCommands",
null,[305]);class ny{THc(){return Db.a.Xpm}xIc(){return Db.a.V3m}}Object(r.a)(ny,"ListMarkerGalleryMultilevelCommands",null,[305]);class oy{THc(){return Db.a.Ypm}xIc(){return Db.a.BKf}}Object(r.a)(oy,"ListMarkerGalleryNumberingCommands",null,[305]);class Iw{constructor(b,h,n,x,E){this.Kwa=this.pHa=null;this.mwh=S=>{if(!this.Kwa)return 2;if(this.Kwa.Ai.Cs().Uj.G1.id.startsWith(Mr.p_b)){let ma=null;S===Db.a.Lxd?ma=this.Kwa.pVa:S===Db.a.Kxd&&(ma=document.getElementById(Mr.oCd));if(!ma)return 2;this.Kwa.Ai.Cs().Uj.hy(ma);
ma.focus()}else if(S===Db.a.Lxd)this.Kwa.Ai.Cs().g9b();else if(S===Db.a.Kxd)this.Kwa.Ai.Cs().e9b();else return 2;return 32};this.Dji=(S,ma)=>{S=null;ma.view.Be&&(S=ma.view);return S&&S.Cb?32:(sd.b(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",ma.toString()),8)};this.fom=(S,ma,Fa)=>1===Fa?32:2===Fa?(S=this.X2b(ma),S=Mh.FormattingReader.Ds(S).cache.KG,this.Kwa=new Mr(this.AUj,de.FocusManager.instance(),u.AFrameworkApplication.ya,
S),32):8;this.lUc=(S,ma,Fa,$a,sb)=>{if(1===Fa)return 32;if(2===Fa&&!sb)return 8;if(this.Kwa.j6h){for(S=0;S<Qm.a.zyc.length;S++)Uo.FontUtils.Gcj(Qm.a.zyc[S]);this.Kwa.j6h=!1}Zl.a.mLd(ma);sb.PopulationXML=Uo.FontUtils.vJh(Zl.a.U6d,Zl.a.z9e,Db.a.Jxd);return 32};this.U3m=(S,ma,Fa,$a,sb)=>{S=ma.contextId===cc.a.outlineElement;if(1===Fa||!S)return S?32:8;if(2===Fa&&!sb)return 8;sb.MenuItems=this.UJj.Ovl();return 32};this.JPk=(S,ma,Fa,$a,sb)=>{if(1===Fa)return 32;if(2===Fa){S=Object(ja.a)(27,sb);if(!S||
!S.Bd)return 8;this.Kwa.fontName=S.Bd.fontName;this.Kwa.jgo();return 32}return 8};this.ga=b;this.Cf=x.resolve("Box4.List.IListReader");this.J4=h;this.AUj=n;switch(this.J4){case 0:b=x.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader");this.pHa=new Ax;break;case 1:b=x.resolve("Box4.ListMarkerGallery.ListMarkerNumberingLoader");this.pHa=new oy;break;case 2:b=x.resolve("Box4.ListMarkerGallery.ListMarkerMultilevelLoader");this.pHa=new ny;break;default:b=x.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader"),
this.pHa=new Ax}E=this.Cf?this.Cf.Avl(E):null;b.zbe(E);this.UJj=new Qm.a(h,b,E,!!u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.eDb)}Vb(){this.ga.pa(this.pHa.xIc(),cc.a.view,ob.App.h3a.Krh(11));this.ga.pa(this.pHa.xIc(),cc.a.outlineElement,this.U3m);this.ga.Vc(this.pHa.xIc(),1124);this.J4||(this.ga.gb(Db.a.suf,cc.a.view,this.fom,1028),this.ga.gb(Db.a.lUc,cc.a.view,this.lUc,1124),this.ga.gb(Db.a.Jxd,cc.a.view,this.JPk,1028),this.ga.gb(Db.a.Lxd,Ld.a.frame,this.mwh,64),this.ga.gb(Db.a.Kxd,
Ld.a.frame,this.mwh,64));this.ga.pa(this.pHa.THc(),cc.a.view,this.Dji);this.ga.pa(this.pHa.THc(),cc.a.outlineElement,this.Dji);this.ga.Vc(this.pHa.THc(),1124)}X2b(b){return this.wDd(b).Qa}wDd(b){let h=null;b=b.view;return b?h=Kd.SelectionEditor.ak(b.Cb.ib.J(0),!1,!1):h}}Object(r.a)(Iw,"ListMarkerGalleryActor",null,[257]);class Bx{constructor(){this.Re=this.W=null}get name(){return"Box4.ListMarkerGallery"}init(){if(cb.InteractiveViewManager.instance){var b=cb.InteractiveViewManager.instance;b.editingView&&
(this.Re=b.editingView.ud,this.Vjn())}}dispose(){}zc(b){this.W=b}Vjn(){(new Iw(u.AFrameworkApplication.ya,1,this.W.resolve("Common.IStandaloneRootController").q3,this.W,this.Re)).Vb();(new Iw(u.AFrameworkApplication.ya,0,this.W.resolve("Common.IStandaloneRootController").q3,this.W,this.Re)).Vb();(new Iw(u.AFrameworkApplication.ya,2,this.W.resolve("Common.IStandaloneRootController").q3,this.W,this.Re)).Vb()}static main(){N.a.instance.Pc(new Bx)}}Object(r.a)(Bx,"Box4ListMarkerGalleryPackage",null,[1,
2]);var $y=d(341),Wv=d(397),az=d(366),Wm=d(99);const su=b=>{b.element.style.top=""};var $s=d(1008);class bz{constructor(b,h,n){this.fN=!1;this.J5a=0;this.Qba=this.MSg=null;this.Tl=b;this.EVj=h;this.Zr=n;this.sY=b.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.$v=!!u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.u6)&&!this.Zr.m3e&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";V.a.fj&&Sys.UI.DomElement.addCssClass(this.htmlElement,
"FireFox")}get htmlElement(){return this.sY}get visible(){return this.fN}set_visible(b){if(this.fN!==b)return(this.fN=b)?this.RQe():this.gDc(),b}dispose(){this.visible&&this.gDc();Ke.a.YY(this.htmlElement);this.Tl=this.sY=null}L2i(b,h){const n=b.htmlElement||b.createElement();h===this.htmlElement.childNodes.length?this.htmlElement.appendChild(n):this.htmlElement.insertBefore(n,this.htmlElement.childNodes[h]);b.lQi();this.J5a+=b.htmlElement.clientHeight;var x=this.htmlElement.childNodes,E=b.C$g,S=
Object(v.a)(this,this.SMm,"onAfterShowEntry");Wm.WacAirSpace.jU(n,"Shared_BasicClass");var ma=new az.a(n);ma.Uqa(0,1);const Fa=new Wv.a(n);Fa.Aya(n.clientTop-30,n.clientTop);E?(Wm.WacAirSpace.fhb(ma,null,null),Wm.WacAirSpace.fhb(Fa,null,S)):(Wm.WacAirSpace.animate(ma,null,null),Wm.WacAirSpace.animate(Fa,null,S));for(h+=1;h<x.length;h++)S=x[h],Wm.WacAirSpace.jU(S,"Shared_BasicClass"),ma=new Wv.a(S),ma.Aya(S.clientTop-n.clientHeight,S.clientTop),E?Wm.WacAirSpace.fhb(ma,null,null):Wm.WacAirSpace.animate(ma,
null,null);b.KUn();this.set_visible(!0)}u3h(b){const h=b.htmlElement;if(Ke.a.BCb(h)){this.J5a-=b.htmlElement.clientHeight;var n=h.parentNode.children;b=b.C$g;var x=Object(v.a)(this,this.JMm,"onAfterHideEntry");Wm.WacAirSpace.jU(h,"Shared_BasicClass");var E=new $y.a(h);E.Uqa(1,0);b?Wm.WacAirSpace.fhb(E,null,x):Wm.WacAirSpace.animate(E,null,x);x=!1;for(E=0;E<n.length;E++){if(x){const S=n[E];Wm.WacAirSpace.jU(S,"Shared_BasicClass");const ma=new Wv.a(S);ma.Aya(S.clientTop,-h.clientHeight);b?Wm.WacAirSpace.fhb(ma,
null,su):Wm.WacAirSpace.animate(ma,null,su)}x||n[E]!==h||(x=!0)}}}SMm(b){b.element.style.top="";u.AFrameworkApplication.ua.YRc()}JMm(b){b.element.parentNode.removeChild(b.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);u.AFrameworkApplication.ua.YRc()}RQe(){""===this.Tl.style.top.trim()&&(this.Tl.style.top=this.Tl.offsetTop+"px");this.htmlElement.style.left=this.Tl.style.left;this.htmlElement.style.top=this.Tl.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility=
"visible";var b=Sys.UI.DomElement.getBounds(this.htmlElement);this.MSg=this.Tl.style.top;this.J5a=b.height;this.Lbe();u.AFrameworkApplication.ua.i1(Object(v.a)(this,this.onResize,"onResize"));af.a.addHandler(this.htmlElement,kb.a.Lcc,af.a.cab);this.Qba=Object(v.a)(this,this.lza,"contextMenuHandler");u.AFrameworkApplication.ua.Cva.mb(this.htmlElement,this.Qba,null);if(de.FocusManager.YI()){var h=de.FocusManager.instance();b=h.pe($s.a.fJa);b.parent=xd.AFrame.Lp;const n=new ke.DOMFocusListing(()=>this.htmlElement);
n.Go(1);n.Go(2);n.Go(8);h.yja(()=>this.htmlElement,b,n);h=h.getRegion($s.a.fJa);h.oOa();h.dX=!0;h.QVa=!0;const x=u.AFrameworkApplication.ua.gv;b.yub(()=>{x.Hw($s.a.fJa)});x.kS($s.a.fJa);(n.bea||u.AFrameworkApplication.K.$("ReactBusinessBarIsEnabled"))&&x.tG($s.a.fJa)}}gDc(){this.o2i()&&(this.Tl.style.top=this.MSg);this.htmlElement.style.visibility="hidden";u.AFrameworkApplication.ua&&(de.FocusManager.YI()&&de.FocusManager.instance().NHb($s.a.fJa),this.Qba&&(u.AFrameworkApplication.ua.Cva.sc(this.htmlElement,
this.Qba),this.Qba=null));af.a.removeHandler(this.htmlElement,kb.a.Lcc,af.a.cab)}Lbe(){if(this.o2i()&&this.visible){var b=this.Tl,h=this.J5a+this.EVj;const n=Ke.a.ZL(b.style.top);Wm.WacAirSpace.jU(b,"Shared_BasicClass");b=new Wv.a(b);b.Aya(n,h);Wm.WacAirSpace.animate(b,null,null)}}o2i(){return!this.$v&&!this.Zr.m3e}onResize(){const b=this.Zr.entries.length,h=Sys.UI.DomElement.getBounds(this.htmlElement).height;let n;for(let x=0;x<b;++x)n=this.Zr.entries[x],n.htmlElement&&n.lQi();this.J5a=Sys.UI.DomElement.getBounds(this.htmlElement).height;
h!==this.J5a&&this.Lbe()}lza(){return!0}}Object(r.a)(bz,"BusinessBarDom",null,[1084,10]);var gs;(function(b){b[b.none=0]="none";b[b.corruptPage=1]="corruptPage";b[b.currentPageStatus=2]="currentPageStatus";b[b.documentMarkedAsFinal=3]="documentMarkedAsFinal";b[b.documentSigned=4]="documentSigned";b[b.fileAccess=5]="fileAccess";b[b.kickoutWithDataLoss=6]="kickoutWithDataLoss";b[b.lostSession=7]="lostSession";b[b.malformedHyperlinkUris=8]="malformedHyperlinkUris";b[b.odt=9]="odt";b[b.readonlyRecommended=
10]="readonlyRecommended";b[b.saveReplaySuccess=11]="saveReplaySuccess";b[b.saveReplayFailed=12]="saveReplayFailed";b[b.unsupportedObjects=13]="unsupportedObjects";b[b.word11Compat=14]="word11Compat";b[b.unsupportedBrowser=15]="unsupportedBrowser";b[b.applicationNotification=16]="applicationNotification";b[b.skypeDocChatFailed=17]="skypeDocChatFailed";b[b.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";b[b.sessionExpired=19]="sessionExpired";b[b.irmPolicyDescription=20]="irmPolicyDescription";
b[b.policyWarningMessage=21]="policyWarningMessage";b[b.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";b[b.gdprPrivacyNotice=23]="gdprPrivacyNotice";b[b.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";b[b.graphMergePrompt=25]="graphMergePrompt";b[b.readOnlyDocument=26]="readOnlyDocument";b[b.dictationSilence=27]="dictationSilence";b[b.autoSensitivityLabel=28]="autoSensitivityLabel";b[b.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";b[b.dictationDebugInfo=30]=
"dictationDebugInfo";b[b.oneNoteCovid19Message=31]="oneNoteCovid19Message";b[b.citationStylePrompt=32]="citationStylePrompt";b[b.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";b[b.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";b[b.oneNotePagePrintReady=35]="oneNotePagePrintReady";b[b.irmPolicyCausedFeatureDisabled=36]="irmPolicyCausedFeatureDisabled";b[b.mandatoryLabel=37]="mandatoryLabel";b[b.policyTip=38]="policyTip";b[b.minorVersionLimit=39]="minorVersionLimit";b[b.testEntry1=
40]="testEntry1";b[b.testEntry2=41]="testEntry2";b[b.testEntry3=42]="testEntry3";b[b.testEntry4=43]="testEntry4";b[b.testEntry5=44]="testEntry5";b[b.testEntry6=45]="testEntry6";b[b.testEntry7=46]="testEntry7"})(gs||(gs={}));Object(r.b)("BusinessBarId",gs);class Xu{constructor(b,h=0,n=null,x=null){this.AKg=this.oAg=!1;this.aTb=null;this.Zz=[];this.JQa=x||new bz(b,h,this);this.R1l(n)}R1l(b){if(b){this.aTb={};b=b.ranking;for(let h=0;h<b.length;h++)this.aTb[gs[b[h]]]=h}}dispose(){this.JQa.dispose();Zb.a.iUf(this.Zz);
this.Zz=null}get htmlElement(){return this.JQa.htmlElement}get visible(){return this.JQa.visible}get m3e(){return this.oAg}set m3e(b){this.oAg=b}get Brf(){return this.AKg}set Brf(b){this.AKg=b}get entries(){return this.Zz}set entries(b){this.Zz=b}Qea(b){for(let h=0;h<this.Zz.length;h++)if(this.Zz[h].id===b)return!0;return!1}eB(b,h=!1,n=null,x=null,E=null){b.mP=this;let S=this.ztl(b.id);h&&!this.aTb&&(S=0);S<Xu.OEb&&(this.JQa.L2i(b,S),this.Zz.length>=Xu.OEb&&this.JQa.u3h(this.Zz[Xu.OEb-1]),this.JQa.Lbe());
Array.insert(this.Zz,S,b);w.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",gs[b.id],void 0===b.RVa||null===b.RVa?"":b.RVa);b.errorCode&&u.AFrameworkApplication.MQ(b.errorCode,n,x,E)}removeEntry(b){const h=Array.indexOf(this.Zz,b);-1!==h&&h<Xu.OEb&&(this.Zz.length>Xu.OEb&&this.JQa.L2i(this.Zz[Xu.OEb],Xu.OEb),this.JQa.u3h(b),this.JQa.Lbe());Array.remove(this.Zz,b);b.mP=null;b.dispose()}ztl(b){if(!this.aTb||0===b)return this.Zz.length;b=this.aTb[gs[b]];if(void 0===
b||null===b)return this.Zz.length;for(let h=0;h<this.Zz.length;h++)if(b<this.aTb[gs[this.Zz[h].id]])return h;return this.Zz.length}}Xu.OEb=2;Object(r.a)(Xu,"BusinessBar",null,[1057,10,1058]);class Tz{create(b,h,n){return new Pc.a(b,h,n)}}Object(r.a)(Tz,"Factory",null,[1083]);class Uz{static DAk(b,h){b.register(Xu,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").singleInstance().Xd(()=>new Xu(h.value,0,b.Pa("CommonUI.IBusinessBarRankProvider")));b.register(Tz,"CommonUI.BusinessBarEntry.Factory").as("CommonUI.IBusinessBarEntryFactory").singleInstance()}}
Object(r.a)(Uz,"CommonUIComponentConfiguration",null,[]);var AA=d(962);class Yu extends AA.a{constructor(){super()}static get instance(){return Yu._instance||Yu.emf()}static emf(){Yu._instance=new Yu;return Yu._instance}}Yu._instance=null;Object(r.a)(Yu,"ReactRootManager",AA.a,[262,263]);class Vz extends Pg.a{constructor(){super()}get ControlType(){return 3}}Object(r.a)(Vz,"CompoundButtonProps",Pg.a,[]);class cz{constructor(b,h,n,x,E,S,ma){this.lV=h;this.Ntc=b;this.NIg=h.O$l;this.UQb=h.aOc;this.Zse=
S;this.tbd=x;this.ubd=E;this.nbd=n;this.mx=ma;this.V6a=new Do.a;this.V6a.Z(1,"SpellingIssue_16x16x32");this.V6a.Z(2,"GrammarIssue_16x16x32");this.V6a.Z(3,"WritingIssue_16x16x32");this.V6a.Z(4,null);this.V6a.Z(0,null)}create(b,h,n){h=Object(ja.a)(Ok.a,h);if(!h)return w.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";const x=new Sys.StringBuilder;b=this.HRh(b);this.lCc(x,h,n,b);this.IZe(x,h);this.DKk(x,h,b);return x.toString()}Wwb(b,h,n){const x=Object(ja.a)(Ok.a,h);if(!x)return w.ULS.sendTraceTag(39188232,
375,15,"Expect EditorServiceErrorDetails."),[];h=[];b=this.HRh(b);this.s_e(h,x,n,b);this.JZe(h,x);this.EKk(h,x,b);for(n=0;n<h.length;n++)h[n].Id=`${Uh.OAh}_${n}`;return h}lCc(b,h,n,x=null){h.errorType?1===h.errorType&&(this.y0b(h)||b.append(this.ZSe(h,n,x))):b.append(this.Ntc.build())}s_e(b,h,n,x=null){h.errorType?1===h.errorType&&(this.y0b(h)||b.push(this.Ajk(h,n,x))):b.push(this.Ntc.dgh())}IZe(b,h){const n=new Sys.StringBuilder;this.B3i(h)?n.append(xf.a("btnIgnoreAllSpellingError",(2===h.errorType?
Db.a.LEa:Db.a.sla).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.y0b(h)||n.append(xf.a("btnIgrnoreSpellingError",this.HQh(h.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.H3i(h)&&(this.lV.kai&&n.append(xf.a("btnDoNotCheckForThisIssue",Db.a.Sxb.toString(),Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),n.append(xf.a("btnGrammarOptions",Db.a.bib.toString(),B.a.If(Box4Intl.Box4Strings.l_GrammarOptions),null)));n.isEmpty()||(b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),
b.append(n.toString()),b.append("</Controls></MenuSection>"))}JZe(b,h){const n=Object.assign(new Fh.a,{ControlList:[]});if(this.B3i(h)){var x=Tj.a.Jy()?Object.assign(new Pg.a,{ExternalId:"btnIgnoreAllSpellingErrorForAL",Command:Db.a.sla,LabelText:Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors}):Object.assign(new Pg.a,{ExternalId:2===h.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});n.ControlList.push(x)}else this.y0b(h)||(x=Object.assign(new Pg.a,{ExternalId:"btnIgrnoreSpellingError",
Command:this.HQh(h.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),n.ControlList.push(x));this.H3i(h)&&(this.lV.kai&&(h=Object.assign(new Pg.a,{ExternalId:"DoNotCheckForThisIssue"}),n.ControlList.push(h)),h=Object.assign(new Pg.a,{ExternalId:"GrammerSettingsContext"}),n.ControlList.push(h));b.push(n)}HRh(b){if(!this.mx)return null;b=this.mx.language(this.mx.Ds(b.Qa));return vj.a.lg(b)?vj.a.lg(b).name:null}HQh(b){return 2===b?Db.a.LEa:this.lV.xcm?Db.a.rYl:Db.a.Vsa}DKk(b,
h,n=null){if(this.KYf(h)){var x=B.a.If(h.Ss.CategoryTitle);x=xf.o(Uh.Lac,Ra.a.lja,this.V6a.J(h.proofingType),""!==x?x:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[b.toString()],this.tbd,this.ubd);x=xf.d("cgProofingOuter",[x]);b.clear();b.append(xf.h("msProofingOuter",x,"Menu16",void 0,void 0,n,"ariaLabelledById"));w.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}EKk(b,h,n=null){if(this.KYf(h)){var x=B.a.If(h.Ss.CategoryTitle);
n=Object.assign(new Yh.a,{ExternalId:String.format("{0}_{1}",Uh.Lac,h.proofingType),Command:Ra.a.lja.toString(),Image16by16Class:this.V6a.J(h.proofingType),LabelText:""!==x?x:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:n,Menu:Object.assign(new ti.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.Bgl(h),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});n.Menu.MenuSectionList.push(...b);Array.clear(b);
x=Object.assign(new Fh.a,{ControlList:[]});x.ControlList.push(n);b.push(x);w.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}ZSe(b,h,n=null){const x=this.Tol(b);var E=[];let S=!1;var ma=b.Ss.Suggestions;if(ma)if(ma=ma.slice(0,Math.min(3,ma.length)),this.NIg&&(S=!th.a.any(ma,Fa=>!Fa||!Fa.Description)),1!==ma.length||ma[0].Action){let Fa=0,$a=null;S&&($a="font-weight: bold;");for(const sb of ma){if(!sb)continue;ma=null;let Jb="";const Sb=
B.a.If(sb.Text);S&&(ma=this.sLh(sb.Description),Jb=this.rLh(sb.Description));E.push(xf.a("btnCorrectWord"+Fa,h[Fa].toString(),Sb,null,null,null,null,null,$a,null,ma,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,x,Sb),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.hqh(b.token)),"ariaDescribedById",Jb));Fa++}}else h=B.a.If(ma[0].Text),E.push(xf.a("btnCorrectWord0",Db.a.LEa.toString(),
h,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,x,h)));h="Menu16";0<E.length?S&&(h="Menu16DescriptionEnabled"):E=[xf.a("btnNoSuggestions",Db.a.LEa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)];return xf.h("msUnknownWord",xf.d(null,E),h,x,this.Qwl(b),n,"ariaLabelledById")}Ajk(b,h,n=null){var x=1!==b.proofingType&&0!==b.proofingType?b.Ss.ExplanationTitle:"";x=Object.assign(new Fh.a,{Title:x,Lang:n,ControlList:[]});
let E=!1;var S=b.Ss.Suggestions;if(S)if(S=S.slice(0,Math.min(3,S.length)),this.NIg&&(E=!th.a.any(S,ma=>!ma||!ma.Description)),1!==S.length||S[0].Action){let ma=0;for(const Fa of S){if(!Fa)continue;S=null;let $a="";E&&(S=this.sLh(Fa.Description),$a=this.rLh(Fa.Description));if(ma>=h.length)break;S?(S=Object.assign(new Vz,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",ma,b.proofingType),Command:h[ma].toString(),LabelText:Fa.Text,Description:S,Lang:n,AriaDescription:$a}),x.ControlList.push(S)):
(S=Object.assign(new Pg.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",ma,b.proofingType),Command:h[ma].toString(),LabelText:Fa.Text,Lang:n,RoleInMenu:"menuitem"}),x.ControlList.push(S));ma++}}else b=S[0],b=Object.assign(new Pg.a,{ExternalId:"NoSuggestion",Command:Db.a.LEa.toString(),LabelText:b.Text}),x.ControlList.push(b);0>=x.ControlList.length&&x.ControlList.push(Object.assign(new Pg.a,{ExternalId:"btnNoSuggestions",Command:Db.a.LEa.toString(),LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));
return x}Tol(b){return B.a.If(0!==b.proofingType?b.Ss.ExplanationTitle:"")}Qwl(b){return this.KYf(b)?null:this.V6a.J(b.proofingType)}KYf(b){return this.UQb&&2!==b.errorType&&(1!==b.errorType||!this.y0b(b))}B3i(b){return this.Zse&&!!b.errorType&&1===b.proofingType&&!this.y0b(b)}Bgl(b){return 1===b.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.hqh(b.token)):""}H3i(b){return this.lV.GOd&&this.UQb&&1===b.errorType&&(2===b.proofingType||3===b.proofingType)}y0b(b){return!!b.errorType&&
!!this.nbd&&this.nbd.contains(b.token,b.lcid)}sLh(b){return""===b?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):b}rLh(b){return""!==b?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,b):""}hqh(b){let h="";if(b){let n;for(n=0;n<b.length-1;n++)h=h+b.charAt(n)+",";h+=b.charAt(n)}return h}}Object(r.a)(cz,"EditorServiceProofingContextMenuCreator",null,[]);class nj{get ranking(){return[24,23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,36,25,26,
27,28,29,30,31,32,33,34,35,37,40,41,42,43,44,45,46]}}Object(r.a)(nj,"BusinessBarRankProvider",null,[256]);class tu{constructor(){this.W=null}get name(){return"Wonca.UI"}zc(b){this.W=b;b.ha("CommonUI.IBusinessBarRankProvider",()=>new nj).singleInstance();Uz.DAk(b,new se.a(()=>ob.App.xa.Oda));b.ha("Box4.UI.EditorServiceProofingContextMenuCreator",()=>new cz(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.Proofing.IIgnoreAllKeywords"),
u.AFrameworkApplication.bQ,u.AFrameworkApplication.mr,u.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),b.resolve("Box4.IFormattingReader"))).singleInstance();b.ha("CommandUI.ReactRootManager",()=>Yu.instance).as("Common.IReactRootManager").singleInstance()}init(){this.W.resolve("Wonca.IRibbonUserFactory");this.W.resolve("CommonUI.IBusinessBar")}dispose(){}static main(){N.a.instance.Pc(new tu)}}Object(r.a)(tu,"WoncaUIPackage",null,[1,2]);class Xv{constructor(b){this.GM=this.Nrc=null;this.ml=
b}get key(){return"BOOKMARK"}get hw(){return WordEditorIntl.WordEditorStrings.L_Bookmark}get $ja(){return this.GM}reset(b){this.GM=b.node}DEa(b){let h=null;u.AFrameworkApplication.Hf("bookmarks-core-ex;bookmarks-core-ex-cf");if(u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)){if(this.Nrc&&this.ml.pof(b,this.$ja,this.Nrc))return h=Object.assign(new zt.a,{IF:this.key,contentObject:this.Nrc}),{returnValue:!0,KE:h};this.Nrc=
null;if(!this.$ja.hasBookmark)return{returnValue:!1,KE:h};const n=new md.GraphIterator;n.set(this.$ja.Bi());this.ml.i9b(n);if(this.ml.S9h(n)){let x=n.Wd();for(;x;){if(this.ml.pof(b,this.$ja,x))return this.Nrc=x,h=Object.assign(new zt.a,{IF:this.key,contentObject:x,description:this.Zcb()}),{returnValue:!0,KE:h};x=n.xj()}}}return{returnValue:!1,KE:h}}Zcb(){return null}}Object(r.a)(Xv,"BookmarkDetailsProvider",null,[226,227]);class pv{constructor(b,h,n,x,E=null){this.hIg=this.zh=!1;this.tfd=this.HSb=
null;this.yui=(S,ma)=>{S=ma.node;1074135152!==S.Qc?w.ULS.sendTraceTag(24155018,324,10,"node.RuntimeClassId = {0}",S.Qc):(w.ULS.sendTraceTag(24155019,324,50,"OnBookmarkContainerNodeLoaded: Refreshing out of date bookmarks"),this.Kzd(!0))};this.aB=n;this.Ih=x;this.px=h;this.yug=b;this.UA=E}get Py(){return this.px.value}initialize(){this.KPf();this.zh=!0}Kzd(b=!1){if(!this.zh)return w.ULS.sendTraceTag(24262273,324,10,"BookmarkGraphManager not initialized"),!1;if(!b&&this.hIg)return!0;let h=!1;this.Ih.Pd(()=>
{this.HSb={};this.tfd={};if(this.Py){const n=new md.GraphIterator;n.set(this.Py);if(this.YHm(n)){if(n.Rb(1)){do this.$1j(n.currentNode);while(n.wf(1))}h=this.hIg=!0}}},"BGM:EBGL");return h}iLh(b){var h,n,x,E;if(!this.Kzd())return null;const S=new Qa.a;if(b.toString()in this.HSb){const ma=this.HSb[b.toString()];for(let Fa of ma)this.UA.vja.has(null===(h=Fa.id)||void 0===h?void 0:h.toString())&&this.UA.vja.get(null===(n=Fa.id)||void 0===n?void 0:n.toString()).equals(b)&&this.UA.kVa.has(null===(x=Fa.id)||
void 0===x?void 0:x.toString())&&this.UA.kVa.get(null===(E=Fa.id)||void 0===E?void 0:E.toString()).equals(b)?S.add(Fa):w.ULS.sendTraceTag(24155015,324,100,"GetBookmarksInParagraph: bookmarkNode does not have same paragraph for start and end value (shouldn't happen for TOC)")}return S}fea(b){return this.Kzd()?b in this.tfd?this.tfd[b]:null:null}dispose(){this.zh?this.Eco():w.ULS.sendTraceTag(24262275,324,50,"BookmarkGraphManager not initialized")}YHm(b){if(this.aB.tQ(b))return(b=b.Rb(30))||w.ULS.sendTraceTag(24691921,
324,10,"Graph does not contain BookmarkContainer"),b;w.ULS.sendTraceTag(24691922,324,15,"Unable to move to Page Manifest");return null}KPf(){w.ULS.sendTraceTag(24691923,324,50,"Registering OnBookmarkContainerNodeLoaded");this.yug.b9g(this.yui)}Eco(){w.ULS.sendTraceTag(24691924,324,50,"Unregistering OnBookmarkContainerNodeLoaded");this.yug.zNi(this.yui)}$1j(b){var h,n,x,E;b?(this.b7g(null!==(n=this.UA.vja.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==n?n:C.a.nil,b),this.b7g(null!==
(E=this.UA.kVa.get(null===(x=b.id)||void 0===x?void 0:x.toString()))&&void 0!==E?E:C.a.nil,b),(h=b.properties.ia(ic.a.Rs,null))&&(this.tfd[h]=b)):w.ULS.sendTraceTag(24155022,324,50,"Node is null")}b7g(b,h){b===C.a.nil?w.ULS.sendTraceTag(24155023,324,50,"paraNodeId is null"):(b=b.toString(),b in this.HSb||(this.HSb[b]=new Qa.a),b=this.HSb[b],b.contains(h)||b.add(h))}}Object(r.a)(pv,"BookmarkGraphManager",null,[483]);class at{constructor(b,h){this.q9=b;this.Evj=h}get vHb(){return this.Evj}}Object(r.a)(at,
"FoundBookmarkRangeObject",null,[303]);class Yv{constructor(b,h=null){this.HQa=b;this.Pvd={};this.e_b={};this.UA=h}s0a(b,h){if(b=this.HQa.iLh(h.node.id)){w.ULS.sendTraceTag(24462027,3029,50,String.format("Removing {0} bookmarks from paraId {1}",b.count,h.node.id));for(let n of b)n.id.toString()in this.Pvd&&(h=this.Pvd[n.id.toString()],h.id.toString()in this.e_b?b=this.e_b[h.id.toString()]:(b=new Qa.a,this.e_b[h.id.toString()]=b),b.add(n),delete this.Pvd[n.id.toString()])}else w.ULS.sendTraceTag(24691925,
3029,50,"Failed to get bookmarks on paragraph deletion")}SSc(b,h){if(b=this.HQa.iLh(h.original.id))for(let n of b)this.Pvd[n.id.toString()]=h.clone;else w.ULS.sendTraceTag(24691926,3029,50,"Failed to get bookmarks on paragraph copy")}USc(b,h){var n,x;if(h.original.id.toString()in this.e_b){b=this.e_b[h.original.id.toString()];for(let E of b)this.UA.vja.set(null===(n=E.id)||void 0===n?void 0:n.toString(),h.clone.id),this.UA.kVa.set(null===(x=E.id)||void 0===x?void 0:x.toString(),h.clone.id);delete this.e_b[h.original.id.toString()];
w.ULS.sendTraceTag(24691927,3029,50,"OnParagraphPaste: Refreshing out of date bookmarks");this.HQa.Kzd(!0)}}kxi(){w.ULS.sendTraceTag(36820239,3029,10,"New Interface Not Implemented!")}ppd(){w.ULS.sendTraceTag(36471763,3029,10,"New Interface Not Implemented!");return!1}$Vb(){w.ULS.sendTraceTag(591730835,3029,10,"New Interface Not Implemented!");return!1}nVd(){w.ULS.sendTraceTag(36209185,3029,10,"New Interface Not Implemented!")}fea(){w.ULS.sendTraceTag(34936480,3029,10,"New interface not implemented");
return null}Pcb(){w.ULS.sendTraceTag(34936481,3029,10,"New interface not implemented");return null}Kka(){w.ULS.sendTraceTag(35992273,3029,10,"New Interface Not Implemented!");return new at(null,2)}mGf(){w.ULS.sendTraceTag(35992274,3029,10,"New interface not implemented")}xbc(){w.ULS.sendTraceTag(573673489,3029,10,"New interface not implemented")}qGc(){w.ULS.sendTraceTag(559228954,3029,10,"getAllBookmarks not implemented");return null}bph(){w.ULS.sendTraceTag(524321507,3029,10,"containsBookmark not implemented");
return!1}qQf(){w.ULS.sendTraceTag(559228956,3029,10,"removeBookmark not implemented");return!1}Zef(){w.ULS.sendTraceTag(553951760,3029,10,"getParaNodesFromBookmarkName not implemented");return null}hLh(){w.ULS.sendTraceTag(544814809,3029,10,"getBookmarkNameForHeading not implemented");return null}Zhf(){w.ULS.sendTraceTag(544777299,3029,10,"goToBookmark not implemented")}jHc(){w.ULS.sendTraceTag(545118154,3029,10,"getEnclosingBookmark not implemented");return null}i9b(){w.ULS.sendTraceTag(540382879,
3029,10,"moveToBookmarkContainer not implemented");return null}S9h(){w.ULS.sendTraceTag(540382880,3029,10,"isBookmarkContainer not implemented");return null}lej(){w.ULS.sendTraceTag(525133728,3029,10,"updateBookmarkNameOnly not implemented");return!1}KYd(){w.ULS.sendTraceTag(523106501,3029,10,"paragraphContainsAnyBookmarks not implemented");return!1}naf(){w.ULS.sendTraceTag(523106502,3029,10,"getBookmarksFromParagraph not implemented");return null}laf(){w.ULS.sendTraceTag(522735619,3029,10,"getBookmarkRangeOnly not implemented");
return null}$ef(){w.ULS.sendTraceTag(522735620,3029,10,"getParagraphContainingGivenBookmarkAnchors not implemented");return null}pof(){w.ULS.sendTraceTag(521462493,3029,10,"isCpInsideBookmark not implemented");return!1}}Object(r.a)(Yv,"BookmarkManager",null,[254]);var Cx=d(782),py=d(1081);class Dx{create(){return new py.a}}Object(r.a)(Dx,"BookmarkContainerNodeFactory",null,[200]);class qy{constructor(b,h,n,x=null){this.kxi=(E,S)=>{this.ml.mGf(S)};this.SSc=(E,S)=>{var ma=this.NFh(S.clone);E=S.original.Nc;
const Fa=new Jc.a;for(let $a of ma)ma=$a.kn.toString(),Fa.xb(ma)||(Fa.add(ma,!0),(ma=E.Eb($a.kn))&&!ma.anchor&&(ma=this.ml.Pcb($a.kn)),ma?ma.anchor?this.sEk(ma,S.clone):w.ULS.sendTraceTag(573673488,324,15,String.format("BookmarkNode ObjId:{0} Id:{1} as no anchor",ma.id,ma.ia(ic.a.Bvb,-1))):w.ULS.sendTraceTag(573673487,324,15,"BookmarkNode null"))};this.USc=(E,S)=>{E=S.clone;S=this.NFh(E);this.ml.xbc(E,S)};this.Gw=h;this.ml=n;this.tvj=x||new Dx}init(){Cx.a.Rhn(Object(v.a)(this.ml,this.ml.nVd,"onAfterFullBookmarkRangeDeleted"));
this.Gw.$Ne(this.kxi);bk.hqd(this.SSc);bk.Jxc(this.USc)}NFh(b){const h=new Qa.a;for(let n=0;n<b.qa.length;n++){const x=b.qa.J(n);if(x.Lh)for(let E=0;E<x.Lh.length;E++)h.add(x.Lh.J(E))}return h}sEk(b,h){var n=h.Bi().Ad;n=Fn.a(b,n,!0);h=md.GraphIterator.$a(h);this.f0k(h);h.Rb(30);h.d1(n,1,b.id);h.Ci(n)}f0k(b){if(b.Bb(25)&&b.kd(25)&&!b.Zp(30)){const h=this.tvj.create(1074135152);b.Sf(h,30)}}}Object(r.a)(qy,"BookmarksEventHandler",null,[]);var Pq=d(291),Qt=d(478),Qq=d(1141),bt=d(145),ry=d(1012);class BA{create(){return new ry.a}}
Object(r.a)(BA,"BookmarkNodeFactory",null,[200]);class CA{constructor(b,h,n,x,E,S,ma,Fa=null,$a,sb=null){this.D0="_";this.Bug=40;this.wUj=" ";this.px=b;this.aB=h;this.Vd=n;this.nwe=x;this.Hc=E;this.fb=S;this.hb=ma;this.Dvj=Fa||new BA;this.UA=sb}pIc(b,h){return b?this.UA.vja.get(null===h||void 0===h?void 0:h.toString()):this.UA.kVa.get(null===h||void 0===h?void 0:h.toString())}get Py(){return this.px.value}get gFa(){return this.nwe.value}ppd(b,h){if(!h||!h.Qa||!h.Tc)return w.ULS.sendTraceTag(36471765,
3029,15,"There is no selection"),!1;const n=h.Qa.node,x=h.Tc.node,E=Pq.a.$cb(h,!0);h=Pq.a.$cb(h,!1);return this.$Vb(b,E,h,n,x)}$Vb(b,h,n,x,E,S=!1){w.ULS.sendTraceTag(545642374,3029,50,String.format("removeExisting value is: {0}",S));const ma=this.fea(b);if(ma)if(S)this.vLi(ma);else return w.ULS.sendTraceTag(36471764,3029,50,"Unable to add bookmark because name already exists"),!1;if(!x||!E)return w.ULS.sendTraceTag(591730833,3029,50,"Missing Paragraph info while adding bookmark"),!1;S=this.Hc.Rc(15);
S.Db(this.gFa);b=this.E_j(b);if(!b)return!1;this.A_j(x,h,b,E,n);S.dispose();return!0}fea(b){w.ULS.shipAssertTag(34936482,3029,!!b);return this.QFh(h=>b===h.properties.ia(ic.a.Rs,null))}Pcb(b){return b&&b!==C.a.nil?this.QFh(h=>b.equals(h.id)):(w.ULS.sendTraceTag(543424735,3029,10,"Unable to find BookmarkNode when node id is null"),null)}nVd(b){const h=this.Pcb(b);h?(w.ULS.sendTraceTag(36844636,3029,50,String.format("Removing bookmark {0}",b.toString())),this.uLi(h),this.KWc(h)):w.ULS.sendTraceTag(36569436,
3029,15,"Unable to find BookmarkNode for full bookmark range deletion")}Kka(b,h){var n;const x=null!==(n=this.pIc(h,b.id))&&void 0!==n?n:C.a.nil;if(x===C.a.nil)return w.ULS.sendTraceTag(36218377,3029,10,"ParaId not on Bookmark"),new at(null,2);n=this.Py.Ad.Eb(x);return n?n.isConnected?this.getBookmarkRange(n,b,h):(w.ULS.sendTraceTag(36766421,3029,50,"Paragraph not loaded"),new at(null,3)):(w.ULS.sendTraceTag(36766420,3029,10,"Unable to get paragraph from object space"),new at(null,2))}mGf(b){const h=
this.q8k(b);h[Symbol.iterator]().next().done||this.VHm(b,h)}xbc(b,h){const n=new Qa.a;let x=0,E=!1;for(let S of h)S&&S.Ob.Lh?(x++,S.Ob.Lh.remove(S),0<=S.Fe&&S.Fe<b.wordRunProperties.length&&(S.Ob.cp||(E=!0),n.add(S.Fe))):w.ULS.sendTraceTag(36569441,3029,15,"BookmarkRangeObject to remove is null");b.cga(!0,n);w.ULS.sendTraceTag(36844637,3029,50,String.format("Removed {0} bookmark anchors | idsToRemove: {1}",x,n.count));E&&!b.wordRunProperties.length&&b.wordRunProperties.append(ws.CharacterPropertiesEditor.wQ,
1024)}qGc(b=!1){w.ULS.sendTraceTag(559228943,3029,50,"Fetching bookmarks with includeHidden: {0}",b);const h=new Qa.a,n=md.GraphIterator.$a(this.Py);if(null!==this.i9b(n)){var x=n.Hp();w.ULS.sendTraceTag(559228944,3029,50,"Bookmarks count: {0}",x);if(0<x)for(x=n.Wd();null!==x;){let E=x.ia(ic.a.Rs,"");B.a.nf(E)||(b?h.add(x):E.startsWith(this.D0)||h.add(x));x=n.xj()}}!b&&0<h.count&&w.ULS.sendTraceTag(556889755,3029,50,"User Bookmarks count: {0}",h.count);return h}bph(b=!1){w.ULS.sendTraceTag(524321506,
3029,50,"Finding bookmarks with includeHidden: {0}",b);const h=md.GraphIterator.$a(this.Py);if(null!==this.i9b(h)&&0<h.Hp()){var n=h.Wd();if(b&&n)return!0;for(;null!==n;){n=n.ia(ic.a.Rs,"");if(!B.a.nf(n)&&(b||!n.startsWith(this.D0)))return!0;n=h.xj()}}return!1}Zef(b){var h=this.fea(b);let n=new Qa.a;if(h){b=this.pIc(!0,h.id);h=this.pIc(!1,h.id);var x=this.Py.Ad.Eb(b);x&&n.add(x);if(b.equals(h))return n;b=x;do(b=x=this.fb.Vg(b,!1,!1,!0))&&n.add(x);while(x&&!x.id.equals(h))}else w.ULS.sendTraceTag(553927448,
3029,10,"bookmark not exist with the {0}",b);return n}qQf(b){if(null===b)return w.ULS.sendTraceTag(559228951,3029,50,"Cannot remove bookmark as id is null"),!1;b=this.Pcb(b);return this.vLi(b)}hLh(b){let h="",n=b.id;b=b.characterData.split(this.wUj);for(let x=0;3>x&&x<b.length;x++)h+=this.D0+b[x];h.length>this.Bug&&(h=h.substring(0,this.Bug));return this.$lj(h,n)}$lj(b,h){const n=this.qGc(!0);let x=[],E;for(let ma=0;ma<n.count;ma++){var S=n.J(ma);E=S.ia(ic.a.Rs,"");S=this.pIc(!0,S.id);E.startsWith(b)&&
!h.equals(S)&&x.push(E)}return 0<x.length?(x.sort((ma,Fa)=>ma.localeCompare(Fa,void 0,{numeric:!0})),(h=x[x.length-1].substring(b.length+1))?b+this.D0+(parseInt(h)+1):b+this.D0+1):b}Zhf(b){B.a.nf(b)?w.ULS.sendTraceTag(544777296,3029,10,"Cannot navigate to bookmark as name is null"):(b=this.fea(b),null===b?w.ULS.sendTraceTag(544777297,3029,10,"No bookmark with given name exists"):(b=this.Kka(b,!0))?(b=Ae.SelectionFactory.xe(b.q9.paragraph,b.q9.Ob.cp))&&this.hb.setSelection(b):w.ULS.sendTraceTag(544777298,
3029,10,"No start found for bookmark. Document is corrupted"))}vLi(b){if(!b)return w.ULS.sendTraceTag(559228888,3029,15,"Could not find bookmark node with given id"),!1;w.ULS.sendTraceTag(559228889,3029,50,String.format("Removing bookmark {0}",b.id));const h=this.Hc.Rc(15);h.Db(this.gFa);this.uLi(b);this.KWc(b);h.dispose();return!0}jHc(b,h){if(!b||0>h)return w.ULS.sendTraceTag(545118153,3029,10,String.format("Got null paragraph or negative cp value")),null;let n=null,x=new Qa.a,E=new Qa.a;var S=b.qa;
for(var ma=0;ma<S.length;ma++){var Fa=S.J(ma);if(Fa.cp>h||Fa.cp===h&&0<x.count)break;if(Fa.Lh){var $a=Fa.Lh;if(2===$a.length&&$a.J(0).kn.equals($a.J(1).kn)&&Fa.cp===h){x.add($a.J(0).kn.toString());break}for(let sb=0,Jb=$a.length;sb<Jb;sb++){Fa=$a.J(sb);const Sb=b.Nc.Eb(Fa.kn).ia(ic.a.Rs,"");B.a.nf(Sb)||Sb.startsWith(this.D0)||(Fa.Oc?x.add(Fa.kn.toString()):x.contains(Fa.kn.toString())?x.remove(Fa.kn.toString()):E.add(Fa.kn.toString()))}}}0<x.count&&(n=b.Nc.Eb(C.a.Of(x.J(x.count-1))));if(!n)for(h=
Cd.ParagraphReader.Vg(b,!0);h&&!n;){for(S=0;S<h.qa.length;S++)if(ma=h.qa.J(S),ma.Lh){ma=ma.Lh;for(let sb=0,Jb=ma.length;sb<Jb;sb++)$a=ma.J(sb),Fa=b.Nc.Eb($a.kn).ia(ic.a.Rs,""),B.a.nf(Fa)||Fa.startsWith(this.D0)||($a.Oc?E.contains($a.kn.toString())?E.remove($a.kn.toString()):x.add($a.kn.toString()):x.contains($a.kn.toString())?x.remove($a.kn.toString()):E.add($a.kn.toString()))}0<x.count?n=h.Nc.Eb(C.a.Of(x.J(x.count-1))):h=Cd.ParagraphReader.Vg(h,!0)}return n}lej(b,h){if(null===b)return w.ULS.sendTraceTag(525111647,
3029,10,"Bookmark node is null"),!1;if(this.e8l(h)||this.OXk(h))return!1;const n=this.Hc.Rc(15);n.Db(this.gFa);this.leo(b,h);n.dispose();return!0}QFh(b){if(!this.Py)return w.ULS.sendTraceTag(34936483,3029,10,"PageNode is null"),null;const h=new md.GraphIterator;h.set(this.Py);if(!this.i9b(h))return w.ULS.sendTraceTag(34936512,3029,10,"Unable to move to BookmarkContainer"),null;if(!h.Rb(1))return null;do{const n=h.currentNode;if(b(n))return n}while(h.wf(1));return null}getBookmarkRange(b,h,n){for(let x=
0;x<b.qa.length;x++){const E=b.qa.J(x);if(E.Lh)for(let S=0;S<E.Lh.length;S++){const ma=E.Lh.J(S);if(ma.kn.equals(h.id)&&n===ma.Oc)return new at(ma,0)}}w.ULS.sendTraceTag(36729310,3029,15,"paragraph {0} did not contain bookmarkNode id:{1}, isStart: {2} ({3}), had {4} chps | Path: {5}",b.id,h.ia(ic.a.Bvb,-1),n,h.id,b.qa.length,this.VJ(b));return new at(null,1)}i9b(b){if(this.aB.tQ(b))return b=b.Rb(30),w.ULS.shipAssertTag(34936513,3029,!!b,"Graph does not contain BookmarkContainer"),b;w.ULS.sendTraceTag(34936514,
3029,15,"Unable to move to Page Manifest");return null}q8k(b){const h=new Jc.a;for(let n=0;n<b.qa.length;n++){const x=b.qa.J(n);if(x.Lh)for(let E=0;E<x.Lh.length;E++){const S=x.Lh.J(E),ma=S.kn.toString();h.xb(ma)?(w.ULS.shipAssertTag(36218379,3029,S.Oc!==h.J(ma).Oc),h.remove(ma)):h.add(ma,S)}}return h.values}VHm(b,h){this.xbc(b,h);this.BHm(b,h)}BHm(b,h){let n=Cd.ParagraphReader.Vg(b,!1,!0);b=Cd.ParagraphReader.Vg(b,!0,!0);n||b?(n||this.Beh(h,!0)&&w.ULS.sendTraceTag(36320843,3029,15,"No next paragraph but have start bookmarks to move, falling back to prev paragraph."),
b||this.Beh(h,!1)&&w.ULS.sendTraceTag(36320844,3029,15,"No prev paragraph but have end bookmarks to move, falling back to next paragraph."),n=n||b,b=b||n,this.kqi(n,h,0,!0),this.kqi(b,h,b.qa.last.cp,!1)):w.ULS.sendTraceTag(36218381,3029,15,"Both paragraphs are null.")}Beh(b,h){for(let n of b)if(h===n.Oc)return!0;return!1}kqi(b,h,n,x){const E=new Qa.a;n=this.Haf(b,n);for(let S of h)S.Oc===x&&(n?(h=this.G_j(b,x,n,S.kn))&&E.add(h):w.ULS.shipAssertTag(36218382,3029,!0,"Null chp. isStart={0}",x));E.count&&
(b.qn(),this.P7f(b,E),w.ULS.sendTraceTag(36844638,3029,50,String.format("Added {0} bookmark anchors | isStart: {1}",E.count,x)))}G_j(b,h,n,x){const E=this.Pcb(x);return E?this.sMe(b,h,n,E):(w.ULS.sendTraceTag(40445218,3029,15,String.format("BookmarkNode {0} null while trying to add range",x)),null)}sMe(b,h,n,x){var E;if(!x)return w.ULS.sendTraceTag(591730834,3029,10,String.format("BookmarkNode null while trying to add range")),null;if(!n)return w.ULS.sendTraceTag(543424736,3029,10,String.format("Chp null while trying to add range")),
null;n.Lh||(n.Lh=new Qt.a(n));const S=new Qq.a(n,null,x.id,h);n.Lh.add(S);(h?this.UA.vja:this.UA.kVa).set(null===(E=x.id)||void 0===E?void 0:E.toString(),b.id);return S}P7f(b,h){if(h){w.ULS.sendTraceTag(36218384,3029,50,"BookmarksToUpdate.Count:{0}",h.count);h.Sc((n,x)=>n.Fe-x.Fe);for(let n=0;n<h.count;n++){const x=h.J(n);x.Fe?b.wordRunProperties.xZ(x.Fe-1,1024):b.wordRunProperties.bta(x.Fe,1024);b.wordRunProperties.Fq.Z(x.Fe,ws.CharacterPropertiesEditor.wQ);b.wordRunProperties.Zs.Z(x.Fe,ws.CharacterPropertiesEditor.QT)}}else w.ULS.shipAssertTag(36218383,
3029,!1,"Null BookmarksToUpdate.")}Haf(b,h){if(!b||!b.qa||!b.qa.last)return null;w.ULS.shipAssertTag(36471766,3029,h<=b.qa.last.cp,"Cp to split at greater than last Chp.Cp in paragraph");if(b.qa.last.cp===h){var n=b.qa.length-1;if(!b.qa.J(n).formatting)for(var x=n-1;0<=x;x--){var E=b.qa.J(x);if(E.formatting){this.Vd.GX(b,n,h,E.formatting);break}}return b.qa.last}n=null;for(x=0;x<b.qa.length;x++){E=b.qa.J(x);if(E.cp>=h){if(E.cp>h||!E.formatting)this.Vd.GX(b,x,h,n),E=b.qa.J(x);E.Lh||(E.Lh=new Qt.a(E));
w.ULS.shipAssertTag(36471768,3029,E!==b.qa.last);return E}E.formatting&&(n=E.formatting)}return null}E_j(b){const h=new md.GraphIterator;h.set(this.Py);if(!this.i9b(h))return w.ULS.sendTraceTag(36471769,3029,10,"Unable to move to BookmarkContainer"),null;b=this.$Fk(b);h.d1(b,1,null);h.Ci(b);return b}$Fk(b){const h=this.Dvj.create(1074135153);h.setValue(ic.a.Rs,b);h.setValue(ic.a.Bvb,Ub.a.JF());return h}KWc(b){if(b&&b.anchor){w.ULS.sendTraceTag(36729311,3029,100,"Removed bookmark with id:{0}, ({1})",
b.ia(ic.a.Bvb,-1),b.id);var h=new md.GraphIterator;h.set(b);h.Bb(64);h.Fg()}}VJ(b){const h=[];let n=0;for(;b.anchor.Gp&&7!==b.type;)h[n]=bt.a[b.type],b=b.anchor.Gp.vr.node,n++;h[n]=bt.a[b.type];return h.join(" ")}leo(b,h){b.setValue(ic.a.Rs,h)}uLi(b){const h=this.Kka(b,!0).q9;b=this.Kka(b,!1).q9;if(h&&b&&h.paragraph===b.paragraph){let n;this.xbc(h.paragraph,(n=new Qa.a,n.add(h),n.add(b),n))}else{if(h){let n;this.xbc(h.paragraph,(n=new Qa.a,n.add(h),n))}if(b){let n;this.xbc(b.paragraph,(n=new Qa.a,
n.add(b),n))}}}A_j(b,h,n,x,E){if(h=this.sMe(b,!0,this.Haf(b,h),n)){b.qn();var S;this.P7f(b,(S=new Qa.a,S.add(h),S));(n=this.sMe(x,!1,this.Haf(x,E),n))?(x.qn(),this.P7f(b,(S=new Qa.a,S.add(n),S))):w.ULS.sendTraceTag(520646733,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark end range is null")}else w.ULS.sendTraceTag(520646734,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark start range is null")}$ef(b,h){var n;if(!b)return null;h=null!==(n=this.pIc(h,b.id))&&
void 0!==n?n:C.a.nil;return b.Nc.Eb(h)?b.Nc.Eb(h):null}S9h(b){return!!b&&64===b.Se}KYd(b,h){var n;if(0===b.w7)return!1;for(let x=0;x<(null===(n=b.qa)||void 0===n?void 0:n.length);x++){const E=b.qa.J(x);if(null!=E.Lh)for(let S=0;S<E.Lh.length;S++){const ma=E.Lh.J(S),Fa=b.Nc.Eb(ma.kn).JKa();if(!B.a.nf(Fa)&&(!Fa.startsWith(this.D0)||h)&&ma.Oc)return!0}}return!1}naf(b,h){var n;let x=[];if(0===b.w7)return x;for(let E=0;E<(null===(n=b.qa)||void 0===n?void 0:n.length);E++){const S=b.qa.J(E);if(null!=S.Lh)for(let ma=
0;ma<S.Lh.length;ma++){const Fa=S.Lh.J(ma),$a=b.Nc.Eb(Fa.kn),sb=$a.JKa();B.a.nf(sb)||sb.startsWith(this.D0)&&!h||!Fa.Oc||x.push($a)}}return x}SSn(b){return b.ia(ic.a.AF,!1)}e8l(b){return B.a.nf(b)?(w.ULS.sendTraceTag(559228948,3029,50,"bookmark name is null or empty"),!0):!1}OXk(b){return null!==this.fea(b)?(w.ULS.sendTraceTag(559228949,3029,50,"Not updating bookmark name as a bookmark node with same name exists."),!0):!1}laf(b,h,n){return this.getBookmarkRange(b,h,n).q9}pof(b,h,n){if(this.SSn(n)||
this.jcm(n))return!1;const x=this.$ef(n,!0),E=this.$ef(n,!1);if(x&&E&&this.fb.QNc(h,x,E)){if(h!==x&&h!==E)return!0;const S=this.laf(x,n,!0);if(S&&(x!==h||S.Ob.cp<=b)&&(n=this.laf(E,n,!1))&&(E!==h||n.Ob.cp>=b))return!0}return!1}jcm(b){b=null===b||void 0===b?void 0:b.ia(ic.a.Rs,"");return!B.a.nf(b)&&b.startsWith(this.D0)?!0:!1}}Object(r.a)(CA,"FullBookmarkManager",null,[254]);class DA{constructor(){this.HQa=this.Dm=this.W=null}get name(){return"WordEditor.Bookmark"}zc(b){this.W=b;this.Dm=this.W.resolve("Box4.INotebookManager").al;
const h=new CA(new se.a(()=>ob.App.xa.jb.Zc),ql.PageNavigator.instance,this.W.resolve("Box4.ICharacterPropertiesEditor"),new se.a(()=>ob.App.xa.jb.Jc.ud),Zm.a.instance,this.W.resolve("Box4.IParagraphReader"),this.W.resolve("Box4.SelectionManager"),null,null,this.W.resolve("Box4.BookmarkParagraphMapping"));this.W.ha("WordEditor.Bookmark.FullBookmarkManager",()=>h).as("WordEditor.Bookmark.IBookmarkManager").singleInstance();this.W.ha("WordEditor.Bookmark.BookmarksEventHandler",()=>new qy(this.Dm.Te(12),
this.W.resolve("WordEditor.ITableEditor"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).singleInstance();Kb.App.Oce&&(this.HQa=new pv(this.Dm.Te(64),new se.a(()=>ob.App.xa.jb.Zc),ql.PageNavigator.instance,oo.a.instance,this.W.resolve("Box4.BookmarkParagraphMapping")),this.W.ha("WordEditor.Bookmark.BookmarkGraphManager",()=>this.HQa).as("WordEditor.Bookmark.IBookmarkGraphManager").singleInstance())}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Nm()})}dispose(){this.HQa.dispose()}Nm(){w.ULS.sendTraceTag(36209186,
324,50,"Registering paragraph events");if(Kb.App.Kce)this.W.resolve("WordEditor.Bookmark.BookmarksEventHandler").init();else if(Kb.App.Oce){this.HQa.initialize();const b=new Yv(this.HQa,this.W.resolve("Box4.BookmarkParagraphMapping"));this.Dm.Te(12).xv(Object(v.a)(b,b.s0a,"onParagraphDelete"));bk.hqd(Object(v.a)(b,b.SSc,"onParagraphCopy"));bk.Jxc(Object(v.a)(b,b.USc,"onParagraphPaste"))}w.ULS.sendTraceTag(24691930,324,50,"Finish registering paragraph events");this.Whn(this.W.Za("Box4.Accessibility.IAccessibilityContextManager"),
this.W.resolve("WordEditor.Bookmark.FullBookmarkManager"))}Whn(b,h){b&&b.execute(n=>{n.a3(new Xv(h))})}static main(){N.a.instance.Pc(new DA)}}Object(r.a)(DA,"BookmarkPackage",null,[1,2]);var AC=d(852),Jw=d(1005),Wz=d(1504),Rt=d(1375);class Kw extends Rt.a{constructor(b){super();this.qXj=b}get index(){return 3}run(){this.qXj()}bH(){this.kX()}}Object(r.a)(Kw,"FootnoteEndnoteGraphUpdateTracker",Rt.a,[]);class EA{constructor(){this.tad=null}get name(){return"WordEditor.FootnoteEndnoteInteractive"}zc(){}init(){EA.Pb.Yk.continueWith(()=>
{this.Nm()})}Nm(){AC.a.tcb=Wz.a.instance;this.ekf()}dispose(){}ekf(){this.tad=new Kw(()=>{Wz.a.instance.mu()});Jw.a.P1d(Object(v.a)(this.tad,this.tad.bH,"setUpdateNeeded"));xj.GraphTransactionManager.instance.yna(this.tad,3)}static get Pb(){return Oa.a.instance.resolve("Box4.IFeatureHelper")}}Object(r.a)(EA,"PackageManager",null,[1,2]);var Wo=d(752),Lw=d(540),dz=d(492),ez=d(1586);class uu extends pq{constructor(){super()}get hw(){return null}getTitle(b){b=b.aLa();if(!b||!Lw.a.instance.Ila(b))return"";
const h=new Sys.StringBuilder,n=Lw.a.instance.b6(b);h.append(1===n?WordEditorIntl.WordEditorStrings.l_FootnoteContentTitle:WordEditorIntl.WordEditorStrings.l_EndnoteContentTitle);h.append(" ");h.append(Lw.a.instance.Jzb(b));return h.toString()}}Object(r.a)(uu,"FootnoteEndnoteBaseDetailsProvider",pq,[]);class JB extends uu{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE"}get ri(){return 7}}Object(r.a)(JB,"FootnoteEndnoteDetailsProvider",uu,[]);var FA=d(1547),Mw=d(1563),oj=d(1623);class Ex extends uu{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE_REFMARK"}get ri(){return 10}}
Object(r.a)(Ex,"FootnoteEndnoteRefMarkDetailsProvider",uu,[]);class Fx{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd,Gd,vd,ce){this.k7h=(od,Yd,ne,Df,Af)=>{Df=Yd.view;if(!Df.features.i9d||this.kC.M$h)return 8;const Wi=Df.Cb.Rg;if(!Wi)return 2;if(this.Ok.bZ(Wi))return 8;Df=od===ub.a.insertFootnote?1:0;var gm=this.wDd(Yd);if(!gm)return w.ULS.sendTraceTag(3683158,308,10,"We expected a selection here."),8;Yd=!0;gm=gm.Qa;Af&&Af.L6b&&Af.JBa&&(gm=Af.JBa,Yd=!Af.keepCurrentFocus);if(1===ne&&Ee.a.Jla(Wi)||
!gm||!Kd.SelectionEditor.xf(gm)||this.Bxg.instance&&this.Bxg.instance.pdm(gm)||nh.HyperlinkReader.Lla(gm,!0))return 8;if(1===ne)return 32;2===ne&&(ne=this.sV.fg("UserAction","InsertFootnoteEndnote"),od=this.rCj.V3l(gm,Df,od),Af&&Af.L6b&&(Af.Dsi=od),Yd&&this.OXd(od,!0,!0),ne.stop(),this.Hd.us(6));return 32};this.u9b=(od,Yd,ne)=>{const Df=Yd.view;if(od===ub.a.skb||od===ub.a.TJb){if(!Df.features.i9d)return 8}else if(!Df.features.Y1f)return 8;if(!Df.Cb.Rg)return 2;Yd=this.X2b(Yd);return Yd?od!==ub.a.skb&&
od!==ub.a.TJb||this.DGa.eUl(Yd.node,od===ub.a.skb?1:0)?1===ne?32:2===ne&&32===this.ga.Xb(ub.a.L9,2,!0)?(this.ga.Xb(ub.a.gri,2,od),32):8:8:2};this.Qal=(od,Yd,ne,Df,Af)=>{if(1===ne)return 32;if(2===ne){od=this.zGl(Yd);if(!od)return 8;ne=Yd=null;switch(Af){case ub.a.GBf:ne=od.Tc;Yd=this.SPb.aId(ne,1);break;case ub.a.FBf:ne=od.Tc;Yd=this.SPb.aId(ne,0);break;case ub.a.IBf:ne=od.Qa;Yd=this.SPb.x0h(ne,1);break;case ub.a.HBf:ne=od.Qa;Yd=this.SPb.x0h(ne,0);break;case ub.a.skb:ne=od.Qa;(Yd=this.SPb.aId(ne,
1,!0))||(Yd=this.DGa.fPh(ne.node,1));break;case ub.a.TJb:ne=od.Qa,(Yd=this.SPb.aId(ne,0,!0))||(Yd=this.DGa.fPh(ne.node,0))}if(Yd)this.OXd(Yd);else{if(!this.mt.Jc)return 8;(Af=Ad.d(ne.node,ne.cpBegin))&&7===Af.ri&&this.DGa.rUi(Af)}}return 32};this.bVn=(od,Yd,ne,Df,Af)=>1===ne?32:2===ne?(w.ULS.shipAssertTag(4520066,308,!!Af),w.ULS.shipAssertTag(4520067,308,!!Af.WVa),od=Af.WVa,w.ULS.shipAssertTag(4520068,308,this.uE.Ila(od)),this.OXd(od,Af.H6d)?32:8):32;this.cVn=(od,Yd,ne,Df,Af)=>{if(1===ne)return 32;
2===ne&&(od=Af.footnoteEndnoteNode,Af=Af.Tal)&&(this.lpa.u0b(),Yd=this.uE.ufb(od),Af.title=this.uE.erl(od)+(Yd?WordEditorIntl.WordEditorStrings.l_FootnoteTooltipInstruction:WordEditorIntl.WordEditorStrings.l_EndnoteTooltipInstruction));return 32};this.aib=(od,Yd,ne,Df,Af)=>2===ne?(w.ULS.shipAssertTag(4520069,308,!!Af),w.ULS.shipAssertTag(4520070,308,!!Af.WVa),w.ULS.shipAssertTag(4520071,308,Cd.ParagraphReader.oc(Af.WVa)),od=this.uE.g2b(Af.WVa),this.OXd(od,Af.H6d)?32:8):32;this.FHn=(od,Yd,ne)=>{2===
ne&&this.kC.yX();return 32};this.jVk=(od,Yd,ne,Df,Af)=>{if(1===ne)return 32;if(2===ne)return void 0!==Af&&null!==Af?this.kC.X2e(Af,Af):this.kC.X2e(),32;w.ULS.sendTraceTag(4520072,308,10,"{0}",{["Error"]:"FootnoteEndnoteControl not dismissed"});return 8};this.som=(od,Yd,ne)=>{od=this.X2b(Yd);return od&&Kd.SelectionEditor.xf(od)?1===ne?32:2===ne?(ne=0<this.ep.Z1(od.node).gt,this.kC.rZe(),this.kC.dialog.beb=ne,32):8:(w.ULS.sendTraceTag(4743179,308,10,"Expected an IP context here."),8)};this.Oal=(od,
Yd,ne)=>1===ne?32:2===ne?(this.kC.dialog.beb=!1,32):8;this.M$m=(od,Yd,ne,Df,Af)=>this.mIh(od,ne,Af);this.K$m=(od,Yd,ne,Df,Af)=>1===ne?32:this.kC.dialog&&this.kC.dialog.fontName?(Af[Ol.a.Value]=this.kC.dialog.fontName,32):this.Iyj.rKa(Db.a.eHb.toString(),Af,null)?32:8;this.Nal=(od,Yd,ne)=>1===ne?32:2===ne?(this.kC.dialog.beb=!0,32):8;this.L$m=(od,Yd,ne,Df,Af)=>this.mIh(od,ne,Af);this.Lal=(od,Yd,ne)=>{if(1===ne)return 32;if(2===ne){od=this.X2b(Yd);if(!od)return w.ULS.sendTraceTag(51512524,308,10,"Selected graph node context is null"),
8;Yd=this.uE.g2b(od.node);this.uE.Ila(Yd)&&(ne=this.Hc.Rc(15),ne.Db(Yd),this.lfj(od),this.DGa.gbh(Yd,this.kC.dialog),ne.dispose());this.kC.MXc();return 32}return 8};this.Kal=(od,Yd,ne)=>{if(1===ne)return 32;if(2===ne){od=this.X2b(Yd);if(!od)return w.ULS.sendTraceTag(51512525,308,10,"Selected graph node context is null"),8;Yd=this.uE.g2b(od.node);this.uE.Ila(Yd)&&(ne=this.Hc.Rc(15),ne.Db(Yd),this.lfj(od),this.DGa.rbk(Yd,this.kC.dialog),ne.dispose());this.kC.MXc();return 32}return 8};this.Mal=(od,Yd,
ne)=>1===ne?32:2===ne?(this.kC.MXc(),32):8;this.Ial=(od,Yd,ne,Df,Af)=>{if(1===ne)return 32;if(2===ne){od=Object(ja.a)(27,Af);if(!od||!od.Bd)return 8;this.kC.dialog.fontName=od.Bd.fontName;return 32}return 8};this.Jal=(od,Yd,ne,Df,Af)=>{if(1===ne)return 32;if(2===ne){od=Object(ja.a)(27,Af);if(!od||!od.Bd)return 8;this.kC.dialog.RPb=od.Bd;return 32}return 8};this.ga=b;this.mt=h;this.Iyj=n;this.Yc=x;this.uE=E;this.rCj=S;this.DGa=ma;this.lpa=Fa;this.kC=$a;this.ep=sb;this.SPb=Jb;this.Hc=Sb;this.Ok=oc;
this.Hb=Ic;this.sV=gd;this.Hd=Gd;this.Osj=vd;this.Bxg=ce}lfj(b){(b=Mh.FormattingReader.Ds(b))?(this.kC.dialog.fontName||(this.kC.dialog.fontName=b.cache.KG),-1===this.kC.dialog.fontSize&&(this.kC.dialog.RPb=b.cache.fontSize)):w.ULS.sendTraceTag(587790277,308,10,"UpdateFontAndFontSize: Received null formatting object.")}mIh(b,h,n){return 1===h&&this.kC.dialog?32:2===h&&this.kC.dialog?(n[Vi.a.On]=b===ub.a.kNf?this.kC.dialog.beb:!this.kC.dialog.beb,32):8}Vb(){this.ga.gb(ub.a.insertFootnote,cc.a.view,
this.k7h,4);this.ga.gb(ub.a.insertEndnote,cc.a.view,this.k7h,4);this.ga.pa(ub.a.GBf,cc.a.view,this.u9b);this.ga.pa(ub.a.gri,cc.a.view,this.Qal);this.ga.pa(ub.a.FBf,cc.a.view,this.u9b);this.ga.pa(ub.a.IBf,cc.a.view,this.u9b);this.ga.pa(ub.a.HBf,cc.a.view,this.u9b);this.ga.pa(ub.a.skb,cc.a.view,this.u9b);this.ga.pa(ub.a.TJb,cc.a.view,this.u9b);this.ga.pa(ub.a.S2i,cc.a.view,this.bVn);this.ga.gb(ub.a.kIh,cc.a.view,this.Nal,4);this.ga.gb(ub.a.kNf,cc.a.view,this.L$m,100);this.ga.gb(ub.a.lIh,cc.a.view,this.Oal,
4);this.ga.gb(ub.a.FGi,cc.a.view,this.M$m,100);this.ga.pa(ub.a.T2i,cc.a.view,this.cVn);this.ga.gb(ub.a.aib,cc.a.view,this.aib,96);this.ga.gb(ub.a.X8e,cc.a.view,this.FHn,96);this.ga.pa(ub.a.L9,cc.a.view,this.jVk);this.ga.gb(ub.a.Nii,cc.a.view,this.som,4);this.ga.gb(ub.a.hIh,cc.a.view,this.Lal,4);this.ga.gb(ub.a.iIh,cc.a.view,this.Kal,4);this.ga.gb(ub.a.jIh,cc.a.view,this.Mal,4);this.ga.gb(ub.a.rCd,cc.a.view,this.Ial,4);this.ga.gb(ub.a.EGi,cc.a.view,this.K$m,100);this.ga.gb(ub.a.sCd,cc.a.view,this.Jal,
4);this.ga.gb(ub.a.oUc,cc.a.view,Fx.oUc,100);this.ga.gb(ub.a.pUc,cc.a.view,Fx.pUc,100)}EPf(){this.Osj.execute(b=>{b.a3(new JB);b.a3(new Ex)})}X2b(b){b=this.wDd(b);return b?b.Qa:(w.ULS.sendTraceTag(51512526,308,10,"GetCollapsedSelectionFromContext is null"),null)}wDd(b){let h=null;b=b.view;if(!b)return w.ULS.sendTraceTag(3486740,308,10,"We expected a view here."),h;b=b.Cb;if(!b)return w.ULS.sendTraceTag(51512527,308,10,"We expected that we have a selection manager here."),h;b=b.ib;if(!b||!b.length)return w.ULS.sendTraceTag(51512528,
308,10,"We expected that we have a selection collection here."),h;b=b.J(0);if(!b)return w.ULS.sendTraceTag(51512529,308,10,"We expected that we have a current selection here."),h;(h=Kd.SelectionEditor.ak(b,!1,!1))||w.ULS.sendTraceTag(3486741,308,10,"We expected a selection here.");return h}zGl(b){return(b=b.view)?b.Cb.ib.J(0):null}OXd(b,h=!0,n=!1){if(b){this.lpa.u0b();var x=b.Fka;if(x){var E=x.Ob;const S=Ae.SelectionFactory.wN(E.paragraph,E.cp,E.cp+1);E=this.mt.Jc;if(!E)return!1;this.Yc.Ina(E,S);
E.Ajb=150;E.Naa();b=new dz.a(b,h);x=x.dYa(E);if(!x)return w.ULS.sendTraceTag(570529814,308,15,"FootnoteEndnote presenter is null"),!1;n||x.element?this.kC.MZf(b):(this.kC.MZf(new dz.a(b.WVa,!1)),h&&(h=new We.a(2,1,10,()=>{this.kC.yX()}),this.Hb.$b(h)));return!0}}return!1}static Wql(){return new Fx(u.AFrameworkApplication.ya,ob.App.xa.jb,Oa.a.instance.resolve("Box4.IGeneralCuiUser"),cb.InteractiveViewManager.instance,Lw.a.instance,Mw.a.instance,FA.a.instance,Wz.a.instance,ez.FootnoteEndnoteControlManager.instance,
Oa.a.instance.resolve("Box4.IParagraphIndentationReader"),oj.a.instance,new Zm.a,Ai.a.instance,Ye.a.instance,u.AFrameworkApplication.ua.iq,Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Oa.a.instance.Za("Box4.Accessibility.IAccessibilityContextManager"),Oa.a.instance.Za("Box4.IContentControlReader"))}static Vql(){return Fx.Wql()}static oUc(b,h,n,x,E){if(1===n)return 32;if(2===n&&!E)return 8;Zl.a.mLd(h);E.PopulationXML=Uo.FontUtils.vJh(Zl.a.U6d,Zl.a.z9e,ub.a.rCd);return 32}static pUc(b,
h,n,x,E){if(1===n)return 32;if(2===n&&!E)return 8;E.PopulationXML=Uo.FontUtils.wJh(ub.a.sCd);return 32}}Object(r.a)(Fx,"FootnoteEndnoteActor",null,[400]);class GA extends Rt.a{constructor(b){super();this.lKe=b}get index(){return 1}run(){this.lKe()}bH(){this.kX()}}Object(r.a)(GA,"FootnoteEndnoteControlUpdateTracker",Rt.a,[]);var vu=d(370);class hs extends vu.a{constructor(b,h,n,x,E,S,ma,Fa){super(b,h,n,x);this.Sr=()=>{this.A2c(this.zb)};this.nH=b.container;this.mv=document.createElement("div");b.container.appendChild(this.mv);
this.ZB(this.mv);this.bRj=E;this.Bn.execute($a=>{$a.b7(this.Sr)});this.HGa=S;this.zE=ma;this.yH=Fa;this.HGa.execute($a=>{$a.oYf(this.ic,this.nH)});this.yH&&(this.nH.style.backgroundColor=this.zE.jAb())}dispose(){super.dispose();this.Bn.instance&&this.Bn.instance.ejb(this.Sr)}get Bn(){return null!=this.ijg?this.ijg:this.ijg=Oa.a.instance.Za("Common.IZoomManager")}ez(b){this.nH.classList.add("FootnoteEndnoteViewElement");this.A2c(b.currentNode)}A2c(b){this.Bn.instance&&(this.Bn.instance.m4c(this.mv),
this.mv.style.width=Math.round(100/this.Bn.instance.vj)+"%");this.bRj(b)}}Object(r.a)(hs,"FootnoteEndnoteViewElement",vu.a,[]);class HA{constructor(){this._initialized=!1;this.S7c=this.Foe=this.W=null;this.Val=(b,h,n,x)=>b.HZa?new hs(b,h,n,x,E=>{ez.FootnoteEndnoteControlManager.instance.htn(E)},this.W.Za("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!ob.App.instance&&ob.App.instance.yA):null}get name(){return"WordEditor.FootnoteEndnote"}zc(b){this.W=
b}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Nm()})}Nm(){hp.WordSectionNavigator.instance.NBf=Object(v.a)(FA.a.instance,FA.a.instance.NIm,"navigateToWordSectionNodeWithFootnoteEndnote");Wo.a.dYf(this.Val);ez.FootnoteEndnoteControlManager.instance.bind(ob.App.xa.eC);this.Foe=Fx.Vql();this.Foe.Vb();this.Foe.EPf();ob.App.xa.updateCommandUI();this.ekf();this._initialized=!0}dispose(){this._initialized&&(this._initialized=!1,ez.FootnoteEndnoteControlManager.instance.dispose())}ekf(){this.S7c=
new GA(()=>{ez.FootnoteEndnoteControlManager.instance.B2c()});Jw.a.P1d(Object(v.a)(this.S7c,this.S7c.bH,"setUpdateNeeded"));xj.GraphTransactionManager.instance.yna(this.S7c,3)}}Object(r.a)(HA,"PackageManager",null,[1,2]);class IA{constructor(b,h,n,x,E=null){this.nJj=b;this.hb=h;this.mca=x;this.UA=E}get zeh(){return this.nJj.value}get bookmarkManager(){return this.mca.value}gdm(b){return Kb.App.Oce||Kb.App.Kce?b.startsWith(B.a.N$a):!1}vRl(b){var h,n;try{if(Kb.App.Kce)this.wRl(b);else if(Kb.App.Oce&&
this.zeh){var x=b.split("/"),E=this.zeh.fea(x[x.length-1]);if(E&&E.anchor)if(this.UA.vja.has(null===(h=E.id)||void 0===h?void 0:h.toString())){var S=this.UA.vja.get(null===(n=E.id)||void 0===n?void 0:n.toString());if(void 0===S||null===S)w.ULS.sendTraceTag(24691933,324,50,"Empty StartBookmarkParaId in the bookmark node"),this.TPd();else{var ma=ob.App.xa.jb.Zc.Ad.Eb(S);if(ma&&ma.anchor){var Fa=Ae.SelectionFactory.xe(ma,0);this.hb.setSelection(Fa)}else w.ULS.sendTraceTag(24691934,324,50,"Paragraph node is invalid for bookmark"),
this.TPd()}}else w.ULS.sendTraceTag(24691932,324,50,"Missing StartBookmarkParaId in the bookmark node"),this.TPd();else w.ULS.sendTraceTag(24691931,324,15,"Cannot find bookmark node"),this.TPd()}}catch($a){w.ULS.sendTraceTag(24691935,324,10,String.format("Error parsing bookmark url. Error: {0}",$a.message))}}m5f(b){return{returnValue:!1,dQf:b,TIh:""}}wRl(b){if(this.bookmarkManager){b=b.split("/");var h=this.bookmarkManager.fea(b[b.length-1]);h&&h.anchor?(b=this.bookmarkManager.Kka(h,!0).q9,h=this.bookmarkManager.Kka(h,
!1).q9,b||h?b?this.oZi(b):(w.ULS.sendTraceTag(35992277,324,50,"Start Anchor is missing for Bookmark"),this.oZi(h)):(w.ULS.sendTraceTag(35992276,324,50,"Bookmark has no anchors, jumping to end"),this.ptf(!1))):(w.ULS.sendTraceTag(35992275,324,15,"Cannot find bookmark node"),this.ptf(!0))}}TPd(){this.ptf(!0)}ptf(b){b=Ae.SelectionFactory.wo(ob.App.xa.jb.Zc.mbf(),b);this.hb.setSelection(b)}oZi(b){b.paragraph&&b.Ob?(b=Ae.SelectionFactory.xe(b.paragraph,b.Ob.cp),b.T9h=!0,this.hb.setSelection(b)):w.ULS.shipAssertTag(35992279,
324,!0,"bookmark's Paragraph or Containing Properties are missing")}}Object(r.a)(IA,"InternalLinkManager",null,[253]);class Xz{get name(){return"WordEditor.InternalLinks"}init(){}dispose(){}zc(b){b.ha("WordEditor.InternalLinks.InternalLinkManager",()=>new IA(new se.a(()=>b.Pa("WordEditor.Bookmark.IBookmarkGraphManager")),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.IFeatureHelper"),new se.a(()=>b.Pa("WordEditor.Bookmark.IBookmarkManager")),b.resolve("Box4.BookmarkParagraphMapping"))).as("Box4.IInternalLinkManager").singleInstance()}static main(){N.a.instance.Pc(new Xz)}}
Object(r.a)(Xz,"WordEditorInternalLinksPackage",null,[1,2]);class Nw{constructor(b){this.kHa=null;this.checkAndDeleteEphemeralOutline=h=>{h=h.customData;if(h.anchor){ue.a.mark(4763);var n=md.GraphIterator.$a(h);if(n.Bb(8)&&n.kd(8)&&n.ecj(h)===h){if(gf.OutlineReader.isEmpty(n)){let x=!1;for(let E=0;E<kh.a.instance.ib.length;E++){const S=kh.a.instance.ib.J(E);for(let ma=0;ma<S.length;ma++)if(S.J(ma).node===h){x=!0;break}}x||this.Qwh(n)}ue.a.mark(4764)}}};Nw.uJ=b}Gwd(b){if(!Nw.Ue.uOd(b))return null;
b.Rb(1)&&(b.currentNode.Sj(8,!0),b.nc());const h=Nw.uJ.bKk();Nw.Ue.isRtl(b.currentNode)?h.setValue(ie.a.Aq,11):h.setValue(ie.a.Aq,9);b.Sf(h,1);b.Ci(h);return h}fJn(b){if(this.kHa&&b!==this.kHa){const h=new We.a(2,1,0,this.checkAndDeleteEphemeralOutline,120);h.customData=this.kHa;u.AFrameworkApplication.uc.$b(h)}this.kHa=b}Qwh(b){this.kHa===b.currentNode&&(this.kHa=null);const h=new Se.GraphTransaction(7);h.Ju(b);b.Fg();h.dispose()}Wkh(){if(this.kHa&&this.kHa.anchor){const b=md.GraphIterator.$a(this.kHa);
b.qo()&&gf.OutlineReader.SMc(b)&&this.Qwh(b);this.kHa=null}}static get Ue(){return Nd.PageReader.instance}}Nw.uJ=null;Object(r.a)(Nw,"PageContentEditor",null,[1204]);var sy=d(1136),Zv=d(641);class Yz extends oh{constructor(){super()}t1i(b,h,n,x,E){let S=!1,ma=!0;Kd.SelectionEditor.xf(E)&&(h=ec.ListReader.$h(b)&&h,E=Kf.OutlineElementReader.Mz(b,E,!1)&&!Kf.OutlineElementReader.Mz(b,E,!0),h&&n.VTe(b,x)&&(S=!0),ob.App.rd.Kp&&(E||h&&!S)&&(ma=!1));return{s1i:ma,Pjj:S}}}Object(r.a)(Yz,"CursorMoveValidator",
oh,[]);class co{constructor(b,h,n,x){this.MAe=b;this.x4=x;this.vH=h;this.Kh=n;this.KFj=!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("QoEIndentLeftForListImprovementIsEnabled")}get Rd(){return null!=this.yqg?this.yqg:this.yqg=Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Hk(){return null!=this.jqg?this.jqg:this.jqg=Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get pc(){return null!=this.Mrg?this.Mrg:this.Mrg=Oa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Mr(){return this.x4.value}get eh(){return this.Kh.value}get xm(){return this.vH}wPl(b){const h=
window.performance.now(),n=new Xn.ScriptSharpLegacyMap;let x=new Lm.a,E=new Xn.ScriptSharpLegacyMap;if(b&&b.Rw){var S=null;for(let ma=0;ma<b.length;ma++){const Fa=b.getContext(ma);S=S||co.oh.gu(Fa.node);let $a;if(!({groupId:$a}=this.I$n(Fa.node,S)).returnValue)continue;let sb;n.xb($a)||(sb=[],n.add($a,sb));sb=n.J($a);sb.push(Fa)}for(let ma of tj.toArray(n.keys))b=n.J(ma),S=new md.GraphIterator,S.set(b[0].node),({FQi:b,Xs:S}=this.vH.g$n(S)).returnValue?(n.Z(ma,b),E.add(ma,S)):x.add(ma)}w.ULS.sendTraceTag(589592455,
338,50,String.format("GroupGraphNodeContextForIndenationDuration: {0} ms;",window.performance.now()-h));return{returnValue:n,zPl:x,yPl:E}}Uvb(b){return this.Mpk(b)}fYb(b){return this.mpk(b)}Jsd(b,h,n=!0){return md.GraphIterator.yka(()=>{var x=!1;if(ec.ListReader.$h(b))return this.VTe(b,h,n);x||(wf.OutlineElementNavigator.He(b),x=Cd.ParagraphReader.wh(b)||ag.TableReader.isTable(b),wf.OutlineElementNavigator.ae(b),x=x&&this.Kpk(b,h));return x})}VTe(b,h,n=!0){return md.GraphIterator.yka(()=>{const x=
Kf.OutlineElementReader.FAa(b),E=gf.OutlineReader.rL(b.currentNode);if(n?!this.Gem(b,h):!this.Hem(b,h))return!1;var S=md.GraphIterator.$a(b.currentNode);if(0<h&&S.Bb(14)){S.kd(16);var ma=S.currentNode;const Fa=Fg.TableCellReader.Ngf(S);S.kd(14);const $a=S.currentNode;S=qh.a.VP(ma,$a,ic.a.pM,ic.a.za,0);ma=qh.a.VP(ma,$a,ic.a.rO,ic.a.Aa,0);S=mf.a.Ty(S,0);ma=mf.a.Ty(ma,0);return x+E<Fa-S-ma}return!0})}Kpk(b,h){const n=Kf.OutlineElementReader.FAa(b);var x=Kf.OutlineElementReader.pF(b);if(0<h){h=gf.OutlineReader.rL(b.currentNode);
x=0;let Fa,$a;({Ko:ma,marginLeft:Fa,marginRight:$a}=co.ZFd(b.currentNode));var E=md.GraphIterator.$a(b.currentNode);wf.OutlineElementNavigator.He(b);if(ag.TableReader.isTable(b)){x=ag.TableReader.hea(b);let sb=0;for(var S of x)sb+=S;x=mf.a.Ty(mf.a.yf(sb,0),0)}wf.OutlineElementNavigator.ae(b);if(E.Bb(14)){E.kd(16);S=E.currentNode;b=Fg.TableCellReader.Ngf(E);E.kd(14);var ma=E.currentNode;E=qh.a.VP(S,ma,ic.a.pM,ic.a.za,0);S=qh.a.VP(S,ma,ic.a.rO,ic.a.Aa,0);E=mf.a.Ty(E,0);S=mf.a.Ty(S,0);return n+h<b-E-
S-x}return n+h<ma-Fa-$a-x}return 0<n-x}XNa(b,h){this.xAi(b,-1*Math.abs(h))}bDc(b,h){this.xAi(b,Math.abs(h))}kTk(b,h,n,x,E){let S=co.Epi;if(h>=co.Epi){S=h-=n;const ma=x*E,Fa=Math.abs(ma),$a=Math.abs(h)%Fa;$a&&(S=0>S?0>x?S+$a:S-(Fa-$a):0<x?S-$a:S+(Fa-$a));S+=ma;S+=n;co.NYd&&(n=Kf.OutlineElementReader.Z1(b),S=co.NYd.pMh(b.currentNode,h+n,S+n,E,S<h)-n)}return S}Ipk(b,h,n){if(!b||!b.length)return!1;h=n?h?-1:1:this.XNh(b[0].node,h);return this.Jpk(b,h,n)}YYm(b,h,n){if(!b)return w.ULS.shipAssertTag(589345600,
338,!1,"The group of listOEs are null which are sent for indentation."),8;if(!b.length)return w.ULS.shipAssertTag(589345601,338,!!b.length,"The group of listOEs are empty which are sent for indentation."),8;if(!n)return w.ULS.shipAssertTag(589592458,338,!1,"The listIds are null which are sent for indentation."),8;if(!n.length)return w.ULS.shipAssertTag(589592459,338,!1,"The listIds are empty which are sent for indentation."),8;const x=b[0].node;h=this.XNh(x,h);if(!this.kHm(x,n[0],h)||!this.hHm(b,
h))return 8;this.Mr.M7();return 32}hHm(b,h){for(let n=0;n<b.length;n++){const x=new md.GraphIterator;x.set(b[n].node);let E=null;wf.OutlineElementNavigator.He(x);if(Cd.ParagraphReader.wh(x)){if(E=x.currentNode,!E)return w.ULS.shipAssertTag(589592461,338,!E,"The paraNode is null for the list OE node"),!1}else if(!Cd.ParagraphReader.wh(x)&&!ag.TableReader.isTable(x))return w.ULS.shipAssertTag(589592460,338,!1,"The content of the listOE is neither a paragraph nor a table node"),!1;x.nc();if(E){if(this.lUl(E)){const S=
E.Hz(),ma=Kf.OutlineElementReader.FAa(x);this.eh.mva(x,1,ma+h);S&&this.Hk.gM(E,S,this.Rd.wg)}E.setValue(ie.a.HT,new Date)}}return!0}kHm(b,h,n){for(let x=0;x<Zh.a.pfa;x++){const E=this.vH.Kw(b,h,x);if(!E)return w.ULS.shipAssertTag(589345602,338,!1,"The list defs returned is null for listId : {0}",h),!1;const S=E.getValue(ic.a.ge);S&&E.setValue(ic.a.ge,S+n)}return!0}lUl(b){return b.hasProperty(ic.a.ge)||b.hasProperty(ic.a.$s)||b.hasProperty(ic.a.QB)}mpk(b){return this.Jsd(b,1,!0)}Mpk(b){return this.Jsd(b,
-1,!0)}XNh(b,h){var n=new md.GraphIterator;n.set(b);const x=Kf.OutlineElementReader.FAa(n),E=Kf.OutlineElementReader.pF(n),S=Kf.OutlineElementReader.Z1(n);n=gf.OutlineReader.rL(b);co.ZFd(b);b=(E?x-E:S)%n;return h?-1*(b?b:n):n-b>co.Vvh?co.Vvh:n-b}I$n(b,h){let n;const x=new md.GraphIterator;x.set(b);b=x.Rb(4).getValue(ic.a.listID);return({id:n}=this.vH.fLb(b,h)).returnValue?{returnValue:!0,groupId:n}:{returnValue:!1,groupId:n}}Jpk(b,h,n){var x=!1;for(let E=0;E<b.length;E++){x=b[E];const S=new md.GraphIterator;
S.set(x.node);Kd.SelectionEditor.Gt(S);if(!Kf.OutlineElementReader.Nh(S))return co.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.MWa}),!1;if(this.Jsd(S,h,n))x=!0;else return co.Lc.Yb(Gc.a.L_b,{["Reason"]:Mc.a.lUe}),!1}return x}xAi(b,h){if(this.Jsd(b,h,!0)){var n=!1;if(ec.ListReader.$h(b)){var x=new md.GraphIterator;x.fd(b);this.xm.cD(x);var E=x.currentNode;x.nc();const ma=E.getValue(ic.a.listLevel);n=!0;var S=E.getValue(ic.a.listID);if(S=this.fIl(S,ma+h))wf.OutlineElementNavigator.He(x),Cd.ParagraphReader.wh(x)&&
co.ZQ.hM(S,x.currentNode,!1),x.nc();else{S=null;let Fa;wf.OutlineElementNavigator.He(x);Cd.ParagraphReader.wh(x)&&(S=x.currentNode);x.nc();Fa=S?S.Hz():null;this.KFj&&(S||(wf.OutlineElementNavigator.He(x),Cd.ParagraphReader.wh(x)&&(S=x.currentNode),x.nc()),S&&(S.hasProperty(ic.a.ge)&&S.removeProperty(ic.a.ge),S.hasProperty(ic.a.$s)&&S.removeProperty(ic.a.$s)));this.Mr.PRf(x,ma,h);E.setValue(ic.a.listLevel,ma+h);E.removeProperty(ic.a.kma);S&&Fa&&(this.Hk.gM(S,Fa,this.Rd.wg),this.Mr.M7());this.R2n(b,
E)}}n||(n=Kf.OutlineElementReader.FAa(b),x=Kf.OutlineElementReader.pF(b),E=gf.OutlineReader.rL(b.currentNode),h=this.kTk(b,n,x,h,E),this.eh.mva(b,1,h))}}Hem(b,h){const n=Kf.OutlineElementReader.FAa(b);var x=Kf.OutlineElementReader.pF(b);const E=Kf.OutlineElementReader.Z1(b);let S,ma;({Ko:b,marginLeft:S,marginRight:ma}=co.ZFd(b.currentNode));if(0<h){if(x=b-S-ma,E&&E+h+ob.App.Zva>x||n+h+ob.App.Zva>x)return!1}else if(E&&0>n+h||0>n-x+h)return!1;return!0}Gem(b,h){var n=this.Mr.Lw(b),x=n.level;const E=
gf.OutlineReader.rL(b.currentNode),S=x+h;if(Nn.a.nQd<S||S<Nn.a.n8e)return!1;const ma=b.currentNode;if(!ec.ListReader.pr){var Fa=wf.OutlineElementNavigator.He(b);wf.OutlineElementNavigator.ae(b);if(Fa.hasProperty(ic.a.ge)&&(Fa=Fa.getValue(ic.a.ge),E*(x+1)!==Fa))return!1}n=this.xm.Kw(ma,n.listID,S);return n?0<h&&n.hasProperty(ic.a.ge)&&(h=n.getValue(ic.a.ge),{Ko:b,marginLeft:n,marginRight:x}=co.ZFd(b.currentNode),h+ob.App.Zva>b-n-x)?!1:!0:(w.ULS.shipAssertTag(590700875,338,!!n),!1)}fIl(b,h){const n=
this.pc.Ip();for(let x=0;x<n.tN;x++){const E=n.ela(x);if(this.xm.Zxb(E)&&E.ia(ic.a.listID,this.Mr.C6+1)===b&&E.ia(ic.a.listLevel,-1)===h)return E}return null}R2n(b,h){wf.OutlineElementNavigator.He(b);if(Cd.ParagraphReader.wh(b)&&b.currentNode.hasProperty(ic.a.ge)&&(h=this.xm.UHc(h))){const x=ec.ListReader.pr;if(x&&h.hasProperty(ic.a.$s)){var n=h.getValue(ic.a.$s);this.MAe.Rjb(b.currentNode,n)}h.hasProperty(ic.a.ge)&&(n=h.getValue(ic.a.ge),this.MAe.mva(b,1,n));x&&h.hasProperty(ic.a.QB)&&(h=h.getValue(ic.a.QB),
this.MAe.Raa(b.currentNode,h))}wf.OutlineElementNavigator.ae(b)}static get ZQ(){return null!=co.krg?co.krg:co.krg=Oa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get NYd(){return null!=co.Yng?co.Yng:co.Yng=Oa.a.instance.Pa("WordEditor.ParagraphIndentationUtility")}static get paragraphEditor(){return co.pu||(co.pu=Oa.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(b){co.pu=b}static get Lc(){return vb.a.instance}static get Sg(){return Pm.a.instance}static get oh(){return ql.PageNavigator.instance}static ZFd(b){let h;
var n=hp.WordSectionNavigator.instance.RL(b);h=co.Sg.Gv(n);b=co.Sg.vL(n);n=co.Sg.wL(n);return{Ko:h,marginLeft:b,marginRight:n}}}co.Vvh=Jf.a.wF(.25);co.pu=null;co.Epi=Jf.a.wF(-11);Object(r.a)(co,"OutlineElementIndentationEditor",null,[484,485]);var Gx=d(301),Ei=d(468),Zu=d(214),Hx;(function(b){b[b.none=0]="none";b[b.character=1]="character";b[b.paragraph=2]="paragraph";b[b.table=3]="table"})(Hx||(Hx={}));Object(r.b)("StyleTargetType",Hx);var st=d(169);class wu{constructor(b,h){this.xC=null;this.kG=
h;this.Cf=b}get paragraphEditor(){return null!=this.Eng?this.Eng:this.Eng=Oa.a.instance.resolve("Box4.IParagraphEditor")}get kF(){return null!=this.Cig?this.Cig:this.Cig=Oa.a.instance.resolve("Box4.IFontStylesGalleryCache")}get Gj(){return null!=this.npg?this.npg:this.npg=Oa.a.instance.Pa("Box4.Styles.StyleSettings")}get ui(){return null!=this.Xig?this.Xig:this.Xig=Oa.a.instance.resolve("Box4.IFormattingEditor")}get pc(){return null!=this.Prg?this.Prg:this.Prg=Oa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Aba(){return this.xC||
(this.xC=new Zv.WACStyleSet)}set Aba(b){this.xC=b}get Pb(){return null!=this.lig?this.lig:this.lig=Oa.a.instance.Pa("Box4.IFeatureHelper")}get Jo(){return this.kG.value}get Rj(){return null!=this.Ujg?this.Ujg:this.Ujg=Oa.a.instance.Pa("Box4.IInsertionPointFormatting")}get TQd(){return this.Cf||(this.Cf=Oa.a.instance.resolve("Box4.List.IListReader"))}get characterPropertiesEditor(){return null!=this.Nfg?this.Nfg:this.Nfg=Oa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Rd(){return null!=
this.Pqg?this.Pqg:this.Pqg=Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Hk(){return null!=this.qqg?this.qqg:this.qqg=Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}nIl(b){const h=b.node;var n=this.Rj?this.Rj.ULh():null;if(n&&!n.equals(C.a.nil)){b=h.Nc;if(!b)return null;n=b.Eb(n);if(!n||(n=new st.a(n),1!==this.pc.Ow(n)))return null}else n=Mh.FormattingReader.Ds(b),n=Mh.FormattingReader.Nsa(n);return n}MMn(b,h){const n=this.pc.Nx(h);
n&&n.uh(this.pc.tf(b))&&(this.D7f(h,n),this.Rj&&(this.Rj.C1a(),this.Rj.gkb(b,h)))}Tak(b,h){if(h)if(h.czb&&0<h.czb.length){let E=new Pa.a;for(var n of h.czb)E.add(n);if(h.Ctf){h=Mh.FormattingReader.rfl(b);n=[];for(var x of h)x.formatting&&x.formatting.Xm&&n.push(x.formatting.Xm);if(0<n.length){x=Gx.APropertySet.sRh(n);h=new Pa.a;for(const S of E)x.hasProperty(S)||h.add(S);E=h}}this.paragraphEditor.DYb(b,!0,E)}else this.paragraphEditor.DYb(b,!0);else sd.b(576582787,3018,15,"Cannot apply alternate formatting strategy as ClearSpecificFormattingProperties is null")}hM(b,
h,n,x=!1,E=!1,S=!1,ma=null){if(Cd.ParagraphReader.oc(h))if(b)if(this.pc.tI(b.Yh()))if(2!==this.pc.Ow(b))w.ULS.shipAssertTag(593506381,324,!1);else{var Fa=this.pc.Nx(h);if(Fa){var $a=this.pc.tf(b);if(!$a)w.ULS.shipAssertTag(593506377,324,!1);else if(Fa.uh($a)){var sb=null,Jb=Of.a.instance.J(3)&&!x?h.Hz():null;n||(ma&&ma.dpk&&this.Pb&&this.Pb.isFeatureEnabled(107)?(this.Tak(h,ma),this.Kho(h,b,ma)):(sb=this.Jo.FOf(sb,h),this.paragraphEditor.DYb(h,!0)));this.D7f(h,Fa);Of.a.instance.J(8)||(b=Fa.uh(this.pc.tf(b)));
E&&Jb&&Jb.hasProperty(Th.a.paragraphStyle)&&Jb.removeProperty(Th.a.paragraphStyle);h.properties.setValue(Th.a.paragraphStyle,b.id);null!=Ei.a.Zd&&!Ei.a.Zd.KL&&this.Pb&&this.Pb.isFeatureEnabled(107)&&this.bfj(h,b,ma);h.ZI=b;h.u3=null;for(n=0;n<h.qa.length;n++)h.qa.J(n).formatting&&h.qa.J(n).formatting.W4b();this.TQd.Zxb(b)&&(sb||(sb=new md.GraphIterator,sb.set(h),sb.vd(),wf.OutlineElementNavigator.ae(sb)),ec.ListReader.$h(sb)||(h.Qg(ic.a.ge,ic.a.CQ,ic.a.QB,ic.a.ZZ,ic.a.MNa,ic.a.Mv),this.ard(sb,b)));
this.Gj&&this.Gj.isProgressiveStyleEnabled&&null!=this.kF&&this.kF.lec($a);x||!Jb||S||this.Hk.gM(h,Jb,this.Rd.wg)}}else w.ULS.shipAssertTag(593506379,324,!1)}else w.ULS.shipAssertTag(593506382,324,!1);else w.ULS.shipAssertTag(593506383,324,!1);else w.ULS.shipAssertTag(593506384,324,!1)}Kho(b,h,n){const x=this.TQd.jI(b),E=this.TQd.Zxb(h);if(x){if(null!=Ei.a.Zd&&Ei.a.Zd.KL)this.bfj(b,h,n);else{n=n&&!n.Ctf&&n.czb?n.czb:null;var S=this.TQd.QN(x);S&&this.Jo.Jho(x,h,n,S.qr)}E||b.setValue(ic.a.kma,!1)}else E&&
b.setValue(ic.a.kma,!0)}bfj(b,h,n){const x=b.Nc;if(b=this.characterPropertiesEditor.lKa(b)){var E=null==b.Xm?new Zu.a:b.Xm.clone();Hk.a.Oio(E,h,n&&!n.Ctf&&n.czb?n.czb:null);E.Vla?h=x.KQ(E,!0):(x.Gu(E,null),h=E);b.Aj=h.id}else w.ULS.sendTraceTag(574660761,3018,15,"EOP formatting is null, skipping application on EOP.")}ard(){}e6d(b,h){if(h){w.ULS.shipAssertTag(593506371,324,h.isConnected,"paragraphNode not connected");var n=this.pc.Nx(h);n?(b=n.Lsa(b))?this.pc.tI(b.Yh())?this.hM(b,h,!1,void 0,void 0,
void 0,null):w.ULS.shipAssertTag(593506368,324,this.pc.tI(b.Yh())):w.ULS.shipAssertTag(593506369,324,!!b):w.ULS.shipAssertTag(593506370,324,!1,"StyleReader.GetStyleSetFromParagraphNode==null")}else w.ULS.shipAssertTag(593506372,324,!1)}FVe(b,h=!1,n=!1){const x=this.pc.Nx(b).uh(Of.a.instance.J(8)?jh.StyleReader.wordStyleIdNormal:jh.StyleReader.styleIdNormal);this.hM(x,b,h,void 0,n)}D7f(b,h){(b=wu.oh.gu(b))&&h.QZc(b,!1)}FQk(b){var h=null;if(this.Pb&&this.Pb.isFeatureEnabled(37)){if(!b||!b.count)return w.ULS.sendTraceTag(592221652,
3018,10,"No style IDs provided for delete."),!1;if(!h&&(h=Hk.a.Mx(),!h))return w.ULS.sendTraceTag(592221653,3018,15,"Couldn't retreive PageContentNode."),!1;var n=this.Aba.SN(h);if(!n)return w.ULS.sendTraceTag(592221654,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;var x=new Map;x.set("NumberOfStyles",b.count.toString());x.set("Source","DeleteStyleAPI");ta.Health.instance.recordKpiUsage(jo.a.Ice,0,jo.a.vB,x);x=0;const ma=(new Date).getTime();var E=null;let Fa=null,$a=null,sb=null;
const Jb=this.Pb.isFeatureEnabled(36)&&!0;Jb&&(E=new Qa.a,Fa=new Qa.a,$a=new Qa.a,sb=new Qa.a);for(var S of b){if(!S)return w.ULS.sendTraceTag(592221655,3018,50,"Style ID is null."),!1;const Sb=n.uh(S);if(!Sb||!this.pc.me(Sb,n))return w.ULS.sendTraceTag(592221656,3018,50,"Provided style is null[{0}] or not a custom style [{1}].",!Sb,!!Sb&&this.pc.me(Sb,n)),!1;const oc=this.pc.Ow(Sb);if(2!==oc&&1!==oc)return w.ULS.sendTraceTag(592221657,3018,50,"Provided style has style type: {0}.",oc),!1;const Ic=
this.pc.c2(Sb,n);let gd=0;if(Ic){if(!this.pc.me(Ic,n))return w.ULS.sendTraceTag(571074068,3018,15,"Provided custom style's linked style is not a custom style."),!1;gd=this.pc.Ow(Ic);if(2!==gd&&1!==gd)return w.ULS.sendTraceTag(592221659,3018,15,"Provided style's target type: {0}, linked style's target type: {1}. ",oc,gd),!1}else w.ULS.sendTraceTag(592221658,3018,50,"Provided style's linked style is null.");let Gd=this.Hxb(Sb,n);if(!Gd)return!1;x++;Jb&&(1===oc?(Fa.add(S),sb.add(Sb.id)):(E.add(S),$a.add(Sb.id)));
if(Ic){Gd=this.Hxb(Ic,n);if(!Gd)return!1;x++;Jb&&(1===gd?(Fa.add(this.pc.tf(Ic)),sb.add(Ic.id)):(E.add(this.pc.tf(Ic)),$a.add(Ic.id)))}}Nt.a.bCb();n=Hk.a.Agf(n);S=new Se.GraphTransaction(15);S.Db(h);Jb&&this.Non(E,Fa,$a,sb,h);h.setValue(Th.a.Gga,n);sd.b(572302817,3018,50,String.format("Style Object Ids - {0}",n));S.h5d();S.dispose();h=(new Date).getTime();E=new Map;E.set("Source","DeleteStyleAPI");E.set("NumberOfStyles",b.count.toString());E.set("TrueStyleCount",x.toString());E.set("ShouldRemoveReferences",
(!0).toString());b=Object.assign(new ab.a,{extendedProperties:E,durationMs:h-ma});ta.Health.instance.recordKpiSuccess(jo.a.Ice,b);return!0}return!1}Non(b,h,n,x,E){if(b&&b.count||h&&h.count)if(E){var S=(new Date).getTime();if(E=this.lol(E)){for(;E.moveNext();){if(!Cd.ParagraphReader.wh(E.iterator))continue;const ma=E.currentNode;this.xon(ma,b,n);this.yon(ma,h,x)}n=(new Date).getTime();w.ULS.sendTraceTag(591148963,3018,50,String.format("RemoveStyleReferences Duration: {0} ms;",n-S));x=new Map;x.set("Source",
"DeleteStyleRemoveStylesReferences");x.set("NumberOfStyles",(b.count+h.count).toString());b=Object.assign(new ab.a,{extendedProperties:x,durationMs:n-S});ta.Health.instance.recordKpiSuccess(jo.a.Ice,b)}}else sd.b(577520338,3018,50,"PageContentNode not provided.");else sd.b(577520337,3018,50,"No style IDs provided")}xon(b,h,n){if(h&&h.count&&b){var x=b.FA;x&&x.hasProperty(Th.a.paragraphStyle)&&n.contains(x.getValue(Th.a.paragraphStyle))&&(x.removeProperty(Th.a.paragraphStyle),b.FA=x,b.Hz()&&this.Hk.gM(b,
b.Hz(),this.Rd.wg));(n=this.pc.yo(b))&&(n=this.pc.tf(n))&&h.contains(n)&&this.FVe(b,!0,!0)}}yon(b,h,n){if(b&&b.qa&&b.qa.length&&h&&h.count)for(let ma=0;ma<b.qa.length;ma++){var x=b.qa.J(ma);if(x&&x.formatting&&(x=x.formatting)&&x.Ob){var E=Mh.FormattingReader.Nsa(x);E&&(E=this.pc.tf(E))&&h.contains(E)&&this.ui.vVe(x);if(E=x.Ob.hn){var S=E.Xm;S&&(S=S.clone(),S.hasProperty(Th.a.kB)&&n.contains(S.getValue(Th.a.kB))&&this.Mmn(b,S,E,x));Of.a.instance.J(3)&&(S=ma===b.qa.length-1?b.characterData.length:
b.qa.J(ma+1).cp,this.Hk.XIb(b,x.Ob,x.Ob.cp,S,E,x,this.Rd.wg))}}}}Mmn(b,h,n,x){b&&h&&n&&x&&(b=b.Nc)&&(h.removeProperty(Th.a.kB),h.Vla?h=b.KQ(h,!0):b.Gu(h,null),n.Aj=h.id,x.Ob.hn=n)}lol(b){if(!b)return null;b=md.GraphIterator.$a(b);return b.qo()?cn.a.Ir(b,b.origin):null}Hxb(b,h){if(!b)return w.ULS.sendTraceTag(592221660,3018,10,"WACStyle for given style ID is null."),!1;var n=b.Yh();return this.pc.tI(n)?h.Mon(b)?!0:(n=new Map,n.set("Source","DeleteStyle"),n.set("StyleType",Hx[this.pc.Ow(b)]),n.set("IsCustomStyle",
this.pc.me(b,h).toString()),n.set("IsLinkedStyle",(!!this.pc.c2(b,h)).toString()),b=Object.assign(new ab.a,{extendedProperties:n}),ta.Health.instance.recordKpiFailure(jo.a.Ice,"UnableToDeleteStyle",!1,!0,b),w.ULS.sendTraceTag(592221662,3018,50,"Couldn't remove style from style set."),!1):(w.ULS.sendTraceTag(592221661,3018,50,"Invalid property set inside WACStyle."),!1)}c9b(b,h,n,x){var E,S,ma;if(this.Pb&&this.Pb.isFeatureEnabled(86)){if(!b)return w.ULS.sendTraceTag(591138959,3018,15,"No style IDs provided for delete."),
!1;if(!n&&(n=Hk.a.Mx(),!n))return w.ULS.sendTraceTag(591138960,3018,15,"Couldn't retreive PageContentNode."),!1;const $a=this.Aba.SN(n);if(!$a)return w.ULS.sendTraceTag(591138961,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;b=$a.uh(b);if(!b)return w.ULS.sendTraceTag(591138962,3018,50,"Provided style is null[{0}].",!b),!1;var Fa=this.pc.Ow(b);if(2!==Fa&&1!==Fa)return w.ULS.sendTraceTag(591138963,3018,50,"Provided style has style type: {0}.",Fa),!1;ta.Health.instance.recordKpiUsage(jo.a.S9f,
0,jo.a.vB,new Map([["Source","ModifyStyleAPI"]]));Fa=Date.now();const sb=new Se.GraphTransaction(15);let Jb,Sb;try{sb.Db(n);if(!(x&&0!=x.length||h&&0!=h.count))return!1;if(x&&0!=x.length){if(null===(E=Ei.a.Zd)||void 0===E?0:E.ONc)Jb=Hk.a.vFd(b);if(!$a.pRk(b,x))return this.Rta("ModifyStyleAPI",b,$a,Fa,"UnableToDeleteStyleProperties"),!1}if(h&&0!=h.count){const vd=$a.Pjo(b,h);if(null===(S=Ei.a.Zd)||void 0===S?0:S.ONc)Sb=Hk.a.vFd(b);if(!vd)return this.Rta("ModifyStyleAPI",b,$a,Fa,"UnableToModifyStyle"),
!1}(null===(ma=Ei.a.Zd)||void 0===ma?0:ma.ONc)&&this.mHm(b,n,Sb,Jb);Nt.a.bCb();const oc=Hk.a.Agf($a);n.setValue(Th.a.Gga,oc);sd.b(572302818,3018,50,String.format("Style Object Ids - {0}",oc));const Ic=Date.now(),gd=new Map([["Source","ModifyStyleAPI"]]),Gd=Object.assign(new ab.a,{extendedProperties:gd,durationMs:Ic-Fa});ta.Health.instance.recordKpiSuccess(jo.a.S9f,Gd);return!0}finally{sb&&sb.dispose()}}return!1}mHm(b,h,n,x){var E,S;if(null!==b){var ma;x&&((ma=null===(E=this.Jo)||void 0===E?void 0:
E.Dbe(h,x,b,!0))||sd.b(522856385,3018,50,"Cannot able to remove the pstyle property in list def during modify style."));n&&((ma=null===(S=this.Jo)||void 0===S?void 0:S.Dbe(h,n,b,!1))||sd.b(522856386,3018,50,"Cannot able to modify the pstyle property in list def during modify style."))}}Rta(b,h,n,x,E){const S=Date.now();b=new Map([["Source",b],["StyleType",Hx[this.pc.Ow(h)]],["IsCustomStyle",this.pc.me(h,n).toString()],["IsLinkedStyle",(!!this.pc.c2(h,n)).toString()]]);x=Object.assign(new ab.a,{extendedProperties:b,
durationMs:S-x});ta.Health.instance.recordKpiFailure(jo.a.S9f,E,!1,!0,x)}static get oh(){return ql.PageNavigator.instance}}Object(r.a)(wu,"WACStyleEditor",null,[24]);class ty extends wu{constructor(b,h,n){super(b,n);this.x4=h}get Mr(){return this.x4.value}ard(b,h){this.Mr.ard(b,h)}}Object(r.a)(ty,"WACStyleEditor",wu,[]);class JA{j2a(b,h){b.properties.setValue(ic.a.marginTop,h)}h2a(b,h){b.properties.setValue(ic.a.marginBottom,h)}uga(b,h){b.properties.setValue(ic.a.marginLeft,h)}i2a(b,h){b.properties.setValue(ic.a.marginRight,
h)}mXf(b,h){b.properties.setValue(ic.a.Ko,h)}lXf(b,h){b.properties.setValue(ic.a.Xx,h)}$Xi(b,h){b.properties.setValue(ic.a.Yhi,h)}UIb(b,h){b.properties.setValue(wi.a.yC,h)}ZFn(b,h){b.properties.setValue(wi.a.ZV,h)}hdc(b,h){b.properties.setValue(wi.a.Fx,h)}}Object(r.a)(JA,"WordSectionEditor",null,[252]);class KB{get name(){return"WordEditor.OutlineLevelEditors"}zc(b){b.ha("WordEditor.OutlineLevelEditors.WordSectionEditor",()=>new JA).as("Box4.IWordSectionEditor").singleInstance();u.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&
(b.ha("Box4.OutlineLevelEditors.PageContentEditor",()=>new Nw(b.resolve("Box4.IOutlineEditor"))).as("Box4.Pages.IPageContentEditor").singleInstance(),b.ha("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new co(Ig.a.iLa,b.resolve("WordEditor.List.IFlatListReader"),b.Ye("Box4.IOutlineElementEditor"),b.Ye("WordEditor.IFlatListEditor"))).as("Box4.IOutlineElementIndentationEditor"),b.ha("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new co(Ig.a.iLa,b.resolve("WordEditor.List.IFlatListReader"),
b.Ye("Box4.IOutlineElementEditor"),b.Ye("WordEditor.IFlatListEditor"))).as("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"),b.ha("WordEditor.OutlineLevelEditors.CursorMoveValidator",()=>new Yz).as("Box4.List.ICursorMovementValidator").singleInstance(),b.ha("Box4.Styles.WACStyleReader",()=>new sy.a(b.resolve("WordEditor.ClientPagination.IClientPaginationSettings"),new Zv.WACStyleSet)).as("Box4.Styles.IWACStyleReader").singleInstance(),b.ha("WordEditor.OutlineLevelEditors.WACStyleEditor",
()=>new ty(b.resolve("Box4.List.IListReader"),b.Ye("WordEditor.IFlatListEditor"),b.Ye("Box4.List.IListEditor"))).as("Box4.Styles.IWACStyleEditor").singleInstance())}init(){}dispose(){}static main(){N.a.instance.Pc(new KB)}}Object(r.a)(KB,"WordEditorOutlineLevelEditorsPackage",null,[1,2]);var LB=d(1171),KA=d(564),dn=d(787),Cs=d(114),tt=d(317);class ct{constructor(b,h,n,x,E,S){this.Cf=E;this._pageContent=n;this.hrb=Array(ct.pfa);this.yUb=Array(ct.pfa);this.L_g=Array(ct.pfa);this.HDe=Array(ct.pfa);this.VWg=
Array(ct.pfa);this.mV=x;this.Dwc=S;for(x=0;x<ct.pfa;x++){var ma=this.$Rh(b,x,n,E);ma?(S=ma.ia(ie.a.bX,Zh.a.Xi),ma=ma.ia(ic.a.VXc,Zh.a.Xi)):ma=S=Zh.a.Xi;this.yUb[x]=S!==Zh.a.Xi?S:Zh.a.RCc;this.HDe[x]=ma===Zh.a.Xi?x-1:ma-1;ct.E6(h)&&(this.L_g[x]=Zh.a.Xi,this.VWg[x]=Zh.a.Xi);this.hrb[x]=this.yUb[x]}}$Rh(b,h,n,x){x.P1(n);return bo.a.getInstance().p5b&&this.Dwc?this.Cf.Rdf(b,h,this.mV,n):this.Cf.u2b(b,h,n.Nc,n)}restart(b){this.hrb[b]=this.yUb[b]}Zri(b){for(var h=0;h<b;h++)this.hrb[h]===this.yUb[h]&&this.hrb[h]++;
for(h=b+1;h<ct.pfa;h++)this.HDe[h]>=b&&this.restart(h);return this.hrb[b]++}static E6(b){return!!b&&b.isFeatureEnabled(74)}}ct.pfa=9;Object(r.a)(ct,"AWordList",null,[31]);class LA{constructor(b,h,n,x){this.D7a=new Xn.ScriptSharpLegacyMap;this.Cf=b;this.oz=h;this.mV=n;this.Dwc=x}Es(b,h){this.D7a.xb(b)||this.D7a.Z(b,new ct(b,h,this.oz,this.mV,this.Cf,this.Dwc));return this.D7a.J(b)}uCf(b,h,n){return this.Es(b,n).Zri(h)}}Object(r.a)(LA,"AListNumberingMap",null,[1261]);class wh extends ct{constructor(b,
h,n,x,E,S){super(b,h,n,x,E,S)}gAl(b,h,n,x){x.P1(n);return bo.a.getInstance().p5b&&this.Dwc?this.Cf.Zvl(b,h,this.mV):this.Cf.Yvl(b,h,this._pageContent.Nc)}Wej(b,h,n){var x=this.gAl(b,h,this._pageContent,this.Cf);x?(b=x.ia(ie.a.bX,Zh.a.RCc),x=x.ia(ic.a.VXc,Zh.a.Xi),this.hrb[h]=this.L_g[h]=this.yUb[h]=b,x!==Zh.a.Xi&&(this.VWg[h]=this.HDe[h]=x-1)):n&&(x=this.$Rh(b,h,this._pageContent,this.Cf),b=Zh.a.RCc,x&&(b=x.ia(ie.a.bX,Zh.a.RCc)),this.hrb[h]=this.yUb[h]=b)}}Object(r.a)(wh,"WordList",ct,[]);class Ow extends LA{constructor(b){super(b.hd,
b.pageContentNode,b.mIb,b.Qhj);this.iVg=new Qa.a}yvl(b,h,n){let x;bo.a.getInstance().BT?{value:x}=this.Cf.oQ.Dc(b,x):{value:x}=this.Cf.nQ.Dc(b,x);this.D7a.xb(x)||this.D7a.Z(x,new wh(b,n,this.oz,this.mV,this.Cf,this.Dwc));if(!this.iVg.contains(b))for(this.iVg.add(b);h<Zh.a.pfa;h++)this.D7a.J(x).Wej(b,h,!1);else if(!h)for(h+=1;h<Zh.a.pfa;h++)this.D7a.J(x).Wej(b,h,!0);return this.D7a.J(x)}uCf(b,h,n){return ct.E6(n)?this.yvl(b,h,n).Zri(h):super.uCf(b,h,n)}}Object(r.a)(Ow,"ListNumberingMap",LA,[]);class Cg{constructor(){this.tfa=
0;this.vjj=!1}}Object(r.a)(Cg,"LastNumber",null,[]);var Ix=d(566),Zz=d(704),$u=d(864);class uy{constructor(){this.startAt=this.g_=0}}Object(r.a)(uy,"WordListRestartInfo",null,[]);class Ho{constructor(b,h,n,x){this.LUd=!1;this.Mr=b;this.sci=n;this.c5b=x;this.Ur=this.Mr.Lw(h);this.outlineElement=new md.GraphIterator;this.outlineElement.fd(h)}static get hd(){return Ho.Cf||(Ho.Cf=Oa.a.instance.resolve("Box4.List.IListReader"))}static set hd(b){Ho.Cf=b}static get Zd(){return bo.a.getInstance()}static D7k(b,
h,n,x=!1,E=!1){var S=h.currentNode;let ma=null;new md.GraphIterator;let Fa=!1,$a=!1;h=h.Rva();const sb=cn.a.Vp(h);sb.moveNext();for(h=sb.iterator;h.currentNode!==S;){let Sb=$a=Fa=!1;var Jb=!1;ec.ListReader.pr&&(Jb=Ho.TXk(h));if(Kf.OutlineElementReader.Nh(h)&&!Jb){Jb=!1;if(h.Zp(4))if(Ho.qti(h,n,!0,x,E))if(ec.ListReader.lZ){if(Sb=!0,ma=new Ho(b,h,!1,!1),sb.moveNext(),sb.iterator===S&&(Fa=!0),x)break}else ma=new Ho(b,h,!1,!1),Fa=!0;else Kf.OutlineElementReader.isEmpty(h,!1)||(Jb=!0),$a=!0;else!Kf.OutlineElementReader.isEmpty(h,
!1)&&h.Zdb(12)&&(Kf.OutlineElementReader.rP(h)||(Jb=!0));!x&&Jb&&ma&&(!n.propertySet.hasProperty(ic.a.listLevel)&&ec.ListReader.pr?ma=null:ma.Ur.level=0)}Sb||sb.moveNext();h=sb.iterator}ma&&(ma.c5b=Fa);if(!ma&&h.wf(1))for(S=!0;h.currentNode;){if(Kf.OutlineElementReader.Nh(h)){if(h.Zp(4)&&Ho.qti(h,n,!1,x,E)){ma=new Ho(b,h,!0,S);break}if(!Kf.OutlineElementReader.isEmpty(h,!1))break}if(!h.wf(1))break;S=!1}ma&&(ma.LUd=$a);return ma}static TXk(b){var h=b.Rb(2);if(!h)return!1;h=Cd.ParagraphReader.wh(b)&&
Ho.Mfm(h);b.nc();return h}static Mfm(b){return Ad.a(b,8)}static qti(b,h,n,x=!1,E=!1){Ho.hd.cD(b);var S=b.currentNode;b.nc();if(S.ia(ic.a.kma,!1)&&!Ho.Zd.fDb)return!1;const ma=Ho.hd.QN(S);(b=h.qr===ma.qr)&&h.listStyle&&1!==h.sr&&(b=h.listStyle===ma.listStyle);Ho.hd.ur&&b&&(h.Yla&&1!==h.sr||h.r1b||E)&&(b=Ho.Ndm(h,ma),h.qr||(b=b&&h.font===ma.font));if(1===h.sr)if(1===ma.sr&&ma.propertySet.hasProperty(Ji.a.Ogb))b=h.G3===ma.G3;else return!1;b&&h.qr&&h.Qz!==Zh.a.Xi&&(b=ma.fq,n&&(x&&1===h.Qz&&1===b||b++),
b=h.Qz===b);b&&(x||h.r1b)&&(h=h.propertySet.ia(ic.a.listID,0),S=S.ia(ic.a.listID,0),0<h&&0<S&&(b=h===S));return b}static Ndm(b,h){h=h.DQd;b.Yla&&(h=h.replace(RegExp("%\\d"),"%1"));return h.toLocaleLowerCase()===b.DQd.toLocaleLowerCase()}static E7k(b,h,n){var x=h.currentNode;let E=null;const S=new md.GraphIterator,ma=b.yL(x,n);var Fa=!1;let $a=!1;S.fd(h);S.nc();for(S.Rb(1);S.currentNode!==x;)$a=Fa=!1,Kf.OutlineElementReader.Nh(S)&&S.Zp(4)&&(h=b.Lw(S),Ho.rti(h,n,!0)?(E=new Ho(b,S,!1,!1),Fa=!0):($a=
!0,h.listID===n.listID&&h.level<=ma.g_&&(E=null))),S.wf(1);E&&(E.c5b=Fa);if(!E&&S.wf(1))for(x=!0;S.currentNode;){if(Kf.OutlineElementReader.Nh(S)&&S.Zp(4)){Fa=b.Lw(S);if(Fa.listID===n.listID&&Fa.level<=ma.g_)break;if(Ho.rti(Fa,n,!1)){E=new Ho(b,S,!0,x);break}}if(!S.wf(1))break;x=!1}E&&(E.LUd=$a);return E}static rti(b,h,n){let x=b.listID===h.listID&&b.level===h.level;x&&h.fq!==Zh.a.Xi&&(b=b.fq,n&&b++,x=h.fq===b);return x}}Ho.Cf=null;Object(r.a)(Ho,"JoinTargetInfo",null,[]);class $z{constructor(){this.action=
0;this.Ur=null}}Object(r.a)($z,"ApplyListInfoWordResult",null,[]);class fz{constructor(b,h,n){this.V8n=b;this.Iec=n;this.wYm=h;this.e8=n-h.fq;this.oTc=h.listID}get delta(){-1!==this.e8&&(this.e8=this.Iec-this.wYm.fq);return this.e8}set delta(b){this.e8=b}}Object(r.a)(fz,"ListTransferInfo",null,[]);class po extends Ei.a{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb){super(b,n,$a);this.ZTa=!1;this.jlc=this.I8c=this.KOb=null;this.ep=E;this.vH=b;this.yQb=h;this.Hc=x;this.vJf={};this.zwe=S;this.Hd=ma;this.Tm=
Fa;this.wc=sb;this.tC=Jb;this.cS=Sb}get E6(){return this.vH.O$}get xm(){return this.vH}get B7(){return this.cS}get pc(){return this.tC}get Xs(){return this.xm.Xs}get pp(){return this.xm.pp}get f9(){return this.xm.f9}get ur(){return this.hd.ur}get C6(){return this.xm.C6}set C6(b){this.xm.C6=b}get GMa(){return this.xm.GMa}set GMa(b){this.xm.GMa=b}get xkb(){return null!=this.Kog?this.Kog:this.Kog=Oa.a.instance.Pa("Box4.List.ISingleLevelListEditor")}r8j(b,h,n,x){w.ULS.sendTraceTag(17622210,324,50,"AdjustAndSetLevel is called in WordEditor.");
const E=n.ia(ad.a.HMd,!1);let S=!1,ma=-1;!E||h.listStyle&&1!==h.sr||(S=!n.ia(ad.a.ntf,!1),ma=n.ia(ad.a.Zuf,-1));b=this.cXb(b,h,!0,S,ma,x,n);E||n.setValue(ad.a.ntf,2===b.action);3===b.action&&!n.hasProperty(ad.a.Zuf)&&b.Ur&&n.setValue(ad.a.Zuf,b.Ur.level)}get pem(){if(null!=this.Ilg)var b=this.Ilg;else{var h;b=this.Ilg=!(null===(h=u.AFrameworkApplication.K)||void 0===h||!h.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfImproveListOeMerge",!1))}return b}merge(b,h,n,x=null){const E=
!this.pem||ec.ListReader.$h(b)||ec.ListReader.$h(h);b=super.merge(b,h,n,x);E&&this.M7();return b}EFi(b,h){this.wqk(b,h)}wqk(b,h){b=this.hd.Ldf(b);const n=this.hd.Ldf(h);-1!==b&&-1!==n&&(b-=n,0<b?this.yQb.value.bDc(h,b):0>b&&this.yQb.value.XNa(h,b,0))}qMi(b){this.hd.cD(b);this.leaveList(b);b.Fg();Of.a.instance.J(3)&&this.M7()}S8n(b,h,n,x){var E=md.GraphIterator.$a(n);E=this.Lw(E);this.T8n(E,b,h,n,x);ob.App.Lgb&&!Ei.a.Zd.KL&&this.U8n(n,x)}Lw(b){this.hd.cD(b);const h=this.qea(b.currentNode);b.nc();return h}eKn(b,
h){this.hd.cD(b);b.currentNode.setValue(ic.a.listID,h);h=this.qea(b.currentNode);b.nc();return h}qea(b){const h=new dn.a;if(Of.a.instance.J(3)){var n=this.hd.uL(b,!1,!0);h.listID=n.listId;h.level=n.listLevel}else h.listID=b.ia(ic.a.listID,0),h.level=b.ia(ic.a.listLevel,-1);h.kma=b.ia(ic.a.kma,!1);this.ur&&(n=this.BFd(b),h.RHn(n));h.fq=b.ia(Ei.a.Zd.iy,Zh.a.Xi);h.NDc=b.ia(Ei.a.Zd.$I,Zh.a.Xi);return h}dXb(b,h){b||vb.a.instance.Yb("CrashWhenApplyingList",{["Reason"]:"ListNodeIsNull"});h||vb.a.instance.Yb("CrashWhenApplyingList",
{["Reason"]:"RefInfoIsNull"});b.setValue(ic.a.listID,h.listID);b.setValue(ic.a.listLevel,h.level);h.kma&&b.setValue(ic.a.kma,!0)}Ufj(b){this.xm.P1(b);b=po.oh.gu(b);let h=b.ia(ic.a.pp,null);h=h?Array.clone(h):[];b.setValue(ic.a.pp,h);this.xm.aCb()}h7i(b){switch(b){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}Hvl(b){b=b.view;if(!b.Cb||!b.Cb.ib)return null;b=T.OutlineElementGeneralizer.Hka(b.Cb.ib,!1);if(1!==b.length)return null;b=
md.GraphIterator.$a(b.getContext(0).node);if(!ec.ListReader.$h(b))if(14===b.Wd().type){const h=this.xm.HOl(b.currentNode);h&&b.set(h)}else sd.b(589177753,393,15,"Encountered an OE of non list type."),b.nc();b.vd();return b}xJk(b,h,n,x){const E=b.MG(),S=new dn.a;S.listID=this.Tsh(b);this.E6?(S.LQd=Ei.a.Zd.BT?this.Ush(b):this.Lsh(b),this.gJi(b,S.listID,S.LQd)):this.iJi(b,S.listID);S.gYi(h.propertySet,this.QPc(n));this.Ozd(b);n=this.fSh(b,h);for(let Fa=0;9>Fa;Fa++){const $a=new Cs.a;E.Ad.Gu($a);this.hJi(b,
this.E6?C.a.nil:$a.id,this.E6?$a.id:C.a.nil);this.G0j($a,h.qr,Fa);this.k7g($a,n,Fa);var ma=x.gEb[Fa];ma=6===ma?nr.a.wP(1,1):nr.a.wP(0,ma);ma.ima&&$a.setValue(ie.a.M2,ma.ima);h.Qz!==Zh.a.Xi&&Fa===S.level&&$a.setValue(ie.a.bX,h.Qz);x.qAa&&x.qAa[Fa]&&$a.setValue(ie.a.font,x.qAa[Fa]);ma=x.SPc[Fa];w.ULS.shipAssertTag(22127636,338,!!ma);$a.setValue(ic.a.Qr,ma);$a.setValue(ic.a.baa,x.UPd[Fa]);tt.a.s6d(x.G3,$a)}return S}wJk(b,h,n){const x=b.MG(),E=new dn.a;E.listID=this.Tsh(b);this.E6?(E.LQd=Ei.a.Zd.BT?this.Ush(b):
this.Lsh(b),this.gJi(b,E.listID,E.LQd)):this.iJi(b,E.listID);E.gYi(h.propertySet,this.QPc(n));if(!h.listStyle)switch(E.level%3){case 0:h.n7(h.listType,1);break;case 1:h.n7(h.listType,2);break;case 2:h.n7(h.listType,3)}this.Ozd(b);n=this.fSh(b,h);for(let S=0;9>S;S++){const ma=new Cs.a;x.Ad.Gu(ma);this.hJi(b,this.E6?C.a.nil:ma.id,this.E6?ma.id:C.a.nil);this.F0j(ma,h.qr,S);this.k7g(ma,n,S);this.ur&&(2===S%3&&h.qr?ma.setValue(ic.a.baa,"right"):ma.setValue(ic.a.baa,"left"));S===E.level&&(h.ima&&ma.setValue(ie.a.M2,
h.ima),h.Qz!==Zh.a.Xi&&ma.setValue(ie.a.bX,h.Qz),this.ur&&(h.qr?this.mYi(h,ma,S):(po.jYi(h,ma),po.lYi(h,ma)),po.kYi(h,ma)),hv.a.yNc&&h.r1b&&ma.UH(h.propertySet,ic.a.listID,ic.a.listLevel))}return E}mYi(b,h,n){b.Yla?(b=b.levelText,b=B.a.replaceAll(b,"%1","%"+(n+1))):b=b.iMc||b.Bea?b.levelText:"%"+(n+1)+".";w.ULS.shipAssertTag(22127638,338,!!b);h.setValue(ic.a.Qr,b)}h2i(b,h,n,x){if(b.iMc)return!1;if(1===b.sr)return x;if(x)return!0;if(h){x=b.listType===h.listType;const E=!b.listStyle&&b.Qz===Zh.a.Xi;
let S=b.listStyle===h.listStyle&&b.Qz===h.Qz;this.ur&&(b=(!b.Yla||this.lUf(h,b))&&!n,S=S&&b);return x&&(E||S)}return!1}Ozd(b){this.KOb||(this.KOb=b.ia(ic.a.gPk,null));this.I8c||(this.I8c=b.ia(ic.a.fPk,null));this.jlc||(this.jlc=b.ia(ic.a.hPk,null))}QPc(b){720>b&&(b=0);b=Math.floor(b/720);0>b&&(b=0);8<b&&(b=8);return b}iJi(b,h){const n=b.ia(ic.a.Xs,null),x=n?n.length:0,E=Array(x+1);let S=0;for(;S<x;S++)E[S]=n[S];E[S]=h;b.setValue(ic.a.Xs,E);this.xm.aCb()}gJi(b,h,n){this.XMe(ic.a.Xs,b,h);if(Ei.a.Zd.BT){this.XMe(wi.a.A9b,
b,n);var x=this.xm.xFd(b);x.add(h,n);b.setValue(wi.a.oQ,Zz.b(LB.a.Qfc(x)))}else this.XMe(ic.a.f9,b,n),x=this.xm.wFd(b),x.add(h,n),b.setValue(ic.a.nQ,Zz.b(LB.a.Qfc(x)))}hJi(b,h,n){this.E6?(this.Z6g(ic.a.pp,b,n),this.Z6g(ic.a.U2,b,h)):(n=(n=b.ia(ic.a.pp,null))?Array.clone(n):[],n.push(h),b.setValue(ic.a.pp,n),this.xm.aCb())}XMe(b,h,n){const x=h.ia(b,null),E=x?x.length:0,S=Array(E+1);let ma=0;for(;ma<E;ma++)S[ma]=x[ma];S[ma]=n;h.setValue(b,S)}Z6g(b,h,n){let x=h.ia(b,null);x=x?Array.clone(x):[];x.push(n);
h.setValue(b,x)}F0j(b,h,n){var x=n%3+1;if(ec.ListReader.pr){const E=h?this.jlc:this.I8c;E&&n<E.length?b.setValue(ic.a.$s,E[n]):b.setValue(ic.a.$s,360)}x=ec.ListReader.lZ?nr.a.wP(h?0:1,this.h7i(x),null,0,n):nr.a.wP(h?0:1,this.h7i(x));b.ys(x.propertySet);b.setValue(ic.a.uRe,h?-1:-2);this.ur&&(h?b.setValue(ic.a.Qr,"%"+(n+1)+"."):(b.setValue(ie.a.font,this.snl(n)),b.setValue(ic.a.Qr,String.fromCharCode(this.inl(n)))),tt.a.pdc(2,b))}G0j(b,h,n){if(ec.ListReader.pr){const x=h?this.jlc:this.I8c;x&&n<x.length?
b.setValue(ic.a.$s,x[n]):b.setValue(ic.a.$s,360)}b.setValue(ic.a.uRe,h?-1:-2);tt.a.pdc(1,b)}inl(b){switch(b%3){case 0:return 61623;case 1:return 111;case 2:return 61607;default:return 61623}}snl(b){switch(b%3){case 0:return"Symbol";case 1:return"Courier New";case 2:return"Wingdings";default:return"Symbol"}}Tsh(b){if(this.E6)this.C6<Zh.a.dQc&&this.xm.P1(b),this.C6=this.cTh(this.Xs,this.C6,Zh.a.dQc);else{if(this.C6<Zh.a.dQc&&(this.xm.P1(b),this.Xs&&this.pp)){b=this.Xs.length;for(let h=0;h<b;h++)this.Xs[h]>=
this.C6&&(this.C6=this.Xs[h])}this.C6+=1}return this.C6}Lsh(b){this.GMa<Zh.a.Nod&&this.xm.P1(b);return this.GMa=this.cTh(this.f9,this.GMa,Zh.a.Nod)}Ush(b){var h;this.xm.P1(b);do b=Math.floor(Math.random()*(po.bEm-po.Mpi))+po.Mpi;while(null===(h=this.xm.pFb)||void 0===h?0:h.includes(b));return b}cTh(b,h,n){if(h<n&&b){n=b.length;for(let x=0;x<n;x++)b[x]>h&&(h=b[x])}h++;return h}QRf(b,h,n){po.hOc||this.b9e(b,h,n,Object(v.a)(this,this.T_c,"siblingMatchesListAndLevel"),Object(v.a)(this,this.aXn,"siblingRenumberSimple"))}Nrn(b,
h,n,x=!1){this.b9e(b,h,n,Object(v.a)(this,this.T_c,"siblingMatchesListAndLevel"),Object(v.a)(this,this.b4i,"siblingRenumberAndUpdateSublistsDelta"),null,x)}Mrn(b,h,n){this.$al(b,h,n,Object(v.a)(this,this.T_c,"siblingMatchesListAndLevel"),Object(v.a)(this,this.a4i,"siblingRenumberAndUpdateSublists"))}PRf(b,h,n){const x=vb.a.instance.oo(Db.a.PRf);1>Math.abs(n)&&vb.a.instance.Yb("PossiblyIncorrectListPromoteDemote",{["Reason"]:"DepthIsIncorrect"});(h<Nn.a.n8e||h>Nn.a.nQd)&&vb.a.instance.Yb("PossiblyIncorrectListPromoteDemote",
{["Reason"]:"LevelHasInvalidRange"});(h+n<Nn.a.n8e||h+n>Nn.a.nQd)&&vb.a.instance.Yb("PossiblyIncorrectListPromoteDemote",{["Reason"]:"Level+DepthHasInvalidRange"});const E={};let S=null;const ma=this.Lw(b);const Fa=b.currentNode,$a=ma.listID,sb=h+n;let Jb,Sb=Zh.a.Xi,oc=!0,Ic=!0,gd=!1;const Gd=Array(9);let vd=!1,ce=!1;var od=new dn.a;od.listID=ma.listID;od.level=ma.level+n;od=this.xm.pea(b.currentNode,od);var Yd=this.hd.Es(b);od=od.qr;const ne=Yd.qr,Df=this.ur&&(od||ne);if(ne||od){var Af=new dn.a;
Af.listID=ma.listID;Af.level=h;E[h.toString()]=this.yL(Fa,Af);Yd=E[h.toString()].g_;Af.level=sb;E[sb.toString()]=this.yL(Fa,Af);Jb=E[sb.toString()].g_;for(var Wi=0;9>Wi;Wi++)Gd[Wi]=!1;Wi=new md.GraphIterator;Wi.fd(b);Af=Wi.Rva();var gm=cn.a.Ir(Wi,Af);for(gm.moveNext();gm.moveNext();){Wi=gm.iterator;var Ck=void 0;let ls;if(Wi.Zp(4)&&(Af=this.Lw(Wi),Af.listID===$a)){var Rm=this.hd.Es(Wi);var Qr=Rm.qr;Af.level<=Yd&&(oc=!1);Af.level<=Jb&&(Ic=!1);if(!oc&&!Ic)break;ls=Af.level.toString();E[ls]||(E[ls]=
this.yL(Fa,Af));Rm=E[ls];this.Hso(Rm,Gd)||(Rm.g_>=h?(S||(S=this.hXe(ma,b,E)),Ck=Zh.a.Xi,S[ls]?Ck=!this.ur||Qr?S[ls]+1:Zh.a.Xi:Af.level===sb&&(Ck=!this.ur||Qr?Rm.startAt:Zh.a.Xi),Ck!==Zh.a.Xi?(Af.level!==sb||gd||(Sb=Ck,gd=!0,this.hd.cD(Wi),Wi.nc(),Ck++),this.bwb(Wi,Ck),S[ls]=Ck):Df&&this.L6f(Wi,Af)):Rm.g_>=sb?(S||(S=this.hXe(ma,b,E)),Ck=Gd[Af.level]?!this.ur||Qr?S[ls]+1:Zh.a.Xi:!this.ur||Qr?Rm.startAt:Zh.a.Xi,this.ur&&Ck===Zh.a.Xi?Df&&this.L6f(Wi,Af):this.bwb(Wi,Ck),S[ls]=Ck):Af.level===h&&ne||Af.level===
sb&&od?(this.hd.cD(Wi),Ck=Wi.currentNode,Wi.nc(),Ck=Ck.getValue(Ei.a.Zd.iy),Qr=Ck===(Rm.startAt===Zh.a.Xi?1:Rm.startAt)+1,Af.level===h?!(0>n)&&Qr||vd?vd=!0:Ck--:(ce?Ck--:0>n&&Qr&&this.Qpf(Wi,Rm,null)&&(Ck--,ce=!0),gd||(Sb=Ck,gd=!0),Ck++),this.bwb(Wi,Ck)):Af.level!==h&&Af.level!==sb||!Df||this.L6f(Wi,Af),Gd[Af.level]=!0)}}od&&!gd&&(h=E[sb.toString()],ma.level=sb,Sb=this.sPc(ma,b,h).tfa,Sb===Zh.a.Xi?Sb=h.startAt:Sb++);od&&this.bwb(b,Sb)}x.end()}wdh(){this.M7()}M7(){var b=null,h,n;if(Of.a.instance.J(3)){var x=
new md.GraphIterator;if(b)if(8===b.type)x.set(b);else{w.ULS.sendTraceTag(592535635,393,15,"Unable to update lists number as cannot navigate to page content node.");return}else x.set(ob.App.xa.jb.Zc),po.oh.z5f(x),b=po.oh.gu(x.currentNode);if(x.Bb(7)||x.kd(7)){x=cn.a.Ir(x,x.origin);var E=new Ow({hd:this.xm,pageContentNode:b,mIb:null,Qhj:!1});for(b=new Ow({hd:this.xm,pageContentNode:b,mIb:null,Qhj:!1});x.moveNext();){var S=x.iterator;if(!S.Zp(4)&&!S.Zp(31))continue;this.hd.cFb(S);const Fa=S.currentNode;
S.nc();if(!Fa){w.ULS.sendTraceTag(575813713,393,15,"List Node comes out to be null while updating numbering. Iterator Valid {0}",S.Qd);continue}if(!this.E6&&63!==Fa.type&&this.hd.QN(Fa).listType)continue;var ma=this.hd.uL(Fa,!1,!1);if(this.E6&&ma&&this.hd.VNd(ma.listId)){w.ULS.sendTraceTag(592535636,393,50,"Skipping updating list numbers for this list id {0}",ma.listId);continue}const $a=Object(ja.a)(Tc.AParagraphNode,wf.OutlineElementNavigator.He(S,!0));$a&&($a.qa?(null==$a.qa.last&&w.ULS.sendTraceTag(540374985,
393,15,"Unexpected : Encountered last of para character properties null."),S.nc(),this.E6&&this.xm.P1(S.currentNode),12===$a.type&&($a.gj&&$a.FA.hasProperty(ic.a.listID)||null===(h=$a.qa.last)||void 0===h||!h.Yi)&&((S=this.hd.uL(Fa,!0,!0))?this.oYi(Fa,b,Ei.a.Zd.Shc,S):w.ULS.shipAssertTag(24475424,376,!0,"The previous number list ID is not found! List Node Type={0}",Fa.type)),!ma||null!==(n=$a.qa.last)&&void 0!==n&&n.ei||!this.oYi(Fa,E,Ei.a.Zd.iy,ma)||(ma=Fa.getValue(Ei.a.Zd.iy),this.E6&&this.hd.QN(Fa).listType||
Fa.setValue(Ei.a.Zd.$I,ma))):w.ULS.shipAssertTag(24975004,376,!0,"The paragraph node has null CharacterProperties! Skipping."))}}else w.ULS.shipAssertTag(593234060,376,7===x.Se,"Couldnt reach to page manifest node")}}oYi(b,h,n,x){n||w.ULS.shipAssertTag(571757918,393,!!n,"Prop definition is null");h=h.uCf(x.listId,x.listLevel,this.wc);x=-1;b.hasProperty(n)&&(x=b.getValue(n));return h===x||this.E6&&63!==b.type&&this.hd.QN(b).listType&&(!Ei.a.Zd.Xea||n!==Ei.a.Zd.Shc||1!==this.hd.QN(b).listType)?!1:(b.setValue(n,
h),!0)}L6f(b,h){this.hd.cD(b);const n=b.currentNode;b.nc();n&&this.hd.N$(n)&&this.d9e(b,h,Object(v.a)(this,this.Lxf,"matchesListId"),Object(v.a)(this,this.C1f,"sublistsUpdateListItem"))}Qpf(b,h,n){let x=!1,E=!0,S=0;const ma=this.Lw(b),Fa=b.currentNode;let $a=null;b=b.Rva();b=cn.a.Vp(b);for(b.Om($u.a.w_a,null);b.moveNext();){const sb=b.iterator.currentNode;if(sb===Fa)break;if(!ec.ListReader.o2(sb))continue;const Jb=this.Lw(b.iterator);Jb.listID===ma.listID&&(Jb.level>ma.level?(x=!0,$a=sb,S++):Jb.level===
ma.level?(E=!1,$a=null,S=0):Jb.level<=h.g_&&(E=!0,$a=null,S=0))}return x&&E&&(!n||1===S&&$a===n)}Hso(b,h){for(b=b.g_;0<=b;b--)if(h[b])return!0;return!1}bwb(b,h){this.hd.cD(b);const n=b.currentNode;b.nc();const x=this.Lw(b);x&&this.xm.j8b(n,x.listID,x.level)?this.Mrn(b.currentNode,x,h):po.hOc||(n.setValue(Ei.a.Zd.iy,h),n.setValue(Ei.a.Zd.$I,h))}Orn(b,h,n){const x={};let E=null;const S=new md.GraphIterator;const ma=b.fq===h.startAt;let Fa=!1;var $a=new md.GraphIterator;$a.fd(n);var sb=n.Rva();sb=cn.a.Ir($a,
sb);sb.Om($u.a.w_a,null);sb.moveNext();let Jb=!1;for(;sb.moveNext();)if(S.fd(sb.iterator),S.Zp(4)){var Sb=this.Lw(S);if(Sb.listID===b.listID)if(Sb.level>b.level)Fa=!0,$a=Sb.level.toString(),x[$a]||(x[$a]=this.yL(n.currentNode,Sb)),Sb=x[$a].g_,Sb===b.level&&(E||(E=this.hXe(b,n,x)),E[$a]&&(Sb=E[$a]+1,this.bwb(S,Sb),E[$a]=Sb));else if(Sb.level===b.level||Sb.level<=h.g_){Jb=!0;break}}return!Jb||ma&&Fa?null:S}Lrn(b){ec.ListReader.$h(b)||vb.a.instance.Yb("PossiblyIncorrectListRenumber",{["Reason"]:KA.a.Yxb});
const h=this.Lw(b);var n=this.yL(b.currentNode,h);const x=b.Rb(4);x.removeProperty(Ei.a.Zd.Shc);b.nc();const E=this.WFc(b,h,Object(v.a)(this,this.B1f,"sublistsEnsureSameList"),Object(v.a)(this,this.t7i,"sublistsUpdateLevel"));if(this.hd.Es(b).qr){var S=null;E&&(S=this.Lw(E));S&&S.listID===h.listID&&S.level===h.level?n=this.hd.Es(E).fq:(S=this.sPc(h,b,n),n=S.tfa===Zh.a.Xi?n.startAt:S.tfa+1);n!==Zh.a.Xi&&(x.setValue(Ei.a.Zd.iy,n),x.setValue(Ei.a.Zd.$I,n));E&&this.QRf(E.currentNode,h,1)}b.z3b()&&ec.ListReader.$h(b)&&
(b=this.hd.Es(b),b.qr&&(b.Pda=b.fq))}get J1i(){return this.ur}jSh(b){const h=this.hd.Es(b);if(this.ur){h.r1b=!0;this.hd.cD(b);const n=b.currentNode.ia(ic.a.listID,0);h.propertySet.setValue(ic.a.listID,n);b.kd(11)}return h}hXe(b,h,n){const x={},E=new md.GraphIterator,S=h.currentNode;var ma=h.Rva();const Fa=cn.a.Vp(ma);for(Fa.Om($u.a.w_a,null);Fa.moveNext();){E.fd(Fa.iterator);if(E.currentNode===S)break;if(E.Zp(4)&&(ma=this.Lw(E),ma.listID===b.listID)){if(ma.level>b.level){this.hd.cD(E);var $a=E.currentNode;
E.nc();x[ma.level.toString()]=$a.ia(Ei.a.Zd.iy,Zh.a.Xi)}for($a=ma.level;$a<=Nn.a.nQd;$a++){const sb=$a.toString();x[sb]&&(n[sb]||(n[sb]=this.yL(h.currentNode,ma)),n[sb].g_>=ma.level&&delete x[sb])}}}return x}sPc(b,h,n){const x=new md.GraphIterator,E=h.currentNode;let S;var ma=Zh.a.Xi;let Fa=!1,$a=!1,sb=!1,Jb=null;var Sb=h.Rva();Sb=cn.a.Vp(Sb);for(Sb.Om($u.a.w_a,null);Sb.moveNext();){x.fd(Sb.iterator);if(x.currentNode===E)break;Fa=!1;x.Zp(4)&&(S=this.Lw(x),S.listID===b.listID&&(S.level===b.level?(this.hd.cD(x),
ma=x.currentNode,x.nc(),ma=ma.ia(Ei.a.Zd.iy,Zh.a.Xi),Fa=!0,Jb=x.Tgc(1),$a=!0):S.level>b.level?sb=!0:S.level<=n.g_&&(ma=Zh.a.Xi,sb=$a=!1)))}!$a&&sb&&(ma=n.startAt);Fa&&(Fa=h.Tgc(1)===Jb);b=new Cg;b.tfa=ma;b.vjj=Fa;return b}rOi(b,h=!1,n=0){const x=this.qea(b),E=this.yL(b,x),S=this.xm.pea(b,x);var ma=new md.GraphIterator;const Fa=S.qr;let $a=E.startAt,sb=!1,Jb=!1;w.ULS.shipAssertTag(22127639,338,S.Bea,"Info does not have a level Text. ListNode.LevelText = {0}",b.ia(ic.a.Qr,null));const Sb=S.listStyle;
ma.set(b);if(ma.vd()&&(b=ma.IOa()))for(b=cn.a.Vp(b),b.Om($u.a.w_a,x);b.moveNext();){ma=b.iterator.currentNode;if(!ec.ListReader.o2(ma))continue;var oc=this.Lw(b.iterator);h&&oc.listID===n&&(oc=this.eKn(b.iterator,x.listID));if(oc.listID!==x.listID)continue;const Ic=b.iterator.Rb(4);Ic&&b.iterator.nc();oc.level>x.level?(this.xm.j8b(Ic,x.listID,oc.level)&&this.jnf(ma,Ic),Jb=!0):(oc.level<=E.g_?($a=E.startAt,Jb=sb=!1):(oc=this.Hqi(b,Sb),this.ur&&oc.currentNode.setValue(ic.a.Qr,S.DQd),{eUi:sb,tfa:$a}=
this.tOi(Fa,Jb,sb,oc,$a,ma)),po.G8h(b))}}jnf(b,h){w.ULS.shipAssertTag(22819227,338,!!b&&!!h);ec.ListReader.ufa?h.setValue(uc.a.kvf,C.a.create().toString()):b.setValue(uc.a.kvf,C.a.create().toString())}Jrn(b){if(!Ei.a.Zd.Pfb){var h=this.qea(b),n;this.yL(b,h);var x=this.xm.pea(b,h),E=x.qr,S=Array(10),ma=Array(10),Fa=null;w.ULS.shipAssertTag(22127640,338,x.Bea,"Info does not have a level Text. ListNode.LevelText = {0}",b.ia(ic.a.Qr,null));var $a=x.listStyle;var sb=new md.GraphIterator;sb.set(b);if(sb.vd()&&
(sb=sb.IOa()))for(sb=cn.a.Vp(sb),sb.Om($u.a.w_a,h);sb.moveNext();){var Jb=sb.iterator.currentNode;if(!ec.ListReader.o2(Jb))continue;const Sb=this.Lw(sb.iterator);if(Sb.listID!==h.listID)continue;(n=sb.iterator.Rb(4))&&sb.iterator.nc();const oc=Sb.level;Fa=Fa?Fa.level:-1;h=this.qea(n);n=this.yL(n,h);this.jnf(Jb,b);if(Fa<oc||void 0===S[oc]||null===S[oc])S[oc]=n.startAt,ma[oc]=!1;n=this.Hqi(sb,$a);n.currentNode.setValue(ic.a.Qr,x.DQd);({eUi:ma[void 0],tfa:S[void 0]}=this.tOi(E,Fa>oc,ma[oc],n,S[oc],Jb));
Fa=Sb;po.G8h(sb)}}}Hqi(b,h){b=b.iterator;this.hd.cD(b);Ei.a.Zd.Pfb||this.JJn(b.currentNode,h);return b}tOi(b,h,n,x,E,S){b?(h&&!n&&E++,wf.OutlineElementNavigator.ae(x),this.bwb(x,E),E++,n=!0,ec.ListReader.pr&&(x.Rb(2),Ix.a.k6b(x.currentNode)&&x.currentNode.Sj(4,!0))):(x.currentNode.removeProperty(Ei.a.Zd.iy),wf.OutlineElementNavigator.ae(x));S.Sj(4,!0);(b=x.rp(16))&&b.Sj(8,!0);return{eUi:n,tfa:E}}JJn(b,h){b.setValue(ic.a.listStyle,h)}yL(b,h){const n=vb.a.instance.oo(Db.a.yL),x=new uy;(b=this.xm.Kw(b,
h.listID,h.level))?(x.g_=b.ia(ic.a.VXc,h.level-1),x.startAt=b.ia(ie.a.bX,1)):vb.a.instance.Yb("PossiblyIncorrectListRestartValue",{["Reason"]:"listPropsIsNull"});n.end();return x}tLk(b){const h=mn.a.instance.createInstance(1074135151);b.Sf(h,31)}T8n(b,h,n,x,E){const S=this.createList(h);h.nc();this.dXb(S,b);h=this.xm.pea(h.currentNode,b);h.listType||(S.setValue(Ei.a.Zd.iy,b.fq),S.setValue(Ei.a.Zd.$I,b.NDc),this.P2d(S,b,n?x:E,1));switch(h.listType){case 0:n="Numbering";break;case 1:n="Bullet";break;
default:n="Invalid List Type"}u.AFrameworkApplication.ya.processAction(Db.a.joinList,2);w.ULS.sendTraceTag(38544079,393,50,"List Actions : Join List - {0}",n);ec.ListReader.lZ&&(S.setValue(ic.a.listID,b.listID),S.setValue(ic.a.listLevel,b.level))}U8n(b,h){b=md.GraphIterator.$a(b).Rb(4);h=md.GraphIterator.$a(h).Rb(4);b.hasProperty(ie.a.fontColor)&&h.setValue(ie.a.fontColor,b.getValue(ie.a.fontColor));b.hasProperty(ie.a.fontSize)&&h.setValue(ie.a.fontSize,b.getValue(ie.a.fontSize));b.hasProperty(ie.a.font)&&
h.setValue(ie.a.font,b.getValue(ie.a.font));b.hasProperty(ic.a.we)&&h.setValue(ic.a.we,b.getValue(ic.a.we));b.hasProperty(ie.a.bold)&&h.setValue(ie.a.bold,b.getValue(ie.a.bold));b.hasProperty(ie.a.italic)&&h.setValue(ie.a.italic,b.getValue(ie.a.italic));b.hasProperty(ie.a.superscript)&&h.setValue(ie.a.superscript,b.getValue(ie.a.superscript));b.hasProperty(ie.a.subscript)&&h.setValue(ie.a.subscript,b.getValue(ie.a.subscript));b.hasProperty(ie.a.strikethrough)&&h.setValue(ie.a.strikethrough,b.getValue(ie.a.strikethrough))}kMi(b){if(Of.a.instance.J(10)){var h=
this.pc.yo(b);h?this.pc.tf(h)===jh.StyleReader.wordStyleIdListParagraph&&(h=this.pc.Nx(b),this.B7.hM(h.uh(jh.StyleReader.wordStyleIdNormal),b,!0,!1,!1,this.ZTa&&u.AFrameworkApplication.K.$("WordEditorSkipTrackingChangeForList"))):w.ULS.shipAssertTag(8271188,315,!1)}}DJn(b){if(Of.a.instance.J(10)){if(this.pc.tf(this.pc.yo(b))===jh.StyleReader.wordStyleIdNormal){const h=this.pc.Nx(b);this.B7.hM(h.uh(jh.StyleReader.wordStyleIdListParagraph),b,!0,!0)}b.Qg(ic.a.ge,ic.a.CQ,ic.a.QB,ic.a.ZZ,ic.a.$s,ic.a.Lfa);
b.setValue(ic.a.MNa,0)}}krk(b,h){const n=b.getValue(ic.a.listID),x=b.getValue(ic.a.listLevel);for(let S=0;9>S;S++){const ma=this.xm.Kw(b,n,S);if(!ma)return vb.a.instance.Yb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),null;var E=h.gEb[S];E=6===E?nr.a.wP(1,1):nr.a.wP(0,E);E.ima&&ma.setValue(ie.a.M2,E.ima);ma.hasProperty(ie.a.font)&&ma.removeProperty(ie.a.font);h.qAa&&h.qAa[S]&&ma.setValue(ie.a.font,h.qAa[S]);E=h.SPc[S];w.ULS.shipAssertTag(22127641,338,!!E);ma.setValue(ic.a.Qr,E);ma.setValue(ic.a.sr,
tt.a.l9b);tt.a.s6d(h.G3,ma);ma.setValue(ic.a.baa,h.UPd[S]);ma.Qg(ic.a.VXc,ie.a.bX);this.Ufj(b)}this.Jrn(b);b=new dn.a;b.listID=n;b.level=x;return b}Fjh(b,h,n,x=null){if(this.ur&&x)return this.krk(b,x);x=b.getValue(ic.a.listID);const E=b.getValue(ic.a.listLevel),S=this.xm.Kw(b,x,E);if(!S)return vb.a.instance.Yb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),h&&w.ULS.sendTraceTag(588022420,393,15,"List def is null for List Style {0}, List type {1}, ListId {2} and level {3}",h.listStyle,
h.listType,x,E),null;hv.a.yNc&&h.r1b&&(S instanceof Gx.APropertySet?S.UH(h.propertySet,ic.a.listID,ic.a.listLevel):w.ULS.sendTraceTag(527991759,393,15,"ListDefintion was not an instance of APropertySet, it is an instance of {0}",null===S||void 0===S?void 0:S.constructor.name));var ma=S.ia(ic.a.sr,null);ma&&ma===tt.a.l9b&&this.jrk(b,x);if(!h.listStyle){ma=0;if(-1!==n){for(ma+=E-n;0>ma;)ma+=3;ma%=3}switch(ma){default:n=1;break;case 1:n=2;break;case 2:n=3}h.n7(h.listType,n)}h.ima&&S.setValue(ie.a.M2,
h.ima);this.ur&&(h.qr?(this.mYi(h,S,E),S.hasProperty(ie.a.font)&&S.removeProperty(ie.a.font)):(po.jYi(h,S),po.lYi(h,S)),po.kYi(h,S));S.Qg(ic.a.VXc,ie.a.bX,ic.a.WNc);this.Ufj(b);Ei.a.Zd.Pfb||this.rOi(b);b=new dn.a;b.listID=x;b.level=E;return b}jrk(b,h){let n;for(let x=0;9>x;x++){n=this.xm.Kw(b,h,x);if(!n){w.ULS.sendTraceTag(588022421,393,15,"List def is null for List id {0}, List level {1}",h,x);break}n.setValue(ic.a.sr,tt.a.wKd);n.removeProperty(Ji.a.Ogb)}}J5d(b,h){const n=vb.a.instance.oo(Db.a.J5d);
this.yQb.value||vb.a.instance.Yb("PossibleIncorrectListIndentation",{["Reason"]:"IOutlineElementIndentationEditorIsNull"});this.dTa?(n.properties.Z("PendingListInfo","true"),ec.ListReader.$h(b)&&(n.properties.Z("RemoveCurrentListInfo","true"),this.ZTa=!0,this.$Ia(b,null,!0,!1,-1),this.yQb.value.XNa(b,-1,0),this.ZTa=!1),this.cXb(b,this.dTa,!1,!0,-1,!1,null,ec.ListReader.lZ),this.dTa=null):h||(n.properties.Z("CurrentlyUnderPastedList","true"),this.$Ia(b,null,!1,!1,-1));n.end()}XWf(b,h,n,x){const E=
vb.a.instance.oo(Db.a.XWf);if(ec.ListReader.$h(b)&&Kf.OutlineElementReader.isEmpty(b,!1))this.yQb.value.VTe(b,-1)?this.yQb.value.XNa(b,-1,0):this.$Ia(b,null,!1,!1,-1);else{const S=!n.cpBegin,ma=n.cpBegin===Cd.ParagraphReader.textLength(x),Fa=Of.a.instance.J(4)&&ob.App.rd.Kp;let $a=!0;Fa&&S&&!ma?($a=!1,x=new md.GraphIterator,x.fd(b),x.vd(),this.Kh.XC(x,!0,!1)):x=this.Kh.cta(b);this.Kh.dba(b,x,n,!1,!0,$a,!1,h);!Fa||S||ma||(h=po.Tg.$af(n),ob.App.rd.Jq.sG(h));this.ZTa||(wf.OutlineElementNavigator.He(b),
h=b.currentNode,wf.OutlineElementNavigator.ae(b),ec.ListReader.$h(b)&&h.gj&&!h.FA.hasProperty(ic.a.listID)&&(wf.OutlineElementNavigator.He(x),b=x.currentNode,x=new Cs.a,b.Nc.Gu(x),this.Tm.gM(b,x,this.Hd.wg)),this.M7())}E.end()}D6d(b,h){var n;if(ec.ListReader.$h(b))return!1;b.Rb(2);var x=ud.a.lfk;const E=[!0,!1].map(S=>Cd.ParagraphReader.Vg(b.currentNode,S,void 0,!1));b.nc();for(let S=0;S<E.length;S++){const ma=E[S];if(ma&&!ec.ListReader.Nla(ma))for(const Fa of x)if(Fa.test(ma.characterData))return x=
null===(n=Fa.exec(ma.characterData))||void 0===n?void 0:n[0],this.ogn(h,S?"nextPara":"prevPara",x),!1}return!0}ogn(b,h,n){const x=new Map;x.set("CurrentAutoListPreventedAutoListText",b);x.set("UndoAutoListPreferenceFoundIn",h);x.set("UndoAutoListPreferenceAutoListText",n);ta.Health.instance.recordKpiUsage(Zh.a.oPc.kmn,0,Zh.a.vB,x)}iTn(b,h){return b&&h}HQf(b){for(let h=0;h<b.count;h++){const n=md.GraphIterator.$a(b.J(h));n.qo();this.vDa(n)}b.clear()}sOi(b){if(ec.ListReader.o2(b)){if(!po.hOc){const h=
new md.GraphIterator;h.set(b);h.vd();this.Lrn(h)}this.M7()}}FOf(b,h){b=new md.GraphIterator;b.set(h);b.vd();wf.OutlineElementNavigator.ae(b);b.Ydb(h)||vb.a.instance.Yb("PossibleLossOfDirectFormatting",{["Reason"]:"OeDoesNotContainParagraph"});this.$Ia(b,null,!0,!1,-1);return super.FOf(b,h)}eYi(b,h,n){this.Kh.mva(b,h,n,!0)}iYi(b){b.n7(1,1)}ard(b,h){const n=vb.a.instance.oo(Db.a.Lbk);if(this.pc.tI(h.Yh())){if(ec.ListReader.$h(b)&&this.cXb(b,null,!0,!1,-1),h=this.xm.rSh(h)){n.properties.Z("EarlyReturn",
"False");this.xm.pea(b.currentNode,h);var x=Ho.E7k(this,b,h),E=this.createList(b);b.nc();if(x)this.joinList(E,x,!0);else{if(x=this.WFc(b,h,Object(v.a)(this,this.B1f,"sublistsEnsureSameList"),Object(v.a)(this,this.t7i,"sublistsUpdateLevel"))){const S=this.Lw(x);if(S.listID===h.listID&&S.level<h.level&&this.hd.Es(x).qr){const ma=this.yL(x.currentNode,S);S.fq===(ma.startAt===Zh.a.Xi?1:ma.startAt)&&(S.NDc=S.fq,this.P2d(E,S,x.currentNode,1))}}x=this.yL(E,h);b=this.sPc(h,b,x);b=b.tfa!==Zh.a.Xi?b.tfa+1:
x.startAt===Zh.a.Xi?1:x.startAt;this.dXb(E,h);E.setValue(Ei.a.Zd.iy,b);E.setValue(Ei.a.Zd.$I,b)}E.setValue(ic.a.kma,!0);n.end()}}else vb.a.instance.Yb("PossiblyIncorrectListStyle",{["Reason"]:"StyleContainerNotValid"})}P2d(b,h,n,x,E=!1){this.xm.j8b(b,h.listID,h.level)?this.Nrn(n,h,x,E):this.QRf(n,h,x)}xbh(b,h,n,x,E=null){b=this.ur&&E?this.xJk(b,n,x,E):this.wJk(b,n,x);this.dXb(h,b);n.listType||(x=n.Qz,x===Zh.a.Xi&&(x=1),h.setValue(Ei.a.Zd.iy,x),h.setValue(Ei.a.Zd.$I,x));this.ur&&(n.Bea?(n=n.levelText,
E||(n=n.replace("%1","%"+(b.level+1))),h.setValue(ic.a.Qr,n)):(w.ULS.sendTraceTag(22127642,338,15,"desiredInfo does not have a levelText. Replacing with an emtpy string."),h.setValue(ic.a.Qr,"")));return b}leaveList(b){const h=this.qea(b.currentNode);var n=this.xm.pea(b.currentNode,h);const x=new md.GraphIterator;x.fd(b);x.nc();ec.ListReader.$h(x)||vb.a.instance.Yb("PossibleErrorInLeaveList",{["Reason"]:KA.a.Yxb});var E=this.yL(x.currentNode,h),S=h.fq===E.startAt;ec.ListReader.ufa&&po.O5l(x);if(E=
this.Orn(h,E,x)){const ma=this.hd.Es(E);ma.Pda=ma.qr?ma.fq:Zh.a.Xi}n.qr&&E&&this.P2d(b.currentNode,h,E.currentNode,-1);S&&E&&(n=this.Lw(E),this.xm.pea(E.currentNode,n).qr&&(S=this.yL(E.currentNode,n),n.fq===(S.startAt===Zh.a.Xi?1:S.startAt)+1&&this.Qpf(E,S,x.currentNode)&&this.P2d(b.currentNode,h,E.currentNode,-1,!0)));!E&&this.xm.j8b(b.currentNode,h.listID,h.level)&&this.d9e(x,h,Object(v.a)(this,this.Lxf,"matchesListId"),Object(v.a)(this,this.C1f,"sublistsUpdateListItem"))}joinList(b,h,n,x=null){let E=
null,S=null;if(b)if(22!==b.type&&63!==b.type)w.ULS.sendTraceTag(587851670,393,15,"Graph node {0} received is not list node : skipping join list action.",b.type);else{Of.a.instance.J(3)&&(E=this.xm.WXa(b),S=E.Hz());(Of.a.instance.J(3)||Ei.a.Zd.WCb)&&this.dXb(b,h.Ur);if(this.xm.pea(b,h.Ur).qr){var ma=new md.GraphIterator;ma.set(b);ma.vd();ma.nc();let Fa=null;Ei.a.Zd.Ogm&&x&&!x.V8n&&(Fa=this.xm.sTh(ma.currentNode,h.Ur));const $a=this.n$k(ma,h,x);ma=this.e$k(ma,b,h,n,x,$a);this.j$k(h,n,x,$a,ma);Fa&&$a&&
this.QRf(Fa,h.Ur,this.wmm($a,Fa)-(h.Ur.fq-1))}Of.a.instance.J(3)||Ei.a.Zd.WCb||this.dXb(b,h.Ur);Of.a.instance.J(3)&&E&&S&&!this.ZTa&&(this.Tm.gM(E,S,this.Hd.wg),this.M7())}else w.ULS.sendTraceTag(587747659,393,15,"List node received is null : skipping join list action.")}wmm(b,h){let n=0;const x=this.Lw(b),E=new md.GraphIterator;E.set(b.currentNode);E.vd();b=Oh.a.Ir(E,E.Rva());for(b.Om($u.a.w_a,null);b.moveNext();){if(!ec.ListReader.$h(E))continue;this.hd.cD(E);const S=this.qea(E.currentNode);E.nc();
if(E.currentNode.id===h.id)break;S.listID===x.listID&&S.level===x.level&&n++}return n}n$k(b,h,n){if(h.sci)h=h.outlineElement;else{let x,E;n?(x=Object(v.a)(this,this.s7i,"sublistsEnsureSameListAsOriginal"),E=Object(v.a)(this,this.X8d,"sublistsUpdateId")):h.c5b?(x=Object(v.a)(this,this.B1f,"sublistsEnsureSameList"),E=Object(v.a)(this,this.X8d,"sublistsUpdateId")):(x=Object(v.a)(this,this.x1n,"sublistsEnsureLevelHigherThanOrEqualTo"),E=Object(v.a)(this,this.y1n,"sublistsUpdateLevelAndId"));h=this.WFc(b,
h.Ur,x,E,n)}!h&&n&&(n=new md.GraphIterator,n.fd(b),n.z3b()&&ec.ListReader.$h(n)&&(h=n));return h}e$k(b,h,n,x,E,S){x?(E?b=E.Iec:(S=this.yL(h,n.Ur),n=this.sPc(n.Ur,b,S),b=n.tfa!==Zh.a.Xi?n.tfa+1:S.startAt===Zh.a.Xi?1:S.startAt),h.setValue(Ei.a.Zd.iy,b),h.setValue(Ei.a.Zd.$I,b)):(b=Zh.a.Xi,this.jKn(h,S,n));return b}j$k(b,h,n,x,E){if(x){var S=!1,ma=this.Lw(x),Fa=ma.level===b.Ur.level,$a=!!n&&ma.listID===n.oTc;(ma.listID===b.Ur.listID||$a)&&Fa&&(Fa=this.yL(x.currentNode,ma),$a=Fa.startAt===Zh.a.Xi?1:Fa.startAt,
ma.fq===$a+1&&(S=h?E===$a:this.Qpf(x,Fa,null)));if(!S||n)n?(h=n.delta,E=Object(v.a)(this,this.ZWn,"siblingMatchesLevel"),S=Object(v.a)(this,this.$Wn,"siblingRenumberAndUpdateListID")):(h=1,E=Object(v.a)(this,this.T_c,"siblingMatchesListAndLevel"),S=Object(v.a)(this,this.b4i,"siblingRenumberAndUpdateSublistsDelta")),ma=new md.GraphIterator,ma.set(x.currentNode),ma.vd(),this.hd.cD(ma),ma.nc(),this.b9e(x.currentNode,b.Ur,h,E,S,n)}}jKn(b,h,n){let x=null;h&&(x=this.Lw(h));if(x&&x.listID===n.Ur.listID&&
x.level===n.Ur.level){const E=this.hd.Es(h);let S=E.fq;b.setValue(Ei.a.Zd.iy,S);b.setValue(Ei.a.Zd.$I,S);ec.ListReader.lZ&&(E.propertySet.setValue(ic.a.listID,x.listID),E.propertySet.setValue(ic.a.listLevel,x.level));if(!n.c5b||n.LUd)n.sci&&!n.LUd&&(this.hd.cD(h),b=h.currentNode,wf.OutlineElementNavigator.ae(h)),b.setValue(Ei.a.Zd.$I,b.getValue(Ei.a.Zd.iy))}else h=n.Ur.fq+1,b.setValue(Ei.a.Zd.iy,h),b.setValue(Ei.a.Zd.$I,h)}$Ia(b,h,n=!0,x=!1,E=-1){this.cXb(b,h,n,x,E)}cXb(b,h,n=!0,x=!1,E=-1,S=!1,ma=
null,Fa=!1){const $a=vb.a.instance.oo(Db.a.cXb),sb=new $z;sb.Ur=null;sb.action=0;if(!Kf.OutlineElementReader.Nh(b))return vb.a.instance.Yb("PossibleListStateNotUpdated",{["Reason"]:KA.a.MWa}),$a.end(),w.ULS.sendTraceTag(578331469,393,15,"Iterator not pointing to OE in apply list info word."),sb;let Jb=-1,Sb;Sb=Kf.OutlineElementReader.Z1(b);var oc=po.oh.gu(b.currentNode);const Ic=b.Rb(2);let gd=!1,Gd=null;if(Ic&&Cd.ParagraphReader.oc(Ic)&&(gd=!0,Gd=Ic,Jb=this.ep.eT(b.currentNode).gt-this.ep.pF(Ic).gt,
Ad.a(Ic,8)))return $a.end(),w.ULS.sendTraceTag(578331470,393,15,"Returning from apply list info word as its a page break."),sb;let vd=null;if(Of.a.instance.J(3)&&12===Ic.type){if(Gd.qa.last.ei)return w.ULS.sendTraceTag(578331471,393,15,"User applied list to para with deleted EOP."),sb;vd=Gd.Hz()}wf.OutlineElementNavigator.ae(b);var ce=Kf.OutlineElementReader.FAa(b);const od=Kf.OutlineElementReader.pF(b),Yd=Kf.OutlineElementReader.Z1(b);let ne=null,Df=null;h&&(ne=h.BA,Df=this.infoAtLevel(b,h));let Af=
b.Rb(4);Af?h&&16!==h.listType?(this.Fjh(Af,Df,E,ne,!!ma&&ma.hasProperty(ad.a.DBf)),b.nc(),sb.action=3,sb.Ur=this.Lw(b)):(gd&&(this.kMi(Gd),this.Pnn(Gd),Gd.aW=null),x=this.hd.VNd(Af.ia(ic.a.listID,0)),!Ei.a.Zd.Xea||x?(Af.W6d=!1,this.leaveList(b),b.Fg()):b.nc(),n&&gd&&(this.Ozd(oc),oc=ce+(Yd?Yd:-1*od)-this.jlc[0],oc=0>oc?0:oc,this.Kh.mva(b,1,oc)),Ei.a.Zd.Xea&&b.Rb(4)&&(Af.W6d=!1,this.leaveList(b),b.Fg()),sb.action=1,sb.Ur=null,Gd&&(this.Hd.wg&&!this.ZTa||Ei.a.Zd.Xea&&!this.Hd.wg&&Gd.gj)&&(!Gd.gj||Gd.FA&&
Gd.FA.hasProperty(ic.a.listID))&&this.tLk(b)):h&&16!==h.listType&&(n=-1,ce=h.propertySet.ia(ic.a.listID,-1),ec.ListReader.lZ&&Fa&&0<ce&&ce+""in this.vJf&&(n=this.vJf[ce+""]),h=h.xhb?new Ho(this,md.GraphIterator.$a(h.xhb),!1,!0):Ho.D7k(this,b,Df,Fa,S),this.h_l(b,Df,x,Fa,h),Af=this.WIk(b),this.ur&&this.SHn(h,Df),gd&&!Ei.a.Zd.KL&&this.H5d(Af,Ic,ma),void 0===h||null===h||S||Df.qr!==this.hd.pea(Af,h.Ur).qr?this.l$l(Df,n,h,Af)?(this.Iho(Df,Af,n,Jb),sb.action=3,sb.Ur=this.Fjh(Af,Df,-1,ne)):(sb.action=4,
0<Sb&&(Jb+=Sb),sb.Ur=this.xbh(oc,Af,Df,Jb,ne),this.Aho(n,ce,sb.Ur,Af)):(sb.action=2,sb.Ur=h.Ur,Df.listStyle||(h.c5b=!0),this.vmm(n,sb.Ur,Af,h)),gd&&this.DJn(Ic),b.nc());Of.a.instance.J(3)&&!this.ZTa&&(Gd&&vd&&this.Tm.gM(Gd,vd,this.Hd.wg),this.M7());$a.end();return sb}WIk(b){Ei.a.Zd.Xea&&b.Rb(31)&&b.Fg();return this.createList(b)}Pnn(b){b.hasProperty(ic.a.ge)&&b.removeProperty(ic.a.ge);b.hasProperty(ic.a.QB)&&b.removeProperty(ic.a.QB);b.hasProperty(ic.a.$s)&&b.removeProperty(ic.a.$s)}infoAtLevel(b,
h){if(!h)return null;const n=h.BA;if(this.ur)if(1===h.sr){if(h.Yla&&!h.vI||!h.gVe(!1))return h;let x;b=Kf.OutlineElementReader.FAa(b);x=this.QPc(b);const E=n.gEb[x];b=nr.a.F1(h.propertySet,h.propertySet);6===E?b.n7(1,1):b.n7(0,E);b.K5d("multilevel");b.levelText=n.SPc[x];n.qAa&&n.qAa[x]&&(b.font=n.qAa[x]);b.Ws=n.UPd[x];b.G3=n.G3;b.MQd=h.MQd}else b=h;else b=h;return b}SHn(b,h){b&&b.Ur&&(h.levelText=b.Ur.levelText,h.qr||(h.font=b.Ur.font))}h_l(b,h,n,x,E){if(n&&E){n=Kf.OutlineElementReader.FAa(b);if(this.ur){var S=
Kf.OutlineElementReader.Z1(b);0<S?n+=S:(S=Kf.OutlineElementReader.pF(b),0<S&&(n-=S))}h=h.propertySet.ia(ic.a.listLevel,-1);E.Ur.level=x&&0<=h?h:this.QPc(n);this.xm.pea(b.currentNode,E.Ur).listType||(x=this.yL(b.currentNode,E.Ur),b=this.sPc(E.Ur,b,x),E.Ur.NDc=E.Ur.fq=b.tfa===Zh.a.Xi?x.startAt-1:b.tfa,E.c5b=b.vjj)}else E&&E.Ur&&h.propertySet&&h.propertySet.hasProperty(ic.a.listLevel)&&(E.Ur.level=h.propertySet.getValue(ic.a.listLevel))}Aho(b,h,n,x){ec.ListReader.lZ&&(0>=b?this.vJf[h+""]=n.listID:(x.properties.setValue(ic.a.listID,
b),n.listID=b))}Iho(b,h,n,x){h.properties.setValue(ic.a.listID,n);h.properties.hasProperty(ic.a.listLevel)||(n=b.propertySet&&b.propertySet.hasProperty(ic.a.listLevel)?b.propertySet.Og(ic.a.listLevel):this.QPc(x),h.properties.setValue(ic.a.listLevel,n),this.ur&&(b.propertySet&&b.Bea&&(n=b.levelText.replace("%1","%"+(n+1)),h.setValue(ic.a.Qr,n)),b.propertySet&&b.L3b&&!Ei.a.Zd.KL&&h.setValue(ie.a.font,b.font)))}vmm(b,h,n,x){if(ec.ListReader.lZ){let E=null;0<b&&(E=new fz(0,h,-1),E.oTc=b,E.delta=-1);
this.joinList(n,x,!1,E)}else this.joinList(n,x,!1)}l$l(b,h,n,x){return!ec.ListReader.lZ||0>=h?!1:void 0===n||null===n?(n=b.propertySet.ia(ic.a.listLevel,-1),0<=n&&(h=this.xm.Kw(x,h,n))&&(h=h.ia(ie.a.M2,null))?b.ima!==h:!1):b.qr!==this.hd.pea(x,n.Ur).qr||b.ima!==this.hd.pea(x,n.Ur).ima}Onn(b,h){const n=!!h&&Cd.ParagraphReader.oc(h);let x=0,E=0;n&&(x=this.ep.eT(b.currentNode).gt,E=this.ep.pF(h).gt);n&&this.kMi(h);b.Fg();n&&this.Kh.mva(b,1,x-E)}C9(b,h,n,x=-1,E=!1,S=null,ma=!1){w.ULS.sendTraceTag(17622211,
324,50,"'Continue Existing List' is selected from Context Menu.");const Fa=vb.a.instance.oo(Db.a.C9),$a=this.Hc.Rc(15);$a.Ju(b);let sb=null,Jb=0;({umm:sb,tLm:Jb,returnValue:x}=this.d8k(b,h,x,sb,Jb,E,S));if(!sb||ma&&(1===n||0>n-sb.Ur.fq||2<n-sb.Ur.fq))return $a.dispose(),Fa.end(),!1;for(;0<Jb;)b.z3b(),Jb--;this.Bho(b,h,x,sb);$a.dispose();Fa.end();return!0}Bho(b,h,n,x){for(;b.z3b();)if(b.Rb(4)){if(this.qea(b.currentNode).listID===h.listID){h=new fz(0,h,n);this.joinList(b.currentNode,x,!0,h);break}b.nc()}}d8k(b,
h,n,x,E,S=!1,ma=null){for(;b.$Hd();){if(b.Zp(4)){const Fa=this.Lw(b),$a=this.hd.Es(b);if($a.listType!==ma.listType){E++;continue}if(S&&$a.listStyle!==ma.listStyle||!S&&h.level<Fa.level){E++;continue}-1===n&&(n=Fa.fq+1);x=null;if(h.level===Fa.level||S)Ei.a.Zd.fDb&&this.xkb&&this.xkb.Blf(b),x=new Ho(this,b,!1,!1);S&&Fa.level!==h.level&&b.Zp(4)&&(b.Rb(4).setValue(ic.a.listLevel,Fa.level),b.nc());break}E++}return{returnValue:n,umm:x,tLm:E}}BFd(b){let h=0;var n=0;Of.a.instance.J(3)&&(n=this.hd.uL(b,!1,
!0),h=n.listId,n=n.listLevel);return this.hd.Kw(b,h,n)}startNewList(b,h,n){w.ULS.sendTraceTag(17622212,324,50,"'Start New List' is selected from Context Menu.");if(h){var x=vb.a.instance.oo(Db.a.startNewList),E=this.Hc.Rc(15);E.Ju(b);var S=nr.a.wP(0,h.listStyle,null,0,h.propertySet.ia(ic.a.listLevel,-1));b.Rb(4);var ma=b.currentNode.ia(ic.a.listID,0),Fa=b.currentNode.ia(ic.a.listLevel,-1);b.nc();S.MQd=ma;var $a=h.propertySet.ia(ic.a.ge,0);0<$a&&S.propertySet.setValue(ic.a.ge,$a);-1===S.propertySet.ia(ic.a.listLevel,
-1)&&S.propertySet.setValue(ic.a.listLevel,Fa);1===h.sr&&((Fa=new yx.a,ma=h.$Zh(b.currentNode,ma),ma)?1===ma&&(S.K5d(tt.a.l9b),S.BA=Fa.a_e(Fa.kDf,Fa.lDf),S.G3=S.BA.G3):(S.K5d(tt.a.l9b),S.BA=Fa.hZe(),S.G3=S.BA.G3));h.sea()&&1>n&&(n=1);S.Qz=n;ma=new qi.DictionaryPropertySet;ma=this.w0b(Db.a.gH,ma);Fa=b.Rb(2);b.nc();b.Rb(4);h=this.qea(b.currentNode);this.ur&&($a=this.BFd(b.currentNode))&&(S.levelText=$a.ia(ic.a.Qr,""),S.vI=42,S.Ws=$a.ia(ic.a.baa,"left"));this.Onn(b,Fa);({pBa:S}=this.Yqa(ma,b,S,!0));
b.Rb(4);22!==b.currentNode.type&&63!==b.currentNode.type&&w.ULS.sendTraceTag(587851671,393,15,"Graph node {0} is not list node.",b.currentNode.type);b.currentNode.setValue(ic.a.listLevel,h.level);b.nc();S=new Ho(this,b,!1,!1);this.hd.cD(b);n=new fz(1,h,n);this.joinList(b.currentNode,S,!0,n);E.dispose();x.end()}else w.ULS.sendTraceTag(51242764,324,50,"'Start New List' has no current ListInfo")}arf(b){if(!b)return!1;const h=b.Rb(2);h&&b.nc();return Of.a.instance.J(3)&&h&&12===h.type&&h.qa&&h.qa.last&&
h.qa.last.ei?!0:!1}lZd(b,h,n,x){return this.zwe.lZd(b,h,n,x)}lUf(b,h){if(!b||!h)return!1;const n=b.propertySet.ia(ic.a.Qr,null);h=h.propertySet.ia(ic.a.Qr,null);if(!n||!h)return!1;const x=b.propertySet.ia(ie.a.font,null);b=b.propertySet.ia(ie.a.font,null);return n===h&&x===b}ZYi(b,h,n){n||h.listType||(h.Qz=b.ia(ie.a.bX,Zh.a.Xi))}fSh(b,h){if(!h)return null;const n=Array(9),x=h.MQd;if(!this.Wdm(h,b)||1>x)return null;for(h=0;9>h;h++){const E=this.hd.Kw(b,x,h);if(null===E||void 0===E?0:E.hasProperty(ic.a.ge))n[h]=
E.getValue(ic.a.ge);else return null}return n}Wdm(b,h){if(!b)return!1;const n=b.propertySet.ia(ic.a.listLevel,-1);b=b.propertySet.ia(ic.a.ge,-1);if(0>n||0>b)return!1;this.Ozd(h);return b!==this.KOb[n]?!0:!1}k7g(b,h,n){b&&b.setValue(ic.a.ge,h?h[n]:this.KOb&&n<this.KOb.length?this.KOb[n]:720*(n+1))}b9e(b,h,n,x,E,S=null,ma=!1){const Fa=new md.GraphIterator,$a=this.yL(b,h);Fa.set(b);Fa.vd();b=Oh.a.Ir(Fa,Fa.Rva());b.Om($u.a.w_a,null);let sb=-1;for(;b.moveNext();){if(!ec.ListReader.$h(Fa))continue;this.hd.cD(Fa);
const Jb=Fa.currentNode,Sb=this.qea(Jb);Fa.nc();if(x!==Object(v.a)(this,this.T_c,"siblingMatchesListAndLevel")||Sb.listID===h.listID){if(ma){if(-1!==sb&&sb>Sb.level)break;if(-1===sb)sb=Sb.level;else if(Sb.level!==sb)continue}else{if(Sb.level<=$a.g_)break;if(!x(h,Sb,S))continue}E(Jb,n,h.listID,S)}}}$al(b,h,n,x,E){const S=new md.GraphIterator,ma=this.yL(b,h);S.set(b);S.vd();if(ec.ListReader.$h(S)){this.hd.cD(S);b=S.currentNode;var Fa=this.qea(b);S.nc();Fa.level<=ma.g_||x(h,Fa,null)&&E(b,n,h.listID,
null)}}d9e(b,h,n,x,E=null){const S=new md.GraphIterator;S.fd(b);x(b,h,this.Lw(S),S,0);this.WFc(b,h,n,x,E)}WFc(b,h,n,x,E=null){let S=new md.GraphIterator;const ma=this.yL(b.currentNode,h);let Fa=null,$a=0;var sb=new md.GraphIterator;sb.fd(b);sb.Bb(10);const Jb=cn.a.Ir(sb,sb.origin);for(Jb.moveNext();Jb.moveNext();)if(Fa=null,S=Jb.iterator,1===S.role&&(Fa=Jb.currentNode,S.Zp(4)&&(sb=this.Lw(S),n(h,sb,E))))if(sb.level>h.level)x(b,h,sb,S,$a),$a++;else if(sb.level===h.level||sb.level<=ma.g_)break;return Fa?
S:null}T_c(b,h){return h.listID!==b.listID||h.level!==b.level?!1:!0}ZWn(b,h,n){return h.listID!==b.listID&&h.listID!==n.oTc||h.level!==b.level?!1:!0}Lxf(b,h,n){return h.listID===b.listID||n&&h.listID===n.oTc?!0:!1}b4i(b,h,n,x){const E=b.ia(Ei.a.Zd.iy,-1);this.a4i(b,E+h,n,x)}a4i(b,h,n,x){if(!po.hOc){const E=b.ia(Ei.a.Zd.iy,-1);b.hasProperty(Ei.a.Zd.iy)&&-1===E&&vb.a.instance.Yb("PossibleIncorrectListRenumbering",{["Reason"]:"PropertyNotExist"});b.setValue(Ei.a.Zd.iy,h);b.setValue(Ei.a.Zd.$I,h)}b.setValue(ic.a.listID,
n);h=this.qea(b);b=md.GraphIterator.$a(b);b.vd();b.nc();this.d9e(b,h,Object(v.a)(this,this.Lxf,"matchesListId"),Object(v.a)(this,this.C1f,"sublistsUpdateListItem"),x)}aXn(b,h){const n=b.getValue(Ei.a.Zd.iy);b.setValue(Ei.a.Zd.iy,n+h);b.hasProperty(Ei.a.Zd.$I);b.setValue(Ei.a.Zd.$I,n+h)}$Wn(b,h,n,x){let E,S;E=this.xm.WXa(b);S=E.Hz();if(!po.hOc){b.hasProperty(Ei.a.Zd.iy)||vb.a.instance.Yb("PossibleIncorrectListRenumbering",{["Reason"]:"PropertyNotExist"});const ma=b.getValue(Ei.a.Zd.iy);b.setValue(Ei.a.Zd.iy,
ma+h);b.hasProperty(Ei.a.Zd.$I)&&b.getValue(Ei.a.Zd.$I)!==ma&&vb.a.instance.Yb("PossibleIncorrectListRenumbering",{["Reason"]:"PropertyNotExist"});b.setValue(Ei.a.Zd.$I,ma+h)}b.setValue(ic.a.listID,n);h=this.qea(b);b=md.GraphIterator.$a(b);b.vd();b.nc();E&&S&&!this.ZTa&&(this.Tm.gM(E,S,this.Hd.wg),this.M7());this.WFc(b,h,Object(v.a)(this,this.s7i,"sublistsEnsureSameListAsOriginal"),Object(v.a)(this,this.X8d,"sublistsUpdateId"),x)}kIi(b,h,n,x,E){b=this.yL(b.currentNode,n);b.g_>=h.level&&this.bwb(x,
b.startAt+E)}t7i(b,h,n,x,E){this.kIi(b,h,n,x,E)}X8d(b,h,n,x){n.listID=h.listID;x.Rb(4);b=this.xm.WXa(x.currentNode);h=b.Hz();this.dXb(x.currentNode,n);x.nc();b&&h&&!this.ZTa&&(this.Tm.gM(b,h,this.Hd.wg),this.M7())}C1f(b,h,n,x){ec.ListReader.$h(x)&&(b=new md.GraphIterator,b.fd(x),b.vd(),this.hd.cD(b),this.jnf(x.currentNode,b.currentNode))}y1n(b,h,n,x,E){n.listID=h.listID;this.kIi(b,h,n,x,E);this.X8d(b,h,n,x,E)}B1f(b,h){return h.listID!==b.listID?!1:!0}x1n(b,h){return h.level>b.level?!1:!0}s7i(b,h,
n){return h.listID!==n.oTc?!1:!0}static get hOc(){null==po.Uid&&(u.AFrameworkApplication.K?(u.AFrameworkApplication.Hf("i75ig452;a229j208"),po.Uid=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveRedundantRenumberingForListActions",!1)):po.Uid=!1);return po.Uid}static get Tg(){return Rl.ContextSetEditor.instance}static get oh(){return ql.PageNavigator.instance}static jYi(b,h){h.setValue(ie.a.font,b.Yla||b.iMc||b.L3b?b.font:"Symbol")}static lYi(b,h){b=b.Yla||b.iMc||
b.Bea?b.levelText:Zh.a.Cxd;w.ULS.shipAssertTag(22127637,338,!!b);h.setValue(ic.a.Qr,b)}static kYi(b,h){b=b.propertySet.ia(ic.a.baa,"left");h.setValue(ic.a.baa,b)}static G8h(b){b=b.iterator.parentNode;const h=md.GraphIterator.$a(b);b&&Kf.OutlineElementReader.Wqf(h,null)&&b.Sj(8,!0)}static O5l(b){const h=new md.GraphIterator;h.set(b.currentNode);wf.OutlineElementNavigator.ae(b);for(b=h.Wd();b&&!Ix.a.k6b(b);)b=h.xj();b&&b.Sj(4,!0)}}po.bEm=2147450879;po.Mpi=1;po.Uid=null;Object(r.a)(po,"FlatListEditorCssVersion",
Ei.a,[530,531,43]);class vy{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb){this.vH=b;this.Kh=n;this.Jgd=h;this.Hc=x;this.ep=E;this.zwe=S;this.Hd=ma;this.Tm=Fa;this.oHa=$a;this.wc=sb;this.Ie=Jb;this.HIa=Sb}create(){return new po(this.vH,this.Jgd,this.Kh,this.Hc,this.ep,this.zwe,this.Hd,this.Tm,this.oHa,this.wc,this.Ie,this.HIa)}}Object(r.a)(vy,"FlatListEditorFactory",null,[]);class Pw{constructor(){this.startAt=this.listLevel=this.listId=0;this.xhb=null}}Object(r.a)(Pw,"ListAutoCorrectionRefInfo",null,
[]);class aA{constructor(b,h){this.rJj=b;this.Cf=h}lZd(b,h,n,x){if(!b.hasProperty(ad.a.NMa))return!0;h=md.GraphIterator.$a(h.currentNode);Kd.SelectionEditor.Gt(h);let E=!0;if(!n.listType&&!x){23===h.Se&&h.dE(1);x=b.ia(ad.a.NMa,1);if(1!==x){var S=new md.GraphIterator;S.fd(h);S.Bb(10);S=cn.a.Vp(S.origin);x=this.c8k(S,x,n,h.currentNode);n.xhb||(E=!1)}b.setValue(ad.a.NMa,x)}return E}c8k(b,h,n,x){const E=new Qa.a;for(;b.moveNext()&&b.iterator.currentNode!==x;){const S=b.iterator;if(!S.Zp(4))continue;const ma=
this.rJj.value.Lw(S),Fa=this.Cf.Es(S);this.s$m(E,ma);Fa.listType===n.listType&&Fa.listStyle===n.listStyle&&(0>h-ma.fq||2<h-ma.fq||E.add(Object.assign(new Pw,{listId:ma.listID,listLevel:ma.level,xhb:S.currentNode,startAt:ma.fq+1})))}0<E.count&&(h=E.J(E.count-1).startAt,n.xhb=E.J(E.count-1).xhb);return h}s$m(b,h){let n=0;for(;n<b.count;){const x=b.J(n);x.listId===h.listID&&x.listLevel>=h.level?b.removeAt(n):n++}}}Object(r.a)(aA,"ListAutoCorrector",null,[488]);class MA{constructor(b,h,n,x,E){this.K2a=
(S,ma,Fa)=>{var $a;S=this.cCc(ma);if(!S||this.Mr.arf(S))return 8;ma=this.Mr.Lw(S);if(1===ma.fq||this.sNc(ma.level))return 8;ma=null===($a=this.hd)||void 0===$a?void 0:$a.Es(S);if(!ma||this.Hci(ma))return 8;if(1===Fa)return 32;this.Mr.startNewList(S,ma,1);return 32};this.J2a=(S,ma,Fa)=>{S=this.cCc(ma);if(!S||this.Mr.arf(S))return 8;ma=this.Mr.Lw(S);if(this.sNc(ma.level))return 8;const $a=this.hd.Es(S);if(!$a||this.Hci($a))return 8;if(1===Fa)return 32;this.i2e.cyl(S.currentNode,ma.fq,this.hd,this.Mr,
this.TPa);return 32};this.C9=(S,ma,Fa)=>{S=this.cCc(ma);if(!S||this.Mr.arf(S))return 8;ma=this.Mr.Lw(S);if(1!==ma.fq||this.sNc(ma.level))return 8;if(1===Fa)return 32;Fa=this.hd.Es(S);return this.Mr.C9(S,ma,Fa.Qz,-1,!1,Fa)?32:8};this.Gkb=(S,ma,Fa,$a,sb)=>{S=this.cCc(ma);if(!S)return 8;ma=this.Mr.Lw(S);if(this.sNc(ma.level))return 8;if(1===Fa)return 32;Fa=this.hd.Es(S);this.Mr.startNewList(S,Fa,sb);return 32};this.Jab=(S,ma,Fa,$a,sb)=>{S=this.cCc(ma);if(!S)return 8;ma=this.Mr.Lw(S);return this.sNc(ma.level)?
8:1===Fa?32:this.Mr.C9(S,ma,ma.fq,sb)?32:8};this.Ac=b;this.hd=n;this.Mr=x;this.i2e=E}get tam(){return ec.ListReader.pr}sNc(b){return 0>b?!0:this.tam?!1:!!b}Vb(){this.Ac.pa(Db.a.K2a,cc.a.outlineElement,this.K2a);this.Ac.pa(Db.a.K2a,cc.a.Wc,this.K2a);this.Ac.pa(Db.a.K2a,cc.a.view,this.K2a);this.Ac.Vc(Db.a.K2a,12);this.Ac.pa(Db.a.J2a,cc.a.outlineElement,this.J2a);this.Ac.pa(Db.a.J2a,cc.a.Wc,this.J2a);this.Ac.pa(Db.a.J2a,cc.a.view,this.J2a);this.Ac.Vc(Db.a.J2a,12);this.Ac.pa(Db.a.C9,cc.a.outlineElement,
this.C9);this.Ac.pa(Db.a.C9,cc.a.Wc,this.C9);this.Ac.pa(Db.a.C9,cc.a.view,this.C9);this.Ac.Vc(Db.a.C9,12);this.Ac.pa(Db.a.Gkb,cc.a.outlineElement,this.Gkb);this.Ac.pa(Db.a.Gkb,cc.a.Wc,this.Gkb);this.Ac.pa(Db.a.Gkb,cc.a.view,this.Gkb);this.Ac.Vc(Db.a.Gkb,12);this.Ac.pa(Db.a.Jab,cc.a.outlineElement,this.Jab);this.Ac.pa(Db.a.Jab,cc.a.Wc,this.Jab);this.Ac.pa(Db.a.Jab,cc.a.view,this.Jab);this.Ac.Vc(Db.a.Jab,12)}get TPa(){return Oa.a.instance.resolve("Common.IStandaloneRootController").q3}cCc(b){return this.Mr.Hvl(b)}Hci(b){return 1===
(null===b||void 0===b?void 0:b.listType)}}Object(r.a)(MA,"ListContextMenuSectionActor",null,[]);class wy{static get Npm(){return Kc.a.Lx(wy.rl,Box4Intl.Box4Strings.l_StartNewListDialog,Box4Intl.Box4Strings.l_ContinueFromPreviousList,Box4Intl.Box4Strings.l_SetValueTo)}}wy.rl="<div class='WACDialogRow' id='StartNewList'> <input type='radio' id='ListRadioStartNew' name='ListRadioBox' class='WACDialogRadio' alt='{0}' title='{0}'></input> <label id='StartNewList' class='WACDialogLabel' for='ListRadioStartNew' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='ContinuePreviousList'> <input type='radio' id='ListRadioContinue' name='ListRadioBox' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ContinueFromPreviousList' class='WACDialogLabel' for='ListRadioContinue' >{1}</label> </div> <div class='WACDialogRow' id='SpinnerRow'> <div class='WACDialogGroupBox' id='ListStartAtSpinnerBox'> <label id='ListStartAtNumber' class='DialogSpinnerLabel' >{2}</label> <br/> <div id='SetListStartSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(r.a)(wy,"ListSetStartValueDialogHtml",null,[]);class av extends Kc.a{constructor(b,h,n,x,E){super();this.cgd=this.Yje=this.vgd=this.PGe=null;this.Ule=!0;this.HK=!1;this.Q7a=0;this.v7=[Db.a.YWf,Db.a.w0f,Db.a.sNf];this.DMn=(S,ma)=>{ec.ListReader.pr?(S=ma[rc.a.Number],this.m4=Number.isInteger(ma[rc.a.Number])&&S>=this.Q7a?S:this.Q7a):this.m4=ma[rc.a.Number]};this.DHl=(S,ma)=>{ec.ListReader.pr&&(this.m4=this.m4>=this.Q7a?this.m4:this.Q7a);ma[rc.a.Number]=this.m4;ma[rc.a.UnitType]=0};this.GJn=(S,
ma)=>{if(1===S){var Fa=ma.ListRadioStartNew,$a=ma.ListRadioContinue,sb=md.GraphIterator.$a(this.Re);sb.vd();ma=this.Mr.Lw(sb);S=this.Cf.Es(sb);if(Fa)this.Mr.startNewList(sb,S,this.m4);else if($a)if(this.Ule)this.Mr.C9(sb,ma,this.Yze,-1,!1,S);else{Fa=!0;for($a=null;sb.QG();)if(sb.Zp(4)){$a=new Ho(this.Mr,sb,!1,!1);break}if(!$a||this.Mr.Lw(sb).fq>=this.m4)Fa=!1;Fa?(sb=md.GraphIterator.$a(this.Re),sb.vd(),this.Mr.C9(sb,ma,this.Yze,this.m4,!1,S)):(this.dispose(),this.jva(CommonUIStrings.l_ErrorDialogMessage,
this.Mpm))}}};this.Mpm=()=>{new av(this.Re,this.Yze,this.Cf,this.Mr,this.yd)};this.NVm=()=>{document.getElementById(av.Fji).style.visibility="visible"};this.XOm=()=>{document.getElementById(av.Fji).style.visibility="hidden"};this.kg="ListSetStartValueDialog";this.ug=wy.Npm;this.Re=b;this.m4=h;this.Cf=n;this.Yze=h;this.x4=x;ec.ListReader.pr&&(h=new md.GraphIterator,b?(h.set(b),h.vd(),Kf.OutlineElementReader.Nh(h)||wf.OutlineElementNavigator.ae(h),ec.ListReader.$h(h)&&(h.Rb(4),b=h.currentNode,22===
b.type&&(this.Cf.QN(b).sea()?this.Q7a=1:this.Q7a=0))):this.Q7a=1);this.yd=E;this.Zh(Box4Intl.Box4Strings.l_SetNumberingValueList,this.GJn,{["ListRadioStartNew"]:!0,["ListRadioContinue"]:!1});this.Ule&&(this.PGe=document.getElementById("ListRadioStartNew"),this.vgd=this.NVm,this.Yje=document.getElementById("ListRadioContinue"),this.cgd=this.XOm,af.a.addHandler(this.PGe,"click",this.vgd),af.a.addHandler(this.Yje,"click",this.cgd));for(let S of this.v7)ah.a.sja(S,this.DMn,this.DHl);this.yd.xl()}get Mr(){return this.x4}dispose(){this.HK||
(this.Ule&&(this.vgd&&af.a.removeHandler(this.PGe,"click",this.vgd),this.cgd&&af.a.removeHandler(this.Yje,"click",this.cgd)),this.yd.IA("ListStartSpinner"),super.dispose(),this.HK=!0)}zkk(){const b=xf.n("none",ec.ListReader.pr?this.Q7a+"":"0","100","1");return xf.l(av.Gji,Db.a.YWf,Db.a.sNf,Box4Intl.Box4Strings.l_SetValueTo,[b],null,Db.a.w0f)}eVa(b){const h=document.getElementById(av.Gji);this.yd.rya("ListStartSpinner",b);b=this.yd.EXa("ListStartSpinner","Medium");h.appendChild(b)}UT(){const b=this.zkk();
this.eVa(b)}}av.Gji="SetListStartSpinnerContainer";av.Fji="ListStartAtSpinnerBox";Object(r.a)(av,"ListSetStartValueDialog",Kc.a,[]);class $v{cyl(b,h,n,x,E){new av(b,h,n,x,E)}static get instance(){return $v._instance||($v._instance=new $v)}}$v._instance=null;Object(r.a)($v,"ListDialogFactory",null,[487]);class MB{constructor(b,h,n){this.x4=b;this.Cf=h;this.Hc=n}Blf(b){w.ULS.shipAssertTag(40420184,393,Kf.OutlineElementReader.Nh(b));const h=b.Rb(4);b.nc();if(h){const n=this.Cf.QN(h);n.sr||this.i_l(b,
h,n)}}qtk(b){for(let h=0;h<b.length;h++){const n=new md.GraphIterator;n.set(b.getContext(h).node);this.Blf(n)}}i_l(b,h,n){const x=ql.PageNavigator.instance.gu(h),E=this.x4.qea(h),S=this.Hc.Rc(15);S.Ju(b);b=this.x4.xbh(x,h,n,0,null);this.x4.rOi(h,!0,E.listID);S.dispose();this.Cf.pea(h,b)}}Object(r.a)(MB,"SingleLevelListEditor",null,[486]);var NA=d(334);class qv extends ei{constructor(b){super();qv.xoc=b}nFi(b,h,n,x,E,S){if(!b||!b.length)return 8;let ma;const Fa=({zPl:b,yPl:ma}=qv.np.wPl(b)).returnValue;
let $a=1;for(let Jb of Fa.keys){var sb=b.contains(Jb);const Sb=Fa.J(Jb);qv.np.Ipk(Fa.J(Jb),this.Vzc(h),sb)?sb?(w.ULS.sendTraceTag(575213851,393,50,"List Actions: {0} lists, with change in level",this.Vzc(h)?"Promote":"Demote"),sb=u.AFrameworkApplication.ya.Qf(NA.a.tza(Sb),h,n,x,E,S)):(w.ULS.sendTraceTag(575213852,393,50,"List Actions: {0} lists, without change in level",this.Vzc(h)?"Promote":"Demote"),sb=qv.np.YYm(Fa.J(Jb),this.Vzc(h),ma.J(Jb))):(w.ULS.sendTraceTag(575213850,393,50,"List Actions: Tried to {0} lists, but unable to indent",
this.Vzc(h)?"Promote":"Demote"),sb=8);$a=pd.ActionManager.jRc($a,sb)}return $a}Vzc(b){return b===Db.a.HF?!0:!1}static get np(){return qv.xoc||(qv.xoc=Oa.a.instance.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))}}qv.xoc=null;Object(r.a)(qv,"WordEditorListContextManager",ei,[]);class St{get name(){return"WordEditor.ListEditors"}zc(b){u.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&(b.ha("WordEditor.ListEditors.IListAutoCorrector",()=>new aA(b.Ye("WordEditor.IFlatListEditor"),
b.resolve("Box4.List.IListReader"))).singleInstance(),b.ha("WordEditor.IFlatListEditor",()=>(new vy(b.resolve("WordEditor.List.IFlatListReader"),b.Ye("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.IOutlineElementEditor"),new Zm.a,b.resolve("Box4.IParagraphIndentationReader"),b.resolve("WordEditor.ListEditors.IListAutoCorrector"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.List.IListFormattingEditor"),
b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.Styles.IWACStyleEditor"))).create()).singleInstance(),b.ha("Box4.List.IListEditor",()=>b.resolve("WordEditor.IFlatListEditor")).singleInstance(),b.ha("Box4.List.ISingleLevelListEditor",()=>new MB(b.resolve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).singleInstance(),b.ha("Box4.ListEditors.WordEditorListContextManager",()=>new qv(b.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))).as("Box4.ListEditors.IListContextManager"))}init(){(new MA(u.AFrameworkApplication.ya,
new qm.a,St.hd,St.Mr,$v.instance)).Vb();const b=u.AFrameworkApplication.ya;b.gb(Db.a.sNf,cc.a.view,ah.a.JQ,96);b.gb(Db.a.w0f,cc.a.view,ah.a.tF,96);b.gb(Db.a.YWf,cc.a.view,ah.a.tF,96)}dispose(){}static get hd(){return null!=St.qmg?St.qmg:St.qmg=Oa.a.instance.resolve("Box4.List.IListReader")}static get Mr(){return null!=St.qig?St.qig:St.qig=Oa.a.instance.resolve("WordEditor.IFlatListEditor")}static main(){N.a.instance.Pc(new St)}}Object(r.a)(St,"WordEditorListEditorsPackage",null,[1,2]);var BC=d(1624),
aw=d(517),xu=d(75),en=d(1893);class gz extends Bb.a{constructor(b,h,n,x,E,S){super(b,h);this.styleId=null;this.yj=0;this.OMa=null;this.characterData=n;this.paragraphNode=x;this.listMarker=E;this.ALa=S}}Object(r.a)(gz,"HeadingText",Bb.a,[]);class Jx{constructor(b,h,n,x,E,S,ma){this.jHg=!0;this.oOg=0;this.a3g=8;this.Kfa=null;this.JVl=Fa=>{if(Fa.nr)return!0;Fa=Fa.role;return 1===Fa||2===Fa||4===Fa};this.jJj=b;this.aB=h;this.Ie=n;this.Cf=x;this.$A=E;this.Hba=S;this.mwe=ma}get Py(){return this.jJj.value}get rlf(){return this.jHg}set rlf(b){this.jHg=
b}get yEb(){return this.oOg}set yEb(b){this.oOg=b}get GLb(){return this.a3g}set GLb(b){this.a3g=b}isl(){return Object(xu.__awaiter)(this,void 0,void 0,function*(){var b=this.mwe.value;if(!isNullOrUndefined(b)&&b.Rx)return b=yield this.sAl(),this.eLf(b,!0);b=this.Kfa;return isNullOrUndefined(b)?null:Promise.resolve(this.eLf(b,!0))})}lQh(){return this.eLf([],!1)}eLf(b,h){const n=window.performance.now(),x=this.mQh();if(!x)return null;const E=new Qa.a;let S=0;for(;x.moveNext();){var ma=x.iterator;if(11===
ma.Se){const Fa=this.Cf.aAb(ma),$a=wf.OutlineElementNavigator.He(ma,!0);h&&b[S]&&b[S].ParaId===Cd.ParagraphReader.iT($a)&&S++;wf.OutlineElementNavigator.ae(ma);if(!$a||!Cd.ParagraphReader.oc($a)||$a.Pr||""===$a.characterData||"\ufffc"===$a.characterData)continue;const sb=this.TEd($a);sb&&(Fa&&(sb.listMarker=this.$A.y_a(Fa,!1).B2,ma=this.Cf.Es(ma),1===ma.listType&&ma.L3b&&(sb.OMa=ma.font)),h&&(b[S-1]&&b[S-1].ParaId===Cd.ParagraphReader.iT($a)?sb.yj=S:sb.yj=S+1),E.add(sb))}}w.ULS.sendTraceTag(591963592,
3019,50,String.format("GetHeadingsDataForToc Duration: {0} ms;",window.performance.now()-n));return E}sAl(){let b=new Nb.a;var h=en.a.A9(u.AFrameworkApplication.rootQuerySignature,null);let n=new En.a;n.Vr=h;n.status=1;this.JNj=window.performance.now();h=this.Hba.Jka(0,()=>{if(2!=n.statusCode||null==n.hk||0==n.hk.length||null==n.hk[0]){const x=String.format("GetPageEndsOperation Failed with status code: {0};",n.statusCode);b.setException(Error.create(x));w.ULS.sendTraceTag(543802465,3019,10,x)}else b.Gg(n.hk[0].PageEnds),
w.ULS.sendTraceTag(543802466,3019,50,String.format("GetPageEndsDuration Duration: {0} ms;",window.performance.now()-this.JNj))});h.CJ(n);h.gW();return Ua.b(b.task)}fsl(){const b=this.mQh();if(!b)return-1;let h=0;for(;b.moveNext();){const n=b.iterator;if(11===n.Se){const x=wf.OutlineElementNavigator.He(n,!0);wf.OutlineElementNavigator.ae(n);x&&Cd.ParagraphReader.oc(x)&&!x.Pr&&""!==x.characterData&&"\ufffc"!==x.characterData&&this.TEd(x)&&h++}}return h}mQh(){if(!this.Py)return w.ULS.sendTraceTag(591000526,
3019,10,"PageNode is null"),null;var b=this.aB.hT(this.Py);if(!b)return w.ULS.sendTraceTag(591963593,3019,10,"pageContentNode is null."),null;b=md.GraphIterator.$a(b);if(!b.qo())return w.ULS.sendTraceTag(591963594,3019,10,"Failed to root at PageContent."),null;b=cn.a.Ir(b,b.origin);b.Om(this.JVl,null);return b}TEd(b){return this.tNl(b)||this.esl(b)}esl(b){var h;let n=h=null,x=-1;var E=-1,S=this.Ie.Nx(b);for(let Fa=0;Fa<b.qa.length;Fa++)if(h=b.qa.J(Fa),h.formatting){var ma=Mh.FormattingReader.Nsa(h.formatting);
const $a=this.Ie.tf(ma);if(!n&&(n=$a,E=(E=Hk.a.DHc(n))?Number.parseInvariant(E):0,!this.Xqf(E-1)))break;ma=(ma=this.Ie.c2(ma,S))?ma.ia(ic.a.lj,9):9;x=-1===x?ma:x;if(!(this.Vsf(ma)&&x===ma||Hk.a.Qsf($a)&&n===$a))break}h=h.cp;S=b.characterData.substring(0,h);return this.Vsf(x)?new gz(0,h,S,b,null,x+1):Hk.a.Qsf(n)?new gz(0,h,S,b,null,E):null}Vsf(b){return this.rlf&&this.Xqf(b)}Xqf(b){return b<=this.GLb&&b>=this.yEb}tNl(b){const h=Cd.ParagraphReader.HAa(b);if(this.Vsf(h))return new gz(0,b.characterData.length,
b.characterData,b,null,h+1);if(this.Xqf(h)){var n=this.Ie.yo(b);n=this.Ie.tf(n);if(Hk.a.q7b(n))return new gz(0,b.characterData.length,b.characterData,b,null,h+1)}return null}}Object(r.a)(Jx,"StyleBasedDocumentHeadings",null,[399]);class yu{constructor(){this.startTime=0}}Object(r.a)(yu,"TocCallbackData",null,[]);class eo{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb){this.F7f=(Sb,oc,Ic)=>{const gd=oc.node;if(!gd)return w.ULS.sendTraceTag(36705296,324,10,"Context node is null in UpdateTableOfContentsHandler."),
2;if(12!==gd.type)return w.ULS.sendTraceTag(36705297,324,10,"Context node is not a paragraph in UpdateTableOfContentsHandler."),2;if(!gd.Pr)return 2;if(1===Ic)return Vh.SessionStatusManager.instance.Qj?8:32;this.wc&&this.wc.isFeatureEnabled(130)?this.$md.bgo(gd).then(Gd=>{Gd||this.mhj(gd)}):this.mhj(gd);return 32};this.xko=Sb=>{Sb=window.performance.now()-Sb.startTime;w.ULS.sendTraceTag(574408796,3019,50,String.format("UpdateTOC Duration: {0} ms;",Sb));Sb=Object.assign(new ab.a,{durationMs:Sb});ta.Health.instance.recordKpiSuccess(eo.Hkj,
Sb);eo.Iva()};this.M4l=(Sb,oc,Ic)=>{if(Cd.ParagraphReader.oc(oc.node)&&oc.node.Pr)return 2;if(1===Ic)return Vh.SessionStatusManager.instance.Qj?8:32;if(oc.contextId!==cc.a.Wc||this.Ok.L$(oc)||!Cd.ParagraphReader.oc(oc.node))return 32;this.Hd.us(17);this.$md.xGk(oc);return 32};this.aRf=(Sb,oc,Ic)=>{Sb=oc.node;if(!Sb)return w.ULS.sendTraceTag(39358978,324,10,"Context node is null in RemoveTableOfContentsHandler."),2;if(12!==Sb.type)return w.ULS.sendTraceTag(39358979,324,10,"Context node is not a paragraph in RemoveTableOfContentsHandler."),
2;if(!Sb.Pr)return 2;if(1===Ic)return Vh.SessionStatusManager.instance.Qj?8:32;Ic=new md.GraphIterator;Ic.set(Sb);Ic.Bb(8);Ic.kd(8);oc=this.Hc.Rc(15);oc.Ju(Ic);this.$md.onn(Sb)?(oc.dispose(),eo.Iva()):(oc.dispose(),w.ULS.sendTraceTag(556565975,3019,10,"Failed to remove TOC."));return 32};this.ga=b;this.p6c=h;this.Xc=x;this.Hc=E;this.Ok=S;this.$md=ma;this.Hd=Fa;this.wc=$a;this.dEg=sb;this.xE=Jb}Vb(){this.ga.pa(Db.a.Ogc,cc.a.paragraph,this.F7f);this.ga.pa(Db.a.Ogc,cc.a.Fd,this.F7f);this.ga.pa(Db.a.Ogc,
cc.a.Wc,this.F7f);this.ga.Vc(Db.a.Ogc,1028);this.ga.pa(ub.a.Rmf,cc.a.Wc,this.M4l);this.ga.Vc(ub.a.Rmf,1028);this.ga.pa(ub.a.ZWc,cc.a.paragraph,this.aRf);this.ga.pa(ub.a.ZWc,cc.a.Fd,this.aRf);this.ga.pa(ub.a.ZWc,cc.a.Wc,this.aRf);this.ga.Vc(ub.a.ZWc,1028)}mhj(b){ta.Health.instance.recordKpiUsage(eo.Hkj,1,eo.vB,null);const h=this.Lgl(b),n=new yu;n.startTime=window.performance.now();this.p6c.sVi(h,ic.a.R6f,this.$Ll(this.GAl(b)),this.xko,null,n);this.$md.Yrk()}Foj(b){if(null!=b&&b.Pr)if(null==this.dEg.instance)w.ULS.sendTraceTag(539628835,
3019,10,"Page Number Finder instance is null.");else{var h=this.dEg.instance.sUh();b=this.X7k(b);var n=!1;1===this.xE.Hx&&(n=!0);0!=b&&h!=b&&(h=[Object.assign(new ca.a,{name:"TOCPageNo",string:b}),Object.assign(new ca.a,{name:"HeadingPageNo",string:h}),Object.assign(new ca.a,{name:"isPageView",string:n})],Pe.a("TOCPageNoMismatch",!0,void 0,h))}}X7k(b){for(let h=0;h<b.qa.length;h++){const n=b.qa.J(h);if(null!=n.af)for(let x=0;x<n.af.length;x++){const E=n.af.J(x);if(1===E.Yl&&E.instruction.trim().startsWith("PAGEREF"))return parseInt(b.characterData.substr(n.cp,
b.characterData.length-n.cp))}}return 0}GAl(b){return b?b.ia(ic.a.tM,null):(w.ULS.sendTraceTag(38638673,324,10,"Node is null in GetParaIdForUpdate."),null)}Lgl(b){return this.Xc.AAa(b,7,7).Rb(35)}$Ll(b){const h=[];h.push(b+",TOC,0");return h}static Iva(){u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("WordEditorTOCFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Oa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("InsertTOCInWordWeb","WordEditorTOCFloodgateIsEnabled")})},
eo.gka)}}eo.gka=5E3;eo.Hkj="WordUpdateTOC";eo.vB="wwaengidc";Object(r.a)(eo,"TableOfContentsActor",null,[302]);class bA{}Object(r.a)(bA,"FieldData",null,[]);class cA extends bA{constructor(){super();this.plb=null}}Object(r.a)(cA,"TOCFieldData",bA,[]);class OA{constructor(b,h,n,x,E,S=null){this.LVl=b;this.Rs=h;this.yj=n;this.i7i=x;this.listMarker=E;this.OMa=S}}Object(r.a)(OA,"TOCHeadingData",null,[]);class hz{constructor(b,h){this.zRa=b;this.ml=h}nQh(b){return Object(xu.__awaiter)(this,void 0,void 0,
function*(){this.zRa.rlf=b.slf;this.zRa.yEb=b.yEb;this.zRa.GLb=b.GLb;return this.zRa.isl()})}vhl(b){if(b=this.uhl(b))return this.ml.fea(b)}uhl(b){const h=b.qa.length;for(let n=0;n<h;n++){const x=b.qa.J(n);if(x.hyperlink&&x.hyperlink.Dla&&x.hyperlink.url.startsWith(B.a.N$a))return x.hyperlink.url.substr(x.hyperlink.url.indexOf("_Toc"))}return null}d2d(b){(b=this.vhl(b))&&this.ml.nVd(b.id)}RIl(){return this.zRa.fsl()}wEi(b,h){const n=new cA,x=new Qa.a;for(let E of b){b=this.QIl(E,h);if(!b)return null;
x.add(b)}n.plb=x;return n}QIl(b,h){let n;if(h&&(n=this.YFk(b),!n))return w.ULS.sendTraceTag(591184344,3019,10,"Unable to create bookmark for Table of Contents"),null;h=Tc.AParagraphNode.dU(b.characterData.trim());const x=this.DKl(b.ALa);return new OA(h,n,b.yj,x,b.listMarker,b.OMa)}YFk(b){const h=String.format("{0}{1}","_Toc",Ub.a.JF());return this.ml.$Vb(h,b.begin,b.end,b.paragraphNode,b.paragraphNode)?h:null}DKl(b){return String.format("toc {0}",b)}}Object(r.a)(hz,"TOCDataManager",null,[301]);class bw{l_f(){const b=
Object.assign(new yd.StandardDialog,{yt:u.AFrameworkApplication.A$,Ed:0,YDa:!1});b.lU(1);b.Bga(WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogTitle,WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogMessage,()=>{})}static get instance(){return null!=bw.blg?bw.blg:bw.blg=new bw}}Object(r.a)(bw,"TOCDialogHelper",null,[]);var NB=d(194),Qw=d(819),OB=d(339),yj=d(173);class iz{constructor(b,h,n,x,E,S,ma){this.m_f=b;this.yfb=h;this.slf=n;this.yEb=x;this.GLb=E;this.xub=S;this.v2c=[];this.instruction=ma}toString(){return"showPageNumber:"+
this.m_f+"  isHyperlink:"+this.yfb+" includeOutlineLevels:"+this.slf+" lowerOutlineLevel:"+this.yEb+" upperOutlineLevel:"+this.GLb+" addContentControl:"+this.xub+" unsupportedSwitches:"+this.v2c.toString()}}Object(r.a)(iz,"TOCSettings",null,[]);class pj{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd,Gd,vd,ce){this.JHg="TOC";this.Oke=this.ZIe=null;this.j3a=b;this.Kh=h;this.mC=n;this.cS=x;this.tC=E;this.Ok=S;this.hb=ma;this.Vd=Fa;this.Q1g=$a;this.og=sb;this.XIe=Jb;this.Zo=oc;this.DH=Ic;this.un=
gd;this.Hc=Gd;this.Hb=vd;this.rg=ce}get SLc(){return this.JHg}set SLc(b){this.JHg=b}get qlb(){this.ZIe||(this.ZIe=this.TNh());return this.ZIe}TNh(){return new iz(!0,!0,!0,0,8,!0,this.w5m())}xGk(b){Object(xu.__awaiter)(this,void 0,void 0,function*(){Pe.a(pj.iMk);const h=window.performance.now();if(Cd.ParagraphReader.oc(b.node))if(this.Ok.L$(b))w.ULS.shipAssertTag(592233794,3019,!1,"We can't insert table of contents, current insertion point is in locked range"),pj.UMa("IP is in locked range");else{var n=
yield this.j3a.nQh(this.qlb);if(n){var x=new We.a(2,1,0,()=>{this.kMk(b,n,this.qlb.yfb,h)});this.Hb.$b(x)}else w.ULS.sendTraceTag(592233795,3019,10,"Failed to create table of contents."),pj.UMa("Failed to get TOC data")}else w.ULS.shipAssertTag(592233793,3019,!1,"We can't insert table of contents, current context is not paragraph context"),pj.UMa("Context should be paragraph")})}kMk(b,h,n,x=0){let E;try{if(0==x&&(x=window.performance.now()),this.lFh(b.node)){var S=new md.GraphIterator;S.set(b.node);
S.Bb(7);S.kd(7);E=this.Hc.Rc(15);E.Ju(S);var ma=this.j3a.wEi(h,n);ma||pj.UMa("Failed to prepare TOC Field data");var Fa=ma.plb?ma.plb.count:0;if(Fa){h=null;var $a;for(n=0;n<Fa;n++){const oc=ma.plb.J(n);if(!({oxb:$a}=this.D7h(b,h,n,Fa,oc,Jb?Jb.toString():void 0)).returnValue){pj.UMa("Failed to populate new TOC paragraph");return}if(0==n){var sb=$a.currentNode;var Jb=Cd.ParagraphReader.iT(sb)}h=$a}if(this.qlb.xub&&!this.bZe(sb.id,h.xn.id))pj.UMa("Failed to add content control block");else{var Sb=window.performance.now()-
x;Pe.a(pj.C_e,!0,Sb)}}else if(this.XIe.l_f(),this.pHk(b)){const oc=window.performance.now()-x;Pe.a(pj.C_e,!0,oc)}}else pj.UMa("Failed to fetch style set")}catch(oc){pj.UMa(String.format("{0} {1}",oc.message,oc.stack))}finally{E&&E.dispose()}}lFh(b){this.Oke=this.tC.Nx(b);return this.Oke?!0:(w.ULS.sendTraceTag(592233796,3019,15,"Failed to fetch style set"),!1)}static qCa(b){b=[Object.assign(new ca.a,{name:pj.vko,string:b})];Pe.a(pj.H7f,!1,void 0,b)}static Bwf(b){b=[Object.assign(new ca.a,{name:pj.Ron,
string:b})];Pe.a(pj.VMi,!1,void 0,b)}static UMa(b){b=[Object.assign(new ca.a,{name:pj.jMk,string:b})];Pe.a(pj.C_e,!1,void 0,b)}bgo(b){return Object(xu.__awaiter)(this,void 0,void 0,function*(){const h=this.uYh(b);if(null==h)pj.qCa("Cannot update TOC when firstTocPara = null");else{var n=this.TIl(h);if(0<n.v2c.length)return this.jAm(n.v2c),!1;Pe.a(pj.uko);var x=window.performance.now(),E=yield this.j3a.nQh(n);if(!E)return w.ULS.sendTraceTag(559248668,3019,10,"Failed to get data for TOC update."),pj.qCa("Failed to fetch TOC data"),
!1;var S=new We.a(1,1,0,()=>{this.wko(h,E,n,x)});this.Hb.$b(S);return!0}})}wko(b,h,n,x=0){let E;try{if(null==b)pj.qCa("Attempt to update TOC when firstTocPara = null");else{0==x&&(x=window.performance.now());var S=new md.GraphIterator;S.set(b);S.Bb(7);S.kd(7);E=this.Hc.Rc(15);E.Ju(S);var ma=this.j3a.wEi(h,n.yfb);if(null==ma)pj.qCa("Attempt to update TOC when tocFieldData = null");else{var Fa;if(({rUe:Fa}=this.rMi(b,n)).response){w.ULS.sendTraceTag(559018207,3019,50,String.format("Attempting to update TOC with settings: {0}",
n.toString()));var $a=ma.plb?ma.plb.count:0;if(this.lFh(b)){var sb;this.Udi(b)&&(this.UMi(b),(b=Cd.ParagraphReader.Vg(b,!1,!0))&&(sb=b.ia(ic.a.Mc,null).toString()));var Jb=b.ia(ic.a.tM,null);h=Jb;sb=null!==sb&&void 0!==sb?sb:Jb;if($a){for(var Sb=0,oc;b.Pr&&h==Jb&&Sb<$a;){let Gd=ma.plb.J(Sb);n.yfb&&this.j3a.d2d(b);if(!this.Yjo(b,Sb,$a,Gd,n)){w.ULS.sendTraceTag(559248669,3019,10,"Failed to Update TOC Paragraph.");pj.qCa("Failed to update TOC paragraph");return}b.setValue(ic.a.tM,sb);Sb++;oc=b;b=Cd.ParagraphReader.Vg(oc,
!1,!0);if(!b){h=null;break}this.Zdi(b)&&this.TMi(b);h=b.ia(ic.a.tM,null)}h==Jb&&this.RQf(b);var Ic;if(({cuf:Ic}=this.R2j(ma,Sb,$a,oc,sb)).response)if(n.xub&&!this.bZe(Fa,Ic.id))pj.qCa("Failed to add content control block");else{var gd=window.performance.now()-x;Pe.a(pj.H7f,!0,gd)}else pj.qCa("Failed to add new paragraph")}else this.XIe.l_f(),this.rko(b,n.xub,Fa,n.instruction,sb)&&(Sb=window.performance.now()-x,Pe.a(pj.H7f,!0,Sb))}else pj.qCa("Failed to fetch style set")}else pj.qCa("Failed to remove Content Control")}}}catch(Gd){pj.qCa(String.format("{0} {1}",
Gd.message,Gd.stack))}finally{E&&E.dispose()}}R2j(b,h,n,x,E){let S=new md.GraphIterator;for(S.set(x);h<n;){x=b.plb.J(h);if(!({oxb:x}=this.D7h(null,S,h,n,x,E)).returnValue)return{cuf:S.currentNode,response:!1};S=x;h++}return{cuf:S.currentNode,response:!0}}rMi(b,h){var n,x,E;let S,ma;const Fa=null===(n=null===b||void 0===b?void 0:b.qa)||void 0===n?void 0:n.first.Mb;if(Fa&&0<Fa.length)if(b=b.qa.first.Mb.J(0),b.Vf){n=b.contentControlNode.getValue(ic.a.By);S=this.rg.hr.get(null===(x=b.contentControlNode.id)||
void 0===x?void 0:x.toString());ma=this.rg.xs.get(null===(E=b.contentControlNode.id)||void 0===E?void 0:E.toString());if(0!=this.Zo.JHb(n))return w.ULS.sendTraceTag(558952907,3019,10,"Failed to release content control"),{response:!1,rUe:S,rjh:ma};h.xub=!0}else w.ULS.sendTraceTag(528537613,3019,15,"Content control is not block type"),h.xub=!1;else h.xub=!1;return{response:!0,rUe:S,rjh:ma}}rko(b,h,n,x,E){w.ULS.sendTraceTag(559018209,3019,50,"Updating old TOC to empty TOC");this.j3a.d2d(b);let S=this.QDd(b);
if(!this.HDi(S,h,n,x))return pj.qCa("Failed to populate empty TOC."),!1;if(h=Cd.ParagraphReader.Vg(b,!1,!0))n=b.ia(ic.a.tM,null),x=h.ia(ic.a.tM,null),n==x&&this.RQf(h);b.setValue(ic.a.tM,E);return!0}HDi(b,h,n,x){this.Vd.replaceTextRange(b,WordEditorIntl.WordEditorStrings.L_EmptyTOCText);b=b.node;this.zqi(b);this.og.KF(b.qa.first.formatting,!0);this.nZe(b,0,1,x);return h&&n&&!this.bZe(n,b.id)?!1:!0}QDd(b){b.qa.reset();b.GVa();const h=new NB.a(b,0);h.formatting=new yj.a(h,C.a.nil);h.Wh=!0;b.qa.add(h);
return Dd.a.createTextRange(b,0,b.characterData.length)}Udi(b){if(Cd.ParagraphReader.lT(b)){var h=b.qa.last.af;if(!h||!h.length)return!1;if(4<=h.length){b=0===h.J(h.length-4).Yl;const n=1===h.J(h.length-3).Yl&&h.J(h.length-3).instruction.trim().startsWith(this.SLc),x=2===h.J(h.length-2).Yl;h=5===h.J(h.length-1).Yl;return b&&n&&x&&h}}return!1}Zdi(b){if(Cd.ParagraphReader.lT(b)){var h=b.qa.first.af;if(!h||!h.length)return!1;if(2<=h.length)return b=4===h.J(0).Yl,h=3===h.J(1).Yl,b&&h}return!1}UMi(b){const h=
b.qa.last.af,n=h.J(h.length-4),x=h.J(h.length-3),E=h.J(h.length-2),S=h.J(h.length-1);h.remove(n);h.remove(x);h.remove(E);h.remove(S);b.removeProperty(ic.a.tM)}TMi(b){const h=b.qa.first.af,n=h.J(0),x=h.J(1);h.remove(n);h.remove(x);b.removeProperty(ic.a.tM)}RQf(b){if(b){var h=b.ia(ic.a.tM,null),n=b.ia(ic.a.Mc,null).toString(),x=h;n==h&&this.Udi(b)&&(this.UMi(b),(b=Cd.ParagraphReader.Vg(b,!1,!0))&&(x=b.ia(ic.a.tM,null)));n=new md.GraphIterator;n.set(b);n.Bb(8);w.ULS.sendTraceTag(559018210,3019,50,"Attempting to remove TOC paragraphs");
for(var E;b&&b.Pr&&x==h&&E!=b;){if(this.Zdi(b)){this.TMi(b);break}this.j3a.d2d(b);this.un.ae(n);x=this.un.Rr(n,!1,!0);this.Kh.t1a(b);if(!x)return null;E=b;n.Rb(2);x=(b=n.currentNode)?b.ia(ic.a.tM,null):null}return b}}TIl(b){var h=b.qa,n=h?h.length:0,x=null;b=new iz(!0,!1,!1,0,8,!0,void 0);for(let E=0;E<n&&(x=this.SIl(h.J(E)),b.instruction=x,x=this.YFl(x),x[0]!==this.SLc);E++);h=x?x.length:0;for(n=1;n<h;n++)switch(x[n]){case "\\h":b.yfb=!0;break;case "\\u":b.slf=!0;break;case "\\o":this.CKn(x[n+1],
b)&&n++;break;case "\\z":break;case "\\n":b.m_f=!1;b.v2c.push(x[n]);break;default:b.v2c.push(x[n])}return b}CKn(b,h){return b&&(b=b.match(RegExp('^"([0-9])-([0-9])"$')))&&3===b.length?(h.yEb=Number.parseInvariant(b[1])-1,h.GLb=Number.parseInvariant(b[2])-1,!0):!1}onn(b){try{Pe.a(pj.Qon);const h=window.performance.now(),n=this.uYh(b);if(null==n){pj.Bwf("Attempt to remove TOC when firstTocPara = null");return}let x,E,S;const ma=this.TNh();if(!({rUe:x,rjh:E}=this.rMi(n,ma)).response)return pj.Bwf("Failed to remove content control"),
!1;if(void 0==x&&void 0==E)S=this.RQf(n);else{S=n.Nc.Eb(x);let $a=new md.GraphIterator;$a.set(S);$a.Bb(8);b=!1;let sb;for(;!b&&S&&sb!=S;){S.id.equals(E)&&(b=!0);S&&S.Pr&&this.j3a.d2d(S);this.un.ae($a);const Jb=this.un.Rr($a,!1,!0);this.Kh.t1a(S);if(!Jb){S=null;break}$a.Rb(2);sb=S;S=$a.currentNode}}S&&this.uRc(S);const Fa=window.performance.now()-h;Pe.a(pj.VMi,!0,Fa)}catch(h){pj.Bwf(String.format("{0} {1}",h.message,h.stack))}return!0}uRc(b){b=Dd.a.Uc(b,0);b=new om.Selection([b],!0);this.hb.setSelection(b)}bZe(b,
h){return this.Zo.fja(b,h,null,pj.hXk,!0).returnValue?(w.ULS.sendTraceTag(573653840,3019,10,"Failed to create content control block for table of contents."),!1):!0}Yrk(){this.j3a.RIl()||this.XIe.l_f()}uYh(b){if(!b.Pr)return w.ULS.sendTraceTag(528320659,3019,15,"Cannot get TOC Begin Paragraph. Para is not in TOC"),null;b=b.ia(ic.a.tM,null);return this.DH.PAl(b)}jAm(b){b.length&&(b=[Object.assign(new ca.a,{name:"UnsupportedSwitches",string:b.toString()})],Pe.a("UnsupportedTocInstruction",void 0,void 0,
b))}SIl(b){const h=(b=b.af)?b.length:0;for(let n=0;n<h;n++)if(1===b.J(n).Yl&&b.J(n).instruction.trim().startsWith(this.SLc))return b.J(n).instruction.trim();return null}YFl(b){const h=[];if(!b)return h;b=b.split(" ");return b.length?b:h}pHk(b){b=this.Vsh(b,null,!0,void 0).returnValue;if(!b)return pj.UMa("Failed to create paragraph"),!1;const h=Dd.a.Uc(b,0);if(!this.HDi(h,!0,b.id,this.qlb.instruction))return pj.UMa("Failed to populate empty TOC"),!1;w.ULS.sendTraceTag(575447938,3019,50,"Created an empty table of contents.");
return!0}Vsh(b,h,n,x){let E,S;n&&b?(E=this.EHk(b),S=E.currentNode,x=Cd.ParagraphReader.iT(S).toString()):h&&(E=this.eyl(h),S=this.Kh.uN(E));if(!S)return w.ULS.sendTraceTag(592233798,3019,15,"Failed to insert paragraph for table of contents"),{returnValue:null,oxb:E};S.setValue(ic.a.tM,x);return{returnValue:S,oxb:E}}w5m(){const b=new Sys.StringBuilder(this.SLc);b.append(" \\o \\z \\u");b.append(" \\h");return b.toString()}K5m(b){const h=new Sys.StringBuilder("PAGEREF ");h.append(b);this.qlb.yfb&&h.append(" \\h");
return h.toString()}eyl(b){b.vd();this.un.ae(b);return this.Kh.cta(b,!1)}EHk(b){const h=new md.GraphIterator;h.set(b.node);h.vd();this.un.ae(h);let n=this.dTh(h);const x=!b.cpBegin;if(Kf.OutlineElementReader.isEmpty(h,!0))return this.s7h(n);if(x)return this.Kh.XC(n,!0,!1),this.Kh.dba(h,n,b,!1,!1,!1),b=this.dTh(n),this.s7h(b);n=this.Kh.cta(h);this.Kh.dba(h,n,b,!1,!1,!0);b=this.Kh.cta(h);this.Kh.jJb(b.currentNode,!1);this.Kh.uN(b);this.un.He(b);return b}dTh(b){const h=new md.GraphIterator;h.fd(b);h.vd();
return h}s7h(b){this.Kh.XC(b,!0,!0);this.Kh.jJb(b.currentNode,!1);this.un.He(b);return b}zqi(b){const h=b.qa;1===h.length&&(h.first.Wh=!1,b.Mzd().Wh=!0)}Yjo(b,h,n,x,E){let S=this.QDd(b);this.Vd.replaceTextRange(S,"");this.LDi(b,x,E);this.nZe(b,h,n,E.instruction);return E.yfb&&!this.DG(b,x.Rs)?!1:!0}D7h(b,h,n,x,E,S){h=({oxb:b}=this.Vsh(b,h,0==n,S)).returnValue;if(!h)return{returnValue:!1,oxb:b};this.LDi(h,E,this.qlb);this.nZe(h,n,x,this.qlb.instruction);return this.qlb.yfb&&!this.DG(h,E.Rs)?{returnValue:!1,
oxb:b}:{returnValue:!0,oxb:b}}LDi(b,h,n){this.B3l(b,h.LVl,h.listMarker,h.i7i,h.OMa);this.Q1g.W4l(b,b.characterData.length);n.m_f&&this.r4l(b,h);this.zqi(b);this.SMn(b,h.i7i)}Pvl(b,h){if(!b)return 0;const n=pj.EKl();return 4<b.length?n.J(h)+.5*Math.floor(b.length/3):n.J(h)}B3l(b,h,n,x,E){n&&this.O3l(b,n,x);n=Dd.a.Uc(b,b.characterData.length);this.Vd.replaceTextRange(n,h);E&&(b=b.qa.ji(0),this.og.k_(b.formatting,E))}O3l(b,h,n){n=this.Pvl(h,n);const x=Dd.a.Uc(b,0);this.Vd.replaceTextRange(x,h);this.Q1g.P3l(b,
h.length,n)}r4l(b,h){var n=Dd.a.Uc(b,b.characterData.length);this.Vd.replaceTextRange(n,h.yj.toString());n=b.qa.ji(b.characterData.length-h.yj.toString().length);h=this.K5m(h.Rs);this.KLa(b,n,0,2,h);this.KLa(b,n,1,2,h);this.KLa(b,n,2,2,h);n=b.qa.ji(b.characterData.length);this.KLa(b,n,3,2,h)}SMn(b,h){h=this.Oke.uh(h);this.cS.hM(h,b,!0)}nZe(b,h,n,x){const E=b.qa.first,S=b.qa.last;h?this.KLa(b,E,4,1,x):(this.KLa(b,E,0,1,x),this.KLa(b,E,1,1,x),this.KLa(b,E,2,1,x));h===n-1?this.KLa(b,S,3,1,x):this.KLa(b,
S,5,1,x)}KLa(b,h,n,x,E=null){n=new Qw.a(h,null,n,x,!0,!1,!1,E);h.af||(h.af=new OB.a(h));h.af.add(n);b.qn();this.MMk(n,b)}MMk(b,h){Of.a.instance.J(6)&&(b.Fe?h.wordRunProperties.xZ(b.Fe-1,2):h.wordRunProperties.bta(b.Fe,2),h.wordRunProperties.Fq.Z(b.Fe,ws.CharacterPropertiesEditor.wQ),h.wordRunProperties.Zs.Z(b.Fe,ws.CharacterPropertiesEditor.QT))}DG(b,h){b=Dd.a.createTextRange(b,0,b.characterData.length);return this.mC.DG(b,h,!1,!1,!1,!0)?!0:(w.ULS.sendTraceTag(592233799,3019,50,"Failed to create hyperlink for table of contents entries"),
!1)}static EKl(){pj.Aqa||(pj.Aqa=new Jc.a,pj.Aqa.Z("toc 1",1),pj.Aqa.Z("toc 2",1.5),pj.Aqa.Z("toc 3",2),pj.Aqa.Z("toc 4",2.5),pj.Aqa.Z("toc 5",3),pj.Aqa.Z("toc 6",3.5),pj.Aqa.Z("toc 7",4),pj.Aqa.Z("toc 8",4.5),pj.Aqa.Z("toc 9",5));return pj.Aqa}}pj.Aqa=null;pj.hXk="Table of Contents";pj.iMk="CreateTocClient";pj.C_e="CreateTocSuccess";pj.jMk="CreateTocFailureCause";pj.uko="UpdateTocClient";pj.H7f="UpdateTocSuccess";pj.vko="UpdateTocFailureCause";pj.Qon="RemoveTocClient";pj.VMi="RemoveTocSuccess";pj.Ron=
"RemoveTocFailureCause";Object(r.a)(pj,"TOCField",null,[299,300]);var Rw=d(639);class kq{constructor(b,h){this.Hwa=b;this.xFa=h}W4l(b,h){if(Cd.ParagraphReader.oc(b)&&!(0>h)){var n=Pm.a.aYb(b);n=new Rw.a(n,4,1,1);this.Hwa.uLd(b,n);b=Dd.a.Uc(b,h);this.xFa.HLd(b)}}P3l(b,h,n){var x=Zl.a.IJ/2;const E=b.qa.c2b(h);x=Mh.FormattingReader.Ln(E.formatting,ie.a.fontSize,2*x)/2;n=new Rw.a(Jf.a.wF(x/36)*n,1,0,1);this.Hwa.uLd(b,n);b=Dd.a.Uc(b,h);this.xFa.HLd(b)}}Object(r.a)(kq,"TOCTabUtility",null,[298]);class PA{constructor(){this.W=
null}get name(){return"WordEditor.TableOfContents"}zc(b){this.W=b;this.W.ha("WordEditor.AutoSaveParamsUpdateService",()=>new BC.a(this.W.resolve("Box4.Graph.IGraphIteratorFactory"),aw.a.HP)).singleInstance();this.W.ha("WordEditor.TableOfContents.StyleBasedDocumentHeadings",()=>new Jx(new se.a(()=>ob.App.xa.jb.Zc),ql.PageNavigator.instance,this.W.resolve("Box4.Styles.IWACStyleReader"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IListMarkerUtility"),new Lq.a,new se.a(()=>ob.App.xa.jb.Jc))).as("WordEditor.TableOfContents.IDocumentHeadings").singleInstance();
this.W.ha("WordEditor.TableOfContents.TOCDataManager",()=>new hz(this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).as("Box4.ITOCDataManager").singleInstance();this.W.ha("WordEditor.TableOfContents.TOCTabUtility",()=>new kq(this.W.resolve("WordEditor.ICustomTabStopUtility"),this.W.resolve("Box4.IBlobEditor"))).as("WordEditor.TableOfContents.ITOCTabUtility").singleInstance();this.W.ha("WordEditor.TableOfContents.TOCField",()=>new pj(this.W.resolve("Box4.ITOCDataManager"),
this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.IHyperlinkEditor"),this.W.resolve("Box4.Styles.IWACStyleEditor"),this.W.resolve("Box4.Styles.IWACStyleReader"),Ai.a.instance,this.W.resolve("Box4.ISelectionManager"),this.W.resolve("Box4.ICharacterPropertiesEditor"),this.W.resolve("WordEditor.TableOfContents.ITOCTabUtility"),this.W.resolve("Box4.IFormattingEditor"),bw.instance,this.W.resolve("Box4.IFeatureHelper"),this.W.resolve("WordEditor.ContentControl.IContentControlManager"),this.W.Pa("WordEditor.ParagraphWordIdMapping"),
this.W.resolve("Box4.IOutlineElementNavigator"),Zm.a.instance,u.AFrameworkApplication.uc,this.W.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.TableOfContents.ITOCField").singleInstance();this.W.ha("WordEditor.TableOfContents.TableOfContentsActor",()=>new eo(u.AFrameworkApplication.ya,this.W.resolve("WordEditor.AutoSaveParamsUpdateService"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.Graph.IGraphIteratorFactory"),Zm.a.instance,Ai.a.instance,this.W.resolve("WordEditor.TableOfContents.ITOCField"),
this.W.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.W.resolve("Box4.IFeatureHelper"),this.W.Za("WordEditor.IPageNumberFinder"),b.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.TableOfContents.ITableOfContentsActor").singleInstance()}init(){this.W.resolve("WordEditor.TableOfContents.ITableOfContentsActor").Vb()}dispose(){}}Object(r.a)(PA,"PackageManager",null,[1,2]);class Io{constructor(b,h,n,x,E,S,ma,Fa){this.cOa=($a,sb,Jb,Sb,oc)=>{if(!({zx:$a}=this.nkb(sb,Jb,
oc,!0,!0)).returnValue)return $a;this.smd.hsh(oc,sb.node);return 32};this.Lua=($a,sb,Jb,Sb,oc)=>this.N1h(sb,Jb,Sb,oc,!0);this.EGb=($a,sb,Jb,Sb,oc)=>{if(!({zx:$a}=this.nkb(sb,Jb,oc,!1,!0)).returnValue)return $a;this.smd.jJk(oc,sb.node);w.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32};this.pja=($a,sb,Jb,Sb,oc)=>{if(!({zx:Sb}=this.nkb(sb,Jb,oc,!1,!0)).returnValue)return 2==Jb&&8==Sb&&Oq.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],Mc.a.Ayb),Sb;const Ic=
sb.node;let gd=null;(gd=$a===Db.a.pja?this.smd.ZLb(oc[Qf.a.SourceControlId],Ic):this.ps.yAb(Ic,oc))?(this.kZd(Ic,()=>{this.xod.ePa(gd,Ic)}),this.wO(),Sb=32):(Oq.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],Mc.a.Ayb),Sb=8);$a===Db.a.pja&&32===Sb&&w.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");w.ULS.shipAssertTag(0,324,32===Sb);return Sb};this.$qa=($a,sb,Jb,Sb,oc)=>this.N1h(sb,Jb,Sb,oc,!1);this.P9d=($a,sb,Jb,Sb,oc)=>ba.a.Tma($a,sb,Jb,Sb,oc,{},14);this.kwb=
($a,sb,Jb,Sb,oc)=>{if(!({zx:$a}=this.nkb(sb,Jb,oc,!1,!1)).returnValue)return $a;const Ic=sb.node;this.kZd(Ic,()=>{this.xod.Mlh(Ic)});return 32};this.ps=b;this.smd=h;this.ga=n;this.xod=x;this.Hc=E;this.Cw=S;this.AIj=Fa}Vb(){this.qbc(ob.App.h3a.Lrh())}qbc(b){this.ga.pa(Db.a.cOa,cc.a.view,b);this.ga.pa(Db.a.cOa,cc.a.table,this.cOa);this.ga.Vc(Db.a.cOa,1127);this.ga.pa(Db.a.pja,cc.a.view,this.P9d);this.ga.pa(Db.a.pja,cc.a.table,this.pja);this.ga.Vc(Db.a.pja,1030);this.ga.pa(Db.a.applyStyle,cc.a.table,
this.pja);this.ga.pa(Db.a.$qa,cc.a.view,this.P9d);this.ga.pa(Db.a.$qa,cc.a.table,this.$qa);this.ga.Vc(Db.a.$qa,1038);this.ga.pa(Db.a.Lua,cc.a.view,b);this.ga.pa(Db.a.Lua,cc.a.table,this.Lua);this.ga.Vc(Db.a.Lua,1127);this.ga.pa(Db.a.EGb,cc.a.view,b);this.ga.pa(Db.a.EGb,cc.a.table,this.EGb);this.ga.Vc(Db.a.EGb,1126);this.ga.pa(Db.a.kwb,cc.a.view,this.P9d);this.ga.pa(Db.a.kwb,cc.a.table,this.kwb);this.ga.Vc(Db.a.kwb,1028)}wO(){u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&
window.setTimeout(()=>{const b=Oa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}N1h(b,h,n,x,E){if(!({zx:S}=this.nkb(b,h,x,E,!0)).returnValue)return 2==h&&8==S&&Oq.a.recordQosError("TableStyleOptionButtonClickNoResponse",["TableInteractionFailed"],Mc.a.O4k),S;b=b.node;h=this.ps.fT(b);var S=x[Qf.a.On];const ma=Io.lJl(x.MenuItemId);E?x[Qf.a.On]=Io.qSn(h,ma):(this.Bck(h,ma,S,b),n.Jr=ma,
n.pB=S?0:1,w.ULS.shipAssertTag(0,324,!!ma));return 32}kZd(b,h){const n=this.Hc.Rc(15);try{n.Db(b),this.Cw.C1a(),h()}finally{n&&n.dispose()}}nkb(b,h,n,x,E){return this.Njm(b,h,n,x,E)?{returnValue:x||2===h,zx:32}:{returnValue:!1,zx:8}}Njm(b,h,n,x,E){if(b.contextId!==cc.a.table)return!1;if(x||2===h)if(E&&!n||!Object(pb.a)(Qu.TableNode,b.node)||this.AIj(b.node))return!1;return!0}Bck(b,h,n,x){const E=(512===h||1024===h?!n:n)?b|h:b&~h;E!==b&&this.kZd(x,()=>{this.xod.Ena(E,x)})}static Wz(){Io.s9a[Io.c9k]=
32;Io.s9a[Io.U8k]=128;Io.s9a[Io.Lnm]=64;Io.s9a[Io.Dnm]=256;Io.s9a[Io.Jfk]=512;Io.s9a[Io.Ifk]=1024}static qSn(b,h){b=!!(b&h);if(512===h||1024===h)b=!b;return b}static lJl(b){let h=0;b in Io.s9a&&(h=Io.s9a[b]);return h}}Io.c9k="buttonFirstRow";Io.U8k="buttonFirstColumn";Io.Lnm="buttonLastRow";Io.Dnm="buttonLastColumn";Io.Jfk="buttonBandedRow";Io.Ifk="buttonBandedColumn";Io.s9a={};Object(r.a)(Io,"TableStyleActor",null,[]);Io.Wz();var Kl=d(757);class Kx extends Qp.a{constructor(){super();this.TableStyles=
this.TableCellStyles=null;this.columns=0}}Object(r.a)(Kx,"TableGalleryButtonProps",Qp.a,[]);class Vo extends Kx{constructor(){super()}get Type(){return 6}}Object(r.a)(Vo,"TableStyleGalleryButtonProps",Kx,[]);class $h{}$h.sKm=2147483647;Object(r.a)($h,"TableStyleUtil",null,[]);class Up{constructor(b,h,n){this.IVe="Clear";this.yyb=null;this.BVj=b;this.Ie=h;this.ps=n;this.bQ=u.AFrameworkApplication.bQ;this.mr=u.AFrameworkApplication.mr}XWa(){}l1j(b,h){this.XWa(b);const n=this.qKh(b),x=n.length;if(!(0>=
x)){var E=$h.sKm,S=null;for(let $a=0;$a<x;$a++){var ma=n[$a],Fa=this.ps.yJl(ma);E!==Fa&&(E=Object.assign(new Fh.a,{Id:"msMoreTableStyles"+Fa,Title:this.zJl(Fa),ControlList:[]}),S=Object.assign(new ao.a,{Type:6,Id:"galleryMoreTableStyles"+Fa,ExternalGalleryId:"TableStylesGallery",Width:Up.x1f,ElementDimensions:"Size64by48",GalleryItems:[]}),this.yyb&&(S.ExternalId=this.yyb[Fa.toString()]),E.ControlList.push(S),h.MenuSectionList.push(E),E=Fa);Fa=this.Ie.rF(ma);ma=Up.J2f+$a;Fa=Object.assign(new Vo,{Id:ma,
ExternalId:ma,Command:Db.a.pja.toString(),QueryCommand:Db.a.cOa.toString(),LabelText:Fa?B.a.If(Fa):"",Alt:Fa,VerticalCenterAlign:"true"});Fa.TableCellStyles=this.mHd(ma,b);Fa.TableStyles=this.WIc(ma,b);S&&S.GalleryItems.push(Fa)}}}k1j(b){const h=Object.assign(new Fh.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",ControlList:[]}),n=Object.assign(new Pg.a,{Id:"fseaClearTableFormatting",Command:Db.a.kwb.toString(),LabelText:B.a.If(this.IVe),Alt:B.a.If(this.IVe),
Image16by16:this.mr,Image16by16Class:Tg.getImageClassWithCluster(this.bQ,Up.yvk),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});h.ControlList.push(n);b.MenuSectionList.push(h)}hsh(b,h){this.XWa(h);const n=b[Qf.a.SourceControlId];var x=this.ZLb(n,h);if(x){var E=this.ps.Kz(h);E=E?this.Ie.tf(E):null;var S=this.Ie.rF(x);x=this.Ie.tf(x);b[Vi.a.Alt]=S;b[Vi.a.On]=x===E;h=Object.assign(new Vo,{Id:n,ExternalId:n,Command:Db.a.pja.toString(),QueryCommand:Db.a.cOa.toString(),TableCellStyles:this.mHd(n,
h),TableStyles:this.WIc(n,h),Alt:S});b[Vi.a.GalleryButtonProps]=h}else b[Vi.a.InnerHTML]=null,b[Vi.a.Alt]=null,b[Vi.a.On]=!1,b[Vi.a.GalleryButtonProps]=null}mHd(b,h){this.XWa(h);return(b=this.ZLb(b,h))?this.BVj.MLh(b,h):null}WIc(b,h){this.XWa(h);return this.ZLb(b,h),null}jJk(b,h){b.MenuItems=this.Exl(h)}Exl(b){const h=Object.assign(new ti.a,{Id:"menuMoreTableStyles",MenuSectionList:[]});this.l1j(b,h);this.k1j(h);return h}ZLb(b,h){return b?b.startsWith(Up.J2f)?this.Ohf(parseInt(b.substr(Up.J2f.length)),
h):this.uvn(parseInt(b.substr(Up.V3n.length)),h):null}}Up.J2f="buttonTableStyleMenu";Up.V3n="buttonTableStyleRibbon";Up.x1f=7;Up.yvk="ClearTableStyle_16x16x32";Object(r.a)(Up,"ATableStyleRibbonControl",null,[450]);class cw extends Up{constructor(b,h,n){super(null,h,n);this.U0g=b}hsh(b,h){this.XWa(h);const n=b[Qf.a.SourceControlId];var x=this.ZLb(n,h);if(x){var E=this.ps.Kz(h);E=E?this.Ie.tf(E):null;var S=this.Ie.rF(x);x=this.Ie.tf(x);b[Vi.a.Alt]=S;b[Vi.a.On]=x===E;h=Object.assign(new Vo,{Id:n,ExternalId:n,
Command:Db.a.pja.toString(),QueryCommand:Db.a.cOa.toString(),TableCellStyles:this.mHd(n,h),TableStyles:this.WIc(n,h),Alt:S});b[Vi.a.GalleryButtonProps]=h}else b[Vi.a.InnerHTML]=null,b[Vi.a.Alt]=null,b[Vi.a.On]=!1,b[Vi.a.GalleryButtonProps]=null}mHd(b,h){this.XWa(h);return(b=this.ZLb(b,h))?this.U0g.MLh(b,h,5,5):null}WIc(b,h){this.XWa(h);return this.ZLb(b,h),null}}Object(r.a)(cw,"ATableStyleRibbonControlVariableSizePreviews",Up,[]);var Sw=d(1426),xy=d(1070);class Tw{constructor(b,h,n,x){this.Lhl=(E,
S)=>this.getBorder(E,this.VX.zL(S));this.Khl=(E,S)=>this.getBorder(E,this.VX.LN(S));this.tC=b;this.Nt=h;this.fUa=n;this.VX=x;this.Ivj=new se.a(()=>this.Jhl());this.Z4a=new se.a(()=>this.Ihl())}Jhl(){const b={},h=u.AFrameworkApplication.isRtl;b.top="border-top";b.left=h?"border-right":"border-left";b.bottom="border-bottom";b.right=h?"border-left":"border-right";b.insideHorizontal="border-bottom";b.insideVertical=h?"border-left":"border-right";return b}Ihl(){const b={};b[Uf.a.Oya]=Uf.a.S$a;b[Uf.a.S$a]=
Uf.a.S$a;b[Uf.a.mVa]=Uf.a.mVa;return b}zGk(b,h,n,x){const E=new xy.a;E.rowCount=n;E.qab=x;E.BPa=this.fUa.LIl(b);E.Ha=b.ia(ic.a.Ha,1);E.Ga=b.ia(ic.a.Ga,1);E.tableLook=h;E.I9d=1;return E}MLh(b,h,n,x){if(!this.tC.tf(b)||!Object(pb.a)(25,b)||!Object(pb.a)(nk.a,h))return null;const E=this.Nt.fT(h);n=this.zGk(b,E,n,x);x=[];for(n.rowIndex=0;n.rowIndex<n.rowCount;n.rowIndex++)this.k3j(b,h,n,x);return x}WIc(){return null}h2(){}k3j(b,h,n,x){n.y4b=!n.rowIndex;for(n.cellIndex=0;n.cellIndex<n.qab;n.cellIndex++)this.P_j(b,
h,n,x)}P_j(b,h,n,x){h=this.fUa.Uzk(n,this.fUa.Waf(n),h,b);const E={};var S=this.Nt.ADd(b,h,ie.a.fontColor,!0,Bm.a.U1(),"None");E.color=S?S:"inherit";S=this.Nt.ADd(b,h,ie.a.NH,!0,Bm.a.U1(),"None");E["background-color"]=S?S:"inherit";this.Nt.gCb()&&this.O3j(n,b,h,E);x.push(E)}O3j(b,h,n,x){b=this.fUa.NKa(b);this.ypd(5,b,h,n,x);this.ypd(3,b,h,n,x);this.ypd(0,b,h,n,x);this.ypd(4,b,h,n,x)}ypd(b,h,n,x,E){h=this.Bol(b,h,n,x);h!==Uf.a.RE&&(E[this.Ivj.value[Sw.a[b]]]=h)}Bol(b,h,n,x){let E=Uf.a.RE;if(({xja:E}=
this.FEa(x,b,1,h,this.Khl,E)).returnValue)return E;({xja:E}=this.FEa(n,b,3,h,this.Lhl,E));return E}FEa(b,h,n,x,E,S){return this.VX.W0i(n,h,x)&&(S=E(b,h))!==Uf.a.RE||!h&&({xja:S}=this.FEa(b,1,n,x,E,S)).returnValue||4===h&&({xja:S}=this.FEa(b,2,n,x,E,S)).returnValue?{returnValue:!0,xja:S}:{returnValue:S!==Uf.a.RE,xja:S}}getBorder(b,h){let n="",x,E;({borderStyle:x,borderWidth:E}=this.Nhl(b,h));if(x===Uf.a.mVa)return n;n=String.format(Uf.a.Trd,E,x,this.Chl(b,h));return n.trim()}Chl(b,h){if(!h)return Uf.a.TY;
b=this.Nt.Fyb(b,h.color,Eo.a.auto);return b!==Eo.a.auto?Eo.a.BC(b):Uf.a.TY}Nhl(b,h){var n=Uf.a.hra;let x=Uf.a.UE+Uf.a.MXb;if(!h)return{borderStyle:n,borderWidth:x};n=this.Nt.Fyb(b,h.style,Uf.a.mVa);b=this.Nt.Fyb(b,h.size,Uf.a.UE);x=this.Mhl(n,b)+Uf.a.MXb;n=this.Dhl(n);return{borderStyle:n,borderWidth:x}}Mhl(b,h){let n=2;b===Uf.a.JXb&&h<Uf.a.wja&&(n=1);return n}Dhl(b){return this.Z4a.value[b]||Uf.a.KXb}static AJl(){return new Tw(Oa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Oa.a.instance.resolve("WordEditor.IWACTableStyleReader"),
gp.a.instance,Uf.a.instance)}static get instance(){return null!=Tw.mkg?Tw.mkg:Tw.mkg=Tw.AJl()}}Object(r.a)(Tw,"TableStylePreviewGenerator",null,[451]);var bv;(function(b){b[b.oyo=0]="background1";b[b.OIo=1]="text1";b[b.pyo=2]="background2";b[b.PIo=3]="text2";b[b.accent1=4]="accent1";b[b.accent2=5]="accent2";b[b.accent3=6]="accent3";b[b.accent4=7]="accent4";b[b.accent5=8]="accent5";b[b.accent6=9]="accent6";b[b.hyperlink=10]="hyperlink";b[b.ABo=11]="followedHyperlink";b[b.Bzo=12]="dark1";b[b.CDo=13]=
"light1";b[b.Czo=14]="dark2";b[b.DDo=15]="light2";b[b.none=16]="none";b[b.max=17]="max"})(bv||(bv={}));Object(r.b)("ThemeColor",bv);class Tt{constructor(b){this.txa=b}Nfl(b,h,n){let x;({gIi:h,Ldh:x}=this.PDl(h));b=[];const E=[];for(let ma=0;16>ma;ma++){if(!(bv[ma]in n.xtb))continue;const Fa=ma,$a=String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,WoncaIntl.WoncaStrings[x[Fa]],this.Gul(ma));var S=h[Fa];S=S&4278190080|(S&255)<<16|S&65280|(S&16711680)>>>16;E.push(Object.assign(new aq.a,{Color:Fa.toString(),
DisplayColor:"#"+B.a.TH(S,6),Alt:B.a.If($a)}));b[b.length]=ma}return{returnValue:E,P5n:b}}Gul(b){switch(b){case 0:return Box4Intl.Box4Strings.l_ThemeLabel1;case 1:return Box4Intl.Box4Strings.l_ThemeLabel2;case 2:return Box4Intl.Box4Strings.l_ThemeLabel3;case 3:return Box4Intl.Box4Strings.l_ThemeLabel4;case 4:return Box4Intl.Box4Strings.l_ThemeLabel5;case 5:return Box4Intl.Box4Strings.l_ThemeLabel6;case 6:return Box4Intl.Box4Strings.l_ThemeLabel7;case 7:return Box4Intl.Box4Strings.l_ThemeLabel8;case 8:return Box4Intl.Box4Strings.l_ThemeLabel9;
case 9:return Box4Intl.Box4Strings.l_ThemeLabel10;default:return""}}PDl(b){let h=null,n=null;b=this.txa(b);if(!b)return{gIi:h,Ldh:n};h=b.properties.ia(ic.a.themeColors,null);n=b.properties.getValue(ic.a.r$d).split(" ");return{gIi:h,Ldh:n}}static CJl(){return new Tt(Object(v.a)(Tt.oh,Tt.oh.gu,"navigateToPageContentNode"))}static get oh(){return ql.PageNavigator.instance}static get instance(){return null!=Tt.Ekg?Tt.Ekg:Tt.Ekg=Tt.CJl()}}Object(r.a)(Tt,"TableStyleThemeHelper",null,[462]);var jz=d(837);
class ut{constructor(b,h){this.$He={};this.xtb={};this.Ie=b;this.ps=h}W5e(b,h){const n=this.$He[bv[h]];return n&&n.length?n:this.Idl(b,h)}XQh(b,h,n){if(h=this.W5e(h,n))for(b=this.Ie.tf(b),n=0;n<h.length;n++)if(this.Ie.tf(h[n])===b)return n;return-1}h2(){this.$He={};this.xtb={}}Idl(b,h){const n=[];this.xtb={};b=this.ps.mLa(b);this.Rqd(n,this.xtb,0,h,b);this.Rqd(n,this.xtb,1,h,b);this.Rqd(n,this.xtb,2,h,b);this.Rqd(n,this.xtb,3,h,b);return this.$He[bv[h]]=n}Rqd(b,h,n,x,E){const S=E.tN;for(let ma=0;ma<
S;ma++){const Fa=E.ela(ma);if(3!==this.Ie.Ow(Fa))continue;const $a=this.ps.xJl(Fa),sb=this.ps.VIc(Fa);h[bv[sb]]=!0;$a!==n||sb!==x&&16!==sb||this.Ie.tf(Fa)===jz.a.e4c||(b[b.length]=Fa)}}static hNl(){return new ut(Oa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Oa.a.instance.resolve("WordEditor.IWACTableStyleReader"))}static FMk(){return ut.hNl()}}Object(r.a)(ut,"WACTableStyleRibbonList",null,[461]);class zu extends cw{constructor(b,h,n,x,E){super(b,h,n);this.wOb=4;this.Mmd=[];this.e6l=()=>{this.IVb.h2();
this.U0g.h2()};this.CVj=E;this.IVb=x;this.IVe=WordEditorIntl.WordEditorStrings.L_BtnClearTableFormatting;this.O3m()}tGk(b,h){b.MenuItems=this.Rcl(h)}O3m(){this.yyb={};this.yyb["0"]="CustomTableStyles";this.yyb["1"]="PlainTableStyles";this.yyb["2"]="GridTableStyles";this.yyb["3"]="ListTableStyles"}Rcl(b){const h=Object.assign(new ti.a,{Id:"menuTableTheme"});h.MenuSectionList=[];if(this.cjm(b))return h;const n=Object.assign(new Fh.a,{Id:"msTableStyleTheme",ControlsId:"ctrlTableStyleThemeColors",ControlList:[]}),
x=Object.assign(new Kl.a,{Id:"clrTableStyleTheme",ExternalId:"TableStyleThemeColorPicker",Command:ub.a.w$a.toString(),QueryCommand:ub.a.qHb.toString(),Width:zu.Q5n});x.Colors=({P5n:this.Mmd}=this.CVj.Nfl(this.Mmd,b,this.IVb)).returnValue;n.ControlList.push(x);h.MenuSectionList.push(n);return h}XWa(b){if(b=this.ps.Kz(b))b=this.ps.VIc(b),16!==b&&(this.wOb=b)}qKh(b){return this.IVb.W5e(b,this.wOb)}Ohf(b,h){h=this.IVb.W5e(h,this.wOb);return 0>b||b>=h.length?null:h[b]}uvn(b,h){var n=this.ps.Kz(h);n=this.IVb.XQh(n,
h,this.wOb);n=-1!==n?Math.floor(n/Up.x1f)*Up.x1f:0;return this.Ohf(n+b,h)}zJl(b){switch(b){case 0:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesCustom;case 2:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesGrid;case 3:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesList;case 1:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesPlain;default:return""}}cjm(b){this.XWa(b);return 0>=this.qKh(b).length}oko(b,h){if(!b||!h)return null;b=parseInt(b[Jm.Color]);var n=
this.ps.Kz(h);const x=this.ps.VIc(n);if(x===b)return null;if(16===x)return this.wOb=b,null;n=this.IVb.XQh(n,h,x);this.wOb=b;return this.Ohf(n,h)}pTk(b){b=this.ps.Kz(b);b=this.ps.VIc(b);if(16!==b)for(let h=0;h<this.Mmd.length;h++)if(this.Mmd[h]===b)return h;return-1}tWb(b){b.uMe(this.e6l,2)}static BJl(){return new zu(Tw.instance,Oa.a.instance.resolve("Box4.Styles.IWACStyleReader"),Oa.a.instance.resolve("WordEditor.IWACTableStyleReader"),ut.FMk(),Tt.instance)}static get instance(){return null!=zu.hlg?
zu.hlg:zu.hlg=zu.BJl()}}zu.Q5n=4;Object(r.a)(zu,"TableStyleRibbonControls",cw,[449,450]);var yy=d(1517);class Uw extends Io{constructor(b,h,n,x,E,S,ma,Fa){super(b,h,n,x,E,S,ma,Fa)}qbc(b){super.qbc(b);this.ga.pa(ub.a.w$a,cc.a.view,Object(v.a)(this,this.P9d,"tableStyleGenericViewActionHandler"));this.ga.pa(ub.a.w$a,cc.a.table,Object(v.a)(this,this.w$a,"applyTableTheme"));this.ga.Vc(ub.a.w$a,1030);this.ga.pa(ub.a.vac,cc.a.view,b);this.ga.pa(ub.a.vac,cc.a.table,Object(v.a)(this,this.vac,"populateMenuTableTheme"));
this.ga.Vc(ub.a.vac,1126);this.ga.pa(ub.a.qHb,cc.a.view,b);this.ga.pa(ub.a.qHb,cc.a.table,Object(v.a)(this,this.qHb,"queryTableTheme"));this.ga.Vc(ub.a.qHb,1127)}vac(b,h,n,x,E){if(!({zx:b}=this.nkb(h,n,E,!1,!0)).returnValue)return b;this.K2f.tGk(E,h.node);return 32}w$a(b,h,n,x,E){if(!({zx:b}=this.nkb(h,n,E,!1,!0)).returnValue)return 2==n&&8==b&&Oq.a.recordQosError("TableStyleColorButtonClickNoResponse",["TableInteractionFailed"],Mc.a.P4k),b;const S=h.node,ma=this.K2f.oko(E,S);ma&&this.kZd(S,()=>{this.xod.ePa(ma,
S)});return 32}qHb(b,h,n,x,E){if(!({zx:b}=this.nkb(h,n,E,!0,!0)).returnValue)return b;E[Jm.IndexColorSelected]=this.K2f.pTk(h.node);return 32}get K2f(){return this.smd}static wJl(){return new Uw(Oa.a.instance.resolve("WordEditor.IWACTableStyleReader"),zu.instance,u.AFrameworkApplication.ya,yy.a.instance,new Zm.a,Oa.a.instance.resolve("Box4.IInsertionPointFormatting"),Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(v.a)(Ai.a.instance,Ai.a.instance.dgb,"isTableNodeInLockedRange"))}static get instance(){return null!=
Uw.tkg?Uw.tkg:Uw.tkg=Uw.wJl()}}Object(r.a)(Uw,"TableStyleActor",Io,[]);var Ds=d(1564);class Hp{constructor(){this.W=null}get name(){return"WordEditor.TableStyle"}zc(b){this.W=b;this.W.ha("Box4.TableEditors.ITableStylePreviewGeneratorVariableSize",()=>Tw.instance).singleInstance();this.W.ha("Box4.TableEditors.ITableStyleEditor",()=>Ds.a.instance).singleInstance();this.W.ha("Box4.TableEditors.IWACTableStyleEditor",()=>yy.a.instance).singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>
{this.Nm()})}Nm(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(121)&&(Uw.instance.Vb(),zu.instance.tWb(Br.a.instance),jh.StyleReader.Q9d=Ds.a.instance,ob.App.xa.updateCommandUI())}dispose(){}}Object(r.a)(Hp,"TableStylePackage",null,[1,2]);var zy=window.WordEditorHeaderToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",attrs:{Id:"WordEditorHeaderToolbar",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",
ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageSideArrow:"IMGMAP@we@SubmenuFlyoutArrow_13x13x32",Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",Title:"STR@L_HeaderToolbarLabel",LabelText:"STR@L_HeaderToolbarLabel"},children:[{name:"Docks",attrs:{Id:"HeaderToolbarButtonDocks"},children:[{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockLeft",Alignment:"Left"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsLeft"},
children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarSectionsFlyout",Command:"0x2F9A3D80",QueryCommand:"0x978B3323",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0xF9833D60",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarFirstPageButton",LabelText:"STR@L_HeaderToolbarFirstPageButton",Command:"0xC95FE689",QueryCommand:"0xA99F5B15",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarEvenPagesButton",
LabelText:"STR@L_HeaderToolbarEvenPagesButton",Command:"0xD9BEF8F8",QueryCommand:"0xF04337C4",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOddPagesButton",LabelText:"STR@L_HeaderToolbarOddPagesButton",Command:"0xE58D2847",QueryCommand:"0x732475F7",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOtherPagesButton",LabelText:"STR@L_HeaderToolbarOtherPagesButton",Command:"0x91C2D5C5",
QueryCommand:"0x4B388351",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockRight",Alignment:"Right"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsRight"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarOptions",Command:"0x568463EB",LabelText:"STR@L_HeaderToolbarOptions"},children:[{name:"Menu",attrs:{Id:"HeaderFooterToolbarMenu"},children:[{name:"MenuSection",attrs:{Id:"HeaderToolbarOptionsSection",DisplayMode:"Menu32"},
children:[{name:"Controls",attrs:{Id:"HeaderToolbarOptionsControl"},children:[{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonAllPages",MenuItemId:"HeaderToolbarButtonAllPages",Image32by32:"IMGMAP@box42@HeaderAndFooter_32x32x32",Command:"0xF56DFAEA",QueryCommand:"0x7B6FA1F6",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarAllPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstPage",MenuItemId:"HeaderToolbarButtonFirstPage",Image32by32:"IMGMAP@we@DifferentFirstPage_32x32x32",
Command:"0x3284B693",QueryCommand:"0x51527973",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstPage"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonEvenOddPages",MenuItemId:"HeaderToolbarButtonEvenOddPages",Image32by32:"IMGMAP@we@DifferentEvenOddPages_32x32x32",Command:"0x3DB867BD",QueryCommand:"0xE8BBEA49",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarEvenOddPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstEvenOddPages",MenuItemId:"HeaderToolbarButtonFirstEvenOddPages",
Image32by32:"IMGMAP@we@DifferentFirstEvenOddPages_32x32x32",Command:"0x8FF03DBF",QueryCommand:"0x2799C44F",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstEvenOddPages"}}]}]},{name:"MenuSection",attrs:{Id:"HeaderToolbarDeleteSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarDeleteControl"},children:[{name:"Button",attrs:{Id:"HeaderToolbarButtonRemovePageNumbers",MenuItemId:"HeaderToolbarButtonRemovePageNumbers",Image32by32:"IMGMAP@we@WordRemovePageNumbers_32x32x32",
Command:"0xF3612A1B",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_RemovePageNumbers"}},{name:"Button",attrs:{Id:"HeaderToolbarButtonDelete",MenuItemId:"HeaderToolbarButtonDelete",Image32by32:"IMGMAP@we@RemoveHeadersAndFooters_32x32x32",Command:"0x3CD9B935",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarRemoveHeadersAndFooters"}}]}]}]}]}]}]}]}]}]},PB=d(1421);class cv{constructor(b,h){this.OGa=b;this.Dwa=h}nkn(b){this.OGa.gqd(b)}eza(b){this.Dwa.eza(b)}DJb(b,
h){return this.Dwa.DJb(b,h)}CJb(b,h){return this.Dwa.CJb(b,h)}d5f(b,h,n){this.Dwa.d5f(b,h,n)}}Object(r.a)(cv,"ClientPaginationHeaderFooterBridge",null,[448]);class QA{constructor(b,h){this.Nl=b;this.ga=h;this.y8=new mm.a;this.z8=new mm.a}eza(b){b=md.GraphIterator.$a(b);if(b.qo()&&b.Hp()){b.Wd();do 10===b.Se&&this.xKf(b.currentNode),b.zu();while(8!==b.Se)}}DJb(b,h){var n=this.tAb(h);if(!this.y8.xb(n))return w.ULS.sendTraceTag(573400388,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+
n),!1;h=this.y8.J(n);w.ULS.shipAssertTag(573400389,336,this.z8.xb(n),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");n=this.z8.J(n);return this.Fjf(h,b,n)}CJb(b,h){var n=this.tAb(h);if(!this.y8.xb(n))return w.ULS.sendTraceTag(573400390,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+n),!1;h=this.y8.J(n);w.ULS.shipAssertTag(573400391,336,this.z8.xb(n),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");
n=this.z8.J(n);return this.U8e(h,b,n)}d5f(b,h,n){h=this.Wgf(h,n);this.ga.Xb(b?ub.a.sce:ub.a.J3c,2,h)}Wgf(b,h){h=this.Nl.Lzb(h);if(!h)return w.ULS.sendTraceTag(573400392,3009,15,"Header footer container node expected not to be null."),0;h=this.Nl.gla(h);const n=1===b;b=!(b%2);return 1===h?1:2===h?n?2:1:3===h?b?3:4:n?2:b?3:4}xKf(b){if(10===b.type){var h=new mm.a,n=this.Nl.Lzb(b);w.ULS.shipAssertTag(573400393,336,!!n,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");
var x=this.Nl.gla(n);b=this.tAb(b);this.A7f(b,x);this.z7f(b,h);n=md.GraphIterator.$a(n);if(n.Hp()){n.Wd();do b=n.currentNode,x=this.Nl.SEd(b),b=this.Nl.e3h(b),h.add(x,b),n.zu();while(36===n.Se)}}}A7f(b,h){this.z8.xb(b)?this.z8.Z(b,h):this.z8.add(b,h)}z7f(b,h){this.y8.xb(b)?this.y8.Z(b,h):this.y8.add(b,h)}tAb(b){w.ULS.shipAssertTag(573400395,336,10===b.type,"Expected node of type Outline but received node of type "+b.type);return b.ia(ic.a.nga,0)}Fjf(b,h,n){const x=1===h;h=!(h%2);switch(n){case 2:if(x){if(b.xb(2))return b.J(2)}else if(b.xb(0))return b.J(0);
break;case 3:if(h){if(b.xb(1))return b.J(1)}else if(b.xb(0))return b.J(0);break;case 4:if(x){if(b.xb(2))return b.J(2)}else if(h){if(b.xb(1))return b.J(1)}else if(b.xb(0))return b.J(0);break;case 1:if(b.xb(0))return b.J(0)}return!1}U8e(b,h,n){const x=1===h;h=!(h%2);switch(n){case 2:if(x){if(b.xb(5))return b.J(5)}else if(b.xb(3))return b.J(3);break;case 3:if(h){if(b.xb(4))return b.J(4)}else if(b.xb(3))return b.J(3);break;case 4:if(x){if(b.xb(5))return b.J(5)}else if(h){if(b.xb(4))return b.J(4)}else if(b.xb(3))return b.J(3);
break;case 1:if(b.xb(3))return b.J(3)}return!1}}Object(r.a)(QA,"ClientPaginationPageAdornmentContentManager",null,[447]);class Lx{constructor(b,h,n,x,E,S){this.KAk=ma=>{1===ma&&this.yD.FD&&(ma=this.Xc.AAa(this.yD.FD,8,8),this.Nl.ipk(ma)?this.SQk(ma):this.kUn())};this.Cbo=ma=>{1===ma&&this.ga.Xb(Db.a.openInClient,2,!1)};this.yD=b;this.Nl=h;this.Xc=n;this.Hc=x;this.Knc=E;this.ga=S}xUn(){const b=new yd.StandardDialog;b.Ed=1;b.We(1,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogRemoveAllButton);
b.lU(0);b.Lv(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogMessage,0,this.KAk)}SQk(b){b.kd(8);const h=this.Hc.Rc(15);h.set(b.xn.Ti);this.Knc.umn(b);this.yD.dismiss();h.dispose();w.ULS.sendTraceTag(4214792,317,50,"{0}",{["RemovedHeadersAndFooters"]:!0})}kUn(){const b=new yd.StandardDialog;b.Ed=1;b.We(1,Box4Intl.Box4Strings.L_OpenInWord);b.We(0,CommonUIStrings.l_Close);b.lU(0);b.Lv(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarCantDeleteContent,
0,this.Cbo);w.ULS.sendTraceTag(4214793,317,50,"{0}",{["CouldntRemoveHeadersAndFooters"]:!0})}}Object(r.a)(Lx,"DeleteHeaderFooterDialog",null,[]);class Ay{constructor(b,h,n,x,E){this.Nl=b;this.Xc=h;this.Hc=n;this.Knc=x;this.ga=E}create(b){return new Lx(b,this.Nl,this.Xc,this.Hc,this.Knc,this.ga)}}Object(r.a)(Ay,"DeleteHeaderFooterDialogFactory",null,[446]);class dw{constructor(b,h,n,x,E,S,ma,Fa,$a,sb){this.h8=null;this.q4f=(Jb,Sb,oc,Ic,gd)=>{var Gd=this.Shf(Sb);return Gd?1===oc?32:(oc=this.control)?
(Sb=this.Hc.Rc(15),Sb.Db(Gd),Sb.zl=Jb,oc.N9?this.ga.processAction(ub.a.ES,2):(Gd=this.UCh(Gd),Ic.Jr=Gd?1:0,Ic=Jb!==ub.a.J3c,(Jb=this.Zcf(Jb,gd))&&oc.gva(Jb),this.ga.Xb(ub.a.Fyd,2,Ic)),Sb.dispose(),32):8:8};this.y1e=(Jb,Sb,oc)=>{if(1===oc)return 32;this.szj.create(this.control).xUn();return 32};this.X$m=(Jb,Sb,oc,Ic,gd)=>1===oc?32:(Jb=this.control)?(gd[Qf.a.On]=Jb.N9,32):8;this.ckb=(Jb,Sb,oc,Ic,gd)=>{if(1===oc||!this.control.N9)return 32;Sb=this.kQh(Jb,gd);oc=dw.D_h(this.control.FD);Ic=this.Hc.Rc(15);
Ic.Db(oc);Ic.zl=Jb;Jb=this.Xc.Ck();Jb.set(oc);this.PGa.U5e(Jb.currentNode,Sb);this.Nl.aFb(Jb);this.Knc.KZi(Jb,Sb);Ic.dispose();return 32};this.gva=(Jb,Sb,oc,Ic,gd)=>{if(1===oc)return 32;Jb=this.Zcf(Jb,gd);this.control.N9&&this.control.gva(Jb);return 32};this.S4d=(Jb,Sb,oc,Ic,gd)=>{if(1===oc)return 32;Jb=this.$Wh(Jb,gd);Ic.Jr=Jb;Sb=this.Shf(Sb);if(!Sb)return 8;Ic=this.Xc.Ck();Ic.set(Sb);Ic.Bb(8);Ic.at(8);if(!this.Lk.eIm(Ic,Jb))return 8;this.Nl.aFb(Ic);this.control.Vda(Ic.currentNode);return 32};this.yKf=
(Jb,Sb,oc,Ic,gd)=>{if(1===oc)return 32;Jb=this.CWj.nLk(this.Shf(Sb));gd.PopulationXML=Jb;return 32};this.K0d=(Jb,Sb,oc,Ic,gd)=>{Jb=this.kQh(Jb,gd);Sb=this.control.FD;oc=this.Nl.gla(Sb);gd[Qf.a.On]=Jb===oc;1===Jb&&(gd[Qf.a.LabelText]=this.C0h(Sb)?WordEditorIntl.WordEditorStrings.L_HeaderToolbarEntireSection:WordEditorIntl.WordEditorStrings.L_HeaderToolbarAllPages);return 32};this.K_d=(Jb,Sb,oc,Ic,gd)=>{if(1===oc||!this.control.N9)return 32;Sb=this.control.FD;void 0!==Sb&&null!==Sb&&(Sb=this.Nl.gla(Sb),
Jb=this.Zcf(Jb,gd),oc=this.control.yOb,gd[Qf.a.Visible]=this.$4n(Jb,Sb),gd[Qf.a.On]=Jb===oc);return 32};this.ian=(Jb,Sb,oc,Ic,gd)=>{if(1===oc||!this.control.N9)return 32;Jb=this.control.FD;void 0!==Jb&&null!==Jb&&this.e4m(Jb,gd);return 32};this.x$m=(Jb,Sb,oc,Ic,gd)=>{if(1===oc||!this.control.N9)return 32;Jb=this.$Wh(Jb,gd);Sb=this.control.FD;oc=0;void 0!==Sb&&null!==Sb&&(oc=Sb.getValue(ic.a.nga));gd[Qf.a.On]=Jb===oc;return 32};this.ES=(Jb,Sb,oc)=>{if(1===oc)return 32;this.control.dismiss();return 32};
this.XJd=()=>32;this.Fyd=(Jb,Sb,oc,Ic,gd)=>{if(1===oc)return 32;this.control.show(gd);return 32};this.zgb=(Jb,Sb,oc,Ic,gd)=>{if(1===oc)return 32;if(!gd)return 8;Sb=gd.WVa;if(!Sb||!Sb.isConnected)return 8;Jb=this.Nl.JBf(Sb);if(!({isHeader:oc,t3f:Sb}=this.Nl.fZh(Sb)).returnValue)return 8;this.control.Vda(Jb);this.control.gva(Sb);this.control.show(oc,gd.H6d);return 32};this.ga=b;this.Nl=h;this.Knc=n;this.PGa=x;this.Lk=E;this.Xc=S;this.Hc=ma;this.CWj=Fa;this.aEj=$a;this.szj=sb}get control(){return this.h8}set control(b){this.h8=
b}Vb(){this.ga.pa(ub.a.xLd,cc.a.view,this.q4f);this.ga.gb(ub.a.pNf,cc.a.application,this.X$m,96);this.ga.pa(ub.a.sce,cc.a.view,this.q4f);this.ga.pa(ub.a.J3c,cc.a.view,this.q4f);this.ga.gb(ub.a.XJd,cc.a.view,this.XJd,64);this.ga.pa(ub.a.Fyd,cc.a.view,this.Fyd);this.ga.gb(ub.a.ES,cc.a.application,this.ES,96);this.ga.gb(ub.a.zgb,cc.a.application,this.zgb,96);this.ga.gb(ub.a.SEn,cc.a.view,this.gva,96);this.ga.pa(ub.a.SVi,cc.a.view,this.gva);this.ga.pa(ub.a.UVi,cc.a.view,this.gva);this.ga.pa(ub.a.TVi,
cc.a.view,this.gva);this.ga.pa(ub.a.VVi,cc.a.view,this.gva);this.ga.gb(ub.a.oIn,cc.a.view,this.ckb,100);this.ga.gb(ub.a.BXi,cc.a.view,this.ckb,4);this.ga.gb(ub.a.AXi,cc.a.view,this.ckb,4);this.ga.gb(ub.a.yXi,cc.a.view,this.ckb,4);this.ga.gb(ub.a.zXi,cc.a.view,this.ckb,4);this.ga.pa(ub.a.S4d,cc.a.view,this.S4d);this.ga.pa(ub.a.OVf,cc.a.view,this.S4d);this.ga.gb(ub.a.yKf,cc.a.view,this.yKf,96);this.ga.gb(ub.a.y1e,cc.a.view,this.y1e,4);this.ga.gb(ub.a.qGi,cc.a.view,this.K_d,97);this.ga.gb(ub.a.sGi,cc.a.view,
this.K_d,97);this.ga.gb(ub.a.rGi,cc.a.view,this.K_d,97);this.ga.gb(ub.a.tGi,cc.a.view,this.K_d,97);this.ga.gb(ub.a.MGi,cc.a.view,this.K0d,97);this.ga.gb(ub.a.LGi,cc.a.view,this.K0d,97);this.ga.gb(ub.a.JGi,cc.a.view,this.K0d,97);this.ga.gb(ub.a.KGi,cc.a.view,this.K0d,97);this.ga.gb(ub.a.R$m,cc.a.view,this.ian,97);this.ga.gb(ub.a.OMf,cc.a.view,this.x$m,97)}UCh(b){const h=this.Nl.Lzb(b),n=this.Nl.gla(h);b=this.PGa.U5e(b,n);this.control.Vda(h);return b}kQh(b,h){switch(b){case ub.a.BXi:case ub.a.MGi:b=
1;break;case ub.a.AXi:case ub.a.LGi:b=2;break;case ub.a.yXi:case ub.a.JGi:b=3;break;case ub.a.zXi:case ub.a.KGi:b=4;break;default:b=h}return b}Zcf(b,h){switch(b){case ub.a.SVi:case ub.a.qGi:b=1;break;case ub.a.UVi:case ub.a.sGi:b=2;break;case ub.a.TVi:case ub.a.rGi:b=3;break;case ub.a.VVi:case ub.a.tGi:b=4;break;case ub.a.sce:case ub.a.J3c:b=h;break;case ub.a.xLd:b=0;break;default:b=h}return b}$Wh(b,h){return b===ub.a.OVf||b===ub.a.OMf?parseInt(h.MenuItemId):h}Shf(b){return this.Lk.m$(b.tk)}$4n(b,
h){switch(h){case 1:return!1;case 2:return 1===b||2===b;case 4:return 4===b||2===b||3===b;case 3:return 4===b||3===b}return!0}e4m(b,h){const n=this.C0h(b);if(h[Ki.a.Visible]=n)b=this.Lk.E_h(this.aEj(b)),b=String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,b),h[Ki.a.LabelText]=b}C0h(b){const h=this.Xc.Ck();h.set(b);h.Bb(8);h.at(8);return 1<this.Lk.shf(h)}static D_h(b){const h=new md.GraphIterator;h.set(b);h.Bb(10);return hp.WordSectionNavigator.Xwn(h)}}Object(r.a)(dw,
"HeaderFooterActor",null,[]);var RA=d(599),Vw=d(737);class kz{constructor(b,h,n,x,E){this.QLj=b;this.Nl=h;this.Lk=n;this.Xc=x;this.ga=E}HCh(b,h){this.Nl.aFb(b);h=this.M0k(b,h);b.nc();return h}U5e(b,h){b=this.Xc.AAa(b,8,8);let n=!1;this.Lk.CKa(b,x=>{const E=this.Xc.Ck();E.set(x);n=(x=this.HCh(E,h))||n;return x});return n}M0k(b,h){if(3!==this.ga.mode)return!1;let n=!1;h=Vw.a.g2e(h);for(let x=0;x<h.length;++x)n=this.QLj.L0k(b,h[x])||n;return n}}kz.zPk=1;Object(r.a)(kz,"HeaderFooterInserter",null,[418]);
class rv{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb){this.dZg=this.pAg=!1;this.FD=null;this.Use=!1;this.yOb=0;this.EFb=()=>{this.Use=!0};this.i4=b;b.bind(this);this.jKe=x;this.Szj=$a;this.GRg=E;this.FMj=S;this.F6a=ma;this.header=h;this.footer=n;this.header.mMk();this.i4.Uy();this.nIe=kz.zPk;this.PGa=Fa;rv.ga=sb;this.EM=Jb}get N9(){return this.pAg}show(b=!0,h=!0){this.N9||(this.khj(),this.YWi(!0),this.header.Ghn(),this.Szj(),this.E_n(),u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.Wla&&appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new RA.a,
{state:0,disablePopover:!0}))));(this.dZg=h)&&this.GRg(b)}dismiss(b=!1){this.N9&&(this.FMj(b),this.YWi(!1),this.Lxb(),this.yOb=0,this.J0n(),u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.Wla&&appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new RA.a,{disablePopover:!1}))))}YWi(b){this.pAg=b;rv.ga.processAction(Db.a.u9e,2);this.i4.j_(b);this.header.j_(b);this.footer.j_(b);this.jKe()}Vda(b){this.FD!==b&&(this.FD=b,this.header.Vda(b),this.footer.Vda(b),this.yOb=0,this.ckb(this.F6a.gla(b)))}Lxb(){this.FD&&
(this.header.qbb(),this.footer.qbb(),this.FD=null)}update(){this.N9&&this.xbe()}xbe(){this.FD&&(this.F6a.QXk(this.FD)&&this.F6a.xVl(this.FD)?this.khj():this.dismiss())}khj(){const b=this.F6a.gla(this.FD);b!==this.nIe&&this.ckb(b)}ckb(b){this.nIe=b;this.gva(this.ZJl(b))}ZJl(b){switch(b){case 2:return 2;case 3:return 3;case 4:return 2}return 1}gva(b,h=!0){this.yOb!==b&&(this.PGa.U5e(this.FD,this.nIe),this.header.RVi(b),this.header.Ych(Qe.AppFrame.q$),this.footer.RVi(b),this.footer.Ych(Qe.AppFrame.V9),
this.yOb=b,this.N9&&this.dZg&&this.s1k(h))}s1k(b){this.GRg(b);b?this.header.setInitialSelection():this.footer.setInitialSelection()}dispose(){this.i4.J7();this.header.dispose();this.footer.dispose()}E_n(){this.EM.eqd(this.EFb);this.Use=!1}J0n(){this.EM.kRf(this.EFb);this.Use&&rv.ga.processAction(ub.a.XJd,2)}static oVk(){rv.ga.Xb(Ra.a.leb,2,!0);rv.ga.processAction(ub.a.L9,2)}}rv.ga=null;Object(r.a)(rv,"HeaderFooterControl",null,[445,10]);class lz{constructor(b,h,n,x,E){this.jKe=b;this.F6a=h;this.PGa=
n;this.ga=x;this.EM=E}create(b,h,n,x,E){return new rv(b,h,n,this.jKe,x,E,this.F6a,this.PGa,rv.oVk,this.ga,this.EM)}}Object(r.a)(lz,"Factory",null,[424]);class dA{constructor(){this.h8=null}get control(){return this.h8}set control(b){this.h8=b}f$e(b){return this.g$e(this.control.FD,this.control.yOb,b.isHeader,b)}g$e(b,h,n,x){return()=>{if(!b.isConnected)return null;this.control.Vda(b);this.control.gva(h);this.control.show(n);return x}}dismiss(){this.h8.N9&&this.h8.dismiss()}}Object(r.a)(dA,"HeaderFooterControlLauncher",
null,[]);var CC=d(1121),Au=d(523),Dm=d(335),eA=d(790);class Bu{constructor(b,h,n){this.Ufc=null;const x=h?"Header":"Footer";this.Wq=b.ownerDocument.createElement("div");this.Wq.id=h?"HeaderPane":"FooterPane";this.Wq.classList.add(Bu.AVl,x);this.$tb=(new eA.a(this.Wq,"WACViewPanel_"+x)).pE;this.Wq.appendChild(this.$tb);b.appendChild(this.Wq);h&&(this.Ufc=b.ownerDocument.createElement("div"),this.Ufc.classList.add(Bu.FVl),this.Wq.appendChild(this.Ufc));this.ftg=n.CAl(this.Wq)}bind(){}j_(b){b?this.ftg.a$j():
this.ftg.c$j()}Ggk(b){b.L$a(this.$tb)}}Bu.FVl="HeaderToolbarContainer";Bu.AVl="HeaderFooterPane";Object(r.a)(Bu,"PaneControlDom",null,[460]);class sv{constructor(b,h,n,x,E){this.yD=this.nq=null;this.exi=()=>{this.yD.dismiss(!0);if(this.CPb){let S=new or.a(!0);this.CPb.mDa(S)}return!0};this.fD=S=>{S.Ib.preventDefault();return!1};this.Wq=b.ownerDocument.createElement("div");this.Wq.id=sv.Mph;this.Wq.className=sv.Mph;this.JD=x;this.CPb=E;this.c3h=new Bu(this.Wq,!0,h);this.dKk(this.Wq);this.gIh=new Bu(this.Wq,
!1,h);this.j_(!1);b.appendChild(this.Wq)}dKk(b){this.nq=b.ownerDocument.createElement("div");this.nq.id=sv.mZm;this.nq.className=sv.kZm;this.nq.tabIndex=0;this.nq.setAttribute(qf.a.Ah,qf.a.n1);this.nq.setAttribute(qf.a.cda,WordEditorIntl.WordEditorStrings.L_HeaderFooterOverlayAccessibleText);b.appendChild(this.nq)}bind(b){this.yD=b}j_(b){if(!b&&this.JD){var h=new or.a(!0);this.JD.mDa(h)}!b&&this.CPb&&(h=new or.a(!0),this.CPb.mDa(h));this.Wq.style.display=b?"":"none";this.c3h.j_(b);this.gIh.j_(b)}GHn(){this.nq.focus()}Uy(){$e.a.instance.mb(kb.a.click,
this.nq,this.exi);sf.a.instance.mb(kb.a.Vw,this.Wq,this.fD)}J7(){$e.a.instance.sc(kb.a.click,this.nq,this.exi);sf.a.instance.sc(kb.a.Vw,this.Wq,this.fD)}}sv.Mph="HeaderFooterControl";sv.mZm="HeaderFooterOverlay";sv.kZm="EditingSurfaceOverlay HeaderFooterOverlay";Object(r.a)(sv,"HeaderFooterControlDom",null,[443]);class SA{constructor(b,h,n,x,E,S,ma,Fa,$a,sb){this.i4=null;this.sa=new Ge.a;this.yD=this.Zjd=null;this.lFf=Jb=>{this.k7(Jb);this.sa.raiseEvent("OnShowEventKey")};this.kFf=Jb=>{this.gf&&(this.Zjd=
new CC.a(this.gf));this.Wb.ICc(Qe.AppFrame.q$);this.Wb.ICc(Qe.AppFrame.V9);this.Saa(Jb);this.sa.raiseEvent("OnDismissEventKey")};this.zYd=()=>{this.Zjd&&(this.Zjd.dispose(),this.Zjd=null)};this.Wb=b;this.Mo=h;this.zTg=n;this.AEj=x;this.zOj=E;this.ga=S;this.Pxg=Au.a.create();this.IBg=mc.KeyInputManager.mc(db.a.Ks,0);this.oY=mc.KeyInputManager.mc(db.a.L3,0);this.xUj=mc.KeyInputManager.mc(db.a.nQa,0);this.AH=ma;this.Ma=Fa;this.JD=$a;this.CPb=sb;this.gf&&this.gf.jja(this.zYd)}g9g(b){this.sa.addHandler("OnShowEventKey",
b)}Ppn(b){this.sa.removeHandler("OnShowEventKey",b)}gqd(b){this.sa.addHandler("OnDismissEventKey",b)}tNi(b){this.sa.removeHandler("OnDismissEventKey",b)}get gf(){const b=this.AH.value;return b?b.Ji?b:(w.ULS.sendTraceTag(25474004,317,10,"_lazyPageView.Value is not a page view in HeaderFooterControlOwner."),null):(w.ULS.sendTraceTag(25474003,317,10,"_lazyPageView.Value is null in HeaderFooterControlOwner."),null)}get control(){return this.yD}get YCk(){return this.Pxg}bind(b){this.yD=this.nBk(b);this.Pxg.instance=
this.yD}nBk(b){this.i4=new sv(b,this.zOj.value,this.Ma,this.JD,this.CPb);b=this.zTg.value.create(this.ga,this.i4.c3h,!0,Qe.AppFrame.q$);const h=this.zTg.value.create(this.ga,this.i4.gIh,!1,Qe.AppFrame.V9);this.yD=this.AEj.value.create(this.i4,b,h,this.lFf,this.kFf);this.$lf();this.kS();return this.control}$lf(){var b=3===this.ga.mode?Qe.AppFrame.iF:Qe.AppFrame.gWc;const h=this.Wb.pe(Qe.AppFrame.q$);h.parent=b;this.Wb.JMe(Qe.AppFrame.q$);const n=this.Wb.pe(Qe.AppFrame.V9);n.parent=b;this.Wb.JMe(Qe.AppFrame.V9);
b=this.Wb.pe(Dm.a.fBb);b.parent=xd.AFrame.Lp;b.Wca(()=>{this.i4.GHn()});b.bindAction(this.IBg,ub.a.ES);b.bindAction(this.oY,ub.a.ES);b.bindAction(this.xUj,ub.a.ES);h.bindAction(this.oY,ub.a.ES);n.bindAction(this.oY,ub.a.ES)}kS(){this.Mo.kS(Qe.AppFrame.q$);this.Mo.kS(Dm.a.IYa);this.Mo.kS(Qe.AppFrame.V9);this.Mo.kS(Dm.a.fBb)}k7(b){this.Mo.tG(Qe.AppFrame.q$);this.Mo.tG(Dm.a.IYa);this.Mo.tG(Qe.AppFrame.V9);this.Mo.tG(Dm.a.fBb);this.Mo.Hw(xd.AFrame.Xp);this.Wb.kxc(Qe.AppFrame.q$);this.Wb.kxc(Qe.AppFrame.V9);
b?this.Wb.Jg(Qe.AppFrame.q$):this.Wb.Jg(Qe.AppFrame.V9)}Saa(b){this.Mo.Hw(Qe.AppFrame.q$);this.Mo.Hw(Dm.a.IYa);this.Mo.Hw(Qe.AppFrame.V9);this.Mo.Hw(Dm.a.fBb);this.Mo.tG(xd.AFrame.Xp);(b||this.Wb.xg&&(this.Wb.xg.name===Qe.AppFrame.q$||this.Wb.xg.name===Dm.a.IYa||this.Wb.xg.name===Qe.AppFrame.V9||this.Wb.xg.name===Dm.a.fBb))&&this.Wb.Jg(xd.AFrame.Xp)}dispose(){const b=this.Wb.pe(Dm.a.fBb);b.Ar(this.IBg);b.Ar(this.oY);this.Wb.pe(Qe.AppFrame.q$).Ar(this.oY);this.Wb.pe(Qe.AppFrame.V9).Ar(this.oY);this.gf&&
this.gf.B2d(this.zYd);this.control.dispose()}}Object(r.a)(SA,"HeaderFooterControlOwner",null,[420,421]);var TA=d(1071);class UA{constructor(b,h,n,x,E,S){this.Nl=b;this.Xc=h;this.VNj=n;this.Ql=x;this.YNj=E;this.CEj=S}r3l(b,h){const n=this.Xc.Ck();n.set(b);this.Nl.bFb(n,h);this.VNj(n);this.YNj(n.currentNode,this.Ql);this.CEj.s3l(n,TA.a(h))}}Object(r.a)(UA,"HeaderFooterDefaultContentInserter",null,[423]);class lq{constructor(b,h,n,x,E,S,ma,Fa){this.dS=b;this.wVj=h;this.pie=n;this.Ql=x;this.XNj=E;this.RTj=
S;this.rEj=ma;lq.Kh=Fa}s3l(b,h){this.wVj(b,1,3,null,!1);this.dS.PZc(jz.a.e4c,1696,b.currentNode);this.pie(b,0,this.Ql?3:1,h);this.pie(b,1,2,h);this.pie(b,2,this.Ql?1:3,h);this.XNj(b);this.RTj(b,!1,!0,null);this.rEj(b,h)}static get ZQ(){return null!=lq.hrg?lq.hrg:lq.hrg=Oa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get paragraphEditor(){return null!=lq.Nng?lq.Nng:lq.Nng=Oa.a.instance.resolve("Box4.IParagraphEditor")}static NFn(b,h,n){$d.moveToCellContent(b,0,h);wf.OutlineElementNavigator.He(b);
lq.ZQ.e6d(Box4Intl.Box4Strings.L_StyleWordHeader,b.currentNode);lq.paragraphEditor.lD(b.currentNode,n);h||lq.paragraphEditor.np.mva(b,1,-115);2===h&&lq.paragraphEditor.np.ZIb(b.currentNode,1,-115);$d.returnToContainingTable(b)}static mIn(b,h){wf.OutlineElementNavigator.He(b);lq.ZQ.e6d(h?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,b.currentNode);wf.OutlineElementNavigator.ae(b)}static Lil(){return(b,h,n)=>{lq.NFn(b,h,n)}}static Mrl(){return(b,h)=>{lq.mIn(b,h)}}static iJl(b){return(h,
n,x,E,S)=>b.uza(h,n,x,E,S)}static mHl(){return(b,h,n,x,E)=>lq.Kh.XC(b,h,n,x,E)}}lq.Kh=null;Object(r.a)(lq,"HeaderFooterDefaultTableInserter",null,[422]);class tv{constructor(b,h,n,x){this.Nl=b;this.xSb=h;this.Xc=n;this.Lk=x}KZi(b,h){b.xn.properties.setValue(ic.a.gjf,2===h||4===h);b.Bb(8);b.h3c(8).properties.setValue(ic.a.FJd,3===h||4===h)}umn(b){this.Lk.CKa(b,h=>{const n=this.Xc.Ck();n.set(h);this.Nl.aFb(n);this.KZi(n,1);this.vmn(n);return!0})}vmn(b){for(;b.Wd();)b.Fg()}}Object(r.a)(tv,"HeaderFooterEditor",
null,[419]);var QB=d(1075);class VA extends Rt.a{constructor(b){super();this.lKe=b}get index(){return 0}run(){this.lKe()}wVl(b,h){h.property===ic.a.gjf&&this.bH()}KZm(b,h){h.property===ic.a.FJd&&this.bH()}bH(){this.kX()}}Object(r.a)(VA,"ControlUpdateNeededTracker",Rt.a,[]);class WA{constructor(b,h,n,x,E,S){this.w5a=null;this.BEj=n;this.Gad=h;this.lQb=b;this.mOj=x;this.MHa=S}start(){this.lQb.bind(ob.App.xa.eC);this.Gad.control=this.lQb.control;this.Gad.Vb();this.BEj.control=this.lQb.control;this.mOj.value.create(this.lQb.control,
Object(v.a)(this.Gad,this.Gad.UCh,"ensureSectionHeaderFooterAttachedToControl")).Vb();this.XWl()}XWl(){this.w5a=new VA(()=>{this.lQb.control.update()});const b=ob.App.Wj.al;b.Te(35).jp(Object(v.a)(this.w5a,this.w5a.wVl,"headerFooterContainerNodePropertyChanged"));b.Te(8).jp(Object(v.a)(this.w5a,this.w5a.KZm,"pageContentNodePropertyChanged"));QB.a.P1d(Object(v.a)(this.w5a,this.w5a.bH,"setUpdateNeeded"));xj.GraphTransactionManager.instance.yna(this.w5a,3)}dispose(){this.lQb.dispose();this.MHa.Hyh()}}
Object(r.a)(WA,"HeaderFooterManager",null,[]);class XA{constructor(b,h,n,x){this.Lk=b;this.Nl=h;this.PLj=n;this.gle=x}L0k(b,h){let n=!1;const x=Vw.a.Bef(h);b.Zp(x)||(this.A3l(b,h),this.gle.r3l(b.currentNode,h),n=!0);return n}A3l(b,h){const n=this.PLj.create(1074135123),x=b.currentNode.ia(ic.a.nga,0);n.properties.setValue(ic.a.nga,x);n.properties.setValue(ic.a.U3b,h);h=Vw.a.Bef(h);b.Sf(n,h)}}Object(r.a)(XA,"HeaderFooterNodeLevelInserter",null,[417]);var Mx=d(234),YA=d(421);class uv extends Mx.a{constructor(b,
h,n){super(b,h,"","");this.Brb=null;this.n3h=uv.Svh;this.hKc=[];this.rqe=n}get Vz(){return!0}get cssClass(){return"cui-herodock"}jm(){this.Ahn();super.jm()}kKa(){for(const b of this.hKc)b.Jzd();super.kKa()}EZn(){let b,h,n;b=[];h=[];n=[];for(let x=0;x<this.hKc.length;x++){const E=this.hKc[x];E.visible?b.length<this.n3h?b.push(E):Object(pb.a)(YA.FlyoutAnchor,E)?Array.addRange(h,E.Ell()):h.push(E):n.push(E)}return{N7n:b,iZm:h,l6l:n}}cKk(b){if(!b||!b.length)return null;const h=new Fk.Menu(this.root,this.id+
"OverflowMenu",null,null,null),n=new fc.a(this.root,this.id+"OverflowMenuSection",null,null,{DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},h);for(const x of b)n.Sf(x.vP("Menu20"));h.Sf(n);return h}Ahn(){this.h2d();this.Kc=Vf.a.sOa(this.Kc);this.uB();var b;({N7n:n,iZm:b,l6l:x}=this.EZn());for(var h of n){var n=h.vP("Medium20");n.enabled=!0;this.aWb(n,this.children.count);this.Kc.appendChild(n.Kc);n.tka()}if(b=this.cKk(b))this.Brb?this.Brb.menu=b:(h=this.id+"OverflowMenuLauncher",n=
{},n.Image20by20=this.rqe.OverflowMenuImage20by20,n.Image20by20Class=this.rqe.OverflowMenuImage20by20Class,n.PopulateDynamically="false",n.HideDefaultArrow="true",n.Alt=this.rqe.OverflowMenuTooltip,n.Command="798637440",n.Id=h,this.Brb=new YA.FlyoutAnchor(this.root,h,n,b)),b=this.Brb.vP("Small20"),b.enabled=!0,this.aWb(b,this.children.count),this.Kc.appendChild(b.Kc),b.tka();if(u.AFrameworkApplication.K.$("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(const E of x){var x=E.vP("Medium20");
this.Sf(x);x.tka()}}dispose(){this.Brb&&(this.Brb.dispose(),this.Brb=null);for(const b of this.hKc)b.dispose();this.h2d();super.dispose()}set Vz(b){super.Vz=b}}uv.Svh=4;Object(r.a)(uv,"HeroDock",Mx.a,[]);var fA=d(606);class gA extends fA.a{constructor(){super();this.h9d=this.ifm=this.m0n=!1;this.NDm=u.AFrameworkApplication.Bqf?1:uv.Svh}}Object(r.a)(gA,"ToolbarBuildOptions",fA.a,[]);var Fi=d(52),ZA=d(848),By=d(700);class Cy extends Mx.a{constructor(b,h,n){super(b,h,"","");this.Gic=n.Alignment;this.RAg=
n.ScalingDirection===Fi.a.rnj}jm(){this.esa();this.PV(this.Kc);super.jm()}PV(b){for(let h of this.children){h.uB();switch(this.Gic){case Fi.a.Nde:Vf.a.Pf(h.Kc,"cui-toolbar-button-left");break;case Fi.a.m4a:Vf.a.Pf(h.Kc,"cui-toolbar-button-center");break;case Fi.a.yMb:Vf.a.Pf(h.Kc,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this.Gic);}h.visible&&b.appendChild(h.Kc);h.tka()}}HN(b){if(!Object(pb.a)(jb.a,b))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.");
}get cssClass(){switch(this.Gic){case Fi.a.Nde:return"cui-toolbar-buttondock alignleft";case Fi.a.m4a:return"cui-toolbar-buttondock aligncenter";case Fi.a.yMb:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this.Gic);}}get Vz(){return!0}get alignment(){return this.Gic}w3b(){let b=0;if(this.alignment===Fi.a.m4a)for(let h of this.children){const n=h;n.visible&&(b+=n.Kc.offsetWidth)}else b=this.Kc.offsetWidth;return b}fHd(){let b=null;if(this.alignment===Fi.a.m4a)for(let h of this.children){if(h.visible){b=
Sys.UI.DomElement.getBounds(h.Kc);break}}else b=Sys.UI.DomElement.getBounds(this.Kc);return b?0===this.root.x_?b.x:b.x+b.width:0}qEd(){let b=null;if(this.alignment===Fi.a.m4a){if(0<this.children.count){const h=this.children.rEd(this.children.count-1);for(;h.Y_a();){const n=h.get_current();if(n.visible){b=Sys.UI.DomElement.getBounds(n.Kc);break}}}}else b=Sys.UI.DomElement.getBounds(this.Kc);return b?0===this.root.x_?b.x+b.width:b.x:0}N5e(){for(let b of this.children){const h=b;if(!Object(pb.a)(jb.a,
h)||h.control.visible)h.visible=!0}}gAn(b){const h=this.children.toArray(),n=new By.a;let x=this.RAg?0:h.length-1;const E=this.children.count,S=this.root.CPa;for(;this.w3b()>=b&&!(x>=E||0>x);){const ma=h[x];S&&Object(pb.a)(jb.a,ma)&&ma.control.visible&&(n.add(ma),ma.jbh());x+=this.RAg?1:-1}for(let ma of n)ma.$Li(),ma.visible=!1}set Vz(b){super.Vz=b}}Object(r.a)(Cy,"ButtonDock",Mx.a,[]);class dv extends jj.a{constructor(b,h,n,x,E,S,ma=!1){super(b,h,S);this.bpa=this.aY=this.Pia=null;this.hye=!1;this.ZZa=
x;this.h9d=E;this.dnd=0;ff.c(h.Size)||(h.Size===Fi.a.ncg||n.options.ifm?this.dnd=0:h.Size===Fi.a.bqj&&(this.dnd=1));this.DWj=ma}get CPa(){return!0}Sf(b){super.Sf(b);Object(pb.a)(Cy,b)&&!this.hye&&(b.alignment===Fi.a.Nde?(this.Pia&&this.gXf(),this.Pia=b):b.alignment===Fi.a.m4a?(this.aY&&this.gXf(),this.aY=b):b.alignment===Fi.a.yMb&&(this.bpa&&this.gXf(),this.bpa=b))}gXf(){this.hye=!0;this.bpa=this.aY=this.Pia=null}Ljb(b,h){b=this.XGc(b);ff.c(b)||b.visible===h||(b.visible=h,this.refresh())}jm(){super.jm();
this.PJi(!0)}PJi(b){const h=this.root.Ewb;ff.c(this.Kc)&&this.nMk();this.Kc=Vf.a.sOa(this.Kc);this.iKc&&this.Kc.appendChild(this.iKc);for(let n of this.children)n.visible&&(n.uB(),this.Kc.appendChild(n.Kc),n.tka());this.aY&&b&&this.l0k();h&&h.yX();this.dirty=!1}l0k(){if(this.aY.visible&&this.aY.children.count&&(this.vbh(0,0),this.PXk(this.Pia,this.aY,this.bpa))){let b=0,h=0;const n=this.Pia?this.Pia.w3b():0,x=this.bpa?this.bpa.w3b():0;if(0<x||0<n)x>n?(b=0,h=x-n):(b=n-x,h=0);this.vbh(b,h)}}PXk(b,h,
n){let x=!1;0===this.root.x_?(b&&(x=b.qEd()>h.fHd()),!x&&n&&(x=h.qEd()>n.fHd())):(b&&(x=b.qEd()<h.fHd()),!x&&n&&(x=h.qEd()<n.fHd()));return x}vbh(b,h){0===this.x_?(this.aY.Kc.style.marginLeft=b+"px",this.aY.Kc.style.marginRight=h+"px"):(this.aY.Kc.style.marginRight=b+"px",this.aY.Kc.style.marginLeft=h+"px")}nMk(){this.uB()}Et(){this.qzh(()=>{lo.a.prototype.Et.call(this)})}aM(b){b=this.XGc(b);ff.c(b)||this.qzh(Object(v.a)(b,b.xl,"pollForStateAndUpdate"))}qzh(b){this.o9b=this.a0a=!1;b();if(this.a0a||
this.o9b)this.DWj||this.refresh(),this.scale()}HN(b){if(!Object(pb.a)(uv,b)&&!Object(pb.a)(Cy,b))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(Object(pb.a)(Cy,b)&&b.alignment===Fi.a.m4a)for(let h of this.children)if(h.alignment===Fi.a.m4a)throw Error.create("Can't add a centered buttondock because one is already present.");}get cssClass(){let b="cui-toolbar-toolbar ";0===this.dnd?(b+="cui-toolbar-onerow ",u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.w6||
(b+="UITextTranformUpperCase ")):1===this.dnd&&(b+="cui-toolbar-singledock ");return b+super.cssClass}get Vra(){return"div"}get f7(){return 26}get M$i(){return this.lN}set M$i(b){this.lN=b}eGk(b){b=b[Fi.a.Rv];return new Cy(this.root,b.Id,b)}uB(){super.uB();this.Kc.setAttribute("role","toolbar");this.properties.Title&&this.Kc.setAttribute("title",this.properties.Title)}SEa(b){return this.root&&this.root.pbc(b)?!0:!1}JHn(){this.YOa()}scale(){super.scale();if(!Vf.a.rr(this.properties.Scale)||this.hye)return!1;
ff.c(this.Pia)||(this.Pia.visible=!0,this.Pia.N5e());ff.c(this.aY)||(this.aY.visible=!0,this.aY.N5e());ff.c(this.bpa)||(this.bpa.visible=!0,this.bpa.N5e());this.PJi(!1);const b=this.Kc.offsetWidth,h=ff.c(this.Pia)?0:this.Pia.w3b(),n=ff.c(this.aY)?0:this.aY.w3b(),x=ff.c(this.bpa)?0:this.bpa.w3b();x+n+h>=b&&(x+h>=b?(this.r3h(this.aY),x>=b?(this.r3h(this.Pia),this.yUf(this.bpa,b)):this.yUf(this.Pia,b-x)):this.yUf(this.aY,b-x-h));this.a0a=!1;this.jm();return!1}r3h(b){b&&(b.visible=!1)}yUf(b,h){b&&b.gAn(h)}}
Object(r.a)(dv,"Toolbar",jj.a,[830]);class Dy extends dv{constructor(b,h,n,x,E=!1){super(b,h,n,!1,!1,x,E);this.aNg=!0}get f7(){return 7}get cssClass(){return Dy.n0n+" "+super.cssClass}static get n0n(){let b="cui-statusbar";u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.w6||(b+=" UISmallFont UITextTranformUpperCase");return b}}Object(r.a)(Dy,"StatusBar",dv,[]);var Ey=d(502);class hA extends Ey.a{constructor(){super();this.toolbar=null;this.fPd=!1}}Object(r.a)(hA,"ToolbarBuildContext",Ey.a,
[]);class iA extends ol.Builder{constructor(b,h,n,x){super(b,h,aj.Task.W9(n),x);if(ff.c(h))throw Error.create("Toolbar placeholder DOM element is null or undefined.");}get toolbar(){return this.root}kYf(b){this.root=b}get z4f(){return this.options}Vlk(){const b=new hA,h=new ZA.a;h.id="toolbar";h.NVc=1;h.handler=Object(v.a)(this,this.CUm,"onReturnToolbarData");h.data=b;this.Lra.Y3d(h)}CUm(b){this.kYf(this.Xlk(b.fVc,b.tBc));this.toolbar.M$i=this;this.toolbar.jm();this.placeholder.appendChild(this.toolbar.Kc);
Vf.a.Pf(this.placeholder,"loaded");this.kra.continueWith(()=>{this.kra.result.DFb(this.toolbar)},11)}Xlk(b,h){var n=Fi.a.mea(b,Fi.a.Jqj);ff.c(n)&&(n=Fi.a.mea(b,Fi.a.iqj),h.fPd=!0);if(ff.c(n))throw Error.create("No toolbar element was present in the data");b=new Fi.a(n);n=u.AFrameworkApplication.K.$("ToolbarScalingRedundancyEliminationIsEnabled");h.fPd?this.kYf(new Dy(b.attributes[Fi.a.id],b.attributes,this,this.M8,n)):this.kYf(new dv(b.attributes[Fi.a.id],b.attributes,this,this.z4f.m0n,this.z4f.h9d,
this.M8,n));this.toolbar.ora=this.options.ora;this.toolbar.Wbe=!0;this.toolbar.jm();b=Fi.a.Fv(Fi.a.mea(b.node,Fi.a.bnj));h=this.$ik(b,h);for(const x of h)this.toolbar.Sf(x);return this.toolbar}$ik(b,h){const n=[];for(let x=0;x<b.length;x++)this.iMa(b[x])||Array.add(n,this.Hjk(b[x],h));return n}Hjk(b,h){const n=Fi.a.fIc(b);let x=null;n===Fi.a.Ilj?x=this.ijk(b,h):n===Fi.a.Gnj&&(x=this.gkk(b,h));return x}gkk(b,h){var n=new Fi.a(b);n=new uv(this.root,n.attributes[Fi.a.id],b[Fi.a.Rv]);n.n3h=this.z4f.NDm;
b=Fi.a.mea(b,Fi.a.xmb);b=Fi.a.Fv(b);const x=[];for(let S=0;S<b.length;S++){var E=b[S];this.iMa(E)||(E=this.kda(E,h),Array.add(x,E))}n.hKc=x;return n}ijk(b,h){new Fi.a(b);const n=this.toolbar.eGk(b);b=Fi.a.mea(b,Fi.a.xmb);b=Fi.a.Fv(b);for(let x=0;x<b.length;x++){if(this.iMa(b[x]))continue;const E=this.Wlk(b[x],h);n.Sf(E)}return n}Wlk(b,h){var n=new Fi.a(b);const x=n.name;n=n.attributes[Fi.a.Jhc];let E;E=h.fPd?"Small14":"Small";switch(x){case Fi.a.button:return b=this.kda(b,h),b.vP(ff.b(n)?E:n);case Fi.a.oAa:return E=
h.fPd?"Medium14":"Medium",b=this.kda(b,h),b.vP(ff.b(n)?E:n);case Fi.a.label:return b=this.kda(b,h),b.vP(ff.b(n)?E:n);case Fi.a.separator:return b=this.kda(b,h),b.vP("Small");case Fi.a.toggleButton:return b=this.kda(b,h),b.vP(ff.b(n)?E:n);default:throw Error.create("Invalid control type.");}}}Object(r.a)(iA,"ToolbarBuilder",ol.Builder,[]);var jA=d(1433);class br{constructor(b,h,n,x,E,S){this.Ehb=()=>{this.toolbar.xl()};this.nH=b;b=new Vn.CuiHelper(Gl.a.U$a,WordEditorIntl.WordEditorStrings,null,null,
[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings]);x=new gA;x.WF={};S=3!==S.mode;x.WF.HeaderToolbarControlsRight=S;x.WF.HeaderToolbarButtonDockRight=S;x.WF.HeaderToolbarButtonRemovePageNumbers=S;E=new iA(x,this.nH,this,E);E.Lra=new jA.a(br.GVl,b);E.Vlk();this.Zia=E.toolbar;n.execute(ma=>{this.toolbar.kE=ma});this.toolbar.refresh();this.toolbar.xl();this.Dh=h;h.SUa(this.Ehb)}get toolbar(){return this.Zia}dispose(){this.Dh.Fbc(this.Ehb);this.toolbar&&(this.toolbar.dispose(),this.Zia=null)}refresh(){this.toolbar.refresh()}setFocus(){this.toolbar.JHn()}nVk(){this.toolbar.M1()}DFb(){}}
br.GVl="WordEditorHeaderToolbarData";Object(r.a)(br,"HeaderFooterToolbar",null,[137,442]);class mz{constructor(b,h,n,x,E){this.Dh=b;this.wke=h;this.wc=n;this.M8=x;this.ga=E}create(b){return new br(b,this.Dh,this.wke,this.wc,this.M8,this.ga)}}Object(r.a)(mz,"Factory",null,[416]);class Ww{constructor(b,h){this.Xc=b;this.Lk=h}nLk(b){return'<Menu Id="HeaderToolbarSectionMenu"><MenuSection Id="HeaderToolbarSectionSection" DisplayMode="Menu16"><Controls Id="HeaderToolbarSectionControls">'+this.mLk(b)+"</Controls></MenuSection></Menu>"}xrl(b){const h=
this.Xc.Ck();h.set(b);h.Bb(8);h.kd(8);return h}mLk(b){if(!b)return"";let h="";b=this.xrl(b);this.Lk.CKa(b,n=>{const x=this.Lk.E_h(n);n=n.getValue(ic.a.nga);h+=xf.m(n.toString(),n.toString(),ub.a.OVf.toString(),ub.a.OMf.toString(),String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,x));return!0});return h}}Object(r.a)(Ww,"HeaderFooterToolbarGenerator",null,[415]);var RB=d(115);class $A extends vu.a{constructor(b,h,n,x,E,S,ma,Fa){super(b,h,n,x);this.Sr=()=>{this.A2c(this.zb)};
this.nH=b.container;this.mv=document.createElement("div");this.ZB(this.mv);this.Hxa=E;this.HGa=S;this.Bn.execute($a=>{$a.b7(this.Sr)});this.zE=ma;if(this.yH=Fa)this.nH.style.backgroundColor=this.zE.jAb()}dispose(){super.dispose();this.Bn.instance&&this.Bn.instance.ejb(this.Sr)}get Bn(){return null!=this.ejg?this.ejg:this.ejg=Oa.a.instance.Za("Common.IZoomManager")}ez(b){this.nH.classList.add("HeaderFooterViewElement");this.mv.classList.add("HeaderFooterViewContent");this.A2c(b.currentNode)}L7(b){this.mv.parentNode&&
this.mv.parentNode===this.nH||(this.nH.appendChild(this.mv),this.HGa.instance&&this.HGa.instance.oYf(this.ic,this.nH));super.L7(b)}Tlb(b){RB.a.Pd(()=>{RB.a.prototype.Tlb.call(this,b);this.Kej();this.HGa.instance&&this.HGa.instance.Tdj(this.ic,this.mv.style.paddingLeft,this.mv.style.paddingTop)},"HFVE:UFO")}A2c(b){this.Bn.instance&&this.Bn.instance.m4c(this.mv);this.Kej();b=this.Hxa.$2b(b);this.mv.style.paddingLeft=b.kZb+"px";this.mv.style.width=b.sBc+"px";this.HGa.instance&&this.HGa.instance.Tdj(this.ic,
this.mv.style.paddingLeft,this.mv.style.paddingTop)}Kej(){if(this.Bn.instance){this.mv.style.paddingTop="";var b=Hm.a.yB(this.mv);b.paddingTop&&(b=Ke.a.ZL(b.paddingTop),this.mv.style.paddingTop=Math.round(b/this.Bn.instance.vj)+"px")}}}Object(r.a)($A,"HeaderFooterViewElement",vu.a,[]);class Xw{constructor(b,h,n,x){this.Hxa=b;this.HGa=h;this.zE=n;this.yH=x}create(b,h,n,x){return new $A(b,h,n,x,this.Hxa,this.HGa,this.zE,this.yH)}}Object(r.a)(Xw,"Factory",null,[412]);var ew=d(369),Nx=d(188),wD=d(936),
aB=d(572);class vt extends ew.a{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd,Gd,vd,ce){super(h,S,ma,Fa,$a,Nx.a.wkf,sb,Jb,Sb,oc,Ic,gd,Gd,vd,ce);this.isHeader=this.isHeader=b;this.zTa=E;this.zTa.$0c=this;x(this);this.N7c=n;this.Swa=document.createElement("div");this.Swa.setAttribute("Unselectable","on");this.Swa.setAttribute("hideselection","hideselection");this.Swa.setAttribute("style","outline:none;");this.Swa.innerText=WordEditorIntl.WordEditorStrings.l_HeaderFooterNoContentAvailableMessage;
this.Swa.tabIndex=0;this.features.Y1i=!0;this.features.ZTe=!0}get Gpf(){return!0}Khf(){const b=this.N7c.f$e(this);return wD.ViewReference.lF(this,b)}$2e(b){Object(pb.a)(vt,b)||this.N7c.dismiss()}get Ijf(){return"WordEditor"+(this.isHeader?"Header":"Footer")+"HiddenLabel"}LIc(){return aB.a.Ypi}onResize(){super.onResize();this.zTa.TCh()}iB(b,h=null){this.Swa.parentNode&&this.Swa.parentNode.removeChild(this.Swa);super.iB(b,h);this.zTa.GCh(this.ud.Ti)}detach(){this.zTa.SCh();super.detach();this.Swa.parentNode||
this.container.insertBefore(this.Swa,this.container.firstChild)}LZc(){this.Nr?super.LZc():this.Swa.focus()}BCd(){this.onResize()}}Object(r.a)(vt,"HeaderFooterView",ew.a,[435,437,235,123,10,42,438,439,440]);class Ox{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd,Gd){this.N7c=b;this.rYj=h;this.qYj=n;this.mt=x;this.Yc=E;this.aja=S;this.ga=ma;this.hSa=Fa;this.xqa=$a;this.a5=sb;this.YYj=Jb;this.It=Sb;this.Yz=oc;this.Bf=Ic;this.Fh=gd;this.G7c=Gd}create(b,h){return new vt(b,h,this.N7c,this.rYj,this.qYj(),
this.mt,this.Yc,this.aja,this.ga,this.hSa,this.xqa,this.a5,this.YYj,this.It,this.Yz,this.Bf,this.Fh,this.G7c)}}Object(r.a)(Ox,"Factory",null,[414]);class fw{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd,Gd,vd,ce){this.mTg=!1;this.A_g="SourceControlId";this.g6n=1;this.h6n=1E3;this.k0d=(od,Yd,ne,Df,Af)=>{if(1===ne)return 32;this.kad(Af[this.A_g]);Af[Vi.a.Text]=this.BAe.YZm(this.j8a.yBb);return 32};this.W$m=(od,Yd,ne,Df,Af)=>{if(1===ne)return 32;Af[Qf.a.On]=this.j8a.yBb;return 32};this.CZl=(od,
Yd,ne,Df,Af)=>{if(1===ne)return 32;this.j8a.bho(Af[Qf.a.On]);return 32};this.uMi=(od,Yd,ne)=>{if(1===ne)return 32;if(this.h8){Yd=fw.oh.gu(Yd.view.ud);ne=md.GraphIterator.$a(Yd);const Df=this.Hd.jVa();try{const Af=this.Hc.Rc(15);try{Af.Db(Yd),Af.zl=od,Pm.a.instance.CKa(ne,Wi=>{this.ESb.VWc(Wi,this.Cml,this.ZIn);return!0})}finally{Af&&Af.dispose()}}finally{Df&&Df.dispose()}}return 32};this.qUc=(od,Yd,ne,Df,Af)=>{if(1===ne)return 32;Af.MenuItems=this.oOj.value;this.mTg?this.j8a.nun():this.mTg=!0;return 32};
this.s4l=(od,Yd,ne,Df,Af)=>{if(1===ne)return 32;const Wi=this.kad(Af[this.A_g]);if(this.h8){Yd=fw.oh.gu(Yd.view.ud);ne=md.GraphIterator.$a(Yd);Df=this.Hc.Rc(15);try{Df.Db(Yd);Df.zl=od;let gm=null;const Ck=this.le.fg("UserAction","InsertPageNumber");Pm.a.instance.CKa(ne,Rm=>{this.h8.N9||this.NAj(Rm);gm=this.AAe.q4l(Rm,Wi,this.j8a.yBb)||gm;return!0});Ck.stop();if(!gm)return 8;this.iVn(gm,Wi)}finally{Df&&Df.dispose()}this.Hd.us(12)}return 32};this.XZm=()=>32;this.OVn=(od,Yd,ne,Df,Af)=>{if(1===ne)return 32;
2===ne&&this.MHa.showCallout(Af);return 32};this.NVn=(od,Yd,ne,Df,Af,Wi)=>this.aGe.create(od,Yd,ne,Df,Af,Wi);this.qVk=(od,Yd,ne)=>{if(1===ne)return 32;this.MHa.Hyh();return 32};this.fUn=od=>{u.AFrameworkApplication.ya.bna(null,ub.a.w3i,od.customData,null)};this.Cml=od=>{const Yd=kh.a.instance.ib.kb;let ne=-1;for(let Df of Yd)if(Df.node===od){ne=Df.cpBegin;break}return{returnValue:ne,ZNd:Kd.SelectionEditor.Km(Yd)}};this.ZIn=(od,Yd)=>{od=Ae.SelectionFactory.xe(od,Yd);kh.a.instance.setSelection(od)};
this.ga=b;this.Hc=h;this.Hb=n;this.j8a=x;this.h8=E;this.Nl=S;this.BAe=ma;this.AAe=Fa;this.ESb=$a;this.MHa=sb;this.hb=Jb;this.aGe=Sb;this.le=oc;this.Hd=Ic;this.kad=gd;this.NAj=ce;this.oOj=new se.a(()=>this.j8a.wAl())}Vb(){this.ga.gb(ub.a.qUc,cc.a.view,this.qUc,100);this.ga.gb(ub.a.kBi,cc.a.view,this.XZm,68);this.ga.gb(ub.a.w7h,cc.a.view,this.s4l,4);this.ga.gb(ub.a.yBb,cc.a.view,this.CZl,4);this.ga.gb(ub.a.VWc,cc.a.view,this.uMi,4);this.ga.gb(ub.a.kon,cc.a.view,this.uMi,4);this.ga.gb(ub.a.nNf,cc.a.application,
this.W$m,97);this.ga.gb(ub.a.k0d,cc.a.application,this.k0d,97);this.ga.gb(ub.a.v3i,cc.a.view,this.OVn,4);this.ga.jS(ub.a.w3i,cc.a.view,this.NVn,100);this.ga.gb(ub.a.pVk,cc.a.view,this.qVk,4)}iVn(b,h){const n=b.Ob.paragraph;if(n){var x=this.Nl.JBf(n);x&&this.h8.Vda(x)}x=this.h8.N9;this.h8.show(4>h);n&&this.nIn(n)&&(this.nMn(b,n),this.X3j(b,x))}nIn(b){let h;if(!({isHeader:h,t3f:b}=this.Nl.fZh(b)).returnValue)return!1;this.h8.gva(b,h);return!0}nMn(b,h){b=Ae.SelectionFactory.xe(h,b.Ob.cp);this.hb.setSelection(b)}X3j(b,
h){h=new We.a(2,1,h?this.g6n:this.h6n,this.fUn);h.customData=b;this.Hb.$b(h)}static get oh(){return ql.PageNavigator.instance}}Object(r.a)(fw,"PageNumbersActor",null,[441]);class DC{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc){this.ga=b;this.Hb=h;this.j8a=n;this.BAe=x;this.AAe=E;this.ESb=S;this.MHa=ma;this.aGe=Fa;this.Nl=$a;this.Hd=sb;this.kad=Jb;this.zXj=Sb;this.Nca=oc}create(b,h){return new fw(this.ga,new Zm.a,this.Hb,this.j8a,b,this.Nl,this.BAe,this.AAe,this.ESb,this.MHa,kh.a.instance,this.aGe,
ob.App.xa.iq,this.Hd,this.kad,this.zXj,this.Nca,h)}}Object(r.a)(DC,"Factory",null,[413]);var Px=d(1828),zh;(function(b){b[b.small=0]="small";b[b.mediumSmall=1]="mediumSmall";b[b.medium=2]="medium";b[b.large=3]="large"})(zh||(zh={}));Object(r.b)("ModalCalloutSize",zh);var Fy;(function(b){b[b.topCenter=0]="topCenter";b[b.topJustified=1]="topJustified";b[b.topLeft=2]="topLeft";b[b.topRight=3]="topRight";b[b.bottomCenter=4]="bottomCenter";b[b.bottomLeft=5]="bottomLeft";b[b.bottomRight=6]="bottomRight"})(Fy||
(Fy={}));Object(r.b)("BeakLocation",Fy);class bB{constructor(b,h,n){this.f6n=1;this.ZCe=!1;this.XTb=null;this.djn=()=>{this.hb.OD(this.cna);this.ZCe=!0;this.XTb=null};this.cna=(x,E)=>{if(x=E.kl.kb)1<x.length||!x.length?x=!0:(x=x.Qa,x=x.cpEnd-x.cpBegin,x=1<x||!x),x&&this.Qzj()};this.Hb=b;this.hb=h;this.Qzj=n}Uy(){this.W3j()}J7(){this.ZCe?(this.hb.ega(this.cna),this.ZCe=!1):this.XTb&&(this.Hb.ef(this.XTb),this.XTb=null)}W3j(){this.XTb=new We.a(2,1,this.f6n,this.djn);this.Hb.$b(this.XTb)}}Object(r.a)(bB,
"CalloutDismissManager",null,[]);class Es{constructor(b,h,n,x){this.dismiss=()=>{this.qI&&(this.Hlc.J7(),this.pRc.dismiss())};this.pRc=b;this.xp=x;this.Hlc=new bB(h,n,this.dismiss)}get qI(){return this.pRc.qI}show(){if(!this.qI){const b=document.createElement("div");b.classList.add(Es.WZm);b.innerText=WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText;this.pRc.content=b;this.pRc.show();this.xp&&this.xp.sendNotification(WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText,!0);this.Hlc.Uy()}}dispose(){this.dismiss();
this.pRc.dispose()}static pJk(b,h){h=Px.a.Jsh(rd.a.getElementBounds(b.targetElement),h,ob.App.xa.eC,zh.small);h.fda=Es.zaf(b);h.yt=!1;return h}static zaf(b){let h=Fy.bottomCenter;Object(pb.a)(435,b.view)&&b.view.isHeader&&(h=Fy.topCenter);return h}}Es.WZm="PageNumbersCalloutControl";Object(r.a)(Es,"PageNumbersCallOutControl",null,[436]);class Ip{constructor(b,h,n){this.LR=null;this.DR=!1;this.dismiss=()=>{this.qI&&this.LR&&Cj.UISurfaces.UP().then(x=>{this.Hlc.J7();x.removeNotification(this.LR);this.DR=
!1;return null},x=>{w.ULS.sendTraceTag(593352339,383,15,"Failed to GetNotificationsAPIAsync: {0}",x);return null})};this.Tl=b;this.Hlc=new bB(h,n,this.dismiss)}get qI(){return this.DR}show(){this.qI||Cj.UISurfaces.UP().then(b=>{const h=b.callout(Object.assign(new ur.a,{target:this.Tl,content:WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText})),n=Object.assign(new wd.a,{telemetryId:"PageNumbersCallout",onShow:()=>{this.DR=!0},expirationOptions:Object.assign(new Le.a,{displayTimeoutSeconds:7,
onExpire:()=>{this.dismiss()}})});this.LR=b.addNotification(h,n);this.Hlc.Uy();return null},b=>{w.ULS.sendTraceTag(593352340,383,15,"Failed to GetNotificationsAPIAsync: {0}",b);return null})}}Object(r.a)(Ip,"ReactPageNumbersCallOutControl",null,[436]);class cB{constructor(b,h,n){this.hb=h;this.Hb=b;this.xp=n}create(b,h){if(u.AFrameworkApplication.ua.Sb&&u.AFrameworkApplication.ua.Sb.nMa)return new Ip(h.targetElement,this.Hb,this.hb);b=Es.pJk(h,b);return new Es(b,this.Hb,this.hb,this.xp,u.AFrameworkApplication.ua.qM)}}
Object(r.a)(cB,"Factory",null,[409]);class dB{constructor(b,h){this.yD=null;this.nOj=b;this.xi=h}get control(){return this.yD}showCallout(b){this.control&&this.control.qI&&this.control.dismiss();this.yD=this.L5m(b);this.control.show()}Hyh(){this.control&&(this.control.dismiss(),this.yD=null)}L5m(b){const h=this.xi.Qka();this.yD=this.nOj.value.create(h,b);return this.control}}Object(r.a)(dB,"PageNumbersCalloutControlManager",null,[411]);var eB=d(748);class fB extends Qp.a{constructor(){super();this.Text=
null}get Type(){return 7}}Object(r.a)(fB,"PageNumberGalleryButtonProps",Qp.a,[]);const vv=(b,h,n)=>{b=b.Ck();b.set(n);h.aFb(b);return b};class Cu{constructor(b,h,n){this.yre=!1;this.Nca=h;this.Ql=n}get yBb(){return this.yre}wAl(){const b=Object.assign(new ti.a,{Id:"menuPageNumbersDropDown",MenuSectionList:[]});b.MenuSectionList.push(this.E1j());b.MenuSectionList.push(this.q2j());b.MenuSectionList.push(this.S2j());return b}bho(b){this.yre=b;this.NJi()}nun(){this.yre=!1;const b={};b[Cu.A5h]="CheckboxModel";
this.Nca(b);this.NJi()}E1j(){const b=Object.assign(new Fh.a,{Id:"msIncludePageCount",ControlsId:"ctrlIncludePageCount",Title:B.a.If(WordEditorIntl.WordEditorStrings.L_PageNumbersSectionHeaderForAdd),ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new eB.a,{Id:Cu.DZl,Command:ub.a.yBb.toString(),QueryCommand:ub.a.nNf.toString(),LabelText:B.a.If(WordEditorIntl.WordEditorStrings.L_IncludePageCount),Alt:B.a.If(WordEditorIntl.WordEditorStrings.L_IncludePageCountAlt),KeyTip:CommonUIStrings.l_IncludePageCountKeytip,
UseUncheckedImage:!0,CloseMenuWhenExecuted:!1});b.ControlList.push(h);return b}q2j(){const b=Object.assign(new Fh.a,{Id:"msPageNumbersPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),h=Object.assign(new ao.a,{Id:"galleryPageNumbersPosition",ExternalId:"PageNumbers",ExternalGalleryId:"InsertPageNumberGallery",Type:7,Width:3,ElementDimensions:"Size61by75",GalleryItems:[]});if(this.Ql){for(var n=3;1<=n;n--)h.GalleryItems.push(this.Scf(n));for(n=6;4<=n;n--)h.GalleryItems.push(this.Scf(n))}else for(n=
1;6>=n;n++)h.GalleryItems.push(this.Scf(n));b.ControlList.push(h);return b}S2j(){const b=Object.assign(new Fh.a,{Id:"msRemovePageNumbers",ControlsId:"ctrlRemovePageNumbers",DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new Pg.a,{Id:"btnRemovePageNumber",Command:ub.a.VWc.toString(),LabelText:B.a.If(WordEditorIntl.WordEditorStrings.L_RemovePageNumbers),Alt:B.a.If(WordEditorIntl.WordEditorStrings.L_RemovePageNumbersAlt),Image16by16:u.AFrameworkApplication.mr,Image16by16Class:Tg.getImageClass("WordRemovePageNumbers_16x16x32"),
KeyTip:CommonUIStrings.l_RemovePageNumbersKeytip});b.ControlList.push(h);return b}Scf(b){const h=Cu.vIf+b.toString();var n=Object,x=n.assign,E=new fB,S=ub.a.w7h.toString(),ma=ub.a.k0d.toString(),Fa=B.a,$a=Fa.If;let sb="";switch(b){case 1:sb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopLeftAlt;break;case 2:sb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopCenterAlt;break;case 3:sb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopRightAlt;break;case 4:sb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomLeftAlt;
break;case 5:sb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomCenterAlt;break;case 6:sb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomRightAlt}return x.call(n,E,{Id:h,Command:S,QueryCommand:ma,Alt:$a.call(Fa,sb)})}NJi(){const b={};for(let h=1;6>=h;h++)b[Cu.vIf+h.toString()]="PageNumberGalleryButtonModel";b[Cu.A5h]="CheckboxModel";this.Nca(b)}static xAl(b){return b?parseInt(b.substr(Cu.vIf.length)):1}}Cu.DZl="btnIncludePageCount";Cu.A5h="IncludePageCount";Cu.vIf="btnPageNumbersPosition";
Object(r.a)(Cu,"PageNumbersControl",null,[410]);class wv{constructor(b,h,n,x,E=null,S=null,ma=null,Fa=null){this.Zrl=($a,sb)=>{const Jb=new qk.a;$a=4>$a;switch(sb){case 1:case 2:Jb.add($a?0:3);break;case 3:case 4:Jb.add($a?0:3),Jb.add($a?1:4)}return Jb};this.ell=($a,sb,Jb)=>{var Sb=vv(this.Xc,this.Nl,$a);this.Nl.bFb(Sb,Jb);let oc=this.jyj(Sb,sb);if(oc)this.ESb.XMi(oc);else{Sb=vv(this.Xc,this.Nl,$a);this.Nl.bFb(Sb,Jb);Sb.Wd();if(Kf.OutlineElementReader.Nh(Sb)&&(wf.OutlineElementNavigator.He(Sb),Cd.ParagraphReader.wh(Sb))){Sb=
Sb.currentNode;const Ic=this.kZh(sb);Cd.ParagraphReader.Ev(Sb)===Ic&&this.ESb.XMi(Sb)&&(oc=Sb)}oc||(Sb=vv(this.Xc,this.Nl,$a),this.Nl.bFb(Sb,Jb),this.lK.Seb(Sb,null,!0),oc=wf.OutlineElementNavigator.He(Sb),this.lD(sb,oc))}return oc};this.fll=($a,sb)=>{let Jb=null;$a.Rb(1);if(Kf.OutlineElementReader.Nh($a)&&($a.Rb(2),ag.TableReader.isTable($a))){var Sb=$a.currentNode;if(3===ag.TableReader.kh(Sb)){let oc=0;Sb=ag.TableReader.hm(Sb);switch(sb){case 1:case 4:oc=Sb?2:0;break;case 2:case 5:oc=1;break;case 3:case 6:oc=
Sb?0:2}$d.moveToCellContent($a,0,oc);$a.currentNode&&Kf.OutlineElementReader.Nh($a)&&($a=wf.OutlineElementNavigator.He($a),Cd.ParagraphReader.oc($a)&&(Jb=$a))}}return Jb};this.dcm=($a,sb)=>{const Jb=vv(this.Xc,this.Nl,$a);$a=Jb.currentNode.ia(ic.a.nga,0);this.Nl.bFb(Jb,sb);sb=Jb.currentNode.ia(ic.a.nga,0);return $a===sb};this.Xc=b;this.pOj=h;this.ESb=n;this.Nl=x;this.Lnc=E||this.Zrl;this.kyj=S||this.ell;this.jyj=ma||this.fll;this.wHj=Fa||this.dcm}get lK(){return null!=this.Omg?this.Omg:this.Omg=Oa.a.instance.resolve("Box4.IOutlineEditor")}q4l(b,
h,n){var x=vv(this.Xc,this.Nl,b).xn;x=this.Nl.gla(x);x=this.Lnc(h,x);let E=null;for(let ma=0;ma<x.length;ma++){var S=x.mg(ma);this.wHj(b,S)&&(S=this.kyj(b,h,S),E=this.pOj.p2j(S,n)||E)}return E}lD(b,h){wv.B7.e6d(4>b?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,h);wv.paragraphEditor.lD(h,this.kZh(b))}kZh(b){let h=1;switch(b){case 1:case 4:h=1;break;case 2:case 5:h=2;break;case 3:case 6:h=3}return h}static get paragraphEditor(){return null!=wv.Lng?wv.Lng:wv.Lng=Oa.a.instance.resolve("Box4.IParagraphEditor")}static get B7(){return null!=
wv.Zog?wv.Zog:wv.Zog=Oa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}}Object(r.a)(wv,"PageNumbersInserter",null,[407]);var Gy=d(857),EC=d(865);class Fs{constructor(b,h,n=null,x=null,E=null){this.DFk=(S,ma)=>{S=Dd.a.Uc(S,Cd.ParagraphReader.textLength(S));const Fa=S.node.Nc;return Fa?Fs.characterPropertiesEditor.Iea(S,$a=>{$a=EC.a.getInstance($a);this.iwd($a,15,Fa,ma);this.iwd($a,47,Fa,ma);this.iwd($a,16,Fa);this.iwd($a,17,Fa);return $a}):null};this.S4l=(S,ma)=>{S=Dd.a.Uc(S,Cd.ParagraphReader.textLength(S));
Fs.characterPropertiesEditor.replaceTextRange(S,ma)};this.Hc=b;this.Rgd=n||WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.qke=x||this.DFk;this.l1g=E||this.S4l}p2j(b,h){const n=this.Hc.Rc(15);n.Db(b);var x=Cd.ParagraphReader.text(b),E=!1;0<x.length&&" "!==x.charAt(x.length-1)&&(E=!0);if(h){h=String.format(this.Rgd,"#","$");E&&(h=" "+h);E=h.indexOf("#");x=h.indexOf("$");w.ULS.shipAssertTag(4256717,309,-1!==E,"{0}",{["PageNumberIndex"]:E});w.ULS.shipAssertTag(4256718,309,
-1!==x,"{0}",{["PageCountIndex"]:x});w.ULS.shipAssertTag(4256719,309,E!==x,"{0}",{["PageNumberIndex"]:E,["PageCountIndex"]:x});let Fa;let $a;if(E<x){var S=E;Fa=x;var ma=Gy.a.oHc(0);$a=Gy.a.oHc(1)}else S=x,Fa=E,ma=Gy.a.oHc(1),$a=Gy.a.oHc(0);this.Smf(b,h,0,S);ma=this.qke(b,ma);this.Smf(b,h,S+1,Fa);S=this.qke(b,$a);this.Smf(b,h,Fa+1,h.length);b=E<x?ma:S}else E&&this.l1g(b," "),b=this.qke(b,Gy.a.oHc(0));n.dispose();return b}iwd(b,h,n,x=null){const E=new Cs.a;E.setValue(ie.a.E7,!0);E.setValue(ic.a.Gyb,
1);E.setValue(ic.a.gq,h);switch(h){case 15:E.setValue(ic.a.sMa,!0);E.setValue(ic.a.fieldInstruction,x);break;case 47:E.setValue(ic.a.fieldInstruction,x);break;case 17:E.setValue(ic.a.lDb,!0)}h=n.Gu(E,C.a.create());this.n3j(b,h)}n3j(b,h){b.Qqa(h,C.a.nil,Tc.AParagraphNode.tB,null)}Smf(b,h,n,x){h=h.substring(n,x);0<h.length&&this.l1g(b,h)}static get characterPropertiesEditor(){return Fs.Vd||(Fs.Vd=Oa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(b){Fs.Vd=
b}}Fs.Vd=null;Object(r.a)(Fs,"PageNumbersNodeLevelInserter",null,[408]);class gw{YZm(b){return gw.NCl(b)}static NCl(b){return String.format(b?WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount:WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewText,gw.UAi,gw.UAi)}}gw.UAi="1";Object(r.a)(gw,"PageNumbersPositionPreviewGenerator",null,[406]);class SB{constructor(){this.qxg=String.format(WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount,"\ufffc","\ufffc");
this.Ixj=this.qxg.length}ZUl(b){let h=b.characterData.lastIndexOf("\ufffc");return-1!==h&&h+1===Cd.ParagraphReader.textLength(b)?{returnValue:!0,tUc:h}:{returnValue:!1,tUc:-1}}MTl(b){let h=b.characterData.lastIndexOf(this.qxg);return-1!==h&&h+this.Ixj===Cd.ParagraphReader.textLength(b)?{returnValue:!0,tUc:h}:{returnValue:!1,tUc:-1}}EUl(b){return Ad.a(b,9)?!0:!1}}Object(r.a)(SB,"PageNumbersReader",null,[404]);class gB{constructor(b,h,n,x,E,S=null,ma=null){this.jon=(Fa,$a,sb,Jb)=>{Fa=vv(this.Xc,this.Nl,
Fa);this.Nl.bFb(Fa,$a);$a=Oh.a.tq(Fa);for(Fa=!1;$a.moveNext();){const Sb=$a.currentNode;if(Cd.ParagraphReader.oc($a.currentNode)&&Ad.a($a.currentNode,9)){Fa=!0;let oc;const Ic=({ZNd:oc}=sb(Sb,oc)).returnValue;let gd=Ic;gd=this.Smn(Sb,gd);gd=this.Eon(Sb,gd);-1<Ic&&(gd===Ic&&oc||Jb(Sb,gd))}}Fa&&this.Hd.us(12)};this.Xc=b;this.Nl=h;this.CAe=n;this.Hd=x;this.Ptc=E;this.Lnc=S||Vw.a.g2e;this.FQj=ma||this.jon;this.Rgd=WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.UDg=String.format(this.Rgd,
"#","$");this.NFj=this.UDg.indexOf("#");this.MFj=this.UDg.indexOf("$");this.Ooe=String.format(this.Rgd,"\ufffc","\ufffc");this.NDg=this.Ooe.length}VWc(b,h,n){var x=vv(this.Xc,this.Nl,b).xn;x=this.Nl.gla(x);x=this.Lnc(x);for(let E of x)this.FQj(b,E,h,n)}XMi(b){if(this.CAe.EUl(b)){let h=-1;if(({tUc:h}=this.CAe.MTl(b)).returnValue&&this.bkh(b,h)||({tUc:h}=this.CAe.ZUl(b)).returnValue&&this.Erk(b,h))return!0}return!1}Eon(b,h){var n=b.qa.length;for(let E=0;E<n;E++){var x=b.qa.J(E);x.blob&&9===x.blob.ri&&
(x=x.cp,n=Dd.a.createTextRange(b,x,x+1),this.Ptc(n,""),n=b.qa.length,E--,h=this.V9g(h,x,1))}return h}Smn(b,h){let n=b.characterData.indexOf(this.Ooe);for(;-1!==n;)this.bkh(b,n)&&(h=this.V9g(h,n,this.NDg)),n=b.characterData.indexOf(this.Ooe);return h}Erk(b,h){const n=b.qa.ji(h);return n&&n.blob&&9===n.blob.ri?(b=Dd.a.createTextRange(b,h,h+1),this.Ptc(b,""),!0):!1}bkh(b,h){const n=b.qa.ji(h+this.NFj),x=b.qa.ji(h+this.MFj);return n&&n.blob&&9===n.blob.ri&&x&&x.blob&&9===x.blob.ri?(b=Dd.a.createTextRange(b,
h,h+this.NDg),this.Ptc(b,""),!0):!1}V9g(b,h,n){-1<b&&b>h&&(h=b-h,b=h>n?b-n:b-h);return b}}Object(r.a)(gB,"PageNumbersRemover",null,[403]);class Gs{constructor(b,h){this.Wmb=this.Vmb=null;this.Wq=b;this.Hb=h}a$j(){this.Wq.style.display="";this.Vmb||(this.Wmb&&(this.Hb.ef(this.Wmb),this.Wmb=null),this.Vmb=new We.a(0,1,10,()=>{this.Wq.classList.add("Displayed");this.Vmb=null}),this.Hb.$b(this.Vmb))}c$j(){this.Wq.classList.remove("Displayed");this.Wmb||(this.Vmb&&(this.Hb.ef(this.Vmb),this.Vmb=null),
this.Wmb=new We.a(0,1,200,()=>{this.Wq.style.display="none";this.Wmb=null}),this.Hb.$b(this.Wmb))}}Object(r.a)(Gs,"PaneControlAnimationHelper",null,[433]);class Qx{constructor(b){this.Hb=b}CAl(b){return new Gs(b,this.Hb)}}Object(r.a)(Qx,"PaneControlAnimationHelperFactory",null,[402]);class Hy{constructor(b,h,n,x,E,S,ma,Fa,$a=!1){this.osg=this.Zia=this.Had=null;this.zVl=()=>{this.fw.sendNotification(this.osg+" "+WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText,!0)};this.ga=
b;this.i4=h;this.i4.bind(this);this.Tse=n;this.Bia=E;this.cJe=ma;this.Wb=Fa;this.fcd=$a;this.Xba=S.value.create(n,x);this.i4.Ggk(this.Xba);this.oY=mc.KeyInputManager.mc(db.a.L3,0)}get fw(){return null!=this.cfg?this.cfg:this.cfg=Oa.a.instance.resolve("Common.Utils.IAriaNotifier")}j_(b){this.i4.j_(b);this.Zia&&!b&&this.Zia.nVk()}Vda(b){this.Had!==b&&(this.qbb(),this.Had=b)}RVi(b){if(this.Had){var h=this.Bia.hdb(this.Had,Vw.a.Yrl(b,this.Tse));this.fcd?(this.osg=this.WJh(b,this.Tse),this.Xba.WIb(qf.a.krd)):
this.Ndo(b);h&&this.SQe(h)}}Ych(b){this.fcd&&this.Wb&&(b=this.Wb.pe(b))&&b.Vca(this.zVl)}WJh(b,h){let n="";switch(b){case 1:n=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessage;break;case 2:n=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessageForReadOnly:
WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessage;break;case 3:n=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessage;
break;case 4:n=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessage}return n}Ndo(b){this.Xba.bXi(this.WJh(b,this.Tse),qf.a.krd)}setInitialSelection(){this.Xba.LZc()}SQe(b){this.qbb();this.Xba.iB(b,b.Ti)}qbb(){this.Xba.detach()}mMk(){this.Zia=
this.cJe.value.create(this.i4.Ufc);this.bPn(this.Zia)}bPn(b){if(this.Wb){const h=this.Wb.pe(Dm.a.IYa);h.parent=xd.AFrame.Lp;h.Wca(()=>{b.setFocus();this.rNn()});h.bindAction(this.oY,ub.a.ES)}}rNn(){if(this.Wb){var b=this.Wb.pe(Dm.a.IYa);const h=new ke.DOMFocusListing(()=>this.i4.Ufc);h.uDa=!0;h.Go(1);this.Wb.eTe(this.i4.Ufc,b,h);b=this.Wb.getRegion(Dm.a.IYa);b.oOa();b.dX=!0;h.bea&&h.hy(h.bea)}}dispose(){void 0!==this.Zia&&null!==this.Zia&&(this.Wb.pe(Dm.a.IYa).Ar(this.oY),this.Zia.dispose())}Ghn(){void 0!==
this.Zia&&null!==this.Zia&&this.Zia.refresh()}}Object(r.a)(Hy,"PaneControl",null,[434]);class hB{constructor(b,h,n,x){this.Nl=b;this.DEj=h;this.cJe=n;this.Wb=x}create(b,h,n,x){return new Hy(b,h,n,x,this.Nl,this.DEj,this.cJe,this.Wb,u.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}}Object(r.a)(hB,"Factory",null,[405]);var iB=d(1062);class FC extends Wc.a{constructor(b,h,n,x,E,S,ma,Fa,$a){super();this.init(b);this.ll("ShowCalloutForPageNumberOperation");this.Xsj=Fa;
this.Neb(this.Xsj,h,x,E,S);this.nz=0;this.vsc=S;this.MHa=ma;this.Dh=$a;1===this.behavior&&(this.$q=32,this.Cna())}run(){var b=this.Dh.jb.uv;!this.nz&&this.vsc.OJd(b)&&this.vsc.dYa(b).element&&(this.nz=1);if(1===this.nz){const h=this.vsc.dYa(b);b=new iB.a(h.element,b);this.MHa.showCallout(b);this.nz=2}2===this.nz&&(this.$q=32,this.Cna())}}Object(r.a)(FC,"ShowCalloutForPageNumberOperation",Wc.a,[]);class GC{constructor(b,h,n){this.MHa=b;this.ga=h;this.RMb=n}create(b,h,n,x,E,S){return new FC(b,h,n,x,
E,S,this.MHa,this.ga,this.RMb)}}Object(r.a)(GC,"Factory",null,[297]);class Iy{get lK(){return null!=this.Mmg?this.Mmg:this.Mmg=Oa.a.instance.resolve("Box4.IOutlineEditor")}zc(b){b.ha("WordEditor.HeaderFooter.HeaderFooterManager",()=>new WA(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlOwner"),b.resolve("WordEditor.HeaderFooter.HeaderFooterActor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),b.Ye("WordEditor.HeaderFooter.IPageNumbersActorFactory"),b.resolve("WordEditor.IHeaderFooterViewElementFactory"),
b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterView.Factory",()=>new Ox(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),PB.a.qXe,()=>b.resolve("WordEditor.SectionAlignedViewRepositioner"),ob.App.xa.jb,cb.InteractiveViewManager.instance,()=>b.resolve("Box4.IUndoManager"),u.AFrameworkApplication.ya,b.resolve("Box4.IInteractiveEventNotifier"),b.Za("Box4.ITextMetricsAdapter"),
b.resolve("Box4.IRotatingCoordinateConverter"),b.Za("Common.IZoomManager"),b.Pa("Box4.IContentControlViewElementManager"),b.Pa("Box4.CpConversionManagerImpl"),b.Pa("Box4.ContentControlConfigSettings"),b.Pa("Box4.IContentControlReader"),b.Pa("Box4.IContentControlBoundaryNavigator"))).as("WordEditor.HeaderFooter.IHeaderFooterViewFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterViewElement.Factory",()=>new Xw(b.resolve("Box4.SectionAlignedViewPositionProvider"),b.Za("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),
b.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!ob.App.instance&&ob.App.instance.yA)).as("WordEditor.IHeaderFooterViewElementFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterToolbar.Factory",()=>new mz(Kb.App.fm,b.Za("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),Kb.App.fm,u.AFrameworkApplication.ya)).as("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory").singleInstance();b.ha("WordEditor.HeaderFooter.PaneControl.Factory",()=>new hB(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),
b.Ye("WordEditor.HeaderFooter.IHeaderFooterViewFactory"),b.Ye("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory"),de.FocusManager.instance())).as("WordEditor.HeaderFooter.IPaneControlFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControl.Factory",()=>new lz(()=>{ob.App.xa.updateCommandUI()},b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),u.AFrameworkApplication.ya,b.resolve("Box4.ContentEditableViewEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlFactory").singleInstance();
b.ha("WordEditor.HeaderFooter.PageNumbersActor.Factory",()=>new DC(u.AFrameworkApplication.ya,Ye.a.instance,b.resolve("WordEditor.HeaderFooter.PageNumbersControl"),b.resolve("WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator"),b.resolve("WordEditor.HeaderFooter.PageNumbersInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),
b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Cu.xAl,Object(v.a)(ob.App.xa,ob.App.xa.R2c,"updateRibbonControl"),Object(v.a)(ob.App.xa,ob.App.xa.ZF,"updateRibbonControls"))).as("WordEditor.HeaderFooter.IPageNumbersActorFactory").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControlLauncher",()=>new dA).singleInstance();b.ha("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory",()=>new Qx(Ye.a.instance)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterControlOwner",
()=>new SA(de.FocusManager.instance(),ob.App.xa.gv,b.Ye("WordEditor.HeaderFooter.IPaneControlFactory"),b.Ye("WordEditor.HeaderFooter.IHeaderFooterControlFactory"),b.Ye("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory"),u.AFrameworkApplication.ya,new se.a(()=>ob.App.xa.jb.Jc),u.AFrameworkApplication.K,b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Box4.IExternalContentFloatieEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent").singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterEditor",
()=>new tv(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),Nd.PageReader.instance,new qm.a,Pm.a.instance)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator",()=>new Ww(new qm.a,Pm.a.instance));b.ha("WordEditor.HeaderFooter.HeaderFooterActor",()=>new dw(u.AFrameworkApplication.ya,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),Pm.a.instance,new qm.a,
new Zm.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator"),dw.D_h,b.resolve("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory"))).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter",()=>new lq(yy.a.instance,lq.iJl(b.resolve("Box4.ITableEditor")),lq.Lil(),u.AFrameworkApplication.isRtl,wf.OutlineElementNavigator.ae,lq.mHl(),lq.Mrl(),b.resolve("Box4.IOutlineElementEditor")));b.ha("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter",()=>new UA(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),
new qm.a,h=>this.lK.Seb(h),u.AFrameworkApplication.isRtl,Object(v.a)(b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.IOutlineElementEditor").jJb,"setRtlSimple"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter")));b.ha("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter",()=>new XA(Pm.a.instance,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooterNodeFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter"))).singleInstance();
b.ha("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory",()=>new Ay(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new qm.a,new Zm.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),u.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.HeaderFooter.HeaderFooterInserter",()=>new kz(b.resolve("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),Pm.a.instance,new qm.a,u.AFrameworkApplication.ya)).singleInstance();
b.ha("WordEditor.HeaderFooter.PageNumbersControl",()=>new Cu(Object(v.a)(ob.App.xa,ob.App.xa.R2c,"updateRibbonControl"),Object(v.a)(ob.App.xa,ob.App.xa.ZF,"updateRibbonControls"),u.AFrameworkApplication.isRtl)).singleInstance();b.register(gw,"WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter",()=>new Fs(new Zm.a,b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersInserter",
()=>new wv(new qm.a,b.resolve("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersReader",()=>new SB).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersRemover",()=>new gB(new qm.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.PageNumbersReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
Object(v.a)(Iy.characterPropertiesEditor,Iy.characterPropertiesEditor.replaceTextRange,"replaceTextRange"))).singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersCalloutControlManager",()=>new dB(b.Ye("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory"),ob.App.xa)).as("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager").singleInstance();b.ha("WordEditor.HeaderFooter.PageNumbersCallOutControl.Factory",()=>new cB(Ye.a.instance,kh.a.instance,b.resolve("Common.Utils.IAriaNotifier"))).as("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory").singleInstance();
b.ha("WordEditor.HeaderFooter.ShowCalloutForPageNumberOperation.Factory",()=>new GC(b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),u.AFrameworkApplication.ya,ob.App.xa)).as("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory").singleInstance();b.ha("WordEditor.HeaderFooter.ClientPaginationPageAdornmentContentManager",()=>new QA(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),u.AFrameworkApplication.ya)).as("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager").singleInstance();
b.ha("WordEditor.HeaderFooter.ClientPaginationHeaderFooterBridge",()=>new cv(b.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),b.resolve("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager"))).as("WordEditor.IClientPaginationHeaderFooterBridge").singleInstance()}static get characterPropertiesEditor(){return null!=Iy.Ffg?Iy.Ffg:Iy.Ffg=Oa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}}Object(r.a)(Iy,"HeaderFooterComponentConfiguration",null,[2]);class jB{constructor(){this.Jad=
this.W=null}get name(){return"WordEditor.HeaderFooter"}zc(b){this.W=b;(new Iy).zc(b)}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Nm()})}Nm(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(121)&&(this.Jad=this.W.resolve("WordEditor.HeaderFooter.HeaderFooterManager"),this.Jad.start(),this.W.resolve("WordEditor.IClientPaginationHeaderFooterBridge"))}dispose(){this.Jad&&this.Jad.dispose()}static main(){N.a.instance.Pc(new jB)}}Object(r.a)(jB,"PackageManager",null,[1,
2]);var Ut=d(383),HC=d(796);class hw{constructor(b,h){this.Bf=b;this.Qm=h}create(){return new HC.a(this.Bf.instance,this.Qm.instance)}}Object(r.a)(hw,"ContentControlNodeFactory",null,[200]);var TB=d(1625),UB=d(1011);class VB{create(){return new UB.a}}Object(r.a)(VB,"ContentControlContainerNodeFactory",null,[200]);class kB{constructor(b,h,n,x){this.Ara=b;this.rph=h;this.vvd=n;this.DI=x;this.$Bk=new VB;this.rNm=(E,S)=>{this.DI.Pd(()=>{if(S){S.xo.selectedContentControls||(S.xo.selectedContentControls=
{});var ma=S.xo.selectedContentControls,Fa=S.TOa;if(Fa&&Fa.length){var $a=Fa[0];Fa=Fa[Fa.length-1];$a=this.Ara.lbf(Dd.a.Uc($a.node,$a.gl),Dd.a.Uc(Fa.node,Fa.ot),!1);for(let sb of $a)ma[sb.contentControlNode.id.toString()]=!0}}},"CC:OnBeforeCopy")};this.SSc=(E,S)=>{this.DI.Pd(()=>{if(S){var ma=S.clone,Fa=S.original;try{const $a=S.xo.selectedContentControls,sb=this.Ara.waf(Fa,0,Fa.characterData.length,!0,!0,!1);for(let Jb of sb){const Sb=Jb.oe.toString();$a[Sb]?Jb.zq&&!this.jEk(Jb.contentControlNode,
ma,$a)&&(w.ULS.sendTraceTag(521172763,368,10,String.format("Cannot clone ContentControlNode id:{0} under the clipboard tree",Sb)),this.tQf(ma,Jb.oe)):this.tQf(ma,Jb.oe)}}catch($a){w.ULS.sendTraceTag(521171974,307,10,"onParagraphCopy operation failed: {0}",$a.toString()),this.rph.rmn(ma)}}},"CC:onParagraphCopy")};this.USc=(E,S)=>{this.DI.Pd(()=>{if(S){var ma=S.clone,Fa=S.original;try{const $a=this.Ara.waf(ma,0,Fa.characterData.length);S.xo.ccObjectIdMapping||(S.xo.ccObjectIdMapping={});const sb=S.xo.ccObjectIdMapping;
for(let Jb=0;Jb<$a.count;Jb++){const Sb=$a.J(Jb),oc=Sb.oe.toString();if(this.chm(Sb))if(Sb.Oc){const Ic=Fa.Bi().Ad.Eb(oc),gd=this.QBl(Sb),Gd=this.gwk(Ic,gd.OBi,gd.W6h,ma.Bi().Ad);sb[oc]=Gd.id;this.vvd.Jej(sb[oc],ma.id,C.a.nil)}else this.vvd.Jej(sb[oc],null,ma.id);sb[oc]?(Sb.oe=sb[oc],Sb.wt=null):this.tQf(ma,Sb.oe)}}catch($a){w.ULS.sendTraceTag(520414297,307,10,"onParagraphPaste operation failed: {0}",$a.toString())}}},"CC:onParagraphPaste")}}init(){bk.W4j(this.rNm);bk.hqd(this.SSc);bk.Jxc(this.USc)}Ejl(b){if(!b.Bb(25)||
!b.kd(25))return null;if(!b.Zp(25)){const h=this.$Bk.create(1074135144);b.Sf(h,25)}return b.Rb(25)}jEk(b,h,n){var x=b.ia(ic.a.D5,null);const E=md.GraphIterator.$a(h);h=h.Bi().Ad;n=x&&n[x.toString()]?h.Eb(x):this.Ejl(E);if(!n)return w.ULS.sendTraceTag(521172765,368,10,String.format("Cannot get parent node of the cloned content control node id:{0}",b.id.toString())),null;x=Fn.a(b,h,!0);md.GraphIterator.$a(n).d1(x,26,b.id);54!==n.type&&x.setValue(ic.a.D5,n.id);return x}tQf(b,h){this.rph.CQk(new Qa.a([b]),
h)}chm(b){var h=b.Ob.paragraph.Nc;if(!h)return w.ULS.sendTraceTag(520152150,368,10,String.format("Cannot get containing object space of the cloned content control node id:{0}",b.oe.toString())),!1;h=h.Eb(b.wt);if(!h)return w.ULS.sendTraceTag(520152149,368,10,String.format("Cannot get property set of the cloned content control node id:{0}",b.oe.toString())),!1;b=h.getValue(ic.a.gq);return 38===b||39==b}gil(b,h){var n,x=b.qa.J(b.qa.length-1);let E=b.characterData.length;x=(null===(n=null===x||void 0===
x?void 0:x.Mb)||void 0===n?void 0:n.length)||0;b.id.equals(h.Ob.paragraph.id)&&(E=h.Ob.cp,x=h.Ob.Mb.gI(h.oe,h.Oc));return this.Ara.wLh(b,0,E,0,x)}QBl(b){let h=null,n=b.Ob.paragraph;const x={};for(;n;){const E=this.gil(n,b);for(let S=E.count-1;0<=S;S--){const ma=E.J(S);if(!ma.zq)continue;const Fa=ma.oe.toString();if(ma.Oc){if(!x[Fa])return{OBi:ma.contentControlNode,W6h:h}}else x[Fa]=!0,h||(h=ma.contentControlNode)}n=Cd.ParagraphReader.Vg(n,!0,!0)}return{OBi:null,W6h:h}}gwk(b,h,n,x){let E;h?E=this.vvd.Asa(h):
(E=this.vvd.Bsa(),h=E.currentNode);b=Fn.a(b,x,!0);b.lh(ic.a.By,Ub.a.JF());54!==h.type&&b.setValue(ic.a.D5,h.id);E.SG(b,n,26);return b}}Object(r.a)(kB,"ContentControlCCP",null,[]);var xv=d(189),lB=d(706);class gl{constructor(b,h,n,x){this.Vd=b;this.Bf=h;this.fb=n;this.rg=x}get MW(){return!!this.Bf.instance&&this.Bf.instance.MW}get mCb(){return!!this.Bf.instance&&this.Bf.instance.mCb}Pqa(b,h,n,x,E,S=xv.a.Dxb,ma=xv.a.j_b,Fa=null,$a=xv.a.d1e,sb=-1){(b=this.XFd(b,n))?(b.Mb||(b.Mb=new Ut.a(b)),this.u0j(h,
b.Mb,x,E,S,ma,Fa,$a,sb)):w.ULS.sendTraceTag(17585366,368,15,"Unable to get a ChP at expected cp, which should not happen")}Iwh(b,h,n){if(b){new Qa.a;for(let E=0;E<b.count;E++){var x=this.gbf(b.J(E),h,!1);for(let S of x)this.Tmn(S,n)}}}BQk(b,h){this.Iwh(b,h,!0)}CQk(b,h){this.Iwh(b,h,!1)}replaceTextRange(b,h){this.Vd.replaceTextRange(b,h)}XFd(b,h){var n=Dd.a.Uc(b,h);this.Vd.dKb(n);for(n=0;n<b.qa.length;n++){const x=b.qa.J(n);if(x.cp>h)break;if(x.cp===h)return x}return null}u0j(b,h,n,x,E=xv.a.Dxb,S=
xv.a.j_b,ma=null,Fa=xv.a.d1e,$a=-1){const sb=h.Ob.paragraph;b=new lB.a(h.Ob,!0,!0,!0,null,b,x,n,E,S,ma,Fa,null,this.rg);if(!this.MW||-1>=$a||$a>h.length)$a=h.length;h.insert(b,$a);sb.qn();Of.a.instance.J(6)&&(b.Fe?sb.wordRunProperties.xZ(b.Fe-1,512):sb.wordRunProperties.bta(b.Fe,512),sb.wordRunProperties.Fq.Z(b.Fe,ws.CharacterPropertiesEditor.wQ),sb.wordRunProperties.Zs.Z(b.Fe,ws.CharacterPropertiesEditor.QT))}gbf(b,h,n){const x=new Qa.a;for(let E=0;E<b.qa.length;E++){const S=b.qa.J(E);if(S.Mb)for(let ma=
0;ma<S.Mb.length;ma++)if(S.Mb.J(ma).oe.equals(h)&&(x.add(S.Mb.J(ma)),n))return x}return x}x2c(b,h,n){if(this.mCb&&b){var x=b.node,E=b.gl,S=b.ot,ma=this.YMh(x,E,h,!0);h=this.YMh(x,S,h,!1);n?-1!==ma&&ma++:-1!==h&&h++;E||-1===ma||(ma=Math.max(ma,this.fb.Wu(x)));S===this.fb.textLength(x)&&-1!==h&&(h=Math.min(h,this.fb.xu(x)));b.Fb=ma;b.Ub=h}}YMh(b,h,n,x){return(b=(b=b.qa.ji(h))?b.Mb:null)&&b.length?b.gI(n,x):-1}Tmn(b,h){b&&b.Ob.Mb&&(h?b.Ob.Mb.remove(b):b.Ob.Mb.lna(b),h=b.Ob.paragraph,0<=b.Fe&&b.Fe<h.wordRunProperties.length&&
(b.Ob.cp||1!==h.wordRunProperties.length||(h.wordRunProperties.xZ(0,512),h.wordRunProperties.Fq.Z(1,ws.CharacterPropertiesEditor.wQ),h.wordRunProperties.Zs.Z(1,ws.CharacterPropertiesEditor.QT)),h.wordRunProperties.removeAt(b.Fe,512)),h.qn())}rmn(b){const h=b.qa;if(h){var n=new Qa.a;for(let x=0;x<h.length;x++){const E=h.J(x);if(E&&E.Mb){for(let S=0;S<E.Mb.length;S++)n.add(E.Mb.J(S).Fe);E.Mb=null}}b.cga(!0,n)}}}Object(r.a)(gl,"ContentControlChpManager",null,[498]);class dt{constructor(b,h,n,x,E){this.fb=
b;this.Co=h;this.Fh=n;this.wc=x;this.rg=E}iaf(b){if(!b||!Kd.SelectionEditor.xf(b))return null;if(!b.cpBegin){const h=this.dLh(b.node,b.Fb,!0);if(h)return h}return b.cpBegin===this.fb.textLength(b.node)?this.dLh(b.node,b.Fb-1,!1):null}nhl(b,h){b=this.xsh(b,h);return this.iaf(b)}dLh(b,h,n){return b.qa&&b.qa.length?(b=n?b.qa.first.Mb:b.qa.last.Mb)&&0<=h&&h<b.length&&b.J(h).Vf&&b.J(h).Oc===n&&this.jof(b.J(h))?b.J(h):null:null}tdf(b){if(!b||!Kd.SelectionEditor.Zt(b))return null;var h=this.Co.NDd(b,b);
b=0<h.count?h.J(h.count-1):null;return b&&!b.Vf&&this.jof(b)?(h=1<h.count?h.J(h.count-2):null)&&!h.Vf&&this.jof(h)?null:b:null}jof(b){if(!b)return!1;var h=this.wUh(b);if(!h)return!1;if(b.Oc)var n=b;else n=h,h=b;var x=this.fb.textLength(b.Ob.paragraph);if(n.Ob.cp||h.Ob.cp!==x||!n.zq||n.Dta||!h.zq||h.Dta)return!1;n=n.Ob.Mb;h=h.Ob.Mb;for(x=0;x<n.length&&!n.J(x).oe.equals(b.oe);x++)if(!n.J(x).Oc)return!1;for(n=h.length-1;0<=n&&!h.J(n).oe.equals(b.oe);n--)if(h.J(n).Oc)return!1;return!0}h2c(b){b=this.iaf(b);
this.Evd(b,!1)}Kcj(b,h){b=this.xsh(b,h);this.h2c(b)}GEa(b){b=this.tdf(b);return this.Evd(b,!0)?b:null}c8l(b,h){b=this.iaf(b);return!!b&&b.oe.equals(h)}m5b(b,h,n){b=this.nhl(b,h);return!!b&&b.oe.equals(n)}Tpf(b,h){b=this.tdf(b);return!!b&&b.oe.equals(h)}Evd(b,h){if(!b)return!1;const n=this.wUh(b);return this.Uph(b,h)&&(!n||this.Uph(n,h))}Uph(b,h){if(!b||b.Vf===h)return!1;var n=this.Co.Eae(b.Ob.paragraph,b.Oc);const x=b.Ob.Mb;-1!==n||b.Oc||(n=x.length);const E=h===b.Oc?1:-1;n+=h?E:0;b=x.gI(b.oe,b.Oc)+
E;if(n===b||0<E!==b>n)return w.ULS.shipAssertTag(24933847,368,n!==b,"Stopping content control inline block conversion since we can't find a correct range to convert. begin: {0}, end: {1}, step: {2}",n,b,E),w.ULS.shipAssertTag(24933848,368,0<E===b>n,"Stopping content control inline block conversion or we'll trap in infinite loop. begin: {0}, end: {1}, step: {2}",n,b,E),!1;for(var S=n;S!==b;S+=E){var ma=x.J(S);x.lna(ma);ma.Vf=h;x.Y4l(ma,S);this.fho(x.J(S))}if(this.D$)for(x.Ob.paragraph.qn(),S=n;S!==
b;S+=E)ma=x.J(S),ma.paragraph.wordRunProperties.Fq.Z(ma.Fe,ws.CharacterPropertiesEditor.wQ),ma.paragraph.wordRunProperties.Zs.Z(ma.Fe,ws.CharacterPropertiesEditor.QT);h?this.Hjo(x,n,b,E):this.Ijo(x,n,b,E);w.ULS.sendTraceTag(24933849,368,50,"Converted {0} content control(s) to {1}",Math.abs(b-n),h?"block":"inline");return!0}rGd(b){var h,n;return b.Oc&&this.rg.hr.get(null===(h=b.contentControlNode.id)||void 0===h?void 0:h.toString()).equals(b.Ob.paragraph.id)?38:!b.Oc&&this.rg.xs.get(null===(n=b.contentControlNode.id)||
void 0===n?void 0:n.toString()).equals(b.Ob.paragraph.id)?39:b.Vf&&b.Oc?40:b.Vf&&!b.Oc?41:!b.Vf&&b.Oc?38:39}fho(b){const h=b.Ob.paragraph.Nc;if(h){var n=h.Eb(b.wt),x=b.contentControlNode;if(vs.a.OBa||n&&x){if(n){n=n.clone();n.setValue(ic.a.usf,b.Vf);const E=this.rGd(b);n.setValue(ic.a.gq,E);h.Gu(n,null);b.wt=n.id}x&&x.setValue(ic.a.o6,b.Vf)}}}wUh(b){if(b.Ob.cp&&b.Ob.cp!==this.fb.textLength(b.Ob.paragraph)||!b.Ob.paragraph.qa||!b.Ob.paragraph.qa.length)return null;const h=b.Oc?b.Ob.paragraph.qa.last:
b.Ob.paragraph.qa.first;if(!h.Mb)return null;b=h.Mb.gI(b.oe,!b.Oc);return-1===b?null:h.Mb.J(b)}Ijo(b,h,n,x){var E,S,ma,Fa,$a=b.J(h).contentControlNode;if($a){var sb=b.J(h).Oc?this.rg.hr:this.rg.xs;$a=null!==(S=sb.get(null===(E=$a.id)||void 0===E?void 0:E.toString()))&&void 0!==S?S:C.a.nil;if(!$a.equals(C.a.nil))if(b.Ob&&b.Ob.paragraph&&b.Ob.paragraph.id.equals($a)){for(h+=x;h!==n;h+=x){E=b.J(h).contentControlNode;if(!E)return;sb.set(null===(ma=E.id)||void 0===ma?void 0:ma.toString(),$a)}0<=n&&n<b.length&&
b.J(n).Vf&&this.a7b(b.J(n))&&(b=b.J(n).contentControlNode)&&sb.set(null===(Fa=b.id)||void 0===Fa?void 0:Fa.toString(),$a)}else w.ULS.shipAssertTag(24933851,368,!1,"Start/End object of innermost content control is not the paragraph which holds the content control.")}}Hjo(b,h,n,x){var E;if(!vs.a.w5b){var S=null,ma=h-x;0<=ma&&ma<b.length&&b.J(ma).Vf&&this.a7b(b.J(ma))&&(S=b.J(ma).contentControlNode);for(ma=b.J(h).Oc;h!==n;h+=x){const Fa=b.J(h).contentControlNode;if(!Fa)break;S&&(ma?this.rg.hr:this.rg.xs).set(null===
(E=S.id)||void 0===E?void 0:E.toString(),Fa.id);S=Fa}}}a7b(b){return b.zq&&!b.Dta}xsh(b,h){if(!b||!this.Fh)return null;const n=h?Dd.a.Uc(b,0):Dd.a.iw(b);b=this.Fh.wq(b,h);n.Ub=n.Fb=b;return n}get D$(){return this.wc.isFeatureEnabled(30)}}Object(r.a)(dt,"ContentControlConverter",null,[497]);var Yw;(function(b){b[b.Wto=0]="BoundingBox";b[b.wwo=1]="Tags";b[b.Muo=2]="Hidden";b[b.wvo=3]="NumberOfContentControlAppearance"})(Yw||(Yw={}));Object(r.b)("ContentControlAppearance",Yw);var Jy;(function(b){b[b.Unknown=
-1]="Unknown";b[b.ewo=0]="RichText";b[b.Hvo=1]="PlainText";b[b.Fvo=2]="Picture";b[b.euo=3]="ComboBox";b[b.wuo=4]="DropDownList";b[b.Xto=5]="BuildingBlockGallery";b[b.Date=6]="Date";b[b.bwo=7]="RepeatSectionItem";b[b.buo=8]="CheckBox";b[b.awo=9]="RepeatSection";b[b.Bibliography=10]="Bibliography";b[b.vwo=11]="TableOfContents";b[b.xvo=12]="NumberOfContentControlKinds"})(Jy||(Jy={}));Object(r.b)("ContentControlKind",Jy);class nz{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb){this.h6a=this.qvc=this.G9c=this.Ald=
this.Vfd=null;this.rha=this.El=this.Hsc=this._id=0;this.cPb=this.TSb=this.tmd=this._title=this.uwa=null;this.$cd=this.Zcd=this.dLg=this.Wid=this.Yoc=this.Toc=this.$8c=!1;this.uMg=null;this.Vf=!1;this.Nje=null;this.zi=n;this.px=h;this.Zg=x;this.hs=E;this.Qm=S;this.j0=ma;this.opa=Fa;this.Qca=$a;this.gub=sb;this.rg=Jb;b?(this.Vfd=b.id,this.Nje=b,this.NS(!1)):this._id=Ub.a.JF()}get Qi(){return this.zi.value}get id(){this.NS();return this._id}set id(b){this._id=b;this.Qd()&&(this.contentControlNode.setValue(ic.a.By,
this._id),this.N_())}get parentId(){this.NS();return this.Hsc}set parentId(b){this.Hsc=b}get title(){this.NS();return this._title}set title(b){this._title=b;this.Qd()&&(this.contentControlNode.setValue(ic.a.Dab,this._title),this.N_(),this.z2c(h=>{h.title=this._title?this._title:xv.a.Dxb}))}get tag(){this.NS();return this.tmd}set tag(b){this.tmd=b;this.Qd()&&(this.contentControlNode.setValue(ic.a.nBc,this.tmd),this.N_())}get type(){this.NS();return this.El}set type(b){this.El=b;this.Qd()&&(this.contentControlNode.setValue(ic.a.Dwb,
Jy[this.El]),this.N_())}get appearance(){this.NS();return this.rha}set appearance(b){if(b&&1!==b&&2!==b)throw Error.argumentUndefined("The appearance value is undefined enum.");this.rha=b;this.Qd()&&(this.contentControlNode.setValue(ic.a.Eab,Yw[this.rha].toLowerCase()),this.N_(),this.z2c(h=>{h.appearance=Yw[this.rha].toLowerCase()}))}get color(){this.NS();return this.uwa}set color(b){if(b&&16777215>=b)this.uwa=b,this.Qd()&&(this.contentControlNode.setValue(ic.a.jBc,this.uwa),this.N_(),this.z2c(h=>
{h.color=this.uwa}));else throw Error.argumentOutOfRange("The color value is out of range.");}get uZd(){this.NS();return this.TSb}set uZd(b){this.TSb=b}get Nyd(){this.NS();return this.cPb}set Nyd(b){this.cPb=b;this.Qd()&&(this.contentControlNode.setValue(ic.a.lBc,this.cPb),this.N_())}get D3e(){this.NS();return this.$8c}set D3e(b){b&&(this.$8c=b,this.Qd()&&(this.contentControlNode.setValue(ic.a.tvd,this.$8c),this.N_()))}get removeWhenEdited(){this.NS();return this.Wid}set removeWhenEdited(b){if(b&&
!this.Pea)throw Error.invalidOperation("Cannot set RemoveWhenEdited to true property if the content control is undeletable.");this.Wid=b;this.Qd()&&(this.contentControlNode.setValue(ic.a.tph,this.Wid),this.N_())}get Pea(){this.NS();return this.Toc}set Pea(b){if(!b&&this.removeWhenEdited)throw Error.invalidOperation("Cannot set IsDeletable property to false if the content control RemoveWhenEdited property is true.");this.Toc=b;this.Qd()&&(this.contentControlNode.setValue(ic.a.hZb,this.Toc),this.z2c(h=>
{h.BS=this.Toc}),this.N_())}get isEditable(){this.NS();return this.Yoc}set isEditable(b){this.Yoc=b;this.Qd()&&(this.contentControlNode.setValue(ic.a.Cwb,this.Yoc),this.z2c(h=>{h.editable=this.Yoc}),this.N_())}get isSupported(){this.NS();return this.dLg}get ghm(){return this.isSupported&&11!==this.type&&10!==this.type}get lkm(){this.NS();return this.cPb&&"table of contents"===this.cPb.toLowerCase()?!0:!1}get qOd(){this.NS();return this.Zcd}set qOd(b){this.Zcd=b;this.Qd()&&(this.contentControlNode.setValue(ic.a.wph,
this.Zcd),this.N_())}get t6b(){this.NS();return this.$cd}set t6b(b){this.$cd=b;this.Qd()&&(this.contentControlNode.setValue(ic.a.xph,this.$cd),this.N_())}get ZN(){return this.contentControlNode.ia(ic.a.E5,!1)}set ZN(b){this.Qd()&&this.contentControlNode.setValue(ic.a.E5,b)}get ju(){this.NS();return this.Ald}set ju(b){this.Ald=b}get Fz(){this.NS();return this.G9c}set Fz(b){this.G9c=b}get objectId(){return this.Vfd}set objectId(b){this.Vfd=b;this.Nje=this.Qi.Eb(this.Vfd)}get start(){this.Ygj();return this.qvc}set start(b){this.qvc=
b}get end(){this.Ygj();return this.h6a}set end(b){this.h6a=b}get contentControlNode(){return this.Nje}z0m(b){for(let h=0;3>h;++h)if(Yw[h].toLowerCase()===b)return h;return 0}A0m(b){for(let h=0;12>h;++h)if(Jy[h]===b)return h;return-1}N_(){const b=this.start.node;b&&b.setValue(ie.a.HT,new Date)}O2c(){var b,h,n,x;this._id=this.contentControlNode.ia(ic.a.By,0);this.rha=this.z0m(this.contentControlNode.ia(ic.a.Eab,null));this.uwa=this.contentControlNode.ia(ic.a.jBc,null);this._title=this.contentControlNode.ia(ic.a.Dab,
null);this.tmd=this.contentControlNode.ia(ic.a.nBc,null);this.Vf=this.contentControlNode.ia(ic.a.o6,!1);this.Toc=this.contentControlNode.ia(ic.a.hZb,!1);this.Yoc=this.contentControlNode.ia(ic.a.Cwb,!1);this.dLg=this.contentControlNode.ia(ic.a.xda,!1);this.cPb=this.contentControlNode.ia(ic.a.lBc,null);this.$8c=this.contentControlNode.ia(ic.a.tvd,!1);this.Ald=null!==(h=this.rg.hr.get(null===(b=this.contentControlNode.id)||void 0===b?void 0:b.toString()))&&void 0!==h?h:C.a.nil;this.G9c=null!==(x=this.rg.xs.get(null===
(n=this.contentControlNode.id)||void 0===n?void 0:n.toString()))&&void 0!==x?x:C.a.nil;this.$cd=this.contentControlNode.ia(ic.a.xph,!1);this.Zcd=this.contentControlNode.ia(ic.a.wph,!1);this.Wid=this.contentControlNode.ia(ic.a.tph,!1);this.El=this.A0m(this.contentControlNode.ia(ic.a.Dwb,"RichText"));b=null;try{const E=this.contentControlNode.ia(ic.a.D5,C.a.nil);if(C.a.Dp(E,C.a.nil))this.Hsc=0;else if(b=this.Qi.Eb(E))this.Hsc=b.ia(ic.a.By,0)}catch(E){this.Hsc=0}this.Fio()}Fio(){if(this.gub){var b=this.contentControlNode.ia(ic.a.TXe,
"");if((b=this.opa.t_h(b))&&0<b.length){this.TSb=this.nKh(b.Qa,b.Tc);return}}this.TSb=(b=this.Zg.Bsa())&&b.currentNode?b.currentNode.ia(ic.a.kBc,null):null}NS(b=!0){if(!b||this.Qd())b=this.contentControlNode.ia(ie.a.lastModifiedTime,new Date(0)),this.uMg!==b?(w.ULS.sendTraceTag(520734535,368,50,"Last Modified Time was used to update Properties"),this.O2c(),this.uMg=b):w.ULS.sendTraceTag(520734534,368,50,"Last Modified was NOT used but updateProperties would run if Last Modified was removed.")}Gjo(b,
h){var n,x;this.Ald=b;this.G9c=h;this.rg.hr.set(null===(n=this.contentControlNode.id)||void 0===n?void 0:n.toString(),b);this.rg.xs.set(null===(x=this.contentControlNode.id)||void 0===x?void 0:x.toString(),h)}Ygj(){if(this.contentControlNode){var b=this.ju,h=this.Fz;if(!b||!h||b.equals(C.a.nil)||h.equals(C.a.nil))w.ULS.sendTraceTag(17330978,368,10,"StartObjectId/EndObjectId are not initialized before trying to update Start/End contexts.");else if(b=this.Zg.Ika(b,!0),h=this.Zg.Ika(h,!1),b&&h)if(b.isConnected&&
h.isConnected||w.ULS.sendTraceTag(37777626,368,10,"StartParaNode/EndParaNode are not connected."),this.Vf)b=Dd.a.create(b),this.hs.x2c(b,this.objectId,!0),this.start=b,b=Dd.a.create(h),this.hs.x2c(b,this.objectId,!0),this.end=b;else{let n=h=-1;if(b.qa){for(let x=0;x<b.qa.length&&(-1===h||-1===n);x++){const E=b.qa.J(x);if(E.Mb)for(let S=0;S<E.Mb.length&&(-1===h||-1===n);S++){const ma=E.Mb.J(S);C.a.Dp(ma.oe,this.objectId)&&(ma.Oc?h=E.cp:n=E.cp)}}0<=h&&0<=n&&(b=Dd.a.jL(h,n,!1,b),this.hs.x2c(b,this.objectId,
!0),this.start=this.end=b)}}}}getText(){let b="";var h=this.start;const n=this.end;if(!h||!n)return b;this.Vf?b=this.nKh(h,n):(h=Cd.ParagraphReader.text(h.node).substring(h.cpBegin,n.cpEnd),b+=Tc.AParagraphNode.dU(h));return b}Qd(){return!!this.contentControlNode&&this.contentControlNode.isConnected}setText(b){return this.Qca?this.Qm.NZi(this,b)?0:2:2}clear(){return this.Qca?this.Qm.NZi(this,"")?0:2:2}gMh(){const b=new Qa.a;var h=this.contentControlNode.ia(ic.a.contentControlNode,[]);for(let n of h)if(!C.a.Dp(n,
C.a.nil)){h=this.zi.value.Eb(n);try{b.add(this.j0.Qwb(h,this.px,this.zi,this.Zg,this.hs,this.Qm,this.opa,this.Qca,this.gub))}catch(x){}}return b}E$e(){const b=new Qa.a;this.gKh(this,b);return b}gKh(b,h){b=b.gMh();if(b.count)for(let n of b)h.add(n),this.gKh(n,h)}cE(b=!1){const h=new Qa.a;if(this.Vf){var n=this.Qm.bT(this.start,this.end);for(var x of n)n=Dd.a.create(x),this.hs.x2c(n,this.objectId,b),h.add(n)}else x=this.start.clone(),this.hs.x2c(x,this.objectId,b),h.add(x);return h}z2c(b){const h=this.Qm.bT(this.start,
this.end);for(let n=0;n<h.count;n++){const x=this.hs.gbf(h.J(n),this.objectId,!1);if(x){for(let E=0;E<x.count;E++)b(x.J(E));h.J(n).gk()}}}nKh(b,h){const n=new Sys.StringBuilder;h=this.Qm.bT(b,h);for(let x of h)x.id.equals(b.node.id)||n.append("\r"),n.append(Cd.ParagraphReader.plainText(x));return n.toString()}}Object(r.a)(nz,"ContentControl",null,[536]);class e{constructor(b){this.rg=b}Qwb(b,h,n,x,E,S,ma,Fa,$a){return new nz(b,h,n,x,E,S,this,ma,Fa,$a,this.rg)}}Object(r.a)(e,"ContentControlFactory",
null,[496]);var c=d(904);class k{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb){this.px=b;this.zi=h;this.Xc=n;this.DSb=x;this.ayj=E;this.uJ=S;this.Kh=ma;this.fb=Fa;this.bhd=$a;this.$$c=sb;this.rg=Jb}get hr(){return this.rg.hr}get xs(){return this.rg.xs}get Py(){return this.px.value}Bsa(){const b=this.Xc.Ck();b.set(this.Py);this.DSb.tQ(b);if(b.Rb(25))return b;this.$$c.instance&&this.$$c.instance.Gla&&w.ULS.sendTraceTag(17040640,368,10,"Content Control root node doesn't exist");w.ULS.sendTraceTag(528537619,
368,15,"getContentControlRootIterator() returning null");return null}AHc(b,h,n=!1){this.t0b();const x=new Qa.a;let E;if(b){E=b.Rb(26);if(!E)return x;for(;E&&(!h(E)||(x.add(E),!n));){x.addRange(this.AHc(b,h));if(n&&0<x.count)break;E=b.wf(26)}b.nc()}return x}uAl(){const b=this.Xc.Ck();b.set(this.px.value);this.DSb.tQ(b);return b.currentNode}lMa(b,h,n){let x;x=b.equals(h);x||(x=(b=this.Ika(b,n))?b.id.equals(h):!1);return x}IKa(b,h){var n,x,E,S;b=this.yu(b);if(!b)return null;let ma=null;for(;55===b.type;){let Fa;
Fa=h?null!==(x=this.rg.hr.get(null===(n=b.id)||void 0===n?void 0:n.toString()))&&void 0!==x?x:C.a.nil:null!==(S=this.rg.xs.get(null===(E=b.id)||void 0===E?void 0:E.toString()))&&void 0!==S?S:C.a.nil;if(Fa.equals(ma)){b=null;break}else b=this.yu(Fa);ma=Fa}return b}Ika(b,h){return(b=this.IKa(b,h))?Cd.ParagraphReader.oc(b)?b:h?this.fb.Ym(b):this.fb.TJ(b):null}Gwh(b,h=!1){this.reo(b);this.Hwh(b,h)}reo(b){var h,n,x,E,S,ma,Fa,$a,sb=this.Asa(b);sb=this.Asa(sb.parentNode);sb=55===sb.currentNode.type?sb.currentNode.id:
null;let Jb;Jb=this.yu(null!==(n=this.rg.hr.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==n?n:C.a.nil);for(h=this.yu(null!==(E=this.rg.xs.get(null===(x=b.id)||void 0===x?void 0:x.toString()))&&void 0!==E?E:C.a.nil);Jb&&55===Jb.type;)Jb=this.yu(null!==(ma=this.rg.hr.get(null===(S=Jb.id)||void 0===S?void 0:S.toString()))&&void 0!==ma?ma:C.a.nil);for(;h&&55===h.type;)h=this.yu(null!==($a=this.rg.xs.get(null===(Fa=h.id)||void 0===Fa?void 0:Fa.toString()))&&void 0!==$a?$a:C.a.nil);Jb&&
h&&this.Iej(Jb.id,h.id,sb,Sb=>{Sb=Sb.ia(ic.a.bW,C.a.nil);return!Sb||Sb.equals(C.a.nil)||b.id.equals(Sb)})}Hwh(b,h=!1){var n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic;w.ULS.sendTraceTag(528537620,368,50,"Attempting to delete content control node");const gd=this.Asa(b),Gd=this.Asa(gd.parentNode);let vd=C.a.nil,ce=C.a.nil;var od=Gd.currentNode.ia(ic.a.contentControlNode,[]);const Yd=new Qa.a;for(let Df=0;Df<od.length;Df++)Yd.add(od[Df]);if(h){if(54!==Gd.currentNode.type){vd=this.rg.hr.get(null===(n=Gd.currentNode.id)||
void 0===n?void 0:n.toString());ce=this.rg.xs.get(null===(x=Gd.currentNode.id)||void 0===x?void 0:x.toString());od=this.yu(vd);for(n=this.yu(ce);od&&55===od.type;)vd=this.rg.hr.get(null===(E=od.id)||void 0===E?void 0:E.toString()),od=this.yu(vd);for(;n&&55===n.type;)ce=this.rg.xs.get(null===(S=n.id)||void 0===S?void 0:S.toString()),n=this.yu(ce)}E=this.Asa(b);if(E.Rb(26)){S=new Qa.a;for(S.add(E.currentNode);E.wf(26);)S.add(E.currentNode);for(var ne of S)this.Hwh(ne,h)}}else if(vd=this.rg.hr.get(null===
(ma=b.id)||void 0===ma?void 0:ma.toString()),ce=this.rg.xs.get(null===(Fa=b.id)||void 0===Fa?void 0:Fa.toString()),h=this.Ctl(Yd,b.id),ne=this.Asa(b),ne.Rb(26))for(E=this.Asa(ne.currentNode),S=E.currentNode,od=b;S;)n=ne.currentNode,Yd.insert(h++,n.id),S=E.wf(26),x=this.Asa(n),54!==Gd.currentNode.type?n.setValue(ic.a.D5,Gd.currentNode.id):n.removeProperty(ic.a.D5),Fn.g(x,Gd,od,26),od=x.currentNode,S&&(ne.set(S),ne.I_(this.Bsa().currentNode));54!==Gd.currentNode.type&&(h=null!==(sb=this.rg.hr.get(null===
($a=Gd.currentNode.id)||void 0===$a?void 0:$a.toString()))&&void 0!==sb?sb:C.a.nil,$a=null!==(Sb=this.rg.xs.get(null===(Jb=Gd.currentNode.id)||void 0===Jb?void 0:Jb.toString()))&&void 0!==Sb?Sb:C.a.nil,h.equals(b.id)&&this.rg.hr.set(null===(oc=Gd.currentNode.id)||void 0===oc?void 0:oc.toString(),vd),$a.equals(b.id)&&this.rg.xs.set(null===(Ic=Gd.currentNode.id)||void 0===Ic?void 0:Ic.toString(),ce));gd.Fg();w.ULS.sendTraceTag(528537621,368,50,"Disconnected nodeToDelete");this.remove(Yd,b.id);od=Array(Yd.count);
for(Jb=0;Jb<Yd.count;Jb++)od[Jb]=Yd.J(Jb);Gd.currentNode.setValue(ic.a.contentControlNode,od);c.a.pCa(b.id)}t0j(b,h,n,x,E,S,ma=null){var Fa,$a,sb,Jb,Sb,oc,Ic,gd;let Gd,vd;h?(Gd=this.yu(h.objectId),vd=this.Asa(Gd)):(vd=this.Bsa(),Gd=vd.currentNode);const ce=this.ayj.create(1074135145);ma&&ce.properties.ys(ma.properties);54!==Gd.type&&ce.setValue(ic.a.D5,Gd.id);ma?vd.KBb(ce,n,26,ma.id):vd.SG(ce,n,26);this.rg.hr.set(null===(Fa=ce.id)||void 0===Fa?void 0:Fa.toString(),E);this.rg.xs.set(null===($a=ce.id)||
void 0===$a?void 0:$a.toString(),S);b.Vf&&(h&&(n=null!==(Jb=this.rg.hr.get(null===(sb=Gd.id)||void 0===sb?void 0:sb.toString()))&&void 0!==Jb?Jb:C.a.nil,sb=null!==(oc=this.rg.xs.get(null===(Sb=Gd.id)||void 0===Sb?void 0:Sb.toString()))&&void 0!==oc?oc:C.a.nil,n.equals(E)&&this.rg.hr.set(null===(Ic=Gd.id)||void 0===Ic?void 0:Ic.toString(),ce.id),sb.equals(S)&&this.rg.xs.set(null===(gd=Gd.id)||void 0===gd?void 0:gd.toString(),ce.id)),this.Iej(E,S,ce.id,od=>{od=od.ia(ic.a.bW,C.a.nil);const Yd=h?h.objectId:
null;return!od||od.equals(C.a.nil)||od.equals(Yd)}));E=this.Asa(ce);S=Array(x.count);for(Sb=x.count-1;0<=Sb;Sb--)S[Sb]=x.J(Sb).objectId,oc=this.yu(x.J(Sb).objectId),oc=this.Asa(oc),oc.currentNode.setValue(ic.a.D5,ce.id),Fn.g(oc,E,null,26);0<S.length&&ce.setValue(ic.a.contentControlNode,S);k.Pb.isFeatureEnabled(39)&&(b.Nyd&&ce.setValue(ic.a.lBc,b.Nyd),b.D3e&&ce.setValue(ic.a.tvd,!0));return ce}JGn(b,h,n,x){b.setValue(ic.a.o6,h);b.setValue(ic.a.hZb,!0);b.setValue(ic.a.Cwb,!0);b.setValue(ic.a.By,n);
b.setValue(ic.a.Eab,Yw[0]);b.setValue(ic.a.xda,!0);b.setValue(ic.a.Dwb,"RichText");x&&b.setValue(ic.a.slb,x);b.setValue(ic.a.iZb,0)}Jej(b,h=null,n=null){h&&this.rg.hr.set(b.toString(),h);n&&this.rg.xs.set(b.toString(),n)}Uwh(b){if(!b||!b.count||!b.J(0))return null;const h=this.xff(b);for(let n=0;n<b.count;n++)this.Kh.t1a(b.J(n));return h}xff(b){if(!b||!b.J(0))return null;const h=this.Xc.Ck();h.set(b.J(0));h.vd();h.nc();return h.QG()?h.currentNode:null}DBl(b){const h=this.Xc.Ck();h.set(b);h.vd();h.nc();
h.nc();return h}l7g(b,h,n){const x=new Qa.a;for(let E=0;E<n;E++){h=this.uJ.Seb(b,h,!0,null);if(!h||!b.Wd())return null;const S=b.currentNode;b.nc();b.nc();x.add(S)}return x}r3b(b){const h=this.Xc.Ck();h.set(b);for(h.Bb(7);h.nc();)switch(h.currentNode.type){case 8:case 16:case 36:case 40:return h.currentNode.id}return null}hUh(b){const h=this.Xc.Ck();h.set(b);h.vd();return(b=h.IOa())?b.id:null}ydf(b){const h=this.Xc.Ck();h.set(b);return h.Bb(7)?h:null}yu(b){return this.zi.value.Eb(b)}t0b(){if(!k.BIg){var b=
this.Bsa();b&&this.$4f(b);k.BIg=!0}}sPa(b){return this.bhd.sPa(b)}w8j(b,h){const n=this.Xc.Ck();n.set(b.node);const x=this.Xc.Ck();x.set(h.node);n.vd();x.vd();const E=this.Xc.Ck();E.set(n.currentNode);const S=this.Xc.Ck();S.set(x.currentNode);const ma=$d.returnToLowestCommonTableCell(n,x);return ma?(E.vd(),S.vd(),{returnValue:({Ox:b}=this.Atd(E,!0,ma,b)).returnValue&&({Ox:h}=this.Atd(S,!1,ma,h)).returnValue,X5i:b,YBh:h}):{returnValue:({Ox:b}=this.Atd(n,!0,null,b)).returnValue&&({Ox:h}=this.Atd(x,
!1,null,h)).returnValue,X5i:b,YBh:h}}Atd(b,h,n,x){let E=null,S=b.kd(16);for(;S!==n;){if(h&&Fg.TableCellReader.$am(b)||!h&&Fg.TableCellReader.xci(b))E=b.kd(14);else return{returnValue:!1,Ox:x};S=b.kd(16)}E&&(x=Dd.a.create(E));return{returnValue:!0,Ox:x}}$4f(b){if(b.Rb(26)){for(this.$4f(b);b.wf(26);)this.$4f(b);b.nc()}}remove(b,h){for(let n=0;n<b.count;n++)if(b.J(n).toString()===h.toString()){b.removeAt(n);break}}Asa(b){const h=this.Xc.Ck();h.set(b);h.I_(this.Bsa().currentNode);return h}Ctl(b,h){for(let n=
0;n<b.count;n++)if(b.J(n).equals(h))return n;return-1}Iej(b,h,n,x){b=this.Jkl(b,h);for(h=0;h<b.count;h++)x(b.J(h))&&(n?b.J(h).setValue(ic.a.bW,n):b.J(h).removeProperty(ic.a.bW),this.$$c.instance&&this.$$c.instance.A$h&&b.J(h).Sj(16,!0))}Jkl(b,h){const n=new Qa.a;var x=this.yu(b);const E=this.yu(h);if(!x||!E)return n;const S=({NPc:ma}=this.aDd(x,E)).returnValue;x=ma[S];if(14===x.type)n.add(x);else if(15===x.type&&1<=S){const Fa=ma[S-1];1===ag.TableReader.ag(Fa)&&n.add(Fa)}var ma=md.GraphIterator.$a(S>=
ma.length-1?x:ma[S+1]);ma.Bb(7);for(x=cn.a.Ir(ma,x);x.moveNext()&&x.currentNode!==E;)14===x.currentNode.type&&n.add(x.currentNode);if(!C.a.Dp(h,b)&&14===E.type)for(ma=md.GraphIterator.$a(E),x=cn.a.Ir(ma,E);x.moveNext();)14===x.currentNode.type&&n.add(x.currentNode);return n}aDd(b,h){b=this.Jcb(b);h=this.Jcb(h);let n=0;for(;n<b.length&&n<h.length&&b[n]===h[n];++n);return{returnValue:0<n?n-1:n,NPc:b,MTf:h}}Jcb(b){const h=[];h.push(b);b=md.GraphIterator.$a(b);for(b.Bb(7);b.nc();)h.push(b.currentNode);
h.reverse();return h}static get Pb(){return null!=k.Chg?k.Chg:k.Chg=Oa.a.instance.Pa("Box4.IFeatureHelper")}}k.BIg=!1;Object(r.a)(k,"ContentControlGraphManager",null,[495]);class t{constructor(b,h,n,x,E,S,ma,Fa,$a){this.yoa=null;this.pfm=(sb,Jb)=>{if(this.MW)return this.qfm(sb,Jb);if(!sb||!sb.count)return w.ULS.sendTraceTag(17356048,368,15,"The GNC list should not be null or empty"),!1;let Sb=!0;switch(Jb){case 0:Jb=this.KP(sb.J(0),sb.J(sb.count-1),1);if((sb=this.KP(sb.J(0),sb.J(sb.count-1),3))&&
0<sb.count){if(!sb.J(0).isSupported||!sb.J(0).isEditable){Sb=!1;break}for(sb=sb.J(0);sb;)this.OWc(Jb,sb.id),sb=this.getById(sb.parentId)}if(Jb)for(var oc of Jb)if(!oc.isSupported||!oc.isEditable){Sb=!1;break}break;case 1:if(sb.J(0).contextId!==cc.a.Wc){w.ULS.sendTraceTag(17356049,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.Inserting");Sb=!1;break}(Jb=this.KP(sb.J(0),sb.J(0),1))&&0<Jb.count&&(Sb=!1);break;case 2:if(sb.J(0).contextId!==cc.a.Wc){w.ULS.sendTraceTag(17424994,
368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary");Sb=!1;break}(Jb=this.KP(sb.J(0),sb.J(0),3))&&0<Jb.count&&(Sb=!1);break;case 3:case 4:Jb=this.jFd(sb.J(0),!0);oc=this.jFd(sb.J(sb.count-1),!1);if(!Jb||!oc){w.ULS.sendTraceTag(17356050,368,15,"The GNC list is not supported for ApiOperation.Clearing or ApiOperation.Replacing");Sb=!1;break}if((Jb=this.KP(Jb,Jb,3))&&0<Jb.count){Sb=!1;break}if((Jb=this.KP(oc,oc,3))&&0<Jb.count){Sb=!1;break}if(Jb=
this.Qm.KP(sb.J(0),sb.J(sb.count-1),1))for(let Ic of Jb)if(!Ic.Pea){Sb=!1;break}break;default:Sb=!1}return Sb};t.px=b;t.zi=h;this.Zg=n;this.hs=x;this.Qm=E;this.j0=S;this.opa=ma;this.Bf=Fa;this.Co=$a}get VLa(){return!!this.Bf.instance&&this.Bf.instance.VLa}get Gla(){return!!this.Bf.instance&&this.Bf.instance.Gla}get RMd(){return!!this.Bf.instance&&this.Bf.instance.RMd}get MW(){return!!this.Bf.instance&&this.Bf.instance.MW}get TMd(){return!!this.Bf.instance&&this.Bf.instance.TMd}mCb(){return!!this.Bf.instance&&
this.Bf.instance.mCb}fja(b,h,n=null,x=null,E=!1){if(!this.VLa)return{returnValue:2,id:0};b=this.Zg.Ika(b,!0);h=this.Zg.Ika(h,!1);if(!b||!h)return{returnValue:2,id:0};b=Dd.a.create(b);h=Dd.a.create(h);return this.X5g(b,h,n,x,E)}z_j(b,h,n=!1){return this.VLa&&b&&h?this.X5g(b,h,null,null,!1,n):{returnValue:2,id:0}}Bub(b,h=null,n=!1){let x=0;if(!this.VLa)return{returnValue:2,id:x};const E=this.j0.Qwb(h,t.px,t.zi,this.Zg,this.hs,this.Qm,this.opa,this.VLa,this.RMd);E.start=b;E.end=b;E.ju=b.node.id;E.Fz=
b.node.id;E.Vf=!1;return this.Qm.Y6g(E,h,n)?(x=E.id,{returnValue:0,id:x}):{returnValue:2,id:x}}s0j(b,h=null){if(!this.VLa||!this.Vbm(b))return{returnValue:2,id:0};var n=b.J(0).contextId===cc.a.endOfParagraph?b.J(1):b.J(0);const x=b.J(b.count-1);if(this.BXe(b,cc.a.paragraph)||this.BXe(b,cc.a.endOfParagraph)){b=n.node.id;let E=x.node.id;const S=b.equals(E);n=this.Qm.y5i(n,!0);void 0!==n&&null!==n&&(b=n,E=S?b:E);this.Qm.y5i(x,!1);h.setValue(ic.a.o6,!0);return this.fja(b,E,h)}return n!==x||n.contextId!==
cc.a.Fd&&n.contextId!==cc.a.Wc?{returnValue:2,id:0}:(h.setValue(ic.a.o6,!1),this.Bub(n,h))}getById(b){if(!this.Gla)return null;const h=this.Zg.AHc(this.Zg.Bsa(),n=>n.getValue(ic.a.By)===b,!0);return 0<h.count?this.Qm.cT(h.J(0)):null}getByTitle(b){if(!this.Gla)return null;const h=this.Zg.AHc(this.Zg.Bsa(),x=>x.ia(ic.a.Dab,null)===b,!1),n=new Qa.a;for(let x of h)n.add(this.Qm.cT(x));return n}getByTag(b){if(!this.Gla)return null;const h=this.Zg.AHc(this.Zg.Bsa(),x=>x.ia(ic.a.nBc,null)===b,!1),n=new Qa.a;
for(let x of h)n.add(this.Qm.cT(x));return n}KP(b,h,n,x=!1){return this.Gla?this.MW?this.Qm.xsa(b,h,n):this.Qm.KP(b,h,n,x):null}bT(b,h){return this.Qm.bT(b,h)}pfl(){if(!this.Gla)return null;const b=this.Zg.AHc(this.Zg.Bsa(),()=>!0,!1),h=new Qa.a;for(let n of b)h.add(this.Qm.cT(n));return h}JHb(b){if(!this.VLa)return w.ULS.sendTraceTag(528537618,368,15,"Cannot release content control, isContentControlWriteEnabled = false"),2;b=this.getById(b);return this.Qm.tDa(b)?0:2}rQk(b){if(!this.VLa)return 2;
b=this.getById(b);return this.Qm.deleteContentControl(b)?0:2}J0j(b){this.Qm.win(b)}vgk(b){this.yoa=b;this.yoa.rkn(this.pfm)}Zkl(b){if(!this.mCb())return null;let h;var n=b.cE();h=this.jFd(n.J(n.count-1),!1);n=this.hs.XFd(n.J(n.count-1).node,h.cpBegin).Mb;b=this.IJl(n,b);if(-1===b)return null;h.Fb=b;h.Ub=h.Fb;return h}qfm(b,h){if(!b||!b.count)return w.ULS.sendTraceTag(21031131,368,15,"The GNC list should not be null or empty"),!1;switch(h){case 0:return this.eam(b);case 3:case 4:case 6:return this.qhm(b,
6===h);case 1:case 2:case 5:return 1!==b.count||b.J(0).contextId!==cc.a.Wc?(w.ULS.sendTraceTag(21031132,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary"),!1):this.cci(b.J(0),5===h,!1);default:return!1}}eam(b){const h=this.Qm.xsa(b.J(0),b.J(b.count-1),3);if(h&&0<h.count){var n=h.J(0);if(!n.isSupported||!n.isEditable)return!1}b=this.Qm.xsa(b.J(0),b.J(b.count-1),1);for(n=0;h&&n<h.count;n++)this.OWc(b,h.J(n).id);if(b)for(let x of b)if(!x.isSupported||
!x.isEditable)return!1;return!0}qhm(b,h){var n=b.J(0),x=b.J(b.count-1),E=n.gl,S=x.ot;if(-1===E||-1===S)return!1;E=this.Co.X5(n.node,E,n.Fb);S=this.Co.X5(x.node,S,x.Ub);var ma=-1,Fa=Math.min(E.count,S.count);for(--Fa;0<=Fa;Fa--){const $a=E.J(Fa).oe,sb=S.J(Fa).oe;if($a.equals(sb)){ma=Fa;break}}if(-1<ma&&(Fa=this.Qm.cT(E.J(ma).contentControlNode),!Fa.isEditable||!Fa.isSupported||Fa.ZN&&!this.L$l(Fa,b)))return!1;n=this.Qm.xsa(n,x,1);for(x=0;x<=ma;x++)this.OWc(n,this.Qm.cT(E.J(x).contentControlNode).id);
for(x=ma+1;x<E.count;x++){Fa=this.Qm.cT(E.J(x).contentControlNode);if(!Fa.isEditable||!Fa.Pea||!Fa.isSupported||Fa.ZN)return!1;this.OWc(n,Fa.id)}for(E=ma+1;E<S.count;E++){ma=this.Qm.cT(S.J(E).contentControlNode);if(!ma.isEditable||!ma.Pea||!ma.isSupported||ma.ZN)return!1;this.OWc(n,ma.id)}if(n)for(let $a of n)if(!$a.isSupported||!$a.Pea)return!1;return h&&(b=this.jFd(b.J(0),!0))?this.cci(b,!0,!0):!0}L$l(b,h){h=this.Co.zBl(h.J(0),h.J(h.count-1));return!!b&&!!h&&b.objectId.equals(h.oe)}cci(b,h,n){return(b=
this.Qm.xsa(b,b,3))&&0<b.count&&(b=b.J(0),!b.isSupported||!b.isEditable||!this.TMd&&h&&!b.Vf||!n&&b.ZN)?!1:!0}jFd(b,h){if(!b)return null;let n=null;switch(b.contextId){case cc.a.paragraph:n=h?Dd.a.Uc(b.node,0):Dd.a.iw(b.node);break;case cc.a.endOfParagraph:n=Dd.a.iw(b.node);break;case cc.a.Fd:n=h?Dd.a.Uc(b.node,b.cpBegin):Dd.a.Uc(b.node,b.cpEnd);break;case cc.a.Wc:n=b}n&&(n.Ub=n.Fb=h?b.Fb:b.Ub);return n}OWc(b,h){if(b)for(let n of b)if(n.id===h){b.remove(n);break}}IJl(b,h){if(!b)return-1;let n=-1;
for(let x=0;x<b.length;x++)if(b.J(x).oe.equals(h.objectId)&&!1===b.J(x).Oc){n=x;if(h.Vf&&0<x&&b.J(x-1).Vf&&!b.J(x-1).Oc)return-1;break}return n}Vbm(b){if(void 0===b||null===b)return!1;for(let h=0;h<b.count;h++){const n=b.J(h).contextId;if(n!==cc.a.paragraph&&n!==cc.a.endOfParagraph&&n!==cc.a.Fd&&n!==cc.a.Wc||0<h&&h<b.count-1&&n===cc.a.Fd&&(b.J(h).cpBegin||b.J(h).cpEnd!==b.J(h).node.characterData.length))return!1}return b.J(0).contextId===cc.a.endOfParagraph&&1===b.count||this.BXe(b,cc.a.Wc)&&1<b.count?
!1:!0}BXe(b,h){for(let n of b)if(n.contextId===h)return!0;return!1}X5g(b,h,n=null,x=null,E=!1,S=!1){let ma=0;var Fa=h.node;let $a=Dd.a.create(b.node);Fa=Dd.a.create(Fa);if(!({X5i:$a,YBh:Fa}=this.Zg.w8j($a,Fa)).returnValue)return{returnValue:2,id:ma};const sb=this.j0.Qwb(n,t.px,t.zi,this.Zg,this.hs,this.Qm,this.opa,this.VLa,this.RMd);sb.start=b;sb.end=h;sb.ju=$a.node.id;sb.Fz=Fa.node.id;sb.Vf=!0;sb.Nyd=x;sb.D3e=E;return this.Qm.Y6g(sb,n,S)?(ma=sb.id,{returnValue:0,id:ma}):{returnValue:2,id:ma}}}t.px=
null;t.zi=null;Object(r.a)(t,"ContentControlManager",null,[494]);var y=d(686),O=d(162),Z=d(191);class ra extends Sys.EventArgs{constructor(b){super();this.sOk=b}}Object(r.a)(ra,"ContentControlChangeEventArgs",Sys.EventArgs,[]);class Ka{constructor(){this.ssi=0;this.RBi=null}}Object(r.a)(Ka,"BypassIfNodeOfTypeAndParentMatchingConditionFilterData",null,[]);class bb{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd,Gd,vd,ce,od,Yd,ne,Df,Af){this.BVg=[];this.ACe=[];this.px=b;this.zi=h;this.Zg=n;this.hs=
x;this.j0=E;this.og=$a;this.tC=sb;this.hb=S;this.hA=ma;this.Cxa=Fa;this.opa=Ic;this.gub=gd;this.Qca=Jb;this.oH=Sb;this.ga=oc;this.Co=Gd;this.Bf=vd;this.Fh=ce;this.fb=od;this.Hc=Yd;this.M3g=ne;this.wc=Df;this.rg=Af;this.oH&&(this.oH.addHandler(y.a.HHb,Object(v.a)(this,this.Fyi,"onShowingPlaceholder")),this.oH.addHandler(y.a.v2d,Object(v.a)(this,this.Rxi,"onRemoveWhenEdited")))}get Py(){return this.px.value}get Qi(){return this.zi.value}get MW(){return!!this.Bf.instance&&this.Bf.instance.MW}get D$(){return!!this.wc&&
this.wc.isFeatureEnabled(30)}dispose(){this.oH&&(this.oH.removeHandler(y.a.HHb,Object(v.a)(this,this.Fyi,"onShowingPlaceholder")),this.oH.removeHandler(y.a.v2d,Object(v.a)(this,this.Rxi,"onRemoveWhenEdited")))}KP(b,h,n,x=!1){if(this.MW)return this.xsa(b,h,n);if(!b||!h)return null;const E=this.Zg.Ika(b.node.id,!0);var S=this.Zg.Ika(h.node.id,!1);if(!E||!S)return null;b=b.contextId===cc.a.endOfParagraph?b:Dd.a.Uc(E,-1===b.cpBegin?0:b.cpBegin);h=h.contextId===cc.a.endOfParagraph?h:Dd.a.Uc(S,-1===h.cpEnd?
S.characterData.length:h.cpEnd);S=null;switch(n){case 0:S=this.ipl(b,h);break;case 1:S=this.KBl(b,h);break;case 3:S=this.LUh(b,h,x);break;case 2:S=this.LKl(b,h);break;case 4:S=this.lbf(b,h,!1)}return S}xsa(b,h,n){if(!b||!h||b.contextId!==cc.a.endOfParagraph&&(b=this.Vph(b,!0),!b)||h.contextId!==cc.a.endOfParagraph&&(h=this.Vph(h,!1),!h))return null;let x=null;switch(n){case 0:x=this.jpl(b,h);break;case 1:x=this.LBl(b,h);break;case 3:x=this.MUh(b,h);break;case 2:x=this.MKl(b,h);break;case 4:x=this.lbf(b,
h,!0)}return x}Vph(b,h){var n=this.Zg.Ika(b.node.id,h);if(!n)return null;h?(h=-1===b.cpBegin?0:b.cpBegin,b=b.Fb):(h=-1===b.cpEnd?n.characterData.length:b.cpEnd,b=b.Ub);n=Dd.a.Uc(n,h);n.Fb=b;n.Ub=b;return n}ipl(b,h){const n=new Qa.a;if(b.contextId===cc.a.endOfParagraph||h.contextId===cc.a.endOfParagraph||b.equals(h))return n;const x=new Lm.a,E=this.nzb(b,b),S=this.nzb(h,h);for(let ma=0;ma<E.count;ma++)if(E.J(ma).Oc)for(let Fa=0;Fa<S.count;Fa++)S.J(Fa).Oc||E.J(ma).oe.equals(S.J(Fa).oe)&&(!E.J(ma).Vf||
this.Zg.lMa(E.J(ma).oe,b.node.id,!0)&&this.Zg.lMa(S.J(Fa).oe,h.node.id,!1))&&this.vpd(n,x,E.J(ma).oe);return n}jpl(b,h){const n=new Qa.a;if(b.contextId===cc.a.endOfParagraph||h.contextId===cc.a.endOfParagraph||b.equals(h)&&b.Fb===b.Ub||-1===b.Fb||-1===h.Ub)return n;var x=b.node.qa.ji(b.cpBegin),E=h.node.qa.ji(h.cpEnd);x&&x.Mb&&0<x.Mb.length&&b.Fb<=x.Mb.length&&E&&E.Mb&&0<E.Mb.length&&h.Ub<=E.Mb.length&&(b=b.Fb,h=h.Ub,b===x.Mb.length&&b--,0<h&&h--,x=x.Mb.J(b),E=E.Mb.J(h),x.Oc&&!E.Oc&&C.a.Dp(x.oe,E.oe)&&
x.zq&&E.zq&&(E=x.contentControlNode)&&n.add(this.cT(E)));return n}KBl(b,h){const n=new Qa.a,x=new Lm.a,E=this.nzb(b,h);for(let S=0;S<E.count;S++)this.vpd(n,x,E.J(S).oe);b=this.LUh(b,h,!1,!1);for(let S of b)x.contains(S.objectId)||(n.add(S),x.add(S.objectId));return n}LBl(b,h){const n=new Qa.a,x=new Lm.a,E=this.vaf(b,h);for(let S=0;S<E.count;S++)this.xMe(n,x,E.J(S));b=this.MUh(b,h);for(let S of b)x.contains(S.objectId)||(n.add(S),x.add(S.objectId));return n}LUh(b,h,n,x=!0){const E=new Qa.a;b.equals(h)&&
(n=!1);const S=new Lm.a;let ma=!1;b=this.nzb(null,b,!0,n);h=this.nzb(h,null,n,!0);for(n=b.count-1;0<=n;n--){for(let Fa=0;Fa<h.count&&!(b.J(n).oe.equals(h.J(Fa).oe)&&(b.J(n),this.vpd(E,S,b.J(n).oe)&&(ma=!this.Zg.yu(b.J(n).oe).ia(ic.a.D5,null),x||ma)));Fa++);if(0<E.count&&(x||ma))break}return E}MUh(b,h){const n=new Qa.a,x=new Lm.a,E=b.node;var S=h.node;const ma=h.contextId===cc.a.endOfParagraph?S.characterData.length:h.cpEnd;b=this.Co.X5(E,b.contextId===cc.a.endOfParagraph?E.characterData.length:b.cpBegin,
b.Fb);h=this.Co.X5(S,ma,h.Ub);S=b.count>h.count?h.count:b.count;for(--S;0<=S;S--)b.J(S).oe.equals(h.J(S).oe)&&this.xMe(n,x,b.J(S));return n}LKl(b,h){const n=new Qa.a;let x=new Lm.a;const E=this.nzb(b,h);let S=0,ma=null;if(b.equals(h))return n;for(b=0;b<E.count;b++)!E.J(b).Oc||E.J(b).Vf&&!this.Zg.lMa(E.J(b).oe,E.J(b).Ob.paragraph.id,!0)?E.J(b).Oc||E.J(b).Vf&&!this.Zg.lMa(E.J(b).oe,E.J(b).Ob.paragraph.id,!1)||(S--,0>S?(S=0,x=new Lm.a):!S&&ma&&E.J(b).oe.equals(ma)&&this.vpd(n,x,ma)):(S||(ma=E.J(b).oe),
S++);return n}MKl(b,h){const n=new Qa.a;if(b.equals(h)&&b.Fb===h.Ub)return n;let x=new Lm.a;b=this.vaf(b,h);h=0;let E=null;for(let S=0;S<b.count;S++){const ma=b.J(S);!ma.Oc||ma.Vf&&!this.Zg.lMa(ma.oe,ma.Ob.paragraph.id,!0)?ma.Oc||ma.Vf&&!this.Zg.lMa(ma.oe,ma.Ob.paragraph.id,!1)||(h--,0>h?(h=0,x=new Lm.a):!h&&E&&ma.oe.equals(E.oe)&&this.xMe(n,x,E)):(h||(E=ma),h++)}return n}lbf(b,h,n){const x=new Qa.a;b=n?this.vaf(b,h):this.nzb(b,h);h=0;for(n=0;n<b.count;n++){var E=b.J(n);E.zq&&(E.Oc?h++:(h--,0>h?h=
0:(E=this.cT(E.contentControlNode))&&x.add(E)))}return x}nzb(b,h,n=!0,x=!0){const E=new Qa.a,S=this.bT(b,h);if(!S.count)return E;let ma,Fa,$a,sb;for(let Jb=0;Jb<S.count;Jb++){ma=0;Fa=S.J(Jb).characterData.length;$a=sb=!0;if(b&&S.J(Jb).id.equals(b.node.id)){if(b.contextId===cc.a.endOfParagraph)continue;0<=b.cpBegin&&(ma=b.cpBegin)}h&&S.J(Jb).id.equals(h.node.id)&&0<=h.cpEnd&&(Fa=h.cpEnd);Jb||($a=n);Jb!==S.count-1||h&&h.contextId===cc.a.endOfParagraph||(sb=x);E.addRange(this.waf(S.J(Jb),ma,Fa,$a,sb))}return E}vaf(b,
h){const n=new Qa.a,x=this.bT(b,h);let E,S,ma;for(let $a=0;$a<x.count;$a++){const sb=x.J($a);var Fa=sb.qa.J(sb.qa.length-1);E=0;S=sb.characterData.length;ma=0;Fa=Fa&&Fa.Mb?Fa.Mb.length:0;b&&sb.id.equals(b.node.id)&&(E=b.gl,ma=b.Fb);h&&sb.id.equals(h.node.id)&&(S=h.ot,Fa=h.Ub);n.addRange(this.wLh(sb,E,S,ma,Fa))}return n}waf(b,h,n,x=!0,E=!0,S=!0){const ma=new Qa.a;b=b.qa;for(let Fa=0;Fa<b.length;Fa++){if(b.J(Fa).cp<h)continue;if(b.J(Fa).cp>n)break;const $a=b.J(Fa);if($a.Mb&&0<$a.Mb.length&&($a.cp!==
h||x)&&($a.cp!==n||E))for(let sb=0;sb<$a.Mb.length;sb++){const Jb=$a.Mb.J(sb);(S||Jb.Oc)&&ma.add(Jb)}}return ma}wLh(b,h,n,x,E){const S=new Qa.a;b=b.qa;for(let ma=0;ma<b.length;ma++){if(b.J(ma).cp<h)continue;if(b.J(ma).cp>n)break;const Fa=b.J(ma);if(Fa.Mb&&0<Fa.Mb.length){let $a=0,sb=Fa.Mb.length;Fa.cp===h&&($a=x);for(Fa.cp===n&&(sb=E);$a<sb&&$a<Fa.Mb.length;$a++)S.add(Fa.Mb.J($a))}}return S}vpd(b,h,n){let x=null;if(h.contains(n)||!(x=this.Qi.Eb(n)))return!1;b.add(this.cT(x));h.add(n);return!0}xMe(b,
h,n){let x=null;!h.contains(n.oe)&&(x=n.contentControlNode)&&(b.add(this.cT(x)),h.add(n.oe))}Lbj(b,h){let n,x=!1;n=({C0a:h,B0a:b,o_c:x}=this.Mbj(b,h,!1,x)).returnValue||x;x&&(n=n||({C0a:h,B0a:b,o_c:x}=this.Mbj(h,b,!0,x)).returnValue);return{returnValue:n,C0a:h,B0a:b}}Mbj(b,h,n,x){var E,S,ma,Fa;let $a,sb;if(n)return $a=sb=null,{returnValue:!1,C0a:sb,B0a:$a,o_c:!1};let Jb=!1;sb=b;$a=h;const Sb=b.cpBegin,oc=h.cpEnd;x=!1;var Ic=n?this.jKh(h):this.Cfl(b);let gd=!1,Gd=!1,vd=0,ce=0;for(let od of Ic)for(Ic=
0;Ic<od.qa.length;Ic++){const Yd=od.qa.J(Ic);!Gd&&od.id.equals(h.node.id)&&(Gd=!0);if(!gd&&(od.id.equals(h.node.id)&&-1!==oc&&Yd.cp>oc||Gd&&!od.id.equals(h.node.id)))if(gd=!0,vd!==ce)Jb=!0;else return{returnValue:!1,C0a:sb,B0a:$a,o_c:x};if((!od.id.equals(b.node.id)||Yd.cp>=Sb||-1===Sb)&&Yd.Mb)for(let ne=0;ne<Yd.Mb.length;ne++){const Df=Yd.Mb.J(ne),Af=this.Qi.Eb(Df.oe);if(!Af.getValue(ic.a.o6)||(!Df.Oc||this.Zg.lMa(null!==(S=this.rg.hr.get(null===(E=Af.id)||void 0===E?void 0:E.toString()))&&void 0!==
S?S:C.a.nil,od.id,!0))&&(Df.Oc||this.Zg.lMa(null!==(Fa=this.rg.xs.get(null===(ma=Af.id)||void 0===ma?void 0:ma.toString()))&&void 0!==Fa?Fa:C.a.nil,od.id,!1))){Df.Oc?vd++:vd--;if(Jb&&vd===ce)return{C0a:sb,B0a:$a}=this.IGk(b.node,od,b.cpBegin,Yd.cp),{returnValue:!0,C0a:sb,B0a:$a,o_c:x};!n&&vd<ce&&(x=!0,ce--)}}}return{returnValue:Jb,C0a:sb,B0a:$a,o_c:x}}IGk(b,h,n,x){let E;h.id.equals(b.id)?b=0<n||x<Cd.ParagraphReader.textLength(h)?E=Dd.a.createTextRange(h,n,x):E=Dd.a.create(h):(E=0<n?Dd.a.createTextRange(b,
n,Cd.ParagraphReader.textLength(b)):Dd.a.create(b),b=x<Cd.ParagraphReader.textLength(h)?Dd.a.createTextRange(h,0,x):Dd.a.create(h));return{C0a:E,B0a:b}}Sxl(b){var h,n,x,E;const S=b.cpBegin,ma=this.jKh(b);for(let $a=ma.count-1;0<=$a;$a--){const sb=ma.J($a);for(let Jb=sb.qa.length-1;0<=Jb;Jb--){const Sb=sb.qa.J(Jb);if((!sb.id.equals(b.node.id)||Sb.cp<=S||-1===S&&!Sb.cp)&&Sb.Mb){var Fa=Sb.Mb.length-1;for((Sb.cp===S||-1===S&&!Sb.cp)&&this.MW&&sb.id.equals(b.node.id)&&(Fa=b.Fb-1);0<=Fa;Fa--){const oc=
Sb.Mb.J(Fa),Ic=this.Qi.Eb(oc.oe);if(oc.Oc){if(Ic.getValue(ic.a.o6)&&!this.Zg.lMa(null!==(E=this.rg.hr.get(null===(x=Ic.id)||void 0===x?void 0:x.toString()))&&void 0!==E?E:C.a.nil,sb.id,!0))continue;return null}if(!Ic.getValue(ic.a.o6)||this.Zg.lMa(null!==(n=this.rg.xs.get(null===(h=Ic.id)||void 0===h?void 0:h.toString()))&&void 0!==n?n:C.a.nil,sb.id,!1))return this.cT(Ic)}}}}return null}cT(b){if(!b)return null;this.Zg.t0b();return this.j0.Qwb(b,this.px,this.zi,this.Zg,this.hs,this,this.opa,this.Qca,
this.gub)}bT(b,h){b=this.iKh(b,h,bb.Xzb(12));if(!b)return null;h=new Qa.a;for(let n of b)h.add(n);return h}Afl(b,h){const n=bb.mul();return this.iKh(Dd.a.create(b.node),Dd.a.create(h.node),n)}iKh(b,h,n){if(!n||!b&&!h)return null;if(b&&h&&(b.equals(h)||b.node.id.equals(h.node.id))){var x=b.node;if(x&&n(x)){var E;return E=new Qa.a,E.add(x),E}}x=Object.assign(new Ka,{ssi:35,RBi:n});b=b?b.node:null;h=h?h.node:null;E=this.IFl(b,h);if(!E)return null;h=this.z8j(h,n,bb.Jgh,x);return this.wfl(b,h,E,n,bb.Jgh,
x)}IFl(b,h){return(b=b?this.BRh(b):this.BRh(h))?b.kd(35):this.Zg.uAl()}z8j(b,h,n,x){if(!b)return null;h(b)||(h=this.xfl(b,h,n,x),h.count&&(b=h.J(h.count-1)));return b}wfl(b,h,n,x,E,S){b?(b=md.GraphIterator.$a(b),b.Bb(7),n=cn.a.Ir(b,n)):n=cn.a.Vp(n);E&&n.Om(E,S);for(E=new Qa.a;n.moveNext()&&(x(n.currentNode)&&E.add(n.currentNode),!h||!n.currentNode.id.equals(h.id)););return E}xfl(b,h,n,x){b=cn.a.Vp(b);n&&b.Om(n,x);for(n=new Qa.a;b.moveNext();)h(b.currentNode)&&n.add(b.currentNode);return n}BRh(b){b=
md.GraphIterator.$a(b);return b.Bb(35)?b:null}y2h(b,h){b=this.bT(b,h);for(let n of b)if((b=this.Zg.ydf(n))&&b.e6(4))return!0;return!1}Y6g(b,h=null,n=!1){if(!b)return!1;var x=b.start,E=b.end;if(!Kd.SelectionEditor.Zt(x)&&x.contextId!==cc.a.paragraph||!Kd.SelectionEditor.Zt(E)&&E.contextId!==cc.a.paragraph||!this.MW&&({C0a:x,B0a:E}=this.Lbj(b.start,b.end)).returnValue||this.MW&&!({start:x,end:E}=this.wpk(x,E)).returnValue)return!1;b.start=x;b.end=E;const S=this.pam(x,E);if(this.MW){var ma=this.xsa(b.start,
b.end,3);var Fa=this.xsa(b.start,b.end,2)}else ma=this.KP(b.start,b.end,3),Fa=this.KP(b.start,b.end,2);const $a=ma&&0<ma.count?ma.J(0):null,sb=Fa&&0<Fa.count?Fa.J(0):null;if(n)return this.EMc(b,0,ma)?!0:!1;if(this.EMc(b,0,ma)){n=(n=Object(ja.a)(nz,this.Sxl(b.start)))?this.Zg.yu(n.objectId):null;Fa=this.Zg.t0j(b,$a,n,Fa,b.ju,b.Fz,h);if(b.Vf)for(x=this.bT(b.start,b.end),E=0;E<x.count;E++)this.MW?(n=$a?$a.objectId:null,ma=this.hRh(n,x.J(E),!0),this.hs.Pqa(x.J(E),Fa.id,0,!0,!0,void 0,void 0,void 0,void 0,
ma),n=this.hRh(n,x.J(E),!1),this.hs.Pqa(x.J(E),Fa.id,x.J(E).characterData.length,!0,!1,void 0,void 0,void 0,void 0,n)):(this.hs.Pqa(x.J(E),Fa.id,0,!0,!0),this.hs.Pqa(x.J(E),Fa.id,x.J(E).characterData.length,!0,!1));else this.MW?(n=-1===x.Fb?0:x.Fb,this.hs.Pqa(b.start.node,Fa.id,x.cpBegin,!1,!0,void 0,void 0,void 0,void 0,n),this.hs.Pqa(b.end.node,Fa.id,E.cpEnd,!1,!1,void 0,void 0,void 0,void 0,S?n+1:E.Ub)):(this.hs.Pqa(b.start.node,Fa.id,b.start.cpBegin,!1,!0),this.hs.Pqa(b.start.node,Fa.id,b.start.cpEnd,
!1,!1));h||this.Zg.JGn(Fa,b.Vf,b.id,this.Zg.r3b(this.Zg.yu(b.ju)));b.objectId=Fa.id;h=this.Zg.Bsa().currentNode;h.hasProperty(ic.a.kBc)||h.setValue(ic.a.kBc,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);$a&&this.qgj($a.contentControlNode,b);sb&&this.qgj(Fa,sb);S&&this.ga.Xb(Db.a.LZf,2,b.id);return!0}return!1}deleteContentControl(b){if(this.EMc(b,3)){b.ZN&&(b.ZN=!1);const h=this.hb.ib.kb;b=b.cE();const n=new om.Selection(b.toArray(),!0);let x=!1;this.hb.wIb(()=>{this.hb.setSelection(n);
if(32===this.ga.processAction(Db.a.HG,2)){if(this.M3g.instance){const E=this.M3g.instance.TSh(h,n,this.hb.ib.kb);this.hb.Sdo(new O.SelectionCollection([E],0))}x=!0}});return x}w.ULS.sendTraceTag(528537614,368,15,"Invalid content control to delete");return!1}tDa(b,h=!1){if(this.EMc(b,2)){if(b.ZN)return w.ULS.sendTraceTag(528537615,368,15,"Attempting to delete content control showing placeholder"),this.deleteContentControl(b);const n=this.Zg.yu(b.objectId);let x=new Qa.a;h&&(x=b.E$e());x.add(b);n&&
n.anchor&&this.Zg.Gwh(n,h);for(let E of x)b=this.bT(E.start,E.end),this.hs.BQk(b,E.objectId);this.wHi(x);w.ULS.sendTraceTag(528537616,368,50,"Successfully released content control.");return!0}w.ULS.sendTraceTag(528537617,368,15,"Invalid content control to release.");return!1}NZi(b,h){if(this.EMc(b,1)){let Fa=!1;h||(Fa=!0,{HRn:n,returnValue:h}=this.vIc(b),n&&this.Zg.Bsa().currentNode.setValue(ic.a.kBc,h));var n=b.gMh().toArray();for(var x=0;x<n.length;x++)this.tDa(n[x],!0);h=this.AZn(h);if(b.Vf){x=
this.bT(b.start,b.end);if(!x.count)return!1;if(1===x.count&&u.AFrameworkApplication.gF)h=h.join(" "),this.hs.replaceTextRange(Dd.a.createTextRange(x.J(0),0,x.J(0).characterData.length),h);else{var E=this.Zg.DBl(x.J(0));n=x.J(0).A1b();x=this.Zg.Uwh(x);x=this.Zg.l7g(E,x,h.length);for(E=0;E<x.count;E++){this.hs.replaceTextRange(Dd.a.createTextRange(x.J(E),0,0),h[E]);for(var S=0;S<n.count;S++)this.hs.Pqa(x.J(E),n.J(S),0,!0,!0),this.hs.Pqa(x.J(E),n.J(n.count-S-1),x.J(E).characterData.length,!0,!1)}b.Gjo(x.J(0).id,
x.J(x.count-1).id);h=this.hA.xe(x.J(0),0);this.hb.setSelection(h)}}else{E=0;1<h.length&&w.ULS.sendTraceTag(17585367,368,15,"New text being set to an inline content control should not contain multiple paragraphs");n=b.start;x=n.node;for(var ma=0;ma<x.qa.length&&n.contextId===cc.a.Fd;ma++)if(S=x.qa.J(ma),S.cp===n.cpBegin&&S.blob){E++;for(ma+=1;ma<x.qa.length;ma++)if(S=x.qa.J(ma),S.cp>n.cpBegin&&S.cp<=n.cpEnd)if(S.blob)E++;else break;else if(S.cp>n.cpEnd)break;break}if(0<E&&E+n.cpBegin<n.cpEnd)x=Dd.a.createTextRange(n.node,
n.cpBegin,n.cpBegin+E),n=Dd.a.createTextRange(n.node,n.cpBegin+E,n.cpEnd),this.hs.replaceTextRange(n,h[0]),this.hs.replaceTextRange(x,"");else if(0<E&&E+n.cpBegin===n.cpEnd)for(this.hs.replaceTextRange(b.start,h[0]),h=0;h<x.qa.length;h++){if(E=x.qa.J(h),E.cp===n.cpBegin){E.blob=null;break}}else u.AFrameworkApplication.gF?(h=h.join(" "),this.hs.replaceTextRange(b.start,h)):this.hs.replaceTextRange(b.start,h[0])}this.frd(b,Fa);let $a;this.Qbn(($a=new Qa.a,$a.add(b),$a));return!0}return!1}frd(b,h){const n=
this.hs.XFd(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(!n)w.ULS.sendTraceTag(17585368,368,15,"Unable to get a ChP at starting Ip of Content Control");else if(Of.a.instance.J(10)){const x=this.Zg.yu(b.objectId);if(h){h=this.tC.Nx(b.start.node);let E=h.uh(bb.a3m);E||(E=h.Lsa(bb.$2m));E&&(this.og.Fja(n.formatting),this.og.gkb(n.formatting,E));x&&(b.ZN=!0)}else x&&b.ZN&&(this.Wvn(b,n),b.ZN=!1)}}Wvn(b,h){b=this.Zg.yu(b.objectId);let n=null;b&&(n=b.ia(ic.a.mBc,C.a.nil));this.og.Fja(h.formatting);
n&&!n.equals(C.a.nil)&&(b=this.zi.value.Eb(n),h.formatting=b)}vIc(b){let h=!1;b=b.uZd;this.bjm(b)&&(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,h=!0);return{returnValue:b,HRn:h}}amn(b,h=!0){this.Qca&&(h&&this.Xln(b),this.emn(b))}bmn(b){if(this.Qca&&(b=this.KP(b,b,4)))for(let h of b)this.tDa(h,!1)}SOm(b,h){if(h&&!b.Oc&&(this.Zg.t0b(),(b=b.Ob.paragraph.Nc.Eb(b.oe))&&b.anchor)){this.Zg.Gwh(b);b=this.j0.Qwb(b,this.px,this.zi,this.Zg,this.hs,this,this.opa,this.Qca,this.gub);let n;this.wHi((n=
new Qa.a,n.add(b),n))}}Rxi(b,h){this.Zg.t0b();b=this.Zg.yu(h.oe);const n=this.cT(b);if(n&&n.Qd()&&n.removeWhenEdited){const x=this.Hc.Rc(7);x.Db(b);this.tDa(n,!1);h.state=2;x.dispose()}}Fyi(b,h){this.Zg.t0b();b=this.Zg.yu(h.oe);this.t9l(b)&&(b=b.ia(ic.a.By,0),this.ga&&(this.ga.Xb(Db.a.LZf,2,b),bb.Rd.KOe()))}t9l(b){return b&&b.isConnected&&!b.ia(ic.a.E5,!1)?this.D$h(b):!1}D$h(b){b=this.j0.Qwb(b,this.px,this.zi,this.Zg,this.hs,this,this.opa,this.Qca,this.gub);if(!b.Qd())return!1;if(b.Vf){if(b.ju.toString()===
b.Fz.toString()){var h=this.Zg.yu(b.ju);if(!h)return w.ULS.shipAssertTag(22828291,368,!1,"Block content control is connected but its start node is null"),!1;if(12===h.type&&1===h.qa.length)return this.B$h(h.qa.J(0),b.objectId)}}else{h=b.start;if(!h)return w.ULS.shipAssertTag(22828292,368,!1,"Inline content control is connected but its start context is null"),!1;if(h.cpBegin===h.cpEnd)return h=this.Zg.yu(b.ju).qa.ji(h.cpBegin),this.B$h(h,b.objectId)}return!1}B$h(b,h){b=b?b.Mb:null;if(!b)return!1;const n=
b.gI(h,!0);return-1<n&&n+1<b.length&&b.J(n+1).oe.toString()===h.toString()}win(b){this.ACe.push(b)}y5i(b,h){if(void 0===b||null===b||b.contextId!==cc.a.Fd)return null;b=Dd.a.Uc(b.node,h?b.cpBegin:b.cpEnd);return 0<b.cpBegin&&b.cpBegin<Cd.ParagraphReader.textLength(b.node)?this.Zg.sPa(b):null}select(b,h){if(b&&!b.equals(C.a.nil)){var n=this.Zg.yu(b);if(n&&55===n.type){n=this.cT(n);if(n.Vf)n=this.ohl(n);else{n=n.start;if(!n)return;n=this.hA.Kn(n)}n&&n.length&&(this.JWi(n.Qa,b,h,!0,!0),this.JWi(n.Tc,
b,h,!1,!1),this.hb.setSelection(n))}}}xBn(b,h){if(!Kd.SelectionEditor.xf(b)||b.Fb!==b.Ub)return!1;const n=b.Fb;return-1===n?!1:(b=this.Co.AXa(b.node,b.cpBegin,n,!h))&&h===b.Oc?(h=this.cT(b.contentControlNode),this.select(b.oe,!h.isEditable),!0):!1}ohl(b){var h=this.Zg.IKa(b.ju,!0);b=this.Zg.IKa(b.Fz,!1);if(!h||!b)return null;h=this.Afl(Dd.a.create(h),Dd.a.create(b));if(!h||!h.count)return null;b=new Qa.a;for(let n=0;n<h.count;n++){let x;if(12===h.J(n).type)x=n===h.count-1?Dd.a.createTextRange(h.J(n),
0,Cd.ParagraphReader.textLength(h.J(n))):Dd.a.create(h.J(n)),this.Fh&&(x.Fb=this.Fh.wq(x.node,!0),x.Ub=this.Fh.wq(x.node,!1));else if(15===h.J(n).type)x=Z.TableNodeContext.create(h.J(n));else continue;b.add(x)}return new om.Selection(b.toArray(),!0)}gGn(b){if(b&&!b.equals(C.a.nil)&&(this.Zg.t0b(),(b=this.Zg.yu(b))&&55===b.type&&b.isConnected)){var h=b.ia(ic.a.E5,!1);b.setValue(ic.a.E5,!1);h&&this.nhn(b)}}nhn(b){var h,n;const x=null!==(n=this.rg.hr.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&
void 0!==n?n:C.a.nil;x.equals(C.a.nil)||(h=this.Zg.Ika(x,!0))&&(b=this.hs.gbf(h,b.id,!0))&&0<b.count&&(b=b.J(0),h=b.Ob,h.formatting=b.IP?b.IP.Yf(h):new yj.a(h,C.a.nil))}dLi(b){if(b=this.dNh(b))for(let h of b)h.ZN=!1,this.tDa(h,!1)}Tkl(b){const h=new Qa.a;if(b=this.dNh(b))for(let n of b)h.add(n.contentControlNode);return h}cmn(b){if(b&&(11===b.type||14===b.type||15===b.type||16===b.type)){var h=this.fb.Ym(b),n=this.fb.TJ(b);if(this.Fh&&h&&n){b=this.Fh.wq(h,!0);const x=this.Fh.wq(n,!1);h=Dd.a.create(h);
n=Dd.a.create(n);h.Fb=b;n.Ub=x;if(b=this.xsa(h,n,4))for(let E of b)this.tDa(E,!1)}}}Dfl(b){var h,n,x,E;const S=null!==(n=this.rg.hr.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==n?n:C.a.nil;b=null!==(E=this.rg.xs.get(null===(x=b.id)||void 0===x?void 0:x.toString()))&&void 0!==E?E:C.a.nil;if(S.equals(C.a.nil)||b.equals(C.a.nil))return new Qa.a;x=this.Zg.Ika(S,!0);E=this.Zg.Ika(b,!1);return x&&E?this.bT(Dd.a.create(x),Dd.a.create(E))||new Qa.a:new Qa.a}IKa(b,h){return this.Zg.IKa(b,
h)}idf(b,h){if(b&&55===b.type&&(b=this.cT(b),b=h?b.start:b.end)){const n=Dd.a.Uc(b.node,h?b.gl:b.ot);n.Fb=n.Ub=(h?b.Fb:b.Ub)+(h?-1:1);return n}return null}Wkl(b){return(b=this.cT(b))?b.start:null}JWi(b,h,n,x,E){if((b.contextId===cc.a.Fd||b.contextId===cc.a.Wc||b.contextId===cc.a.paragraph)&&(E=b.node.qa.ji(E?b.gl:b.ot))&&E.Mb)for(let S=0;S<E.Mb.length;S++){const ma=E.Mb.J(S);if(ma.oe.equals(h)&&ma.zq)if(x&&ma.Oc){b.Fb=n?S:S+1;break}else if(!x&&!ma.Oc){b.Ub=n?S+1:S;break}}}Qbn(b){for(let h=0;h<this.BVg.length;++h)(0,this.BVg[h])(this,
new ra(b))}wHi(b){for(let h=0;h<this.ACe.length;++h)(0,this.ACe[h])(this,new ra(b))}emn(b){b=Dd.a.create(b);if(b=this.KP(b,b,4))for(let h of b)h.Vf||this.tDa(h,!1)}Xln(b){if(b=b.A1b())for(let n=0;n<b.count;n++){var h=this.Zg.yu(b.J(0));h=this.j0.Qwb(h,this.px,this.zi,this.Zg,this.hs,this,this.opa,this.Qca,this.gub);this.tDa(h)}}Cfl(b){return this.bT(b,null)}EMc(b,h,n=null){let x=!0;try{if(!b)return w.ULS.sendTraceTag(529106507,368,50,"Content Control is null"),!1;w.ULS.sendTraceTag(529106508,368,
50,String.format("Content control change type: {0}, isSupported: {1}, isDeletable: {2}",h,b.isSupported,b.Pea));if(this.Cxa&&Of.a.instance.J(3)&&this.Cxa.ZW(this.px.value))return w.ULS.sendTraceTag(529106509,368,50,"Content Control Change Invalid because track changes is enabled"),!1;if(this.rfm(h)&&this.sfm(h)&&!this.u9l(b))return!1;if(!n){const ma=this.yBl(b);ma&&(n=new Qa.a,n.add(ma))}var E=this.Zg.hUh(b.start.node);const S=this.Zg.hUh(b.end.node);if(E&&S&&!E.equals(S)||!E&&S||E&&!S)return!1;E=
!0;if(n&&0<n.count){if(!n.J(0).isSupported)return!1;E=n.J(0).isEditable}switch(h){case 0:x=this.$6l(b,E);break;case 1:x=(this.D$||!this.Spf(b))&&b.isSupported&&b.isEditable&&this.cch(b)&&this.E$h(b);u.AFrameworkApplication.gF||(x=x&&!this.y2h(b.start,b.end));break;case 2:const ma=b.lkm?!0:b.isSupported;x=(this.D$||!this.Spf(b))&&ma&&b.Pea&&E;w.ULS.sendTraceTag(529106510,368,50,"True");break;case 3:x=b.isSupported&&b.Pea&&E&&this.cch(b)&&this.E$h(b)&&!this.y2h(b.start,b.end)}}catch(S){w.ULS.sendTraceTag(17413646,
368,15,"Exception was caught in IsContentControlValid. OperationType: "+h+", Exception: "+S),x=!1}return x}sfm(b){u.AFrameworkApplication.gF&&u.AFrameworkApplication.Hf("7gbeh287;7cff7940");return!(u.AFrameworkApplication.gF&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.skipNestedCCCheck",!1)&&1===b)}rfm(b){return!(this.MW&&(!b||2===b||3===b))}$6l(b,h){let n=!0;if(!this.D$&&this.Spf(b))n=!1;else if(this.MW)this.MW?b.Vf||Kd.SelectionEditor.Zt(b.start)||b.start.contextId===
cc.a.endOfParagraph?b.Vf&&(b.start.contextId!==cc.a.paragraph&&b.start.contextId!==cc.a.endOfParagraph||b.end.contextId!==cc.a.paragraph&&b.end.contextId!==cc.a.endOfParagraph)&&(n=!1):n=!1:n=h?this.b8l(b):!1;else if(!(b.Vf||-1!==b.start.cpBegin&&-1!==b.end.cpEnd&&b.start.equals(b.end)))n=!1;else if(b.Vf&&(b.start.contextId!==cc.a.paragraph||b.end.contextId!==cc.a.paragraph||b.start.equals(b.end)&&!Cd.ParagraphReader.textLength(b.start.node)))n=!1;else if(b.start.contextId===cc.a.Wc||b.end.contextId===
cc.a.Wc||b.start.contextId===cc.a.endOfParagraph||b.end.contextId===cc.a.endOfParagraph)n=!1;return n}dNh(b){if(!b||!b.length)return null;const h=b[0];b=b[b.length-1];this.Fh&&(this.fb.gm(h)&&12===h.node.type&&(h.Fb=this.Fh.wq(h.node,!0)),this.fb.gm(b)&&12===b.node.type&&(b.Ub=this.Fh.wq(b.node,!1)));return this.xsa(h,b,4)}cch(b){b=b.E$e();for(let h of b)if(!h.isSupported||!h.Pea)return!1;return!0}u9l(b){if(this.Lbj(b.start,b.end).returnValue)return!1;const h=this.KP(b.start,b.end,2);if(!h)return!0;
for(let n of h)if(!n.objectId.equals(b.objectId)&&(n.Vf&&(n.start.node.id.equals(b.start.node.id)&&(-1===b.start.cpBegin||!b.start.cpBegin)||n.end.node.id.equals(b.end.node.id)&&(-1===b.end.cpEnd||b.end.cpEnd===Cd.ParagraphReader.textLength(n.end.node)))||!n.Vf&&(b.start.node.id.equals(n.start.node.id)&&(-1!==b.start.cpBegin?n.start.cpBegin===b.start.cpBegin:!n.start.cpBegin)||b.end.node.id.equals(n.end.node.id)&&(-1!==b.end.cpEnd?n.end.cpEnd===b.end.cpEnd:n.end.cpEnd===Cd.ParagraphReader.textLength(b.end.node)))))return!1;
return!0}E$h(b){if(b.Vf){var h=this.Zg.yu(b.ju),n=this.Zg.yu(b.Fz);let x=null;if(12===h.type&&12===n.type){h=this.Zg.r3b(h);h=this.Zg.yu(h);n=this.Zg.r3b(n);n=this.Zg.yu(n);if(!h||!n)return!1;16===h.type&&16===n.type&&h.id.equals(n.id)&&(x=h)}b=this.bT(b.start,b.end);if(!b.count)return!1;for(let E of b)if(b=this.Zg.r3b(E),b=this.Zg.yu(b),!b||!(16!==b.type||x&&b.id.equals(x.id)))return!1}return!0}Spf(b){return b.Vf?!1:(b=b.start.node)?!b.ia(ic.a.R5b,!0):!0}b8l(b){if(b.Vf){var h=this.Zg.yu(b.ju);b=
this.Zg.yu(b.Fz);if(Fg.TableCellReader.Eta(h)||Fg.TableCellReader.Eta(b)||al.a.$la(h)||al.a.$la(b))return!1;h=this.Zg.r3b(h);h=this.Zg.yu(h);b=this.Zg.r3b(b);b=this.Zg.yu(b);if(!h||!b||(16===h.type||16===b.type)&&!h.id.equals(b.id))return!1}return!0}yBl(b){if(!b)return null;b=this.Zg.yu(b.objectId);if(!b)return null;b=b.ia(ic.a.D5,C.a.nil);return b.equals(C.a.nil)?null:(b=this.Zg.yu(b))?this.cT(b):null}jKh(b){return this.bT(null,b)}AZn(b){return(b||"").split(RegExp("\r\n|\r|\n"))}bjm(b){return b&&
""!==b?!1:!0}hRh(b,h,n){h=h.qa.ji(n?0:h.characterData.length);if(!h)return w.ULS.sendTraceTag(21018849,368,15,"Unable to get a ChP at expected cp, which should not happen"),0;if(!h.Mb||!h.Mb.length)return 0;if(!b)return n?0:h.Mb.length;for(let x=0;x<h.Mb.length;x++){const E=h.Mb.J(x);if(C.a.Dp(E.oe,b)&&E.Oc===n)return n?x+1:x}return n?0:h.Mb.length}wpk(b,h){var n=b.node,x=h.node,E=b.contextId===cc.a.paragraph?0:b.cpBegin,S=h.contextId===cc.a.paragraph?Cd.ParagraphReader.textLength(x):h.cpEnd;n=this.Co.X5(n,
E,b.Fb);x=this.Co.X5(x,S,h.Ub);S=!n||!n.count;E=!x||!x.count;if(S&&E)return{returnValue:!0,start:b,end:h};if(S)return{returnValue:this.Dae(b,x.J(x.count-1).oe,!0),start:b,end:h};if(E)return{returnValue:this.Dae(h,n.J(n.count-1).oe,!1),start:b,end:h};if(n.count===x.count)return n=n.J(n.count-1),x=x.J(x.count-1),{returnValue:n.oe.equals(x.oe),start:b,end:h};n=(S=n.count<x.count)?x.J(x.count-1):n.J(n.count-1);return{returnValue:S?this.Dae(b,n.oe,!0):this.Dae(h,n.oe,!1),start:b,end:h}}Dae(b,h,n){var x=
b.node;let E;if(n){E=b.contextId===cc.a.paragraph?0:b.cpBegin;var S=b.Fb}else E=b.contextId===cc.a.paragraph?Cd.ParagraphReader.textLength(x):b.cpEnd,S=b.Ub;x=x.qa.ji(E);if(-1===S||!x||!x.Mb||!x.Mb.length)return!1;x=x.Mb;if(n)for(n=S;n<x.length;n++){S=x.J(n);if(!S.Oc)break;if(S.oe.equals(h))return b.Fb=n+1,!0}else for(n=S-1;0<=n;n--){S=x.J(n);if(S.Oc)break;if(S.oe.equals(h))return b.Ub=n,!0}return!1}pam(b,h){return this.cdk(b,h)&&b.Fb===b.Ub&&(b.contextId===cc.a.Wc||b.contextId===cc.a.paragraph&&
!b.node.characterData.length)}cdk(b,h){return b.equals(h)&&b.Fb===h.Fb&&b.Ub===h.Ub}qgj(b,h){var n,x,E,S,ma,Fa;if(b&&h.Vf){var $a=null!==(x=this.rg.hr.get(null===(n=b.id)||void 0===n?void 0:n.toString()))&&void 0!==x?x:C.a.nil;n=this.Zg.Ika(h.ju,!0);$a.equals(n?n.id:null)&&this.rg.hr.set(null===(E=b.id)||void 0===E?void 0:E.toString(),h.objectId);E=null!==(ma=this.rg.xs.get(null===(S=b.id)||void 0===S?void 0:S.toString()))&&void 0!==ma?ma:C.a.nil;S=this.Zg.Ika(h.Fz,!1);E.equals(S?S.id:null)&&this.rg.xs.set(null===
(Fa=b.id)||void 0===Fa?void 0:Fa.toString(),h.objectId)}}static get Rd(){return null!=bb.xqg?bb.xqg:bb.xqg=Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static Xzb(b){return h=>h.type===b}static mul(){return b=>12===b.type||15===b.type}static Jgh(b,h){return b.Se===h.ssi||b.parentNode&&h.RBi(b.parentNode)?!1:!0}}bb.a3m="Placeholder Text";bb.$2m="Placeholder Text";Object(r.a)(bb,"ContentControlOperator",null,[492,10,493]);class xb{constructor(b,h,n){this.Xc=b;this.px=
h;this.DSb=n}t_h(b){const h=this.qul();return h&&b&&this.GOl(h,b)?this.dNl(h):null}GOl(b,h){if(!b)return!1;do{const n=b.currentNode;if(!n)break;if(n.ia(ic.a.DOl,null)===h)return!0}while(b.wf(29));return!1}dNl(b){var h=b.Rb(1);b.nc();b=b.dE(1);if(!h||!b)return null;h=Ae.SelectionFactory.Eth(h,b);b=Kd.SelectionEditor.ak(h,!1,!1);return Ae.SelectionFactory.MC(h,b.Tc)}qul(){const b=this.Xc.Ck();b.set(this.px.value);this.DSb.tQ(b);return b.Rb(28)&&b.Rb(29)?b:null}}Object(r.a)(xb,"GlossaryNavigator",null,
[491]);class Xb{constructor(b,h,n,x,E,S){this.hs=b;this.Zg=h;this.Qm=n;this.fb=x;this.sh=E;this.Qca=S}kZc(b,h,n){if(!this.Qca)return 1;if(!({tableNode:E}=this.vsf(b)).returnValue||!this.sh.egi(E,h)||this.aLi(b,h))return 2;var x=this.sh.kKh(h);var E=x.J(0).A1b();E&&E.count||(E=new Qa.a,E.add(b.objectId));b=this.Zg.Uwh(x);n=n.split("\n");h=Object(ja.a)(md.GraphIterator,this.Zg.ydf(h));h=this.Zg.l7g(h,b,n.length);for(b=0;b<h.count;++b){x=h.J(b);this.hs.replaceTextRange(Dd.a.createTextRange(x,0,0),n[b]);
for(let S=0;S<E.count;++S)this.hs.Pqa(x,E.J(S),0,!0,!0),this.hs.Pqa(x,E.J(E.count-S-1),x.characterData.length,!0,!1)}return 0}aLi(b,h){if(!this.Qca)return 1;let n;if(!({tableNode:n}=this.vsf(b)).returnValue||!this.sh.egi(n,h))return 2;h=this.sh.kKh(h);if(0<h.count&&(h=this.Qm.KP(Dd.a.create(h.J(0)),Dd.a.create(h.J(h.count-1)),2)))for(let x of h)if(x.id!==b.id&&!this.Qm.tDa(x,!0))return 2;return 0}f7b(b){if(!this.Qca||!({tableNode:n}=this.vsf(b)).returnValue)return!1;b=b.E$e();for(var h of b)if(!h.Pea||
!h.isSupported)return!1;if(this.sh.k9l(n))return!1;var n=Object(ja.a)(md.GraphIterator,this.Zg.ydf(n));h=new Qa.a;this.fb.zdb(n,!0,!1,h);for(let x of h)if(0<x.ia(ic.a.Gyb,0)||this.fb.cYa(x).uw)return!1;return!0}vsf(b){let h=null;return b&&b.ju.toString()===b.Fz.toString()&&b.Qd()&&b.isEditable&&b.isSupported?(h=this.Zg.yu(b.ju))&&14===h.type?{returnValue:!0,tableNode:h}:{returnValue:!1,tableNode:null}:{returnValue:!1,tableNode:h}}}Object(r.a)(Xb,"TableContentControlEditor",null,[490]);class lc{k9l(b){let h=
!1;const n=new md.GraphIterator;n.set(b);$d.forEachCellInTable(n,x=>{if(!Fg.TableCellReader.qg(x)){let E=Te.OutlineNavigator.K6(x);for(;E;){if(Kf.OutlineElementReader.QJd(x))return h=!0,!1;E=x.Vi(1)}}return!0});return h}egi(b,h){const n=new md.GraphIterator;n.set(h);return Fg.TableCellReader.Eta(h)&&n.Bb(14)&&n.kd(14).id===b.id?!0:!1}kKh(b){const h=new Qa.a,n=new md.GraphIterator;n.set(b);b=new Qa.a;Cd.ParagraphReader.zdb(n,!0,!1,b);for(let x of b)h.add(x);return h}}Object(r.a)(lc,"TableReader",null,
[251]);class Bc{constructor(){this.Qm=null}get name(){return"WordEditor.ContentControl"}init(){u.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled")&&(Ut.a.mOa(Object(v.a)(Oa.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator"),Oa.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator").SOm,"onContentControlRangeChanged")),this.Qm=Oa.a.instance.Pa("WordEditor.ContentControl.IContentControlOperator"),vs.a.OBa&&Oa.a.instance.resolve("WordEditor.ContentControl.ContentControlCCP").init())}dispose(){this.Qm&&
(this.Qm.dispose(),this.Qm=null)}zc(b){b.ha("WordEditor.ContentControl.Perf.IPerfLogger",()=>new TB.a(rd.a.lf)).singleInstance();b.ha("WordEditor.ContentControl.ContentControlFactory",()=>new e(Oa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlFactory").singleInstance();b.ha("WordEditor.ContentControlNodeFactory",()=>new hw(Oa.a.instance.Za("Box4.ContentControlConfigSettings"),Oa.a.instance.Za("Box4.ContentControl.IContentControlOperator"))).singleInstance();
b.ha("WordEditor.ContentControl.ContentControlGraphManager",()=>new k(new se.a(()=>ob.App.xa.jb.Zc),new se.a(()=>ob.App.xa.jb.Zc.Ad),new qm.a,ql.PageNavigator.instance,Oa.a.instance.resolve("WordEditor.ContentControlNodeFactory"),Oa.a.instance.resolve("Box4.IOutlineEditor"),Oa.a.instance.resolve("Box4.IOutlineElementEditor"),Oa.a.instance.resolve("Box4.IParagraphReader"),Oa.a.instance.resolve("WordEditor.IParagraphSplitHelper"),Oa.a.instance.Za("Box4.ContentControlConfigSettings"),Oa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlGraphManager").singleInstance();
b.ha("WordEditor.ContentControl.GlossaryNavigator",()=>new xb(new qm.a,new se.a(()=>ob.App.xa.jb.Zc),ql.PageNavigator.instance)).as("WordEditor.ContentControl.IGlossaryNavigator").singleInstance();b.ha("WordEditor.ContentControl.ContentControlOperator",()=>new bb(new se.a(()=>ob.App.xa.jb.Zc),new se.a(()=>ob.App.xa.jb.Zc.Ad),Oa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Oa.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Oa.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),
kh.a.instance,Oa.a.instance.resolve("Box4.ISelectionFactory"),Nd.PageReader.instance,Oa.a.instance.resolve("Box4.IFormattingEditor"),Oa.a.instance.resolve("Box4.Styles.IWACStyleReader"),u.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"),Oa.a.instance.Pa("Box4.IContentControlDataChangedManager"),u.AFrameworkApplication.ya,Oa.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),u.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),Oa.a.instance.resolve("Box4.IContentControlChpHelper"),
Oa.a.instance.Za("Box4.ContentControlConfigSettings"),Oa.a.instance.Pa("Box4.IContentControlReader"),Oa.a.instance.resolve("Box4.IParagraphReader"),Oa.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Oa.a.instance.Za("Box4.Actors.IVirtualSelectionMerger"),Oa.a.instance.resolve("Box4.IFeatureHelper"),Oa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("Box4.ContentControl.IContentControlOperator").as("WordEditor.ContentControl.IContentControlOperator").singleInstance();b.ha("WordEditor.ContentControl.ContentControlManager",
()=>new t(new se.a(()=>ob.App.xa.jb.Zc),new se.a(()=>ob.App.xa.jb.Zc.Ad),Oa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Oa.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Oa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Oa.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),Oa.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),Oa.a.instance.Za("Box4.ContentControlConfigSettings"),
Oa.a.instance.resolve("Box4.IContentControlChpHelper"))).as("WordEditor.ContentControl.IContentControlManager").singleInstance();b.ha("WordEditor.ContentControl.ContentControlChpManager",()=>new gl(Oa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Oa.a.instance.Za("Box4.ContentControlConfigSettings"),Oa.a.instance.resolve("Box4.IParagraphReader"),Oa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlChpManager").singleInstance();b.ha("WordEditor.ContentControl.TableContentControlEditor",
()=>new Xb(Oa.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Oa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Oa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Oa.a.instance.resolve("Box4.IParagraphReader"),new lc,u.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"))).as("WordEditor.ContentControl.ITableContentControlEditor").singleInstance();u.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")&&
b.ha("Box4.ContentControlConverter",()=>new dt(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IContentControlChpHelper"),b.resolve("Box4.IContentControlReader"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.ContentControlParagraphMapping"))).as("Box4.IContentControlConverter").singleInstance();vs.a.OBa&&b.ha("WordEditor.ContentControl.ContentControlCCP",()=>new kB(b.resolve("WordEditor.ContentControl.ContentControlOperator"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),
b.resolve("WordEditor.ContentControl.IContentControlGraphManager"),b.resolve("WordEditor.ContentControl.Perf.IPerfLogger"))).singleInstance()}static main(){N.a.instance.Pc(new Bc)}}Object(r.a)(Bc,"ContentControlPackage",null,[1,2]);var Zc=d(1381),$c=d(1681);class fd extends Sys.EventArgs{constructor(b,h,n){super();this.definition=b;this.source=h;this.Azk=n}}Object(r.a)(fd,"MenuDidCloseEventArgs",Sys.EventArgs,[]);class Zd extends Sys.EventArgs{constructor(b,h){super();this.definition=b;this.source=
h}}Object(r.a)(Zd,"MenuDidOpenEventArgs",Sys.EventArgs,[]);class ze{constructor(b,h,n,x,E,S,ma=!1,Fa=null,$a=null,sb=null,Jb=!1,Sb=null,oc=!1,Ic=!0,gd=null,Gd=!1,vd=9){this.target=this.container=this.menu=null;this.isDismissed=!1;this.HSc=this.rSc=this.tEh=this.onScroll=this.onResize=this.UZ=this.iua=this.NCa=this.documentElement=this.xna=this.editingElement=null;this.isFocused=!1;this.zyd=null;this.EJf=this.cpf=!1;this.Mbe=null;this.UZd=0;this.paragraphNode=b;this.cpBegin=h;this.cpEnd=n;this.definition=
x;this.NZj=E;this.DMa=S;this.ZJa=ma;this.v2i=Fa;this.jka=$a;this.hostServices=sb;this.AUn=Jb;this.GAi=Sb;this.J2i=oc;this.mVk=Ic;this.tEh=gd;this.showDictationCommandUx=Gd;this.source=vd}}Object(r.a)(ze,"UxManagerState",null,[]);var Qc=d(1565);class Vd{constructor(b){this.contextualIntentInvocationSource=9;this.contextualIntentInvocationSource=b}}Object(r.a)(Vd,"UxManagerMenuActionTelemetryData",null,[]);class He{constructor(b,h,n,x,E,S,ma,Fa,$a,sb){this.Wb=b;this.hb=h;this.hz=n;this.Yc=x;this.re=
E;this.Hb=S;this.xi=ma;this.Kj=Fa;this.bS=$a;this.CNb=sb;this.bGe=!1;this._state=this.$Jg=null;this.shouldIgnoreFocusEvent=Jb=>{var Sb;return this.Yc.xd.Rx&&!this.Yc.xd.XN&&Jb===(null===(Sb=this.Yc.editingView)||void 0===Sb?void 0:Sb.editingElement)};this.sa=new Ge.a;this.cvc=new Jc.a;this.bqd((Jb,Sb)=>{He.Swm(n,Sb.definition,Sb.source)});this.y8g((Jb,Sb)=>{He.Rwm(n,Sb.definition,Sb.source,Sb.Azk)});this.Wb.pe(He.jCd).LL=!0}bqd(b){this.sa.addHandler(He.myf,b)}hRf(b){this.sa.removeHandler(He.myf,b)}lcn(b,
h){this.sa.raiseEvent(He.myf,new Zd(b,h))}y8g(b){this.sa.addHandler(He.lyf,b)}opn(b){this.sa.removeHandler(He.lyf,b)}kcn(b,h,n){this.sa.raiseEvent(He.lyf,new fd(b,h,n))}gko(b){if(!b.isDismissed&&b.xna){var h=Qc.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(h&&h.length){h=Qc.b(h);var n=rd.a.getElementBounds(b.xna);h.width||h.height?h.x+h.width<n.x||h.x>n.x+n.width||h.y+h.height<n.y||h.y>n.y+n.height?this.dismiss():(n=b.target,n.style.left=h.x+"px",n.style.top=h.y+"px",n.style.width=h.width+"px",n.style.height=
h.height+"px",b.menu.updatePosition()):(w.ULS.sendTraceTag(50968328,341,15,"Unable to obtain valid updated anchor for UX"),this.dismiss())}else w.ULS.sendTraceTag(50968327,341,15,"Unable to obtain updated anchor for UX"),this.dismiss()}}nHi(b){b.isDismissed||b.Mbe||(b.Mbe=new We.a(2,1,1,()=>{b.Mbe=null;this.gko(b)},147),this.Hb.$b(b.Mbe))}NCa(b,h){!b.isDismissed&&b.mVk&&0<h.iU.length&&(this.dismiss(),w.ULS.sendTraceTag(594363728,341,50,"Menu dismissed from selection change (possibly typing)"))}E9j(b){return!!b&&
b.id===He.RZj}iua(b,h){if(b.isDismissed||!h||!h.Ib)return!1;h=h.Ib;const n=h.keyCode,x=!b.isFocused&&!!b.menu,E=h.altKey||h.ctrlKey||h.shiftKey;let S=!1;n===db.a.L3?(this.dismiss(),w.ULS.sendTraceTag(594363727,341,50,"Dismiss menu from keyboard"),S=!0):n!==db.a.Ks&&n!==db.a.fx||!x||E||!this.E9j(b.definition)?n!==db.a.OLb&&n!==db.a.y3c||!x||E||(this.MMf(b),b.menu?(b.menu.focus(),S=!0,w.ULS.sendTraceTag(594363725,341,50,"Focus menu from keyboard")):w.ULS.sendTraceTag(576582676,341,50,"Began focus menu from keyboard but dismissed before completion")):
(b.menu.executeDefaultAction(),w.ULS.sendTraceTag(594363726,341,50,"Default action from keyboard"),S=!0);S&&(h.preventDefault(),h.stopPropagation());return S}rSc(b,h){if(b.isDismissed)return!1;b.menu.invokeBadgeId(h);w.ULS.sendTraceTag(526463882,341,50,"Badge ID action from dictation correction voice command");return!0}HSc(b,h){if(b.isDismissed)return!1;b.menu.executeActionFromString(h);w.ULS.sendTraceTag(526463883,341,50,"Execute action from dictation correction voice command as string");return!0}UZ(b,
h){if(b.isDismissed||!h||!h.Ib)return!1;const n=b.target;b=b.menu.getElementBounds();var x=h.Ib;h=x.clientX;x=x.clientY;n&&He.qDi(h,x,rd.a.getElementBounds(n),16)||b&&He.qDi(h,x,He.kik(b),4)||this.dismiss();return!1}MOn(b){var h=Qc.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(!h||!h.length)return!1;h=Qc.a(h,"OfficeContextualTarget");if(!h)return!1;b.container=He.SBc();b.target=h;b.editingElement=this.Yc.editingView.editingElement;b.xna=this.Yc.xd.container;b.documentElement=document.documentElement;b.NCa=
(n,x)=>{this.NCa(b,x)};b.iua=n=>this.iua(b,n);b.UZ=n=>this.UZ(b,n);b.onScroll=()=>{this.nHi(b)};b.onResize=()=>{this.nHi(b)};b.showDictationCommandUx&&(b.rSc=n=>this.rSc(b,n),b.HSc=n=>this.HSc(b,n),this.CNb&&this.CNb.execute(n=>{n.pKn(b.rSc);n.rKn(b.HSc)}));document.body.appendChild(b.container);document.body.appendChild(b.target);this.hb.OD(b.NCa);this.xi.i1(b.onResize);this.re.mb(kb.a.KH,b.editingElement,b.iua);b.ZJa&&this.Kj.mb(kb.a.haa,b.documentElement,b.UZ);af.a.addHandler(b.xna,"scroll",b.onScroll);
b.DMa||this.MMf(b);return!0}SAb(b,h){const n=!!b.menu;this.kcn(b.definition,b.source,h);b.container&&document.body.removeChild(b.container);b.target&&document.body.removeChild(b.target);b.isFocused&&this.Wb.xg.name===He.jCd&&this.Wb.GQ(He.jCd);b.NCa&&this.hb.ega(b.NCa);b.iua&&b.editingElement&&this.re.sc(kb.a.KH,b.editingElement,b.iua);this.CNb&&this.CNb.execute(x=>{b.showDictationCommandUx&&(x.Aun(),x.Bun());x.WXi(!1,b.showDictationCommandUx)});b.UZ&&b.documentElement&&b.ZJa&&this.Kj.sc(kb.a.haa,
b.documentElement,b.UZ);b.onScroll&&b.xna&&af.a.removeHandler(b.xna,"scroll",b.onScroll);b.onResize&&this.xi.dga(b.onResize);b.menu=null;b.container=null;b.target=null;b.isDismissed=!0;b.editingElement=null;b.documentElement=null;b.xna=null;b.NCa=null;b.iua=null;b.UZ=null;b.onScroll=null;b.onResize=null;b.rSc=null;b.HSc=null;n&&b.jka&&(b.cpf?b.EJf=!0:b.jka(b.zyd))}wYa(b,h){var n;if(!h)return!1;switch(h.actionType){case Rn.b.Toggle:if(h.objectFulfillment===He.l7n)return this.bGe=!this.bGe,this.i7f(),
this.vyd(b),!0;if(h.objectFulfillment===He.p7n)return{value:n}=this.cvc.Dc(h.suggestionGroup.type,!1),this.cvc.Z(h.suggestionGroup.type,!n),this.vyd(b),!0;break;case Rn.b.GiveFeedback:if(!$c.a.w$l(null===(n=h.suggestionGroup)||void 0===n?void 0:n.type))return this.focus(),this.i7f(),this.vyd(b),!0}b.cpf=!0;h=b.NZj.executeAction(h,b.paragraphNode,b.cpBegin,b.cpEnd);b.cpf=!1;h&&this.vyd(b);b.EJf&&(b.EJf=!1,b.jka(b.zyd),b.zyd=null);return h}vyd(b){b.UZ&&b.documentElement&&b.ZJa&&(this.Kj.sc(kb.a.haa,
b.documentElement,b.UZ),b.ZJa=!1)}uSn(b,h){return!(0<=b.positionInSet&&0<b.setSize)&&!h}Dcj(b){var h;if(this.MOn(b)){var n=1;u.AFrameworkApplication.K.$("RenderMultipleSuggestionGroupsInBranfordIsEnabled")&&(n=3);var x=!1;0<(null===(h=b.definition.suggestionGroups)||void 0===h?void 0:h.length)&&(x=b.definition.suggestionGroups[0].type,x=this.cvc.xb(x)?this.cvc.J(x):b.AUn);h=!1;u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FooterIconsInContextualCardIsEnabled",!1)&&(h=
!0);const E=u.AFrameworkApplication.ya;n={containerElement:b.container,targetElement:b.target,definition:b.definition,onAction:S=>this.wYa(b,S),onDismiss:S=>{this.SAb(b,S)},openCustomDictionaryDialog:()=>E.processAction(ub.a.y0e,2),keepCurrentFocus:b.DMa,preventDismissOnScroll:!0,preventDismissOnResize:!0,showSnippet:this.bGe,showDescription:x,showEditorButton:b.J2i,showEditorBranding:this.uSn(b.definition,b.J2i),hostServices:b.hostServices,maxSuggestionGroupNumber:n,renderFooterIcons:h,shouldIgnoreFocusEvent:this.shouldIgnoreFocusEvent,
keyboardHandlerTarget:b.tEh,showDictationCommandUx:b.showDictationCommandUx,editingElement:b.editingElement};b.GAi&&b.GAi(n);this.hz.createContextualUi(n).then(S=>{this.lcn(b.definition,b.source);b.menu=S;b.v2i&&b.v2i();this.CNb&&this.CNb.execute(ma=>ma.WXi(!0,b.showDictationCommandUx))}).catch(S=>{this.SAb(b,{Rxo:Zc.a.Unknown});w.ULS.sendTraceTag(50631187,341,10,"Failed to show menu. Error: {0}",S)});0<b.UZd&&w.ULS.sendTraceTag(50968329,341,50,"Needed {0} tries to obtain updated anchor for UX",b.UZd)}else 5<
++b.UZd?(w.ULS.sendTraceTag(50968330,341,15,"Unable to obtain initial anchor for UX after maximum tries -- giving up"),this.dismiss()):this.Hb.$b(new We.a(2,1,Math.pow(3,b.UZd),()=>{b.isDismissed||this.Dcj(b)},146))}get YN(){return!!this._state&&!this._state.isDismissed}set z5d(b){this.$Jg=b}get lem(){return this.$Jg}Dfi(b){let h=!1;({value:h}=this.cvc.Dc(b,!1));return h}G6f(b,h){this.YN&&(this._state.cpBegin=b,this._state.cpEnd=h)}get definition(){return this.YN?this._state.definition:null}set definition(b){this.YN&&
(this._state.definition=b,this._state.menu&&this._state.menu.setDefinition(b))}focus(){this.YN&&this._state.menu&&(this._state.isFocused||this.MMf(this._state),this._state.menu.focus())}i7f(){this.YN&&this._state.menu&&this._state.menu.updatePosition()}MMf(b){this.Wb.nK(He.jCd,!1);b.isFocused=!0}A2a(b,h,n,x,E,S=null,ma=null,Fa=null,$a=!1,sb=null,Jb=!1,Sb=!0,oc=null,Ic=!1,gd=9){if(!h||this._state&&!this._state.isDismissed)return!1;let Gd,vd;if(!({paragraphNode:vd,start:b,end:Gd}=He.i$n(b)).returnValue)return!1;
this._state=new ze(vd,b,Gd,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd);this.Dcj(this._state);return!0}i5d(){this._state&&(this._state.zyd=!0)}dismiss(){var b;this._state&&(this._state.isDismissed=!0,null===(b=this._state.menu)||void 0===b?void 0:b.dismiss())}static Swm(b,h,n){n=new Vd(n);b.logAction({actionType:Rn.b.SessionStart,engagement:Rn.a.Try,objectName:He.l9i,objectId:h.id,data:n});if(h.suggestionGroups)for(let x of h.suggestionGroups)b.logAction({actionType:Rn.b.Presented,engagement:Rn.a.See,objectName:x.type,
objectId:x.id,data:n})}static Rwm(b,h,n,x){n=new Vd(n);b.logAction({actionType:Rn.b.SessionEnd,engagement:Rn.a.None,objectName:He.l9i,objectId:h.id,data:n},x)}static SBc(){const b=document.createElement("div");b.id="OfficeContextualContainer";return b}static kik(b){return new Sys.UI.Bounds(b.left,b.top,b.width,b.height)}static qDi(b,h,n,x){const E=n.y-x,S=n.x+n.width+x,ma=n.y+n.height+x;return n.x-x<=b&&b<=S&&E<=h&&h<=ma}static i$n(b){let h,n;if(!b||!Cd.ParagraphReader.oc(b.node)||b.contextId!==cc.a.Wc&&
b.contextId!==cc.a.Fd&&b.contextId!==cc.a.paragraph)return{returnValue:!1,paragraphNode:null,start:-1,end:-1};n=b.node;b.contextId!==cc.a.paragraph?(h=b.cpBegin,b=b.cpEnd):(h=0,b=n.characterData.length);return{returnValue:!0,paragraphNode:n,start:h,end:b}}sQc(){this.bS&&this.bS.execute(b=>{b.logActivity("WordWebEditorSeen",null)})}}He.RZj="ActionSet";He.l9i="IntentGroup";He.jCd="CanvasContextualUxReact";He.l7n="Context";He.p7n="Description";He.myf="MenuDidOpen";He.lyf="MenuDidClose";Object(r.a)(He,
"UxManager",null,[]);class of{constructor(){this.W=null}get name(){return"WordEditor.CanvasContextualProvider"}zc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Nm()})}Nm(){u.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");const b=u.AFrameworkApplication.K.$("EditorGoalsEnabled");(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(66)||u.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")||u.AFrameworkApplication.K.$("RewriteIsEnabled")||
u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&(u.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasContextual"):this.W.resolve("Common.IDynamicScriptLoaderProvider").tE.loadScript("canvasContextual")).then(()=>{this.W.ha("CanvasContextual.ICanvasContextualController",()=>canvasContextual.FactoryGlobal.getWordContextualControllerInstance({uiCulture:u.AFrameworkApplication.uiCulture,dataCulture:u.AFrameworkApplication.dataCulture,
isRightToLeft:u.AFrameworkApplication.isRtl,ulsLogger:new ml.a})).singleInstance();this.W.ha("WordEditor.CanvasContextualProvider.UxManager",()=>new He(de.FocusManager.instance(),this.W.resolve("Box4.ISelectionManager"),this.W.resolve("CanvasContextual.ICanvasContextualController"),cb.InteractiveViewManager.instance,mc.KeyInputManager.instance,u.AFrameworkApplication.uc,u.AFrameworkApplication.ua,u.AFrameworkApplication.ua.C_,this.W.Za("Common.ISystemInitiatedFeedback"),this.W.Za("WordEditor.DictationCommands.CorrectionCommandUxStateManager"))).singleInstance();
this.W.resolve("CanvasContextual.ICanvasContextualController");this.W.resolve("WordEditor.CanvasContextualProvider.UxManager");b&&(this.W.ha("CanvasContextual.IEditorInitializer",()=>canvasContextual.FactoryGlobal.getEditorInitializerInstance({uiCulture:u.AFrameworkApplication.uiCulture,ulsLogger:new ml.a})).singleInstance(),this.W.resolve("CanvasContextual.IEditorInitializer").init(),this.W.ha("CanvasContextual.ISkittleControllerV2",()=>canvasContextual.FactoryGlobal.getSkittleControllerV2Instance({ulsLogger:new ml.a})).singleInstance(),
this.W.resolve("CanvasContextual.ISkittleControllerV2"))}).catch(h=>{w.ULS.sendTraceTag(50422751,341,10,"CanvasContextualProvider - Failed to load Canvas Contextual script. Error: {0}",h)})}dispose(){}static main(){N.a.instance.Pc(new of)}}Object(r.a)(of,"PackageManager",null,[1,2]);class Eg{constructor(b,h,n,x){this.L3l=(E,S,ma)=>{E=null;S.view.Be&&(E=S.view);if(!E||!E.Cb)return 8;if(!this.jG.Ypf())return 2;if(1===ma)return 32;this.VOj.YGk();return 32};this.Yni=(E,S,ma)=>{let Fa=null;S.view.Be&&
(Fa=S.view);if(!Fa||!Fa.Cb)return 8;if(!this.jG.Ypf())return 2;if(1===ma)return 32;if(1!==this.jG.Z2b(this.hb.ib,!0).count)return 2;S=new Se.GraphTransaction(15);try{if(S.Db(Fa.ud),!this.jG.mao(E===ub.a.Hxf))return 8}finally{S&&S.dispose()}return 32};this.ga=b;this.hb=h;this.jG=n;this.VOj=x}Vb(){this.ga.pa(ub.a.zLd,cc.a.view,this.L3l);this.ga.pa(ub.a.Hxf,cc.a.view,this.Yni);this.ga.pa(ub.a.Zni,cc.a.view,this.Yni)}}Object(r.a)(Eg,"IntelligentPlaceholderActor",null,[]);class ii{constructor(){this.hjc=
new Jc.a;this.n7c=new Jc.a}D_j(b,h){let n;({value:n}=this.hjc.Dc(b,n)).returnValue||this.hjc.Z(b,n=new Pa.a);n.add(h)}i0j(b,h){this.n7c.xb(b)&&w.ULS.sendTraceTag(50954435,323,15,"Comment ID already exists for bookmark");this.n7c.Z(b,h)}B_j(b,h,n){this.D_j(b,h);this.i0j(h,n)}whl(b){let h;return({value:h}=this.hjc.Dc(b,h)).returnValue?h:null}gkl(b){let h;return({value:h}=this.n7c.Dc(b,h)).returnValue?h:null}Xon(b){let h;if(({value:h}=this.hjc.Dc(b,h)).returnValue){for(let n of h)this.n7c.remove(n);
this.hjc.remove(b)}else w.ULS.sendTraceTag(50954436,323,15,"No bookmarks found for user ID")}}Object(r.a)(ii,"IntelligentPlaceholderAtMentionManager",null,[501]);class Mk{constructor(b,h){this.GM=this.Orc=null;this.fb=b;this.p5a=h}get key(){return"COMMENT"}get hw(){return WordEditorIntl.WordEditorStrings.L_Comment}get $ja(){return this.GM}reset(b){this.GM=b.node}DEa(b){let h=null;if(this.Orc&&this.Q$h(b,this.$ja,this.Orc))return h=Object.assign(new zt.a,{IF:this.key,contentObject:this.Orc}),{returnValue:!0,
KE:h};this.Orc=null;const n=this.p5a.MZe(this.$ja);if(this.p5a.dof(n)){let x=n.Wd();for(;x;){if(this.Q$h(b,this.$ja,x))return this.Orc=x,h=Object.assign(new zt.a,{IF:this.key,contentObject:x,description:this.Zcb()}),{returnValue:!0,KE:h};x=n.xj()}}return{returnValue:!1,KE:h}}Q$h(b,h,n){if(this.Z1i(n))return!1;const x=this.p5a.d3b(n,!0),E=this.p5a.d3b(n,!1);return x&&E&&this.fb.QNc(h,x,E)&&(h=this.p5a.zsa(x,n.id,!0))&&(x!==this.$ja||h.Ob.cp<=b)&&(n=this.p5a.zsa(E,n.id,!1))&&(E!==this.$ja||n.Ob.cp>
b||n.Ob.cp>=b)?!0:!1}Z1i(b){return b.ia(ic.a.AF,!1)}Zcb(){return null}}Object(r.a)(Mk,"CommentDetailsProvider",null,[226,227]);class ph extends Mk{constructor(b,h){super(b,h)}get key(){return"FOLLOW UP"}get hw(){return WordEditorIntl.WordEditorStrings.L_IntelligentPlaceholder}Z1i(b){return!b.ia(ic.a.AF,!1)}Zcb(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}}Object(r.a)(ph,"IntelligentPlaceholderDetailsProvider",Mk,[]);var sj=d(1740),Qh=d(1888),yh=d(1744);class Gh{constructor(){this.xwa=
""}Kea(b){this.xwa+=b}y7h(b){this.xwa+=b}smf(b){this.xwa+=b}insertImage(b){this.xwa+=b}m7h(b){this.xwa+=b}}Object(r.a)(Gh,"PlainTextFormatCreator",null,[857]);var di=d(1557),Zk=d(1887),Fr=d(382),ns=d(1609),td=d(1471);class Xd{constructor(){this.Blc=new Jc.a}contains(b){return this.Blc.xb(Xd.Ftf(b))}add(b){this.Blc.Z(Xd.Ftf(b),b)}remove(b){this.Blc.remove(Xd.Ftf(b))}aco(b){for(let h of b.Blc)this.add(h.value)}oEh(){const b=new Qa.a;for(let h of this.Blc)b.add(h.value.Oj);return b}static Ftf(b){return b.Oj.toString()}}
Object(r.a)(Xd,"CommentRangeSet",null,[]);class hj extends Sys.EventArgs{constructor(b){super();this.commentNode=b}}Object(r.a)(hj,"OnFollowUpEventArgs",Sys.EventArgs,[]);class ht extends hj{constructor(b,h){super(b);this.Z2m=h}}Object(r.a)(ht,"OnCreateEventArgs",hj,[]);class op extends hj{constructor(b,h){super(b);this.ihm=h}}Object(r.a)(op,"OnResolveEventArgs",hj,[]);var Ku=d(222);class Ns{}Ns.Sde="MentionExperienceDegraded";Object(r.a)(Ns,"AtMentionsConstants",null,[]);class Os{constructor(b,h,
n,x,E,S,ma,Fa,$a,sb){this.uTd=b;this.dek=h;this.k1c=n;this.Tsd=x;this.Cb=E;this.Du=S;this.TLd=ma;this.b8h=Fa;this.fw=$a;this.Cyc=sb;this.QNa=null;(b=Oa.a.instance.Pa("Box4.IEditStateEventManager"))&&b.addHandler(Ku.a.yya,this.Zvn.bind(this))}hrf(){return!!this.QNa}Zvn(){this.hrf()&&this.Wih&&(this.QNa.updateInputText(this.Ytf,!1),this.Wih=!1)}ariaNotify(b,h){this.fw.sendNotification(b,h)}w2j(){const b=this.Du.editingView.editingElement;if(b){var h=b.getAttribute(qf.a.syc);b.setAttribute(qf.a.syc,
h?h.toString()+" PeoplePickerAutomationID":"PeoplePickerAutomationID")}else w.ULS.sendTraceTag(51218125,323,15,"Cannot find editing element")}pon(){const b=this.Du.editingView.editingElement;if(b){var h=b.getAttribute(qf.a.syc);h?(h=h.toString().split(" "),Array.remove(h,"PeoplePickerAutomationID"),h.length?b.setAttribute(qf.a.syc,h.join(" ")):b.removeAttribute(qf.a.syc)):w.ULS.sendTraceTag(51218127,323,50,"No aria-controls when dismissing picker?")}else w.ULS.sendTraceTag(51218126,323,15,"Cannot find editing element")}Wtk(){this.pon();
this.QNa&&this.QNa.updateInputText("a",!0);const b=document.getElementById("PeoplePicker");b&&document.body.removeChild(b);this.QNa=null;this.b8h.dXi(!0)}sUm(b,h,n){w.ULS.sendTraceTag(41178053,323,50,"@ mention selected, callback to replace text");b=this.TLd.iZa(b,n.displayName,n.email,n.id);this.ariaNotify(String.format(WordEditorIntl.WordEditorStrings.L_AtMentionsSuggestionSelected,h),!0);b?w.ULS.sendTraceTag(558113739,323,50,"Successfully inserted at mentions"):this.Cyc.logKpiFailure("LPPWordEditorKPI",
"FailedToInsertAtMention",{isInternal:!0},{name:Ns.Sde,isInternal:!0})}uTm(b,h){w.ULS.sendTraceTag(50954434,323,50,"Permissions received for entity");h&&this.Cyc.KB(ub.a.pqk);this.TLd.ZRl(b.id,h)}EPm(){this.Du.xd.Rx&&!this.Du.xd.XN&&this.Du.editingView.o4e?this.Wih=!0:(this.uTd.reset(),w.ULS.sendTraceTag(41178054,323,50,"People picker dismissed off canvas"))}BVm(){w.ULS.sendTraceTag(41178055,323,50,"People picker shown on canvas");this.w2j()}tTm(b,h,n,x=new Map){x=Object.assign(new ab.a,{extendedProperties:x});
this.Cyc.logKpiFailure("LPPWordEditorKPI",b,{isIntentional:h,isInternal:n,additionalValues:x},{name:Ns.Sde,errorNameOverride:"LPPFailedToInsertAtMention",isIntentional:h,isInternal:n,additionalValues:x})}FKi(){this.uTd.NKi(()=>{this.Wtk()});this.uTd.AKi((b,h)=>{this.Ytf=b;if(this.QNa)this.QNa.updateInputText(this.Ytf,!1);else if(this.Cyc.logKpiUsage("LPPWordEditorKPI",0),this.Cyc.KB(ub.a.GXm),(b=this.Osl(h))&&b.height){h=b.y;const n=b.height,x=document.createElement("div");x.id="PeoplePicker";x.style.position=
"absolute";x.style.top=h-5+"px";x.style.left=b.x+"px";x.style.height=n+10+"px";document.body.appendChild(x);b={editingElementId:this.Du.editingView.editingElement.id,containerElement:x,automationID:"PeoplePickerAutomationID",onReplaceTextCallback:Object(v.a)(this,this.sUm,"onReplaceTextFromPicker"),onPermissionsReceivedCallback:Object(v.a)(this,this.uTm,"onPermissionsReceivedFromPicker"),onDismiss:Object(v.a)(this,this.EPm,"onDismissPicker"),onShow:Object(v.a)(this,this.BVm,"onShowPicker"),onFailure:Object(v.a)(this,
this.tTm,"onPeoplePickerServiceFailure")};this.dek.createPeoplePicker(b).then(E=>{E.updateInputText(this.Ytf,!1);this.QNa=E;this.b8h.dXi(!1)})}});this.uTd.BKi(b=>{if(this.QNa)this.QNa.onKeyDown(b.Ib.rawEvent)})}Osl(b){var h=this.Cb.ib;if(!h)return null;h=h.kb;if(!h)return null;h=h.Qa;if(!h)return null;h=h.node;if(!h)return null;h=Object(ja.a)(62,h);if(!h)return null;h=Object(ja.a)(182,h.Ui(this.Du.xd.Tb));if(!h)return null;h=Object(ja.a)(80,h);if(!h)return null;let n=null;try{n=this.k1c.UY(this.Tsd.D1b(2,
b),h,!1,!1,!1,!1)}catch(x){w.ULS.sendTraceTag(41178056,323,15,"Failed to get ip bounds due to exception {0}, will use fallback value.",x)}return n}}Object(r.a)(Os,"WordEditorAtMentionsHandler",null,[295]);var mk=d(1462),vA=d(1028);class Tq{static x9n(b){vA.a.rpf()&&(ag.TableReader.JNc(b)?Tq.g_f(Tq.MEm):ec.ListReader.Nla(b)&&Tq.g_f(Tq.LEm))}static g_f(b){var h;null!==(h=u.AFrameworkApplication.K)&&void 0!==h&&h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsTUIEnabled",!1)&&(Tq.Ici||Tq.addEventListener(),
(h=Oa.a.instance.Za("Common.ISystemInitiatedFeedback"))&&h.execute(n=>{n.logActivity(b,null)}))}static addEventListener(){window.addEventListener(Tq.F2n,Tq.E2n,!0);Tq.Ici=!0}}Tq.F4n="LoopsTeachingCalloutOnInsertTabActivity";Tq.F2n="switchToInsertTabEvent";Tq.LEm="mentionWithinListActivity";Tq.MEm="mentionWithinTableActivity";Tq.Ici=!1;Tq.E2n=()=>{appChrome.api.dispatch(appChrome.actions.setCurrentTab("Insert"))};Object(r.a)(Tq,"FluidComponentsTUIHelper",null,[]);class rq{constructor(b,h,n,x,E,S,ma,
Fa,$a,sb,Jb,Sb,oc,Ic,gd){this.ga=b;this.Xc=h;this.m8a=n;this.hb=x;this.Ap=E;this.Vd=S;this.mC=ma;this.Wbd=Fa;this.Hd=$a;this.Tm=sb;this.Duj=Sb;this.zi=oc;this.Hc=Jb;this.sa=new Ge.a;this.Xe=Ic;this.Ktg=gd;td.a.UNe((Gd,vd)=>{this.AF(vd.commentNode,!0)&&this.sa.raiseEvent(rq.CSc)})}N8g(b){this.sa.addHandler(rq.Wui,b)}A6j(b){this.sa.addHandler(rq.Yxi,b)}i6j(b){this.sa.addHandler(rq.nSm,b)}UNe(b){this.sa.addHandler(rq.CSc,b)}AF(b,h){let n=b.ia(ic.a.AF,!1);h&&(n=n&&!b.ia(ic.a.x9,!1));return n}m6b(b){return this.Ap.m6b(b)}gzl(b){for(let h of b)for(let n of h)if(rq.Rsf(n.contextId))return n.node.Nc;
return null}hGl(b,h,n){const x=new Xd,E=b.Nc;for(let S=0;S<b.qa.length;S++){const ma=b.qa.J(S);if(ma.cp>=h)break;if(ma.Ff&&ma.Ff.length)for(let Fa=0;Fa<ma.Ff.length;Fa++){const $a=ma.Ff.J(Fa);this.AF(E.Eb($a.Oj),n)&&($a.Oc?x.add($a):x.remove($a))}}return x}iGl(b,h,n,x){const E=new Xd,S=b.Nc;for(let ma=0;ma<b.qa.length;ma++){const Fa=b.qa.J(ma);if(Fa.cp>n)break;if(Fa.Ff&&Fa.Ff.length)for(let $a=0;$a<Fa.Ff.length;$a++){const sb=Fa.Ff.J($a);this.AF(S.Eb(sb.Oj),x)&&(sb.Oc?Fa.cp<n&&E.add(sb):Fa.cp<=h&&
E.remove(sb))}}return E}cXh(b,h){let n;const x=b.node;b.contextId!==cc.a.paragraph?(n=b.cpBegin,b=b.cpEnd):(n=0,b=x.characterData.length);return n===b?this.hGl(x,n,h):this.iGl(x,n,b,h)}MIc(b,h){return rq.Rsf(b.contextId)?this.cXh(b,h).oEh():new Qa.a}Z2b(b,h){const n=new Xd;for(let x of b)for(let E of x)rq.Rsf(E.contextId)&&n.aco(this.cXh(E,h));return n.oEh()}Ypf(){var b=this.hb.ib;if(!b||1!==b.length||1!==b.J(0).length)return!1;b=b.J(0).Qa.node;return Cd.ParagraphReader.oc(b)&&!Cd.ParagraphReader.zra(b)&&
this.Ap.mfb(this.ga,!0)?!0:!1}o7h(b,h){if(!this.Ypf())return null;if(this.Ap.UTl())return w.ULS.sendTraceTag(592761861,323,15,"Placeholder insertion failed because of draft comment"),null;let n=!1;var x=this.hb.ib.J(0).Qa;x.contextId===cc.a.Wc?(b=b?Kd.SelectionEditor.Q1(x,!1):null)&&b.VD&&b.Qa.contextId===cc.a.Fd?this.hb.setSelection(b):(this.Vd.replaceTextRange(x,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText+" ",!0),this.hb.setSelection(Ae.SelectionFactory.wN(x.node,x.cpBegin,
x.cpBegin+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText.length))):n=!0;this.Xe.Gxb||sj.a.instance.zLc();b=this.Ap.Ywb(this.hb.ib.kb);if(!b)return null;this.m6b(b)&&this.Ktg.KB(Ra.a.newComment,{succeeded:!0,nLb:29});var E=this.Xc.pg(b);const S=E.Rb(1);if(!S||393229!==S.Qc)return null;E=E.Rb(2);if(!E||393230!==E.Qc)return null;this.C6f(b.Nc,b.id);this.sa.raiseEvent(rq.Wui,new ht(b,h));n&&(h=x.node,x=x.contextId!==cc.a.paragraph?x.cpEnd:h.characterData.length,this.hb.setSelection(Ae.SelectionFactory.wN(h,
x,x)));return b}zLd(b){return!!this.o7h(!0,b)}Emf(b,h,n,x,E,S){if(0>h)return!1;x="@"+x;const ma=x+" ",Fa=new Se.GraphTransaction(15);try{Fa.Db(b);this.Vd.replaceTextRange(Dd.a.createTextRange(b,h,n),ma);this.Hd.wg&&(this.Tm.LVe(b,h,h+x.length),this.Tm.Hna(b,h+x.length,h+ma.length,1));const $a=this.mC.DG(Dd.a.createTextRange(b,h,h+x.length),"mailto:"+E,!1,!0,!1);if(!$a)return!1;const sb=$a.Bx;if(!sb)return w.ULS.sendTraceTag(51217483,323,15,"Insertion of IntelligentPlaceholderWithMention failed"),
!1;this.hb.setSelection(Ae.SelectionFactory.wN(b,h,h+x.length));let Jb=this.o7h(!1,2);if(!Jb)return!1;S&&this.Wbd.B_j(S,sb,Jb.id);this.hb.setSelection(Ae.SelectionFactory.xe(b,h+ma.length));Tq.x9n(b)}finally{Fa&&Fa.dispose()}return!0}iZa(b,h,n,x){const E=this.hb.Rg;return Kd.SelectionEditor.xf(E)?this.Emf(E.node,E.cpBegin-b,E.cpBegin,h,n,x):!1}lCl(b){if(1===b.length&&b.J(0).VD&&(b=b.J(0).Qa,b.contextId===cc.a.Wc&&Cd.ParagraphReader.oc(b.node))){const h=b.node;for(let n=0;n<h.qa.length;n++){const x=
h.qa.J(n);if(x.cp===b.cpBegin){b=x.vGd(!0,!0);if(0<b.length)return b[0].Oj;break}}}return null}Mwb(b,h,n){return this.Ap.LBc(b,h,n).returnValue}cDd(b,h,n,x,E){let S=!1;const ma=b.characterData;if(h>=ma.length||n>ma.length||n<h)return{returnValue:!1,EKa:S};let Fa=h,$a=null;for(let Jb=0;Jb<b.qa.length;Jb++){const Sb=b.qa.J(Jb),oc=Sb.cp;if(!(oc<h)){if(Sb.vl&&$a)try{const Ic=ma.substring(Fa,oc),gd=new Qh.a;gd.fullName=Ic.startsWith("@")?Ic.substr(1):Ic;ns.a($a,gd);const Gd=new yh.a;ns.b($a,Gd);E&&(Gd.contentId=
this.Duj.a$e());x.smf(Ic,gd,Gd);S=!0;$a=null;Fa=oc}catch(Ic){var sb=Object.assign(new ab.a,{extendedProperties:new Map});sb.extendedProperties.set("exception",Ic.message);this.Ktg.logKpiFailure("LPPWordEditorKPI","FailedToRenderAtMention",{isInternal:!0,additionalValues:sb},{name:Ns.Sde,isInternal:!0,additionalValues:sb})}oc<=n&&!$a&&(sb=Math.min(oc,n),sb>Fa&&x.Kea(ma.substring(Fa,sb)),Fa=oc);Sb.hyperlink&&Sb.hyperlink.zF&&($a=Sb.hyperlink);if(oc>=n)break}}return{returnValue:!0,EKa:S}}wKh(b,h,n,x,
E=-1){var S=!1,ma=b.Eb(h),Fa=b.Eb(mk.k(ma));ma=b.Eb(mk.h(ma));E=0<E?E:Number.MAX_VALUE;b=this.Mwb(Fa,h,!0);h=this.Mwb(ma,h,!1);if(-1===b||-1===h)return{returnValue:!1,EKa:S};if(Fa===ma)return this.cDd(Fa,b,h,n,x);const $a=this.m8a.Vwb(Fa,!1,!1);if(!$a)return{returnValue:!1,EKa:S};Fa=new Qa.a;let sb=0;do Fa.add($a.oB),sb+=$a.oB.characterData.length;while($a.oB!==ma&&$a.SAa()&&sb<E);for(E=0;E<Fa.count;E++)if(S=Fa.J(E),ma=S.characterData,E)if(E===Fa.count-1){if(!({EKa:S}=this.cDd(S,0,h,n,x)).returnValue)return{returnValue:!1,
EKa:S}}else{if(!({EKa:S}=this.cDd(S,0,ma.length,n,x)).returnValue)return{returnValue:!1,EKa:S};n.Kea("\n")}else{if(!({EKa:S}=this.cDd(S,b,ma.length,n,x)).returnValue)return{returnValue:!1,EKa:S};n.Kea("\n")}return{returnValue:!0,EKa:S}}bDd(b,h){const n=new Gh;return this.wKh(b,h,n,!1,-1).returnValue?n.xwa:null}CAd(b,h){var n=b.Eb(h);if(!n)return null;b=b.Eb(mk.h(n));if(!b)return null;h=this.Mwb(b,h,!1);if(-1===h)return null;n=b.characterData;if(h>=n.length||!B.a.V$(n.charAt(h))){n=this.Hc.Rc(15);
try{n.Db(b),this.Vd.replaceTextRange(Dd.a.Uc(b,h)," ")}finally{n&&n.dispose()}}return Ae.SelectionFactory.xe(b,h+1)}C6f(b,h){const n=b.Eb(h),x=new di.a;this.wKh(b,h,x,!0).returnValue&&(x.Kea("\n"),this.Ap.Cej(n,x.e8),this.sa.raiseEvent(rq.OWm))}kCn(b,h){for(let n of b){if(n.contains(h))return!0;for(let x of n)for(let E of h)if(x.node===E.node&&x.gl>=E.gl)return!0}return!1}Fwh(b,h,n,x,E){const S=this.hb.ib.clone(),ma=new fi.a(ob.App.xa.jb.Jc);b=Ae.SelectionFactory.xe(b,h);n=Dd.a.Uc(n,x);b=Ae.SelectionFactory.MC(b,
n);this.hb.setSelection(b);n=!this.kCn(S,b);return 32===this.ga.Qf(ma,Db.a.HG,2,!0,null,null)?(n?this.hb.CX(S):E!==C.a.nil&&(E=this.CAd(this.zi.value,E),this.hb.setSelection(E)),!0):!1}$mn(b,h){var n=b.Eb(h);const x=b.Eb(mk.k(n));b=b.Eb(mk.h(n));if(x===b){n=" "+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText;var E=x.characterData.indexOf(n);-1!==E&&this.Fwh(x,E,b,E+n.length,h)}}Nwh(b,h,n){var x=b.Eb(h);if(!x)return!1;const E=b.Eb(mk.k(x));b=b.Eb(mk.h(x));x=this.Mwb(E,h,!0);
const S=this.Mwb(b,h,!1);if(-1===x||-1===S||!this.Fwh(E,x,b,S,C.a.nil))return!1;n&&this.Wwh(h);return!0}Wwh(b){this.Ap.NQf(b,!0)}mao(b){var h=this.gzl(this.hb.ib);if(!h)return!1;const n=this.Z2b(this.hb.ib,!0);if(1!==n.count)return!1;const x=h.Eb(n.J(0));if(b)h=this.Nwh(h,n.J(0),!1);else{const E=mk.k(x),S=mk.h(x);C.a.Dp(E,S)||w.ULS.sendTraceTag(592487139,323,15,"User attempted to resolve comment that spans more than 1 paragraph");this.GDk(n.J(0));h.Eb(E).Sj(16,!0);h=!0}h&&(x.setValue(ic.a.x9,!0),
this.sa.raiseEvent(rq.Yxi,new op(x,b)));return h}Qdh(b,h){b=this.Z2b(this.hb.ib,!1);h.xo[rq.uyh]=!!b.count}lwi(b,h){if(h.xo[rq.uyh]&&Cd.ParagraphReader.oc(h.clone)&&(h=h.clone,b=h.Nc)&&(h=Dd.a.createTextRange(h,0,h.characterData.length),h=this.MIc(h,!1),h.count))for(let n of h)(h=b.Eb(n))&&h.setValue(ic.a.AF,!1)}Wll(b,h,n){let x;const E=({bAc:$a}=this.Ap.LBc(h,n,!0)).returnValue;n=({bAc:x}=this.Ap.LBc(h,n,!1)).returnValue;let S=null,ma=-1,Fa=-1;for(;$a<x;$a++){let sb=h.qa.J($a);if(sb.hyperlink&&sb.hyperlink.zF&&
sb.hyperlink.Bx===b){S=sb.hyperlink;ma=sb.cp;break}}if(!S||ma<E)return{returnValue:!1,Yqh:ma,Xqh:Fa};for(b=$a;b<h.qa.length;b++){var $a=h.qa.J(b);if($a.cp>n)break;if($a.oT){Fa=$a.cp;break}}return{returnValue:-1!==Fa,Yqh:ma,Xqh:Fa}}Wnn(b){var h=this.Wbd.gkl(b);if(h){var n=null;ob.App.xa&&(n=ob.App.xa.jb.Zc.Ad);if(n){var x=n.Eb(h);h=n.Eb(mk.k(x));var E=n.Eb(mk.h(x));if(h!==E)w.ULS.sendTraceTag(50954439,323,10,"Mention bookmark has no associated comments");else if(({Yqh:b,Xqh:E}=this.Wll(b,h,x.id)).returnValue){var S=
new Se.GraphTransaction(7);try{S.Db(h);let ma=Dd.a.createTextRange(h,b,E);this.Vd.replaceTextRange(ma,"");this.C6f(n,x.id)}finally{S&&S.dispose()}this.hb.ib&&0<this.hb.ib.length?(n=this.hb.ib.J(0).Qa,n.node===h?w.ULS.sendTraceTag(50954441,323,50,"Moving from cp {0} to {1}",n.cpBegin,b):w.ULS.sendTraceTag(50954442,323,50,"Moving selection to a different node")):w.ULS.sendTraceTag(50954443,323,50,"Unable to find selection start after deleting mention");this.hb.setSelection(Ae.SelectionFactory.xe(h,
b))}else w.ULS.sendTraceTag(50954440,323,15,"Unable to compute hyperlink CPs for bookmark")}else w.ULS.sendTraceTag(50954438,323,15,"Unable to find object space for removing mention")}else w.ULS.sendTraceTag(50954437,323,15,"Mention bookmark has no associated comments")}ZRl(b,h){if(!h){h=this.Wbd.whl(b);if(!h){w.ULS.sendTraceTag(50954444,323,15,"No bookmarks found for userId");return}for(let n of h)this.Wnn(n)}this.Wbd.Xon(b)}sfl(){sj.a.instance.zLc();const b=new Qa.a;for(let n of this.Ap.SOe)if(n.Qq!==
Zk.a.beingCreated){var h=C.a.Of(n.objectId);h=this.zi.value.Eb(h);this.AF(h,!0)&&b.add(h)}return b}NBn(b){b=this.Ap.dgf(b);this.hb.setSelection(b)}GDk(b){b?this.zi.value.Eb(b).setValue(ic.a.AF,!1):w.ULS.sendTraceTag(594043491,323,10,"The given intelligent placeholder guid is null")}static Rsf(b){return b===cc.a.Fd||b===cc.a.Wc||b===cc.a.paragraph}}rq.uyh="DisableNestedIntelligentPlaceholder";rq.Wui="CreateIntelligentPlaceholder";rq.Yxi="ResolveIntelligentPlaceholder";rq.OWm="UpdateIntelligentPlaceholder";
rq.CSc="DeleteIntelligentPlaceholder";rq.nSm="MentionAddedToFollowUpEventKey";Object(r.a)(rq,"IntelligentPlaceholderEditor",null,[502,503,504]);class Ps{constructor(b,h,n,x){this.Gpa=!1;this.Pl=!0;this.re=null;this.I$a=E=>{if(!this.Pl||!this.qpk(E,this.hb.ib))return!1;E.Ib.preventDefault();E.Ib.stopPropagation();this.Yc.xd&&this.Yc.xd.CEc(!1);E=this.CAd(this.hb.ib);if(!E)return!1;this.hb.setSelection(E);return!0};this.Yc=b;this.zi=h;this.hb=n;this.H4=x}Lyc(b,h){this.Gpa||(b.fta?(this.J$a(h),this.Gpa=
!0):b.Zca(()=>{this.Gpa||(this.J$a(h),this.Gpa=!0)}))}dispose(){this.re&&this.re.sc(kb.a.KH,this.Yc.editingView.editingElement,this.I$a)}J$a(b){this.re=b;this.Yc.xd.Ji&&this.re.mb(kb.a.KH,this.Yc.editingView.editingElement,this.I$a)}qpk(b,h){if(b.Ib.keyCode!==db.a.fx&&b.Ib.keyCode!==db.a.Ks||1!==h.length||!h.J(0).VD)return!1;var n=this.H4.Z2b(h,!0);if(1!==n.count)return!1;const x=h.J(0).Qa.node;if(!Cd.ParagraphReader.oc(x))return!1;b=this.H4.Mwb(x,n.J(0),!0);n=this.H4.Mwb(x,n.J(0),!1);return h.J(0).Qa.cpBegin<
b||h.J(0).Qa.cpEnd>n?!1:!0}CAd(b){b=this.H4.Z2b(b,!0);if(1!==b.count)return null;b=b.J(0);return this.H4.CAd(this.zi.value,b)}dXi(b){this.Pl=b}}Object(r.a)(Ps,"IntelligentPlaceholderKeyboardListener",null,[500,10]);class Jv{constructor(b,h){this.n5l=n=>{1===n&&this.ga.processAction(Ra.a.newComment,2);2===n&&(this.UXg.instance?this.UXg.instance.tgc("https://go.microsoft.com/fwlink/?linkid=2154656")&&B.a.RW("https://go.microsoft.com/fwlink/?linkid=2154656")&&window.open("https://go.microsoft.com/fwlink/?linkid=2154656",
"_blank"):w.ULS.sendTraceTag(556794450,323,15,"IntelligentPlaceholderPhaseOut Dialog's SafeLinkManager was not ready"));n=[Object.assign(new ca.a,{name:"DialogResult",int64:n})];Pe.d(ub.a.UHh,void 0,void 0,void 0,void 0,void 0,n)};this.ga=b;this.UXg=h}YGk(){const b=new yd.StandardDialog;b.Ed=11;b.We(1,WordEditorIntl.WordEditorStrings.L_TryIt);b.We(2,WordEditorIntl.WordEditorStrings.L_LearnMore);b.Lv(WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsHeader,WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsContent,
0,this.n5l);Pe.a("FollowUpsPhaseOutDialogShown")}}Object(r.a)(Jv,"IntelligentPlaceholderPhaseOutDialogManager",null,[]);var rn=d(1445);class wA{constructor(b,h,n,x,E,S){this.W4=this.xBe=null;this.S2=()=>{this.W4||(this.W4=new We.a(3,1,0,()=>{this.W4=null;this.vJd(this.hb.ib)},130),this.Hb.$b(this.W4))};this.Hc=b;this.jG=h;this.hb=n;this.Hb=x;this.VJe=E;this.zi=S;this.v0=new bg.a;this.$r=new rn.a;this.KTg=new kf.a(this.v0);this.jG.N8g((ma,Fa)=>{this.C2j(Fa.commentNode)})}C2j(b){b=b.id;const h=this.fVh(this.zi.value,
b);h&&this.$r.Z(b,h)}fVh(b,h){const n=b.Eb(h);return!n||this.jG.m6b(n)?null:this.jG.bDd(b,h)}jjk(b){const h=new rn.a;var n=this.jG.Z2b(b,!0);if(!n)return h;b=this.zi.value;for(let x of n)(n=this.fVh(b,x))&&h.Z(x,n);return h}NQf(b){if(this.xBe){const h=this.Hc.Rc(15);try{h.Db(this.VJe()),this.jG.Wwh(this.xBe)}finally{h&&h.dispose()}}this.xBe=b?this.jG.lCl(b):null}xSl(b){const h=this.zi.value;if(b=b?this.jjk(b):new rn.a){var n=new kf.a(this.v0),x=new kf.a(this.v0);wA.Zol(this.$r,b,n,x);for(var E of n)this.$r.Z(E,
b.J(E));for(let S of x)if(n=this.$r.J(S),x=this.jG.bDd(h,S),this.$r.remove(S),x&&(b=E=!1,da.a.pJc().equals(x,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?(b=!0,n=!1):n=-1<x.indexOf(WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?E=!0:!da.a.pJc().equals(n,x),n||E||b)){x=this.Hc.Rc(15);try{x.Db(this.VJe()),b?this.jG.Nwh(h,S,!0):(E&&this.jG.$mn(h,S),n&&this.jG.C6f(h,S))}finally{x&&x.dispose()}}}}oBl(b){const h=new kf.a(this.v0);for(let n of b)for(let x of n)b=
x.node,Cd.ParagraphReader.oc(b)&&h.add(b.id);return h}YQl(b){var h=this.zi.value;const n=b?this.oBl(b):new kf.a(this.v0);if(n){b=new Qa.a;for(let S of this.KTg)if(!n.contains(S)){var x=h.Eb(S);if(x){x=x.qa;for(let ma=0;ma<x.length;ma++){const Fa=x.J(ma).Ff;if(Fa)for(let $a=0;$a<Fa.length;$a++){var E=Fa.J($a);E.Oc&&(E=h.Eb(E.Oj))&&E.ia(ic.a.Rgi,!1)&&C.a.Dp(S,mk.h(E))&&this.jG.m6b(E)&&b.add(E)}}}}this.KTg=n;if(b.count){h=this.Hc.Rc(7);try{h.Db(this.VJe());for(let S of b)S.Qg(ic.a.Rgi)}finally{h&&h.dispose()}}}}vJd(b){this.NQf(b);
this.xSl(b);this.YQl(b)}Lih(){this.W4&&(this.Hb.ef(this.W4),this.W4=null)}sSc(){if(this.W4||this.zi.UJd)this.Lih(),this.vJd(null)}HA(){this.hb.OD(this.S2);u.AFrameworkApplication.rK(()=>{this.sSc()})}dispose(){this.hb.ega(this.S2);this.Lih()}static Zol(b,h,n,x){for(let E of h){let S=E.key;b.xb(S)||n.add(S)}for(let E of b)b=E.key,h.xb(b)||x.add(b)}}Object(r.a)(wA,"IntelligentPlaceholderSelectionCache",null,[10]);var Jz;(function(b){b[b.unknown=0]="unknown";b[b.contextMenu=1]="contextMenu";b[b.atMention=
2]="atMention";b[b.SIo=3]="textGesture";b[b.paste=4]="paste";b[b.Dso=5]="workItemIntent";b[b.Yyo=6]="characterTrigger"})(Jz||(Jz={}));Object(r.b)("IntelligentPlaceholderCreation",Jz);class du{constructor(b,h,n,x){this.Pwa=b;this.sm=h;this.zNb=n;this.px=x}M6d(b){return b&&b.Nc&&b.Nc.id.equals(this.px.value.Ad.id)?!0:!1}o1i(b){return this.M6d(b)&&b.ia(ic.a.AF,!1)?!0:!1}Uxm(){this.zNb.execute(b=>{b.logAction({actionType:Rn.b.SessionStart,engagement:Rn.a.Offer,objectName:du.vfc})})}eSd(b,h){let n=!1;
u.AFrameworkApplication.K.$("FixInCanvasMentionLogging")&&(n=2==h&&this.M6d(b));if(this.o1i(b)||n){var x=b.getValue(ic.a.ZD);this.zNb.execute(E=>{E.logAction({actionType:Rn.b.Created,engagement:Rn.a.None,objectName:du.vfc,objectId:x.toString(),objectFulfillment:Jz[h]})})}}Kum(b){if(this.o1i(b)){var h=b.getValue(ic.a.ZD);this.zNb.execute(n=>{n.logAction({actionType:Rn.b.Deleted,engagement:Rn.a.None,objectName:du.vfc,objectId:h.toString()})})}}Qym(b,h){if(this.M6d(b)){var n=b.getValue(ic.a.ZD);this.zNb.execute(x=>
{x.logAction({actionType:Rn.b.Resolved,engagement:Rn.a.None,objectName:du.vfc,objectId:n.toString(),objectFulfillment:h?"RemoveText":"KeepText"})})}}Yzm(b){b===ub.a.zLd&&this.zNb.execute(h=>{h.logAction({actionType:Rn.b.Deleted,engagement:Rn.a.None,objectName:du.vfc,objectFulfillment:du.U4n})})}Qwm(b){if(this.M6d(b)){var h=b.getValue(ic.a.ZD);this.zNb.execute(n=>{n.logAction({actionType:Rn.b.Modified,engagement:Rn.a.None,objectName:du.vfc,objectId:h.toString(),objectFulfillment:"MentionInserted"})})}}egk(){this.Uxm();
this.Pwa.N8g((b,h)=>{this.eSd(h.commentNode,h.Z2m)});this.Pwa.A6j((b,h)=>{this.Qym(h.commentNode,h.ihm)});this.Pwa.i6j((b,h)=>{this.Qwm(h.commentNode)});this.sm.cOe((b,h)=>{this.Yzm(h.actionId)});td.a.UNe((b,h)=>{this.Kum(h.commentNode)})}}du.vfc="IntelligentPlaceholder";du.U4n="Undo";Object(r.a)(du,"IntelligentPlaceholderTelemetry",null,[]);class xA{constructor(){this.H4=this.Hdd=this.rkd=this.W=null}get name(){return"WordEditor.IntelligentPlaceholder"}zc(b){this.W=b;b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager",
()=>new Jv(u.AFrameworkApplication.ya,b.Za("Common.App.SafeLinks.ISafeLinksManager"))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderAtMentionManager",()=>new ii).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager").singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderEditor",()=>new rq(u.AFrameworkApplication.ya,new qm.a,b.resolve("Box4.IParagraphIteratorFactory"),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.Comments.IWordEditorCommentModel"),
b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.IHyperlinkEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IAtMentionHyperlinkConfigurator"),new se.a(()=>ob.App.xa.jb.Zc.Ad),b.resolve("WordEditor.Comments.CommentsSettings"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEventSource").singleInstance();
b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor",()=>new Eg(u.AFrameworkApplication.ya,b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager"))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache",()=>new wA(b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),
b.resolve("Box4.ISelectionManager"),u.AFrameworkApplication.uc,()=>ob.App.xa.jb.Jc.ud,new se.a(()=>ob.App.xa.jb.Zc.Ad))).singleInstance();b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener",()=>new Ps(cb.InteractiveViewManager.instance,new se.a(()=>ob.App.xa.jb.Zc.Ad),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener").singleInstance();
b.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry",()=>new du(b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.IUndoManager"),b.Za("CanvasContextual.ICanvasContextualController"),new se.a(()=>ob.App.xa.jb.Zc))).singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Nm()})}Nm(){const b=this.W.resolve("Box4.IFeatureHelper");b.isFeatureEnabled(17)&&(this.W.Za("WordEditor.CanvasContextualProvider.UxManager"),
this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor").Vb(),this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry").egk(),this.H4=this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),bk.Y4j(Object(v.a)(this.H4,this.H4.Qdh,"beforeIntelligentPlaceholderPaste")),bk.Jxc(Object(v.a)(this.H4,this.H4.lwi,"onIntelligentPlaceholderPaste")),this.rkd=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache"),
b.isFeatureEnabled(103)||this.rkd.HA(),this.Hdd=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener"),this.Hdd.Lyc(ob.App.xa.jb,mc.KeyInputManager.instance),this.Pjn(this.W.Za("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor")))}dispose(){this.rkd&&this.rkd.dispose();this.Hdd&&this.Hdd.dispose();this.H4&&(bk.gpn(Object(v.a)(this.H4,this.H4.Qdh,"beforeIntelligentPlaceholderPaste")),
bk.Lpn(Object(v.a)(this.H4,this.H4.lwi,"onIntelligentPlaceholderPaste")))}Pjn(b,h,n){b&&b.execute(x=>{x.a3(new ph(h,n))})}static main(){N.a.instance.Pc(new xA)}}Object(r.a)(xA,"PackageManager",null,[1,2]);var zC=window.FindReplaceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FindReplaceTaskPane",Title:"STR@L_NavigationPaneTitle",Width:"300"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupNavControls",
IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Medium",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnHeadings",Command:"0xD0FBCB6A",LabelText:"STR@L_NavigationPaneHeadingsSubtitle"}},{name:"Button",attrs:{Id:"btnFind",Command:"0x7EC3CC8E",LabelText:"STR@L_Find"}},{name:"Button",attrs:{Id:"btnReplace",Command:"0x8358F6C1",LabelText:"STR@L_Replace"}}]}]}]}]},{name:"Group",
attrs:{Id:"GroupFindInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"TwoRow"},children:[{name:"Row",attrs:{Id:"SearchBoxPlaceholder",DisplayMode:"Medium"}},{name:"Row",attrs:{Id:"RowFindFilters",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelFilters",Command:"0x2F9A3D80",QueryCommand:"0x5E7080C7"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupReplaceInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},
children:[{name:"Row",attrs:{Id:"ReplacePlaceholder",DisplayMode:"Medium"}}]}]},{name:"Group",attrs:{Id:"GroupReplaceControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"RowReplaceButtons",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonReplace",Command:"0x3F2E19EE",LabelText:"STR@L_Replace"}},{name:"Button",attrs:{Id:"ButtonReplaceAll",Command:"0x69D75659",LabelText:"STR@L_ReplaceAll"}}]}]}]}]},
{name:"Group",attrs:{Id:"GroupFindControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelSummary",Command:"0x2F9A3D80",QueryCommand:"0x7F7A1460"}}]}]}]},{name:"Section",attrs:{Type:"OneRow",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{Id:"RowFindButtons",DisplayMode:"Small"},children:[{name:"Controls",attrs:{},children:[{name:"Button",
attrs:{Id:"ButtonFindPrevious",Alt:"STR@L_FindPrevious",Command:"0x4457C7F4",QueryCommand:"0x89A9BD2C",Image16by16:"IMGMAP@we@UpArrow_16x16x32",LabelText:"STR@L_FindPrevious"}},{name:"Button",attrs:{Id:"ButtonFindNext",Alt:"STR@L_FindNext",Command:"0xB28AED00",Image16by16:"IMGMAP@we@DownArrow_16x16x32",QueryCommand:"0x8CA2CFB8",LabelText:"STR@L_FindNext"}}]}]}]}]},{name:"Group",attrs:{Id:"FindResultsPlaceholder",IsStretched:"true"}},{name:"Group",attrs:{Id:"GroupOutOfSyncResultsNotification",IsStretched:"false"}}]}]}]},
IB=d(1921),os=d(1824),io=d(1894);class fr{}fr.vZn="Search_16x16x32";fr.nZn="ClosePaneGlyph_16x16x32";Object(r.a)(fr,"SearchBoxIcons",null,[]);var jx=d(1897),Hs=d(1898),Hn=d(1896);class xD{constructor(){this.UCg=null}get key(){return"FIND_HIT"}get hw(){return WordEditorIntl.WordEditorStrings.l_FindHitContentTitle}reset(b){this.UCg=b.node.bLa()}DEa(b){let h=null;for(let n of this.UCg)if(n.begin<=b&&b<n.end)return h=Object.assign(new zt.a,{IF:this.key,contentObject:n}),{returnValue:!0,KE:h};return{returnValue:!1,
KE:h}}}Object(r.a)(xD,"FindHitDetailsProvider",null,[226,227]);var IC=d(1585),JC=d(1531),yD=d(1568);class Rx{constructor(b,h,n,x,E,S,ma,Fa=null,$a=null){this.Sl=null;this.find=(sb,Jb,Sb,oc,Ic)=>1===Sb?32:void 0===Ic||null===Ic?8:Ic.length?this.S0f(Ic):(this.fUe(io.a.initial),32);this.findInDocument=(sb,Jb,Sb,oc,Ic)=>this.x3i(ub.a.rkb,sb,Jb,Sb,oc,Ic);this.O6k=(sb,Jb,Sb,oc,Ic)=>this.x3i(ub.a.tkb,sb,Jb,Sb,oc,Ic);this.tGh=(sb,Jb,Sb)=>1===Sb?32:this.S0f(this.Xn.XKa());this.gVc=(sb,Jb,Sb,oc,Ic)=>{sb=!this.Xn.dF;
Ic[ae.a.Image16by16Class]=sb?Tg.getImageClass(fr.vZn):Tg.getImageClass(fr.nZn);Ic[ae.a.LabelText]=sb?WordEditorIntl.WordEditorStrings.L_SearchFilterTooltip:WordEditorIntl.WordEditorStrings.l_SearchFilterCancelTooltip;Ic[ae.a.ApplyLabelTextToControlOnly]=!0;Ic[ae.a.EnsureControlRoleIsButton]=!0;Ic[ae.a.On]=!1;return 32};this.Q7k=(sb,Jb,Sb)=>{if(1===Sb)return 32;this.q0h(!1);return 32};this.$7k=(sb,Jb,Sb)=>{if(1===Sb)return 32;this.q0h(!0);return 32};this.vNf=(sb,Jb,Sb,oc,Ic)=>{Ic[nl.a.Visible]=this.Xn.E3i;
return 32};this.FNf=(sb,Jb,Sb,oc,Ic)=>{Ic[nl.a.Visible]=this.Xn.E3i;return 32};this.VHd=(sb,Jb,Sb,oc,Ic)=>{if(1===Sb)return 32;this.$z.XXc.v0h(Ic);return 32};this.cancelSearch=(sb,Jb,Sb)=>{if(1===Sb)return 32;this.fUe(io.a.initial);return 32};this.vAc=(sb,Jb,Sb)=>{if(1===Sb)return 32;this.fUe(io.a.initial);this.Xn.NA(!1);return 32};this.clearSearch=(sb,Jb,Sb)=>{if(1===Sb)return this.I8l(sb===Ra.a.Hlh);this.Xn.clearSearch();return 32};this.tbe=(sb,Jb,Sb)=>{if(1===Sb)return 32;switch(sb){case Ra.a.P7e:this.Xn.matchCase=
!this.Xn.matchCase;break;case Ra.a.d8e:this.Xn.matchWholeWord=!this.Xn.matchWholeWord}return this.S0f(this.Xn.XKa())};this.T_d=(sb,Jb,Sb,oc,Ic)=>{Ic[Qf.a.On]=this.Xn.matchCase;return 32};this.V_d=(sb,Jb,Sb,oc,Ic)=>{Ic[Qf.a.On]=this.Xn.matchWholeWord;return 32};this.gNf=(sb,Jb,Sb,oc,Ic)=>{sb=this.Xn.matchCase;Jb=this.Xn.matchWholeWord;Sb="";sb&&Jb?Sb=String.format(WordEditorIntl.WordEditorStrings.l_FindMultipleFiltersLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):
sb?Sb=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase):Jb&&(Sb=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));Ic[Ud.a.Value]=Sb;Ic[Ud.a.Visible]=sb||Jb;return 32};this.cbc=(sb,Jb,Sb,oc,Ic)=>{sb=this.Xn.E0;Jb="";switch(this.Xn.dF){case io.a.startSearch:Jb=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case io.a.searching:Jb=sb?this.Kff(WordEditorIntl.WordEditorStrings.l_SummarySomeResults):
WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case io.a.searchComplete:Jb=this.Kff(WordEditorIntl.WordEditorStrings.l_SummaryAllResults);break;case io.a.tooManyResults:Jb=this.Kff(this.Xn.TBa?WordEditorIntl.WordEditorStrings.l_SummaryAllResults:WordEditorIntl.WordEditorStrings.l_SummarySomeResults);break;case io.a.noMatchesFound:Jb=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case io.a.replaceAllInProgress:Jb=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgress;break;case io.a.replaceAllComplete:Jb=
WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}Ic[Ud.a.Value]=Jb;return 32};this.U_d=(sb,Jb,Sb,oc,Ic)=>{Ic&&(Ic.CommandValueId=this.Xn.XKa());return 32};this.replace=(sb,Jb,Sb,oc,Ic)=>{if(1===Sb)return this.Hrf()?32:8;if(!this.Hrf())return 8;sb=this.Xn.qAb();"string"===typeof Ic&&Ic&&(sb=Ic);w.ULS.sendTraceTag(6033813,312,50,"Replace Called");Pe.a("NavigationPaneReplace");Ic=this.ysb.replace(sb);this.Xn.lFn(Ic);return 32};this.replaceAll=(sb,Jb,Sb,oc,Ic)=>{if(1===Sb)return this.phm()?32:8;
sb=this.Xn.qAb();"string"===typeof Ic&&Ic&&(sb=Ic);Pe.a("NavigationPaneReplace");this.Sl=this.le.fg("UserAction","ReplaceAll");this.Xn.x5(io.a.replaceAllInProgress);w.ULS.sendTraceTag(4065348,312,50,"Replace All started feedback indicated to user.");yD.a.Urn(this.Xn.XKa(),this.Xn.qAb());this.ysb.replaceAll(sb,this.qUm);return 32};this.qUm=(sb,Jb)=>{this.Sl&&(this.Sl.stop(),this.Sl=null);w.ULS.sendTraceTag(4065349,312,50,"{0}",{["ReplaceAll Complete.ReplaceCount"]:sb,["TotalCount"]:Jb});yD.a.Rrn(sb,
Jb);this.Xn.x5(io.a.replaceAllComplete)};this.DGi=(sb,Jb,Sb,oc,Ic)=>{Jb=!1;if(!Ic)return 8;this.Xn.hh.isVisible&&(Jb=sb===ub.a.BVc===this.Xn.IIc());sb!==ub.a.BVc||this.IKg||(Jb=!1);Ic[Qf.a.On]=Jb;return 32};this.hNf=(sb,Jb,Sb,oc,Ic)=>{if(!Ic||!this.Xn.hh.isVisible)return 32;Ic[Qf.a.On]=this.Xn.TBa;return 32};this.jNf=(sb,Jb,Sb,oc,Ic)=>{if(!Ic)return 32;Ic.currentFindReplaceViewType=this.Xn.dF;return 32};this.aan=(sb,Jb,Sb,oc,Ic)=>{if(1===Sb)return 32;sb=Ic[Qf.a.On];Ic&&(Ic[Qf.a.On]=this.Xn.hh.isVisible);
sb&&!Ic[Qf.a.On]&&(Rx.fbj(),Pe.a("NavigationPaneCrossClick"));return 32};this.XPa=(sb,Jb,Sb,oc,Ic)=>{const gd=this.Xn.hh.isVisible;w.ULS.sendTraceTag(42501021,367,50,"Visibility: {0}",gd);return gd?this.vAc(sb,Jb,Sb,oc,Ic):this.eec(sb,Jb,Sb,oc,Ic)};this.eec=(sb,Jb,Sb,oc,Ic)=>{if(1===Sb)return!Vh.SessionStatusManager.instance.dK||Ee.a.Jla(Jb)?8:32;if(2===Sb){u.AFrameworkApplication.eaa("AutoDetectedHeadingsIsEnabled");Rx.fbj();this.c3();IC.FindReplaceUIManager.$mk(sb,Ic,this.Xn.hh.isVisible);Jb=!0;
sb===ub.a.jec&&void 0!==Ic&&null!==Ic&&(Jb=Ic);this.Xn.NA(!0,Jb);Ic=Hn.a.initial;switch(sb){case ub.a.fec:w.ULS.sendTraceTag(42501022,367,50,"");Ic=Hn.a.headings;break;case ub.a.rkb:Ic=Hn.a.find;break;case ub.a.tkb:Ic=Hn.a.replace;break;case ub.a.jec:Ic=Hn.a.intelligentPlaceholder;break;case ub.a.XPa:Ic=this.Xn.cbb,Ic||(w.ULS.sendTraceTag(42501023,367,50,""),Ic=Hn.a.headings)}this.Xn.bKn(Ic,Jb);return 32}return 8};this.j0a=()=>{this.Xn.dF&&!this.Xn.TBa&&w.ULS.sendTraceTag(5007322,312,50,"App closed when find is in progress.")};
this.ga=b;this.Xn=h;this.$z=n;this.ysb=x;this.IKg=E;this.le=ma;$a&&$a(1,this.j0a,null);this.GGa=Fa}c3(){}Vb(){this.ga.gb(ub.a.WNf,cc.a.view,this.aan,96);this.ga.pa(ub.a.XPa,cc.a.view,this.XPa);this.ga.pa(ub.a.fec,cc.a.view,this.eec);this.ga.pa(ub.a.rkb,cc.a.view,this.eec);this.ga.pa(Db.a.CBd,cc.a.view,this.find);this.ga.pa(Ra.a.findInDocument,cc.a.view,this.findInDocument);this.ga.pa(Db.a.findOnPage,cc.a.view,this.tGh);this.ga.gb(Ra.a.D$m,cc.a.view,this.gVc,97);this.ga.pa(Db.a.FUd,cc.a.view,this.Q7k);
this.ga.pa(Db.a.k_d,cc.a.view,this.$7k);this.ga.gb(Db.a.vNf,cc.a.view,this.vNf,97);this.ga.gb(Db.a.FNf,cc.a.view,this.FNf,97);this.ga.pa(ub.a.VHd,cc.a.view,this.VHd);this.ga.pa(Db.a.Wvb,cc.a.view,this.cancelSearch);this.ga.pa(Ra.a.clearSearch,cc.a.view,this.clearSearch);this.ga.pa(Ra.a.Hlh,cc.a.application,this.clearSearch);this.ga.pa(ub.a.vAc,cc.a.view,this.vAc);this.ga.pa(Ra.a.P7e,cc.a.view,this.tbe);this.ga.pa(Ra.a.d8e,cc.a.view,this.tbe);this.ga.gb(Ra.a.T_d,cc.a.view,this.T_d,97);this.ga.gb(Ra.a.V_d,
cc.a.view,this.V_d,97);this.ga.gb(ub.a.gNf,cc.a.view,this.gNf,97);this.ga.gb(ub.a.cbc,cc.a.view,this.cbc,97);this.ga.gb(ub.a.hNf,cc.a.view,this.hNf,97);this.ga.gb(ub.a.jNf,cc.a.view,this.jNf,97);this.ga.gb(ub.a.iNf,cc.a.view,this.DGi,97);Object(JC.b)()&&this.ga.gb(ub.a.U_d,cc.a.view,this.U_d,96);this.IKg&&(this.ga.gb(ub.a.tkb,cc.a.view,this.eec,1028),this.ga.gb(ub.a.BVc,cc.a.view,this.DGi,97),this.ga.gb(ub.a.replace,cc.a.view,this.replace,1028),this.ga.gb(ub.a.replaceAll,cc.a.view,this.replaceAll,
1028),u.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)&&this.ga.gb(Ra.a.Y7e,cc.a.view,this.O6k,1028));this.ga.pa(ub.a.jec,cc.a.view,this.eec)}EPf(){this.GGa&&this.GGa.execute(b=>{b.a3(new xD)})}x3i(b,h,n,x,E,S){if(1===x)return Vh.SessionStatusManager.instance.dK?32:8;if(void 0===S||null===S)return 8;this.eec(b,n,2,E,S);b=this.Xn;b.zWf(S.CommandValueId);Object(JC.b)()&&("MatchCase"in
S&&(b.matchCase=S.MatchCase),"MatchWholeWord"in S&&(b.matchWholeWord=S.MatchWholeWord));return this.tGh(h,n,x,E,S)}S0f(b){if(void 0===b||null===b||!b.length)return 32;b=jx.a.createQuery(b,this.I$m);if(void 0===b||null===b)return w.ULS.sendTraceTag(4069067,312,10,"InvalidQuery"),8;this.$z.find(b);return 32}get I$m(){let b=Hs.a.none;this.Xn.matchCase&&(b|=Hs.a.matchCase);this.Xn.matchWholeWord&&(b|=Hs.a.wholeWordOnly);return b}q0h(b){this.Xn.cbb!==Hn.a.headings&&this.Xn.E0&&(b?this.$z.XXc.JOl():this.$z.XXc.s0h())}fUe(b){this.Xn.dF&&
(this.Xn.TBa||w.ULS.sendTraceTag(5007321,312,50,"User action resulting in cancelling find operation in progress."),this.$z.xVa(),this.Xn.x5(b))}I8l(b){return this.Xn.dF===io.a.replaceAllInProgress||b&&!this.Xn.dF?8:32}Kff(b){return String.format(b,this.Xn.l8c,this.Xn.E0)}Hrf(){return this.Xn.IIc()&&0<this.Xn.E0}phm(){return this.Hrf()&&this.Xn.TBa}static fbj(){null!=u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("NavPaneFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Oa.a.instance.Za("Common.ISystemInitiatedFeedback");
b&&b.execute(h=>{h.logActivity("NavPaneUsed","NavPaneFloodgateIsEnabled")})},Rx.gka)}static Tpl(b,h,n,x){return new Rx(u.AFrameworkApplication.ya,b,h,n,x,de.FocusManager.instance(),ob.App.xa.iq,Oa.a.instance.Za("Box4.Accessibility.IAccessibilityContextManager"),Object(v.a)(u.AFrameworkApplication.ua.qM,u.AFrameworkApplication.ua.qM.mb,"registerHandler"))}static Spl(b,h,n,x){return Rx.Tpl(b,h,n,x)}}Rx.gka=5E3;Object(r.a)(Rx,"FindReplaceActor",null,[]);var QE=d(197),RE=d(877),oz=function(){function b(){this._map=
new Map}Object.defineProperty(b.prototype,"first",{get:function(){return this.uH},set:function(h){this.uH=h},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"last",{get:function(){return this.pRb},enumerable:!1,configurable:!0});b.prototype.length=function(){return this._map.size};b.prototype.get=function(h){return this._map.get(h)};b.prototype.insert=function(h,n){this.removeItem(h);n={key:h,Caa:this.pRb,next:void 0,data:n};this.first||(this.first=n);this.pRb&&(this.pRb.next=n);
this.pRb=n;this._map.set(h,n)};b.prototype.insertAfter=function(h,n,x){h=this._map.get(h);if(!h)return!1;x={key:n,Caa:h,next:h.next,data:x};var E=h.next;E&&(E.Caa=x);h.next=x;this._map.set(n,x);return!0};b.prototype.insertBefore=function(h,n,x){h=this._map.get(h);if(!h)return!1;x={key:n,Caa:h.Caa,next:h,data:x};var E=h.Caa;E&&(E.next=x);h.Caa=x;this._map.set(n,x);return!0};b.prototype.removeItem=function(h){var n=this._map.get(h);n&&(this.first===n&&(this.first=n.next),this.pRb===n&&(this.pRb=n.Caa),
n.Caa&&(n.Caa.next=n.next),n.next&&(n.next.Caa=n.Caa),this._map.delete(h))};return b}();class is{constructor(){this.type="heading"}}Object(r.a)(is,"NavPaneHeadingItem",null,[]);class zD{constructor(){this.type="bookmark"}}Object(r.a)(zD,"NavPaneBookmarkItem",null,[]);class AD{constructor(b,h,n,x,E,S){var ma;this.fb=b;this.hb=h;this.Wb=n;this.ml=x;this.zi=E;this.$A=S;this.ptc=0;this.Pfd=new Map;this.SFg=!1;this.Kxf={[1]:1,[0]:1,[2]:1};this.vFa=new Map;this.cJa=!0;this.dMj=null===(ma=u.AFrameworkApplication.K)||
void 0===ma?void 0:ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneShowNumberListedHeadings",!1)}get headingsReady(){return this.SFg}set headingsReady(b){this.SFg=b}get q$m(){return this.ptc}get Qma(){this.KSb&&0!=this.KSb.length()||(this.KSb=this.E5m());return this.KSb}set Qma(b){this.KSb=b}get Pcc(){return this.gSj}set Pcc(b){this.Pcc&&(this.Pcc.isSelected=!1);b.isSelected=!0;this.gSj=b}lef(b,h){return"bookmark"===b.type?b.text:h.id.toString()}E5m(){var b;const h=new oz;var n=null===
(b=this.zi.value)||void 0===b?void 0:b.EBi;if(!n)return h;this.Pfd=new Map;b=n.SBd();let x;const E=[];for(;b;){const S=this.zi.value.Eb(b.id);n=this.aTh(S,E);null===n||void 0===n?void 0:n.forEach(ma=>{(x=this.OUh(ma,E))&&"heading"===x.type&&x.indentLevel<ma.indentLevel&&(1>=x.indentLevel?(x.isCollapsed=!1,ma.isHidden=!1):(x.isCollapsed=!0,ma.isHidden=!0));h.insert(this.lef(ma,S),ma)});b=b.next}return h}OUh(b,h){return"heading"===b.type?1<h.length?h[h.length-2]:void 0:0<h.length?h[h.length-1]:void 0}k7f(b){var h;
let n=Cd.ParagraphReader.HAa(b),x=!1;9===n&&this.vFa.has(b.id.toString())&&(n=this.vFa.get(b.id.toString()),x=!0);const E=null===(h=this.Qma.get(b.id.toString()))||void 0===h?void 0:h.data;if(E){if(E.indentLevel===n){h=Tc.AParagraphNode.dU(b.characterData.trim());b=this.ml.value.KYd(b,!1);if(h!==E.text||E.hasBookmark!==b)return E.text=h,E.hasBookmark=b,!0;!x&&E.isPurelyADH&&(E.isPurelyADH=!1,--this.ptc);return!1}this.vUc();return!0}if(9===n)return this.x7l(b)?(this.vUc(),!0):!1;this.vUc();return!0}x7l(b){var h;
const n=this.ml.value.naf(b,!1);b=null!==(h=this.Pfd.get(b.id.toString()))&&void 0!==h?h:0;if(b!==n.length)return!0;for(h=0;h<b;++h)if(!this.Qma.get(n[h].JKa()))return!0;return!1}UQk(b){if(this.Qma.get(b.id.toString())||this.ml.value.KYd(b,!1))return this.vUc(),!0;this.vFa.delete(b.id.toString());return!1}vUc(){var b,h=null===(b=this.zi.value)||void 0===b?void 0:b.EBi;const n=new oz;this.ptc=0;if(h){this.Pfd=new Map;var x=[];b=h.SBd();for(var E,S;b;){const ma=this.zi.value.Eb(b.id);h=this.aTh(ma,
x);null===h||void 0===h?void 0:h.forEach(Fa=>{var $a=this.lef(Fa,ma);S=this.OUh(Fa,x);this.nwn($a,Fa,S);n.insert($a,Fa);"heading"===(null===E||void 0===E?void 0:E.type)&&($a=E,$a.indentLevel>=Fa.indentLevel&&($a.isCollapsed=void 0));E=Fa});b=b.next}}this.Qma=n}nwn(b,h,n){var x,E;if(b=null===(x=this.KSb.get(b))||void 0===x?void 0:x.data)b.isSelected&&(h.isSelected=!0,this.Pcc=h),h.isHidden=b.isHidden;if(n){if(x=null===(E=this.KSb.get(this.lef(n,n.paragraphNode)))||void 0===E?void 0:E.data)n.isCollapsed=
x.isCollapsed;n.isCollapsed?h.isHidden=!0:n.isHidden?(n.isCollapsed=!0,h.isHidden=!0):(n.isCollapsed=!1,h.isHidden=!1)}}aTh(b,h){var n=Cd.ParagraphReader.HAa(b),x=!this.Hpf(b);const E=this.gcm(n)&&x?!0:!1;x=this.vFa.has(b.id.toString())&&x;let S=[];if(E)S.push(this.msh(b,n,!1,h));else if(x)this.ptc+=1,this.cJa&&(n=this.vFa.get(b.id.toString()),S.push(this.msh(b,n,!0,h)));else{let ma=0;this.ml.value.naf(b,!1).forEach(Fa=>{const $a=new zD;$a.text=Fa.JKa();$a.isSelected=!1;$a.bookmarkManager=this.ml;
$a.indentLevel=0<h.length?h[h.length-1].indentLevel+1:0;ma+=1;S.push($a)});this.Pfd.set(b.id.toString(),ma)}return S}msh(b,h,n,x){var E,S;const ma=new is;ma.text=Tc.AParagraphNode.dU(b.characterData.trim());ma.indentLevel=h;ma.paragraphNode=b;ma.isSelected=!1;ma.isPurelyADH=n;this.dMj&&(ma.listMarker=this.Fef(b));ma.hasBookmark=this.ml.value.KYd(b,!1);for(b=null===(E=x[x.length-1])||void 0===E?void 0:E.indentLevel;b&&b>=h;)x.pop(),b=null===(S=x[x.length-1])||void 0===S?void 0:S.indentLevel;(!b||b<
h)&&x.push(ma);return ma}Hpf(b){return this.fb.oc(b)&&0===this.fb.textLength(b,this.Kxf[QE.a.Oi])}r3k(b){(b=this.Qma.get(b))&&(1==b.data.isCollapsed?this.K3i(b):this.pWl(b))}onClickHeading(b){var h;this.Pcc=b=null===(h=this.Qma.get(b))||void 0===h?void 0:h.data;h=Ae.SelectionFactory.xe(b.paragraphNode,0);this.hb.setSelection(h);this.Wb.Jg(xd.AFrame.Xp)}onClickBookmark(b){var h;this.Pcc=b=null===(h=this.Qma.get(b))||void 0===h?void 0:h.data;this.ml.value.Zhf(b.text)}y6f(b,h){const n=b.id.toString();
if(!this.vFa.has(n)||this.vFa.get(n)!==h)if(this.vFa.set(n,h),this.cJa)return this.k7f(b);return!1}pQk(b){const h=b.id.toString();return this.vFa.has(h)&&(this.vFa.delete(h),this.cJa)?this.k7f(b):!1}i7n(b){this.cJa=b;this.vUc()}X6f(b){var h;const n=null===(h=this.Qma.get(b.id.toString()))||void 0===h?void 0:h.data;if(!n)return!1;b=this.Fef(b);if(n.listMarker===b)return!1;this.Vdo();return!0}H1e(b){var h;b=null===(h=this.Qma.get(b.id.toString()))||void 0===h?void 0:h.data;if(!b||void 0===b.listMarker)return!1;
b.listMarker=void 0;return!0}K3i(b){var h=b.data;1==h.isCollapsed&&(h.isCollapsed=!1);h=h.indentLevel;b=b.next;let n;for(;b&&b.data.indentLevel>h;)n=b,b=n.next,n.data.isHidden=!1,"heading"==n.data.type&&(b=n.data.isCollapsed?this.KXn(n):this.K3i(n));return b}pWl(b){var h=b.data;h.isCollapsed=!0;h=h.indentLevel;b=b.next;let n;for(;b&&b.data.indentLevel>h;)n=b,b=n.next,n.data.isHidden=!0}KXn(b){const h=b.data.indentLevel;for(b=b.next;b&&b.data.indentLevel>h;)b=b.next;return b}gcm(b){return 0<=b&&8>=
b}Vdo(){let b=this.Qma.first;for(;b;){if("heading"===b.data.type){const h=b.data;h.listMarker=this.Fef(h.paragraphNode)}b=b.next}}Fef(b){var h;if(b.aW instanceof RE.a)return this.EMl(null===(h=this.$A.y_a(b.aW))||void 0===h?void 0:h.B2)}EMl(b){for(let h=0;h<(null===b||void 0===b?void 0:b.length);)return 128<=b.charCodeAt(h)?void 0:b}}Object(r.a)(AD,"NavPaneHeadingsManager",null,[]);var KC=d(1532);class Ky{constructor(){this.ysb=this.$z=this.Vmc=this.q$c=this.W=null}get name(){return"WordEditor.FindReplace"}zc(b){this.W=
b;const h=new AD(Oa.a.instance.resolve("Box4.IParagraphReader"),Oa.a.instance.resolve("Box4.ISelectionManager"),de.FocusManager.instance(),Oa.a.instance.Ye("WordEditor.Bookmark.IBookmarkManager"),new se.a(()=>ob.App.xa.jb.Zc.Ad),b.resolve("Box4.IListMarkerUtility"));this.W.ha("WordEditor.FindReplace.NavPaneHeadingsManager",()=>h).as("WordEditor.FindReplace.NavPaneHeadingsManager").singleInstance()}init(){Ky.Pb.Yk.continueWith(()=>{this.Nm()})}Nm(){if(ob.App.K9f){const b=ob.App.Nce;this.Vmc=IC.FindReplaceUIManager.getInstance(b);
this.$z=os.FindManager.createInstance(this.Vmc,IB.a.instance,KC.a.instance,!0);this.ysb=this.$z.SHb;this.q$c=Rx.Spl(this.Vmc,this.$z,this.ysb,b);this.q$c.Vb();this.q$c.c3();this.q$c.EPf();ob.App.xa.updateCommandUI()}}dispose(){this.Vmc&&this.Vmc.dispose()}static get Pb(){return null!=Ky.xhg?Ky.xhg:Ky.xhg=Oa.a.instance.resolve("Box4.IFeatureHelper")}}Object(r.a)(Ky,"FindReplacePackageManager",null,[1,2]);class mB{constructor(){}a$e(){return"_@_"+na.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+
"Z"}Hgo(b,h,n,x){h.mFn(b,x);h.$l(b,ie.a.E7,!0);h.$l(b,ic.a.sMa,!0);h.$l(b,ic.a.fieldInstruction,mB.pFh(n));h.$l(b,ic.a.gq,15)}k8j(b,h,n,x){const E=b.hwd(x);h.$l(E,ie.a.E7,!0);h.$l(E,ic.a.gq,47);h.$l(E,ic.a.fieldInstruction,mB.pFh(n));b=b.hwd(x);h.$l(b,ie.a.E7,!0);h.$l(b,ic.a.gq,16);return[E.Aj,b.Aj]}gdl(b,h,n){b=b.hwd(n);h.$l(b,ie.a.E7,!0);h.$l(b,ic.a.lDb,!0);return b.Aj}static pFh(b){return String.format(' HYPERLINK "{0}"',b)}}Object(r.a)(mB,"AtMentionHyperlinkConfigurator",null,[455]);class LC{constructor(b,
h,n){this.Vqc=b;this.hb=h;this.cte=!1;this.uFf=this.uFf.bind(this);this.KFf=this.KFf.bind(this);this.IGf=this.IGf.bind(this);n&&n.execute(x=>{this.Cha=x})}FKi(){this.Vqc.AKi(this.uFf);this.Vqc.BKi(this.KFf);this.Vqc.NKi(this.IGf)}hrf(){return!1}uFf(b,h,n){var x,E;h=Date.now();if(this.Cha){var S=null===(E=null===(x=this.hb.ib)||void 0===x?void 0:x.kb)||void 0===E?void 0:E.Tc;S?(x=S.node,Cd.ParagraphReader.oc(x)?(E=Cd.ParagraphReader.text(x),0>n||n>E.length?w.ULS.sendTraceTag(540340298,3034,50,"ContextIQUserInitHandler::onInputCallback - Position of the @ was not within the bounds of the paragraph."):
(this.cte||(this.cte=!0,this.Cha.QWn(S)),this.Cha.G6f(n,n+b.length),b=E.substring(0,n)+b,this.Cha.l$e(x,b,n,h))):w.ULS.sendTraceTag(540541835,3034,10,"ContextIQUserInitHandler::onInputCallback - Current node is not a paragraph.")):w.ULS.sendTraceTag(540541834,3034,10,"ContextIQUserInitHandler::onInputCallback - Failed to get the current selection context.")}else w.ULS.sendTraceTag(537776153,3034,10,"ContextIQUserInitHandler::onInputCallback - ContextIQIntentProvider is not available yet.")}KFf(b){if(this.Cha)this.Cha.onKeyDown(b)}IGf(){this.cte=
!1;this.Cha&&this.Cha.pmh()}}Object(r.a)(LC,"ContextIQUserInitHandler",null,[295]);var SE=d(1689);class yv{constructor(){this.hz=null}get name(){return"WordEditor.AtMentions"}zc(b){this.W=b;b.ha("Box4.IAtMentionHyperlinkConfigurator",()=>new mB(b.resolve("Box4.IFeatureHelper"))).singleInstance();const h={crewAlias:yv.Tlj,featureName:yv.qnj,topLevelKpiName:yv.Kqj,vetoPillar:7};b.ha("WordEditor.AtMentions.IFeatureUsageAndHealthLogger",()=>new gk.a(ta.Health.instance,new Lh.a,h)).as("WordEditor.AtMentions.IFeatureUsageAndHealthLogger").singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>
{this.Nm()})}dispose(){}Nm(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(17)&&(u.AFrameworkApplication.K.$("CanvasAtMentionDetectionIsEnabled")&&this.W.Za("Common.App.People.IExternalPeopleAPI").execute(b=>{b.atMentionsEnabledAsync().then(h=>{u.AFrameworkApplication.K.$("ConsumerMentionsHostIsEnabled")&&(h=h&&u.AFrameworkApplication.K.$("WordEditorConsumerCanvasMentionsIsEnabled"));h&&this.zqm()})}),this.W.resolve("Box4.IAtMentionHyperlinkConfigurator"))}zqm(){(u.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("canvasAtMentions"):this.W.resolve("Common.IDynamicScriptLoaderProvider").tE.loadScript("canvasAtMentions")).then(()=>{u.AFrameworkApplication.K.yq(()=>{this.kin()})})}kin(){const b={peopleAPI:this.W.resolve("Common.App.People.IExternalPeopleAPI"),localizationDetails:{isRightToLeft:u.AFrameworkApplication.isRtl,appLocale:Sys.CultureInfo.CurrentCulture.name},useLPP:!0,isTestEnv:this.Zjm()};this.hz=canvasAtMentions.FactoryGlobal.getWordAtMentionsControllerInstance(b);this.W.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>
{h.isFeatureEnabled("MsoContextIq",!1).then(n=>{n&&SE.a.B4c()?this.W.ha("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new LC(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.W.resolve("Box4.ISelectionManager"),this.W.Za("WordEditor.CanvasContextual.ContextIQIntentProvider"))).singleInstance():this.W.ha("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new Os(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.hz,this.W.resolve("Box4.ITextMetricsAdapter"),this.W.resolve("Box4.ICaretPositionManager"),
this.W.resolve("Box4.ISelectionManager"),cb.InteractiveViewManager.instance,this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener"),this.W.resolve("Common.Utils.IAriaNotifier"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).singleInstance();this.W.resolve("WordEditor.AtMentions.IWordEditorAtMentionsHandler").FKi()})})}Zjm(){var b,h;const n=null!==(b=u.AFrameworkApplication.sessionStartInfoSettings.Ring)&&
void 0!==b?b:"-1";b=null!==(h=u.AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)&&void 0!==h?h:"";return n===yv.Hlj&&b===yv.Glj}}yv.Hlj="-4";yv.Glj="DC2";yv.Tlj="webasynccollabeng";yv.qnj="AtMentions";yv.Kqj="AtMentionsFeatureUsage";Object(r.a)(yv,"PackageManager",null,[1,2]);var Vp=d(1621);class wt{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;this.shouldTakeFocus=!1}}Object(r.a)(wt,"CommonOptionalButtonProperties",
null,[]);class Vt extends wt{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null}}Object(r.a)(Vt,"OptionalButtonProperties",wt,[]);var Dh=d(1365);class qj{constructor(b,h,n,x,E,S){this.Jf=b;this.WDe=h;this._augLoopRuntimeManager=n;this.K7c=x;this.syj=E;this.JYj=S;this.Gvg=this.GWg=this.HWg=this.xDe=0;this.Mod=!1;this.t5a=null;this.UJg=this.vJg=!1;this.lAj=new Map([["ReferencesSmartLookUp",!0],["SmartLookupSynonyms",!0],["SmartLookupContextMenu",
!0],["SmartLookupDictionary",!0],["ChangePicture",!0]]);this.$yj=[{id:`${Uh.Lac}_${1}`},{id:`${Uh.Lac}_${2}`},{id:`${Uh.Lac}_${3}`},{id:Dh.a.sxd},{id:Dh.a.Svd},{id:Dh.a.eZd},{id:Dh.a.bZd}];this.Btj=[{id:"NewComment",count:2},{id:"CreatePullQuote"},{id:"DeleteBookmarkContextMenu"},{id:"EditBookmarkNameContextMenu"},{id:"EditIllustration"},{id:"CreateHeadingLink"},{id:"RemoveContentControl"},{id:"ReviewDesignerSuggestion"}];this.l7c=new Map;this.NKg=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SearchSuggestionInContextMenuIsEnabled",
!1);this.xGj=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdaptiveContextMenuIsEnabled",!1);this.tKg=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.PersonalizerInContextMenuIsEnabled",!1);this.THj=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenHyperlinkInlineViewIsEnabled",!1);this.PKj=u.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.AcmMaximumSuggestions",8);this.vJg=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.GenericSignalSchemaIsEnabled",
!1);this.UJg=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.LoggingIntentIsEnabled",!1);this.ywj=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CanvasContextFeature",!1);this.uSb=new Map;this.Jf.mb(this,Vp.SearchSuggestionAnnotation.getTypeName());u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&(u.AFrameworkApplication.K.$("IsO365CommercialHost")||u.AFrameworkApplication.K.$("IsO365ConsumerHost"))&&
this.l7c.set("InsertLink","InsertLinkFlyout");this.l7c.set("GraphicsEditor","");this.fej()}O7m(b,h){const n=Date.now();this.xDe&&1250>n-this.xDe||0<this.uSb.size||(this.xDe=n,this.t5a=b,this.xld=this.NHl(h),this.avn(),this.GWg=Date.now(),this.vJg?this.otn():this.ntn())}mI(b,h){if(b.annotationType===Vp.SearchSuggestionAnnotation.getTypeName()&&b.content&&h===eg.a.getTypeName()){h=Date.now();b=b.content;var n=this.uSb.get(b.correlationId);if(n){window.clearTimeout(n.$3f);this.uSb.delete(b.correlationId);
n.eDi&&(this.K7c.oxn=n.eDi);var x=b.menuSuggestions&&0<b.menuSuggestions.length,E=b.searchSuggestions&&0<b.searchSuggestions.length,S=!0;x&&(this.Tho(b.menuSuggestions,b.searchSuggestions),this.Mod&&(S=!1));S&&this.lOi();w.ULS.sendTraceTag(572057625,1303,50,JSON.stringify({["description"]:"[Zero term context menu] augloop response latency",["correlationId"]:b.correlationId,["requestPreparationTime"]:this.HWg,["canvasContextRetrievalTime"]:this.Gvg,["networkTime"]:b.networkTime,["executionTime"]:b.executionTime,
["updateTime"]:Date.now()-h,["latencyMs"]:h-n.timestamp,["containsZTM"]:x,["expectedZTM"]:n.IAd,["containsSearchSuggestions"]:E,["expectedSearchSuggestions"]:n.K6e,["fallBack"]:S}))}}}NHl(b){const h=[],n=new Map,x=Date.now();for(const E of b){if(!E)continue;b=[];const S={itemsMetadata:new Jc.a};for(let ma=0;ma<E.ControlList.length;ma++){const Fa=E.ControlList[ma];if(Fa&&!Fa.ExternalId)continue;b.push(Fa.ExternalId);const $a={timeStamp:x,source:"FallbackZeroTermMenu",confidenceScore:-1};S.itemsMetadata[Fa.ExternalId]=
$a;n.set(Fa.ExternalId,$a)}h.push(appChrome.api.menuSection(b,E.Title,E.Lang,E.Id,S))}return{sections:h,commands:n}}Iaj(b){return this.l7c.has(b)?this.l7c.get(b):b}OEa(b){if(!u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableUpdateControls",!1)){var h={};for(const n of b)b=this.Iaj(n.suggestion),appChrome.selectors.isControlDefined(b)&&(h[b]=appChrome.selectors.getModelType(b));ob.App.xa.GCd(h)}}Y8l(b){return!appChrome.selectors.isControlDefined(b)||appChrome.selectors.isControlDisabled(b)?
!1:this.lAj.has(b)?this.xld.commands.has(b):!0}quh(b){return appChrome.actions.updateMenu("ZeroTermContextMenu",b,null,null,null,null,{menuTargetType:this.t5a})}Fcb(b=!1){b=b?xm.a.instance.Rmc:xm.a.instance.Fcb();const h=[],n=Date.now();for(let x of b)x.commandId&&h.push({Id:x.commandId,TimeElapsedSinceClick:(n-x.timeStamp)/1E3,ContentType:x.contentType,CommandSurface:x.commandSurface,InputMethod:x.Qw});return h}N1b(){const b=xm.a.instance.N1b(),h=[],n=Date.now();for(let x of b)x.controlId&&h.push({Id:x.controlId,
TimeElapsedSinceClick:(n-x.timeStamp)/1E3,ContentType:x.contentType,CommandSurface:x.commandSurface,InputMethod:x.Qw});return h}Baf(){let b={semantic:Vp.ObjectSemantic.CanvasContext,type:Vp.ObjectSchemaType.WordCanvasContext,value:{contentType:this.t5a}};if(this.ywj){const h=Date.now(),n=this.JYj.Baf(kh.a.instance.ib.kb);n&&n.value.contentType&&(b.value=n.value);this.Gvg=Date.now()-h}return b}nll(){const b=this.N1b(),h=this.Fcb(),n=this.Fcb(!0),x=[];x.push({semantic:Vp.ObjectSemantic.ControlIdHistory,
type:Vp.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Vp.SequenceType.ControlId,Sequence:b}});x.push({semantic:Vp.ObjectSemantic.CommandIdHistory,type:Vp.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Vp.SequenceType.CommandId,Sequence:h}});x.push({semantic:Vp.ObjectSemantic.FilteredCommandIdHistory,type:Vp.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:Vp.SequenceType.CommandId,Sequence:n}});x.push(this.Baf());return x}XUh(){if(!this.tKg)return null;
const b={RankRequestData:{EventId:na.a.create().toString()},RewardRequestData:this.K7c.nxn};this.K7c.cQi();return b}fej(){this._augLoopRuntimeManager.getSession().then(b=>this.k6c=b).catch(()=>{this.k6c=void 0})}otn(){const b=this.nll(),h=[Vp.IntentIds.ZeroTermMenu];this.UJg&&h.push(Vp.IntentIds.Logging);this.NKg&&h.push(Vp.IntentIds.KeyPhrases);const n=this.XUh();this.w7i(null,null,n,h,b)}ntn(){const b={CommandClickedEvents:this.N1b(),CommandActionEvents:this.Fcb(),ContentType:this.t5a},h=this.NKg?
this.jRh():null,n=this.XUh();this.w7i(b,h,n)}w7i(b,h,n,x,E){var S,ma,Fa,$a;if(b||E){var sb=new Vp.SearchSuggestionSignal({correlationId:this.Mll(),intents:x,personalizerData:n,contextObjects:E,context:null===h||void 0===h?void 0:h.neighborhood,start:null!==(S=null===h||void 0===h?void 0:h.mentionStart)&&void 0!==S?S:0,length:null!==(ma=null===h||void 0===h?void 0:h.mentionLength)&&void 0!==ma?ma:0,zeroTermMenuRequest:b});n=window.setTimeout(()=>{this.vUm(sb.correlationId)},750);b={IAd:!!b,K6e:!!h,
timestamp:Date.now(),$3f:n,eDi:null===($a=null===(Fa=sb.personalizerData)||void 0===Fa?void 0:Fa.RankRequestData)||void 0===$a?void 0:$a.EventId};this.HWg=Date.now()-this.GWg;this.uSb.set(sb.correlationId,b);Fa=new eg.l({parentPath:["Signal",Vp.SearchSuggestionSignal.getTypeName()],items:[{id:na.a.create().toString(),body:sb}]});this.k6c&&!this.k6c.isClosed?this.k6c.submitOperation(Fa):(this._augLoopRuntimeManager.submitOperation({operation:Fa}),this.fej());w.ULS.sendTraceTag(574441286,1303,50,JSON.stringify({["description"]:"[Zero term context menu] search suggestion al workflow invocation",
["correlationId"]:sb.correlationId,["containsZTM"]:b.IAd,["containsSearchSuggestions"]:b.K6e,["intents"]:x}))}else w.ULS.sendTraceTag(556892510,1303,15,"No search suggestion al workflow will be activated")}Mll(){const b=na.a.create().toString();appChrome.api.setOfeCorrelationId("ACM",b);return b}vUm(b){const h=this.uSb.get(b);h&&(this.uSb.delete(b),h.IAd&&this.lOi(),w.ULS.sendTraceTag(572057624,1303,15,JSON.stringify({["description"]:"[Zero term context menu] augloop request timeout",["correlationId"]:b,
["containsZTM"]:h.IAd,["containsSearchSuggestions"]:h.K6e})))}lOi(){const b=this.quh(this.xld.sections);appChrome.api.dispatch(b);this.Znh()}Znh(){this.Mod=!0}hnn(b){var h,n;const x=[],E=new Map;if(!b||0===b.length)return x;for(const S of b){if(!S||!S.controlIds||0===S.controlIds.length)continue;b={controlIds:[],id:S.id,title:S.title,lang:S.lang,data:{itemsMetadata:new Jc.a}};const ma="CommandsZTM"===S.id;for(const Fa of S.controlIds){if(E.has(Fa))continue;if(ma&&b.controlIds.length>=this.PKj)break;
const $a=null===(n=null===(h=S.data)||void 0===h?void 0:h.itemsMetadata)||void 0===n?void 0:n[Fa];E.set(Fa,$a);b.controlIds.push(Fa);$a&&(b.data.itemsMetadata[Fa]=$a)}0<b.controlIds.length&&x.push(b)}return x}avn(){this.Mod=!1;if(this.xGj){const b=[appChrome.actions.updateControlHiddenState("ContextMenu",!0),appChrome.actions.updateControlEnabledDisabledState("ZeroTermContextMenu",!1)];appChrome.api.dispatch(b)}}Tho(b,h){this.Mod||(b=this.$dl(b,h),0<b.length&&appChrome.api.dispatch(b))}$dl(b,h){const n=
[];let x=[];var E=this.MBl();E&&0<E.length&&x.push(...E);(E=this.Ycl())&&x.push(E);(E=this.zdl(n))&&x.push(E);Array.isArray(b)&&0<b.length&&(this.THj&&(E=this.syj.E3m(n))&&b.unshift({suggestion:E,rankingScore:-1,suggestionSource:"RichCommandZeroTermMenu"}),b=this.Fra(b))&&(b.id="CommandsZTM",x.push(b));Array.isArray(h)&&0<h.length&&(h=this.Bdl(h,n))&&x.push(h);(h=this.Ocl())&&x.push(h);x=this.hnn(x);if(0===x.length)return[];this.tKg&&(this.K7c.sto=this.HDk(x));n.push(this.quh(x));this.Znh();return n}zdl(b){const h=
[],n={itemsMetadata:new Jc.a};if(this.WDe){var x=this.WDe.Cen();const E=Date.now();for(const S of x)x=S.wRi.actionId,n.itemsMetadata[x]={timeStamp:E,source:this.WDe.source,confidenceScore:S.score},appChrome.selectors.isControlDefined(x)||b.push(S.wRi.Vcl()),h.push(x)}return 0<h.length?appChrome.api.menuSection(h,null,null,null,n):null}MBl(){var b,h;const n=null===(b=this.xld)||void 0===b?void 0:b.sections.filter(x=>{var E;return null===(E=x.id)||void 0===E?void 0:E.startsWith(Uh.OAh)});for(const x of n)if(null===
(h=x.data)||void 0===h?0:h.itemsMetadata)for(const E in x.data.itemsMetadata)x.data.itemsMetadata[E].source="PassThroughZeroTermMenu";return n}Ycl(){const b=this.uJh(this.$yj,"DefaultZeroTermMenu");return this.Fra(b)}Ocl(){const b=this.uJh(this.Btj,"AdvertizedZeroTermMenu");return this.Fra(b)}uJh(b,h){const n=[];for(const x of b)x&&this.ySn(x)&&this.xld.commands.has(x.id)&&n.push({suggestion:x.id,rankingScore:-1,suggestionSource:h});return n}ySn(b){if("number"!==typeof(null===b||void 0===b?void 0:
b.count))return!0;if(0===b.count)return!1;b.count--;return!0}HDk(b){const h=[];for(let x of b)for(let E of x.controlIds){var n=x.data;b=-1;let S=null;n&&n.itemsMetadata&&(n=n.itemsMetadata[E],b=n.confidenceScore,S=n.source);h.push({suggestion:E,rankingScore:b,suggestionSource:S})}return h}Bdl(b,h){const n=[],x=[],E={itemsMetadata:new Jc.a};this.iFd();let S=0;for(let Fa of b){b=Fa.suggestion;var ma={neighborhood:b,mentionStart:0,mentionLength:b.length};ma=(new Hq.a).zth(ma,23,null);b=Object.assign(new Pg.a,
{ExternalId:"ZeroTermContextMenuSearchSuggestion"+S,LabelText:this.NZe(b,WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookupSubmenu_SearchMore),CommandValueId:ma});if(appChrome.selectors.isControlDefined(b.ExternalId))h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),h.push(appChrome.actions.setButtonCommandValueId(b.ExternalId,ma));else{ma={};const $a=Object.assign(new Vt,{commandValueId:b.CommandValueId});ma["default"]=
"Insights_20";$a.iconSet=ma;x.push(appChrome.api.createButtonModel(b.ExternalId,b.LabelText,$a))}n.push(b.ExternalId);E.itemsMetadata[b.ExternalId]={timeStamp:Date.now(),source:Fa.suggestionSource?Fa.suggestionSource:"SearchSuggestion",confidenceScore:Fa.rankingScore};S++;if(3<=S)break}0<x.length&&h.push(appChrome.actions.addControls(x));return n&&0<n.length?appChrome.api.menuSection(n,null,null,null,E):null}Fra(b){const h=[],n={itemsMetadata:new Jc.a},x=Date.now();this.OEa(b);for(let E of b)b=this.Iaj(E.suggestion),
this.Y8l(b)&&(h.push(b),n.itemsMetadata[b]={timeStamp:x,source:E.suggestionSource,confidenceScore:E.rankingScore});return 0<h.length?appChrome.api.menuSection(h,null,null,null,n):null}jRh(){return(new Hq.a).agf()}iFd(){const b=this.jRh();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}GGd(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=B.a.Ky(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}NZe(b,h,n){(b=this.GGd(b))&&0<b.length&&(n=String.format(h,b));return n}}
Object(r.a)(qj,"AugLoopSearchSuggestionManager",null,[179,505]);var TE=d(494),BD=d(310);d(1780);class CD{constructor(b){this.Nob=b;this.hxc=[];TE.a.instance.QNe(this.IPl.bind(this))}IPl(b,h){b={commandId:h.actionName,timestamp:h.timeStamp};(new NC).ofo(b)&&(Array.insert(this.hxc,0,b),this.hxc.length>this.Nob.loi&&Array.removeAt(this.hxc,this.Nob.loi))}}Object(r.a)(CD,"ActionContextCache",null,[]);class MC{constructor(b){this.Ms=b}get paragraphId(){return this.Ms&&this.Ms.Qa&&this.Ms.Qa.node&&this.Ms.Qa.node.id&&
this.Ms.Qa.node.id.guid?this.Ms.Qa.node.id.guid.toString():null}}Object(r.a)(MC,"SelectionDetailFetcher",null,[]);class NC{ofo(b){return"BrowserPasted"===b.commandId||"ImageResize"===b.commandId?(b.paragraphId=(new MC(this.X1())).paragraphId,!0):!1}X1(){var b=ob.App.xa.jb.Jc;return b?(b=b.Cb)&&b.ib&&b.ib.length?b.ib.kb:null:null}}Object(r.a)(NC,"ActionContextFetcher",null,[]);class DD{constructor(b,h,n){this.Nob=b;this.ga=h;this.dWg=n;this.source="RichAction";this.bln()}Cen(){const b=[];for(const h of this.dWg){const n=
h.uDh();n>=this.Nob.threshold&&b.push({score:n,wRi:h})}b.sort((h,n)=>n.score-h.score);return b.slice(0,Math.min(this.Nob.topN,b.length))}bln(){for(const b of this.dWg){const h=b.i3k;this.ga.gb(h.nyk,h.contextId,h.handler,h.flags)}}}Object(r.a)(DD,"ActionRecommender",null,[]);var nB;(function(b){b.Yvo="WordEditor.ContextualSearch.RichAction.PreviousParagraphFormatApplier";b.Xvo="WordEditor.ContextualSearch.RichAction.NextParagraphFormatApplier";b.Wvo="WordEditor.ContextualSearch.RichAction.AdjacentImageAligner"})(nB||
(nB={}));Object(r.b)("RichActionRegisterNames",nB);class OC{constructor(){this.topN=2;this.threshold=.5;this.loi=50;this.UDm=3}}Object(r.a)(OC,"FeatureSetting",null,[]);class oB{constructor(b,h,n,x,E){this.Cb=b;this.iconName=h;this.actionId=n;this.SZj=x;this.Ywk=E;this.EG=void 0}get i3k(){return{nyk:this.Ywk,contextId:Ld.a.frame,handler:this.oda.bind(this),flags:1028}}Vcl(){const b=new Vt;var h={};h["default"]=this.iconName;b.iconSet=h;h=[];h.push(appChrome.api.createButtonModel(this.actionId,this.SZj,
b));return appChrome.actions.addControls(h)}oda(b,h,n){if(1===n)return 32;h=new Se.GraphTransaction(15);h.Db(this.EG.Qa.node);h.zl=b;b=this.execute();h.dispose();return b}}Object(r.a)(oB,"RichAction",null,[]);class pz extends oB{constructor(b,h,n,x){super(b,"FormatPainter_20","previous"===x?"RaNeighborPreviousParagraphFormatApplier":"RaNeighborNextParagraphFormatApplier",`Format as ${x} paragraph`,"previous"===x?ub.a.qHi:ub.a.pHi);this.mJ=h;this.nfe=n;this.kuj=x;this.aSb=void 0}uDh(){var b,h,n;this.EG=
null===(h=null===(b=this.Cb)||void 0===b?void 0:b.ib)||void 0===h?void 0:h.kb;this.aSb=void 0;if(1!==(null===(n=this.EG)||void 0===n?void 0:n.length)||!Cd.ParagraphReader.wh(this.EG.Qa.iterator)||this.EG.JL||!this.S9l)return 0;b=Cd.ParagraphReader.Vg(this.EG.Qa.node,"previous"===this.kuj,!1,!1);if(!b||!Cd.ParagraphReader.oc(b)||!this.qdi&&!this.Qbm)return 0;this.aSb=b;return.9}execute(){if(!this.EG||!this.aSb)return 16;var b=Dd.a.createTextRange(this.aSb,0,Cd.ParagraphReader.textLength(this.aSb));
b=new om.Selection([b],!1);this.mJ.WJf(b);this.qdi?(b=Dd.a.createTextRange(this.EG.Qa.node,0,Cd.ParagraphReader.textLength(this.EG.Qa.node)),b=new om.Selection([b],!1),this.mJ.Zqd(b)):this.mJ.Zqd(this.EG);this.aSb=this.EG=void 0;return 32}get qdi(){return this.EG.Qa.cpBegin===this.EG.Qa.cpEnd}get Qbm(){return 0===this.EG.Qa.cpBegin&&this.EG.Qa.cpEnd===Cd.ParagraphReader.textLength(this.EG.Qa.node)}get S9l(){for(const b of this.nfe.hxc)if("BrowserPasted"===b.commandId){const h=b.paragraphId;if(h){const n=
(new MC(this.EG)).paragraphId;if(h===n)return!0}}return!1}}Object(r.a)(pz,"NeighborParagraphFormatApplier",oB,[]);class ED extends pz{constructor(b,h,n){super(b,h,n,"previous")}}Object(r.a)(ED,"PreviousParagraphFormatApplier",pz,[]);class FD extends pz{constructor(b,h,n){super(b,h,n,"next")}}Object(r.a)(FD,"NextParagraphFormatApplier",pz,[]);class GD extends oB{constructor(b,h,n,x){super(b,"FormatPainter_20","RaAdjacentImageAligner","Align images",ub.a.oHi);this.hj=h;this.nfe=n;this.Nob=x;this.$Mb=
void 0}uDh(){var b,h,n;this.EG=null===(h=null===(b=this.Cb)||void 0===b?void 0:b.ib)||void 0===h?void 0:h.kb;if(1!==(null===(n=this.EG)||void 0===n?void 0:n.length)||!this.EG.JL)return 0;var x=Pd.ImageReader.Xl(this.EG.Qa);b=this.bKh(this.EG.Qa.node,!0);h=this.l9h(x,b.HWb);n=this.bKh(this.EG.Qa.node,!1);x=this.l9h(x,n.HWb);if(h&&!x)return this.$Mb=b.HWb,.9;if(x&&!h)return this.$Mb=n.HWb,.9;if(!h&&!x)return 0;this.$Mb=this.j7l(n.n8j)?n.HWb:b.HWb;return.9}execute(){if(!this.EG||!this.$Mb)return 16;
const b=Pd.ImageReader.Xl(this.EG.Qa),h=Pd.ImageReader.zB(this.$Mb),n=Pd.ImageReader.nA(this.$Mb);this.hj.tZi(b,this.EG.Qa,n,h);return 32}bKh(b,h){let n=void 0,x=void 0;try{for(let E=-1;E<this.Nob.UDm;++E){n=Cd.ParagraphReader.Vg(b,h,!1,!1);if(!n)break;if(x=Pd.ImageReader.Xl(Dd.a.createTextRange(n,0,Cd.ParagraphReader.textLength(n))))break;if(0<Cd.ParagraphReader.textLength(n))break;b=n}}catch(E){w.ULS.sendTraceTag(545861641,1303,10,"Exception as getting adjacent image. Error: {0}",E),x=n=void 0}return{n8j:n,
HWb:x}}l9h(b,h){if(!h)return!1;const n=Pd.ImageReader.zB(b);b=Pd.ImageReader.nA(b);const x=Pd.ImageReader.zB(h);h=Pd.ImageReader.nA(h);return n===x&&b===h?!1:!0}j7l(b){b=b.id.guid.toString();for(const h of this.nfe.hxc)if("ImageResize"===h.commandId)return h.paragraphId===b;return!1}}Object(r.a)(GD,"AdjacentImageAligner",oB,[]);class pB{constructor(b){this.Ac=b;this.dxc=null;this.U8a={EventId:null};this.ide=(h,n,x,E,S)=>{var ma;if(1===x)return 32;if(!this.dxc||0===this.dxc.filter(Fa=>Fa.suggestionSource===
pB.source).length)return this.cQi(),32;S&&S.h3k&&(this.U8a.ExecutedSuggestion={suggestion:null!==(ma=S.SFo)&&void 0!==ma?ma:S.h3k,suggestionSource:S.source,rankingScore:S.confidenceScore});this.U8a.OfferedSuggestions=this.dxc;return 32};this.Vb()}Vb(){this.Ac.gb(ub.a.ide,Ld.a.frame,this.ide,1124)}cQi(){this.U8a={EventId:null};this.dxc=null}set oxn(b){this.U8a.EventId=b}set sto(b){this.dxc=b}get nxn(){return this.U8a&&this.U8a.EventId&&this.U8a.OfferedSuggestions?this.U8a:null}}pB.source="Personalizer";
Object(r.a)(pB,"ContextualSearchPersonalizerActor",null,[250]);class HD{}Object(r.a)(HD,"DocumentItem",null,[]);class Sx{constructor(b){this.Cb=b;this.bYj=RegExp("^(docx|pptx|ppsx|xlsx|pdf)$");this.cYj=["sharepoint.com","sharepoint-df.com"]}eGl(){var b,h;let n=null;const x=null===(h=null===(b=this.Cb)||void 0===b?void 0:b.ib)||void 0===h?void 0:h.kb;if(!x)return null;b=x.Qa;if(32!==u.AFrameworkApplication.ya.Qf(b,Db.a.ENa,1,!0,null,null))return n;(b=nh.HyperlinkReader.Y2b(b))&&1===b.length&&(n=decodeURIComponent(b[0].hyperlink.url));
return n}mol(b){const h=b.lastIndexOf(".");if(0>h)return null;b=b.substring(h+1).toLowerCase();return this.bYj.test(b)?b:null}mlm(b){const h=new URL(b);return h&&h.hostname&&this.cYj.find(n=>h.hostname.toLowerCase().includes(n))?!0:!1}E3m(b){const h=[];var n=new Hq.a,x=this.eGl();if(!x||!this.mlm(x))return null;const E=this.mol(x);if(!E)return null;x={landingTab:"Files",data:{type:3,l2Document:Object.assign(new HD,{Id:na.a.create().toString(),Path:x,FileType:E,LastModifiedTime:null})}};n=n.zth({neighborhood:"",
mentionStart:0,mentionLength:0},10,x);appChrome.selectors.isControlDefined("OpenHyperlinkInlineView")||(x=Object.assign(new Vt,{commandValueId:n}),h.push(appChrome.api.createButtonModel("OpenHyperlinkInlineView",WordRibbonStrings.OpenHyperlinkInSidebar,x)));x=Object.assign(new Pg.a,{ExternalId:"OpenHyperlinkInlineView",CommandValueId:n});b.push(appChrome.actions.setButtonCommandValueId(x.ExternalId,n));0<h.length&&b.push(appChrome.actions.addControls(h));return x.ExternalId}}Object(r.a)(Sx,"ContextualSearchHyperlinkProcessor",
null,[248]);class Fj{constructor(){this.W=null}get name(){return"WordEditor.ContextualSearch"}zc(b){this.W=b;u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RichActionInContextMenuIsEnabled",!1)&&(this.W.ha("WordEditor.ContextualSearch.RichAction.FeatureSetting",()=>new OC).singleInstance(),this.W.ha("WordEditor.ContextualSearch.RichAction.ActionContextCache",()=>new CD(this.W.resolve("WordEditor.ContextualSearch.RichAction.FeatureSetting"))).singleInstance(),this.W.ha("WordEditor.ContextualSearch.RichAction.PreviousParagraphFormatApplier",
()=>new ED(Kb.App.fm.jb.Jc.Cb,this.W.resolve("Box4.IFormatPainter"),this.W.resolve("WordEditor.ContextualSearch.RichAction.ActionContextCache"))).singleInstance(),this.W.ha("WordEditor.ContextualSearch.RichAction.NextParagraphFormatApplier",()=>new FD(Kb.App.fm.jb.Jc.Cb,this.W.resolve("Box4.IFormatPainter"),this.W.resolve("WordEditor.ContextualSearch.RichAction.ActionContextCache"))).singleInstance(),this.W.ha("WordEditor.ContextualSearch.RichAction.AdjacentImageAligner",()=>new GD(Kb.App.fm.jb.Jc.Cb,
this.W.resolve("WordEditor.IImageEditor"),this.W.resolve("WordEditor.ContextualSearch.RichAction.ActionContextCache"),this.W.resolve("WordEditor.ContextualSearch.RichAction.FeatureSetting"))).singleInstance(),this.W.ha("WordEditor.ContextualSearch.RichAction.ActionRecommender",()=>new DD(this.W.resolve("WordEditor.ContextualSearch.RichAction.FeatureSetting"),u.AFrameworkApplication.ya,Object.keys(nB).filter(h=>h.startsWith("Ra",0)).map(h=>this.W.resolve(nB[h])))).singleInstance());this.W.ha("WordEditor.ContextualSearch.ContextualSearchPersonalizerActor",
()=>new pB(u.AFrameworkApplication.ya)).as("WordEditor.ContextualSearch.IContextualSearchPersonalizerActor").singleInstance();this.W.ha("WordEditor.ContextualSearch.ContextualSearchHyperlinkProcessor",()=>new Sx(Kb.App.fm.jb.Jc.Cb)).as("WordEditor.ContextualSearch.IContextualSearchHyperlinkProcessor").singleInstance();this.W.ha("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager",()=>new qj(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.Pa("WordEditor.ContextualSearch.RichAction.ActionRecommender"),
augLoop.ALFactoryGlobal.getAugLoopRuntimeManager(),this.W.resolve("WordEditor.ContextualSearch.IContextualSearchPersonalizerActor"),this.W.resolve("WordEditor.ContextualSearch.IContextualSearchHyperlinkProcessor"),this.W.resolve("Box4.CanvasContext.ICanvasContextProvider"))).as("WordEditor.ContextualSearch.ISearchSuggestionManager").singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{If.a.zn().then(()=>{this.start()})})}start(){this.W.resolve("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager")}dispose(){}static main(){N.a.instance.Pc(new Fj)}}
Object(r.a)(Fj,"PackageManager",null,[1,2]);var ID=d(333),Wt=d(923);class JD extends Wt.a{constructor(){super();this.documentUrl=this.scripts=null}}Object(r.a)(JD,"BootMessage",Wt.a,[]);var KD=d(1007);class LD{constructor(){this.BJ=null;this.tSm=b=>{if(b.target===this.BJ)if(void 0===b.data||null===b.data)w.ULS.sendTraceTag(50739143,3007,10,"WebWorker: The received message did not have any data.");else try{if("string"===typeof b.data){const h=z.a(b.data);this.e9d(h.api)?this.V5c.J(h.api).W8b(h.method,
h):w.ULS.sendTraceTag(50739144,3007,10,"WebWorker: The received message contained an unsupported API.")}}catch(h){w.ULS.sendTraceTag(50739145,3007,10,"WebWorker: Error routing a message received from a worker thread. Exception: {0}",h)}};this.V5c=new Do.a}gtf(){return!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}create(b,h){let n=!1;try{this.BJ=new Worker(b);this.BJ.onmessage=this.tSm;const x=Object.assign(new JD,
{api:0,method:0,scripts:h,documentUrl:document.URL});this.postMessage(x);this.gtf()&&KD.a.jsj(this.BJ);n=!0}catch(x){w.ULS.sendTraceTag(50442775,3007,10,"WebWorker: Error creating worker. Exception: {0}",x)}return n}postMessage(b){try{const h=z.c(b);this.BJ.postMessage(h)}catch(h){w.ULS.sendTraceTag(50442776,3007,10,"WebWorker: Error sending a message to worker thread. Exception: {0}",h)}}e9d(b){return this.V5c.xb(b)}h_j(b,h){this.e9d(b)&&w.ULS.sendTraceTag(50442777,3007,10,"WebWorker: We're overwriting an existing API in the collection.  ApiId: {0}",
b);this.V5c.Z(b,h)}lgl(b){return this.e9d(b)?this.V5c.J(b):null}}Object(r.a)(LD,"WebWorker",null,[66]);class PC{constructor(){this.f$f=[]}IMk(b,h){if(h){var n=u.AFrameworkApplication.vw(b.DTi,7),x=[];for(let E=0;E<b.qKb.length;E++){let S;switch(b.qKb[E].format){case 5:case 6:S=ID.a.Fdb(b.qKb[E].name);break;default:S=b.qKb[E].name}x.push(u.AFrameworkApplication.vw(S,b.qKb[E].format))}try{const E=URL.createObjectURL(new Blob(["importScripts('"+n+"');"],{type:"application/javascript"})),S=new LD;if(S.create(E,
x))for(this.f$f.push(S),n=0;n<b.d9d.length;n++){const ma=h.MFk(S,b.d9d[n]);ma&&S.h_j(b.d9d[n],ma)}}catch(E){w.ULS.sendTraceTag(50442778,3007,10,"Exception caught when creating a new worker. Exception: {0}",E.message)}}else w.ULS.sendTraceTag(42824902,3007,10,"CreateWebWorker: ApiFactory parameter was null.")}}Object(r.a)(PC,"WebWorkerCollection",null,[]);class MD{constructor(b,h){this.zLe=new PC;if(b){b=b.create();for(let n=0;n<b.length;n++)this.zLe.IMk(b[n],h)}else w.ULS.sendTraceTag(50442779,3007,
10,"WebWorkerRouter: configFactory parameter was null.")}sendMessage(b,h,...n){let x=!1;for(let S=0;S<this.zLe.f$f.length;S++){var E=this.zLe.f$f[S];E.e9d(b)&&((E=E.lgl(b))?x=E.dYb(h,n)||x:w.ULS.sendTraceTag(50442780,3007,10,"WebWorkerRouter: Failed to get an Api that is supported by the web worker. ApiId: {0}",b))}x||w.ULS.sendTraceTag(50442781,3007,10,"WebWorkerRouter: A SendMessage did not find a worker to succesfully send the message to. ApiId: {0}, MethodId: {1}",b,h)}}Object(r.a)(MD,"WebWorkerRouter",
null,[21]);class WB{constructor(){this.D=this.ST=0}}Object(r.a)(WB,"LongTaskInfo",null,[]);class QC{constructor(b,h){this.rLe=null;this.RAm=n=>{if(n){var x=[];for(let E of n.getEntries())E.duration>=this.gqo&&(n=new WB,n.ST=E.startTime,n.D=Math.round(E.duration),x.push(n));if(0<x.length){let E;(E=this.gP).sendMessage.apply(E,[1,3].concat(x))}}};b.b3(this.RAm);this.gP=h}get gqo(){null==this.rLe&&(this.rLe=u.AFrameworkApplication.K?u.AFrameworkApplication.K.rc("WordHangDetectionHangThresholdTime",2E3):
2E3);return this.rLe}}Object(r.a)(QC,"HangDetector",null,[]);class ND{constructor(){this.fUg=null;this.u5l=b=>{for(let h of this.UM)h(b)};this.UM=[];this.iSb=0}b3(b){this.iSb||this.QLm();1===this.iSb&&this.UM.push(b)}QAm(){return!!window.PerformanceObserver&&!!window.PerformanceLongTaskTiming&&!!PerformanceObserver.supportedEntryTypes&&-1!==Array.indexOf(PerformanceObserver.supportedEntryTypes,"longtask")}QLm(){if(!this.iSb)if(this.QAm())try{this.fUg=new PerformanceObserver(this.u5l),this.fUg.observe({type:"longtask"}),
this.iSb=1}catch(b){this.iSb=2,w.ULS.sendTraceTag(592479427,3008,10,"Failed to create PerformanceObserver with message {0}",b.message)}else this.iSb=2}}Object(r.a)(ND,"LongTaskListeners",null,[517]);class XB extends Wt.a{constructor(){super();this.LocalCobaltClusterId=this.LocalCobaltMachineId=this.LocalCobaltSessionId=this.sessionID=this.sessionStartInfoSettings=this.appSettings=null;this.LocalCobaltSessionHasBackup=!1;this.SettingsRoutedToServer=this.WaciiEnabledRequests=0;this.WacClusterId=null}}
Object(r.a)(XB,"SettingsMessage",Wt.a,[]);class Du{constructor(b){this.BJ=b}}Object(r.a)(Du,"WebWorkerApiMain",null,[]);class OD extends Du{constructor(b){super(b)}gtf(){return!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}dYb(b,h){if(!h)return w.ULS.sendTraceTag(591972375,3007,10,"InitializeWorkerApiMain: InitializeSettings called with a null methodParams value."),!1;if(1===b)return this.Iok(h);w.ULS.sendTraceTag(591972376,
3007,10,"InitializeWorkerApiMain: Unknown method called.  MethodId: {0}",b);return!1}W8b(b,h){switch(b){case 14:this.pRl(h);break;default:w.ULS.sendTraceTag(591972377,3007,10,"InitializeWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}Iok(b){if(2!==b.length)return w.ULS.sendTraceTag(591972378,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters.  Param Count: {0}",b.length),!1;if("object"!==typeof b[0]||"object"!==typeof b[1])return w.ULS.sendTraceTag(587343010,
3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters. Param[0] is Dictionary: {0}, Param[1] is Dictionary: {1}","object"===typeof b[0],"object"===typeof b[1]),!1;b=Object.assign(new XB,{api:0,method:1,appSettings:b[0],sessionStartInfoSettings:b[1],sessionID:u.AFrameworkApplication.userSessionId,LocalCobaltSessionId:jl.a.instance.pQ,LocalCobaltMachineId:jl.a.instance.lEb,LocalCobaltClusterId:jl.a.instance.q8b,LocalCobaltSessionHasBackup:jl.a.instance.Pta,WaciiEnabledRequests:jl.a.instance.ooa,
SettingsRoutedToServer:jl.a.instance.nYf,WacClusterId:u.AFrameworkApplication.Ze.P3});this.BJ.postMessage(b);return!0}pRl(b){this.gtf()&&b&&b.result&&(w.ULS.sendTraceTag(555877916,3007,15,"Receive initialize finished message"),this.Xlo())}Xlo(){Object(xu.__awaiter)(this,void 0,void 0,function*(){try{const b=yield new KD.a.ksj.WorkerUtilsTestClass(10);yield b.Hh(5);15==(yield b.counter)?w.ULS.sendTraceTag(555877917,3007,50,"WorkerUtils testing successfully"):w.ULS.sendTraceTag(555877918,3007,15,"WorkerUtils testing failed")}catch(b){w.ULS.sendTraceTag(555877919,
3007,10,"WorkerUtils failed with exception: {0}",b.message)}})}}Object(r.a)(OD,"InitializeWorkerApiMain",Du,[]);class PD extends Wt.a{constructor(){super();this.mockDataEnabled=!1;this.requestEndpoint=this.rootQuerySignature=null;this.appMode=0;this.activityFeedIsEnabled=!1;this.api=2;this.method=4}}Object(r.a)(PD,"CatchUpNetworkRequestWorkerRequestMessage",Wt.a,[]);class YB extends Du{constructor(b,h){super(b);this.Fzc=h}dYb(b,h){if(4===b)return b=Object.assign(new PD,{rootQuerySignature:h[0],requestEndpoint:h[1],
appMode:h[2],activityFeedIsEnabled:h[3]}),this.BJ.postMessage(b),!0;w.ULS.sendTraceTag(592189584,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unknown method called.  MethodId: {0}",b);return!1}W8b(b,h){switch(b){case 5:w.ULS.sendTraceTag(592189585,3012,50,"CatchUpNetworkRequestWorkerExternalApi: Message received for method: {0}",b);this.Fzc.HFn(h);break;default:w.ULS.sendTraceTag(592189586,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unsupported Method sent to the Api.  MethodId: {0}",b)}}}
Object(r.a)(YB,"CatchUpNetworkRequestWorkerExternalApi",Du,[]);class QD extends Wt.a{constructor(){super();this.taskInfo=null}}Object(r.a)(QD,"HangDetectionMessage",Wt.a,[]);class qz extends Wt.a{constructor(){super();this.taskInfo=null}}Object(r.a)(qz,"ReportLongTasksMessage",Wt.a,[]);class rz extends Du{constructor(b){super(b)}dYb(b,h){if(!h)return w.ULS.sendTraceTag(591972370,3008,10,"HangDetectionWorkerApiMain: HangDetection called with a null methodParams value."),!1;switch(b){case 2:return this.Hok(h);
case 3:return this.Vsn(h);default:return w.ULS.sendTraceTag(591972371,3008,10,"HangDetectionWorkerApiMain: Unknown method called.  MethodId: {0}",b),!1}}W8b(b){w.ULS.sendTraceTag(591972372,3007,10,"HangDetectionWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}Hok(b){if(1!==b.length||"object"!==typeof b[0])return w.ULS.sendTraceTag(591972373,3008,10,"HangDetectionWorkerApiMain: HangDetection called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=Object.assign(new QD,{api:1,method:2,taskInfo:b[0]});this.BJ.postMessage(b);return!0}Vsn(b){if(!b.length||!Object(pb.a)(WB,b[0]))return w.ULS.sendTraceTag(591972374,3008,10,"HangDetectionWorkerApiMain: ReportLongTasks called with incorrect parameters. Params length is {0}, Param[0] is LongTaskInfo is {1}",b.length,0<b.length?Object(pb.a)(WB,b[0]):!1),!1;b=Object.assign(new qz,{api:1,method:3,taskInfo:b});this.BJ.postMessage(b);return!0}}Object(r.a)(rz,"HangDetectionWorkerApiMain",
Du,[]);class Eu extends Wt.a{constructor(){super();this.context=this.textPredictionConfig=this.prediction=this.paragraphContent=null}}Object(r.a)(Eu,"LocalInferenceMessage",Wt.a,[]);class sz{constructor(){this.prediction=this.context=null}}Object(r.a)(sz,"LocalInferenceOutput",null,[]);class Ly{constructor(){this.modelFilesUrl=this.settings=this.scriptDirectory=null}}Object(r.a)(Ly,"TextPredictionConfig",null,[]);class Zw{constructor(){this.extendedRankLimit=0;this.dynamicTemporaryInDocModelNGramToken=
3}}Object(r.a)(Zw,"TextPredictionSettings",null,[]);class UE{constructor(){this.nGramOrder=0;this.modelFilesUrl=null}}Object(r.a)(UE,"TextPredictionDynamicPayload",null,[]);class ck extends Du{constructor(b,h){super(b);this.QYj=h}dYb(b,h){if(!h)return w.ULS.sendTraceTag(575959325,3008,10,"LocalInferenceWorkerApiMain: LocalInference called with a null methodParams value."),!1;switch(b){case 8:return this.Ook(h);case 7:return this.Jok(h);case 9:return this.Nok(h);case 10:return this.Kok(h);case 13:return this.Lok(h);
case 14:return this.Mok(h);default:return w.ULS.sendTraceTag(575959326,3008,10,"LocalInferenceWorkerApiMain: Unknown method called.  MethodId: {0}",b),!1}}W8b(b,h){switch(b){case 9:this.oSl(h);break;default:w.ULS.sendTraceTag(575959822,3007,10,"LocalInferenceWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}oSl(b){b&&b.prediction&&(b=Object.assign(new sz,{prediction:b.prediction,context:b.context}),this.QYj.jdh().Y7m(b))}Jok(b){if(1>b.length)return w.ULS.sendTraceTag(575959823,
3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceAddContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Eu,{api:4,method:7,paragraphContent:b,textPredictionConfig:this.getConfig()});this.BJ.postMessage(b);return!0}Ook(b){if(1>b.length)return w.ULS.sendTraceTag(575959824,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceRemoveContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Eu,{api:4,method:8,paragraphContent:b});this.BJ.postMessage(b);return!0}Nok(b){if(2>b.length)return w.ULS.sendTraceTag(575959825,3008,10,"LocalInferenceWorkerApiMain: callLocalInferencePredict called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;var h=b[0];b=b[1];h=Object.assign(new Eu,{api:4,method:9,paragraphContent:b,context:h});this.BJ.postMessage(h);return!0}Kok(b){if(1>
b.length)return w.ULS.sendTraceTag(570782293,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceInit called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Eu,{api:4,method:10,textPredictionConfig:this.getConfig(b)});this.BJ.postMessage(b);return!0}Lok(b){if(1>b.length)return w.ULS.sendTraceTag(556827920,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Eu,{api:4,method:13,textPredictionConfig:this.sOh(b)});this.BJ.postMessage(b);return!0}Mok(b){if(1>b.length)return w.ULS.sendTraceTag(541733787,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,Object(pb.a)(Object,b[0])),!1;b=b[0];b=Object.assign(new Eu,{api:4,method:14,textPredictionConfig:this.sOh(b)});this.BJ.postMessage(b);return!0}getConfig(b=
null){return Object.assign(new Ly,{scriptDirectory:u.AFrameworkApplication.r_+"/intelligence/",settings:Object.assign(new Zw,{extendedRankLimit:0}),modelFilesUrl:b})}sOh(b=null){return Object.assign(new Ly,{scriptDirectory:u.AFrameworkApplication.r_+"/intelligence/",settings:Object.assign(new Zw,{dynamicTemporaryInDocModelNGramToken:b.nGramOrder}),modelFilesUrl:b.modelFilesUrl})}}Object(r.a)(ck,"LocalInferenceWorkerApiMain",Du,[]);class RC extends Du{constructor(b){super(b);u.AFrameworkApplication.rK(()=>
{this.sSc()})}dYb(b){w.ULS.sendTraceTag(591689869,3008,10,"ShutdownWorkerApiMain: CallMethod not supported on this API.  MethodId: {0}",b);return!1}W8b(b){w.ULS.sendTraceTag(591689870,3007,10,"ShutdownWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}sSc(){const b=Object.assign(new Wt.a,{api:3,method:6});this.BJ.postMessage(b)}}Object(r.a)(RC,"ShutdownWorkerApiMain",Du,[]);var RD=d(847),SD=d(594);class TD extends Wt.a{constructor(){super();this.args=null;this.numLogs=
0}}Object(r.a)(TD,"UlsWorkerMessage",Wt.a,[]);var SC=d(840),UD=d(967),VD=d(1024);class ZB extends UD.a{constructor(b,h,n,x,E){super(b,h,n,x,E);this.Kxe=null;this.IFe=!1;if(this.pLg=this.Ksf())if(b=x.lb("ContentBaseUrl")?6:5,x=x.lb("AppScriptBaseName"))x=u.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerScriptName",x+".{0}ulsworker.js"),x=ID.a.Fdb(x),x=u.AFrameworkApplication.vw(x,b),SC.createWorker({createMode:"Thread"},{local:SC.paramInsideDef(VD.ulsWorkerInsideInit),
$5n:SC.paramInsideDef(Object(VD.ulsWorkerInsideScript)(x))}).then(S=>{S.onClose=()=>{this.RJe=void 0};this.RJe=S},S=>{var ma=new Date;S=`UlsWorkerDefererHost threw an error: ${this.jGm(S)}`;console.error(S);ma=new SD.a(ma.getTime(),3007,545653664,10,S,0,!1,null,null);super.yW(ma);this.IFe=!0})}Ksf(){return!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",!1)}get sGm(){this.Kxe||(this.Kxe=Oa.a.instance.resolve("Box4.Workers.IWebWorkerRouter"));
return this.Kxe}wKa(b){this.IFe=b}yW(b){if(this.IFe)super.yW(b);else if(this.pLg)null!=this.RJe&&this.RJe.call.yW(b);else{let h;(h=this.sGm).sendMessage.apply(h,[5,11].concat([b]))}}jGm(b){if(null==b||"object"!==typeof b)return"unknown";const h=String(b.name),n=String(b.message);return null!=b.stack?(b=String(b.stack),0<=b.indexOf(n)&&0<=b.indexOf(h)?b:`${h}: ${n}\n${b}`):0<=n.indexOf(h)?n:`${h}: ${n}`}}Object(r.a)(ZB,"UlsWorkerDefererHost",UD.a,[]);class $B extends Du{constructor(b){super(b);this.KQg=
0;b=Oa.a.instance.Pa("Common.IRefreshableAppSettings");this.rVb=new ZB(RD.a.Exd,!0,u.AFrameworkApplication.Ze,null!==b&&void 0!==b?b:u.AFrameworkApplication.K,b);b=w.ULS.host;null!=b&&b.F3b(this.rVb);w.ULS.fkb(this.rVb);this.ZLg=rd.a.lf();this.NUj=2*u.AFrameworkApplication.K.rc("UlsWorkerStayAliveIntervalMS",6E4);this.rVb.wKa(!0)}dYb(b,h){if(11!==b||!h||1!==h.length||!Object(pb.a)(SD.a,h[0]))return!1;if(rd.a.lf()-this.ZLg>this.NUj)return this.rVb.wKa(!0),this.rVb.yW(h[0]),w.ULS.sendTraceTag(570770058,
3008,15,"UlsWorkerApiMain: Haven't heard from UlsWorkerApi recently"),!1;b=Object.assign(new TD,{api:5,method:b,args:h[0],numLogs:this.KQg});this.KQg++;this.BJ.postMessage(b);return!0}W8b(b,h){void 0!==h&&null!==h&&12===b&&(this.ZLg=rd.a.lf(),this.rVb.wKa(!1))}}Object(r.a)($B,"UlsWorkerApiMain",Du,[]);class WD{constructor(b){this.container=b}MFk(b,h){var n=null;switch(h){case 0:n=new OD(b);break;case 1:n=new rz(b);break;case 2:n=new YB(b,this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"));
break;case 3:n=new RC(b);break;case 4:n=new ck(b,this.container.resolve("Box4.WordPrediction.IWordPredictionAugLoop"));break;case 5:h=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsWorkerIsEnabled",!1);n=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",!1);n=(h||n)&&u.AFrameworkApplication.hsd?new $B(b):null;break;default:w.ULS.sendTraceTag(50442782,3008,10,"WordWebWorkerApiFactory: CreateApi was passed an unsupported ApiId. ApiId: {0}",
h)}return n}}Object(r.a)(WD,"WordWebWorkerApiFactory",null,[515]);var VE=d(259);class qB{constructor(b,h){this.name=b;this.format=h}}Object(r.a)(qB,"ImportedScript",null,[]);class tz{constructor(){this.d9d=this.qKb=this.DTi=null}}Object(r.a)(tz,"WebWorkerConfig",null,[]);var jp=d(1415);class TC{constructor(b){this.BHe=[];this.IHj=b;if(u.AFrameworkApplication.K){b=u.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||u.AFrameworkApplication.K.$("IsCombinedBundleEnabled");const h=u.AFrameworkApplication.K.lb("ContentBaseUrl")?
6:5,n=u.AFrameworkApplication.K.lb("AppScriptBaseName"),x=b?"":".";if(n){const E=b?"":"{0}",S=n+`${x}${E}worker.js`;this.BHe.push(new qB(`MicrosoftAjax${b?"":"DS"}.${E}js`,h),new qB(S,h));this.Ksf()&&this.BHe.push(new qB(n+`${x}${E}ulsworker.js`,h))}else w.ULS.sendTraceTag(558465106,3008,10,"WordWebWorkerConfigFactory: Failed to get AppScriptBaseName. Worker JS is not loaded")}else w.ULS.sendTraceTag(558465107,3008,10,"WordWebWorkerConfigFactory: AFrameworkApplication.appSettingsManager do not exist. Worker JS is not loaded")}create(){const b=
[],h=Object.assign(new tz,{DTi:"workerboot",qKb:this.BHe,d9d:[0,1,2,3,4,5]});this.IHj&&this.Y$l()&&h.qKb.push(new qB("intelligence/edge-inference-web.js",5));b.push(h);return b}Y$l(){return(new VE.a("arrowFunction",()=>{try{Object(jp.a)("const sum = (a, b) => a + b")}catch(b){return!1}return!0},!1)).isSupported()}Ksf(){return!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",!1)}}Object(r.a)(TC,"WordWebWorkerConfigFactory",
null,[244]);class UC{constructor(){this.Ma=this.W=null}get name(){return"WordEditor.Workers"}init(){const b=this.W.resolve("Box4.Workers.IWebWorkerRouter");b.sendMessage.apply(b,[0,1].concat([this.Ma.appSettings,u.AFrameworkApplication.sessionStartInfoSettings]))}dispose(){}zc(b){this.W=b;this.Ma=this.W.resolve("Common.IAppSettingsManager");const h=this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextPredictionEdge",!1);b.ha("Box4.Workers.WebWorkerRouter",()=>new MD(new TC(h),new WD(b))).as("Box4.Workers.IWebWorkerRouter").singleInstance();
b.ha("WordEditor.Workers.LongTaskListeners",()=>new ND).as("WordEditor.Workers.ILongTaskListeners").singleInstance();b.ha("WordEditor.Workers.HangDetector",()=>new QC(b.resolve("WordEditor.Workers.ILongTaskListeners"),b.resolve("Box4.Workers.IWebWorkerRouter"))).singleInstance()}static main(){N.a.instance.Pc(new UC)}}Object(r.a)(UC,"WordEditorWorkersPackage",null,[1,2]);var WE=d(1143);class XD{constructor(){this.njd=[]}yWh(b,h){let n=-1,x=null;x=E=>{E?h(this.njd[n]):(++n,n<this.njd.length?this.njd[n].hYb(b,
x):h(null))};x(!1)}hYb(b,h){this.yWh(b,n=>{h(!!n)})}Wbc(b,h,n){this.yWh(b,x=>{if(!x)throw Error.invalidOperation("ResolveUrl called without checking CanResolveUrl");x.Wbc(b,h,n)})}w7g(b){this.njd.push(b)}}Object(r.a)(XD,"CompositeExternalContentURLResolver",null,[510,511]);var uz=d(1411);class Jp extends uz.a{constructor(){super();this.Thumbnail=this.Author=this.Title=this.MediaType=null;this.Height=this.Width=0;this.IFrameHtml=null}}Object(r.a)(Jp,"ExternalContentEmbedResponse",uz.a,[]);var VC=d(1425),
YD=d(1338),XE=d(1305),ZD=d(1336),vz=d(698),iw=d(716),Is=d(201),js=d(841),zv;(function(b){b[b.autoCorrect=0]="autoCorrect";b[b.externalComponentPaste=1]="externalComponentPaste";b[b.externalHyperlinkPaste=2]="externalHyperlinkPaste";b[b.NAo=3]="externalContentFloatieConversion"})(zv||(zv={}));Object(r.b)("ExternalContentConversionContext",zv);class fg{constructor(){this.PDb=this.ODb=null;this.R6e=new ZD.ExternalContentEmbedRetriever;this.Vuc=!0;this.Dmc=this.Qn=this.K4h=this.J4h=this.em=this.fp=null;
this.picturePasteRequestSucceeded=()=>{w.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")};this.jac=()=>{w.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")};null!=fg.zka&&fg.zka.jNh()}get yJb(){return this.Vuc}set yJb(b){this.Vuc=b}UTe(b,h){let n=!1;if(b){switch(b.contextId){case cc.a.Wc:n=!h;break;case cc.a.Fd:n=!0}n&&!js.a(b.node)&&(n=!1)}return n}slm(b){const h=b.startsWith(nh.HyperlinkReader.Oac),n=b.startsWith(nh.HyperlinkReader.XUc),
x=b.startsWith(nh.HyperlinkReader.H_d);return(h||n||x)&&nh.HyperlinkReader.xMa(b)}jIi(){this.Qn=C.a.create();fg.vf.Zwb(this.Qn,4);fg.vf.Z2(this.Qn,0,fg.vf.eo());this.NBb(this.ODb,3,this.PDb,!0)}JLa(b,h,n){this.Qn=C.a.create();fg.vf.Zwb(this.Qn,n?0:2);fg.vf.Z2(this.Qn,0,fg.vf.eo());this.Dmc();this.NBb(b,n?0:2,h)}dZd(b,h){this.Qn=C.a.create();fg.vf.Zwb(this.Qn,1);fg.vf.Z2(this.Qn,0,fg.vf.eo());this.NBb(b,1,h)}yLd(b,h,n){if(!b||!b.isConnected||!Pd.ImageReader.qw(b))return null;const x=new vz.a;x.setValue(Th.a.o4b,
n);x.setValue(Th.a.NYa,h);x.VVa=this.J4h;x.hw=this.K4h;x.g_a=1===n;md.GraphIterator.$a(b).Sf(x,2);this.PQc(x);return x}bKi(b){this.Dmc=b}Dee(b,h){const n=fg.p_.x_b(h)||0;h=fg.p_.zWa(h)||0;const x=b.Width/b.Height;1<=x?(b.Width=n,b.Height=n/x):(b.Height=h,b.Width=h/x)}$ag(b,h,n){if(null!=b&&null!=h&&!B.a.nf(n)){var x=fg.dSc.F2b(n);x.ZDa=!0;x.hideFloatie=!0;this.Dee(b,h.node);this.M4b(b,h,!1,!1,x,n)}}Edb(b){return b?b.mf:0}D8f(b,h,n){let x=null;const E=b.node;if(!Cd.ParagraphReader.oc(E)||!E.isConnected)return{returnValue:!1,
joa:x};if(n)return{returnValue:!0,joa:b};n=b.cpBegin;const S=b.cpEnd,ma=Cd.ParagraphReader.text(E);if(0<=n&&S<=ma.length&&ma.substring(n,S)===h)return{returnValue:!0,joa:b};const Fa=ma.indexOf(h);return 0<=Fa?(x=Dd.a.createTextRange(E,Fa,Fa+h.length),{returnValue:!0,joa:x}):0<=n&&S<=ma.length&&this.R3b(b)?{returnValue:!0,joa:b}:{returnValue:!1,joa:x}}R3b(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=Dd.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=nh.HyperlinkReader.NC(h,!1);if(1===h.length){h=h[0];
const n=Cd.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==n)return!0}return!1}Wsf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}Iva(b,h){u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const n=Oa.a.instance.Za("Common.ISystemInitiatedFeedback");n&&n.execute(x=>{x.logActivity(b,h)})},fg.gka)}ocf(b,h){const n=!B.a.w1(h);switch(b){case 1:b=n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,
h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}NBb(b,h,n,x=!1){if(this.slm(n)){var E=fg.dSc.F2b(n);if(E)if(this.Wsf(E)){w.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent");b=Object(ja.a)(Dd.a,
b);var S=!h;this.UTe(b,S)?this.YMc(n)?(h=1===h,x=this.Fql(b),E.hideFloatie=!0,this.M4b(x,b,S,h,E,n)):this.cLf(b,h,E,n,x):fg.vf.GP(this.Qn,2,"URL inserted in Non-Embedable context",fg.vf.eo())}else w.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),fg.vf.GP(this.Qn,2,"Size provided is not valid for OEmbed",fg.vf.eo())}else w.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),fg.vf.GP(this.Qn,2,"URL inserted is not valid for ExternalContent",
fg.vf.eo())}Fql(b){let h=new Jp;h.Width=fg.p_.x_b(b.node)||0;h.Height=fg.p_.zWa(b.node)||0;h.Title="Fluid Component";h.MediaType="fluid";return h}YMc(b){return u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=fg.jfa&&fg.jfa.Yfi(b)}cLf(b,h,n,x,E){const S=!h,ma=1===h,Fa=fg.p_.x_b(b.node)||0,$a=fg.p_.zWa(b.node)||0,sb=VC.a.xXe(n.U7f,!0,Fa,$a);this.wQc(b,x,h,!0);this.R6e.akh(sb,Jb=>{fg.vf.Z2(this.Qn,4,fg.vf.eo());fg.vf.rZc(this.Qn,this.Edb(Jb.data));
if(Jb=this.iLf(Jb)){w.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var Sb=Is.o(Jb.MediaType);fg.vf.C1d(this.Qn,7,Sb);Sb=b;({joa:Sb}=this.D8f(b,x,ma)).returnValue?(this.wQc(Sb,x,h,!1),null==n.width?0<Fa&&Jb.Width>Fa&&(w.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Jb.Width=Fa):(w.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),
Jb.Width=this.A3c(n.width,Jb.Width,Fa)),null==n.height?0<$a&&Jb.Height>$a&&(w.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Jb.Height=$a):(w.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Jb.Height=this.A3c(n.height,Jb.Height,$a)),fg.zka.x5a||E?this.M4b(Jb,Sb,S,ma,n,x):(this.ODb=b,this.PDb=x,this.WBc(x))):(w.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),
fg.vf.GP(this.Qn,2,"No conversion as the context is no longer valid for the external content conversion",fg.vf.eo()));ma&&this.HVa(Sb.node)}else ma&&this.HVa(b.node),fg.vf.GP(this.Qn,1,"URL not oEmbedable",fg.vf.eo())},Jb=>{fg.vf.Z2(this.Qn,4,fg.vf.eo());fg.vf.rZc(this.Qn,this.Edb(Jb.data));ma&&this.HVa(b.node);w.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Jb.data.Ee);fg.vf.GP(this.Qn,2,"ExternalContentEmbedRequest failed",fg.vf.eo())},Jb=>{ma&&this.HVa(b.node);
w.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Jb)},this.Qn)}A3c(b,h,n){!b&&0<n&&h>n||b>n?(w.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=n):b>n?h=n:b&&b<n&&(h=b);return h}M4b(b,h,n,x,E,S){this.em=na.a.create();b.Width=b.Width/b.Height*(b.Height-(iw.a.aKd+iw.a.jda))+2*iw.a.jda;const ma=new Se.GraphTransaction(15);ma.Db(h.node);ma.zl=ub.a.JLa;const Fa=this.R3b(h);null!=E.ZDa&&
!E.ZDa||x||Fa||(b.Title=""===E.title||E.title?E.title:b.Title,!b.Title&&""!==b.Title)||(h=this.Tmf(h,ma,b.Title,S,n));if(h){x&&(h=this.E1e(h));var $a=this.Awd(h,x);if($a){n=Is.o(b.MediaType);var sb=this.DGd(b,n);this.J4h=b.IFrameHtml;this.K4h=b.Title;if($a=this.zmf($a,sb,ma,x,S,n))ma.tCa(this.em,1),ma.dispose(),this.ODb=h,this.PDb=S,this.iIf(E,b,$a),this.OKf(S,x||E.hideFloatie,Fa,n,b.Title)}else ma.dispose(),w.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),
fg.vf.GP(this.Qn,2,"Could not create IP context on splitting the paragraph",fg.vf.eo())}else fg.vf.GP(this.Qn,2,"GraphNodeContext is null",fg.vf.eo())}DGd(b,h){const n=new qi.DictionaryPropertySet;fg.qT.$Zd(n,b.Width,b.Height);b=this.ncf(h,b.Title);n.setValue(ie.a.imageAltText,b);n.setValue(ic.a.pT,Ub.a.JF());n.setValue(ic.a.imageType,0);return n}zmf(b,h,n,x,E,S){if(!b)return null;b=fg.qT.ELd(b,h);if(!b)return n.dispose(),w.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),
fg.vf.GP(this.Qn,2,"The anchored image could not be inserted",fg.vf.eo()),null;n=b.node;E=this.yLd(n,E,S);fg.vf.a7f(this.Qn,E.id);x||this.pWf(n);return n}iIf(b,h,n){B.a.w1(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(fg.vf.Z2(this.Qn,8,fg.vf.eo()),w.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.IDc(n,h.Thumbnail))}OKf(b,h,n,x,E){h||this.WBc(b);this.Iva("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");
this.hYd("IsHyperlinkWithNonURLDisplayText",n);this.ariaNotify(x,E);fg.vf.Z2(this.Qn,5,fg.vf.eo())}hYd(b,h){w.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");Y.a.sendTelemetryEvent(Object.assign(new fa.a,{name:"Office.Word.Online.ExternalContent.OEmbedInsertions",dataFields:[Object.assign(new ca.a,{name:b,bool:h})]}))}ariaNotify(b,h){this.yJb&&fg.fw&&(b=this.ocf(b,h),fg.fw.sendNotification(b,!0))}Tmf(b,h,n,x,E){if(E){if((E=nh.HyperlinkReader.NC(b,
!1))&&1!==E.length)return h.dispose(),w.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;fg.hyperlinkEditor.LQ(E[0].paragraph,E[0].hyperlink)}return this.WRf(b,n,x)}E1e(b){const h=b.node,n=Cd.ParagraphReader.text(h);return 0<n.length&&!n.trim().length?(b=Dd.a.createTextRange(h,0,n.length),fg.characterPropertiesEditor.replaceTextRange(b,""),Dd.a.Uc(h,0)):b}Awd(b,h){return h?b:this.hdf(b)}hdf(b){const h=Cd.ParagraphReader.text(b.node),
n=md.GraphIterator.$a(b.node);if(n.vd()){b=Dd.a.Uc(b.node,b.cpEnd);wf.OutlineElementNavigator.ae(n);const x=fg.eh.cta(n);fg.Kh.dba(n,x,b,!0,!0,!0,!0);""!=h&&fg.Kh.XC(n,!1,!0);n.Wd();return Dd.a.Uc(n.currentNode,0)}return null}iLf(b){if(!({group:b}=wl.a.G7(b.data.Ee)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}WRf(b,h,n){const x=b.cpBegin+h.length;fg.characterPropertiesEditor.replaceTextRange(b,h);b=Dd.a.createTextRange(b.node,b.cpBegin,x);fg.hyperlinkEditor.DG(b,n,!1);return b}ncf(b,
h){const n=!B.a.w1(h);switch(b){case 1:return n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}IDc(b,h){b.Bi().contentReplicator.forceOutbound(()=>{this.gLf(h,b)},()=>{w.ULS.sendTraceTag(592996173,
324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}PQc(b){b=md.GraphIterator.$a(b);b.Bb(12);b.kd(12);b.xn.rP=!0}HVa(b){b.dac=null}pWf(b){b=md.GraphIterator.$a(b);b.Bb(11)&&(b.kd(11),b.vd()&&b.xj()&&b.Wd()&&Cd.ParagraphReader.oc(b.currentNode)&&(b=Ae.SelectionFactory.xe(b.currentNode,0),kh.a.instance.setSelection(b)))}wQc(b,h,n,x){const E=b.cpBegin,S=b.cpEnd;b=Cd.ParagraphReader.text(b.node).trim();E||b!==h&&""!==b?E?S===b.length?w.ULS.sendTraceTag(590958601,324,
50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",zv[n],x):0<E&&S<b.length&&w.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",zv[n],x):w.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
zv[n],x):w.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",zv[n],x)}WBc(b){this.D_b();const h=new Go.a(1,u.AFrameworkApplication.isRtl);h.aUc=b;fg.$bb.$Vc(h)}D_b(){const b=new or.a(!0);fg.Z$b.mDa(b)}gLf(b,h){if(b=this.jff(b,h))h=Array(1),h[0]=b,b=YD.a.construct(h,!1,u.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.fp.Bs:null),h=this.D_e(),
this.Ijb(h,b)}jff(b,h){if(!h)return w.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.fp=h.Bi();(new md.GraphIterator).set(h);if(!h.anchor||!h.anchor.Gp||!h.anchor.Gp.vr)return w.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var n=h.anchor.Gp.vr.node;if(!n)return w.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),
null;let x=Ll.a.Bq;Of.a.instance.J(4)&&(x=n.ia(Ji.a.gK,Ll.a.Bq));n=h.getValue(ie.a.iL);const E=mf.a.yf(Pd.ImageReader.fI(h.properties),0),S=mf.a.yf(Pd.ImageReader.tL(h.properties),1);return XE.a.construct(h.id.toString(),b,h.ia(ie.a.imageAltText,""),E,S,h.ia(ic.a.GW,""),x,h.ia(ic.a.pT,0),h.ia(ic.a.Vea,!1),h.ia(Ji.a.Qda,-1),h.ia(ic.a.Pgb,Box4Intl.Box4Strings.l_Picture),h.ia(ie.a.Wea,!1),n,h.ia(ic.a.runId,1),h.ia(ic.a.Mc,0))}Ijb(b,h){u.AFrameworkApplication.Ze.Lj(b,2,z.c(h),{},!1,2,this.picturePasteRequestSucceeded,
this.jac,null,void 0,void 0,void 0,void 0,"26");w.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}D_e(){let b=Ec.a.XCd("PicturePaste.ashx");u.AFrameworkApplication.K&&!u.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=Ec.a.Jn(b,Qi.a.fileId,this.fp.Bs));b=Ec.a.Jn(b,Qi.a.cellId,this.fp.Zl.toString());this.em||(this.em=na.a.create(),w.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=Ec.a.Jn(b,
Qi.a.K1,this.em.toString());b=Ec.a.Jn(b,Qi.a.classId,(393233).toString());this.fp.YH&&(b=Ec.a.Jn(b,Qi.a.YH,this.fp.YH));b=Ec.a.Jn(b,Qi.a.kmb,"1");b=Ec.a.Jn(b,Ve.a.imageType,"0");b=jl.a.instance.DNe(b);this.fp.contentReplicator&&this.fp.contentReplicator.vDb&&(b=Ec.a.Jn(b,Qi.a.SRe,"1"));b=Ec.a.Jn(b,Qi.a.gra,this.fp.contentReplicator.$t.toString());b=Ec.a.Jn(b,Qi.a.bac,"0");return b=Ec.a.Jn(b,Qi.a.MLb,"1")}static get $bb(){return null!=fg.ghg?fg.ghg:fg.ghg=Oa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get zka(){fg.Twa||
(fg.Twa=Oa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return fg.Twa}static get Z$b(){return null!=fg.$ng?fg.$ng:fg.$ng=Oa.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get fw(){return null!=fg.efg?fg.efg:fg.efg=Oa.a.instance.resolve("Common.Utils.IAriaNotifier")}static get p_(){return null!=fg.Pog?fg.Pog:fg.Pog=Oa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get qT(){return null!=fg.Ljg?fg.Ljg:fg.Ljg=Oa.a.instance.resolve("WordEditor.IImageEditor")}static get eh(){return fg.Kh||
(fg.Kh=Oa.a.instance.resolve("Box4.IOutlineElementEditor"))}static get hyperlinkEditor(){return null!=fg.Bjg?fg.Bjg:fg.Bjg=Oa.a.instance.resolve("Box4.IHyperlinkEditor")}static get characterPropertiesEditor(){return null!=fg.Mfg?fg.Mfg:fg.Mfg=Oa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get vf(){return null!=fg.phg?fg.phg:fg.phg=Oa.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}static get dSc(){return null!=fg.Kmg?fg.Kmg:fg.Kmg=Oa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}static get jfa(){return null!=
fg.Dmg?fg.Dmg:fg.Dmg=Oa.a.instance.resolve("Fluid.Host.LoopComponentManager")}}fg.Kh=null;fg.gka=5E3;fg.Twa=null;Object(r.a)(fg,"ExternalContentEditor",null,[292]);var jw=d(265),rB=d(1189);class kA{constructor(b,h){this.x5a=!0;this.t0a=n=>{if(null!=n.result)return n.result.Value;w.ULS.sendTraceTag(556376794,324,15,"onRegister get convertExternalContentIsEnabled settings options from Roaming Service failed.");return this.x5a};this.ECa=n=>{n.ho||n.Ii?w.ULS.sendTraceTag(559153884,324,15,"Load to get convertExternalContentIsEnabled settings options from Roaming Service failed."):
(this.Ugh(n.result),w.ULS.sendTraceTag(559437389,324,50,"Load to get convertExternalContentIsEnabled settings options from Roaming Service successfully"));return this.x5a};this.Qu=b;this.yJ=h}jNh(){const b=new Nb.a;this.Zei()&&this.yJ?this.yJ.p1a(jw.a.yBc).CWRCo(this.t0a,0).CWRCo(this.ECa,8):b.Gg(this.x5a)}P_(b){this.yJ&&this.yJ.P_(jw.a.yBc,new rB.a(jw.a.yBc,b))}yzn(b){this.Zei()&&(this.Qu.zga("saveConvertExternalContentIsEnabled",b.toString()),w.ULS.sendTraceTag(559437386,324,50,"Try to save convertExternalContentIsEnabled settings value to Roaming Service."),
this.Ugh(b),this.P_(b))}Zei(){const b=u.AFrameworkApplication.K.$("IsAnonymousUser");if(u.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)w.ULS.sendTraceTag(559437387,324,50,"User is anonymous ");else return!0;return!1}Ugh(b){this.x5a=b}}Object(r.a)(kA,"ExternalContentSettingInfo",null,[514]);var $D=d(1113);class Tx{constructor(){this.thumbnail=this.author=this.title=this.mediaType=this.url=null;this.height=this.width=0;this.type=null;this.showFloatie=!1}}Object(r.a)(Tx,"FluidComponentProperties",
null,[]);class aE{constructor(){this.loopType=this.hw=this.VVa=this.url=null;this.mediaType=0;this.wmi=null}}Object(r.a)(aE,"IFrameProps",null,[]);class Gj{static get p_(){return null!=Gj.Nog?Gj.Nog:Gj.Nog=Oa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get qT(){return Gj.hj||(Gj.hj=Oa.a.instance.resolve("WordEditor.IImageEditor"))}static get fw(){return null!=Gj.dfg?Gj.dfg:Gj.dfg=Oa.a.instance.resolve("Common.Utils.IAriaNotifier")}static get hyperlinkEditor(){return null!=
Gj.xjg?Gj.xjg:Gj.xjg=Oa.a.instance.resolve("Box4.IHyperlinkEditor")}static get eh(){return null!=Gj.dng?Gj.dng:Gj.dng=Oa.a.instance.resolve("Box4.IOutlineElementEditor")}static get characterPropertiesEditor(){return null!=Gj.Lfg?Gj.Lfg:Gj.Lfg=Oa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static xMa(b){const h=b.startsWith(nh.HyperlinkReader.Oac),n=b.startsWith(nh.HyperlinkReader.XUc),x=b.startsWith(nh.HyperlinkReader.H_d);return(h||n||x)&&nh.HyperlinkReader.xMa(b)}static UTe(b,h){let n=
!1;if(b){switch(b.contextId){case cc.a.Wc:n=!h;break;case cc.a.Fd:n=!0}n&&!js.a(b.node)&&(n=!1)}return n}static R3b(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=Dd.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=nh.HyperlinkReader.NC(h,!1);if(1===h.length){h=h[0];const n=Cd.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==n)return!0}return!1}static ncf(b,h){const n=!B.a.w1(h);switch(b){case 1:return n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,
h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}static PQc(b){b=md.GraphIterator.$a(b);b.Bb(12);b.kd(12);b.xn.rP=!0}static DGd(b,h,n,x){const E=new qi.DictionaryPropertySet;Gj.qT.$Zd(E,h,b);b=Gj.ncf(x,n);E.setValue(ie.a.imageAltText,b);E.setValue(ic.a.pT,Ub.a.JF());E.setValue(ic.a.imageType,
0);return E}static yLd(b,h){if(!b||!b.isConnected||!Pd.ImageReader.qw(b))return null;const n=new vz.a;n.setValue(Th.a.o4b,h.mediaType);n.setValue(Th.a.NYa,h.url);n.setValue(ad.a.loopComponentType,h.loopType);n.VVa=h.VVa;n.hw=h.hw;n.g_a=1===h.mediaType;n.createMode=h.wmi;md.GraphIterator.$a(b).Sf(n,2);Gj.PQc(n);return n}static Awd(b,h){return h?b:Gj.hdf(b)}static hdf(b){const h=Cd.ParagraphReader.text(b.node),n=md.GraphIterator.$a(b.node);if(n.vd()){b=Dd.a.Uc(b.node,b.cpEnd);wf.OutlineElementNavigator.ae(n);
const x=Gj.eh.cta(n);Gj.eh.dba(n,x,b,!0,!0,!0,!0);""!=h&&Gj.eh.XC(n,!1,!0);n.Wd();return Dd.a.Uc(n.currentNode,0)}return null}static pWf(b){b=md.GraphIterator.$a(b);b.Bb(11)&&(b.kd(11),b.vd()&&b.xj()&&b.Wd()&&Cd.ParagraphReader.oc(b.currentNode)&&(b=Ae.SelectionFactory.xe(b.currentNode,0),kh.a.instance.setSelection(b)))}static ocf(b,h){const n=!B.a.w1(h);switch(b){case 1:b=n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;
break;default:b=n?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}static ariaNotify(b,h){Gj.fw&&(b=Gj.ocf(b,h),Gj.fw.sendNotification(b,!0))}static hYd(b,h,n){w.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");Y.a.sendTelemetryEvent(Object.assign(new fa.a,{name:n,dataFields:[Object.assign(new ca.a,
{name:b,bool:h})]}))}}Object(r.a)(Gj,"ExternalContentHelper",null,[]);var $w=d(908),Fu=d(1145);class ks extends Fu.a{constructor(){super(...arguments);this.Qn=null}static get vf(){return null!=ks.ohg?ks.ohg:ks.ohg=Oa.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}Sij(b,h,n){return Gj.xMa(h)?Gj.UTe(b,n)?!0:(ks.vf.GP(this.Qn,2,"URL inserted in Non-Embedable context",ks.vf.eo()),!1):(w.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),
ks.vf.GP(this.Qn,2,"URL inserted is not valid for ExternalContent",ks.vf.eo()),!1)}}Object(r.a)(ks,"AbstractExternalContentEditor",Fu.a,[292]);var aC=d(1144);class fn extends ks{constructor(b){super();fn.CSa=b;this.yvf()}yvf(){this.Ygc&&aC.a.yvf(fn.CSa.SNh())}static get paragraphEditor(){return null!=fn.Cng?fn.Cng:fn.Cng=Oa.a.instance.resolve("Box4.IParagraphEditor")}GHk(b,h){h=this.FSh(b,h);this.j7h(h,b,5)}JLa(b,h,n){this.Sij(b,h,n)&&(n=this.FSh(b,null),n.url=h,this.j7h(n,b,2))}dZd(b,h){this.JLa(b,
h,!1)}j7h(b,h,n){this.em=na.a.create();const x=new Se.GraphTransaction(15);x.Db(h.node);x.zl=ub.a.y3l;const E=Gj.R3b(h),S=Is.o(b.mediaType),ma=Gj.DGd(b.height,b.width,b.title,S);h=this.ygo(h,1==n);(h=Gj.hj.ELd(h,ma))?(h=h.node,Gj.yLd(h,{url:b.url,mediaType:S,hw:b.title,loopType:b.type,wmi:n})||w.ULS.sendTraceTag(538817433,324,50,"insertFluidComponentCore: Iframe node is null"),x.tCa(this.em,1),x.dispose(),this.IDc(h,b.thumbnail,this.Ygc),this.I4m(E,S,b.type)):w.ULS.sendTraceTag(538817432,324,50,"insertFluidComponentCore: insertPictureResult is null")}ygo(b,
h){Gj.characterPropertiesEditor.replaceTextRange(b,"");return Gj.Awd(b,h)}I4m(b,h,n){Gj.hYd("IsHyperlinkWithNonURLDisplayText",b,"Office.Word.Online.ExternalContent.FluidComponent");Gj.ariaNotify(h,this.Cgl(n))}Cgl(b){switch(b){case $w.a.CheckList:return"Checklist Component";case $w.a.TaskAssignment:return"Task List Component";case $w.a.Poll:return"Poll Component";default:return"Fluid Component"}}FSh(b,h){let n=new Tx;n.width=Gj.p_.x_b(b.node)||0;Is.h()?n.height=null!=fn.CSa&&fn.CSa.QNh(h)||Gj.p_.zWa(b.node)||
0:n.height=null!=fn.CSa&&fn.CSa.QNh(h)+2*iw.a.jda||Gj.p_.zWa(b.node)||0;n.title="Fluid Component";n.mediaType="fluid";n.type=h;n.thumbnail=this.Gql(n.width,n.height);n.url=null!=fn.CSa&&"https://fa000000096.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2202.14002/en-us_web/assets/fallback.jpg";return n}Gql(b,h){return this.Ygc?aC.a.xPh(b,h):fn.CSa.SNh()}get Ygc(){return null!=this.brg?this.brg:this.brg=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.useUpdatedFluidThumbailEnabled",
!1)}static YMc(b){u.AFrameworkApplication.Hf("04a02846;bab1g953");return u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=fn.CSa&&fn.CSa.Yfi(b)}}Object(r.a)(fn,"FluidComponentEditor",ks,[]);class bC{get V3k(){return null!=this.fhg?this.fhg:this.fhg=Oa.a.instance.resolve("Wonca.ExternalContent.IExternalContentEditor")}get eCd(){return null!=this.uig?this.uig:this.uig=Oa.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}D4m(b,
h){b&&(fn.YMc(h)?this.eCd.JLa(b,h,!0):this.V3k.JLa(b,h,!0))}}Object(r.a)(bC,"PostHyperlinkAutoCorrectStrategy",null,[512]);class wz{hYb(b,h){h(wz.M4m.test(b))}Wbc(b,h){b.startsWith("https")||(b=b.replace("http","https"));b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen='' sandbox='allow-scripts allow-same-origin'></iframe>",960,960,b);b=Object.assign(new Jp,{OperationId:0,
StatusCode:0,MediaType:"rich",Height:960,Width:960,Thumbnail:wz.thumbnailUrl,Title:"Power BI",IFrameHtml:b});h(b)}}wz.M4m=RegExp("^https?:\\/\\/(app|msit).powerbi.com\\/view\\?r=[^\\/]+$","i");wz.thumbnailUrl="https://www.onenote.com/Images/oembed_powerbi_defaultthumbnail.png";Object(r.a)(wz,"PowerBIURLResolver",null,[510,511]);class kw{constructor(b){this.e3g=b}hYb(b,h){let n=!1;try{if(kw.rjm(b)){const x=this.e3g.F2b(b);n=null!=x.width&&null!=x.height&&!!x.thumbnailUrl&&!!x.title&&null!=x.ZDa}}catch(x){}h(n)}Wbc(b,
h){var n=this.e3g.F2b(b);b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' style='border:none' allowfullscreen='true' allow='accelerometer; autoplay; battery; camera; clipboard-write; encrypted-media; fullscreen; gyroscope; picture-in-picture; sync-xhr; wake-lock; screen-wake-lock; web-share' sandbox='allow-downloads allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-scripts allow-same-origin'></iframe>",n.width,n.height,b);n=Object.assign(new Jp,
{Height:n.height,IFrameHtml:b,MediaType:"rich",OperationId:0,StatusCode:0,Thumbnail:n.thumbnailUrl,Title:n.title,Width:n.width});h(n)}static rjm(b){for(let h of kw.$1n)if(b.startsWith(h))return!0;return!1}static Dda(){return new kw(Oa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}}kw.$1n=["https://wedge.wedge:9090/","https://wedgecomponents.azurewebsites.net/"];Object(r.a)(kw,"WedgeComponentExperimentsURLResolver",null,[510,511]);class xz{constructor(b,h,n){this.ga=b;
this.hCj=h;this.Ok=n}Vb(){this.ga.gb(ub.a.p7h,cc.a.Wc,this.R3l.bind(this),1028);this.ga.gb(ub.a.JLd,cc.a.Wc,this.Dmf.bind(this),1028);this.ga.gb(ub.a.rLd,cc.a.Wc,this.Dmf.bind(this),1028);this.ga.gb(ub.a.Omf,cc.a.Wc,this.Dmf.bind(this),1028);this.ga.gb(ub.a.Zii,cc.a.Wc,this.qoj.bind(this),1028)}R3l(){return 32}Dmf(b,h,n){var x,E;if(!vA.a.rpf())return 2;if(1===n){Tq.g_f(Tq.F4n);if(!h.ul||!Kd.SelectionEditor.xf(h)||vs.a.wvd&&(null===(x=this.Ok)||void 0===x?0:x.bZ(h))||(null===(E=this.Ok)||void 0===
E?0:E.ota(h)))return 2;if(h&&h.node&&js.a(h.node))return 32}else if(2===n)return this.hCj.GHk(h,xz.Eql(b)),32;return 2}qoj(b,h,n){2===n&&B.a.RW("https://go.microsoft.com/fwlink/?linkid=2194838")&&ob.App.jUf.tgc("https://go.microsoft.com/fwlink/?linkid=2194838");return 32}static Eql(b){switch(b){case ub.a.JLd:return $w.a.TaskAssignment;case ub.a.rLd:return $w.a.CheckList;case ub.a.Omf:return $w.a.Poll;default:return null}}}Object(r.a)(xz,"FluidComponentsActor",null,[]);class Ce extends ks{constructor(){super();
this.PDb=this.ODb=null;this.R6e=new ZD.ExternalContentEmbedRetriever;this.Dmc=null;null!=Ce.zka&&Ce.zka.jNh()}jIi(){this.Qn=C.a.create();Ce.vf.Zwb(this.Qn,4);Ce.vf.Z2(this.Qn,0,Ce.vf.eo());this.NBb(this.ODb,3,this.PDb,!0)}JLa(b,h,n){this.Qn=C.a.create();Ce.vf.Zwb(this.Qn,n?0:2);Ce.vf.Z2(this.Qn,0,Ce.vf.eo());this.Dmc();this.NBb(b,n?0:2,h)}dZd(b,h){this.Qn=C.a.create();Ce.vf.Zwb(this.Qn,1);Ce.vf.Z2(this.Qn,0,Ce.vf.eo());this.NBb(b,1,h)}bKi(b){this.Dmc=b}Dee(b,h){const n=Ce.p_.x_b(h)||0;h=Ce.p_.zWa(h)||
0;const x=b.Width/b.Height;1<=x?(b.Width=n,b.Height=n/x):(b.Height=h,b.Width=h/x)}$ag(b,h,n){if(null!=b&&null!=h&&!B.a.nf(n)){var x=Ce.dSc.F2b(n);x.ZDa=!0;x.hideFloatie=!0;this.Dee(b,h.node);this.M4b(b,h,!1,!1,x,n)}}Edb(b){return b?b.mf:0}D8f(b,h,n){let x=null;const E=b.node;if(!Cd.ParagraphReader.oc(E)||!E.isConnected)return{returnValue:!1,joa:x};if(n)return{returnValue:!0,joa:b};n=b.cpBegin;const S=b.cpEnd,ma=Cd.ParagraphReader.text(E);if(0<=n&&S<=ma.length&&ma.substring(n,S)===h)return{returnValue:!0,
joa:b};const Fa=ma.indexOf(h);return 0<=Fa?(x=Dd.a.createTextRange(E,Fa,Fa+h.length),{returnValue:!0,joa:x}):0<=n&&S<=ma.length&&Gj.R3b(b)?{returnValue:!0,joa:b}:{returnValue:!1,joa:x}}Wsf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}Iva(b,h){u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const n=Oa.a.instance.Za("Common.ISystemInitiatedFeedback");n&&n.execute(x=>{x.logActivity(b,h)})},Ce.gka)}NBb(b,h,n,x=!1){if(this.Sij(b,
n,!h)){var E=Ce.dSc.F2b(n);E&&(this.Wsf(E)?(w.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent"),this.cLf(b,h,E,n,x)):(w.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),Ce.vf.GP(this.Qn,2,"Size provided is not valid for OEmbed",Ce.vf.eo())))}}cLf(b,h,n,x,E){const S=!h,ma=1===h,Fa=Ce.p_.x_b(b.node)||0,$a=Ce.p_.zWa(b.node)||0,sb=VC.a.xXe(n.U7f,!0,Fa,$a);this.wQc(b,x,h,!0);this.R6e.akh(sb,Jb=>{Ce.vf.Z2(this.Qn,
4,Ce.vf.eo());Ce.vf.rZc(this.Qn,this.Edb(Jb.data));if(Jb=this.iLf(Jb)){w.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var Sb=Is.o(Jb.MediaType);Ce.vf.C1d(this.Qn,7,Sb);Sb=b;({joa:Sb}=this.D8f(b,x,ma)).returnValue?(this.wQc(Sb,x,h,!1),null==n.width?0<Fa&&Jb.Width>Fa&&(w.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Jb.Width=Fa):(w.ULS.sendTraceTag(572618198,
324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Jb.Width=this.A3c(n.width,Jb.Width,Fa)),null==n.height?0<$a&&Jb.Height>$a&&(w.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Jb.Height=$a):(w.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Jb.Height=this.A3c(n.height,Jb.Height,$a)),Ce.zka.x5a||E?this.M4b(Jb,Sb,S,ma,n,
x):(this.ODb=b,this.PDb=x,this.WBc(x))):(w.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),Ce.vf.GP(this.Qn,2,"No conversion as the context is no longer valid for the external content conversion",Ce.vf.eo()));ma&&this.HVa(Sb.node)}else ma&&this.HVa(b.node),Ce.vf.GP(this.Qn,1,"URL not oEmbedable",Ce.vf.eo())},Jb=>{Ce.vf.Z2(this.Qn,4,Ce.vf.eo());Ce.vf.rZc(this.Qn,this.Edb(Jb.data));ma&&this.HVa(b.node);
w.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Jb.data.Ee);Ce.vf.GP(this.Qn,2,"ExternalContentEmbedRequest failed",Ce.vf.eo())},Jb=>{ma&&this.HVa(b.node);w.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Jb)},this.Qn)}A3c(b,h,n){!b&&0<n&&h>n||b>n?(w.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=n):b>n?h=n:b&&b<n&&(h=b);return h}M4b(b,h,n,x,
E,S){this.em=na.a.create();b.Width=b.Width/b.Height*(b.Height-(iw.a.aKd+iw.a.jda))+2*iw.a.jda;const ma=new Se.GraphTransaction(15);ma.Db(h.node);ma.zl=ub.a.JLa;const Fa=Gj.R3b(h);null!=E.ZDa&&!E.ZDa||x||Fa||(b.Title=""===E.title||E.title?E.title:b.Title,!b.Title&&""!==b.Title)||(h=this.Tmf(h,ma,b.Title,S,n));if(h){x&&(h=this.E1e(h));var $a=Gj.Awd(h,x);if($a){n=Is.o(b.MediaType);var sb=Gj.DGd(b.Height,b.Width,b.Title,n);($a=this.zmf($a,sb,x,{url:S,VVa:b.IFrameHtml,hw:b.Title,mediaType:n}))?(ma.tCa(this.em,
1),ma.dispose(),this.ODb=h,this.PDb=S,this.iIf(E,b,$a),this.OKf(S,x||E.hideFloatie,Fa,n,b.Title)):ma.dispose()}else ma.dispose(),w.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),Ce.vf.GP(this.Qn,2,"Could not create IP context on splitting the paragraph",Ce.vf.eo())}else Ce.vf.GP(this.Qn,2,"GraphNodeContext is null",Ce.vf.eo())}zmf(b,h,n,x){if(!b)return null;b=Ce.qT.ELd(b,h);if(!b)return w.ULS.sendTraceTag(590455042,324,
10,"Unable to insert external content. The anchored image could not be inserted."),Ce.vf.GP(this.Qn,2,"The anchored image could not be inserted",Ce.vf.eo()),null;b=b.node;x=Gj.yLd(b,x);Ce.vf.a7f(this.Qn,x.id);n||Gj.pWf(b);return b}iIf(b,h,n){B.a.w1(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(Ce.vf.Z2(this.Qn,8,Ce.vf.eo()),w.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.IDc(n,h.Thumbnail,
!1))}OKf(b,h,n,x,E){h||this.WBc(b);this.Iva("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");Gj.hYd("IsHyperlinkWithNonURLDisplayText",n,"Office.Word.Online.ExternalContent.OEmbedInsertions");Gj.ariaNotify(x,E);Ce.vf.Z2(this.Qn,5,Ce.vf.eo())}Tmf(b,h,n,x,E){if(E){if((E=nh.HyperlinkReader.NC(b,!1))&&1!==E.length)return h.dispose(),w.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;Gj.hyperlinkEditor.LQ(E[0].paragraph,
E[0].hyperlink)}return this.WRf(b,n,x)}E1e(b){const h=b.node,n=Cd.ParagraphReader.text(h);return 0<n.length&&!n.trim().length?(b=Dd.a.createTextRange(h,0,n.length),Gj.characterPropertiesEditor.replaceTextRange(b,""),Dd.a.Uc(h,0)):b}iLf(b){if(!({group:b}=wl.a.G7(b.data.Ee)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}WRf(b,h,n){const x=b.cpBegin+h.length;Gj.characterPropertiesEditor.replaceTextRange(b,h);b=Dd.a.createTextRange(b.node,b.cpBegin,x);Gj.hyperlinkEditor.DG(b,n,!1);
return b}HVa(b){b.dac=null}wQc(b,h,n,x){const E=b.cpBegin,S=b.cpEnd;b=Cd.ParagraphReader.text(b.node).trim();E||b!==h&&""!==b?E?S===b.length?w.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",zv[n],x):0<E&&S<b.length&&w.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
zv[n],x):w.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",zv[n],x):w.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",zv[n],x)}WBc(b){this.D_b();const h=new Go.a(1,u.AFrameworkApplication.isRtl);h.aUc=b;Ce.$bb.$Vc(h)}D_b(){const b=
new or.a(!0);Ce.Z$b.mDa(b)}static get $bb(){return null!=Ce.hhg?Ce.hhg:Ce.hhg=Oa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get zka(){Ce.Twa||(Ce.Twa=Oa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Ce.Twa}static get Z$b(){return null!=Ce.aog?Ce.aog:Ce.aog=Oa.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get p_(){return null!=Ce.Oog?Ce.Oog:Ce.Oog=Oa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get qT(){return null!=
Ce.Kjg?Ce.Kjg:Ce.Kjg=Oa.a.instance.resolve("WordEditor.IImageEditor")}static get dSc(){return null!=Ce.Jmg?Ce.Jmg:Ce.Jmg=Oa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}}Ce.gka=5E3;Ce.Twa=null;Object(r.a)(Ce,"ExternalContentEditorV2",ks,[]);class sB{constructor(){this.wc=this.W=null}get name(){return"WordEditor.ExternalContent"}get Pb(){return this.wc?this.wc:this.wc=this.W.resolve("Box4.IFeatureHelper")}zc(b){this.W=b;b.ha("WordEditor.ExternalContent.ExternalContentSizeBehavior",
()=>new WE.a(Pm.a.instance,hp.WordSectionNavigator.instance)).as("WordEditor.ExternalContent.IExternalContentSizeBehavior").singleInstance();b.ha("WordEditor.ExternalContent.PostHyperlinkAutoCorrectStrategy",()=>new bC).as("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy").singleInstance();b.ha("WordEditor.ExternalContent.ExternalContentSettingInfo",()=>new kA(b.resolve("Box4.IRoamingServiceRequestManager"),b.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.ExternalContent.IExternalContentSettingInfo").singleInstance();
u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)?(b.ha("WordEditor.ExternalContent.ExternalContentEditorV2",()=>new Ce).as("Wonca.ExternalContent.IExternalContentEditor").singleInstance(),b.ha("WordEditor.ExternalContent.FluidComponentEditor",()=>new fn(b.resolve("Fluid.Host.LoopComponentManager"))).singleInstance(),b.ha("WordEditor.ExternalContent.FluidComponentsActor",()=>new xz(u.AFrameworkApplication.ya,b.resolve("WordEditor.ExternalContent.FluidComponentEditor"),
Ai.a.instance)).singleInstance()):b.ha("WordEditor.ExternalContent.ExternalContentEditor",()=>new fg).as("Wonca.ExternalContent.IExternalContentEditor").singleInstance()}init(){this.Pb.Yk.continueWith(()=>{this.Nm()});u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&this.W.resolve("WordEditor.ExternalContent.FluidComponentsActor").Vb()}dispose(){}yHk(){const b=new XD;this.HBh()&&b.w7g(kw.Dda());b.w7g(new wz);return b}Nm(){null==u.AFrameworkApplication.K||
u.AFrameworkApplication.K.$("IOEmbedOverridesURLParserCrashFixIsEnabled")||this.W.ha("WordEditor.ExternalContent.OEmbedQueryParamsOverridesURLParser",()=>new $D.a).as("WordEditor.ExternalContent.IOEmbedOverridesURLParser").singleInstance();this.HBh()&&(this.W.ha("WordEditor.ExternalContent.IWordExternalContentURLResolver",()=>this.yHk()).as("WordEditor.ExternalContent.IWordExternalContentURLResolver").singleInstance(),this.W.resolve("WordEditor.ExternalContent.IWordExternalContentURLResolver"))}HBh(){return u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableInnerRingWEdgeExperimentsOEmbedURLResolver",
!1)}static main(){N.a.instance.Pc(new sB)}}Object(r.a)(sB,"ExternalContentPackage",null,[1,2]);var ev;(function(b){b[b.invalid=-1]="invalid";b[b.clear=0]="clear";b[b.left=1]="left";b[b.start=2]="start";b[b.center=3]="center";b[b.right=4]="right";b[b.end=5]="end";b[b.decimal=6]="decimal";b[b.qyo=7]="bar";b[b.tfa=8]="num"})(ev||(ev={}));Object(r.b)("TabStopValues",ev);class Jo{}Jo.ewh=8;Jo.GPk=1;Jo.S5="wwaengidc";Jo.kpiName="WordRuler";Jo.precision=.0625;Jo.D3n=1;Jo.omo="ShowHideRuler";Object(r.a)(Jo,
"Constants",null,[]);var cC=d(357),ax=d(746);class Nr{static V2b(b,h){if(!Nr.mOc)return null;switch(b){case "Left":return n=>{const x=n.rulerCanvasProps;n=n.indents;return{ZDb:0,qIb:x.scale-(x.margins[1].value+n[2].value+Math.max(n[0].value,n[1].value)+8*x.precision)}};case "Right":return n=>{const x=n.rulerCanvasProps;n=n.indents;return{ZDb:0,qIb:x.scale-(n[2].value+(x.margins[0].value+Math.max(n[0].value,n[1].value))+8*x.precision)}};case "MoveTableColumn":return()=>{let n=0,x=0;if(0===h){var E=
{};32===Nr.Ac.Xb(Db.a.ebc,2,E)&&(n=Jf.a.cC(E.MinIndent),x=Jf.a.cC(E.MaxIndent))}else E={ao:h-1},32===Nr.Ac.Xb(Db.a.dbc,2,E)&&(n=Jf.a.cC(E.MinResize),x=Jf.a.cC(E.MaxResize));return{ZDb:n,qIb:x}};case "Top":return n=>{n=n.rulerCanvasProps;return{ZDb:0,qIb:n.scale-(n.margins[1].value+8*n.precision)}};case "Bottom":return n=>{n=n.rulerCanvasProps;return{ZDb:0,qIb:n.scale-(n.margins[0].value+8*n.precision)}}}return null}static TGd(b){if(!Nr.mOc)return null;switch(b){case "FirstLineIndent":case "HangingIndent":case "LeftIndent":return h=>
{var n=h.rulerCanvasProps,x=h.indents,E=h.ipContextIndex;h=n.margins;var S=n.scale;n=n.precision;if("MoveTableColumn"!==h[0].type){E=h[0].value;h=h[1].value+x[2].value;var ma=E;"LeftIndent"===b&&(ma+=Math.max(x[0].value,x[1].value));x=-1*E;n=S-(ma+h+8*n)}else{S=0;for(ma=0;ma<=E;ma++)S+=h[ma].value;ma=0;if("LeftIndent"===b){ma=x[0].value;const Fa=x[1].value;S+=Math.max(ma,Fa);ma=Math.max(ma,Fa)}h=h[E+1].value;ma+=x[2].value;x=-1*S;n=h-ma-n}return{ZDb:x,qIb:n}};case "RightIndent":return h=>{var n=h.rulerCanvasProps,
x=h.indents,E=h.ipContextIndex,S=n.margins;h=n.scale;n=n.precision;if("MoveTableColumn"!==S[0].type){var ma=S[0].value;S=S[1].value;E=x[0].value;var Fa=x[1].value;x=-1*S;h-=ma+S+Math.max(E,Fa)+8*n}else{ma=0;for(Fa=0;Fa<=E;Fa++)ma+=S[Fa].value;S=S[E+1].value;E=x[0].value;Fa=x[1].value;x=-1*(h-ma-S);h=S-Math.max(E,Fa)-n}return{ZDb:x,qIb:h}}}return null}static zFl(){return b=>{var h=b.rulerCanvasProps,n=b.indents,x=b.ipContextIndex,E=h.margins;b=h.precision;h=h.scale;"MoveTableColumn"!==E[0].type?(x=
E[0].value,E=E[1].value+n[2].value,n=Math.min(n[0].value,n[1].value)+b,b=h-(x+E+b)):(h=n[2].value,E=E[x+1].value,n=Math.min(n[0].value,n[1].value)+b,b=E-(h+b));return{ZDb:n,qIb:b}}}static get Ac(){return null!=Nr.Xeg?Nr.Xeg:Nr.Xeg=u.AFrameworkApplication.ya}static get mOc(){null==this.m7a&&(u.AFrameworkApplication.F6("WoRul910;WoRul910cf"),this.m7a=u.AFrameworkApplication.K?u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RulerPropertyBoundaryIsEnabled",!1):!1);return this.m7a}}
Nr.m7a=null;Object(r.a)(Nr,"RulerPropertyBoundaryHelper",null,[]);var bE=d(898),dC;(function(b){b[b.appChromeReady=0]="appChromeReady";b[b.appChromeLazyReady=1]="appChromeLazyReady"})(dC||(dC={}));Object(r.b)("WoncaAppChromeState",dC);const cE=b=>{Mg.c()?b():w.ULS.sendTraceTag(51393038,340,10,"appChrome is not defined.")},tB=(b,h)=>{const n=Oa.a.instance.Pa("Wonca.IWoncaAppChromeStateManager");n?n.sl(b,()=>{cE(h)}):cE(h)};var YE=d(1206),ZE=d(1207);class Ux{constructor(b,h,n,x,E,S){this.RYm="OutlineContainer";
this.tXj="UpdateCustomTabFailed";this.qsb="ReadRulerPropertiesFailed";this.xXj="UpdateIndentFailed";this.U2g="UpdateMarginFailed";this.Hm=b;this.eSb=h;this.ga=n;this.qEe=x;this.sC=E;this.yY=S;this.pPb=null;this.$v=!!u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.u6}HA(){this.rNe();this.A7g();this.eSb.al.Te(10).jp(Object(v.a)(this,this.RSc,"onOutlinePropertyChanged"));af.a.addHandler(this.ZKe,kb.a.scroll,Object(v.a)(this,this.Mgj,"updateRulerLocationOnScroll"));this.Hm.execute(h=>{h.b7(Object(v.a)(this,
this.Sr,"onZoomChanged"))});const b=[this.Xef(),document.getElementById(Qe.AppFrame.L3c),document.getElementById("PageContentContainer")];this.pPb?this.pPb.register(b,Object(v.a)(this,this.TEa,"updateRulerLocation")):tB(dC.appChromeLazyReady,()=>{appChrome.getResizeObserver().then(h=>{this.pPb=h.createResizeObserver();this.pPb.register(b,Object(v.a)(this,this.TEa,"updateRulerLocation"));return null})});ob.App.xa.tu.registerBoundingWindowRectsChanged("documentPanel",(h,n)=>{"undefined"!==n&&this.J3a([1,
0])})}Xef(){return 1===this.yY.Hx?this.vOj:this.RNj}get ZKe(){return document.getElementById(Qe.AppFrame.fFa)}get RNj(){const b=document.getElementsByClassName(this.RYm);return b&&0<b.length?b[0]:null}get vOj(){var b=this.sC.Z0b;if(!b)return null;b=this.jBn(Cd.ParagraphReader.iT(b));return bE.a.tUh(b)}jBn(b){return 0<b?document.querySelector("div.PagesContainer p[paraid='"+b+"']"):null}ZWd(b){b.button===Sys.UI.MouseButton.rightButton&&this.qEe.show(new Sys.UI.Point(b.clientX,b.clientY),2)}Mgj(){this.TEa()}get HM(){return this.Hm&&
this.Hm.instance?this.Hm.instance.vj:Jo.GPk}t2b(){const b={};return 32!==this.ga.Xb(Db.a.jDa,2,b)?(w.ULS.sendTraceTag(529065947,YE.a.msoulscat_Wac_WordRuler,ZE.a.warning,"Unable to read page properties for Ruler"),hl.recordQosError(this.qsb,[hl.Eca],"Unable to read page properties for Ruler"),null):b}dispose(){this.p3h();this.eSb.al.Te(10).wX(Object(v.a)(this,this.RSc,"onOutlinePropertyChanged"));af.a.removeHandler(this.ZKe,kb.a.scroll,Object(v.a)(this,this.Mgj,"updateRulerLocationOnScroll"));this.Hm.execute(b=>
{b.ejb(Object(v.a)(this,this.Sr,"onZoomChanged"))});this.pPb&&this.pPb.dispose();ob.App.xa.tu.unregisterBoundingWindowRectsChanged("documentPanel",(b,h)=>{"undefined"!==h&&this.J3a([1,0])})}get edi(){null==Ux.ute&&(Ux.ute=u.AFrameworkApplication.K?u.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&u.AFrameworkApplication.K.$("RulerThemingIsEnabled"):!1);return Ux.ute}}Ux.ute=null;Object(r.a)(Ux,
"ARuler",null,[337]);var eC=d(315);class Or extends Ux{constructor(b,h,n,x,E,S,ma){super(b,h,n,E,S,ma);this.A2="HorizontalRuler";this.ymj="CustomTabModificationFromRuler";this.Wnj="IndentModificationFromRuler";this.Rde="MarginModificationFromRuler";this.mGg=this.lGg=this._tabStops=null;if(cC.a.isSharedUxGateEnabled("WordOnline.ChangeGate.DelayLoadUISlice20InRuler"))this.hqa=x;else{const Fa=x();this.hqa=()=>Fa}this.qv={}}get DW(){return this.lGg}get dBa(){return this.mGg}renderRuler(){this.DW.classList.remove("HideWACHorizontalRulerContainer");
this.DW.classList.add("ShowWACHorizontalRulerContainer");var b=this.t2b();if(b){var h=Object(v.a)(this,this.TFf,"onMarginChange"),n=Object(v.a)(this,this.tRm,"onIndentChange"),x=Object(v.a)(this,this.gPm,"onCustomTabChange"),E=this.c2c(),S=this.Dbj(),ma=this.Cbj();E&&S&&ma||(this.qv.disabled=!0);this.qv.onIndentChange=n;this.qv.onMarginChange=h;this.qv.onTabChange=x;this.TEa();b=mf.a.Ni(b.Ko,0);this.dBa.style.width=(b*this.HM).toString()+"px";return this.hqa().then(Fa=>{Fa.renderRuler(this.dBa,this.qv)})}}gPm(b,
h,n){if(!(b>=this._tabStops.length)){b=this._tabStops[b];var x="Modify"===n?this.ga.Xb(ub.a.b9b,2,{["tabStop"]:b,["value"]:Jf.a.wF(h)}):this.ga.Xb(ub.a.u1a,2,b);if(32===x){h=1;var E=String.format("Custom tab modified using ruler. Operation: {0}. CustomTab: {1}",n,ev[b.gba]);w.ULS.sendTraceTag(591213271,3014,50,E)}else h=0,E=String.format("Unable to modify custom tab using ruler. Operation: {0}. CustomTab: {1}",n,ev[b.gba]),w.ULS.sendTraceTag(591213272,3014,15,E),hl.recordQosError(this.tXj,[hl.Eca],
"Unable to modify custom tab using ruler");Pe.a(this.ymj,32===x,void 0,[Object.assign(new ca.a,{name:"Operation",string:n}),Object.assign(new ca.a,{name:"TabType",int64:ev[b.gba]})]);n=new Map;n.set("Command","OnCustomTabChange");n.set("Source",this.A2);n.set("Response",E);ta.Health.instance.recordKpiUsage(Jo.kpiName,h,Jo.S5,n)}}Cbj(){const b=[];var h={};if(32!==this.ga.Xb(ub.a.bHb,2,h))return w.ULS.sendTraceTag(589651997,3014,15,"Unable to read paragraph tabs for Ruler"),hl.recordQosError(this.qsb,
[hl.Eca],"Unable to read paragraph tabs for Ruler"),!1;var n=h.customTabs;if(!n||0>=n.length)return this.qv.tabs=b,!0;this._tabStops=n;h="";for(let x of n){switch(x.gba){case 1:h="LeftTab";break;case 4:h="RightTab";break;case 3:h="CenterTab";break;case 6:h="DecimalTab";break;case 7:h="BarTab"}n=mf.a.yib(x.kEa,0);b.push({["type"]:h,["value"]:n,["getRulerPropertyBoundary"]:Nr.zFl()})}this.qv.tabs=b;return!0}J3a(b){if(this.DW){this.DW.classList.add("ShowWACHorizontalRulerContainer");"disabled"in this.qv&&
delete this.qv.disabled;for(let h of b)switch(h){case 0:b=this.Dbj();const n=this.Cbj();b&&n||(this.qv.disabled=!0);break;case 1:this.c2c()||(this.qv.disabled=!0)}Ee.a.rCb()&&this.sC.kb.qpf&&(this.qv.disabled=!0);this.hqa().then(h=>{h.renderRuler(this.dBa,this.qv);return null})}}c2c(){const b={};var h=this.t2b();if(!h)return!1;b.scale=Jf.a.cC(h.Ko);b.precision=Jo.precision;b.rulerType="Horizontal";if(!this.wXm())return this.qv.ipContextIndex=0,this.qv.permittedUnits=Jo.ewh,h=[{["type"]:"Left",["value"]:Jf.a.cC(h.marginLeft),
["getRulerPropertyBoundary"]:Nr.V2b("Left",0)},{["type"]:"Right",["value"]:Jf.a.cC(h.marginRight),["getRulerPropertyBoundary"]:Nr.V2b("Right",1)}],b.margins=h,this.qv.rulerCanvasProps=b,!0;var n={};h={};var x=this.ga.Xb(Db.a.HVc,2,n);const E=this.ga.Xb(Db.a.oHb,2,h);if(32!==x||32!==E)return w.ULS.sendTraceTag(589651998,3014,15,"Unable to read table properties for Ruler"),hl.recordQosError(this.qsb,[hl.Eca],"Unable to read table properties for Ruler"),!1;n=n.ColumnWidths;x=h.TablePosition;if(!x||!n||
0>=n.length)return w.ULS.sendTraceTag(589632533,3014,15,"Cannot show table properties on the ruler as they are null"),hl.recordQosError(this.qsb,[hl.Eca],"Cannot show table properties on the ruler as they are null"),!1;h=Array(n.length+1);h[0]={["type"]:"MoveTableColumn",["value"]:Jf.a.cC(x.x/this.HM),["getRulerPropertyBoundary"]:Nr.V2b("MoveTableColumn",0)};for(x=0;x<n.length;x+=1)h[x+1]={["type"]:"MoveTableColumn",["value"]:Jf.a.cC(n[x]),["getRulerPropertyBoundary"]:Nr.V2b("MoveTableColumn",x+1)};
this.qv.ipContextIndex=this.fJl();this.qv.permittedUnits=Jo.D3n;b.margins=h;this.qv.rulerCanvasProps=b;return!0}Dbj(){var b={};if(32!==this.ga.Xb(Db.a.g1a,2,b))return w.ULS.sendTraceTag(592496522,3014,15,"Unable to read paragraph indentation for Ruler"),hl.recordQosError(this.qsb,[hl.Eca],"Unable to read paragraph indentation for Ruler"),!1;const h={type:"FirstLineIndent"};h.getRulerPropertyBoundary=Nr.TGd("FirstLineIndent");const n={type:"HangingIndent"};n.getRulerPropertyBoundary=Nr.TGd("HangingIndent");
const x={type:"RightIndent"};x.getRulerPropertyBoundary=Nr.TGd("RightIndent");const E={type:"LeftIndent"};E.getRulerPropertyBoundary=Nr.TGd("LeftIndent");this.qv.rtl=b.isRtl;b=b.Ts;h.value=1===b.specialIndentType?Jf.a.cC(b.bba+b.tA):2===b.specialIndentType?Jf.a.cC(b.tA-b.bba):Jf.a.cC(b.tA);n.value=Jf.a.cC(b.tA);E.value=Jf.a.cC(b.tA);x.value=Jf.a.cC(b.wla);this.qv.indents=[h,n,x,E];return!0}tRm(b,h){var n=new ax.a;n.unit=1;n.value=Jf.a.wF(h);h=8;switch(b){case "FirstLineIndent":h=this.ga.Xb(Db.a.MZc,
2,n);break;case "HangingIndent":h=this.ga.Xb(Db.a.NZc,2,n);break;case "LeftIndent":h=this.ga.Xb(Db.a.WYa,2,n);break;case "RightIndent":h=this.ga.Xb(Db.a.VYa,2,n)}let x;32===h?(n=1,x=String.format("Indents set using Ruler. Indent: {0}",b),w.ULS.sendTraceTag(592517017,3014,50,x)):(n=0,x=String.format("Unable to set indent using Ruler. Indent: {0}",b),w.ULS.sendTraceTag(592496523,3014,15,x,b),hl.recordQosError(this.xXj,[hl.Eca],"Unable to set indent using Ruler."));Pe.a(this.Wnj,32===h,void 0,[Object.assign(new ca.a,
{name:"Type",string:b})]);b=new Map;b.set("Command","OnIndentChange");b.set("Source",this.A2);b.set("Response",x);ta.Health.instance.recordKpiUsage(Jo.kpiName,n,Jo.S5,b)}A7g(){af.a.addHandler(this.DW,kb.a.Vw,Object(v.a)(this,this.ZWd,"onRulerMouseDown"))}p3h(){this.DW.classList.remove("ShowWACHorizontalRulerContainer");this.DW.classList.add("HideWACHorizontalRulerContainer");af.a.removeHandler(this.DW,kb.a.Vw,Object(v.a)(this,this.ZWd,"onRulerMouseDown"));this.hqa().then(b=>{b.dispose(this.dBa);return null})}TFf(b,
h,n){let x;x="Left"===b?this.ga.Xb(Db.a.uga,2,Jf.a.wF(h)):"Right"===b?this.ga.Xb(Db.a.i2a,2,Jf.a.wF(h)):n?this.ga.Xb(Db.a.G9d,2,{["columnIndex"]:n-1,["width"]:Jf.a.wF(h)}):this.ga.Xb(Db.a.Bdc,2,Jf.a.wF(h));32===x?(h=1,n=String.format("Margins set using Ruler. Margin: {0}",b),w.ULS.sendTraceTag(592517018,3014,50,n)):(h=0,n=String.format("Unable to set margins using Ruler. Margin: {0}",b),w.ULS.sendTraceTag(592496524,3014,15,n),hl.recordQosError(this.U2g,[hl.Eca],"Unable to set margins using Ruler."));
Pe.a(this.Rde,32===x,void 0,[Object.assign(new ca.a,{name:"Type",string:b})]);b=new Map;b.set("Command","OnMarginChange");b.set("Source",this.A2);b.set("Response",n);ta.Health.instance.recordKpiUsage(Jo.kpiName,h,Jo.S5,b)}Sr(){this.Ogj();this.TEa();this.J3a([1,0])}RSc(b,h){b=h.property;if(b===ic.a.Ko||b===ic.a.marginLeft||b===ic.a.marginRight)this.Ogj(),this.TEa(),this.J3a([1])}Ogj(){var b=this.t2b();b&&(b=mf.a.Ni(b.Ko,0),this.dBa.style.width=Math.round(b*this.HM).toString()+"px")}TEa(){window.requestAnimationFrame(()=>
{var b=this.Xef();b&&(b=rd.a.getElementBounds(b),u.AFrameworkApplication.isRtl?this.dBa.style.marginRight=(window.document.documentElement.clientWidth-b.x-b.width).toString()+"px":this.dBa.style.marginLeft=b.x.toString()+"px")})}fJl(){const b=md.GraphIterator.$a(this.sC.Z0b);if(b.Bb(14))return b.kd(16),fm.a(b,!0);w.ULS.sendTraceTag(557110540,3014,15,"Unable to read table column index for Ruler");hl.recordQosError(this.qsb,[hl.Eca],"Unable to read table column index for Ruler");return 0}wXm(){let b=
!0;const h=this.sC.kb.vN();if(null===h)return w.ULS.sendTraceTag(557065614,3014,15,"Unable to get Context Iterator for the Ruler"),hl.recordQosError(this.qsb,[hl.Eca],"Unable to get Context Iterator for the Ruler"),!1;for(;h.moveNext()&&b;){const n=md.GraphIterator.$a(h.current.node);n.vd();b=b&&ag.TableReader.Tw(n)}return b}rNe(){var b;if(!this.dBa&&!this.DW){this.lGg=document.createElement("div");this.DW.id=Or.PEj;this.DW.className=Or.OEj;this.DW.setAttribute(qf.a.cda,WordEditorIntl.WordEditorStrings.L_Ruler);
this.DW.setAttribute(qf.a.Ah,qf.a.Ech);this.DW.classList.add("HideWACHorizontalRulerContainer");if(this.edi){var h=u.AFrameworkApplication.K.lb("ModernUxExperimentPreferenceCookieName");const n=u.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");Ya.a.Lka(h,!n)&&this.DW.classList.add(Or.iLj)}this.mGg=document.createElement("div");this.dBa.className=Or.NEj;this.dBa.id=Or.QEj;this.DW.appendChild(this.dBa);h=null;this.$v&&((h=u.AFrameworkApplication.K.$("IsSharedLayoutEnabled")?null!==
(b=Object(eC.a)("EditorBars"))&&void 0!==b?b:ob.App.xa.tu.getRegion(ob.App.xa.tu.Uib.J("Ruler")):ob.App.xa.tu.getRegion(ob.App.xa.tu.Uib.J("Ruler")))&&h.appendChild(this.DW),this.DW.classList.add("regionComposer"));h||(h=document.getElementById(Qe.AppFrame.L3c),h.insertBefore(this.DW,h.firstChild))}}static YD(){return new Or(Oa.a.instance.Za("Common.IZoomManager"),ob.App.Wj,u.AFrameworkApplication.ya,Cj.UISurfaces.TWh,Oa.a.instance.resolve("WordEditor.IRulerContextMenu"),Pq.a.instance,Oa.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=
Or.elg?Or.elg:Or.elg=Or.YD()}}Or.PEj="WACHorizontalRulerContainer";Or.OEj="WACHorizontalRulerContainer";Or.QEj="WACHorizontalRuler";Or.NEj="WACHorizontalRuler";Or.iLj="ModernUxWACHorizontalRulerContainer";Object(r.a)(Or,"HorizontalRuler",Ux,[]);var yz=d(924);class Pr extends Ux{constructor(b,h,n,x,E,S,ma){super(b,h,n,E,S,ma);this.A2="VerticalRuler";this.Rde="MarginModificationFromRuler";this.J3g=this.I3g=null;if(cC.a.isSharedUxGateEnabled("WordOnline.ChangeGate.DelayLoadUISlice20InRuler"))this.hqa=
x;else{const Fa=x();this.hqa=()=>Fa}this.qv={}}get N3(){return this.I3g}get cFa(){return this.J3g}renderRuler(){Ke.a.Hu(this.N3,"HideWACVerticalRulerContainer");Ke.a.Pf(this.N3,"ShowWACVerticalRulerContainer");var b=this.t2b();if(b){var h=Object(v.a)(this,this.TFf,"onMarginChange");this.c2c()||(this.qv.disabled=!0);this.qv.onMarginChange=h;this.TEa();b=mf.a.Ni(b.Xx,1);this.cFa.style.height=(b*this.HM).toString()+"px";this.hqa().then(n=>{n.renderRuler(this.cFa,this.qv);return null})}}J3a(b){if(this.N3){Ke.a.Pf(this.N3,
"ShowWACVerticalRulerContainer");"disabled"in this.qv&&delete this.qv.disabled;for(let h of b)switch(h){case 1:this.c2c()?this.TEa():this.qv.disabled=!0}Ee.a.rCb()&&this.sC.kb.qpf&&(this.qv.disabled=!0);this.hqa().then(h=>{h.renderRuler(this.cFa,this.qv);return null})}}c2c(){const b={},h=this.t2b();if(!h)return!1;b.scale=Jf.a.cC(h.Xx);b.precision=Jo.precision;b.rulerType="Vertical";this.qv.ipContextIndex=0;this.qv.permittedUnits=Jo.ewh;b.margins=[{["type"]:"Top",["value"]:Jf.a.cC(h.marginTop),["getRulerPropertyBoundary"]:Nr.V2b("Top",
0)},{["type"]:"Bottom",["value"]:Jf.a.cC(h.marginBottom),["getRulerPropertyBoundary"]:Nr.V2b("Bottom",1)}];this.qv.rulerCanvasProps=b;return!0}A7g(){this.rNe();af.a.addHandler(this.N3,kb.a.Vw,Object(v.a)(this,this.ZWd,"onRulerMouseDown"))}p3h(){Ke.a.Hu(this.N3,"ShowWACVerticalRulerContainer");Ke.a.Pf(this.N3,"HideWACVerticalRulerContainer");af.a.removeHandler(this.N3,kb.a.Vw,Object(v.a)(this,this.ZWd,"onRulerMouseDown"));this.hqa().then(b=>{b.dispose(this.cFa);return null})}TFf(b,h){let n=8;"Top"===
b?n=this.ga.Xb(Db.a.j2a,2,Jf.a.wF(h)):"Bottom"===b&&(n=this.ga.Xb(Db.a.h2a,2,Jf.a.wF(h)));let x;32===n?(h=1,x=String.format("Margins set using Ruler. Margin: {0}",b),w.ULS.sendTraceTag(529065945,3014,50,x)):(h=0,x=String.format("Unable to set margins using Ruler. Margin: {0}",b),w.ULS.sendTraceTag(529065946,3014,15,x),hl.recordQosError(this.U2g,[hl.Eca],"Unable to set margins using Ruler."));Pe.a(this.Rde,32===n,void 0,[Object.assign(new ca.a,{name:"Type",string:b})]);b=new Map;b.set("Command","OnMarginChange");
b.set("Source",this.A2);b.set("Response",x);ta.Health.instance.recordKpiUsage(Jo.kpiName,h,Jo.S5,b)}Sr(){this.Lgj();this.TEa();this.J3a([1])}RSc(b,h){b=h.property;if(b===ic.a.Xx||b===ic.a.marginTop||b===ic.a.marginBottom)this.Lgj(),this.TEa(),this.J3a([1])}Lgj(){var b=this.t2b();b&&(b=mf.a.Ni(b.Xx,1),this.cFa.style.height=Math.round(b*this.HM).toString()+"px")}TEa(){window.requestAnimationFrame(()=>{var b=this.Xef();if(b){const h=rd.a.getElementBounds(b);this.cFa.style.height=h.height.toString()+
"px";b=this.PKl(b);this.cFa.style.marginTop=b+"px"}})}PKl(b){b=b.getBoundingClientRect().y;let h=this.ZKe.getBoundingClientRect().y;return b-h}rNe(){if(!this.cFa&&!this.N3){this.I3g=document.createElement("div");this.N3.id=Pr.lYj;this.N3.className=Pr.kYj;this.N3.setAttribute(qf.a.cda,WordEditorIntl.WordEditorStrings.L_Ruler);this.N3.setAttribute(qf.a.Ah,qf.a.Ech);Sys.UI.DomElement.addCssClass(this.N3,"HideWACVerticalRulerContainer");if(this.edi){var b=u.AFrameworkApplication.K.lb("ModernUxExperimentPreferenceCookieName");
const h=u.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");Ya.a.Lka(b,!h)&&Sys.UI.DomElement.addCssClass(this.N3,Pr.jLj)}this.J3g=document.createElement("div");this.cFa.className=Pr.jYj;this.cFa.id=Pr.mYj;this.N3.appendChild(this.cFa);b=document.getElementById(Qe.AppFrame.L3c);b.insertBefore(this.N3,b.firstChild)}}static YD(){return new Pr(Oa.a.instance.Za("Common.IZoomManager"),ob.App.Wj,u.AFrameworkApplication.ya,Cj.UISurfaces.TWh,Oa.a.instance.resolve("WordEditor.IRulerContextMenu"),
Pq.a.instance,Oa.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=Pr.dlg?Pr.dlg:Pr.dlg=Pr.YD()}}Pr.lYj="WACVerticalRulerContainer";Pr.kYj="WACVerticalRulerContainer";Pr.mYj="WACVerticalRuler";Pr.jYj="WACVerticalRuler";Pr.jLj="ModernUxWACVerticalRulerContainer";Object(r.a)(Pr,"VerticalRuler",Ux,[]);class hl{constructor(b,h,n,x,E,S,ma,Fa,$a){this.vqe=this.Vse=!1;this.A2="RulerActor";this.MXg=null;this.Tla=!1;this.Qwj="ClearAllTabStopsFailed";this.b_g="ShowHideRulerFailed";
this.Oue=null;this.Mtd=(sb,Jb,Sb)=>{if(1===Sb)return 32;sb=this.ga.processAction(ub.a.KHb,2,null);32===sb?(Sb=1,Jb=String.format("Clear all tab stops from ruler"),w.ULS.sendTraceTag(591213266,3014,50,Jb)):(Sb=0,Jb=String.format("Unable to clear all tab stop from ruler"),w.ULS.sendTraceTag(591213267,3014,15,Jb),hl.recordQosError(this.Qwj,[hl.Eca],Jb));const oc=new Map;oc.set("Command","ClearAllTabStops");oc.set("Source",this.A2);oc.set("Response",Jb);ta.Health.instance.recordKpiUsage(Jo.kpiName,Sb,
Jo.S5,oc);return sb};this.GLc=(sb,Jb,Sb)=>{if(1===Sb)switch(sb){case ub.a.sRe:case ub.a.V0e:return 2;default:return 32}Jb=this.qEe.hEl();switch(sb){case ub.a.Wuf:var oc=1;break;case ub.a.NTf:oc=4;break;case ub.a.zUe:oc=3;break;default:return w.ULS.sendTraceTag(591213268,3014,15,"Tried to insert bar or decimal tab stop."),2}sb=new Rw.a(Jb,oc,0,1);sb=this.ga.Xb(ub.a.jZc,2,sb);32===sb?(Sb=1,Jb=String.format("Insert Custom Tab Stop from Ruler. Tab: {0}. Value: {1}",ev[oc],Jb.toString()),w.ULS.sendTraceTag(591213269,
3014,50,Jb)):(Sb=0,Jb=String.format("Unable to set custom tab stop from ruler. Tab: {0}. Value: {1}",ev[oc],Jb.toString()),w.ULS.sendTraceTag(591213270,3014,15,Jb));oc=new Map;oc.set("Command","InsertCustomTabStopRuler");oc.set("Source",this.A2);oc.set("Response",Jb);ta.Health.instance.recordKpiUsage(Jo.kpiName,Sb,Jo.S5,oc);return sb};this.VJb=(sb,Jb,Sb,oc,Ic)=>this.Vse||1===Sb&&Ee.a.Jla(Jb.tk)&&Ee.a.rCb()?8:this.Tla?this.kKc(sb,Jb,Sb,oc,Ic):this.lWn(Jb,Sb);this.syn=()=>{this.Tla?w.ULS.sendTraceTag(574128526,
3014,50,"Ruler was already enabled"):(appChrome.api.dispatch(appChrome.actions.setCurrentTab("View")),32!==this.ga.processAction(Db.a.VJb,2)?(w.ULS.sendTraceTag(574128527,3014,50,"Ruler could not be enabled"),hl.recordQosError(this.b_g,[hl.Eca],"Ruler could not be enabled")):w.ULS.sendTraceTag(573190796,3014,50,"Ruler was enabled from teaching callout"))};this.kKc=(sb,Jb,Sb)=>{if(1===Sb||!this.Tla)return 32;this.Tla=!1;this.rEe.TSi(!1);this.P6a.dispose();this.HPd()&&this.s3e();this.Ngj();w.ULS.sendTraceTag(593351623,
3014,50,"Ruler is disabled");sb=new Map;sb.set("Command","HideRuler");sb.set("Source",this.A2);sb.set("Response","");ta.Health.instance.recordKpiUsage(Jo.kpiName,1,Jo.S5,sb);return 32};this.z0d=(sb,Jb,Sb,oc,Ic)=>{if(1===Sb)return 32;Ic&&(Ic[Qf.a.On]=this.Tla);return 32};this.S_l=sb=>{this.Tla=sb.result};this.eBb=()=>{this.Vse=!1};this.f3h=()=>{this.Vse=!0};this.ga=b;this.P6a=h;this.NKe=n;this.RMb=x;this.qEe=E;this.rEe=S;hl.Lk=Fa;this.OGa=ma;this.yY=$a;this.OGa.g9g(this.f3h);this.OGa.gqd(this.eBb)}initialize(){this.Vb();
this.MXg=this.syn;window.addEventListener("TurnRulerOnAction",this.MXg,!0);return this.rEe.yFl().continueWith(this.S_l,8)}Vb(){this.ga.pa(Db.a.VJb,cc.a.view,this.VJb);this.ga.gb(Db.a.z0d,cc.a.view,this.z0d,96);this.ga.pa(ub.a.sRe,cc.a.view,this.GLc);this.ga.pa(ub.a.zUe,cc.a.view,this.GLc);this.ga.pa(ub.a.Mtd,cc.a.view,this.Mtd);this.ga.pa(ub.a.V0e,cc.a.view,this.GLc);this.ga.pa(ub.a.kKc,cc.a.view,this.kKc);this.ga.pa(ub.a.Wuf,cc.a.view,this.GLc);this.ga.pa(ub.a.NTf,cc.a.view,this.GLc);yz.a.fe.addHandler(yz.a.EWd,
this.gTc.bind(this));this.yY.Qub(this.BHf)}C6h(){this.Tla&&(this.P6a.HA(),this.P6a.renderRuler(),this.HPd()&&this.jOi())}jOi(){this.NKe.HA();this.NKe.renderRuler()}s3e(){this.NKe.dispose()}HPd(){return this.nhi()&&this.isPaginatedView()}nhi(){null==this.Oue&&null!=u.AFrameworkApplication.K&&(this.Oue=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VerticalRulerEnabled",!1));return this.Oue}igc(){this.Tla||Oa.a.instance.Za("Common.ISystemInitiatedFeedback").execute(b=>
{b.logActivity("TurnRulerOnActivity",null)})}pS(){this.OGa.Ppn(this.f3h);this.OGa.tNi(this.eBb);this.Tla&&(this.P6a.dispose(),this.HPd()&&this.s3e())}Ngj(){if(this.RMb){const b={};b[Jo.omo]="ToggleButtonModel";this.RMb.ZF(b)}}lWn(b,h){if(!hl.Lk.m$(b.tk))return w.ULS.sendTraceTag(574375060,3014,15,"Cannot show ruler. Word Section Node not found."),hl.recordQosError(this.b_g,[hl.Eca],"Cannot show ruler. Word Section Node not found."),8;if(1===h)return 32;this.Tla=!0;this.rEe.TSi(!0);this.C6h();this.Ngj();
w.ULS.sendTraceTag(593351624,3014,50,"Ruler is enabled");b=new Map;b.set("Command","ShowRuler");b.set("Source",this.A2);b.set("Response","");ta.Health.instance.recordKpiUsage(Jo.kpiName,1,Jo.S5,b);return 32}isPaginatedView(){return 1===this.yY.Hx}gTc(b,h){switch(h.documentMode){case "View":this.Tla&&(this.ga.processAction(Db.a.VJb,2),this.vqe=!0);break;case "Edit":this.vqe&&(this.ga.processAction(Db.a.VJb,2),this.vqe=!1)}}BHf(b,h){if(hl.instance.Tla&&hl.instance.nhi())switch(h.t9b){case 1:hl.instance.jOi();
break;case 0:hl.instance.s3e()}}static recordQosError(b,h,n){const x=Object.assign(new ab.a,{extendedProperties:new Map});n&&x.extendedProperties.set("exception",n);ta.Health.instance.recordQosError(b,h,!1,!0,!1,!1,x)}static YD(){return new hl(u.AFrameworkApplication.ya,Or.instance,Pr.instance,ob.App.xa,Oa.a.instance.resolve("WordEditor.IRulerContextMenu"),Oa.a.instance.Pa("WordEditor.Ruler.IRulerSettingInfo"),Oa.a.instance.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),Pm.a.instance,
Oa.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=hl.gkg?hl.gkg:hl.gkg=hl.YD()}}hl.Lk=null;hl.Eca="RulerInteractionFailed";Object(r.a)(hl,"RulerActor",null,[]);class dE{constructor(b,h){this.juc=null;this.t0a=n=>n.result?n.result.Value.toString():"";this.ECa=n=>{n.ho||n.Ii?(w.ULS.sendTraceTag(591541278,3014,15,"Failed to get ruler is enabled settings options from Roaming Service."),this.juc=!1):(n=n.result,""===n&&u.AFrameworkApplication.K&&(n=u.AFrameworkApplication.K.lb("RulerDefaultOn")),
this.juc="true"===n.toLowerCase(),w.ULS.sendTraceTag(591541279,3014,50,"Load to get ruler is enabled settings options from Roaming Service successfully."));return this.juc};this.Qu=b;this.yJ=h}yFl(){const b=new Nb.a;if(null==this.juc){if(this.cfi())return this.yJ.p1a(jw.a.sYc).CWRCo(this.t0a,0).CWRCo(this.ECa,8);b.Gg(!1)}else b.Gg(this.juc);return b.task}P_(b){this.yJ.P_(jw.a.sYc,new rB.a(jw.a.sYc,b))}TSi(b){this.cfi()&&(this.Qu.zga("saveRulerIsEnabled",b.toString()),w.ULS.sendTraceTag(591541276,
3014,50,"Try to save ruler settings value to Roaming Service."));this.P_(b)}cfi(){const b=u.AFrameworkApplication.K.$("IsAnonymousUser");if(u.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)w.ULS.sendTraceTag(591541277,3014,50,"User is anonymous ");else return!0;return!1}}Object(r.a)(dE,"RulerSettingInfo",null,[289]);class eE{constructor(){this.vHg=this.W=null}get name(){return"WordEditor.Ruler"}zc(b){this.W=b;w.ULS.sendTraceTag(578110851,3014,50,"Word ruler package is configured.")}init(){this.W.ha("WordEditor.Ruler.RulerSettingInfo",
()=>new dE(this.W.resolve("Box4.IRoamingServiceRequestManager"),this.W.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.Ruler.IRulerSettingInfo").singleInstance();this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Nm()});this.vHg=hl.instance.initialize();w.ULS.sendTraceTag(578110852,3014,50,"Word ruler package is initialized")}Nm(){this.vHg.continueWith(()=>{hl.instance.C6h();hl.instance.igc()});w.ULS.sendTraceTag(578110853,3014,50,"InitializeRuler is called")}dispose(){hl.instance.pS();
w.ULS.sendTraceTag(578110854,3014,50,"Word ruler package is disposed")}}Object(r.a)(eE,"PackageManager",null,[1,2]);class WC{constructor(){this.B4b=this.LWb=null}}Object(r.a)(WC,"CreatePickerCustomizationDictionaryOptions",null,[898]);class fC{}fC.ug="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(r.a)(fC,"InsertMediaM365DialogHtml",
null,[]);class bx{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd,Gd){this.A5a=null;this.gpf=this.ydd=!1;this.t3i=vd=>{if(vd.rawEvent&&(vd=vd.rawEvent.data))try{const ce=Sys.Serialization.JavaScriptSerializer.deserialize(vd,!0),od=ce.MessageId?ce.MessageId.toString():null;ce&&od&&(od===F.a.insertImage||od===F.a.vmf)&&this.asc.start(od===F.a.insertImage?this.c7a:this.GHg)}catch(ce){}};this.Tfo=(vd,ce,od,Yd,ne)=>{if(1===od)return 32;this.oKg?vd=CommonUIStrings.l_OneDriveName:""!==this.Tad?vd=this.Tad:
(vd=CommonUIStrings.l_HostGeneric,w.ULS.sendTraceTag(20509841,352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));ne[nl.a.LabelText]=vd;return 32};this.Wfo=(vd,ce,od,Yd,ne)=>{if(1===od)return 32;if(!u.AFrameworkApplication.Wpf())return ne[nl.a.Visible]=!1,32;this.oKg?vd=String.format(CommonUIStrings.l_ChangePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.Tad?vd=String.format(CommonUIStrings.l_ChangePictureFromHost,this.Tad):(vd=CommonUIStrings.l_ChangePictureFromHostGeneric,
w.ULS.sendTraceTag(577835747,352,15,"InsertMediaActor::UpdateEntryPointsForChangePictureHostButton : Do not have host name, use generic name instead."));ne[nl.a.LabelText]=vd;return 32};this.Ufo=(vd,ce,od,Yd,ne)=>{if(1===od)return 32;u.AFrameworkApplication.K.$("InsertOnlinePictureEnabled")||(ne[nl.a.Visible]=!1);return 32};this.Vfo=(vd,ce,od,Yd,ne)=>{if(1===od)return 32;u.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled")||(ne[nl.a.Visible]=!1);return 32};this.r7d=(vd,ce,od)=>{ce=
this.toc.value.mda(ce);if(1===od)return ce&&this.b7a.Xcm?32:8;if(2!==od||!ce)return 8;this.A5a=na.a.create();w.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");vd=this.Wtl(vd,this.A5a);vd=this.Rbd.NHc(vd);vd.correlationId=this.A5a;vd.P4b=this.HHg;vd.qfa=1;return this.p7d(vd,CommonUIStrings.L_PictureInsertTitle,this.c7a)};this.uVn=(vd,ce,od)=>{vd=32===this.ga.Qf(ce,Db.a.insertHyperlink,1,!1,null,null);if(1===od)return vd&&this.b7a.bci?32:8;if(2!==
od||!vd)return 8;w.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");return this.p7d(this.FHg.getInstance(),Box4Intl.Box4Strings.l_InsertOneDriveFile,this.GHg)};this.g3i=(vd,ce,od)=>{vd=this.toc.value.mda(ce);if(1===od)return vd&&this.b7a.Vpf?32:8;if(2!==od||!vd)return 8;w.ULS.sendTraceTag(17838539,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog.");return this.p7d(this.FHg.getInstance(),CommonUIStrings.L_PictureInsertTitle,
this.c7a)};this.n7d=(vd,ce,od)=>{ce=this.toc.value.mda(ce);if(1===od)return ce&&this.b7a.Zcm?32:8;if(2!==od||!ce)return 8;w.ULS.sendTraceTag(587532180,352,50,"InsertMediaActor::ShowInsertM365PictureFromSearchDialog : Show dialog.");this.A5a=na.a.create();od=u.AFrameworkApplication.K.$("StockImagesFreemiumExperienceIsEnabled")&&this.eR.isFreemiumUpsellEnabled();od=this.ydd?1:od?0:-1;vd=this.Awl(vd,this.A5a,od);vd=this.Rbd.NHc(vd);vd.ug=fC.ug;vd.correlationId=this.A5a;vd.qfa=2;vd.P4b=this.HHg;vd.YIa=
this.eR;vd.gij=od;return this.p7d(vd,CommonUIStrings.L_PictureInsertTitle,this.c7a)};this.s7d=(vd,ce,od)=>{ce=this.toc.value.mda(ce);vd=Oa.a.instance.Pa("Common.App.SharedFilePicker.ISharedFilePicker");if(1===od)return ce&&!this.b7a.Vpf&&vd&&vd.bsf()?32:8;if(2!==od||!ce||!vd)return 8;w.ULS.sendTraceTag(553734720,352,50,"InsertMediaActor::showInsertPictureFromSharedPicker : Show dialog.");this.A5a=na.a.create();od=bx.E3g;ce=!1;u.AFrameworkApplication.Xpf()&&(ce=this.nel());const Yd=new WC;Yd.LWb=ce;
Yd.B4b=!0;od=vd.vZe(CommonUIStrings.L_ImageUploadButtonText,"Select Images",!0,!1,!0,od,"Insert Media",1,Yd);vd.xcf(od).then(ne=>{if(null!=ne&&0<ne.length){const Df=[];for(let Af=0;Af<ne.length;Af++){const Wi=ne[Af][G.a.hDi],gm=ne[Af][G.a.gDi],Ck={};Ck.Extension=Wi;Ck.OriginalUrl=gm;Ck.caption=Wi;Df.push(Ck)}this.c7a.LLa=Db.a.u1;this.c7a.hZa(Df)}});return 32};this.q7d=(vd,ce,od)=>{ce=this.toc.value.mda(ce);vd=Oa.a.instance.Pa("Common.App.SharedFilePicker.ISharedFilePicker");if(1===od)return ce&&vd&&
vd.bsf()?32:8;if(2!==od||!ce||!vd)return 8;od=Oa.a.instance.Pa("Common.App.PhoneLink.IPhoneLinkManager");null!=od&&od.A5k(u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));w.ULS.sendTraceTag(526951881,352,50,"InsertMediaActor::showInsertPictureFromMobileDevice : Show dialog.");this.A5a=na.a.create();od=bx.E3g;ce=new WC;ce.LWb=!0;ce.B4b=!0;od=vd.vZe(CommonUIStrings.L_ImageUploadButtonText,CommonUIStrings.L_ImageUploadingTitle,
!0,!1,!0,od,"InsertPictureFromMobile",3,ce);vd.xcf(od).then(Yd=>{if(null!=Yd&&0<Yd.length){var ne=[];for(let Df=0;Df<Yd.length;Df++){const Af=Yd[Df][G.a.hDi],Wi=Yd[Df][G.a.gDi],gm={};gm.Extension=Af;gm.OriginalUrl=Wi;gm.caption=Af;ne.push(gm)}this.c7a.LLa=Db.a.u1;this.c7a.hZa(ne);ne={};ne.InsertImageCount=Yd.length;Pe.c(Db.a.S3l,void 0,void 0,void 0,void 0,void 0,ne)}});return 32};this.asc=x;this.ygd=E;this.Rbd=ma;this.FHg=Fa;this.G0=$a;this.ga=b;this.toc=S;this.oKg=oc;this.Tad=gd;this.b7a=n;this.c7a=
sb;this.GHg=Jb;this.HHg=Gd;(this.eR=Sb)&&this.eR.isFeatureEnabled("MsoPremiumStockImages",!1).catch(vd=>w.ULS.sendTraceTag(577249666,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",vd)).then(vd=>{(this.ydd=vd)||this.eR.Rua("MsoPremiumStockImages",()=>{this.ydd=!0;w.ULS.sendTraceTag(577249667,352,50,"InsertMediaActor::Constructor - License state changed to premium")});return null})}Vb(){(this.b7a.Vpf||this.b7a.bci)&&this.b7a.Ycm&&this.I5m();
this.Ojn();this.Njn();this.ga.gb(Db.a.Ljh,cc.a.view,this.g3i,1284);this.ga.gb(Db.a.xGi,cc.a.view,this.Wfo,1124);this.ga.gb(Db.a.Hmf,cc.a.view,this.g3i,1284);this.ga.gb(Db.a.qNf,cc.a.view,this.Tfo,1124);this.ga.gb(Db.a.$3l,cc.a.view,this.uVn,1284)}Ojn(){this.ga.gb(Db.a.insertOnlinePicture,cc.a.view,this.r7d,1284);this.ga.gb(Db.a.CLd,cc.a.view,this.n7d,1284);this.ga.Gaa("word_insertOnlinePictures",Db.a.insertOnlinePicture,cc.a.view,this.r7d,b=>{ob.App.xa.BLb(b,Object(v.a)(new Dh.a,(new Dh.a).Vcb,"getCommandById"))});
this.ga.Gaa("word_insertOnlinePictures",Db.a.CLd,cc.a.view,this.n7d,b=>{ob.App.xa.BLb(b,Object(v.a)(new Dh.a,(new Dh.a).Vcb,"getCommandById"))});this.ga.gb(Db.a.IUe,cc.a.view,this.r7d,1284);this.ga.gb(Db.a.KUe,cc.a.view,this.s7d,1284);this.ga.Gaa("word_insertOnlinePictures",Db.a.KUe,cc.a.view,this.s7d);this.ga.gb(Db.a.LUe,cc.a.view,this.n7d,1284);this.ga.gb(Db.a.vGi,cc.a.view,this.Ufo,1284);this.ga.gb(Db.a.wGi,cc.a.view,this.Vfo,1284);this.ga.Gaa("word_insertOnlinePictures",Db.a.IUe,cc.a.view,this.r7d);
this.ga.Gaa("word_insertOnlinePictures",Db.a.LUe,cc.a.view,this.n7d);this.ga.gb(Db.a.Jmf,cc.a.view,this.s7d,1284);this.ga.Gaa("word_insertOnlinePictures",Db.a.Jmf,cc.a.view,this.s7d,b=>{ob.App.xa.BLb(b,Object(v.a)(new Dh.a,(new Dh.a).Vcb,"getCommandById"))})}Njn(){u.AFrameworkApplication.Xpf()&&(this.ga.gb(Db.a.Mmf,cc.a.view,this.q7d,1284),this.ga.gb(Db.a.JUe,cc.a.view,this.q7d,1284),this.ga.Gaa("mso_insertMobileDevicePictures",Db.a.Mmf,cc.a.view,this.q7d,b=>{ob.App.xa.BLb(b,Object(v.a)(new Dh.a,
(new Dh.a).Vcb,"getCommandById"))}),this.ga.Gaa("mso_insertMobileDevicePictures",Db.a.JUe,cc.a.view,this.q7d,b=>{ob.App.xa.BLb(b,Object(v.a)(new Dh.a,(new Dh.a).Vcb,"getCommandById"))}))}I5m(){u.AFrameworkApplication.ua.get_element().appendChild(this.ygd.cXa);af.a.addHandler(this.ygd.cXa.contentWindow,"message",this.t3i);this.gpf=!0}Wtl(b,h){let n=0;u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb&&5===u.AFrameworkApplication.ua.Sb.jo&&(n=12);const x=vj.a.lg(u.AFrameworkApplication.lcid);
return String.format(u.AFrameworkApplication.K.appSettings.WordInsertPictureServiceEndpoint,b===Db.a.insertOnlinePicture?1:0,u.AFrameworkApplication.lcid,x?x.name:"en-us",u.AFrameworkApplication.buildVersion,h,n,u.AFrameworkApplication.K.lb("UserId"))}p7d(b,h,n){try{return b.o7d(h,n),w.ULS.sendTraceTag(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(x){return w.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",
x.toString()),this.qp(ri.a.noPictureSpecified,CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ClipartCannotConnect),8}}Awl(b,h,n){return Db.a.CLd===b?this.G0.Sfh(u.AFrameworkApplication.K.lb("InsertOnlineM365PictureEndpoint"),h.toString(),1,n):this.G0.Sfh(u.AFrameworkApplication.K.lb("InsertOnlineM365PictureEndpoint"),h.toString(),0,n)}qp(b,h,n){const x=new yd.StandardDialog(!0);x.yt=u.AFrameworkApplication.A$;x.Ed=0;x.We(1,CommonUIStrings.l_DialogClose);x.fy(b,h,n,()=>{})}nel(){const b=
Oa.a.instance.Pa("Common.App.PhoneLink.IPhoneLinkManager");return null!=b?b.kil():!1}dispose(){this.gpf&&this.ygd.cXa.contentWindow&&(af.a.removeHandler(this.ygd.cXa.contentWindow,"message",this.t3i),this.gpf=!1)}}bx.E3g=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(r.a)(bx,"InsertMediaActor",null,[10]);var lA=d(925);class XC extends lA.a{constructor(b,h){super(b,Ec.a.h$(h))}xr(b,h){this.isEnabled()&&this.LUa(this.d3a)&&(this.vv(b),this.VB(b,h))}}Object(r.a)(XC,"InsertMediaCrossDocumentMessenger",
lA.a,[516,64,10]);class fE{getInstance(b,h){return new XC(b,h)}}Object(r.a)(fE,"InsertMediaCrossDocumentMessengerFactory",null,[467]);var gE=d(999);class $E{}$E.ug="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(r.a)($E,"InsertMediaDialogHtml",null,[]);var YC;(function(b){b[b.OK=0]="OK";b[b.cancel=1]="cancel";b[b.error=2]="error";
b[b.open=3]="open"})(YC||(YC={}));Object(r.b)("HubbleAction",YC);var uB;(function(b){b[b.unknown=0]="unknown";b[b.bing=1]="bing";b[b.M365=2]="M365";b[b.icons=3]="icons";b[b.oneDrive=4]="oneDrive";b[b.hubble=5]="hubble"})(uB||(uB={}));Object(r.b)("InsertMediaProviders",uB);class aF extends Kc.a{constructor(b,h,n,x=null,E=!1){super(!1,!1,E);this.nG=null;this.Fmc=!1;this.JQc=this.NZ=null;this.zTe="KeepFocusDiv";this.usd="KeepFocusStartDiv";this.correlationId=null;this.qfa=0;this.YIa=this.P4b=null;this.gij=
0;this.twe=null;this.CRm=()=>{this.NZ&&(this.NZ.style.visibility="visible",window.setTimeout(()=>{if(this.Ik){const S=this.Ik.getElementById(this.usd);S&&S.focus()}},0))};this.X$=S=>{S.keyCode===Sys.UI.Key.tab&&(S.target.id!==this.zTe||S.shiftKey?S.target.id===this.usd&&S.shiftKey&&(S.preventDefault(),this.Ik.getElementById(this.zTe).focus()):(S.preventDefault(),this.Ik.getElementById(this.usd).focus()))};this.Dui=()=>{w.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.syb(this.pVa);
this.Jjb(1)};this.Pvi=()=>{this.nG&&(w.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.nG.sendMessage(F.a.AGn,{["CustomHeaders"]:""}))};this.Svi=()=>{this.nG&&(w.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.nG.sendMessage(F.a.uMn,{["SessionId"]:u.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))};this.Ovi=()=>{this.nG&&(w.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.nG.sendMessage(F.a.GFn,{["CID"]:""}))};
this.XRm=()=>{this.YIa&&(w.ULS.sendTraceTag(577249665,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.YIa.launchUpsellExperience("stockimages"))};if(!b)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.Sbd=b;this.UOb="";this.G0=n;this.Fca=[];this.Hhd=h;this.ug=x||$E.ug;this.kg="InsertMediaDialog"}get telemetryEventName(){return"InsertM365Images"}o7d(b,h){this.UOb=b;this.Fmc=!1;this.showDialog(this.UOb,null);this.NZ=
this.X1b(this.pj("insertmediaframe"));if(!this.NZ)throw this.syb(this.pVa),Error.invalidOperation("Couldn't get InsertMediaIframe.");b=document.createElement("div");b.setAttribute("Id",this.usd);b.setAttribute("tabindex","0");b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","-1000px");this.NZ.parentNode.insertBefore(b,this.NZ.parentNode.firstChild);b=document.createElement("div");b.setAttribute("Id",this.zTe);b.setAttribute("tabindex","0");this.NZ.parentNode.appendChild(b);
b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","10000px");$addHandler(this.h2e,"keydown",this.X$);this.NZ.src=this.Sbd;this.NZ.style.width="100%";this.NZ.style.height="100%";this.NZ.frameBorder="0";u.AFrameworkApplication.K.$("ShowInsertMediaIframeWhenIframeIsReady")&&V.a.fj?(this.NZ.style.visibility="hidden",this.JQc=this.CRm,af.a.addHandler(this.NZ,"load",this.JQc)):this.NZ.style.visibility="visible";this.X1b(this.pj("WACDialogButtonPanel")).style.display=
"none";this.X1b(this.pj("WACDialogTitleText")).style.display="none";2===this.qfa&&(this.X1b(this.pj("WACDialogTitlePanel")).style.display="none",this.X1b(this.pj("WACDialogBodyPanel")).style.padding="0");de.FocusManager.instance().Cs().scope.LL=!0;this.nG=this.Hhd.getInstance(this.NZ.contentWindow,this.Sbd);this.nG.xr(F.a.N6g,n=>{this.Tti(n,Object(v.a)(h,h.hZa,"insertMediaCallback"))});this.nG.xr(F.a.insert,n=>{this.qWd(n,Object(v.a)(h,h.hZa,"insertMediaCallback"))});this.nG.xr(F.a.m2j,n=>{this.TSm(n)});
this.nG.xr(F.a.JNh,this.Pvi);this.nG.xr(F.a.getSessionId,this.Svi);this.nG.xr(F.a.xLh,this.Ovi);this.nG.xr(F.a.Msd,this.Dui);2!==this.qfa||this.gij||(this.nG.xr(F.a.zom,this.XRm),this.twe=this.YIa.Rua("MsoPremiumStockImages",n=>{w.ULS.sendTraceTag(577249664,352,50,"OnCompleteM365Upsell: upsell completed from stock images");this.nG.sendMessage(F.a.Xko,{["LicenseTier"]:n.toString()})}));this.Jjb(3)}dispose(){this.YIa&&this.twe&&this.YIa.zbc("MsoPremiumStockImages",this.twe);this.nG&&(this.nG.dispose(),
this.nG=null);this.JQc&&(af.a.removeHandler(this.NZ,"load",this.JQc),this.JQc=null);super.dispose()}Tti(b,h){w.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");if(b=this.G0.Q0m(b))this.Fca.push(b),this.Fmc&&(h(this.Fca),this.Fmc=!1)}qp(){const b=new yd.StandardDialog(!0);b.yt=u.AFrameworkApplication.A$;b.Ed=0;b.We(1,CommonUIStrings.l_DialogOk);b.Lv(CommonUIStrings.l_ImageUploadFailedTitle,CommonUIStrings.l_InsertPictureMaxLimitExceeded,2,()=>{})}Jjb(b){var h=RegExp("hubble","gi");if(this.P4b&&
0<this.P4b.search(h)&&this.correlationId){h=u.AFrameworkApplication.sessionStartInfoSettings;var n={};n.InsertedFiles=this.Fca.length;n.MediaDetails=this.Fca;n.DialogResult=YC[b];n.DialogMode=this.Ydf();n.CorrelationId="{"+this.correlationId.toString()+"}";n.Platform="Wac";n.Provider=uB[this.qfa]||"Unknown";n.AudienceGroup=h&&"AudienceGroup"in h?h.AudienceGroup.toString():"Unknown";n.Ring=h&&"Ring"in h?h.Ring.toString():"Unknown";n.AppId=2;n.Build=u.AFrameworkApplication.buildVersion;n.Locale=vj.a.lg(u.AFrameworkApplication.lcid).name;
this.N5m().send(JSON.stringify(n))}2===this.qfa&&(n=u.AFrameworkApplication.K.lb("InsertMediaDialogAriaTenantNameSpace"))&&""!==n&&(h=[],h.push(Object.assign(new ca.a,{name:"InsertedFiles",int64:this.Fca.length})),h.push(Object.assign(new ca.a,{name:"MediaDetails",string:JSON.stringify(this.Fca)})),h.push(Object.assign(new ca.a,{name:"DialogResult",string:YC[b]})),h.push(Object.assign(new ca.a,{name:"DialogMode",string:this.Ydf()})),h.push(Object.assign(new ca.a,{name:"CorrelationId",string:this.correlationId.toString()})),
h.push(Object.assign(new ca.a,{name:"Provider",string:uB[this.qfa]||"Unknown"})),Y.a.sendTelemetryEvent(Object.assign(new fa.a,{name:String.format("{0}.{1}",n,this.telemetryEventName),dataFields:h})))}Ydf(){return 3===this.qfa?"Icons":5===this.qfa?"ExternalContent":"Images"}X1b(b){const h=document.getElementById(b);if(!h)throw Error.invalidOperation(String.format("Couldn't get {0}.",b));return h}N5m(){const b=new XMLHttpRequest;b.open("POST",this.P4b,!0);b.setRequestHeader("Content-Type","");return b}qWd(b,
h){w.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.syb(this.pVa);h?this.Fca&&50<this.Fca.length?(this.qp(),this.Jjb(0),w.ULS.sendTraceTag(578140104,352,10,"InsertMediaDialog: User tried to insert {0} images using {1}",this.Fca.length,uB[this.qfa])):this.Fca&&0<this.Fca.length?(h(this.Fca),this.Jjb(0),w.ULS.sendTraceTag(578140105,352,50,"InsertMediaDialog: User inserted {0} images using {1}",this.Fca.length,uB[this.qfa])):(w.ULS.sendTraceTag(23078422,352,15,"Empty search result."),
this.Fmc=!0,h(this.Fca),this.Jjb(2)):this.Jjb(2)}TSm(b){b&&b.Values&&(b=b.Values,delete b.m_Origin,delete b.m_Source,delete b.m_ReceivedTime,w.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+b.eventName||!1),Y.a.sendOtelEvent(Object.assign(new gE.a,{otelEvent:b})))}}Object(r.a)(aF,"InsertMediaDialog",Kc.a,[468,10]);class uI{constructor(b,h){this.Mre=b;this.G0=h}NHc(b,h=!1){return new aF(b,this.Mre,this.G0,$E.ug,h)}getInstance(){throw Error.notImplemented();}}Object(r.a)(uI,"InsertMediaDialogFactory",
null,[466]);class vI{constructor(b,h,n){this.a$h=!1;this.correlationId=null;this.qfa=0;this.P4b=null;this.UEj=b;this.uwc=[];this.Uad=h;this.x0g=n.split(";")}o7d(b,h){Array.clear(this.uwc);b=this.UEj.value;b.LUa(this.Uad);b.vv(h.tKc);this.a$h||(b.VB(h.tKc,n=>{this.qWd(n,h)}),this.a$h=!0);w.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");b.sendMessage(h.vuh,{["FileExtensionFilterList"]:this.x0g})}s4j(b){Array.contains(this.uwc,b)||this.uwc.push(b)}qWd(b,
h){w.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");b=h.XBi(b);const n=[];for(let x=0;x<b.length;x++){const E=b[x];h.oNd(E,this.x0g)?n.push(E):this.s4j(h.zWh(E))}n&&n.length?h.hZa(n):w.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.uwc.length&&(h=this.uwc.join(", "),w.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",h),this.OWn(h))}OWn(b){const h=
new yd.StandardDialog;h.Ed=0;h.nU(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,b),null)}dispose(){}}Object(r.a)(vI,"InsertMediaFromHostManager",null,[468,10]);class wI{constructor(b){this.ZFj=b}NHc(){throw Error.notImplemented();}getInstance(){return this.ZFj}}Object(r.a)(wI,"InsertMediaFromHostManagerFactory",null,[465,466]);class xI{constructor(){this.cXa=document.createElement("iframe");this.cXa.src="about:blank";this.cXa.style.visibility=
"hidden";this.cXa.style.position="absolute";this.cXa.style.zIndex="-100"}}Object(r.a)(xI,"InsertMediaFromHostOneDriveHostFrame",null,[464]);class yI extends lA.a{constructor(b,h){super(b,"*"===h?h:Ec.a.h$(h));this.R5g(F.a.insertImage);this.R5g(F.a.vmf)}Y2d(){}}Object(r.a)(yI,"InsertMediaFromOneDriveCrossDocumentMessenger",lA.a,[63,64,10]);class bF{}Object(r.a)(bF,"OnlineMediaSearchResult",null,[]);class ZC{Sfh(b,h,n,x){const E=vj.a.lg(u.AFrameworkApplication.lcid).name,S=u.AFrameworkApplication.buildVersion,
ma=B.a.TV(u.AFrameworkApplication.K.lb("UserId")).toString();if(-1!==b.indexOf("exp=")){const Fa=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertOnlineM365ExperimentEnabled",!1)?1:0;u.AFrameworkApplication.Hf("ShIns226;ShIns226cf");return String.format(b,u.AFrameworkApplication.lcid,E,S,h,ZC.Pee,ma,x,n,Fa)}return String.format(b,u.AFrameworkApplication.lcid,E,S,h,ZC.Pee,ma,x,n)}Q0m(b){if(!b||!b.Values)return null;b=b.Values;if(!b)return null;let h="";"sourceProvider"in
b&&(h=b.sourceProvider||"");return Object.assign(new bF,{Action:b.action||"",Caption:b.caption||"",ContentType:b.contenttype||"",Type:b.extension||"",PageUrl:b.pageUrl||"",OriginalUrl:b.sourceUrl||"",ContentProvider:h,ThumbnailUrl:b.thumbnailUrl||"",LicenseUrl:b.licenseUrl||"",LicenseDisplayName:b.licenseDisplayName||"",Height:b.height||0,Width:b.width||0,SvgContent:b.svgContent||"",Html:b.html||""})}R0m(b){const h=[];if(!b||!b.Values||!b.Values.Items)return h;b=b.Values.Items;for(let x=0;x<b.length;x++){var n=
b[x];n&&(n=Object.assign(new bF,{Type:n.Extension||"",OriginalUrl:n.SourceUrl||"",Caption:n.caption,Height:n.Height||0,Width:n.Width||0}),h.push(n))}return h}lJf(b){const h=[];for(let x=0;x<b.data.files.length;x++){var n=b.data.files[x];n&&(n=Object.assign(new bF,{ContentType:n.itemType||"",Type:n.extension||"",OriginalUrl:n.urls&&n.urls.open?n.urls.open:"",Height:n.photo?n.photo.height:0,Width:n.photo?n.photo.width:0}),h.push(n))}return h}oNd(b,h){if(!b)return!1;for(let n=0;n<h.length;n++)if(0<=
b.toLowerCase().indexOf(h[n]))return!0;return!1}D5m(b){let h="";if(b)for(let n=0;n<b.length;n++){const x=b[n];x&&(h+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',x.OriginalUrl,x.Width,x.Height))}return h}}ZC.Pee=0;Object(r.a)(ZC,"InsertMediaHelper",null,[463]);class zI{constructor(b,h,n,x,E){this.Xcm=b;this.Vpf=h;this.bci=n;this.Ycm=x;this.Zcm=E}}Object(r.a)(zI,"InsertMediaSettingsManager",null,[]);class BG{constructor(b){this.Eoc=Db.a.insertHyperlink;this.ga=b}get LLa(){return this.Eoc}set LLa(b){this.Eoc=
b}hZa(b){try{w.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length);for(let h=0;h<b.length;h++)this.ga.Xb(this.LLa,2,b[h]);w.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length)}catch(h){w.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",h.toString())}}}Object(r.a)(BG,"InsertOneDriveFileHandler",null,[291]);class AI extends BG{constructor(b){super(b)}get vuh(){return F.a.vmf}get tKc(){return F.a.w3l}XBi(b){return b&&
b.Values&&"Items"in b.Values?b.Values.Items:null}zWh(){sd.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}oNd(){return!0}IFi(b,h,n){b=n(b);b.length&&(n={},n.Items=b,h.sendMessage(this.tKc,n))}ZBi(b){const h=[];for(let n=0;n<b.data.files.length;n++){const x=b.data.files[n];if(x){const E={};E.DisplayText=String.format("{0}{1}",x.name,x.extension);E.Url=this.n9k([x.urls.viewInBrowser,x.urls.open,x.urls.download]);h.push(E)}}return h}n9k(b){for(let h=
0;h<b.length;h++)if(b[h]&&""!==b[h])return b[h];w.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid");return""}}Object(r.a)(AI,"InsertOneDriveFileHelper",BG,[290,291]);class CG{constructor(b,h,n){this.Eoc=Db.a.u1;this.xp=null;this.ga=b;this.G0=h;this.Kca=n}get Ac(){return this.ga}get fw(){return this.xp||(this.xp=Oa.a.instance.resolve("Common.Utils.IAriaNotifier"))}get LLa(){return this.Eoc}set LLa(b){this.Eoc=b}hZa(b){try{w.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",
b.length);const h=this.G0.D5m(b);let n=2;if(h&&0<h.length){const x=new qi.DictionaryPropertySet;x.setValue(ad.a.$T,h);x.setValue(ad.a.H$,!0);if(this.Kca){const E=this.Kca.o0c();E.$Wb("insertOnlineImage");x.setValue(ad.a.pra,E)}n=this.ga.Xb(this.LLa,2,x)}w.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",b.length,32===n,""===h)}catch(h){w.ULS.jO(21612225,352,10,h,"InsertImageFromHostHelper::InsertMediaCallback : Exception")}}}
Object(r.a)(CG,"InsertOnlineImageHandler",null,[291]);class cF extends CG{constructor(b,h,n=null){super(b,h,n)}get vuh(){return F.a.insertImage}get tKc(){return F.a.I3l}XBi(b){return this.G0.R0m(b)}zWh(b){return b.Type}oNd(b,h){return this.G0.oNd(b.Type,h)}ZBi(b){return this.G0.lJf(b)}IFi(b,h,n){n=n(b);if(n.length){b=[];for(let x=0;x<n.length;x++){const E=n[x],S={};S.Extension=E.Type;S.SourceUrl=E.OriginalUrl;S.caption=E.Type;S.SourceUrl=E.OriginalUrl;S.Width=E.Width;S.Height=E.Height;b.push(S)}n=
{};n.Items=b;h.sendMessage(this.tKc,n)}}}Object(r.a)(cF,"InsertOnlineImageHelper",CG,[290,291]);class BI{constructor(b,h){this.Qob=b;this.Hhd=h}start(b){this.Qob.start({mode:"open",select:"multi",lightbox:"white"},(h,n)=>{this.hMf(h,n,b)})}hMf(b,h,n){w.ULS.sendTraceTag(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",b);b&&h&&h.data&&h.data.files&&0<h.data.files.length?(b=this.Hhd.getInstance(window.frames[0].parent,window.document.URL),
n.IFi(h,b,Object(v.a)(n,n.ZBi,"parseOneDriveV5Response"))):w.ULS.sendTraceTag(22090010,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}}Object(r.a)(BI,"OneDriveFilePickerHelperV5",null,[288]);class CI{constructor(){this.Qbd=this.W=null}get name(){return"Box4.Media"}zc(b){this.W=b;b.ha("Box4.Media.InsertMediaFromHostOneDriveHostFrame",()=>new xI).as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").singleInstance();const h=new zI(Boolean.parse(u.AFrameworkApplication.K.appSettings.InsertOnlinePictureEnabled||
"false"),u.AFrameworkApplication.Wpf(),!1,u.AFrameworkApplication.AZf(),u.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled"));b.ha("Box4.Media.OneDriveFilePickerHelperV5",()=>new BI(b.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5"),b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"))).as("Box4.Media.IOneDriveFilePickerHelper").singleInstance();b.ha("Box4.Media.InsertMediaActor",()=>new bx(u.AFrameworkApplication.ya,u.AFrameworkApplication.K,
h,b.resolve("Box4.Media.IOneDriveFilePickerHelper"),b.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),new se.a(()=>Oa.a.instance.resolve("Box4.Images.IImageEditor")),b.resolve("Box4.Media.IInsertMediaDialogFactory"),b.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Box4.Media.InsertOnlineImageHelper"),b.resolve("Box4.Media.InsertOneDriveFileHelper"),b.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),u.AFrameworkApplication.Y6b,
u.AFrameworkApplication.Kta,u.AFrameworkApplication.iXl,u.AFrameworkApplication.K.appSettings.InsertPictureTelemetryEndpoint)).singleInstance();b.ha("Box4.Media.InsertMediaDialogFactory",()=>new uI(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("Box4.Media.IInsertMediaDialogFactory").singleInstance();b.ha("Box4.Media.InsertMediaFromHostManagerFactory",()=>new wI(b.resolve("Box4.Media.InsertMediaFromHostManager"))).as("Box4.Media.IInsertMediaFromHostManagerFactory").singleInstance();
b.ha("Box4.Media.InsertMediaFromHostManager",()=>new vI(new se.a(()=>{if(u.AFrameworkApplication.AZf()){var n=Oa.a.instance.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").cXa;n=new yI(n.contentWindow,"*")}else n=u.AFrameworkApplication.EW;return n}),u.AFrameworkApplication.AZf()?Ec.a.h$(window.document.URL):Ec.a.h$(u.AFrameworkApplication.IGb),u.AFrameworkApplication.K.appSettings.ImageFetcherSupportedExtensions)).singleInstance();b.register(fE,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").singleInstance();
b.register(ZC,"Box4.Media.InsertMediaHelper").singleInstance();b.ha("Box4.Media.InsertOnlineImageHelper",()=>new cF(u.AFrameworkApplication.ya,b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Common.Utils.Telemetry.ITelemetry"))).singleInstance();b.ha("Box4.Media.InsertOneDriveFileHelper",()=>new AI(u.AFrameworkApplication.ya)).singleInstance()}init(){this.Qbd=this.W.resolve("Box4.Media.InsertMediaActor");this.Qbd.Vb()}dispose(){this.Qbd&&this.Qbd.dispose()}}Object(r.a)(CI,"MediaPackage",null,
[1,2]);var DI=d(282);class zz{constructor(){this.Lxn="getAddinShortcutsPreference";this.Mxn="saveAddinShortcutsPreference";this.Nxn="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.Tel=6E4;this.CUd=this.fka=this.s7=null}FWh(b){return String.format(this.Nxn,u.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",b,u.AFrameworkApplication.um)}executeRequest(b,h,n,x,E=null){return zz.Ija.pWb(b,h,E,null,n,x,!1,null,this.Tel)}saveSetting(b,h,n,x,E){return this.USi(b,h,n,null,x,
E)}startBatchUpdateScope(){this.CUd=[]}saveShortcutInfoArrayBatch(b,h,n){this.Pzn(n,b,h)}Pzn(b,h,n){const x={action:"",addinId:"",ownerType:0};x.timestamp=(new Date).toUTCString();const E=this.getShortcutInfoArray(h.toString(),n.toString());b?(x.shortcutInfoArray=b,this.BMe(h,n,b)):E&&(x.shortcutInfoArray=E);b={};b[h.toString()]=x;h=new DI.a(n.toString(),b);this.CUd.push(h)}commitBatchUpdateScope(){return this.A_c()?this.Rzn().then(()=>{this.TXb();return Promise.resolve(!0)}):this.Tzn().then(()=>
{this.TXb();return Promise.resolve(!0)})}Rzn(){return this.getSetting().then(b=>{let h=null;if(b&&!({Dv:h}=z.d(b)).returnValue)return w.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);h||(h={});for(const n of this.CUd){(b=h[n.key])||(b={});const x=n.value;for(const E of Ia.a.ON(x))b[E]=x[E];h[n.key]=b}this.s7=h;try{return localStorage.setItem("AddinShortcutPreferenceData",z.c(h)),Promise.resolve(!0)}catch(n){return w.ULS.sendTraceTag(522739853,
0,10,"SaveSettingToLocalStorageBatch failed",n),Promise.resolve(!1)}})}Tzn(){return this.vEn().then(b=>this.g4d(b))}vEn(){return this.jgf().then(b=>{let h=null;b&&(({Dv:h}=z.d(b)).returnValue||w.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));h||(h={});for(const n of this.CUd){(b=h[n.key])||(b={});const x=n.value;for(const E of Ia.a.ON(x))b[E]=x[E];h[n.key]=b}this.s7=h;return z.c(h)})}saveShortcutInfoArray(b,h,n){return this.USi(0,
"","",n,b,h)}USi(b,h,n,x,E,S){const ma=this.A_c(),Fa={};Fa.action=n;Fa.addinId=h;Fa.ownerType=b;Fa.timestamp=(new Date).toUTCString();h=this.getShortcutInfoArray(E.toString(),S.toString());0===b&&x?(Fa.shortcutInfoArray=x,this.BMe(E,S,x)):h&&(Fa.shortcutInfoArray=h);b={};b[E.toString()]=Fa;E=new DI.a(S.toString(),b);return ma?this.Qzn(E):this.Szn(E)}Qzn(b){return this.getSetting().then(h=>{let n=null;if(h&&!({Dv:n}=z.d(h)).returnValue)return w.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),
Promise.resolve(!1);n||(n={});n[b.key]=b.value;this.s7=n;try{return localStorage.setItem("AddinShortcutPreferenceData",z.c(n)),Promise.resolve(!0)}catch(x){return w.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",x),Promise.resolve(!1)}})}Szn(b){return this.uEn(b).then(h=>this.g4d(h))}uEn(b){return this.jgf().then(h=>{let n=null;h&&(({Dv:n}=z.d(h)).returnValue||w.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));
n||(n={});n[b.key]=b.value;this.s7=n;return z.c(n)})}saveSettings(b){this.s7=z.a(b);this.TXb();return this.A_c()?this.XSi(b):this.g4d(b)}XSi(b){try{return localStorage.setItem("AddinShortcutPreferenceData",b),Promise.resolve(!0)}catch(h){return w.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",h),Promise.resolve(!1)}}g4d(b){const h={};h.Wac=b;const n=z.c(h);return new Promise(x=>{try{if(void 0===n||null===n||!n.length||1E6<=n.length)x(!1);else{var E=this.executeRequest(this.FWh(this.Mxn),
2,"SaveAddinShortcutsPreferenceRequest","38",n);E.continueWith(()=>{if(E.ho||E.Ii)w.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),x(!1);else{var S=E.result;void 0!==S.args&&null!==S.args&&void 0!==S.args.data&&null!==S.args.data&&S.args.data.mf===ua.a.qD?x(!0):x(!1)}})}}catch(S){w.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",S.toString()),x(!1)}})}getSetting(){const b=this.A_c();return this.s7?Promise.resolve(z.c(this.s7)):
b?this.UGl():this.jgf()}A_c(){const b=u.AFrameworkApplication.K.$("IsAnonymousUser"),h=u.AFrameworkApplication.K.$("IsRoamingServiceEnabled");return b||!h}UGl(){try{const b=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(b)}catch(b){return w.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",b),Promise.resolve("")}}jgf(){return new Promise((b,h)=>{try{const n=this.executeRequest(this.FWh(this.Lxn),1,"GetSettingRequest","37");n.continueWith(()=>{if(n.ho||
n.Ii)w.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let E="";var x=n.result;x&&x.args&&x.args.data?x.args.data.mf!==ua.a.qD?w.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",x.args.data.mf):x.args.data.Ee?(x=z.a(x.args.data.Ee),x.Wac&&(E=x.Wac)):w.ULS.sendTraceTag(522739865,0,10,"GetSettingFromRoaming : ResponseData is null"):w.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");b(E)}})}catch(n){w.ULS.sendTraceTag(522739866,
0,10,"GetSettingFromRoaming Exception handling request {0}",n.toString()),h("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(b){const h=this.A_c(),n=this;return this.getSetting().then(x=>{let E=null;x&&(E=z.a(x));if(!E)return w.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),Promise.resolve(!0);for(const S of Ia.a.ON(E)){x=E[S.toString()];for(const ma of Ia.a.ON(x)){const Fa=x[ma];if(Fa.addinId===b)delete x[ma.toString()];else if(0===Fa.ownerType&&
Fa.shortcutInfoArray){const $a=Fa.shortcutInfoArray,sb=new Qa.a;for(let Jb=0;Jb<$a.length;++Jb)$a[Jb].addinId!==b&&sb.add($a[Jb]);Fa.shortcutInfoArray=sb.toArray()}}Ia.a.count(x)||delete x[S]}n.s7=E;n.Xmn(b);return h?n.XSi(z.c(E)):n.g4d(z.c(E))})}TXb(){if(this.s7){this.fka=null;const n=this.s7;for(let x in n){var b=x;const E=n[x];for(let S in E){var h=S;const ma=E[S];ma.shortcutInfoArray&&this.BMe(parseInt(h),parseInt(b),ma.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(b=>
{let h=null;if(b&&!({Dv:h}=z.d(b)).returnValue)return w.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.s7=h;this.TXb();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(b,h,n){return this.s7&&(n=this.s7[n])&&(h=n[h])&&h.addinId===b?h:null}getShortcutInfoArray(b,h){return this.s7&&(h=this.s7[h])&&(b=h[b])&&b.shortcutInfoArray?b.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(b,
h,n){this.saveShortcutInfoArrayBatch(parseInt(b),parseInt(h),n)}setShortcutInfoArray(b,h,n){return this.saveShortcutInfoArray(parseInt(b),parseInt(h),n).then(()=>{this.TXb();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(b,h){if(!this.fka)return Promise.resolve(!0);var n=this.fka[b];if(!n)return Promise.resolve(!0);var x=n[h];n=x.modifiers;x=x.keyCode;const E=this.getShortcutInfoArray(n.toString(),x.toString());if(!E||!E.length)return Promise.resolve(!0);let S=0;for(const ma of E){if(ma.addinId===
b&&ma.action===h)break;++S}if(S>=E.length)return Promise.resolve(!0);E.splice(S,1);return this.saveShortcutInfoArray(n,x,E).then(()=>{this.TXb();return Promise.resolve(!0)})}BMe(b,h,n){this.fka||(this.fka={});for(const x of n){n=x.addinId;const E=x.action;let S=this.fka[n];S||(S={});const ma={};ma.modifiers=b;ma.keyCode=h;S[E]=ma;this.fka[n]=S}}Xmn(b){b in this.fka&&delete this.fka[b]}isActionCustomized(b,h){return this.fka&&(b=this.fka[b])&&b[h]?!!b[h]:!1}getShortcutByCustomizedAction(b,h){return this.fka&&
(b=this.fka[b])?b[h]:null}getShortcutsPreferenceMappingTable(){return this.s7}static instance(){zz.qOe||(w.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),zz.qOe=new zz,zz.Ija=u.AFrameworkApplication.Ze);return zz.qOe}}zz.qOe=null;zz.Ija=null;Object(r.a)(zz,"AddinShortcutsPreferenceSettingHelper",null,[]);class EI{constructor(b,h){this.c8c=null;new Qa.a;this.xJg=!0;this.nad=b;this.SEg=h}LNe(b){this.SEg.addHandler("GoalChangedEvent",b)}XKm(){this.SEg.raiseEvent("GoalChangedEvent")}uof(b,
h){return this.c8c&&this.xJg?b in this.c8c?this.c8c[b]:"Formality"===h&&this.nad.$ff().formality?!1:!0:!0}qGn(b,h){h===this.nad.$ff().formality&&(this.c8c=b,this.XKm())}wgo(b){this.xJg=b}}Object(r.a)(EI,"GoalChangeSource",null,[477,478,479]);var dF=d(948),DG=d(895),$C=d(687);class FI{constructor(b,h,n,x,E,S){this.LGa=h;this.Zwa=n;this.Jf=b;this.AJ=x;this.jg=E;this.hEj=S;this.Zwa.uCb()&&this.initialize()}initialize(){return this.AJ.zn().then(()=>{this.Jf.mb(this,dF.a.getTypeName());this.Jf.addHandler(this,
DG.a.getTypeName())}).catch(b=>{this.jg.sendTraceTag(528274563,2252,10,"EnsureAugLoopRuntimeManager threw exception when registering to GoalsAnnotation.",b)})}mI(b,h){if(h===an.a.getTypeName()||h===$C.a.getTypeName())if(!b||!b.content)this.jg.sendTraceTag(528274564,2252,10,"Handled annotation is invalid");else if(vn.a.getTypeNameFor(b.content)===dF.a.getTypeName()||vn.a.getTypeNameFor(b.content)===DG.a.getTypeName())if(vn.a.getTypeNameFor(b.content)===dF.a.getTypeName()){var n=b.content;this.jg.sendTraceTag(528274565,
2252,50,"Goal annotation received with formality goal: {0}",n.critiqueConfiguration.formalityGoal);this.LGa.qGn(n.critiqueConfiguration.mapping,n.critiqueConfiguration.formalityGoal)}else if(vn.a.getTypeNameFor(b.content)===DG.a.getTypeName())if(b=b.content,b.features){for(n of b.features)if("Goals"===n.featureName){this.hEj.wgo(!!n.supportType);return}this.jg.sendTraceTag(528274567,2252,10,"No goals feature in multilingualFeaturesAnnotation")}else this.jg.sendTraceTag(528274566,2252,10,"MultilingualFeaturesAnnotation.Features is null")}}
Object(r.a)(FI,"GoalsAnnotationHandler",null,[179]);class GI{constructor(b){this.Ma=b}uCb(){return this.Ma.$("EditorGoalsEnabled")}}Object(r.a)(GI,"GoalsGate",null,[274]);var WO=d(1151),XO=d(1152),HI=d(851);class lw{}lw.Dxd=0;lw.Gxd="1.0";lw.settingType="Goals";Object(r.a)(lw,"GoalsConstants",null,[]);var EG=d(1020);class II{constructor(b,h,n,x,E){this.SSb=null;this.zbi=!1;this.kUg=b;this.pad=h;this.jg=n;this.Zwa=x;this.zpe=E;this.Zwa.uCb()?this.Ydn():this.Zwa.uCb()&&this.vVf(lw.Dxd,lw.Gxd)}Ydn(){new Promise(b=>
{this.kUg.UUh(lw.settingType,h=>{this.Zdn(h)?(this.vVf(this.SSb.formality,this.SSb.version),b(this.SSb)):(this.vVf(lw.Dxd,lw.Gxd),b(null))})})}Zdn(b){this.zbi=!0;if(!b||!b.jkb)return this.jg.sendTraceTag(528274529,2252,50,"No persisted goal is registered."),!1;b=b.jkb.properties;var h=b.getValue(ic.a.O7h);h=parseInt(h);b=b.getValue(ic.a.PLd);if(!this.pad.M8f(b))return this.jg.sendTraceTag(528274530,2252,10,"Trying to read unsupported persisted formality goal version. Goal version {0}",b),!1;this.SSb=
b=Object.assign(new EG.a,{formality:h,version:b});this.jg.sendTraceTag(528274531,2252,50,"Persisted goal received with formality goal: {0} and version: {1}",b.formality,b.version);return!0}vVf(b,h){b=Object.assign(new HI.a,{formality:b,version:h});this.zpe.uVi(b)}Tso(b){if(this.pad.M8f(b.version)){var h=WO.a.ZHk(b.version,b.formality.toString());this.kUg.n7g(Object.assign(new XO.a,{jkb:h,settingType:lw.settingType}))?this.SSb=b:this.jg.sendTraceTag(528274561,2252,10,"Write persisted goal failed.")}else this.jg.sendTraceTag(528274560,
2252,10,"Trying to write unsupported formality goal version. Goal version {0}",b.version)}PRh(){this.zbi||this.jg.sendTraceTag(528274562,2252,10,"Trying to get persisted goal that is not read yet.");return this.SSb}}Object(r.a)(II,"GoalsPersistenceHandler",null,[270]);class JI{constructor(b,h,n,x){this.jg=b;this.Ape=h;this.pad=n;this.Zwa=x;this.oad=Object.assign(new EG.a,{formality:lw.Dxd,version:lw.Gxd});this.PFe=this.Zwa.uCb()}$ff(){this.PFe&&(this.PFe=!1,this.Ape.PRh()&&(this.oad=this.Ape.PRh()));
return this.oad}eMn(b){this.PFe=!1;this.pad.M8f(b.version)?(this.Zwa.uCb()&&this.Ape.Tso(b),this.oad=b):(this.jg.sendTraceTag(528274528,2252,10,"Unsupported formality goal version. Goal version {0}",b.version),this.oad=Object.assign(new EG.a,{formality:lw.Dxd,version:lw.Gxd}))}}Object(r.a)(JI,"GoalsProvider",null,[268,269]);class eF{constructor(b,h,n,x){this.Jf=b;this.AJ=h;this.U3=n;this.jg=x}uVi(b){b=Object.assign(new an.a,{parentPath:["Signal",HI.a.getTypeName()],items:[Object.assign(new Po.a,{body:b})]});
this.Hzd(b)}Hzd(b){this.AJ.zn().then(()=>{this.ZLe(b)}).catch(h=>{this.jg.sendTraceTag(528274526,2250,10,"EnsureAugLoopRuntimeManager threw exception.",h)})}ZLe(b){return this.Jf.activateAnnotation(dF.a.getTypeName(),eF.QWb).then(()=>{this.U3.getAugLoopRuntimeManager().submitOperation(Object.assign(new Np.a,{operation:b}))}).catch(h=>{this.jg.sendTraceTag(528274527,2250,10,"Activating GoalsAnnotation threw exception.",h)})}}eF.QWb="GoalSelected";Object(r.a)(eF,"GoalsSignalSender",null,[259]);class vB{constructor(){vB.MKe=
new RegExp(vB.gYj)}M8f(b){return!!b.match(vB.MKe)&&1===b.match(vB.MKe).length}}vB.gYj="[0-9]+[.]?[0-9]*";vB.MKe=null;Object(r.a)(vB,"GoalsValidator",null,[258]);class FG{constructor(){this.W=null}get name(){return"WordEditor.Goals"}init(){this.W.resolve("WordEditor.Goals.GoalsAnnotationHandler")}dispose(){}zc(b){this.W=b;this.W.ha("WordEditor.Goals.GoalsValidator",()=>new vB).as("WordEditor.Goals.IGoalsValidator").singleInstance();this.W.ha("WordEditor.Goals.IGoalsGate",()=>new GI(this.W.resolve("Common.IAppSettingsManager"))).singleInstance();
this.W.ha("WordEditor.Goals.GoalsProvider",()=>new JI(this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.GoalsPersistenceHandler"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("WordEditor.Goals.IGoalsGate"))).as("WordEditor.Goals.IGoalReader").as("WordEditor.Goals.IGoalUpdater").singleInstance();this.W.ha("WordEditor.Goals.GoalChangeSource",()=>new EI(this.W.resolve("WordEditor.Goals.IGoalReader"),new Ge.a)).as("WordEditor.Goals.IGoalChangeSource").as("WordEditor.Goals.IGoalCritiqueConfiguration").as("WordEditor.Goals.IGoalsFeatureSupport").singleInstance();
this.W.ha("WordEditor.Goals.GoalsPersistenceHandler",()=>new II(this.W.resolve("Box4.PersistenceSettingsManager"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("WordEditor.Goals.IGoalSelectedSignalSender"))).as("WordEditor.Goals.IGoalsPersistenceHandler").singleInstance();this.W.ha("WordEditor.Goals.GoalsAnnotationHandler",()=>new FI(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.Goals.IGoalCritiqueConfiguration"),
this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsFeatureSupport"))).as("WordEditor.Goals.GoalsAnnotationHandler").singleInstance();this.W.ha("WordEditor.Goals.GoalsSignalSender",()=>new eF(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.W.resolve("Common.IUlsWrapper"))).as("WordEditor.Goals.IGoalSelectedSignalSender").singleInstance()}static main(){N.a.instance.Pc(new FG)}}
Object(r.a)(FG,"WordEditorGoalsPackage",null,[1,2]);var wB=d(732),hE=d(443);class GG{constructor(){this.annotation=null;this.languages=new kf.a(da.a.Pj())}}Object(r.a)(GG,"CritiqueCountWrapper",null,[]);class mA{constructor(){this.Moa=new Jc.a}TDd(){return this.Moa}E5h(b,h,n,x){if(this.Moa.xb(n)){this.Moa.J(n).annotation.count+=h;n=this.Moa.J(n).languages;for(var E of x)n.add(E)}else E=C.a.create().toString(),b=Object.assign(new hE.a,{id:E,categoryName:b,count:h}),this.Moa.add(n,Object.assign(new GG,
{annotation:b,languages:x}))}}mA.Gi=389;Object(r.a)(mA,"BaseCritiquesByTypeCounter",null,[247]);class KI extends mA{constructor(b){super();this.vsb=new Pa.a;this.mke=new Pa.a;this.wod=b}VPl(b){const h=b.annotation;if(h&&wB.a(vn.a.getTypeNameFor(h.content))){const n=h.content;if(b.opType===an.a.getTypeName()){this.wod.Zon(h.parentPath,n);b=n.M_.state;if(60!==b&&70!==b)return this.vsb.contains(h.id)&&this.vsb.remove(h.id),this.NZl(h.id,n),!0;this.vsb.add(h.id)}else if(b.opType===rg.a.getTypeName())if(this.vsb.contains(h.id))this.vsb.remove(h.id);
else return this.vvh(n.typeId,h.id)}return!1}UPl(b){if((b=b.annotation)&&wB.a(vn.a.getTypeNameFor(b.content))){const h=b.content,n=h.M_.state;if((60===n||70===n)&&!this.vsb.contains(b.id))return this.vsb.add(b.id),this.vvh(h.typeId,b.id)}return!1}NZl(b,h){this.mke.add(b);b=new kf.a(da.a.Pj());h.language&&b.add(h.language);this.E5h(h.categoryName,1,h.typeId,b)}vvh(b,h){if(!this.mke.contains(h))return!1;if(!this.Moa.xb(b))return w.ULS.sendTraceTag(589866503,mA.Gi,15,"Unable to decrement the count for critique category {0}. Reason : {1}",
b,"Category not found in CritiqueCountsByCategory dictionary"),!1;if(0>=this.Moa.J(b).annotation.count)return w.ULS.sendTraceTag(589866504,mA.Gi,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Current count is less than or equal to 0"),!1;this.mke.remove(h);this.Moa.J(b).annotation.count--;return!0}}Object(r.a)(KI,"AlCritiquesByTypeCounter",mA,[507,247]);var LI=d(964);class MI extends Rt.a{constructor(b,h,n,x,E,S,ma,Fa,$a){var sb;super();this.Jf=b;this.wod=h;this.$fe=
n;this.aAg=x;this.LGa=E;this.Zpa=S;this.Ih=ma;this.p8=this.uyg=!1;this.bze=new Jc.a;this.bQm=(Jb,Sb)=>{this.wod.TQl(Sb)&&(this.p8=!0,this.kX())};this.cNm=(Jb,Sb)=>{this.$fe.VPl(Sb)&&this.JIb()};this.hvi=()=>{this.JIb()};this.LDf=(Jb,Sb)=>{this.$fe.UPl(Sb)&&this.JIb()};this.Jhb=()=>{this.JIb()};this.JIb=()=>{let Jb=!1;this.Ih.Pd(()=>{var Sb=this.aml();const oc=new Qa.a;for(let Ic of Sb)Sb=Object.assign(new LI.a,{id:Ic.id,parentPath:If.a.Uxb,content:Ic,annotationType:vn.a.getTypeNameFor(Ic)}),oc.add(Sb),
Jb||(Jb=0<Ic.count);this.Jf.pGn(oc)},"CC:SATH");!this.uyg&&Jb&&(Y.a.sendTelemetryEvent(Object.assign(Object.assign({},new fa.a),{name:"Office.Word.Online.Editor.CritiquesAvailable"})),this.uyg=!0)};this.P9l=(Jb,Sb,oc)=>{const Ic=!this.LGa||this.LGa.uof(Jb,oc);Jb=this.Zpa&&this.Zpa.instance?this.Zpa.instance.tof(Jb,oc,Sb.substr(1,Sb.length-2)):!0;return Ic&&Jb};null===Fa||void 0===Fa?void 0:Fa.LNe(this.Jhb);$a.yna(this,7);null===(sb=this.Zpa)||void 0===sb?void 0:sb.execute(Jb=>{Jb.eOe(this.JIb)})}get index(){return 3}run(){this.p8&&
(this.JIb(),this.p8=!1)}Fxi(){this.JIb()}WEk(b){let h=0;if(({value:h}=this.bze.Dc(b.categoryName,0)).returnValue)if(h!==b.count)this.bze.Z(b.categoryName,b.count);else return!1;else this.bze.add(b.categoryName,b.count);return!0}aml(){const b=new Jc.a;var h=this.wod.TDd();const n=this.$fe.TDd();this.H6f(b,h);this.H6f(b,n);this.aAg&&(h=this.aAg.TDd(),this.H6f(b,h));h=new Qa.a;for(let x of b.values)this.WEk(x)&&h.add(x);return h}H6f(b,h){for(let E of h){h=E.value.annotation;const S=E.key;var n=this.tEn(E.value.languages);
if(!b.xb(h.categoryName)){var x=C.a.create().toString();x=Object.assign(new hE.a,{id:x,categoryName:h.categoryName,count:0,countsByTypeId:{}});b.add(h.categoryName,x)}this.P9l(S,n,h.categoryName)&&(n=b.J(h.categoryName),n.count+=h.count,n.countsByTypeId[S]=(n.countsByTypeId[S]?n.countsByTypeId[S]:0)+h.count)}}tEn(b){const h=[];let n=0;for(let x of b)h[n++]=x;return z.c(h)}}Object(r.a)(MI,"CritiquesCounter",Rt.a,[508,509]);class NI{constructor(b){this.jY=b}TDd(){const b=new Jc.a,h=new kf.a(da.a.Pj()),
n=Object.assign(new hE.a,{id:"a8f8d183-1cc4-4f3c-8483-23ae2e6d092b",categoryName:"Did you say?",count:this.jY.Dkc.count});b.add("33ab9b0e-2399-4300-a09f-ec2dbfcbf96e",Object.assign(new GG,{annotation:n,languages:h}));return b}}Object(r.a)(NI,"DictationCritiquesByTypeCounter",null,[506,247]);class OI extends mA{constructor(b){super();this.f5a=new Jc.a;this.Jf=b}TQl(b){const h=If.a.nGd(b.nodeId);if(!If.a.nf(h)){if(b.Tbb&&b.Tbb.length){let n=null;for(let x of b.Tbb)x.errorDetails.JZa()||(b=this.vNh(x),
If.a.nf(b)||(n||(n=new Jc.a),n.xb(b)||n.add(b,new Qa.a),n.J(b).add(x)));this.wvh(h);n?this.gKn(h,n):this.f5a.remove(h)}else{if(!this.f5a.xb(h))return!1;this.wvh(h);this.f5a.remove(h)}return!0}return!1}Zon(b,h){var n;if(({value:n}=this.f5a.Dc(b,n)).returnValue)for(let E of n)if(b=E.value,0<b.count&&this.wbf(b.J(0))===h.categoryName)for(n=b.count-1;0<=n;n--){var x=b.J(n).end-b.J(n).begin;b.J(n).begin===h.range.start&&x===h.range.length&&(x=this.vNh(b.J(n)),this.Moa.xb(x)&&(x=this.Moa.J(x).annotation,
x.count=Math.max(0,x.count-1)),b.removeAt(n))}}wvh(b){if(this.f5a.xb(b))for(let n of this.f5a.J(b)){var h=n.key;b=n.value;this.Moa.xb(h)&&(h=this.Moa.J(h).annotation,h.count=Math.max(0,h.count-b.count))}}gKn(b,h){const n=new Jc.a,x=new Jc.a;for(let E of h){h=E.key;x.add(h,new kf.a(da.a.Pj()));for(let S of E.value){const ma=S.end-S.begin,Fa=this.wbf(S);this.jsk(b,Fa,S.begin,ma)?w.ULS.sendTraceTag(589866513,mA.Gi,50,"Canvas annotation category {0} for parent path {1} in range (start {2},length {3}) already received from AL. Skipping this",
h,b,S.begin,ma):(n.xb(h)||n.add(h,new Qa.a),n.J(h).add(S),x.J(h).add(this.cml(S)))}}this.f5a.Z(b,n);for(let E of this.f5a.J(b))0<E.value.count&&(b=this.wbf(E.value.J(0)),this.E5h(b,E.value.count,E.key,x.J(E.key)))}vNh(b){let h=null;b&&(b=Object(ja.a)(245,b.errorDetails))&&b.Ss&&(h=b.Ss.TypeId);return h}wbf(b){let h=null;b&&(b=Object(ja.a)(245,b.errorDetails))&&b.Ss&&(h=b.Ss.CategoryTitle);return h}cml(b){let h="";b&&b.errorDetails&&(h=vj.a.lg(b.errorDetails.lcid).name);return h}jsk(b,h,n,x){if((b=
this.Jf.zKh(b))&&0<b.count)for(let E of b)if(b=vn.a.getTypeNameFor(E.content),E&&wB.a(b)&&(b=E.content,b.categoryName===h&&b.range.start===n&&b.range.length===x))return!0;return!1}}Object(r.a)(OI,"WacCritiquesByTypeCounter",mA,[246,247]);class HG{constructor(){this.W=null}get name(){return"WordEditor.CritiqueCounts"}zc(b){this.W=b}init(){var b=this.W.resolve("Common.IAppSettingsManager");if(b.$("AugLoopOperationsAreEnabled")){this.W.ha("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter",()=>new OI(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).singleInstance();
this.W.ha("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter",()=>new KI(this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("Common.IAppSettingsManager"))).singleInstance();var h=b.$("DictationCorrectionsInEditorPaneIsEnabled");h&&this.W.ha("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter",()=>new NI(this.W.resolve("Box4.DictationCorrections.IDictationCorrectionManager"))).singleInstance();this.W.ha("WordEditor.CritiqueCounts.ICritiquesCounter",()=>
new MI(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter"),this.W.Pa("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter"),this.W.Pa("WordEditor.Goals.IGoalCritiqueConfiguration"),this.W.Za("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),oo.a.instance,this.W.Pa("WordEditor.Goals.IGoalChangeSource"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).singleInstance();
b=this.W.resolve("WordEditor.CritiqueCounts.ICritiquesCounter");this.W.resolve("Box4.Proofing.IErrorRangeEditor").S8g(b.bQm);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").x5j(b.cNm);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").F8g(b.LDf);h&&(h=this.W.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),h.n8g(b.hvi),h.o8g(b.hvi))}}dispose(){}static main(){N.a.instance.Pc(new HG)}}Object(r.a)(HG,"WordEditorCritiqueCountsPackage",null,[1,2]);class IG{get name(){return"WordEditor.GraphicsEditor"}zc(){}init(){}dispose(){}static main(){N.a.instance.Pc(new IG)}}
Object(r.a)(IG,"PackageManager",null,[1,2]);var YO=window.PasteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.PasteFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"PasteOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",
attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PasteFloatie.FlyoutAnchor",LabelText:"(Ctrl)",Image16by16:"IMGMAP@we@Paste_16x16x32",Alt:"STR@L_PasteOptionsWithCtrl",DisplayMode:"Medium",TemplateAlias:"Paste"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msPasteOptionsButtons",Title:"STR@L_PasteOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",
attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0x5FA36C32",QueryCommand:"0x57455F86",Image16by16:"IMGMAP@we@PasteSourceFormatting_16x16x32",Alt:"STR@L_PasteWithSourceTheme",LabelText:"STR@L_PasteWithSourceTheme"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0x8E28DB06",QueryCommand:"0x8A0031FF",Image16by16:"IMGMAP@we@PasteTextOnly_16x16x32",Alt:"STR@L_PasteTextOnly",LabelText:"STR@L_PasteTextOnly"}},{name:"ToggleButton",attrs:{Id:"floatie.gbFormatWithDesignerButton",
Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteFormatWithDesignerTooltipUnavailable",LabelText:"STR@L_PasteFormatWithDesigner"}},{name:"ToggleButton",attrs:{Id:"floatie.gbMatchDocumentFormattingButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteMatchDocumentFormattingTooltipUnavailable",LabelText:"STR@L_PasteMatchDocumentFormatting"}},{name:"ToggleButton",attrs:{Id:"floatie.gbUseSmartPasteButton",
Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteUseSmartPasteTooltipUnavailable",LabelText:"STR@L_PasteUseSmartPaste"}}]}]}]}]}]}]}]}]}]}]}]};class PI{constructor(b){this.FAj={};this.Wb=b;this.Fsb=new Aa.a}rKa(b,h){const n=this.Wb.Dac,x=parseInt(b);return b&&x!==pd.ActionManager.R4e?this.Fsb.xb(n)?(b=this.Fsb.J(n).GJc(x,h,2),32===b||1===b):!1:!1}ZBa(b){const h=parseInt(b),n=this.Wb.Dac;return b&&h!==pd.ActionManager.R4e?this.Fsb.xb(n)?
32===this.Fsb.J(n).GJc(h,this.FAj,1):!1:!0}PKi(b,h){this.Fsb.Z(b,h)}e1i(b){b=parseInt(b);const h=this.Wb.Dac;return!!h&&!!this.Fsb.J(h)&&this.Fsb.J(h).X8l(b)}}Object(r.a)(PI,"NonCanvasCuiUser",null,[864,243]);var Az=d(1175),gC=d(62),iE;(function(b){b[b.UnspecifiedGallery=0]="UnspecifiedGallery";b[b.CharacterCodeGallery=1]="CharacterCodeGallery";b[b.FontStyleGallery=2]="FontStyleGallery";b[b.InkThicknessGallery=3]="InkThicknessGallery";b[b.IconGallery=4]="IconGallery";b[b.ListGallery=5]="ListGallery";
b[b.TableStyleGallery=6]="TableStyleGallery";b[b.PageNumberGallery=7]="PageNumberGallery";b[b.ChangeColorsGallery=8]="ChangeColorsGallery"})(iE||(iE={}));Object(r.b)("GalleryType",iE);class Av{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(r.a)(Av,"CommonGalleryButtonProps",null,[]);class fF extends Av{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(r.a)(fF,"AdditionalTableStyleGalleryButtonProps",Av,[]);class QI extends fF{constructor(){super()}}
Object(r.a)(QI,"AdditionalChangeColorsGalleryButtonProps",fF,[]);class RI extends Av{constructor(){super();this.character=null}}Object(r.a)(RI,"AdditionalCharacterCodeGalleryButtonProps",Av,[]);class SI extends Av{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(r.a)(SI,"AdditionalFontStyleGalleryButtonProps",Av,[]);class TI{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}
Object(r.a)(TI,"AdditionalGalleryProperties",null,[]);class UI extends Av{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(r.a)(UI,"AdditionalIconButtonProperties",Av,[]);class VI extends Av{constructor(){super();this.styleDisplayName=null}}Object(r.a)(VI,"AdditionalInkThicknessGalleryButtonProps",Av,[]);class WI extends Av{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(r.a)(WI,
"AdditionalListGallerButtonProps",Av,[]);class XI extends Av{constructor(){super();this.text=null}}Object(r.a)(XI,"AdditionalPageNumberGalleryButtonProps",Av,[]);var aD=d(1100);const ZO=(b,h)=>{var n=appChrome.selectors.getActiveControlStates();if(n=Object(ja.a)(Object,n[b])){if((b=Object(ja.a)(String,n.value))&&b===h)return!1;b=Object(ja.a)(String,n.selectedKey);if(!h&&!b)return!1;if(b){n=Array.isArray(n.options)?n.options:null;let x=null;for(let E=0;E<n.length;E++){const S=Object(ja.a)(Object,n[E]);
if(Object(ja.a)(String,S.key)===b){x=S;break}}if(x&&Object(ja.a)(String,x.text)===h)return!1}}return!0},ZI=(b,h,n,x)=>{if(0<(x&2)){x=[];switch(h){case "ToggleButtonModel":case "InkButtonModel":x.push(gF(b,n[Qf.a.On]));break;case "CheckboxModel":x.push(appChrome.actions.toggleCheckbox(b,n[Qf.a.On]));break;case "ComboBoxModel":if(u.AFrameworkApplication.K&&(u.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",
!1))&&!ZO(b,n[Ol.a.Value]))break;(h=n[Ol.a.Key])?x.push(appChrome.actions.updateComboBoxKey(b,h,n[Ol.a.Value])):x.push(appChrome.actions.updateComboBoxValue(b,n[Ol.a.Value]));break;case "FontPickerModel":x.push(appChrome.actions.updateFontPickerSelectedFont(b,n[aD.a.SelectedFont]));break;case "SplitButtonModel":x.push(gF(b,n[ae.a.On]));break;case "SpinButtonModel":x.push(appChrome.actions.updateSpinButton(b,n[rc.a.Number],Jf.a.sZb(n[rc.a.UnitType]),n[rc.a.Text],n[rc.a.MaxValue],n[rc.a.Alt]));break;
case "ColorPickerModel":x.push(appChrome.actions.updateColorPickerSelectedColor(b,n[Jm.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":x.push(appChrome.actions.updatePageNumberGalleryButtonText(b,n[Vi.a.Text]));break;case "CompoundButtonModel":n[Qf.a.Description]&&x.push(appChrome.actions.updateCompoundButtonDescription(b,n[Qf.a.Description]));Qf.a.On in n&&x.push(gF(b,n[Qf.a.On]));break;case "SliderModel":n.snapToStep?x.push(appChrome.actions.updateSliderSelectedValue(b,n[zc.Value])):
x.push(appChrome.actions.updateSliderValue(b,n[zc.Value],n[zc.MinValue]||0,n[zc.MaxValue],n[zc.Text]));break;case "FlyoutAnchorModel":Ki.a.ImageIsVisible in n&&x.push(appChrome.actions.hideFlyoutAnchorIcon(b,!n[Ki.a.ImageIsVisible]));Qf.a.On in n&&x.push(gF(b,n[Qf.a.On]));break;case "InputBoxModel":x.push(appChrome.actions.updateInputBoxValue(b,n[qg.a.Text]))}h=x;var E=Object(ja.a)(String,n[Bj.a.iconColor]);void 0!==E&&null!==E&&h.push(appChrome.actions.updateIconColor(b,E));YI(b,n,x);h=x;(E=Object(ja.a)(Object,
n[Bj.a.IconSet]))&&h.push(appChrome.actions.setControlIconSet(b,E));h=x;E=Object(ja.a)(String,n[Bj.a.customTooltip]);void 0!==E&&null!==E&&h.push(appChrome.actions.setControlCustomTooltip(b,E));b=x;(n=Array.isArray(n[Bj.a.mPf])?n[Bj.a.mPf]:null)&&b.push.apply(b,n);return x}return null},hC=(b,h)=>appChrome.actions.updateControlEnabledDisabledState(b,h),gF=(b,h)=>appChrome.actions.toggleButton(b,h),YI=(b,h,n)=>{h=Object(ja.a)(String,h[Bj.a.Icon]);void 0!==h&&null!==h&&n.push(appChrome.actions.setControlIcon(b,
h))};class $I{constructor(b,h,n,x){this.Sm=x;this.gqa=b;this.qz=h;this.FTb=n;this.Cpc={}}T3m(b,h,n,x,E=null){const S=b.ExternalGalleryId||b.ExternalId;var ma=b.ExternalId;x.push(S);if(appChrome.selectors.isControlDefined(S))b.GalleryStyle&&Mg.d("setGalleryStyles")&&h.push(appChrome.actions.setGalleryStyles(S,b.GalleryStyle));else{if(4!==b.Type)return;n.push(appChrome.api.createGalleryModel(S,Object.assign(new TI,{columns:b.Width,sections:[appChrome.api.gallerySection([],ma)],styles:b.GalleryStyle,
galleryType:"IconGallery"})))}n=0;if(Mg.d("setGallerySections")&&b.GallerySections&&0<b.GallerySections.length){ma=[];x=[];const Fa=[];for(const $a of b.GallerySections){ma.push(appChrome.api.gallerySection([],$a.SectionId,$a.Title));0===n&&$a.GalleryButtons&&0<$a.GalleryButtons.length&&(n=$a.GalleryButtons[0].Type);const sb=this.NMe(x,$a.GalleryButtons);x.push.apply(x,this.qff(sb,S,$a.SectionId,!1,n,E,!0));Fa.push.apply(Fa,sb)}h.push(appChrome.actions.setGallerySections(S,ma));h.push.apply(h,x);
h.push.apply(h,this.Tcf(S,iE[n],Fa,null,5===b.Type))}else b.GalleryItems&&0<b.GalleryItems.length&&(n=b.GalleryItems[0].Type),h.push.apply(h,this.qff(this.NMe(h,b.GalleryItems),S,ma,!1,n,E))}MCl(b,h){const n=[];let x=null,E=!1;if(!b)return null;const S=this.gqa.iUc(this.qz,b.commandId,h);n.push(hC(b.externalUxCommand,!S));if(b.previewControlIds){const $a=[];for(let sb=0;sb<b.previewControlIds.length;sb++){var ma={},Fa=b.previewControlIds[sb];ma.SourceControlId=Fa;const Jb=this.Sm.getCommandByExternalUxId(Fa);
this.wGd(Jb||b,ma);ma[Vi.a.On]&&(x=ma.SourceControlId,ma[Vi.a.HighlightOn]&&(E=!0));YI(Fa,ma,n);if(ma=Object(ja.a)(Qp.a,ma[Vi.a.GalleryButtonProps]))$a.push(ma),S&&(Fa=this.gqa.iUc(this.qz,ma.Command,h),ma.IsDisabled=!Fa)}0<$a.length&&n.push.apply(n,this.qff(this.NMe(n,$a),b.externalUxCommand,b.externalUxCommand,!0,$a[0].Type));n.push(appChrome.actions.updateGallerySelectedId(b.externalUxCommand,x));E&&(w.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",x),n.push(appChrome.actions.highlightSelectedFontStyle(x)))}return n}NMe(b,
h){const n=[],x=[];for(let S=0;S<h.length;S++){const ma=h[S],Fa=ff.b(ma.ExternalId)?ma.Id:ma.ExternalId;n.push(Fa);switch(ma.Type){case 1:var E=ma;x.push(appChrome.api.createCharacterCodeGalleryButtonModel(Fa,Object.assign(new RI,{disabled:E.IsDisabled,character:E.Character,style:E.Style,title:E.Alt})));break;case 2:E=ma;x.push(appChrome.api.createFontStylesGalleryButtonModel(Fa,Object.assign(new SI,{disabled:E.IsDisabled,styleDisplayName:E.LabelText,style:E.Style,title:E.Alt,previewStyleLabel:E.PreviewStyleLabel})));
break;case 3:E=ma;x.push(appChrome.api.createInkThicknessGalleryButtonModel(Fa,Object.assign(new VI,{disabled:E.IsDisabled,styleDisplayName:E.LabelText,style:E.Style,title:E.Alt})));break;case 4:E=ma;x.push(appChrome.api.createIconGalleryButtonModel(Fa,Object.assign(new UI,{disabled:E.IsDisabled,icon:[E.Icon],fullIconStyle:E.FullIconStyle,previewIconStyle:E.PreviewIconStyle,largePreviewIconStyle:E.LargePreviewIconStyle,label:E.LabelText,title:E.Alt})));break;case 5:E=ma;x.push(appChrome.api.createListGalleryButtonModel(Fa,
Object.assign(new WI,{disabled:E.IsDisabled,infoAtLevel:E.LevelInfo,ariaLabel:E.Alt})));break;case 6:E=ma;x.push(appChrome.api.createTableStyleGalleryButtonModel(Fa,Object.assign(new fF,{disabled:E.IsDisabled,tableCellStyles:E.TableCellStyles,tableStyles:E.TableStyles,title:E.Alt,columns:E.columns})));break;case 8:E=ma;x.push(appChrome.api.createChangeColorsGalleryButtonModel(Fa,Object.assign(new QI,{disabled:E.IsDisabled,tableCellStyles:E.TableCellStyles,tableStyles:E.TableStyles,title:E.Alt})));
break;case 7:E=ma,x.push(appChrome.api.createPageNumberGalleryButtonModel(Fa,Object.assign(new XI,{disabled:E.IsDisabled,text:E.Text,title:E.Alt})))}this.Sm.addCommandToMaps(Object.assign(new gC.a(Fa,ma.Command),{queryCommandId:ma.QueryCommand,menuItemId:ma.MenuItemId}))}b.push(appChrome.actions.addControls(x));return n}qff(b,h,n,x,E,S=null,ma=!1){const Fa=[];x?Fa.push(appChrome.actions.populateGalleryItems(h,b)):(this.Cpc[h]=!1,ma||(x=!0,appChrome.selectors.isControlDefined(h)&&(x=appChrome.selectors.getGalleryState(h),
x=x.disableIndividualButtons?x.disableIndividualButtons:!0),Fa.push.apply(Fa,this.Tcf(h,iE[E],b,null,5===E,x,S))),Fa.push(appChrome.actions.updateGallerySectionItems(h,n,b)));return Fa}rrl(b){return this.Tcf(b.ExternalUxId,b.galleryType,b.items,b.sections,b.isListGallery,b.disableIndividualButtons?b.disableIndividualButtons:!0)}Tcf(b,h,n,x,E,S=!0,ma=null){const Fa=[];if(b in this.Cpc){if(this.Cpc[b])return delete this.Cpc[b],Fa;this.Cpc[b]=!0}let $a=null,sb=-1;if(n)({hJh:sb,returnValue:$a}=this.E6g(h,
n,Fa,S,ma));else if(x)for(const Jb of x)(n=({hJh:sb}=this.E6g(h,Jb.galleryButtons,Fa,S)).returnValue)&&($a=n);Fa.push(appChrome.actions.updateGallerySelectedId(b,$a));S&&Fa.push(hC(b,!1));E&&0<sb&&Fa.push(appChrome.actions.updateListGalleryTextDirection(b,2===sb));return Fa}E6g(b,h,n,x,E=null){let S,ma=null;S=-1;let Fa=!1;for(const sb of h){var $a=this.orl(b);h={};h.SourceControlId=sb;h.Location=E;const Jb=this.Sm.getCommandByExternalUxId(sb);if(!Jb)continue;const Sb=this.wGd(Jb,h);x&&n.push(hC(sb,
1>(Sb&1)));($a=ZI(sb,$a,h,Sb))&&n.push.apply(n,$a);h[Vi.a.On]&&(ma=sb,h[Vi.a.HighlightOn]&&h[Vi.a.HighlightOn]&&(Fa=!0));void 0!==h[Bj.a.labelText]&&null!==h[Bj.a.labelText]&&n.push(appChrome.actions.setControlLabel(Jb.externalUxCommand,h[Bj.a.labelText]));h[Vi.a.IsRtl]&&0>S&&(S=h[Vi.a.IsRtl])}Fa&&(w.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",ma),n.push(appChrome.actions.highlightSelectedFontStyle(ma)));return{returnValue:ma,hJh:S}}orl(b){switch(b){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";
case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}wGd(b,h){h.MenuItemId=b.menuItemId;return this.gqa.Xma(this.qz,this.FTb,
b.commandId,b.queryCommandId,h)}}Object(r.a)($I,"ReactGalleryPoller",null,[]);var $O=d(820),aJ=d(652);class bJ{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(r.a)(bJ,"PopulateFontPickerDataProps",null,[]);var cJ=d(302),Bz=d(1781);class dJ extends wt{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(r.a)(dJ,"OptionalCompoundButtonProperties",
wt,[]);class eJ extends wt{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(r.a)(eJ,"OptionalFlyoutAnchorProperties",wt,[]);class fJ extends Vt{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(r.a)(fJ,"OptionalPersonaButtonProperties",Vt,[]);class hF extends wt{constructor(){super();this.toggled=!1;this.roleInMenu=
null;this.toggleUsingIcon=!1}}Object(r.a)(hF,"OptionalToggleButtonProperties",wt,[]);var aP=d(1631),bP=d(1630),cP=d(496);class gJ{constructor(){this.hnh=this.actions=null;this.zjj=!1}}Object(r.a)(gJ,"PopulateActions",null,[]);class JG{YXh(b,h){switch(h){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(b);case "ToggleButtonModel":return this.zDl(b);case "InkButtonModel":return this.yDl(b);case "GalleryModel":return appChrome.selectors.getGalleryState(b);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(b);
case "SliderModel":return appChrome.selectors.getSliderState(b)}return{}}zDl(b){const h={};h[Qf.a.On]=appChrome.selectors.getButtonToggleState(b);return h}yDl(b){const h={};h[Qf.a.On]=Mg.i("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(b):appChrome.selectors.getButtonToggleState(b);return h}}Object(r.a)(JG,"ReactStatePropsSelector",null,[]);class iF{constructor(b,h,n,x,E){this.gqa=b;this.qz=h;this.FTb=n;this.Sm=x;this.tHe={};this.oQj=new JG;this.psb=E}y4i(b){const h=b.populationProps.populateQueryCommandId;
return b.populationProps.populateOnlyOnce&&h in this.tHe}XDl(b,h,n=null){const x=[],E={};if(!this.y4i(b)){const S=b.populationProps.populateQueryCommandId,ma={};ma.MenuId=b.externalUxCommand;ma.IsShadowMenuOpen=this.isShadowMenuOpen(n);if(0<(this.gqa.Xma(this.qz,this.FTb,S,S,ma,this.Utl(n))&1))if("FontPickerModel"===h)this.tHe[S]=!0,x.push(iF.rCl(b,ma)),E[b.externalUxCommand]="FontPickerModel";else if(ma.MenuItems)switch(this.tHe[S]=!0,h){case "ComboBoxModel":x.push(iF.pCl(b,ma));E[b.externalUxCommand]=
"ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":x.push.apply(x,this.c_h(b.externalUxCommand,h,ma.MenuItems,E,n&&"location"in n?n.location:null))}}return Object.assign(new gJ,{actions:x,hnh:E,zjj:this.isShadowMenuOpen(n)})}c_h(b,h,n,x,E=null){const S=[],ma=[],Fa=[],$a=[];for(let sb=0;sb<n.MenuSectionList.length;sb++){const Jb=Object(ja.a)(Fh.a,n.MenuSectionList[sb]);if(!Jb)continue;let Sb=
null;const oc=[];ff.c(Jb.Title)||(Sb=Jb.Title);for(let Ic=0;Ic<Jb.ControlList.length;Ic++){const gd=Object(ja.a)(Zi.a,Jb.ControlList[Ic]);if(!gd||gd.ExternalId)x&&this.Zjl(gd,x),S.push.apply(S,this.qCl(gd,ma,oc,$a,b,h,E))}n.UpdateDynamically&&Fa.push(appChrome.api.menuSection(oc,Sb,Jb.Lang))}n.UpdateDynamically&&S.push(appChrome.actions.updateMenu(b,Fa,n.Title,n.AriaLabel,n.ShouldAutoOpen,n.AriaRoleDescription,n.MenuTargetDescriptor));0<ma.length&&S.splice(0,0,appChrome.actions.addControls(ma));0<
$a.length&&Mg.d("setStatefulSplitButtonMruBypassControls")&&S.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(b,$a));return S}Zjl(b,h){switch(b.ControlType){case 1:case 3:h[b.ExternalId]=1===b.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:h[b.ExternalId]="ToggleButtonModel";break;case 6:h[b.ExternalId]="CheckboxModel";break;case 7:h[b.ExternalId]="ColorPickerModel";b=Object(ja.a)(Kl.a,b);b.McuLayout&&(h[b.McuExternalId]="ColorPickerModel");break;case 9:h[b.ExternalId]=
"FlyoutAnchorModel"}}qCl(b,h,n,x,E,S,ma=null){const Fa=[];switch(b.ControlType){case 1:case 3:x=Object(ja.a)(Pg.a,b);this.D3m(x,Fa,h,n);x.MenuItemsStatefulData&&Mg.d("setStatefulSplitButtonMenuItemsStatefulData")&&Fa.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(E,x.MenuItemsStatefulData));break;case 2:this.j4m(Object(ja.a)(cP.a,b),Fa,h,n);break;case 6:this.F3m(Object(ja.a)(eB.a,b),Fa,h,n);break;case 4:this.c4m(Object(ja.a)(za,b),Fa,h,n);break;case 7:this.H3m(Object(ja.a)(Kl.a,
b),Fa,h,n);break;case 9:E=Object(ja.a)(Yh.a,b);this.P3m(E,Fa,h,n);"StatefulSplitButtonModel"===S&&x.push(E.ExternalId);break;case 8:this.psb.T3m(Object(ja.a)(ao.a,b),Fa,h,n,ma)}return Fa}D3m(b,h,n,x){x.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.Description&&h.push(appChrome.actions.updateCompoundButtonDescription(b.ExternalId,b.Description)),b.CommandValueId&&h.push(appChrome.actions.setButtonCommandValueId(b.ExternalId,
b.CommandValueId)),this.Aqd()&&((n=this.cLa(b))&&0<n.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Bz.a(n)).iconSet)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(b.Description||Object(pb.a)(Vz,b)?n.push(appChrome.api.createCompoundButtonModel(b.ExternalId,b.LabelText,b.Description,Object.assign(new dJ,{iconSet:(new Bz.a(this.cLa(b))).iconSet,keytip:b.KeyTip,roleInMenu:b.RoleInMenu,ariaDescription:b.AriaDescription,customTooltip:b.LabelText!==
b.Alt?b.Alt:null}))):n.push(appChrome.api.createButtonModel(b.ExternalId,b.LabelText,Object.assign(new Vt,{iconSet:(new Bz.a(this.cLa(b))).iconSet,keytip:b.KeyTip,supportsPreview:!!b.CommandPreviewId&&!!b.CommandRevertId,customTooltip:b.LabelText!==b.Alt?b.Alt:null,commandValueId:b.CommandValueId,shouldTakeFocus:b.ShouldTakeFocus}))),this.Sm.addCommandToMaps(Object.assign(new gC.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand,commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));
b.Lang&&Mg.d("setControlLanguage")&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}F3m(b,h,n,x){x.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.Aqd()&&((n=this.cLa(b))&&0<n.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Bz.a(n)).iconSet)),b.IsChecked&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.IsChecked)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,
b.Alt)))):(n.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new hF,{iconSet:(new Bz.a(this.cLa(b))).iconSet,keytip:b.KeyTip,toggled:b.IsChecked,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:!!b.CheckedImageClass}))),this.Sm.addCommandToMaps(Object.assign(new gC.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}j4m(b,h,n,x){x.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?
(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.Aqd()&&((n=this.cLa(b))&&0<n.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Bz.a(n)).iconSet)),u.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(u.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?
n.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new hF,{iconSet:(new Bz.a(this.cLa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):n.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new hF,{iconSet:(new Bz.a(this.cLa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel}))),
this.Sm.addCommandToMaps(Object.assign(new gC.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}c4m(b,h,n,x){x.push(b.ExternalId);x=this.XBl(b);appChrome.selectors.isControlDefined(b.ExternalId)?b.LabelText&&h.push(appChrome.actions.setPersonaButtonCoauthor(b.ExternalId,x,b.LabelText)):Mg.a("createPersonaButtonModel")&&n.push(appChrome.api.createPersonaButtonModel(b.ExternalId,x,b.LabelText,Object.assign(new fJ,{role:b.RoleInMenu,fullDescriptionLabel:b.AriaDescription,
iconSet:{["default"]:"doughboywhiteglyph_20"}})))}P3m(b,h,n,x){x.push(b.ExternalId);if(appChrome.selectors.isControlDefined(b.ExternalId))b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.Aqd()&&((n=this.cLa(b))&&0<n.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Bz.a(n)).iconSet)),void 0!==b.ImageIsVisible&&null!==b.ImageIsVisible&&h.push(appChrome.actions.hideFlyoutAnchorIcon(b.ExternalId,!b.ImageIsVisible)),void 0!==b.Toggled&&null!==b.Toggled&&
h.push(appChrome.actions.toggleButton(b.ExternalId,b.Toggled)));else{x=!(void 0===b.ImageIsVisible||null===b.ImageIsVisible)&&!b.ImageIsVisible;const E=!(void 0===b.Toggled||null===b.Toggled)&&b.Toggled;n.push(appChrome.api.createFlyoutAnchorModel(b.ExternalId,b.LabelText,Object.assign(new eJ,{iconSet:(new Bz.a(this.cLa(b))).iconSet,keytip:b.KeyTip,hideIcon:x,toggled:E,roleInMenu:b.AriaLabel})));this.Sm.addCommandToMaps(Object.assign(new gC.a(b.ExternalId,b.Command),{queryCommandId:b.QueryCommand,
populationProps:new $O.a(b.PopulateQueryCommand,b.PopulateOnlyOnce)}))}b.Menu&&h.push.apply(h,this.c_h(b.ExternalId,"FlyoutAnchorModel",b.Menu,null));b.Lang&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}H3m(b,h,n,x){b.McuLayout&&x.push(b.McuExternalId);x.push(b.ExternalId);x=0;appChrome.selectors.isControlDefined(b.ExternalId)?b.McuLayout&&(x=this.oQj.YXh(b.ExternalId,"ColorPickerModel").columnCount):(b.McuLayout&&(n.push(appChrome.api.createColorPickerModel(b.McuExternalId,b.Width)),
this.Sm.addCommandToMaps(Object.assign(new gC.a(b.McuExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})),x=b.Width),n.push(appChrome.api.createColorPickerModel(b.ExternalId,b.Width)),this.Sm.addCommandToMaps(Object.assign(new gC.a(b.ExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));n=[];const E=[];for(let S=0;S<b.Colors.length;S++){const ma=b.Colors[S];S<x?n.push(appChrome.api.colorPickerCell(ma.Color,ma.DisplayColor,
ma.Alt)):E.push(appChrome.api.colorPickerCell(ma.Color,ma.DisplayColor,ma.Alt))}0<n.length&&h.push(appChrome.actions.populateColorPickerCells(b.McuExternalId,n));h.push(appChrome.actions.populateColorPickerCells(b.ExternalId,E));b.SelectedColorId&&(0<n.length&&h.push(appChrome.actions.updateColorPickerSelectedColor(b.McuExternalId,b.SelectedColorId)),h.push(appChrome.actions.updateColorPickerSelectedColor(b.ExternalId,b.SelectedColorId)))}cLa(b){return b.Image32by32Class?this.Sm.OOh(b.Image32by32Class):
b.Image16by16Class?this.Sm.OOh(b.Image16by16Class):b.ExternalImageId}XBl(b){return b?Object.assign(new bP.a,{displayName:b.DisplayName,personaCoinColor:b.ImageBackColor,isUnauthenticatedSender:b.IsAnonymous,identifiers:Object.assign(new aP.a,{PersonaType:"User",Smtp:b.PersonaId})}):null}Utl(b){let h=2;b&&"inputMethod"in b&&b.inputMethod&&(h=b.inputMethod);return h}isShadowMenuOpen(b){return!!b&&b.isShadowRendering}Aqd(){return u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",
!1)}static rCl(b,h){return appChrome.actions.populateFontPickerDataAsync(new Promise((n,x)=>{Oa.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(E=>{E.isFeatureEnabled(cJ.a.$Db,!1).then(S=>{let ma=h.fonts;S||E.isFreemiumUpsellEnabled()||(ma=th.a.x9f(ma,Fa=>Fa.fontType!==cJ.a.ZKf));S=Object.assign(new bJ,{commandId:b.externalUxCommand,fonts:ma,isSubscriber:S,mruList:h.mruList,initialPinnedFontKeys:h.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});
n(S)}).catch(x)})}))}static pCl(b,h){const n=[];for(let x=0;x<h.MenuItems.MenuSectionList.length;x++){const E=h.MenuItems.MenuSectionList[x];E.Title&&n.push(appChrome.api.comboBoxHeader("Header-"+x.toString(),E.Title));for(let S=0;S<E.ControlList.length;S++){const ma=Object(ja.a)(aJ.a,E.ControlList[S]);ma&&n.push(appChrome.api.comboBoxItem(ma.MenuItemId,ma.LabelText,ma.Styles,ma.CommandValueId,ma.AriaLabel,ma.Data,ma.Disabled))}x<h.MenuItems.MenuSectionList.length-1&&n.push(appChrome.api.comboBoxDivider("Divider-"+
x.toString()))}return appChrome.actions.populateComboBoxOptions(b.externalUxCommand,n)}}Object(r.a)(iF,"ReactPopulateQueryCommandPoller",null,[]);class hJ{constructor(b,h,n,x,E){this.Sm=n;this.gqa=b;this.qz=h;this.FTb=x;this.psb=E}WDl(b,h,n){const x=[];if(this.m9l(h))b=this.SHl(b,h,n),void 0!==b&&null!==b&&x.push.apply(x,b);else if(b){var E=this.wGd(b,n);Bj.a.visible in n&&x.push(appChrome.actions.updateControlHiddenState(b.externalUxCommand,!n[Bj.a.visible]));x.push(hC(b.externalUxCommand,1>(E&1)));
void 0!==n[Bj.a.labelText]&&null!==n[Bj.a.labelText]&&x.push(appChrome.actions.setControlLabel(b.externalUxCommand,n[Bj.a.labelText]));void 0!==h&&null!==h&&(E=ZI(b.externalUxCommand,h,n,E),void 0!==E&&null!==E&&x.push.apply(x,E),"PeopleWell"===h&&this.x2j(b.externalUxCommand,n,x))}return x}Rol(b,h,n){const x=[];switch(h){case "FlyoutAnchorModel":var E=appChrome.selectors.getFlyoutAnchorMenuItems(b);break;case "SplitButtonModel":var S=appChrome.selectors.getSplitButtonState(b);if(S=this.Sm.getCommandByExternalUxId(S.command))n=
this.gqa.iUc(this.qz,S.commandId,n),x.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(b,!n)),x.push(hC(b,!1));return x;default:return null}h=!1;for(S in E)if(E=this.Sm.getCommandByExternalUxId(S),ff.c(E))h=!0;else if(n.SourceControlId=E.externalUxCommand,this.gqa.iUc(this.qz,E.commandId,n))return x.push(hC(b,!1)),x;x.push(hC(b,!h));return x}SHl(b,h,n){switch(h){case "PreviewGalleryModel":return this.psb.MCl(b,n);case "GalleryModel":return this.psb.rrl(n)}return null}m9l(b){return"GalleryModel"===
b||"PreviewGalleryModel"===b}wGd(b,h){h.MenuItemId=b.menuItemId;return this.gqa.Xma(this.qz,this.FTb,b.commandId,b.queryCommandId,h)}x2j(b,h,n){const x=h[Ki.a.LabelTextUserGeneratedPlaceholderReplacements];h=h[Ki.a.LabelText];x&&0<x.length&&(h=String.format.apply(null,[h].concat(x)));n.push(this.ZLl(b,h))}ZLl(b,h){return appChrome.actions.updatePeopleWell(this.Mjl(b),h)}Mjl(b){const h=[];var n={};b=this.Sm.getCommandByExternalUxId(b).populationProps.populateQueryCommandId;this.gqa.Xma(this.qz,this.FTb,
"1285265560",b,n);n=n.MenuItems;if(!n)return h;n=n.MenuSectionList[0];for(b=0;b<n.ControlList.length;b++){const x=n.ControlList[b],E={};E.name=x.Alt;E.id=x.MenuItemId;E.description=x.Description;E.color=x.ImageBackColor;E.joinTime=x.JoinTimeInMS;E.imageUrl=x.ImageUrl;E.activeStatus=x.ActiveStatus;E.isAnonymous=x.IsAnonymous;E.canJump=x.CanJump;E.upn=x.Upn;h.push(E)}return h}}Object(r.a)(hJ,"ReactQueryCommandPoller",null,[]);var dP=d(1087);class iJ{constructor(b,h,n){this.Sm=b;this.qz=h;b=new dP.a;
this.HUj=new JG;this.psb=new $I(b,this.qz,n,this.Sm);this.HVg=new iF(b,this.qz,n,this.Sm,this.psb);this.xVg=new hJ(b,this.qz,this.Sm,n,this.psb)}NAa(){const b=[];if(!Mg.c())return b;b.push.apply(b,this.XLl());var h=this.Snl();if(0<h.length)b.push.apply(b,h);else if(h=appChrome.selectors.getActiveControlIds(),Object.keys(h).length){const n=this.Tnl();for(const x of n)b.push(appChrome.actions.updateControlEnabledDisabledState(x,!0)),delete h[x];b.push.apply(b,this.LHd(h))}return b}jUc(b,h){Mg.c()&&
(b=this.LHd(b,h),appChrome.api.dispatch(b))}tKf(b,h,n=null){if(!ff.c(b)&&b.populationProps&&!this.HVg.y4i(b)){b=this.HVg.XDl(b,h,n);if(!b.zjj){let x;(x=b.actions).push.apply(x,this.LHd(b.hnh,Mg.g(n)))}if(0<b.actions.length)return appChrome.api.dispatch(b.actions),!0}return!1}LHd(b,h=0){const n=[],x={};if(Mg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var E of appChrome.selectors.getActiveGroupIds())for(var S of appChrome.selectors.getVisibleControlsInGroup(E))x[S]=
!0;for(let ma in b)E=ma,S=b[ma],0===h&&x[E]&&(h=2),n.push.apply(n,this.WLl(E,S,h));return n}WLl(b,h,n=0){const x=[],E=this.Sm.getCommandByExternalUxId(b);let S={};appChrome.selectors.isControlDefined(b)&&(S=this.HUj.YXh(b,h));S[Az.a.nLb]=n;ff.c(E)?(S.ExternalUxId=b,(b=this.xVg.Rol(b,h,S))&&0<b.length&&x.push.apply(x,b)):(S.MenuItemId=E.menuItemId,S.SourceControlId=b);x.push.apply(x,this.xVg.WDl(E,h,S));return x}XLl(){const b=[],h=!!u.AFrameworkApplication.K&&(u.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||
u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1)),n=appChrome.selectors.getContextualTabIds();let x=[];h&&(x=appChrome.selectors.getActiveContextualTabIds());for(let S=0;S<n.length;S++){var E=this.Sm.Jgf(n[S]);if(E){E=this.qz.ZBa(E);let ma=!0;h&&(ma=0<=Array.indexOf(x,n[S]));h&&ma===E||b.push(appChrome.actions.activateDeactivateContextualTab(n[S],E))}}return b}Snl(){var b=appChrome.selectors.getSelectedTabId();const h=[],n=this.Sm.Jgf(b);
n&&(this.qz.ZBa(n)||h.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(b,!0)));return h}Tnl(){var b=appChrome.selectors.getActiveGroupIds();const h=[];for(const n of b)if(b=this.Sm.Jrl(n))for(const x of b)this.qz.ZBa(x.commandId)||((b=x.externalUxCommandIds)||(b=appChrome.selectors.getVisibleControlsInGroup(x.externalUxGroupId)),h.push.apply(h,b));return h}}Object(r.a)(iJ,"ReactRibbonRootPoller",null,[851]);class jF{constructor(b,h,n=null){this.qz=this.mxa=this.K8a=null;this.kTb=
h;b.QIa(this);this.kE=n}get dma(){this.mxa||(this.mxa=new Date,this.mxa.setTime(0));return this.mxa}set dma(b){this.mxa=b}get f7(){return 2}get kE(){return this.qz}set kE(b){this.qz=b}get mbc(){this.K8a||(this.K8a=new iJ(this.kTb,this.kE,this.f7));return this.K8a}wab(){const b=document.activeElement;Ke.a.isEditable(b)&&b.blur()}executeCommand(b,h,n,x,E,S,ma,Fa=2){ff.c(this.kE)||(E=new La.a,E.CommandLocation=Fa,E.InvocationMethod=x,E.CommandTabName=n,this.vtd(),h[Az.a.nLb]=Fa,this.kE.rKa(b,h,E,S,ma),
this.qum(b,h))}NAa(){return ff.c(this.kE)?[]:this.mbc.NAa()}xl(){const b=this.NAa();0<b.length&&(this.dma=new Date,appChrome.api.dispatch(b))}M2c(){Mg.c()&&this.mbc.jUc({PeopleWell:"PeopleWell"},18)}B2c(){}vtd(){const b=Oa.a.instance.Pa("Common.ISystemInitiatedFeedback");b?b.logActivity("SLRCommandUsed","FGSLRUsageEnabled"):w.ULS.sendTraceTag(561394446,340,50,"ISystemInitiatedFeedback was null")}qum(b,h){try{const n=Oa.a.instance.Pa("Common.ISystemInitiatedFeedback");if(n&&h){const x=h.SourceControlId||
h.launcherId||h.LegacyId||h.NewContextId;let E=(x?"_"+x:"")+(h.SqmControlId?"_"+h.SqmControlId:"");E=E.length?E:"_"+b;n.Ovf("Ribbon"+E)}}catch(n){w.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+(n?n.toString():""))}}}Object(r.a)(jF,"ReactRibbonRoot",null,[340,852]);var kF=d(1569);class jJ{constructor(b){this.$Ke=this.$pe=!1;this.v5a=null;this.zvg=!1;this.yO=null;this.Fpa=!1;this.HCe=b;sf.a.instance.mb(kb.a.Vw,this.WGc(),Object(v.a)(this,this.WOm,"onContextualUIMouseDown"));(b=Oa.a.instance.Za("Common.IActionContextProvider"))&&
b.execute(h=>{this.yO=h});u.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&u.AFrameworkApplication.ua.Sb.sI?cj.a.get_instance().sl(16,()=>{this.zta?this.initializeContextualUI(this.WGc()):cj.a.get_instance().sl(7,()=>{this.initializeContextualUI(this.WGc())})}):cj.a.get_instance().sl(7,()=>{this.initializeContextualUI(this.WGc())})}get EZ(){return this.Fpa}get zta(){return u.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&
u.AFrameworkApplication.ua.Sb.sI?cj.a.get_instance().isCompleted(16)&&cj.a.get_instance().isCompleted(7):cj.a.get_instance().isCompleted(7)}upk(){if(this.zvg)return!0;try{return Promise.resolve(null),this.zvg=!0}catch(b){return!1}}W5f(b){if(!this.zta||this.$Ke)return this.Dwf("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.upk())return this.Dwf("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(u.AFrameworkApplication.gF)return this.Dwf("Unable to launch contextual ui because the feature to show contextual ui is disabled"),
!0;this.$Ke=!0;let h=Ra.a.Bg;switch(b){case 1:h=Ra.a.showContextMenu;break;case 0:h=Ra.a.showFloatie;break;case 2:h=Ra.a.aec}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.$Ke=!1;Pe.c(h)},0)});return!1}u_h(b){return Cj.UISurfaces.BXa().then(h=>{if(appChrome.api.isSmallDevice()&&h.getBlockedSmallScreenFloatieGroupList){h=h.getBlockedSmallScreenFloatieGroupList();const n=[];for(const x of b)Array.contains(h,x)||n.push(x);return n}return b})}showFloatie(b,h,n){this.W5f(0)||this.u_h(h).then(x=>
{if(0>=x.length)return null;this.qYf(x).then(()=>{const E={};E.target=b;Cj.UISurfaces.BXa().then(S=>{appChrome.api.dispatch(S.showFloatie(E,n,void 0,this.Zdf()));this.Fpa=!0;return null})});return null})}showContextMenu(b,h,n=null,x=null){this.W5f(1)||this.G2i(b,h,n,x)}G2i(b,h,n=null,x=null){this.qYf(null).then(()=>{const E={};E.target=b;x&&(E.directionalHint=x);Cj.UISurfaces.BXa().then(S=>{appChrome.api.dispatch(S.showContextMenu(E,h,n,void 0,this.Zdf()));return null})})}$dc(b,h,n,x=null){this.W5f(2)||
this.u_h(h).then(E=>{0>=E.length?this.G2i(b,n,x):this.qYf(E).then(()=>{const S={};S.target=b;const ma={};ma.target=b;Cj.UISurfaces.BXa().then(Fa=>{appChrome.api.dispatch(Fa.showContextualUI(S,ma,n,void 0,x,this.Zdf()));this.Fpa=!0;return null})});return null})}Dwf(b){w.ULS.sendTraceTag(561394519,340,15,b)}W2e(){this.zta&&Cj.UISurfaces.isLoaded()&&Cj.UISurfaces.BXa().then(b=>{appChrome.api.dispatch(b.hideContextMenu());return null})}Vu(){this.zta&&Cj.UISurfaces.isLoaded()&&Cj.UISurfaces.BXa().then(b=>
{this.Fpa=!1;appChrome.api.dispatch(b.hideFloatie());return null})}wDc(){this.zta&&Cj.UISurfaces.isLoaded()&&Cj.UISurfaces.BXa().then(b=>{appChrome.api.dispatch(b.hideContextualUI());this.Fpa=!1;return null})}initializeContextualUI(b){return Cj.UISurfaces.BXa().then(h=>{this.$pe||(h.initializeContextualUI(b),this.$pe=!0);return null})}qYf(b){if(!this.$pe)return this.initializeContextualUI(this.WGc()).then(()=>{this.setActiveFloatieGroups(b);return null});this.setActiveFloatieGroups(b);return Promise.resolve(null)}setActiveFloatieGroups(b){if(b&&
b.length){var h=[];h.push(appChrome.actions.setActiveFloatieGroups(b));appChrome.api.dispatch(h);var n=[];Cj.UISurfaces.BXa().then(x=>{n.push.apply(n,this.HCe.mbc.LHd(x.selectors.getFloatieOnlyControlsMap(),9));0<n.length&&appChrome.api.dispatch(n);return null})}}WGc(){if(this.v5a)return this.v5a;this.v5a=kF.a("div");this.v5a.id="ReactContextualUIDiv";this.v5a.style.position="absolute";this.v5a.style.zIndex="1001";document.body.insertBefore(this.v5a,document.body.firstChild);return this.v5a}WOm(b){b.Ib&&
b.Ib.target&&"input"===b.Ib.target.tagName.toLowerCase()&&de.FocusManager.instance().YB("ribbon");return!1}Zdf(){return this.yO?this.yO.contentType:"Unknown"}}Object(r.a)(jJ,"ReactContextualUILauncher",null,[853]);class kJ extends fA.a{constructor(){super()}}Object(r.a)(kJ,"FloatieBuildOptions",fA.a,[]);class lJ extends Ey.a{constructor(){super()}}Object(r.a)(lJ,"FloatieBuildContext",Ey.a,[]);var eP=d(649);class mJ extends ol.Builder{constructor(b,h,n){super(b,h,n,null);if(ff.c(h))throw Error.create("Floatie placeholder DOM element is null or undefined.");
}get floatie(){return this.root}iOn(b){this.root=b}Qjk(){const b=new lJ,h=new ZA.a;h.NVc=1;h.handler=Object(v.a)(this,this.zUm,"onReturnFloatieData");h.data=b;this.Lra.Y3d(h)}zUm(b){this.Rjk(b.fVc,b.tBc);this.floatie.oHh=this;this.floatie.jm();this.floatie.Kc.style.display="none";this.placeholder.appendChild(this.floatie.Kc);this.kra.continueWith(()=>{this.kra.result.DFb(this.floatie)},11);Xh.a.instance.mb(kb.a.pointerDown,this.floatie.Kc,Object(v.a)(this.floatie,this.floatie.NB,"onPointerDown"))}Rjk(b,
h){b=Fi.a.mea(b,Fi.a.snj);if(ff.c(b))throw Error.create("No floatie element was present in the data");b=new Fi.a(b);this.iOn(new Dr(b.attributes[Fi.a.id],b.attributes));b=Fi.a.mea(b.node,Fi.a.Fde);this.VSe(b,h)}VSe(b,h){b=Fi.a.Fv(b);for(let n=0;n<b.length;n++){if(this.iMa(b[n]))continue;const x=this.aTe(b[n],h);this.floatie.Sf(x)}}aTe(b,h){var n=new Fi.a(b);b=new eP.Group(this.floatie,n.attributes[Fi.a.id],n.attributes[Fi.a.AQa],n.attributes[Fi.a.Ihc],n.attributes[Fi.a.uQa],!1,n.name===Fi.a.Lqj,!1,
n.attributes);n=Fi.a.Fv(n.node);for(let x=0;x<n.length;x++)b.Sf(this.msd(n[x],h));return b}msd(b,h){b=new Fi.a(b);var n=b.attributes[Fi.a.id];b=Fi.a.Fv(b.node);var x=2;2===b.length&&(x=3);n=new jm.a(this.floatie,n,x,2,1);for(x=0;x<b.length;x++){const S=new Fi.a(b[x]);var E=Fi.a.mea(S.node,Fi.a.xmb);E=Fi.a.Fv(E);this.fTe(n.QGd(x+1),E,S.attributes[Fi.a.id],h)}return n}fTe(b,h,n,x){for(n=0;n<h.length;n++){if(this.iMa(h[n]))continue;const E=new Fi.a(h[n]),S=this.kda(h[n],x);S&&b.Sf(S.vP(E.attributes[Fi.a.Jhc]))}}}
Object(r.a)(mJ,"FloatieBuilder",ol.Builder,[]);class jE{constructor(b,h){this.Nu=null;this.vyk=b;this.wke=h}get floatie(){return this.Nu}yab(b,h,n){h=new Vn.CuiHelper(Gl.a.U$a,Box4Intl.Box4Strings,null,null,h);const x=new kJ;x.WF=n||{};x.WF.floatieshadingColor=!1;const E=new mJ(x,document.body,this.vyk.JRi);E.Lra=new jA.a(b,h);E.Qjk();this.wke.execute(S=>{E.floatie.kE=S});E.floatie.mkn(Object(v.a)(this,this.$Vd,"onFloatieDismissed"));E.floatie.Ajn(Object(v.a)(this,this.ssl,"getHiddenFloatieGroups"));
this.Nu=E.floatie;return this.floatie}ssl(){return[]}}Object(r.a)(jE,"AFloatieInitializer",null,[]);class nJ extends jE{constructor(b,h,n,x){super(h,n);this.mKf=()=>{this.floatie.xl()};this.Dh=b;this.wH=x}yab(b,h,n){if(b=super.yab(b,h,n))b.Bac=!0,b.e_d=!0,b.preventDismissOnScroll=!0;this.Dh.SUa(this.mKf);return b}vLc(b,h,n=null){this.wH.Xdh(()=>this.yab(b,h,n))}$Vd(){this.floatie.Bac=!0}}Object(r.a)(nJ,"PasteFloatieInitializer",jE,[]);var KG=d(784);class Vx{ova(b,h){this.Tpk&&this.sUn(b,h,Vx.pyf,
Vx.kb)}sUn(b,h,n,x){switch(n){case 1:case 6:case 2:case 3:case 4:Vx.v4e.show(x,b,h)}}Woi(){switch(Vx.pyf){case 5:case 1:return!0;default:return!1}}FNk(){return Vx.pyf}get Tpk(){return 1!==ob.App.xa.state}static get v4e(){return null!=Vx.Xgg?Vx.Xgg:Vx.Xgg=Oa.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static Rwl(b){if(!b)return 0;if(2===ob.App.xa.mode){const h=b.Qa.node,n=md.GraphIterator.$a(h);n.qo();return Yf.e(n.currentNode)?2:u.AFrameworkApplication.s3c||!Cw.isEmbeddedFileNode(h)||Cw.isInvalid(h)?
Ee.a.scm(b.Qa)||Ee.a.opf(b.Qa)?6:1:3}return 4}static get kb(){return kh.a.instance.ib.kb}static get pyf(){return Vx.Rwl(Vx.kb)}}Object(r.a)(Vx,"SelectionContextMenuProvider",null,[1158]);var lF=d(1764);class mF{constructor(b,h){this.e_d=this.Bac=!1;this.aKc=!0;this.Wv=b;this.Sm=h}get isVisible(){return this.Wv.EZ}get controls(){return null}Vu(){this.Wv.Vu();return!0}B5e(){}x2a(b,h,n){this.Wv.showFloatie(Object.assign(new lF.a,{x:b.x,y:b.y}),this.z$e(n),n)}Izb(){return new Sys.UI.Bounds(0,0,0,0)}M1(){return this.Vu()}z$e(){return[]}}
Object(r.a)(mF,"ReactFloatie",null,[282,283]);class oJ{constructor(b){this.k8c=null;this.Wv=b}dispose(){}M1(){this.Wv.wDc();return!0}showContextMenu(b,h){this.RJb(b,h.clientPoint,h.eg)}RJb(b,h,n){this.u2a(b,new Sys.UI.Bounds(h.x,h.y,0,0),n);w.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",b)}u2a(b,h,n,x=null){this.k8c?this.Wv.$dc(Object.assign(new lF.a,{x:h.x,y:h.y}),this.k8c.z$e(n),n,b):this.Wv.showContextMenu(Object.assign(new lF.a,{x:h.x,y:h.y}),n,b,x);this.k8c=null}aec(b,
h,n,x){this.k8c=Object(ja.a)(mF,n);x.ova(b,h);return!0}wZb(){}}Object(r.a)(oJ,"ReactContextMenuController",null,[584,10]);var fP=d(355);class pJ{constructor(){this.mga=this.text=this.Ala=null}}Object(r.a)(pJ,"BusinessBarButtonData",null,[]);class LG{constructor(){this.text=this.Ala=null}}Object(r.a)(LG,"BusinessBarLinkData",null,[]);var qJ=d(179);class MG{constructor(b,h,n,x){this.FCg=this.jSb=this.bAg=this.V5a=this.$xg=null;this.Zr=b;this.Coa=h;this.ga=n;this.Ma=x}SJf(){this.xYb();this.ttd();this.Rzc();
this.stk()}ttd(){}xYb(){const b=ob.App.xa.jb.Zc;b&&(this.$xg=this.L3a(this.$xg,1,2===ob.App.xa.mode&&b.$Md,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}get Ekm(){return ob.App.Pdj?V.a.zk:!1}vlm(){return u.AFrameworkApplication.ua&&1===u.AFrameworkApplication.ua.mode}stk(){this.Ekm&&!this.jSb&&(this.jSb=this.Coa.create("",CommonUIStrings.l_UnsupportedBrowserDeadline,null),this.jSb.id=15,this.jSb.closeable=!0,this.jSb.addButton(Box4Intl.Box4Strings.L_DownloadNow,Qe.AppFrame.Ddo,""),Pe.a("NewBrowserSuggestionShown"),
this.Zr.eB(this.jSb,!1))}Rzc(){let b=null;const h=ob.App.xa.jb.activeSection;if(h){const n=h.pTc;qJ.a.BMd(n)?22===n?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===n||20===n?b=V.a.ki?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===n?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===n?b=V.a.ki?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===n&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):
qJ.a.U2h(h.EUa)||ob.App.fn||this.vlm()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.FCg=this.L3a(this.FCg,5,!!b,b)}U2i(b,h,n,x){b=this.Coa.create(null,b,null);b.closeable=!0;b.id=23;b.image=3;b.Ipd(h,()=>{rd.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+n)});x&&(b.Kja=x);this.Zr.eB(b,!0)}eVn(b,h,n){this.U2i(b,h,n,null)}pVn(b){b=this.Coa.create(null,b,null);b.closeable=!0;b.id=20;this.Zr.eB(b)}CUn(){var b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,h=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;
this.V5a||(this.V5a=this.Coa.create(b,h,null),this.V5a.closeable=!0,this.V5a.id=27,this.Zr.eB(this.V5a))}ZVl(){this.V5a&&(this.V5a=this.L3a(this.V5a,27,!1,""))}RZf(b){this.bAg=this.L3a(this.bAg,30,!0,b)}L3a(b,h,n,x,E=!1,S="",ma=null,Fa=null,$a=null){n?b?b.message=x:(b=this.Coa.create(S,x,null),b.id=h,b.closeable=E,ma&&b.addButton(ma.text,ma.Ala,ma.mga),Fa&&b.Ipd(Fa.text,Fa.Ala),$a&&(b.Kja=$a),this.Zr.eB(b,!1)):b&&(this.Zr.removeEntry(b),b=null);return b}tMe(b){this.Zr.eB(b,void 0)}}Object(r.a)(MG,
"BusinessBarController",null,[590]);class iC extends MG{constructor(b,h,n,x){super(b,h,n,x);this.kxa=null}FRh(b,h,n=null,x=null,E=null,S=2){this.kxa||(this.kxa=this.Coa.create(h,n||"",null),this.kxa.id=6,this.kxa.image=S,this.kxa.mOd=!1,b&&(this.kxa.errorCode=b),this.kxa.closeable=!1,h=u.AFrameworkApplication.mE&&this.Ma.$("ShowFeedbackButtonOnKickoutBusinessBar"),x?(this.kxa.addButton(x,E,""),h&&this.kxa.E7g(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.d0h(b)})):h&&this.kxa.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,
()=>{this.d0h(b)},""),this.Zr.eB(this.kxa,void 0,null,null,null))}d0h(b){w.ULS.sendTraceTag(36471966,338,15,"Feedback given after kickout: {0}",{["ErrorCode"]:b});this.ga.Xb(Ra.a.giveFeedback,2,{["ErrorCode"]:b})}static get Ue(){return Nd.PageReader.instance}}Object(r.a)(iC,"BusinessBarController",MG,[589,590]);class NG{static get pti(){const b=B.a.Ij(vj.a.lg(u.AFrameworkApplication.lcid).name);return String.format("https://r.office.microsoft.com/r/rlidWebOpenDocumentDetails?clid={0}",b)}}Object(r.a)(NG,
"OdtUtils",null,[]);class rJ extends iC{constructor(b,h,n,x){super(b,h,n,x);this.unb=this.Bnc=this.wOg=this.JIa=this.COg=this.m_g=null;this.NJj="https://go.microsoft.com/fwlink/?linkid=2134357"}SJf(){super.SJf();this.Wsk()}ttd(){const b=ob.App.xa.jb.Zc;if(b){var h=ob.App.HZ;if(ob.App.vs||ob.App.fn||h&&u.AFrameworkApplication.Eu)this.m_g=this.L3a(this.m_g,4,iC.Ue.wOc(b),Box4Intl.Box4Strings.l_BusinessBarSigned,!0),this.COg=this.L3a(this.COg,3,iC.Ue.n6b(b),Box4Intl.Box4Strings.l_BusinessBarMarkedAsFinal,
!0),this.wOg=this.L3a(this.wOg,8,iC.Ue.TBk(b),Box4Intl.Box4Strings.l_BusinessBarContainsMalformedHyperlinkUris,!0),iC.Ue.fPc(b)?this.JIa||(this.JIa=this.Coa.create(Box4Intl.Box4Strings.l_BusinessBarCompatTitle,Box4Intl.Box4Strings.l_BusinessBarCompatMessage,null),this.JIa.id=14,this.JIa.closeable=!0,this.JIa.image=3,this.JIa.addButton(Box4Intl.Box4Strings.L_LearnMore,Qe.AppFrame.apm,""),this.Zr.eB(this.JIa,!1)):this.JIa&&(this.Zr.removeEntry(this.JIa),this.JIa=null)}}Wsk(){if(Kb.App.LNc){const b=
NG.pti,h=this.Coa.create(Box4Intl.Box4Strings.l_BusinessBarODTDocumentTitle,Box4Intl.Box4Strings.l_BusinessBarODTDocument,null);h.id=9;h.closeable=!0;h.I1j(b);this.Zr.eB(h,!0)}}fVn(b,h){if(ob.App.xa.jb.Zc){const n=new pJ;n.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptSendButton;n.Ala=()=>{b()};const x=new LG;x.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptPrivacyLinkText;x.Ala=()=>{rd.a.openWindow(4,u.AFrameworkApplication.Fib)};this.Bnc=this.L3a(this.Bnc,25,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptMessage,
!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptTitle,n,x,()=>{h()})}}gWl(){this.Bnc&&(this.Bnc=this.L3a(this.Bnc,25,!1,""))}lUn(){if(ob.App.xa.jb.Zc){const b=new LG;b.text=WordEditorIntl.WordEditorStrings.L_CitationStyleLearnMore;b.Ala=()=>{rd.a.openWindow(4,this.NJj)};this.unb||(this.unb=this.Coa.create(WordEditorIntl.WordEditorStrings.L_CitationStylePromptTitle,WordEditorIntl.WordEditorStrings.L_CitationStylePromptText,null),this.unb.id=32,this.unb.closeable=!0,this.unb.image=3,this.unb.Ipd(b.text,
b.Ala),this.Zr.eB(this.unb,!1))}}Qea(b){return this.Zr.Qea(b)}eB(b,h){this.Zr.eB(b,h)}}Object(r.a)(rJ,"BusinessBarController",iC,[588,589,590]);class sJ{constructor(){this.menuTargetType=null}}Object(r.a)(sJ,"MenuTargetDescriptor",null,[]);class et{static get E1(){return null!=et.ngg?et.ngg:et.ngg=Oa.a.instance.resolve("Box4.IContextMenuController")}static FGk(b){et.E1.wZb(b,"mnuNavPaneWordEditor","","","Menu16")}static showContextMenu(b,h){et.E1.showContextMenu(b,h)}static RJb(b,h,n){et.E1.RJb(b,
h,n)}static u2a(b,h,n,x=null){et.E1.u2a(b,h,n,x)}static qJh(b,h,n,x){return xf.a(b,h.toString(),x,n)}}Object(r.a)(et,"BaseContextMenu",null,[]);class Kj extends et{constructor(b,h,n,x=!1,E,S=null,ma){super();this.t9m=h;this.Rm=n;this.$j=S;this.Dte=x;this.Vb(b);this.R4a=ma;Kj.QTa[1]=Db.a.l8d;Kj.QTa[2]=Db.a.bId;Kj.QTa[3]=Db.a.T8d}get SYk(){return Dh.a.sxd}get RYk(){return Dh.a.Svd}get TYk(){return Dh.a.eZd}get t4e(){return Dh.a.fCi}Vb(b){b.gb(Db.a.wKf,cc.a.application,Object(v.a)(this,this.GZd,"populateContextMenu"),
96);b.gb(Db.a.FDi,cc.a.application,Object(v.a)(this,this.GZd,"populateContextMenu"),96)}show(b,h,n){let x=null,E=new Sys.UI.Bounds(0,0,0,0);const S=this.mDl(b);if(S&&(b=b.Qa.node)&&(b=b.De(cb.InteractiveViewManager.instance.xd.Tb))){E=Md.a.qq(b,S.end);if(u.AFrameworkApplication.isRtl&&E.x>h.x||!u.AFrameworkApplication.isRtl&&E.x+E.width<h.x||E.y+E.height<h.y)E=Md.a.qq(b,S.end-1);h.x=E.x+(u.AFrameworkApplication.isRtl?0:E.width);h.y=E.y+E.height;x=6}et.u2a("ContextMenu",new Sys.UI.Bounds(h.x,h.y,E.width,
E.height),n,x)}GZd(b,h,n,x,E){if(1===n)return 32;b=E.Qw;E=E.Bd;h=Object.assign(new ti.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.kJk(h,b,E.IsShadowMenuOpen);E.MenuItems=h;return 32}sZ(b,h){return this.P_c(b)||Kj.Pzc(Db.a.mergeCells)||Kj.Pzc(Db.a.dEa)||this.B_f(b)||this.A2i(b,h)||Kj.l3i()||Kj.$2i(b).returnValue}P_c(b){return 2===ob.App.xa.mode&&this.DNc(b)}lCc(b,h,n=null){if(Tj.a.Jy()&&2===ob.App.xa.mode){h=this.R4a.Zph(b.Qa);if(!h||!this.Bhm()&&!this.Uim(h.errorDetails))return;
h=h.errorDetails}else{if(!this.P_c(b))return;h=this.KVh(b)}var x=vj.a.lg(h.lcid);const E=x?x.name:"UNKNOWN";x=Object(pb.a)(Ok.a,h)?h.typeId:"";w.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",h.errorType,h.proofingType,x,E);if(b=this.t9m.JZb(b,h))n.push.apply(n,b),this.Czm(h,x)}Uim(b){return b&&(1===b.proofingType||2===b.proofingType)}Bhm(){return!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightClickALV2Refinement",
!1)}Czm(b,h){const n=Kj.QTa[b.proofingType];n&&(u.AFrameworkApplication.ya.processAction(n,2),w.ULS.sendTraceTag(527799885,375,50,"AEditSurfaceContextMenu: Logging command {0}, typeId {1}, proofingType {2}, ALV2 flight {3}.",n,h,b.proofingType,Tj.a.Jy()))}KVh(b){return this.Rm.Ska(b.Qa).errorDetails}DNc(b){return this.Rm.A4d(b)}Y1b(){return null}qwd(){}mDl(b){return this.DNc(b)?this.Rm.Ska(b.Qa):(b=this.Y1b(b))?new Bb.a(b.zs,b.cpEnd):null}B_f(b){if(2!==ob.App.xa.mode||!b)return!1;b=NA.a.tza(b.toArray());
return!!Kj.Tg.oS(b,14)}M3i(b,h){return 2===h||3===h&&!this.DNc(b)}A2i(b,h){return 3!==h||this.DNc(b)}iGk(){const b=[];b.push(Object.assign(new Pg.a,{ExternalId:this.SYk}));b.push(Object.assign(new Pg.a,{ExternalId:this.RYk}));b.push(Object.assign(new Pg.a,{ExternalId:this.TYk}));return b}nKk(){const b=[];this.Dte&&b.push(Object.assign(new Pg.a,{ExternalId:this.t4e}));return b}static get hd(){return null!=Kj.pmg?Kj.pmg:Kj.pmg=Oa.a.instance.resolve("Box4.List.IListReader")}static get Tg(){return Rl.ContextSetEditor.instance}static get rcm(){null==
Kj.Wse&&(Kj.Wse=u.AFrameworkApplication.K?u.AFrameworkApplication.K.$("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return Kj.Wse}static get xRc(){null==Kj.Emb&&(Kj.Emb=u.AFrameworkApplication.K?u.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return Kj.Emb}static get g1(){null==Kj.zU&&(Kj.zU=u.AFrameworkApplication.K?u.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Kj.zU}static Pzc(b){return 32===u.AFrameworkApplication.ya.processAction(b,1)}static l3i(){return 2===
ob.App.xa.mode&&!!ob.App.Av.PH&&ob.App.Av.PH.lOc(Db.a.PXd.toString())}static n3i(b){if(1!==b.length||!b.Qa.ul)return!1;b=md.GraphIterator.$a(b.Qa.node);b.Bb(11);b.nc();return b.Zp(4)&&!Kj.hd.Es(b).listType?!0:!1}static $2i(b){let h=!1,n=!1;if(!b)return{returnValue:!1,eeb:h,FKc:n};if(Kj.xRc)return Kj.oVn(b,n);if(!(b.VD||Kj.rcm&&2===b.length&&b.Tc.contextId===cc.a.endOfParagraph))return{returnValue:!1,eeb:h,FKc:n};b=b.Qa.clone();h=32===u.AFrameworkApplication.ya.Qf(b,Db.a.ENa,1,!0,null,null);n=32===
u.AFrameworkApplication.ya.Qf(b,Db.a.insertHyperlink,1,!0,null,null);return{returnValue:h||n,eeb:h,FKc:n}}static oVn(b,h){let n;h=b.Qa.clone();n=Kj.g1&&Ad.l(h);let x=!n&&32===u.AFrameworkApplication.ya.Qf(h,Db.a.ENa,1,!0,null,null);if(b.VD||2===b.length&&b.Tc.contextId===cc.a.endOfParagraph)h=!n&&32===u.AFrameworkApplication.ya.Qf(h,Db.a.insertHyperlink,1,!0,null,null);else{h=!0;const E=b.length;for(let S=0;S<E;S++){const ma=b.J(S).clone();if(ma.contextId===cc.a.paragraph||ma.contextId===cc.a.Fd)(n=
Kj.g1&&Ad.l(ma))||(h=32===u.AFrameworkApplication.ya.Qf(ma,Db.a.insertHyperlink,1,!0,null,null)&&h);else if(ma.contextId!==cc.a.endOfParagraph)return h=x=!1,{returnValue:!1,eeb:x,FKc:h}}}return{returnValue:x||h,eeb:x,FKc:h}}static NSh(b){const h=Object.assign(new Fh.a,{ControlList:[]});for(const n of b)h.ControlList.push(Object.assign(new Pg.a,{ExternalId:n}));return h}static LG(b){let h=[];for(const n of b)h.push(Object.assign(new Pg.a,{ExternalId:n}));return h}}Kj.Wse=null;Kj.Emb=null;Kj.zU=null;
Kj.QTa=[];Object(r.a)(Kj,"AEditSurfaceContextMenu",et,[]);var gP=d(587),hP=d(839),iP=d(1690);class nF{static zCl(b,h,n){h=[];n.Y5m.JZb(n.Efl(b),h);return h}static Mnl(b,h,n){const x=[];if(n.P_c(b))return x;n.K.$("WordEditorIdeasCardsIsEnabled")&&!V.a.zk||n.m2e.qwd(b,null,h,x);return x}static CHl(b,h,n){const x=[];n.lCc(b,h,x);return x}}Object(r.a)(nF,"ContextMenuSectionHelper",null,[]);class mq{static znl(b,h,n){h=[];n.XSk(b)&&h.push(Object.assign(new Pg.a,{ExternalId:"ReviewDesignerSuggestion",LabelText:n.IEl(b)}));
return h}static $wl(){return Kj.Pzc(Db.a.mergeCells)?Kj.LG(["MergeCells"]):Kj.Pzc(Db.a.u8d)?Kj.LG(["SplitCells"]):[]}static aLl(b,h,n){h=[];if(!n.Ph.Xoh(b))return h;b=n.Ph.NZh(b);h.push(Object.assign(new Pg.a,{ExternalId:"AcceptChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_AcceptChange,b)}));h.push(Object.assign(new Pg.a,{ExternalId:"RejectChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,
WordEditorIntl.WordEditorStrings.L_RejectChange,b)}));return h}static yil(b,h,n){return u.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&b&&b.Qa&&b.Qa.node&&n.Lc&&n.Lc.psi(b.Qa.node)?Kj.LG(["ShowCatchUpActivitiesForParagraph"]):[]}static sol(b){return Kp.d3i(b)?Kj.LG(["EditIllustration"]):[]}static NNl(b,h,n){return n.K.$("WordEditorWrapTextIsEnabled")&&Kp.UWn(b)?[Object.assign(new Yh.a,{ExternalId:"WrapTextMenu"})]:[]}static FGd(b,h,n){return n.nTk(b)?Kj.LG(["CreatePullQuote"]):[]}static kbf(b,
h,n){return n.WSk()?Kj.LG(["RemoveContentControl"]):[]}static ekl(){return Kp.D2i()?Kj.LG(["NewComment"]):[]}static Vil(b){let h=[];!Kp.z_f(b)&&Kp.d_f(b)&&Vh.SessionStatusManager.instance.dK&&b.JL&&h.push(Object.assign(new Yh.a,{ExternalId:"ChangePictureMenu",QueryCommand:"QueryChangePictureHostButton"}));return h}static $tl(b,h,n){h=[];!Kp.z_f(b)&&Kp.d_f(b)&&Vh.SessionStatusManager.instance.dK&&(w.ULS.sendTraceTag(39188235,1303,50,"Showing Insights context menu option"),b.JL&&!u.AFrameworkApplication.K.$("ChangePicturesIsEnabled")?
h.push(...Kj.LG(["ChangePicture"])):h.push(...n.yIk().ControlList),(b=Kp.iFd())&&0<b.length&&(n=n.QLk(b),null!=n&&h.push(...n.ControlList)));return h}static jDl(){return Kj.l3i()?Kj.LG(["SetProofingLanguage"]):[]}static SEl(b,h,n){return n.Ahm&&n.jWn(b)?Kj.LG(["Rewrite"]):[]}static Gvl(b){return Kj.n3i(b)?Kj.LG(["StartNewList","ContinueNumbering","SetNumberingValue"]):[]}static gBl(){return Kp.z3i()?Kj.LG(["ParagraphOptions"]):[]}static Vsl(b){return Kp.d3i(b)?Kj.LG(["EditIllustration"]):[]}static vHl(b){return Kp.z_f(b)?
Kj.LG(["ShowSmartLookupPane"]):[]}static lLl(b){return Kp.q3i(b)?Kj.LG(["ModernTranslatorSplitButton"]):[]}static gsl(b,h,n){h=[];u.AFrameworkApplication.Hf("0j6hg566;iii68384");if(u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.HeadingDeeplinkIsEnabled",!1)&&b.VD){const x=b.Qa;if(x.contextId===cc.a.paragraph||x.contextId===cc.a.Wc||x.contextId===cc.a.Fd){b=b.Qa.node;if(!n.ko.oc(b)||b.Pr||""===b.characterData)return h;n.O_b.TEd(b)&&h.push(...Kj.LG(["CreateHeadingLink"]))}}return h}static getBookmark(b,
h,n){h=[];if(u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksFloatie",!1)&&b.VD){const x=b.Qa;(Kd.SelectionEditor.xf(x)||Kd.SelectionEditor.sZa(x))&&n.Bhk.jHc(b.Qa.node,b.Qa.cpBegin)&&(h.push(...Kj.LG(["DeleteBookmarkContextMenu"])),h.push(...Kj.LG(["EditBookmarkNameContextMenu"])))}return h}static c$(b){let h=!1,n=!1,x=[];({eeb:h,FKc:n}=Kj.$2i(b)).returnValue&&(h?n?x.push(...Kj.LG(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):
x.push(...Kj.LG(["OpenHyperlink"])):n&&(u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&(u.AFrameworkApplication.K.$("IsO365CommercialHost")||u.AFrameworkApplication.K.$("IsO365ConsumerHost"))?x.push(...Kj.LG(["InsertLinkFlyout"])):x.push(...Kj.LG(["InsertLink"]))));return x}static Fjl(b,h,n){let x=[];if(!n.A2i(b,h))return x;2===ob.App.xa.mode?(x.push(...n.iGk()),x.push(...n.nKk()),3===h&&n.DNc(b)&&x.push(Object.assign(new Pg.a,{ExternalId:"Delete"}))):
u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)?(!u.AFrameworkApplication.protectFile&&!u.AFrameworkApplication.fO||u.AFrameworkApplication.j0b)&&x.push(Object.assign(new Pg.a,{ExternalId:"Copy"})):u.AFrameworkApplication.protectFile||x.push(Object.assign(new Pg.a,{ExternalId:"Copy"}));return x}static M$e(b,h,n){return n.B_f(b)&&n.M3i(b,h)?Kj.LG(["EditTableAltText"]):[]}static pRh(b,h,n){return n.gTk(b)?Kj.LG(["ShowIntentSuggestion"]):
[]}static kJl(b,h,n){const x=[];n.B_f(b)&&!n.M3i(b,h)&&(x.push(Object.assign(new Yh.a,{ExternalId:"InsertTableMenu"})),x.push(Object.assign(new Yh.a,{ExternalId:"DeleteTableMenu"})),x.push(Object.assign(new Yh.a,{ExternalId:"SelectTableMenu"})));return x}static pJl(b,h,n){return Kp.Pb.isFeatureEnabled(119)&&n.zWn(b)?Kj.LG(["UpdateTableOfContents"]):[]}static cpl(b){return Kp.LUn(b)?Kj.LG(["ShowHideEquationToolsPane"]):[]}}Object(r.a)(mq,"ContextMenuSectionItemHelper",null,[]);class Kp extends Kj{constructor(b,
h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd,Gd,vd,ce,od=!1,Yd=null,ne=null,Df,Af,Wi,gm){super(b,h,n,od,void 0,Yd,Df);this.eyd=gm;this.LBe=this.yO=null;this.NFg=!1;this.o4d=new Map;this.kD={};this.PEb={};this.ga=b;this.K=x;this.Ph=E;this.lV=Fa;this.zH=$a;this.Ls=sb;this.MXj=!!Yd;this.m2e=Jb;this.Y5m=Sb;this.ROb=Gd;this.rR=vd;this.Bhk=ce;this.zRa=Wi;this.fb=Af;gd&&gd.execute(Ck=>{this.gYg=Ck});oc&&oc.execute(Ck=>{this.LBe=Ck});this.Lc=ma;this.jy=Ic;ne&&ne.execute(Ck=>{this.yO=Ck});this.L_l();this.g4m();this.D5k();
this.f4m()}get ko(){return this.fb}get O_b(){return this.zRa}get t4e(){return this.MXj?Dh.a.bZd:super.t4e}KSn(){const b=Kb.App.fm.jb.Jc.Cb.ib.kb;return this.P_c(b)&&2!==this.KVh(b).errorType}sZ(b,h){return super.sZ(b,h)||Kp.z3i()||Kj.n3i(b)||Kp.D2i()||Kp.d_f(b)||Kp.q3i(b)}kJk(b,h,n){const x=[];let E=null;try{E=Kb.App.fm.jb.Jc.Cb.ib.kb}catch(S){w.ULS.sendTraceTag(576481226,341,15,"Selection was not initialized in time for ContextMenu Population");return}this.X3m(E,h,x,this.tll(E));b.MenuSectionList.push(...x);
this.SJn(b);!n&&this.gYg&&this.gYg.O7m(b.MenuTargetDescriptor.menuTargetType,x)}tll(b){return Kj.Pzc(Db.a.mergeCells)?mw.Idg:b.qpf?mw.sag:b.JL?mw.vcg:b.S6b()?mw.fag:mw.Cag}zIk(b){b=Kp.NZe(b);return Object.assign(new Pg.a,{ExternalId:"SmartLookupContextMenu",LabelText:b})}RLk(b){return(b=Kp.vmj(b))?Object.assign(new Pg.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}):null}yIk(){const b=Object.assign(new Fh.a,{ControlList:[]}),h=Kp.iFd();b.ControlList.push(this.zIk(h));return b}QLk(b){const h=Object.assign(new Fh.a,
{ControlList:[]});if(b&&0<b.length){b=this.RLk(b);if(null==b)return null;h.ControlList.push(b)}return h}r7b(b){return b.JL||2<b.length||!b.length||2===b.length&&!Kd.SelectionEditor.sk(b.Tc)||1===b.length&&Kd.SelectionEditor.sk(b.Tc)?!1:this.Usf(b.Qa)}Usf(b){return Cd.ParagraphReader.oc(b.node)?""!==Cd.ParagraphReader.text(b.node).trim():!1}zWn(b){var h=md.GraphIterator.$a(b.Qa.node);h=Object(ja.a)(gP.a,h.currentNode);return Of.a.instance.J(5)&&b.JL?!1:!!h&&h.Pr}D5k(){u.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");
this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.jy.execute(b=>{b.isFeatureEnabled(hP.a.yri,!1).then(h=>{h||w.ULS.sendTraceTag(592995265,341,50,"Rewrite license missing, skip creating context menu item");this.NFg=h;return null})}):w.ULS.sendTraceTag(592995266,341,50,"Rewrite flight not enabled, skip creating context menu item")}get Ahm(){u.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");
return this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.NFg:!1}jWn(b){if(!this.r7b(b)||b.H5b||b.S6b())return!1;b=b.Qa;if(Cd.ParagraphReader.gm(b)||Kd.SelectionEditor.xf(b)||Kd.SelectionEditor.Ek(b)){b=this.zH.VXa(b);b||(b=u.AFrameworkApplication.lcid);switch(b&1023){case 9:return!0;case 10:if(this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}gTk(b){if(1!==
b.length||V.a.zk)return!1;const h=u.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled");if(h&&this.KSn()||Tj.a.Jy()&&this.R4a.Zph(b.Qa))return!1;const n=Kp.Pb.isFeatureEnabled(66);return b.J(0).contextId===cc.a.Wc&&(h||n)&&0<this.Ls.OHc(b.J(0),0).count||h&&this.Y1b(b)?!0:!1}XSk(b){return 1===b.length&&this.ROb.qF(b.Qa.node).Kla}IEl(b){var h,n;const x=null===(h=this.eyd)||void 0===h?void 0:h.qZ(null===(n=null===b||void 0===b?void 0:b.Qa)||void 0===n?void 0:n.node);return iP.a.IZh(x)}get Ix(){return null!=
this.Jgg?this.Jgg:this.Jgg=Oa.a.instance.Pa("WordEditor.Designer.IDesignerTaskPane")}nTk(b){if(!this.rR.dai()||!this.Ix||this.Ix.isVisible||!(1===b.length||2===b.length&&Kd.SelectionEditor.sk(b.Tc))||b.igb||!Kd.SelectionEditor.Ek(b.Qa)&&b.Qa.contextId!==cc.a.paragraph||b.gim()||this.ROb.qF(b.Qa.node).Kla)return!1;const h=Cd.ParagraphReader.text(b.Qa.node),n=b.Qa.contextId===cc.a.paragraph?0:b.Qa.cpBegin,x=b.Qa.contextId===cc.a.paragraph?h.length:b.Qa.cpEnd-n;return 1>x||1500<x||B.a.nf(B.a.Uua(h.substr(n,
x)))||1!=Bq.a.Xcb(b.Qa.node)?!1:!0}WSk(){return vs.a.hof?32==this.ga.processAction(Db.a.NWc,1):!1}Y1b(b){return this.m2e.Y1b(b)}qwd(b,h,n,x=null){this.P_c(b)||this.m2e.qwd(b,h,n,x)}Efl(b){return this.LBe?this.LBe.Ffl(b):[]}SJn(b){const h=this.yO?this.yO.contentType:"Unknown";b.MenuTargetDescriptor=Object.assign(new sJ,{menuTargetType:h})}static get Pb(){return null!=Kp.Xhg?Kp.Xhg:Kp.Xhg=Oa.a.instance.resolve("Box4.IFeatureHelper")}static d_f(b){return u.AFrameworkApplication.yZ&&!b.H5b&&Oa.a.instance.resolve("Box4.Insights.IBox4InsightsSelection").$km()}static GGd(b){b=
b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=B.a.Ky(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}static NZe(b){let h=WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookup;(b=Kp.GGd(b))&&0<b.length&&(h=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,b));return h}static vmj(b){b=Kp.GGd(b);return null!=b&&0<b.length?String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSynonyms,b):null}static iFd(){const b=(new Hq.a).getSelectedText();
return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static d3i(b){const h=Kp.Pb.isFeatureEnabled(51);return!b.ovd&&h&&!V.a.zk&&(b.H5b||h&&b.JL)}static z_f(b){return u.AFrameworkApplication.K.$("WordEditorSmartLookupIsEnabled")&&!b.S6b()}static q3i(b){return u.AFrameworkApplication.K.$("LanguageTranslationIsEnabled")&&!b.H5b&&!b.S6b()}static D2i(){return Kp.Pb.Sw(16)}static LUn(b){return b.nfi()&&u.AFrameworkApplication.ua.Sb.eOc}static z3i(){return 2===Kb.App.fm.mode}static UWn(b){return b.JL}X3m(b,
h,n,x){this.PEb[x].forEach(E=>{const S=Object.assign(new Fh.a,{ControlList:[]}),ma=S.ControlList;E.forEach(Fa=>{Fa instanceof ft?n.push(...this.o4d.get(Fa)(b,h,this)):ma.push(...this.kD[Fa](b,h,this))});(null===ma||void 0===ma?0:ma.length)&&n.push(S)})}f4m(){this.o4d.set(ft.vMb,nF.zCl);this.o4d.set(ft.zde,nF.Mnl);this.o4d.set(ft.mee,nF.CHl)}g4m(){this.kD[Ah.qMb]=mq.Fjl;this.kD[Ah.pee]=mq.kJl;this.kD[Ah.qee]=mq.pJl;this.kD[Ah.yde]=mq.znl;this.kD[Ah.Qde]=mq.$wl;this.kD[Ah.mde]=mq.M$e;this.kD[Ah.Kde]=
mq.$tl;this.kD[Ah.K4c]=mq.pRh;this.kD[Ah.Qag]=mq.Vsl;this.kD[Ah.lee]=mq.vHl;this.kD[Ah.see]=mq.lLl;this.kD[Ah.Yde]=mq.jDl;this.kD[Ah.cee]=mq.SEl;this.kD[Ah.M4c]=mq.Gvl;this.kD[Ah.P4c]=mq.gBl;this.kD[Ah.Zde]=mq.FGd;this.kD[Ah.tde]=mq.kbf;this.kD[Ah.Oee]=mq.NNl;this.kD[Ah.Ade]=mq.sol;this.kD[Ah.sde]=mq.Vil;this.kD[Ah.ree]=mq.aLl;this.kD[Ah.rde]=mq.yil;this.kD[Ah.w4c]=mq.getBookmark;this.kD[Ah.Gde]=mq.gsl;this.kD[Ah.Ide]=mq.c$;this.kD[Ah.wmb]=mq.ekl;this.kD[Ah.K4c]=mq.pRh;this.kD[Ah.Bde]=mq.cpl}L_l(){const b=
[Ah.Qde,Ah.mde,Ah.pee];this.PEb[mw.Idg]=[[Ah.qMb],b,[Ah.wmb],[ft.vMb]];this.PEb[mw.vcg]=[[Ah.qMb],[Ah.sde,Ah.Ade,Ah.Oee],b,[Ah.wmb],[ft.vMb]];this.PEb[mw.fag]=[[Ah.Bde],[Ah.M4c,Ah.P4c],[Ah.w4c,Ah.wmb],[ft.vMb]];this.PEb[mw.Cag]=[[Ah.K4c],[Ah.yde],[ft.mee],[ft.zde],[Ah.qMb],[Ah.Kde,Ah.Qag,Ah.lee,Ah.see],[Ah.Yde,Ah.cee,Ah.P4c],[Ah.M4c],b,[Ah.tde],[Ah.Ide,Ah.w4c,Ah.Gde,Ah.wmb],[Ah.Zde],[Ah.ree],[Ah.rde],[Ah.qee],[ft.vMb]];this.PEb[mw.sag]=[[Ah.qMb],[Ah.wmb]];this.PEb[mw.ooj]=[[Ah.K4c],[Ah.yde],[ft.mee],
[ft.zde],[Ah.qMb],[Ah.sde],[Ah.Ade],[Ah.Oee],[Ah.Kde],[Ah.lee],[Ah.see],[Ah.Yde],[Ah.cee],[Ah.Bde],[Ah.M4c],[Ah.P4c],[Ah.Ide],[Ah.Qde],[Ah.mde],[Ah.pee],[Ah.w4c],[Ah.Gde],[Ah.wmb],[Ah.Zde],[Ah.tde],[Ah.ree],[Ah.rde],[Ah.qee],[ft.vMb]]}}Object(r.a)(Kp,"EditSurfaceContextMenu",Kj,[]);var mw;(function(b){b[b.Idg=1]="TABLE_MULTI_CELL";b[b.Cag=2]="GENERIC";b[b.vcg=3]="PICTURE";b[b.fag=4]="EQUATION";b[b.ooj=5]="LEGACY";b[b.sag=6]="FLUID"})(mw||(mw={}));Object(r.b)("Scenarios",mw);class ft{}ft.vMb=new ft;
ft.zde=new ft;ft.mee=new ft;Object(r.a)(ft,"Sections",null,[]);var Ah;(function(b){b[b.K4c=1]="INTENT_SUGGESTION";b[b.qMb=2]="ESSENTIALS";b[b.Kde=3]="INSIGHT";b[b.Qag=4]="ILLUSTRATION";b[b.lee=5]="SMART_LOOKUP";b[b.see=6]="TRANSLATE";b[b.Yde=7]="PROOFING";b[b.cee=8]="REWRITE_SUGGESTIONS";b[b.M4c=9]="LISTS";b[b.P4c=10]="PARAGRAPH_OPTIONS";b[b.Qde=11]="MERGE_SPLIT_CELLS";b[b.mde=12]="ALT_TEXT";b[b.Ide=13]="HYPERLINK";b[b.w4c=14]="BOOKMARK";b[b.Gde=15]="HEADING_LINK";b[b.wmb=16]="COMMENT";b[b.Zde=17]=
"PULL_QUOTE";b[b.Oee=18]="WRAP_TEXT";b[b.Ade=19]="DRAW_ANNOTATE";b[b.ree=20]="TRACK_CHANGE";b[b.rde=21]="CATCHUP_ACTIVITIES";b[b.qee=22]="TABLE_OF_CONTENTS";b[b.yde=23]="DESIGNER_REVIEW";b[b.pee=24]="TABLE_ITEMS";b[b.sde=25]="CHANGE_PICTURE";b[b.Bde=26]="EQUATION_TOOLS";b[b.tde=27]="CONTENT_CONTROL"})(Ah||(Ah={}));Object(r.b)("SectionItem",Ah);class nA extends et{constructor(b,h,n){super();this.Tl=null;this.NZd=(x,E,S,ma,Fa)=>{if(1===S)return 32;x=[];E=[];this.LSn()&&E.push("InsertTabStopMenuSplitButton");
this.wSn()&&E.push("ClearAllTabStops");E.push("HideRuler");x.push(nA.NSh(E));E=Object.assign(new ti.a,{ExternalId:"RulerContextMenu",UpdateDynamically:!0,MenuSectionList:[]});E.MenuSectionList.push(...x);Fa.MenuItems=E;return 32};this.ga=b;this.Hm=h;this.sC=n;this.Vb()}get P6a(){return document.getElementById("WACHorizontalRuler")}get HM(){return this.Hm&&this.Hm.instance?this.Hm.instance.vj:1}get target(){return this.Tl}show(b,h){this.Tl=b;et.RJb("RulerContextMenu",b,h);w.ULS.sendTraceTag(592307397,
3014,50,"Ruler Context menu invoked.");b=new Map;b.set("Command","Show");b.set("Source",nA.A2);b.set("Response","Ruler Context menu invoked.");ta.Health.instance.recordKpiUsage(nA.kpiName,1,nA.S5,b)}hEl(){var b=0,h=(this.target.x-rd.a.raf(this.P6a))/this.HM;h=mf.a.Ty(h,0);var n={},x=this.sC.Z0b,E=md.GraphIterator.$a(x);E.vd();if(!ag.TableReader.Tw(E))return 32===this.ga.Xb(Db.a.jDa,2,n)&&(b=n.marginLeft),h-b;b={};E={};n=this.ga.Xb(Db.a.HVc,2,b);var S=this.ga.Xb(Db.a.oHb,2,E);if(32!==n||32!==S)return w.ULS.sendTraceTag(559252943,
3014,15,"Unable to read table properties for Ruler Context Menu"),h;b=b.ColumnWidths;S=E.TablePosition;if(!S||!b||0>=b.length)return w.ULS.sendTraceTag(559252944,3014,15,"Queried table properties are null or do not exist"),h;n=0;E=md.GraphIterator.$a(x);E.Bb(14)&&(E.kd(16),n=fm.a(E,!0));x=S.x/this.HM;for(E=0;E<n;E++)x+=b[E];return h-x}Vb(){this.ga.gb(ub.a.NZd,cc.a.application,this.NZd,96)}LSn(){var b={},h={},n=this.ga.Xb(Db.a.jDa,2,b),x=this.ga.Xb(Db.a.g1a,2,h);if(32===n&&32===x){x=h.Ts;n=mf.a.Ni(x.wla,
0);x=1===x.specialIndentType?mf.a.Ni(x.tA,0):mf.a.Ni(x.tA-x.bba,0);const E=mf.a.Ni(b.marginLeft,0);b=mf.a.Ni(b.marginRight,0);const S=rd.a.raf(this.P6a),ma=rd.a.mLh(this.P6a);h.isRtl?(h=S+this.HM*Math.max(b,b+n),n=ma-this.HM*Math.max(E,E+x)):(h=S+this.HM*Math.max(E,E+x),n=ma-this.HM*Math.max(b,b+n));if(this.target.x>=h&&this.target.x<=n)return!0}return!1}wSn(){var b={};if(32!==this.ga.Xb(ub.a.bHb,2,b)||!b)return!1;b=b.customTabs;return!b||0>=b.length?!1:!0}static NSh(b){const h=Object.assign(new Fh.a,
{ControlList:[]});for(let n of b)h.ControlList.push(Object.assign(new Pg.a,{ExternalId:n}));return h}}nA.S5="wwaengidc";nA.kpiName="WordRuler";nA.A2="RulerContextMenu";Object(r.a)(nA,"RulerContextMenu",et,[586]);let My;class Wp{static get pc(){return null!=Wp.qrg?Wp.qrg:Wp.qrg=Oa.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get ZQ(){return null!=Wp.irg?Wp.irg:Wp.irg=Oa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get Rj(){return null!=Wp.Sjg?Wp.Sjg:Wp.Sjg=Oa.a.instance.resolve("Box4.IInsertionPointFormatting")}static aGi(b,
h,n){if(1===h)return(b?Wp.Lpk(n):Wp.lpk(n))?32:8;(b=Wp.sIl(b,n))&&Wp.Ubk(b,n);return 32}static Ubk(b,h){const n=new Se.GraphTransaction(15);n.Db(h);Wp.Rj.C1a();Wp.ZQ.hM(b,h,!1);n.dispose()}static Lpk(b){b=Wp.pc.yo(b);return!!b&&Wp.pc.tf(b)!==jh.StyleReader.wordStyleIdHeading1}static lpk(b){b=Wp.pc.yo(b);return!!b&&Wp.pc.tf(b)!==jh.StyleReader.c4a}static sIl(b,h){const n=Wp.pc.yo(h);return n?Wp.pc.Nx(h).uh(Wp.pIl(b,Wp.pc.tf(n))):null}static pIl(b,h){h=Wp.headingsList.indexOf(h);b=b?h-1:h+1;return 0<=
b&&b<Wp.headingsList.count?Wp.headingsList.J(b):null}}Wp.headingsList=(My=new Qa.a,My.add(jh.StyleReader.wordStyleIdHeading1),My.add(jh.StyleReader.wordStyleIdHeading2),My.add(jh.StyleReader.wordStyleIdHeading3),My.add(jh.StyleReader.$3a),My.add(jh.StyleReader.a4a),My.add(jh.StyleReader.b4a),My.add(jh.StyleReader.lmb),My.add(jh.StyleReader.mmb),My.add(jh.StyleReader.c4a),My);Object(r.a)(Wp,"NavigationPaneEditor",null,[]);class kE extends et{constructor(){super();this.G1=null;this.GZd=(b,h,n,x,E)=>
{if(1===n)return 32;b=new Sys.StringBuilder;b.append(String.format('<Menu Id="{0}">',"mnuNavPaneWordEditor"));b.append('<MenuSection Id="msWordEditorHeadings" DisplayMode="Menu16"><Controls>');b.append(et.qJh("promoteHeading",ub.a.y_d,"LeftArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_PromoteHeadingText));b.append(et.qJh("demoteHeading",ub.a.byd,"RightArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_DemoteHeadingText));b.append("</Controls></MenuSection></Menu>");E.PopulationXML=b.toString();
return 32};this.y_d=(b,h,n)=>Wp.aGi(!0,n,this.G1.zb);this.byd=(b,h,n)=>Wp.aGi(!1,n,this.G1.zb)}show(b){kE.zh||(this.wZb(),kE.zh=!0);et.showContextMenu("mnuNavPaneWordEditor",b)}wZb(){const b={PopulateDynamically:"true",PopulateOnlyOnce:"false"};b.PopulateQueryCommand=""+ub.a.NDi;b.Command=""+Ra.a.lja;et.FGk(b);u.AFrameworkApplication.ya.pa(ub.a.NDi,cc.a.application,this.GZd);u.AFrameworkApplication.ya.pa(ub.a.y_d,cc.a.view,this.y_d);u.AFrameworkApplication.ya.pa(ub.a.byd,cc.a.view,this.byd)}}kE.zh=
!1;Object(r.a)(kE,"WordEditorNavigationPaneContextMenu",et,[585]);var Cz=d(1435),Bv=d(294),jP=d(479),kP=d(729),oF=d(1163),OG=d(1629),PG=d(960);class pF{constructor(){this.n6=this.Ubi=!1;this.MKb=2;this.Ws=0;this.h4a=1}}Object(r.a)(pF,"WrapTextPropertiesData",null,[]);class il extends oF.a{constructor(b=null){super(b);this.mYg=new OG.a;this.A4g=new pF;this.M0g=new PG.a;this.Vpe=!1}initialize(){super.initialize();this.jd.Z(ub.a.ruf,Cz.a.Peb);this.jd.Z(ub.a.vuf,Cz.a.Peb);this.jd.Z(ub.a.xuf,Cz.a.Peb);
this.jd.Z(ub.a.pNf,il.$Na);this.jd.Z(ub.a.BVc,il.$Na);this.jd.Z(ub.a.iNf,il.$Na);this.jd.Z(Ra.a.rHb,il.$Na);this.jd.Z(Db.a.h0d,Object(v.a)(this,this.i_,"sectionPropertiesExecuteBridge"));this.jd.Z(Db.a.g0d,Object(v.a)(this,this.i_,"sectionPropertiesExecuteBridge"));this.jd.Z(Db.a.f0d,Object(v.a)(this,this.i_,"sectionPropertiesExecuteBridge"));this.jd.Z(Db.a.j0d,Object(v.a)(this,this.i_,"sectionPropertiesExecuteBridge"));this.jd.Z(Db.a.i0d,Object(v.a)(this,this.i_,"sectionPropertiesExecuteBridge"));
this.jd.Z(Db.a.e0d,Object(v.a)(this,this.i_,"sectionPropertiesExecuteBridge"));this.jd.Z(Db.a.q0d,Object(v.a)(this,this.i_,"sectionPropertiesExecuteBridge"));this.jd.Z(Db.a.p0d,Object(v.a)(this,this.i_,"sectionPropertiesExecuteBridge"));this.jd.Z(Db.a.o0d,Object(v.a)(this,this.i_,"sectionPropertiesExecuteBridge"));this.jd.Z(Db.a.l0d,Object(v.a)(this,this.i_,"sectionPropertiesExecuteBridge"));this.jd.Z(Db.a.m0d,Object(v.a)(this,this.i_,"sectionPropertiesExecuteBridge"));this.jd.Z(Db.a.n0d,Object(v.a)(this,
this.i_,"sectionPropertiesExecuteBridge"));this.jd.Z(Db.a.CNf,Object(v.a)(this,this.i_,"sectionPropertiesExecuteBridge"));this.jd.Z(Db.a.BNf,Object(v.a)(this,this.i_,"sectionPropertiesExecuteBridge"));this.jd.Z(Db.a.UMf,Object(v.a)(this,this.i_,"sectionPropertiesExecuteBridge"));this.jd.Z(Db.a.WMf,Object(v.a)(this,this.i_,"sectionPropertiesExecuteBridge"));this.jd.Z(Db.a.VMf,Object(v.a)(this,this.i_,"sectionPropertiesExecuteBridge"));this.jd.Z(Db.a.TMf,Object(v.a)(this,this.i_,"sectionPropertiesExecuteBridge"));
this.jd.Z(Db.a.bJb,il.CCm);this.jd.Z(Db.a.bPa,il.d_m);this.jd.Z(Db.a.Kjb,il.cyk);this.jd.Z(Db.a.pja,il.$Na);this.jd.Z(Db.a.EGb,il.$Na);this.jd.Z(Db.a.cOa,il.$Na);this.jd.Z(Db.a.$qa,il.$Na);this.jd.Z(Db.a.Lua,il.$Na);this.jd.Z(ub.a.qUc,il.$Na);this.jd.Z(ub.a.rCd,Cz.a.R8e);this.jd.Z(ub.a.sCd,Object(v.a)(this,this.QJh,"genericFontSizeExecuteBridge"));this.Jm.Z(ub.a.oUc,Cz.a.EWa);this.Jm.Z(ub.a.pUc,Cz.a.EWa);this.jd.Z(Db.a.nJb,Cz.a.aXa);this.jd.Z(Db.a.mJb,Cz.a.aXa);this.jd.Z(Db.a.Zjb,Cz.a.aXa);this.jd.Z(Db.a.ONf,
Object(v.a)(this,this.iE,"queryParaFormattingExecuteBridge"));this.jd.Z(Db.a.MNf,Object(v.a)(this,this.iE,"queryParaFormattingExecuteBridge"));this.jd.Z(Db.a.NNf,Object(v.a)(this,this.iE,"queryParaFormattingExecuteBridge"));this.jd.Z(Db.a.jM,il.l9m);this.Jm.Z(ub.a.T0d,il.JWc);this.Jm.Z(ub.a.U0d,il.JWc);this.Jm.Z(ub.a.V0d,il.JWc);this.Jm.Z(ub.a.R0d,il.JWc);this.Jm.Z(ub.a.S0d,il.JWc);this.jd.Z(ub.a.T0d,Object(v.a)(this,this.g4c,"wrapTextPropertiesExecuteBridge"));this.jd.Z(ub.a.U0d,Object(v.a)(this,
this.g4c,"wrapTextPropertiesExecuteBridge"));this.jd.Z(ub.a.V0d,Object(v.a)(this,this.g4c,"wrapTextPropertiesExecuteBridge"));this.jd.Z(ub.a.R0d,Object(v.a)(this,this.g4c,"wrapTextPropertiesExecuteBridge"));this.jd.Z(ub.a.S0d,Object(v.a)(this,this.g4c,"wrapTextPropertiesExecuteBridge"));this.jd.Z(ub.a.$ce,il.Ahc);this.jd.Z(ub.a.ade,il.Ahc);this.jd.Z(ub.a.bde,il.Ahc);this.jd.Z(ub.a.cde,il.Ahc);this.jd.Z(ub.a.dde,il.Ahc);this.jd.Z(ub.a.ede,il.Ahc);this.jd.Z(ub.a.Lna,il.n1b);this.jd.Z(ub.a.WZf,il.n1b);
this.jd.Z(ub.a.XZf,il.n1b);this.jd.Z(ub.a.j7d,il.n1b);this.jd.Z(ub.a.k7d,il.n1b);this.jd.Z(ub.a.l7d,il.n1b);this.jd.Z(ub.a.Pib,Object(v.a)(this,this.T$m,"queryImageCropExecuteBridge"));this.jd.Z(ub.a.kVc,il.VCd);this.jd.Z(ub.a.X_d,il.VCd);this.jd.Z(ub.a.Y_d,il.VCd);this.jd.Z(ub.a.Z_d,il.VCd);this.jd.Z(ub.a.WKc,Object(v.a)(this,this.IKd,"imageCropFromSpinnersExecuteBridge"));this.jd.Z(ub.a.PKc,Object(v.a)(this,this.IKd,"imageCropFromSpinnersExecuteBridge"));this.jd.Z(ub.a.QKc,Object(v.a)(this,this.IKd,
"imageCropFromSpinnersExecuteBridge"));this.jd.Z(ub.a.RKc,Object(v.a)(this,this.IKd,"imageCropFromSpinnersExecuteBridge"));this.jd.Z(Db.a.sla,Object(v.a)(this,this.W4h,"ignoreAllExecuteBridge"));this.jd.Z(Db.a.Sxb,Object(v.a)(this,this.W4h,"ignoreAllExecuteBridge"));this.jd.Z(ub.a.Nib,il.Nib);this.jd.Z(ub.a.t7d,Cz.a.aXa);this.jd.Z(Db.a.TNf,Object(v.a)(this,this.YGi,"queryTableBorderFormattingExecuteBridge"));this.jd.Z(Db.a.UNf,Object(v.a)(this,this.YGi,"queryTableBorderFormattingExecuteBridge"))}clearCache(){super.clearCache();
this.Vpe=!1;this.mYg=new OG.a;this.A4g=new pF;this.M0g=new PG.a}Dbf(){const b=super.Dbf();b.Dya=il.Dya;b.bVa=il.bVa;return b}W4h(b){const h=new Bv.a;h.hAa=!0;h.YK=b;return h}i_(){const b=new Bv.a;b.cBb=!1;b.YK=Db.a.jDa;b.Bd=this.mYg;b.F6b=!0;b.Zea=!0;return b}YGi(){const b=new Bv.a;b.cBb=this.Vpe;this.Vpe=!0;b.YK=Db.a.i1a;b.Bd=this.M0g;b.F6b=!0;b.Zea=!0;return b}g4c(){const b=new Bv.a;b.cBb=!1;b.YK=ub.a.hbc;b.Bd=this.A4g;b.F6b=!0;b.Zea=!0;return b}IKd(b,h){const n=new Bv.a;n.Bd=new qi.DictionaryPropertySet;
switch(b){case ub.a.WKc:n.Bd.setValue(ad.a.Aeb,h[rc.a.Number]);break;case ub.a.PKc:n.Bd.setValue(ad.a.xeb,h[rc.a.Number]);break;case ub.a.QKc:n.Bd.setValue(ad.a.yeb,h[rc.a.Number]);break;case ub.a.RKc:n.Bd.setValue(ad.a.zeb,h[rc.a.Number])}return n}T$m(){const b=new Bv.a;b.Bd=new qi.DictionaryPropertySet;b.Zea=!0;return b}static get FZm(){return null!=il.nng?il.nng:il.nng=Oa.a.instance.Pa("WordEditor.IPageCommandStringBuilder")}static get Xy(){il.uqa||(il.uqa=Oa.a.instance.Pa("WordEditor.ITableBorderManager"));
return il.uqa}static $Na(b,h){b=new Bv.a;b.Bd=h;return b}static xZc(b,h,n){h[Qf.a.Description]=b?b.zCm(n):null}static Dya(b,h){const n=Object(ja.a)(OG.a,b.Bd),x=Object(ja.a)(jP.a,b.Bd),E=Object(ja.a)(pF,b.Bd),S=Object(ja.a)(PG.a,b.Bd);let ma=!0;const Fa=il.FZm;switch(b.dib){default:ma=oF.a.Dya(b,h);break;case Db.a.h0d:h[Bj.a.Icon]=n.rta?"PageMarginsLandscapeNormal_48":"PageMarginsPortraitNormal_48";h[Qf.a.On]=!n.JEb;il.xZc(Fa,h,0);break;case Db.a.g0d:h[Bj.a.Icon]=n.rta?"PageMarginsLandscapeNarrow_48":
"PageMarginsPortraitNarrow_48";h[Qf.a.On]=1===n.JEb;il.xZc(Fa,h,1);break;case Db.a.f0d:h[Bj.a.Icon]=n.rta?"PageMarginsLandscapeModerate_48":"PageMarginsPortraitModerate_48";h[Qf.a.On]=2===n.JEb;il.xZc(Fa,h,2);break;case Db.a.j0d:h[Bj.a.Icon]=n.rta?"PageMarginsLandscapeWide_48":"PageMarginsPortraitWide_48";h[Qf.a.On]=3===n.JEb;il.xZc(Fa,h,3);break;case Db.a.i0d:h[Bj.a.Icon]=n.rta?"PageMarginsLandscapeOffice2003_48":"PageMarginsPortraitOffice2003_48";h[Qf.a.On]=4===n.JEb;il.xZc(Fa,h,4);break;case Db.a.e0d:h[Bj.a.Icon]=
n.rta?"PageMarginsLandscapeCustom_48":"PageMarginsPortraitCustom_48";h[Qf.a.On]=5===n.JEb;break;case Db.a.q0d:h[Qf.a.On]=!n.fGb;h[Qf.a.Description]=Fa?Fa.BTc(0):null;break;case Db.a.p0d:h[Qf.a.On]=1===n.fGb;h[Qf.a.Description]=Fa?Fa.BTc(1):null;break;case Db.a.o0d:h[Qf.a.On]=2===n.fGb;h[Qf.a.Description]=Fa?Fa.BTc(2):null;break;case Db.a.l0d:h[Qf.a.On]=3===n.fGb;h[Qf.a.Description]=Fa?Fa.BTc(3):null;break;case Db.a.m0d:h[Qf.a.On]=4===n.fGb;h[Qf.a.Description]=Fa?Fa.BTc(4):null;break;case Db.a.n0d:h[Qf.a.On]=
5===n.fGb;break;case Db.a.CNf:h[Qf.a.On]=!n.rta;break;case Db.a.BNf:h[Qf.a.On]=n.rta;break;case Db.a.UMf:h[Qf.a.On]=1===n.yC;break;case Db.a.WMf:h[Qf.a.On]=2===n.yC;break;case Db.a.VMf:h[Qf.a.On]=3===n.yC;break;case Db.a.TMf:h[Qf.a.On]=0===n.fyk;break;case Db.a.ONf:h[Qf.a.On]=x.Ts?!x.Ts.specialIndentType:!1;break;case Db.a.MNf:h[Qf.a.On]=x.Ts?1===x.Ts.specialIndentType:!1;h[nl.a.Image16by16Class]=x.isRtl?Tg.getImageClass("IndentSpecialFirstLineRTL_Server_16x16x32"):Tg.getImageClass("IndentSpecialFirstLine_Server_16x16x32");
break;case Db.a.NNf:h[Qf.a.On]=x.Ts?2===x.Ts.specialIndentType:!1;h[nl.a.Image16by16Class]=x.isRtl?Tg.getImageClass("IndentSpecialHangingRTL_Server_16x16x32"):Tg.getImageClass("IndentSpecialHanging_Server_16x16x32");break;case ub.a.T0d:h[Qf.a.On]=1===E.h4a;break;case ub.a.U0d:h[Qf.a.On]=8===E.h4a;break;case ub.a.V0d:h[Qf.a.On]=9===E.h4a;break;case ub.a.R0d:h[Qf.a.On]=3===E.h4a;break;case ub.a.S0d:h[Qf.a.On]=4===E.h4a;break;case ub.a.Pib:h[Qf.a.On]=b.Bd.ia(ad.a.mta,!1);break;case ub.a.Nib:h[Ol.a.IsFreeForm]=
!0;h[Ol.a.Value]=b.Bd[Ud.a.Value];break;case Db.a.TNf:h[Vi.a.On]=il.Xy.kLh(h.MenuItemId)===S.lineStyle;break;case Db.a.UNf:h[Vi.a.On]=il.Xy.lLh(h.MenuItemId)===S.XPc}return ma}static CCm(b,h){b=5;switch(h.MenuItemId){case "buttonMarginsNormal":b=0;break;case "buttonMarginsNarrow":b=1;break;case "buttonMarginsModerate":b=2;break;case "buttonMarginsWide":b=3;break;case "buttonMarginsOffice2003":b=4}h=new Bv.a;h.Bd=b;return h}static d_m(b,h){b=5;switch(h.MenuItemId){case "buttonSizeLetter":b=0;break;
case "buttonSizeLegal":b=1;break;case "buttonSizeExecutive":b=2;break;case "buttonSizeA4":b=3;break;case "buttonSizeA5":b=4}h=new Bv.a;h.Bd=b;return h}static cyk(b,h){b=0;switch(h.MenuItemId){case "buttonOneColumn":b=1;break;case "buttonTwoColumns":b=2;break;case "buttonThreeColumns":b=3}h=new Bv.a;h.Bd=b;return h}static Nib(){const b=new Bv.a;b.YK=ub.a.Nib;b.Bd={};b.Zea=!0;b.F6b=!0;return b}static Ahc(b,h){const n=new Bv.a;n.Bd=new qi.DictionaryPropertySet;let x=1;switch(b){case ub.a.cde:x=1;break;
case ub.a.dde:x=8;break;case ub.a.ede:x=9;break;case ub.a.ade:x=3;break;case ub.a.bde:x=4}n.Bd.setValue(ad.a.h4a,x);n.Bd.setValue(ad.a.cEa,h[Qf.a.SourceControlId]);return n}static n1b(b,h,n){b=new Bv.a;b.Bd=n.InvocationMethod;return b}static l9m(b,h){b=new Bv.a;b.Bd=h;return b}static JWc(){const b=new kP.a;b.YK=ub.a.hbc;return b}static VCd(){const b=new Bv.a;b.Bd=new qi.DictionaryPropertySet;b.cOc=!0;return b}static bVa(b,h){let n=!0;switch(b.dib){case ub.a.kVc:b=b.Bd.ia(ad.a.Aeb,0);h[rc.a.Number]=
b;h[rc.a.UnitType]=7;break;case ub.a.X_d:b=b.Bd.ia(ad.a.xeb,0);h[rc.a.Number]=b;h[rc.a.UnitType]=7;break;case ub.a.Y_d:b=b.Bd.ia(ad.a.yeb,0);h[rc.a.Number]=b;h[rc.a.UnitType]=7;break;case ub.a.Z_d:b=b.Bd.ia(ad.a.zeb,0);h[rc.a.Number]=b;h[rc.a.UnitType]=7;break;default:n=oF.a.bVa(b,h)}return n}}il.uqa=null;Object(r.a)(il,"CuiActionBridge",oF.a,[]);class QG extends Kc.a{constructor(b){super();this.yyk=CommonUIStrings.l_AccHelpDialogCommandsHeaderText;this.KPn=CommonUIStrings.l_AccHelpDialogShortcutHeaderText;
this.jyd=this.Psb=this.o4=this.HSa=this.FFe=null;this.Wb=b;this.ug="<div id='AccessibilityHelpDialogBody'></div>";this.kg="AAccessibilityHelpDialog";this.Ed=6;this.We(0,CommonUIStrings.l_DialogClose)}get l2e(){return null}get B6d(){this.FFe||(this.FFe=this.V0l());return this.FFe}get s3n(){return 300}get iqi(){return"https://go.microsoft.com/fwlink/p/?LinkId=325036"}get hqi(){return CommonUIStrings.l_AccHelpDialogMoreHelpLinkText}get pWa(){return this.Wb.Cs()}XOa(b){super.XOa(b);this.L3m()}nPa(){this.showDialog(this.YJa,
Object(v.a)(this,this.mZj,"accHelpDialogResultHandler"));this.oDa();this.setFocus()}setFocus(){this.o4?(this.Psb=this.o4.tBodies[0].firstChild,this.mU(this.Psb)):this.aG&&"none"!==this.aG.style.display?this.mU(this.aG):this.mU(this.gz)}tja(){this.re.mb(kb.a.Di,this.jyd,Object(v.a)(this,this.R4g,"accHelpDialogKeydownHandler"));if(this.o4){this.re.mb(kb.a.Bh,this.o4,Object(v.a)(this,this.N8i,"tableOnKeyUpHandler"));const b=this.o4.tBodies[0].children;for(let h=0;h<b.length;h++)if(af.a.addHandler(b[h],
kb.a.focus,Object(v.a)(this,this.WRi,"rowOnFocusHandler")),af.a.addHandler(b[h],kb.a.blur,Object(v.a)(this,this.VRi,"rowOnBlurHandler")),V.a.zk){const n=b[h].children;for(let x=0;x<n.length;x++)af.a.addHandler(n[x],kb.a.focus,Object(v.a)(this,this.xjh,"cellOnFocusHandler"))}}super.tja()}pbb(){this.re&&(this.re.sc(kb.a.Di,this.jyd,Object(v.a)(this,this.R4g,"accHelpDialogKeydownHandler")),this.o4&&this.re.sc(kb.a.Bh,this.o4,Object(v.a)(this,this.N8i,"tableOnKeyUpHandler")));if(this.o4){const b=this.o4.tBodies[0].children;
for(let h=0;h<b.length;h++)if(af.a.removeHandler(b[h],kb.a.focus,Object(v.a)(this,this.WRi,"rowOnFocusHandler")),af.a.removeHandler(b[h],kb.a.blur,Object(v.a)(this,this.VRi,"rowOnBlurHandler")),V.a.zk){const n=b[h].children;for(let x=0;x<n.length;x++)af.a.removeHandler(n[x],kb.a.focus,Object(v.a)(this,this.xjh,"cellOnFocusHandler"))}}super.pbb()}oDa(){this.pWa.scope.Ar(this.Wb.uV);this.pWa.scope.Ar(this.Wb.vV);this.pWa.scope.bindAction(this.Wb.uV,Ra.a.gxc);this.pWa.scope.bindAction(this.Wb.vV,Ra.a.fxc)}MSl(b){if(!this.pWa.Uj||
!this.pWa.Uj.G1)return 2;var h=this.pWa.Uj.G1;if(this.o4&&(h===this.gz&&b===Ra.a.gxc||h===this.HSa&&b===Ra.a.fxc))this.mU(this.Psb);else if(h.id.startsWith("SelectableTableRow"))h=null,b===Ra.a.gxc?h=this.HSa:b===Ra.a.fxc&&(h=this.gz),h&&this.mU(h);else if(b===Ra.a.gxc)this.pWa.g9b();else if(b===Ra.a.fxc)this.pWa.e9b();else return 2;return 32}WRi(b){b.target.setAttribute(qf.a.B$a,qf.a.Ho);Sys.UI.DomElement.removeCssClass(this.Psb,"inactiveRowSelection");this.Psb=b.target}VRi(b){b.target.removeAttribute(qf.a.B$a);
Sys.UI.DomElement.addCssClass(b.target,"inactiveRowSelection")}xjh(b){(b=b.target.parentNode)&&b!==this.Psb&&this.mU(b)}N8i(b){return b.Ib.keyCode===db.a.Ks?(b.Ib.stopPropagation(),!0):!1}R4g(b){if(!b.Ib)return!1;const h=b.Ib.keyCode;if(b.eventName===kb.a.Di){b=this.Ftl(this.Psb);let n=-1;const x=Ia.a.count(this.B6d)-1;h===Sys.UI.Key.down?n=b<x?b+1:0:h===Sys.UI.Key.up?n=0<b?b-1:x:h===Sys.UI.Key.home?n=0:h===Sys.UI.Key.end&&(n=x);-1!==n&&this.mU(this.o4.tBodies[0].children[n])}return!0}mZj(){}L3m(){this.jyd=
document.getElementById("AccessibilityHelpDialogBody")||this.kv;this.NLk();this.vLk();this.qJk()}NLk(){if(this.l2e){var b=document.createElement("div");b.className="WACDialogSubtitle";var h=document.createElement("span");h.innerText=this.l2e;b.appendChild(h);this.Nha.appendChild(b)}}vLk(){if(this.B6d&&!Ia.a.isEmpty(this.B6d)){this.o4=document.createElement("table");this.o4.className="SelectableDialogTable";var b=document.createElement("thead"),h=document.createElement("tr");h.setAttribute(qf.a.Ah,
qf.a.wyc);b.appendChild(h);var n=Ke.a.UBc(14,this.yyk);h.appendChild(n);n=Ke.a.UBc(14,this.KPn);h.appendChild(n);this.o4.appendChild(b);b=document.createElement("tbody");h=0;n=this.B6d;for(let S in n){var x=S,E=n[S];const ma=document.createElement("tr");ma.tabIndex=0;ma.setAttribute(qf.a.Ah,qf.a.wyc);ma.id="SelectableTableRow"+h++;x=Ke.a.UBc(15,x);ma.appendChild(x);E=Ke.a.UBc(15,E);ma.appendChild(E);b.appendChild(ma)}b.style.maxHeight=this.s3n+"px";this.o4.appendChild(b);this.jyd.appendChild(this.o4)}}qJk(){if(this.hqi&&
this.iqi){var b=document.createElement("div");b.className="WACDialogLearnMoreLinkContainer";this.HSa=document.createElement("a");this.HSa.innerText=this.hqi;this.HSa.href=this.iqi;this.HSa.target="_blank";this.HSa.id=this.pj("AccessibilityHelpDialogLink");this.HSa.className=xd.AFrame.UOe;b.appendChild(this.HSa);this.ed.insertBefore(b,this.ed.lastChild)}}Ftl(b){return Number.parseInvariant(b.id.substr(18))}e1(b,h,n,x=null){b&&h&&n&&(n=x?String.format(n,x):n,b[h]=n)}PXh(b,h){return V.a.wl?h:b}}Object(r.a)(QG,
"AAccessibilityHelpDialog",Kc.a,[940]);class jC extends QG{constructor(b){super(b)}get YJa(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWETitle}get l2e(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWESubtitle}V0l(){const b=this.PXh(CommonUIStrings.l_AccHelpDialogCtrlKey,CommonUIStrings.l_AccHelpDialogCommandKey),h=this.PXh(CommonUIStrings.l_AccHelpDialogWindowsKey,CommonUIStrings.l_AccHelpDialogCtrlKey),n={};this.e1(n,CommonUIStrings.l_AccHelpDialogAccHelpCommand,CommonUIStrings.l_AccHelpDialogAccHelpShortcut);
this.e1(n,CommonUIStrings.l_AccHelpDialogLandmarkRegionsCommand,CommonUIStrings.l_AccHelpDialogLandmarkRegionsShortcut,b);this.e1(n,CommonUIStrings.l_AccHelpDialogTellMeCommand,CommonUIStrings.l_AccHelpDialogTellMeShortcut);this.e1(n,CommonUIStrings.l_AccHelpDialogAccessKeysCommand,CommonUIStrings.l_AccHelpDialogAccessKeysShortcut,h);this.e1(n,CommonUIStrings.l_AccHelpDialogTooltipToggle,CommonUIStrings.l_AccHelpDialogTooltipToggleShortcut,b);this.e1(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteShortcut,b);this.e1(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteShortcut,b);this.e1(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentShortcut);Kb.App.Gce&&this.e1(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerShortcut,
b);this.e1(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleShortcut,b);this.e1(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptShortcut,b);this.e1(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectShortcut,b);this.e1(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousShortcut,b);this.e1(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextShortcut,b);u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&this.e1(n,CommonUIStrings.l_AccHelpDialogOpenDialogMenuCommand,CommonUIStrings.l_AccHelpDialogOpenDialogMenuShortcut);u.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&
this.e1(n,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsShortcut);(jC.Pb&&jC.Pb.isFeatureEnabled(66)||u.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled"))&&this.e1(n,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestion,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionShortcut);return n}static get Pb(){return null!=jC.Phg?jC.Phg:jC.Phg=Oa.a.instance.Pa("Box4.IFeatureHelper")}}Object(r.a)(jC,
"AccessibilityHelpDialog",QG,[]);class qF{static get ug(){return Kc.a.Lx(qF.rl,WordEditorIntl.WordEditorStrings.l_StyleName,WordEditorIntl.WordEditorStrings.l_BadStyleName)}}qF.rl="<div class='normal' id='text'> <label id='IntroLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleError' role='alert'>{1}</div> </div>";
Object(r.a)(qF,"ApplyStylesDialogHtml",null,[]);class bD extends Kc.a{constructor(b,h){super();this.qG=null;this.Fvc=!1;this.Xtb=this.S4a=this.Wrc=this.Zrc=this.Tvc=null;this.yck=(n,x)=>{if(this.Ef.Nr){if(n){n=x.styleList;x=x.styleText;if(-1===n||B.a.mh(x)!==B.a.mh(this.qG[n]))n=this.hYh(x);x=this.qG[n];n=this.pc.Ip();x=this.pc.tf(n.Lsa(x));u.AFrameworkApplication.ya.Qf(this._context,Db.a.applyStyle,2,!1,new BD.a,x)}this.Ef.JX()}};this.gWm=n=>{this.Fvc?(this.Fvc=!1,this.validate()):"value"===n.rawEvent.propertyName&&
(this.Fvc=!0,this.aN.value!==this.Tvc&&(this.Tvc=this.aN.value,this.udh()))};this.cSm=()=>{-1!==this.Sia.selectedIndex&&(V.a.IB&&(this.Fvc=!0),this.Tvc=this.qG[this.Sia.selectedIndex],this.aN.value=this.qG[this.Sia.selectedIndex],this.validate())};this.onKeyDown=n=>{V.a.NI?n.keyCode!==db.a.dC&&n.keyCode!==db.a.K3||this.S4a||this.Xtb||(this.Xtb=new We.a(0,1,1,this.hno),u.AFrameworkApplication.uc.$b(this.Xtb)):V.a.IB&&n.keyCode===db.a.dC&&(this.Fvc=!0)};this.DF=()=>{this.S4a||(this.S4a=new We.a(0,1,
1,this.Iek),u.AFrameworkApplication.uc.$b(this.S4a));this.Xtb&&(u.AFrameworkApplication.uc.ef(this.Xtb),this.Xtb=null)};this.Iek=()=>{this.S4a=null;this.udh()};this.hno=()=>{this.Xtb=null;this.validate()};this._context=b;this.wc=h;this.kg="ApplyStylesDialog";this.Ef=this._context.view;this.zgf();b=this.r1n();h="";this.qG.length>b&&(h=this.qG[b]);h={["styleText"]:h,["styleList"]:b};this.ug=qF.ug;this.Zh(WordEditorIntl.WordEditorStrings.l_ApplyStyles,this.yck,h);this.Sia=document.getElementById("styleList");
this.IKf();this.Sia.selectedIndex=b;this.aN=document.getElementById("styleText");this.aN.focus();this.aN.select();this.mgd=this.cSm;af.a.addHandler(this.Sia,"change",this.mgd);this.lgd=this.onKeyDown;af.a.addHandler(this.aN,"keydown",this.lgd);V.a.IB?(this.Zrc=this.gWm,af.a.addHandler(this.aN,"propertychange",this.Zrc),this.Tvc=this.qG[b]):(this.Wrc=this.DF,af.a.addHandler(this.aN,"keypress",this.Wrc))}get pc(){return null!=this.srg?this.srg:this.srg=Oa.a.instance.resolve("Box4.Styles.IWACStyleReader")}r1n(){var b=
this.Ef.Cb;if(!b||!b.ib)return sd.b(579216408,3018,15,"Unable to retrieve valid SelectionCollection"),0;b=b.ib.kb;if(!b)return sd.b(579216409,3018,15,"CurrentSelection is null"),0;Cd.ParagraphReader.gm(b.Qa)&&(b=Kd.SelectionEditor.ak(b,!0,!1));b=b.Qa;if(!b||!Kd.SelectionEditor.Zt(b))return sd.b(579216410,3018,15,"Received invalid nodeContext, null={0}",!b),0;var h=Mh.FormattingReader.Ds(b);(h=Mh.FormattingReader.Nsa(h))||(h=this.pc.yo(b.node));if(!h)return 0;b=this.pc.rF(h);b=Array.indexOf(this.qG,
b);0>b&&(b=0);return b}IKf(){const b=this.qG.length;for(let h=0;h<b;h++){const n=document.createElement("OPTION");n.value=h.toString();n.text=this.qG[h];this.Sia.add(n,null)}}zgf(){var b=Hk.a.Mx();if(b){b=(new Zv.WACStyleSet).SN(b);var h=b.tN,n=this.wc.isFeatureEnabled(121)&&!!this.pc.Xg;this.qG=[];for(let x=0;x<h;x++){const E=b.ela(x);if(this.pc.isHidden(E))continue;const S=this.pc.Ow(E);if(!n){if(3===S)continue}else if(3===S&&this.pc.tf(E)===jz.a.e4c)continue;Array.add(this.qG,this.pc.rF(E))}this.qG.sort(bD.Pzk)}else sd.b(577644352,
3018,15,"Couldn't find PageContentNode")}dispose(){this.Zrc&&af.a.removeHandler(this.aN,"propertychange",this.Zrc);this.lgd&&af.a.removeHandler(this.aN,"keydown",this.lgd);this.mgd&&af.a.removeHandler(this.Sia,"change",this.mgd);this.Wrc&&af.a.removeHandler(this.aN,"keypress",this.Wrc);this.S4a&&u.AFrameworkApplication.uc.ef(this.S4a);this.S4a=this.Wrc=this.Sia=this.aN=this.lgd=this.Zrc=this.mgd=null;super.dispose()}udh(){var b=this.aN.value,h=this.WZl(b);const n=-1===h?b:this.qG[h];b=b.length;const x=
n.length;this.Tvc=n;this.aN.value=n;this.Sia.selectedIndex=h;x>b&&(V.a.NI?this.aN.setSelectionRange(b,x):V.a.IB&&(h=this.aN.createTextRange(),h.collapse(!0),h.moveStart("character",b),h.moveEnd("character",x-b),h.select()));this.validate();this.aN.focus()}WZl(b){let h=0,n=this.qG.length,x=-1;for(b=B.a.mh(b);h<n;){const E=Math.floor((h+n)/2),S=bD.XWe(b,this.qG[E]);if(!S){x=E;break}0<S?h=E+1:n=E}if(x>h)for(;!bD.XWe(b,this.qG[x-1])&&(x--,x!==h););return x}validate(){const b=-1===this.hYh(this.aN.value),
h=document.getElementById("badStyleError");b?(h.style.display="inline-block",h.innerText=WordEditorIntl.WordEditorStrings.l_BadStyleName):(h.style.display="none",h.innerText="");return!b}hYh(b){b=B.a.mh(b);const h=this.qG.length;for(let n=0;n<h;n++)if(b===B.a.mh(this.qG[n]))return n;return-1}static XWe(b,h){const n=Math.min(b.length,h.length);b=B.a.mh(b);h=B.a.mh(h);for(let x=0;x<n;x++){const E=B.a.charCodeAt(b,x),S=B.a.charCodeAt(h,x);if(E!==S)return E-S}return b.length<=h.length?0:1}static Pzk(b,
h){return bD.XWe(b,h)}}Object(r.a)(bD,"ApplyStylesDialog",Kc.a,[]);class rF{static get ug(){return Kc.a.Lx(rF.rl,WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName,WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview,WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists)}}rF.rl="<div class='normal' id='text'> <label id='NameLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <br/> <div class='normal' id='text'> <label id='ParagraphLabel' class='WACDialogLabel' >{1}</label> <div id='previewContainer' class='previewContainer' style='height: 40px; border: solid 1px #c3cbd0; position: relative; overflow: hidden;'></div> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleNameError' role='alert'>{2}</div> </div>";
Object(r.a)(rF,"CreateNewStyleDialogHtml",null,[]);class Js extends Kc.a{constructor(b,h,n=!1){super(!1,!1,n);this.mx=null;this._context=b;this.ga=h;n=h=null;this.kg=Js.id;if(this.Ef=b.view)n=this.Ef.Cb;n&&n.ib&&n.ib.kb&&(h=n.ib.kb.Qa);h?(b=h.node)?(this.oz=Js.oh.gu(b))?(this.xC=(new Zv.WACStyleSet).SN(this.oz),(this.KR=this.E9e.eBd(h))?(b=this.KR.ia(ie.a.fontSize,22),16>b?sd.b(593078050,3018,50,"Font size less than 8pt in create new style dialog preview"):52>=b?sd.b(593078049,3018,50,"Font size between 8pt and 26pt in create new style dialog preview"):
90>=b?sd.b(593078048,3018,50,"Font size between 26pt and 45 pt in create new style dialog preview"):sd.b(593078047,3018,50,"Font size more than 45pt in create new style dialog preview"),this.bRf(this.KR)):sd.b(592737758,3018,10,"_newStyleProperties is null.")):sd.b(592737757,3018,10,"_pageContenNode is null."):sd.b(592725466,3018,10,"node is null."):sd.b(556917206,3018,10,"nodeContext is null.")}bRf(b){b.Qg(Th.a.paragraphStyle,Th.a.kB,...jo.a.PG())}get E9e(){return this.mx||(this.mx=Oa.a.instance.resolve("Box4.IFormattingReader"))}get pc(){return null!=
this.zrg?this.zrg:this.zrg=Oa.a.instance.resolve("Box4.Styles.IWACStyleReader")}uef(b){if(!b)return"";const h=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogDefaultStyle,n=b.tN;let x;for(x=1;x<=n;x++){const E=h+x;let S=b.uh(E)||b.f3b(E);S||(S=b.uh(E+"Char")||b.f3b(E+"Char"));if(!S)break}return h+x}Bxc(b,h){const n=new Se.GraphTransaction(15);n.Db(this.oz);n.zl=Db.a.createNewStyle;if(h=Hk.a.Bxc(b,Hk.a.OVh(h),null,this.oz))sd.b(593078046,3018,50,"User created linked style"),this.xC=(new Zv.WACStyleSet).SN(this.oz),
b=B.a.Uua(B.a.vZ(b)),b=this.xC.f3b(b),this.ga.Qf(this._context,Db.a.applyStyle,2,!1,new BD.a,this.pc.tf(b));n.dispose();return h}Pij(b){var h=B.a.Uua(b);const n=""===B.a.Uua(b),x=b.length>Js.HDm,E=RegExp("[{|}|;|\\\\]").test(b);b=!!this.xC.Lsa(b)||!!this.xC.f3b(h);h=null;if(n||x||E||b)h=n?WordEditorIntl.WordEditorStrings.l_StyleNameEmpty:x?WordEditorIntl.WordEditorStrings.l_StyleNameOverMaxLength:E?WordEditorIntl.WordEditorStrings.l_StyleNameRestrictedCharacters:WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists;
return h}static get oh(){return ql.PageNavigator.instance}}Js.id="CreateNewStyleDialog";Js.jTd=26;Js.HDm=253;Js.l7i=5;Js.k7i=40;Object(r.a)(Js,"ACreateNewStyleDialog",Kc.a,[]);class tJ extends Js{constructor(b,h){super(b,h);this.BJk=n=>{this.Ef.Nr&&(n&&(n=new Map,n.set("Source","CreateNewStyleDialog"),n.set("Action","CreateStyle"),ta.Health.instance.recordKpiUsage(jo.a.omb,0,jo.a.vB,n),this.Bxc(this.aN.value,this.KR)||(n=new Map,n.set("Source","CreateNewStyleDialog"),n.set("Action","CreateStyle"),
n=Object.assign(new ab.a,{extendedProperties:n}),ta.Health.instance.recordKpiFailure(jo.a.omb,"CreateStyleFailed",!1,!0,n))),this.Ef.JX())};this.oz&&this.KR&&(b=this.uef(this.xC),h={["styleText"]:b},this.ug=rF.ug,this.Zh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.BJk,h),this.aN=document.getElementById("styleText"),this.mU(this.aN),h=document.getElementById("previewContainer"),this.OMn(this.KR,b,h),this.Q9c=document.getElementById("badStyleNameError"))}iml(b){const h=b.ia(ie.a.fontSize,
Zl.a.IJ)>=2*Js.jTd;b=Nt.a.BNh(b,"97%",Js.jTd,!1,!0,h)+" padding-left: "+Js.l7i+"px;";h||(b=b+" line-height: "+Js.k7i+"px;");return b}OMn(b,h,n){const x=document.createElement("div");x.innerText=h;b=this.iml(b);x.setAttribute("style",b);n.appendChild(x)}validate(){const b=this.Pij(this.aN.value),h=!!b;h?(this.Q9c.style.display="inline-block",this.Q9c.innerText=b):(this.Q9c.style.display="none",this.Q9c.innerText="");return!h}}Object(r.a)(tJ,"CreateNewStyleDialog",Js,[]);var cD=d(344);class uJ extends yd.StandardDialog{constructor(b){super();
this.Qu=b;this.yUn()}yUn(){this.Ed=1;this.lU(1);this.We(1,"Delete Saved Styles");this.Lv("Are you sure?",String.format("Future document will be reset to Word Default Styles. Also any custom styles will not be available for future documents. There will be no changes in current document."),1,this.L1e.bind(this))}L1e(b){1===b&&this.Qu.zga("saveWordUserPreferenceSaveStyleSetting","{}").continueWith(h=>{h.Ii?sd.b(524834400,3018,10,"DeleteSavedSytles: Task Faulted.Exception:{0} Stack:{1}",h.exception,h.exception.stack):
(this.Zun(),sd.b(524834399,3018,50,"User deleted saved styles via UI."))},8)}Zun(){cD.a.$lb="{}"}}Object(r.a)(uJ,"DeleteSavedStylesConfirmationDialog",yd.StandardDialog,[]);class vJ extends yd.StandardDialog{constructor(b,h){super();this.L1e=E=>{if(1===E){E=new Map;E.set("Source","DeleteStyleConfirmationDialog");E.set("Action","DeleteStyle");ta.Health.instance.recordKpiUsage(jo.a.omb,0,jo.a.vB,E);var S=Hk.a.Mx();E=new Se.GraphTransaction(15);E.Db(S);E.zl=Db.a.Hxb;this.ZQ.FQk(this.i0g)?sd.b(578359694,
3018,50,"User deleted a style via UI."):(S=new Map,S.set("Source","DeleteStyleConfirmationDialog"),S.set("Action","DeleteStyle"),S=Object.assign(new ab.a,{extendedProperties:S}),ta.Health.instance.recordKpiFailure(jo.a.omb,"DeleteStyleFailed",!1,!0,S),sd.b(578359695,3018,50,"User tried to delete a style via UI, but we were unable to delete it."));E.dispose()}};h||sd.b(590128417,3018,10,"styleId is null");let n=null,x=null;if(this.Ef=b.view)x=this.Ef.Cb;x&&(n=x.ib.kb.Qa);n?(b=n.node)?(this.oz=this.oh.gu(b))?
(this.i0g=new Qa.a,this.i0g.add(h),this.zUn(h)):sd.b(590128448,3018,10,"_pageContenNode is null."):sd.b(590128419,3018,10,"node is null."):sd.b(590128418,3018,10,"nodeContext is null.")}get ZQ(){return null!=this.grg?this.grg:this.grg=Oa.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get pc(){return null!=this.Brg?this.Brg:this.Brg=Oa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get oh(){return null!=this.Bng?this.Bng:this.Bng=ql.PageNavigator.instance}zUn(b){const h=(new Zv.WACStyleSet).SN(this.oz);
h?((b=h.uh(b))||sd.b(590128450,3018,10,"Style set doesn't contain style with given ID"),b=this.pc.rF(b),this.Ed=4,this.lU(2),this.Lv(CommonUIStrings.l_DefaultDialogTitle,String.format(WordEditorIntl.WordEditorStrings.l_DeleteStyleConfirmationDialogMessage,b),0,this.L1e)):sd.b(590128449,3018,10,"Can't retrieve style set from page content node")}}Object(r.a)(vJ,"DeleteStyleConfirmationDialog",yd.StandardDialog,[]);class sF{static get ug(){return Kc.a.Lx(sF.rl)}}sF.rl="<div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div>";
Object(r.a)(sF,"DeleteStyleDialogHtml",null,[]);class wJ extends Kc.a{constructor(b){super();this.oz=this.qG=null;this.mRk=(h,n)=>{this.Ef.Nr&&(h?(h=n.styleList,-1!==h&&(h=this.qG[h],n=this.pc.Ip(),h=this.pc.tf(n.Lsa(h)),this.i2e.lRk(this._context,h),this.Ef.JX())):this.Ef.JX())};this._context=b;this.kg="DeleteStyleDialog";this.Ed=1;this.We(1,WordEditorIntl.WordEditorStrings.l_DeleteStyleDialogButton);this.Ef=this._context.view;this.zgf();this.ug=sF.ug;this.Zh(WordEditorIntl.WordEditorStrings.l_DeleteStyle,
this.mRk,{["styleList"]:0});this.Sia=document.getElementById("styleList");this.IKf();this.Sia.selectedIndex=0;this.Sia.focus()}get pc(){return null!=this.urg?this.urg:this.urg=Oa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get i2e(){return null!=this.Kgg?this.Kgg:this.Kgg=Oa.a.instance.resolve("WordEditor.UI.IDialogFactory")}IKf(){const b=this.qG.length;for(let h=0;h<b;h++){const n=document.createElement("OPTION");n.value=h.toString();n.text=this.qG[h];this.Sia.add(n,null)}}zgf(){if(this.oz=
Hk.a.Mx()){var b=(new Zv.WACStyleSet).SN(this.oz),h=b.tN;this.qG=[];for(let x=0;x<h;x++){const E=b.ela(x);if(!this.pc.isHidden(E)&&this.pc.me(E,b)){var n=this.pc.Ow(E);if(2===n||1===n)E.hasProperty(ic.a.Gc)&&2!==n||(n=E.ia(ic.a.ZE,null))&&0<n.length||this.qG.push(this.pc.rF(E))}}this.qG.sort()}else sd.b(578650370,3018,15,"PageContentNode is null")}}Object(r.a)(wJ,"DeleteStyleDialog",Kc.a,[]);var lP=d(755);class xJ{constructor(b){this.customData=null;this.IN=b}}Object(r.a)(xJ,"PropertySetChangedState",
null,[]);class yJ{static A7m(b,h,n){if(b&&h){var x=new xJ(h),E=(S,ma,Fa)=>{n.z7m(S,ma,Fa,x)};b=new lP.a(h,b);b.nqd=E;b.ltd=E;b.E2d=E;b.Eac()}}}Object(r.a)(yJ,"PropertySetChangedManager",null,[]);class zJ{constructor(b){this.EY=b}z7m(b,h,n,x){const E=this.EY[b.id.toString()];E&&E(b,h,n,x)}}Object(r.a)(zJ,"PropertyChangedProcessor",null,[]);const dD=(b,h,n)=>{const x=Pq.a.instance.Z0b;if(x){const E=new Se.GraphTransaction(15);E.Db(x);yJ.A7m(b,h,new zJ(n));E.dispose()}};class tF{static get ug(){return Kc.a.Lx(tF.rl,
WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTop,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeft,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottom,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRight)}}tF.rl="<div class='WACDialogRow' id='RowMargins'> <div class='WACDialogGroupBox' id='MarginsDialogTopLeftBox'> <div class='WacDialogLabels' id='MarginsDialogTopLeftLabels'> <label id='MarginsDialogMarginTop' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='MarginsDialogMarginLeft' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogTopLeftSpinners'> <div id='MarginsDialogMarginTopSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginLeftSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> <div class='WACDialogGroupBox MarginsDialogRightChunk' id='MarginsDialogBottomRightBox'> <div class='WacDialogLabels' id='MarginsDialogBottomRightLabels'> <label id='MarginsDialogMarginBottom' class='DialogSpinnerLabel' >{2}</label> <br/> <label id='MarginsDialogMarginRight' class='DialogSpinnerLabel' >{3}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogBottomRightSpinners'> <div id='MarginsDialogMarginBottomSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginRightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> </div>";
Object(r.a)(tF,"MarginsDialogHtml",null,[]);class Lp{static get YZ(){return null!=Lp.ong?Lp.ong:Lp.ong=Oa.a.instance.Pa("WordEditor.IPageCommands")}static yCm(b,h,n){Lp.YZ&&null!==n&&Lp.YZ.L5d(0,n)}static uCm(b,h,n){Lp.YZ&&null!==n&&Lp.YZ.L5d(3,n)}static wCm(b,h,n){Lp.YZ&&null!==n&&Lp.YZ.L5d(1,n)}static xCm(b,h,n){Lp.YZ&&null!==n&&Lp.YZ.L5d(2,n)}static n_m(b,h,n){Lp.YZ&&null!==n&&Lp.YZ.bPa(0,n)}static PZm(b,h,n){Lp.YZ&&null!==n&&Lp.YZ.bPa(1,n)}static Oxk(b,h,n){Lp.YZ&&null!==n&&Lp.YZ.hWf(0,n)}static $xk(b,
h,n){Lp.YZ&&null!==n&&Lp.YZ.hWf(1,n)}static Yxk(b,h,n){Lp.YZ&&null!==n&&Lp.YZ.hWf(2,n)}}Object(r.a)(Lp,"PageLevelPropertyChangedHandlers",null,[]);class Gu extends Kc.a{constructor(b,h,n,x,E,S){super();this.kgb=S;this.ssa=(ma,Fa)=>{var $a=Gu.Jib(ma);ma=ob.App.caa;this.Ce.hasProperty($a)?($a=this.Ce.getValue($a),Fa[rc.a.Number]=Jf.a.xba($a,ma)):Fa[rc.a.Number]=0;Fa[rc.a.UnitType]=ma};this.hva=(ma,Fa)=>{this.Ce.setValue(Gu.Jib(ma),Jf.a.dQa(Fa[rc.a.Number],Fa[rc.a.UnitType]));this.hp.xl()};this.ACm=
ma=>{let Fa=!1;1===ma&&(Math.abs(this.Ce.getValue(ic.a.marginTop))+Math.abs(this.Ce.getValue(ic.a.marginBottom))+ob.App.Zva<=this.WK.getValue(ic.a.Xx)&&this.Ce.getValue(ic.a.marginLeft)+this.Ce.getValue(ic.a.marginRight)+ob.App.Zva<=this.WK.getValue(ic.a.Ko)?dD(this.SM,this.Ce,Gu.eYa()):Fa=!0);this.dispose();Fa&&this.jva(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage,this.vCm)};this.vCm=()=>{Oa.a.instance.resolve("WordEditor.UI.IDialogFactory").Fsh(this.SM,this.WK,this.NO)};this.kg="MarginsDialog";
this.WK=h.clone();this.SM=b.clone();this.Ce=b.clone();this.NO=n;this.sR=!1;this.hp=E;this.ug=tF.ug;n&&(this.Ynb=Aj.a.o3a);this.Zh(WordEditorIntl.WordEditorStrings.L_PageMargins,this.ACm,null);this.GBb();this.kgb&&(this.XGe=document.getElementById("DialogMarginTopSpinner"),this.mU(this.XGe))}UT(){this.ksd("MarginsDialogMarginTopSpinnerContainer","DialogMarginTopSpinner",ub.a.jTc,ub.a.d0d,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTopAlt);this.ksd("MarginsDialogMarginBottomSpinnerContainer",
"DialogMarginBottomSpinner",ub.a.iTc,ub.a.a0d,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottomAlt);this.ksd("MarginsDialogMarginLeftSpinnerContainer","DialogMarginLeftSpinner",ub.a.RXd,ub.a.b0d,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeftAlt);this.ksd("MarginsDialogMarginRightSpinnerContainer","DialogMarginRightSpinner",ub.a.SXd,ub.a.c0d,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRightAlt)}GBb(){for(let b=0;b<Gu.v7.length;b++)ah.a.sja(Gu.v7[b],this.hva,this.ssa);
this.hp.aM("DialogMarginTopSpinner");this.hp.aM("DialogMarginBottomSpinner");this.hp.aM("DialogMarginLeftSpinner");this.hp.aM("DialogMarginRightSpinner")}dispose(){for(let b=0;b<Gu.v7.length;b++)ah.a.Qra(Gu.v7[b]);this.hp.IA("DialogMarginTopSpinner");this.hp.IA("DialogMarginBottomSpinner");this.hp.IA("DialogMarginLeftSpinner");this.hp.IA("DialogMarginRightSpinner");super.dispose()}ksd(b,h,n,x,E){n=Gu.Akk(h,n,x,E);this.eVa(n,b,h)}eVa(b,h,n){h=document.getElementById(h);this.hp.rya(n,b);b=this.hp.EXa(n,
"Medium");h.appendChild(b)}static eYa(){return Gu.EY||(Gu.EY=Gu.OJa())}static OJa(){const b={};b[ic.a.marginTop.id.toString()]=Lp.yCm;b[ic.a.marginBottom.id.toString()]=Lp.uCm;b[ic.a.marginLeft.id.toString()]=Lp.wCm;b[ic.a.marginRight.id.toString()]=Lp.xCm;return b}static Akk(b,h,n,x){let E=!0;if(h===ub.a.jTc||h===ub.a.iTc)E=!1;return xf.l(b,h,n,x,[Gu.Ckk(E),Gu.Bkk(E)])}static Ckk(b){return xf.n("inch",b?"0":"-22","22",".1")}static Bkk(b){return xf.n("centimeter",b?"0":"-55.8","55.8","1")}static Jib(b){let h=
null;switch(b){case ub.a.jTc:case ub.a.d0d:h=ic.a.marginTop;break;case ub.a.iTc:case ub.a.a0d:h=ic.a.marginBottom;break;case ub.a.RXd:case ub.a.b0d:h=ic.a.marginLeft;break;case ub.a.SXd:case ub.a.c0d:h=ic.a.marginRight}return h}}Gu.v7=[ub.a.jTc,ub.a.iTc,ub.a.RXd,ub.a.SXd,ub.a.d0d,ub.a.a0d,ub.a.b0d,ub.a.c0d];Gu.EY=null;Object(r.a)(Gu,"MarginsDialog",Kc.a,[]);class uF{static get ug(){return Kc.a.Lx(uF.rl,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidth,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeight)}}
uF.rl="<div class='WACDialogRow' id='RowPapeSize'> <div class='WacDialogLabels' id='PaperSizeDialogLabels'> <label id='PaperSizeDialogWidth' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='PaperSizeDialogHeight' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='PaperSizeDialogSpinners'> <div id='PaperSizeDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='PaperSizeDialogHeightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(r.a)(uF,"PaperSizeDialogHtml",null,[]);class cr extends Kc.a{constructor(b,h,n,x,E,S){super();this.kgb=S;this.ssa=(ma,Fa)=>{var $a=this.Jib(ma);ma=ob.App.caa;this.Ce.hasProperty($a)?($a=this.Ce.getValue($a),Fa[rc.a.Number]=Jf.a.xba($a,ma)):Fa[rc.a.Number]=0;Fa[rc.a.UnitType]=ma};this.hva=(ma,Fa)=>{this.Ce.setValue(this.Jib(ma),Jf.a.dQa(Fa[rc.a.Number],Fa[rc.a.UnitType]));this.hp.xl()};this.x_m=ma=>{let Fa=!1;1===ma&&(this.Ce.getValue(ic.a.Xx)>=ob.App.Zva+this.WK.getValue(ic.a.marginTop)+this.WK.getValue(ic.a.marginBottom)&&
this.Ce.getValue(ic.a.Ko)>=ob.App.Zva+this.WK.getValue(ic.a.marginLeft)+this.WK.getValue(ic.a.marginRight)?dD(this.SM,this.Ce,cr.eYa()):Fa=!0);this.dispose();Fa&&this.jva(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage,this.w_m)};this.w_m=()=>{Oa.a.instance.resolve("WordEditor.UI.IDialogFactory").jth(this.SM,this.WK,this.NO)};this.kg="PaperSizeDialog";this.WK=h.clone();this.SM=b.clone();this.Ce=b.clone();this.NO=n;this.sR=!1;this.hp=E;this.ug=uF.ug;n&&(this.Ynb=Aj.a.o3a);this.Zh(WordEditorIntl.WordEditorStrings.l_PaperSizeDialogTitle,
this.x_m,null);this.GBb();this.kgb&&(this.XGe=document.getElementById("DialogWidthSpinner"),this.mU(this.XGe))}UT(){this.Zfh("PaperSizeDialogWidthSpinnerContainer","DialogWidthSpinner",ub.a.VXd,ub.a.s0d,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidthAlt);this.Zfh("PaperSizeDialogHeightSpinnerContainer","DialogHeightSpinner",ub.a.UXd,ub.a.r0d,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeightAlt)}GBb(){for(let b=0;b<cr.v7.length;b++)ah.a.sja(cr.v7[b],this.hva,this.ssa);this.hp.aM("DialogWidthSpinner");
this.hp.aM("DialogHeightSpinner")}dispose(){for(let b=0;b<cr.v7.length;b++)ah.a.Qra(cr.v7[b]);this.hp.IA("DialogWidthSpinner");this.hp.IA("DialogHeightSpinner");super.dispose()}Zfh(b,h,n,x,E){n=cr.Rkk(h,n,x,E);this.eVa(n,b,h)}eVa(b,h,n){h=document.getElementById(h);this.hp.rya(n,b);b=this.hp.EXa(n,"Medium");h.appendChild(b)}Jib(b){let h=null;switch(b){case ub.a.UXd:case ub.a.r0d:h=ic.a.Xx;break;case ub.a.VXd:case ub.a.s0d:h=ic.a.Ko}return h}static eYa(){return cr.EY||(cr.EY=cr.OJa())}static OJa(){const b=
{};b[ic.a.Ko.id.toString()]=Lp.n_m;b[ic.a.Xx.id.toString()]=Lp.PZm;return b}static Rkk(b,h,n,x){return xf.l(b,h,n,x,[cr.Tkk(),cr.Skk()])}static Tkk(){return xf.n("inch",cr.J4i,cr.Anm,cr.bYn)}static Skk(){return xf.n("centimeter",cr.J4i,cr.ynm,cr.aYn)}}cr.v7=[ub.a.VXd,ub.a.UXd,ub.a.s0d,ub.a.r0d];cr.J4i="0";cr.Anm="22";cr.bYn=".1";cr.aYn="1";cr.ynm="55.8";cr.EY=null;Object(r.a)(cr,"PaperSizeDialog",Kc.a,[]);class AJ{constructor(){this.c5i=this.yBi=this.xBi=this.D_m=this.LIf=!1}}Object(r.a)(AJ,"Box4PropertySetChangedState",
null,[]);class ik{static get F4b(){return null!=ik.Njg?ik.Njg:ik.Njg=Oa.a.instance.Pa("Box4.IIndentationCommands")}static get Khi(){return null!=ik.Klg?ik.Klg:ik.Klg=Oa.a.instance.Pa("Box4.IJustificationCommands")}static get FX(){return null!=ik.Tog?ik.Tog:ik.Tog=Oa.a.instance.Pa("Box4.ISpacingCommands")}static Jhi(b,h,n){ik.Khi&&n&&(null===h||11!==n||10!==h&&9!==h)&&ik.Khi.lD(n)}static sji(b,h,n){ik.FX&&n&&ik.FX.$B(n)}static MCk(b,h,n){h!=n&&ik.FX.jdc(n)}static Nmm(b,h,n){h!=n&&ik.FX.wZc(n)}static hpo(b,
h,n){h!=n&&ik.FX.YZc(n)}static Lmm(b,h,n){h!=n&&ik.FX.vZc(n)}static HYd(b,h,n,x){ik.FX&&void 0!==n&&null!==n&&(b=ik.GGc(x),!b.LIf&&x.IN.hasProperty(ad.a.YCa)&&x.IN.hasProperty(ad.a.ZCa)&&(h=x.IN.getValue(ad.a.ZCa),x=x.IN.getValue(ad.a.YCa),b.LIf=!0,ik.FX.vga(1,h,x)))}static GYd(b,h,n,x){ik.FX&&void 0!==n&&null!==n&&(b=ik.GGc(x),!b.D_m&&x.IN.hasProperty(ad.a.WCa)&&x.IN.hasProperty(ad.a.XCa)&&(h=x.IN.getValue(ad.a.XCa),x=x.IN.getValue(ad.a.WCa),b.LIf=!0,ik.FX.vga(0,h,x)))}static DYd(b,h,n,x){ik.F4b&&
void 0!==n&&null!==n&&(b=ik.GGc(x),!b.xBi&&x.IN.hasProperty(ad.a.xaa)&&x.IN.hasProperty(ad.a.yaa)&&(h=x.IN.getValue(ad.a.yaa),x=x.IN.getValue(ad.a.xaa),b.xBi=!0,ik.F4b.KYi(1,h,x)))}static EYd(b,h,n,x){ik.F4b&&void 0!==n&&null!==n&&(b=ik.GGc(x),!b.yBi&&x.IN.hasProperty(ad.a.wua)&&x.IN.hasProperty(ad.a.xua)&&(h=x.IN.getValue(ad.a.xua),x=x.IN.getValue(ad.a.wua),b.yBi=!0,ik.F4b.KYi(0,h,x)))}static Aec(b,h,n,x){ik.F4b&&void 0!==n&&null!==n&&(b=ik.GGc(x),!b.c5i&&x.IN.hasProperty(ad.a.aba)&&x.IN.hasProperty(ad.a.q_)&&
(h=0,x.IN.hasProperty(ad.a.LI)&&(h=x.IN.getValue(ad.a.LI)),n=x.IN.getValue(ad.a.q_),x=x.IN.getValue(ad.a.aba),b.c5i=!0,ik.F4b.b6d(h,n,x)))}static GGc(b){b.customData||(b.customData=new AJ);return b.customData}}Object(r.a)(ik,"ParagraphLevelPropertyChangedHandlers",null,[]);class mi extends Kc.a{constructor(b,h,n,x,E,S){super();this.HK=this.P$c=!1;this.kg="ParagraphDialog";mi.FX=n;this.dw=S;this.SM=b.clone();this.Ce=b.clone();if(this.NO=h)this.Ynb=Aj.a.o3a}UT(){mi.$fh(mi.hZn,mi.j5i,Db.a.A$b,Db.a.$ac,
Db.a.H2a,Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,this.dw);mi.$fh(mi.gZn,mi.i5i,Db.a.WXd,Db.a.D0d,Db.a.e0c,Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,this.dw);mi.ukk(mi.fZn,mi.y0f,this.dw);mi.xkk(mi.Apm,mi.JQd,this.dw)}Tlf(){for(let b=0;b<mi.g8d.length;b++)ah.a.sja(mi.g8d[b],Object(v.a)(this,this.hva,"setAdvancedControlValue"),Object(v.a)(this,this.ssa,"getAdvancedControlValue"));ah.a.sja(Db.a.x0a,Object(v.a)(this,this.Njb,"setDropDownValue"),Object(v.a)(this,this.Kib,"provideDropDownValue"));
ah.a.sja(Db.a.xVc,Object(v.a)(this,this.Njb,"setDropDownValue"),Object(v.a)(this,this.Kib,"provideDropDownValue"));this.dw.xl()}dispose(){if(!this.HK){for(let b=0;b<mi.g8d.length;b++)ah.a.Qra(mi.g8d[b]);ah.a.Qra(Db.a.x0a);ah.a.Qra(Db.a.xVc);this.dw.IA(mi.j5i);this.dw.IA(mi.i5i);this.dw.IA(mi.y0f);this.dw.IA(mi.JQd);super.dispose();this.HK=!0}}ssa(b,h){switch(b){case Db.a.$ac:case Db.a.D0d:var n=b===Db.a.$ac?ad.a.ZCa:ad.a.XCa;b=b===Db.a.$ac?ad.a.YCa:ad.a.WCa;this.Ce.hasProperty(n)&&this.Ce.hasProperty(b)?
(b=this.Ce.getValue(b),1===b?(h[rc.a.Text]=Box4Intl.Box4Strings.L_SpinnerAuto,h[rc.a.Number]=Number.NaN,h[rc.a.UnitType]=5):(n=this.Ce.getValue(n),b=2===b?4:5,h[rc.a.Number]=n,h[rc.a.UnitType]=b)):(h[rc.a.Text]="",h[rc.a.Number]=Number.NaN,h[rc.a.UnitType]=ob.App.r6?4:5);break;case Db.a.$_d:n=!1,this.Ce.hasProperty(ad.a.ta)&&this.Ce.hasProperty(ad.a.KZ)&&2===this.Ce.getValue(ad.a.KZ)&&(this.Cci()||this.P$c)&&(b=mi.JT.eLa(this.Ce),b>=mi.Nyf&&(h[rc.a.Number]=b,n=!0)),n||(h[rc.a.Text]="",h[rc.a.Number]=
Number.NaN),h[rc.a.UnitType]=0}}hva(b,h){var n=h[rc.a.Text],x=h[rc.a.Number],E=h[rc.a.UnitType];switch(b){case Db.a.A$b:case Db.a.WXd:n===Box4Intl.Box4Strings.L_SpinnerAuto?(n=0,x=1):(n=x,x=4===E?2:4);h=b===Db.a.A$b?ad.a.YCa:ad.a.WCa;this.Ce.setValue(b===Db.a.A$b?ad.a.ZCa:ad.a.XCa,n);this.Ce.setValue(h,x);break;case Db.a.H2a:case Db.a.e0c:E=b===Db.a.H2a?ad.a.ZCa:ad.a.XCa;b=b===Db.a.H2a?ad.a.YCa:ad.a.WCa;h=h.Increment;""===n||h&&n===Box4Intl.Box4Strings.L_SpinnerAuto?(this.Ce.setValue(E,0),this.Ce.setValue(b,
4)):x||h||(this.Ce.setValue(E,0),this.Ce.setValue(b,1));break;case Db.a.QXd:this.hYi(x);break;case Db.a.p8d:""===n&&this.hYi(mi.Nyf)}this.dw.xl()}hYi(b){this.Ce.setValue(ad.a.KZ,2);this.Ce.setValue(ad.a.ta,mi.JT.Gdf(b));this.P$c=!0;this.dw.aM(mi.JQd)}Kib(b,h){switch(b){case Db.a.xVc:this.g$m(h)}}g$m(b){let h=0;var n=!1;this.Ce.hasProperty(ad.a.ta)&&this.Ce.hasProperty(ad.a.KZ)||(n=!0);n||(2!==this.Ce.getValue(ad.a.KZ)&&(n=!0),h=mi.JT.eLa(this.Ce),h<mi.Nyf&&(n=!0));n||(n=mi.cvf,this.P$c||this.Cci()||
(Ub.a.DZ(h,1)?n="1.00":Ub.a.DZ(h,1.5)?n="1.50":Ub.a.DZ(h,2)&&(n="2.00")),b[yi.a.SelectedItemId]=n)}Njb(b,h){switch(b){case Db.a.x0a:this.MGn(h)}}MGn(b){b=b.MenuItemId;b===mi.cvf?(this.Ce.setValue(ad.a.KZ,2),this.Ce.setValue(ad.a.ta,mi.JT.Gdf(3))):(b=parseFloat(b),this.Ce.setValue(ad.a.KZ,2),this.Ce.setValue(ad.a.ta,mi.JT.Gdf(b)));this.P$c=!1;this.dw.aM(mi.JQd);this.dw.aM(mi.y0f)}MYd(b){1===b&&dD(this.SM,this.Ce,mi.eYa());this.dispose()}LYd(){const b=Oa.a.instance.resolve("Box4.UI.IBox4DialogFactory"),
h=Oa.a.instance.resolve("WordEditor.ClientPagination.IClientPaginationSettings");b.HZb(this.SM,null,this.NO,h)}Cci(){if(!this.Ce.hasProperty(ad.a.ta)||!this.Ce.hasProperty(ad.a.KZ)||2!==this.Ce.getValue(ad.a.KZ))return!1;const b=mi.JT.eLa(this.Ce);return!Ub.a.DZ(b,1)&&!Ub.a.DZ(b,1.5)&&!Ub.a.DZ(b,2)}static get JT(){return null!=mi.Ulg?mi.Ulg:mi.Ulg=Oa.a.instance.resolve("Box4.ILineSpacingHelper")}static eYa(){return mi.EY||(mi.EY=mi.OJa())}static OJa(){const b={};b[ad.a.ta.id.toString()]=ik.sji;b[ad.a.XCa.id.toString()]=
ik.GYd;b[ad.a.WCa.id.toString()]=ik.GYd;b[ad.a.ZCa.id.toString()]=ik.HYd;b[ad.a.YCa.id.toString()]=ik.HYd;return b}static $fh(b,h,n,x,E,S,ma){n=mi.Vkk(h,n,x,E,S);mi.ovb(n,b,h,ma)}static ukk(b,h,n){const x=mi.vkk(h);mi.ovb(x,b,h,n)}static xkk(b,h,n){const x=mi.ykk(h);mi.ovb(x,b,h,n)}static ovb(b,h,n,x){h=document.getElementById(h);x.rya(n,b);b=x.EXa(n,"Medium");h.appendChild(b)}static Vkk(b,h,n,x,E){return xf.l(b,h,n,E,[mi.nlk(),mi.mlk()],[Box4Intl.Box4Strings.L_SpinnerAuto],x,mi.t8d)}static vkk(b){return xf.l(b,
Db.a.QXd,Db.a.$_d,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,[mi.wkk()],null,Db.a.p8d,mi.t8d)}static wkk(){return xf.n("none","1","132",".5")}static nlk(){return xf.n("point","0","1584","1")}static mlk(){return xf.n("line","0","327","1")}static ykk(b){const h=xf.e("DdlLineSpacing_Single","1.00",Db.a.x0a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle),n=xf.e("DdlLineSpacing_1.5","1.50",Db.a.x0a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf),
x=xf.e("DdlLineSpacing_Double","2.00",Db.a.x0a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble),E=xf.e("DdlLineSpacing_Multiple",mi.cvf,Db.a.x0a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple);return xf.k(b,Db.a.x0a,Db.a.xVc,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,mi.Bpm,[h,n,x,E])}}mi.Bpm=150;mi.t8d=70;mi.Nyf=1;mi.j5i="DialogSpacingBeforeSpinner";mi.i5i="DialogSpacingAfterSpinner";mi.y0f="DialogLineSpacingAtSpinner";mi.hZn="ParagraphDialogSpacingBeforeSpinnerContainer";
mi.gZn="ParagraphDialogSpacingAfterSpinnerContainer";mi.fZn="ParagraphDialogLineSpacingAtSpinnerContainer";mi.Apm="ParagraphDialogLineSpacingContainer";mi.JQd="ParagraphDialogLineSpacingSelect";mi.cvf="multiple";mi.g8d=[Db.a.A$b,Db.a.WXd,Db.a.QXd,Db.a.$ac,Db.a.D0d,Db.a.$_d,Db.a.p8d,Db.a.e0c,Db.a.H2a];mi.FX=null;mi.EY=null;Object(r.a)(mi,"ParagraphDialog",Kc.a,[]);class vF{static get ug(){return Kc.a.Lx(vF.rl,Box4Intl.Box4Strings.l_ParagraphDialogGeneral,Box4Intl.Box4Strings.l_ParagraphDialogAlignment,
Box4Intl.Box4Strings.l_ParagraphDialogIndentation,Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,Box4Intl.Box4Strings.l_ParagraphDialogSpacing,Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy)}}
vF.rl="<div class='WACDialogGroupBox ParagraphDialogLeftChunk' id='LeftChunk'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> <div class='ParagraphDialogContentArea' id='ParagraphDialogGeneralRow'> <div class='WACDialogGroupBox' id='GeneralLabelBox'> <table cellpadding=5 cellspacing=5 role='presentation'> <tr role='presentation'> <td> <label id='Alignment' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogAlignmentContainer' >{1}</label> </td> <td> <div id='ParagraphDialogAlignmentContainer' class='WacSpinnerBox' aria-labelledby='Alignment' role='presentation'></div> </td> </tr> </table> <div class='WACDialogRow' id='ParagraphDialogIndentationRow'> <div class='WACDialogSectionTitle UIFontBold'>{2}</div> </div> <div class='WACDialogGroupBox ParagraphDialogContentArea' id='InnerRowIndentationLabels'> <table cellpadding=5 cellspacing=5 role='presentation'> <tr role='presentation'> <td> <label id='ParagraphDialogIndentationLeft' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogIndentLeftSpinnerContainer' >{3}</label> </td> <td> <div id='ParagraphDialogIndentLeftSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogIndentationLeft' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogIndentationRight' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogIndentRightSpinnerContainer' >{4}</label> </td> <td> <div id='ParagraphDialogIndentRightSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogIndentationRight' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogSpecialIndent' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpecialIndentContainer' >{10}</label> </td> <td> <div id='ParagraphDialogSpecialIndentContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpecialIndent' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogSpecialIndentBy' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpecialIndentBySpinnerContainer' >{11}</label> </td> <td> <div id='ParagraphDialogSpecialIndentBySpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpecialIndentBy' role='presentation'></div> </td> </tr> </table> </div> </div> </div> </div> <div class='WACDialogGroupBox ParagraphDialogRightChunk' id='RightChunk'> <div class='WACDialogSectionTitle UIFontBold'>{5}</div> <div class='ParagraphDialogContentArea' id='InnerRowSpacing'> <div class='WACDialogGroupBox' id='SpacingLabelBox'> <table cellpadding=5 cellspacing=5 role='presentation'> <tr> <td> <label id='ParagraphDialogSpacingBefore' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpacingBeforeSpinnerContainer' >{6}</label> </td> <td> <div id='ParagraphDialogSpacingBeforeSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpacingBefore' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogSpacingAfter' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpacingAfterSpinnerContainer' >{7}</label> </td> <td> <div id='ParagraphDialogSpacingAfterSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpacingAfter' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogLineSpacing' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogLineSpacingContainer' >{8}</label> </td> <td> <div id='ParagraphDialogLineSpacingContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogLineSpacing' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogLineSpacingAt' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogLineSpacingAtSpinnerContainer' >{9}</label> </td> <td> <div id='ParagraphDialogLineSpacingAtSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogLineSpacingAt' role='presentation'></div> </td> </tr> </table> </div> </div> </div>";
Object(r.a)(vF,"ParagraphDialogHtml",null,[]);const RG=b=>1===b||2===b||3===b||6===b||10===b||11===b||9===b||7===b||13===b,SG=(b,h,n,x)=>{let E=ob.App.caa;b.hasProperty(h)&&b.hasProperty(n)&&!x?(h=b.getValue(h),b=b.getValue(n),h?2===b?E=2:h=Jf.a.xba(h,E):ob.App.r6&&(E=2)):(h=Number.NaN,ob.App.r6&&(E=2));return{zec:h,z3a:E}},mP=b=>{let h="0";b.hasProperty(ad.a.LI)&&(b=b.getValue(ad.a.LI),(1===b||2===b||!b)&&(1===b?h="1":2===b?h="2":b||(h="0")));return h},wF=(b,h)=>{if(h.hasProperty(ad.a.LI)&&2===h.getValue(ad.a.LI)&&
h.hasProperty(ad.a.q_)&&h.hasProperty(ad.a.aba)&&b.hasProperty(ad.a.yaa)&&b.hasProperty(ad.a.xaa)){var n=b.getValue(ad.a.yaa),x=b.getValue(ad.a.xaa);n=(new Zj.a(x,n)).gt;x=h.getValue(ad.a.q_);h=h.getValue(ad.a.aba);h=(new Zj.a(h,x)).gt;b.setValue(ad.a.yaa,n+h);b.setValue(ad.a.xaa,1)}},EJ=(b,h)=>{var n;if(n=BJ(b,h))n=h.hasProperty(ad.a.q_)&&h.hasProperty(ad.a.aba);if(n){n=h.getValue(ad.a.q_);const x=h.getValue(ad.a.aba);n=(new Zj.a(x,n)).gt;return CJ(h)+DJ(h)+b.getValue(ic.a.marginRight)+b.getValue(ic.a.marginLeft)+
n+ob.App.Zva<=b.getValue(ic.a.Ko)}return BJ(b,h)?CJ(h)+DJ(h)+b.getValue(ic.a.marginRight)+b.getValue(ic.a.marginLeft)+ob.App.Zva<=b.getValue(ic.a.Ko):!0},CJ=b=>{const h=b.getValue(ad.a.yaa);b=b.getValue(ad.a.xaa);return(new Zj.a(b,h)).gt},DJ=b=>{const h=b.getValue(ad.a.xua);b=b.getValue(ad.a.wua);return(new Zj.a(b,h)).gt},BJ=(b,h)=>h.hasProperty(ad.a.yaa)&&h.hasProperty(ad.a.xaa)&&h.hasProperty(ad.a.xua)&&h.hasProperty(ad.a.wua)&&b.hasProperty(ic.a.marginLeft)&&b.hasProperty(ic.a.marginRight)&&b.hasProperty(ic.a.Ko),
nP=b=>b.hasProperty(ad.a.KTc)?b.getValue(ad.a.KTc):!1,oP=b=>b.hasProperty(wi.a.Xh)?b.getValue(wi.a.Xh):!1,pP=b=>b.hasProperty(wi.a.vM)?b.getValue(wi.a.vM):!1,qP=b=>b.hasProperty(wi.a.keepTogether)?b.getValue(wi.a.keepTogether):!1;class qr extends mi{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb){super(b,n,S,ma,Fa,sb);this.Vv=Jb;this.ug=vF.ug;this.WK=h.clone();this.Zh(Box4Intl.Box4Strings.l_ParagraphDialogTitle,Object(v.a)(this,this.MYd,"paragraphDialogResultHandler"),null);this.Tlf();b=document.getElementById("ParagraphDialogAlignmentControl-Medium");
this.mU(b)}UT(){qr.Qfh("ParagraphDialogIndentLeftSpinnerContainer","DialogIndentLeftSpinner",Db.a.E4b,Db.a.jHb,Db.a.Dec,Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,this.dw);qr.Qfh("ParagraphDialogIndentRightSpinnerContainer","DialogIndentRightSpinner",Db.a.$Kd,Db.a.lVc,Db.a.o8d,Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,this.dw);qr.rlk(this.dw);const b=this.Ce.getValue(ad.a.Ws);qr.Yik(b,this.dw);qr.tlk(this.dw);super.UT()}Tlf(){for(let b=0;b<qr.bLd.length;b++)ah.a.sja(qr.bLd[b],
Object(v.a)(this,this.hva,"setAdvancedControlValue"),Object(v.a)(this,this.ssa,"getAdvancedControlValue"));ah.a.sja(Db.a.Hma,Object(v.a)(this,this.Njb,"setDropDownValue"),Object(v.a)(this,this.Kib,"provideDropDownValue"));ah.a.sja(Db.a.Yac,Object(v.a)(this,this.Njb,"setDropDownValue"),Object(v.a)(this,this.Kib,"provideDropDownValue"));ah.a.sja(Db.a.y0a,Object(v.a)(this,this.Njb,"setDropDownValue"),Object(v.a)(this,this.Kib,"provideDropDownValue"));ah.a.sja(Db.a.abc,Object(v.a)(this,this.Njb,"setDropDownValue"),
Object(v.a)(this,this.Kib,"provideDropDownValue"));super.Tlf()}dispose(){if(!this.Bl){for(let b=0;b<qr.bLd.length;b++)ah.a.Qra(qr.bLd[b]);ah.a.Qra(Db.a.Hma);ah.a.Qra(Db.a.Yac);ah.a.Qra(Db.a.y0a);ah.a.Qra(Db.a.abc);this.dw.IA("DialogIndentLeftSpinner");this.dw.IA("DialogIndentRightSpinner");this.dw.IA("ParagraphDialogAlignmentControl");this.dw.IA("ParagraphDialogSpecialIndentSelect");this.dw.IA("ParagraphDialogSpecialIndentBySpinner");super.dispose()}}ssa(b,h){var n=!1;switch(b){case Db.a.jHb:case Db.a.lVc:var x=
b===Db.a.jHb?ad.a.yaa:ad.a.xua,E=b===Db.a.jHb?ad.a.xaa:ad.a.wua;n=ob.App.caa;this.Ce.hasProperty(x)&&this.Ce.hasProperty(E)?(x=this.Ce.getValue(x),E=this.Ce.getValue(E),x?2===E?n=2:x=Jf.a.xba(x,n):ob.App.r6&&(n=2),h[rc.a.Number]=x):(h[rc.a.Text]="",h[rc.a.Number]=Number.NaN,ob.App.r6&&(n=2));h[rc.a.UnitType]=n;n=!0;break;case Db.a.E0d:x=ad.a.q_;E=ad.a.aba;let S=!1;n=ob.App.caa;this.Ce.hasProperty(ad.a.LI)&&(S=!this.Ce.getValue(ad.a.LI));this.Ce.hasProperty(x)&&this.Ce.hasProperty(E)&&!S?(x=this.Ce.getValue(x),
E=this.Ce.getValue(E),x?2===E?n=2:x=Jf.a.xba(x,n):ob.App.r6&&(n=2),h[rc.a.Number]=x):(h[rc.a.Text]="",h[rc.a.Number]=Number.NaN,ob.App.r6&&(n=2));h[rc.a.UnitType]=n;n=!0}n||super.ssa(b,h)}hva(b,h){var n=h[rc.a.Text],x=h[rc.a.Number],E=h[rc.a.UnitType],S=!1;switch(b){case Db.a.E4b:case Db.a.$Kd:n=x;2===E?S=2:(S=1,n=Jf.a.dQa(x,E));x=b===Db.a.E4b?ad.a.xaa:ad.a.wua;this.Ce.setValue(b===Db.a.E4b?ad.a.yaa:ad.a.xua,n);this.Ce.setValue(x,S);S=!0;break;case Db.a.Dec:case Db.a.o8d:""===n&&(x=2===E?2:1,n=b===
Db.a.Dec?ad.a.xaa:ad.a.wua,this.Ce.setValue(b===Db.a.Dec?ad.a.yaa:ad.a.xua,0),this.Ce.setValue(n,x));S=!0;break;case Db.a.H2a:case Db.a.e0c:E=b===Db.a.H2a?ad.a.ZCa:ad.a.XCa;S=b===Db.a.H2a?ad.a.YCa:ad.a.WCa;const ma=h.Increment;""===n||ma&&n===Box4Intl.Box4Strings.L_SpinnerAuto?(this.Ce.setValue(E,0),this.Ce.setValue(S,4)):x||ma||(this.Ce.setValue(E,0),this.Ce.setValue(S,1));S=!0;break;case Db.a.XXd:""===n&&this.Ce.setValue(ad.a.LI,1);this.vZi(x,E);S=!0;break;case Db.a.s8d:""===n&&(this.Ce.setValue(ad.a.LI,
1),this.vZi(.1,E)),S=!0}S||super.hva(b,h)}vZi(b,h){let n=b,x;2===h?x=2:(x=1,n=Jf.a.dQa(b,h));this.Ce.setValue(ad.a.q_,n);this.Ce.setValue(ad.a.aba,x);this.dw.aM("ParagraphDialogSpecialIndentBySpinner")}Kib(b,h){let n=!1;switch(b){case Db.a.Yac:this.f$m(h);n=!0;break;case Db.a.abc:this.h$m(h),n=!0}n||super.Kib(b,h)}h$m(b){let h="0";if(this.Ce.hasProperty(ad.a.LI)){const n=this.Ce.getValue(ad.a.LI);(1===n||2===n||!n)&&(1===n?h="1":2===n?h="2":n||(h="0"))}b[yi.a.SelectedItemId]=h}f$m(b){if(this.Ce.hasProperty(ad.a.Ws)){let h=
this.Ce.getValue(ad.a.Ws);if(10===h||9===h)h=11;RG(h)&&(b[yi.a.SelectedItemId]=h.toString())}}Njb(b,h){let n=!1;switch(b){case Db.a.Hma:this.GKn(h);n=!0;break;case Db.a.y0a:this.CMn(h),n=!0}n||super.Njb(b,h)}CMn(b){b=parseInt(b.MenuItemId);this.Ce.setValue(ad.a.LI,b);this.dw.aM("ParagraphDialogSpecialIndentSelect");b?(this.Ce.setValue(ad.a.aba,1),this.Ce.hasProperty(ad.a.q_)?this.Ce.getValue(ad.a.q_)||this.Ce.setValue(ad.a.q_,720):this.Ce.setValue(ad.a.q_,720)):(this.Ce.setValue(ad.a.aba,1),this.Ce.setValue(ad.a.q_,
0));this.dw.aM("ParagraphDialogSpecialIndentBySpinner")}GKn(b){this.Ce.setValue(ad.a.Ws,parseInt(b.MenuItemId));this.dw.aM("ParagraphDialogAlignmentControl")}MYd(b){let h="";1===b&&(wF(this.SM,this.SM),wF(this.Ce,this.SM),EJ(this.WK,this.Ce)?dD(this.SM,this.Ce,qr.Rhf()):h=""!==h?h:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage);this.dispose();""!==h&&this.jva(h,Object(v.a)(this,this.LYd,"paragraphDialogCreator"))}LYd(){Oa.a.instance.resolve("Box4.UI.IBox4DialogFactory").HZb(this.SM,this.WK,this.NO,
this.Vv)}static Rhf(){return mi.EY||(mi.EY=qr.G_e())}static G_e(){const b=mi.eYa();b[ad.a.Ws.id.toString()]=ik.Jhi;b[ad.a.xaa.id.toString()]=ik.DYd;b[ad.a.yaa.id.toString()]=ik.DYd;b[ad.a.wua.id.toString()]=ik.EYd;b[ad.a.xua.id.toString()]=ik.EYd;b[ad.a.LI.id.toString()]=ik.Aec;b[ad.a.aba.id.toString()]=ik.Aec;b[ad.a.q_.id.toString()]=ik.Aec;return b}static Qfh(b,h,n,x,E,S,ma){n=qr.jkk(h,n,x,E,S);mi.ovb(n,b,h,ma)}static rlk(b){const h=qr.slk();mi.ovb(h,"ParagraphDialogSpecialIndentBySpinnerContainer",
"ParagraphDialogSpecialIndentBySpinner",b)}static Yik(b,h){b=qr.Zik(b);mi.ovb(b,"ParagraphDialogAlignmentContainer","ParagraphDialogAlignmentControl",h)}static tlk(b){const h=qr.ulk();mi.ovb(h,"ParagraphDialogSpecialIndentContainer","ParagraphDialogSpecialIndentSelect",b)}static jkk(b,h,n,x,E){return xf.l(b,h,n,E,[qr.mkk(),qr.lkk(),qr.kkk()],null,x,mi.t8d)}static slk(){return xf.l("ParagraphDialogSpecialIndentBySpinner",Db.a.XXd,Db.a.E0d,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,
[qr.qlk(),qr.plk(),qr.olk()],null,Db.a.s8d,mi.t8d)}static qlk(){return xf.n("inch","0","22",".1")}static plk(){return xf.n("centimeter","0","55.88","1")}static olk(){return xf.n("character","0","316.8",".5")}static mkk(){return xf.n("inch","-11","22",".1")}static lkk(){return xf.n("centimeter","-27.94","55.88","1")}static kkk(){return xf.n("character","-316.8","316.8",".5")}static Zik(b){return xf.k("ParagraphDialogAlignmentControl",Db.a.Hma,Db.a.Yac,Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,
150,qr.VJk(b))}static VJk(b){var h=xf.e("DdlAlignment_Left","1",Db.a.Hma.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft),n=xf.e("DdlAlignment_Center","2",Db.a.Hma.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter);const x=xf.e("DdlAlignment_Right","3",Db.a.Hma.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignRight),E=xf.e("DdlAlignment_Justified","6",Db.a.Hma.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified),S=xf.e("DdlAlignment_Kashida","11",Db.a.Hma.toString(),
Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida),ma=xf.e("DdlAlignment_Distribued","7",Db.a.Hma.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed),Fa=xf.e("DdlAlignment_ThaiDistribued","13",Db.a.Hma.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed);h=[h,n,x,E,ma];n=5;if(u.AFrameworkApplication.lcid===vj.a.lg("AR-SA").LCID||11===b)h[n]=S,n=6;if(u.AFrameworkApplication.lcid===vj.a.lg("TH-TH").LCID||13===b)h[n]=Fa;return h}static ulk(){const b=xf.e("DdlSpecialIndent_None",
"0",Db.a.y0a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent),h=xf.e("DdlSpecialIndent_FirstLine","1",Db.a.y0a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent),n=xf.e("DdlSpecialIndent_Hanging","2",Db.a.y0a.toString(),Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent);return xf.k("ParagraphDialogSpecialIndentSelect",Db.a.y0a,Db.a.abc,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,150,[b,h,n])}}qr.bLd=[Db.a.E4b,Db.a.$Kd,Db.a.y0a,Db.a.XXd,Db.a.Hma,Db.a.jHb,
Db.a.lVc,Db.a.abc,Db.a.E0d,Db.a.Yac,Db.a.Dec,Db.a.o8d,Db.a.s8d];Object(r.a)(qr,"ParagraphDialog",mi,[]);class FJ extends Js{constructor(b,h){super(b,h,!0);this.j6a=null;this.nIi=(n,x)=>{this.Ef.Nr&&(n?(n="string"===typeof x.styleText?x.styleText:null,(x=this.Pij(n))?(this.j6a=x,x=this.uef(this.xC),n=this.Bzb(n,x),this.j6a=null,this.sR=!1,this.hide(),this.Zh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.nIi,n),this.sR=!0):(this.hide(),x=new Map,x.set("Source","ReactCreateNewStyleDialog"),
x.set("Action","CreateStyle"),ta.Health.instance.recordKpiUsage(jo.a.omb,0,jo.a.vB,x),this.Bxc(n,this.KR)||(n=new Map,n.set("Source","ReactCreateNewStyleDialog"),n.set("Action","CreateStyle"),n=Object.assign(new ab.a,{extendedProperties:n}),ta.Health.instance.recordKpiFailure(jo.a.omb,"CreateStyleFailed",!1,!0,n)))):this.hide(),this.Ef.JX())};this.oz&&this.KR&&(this.i8=!1,b=this.uef(this.xC),b=this.Bzb(b,b),this.Zh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.nIi,b))}Bzb(b,h){var n=this.KR.ia(ie.a.fontSize,
Zl.a.IJ)>=2*Js.jTd;const x=Nt.a.Cbf(this.KR,"97%",Js.jTd,!1,!0,n);x["padding-left"]=Js.l7i+"px";n||(x["line-height"]=Js.k7i+"px");n={};n.styleNameLabel=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName;n.previewWindowLabel=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview;n.styleName=b;n.previewContainerText=h;n.getPreviewStyle=()=>x;this.j6a&&(n.errorMessage=this.j6a);return{["id"]:this.kg,["bodyControls"]:n}}}Object(r.a)(FJ,"ReactCreateNewStyleDialog",Js,[]);class xB extends Kc.a{constructor(b,
h=!1,n){super(!1,!1,h);let x=h=this.mx=null;this.kg=xB.id;this.Ef=b.view;this.ml=n;this.Ef&&(x=this.Ef.Cb);x&&x.ib&&x.ib.kb&&(h=x.ib.kb.Qa);h?(b=h.node)?(this.oz=xB.oh.gu(b))||w.ULS.sendTraceTag(539762890,3029,10,"_pageContenNode is null"):w.ULS.sendTraceTag(539762889,3029,10,"node is null"):w.ULS.sendTraceTag(539762888,3029,10,"nodeContext is null")}Vmo(b){var h=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu"),n=this.lfl();const x=""===B.a.Uua(b),E=b.length>xB.FDm;n=n.includes(b);h=
h.test(b);b=b.startsWith("_");let S=null;if(x||E||n||b||!h)S=x?WordEditorIntl.WordEditorStrings.l_BookmarkNameEmpty:E?WordEditorIntl.WordEditorStrings.l_BookmarkNameOverMaxLength:b?WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters:h?WordEditorIntl.WordEditorStrings.l_BookmarkNameAlreadyExists:WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters;return S}f8l(b,h){return b?b===h:!1}static get oh(){return ql.PageNavigator.instance}lfl(){const b=this.ml.qGc(!1);let h=
[];for(let n=0;n<b.count;n++){let x=b.J(n).ia(ic.a.Rs,"");h.push(x)}return h}}xB.id="BookmarkEditDialog";xB.FDm=40;Object(r.a)(xB,"AEditBookmarkDialog",Kc.a,[]);class GJ extends xB{constructor(b,h,n){super(b,!0,n);this.j6a=null;this.NRa="wwaengidc";this.Hpc="ReactCreateEditBookmarkNameDialog";this.NLg="EditBookmarkName";this.Kdd="EditBookmarkNameDialog";this.she=h;this.ml=n;this.oz&&(this.i8=!1,b=this.Bzb(h.properties.ia(ic.a.Rs,null)),this.Zh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.pIi.bind(this),
b))}pIi(b,h){if(this.Ef.Nr){if(b){b="string"===typeof h.BookmarkText?h.BookmarkText:null;var n;this.she.hasProperty(ic.a.Rs)?n=this.she.getValue(ic.a.Rs):w.ULS.sendTraceTag(528880847,3029,10,"Bookmark name not found");h=this.Vmo(b);this.f8l(b,n)?(w.ULS.sendTraceTag(528880848,3029,50,"User did not update existing bookmark's name, dismissing edit bookmark dialog"),this.hide()):h?(this.j6a=h,n=this.Bzb(b),this.j6a=null,this.sR=!1,this.hide(),this.Zh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.pIi.bind(this),
n),this.sR=!0):(this.hide(),n=new Map,n.set("Source",this.Hpc),n.set("Action",this.NLg),ta.Health.instance.recordKpiUsage(this.Kdd,0,this.NRa,n),this.crk(b)||(n=new Map,n.set("Source",this.Hpc),n.set("Action",this.NLg),n=Object.assign(new ab.a,{extendedProperties:n}),ta.Health.instance.recordKpiFailure(this.Kdd,"Unable to edit bookmark",!1,!0,n)))}else this.hide();this.Ef.JX()}}crk(b){b=B.a.Uua(B.a.vZ(b));try{const h=this.ml.lej(this.she,b);if(h)w.ULS.sendTraceTag(539762886,3029,50,"Updated bookmark name to name specified by user");
else return w.ULS.sendTraceTag(525111646,3029,10,"Error updating bookmark name to name specified by user"),h}catch(h){return w.ULS.sendTraceTag(539762887,3029,10,"Error updating bookmark name to name specified by user",h.Message),!1}}Bzb(b){const h={};h.bookmarkValue=b;h.errorMessage=this.j6a;h.bookmarkTextLabel=WordEditorIntl.WordEditorStrings.l_EditBookmarkDialogLabelName;return{["id"]:this.kg,["bodyControls"]:h}}}Object(r.a)(GJ,"ReactEditBookmarkNameDialog",xB,[]);const xF=(b,h)=>{const n=[];if(b.length!==
h.length)return n;for(let x=0;x<b.length;x++){const E={};E.key=h[x];E.text=b[x];E.type="AppComboBoxItem";n[x]=E}return n},Dz=(b,h,n,x,E)=>({["unitType"]:b,["unitPlaceholder"]:B.a.dKf(h),["minValue"]:n,["maxValue"]:x,["step"]:E}),TG=()=>({["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}),HJ=(b,h,n)=>{let x=!1;b.hasProperty(h)&&b.hasProperty(n)?(n=b.getValue(n),1===n?(b=Number.NaN,h=5,x=!0):
(b=b.getValue(h),h=2===n?4:5)):(b=Number.NaN,h=ob.App.r6?4:5);return{zec:b,z3a:h,g5b:x}};class yB{constructor(){this.EY=null}RAl(b){const h={};h.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"};var n=Dz("Point",5,0,1584,1),x=Dz("Line",4,0,327,1),E=[n,x];x=TG();var S=[Box4Intl.Box4Strings.L_SpinnerAuto];n=[""];({zec:Fa,z3a:ma,g5b:$a}=HJ(b,ad.a.ZCa,ad.a.YCa));var ma={["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:Jf.a.sZb(ma),["validUnits"]:E,["numberFormatInfo"]:x,["validReservedValues"]:S};$a?ma.reservedValue=S[0]:ma.value=isNaN(Fa)?"":Fa;h.beforeSpacingSpinButtonProps=ma;({zec:Fa,z3a:ma,g5b:$a}=HJ(b,ad.a.XCa,ad.a.WCa));E={["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,
["unitType"]:Jf.a.sZb(ma),["validUnits"]:E,["numberFormatInfo"]:x,["validReservedValues"]:S};$a?E.reservedValue=S[0]:E.value=isNaN(Fa)?"":Fa;h.afterSpacingSpinButtonProps=E;if(S=E=b.hasProperty(ad.a.ta))S=yB.JT.eLa(b),S=b.hasProperty(ad.a.ta)&&b.hasProperty(ad.a.KZ)&&2===b.getValue(ad.a.KZ)?!Ub.a.DZ(S,1)&&!Ub.a.DZ(S,1.5)&&!Ub.a.DZ(S,2):!1;if(E){var Fa=yB.JT.eLa(b);E=0;var $a=!1;b.hasProperty(ad.a.ta)&&b.hasProperty(ad.a.KZ)||($a=!0);$a||(2!==b.getValue(ad.a.KZ)&&($a=!0),E=Fa,1>E&&($a=!0));$a?E="":
(Fa="multiple",S||(Ub.a.DZ(E,1)?Fa="1.00":Ub.a.DZ(E,1.5)?Fa="1.50":Ub.a.DZ(E,2)&&(Fa="2.00")),E=Fa)}else E=null;Fa={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:xF([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,
Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50","2.00","multiple"]),["allowFreeForm"]:!1};E?Fa.selectedKey=E:Fa.defaultSelectedKey="";h.lineSpacingComboBoxProps=Fa;E=0;Fa=!1;b.hasProperty(ad.a.ta)&&b.hasProperty(ad.a.KZ)&&2===b.getValue(ad.a.KZ)&&S&&(E=yB.JT.eLa(b),Fa=!0,1>E&&(E=Number.NaN));b=[Dz("none",0,1,132,.5)];b={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,
["unitType"]:"none",["validUnits"]:b,["numberFormatInfo"]:x,["validReservedValues"]:n};Fa?b.value=E:b.reservedValue=n[0];h.atSpinButtonProps=b;return h}eYa(){return this.EY||(this.EY=this.OJa())}OJa(){const b={};b[ad.a.ta.id.toString()]=ik.sji;b[ad.a.XCa.id.toString()]=ik.GYd;b[ad.a.WCa.id.toString()]=ik.GYd;b[ad.a.ZCa.id.toString()]=ik.HYd;b[ad.a.YCa.id.toString()]=ik.HYd;return b}static get JT(){return null!=yB.Tlg?yB.Tlg:yB.Tlg=Oa.a.instance.resolve("Box4.ILineSpacingHelper")}}Object(r.a)(yB,"ReactParagraphDialog",
null,[]);class IJ extends Kc.a{constructor(b,h,n,x,E,S=Oa.a.instance.Za("Box4.Settings.SpacingSettings")){var ma,Fa;super(!1,!1,!0);this.oO=this.z4g=null;this.LYd=()=>{Oa.a.instance.resolve("Box4.UI.IBox4DialogFactory").HZb(this.SM,this.WK,this.NO,this.Vv)};this.MYd=(Jb,Sb)=>{var oc,Ic,gd,Gd;if(Sb&&(1===Jb||2===Jb)){if(Sb.alignmentComboBoxProps){var vd=parseInt(Sb.alignmentComboBoxProps.selectedKey);isNaN(vd)||RG(vd)&&this.Ce.setValue(ad.a.Ws,vd)}var ce=Sb.bySpinButtonProps;vd=!!ce&&""!==ce.value;
var od=Sb.didChangeSpecialIndentationComboBoxValue;if(Sb.specialIndentationComboBoxProps){var Yd=parseInt(Sb.specialIndentationComboBoxProps.selectedKey);1!==Yd&&2!==Yd&&Yd||!(Yd||od||vd)||this.Ce.setValue(ad.a.LI,Yd)}if(ce){Yd=ce.value;ce=Jf.a.Jwb(ce.unitType.toLowerCase());let ne;0<=Yd||(Yd=0);2===ce?ne=2:(ne=1,Yd=Jf.a.dQa(Yd,ce));if(vd||od)this.Ce.setValue(ad.a.q_,Yd),this.Ce.setValue(ad.a.aba,ne)}Sb.beforeTextSpinButtonProps&&(od=Sb.beforeTextSpinButtonProps,vd=Jf.a.Jwb(od.unitType.toLowerCase()),
od=""===od.value?Number.NaN:od.value,isNaN(od)||(Yd=od,2===vd?ce=2:(ce=1,Yd=Jf.a.dQa(od,vd)),this.Ce.setValue(ad.a.yaa,Yd),this.Ce.setValue(ad.a.xaa,ce)));Sb.afterTextSpinButtonProps&&(od=Sb.afterTextSpinButtonProps,vd=Jf.a.Jwb(od.unitType.toLowerCase()),od=""===od.value?Number.NaN:od.value,isNaN(od)||(Yd=od,2===vd?ce=2:(ce=1,Yd=Jf.a.dQa(od,vd)),this.Ce.setValue(ad.a.xua,Yd),this.Ce.setValue(ad.a.wua,ce)));Sb.beforeSpacingSpinButtonProps&&(vd=Sb.beforeSpacingSpinButtonProps,od=Jf.a.Jwb(vd.unitType.toLowerCase()),
Yd=vd.reservedValue,""!==vd.value&&(Yd===Box4Intl.Box4Strings.L_SpinnerAuto?(od=1,vd=0):(od=4===od?2:4,vd=vd.value),this.Ce.setValue(ad.a.ZCa,vd),this.Ce.setValue(ad.a.YCa,od)));Sb.afterSpacingSpinButtonProps&&(vd=Sb.afterSpacingSpinButtonProps,od=Jf.a.Jwb(vd.unitType.toLowerCase()),Yd=vd.reservedValue,""!==vd.value&&(Yd===Box4Intl.Box4Strings.L_SpinnerAuto?(od=1,vd=0):(od=4===od?2:4,vd=vd.value),this.Ce.setValue(ad.a.XCa,vd),this.Ce.setValue(ad.a.WCa,od)));if(Sb.atSpinButtonProps||Sb.lineSpacingComboBoxProps)if(vd=
Sb.atSpinButtonProps.value,1<vd)this.Ce.setValue(ad.a.ta,vd),this.Ce.setValue(ad.a.KZ,2);else if(vd=Sb.lineSpacingComboBoxProps.selectedKey)vd="1.00"===vd?1:"1.50"===vd?1.5:"2.00"===vd?2:0,vd=1<=vd?vd:1,this.Ce.setValue(ad.a.ta,vd),this.Ce.setValue(ad.a.KZ,2);(null===(oc=this.oO)||void 0===oc?0:oc.vta)&&Sb.contextualSpacingCheckboxProps&&this.Ce.setValue(ad.a.KTc,Sb.contextualSpacingCheckboxProps.checked);(null===(Ic=this.Vv)||void 0===Ic?0:Ic.iCa)&&Sb.keepWithNextCheckboxProps&&this.Ce.setValue(wi.a.Xh,
Sb.keepWithNextCheckboxProps.checked);(null===(gd=this.Vv)||void 0===gd?0:gd.iFa)&&Sb.widowOrphanCheckboxProps&&this.Ce.setValue(wi.a.vM,Sb.widowOrphanCheckboxProps.checked);(null===(Gd=this.Vv)||void 0===Gd?0:Gd.Ita)&&Sb.keepTogetherCheckboxProps&&this.Ce.setValue(wi.a.keepTogether,Sb.keepTogetherCheckboxProps.checked);wF(this.SM,this.SM);wF(this.Ce,this.SM);Sb="";EJ(this.WK,this.Ce)?dD(this.SM,this.Ce,this.Rhf(this.BFe?this.BFe.OJa():{})):Sb=""!==Sb?Sb:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage;
this.dispose();""!==Sb?this.jva(Sb,this.LYd):2===Jb&&(Pe.c(ub.a.bec,!0,"Custom Tab Stop Dialog was opened via Paragraph Dialog"),this.ga.Xb(ub.a.bec,2,null))}};S.execute(Jb=>this.oO=Jb);this.SM=b.clone();this.Ce=b.clone();this.WK=h.clone();this.NO=n;this.ga=x;this.BFe=new yB;this.Vv=E;b=this.BFe.RAl(this.Ce);h=Dz("Inch",3,-11,22,.1);n=Dz("Inch",3,0,22,.1);S=Dz("Centimeter",1,-27.94,55.88,1);x=Dz("Centimeter",1,0,55.88,1);var $a=Dz("Character",2,-316.8,316.8,.5);E=Dz("Character",2,0,316.8,.5);h=[h,
S,$a];x=[n,x,E];n=TG();b.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,["forId"]:"GeneralGroup"};S=[Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified,Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed];$a=["1","2","3","6","7"];let sb=5;E=this.Ce.hasProperty(ad.a.Ws)?this.Ce.getValue(ad.a.Ws):
0;if(10===E||9===E)E=11;if(u.AFrameworkApplication.lcid===vj.a.lg("AR-SA").LCID||11===E)b.isKashidaSupported=!0,S[sb]=Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida,$a[sb]="11",sb=6;if(u.AFrameworkApplication.lcid===vj.a.lg("TH-TH").LCID||13===E)b.isThaiSupported=!0,S[sb]=Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed,$a[sb]="13";S={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,
["showLabel"]:!0,["options"]:xF(S,$a),["allowFreeForm"]:!1};RG(E)?S.selectedKey=E.toString():S.defaultSelectedKey="";b.alignmentComboBoxProps=S;(null===(ma=this.Vv)||void 0===ma?0:ma.Pjf)||(b.paginationLabelProps={["type"]:"AppLabelProps",["id"]:"PaginationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogPagination,["forId"]:"PaginationGroup"});this.Vv.iCa&&(ma={["type"]:"AppCheckboxInternalProps",["id"]:"KeepWithNextCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepWithNext,["checked"]:oP(this.Ce)},
b.keepWithNextCheckboxProps=ma);this.Vv.iFa&&(ma={["type"]:"AppCheckboxInternalProps",["id"]:"WidowOrphanCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogWidowOrphan,["checked"]:pP(this.Ce)},b.widowOrphanCheckboxProps=ma);this.Vv.Ita&&(ma={["type"]:"AppCheckboxInternalProps",["id"]:"KeepTogetherCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepTogether,["checked"]:qP(this.Ce)},b.keepTogetherCheckboxProps=ma);b.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};E=mP(this.Ce);ma="0"===E;b.specialIndentationComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,["options"]:xF([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],
["0","1","2"]),["selectedKey"]:E,["allowFreeForm"]:!1};S=ob.App.caa;E=0;({zec:E,z3a:S}=SG(this.Ce,ad.a.q_,ad.a.aba,ma));ma={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:Jf.a.sZb(S),["validUnits"]:x,["numberFormatInfo"]:n};ma=this.$Xf(E,ma);b.bySpinButtonProps=ma;x=ob.App.caa;ma=0;({zec:ma,z3a:x}=SG(this.Ce,ad.a.yaa,ad.a.xaa,!1));x=
{["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:Jf.a.sZb(x),["validUnits"]:h,["numberFormatInfo"]:n};x=this.$Xf(ma,x);b.beforeTextSpinButtonProps=x;x=ob.App.caa;ma=0;({zec:ma,z3a:x}=SG(this.Ce,ad.a.xua,ad.a.wua,!1));h={["type"]:"AppSpinButtonProps",["id"]:"AfterTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,
["unitType"]:Jf.a.sZb(x),["validUnits"]:h,["numberFormatInfo"]:n};h=this.$Xf(ma,h);b.afterTextSpinButtonProps=h;h={["id"]:"ParagraphDialog",["bodyControls"]:b};if(null===(Fa=this.oO)||void 0===Fa?0:Fa.vta)Fa={["type"]:"AppCheckboxInternalProps",["id"]:"ContextualSpacingCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogContextualSpacing,["checked"]:nP(this.Ce)},b.contextualSpacingCheckboxProps=Fa;h.dialogButtonsOption=9;h.secondaryActionButtonProps={["id"]:"tabStopOptionsButton",["type"]:"AppButtonProps",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogTabStopOptions};h.styles={["root"]:{["#tabStopOptionsButton"]:{["float"]:"left",["margin-left"]:"0"}}};this.Zh(Box4Intl.Box4Strings.l_ParagraphDialogTitle,this.MYd,h)}Rhf(b){return this.z4g||(this.z4g=this.G_e(b))}G_e(b){var h,n,x,E;b[ad.a.Ws.id.toString()]=ik.Jhi;b[ad.a.xaa.id.toString()]=ik.DYd;b[ad.a.yaa.id.toString()]=ik.DYd;b[ad.a.wua.id.toString()]=ik.EYd;b[ad.a.xua.id.toString()]=ik.EYd;b[ad.a.LI.id.toString()]=ik.Aec;b[ad.a.aba.id.toString()]=
ik.Aec;b[ad.a.q_.id.toString()]=ik.Aec;if(null===(h=this.oO)||void 0===h?0:h.vta)b[ad.a.KTc.id.toString()]=ik.MCk;if(null===(n=this.Vv)||void 0===n?0:n.iCa)b[wi.a.Xh.id.toString()]=ik.Nmm;if(null===(x=this.Vv)||void 0===x?0:x.iFa)b[wi.a.vM.id.toString()]=ik.hpo;if(null===(E=this.Vv)||void 0===E?0:E.Ita)b[wi.a.keepTogether.id.toString()]=ik.Lmm;return b}$Xf(b,h){h.value=isNaN(b)?"":b;return h}}Object(r.a)(IJ,"WordReactParagraphDialog",Kc.a,[]);class yF{static get ug(){return Kc.a.Lx(yF.rl,"Count: ",
"Width: ","Spacing: ")}}yF.rl="<div class='WACDialogRow' id='RowColumns'> <div class='WacDialogLabels' id='ColumnsDialogLabels'> <label id='ColumnsDialogCount' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='ColumnsDialogWidth' class='DialogSpinnerLabel' >{1}</label> <br/> <label id='ColumnsDialogSpacing class='DialogSpinnerLabel' >{2}</label> <br/> </div> <div class='WacSpinnerBoxes' id='ColumnsDialogSpinners'> <div id='ColumnsDialogCountSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='ColumnsDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='ColumnsDialogSpacingSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(r.a)(yF,"ColumnsDialogHtml",null,[]);class Tl extends Kc.a{constructor(b,h,n,x){super();this.kg="ColumnsDialog";this.WK=h.clone();this.SM=b.clone();this.Ce=b.clone();this.NO=n;this.sR=!1;this.hp=x;this.ug=yF.ug;n&&(this.Ynb=Aj.a.o3a);this.Zh("Columns",Object(v.a)(this,this.byk,"columnsDialogResultHandler"),null);this.GBb()}UT(){this.YSe("ColumnsDialogCountSpinnerContainer","DialogCountSpinner",ub.a.IXd,ub.a.O_d,"Columns Count",0,Tl.$Xn,Tl.znm,Tl.$Ek);this.YSe("ColumnsDialogWidthSpinnerContainer",
"DialogWidthSpinner",ub.a.KXd,ub.a.Q_d,"Columns Width",ob.App.caa,Tl.a8d,Tl.eQd,Tl.ipo);this.YSe("ColumnsDialogSpacingSpinnerContainer","DialogSpacingSpinner",ub.a.JXd,ub.a.P_d,"Columns Spacing",ob.App.caa,Tl.$7d,Tl.dQd,Tl.KYn)}GBb(){for(let b=0;b<Tl.v7.length;b++)ah.a.sja(Tl.v7[b],Object(v.a)(this,this.hva,"setAdvancedControlValue"),Object(v.a)(this,this.ssa,"getAdvancedControlValue"));this.hp.aM("DialogCountSpinner");this.hp.aM("DialogWidthSpinner");this.hp.aM("DialogSpacingSpinner")}dispose(){for(let b=
0;b<Tl.v7.length;b++)ah.a.Qra(Tl.v7[b]);this.hp.IA("DialogCountSpinner");this.hp.IA("DialogWidthSpinner");this.hp.IA("DialogSpacingSpinner");super.dispose()}ssa(b,h){var n=this.Jib(b);if(this.Ce.hasProperty(n))if(n==wi.a.yC)b=this.Ce.getValue(n),h[rc.a.Number]=b,h[rc.a.UnitType]=0;else if(n==wi.a.Fx){b=ob.App.caa;n=this.Ce.getValue(wi.a.ZV);const x=this.Ce.getValue(wi.a.yC);n=this.ozb(wi.a.Fx,x,n,0);h[rc.a.Number]=Jf.a.xba(n,b);h[rc.a.UnitType]=b}else n==wi.a.ZV&&(b=ob.App.caa,n=this.Ce.getValue(n),
h[rc.a.Number]=Jf.a.xba(n,b),h[rc.a.UnitType]=b);else h[rc.a.Number]=0,h[rc.a.UnitType]=0}hva(b,h){var n=h[rc.a.Number];h=h[rc.a.UnitType];b=this.Jib(b);if(b==wi.a.yC)this.Ce.setValue(b,n),this.Ce.setValue(wi.a.ZV,Tl.DPk[n]),this.Ce.setValue(wi.a.Fx,[Tl.EPk[n]]);else if(b==wi.a.ZV){var x=this.Ce.getValue(wi.a.yC);h=Jf.a.dQa(n,h);n=this.ozb(wi.a.Fx,x,h,0);h=this.W9g(wi.a.Fx,x,n,h);n=h[0];h=h[1];n>=Tl.a8d&&n<=Tl.eQd&&(this.Ce.setValue(b,h),this.Ce.setValue(wi.a.Fx,[n]))}else b==wi.a.Fx&&(x=this.Ce.getValue(wi.a.yC),
n=Jf.a.dQa(n,h),h=this.ozb(wi.a.ZV,x,0,n),h=this.W9g(wi.a.ZV,x,n,h),n=h[0],h=h[1],h>=Tl.$7d&&h<=Tl.dQd&&(this.Ce.setValue(b,[n]),this.Ce.setValue(wi.a.ZV,h)));this.hp.xl()}ozb(b,h,n,x){var E=this.WK.getValue(ic.a.Ko),S=this.WK.getValue(ic.a.marginLeft);const ma=this.WK.getValue(ic.a.marginRight);E=E-S-ma;S=0;b==wi.a.ZV?S=(E-h*x)/(h-1):b==wi.a.Fx&&(S=(E-(h-1)*n)/h);return S}W9g(b,h,n,x){b==wi.a.ZV?x<Tl.$7d?(x=Tl.$7d,n=this.ozb(wi.a.Fx,h,x,0)):x>Tl.dQd&&(x=Tl.dQd,n=this.ozb(wi.a.Fx,h,x,0)):b==wi.a.Fx&&
(n<Tl.a8d?(n=Tl.a8d,x=this.ozb(wi.a.ZV,h,0,n)):n>Tl.eQd&&(n=Tl.eQd,x=this.ozb(wi.a.ZV,h,0,n)));return[n,x]}byk(b){let h=!1;var n=this.Ce.getValue(wi.a.Fx);const x=this.Ce.getValue(wi.a.yC),E=this.Ce.getValue(wi.a.ZV);let S=0;for(let ma=0;ma<x;ma++)S+=n[0];n=this.WK.getValue(ic.a.Ko)-this.WK.getValue(ic.a.marginLeft)-this.WK.getValue(ic.a.marginRight);1===b&&(13>=x&&(x-1)*E+S<=n?dD(this.SM,this.Ce,Tl.eYa()):h=!0);this.dispose();h&&this.jva("The page does not fit the current columns sizes.  Please try changing them.",
Object(v.a)(this,this.ayk,"marginDialogCreator"))}ayk(){Oa.a.instance.resolve("WordEditor.UI.IDialogFactory").Brh(this.SM,this.WK,this.NO)}YSe(b,h,n,x,E,S,ma,Fa,$a){n=Tl.sjk(h,n,x,E,S,ma,Fa,$a);this.eVa(n,b,h)}eVa(b,h,n){h=document.getElementById(h);this.hp.rya(n,b);b=this.hp.EXa(n,"Medium");h.appendChild(b)}Jib(b){let h=null;switch(b){case ub.a.IXd:case ub.a.O_d:h=wi.a.yC;break;case ub.a.KXd:case ub.a.Q_d:h=wi.a.Fx;break;case ub.a.JXd:case ub.a.P_d:h=wi.a.ZV}return h}static eYa(){return Tl.EY||(Tl.EY=
Tl.OJa())}static OJa(){const b={};b[wi.a.yC.id.toString()]=Lp.Oxk;b[wi.a.Fx.id.toString()]=Lp.$xk;b[wi.a.ZV.id.toString()]=Lp.Yxk;return b}static sjk(b,h,n,x,E,S,ma,Fa){return 0==E?xf.l(b,h,n,x,[Tl.vjk(E,S,ma,Fa)]):xf.l(b,h,n,x,[Tl.ujk(Jf.a.xba(S,3),Jf.a.xba(ma,3),Fa),Tl.tjk(Jf.a.xba(S,1),Jf.a.xba(ma,1),Fa)])}static ujk(b,h,n){return xf.n("inch",b.toString(),h.toString(),n.toString())}static tjk(b,h,n){return xf.n("centimeter",b.toString(),h.toString(),n.toString())}static vjk(b,h,n,x){return xf.n(b.toString(),
h.toString(),n.toString(),x.toString())}}Tl.v7=[ub.a.O_d,ub.a.Q_d,ub.a.P_d,ub.a.IXd,ub.a.KXd,ub.a.JXd];Tl.$Xn=1;Tl.znm=13;Tl.$Ek=1;Tl.a8d=720;Tl.eQd=9360;Tl.ipo=.1;Tl.$7d=0;Tl.dQd=7920;Tl.KYn=.1;Tl.DPk=[-1,0,720,720,720,720,720,720,520,360,245,144,72,0];Tl.EPk=[-1,9360,4320,2635,1800,1296,965,720,720,720,720,720,720,720];Tl.EY=null;Object(r.a)(Tl,"ColumnsDialog",Kc.a,[]);class JJ{RFk(b){new bD(b,Oa.a.instance.resolve("Box4.IFeatureHelper"))}AJk(b,h){u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.zA?
new FJ(b,h):new tJ(b,h)}OYk(b,h,n){new GJ(b,h,n)}Fsh(b,h,n){new Gu(b,h,n,Oa.a.instance.resolve("WordEditor.IPageCommands"),Oa.a.instance.resolve("Common.IStandaloneRootController").q3,!!ob.App.instance&&ob.App.instance.kgb)}jth(b,h,n){new cr(b,h,n,Oa.a.instance.resolve("WordEditor.IPageCommands"),Oa.a.instance.resolve("Common.IStandaloneRootController").q3,!!ob.App.instance&&ob.App.instance.kgb)}Brh(b,h,n){new Tl(b,h,n,Oa.a.instance.resolve("Common.IStandaloneRootController").q3)}lFk(b){return new jC(b)}HZb(b,
h,n,x){u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.zA&&u.AFrameworkApplication.K.$("ReactParagraphDialogIsEnabled")?new IJ(b,h,n,u.AFrameworkApplication.ya,x):new qr(b,h,n,Oa.a.instance.resolve("Box4.IIndentationCommands"),Oa.a.instance.resolve("Box4.IJustificationCommands"),Oa.a.instance.resolve("Box4.ISpacingCommands"),Oa.a.instance.Ye("Box4.IFeatureHelper"),u.AFrameworkApplication.K,Oa.a.instance.resolve("Box4.IParagraphIndentationReader"),Oa.a.instance.resolve("Common.IStandaloneRootController").q3,
x)}iRk(){const b=Oa.a.instance.Pa("Box4.IRoamingServiceRequestManager");null==b?sd.b(524834398,3018,10,"Roaming service not resolved."):new uJ(b)}lRk(b,h){new vJ(b,h)}M1e(b){return new wJ(b)}}Object(r.a)(JJ,"DialogFactory",null,[557,558]);class lE extends Kc.a{constructor(b,h){super(!1,!1,!0);this.lzh="DoNotCheckSpellingCheckbox";this.yzh="DocumentChoiceGroup";this.m8c=0;this.Zhi="LanguageList";this.documentContext="DocumentContext";this.Dq="RangeContext";this.dJn=(n,x)=>{if(Of.a.instance.J(9)){var E=
vb.a.instance.oo(Db.a.aYi);if(1!==n)E.properties.Z("canceled","true");else{n=x[this.Zhi].replace(lE.adg,"");var S=parseInt(n),ma=Boolean.parse(x[this.lzh]);x=x[this.yzh];x===this.documentContext?this.Ndd.SGn(S,ma):this.Ndd.dMn(S,ma);E.properties.Z("PreviousLCID",this.m8c.toString());E.properties.Z("ChangedLCID",S.toString());E.properties.Z("NoProof",ma.toString());this.RLg.cJn(S,this.m8c);Pe.d(Db.a.aYi,!0,void 0,void 0,void 0,void 0,[Object.assign(new ca.a,{name:"SelectedLcid",string:n}),Object.assign(new ca.a,
{name:"NoProof",string:ma.toString()}),Object.assign(new ca.a,{name:"Context",string:x})]);ob.App.xa.updateCommandUI(!0)}E.end()}};this.RLg=h;this.Ndd=b}f_f(){const b=Array(2);b[0]={["key"]:this.Dq,["text"]:WordEditorIntl.WordEditorStrings.l_SelectedText};b[1]={["key"]:this.documentContext,["text"]:WordEditorIntl.WordEditorStrings.l_CurrentDocument};const h={showDocumentChoiceGroup:!0};h.markSelectedText=Box4Intl.Box4Strings.l_MarkSelectedText;h.documentChoiceGroupProps={["id"]:this.yzh,["defaultSelectedKey"]:this.nnl(),
["label"]:WordEditorIntl.WordEditorStrings.l_ChangeProofingLanguage,["options"]:b};this.m8c=({x9m:this.Kyj}=this.Ndd.cGl()).returnValue;h.languageListPropsProvider=this.Kul();h.spellingCheckboxProps={["id"]:this.lzh,["checked"]:!this.Kyj,["label"]:WordEditorIntl.WordEditorStrings.l_DoNotCheckSpellingOrGrammar};this.Zh(Box4Intl.Box4Strings.l_Language,this.dJn,{["id"]:"LanguageDialog",["bodyControls"]:h})}nnl(){return this.Ndd.xf()?this.documentContext:this.Dq}Kul(){return()=>{let b,h;const n=({selectedIndex:b,
z5i:h}=this.RLg.Jul(this.m8c)).returnValue;for(let x=0;x<n.length&&x<h;x++)n[x].value=lE.adg+n[x].value;return{["id"]:this.Zhi,["items"]:n,["selectedLanguageIndex"]:b,["applyBorderIndex"]:h}}}}lE.adg="recent-";Object(r.a)(lE,"ReactLanguageDialog",Kc.a,[559]);class KJ extends jE{constructor(b,h,n,x){super(h,n);this.mKf=()=>{this.floatie.xl()};this.Dh=b;this.wH=x}yab(b,h,n){if(b=super.yab(b,h,n))b.Bac=!0,b.e_d=!0,b.preventDismissOnScroll=!0;this.Dh.SUa(this.mKf);return b}vLc(b,h,n=null){this.wH.Xdh(()=>
this.yab(b,h,n))}$Vd(){this.floatie.Bac=!0}}Object(r.a)(KJ,"ExternalContentFloatieInitializer",jE,[]);class LJ{zGb(){hl.instance.Tla&&(Or.instance.J3a([1,0]),hl.instance.HPd()&&Pr.instance.J3a([1]))}}Object(r.a)(LJ,"RulerUser",null,[555]);class MJ{constructor(){this.whitelistedControlIds=null}}Object(r.a)(MJ,"StatusBarProps",null,[]);class mE{constructor(b,h){this.Bid=!1;this.JCe=null;this.Nca=h.ZF;this.$Ge=h.v6i;cj.a.get_instance().sl(7,()=>{window.setTimeout(()=>{oo.a.instance.Pd(()=>{Cj.UISurfaces.VHl().then(n=>
{const x=Object.assign(new MJ,{whitelistedControlIds:h.whitelistedControlIds});n.initializeNewStatusBar(b,x,this.$Ge);this.JCe=n;this.Bid=!0;window.setTimeout(()=>{oo.a.instance.Pd(()=>{const E=[];if(h.WF){const S=h.WF;for(let ma in S)E.push(appChrome.actions.updateControlHiddenState(ma,S[ma]));appChrome.api.dispatch(E)}this.zGb()},"RSB:I2")},0);return null}).catch(()=>{w.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API");return null})},"RSB:I1");if(h.Sna&&b){mE.xFg||(u.AFrameworkApplication.ya.pa(Ra.a.x6i,
Ld.a.frame,Object(v.a)(this,this.y6i,"statusBarTabAction")),u.AFrameworkApplication.ya.pa(Ra.a.w6i,Ld.a.frame,Object(v.a)(this,this.y6i,"statusBarTabAction")),mE.xFg=!0);const n=Aj.a.Ulf(h.Sna,h.lXi,b,!1);n.LL=!0;this.nbc(n,Ra.a.x6i,Ra.a.w6i)}},0)})}zGb(){this.Bid&&this.Nca&&window.setTimeout(()=>{this.Nca(this.JCe.selectors.getStatusBarControlsMap(this.$Ge),7)},0)}Ljb(b,h){this.Bid&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(b,h))},0)}FQ(b){this.Bid&&
this.Nca&&window.setTimeout(()=>{const h=this.JCe.selectors.getStatusBarControlsMap(this.$Ge);if(h[b]){const n={};n[b]=h[b];this.Nca(n,7)}},0)}nbc(b,h,n){const x=mc.KeyInputManager.mc(db.a.fx,0),E=mc.KeyInputManager.mc(db.a.fx,4);b.Ar(x);b.Ar(E);b.bindAction(x,h);b.bindAction(E,n)}y6i(){return 4}}mE.xFg=!1;Object(r.a)(mE,"ReactStatusBar",null,[]);class NJ{constructor(){this.whitelistedControlIds=this.WF=this.ZF=null;this.ulm=!1;this.lXi=this.Sna=this.v6i=null}}Object(r.a)(NJ,"ReactStatusBarInitOptions",
null,[]);var kC=d(465);class OJ{constructor(b,h,n,x,E){this.kTb=this.WHa=this.Ma=null;this.u0n=()=>{const S=ob.App.xa.Yo.getRegion(Qe.AppFrame.Sna);S&&S.gzf()};this.kTl=(S,ma,Fa,$a,sb)=>{if(!sb)return w.ULS.sendTraceTag(572135558,306,10,String.format("{0}","actionData is null for visibility toggle")),8;if(1===Fa)return 32;sb&&2===sb.length&&this.WHa&&this.WHa.Ljb(sb[0],sb[0]);return 32};this.W2c=S=>{ob.App.xa.ZF(S)};this.ga=x;oo.a.instance.Pd(()=>{this.Ma=E;this.kTb=this.WHa=null;let S={};u.AFrameworkApplication.G3i||
(S[kC.a.kyn]=!0);S.GiveFeedback=!u.AFrameworkApplication.mE;this.Ma.$("OfficeOnlineInGallatinTextVisible")||(S.CenterStatusLabel=!0);S[kC.a.TAi]=!0;this.Ma.$("WPMPackageIsEnabled")&&this.Ma.$("WPMStatusBarLabelIsEnabled")||(S[kC.a.i$f]=!0);this.Ma.$("AddInCommandsIsEnabled")||(S[kC.a.B1j]=!0);this.Ma.$("WordEditorShowOcsConnectionStatus")||(S[kC.a.fVd]=!0);S[kC.a.Lpo]=!0;this.Ma.$("ReadingTimeIsEnabled")||(S[kC.a.AIi]=!0);window.setTimeout(()=>{this.Y1l(b,S)},0)},"SBU:I")}Vb(){this.ga.gb(Db.a.K8d,
cc.a.application,this.kTl,96)}Y1l(b,h){this.kTb=Oa.a.instance.Pa("WordEditor.WordEditorReactCommandDefinitionMapping");const n={};for(let E in h){var x=h[E];n[this.Aff(E)]=x}this.WHa=new mE(b,Object.assign(new NJ,{WF:n,ZF:this.W2c,ulm:!1,v6i:"WordEditorStatusBar",Sna:Qe.AppFrame.Sna,lXi:this.u0n}))}Aff(b){let h="";if(this.kTb){const n=this.kTb.pcf(b);n&&0<n.count&&(h=n.J(0))}return h&&""!==h?h:b}zGb(){this.WHa&&this.WHa.zGb()}Ljb(b,h){this.WHa&&this.WHa.Ljb(this.Aff(b),h)}FQ(b){this.WHa&&this.WHa.FQ(this.Aff(b))}dispose(){}}
Object(r.a)(OJ,"StatusBarUser",null,[554,10]);var PJ=d(1016);class UG{constructor(b){this.ga=b;this.ga.pa(Ra.a.DXc,Ld.a.frame,Object(v.a)(this,this.DXc,"reportFileMenuPageSwitch"));this.ga.pa(Ra.a.OOi,Ld.a.frame,pd.ActionManager.Nf)}DXc(b,h,n,x,E){this.ga.processAction(this.Kpl(E[PJ.a.pageId]),2);return 32}}Object(r.a)(UG,"FileMenuSQMInformation",null,[889]);class QJ extends UG{constructor(b){super(b);this.Pin()}Pin(){this.ga.pa(Ra.a.iSf,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(Ra.a.IOi,Ld.a.frame,
pd.ActionManager.Nf);this.ga.pa(Ra.a.jSf,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(Ra.a.JOi,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(Ra.a.KOi,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(Ra.a.kSf,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(Ra.a.LOi,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(Ra.a.MOi,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(Ra.a.NOi,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(Ra.a.pPi,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(Ra.a.qPi,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(Ra.a.TOi,
Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(Ra.a.UOi,Ld.a.frame,pd.ActionManager.Nf)}Kpl(b){switch(b){case "menuJewelAbout":case "FileAboutPage":return Ra.a.iSf;case "tabHome":case "FileHomePage":return Ra.a.IOi;case "menuJewelInfo":case "FileInfoPage":return Ra.a.jSf;case "menuJewelNew":case "FileNewPage":return Ra.a.JOi;case "menuJewelOpen":case "FileOpenPage":return Ra.a.KOi;case "menuJewelPrint":case "FilePrintPage":return Ra.a.kSf;case "menuJewelSaveAs":case "FileSaveAsPage":return Ra.a.LOi;case "menuJewelShare":case "FileSharePage":return Ra.a.MOi;
case "menuJewelTransform":case "FileTransformPage":return Ra.a.NOi}return Ra.a.OOi}}Object(r.a)(QJ,"WordEditorFileMenuSQMInformation",UG,[]);var RJ=d(1014);class VG{constructor(b){this.ga=b;this.ga.pa(Ra.a.EXc,Ld.a.frame,Object(v.a)(this,this.EXc,"reportTabSwitch"));this.ga.pa(Ra.a.kPi,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(Ra.a.mPi,Ld.a.frame,pd.ActionManager.Nf)}EXc(b,h,n,x,E){this.ga.processAction(this.VEl(E[RJ.a.r2f]),2);return 32}}Object(r.a)(VG,"RibbonSQMInformation",null,[848]);class SJ extends VG{constructor(b){super(b);
this.aln()}aln(){this.ga.pa(Ra.a.cPi,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(Ra.a.dPi,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(ub.a.mSf,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(Ra.a.ePi,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(Ra.a.fPi,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(ub.a.gPi,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(ub.a.hPi,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(ub.a.iPi,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(ub.a.jPi,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(ub.a.nSf,
Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(ub.a.lPi,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(Ra.a.nPi,Ld.a.frame,pd.ActionManager.Nf);this.ga.pa(ub.a.oPi,Ld.a.frame,pd.ActionManager.Nf)}VEl(b){switch(b){case "tabAddins":case "Addins":return Ra.a.cPi;case "tabHome":case "Home":return Ra.a.ePi;case "tabInsert":case "Insert":return Ra.a.fPi;case "tabDeveloper":case "Developer":return Ra.a.dPi;case "tabPageLayout":case "Layout":return ub.a.gPi;case "tabReferences":case "References":return ub.a.jPi;
case "tabReview":case "Review":return ub.a.nSf;case "tabView":case "View":return Ra.a.nPi;case "Table":case "TableLayout":case "ContextualTabs.Tables.Design":case "ContextualTabs.Tables.Layout":return ub.a.lPi;case "tabMailings":case "Mailings":return ub.a.hPi;case "tabWordDesign":case "Design":return ub.a.oPi;case "tabHelp":case "Help":return ub.a.mSf;case "ctabPictureTools":case "Picture":return ub.a.iPi}return Ra.a.mPi}}Object(r.a)(SJ,"WordEditorRibbonSQMInformation",VG,[]);class TJ{constructor(b=
null,h=null,n=null){this.WF=b||{};this.vbj=h||[];this.xbj=n||{}}}Object(r.a)(TJ,"RibbonTrimmingProperties",null,[]);class UJ{constructor(b,h,n){this.Lra=b;this.WF=h;this.mtf=n}}Object(r.a)(UJ,"ReactRibbonJewelProperties",null,[]);class VJ{constructor(){u.AFrameworkApplication.ya.pa(Ra.a.LMa,Ld.a.frame,Object(v.a)(this,this.Adn,"reactFileMenuOpenFromTellMe"))}Adn(b,h,n,x,E){if(1===n||!E)return 32;b=E.SourceControlId;17!==E.UILocation||"New"!==b&&"Open"!==b||(E=[],Mg.d("setFileMenuSelectedPage")&&("New"===
b&&u.AFrameworkApplication.ua?2===u.AFrameworkApplication.ua.Sb.jo?E.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):E.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===b&&u.AFrameworkApplication.ua&&(2===u.AFrameworkApplication.ua.Sb.jo?E.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):E.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),E.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(E));return 32}Mii(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}kOa(){return!1}yDi(){}Xyh(){}}
Object(r.a)(VJ,"ReactFileMenu",null,[356]);class WJ{oZe(){const b=new VJ,h=[];h.push(appChrome.actions.updateFileMenuExpandedValue(!1));h.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(h);return b}}Object(r.a)(WJ,"ReactFileMenuFactory",null,[469]);class eD{constructor(b,h,n,x=!1){this.NKb=b;this.tJg=this.NKb.EZa;this.hVd=Oa.a.instance.Pa("Common.IOfficeTrialExperience");this.FEb=Oa.a.instance.Pa("Common.IMacOfficeOffer");eD.aie=!1;this.Ufm=x;this.ga=h;this.Wb=n}get Ac(){return this.ga}get Ai(){return this.Wb}rQe(){return this.tJg&&
!!this.hVd&&!!this.FEb}qQa(b,h){this.NKb.yq(()=>{w.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready");this.tJg=!0;this.w6e(b,h)});Oa.a.instance.Za("Common.IOfficeTrialExperience").execute(n=>{w.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready");this.hVd=n;this.w6e(b,h)});Oa.a.instance.Za("Common.IMacOfficeOffer").execute(n=>{w.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready");this.FEb=n;this.w6e(b,h)})}w6e(b,h){eD.aie||(this.rQe()?(w.ULS.sendTraceTag(5878051,
340,50,"ExecuteCallbackWhenReady: ready"),b(this,h),eD.aie=!0):w.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))}}eD.aie=!1;Object(r.a)(eD,"RibbonDependencies",null,[767]);class WG{constructor(b,h,n){this.dpb=b;this.ga=h;this.Wb=n}}Object(r.a)(WG,"WoncaRibbonUserFactory",null,[47]);class XJ{constructor(b,h){this.pje=b;this.OVb=h}ekb(b){this.pje.ekb(b);this.OVb&&this.OVb.ekb(b)}uZc(b){this.pje.uZc(b);this.OVb&&this.OVb.uZc(b)}Y2c(b){this.pje.Y2c(b);this.OVb&&this.OVb.Y2c(b)}}
Object(r.a)(XJ,"RibbonCommandTrimmer",null,[287]);var rP=d(1204);class YJ{constructor(b,h){this.Ma=b;this.ATb=h}ekb(b){V.a.ki&&6>V.a.OYa&&(b.fseaInsertPicture=!0);this.Ma.$("InsertSymbolIsEnabled")||(b.grpInsertSymbols=!0);this.Ma.$("ClipartInsertEnabled")||(b.fseaInsertClipart=!0);this.Ma.$("UIDiscoverabilityEnabled")||(b.jbtnAccessibilityHelp=!0);vA.a.ydi()||(b.InsertLoopComponentsForConsumers=!0);const h=this.Ma.$("InsertOnlinePictureEnabled"),n=u.AFrameworkApplication.Wpf();h||(b.fseaInsertOnlinePicture=
!0,b.fseaFlyInsertOnlinePictureFromSearch=!0);n?b.fseaInsertPictureFromOneDrive=!0:(b.fseaFlyInsertOnlinePictureFromHost=!0,b.fseaInsertOnlinePictureFromHost=!0);n&&h?(b.fseaInsertOnlinePicture=!0,b.fseaInsertOnlinePictureFromHost=!0):b.flyOnlinePicture=!0;u.AFrameworkApplication.Xpf()||(b.InsertPictureFromMobileDevice=!0,b.ChangePictureFromMobileDevice=!0);u.AFrameworkApplication.jae&&(b.btnOpenInClient=!0);u.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&u.AFrameworkApplication.K.$("DisablePrint")&&
this.jgc(b)}uZc(b){b.menuJewel=!0;u.AFrameworkApplication.mE||(b.jbtnGiveFeedback=!0)}jgc(b){b.faPrint=!0;b.jbtnSaveACopy=!0;b.jbtnSaveAsToHost=!0;b.jbtnSaveToSharePoint=!0;b.jbtnDownloadACopy=!0;b.jbtnDownloadAsPdf=!0;b.jbtnDownloadAsOdt=!0;b.jbtnPrintToPdf=!0;b.jbtnDirectPrint=!0}Y2c(b){delete b.menuJewel;u.AFrameworkApplication.Fib||(b.jbtnPrivacy=!0);u.AFrameworkApplication.AXc||(b.jbtnReportAbuse=!0);u.AFrameworkApplication.g$d||(b.jbtnTermsOfUse=!0);u.AFrameworkApplication.nBd||(b.jbtnFileSharing=
!0);Of.a.instance.J(4)&&u.AFrameworkApplication.hjb||(b.jbtnShareRWC=!0);u.AFrameworkApplication.y7e||u.AFrameworkApplication.b8f||(b.jbtnVersion=!0);this.ATb.hVd&&this.ATb.hVd.WLm||(b.btnjTryOffice=!0,b.btnjTryOfficeForWordEditor=!0);this.ATb.FEb&&this.ATb.FEb.ARn||(b.btnjTryMacOffice=!0,b.btnjTryMacOfficeForWordEditor=!0);u.AFrameworkApplication.jae?(b.btnjOpenInClient=!0,b.btnjEditInClient=!0):b[ob.App.vs?"btnjOpenInClient":"btnjEditInClient"]=!0;u.AFrameworkApplication.O9n&&(b.jbtnDownloadACopy=
!0,b.jbtnDownloadAsPdf=!0,b.jbtnDownloadAsOdt=!0);u.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&u.AFrameworkApplication.K.$("DisablePrint")?this.jgc(b):u.AFrameworkApplication.K.$("DirectPrintIsEnabled")?b.jbtnPrintToPdf=!0:b.jbtnDirectPrint=!0;u.AFrameworkApplication.fO&&(this.jgc(b),b.faShare=!0);if(u.AFrameworkApplication.protectFile||V.a.vMa||!u.AFrameworkApplication.uKc&&!u.AFrameworkApplication.p7e&&!u.AFrameworkApplication.$7f)b.jbtnFileEmbed=!0;rP.a.AZl()||(b.btnjClose=!0);u.AFrameworkApplication.Y6b?
(b.jbtnVersion=!0,w.ULS.sendTraceTag(594629315,3005,15,"Word external version history menu item for OneDriveConsummer trimmed.")):u.AFrameworkApplication.Zsf()||(b.btnjVersionHistory=!0);b.jbtnVersion&&b.btnjVersionHistory&&b.btnjOpenInClient&&b.btnjEditInClient&&(b.faInfo=!0);u.AFrameworkApplication.zOf||(b.faOpen=!0);b.jbtnFileSharing&&b.jbtnFileEmbed&&b.jbtnShareRWC&&(b.faShare=!0);b.AboutInformationMenuSectionDiagnostics=!this.Ma.$("DiagnosticsInfoInJewelAboutMenuIsEnabled");b.btnjTryOffice&&
b.btnjTryMacOffice&&b.jbtnTermsOfUse&&b.jbtnPrivacy&&b.AboutInformationMenuSectionDiagnostics&&(b.faAbout=!0);b.jbtnHelp&&b.jbtnGiveFeedback&&b.jbtnReportAbuse&&(b.faHelp=!0);b.btnjClose&&(b.msJewelSecondary=!0);const h=!!u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.Fei;if(b.faOpen&&b.faNew||!h)b.faHome=!0}}Object(r.a)(YJ,"WoncaCommandTrimmer",null,[287]);var sP=d(963);d(460);var tP=d(1015),uP=d(1118);class ZJ{constructor(b,h){this.u0=this.nJ=null;this._clientId=b;this.M8=h}H1k(){if(!ff.c(this.u0))return this.u0;
this.K5e();this.u0.style.display="block";this.M8&&this.M8.i1(Object(v.a)(this,this.onResize,"onResize"));return this.u0}onResize(){this.ava()}ava(){this.q5e()?(document.getElementById("application").style.minWidth="0px",(new uP.a(this.u0,null,u.AFrameworkApplication.isRtl)).jAn(this.u0)):u.AFrameworkApplication.ua.Sb.sI||tP.a.kAn(this.u0,u.AFrameworkApplication.isRtl)}q5e(){return u.AFrameworkApplication.K?u.AFrameworkApplication.K.$("EnhancedMobileViewIsEnabled"):!1}K5e(){if(ff.c(this.nJ)){var b;
({W3b:b}=Aj.a.ngc(!u.AFrameworkApplication.ZP)).returnValue&&(this.nJ=kF.a("div"),this.nJ.className=Aj.a.X3k,this.nJ.id=Vn.CuiHelper.KAd,b.appendChild(this.nJ),this.D5e(),u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.v6&&!u.AFrameworkApplication.ZP&&this.E5e(),this.G1k())}}G1k(){ff.c(this.u0)&&(this.u0=kF.a("div"),this.u0.className=Aj.a.C4f,this.u0.style.display="none",this.nJ.appendChild(this.u0))}D5e(){Sys.UI.DomElement.addCssClass(this.nJ,Aj.a.Y3k);u.AFrameworkApplication.isRtl&&kF.b(this.nJ,
"cui-rtl")}E5e(){Sys.UI.DomElement.addCssClass(this.nJ,"FlexBoxLayout")}}Object(r.a)(ZJ,"HeaderSkeleton",null,[]);var nE=d(624);class XG{constructor(){this.kic=null}Hao(){this.kic||(this.kic=Oa.a.instance.Pa("Common.App.AccountSwitching.IAccountSwitching"))||w.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}oel(){this.Hao();return this.kic?this.kic.getCustomAuthConfig():null}static W9l(){return u.AFrameworkApplication.K.$("UiHostSupportsCustomAuthConfig")}}Object(r.a)(XG,
"ReactSharedHeaderAccountSwitchingUtils",null,[]);class YG{constructor(){this.M7b=this.cultureName=null}}Object(r.a)(YG,"HeaderCultureInfo",null,[]);var zF=d(1533);class $J{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(r.a)($J,"SearchInitializationSettings",null,[]);var fD=d(286);class aK{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=
this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(r.a)(aK,"DocumentTitleAppProps",null,[]);class bK{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=
null;this.openBreadcrumbsInNewTab=!1}}Object(r.a)(bK,"DocumentTitleCalloutAppProps",null,[]);class cK{constructor(){this.language=this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=
this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(r.a)(cK,"HeaderAppProps",null,[]);class dK{constructor(){this.workflowButton=
this.ribbonToggleId=null}}Object(r.a)(dK,"HeaderControls",null,[]);class eK{constructor(){this.command=this.label=null}}Object(r.a)(eK,"WorkflowButtonAppProps",null,[]);var AF;(function(b){b[b.none=0]="none";b[b.readOnly=1]="readOnly";b[b.insufficientPermission=2]="insufficientPermission";b[b.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";b[b.editorsPresent=4]="editorsPresent";b[b.notSupported=5]="notSupported"})(AF||(AF={}));Object(r.b)("RenameDisableReason",AF);class fK{constructor(b=
""){this.KUf=this.documentTitleAppProps=this.g$f=null;this.IUj=""!==b?b:ig.a.y7}QDl(b){const h=Oa.a.instance.Pa("Common.IExternalUICommandDefinitionMapping").Vcb(b);if(h&&0<h.length)return h[0].externalUxCommand;w.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",b));return null}Thf(){if(!this.g$f){const b=nE.a();if(b){const h=this.QDl(b.command);h&&(this.g$f=Object.assign(new eK,{command:h,label:b.label}))}}return this.g$f}Dll(){return Object.assign(new dK,
{workflowButton:this.Thf()})}KPm(){cj.a.get_instance().KI(17)}onMove(){const b={};b.MoveButtonClickedTime=new Date;u.AFrameworkApplication.ya.Xb(Ra.a.$Eb,2,b)}mEl(b){switch(b){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}bol(){let b=null,h=null;var n=Oa.a.instance.Pa("Common.IRenameProps");
n?(n=n.pWh(),0!==n&&(b=this.mEl(n),h=AF[n])):w.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new bK,{breadcrumbBrandName:u.AFrameworkApplication.ut.breadcrumbBrandName,breadcrumbBrandUrl:u.AFrameworkApplication.ut.breadcrumbBrandUrl,breadcrumbFolderName:u.AFrameworkApplication.ut.breadcrumbFolderName,breadcrumbFolderUrl:u.AFrameworkApplication.ut.breadcrumbFolderUrl,hideDocumentTitleInput:u.AFrameworkApplication.ua.Sb.cWl,isVersionHistoryEnabled:this.NSn(),
documentExtension:B.a.WKa(u.AFrameworkApplication.fileName),isMoveEnabled:32===u.AFrameworkApplication.ya.processAction(Ra.a.$Eb,1),onMove:Object(v.a)(this,this.onMove,"onMove"),message:b,renameDisableReason:h,openBreadcrumbsInNewTab:u.AFrameworkApplication.K.$("OpenLinksInNewWindow")})}nOh(){if(!this.documentTitleAppProps){const b=u.AFrameworkApplication.ut.yz;this.documentTitleAppProps=Object.assign(new aK,{documentTitle:u.AFrameworkApplication.LDc?b:B.a.eI(b),onFirstRender:Object(v.a)(this,this.KPm,
"onDocumentTitleFirstRender"),getCalloutAppProps:Object(v.a)(this,this.bol,"getDocumentFlyoutProperties"),isShared:!1})}return this.documentTitleAppProps}NSn(){return!!u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.Cfi}EQn(){return!!u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.Bfi}vSn(){const b=!nE.b()&&!u.AFrameworkApplication.hideHeader&&!u.AFrameworkApplication.Mjf&&(u.AFrameworkApplication.K.$("SkypeWebControlIsEnabled")||u.AFrameworkApplication.K.$("TeamsChatIsEnabled"));
w.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",b);return b}TCk(b){appChrome.getHeaderApi().then(h=>{h.setNavBarData(b.result);return null});w.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}Zhn(b=!1){appChrome.getHeaderApi().then(h=>{const n=Oa.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");h.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});h.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});h.setHeaderCommandHandler("OnFlexPaneOpen",
x=>{n.onFlexPaneOpen(x)});h.setHeaderCommandHandler("OnFlexPaneClose",x=>{n.onFlexPaneClose(x)});h.setHeaderCommandHandler("SetCookie",x=>Ya.a.set(x.cookieName,x.value));h.setHeaderCommandHandler("GetCookie",x=>this.Fll(x));h.setHeaderCommandHandler("QueryWorkflowButtonSettings",Object(v.a)(this,this.Thf,"getWorkflowButtonAppProps"));b||(h.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(v.a)(this,this.nOh,"getDocumentTitleAppProps")),h.setHeaderCommandHandler("OnDocumentTitleReducerReady",
()=>{this.LPm();return null}));zF.a.UOd()&&h.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(v.a)(this,this.YWh,"getSearchInitializationSettings"))})}LPm(){Oa.a.instance.Za("Common.App.SaveStatus.ISaveStatusUIHandler").execute(b=>{b.Vlb(!1,u.AFrameworkApplication.ya.mode)})}Fll(b){b=Ya.a.get(b);void 0!==b&&null!==b&&0<b.length&&(b=decodeURIComponent(b));return b}GIl(){return fD.AppChromeOverrideUtilities.isEnabled?fD.AppChromeOverrideUtilities.pGd("suiteux-shell",!1):this.IUj+u.AFrameworkApplication.Maa+
"suiteux-shell"}onFirstRender(){Oa.a.instance.Za("Common.App.O365Shell.IO365ShellActor").execute(b=>{b.BPn.continueWith(Object(v.a)(this,this.TCk,"continueShellServiceDataAsync"),3)});cj.a.get_instance().KI(15)}onFullyLoaded(){cj.a.get_instance().KI(16)}OAa(b=!1){a:{try{var h=vj.a.lg(u.AFrameworkApplication.lcid);if(h){var n=Object.assign(new YG,{cultureName:h.name,M7b:h.M7b});break a}}catch(x){w.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+u.AFrameworkApplication.lcid.toString())}n=
Object.assign(new YG,{cultureName:"en-us",M7b:"en"})}h=Oa.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");n=Object.assign(new cK,{appName:CommonUIStrings.l_AppNameShort,culture:n.cultureName,language:n.M7b,isConsumer:!u.AFrameworkApplication.e8f,showAppLauncher:nE.g(),showMeControl:nE.f(),hideUserName:u.AFrameworkApplication.eKd,defaultDocumentTitleToLeft:u.AFrameworkApplication.Ovh,assetsContainerOverride:this.GIl(),controls:this.Dll(),documentTitleAppProps:b?null:this.nOh(),
showDocumentTitleControl:!b,showWorkflowButton:!!this.Thf(),showChatControl:this.vSn(),showGoPremiumControl:nE.h(),enableSearchControl:zF.a.Xhm(),onFlexPaneOpen:Object(v.a)(h,h.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(v.a)(h,h.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.EQn(),testTraffic:u.AFrameworkApplication.K.$("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(v.a)(this,this.onFirstRender,"onFirstRender"),onFullyLoaded:Object(v.a)(this,this.onFullyLoaded,"onFullyLoaded"),
enableUpdatedRUMReporting:u.AFrameworkApplication.FQn()});!u.AFrameworkApplication.s3c||u.AFrameworkApplication.O_f?(n.userDisplayName=u.AFrameworkApplication.userName,n.emailAddress=u.AFrameworkApplication.K.lb("UserPrincipalName"),n.userID=u.AFrameworkApplication.K.lb("Puid")||"",n.signOutLink=u.AFrameworkApplication.O_f):u.AFrameworkApplication.signInUrl&&(n.signInLink=u.AFrameworkApplication.signInUrl);zF.a.UOd()&&(h=this.YWh(),n.loadTellMeResources=h.loadTellMeResources,n.getTokenRequestDictionary=
h.getTokenRequestDictionary,n.enableVanillaSearchBox=u.AFrameworkApplication.K.$("VanillaSearchUxInHeaderIsEnabled"),n.userRing=h.userRing);XG.W9l()&&(h=new XG,n.shellAuthProviderConfigPromise=Object(v.a)(h,h.oel,"getAccountSwitchingConfig"));this.Zhn(b);return n}YWh(){if(!this.KUf){const b=new zF.a;let h=u.AFrameworkApplication.K.lb("Microsoft365Ring");h&&h.length||(h="generalAudience");this.KUf=Object.assign(new $J,{loadTellMeResources:b.rrm(),getTokenRequestDictionary:Object(v.a)(b,b.HKl,"getTokenRequestDict"),
userRing:h})}return this.KUf}}Object(r.a)(fK,"ReactSharedHeaderPropsHelper",null,[1063]);class ZG{constructor(){this.label=this.value=null}}Object(r.a)(ZG,"TextInfoSectionField",null,[]);var oE=d(731),BF=d(1026);class $G{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(r.a)($G,"CommandDefinition",null,[]);class gK{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(r.a)(gK,"CommandDefinitionMapping",
null,[]);const vP=b=>Object.assign(new gK,{getCommandByExternalUxId:h=>{const n=b.getCommandByExternalUxId(h);return n?Object.assign(new $G,{commandId:parseInt(n.commandId),externalUxCommand:n.externalUxCommand}):Object.assign(new $G,{externalUxCommand:h})},getDoNothingCommand:()=>parseInt(Ra.a.Bg),addCommandToMaps:Object(v.a)(b,b.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(v.a)(b,b.addIconToMap,"addIconToMap"),addTabToMap:Object(v.a)(b,b.addTabToMap,"addTabToMap")});var wP=d(1359);class hK{}
Object(r.a)(hK,"RibbonInitState",null,[]);var iK=d(444),xP=d(1311);class jK{constructor(){}flatten(b){const h=[];for(const n of b)h.push.apply(h,n);return h}}Object(r.a)(jK,"ReactAsyncDispatcher",null,[]);class CF{constructor(b,h){this.jt=null;this.Nid=!1;this.O7a=0;this.WLg="";this.$he={};this.Txe=b;this.Wb=h;this.NRg=Object(v.a)(this,this.XFf,"onModalMouseWheel");this.QKg=!!u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.Wla;this.$v=!!u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.u6}onMenuOpen(){0<
this.O7a?this.O7a++:(this.O7a++,u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>{window.setTimeout(Object(v.a)(this,this.mGi,"pushTransientFocusScope"),0)}):this.mGi(),this.showModal())}mGi(){this.Wb&&this.Wb.nK(xd.AFrame.gna,!0)}mil(){const b=Mg.f(),h=appChrome.selectors.getShyState();return String.format("{0}{1}",b,this.QKg&&h.isActive&&1===h.state?"_ShyRibbon":"")}SKl(b){var h=0;if(this.$v){if(this.$he[b])return this.$he[b];
(h=document.getElementById("BusinessBar"))||w.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");h=h?h.offsetTop:0;this.$he[b]=h}return h}showModal(){if(!this.jt)if(this.jt=this.createElement("div"),this.jt.setAttribute("id","ReactModalDiv"),this.jt.style.position="absolute",this.jt.style.bottom="0px",this.jt.style.left="0px",this.jt.style.right="0px",this.jt.style.backgroundColor="white",this.jt.style.opacity="0.0",this.$v){var b=
document.getElementById("regionComposerRoot");b&&b.appendChild(this.jt)}else this.Txe.appendChild(this.jt);b=this.mil();if(b!==this.WLg){const h=this.SKl(b),n=appChrome.selectors.getShyState();this.QKg&&n.isActive&&1===n.state&&Mg.a("getRibbonHeight")?this.jt.style.top=String.format("{0}px",h+appChrome.api.getRibbonHeight(Mg.f())):this.jt.style.top=String.format("{0}px",h);this.WLg=b}this.jt.style.display="block";this.jt.style.visibility="visible";this.jt.style.zIndex="1000";this.Nid||(window.addEventListener("wheel",
this.NRg,!0),this.iOd()?Xh.a.instance.mb(kb.a.$L,this.jt,Object(v.a)(this,this.DWd,"onModalPointerUp")):Xh.a.instance.mb(kb.a.pointerDown,this.jt,Object(v.a)(this,this.CWd,"onModalPointerDown")),this.Nid=!0)}onMenuClose(){this.O7a--;0<this.O7a||(0>this.O7a?this.O7a=0:this.z3h())}qEf(){this.O7a=0;this.W2e();this.z3h()}createElement(b){b=document.createElement(b);b.setAttribute("unselectable","on");return b}y3h(){this.Wb&&this.Wb.xg&&this.Wb.xg.name===xd.AFrame.gna&&!u.AFrameworkApplication.uc.Iv&&
this.Wb.GQ(xd.AFrame.gna,!1);this.jt&&(this.jt.style.zIndex="-1",this.jt.style.visibility="hidden",this.jt.style.display="none");this.Nid&&(window.removeEventListener("wheel",this.NRg,!0),this.iOd()?Xh.a.instance.sc(kb.a.$L,this.jt,Object(v.a)(this,this.DWd,"onModalPointerUp")):Xh.a.instance.sc(kb.a.pointerDown,this.jt,Object(v.a)(this,this.CWd,"onModalPointerDown")),this.Nid=!1)}z3h(){this.iOd()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.y3h()},0)}):this.y3h()}CWd(){this.wDc();
this.Iyh();this.qEf();this.Qjb();return!0}DWd(){this.wDc();this.Iyh();this.qEf();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Qjb()},0)});return!0}Qjb(){4===u.AFrameworkApplication.ua.Sb.jo&&u.AFrameworkApplication.K.$("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?u.AFrameworkApplication.ua.Qjb():this.Wb.Jg(xd.AFrame.Xp)}XFf(b){b.stopPropagation()}wDc(){const b=Oa.a.instance.Pa("Common.IReactContextualUILauncher");b&&b.wDc()}W2e(){const b=Oa.a.instance.Pa("Common.IReactContextualUILauncher");
b&&b.W2e()}Iyh(){u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.mMa&&(this.iOd()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}iOd(){return u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",!1)}}Object(r.a)(CF,"ReactModalDiv",null,[]);class kK{constructor(b,h){this.cUj=b;this.nxj=h}}Object(r.a)(kK,"ReactExecuteCommandContext",null,[]);class nw{}nw.Trigger=
"FontTrigger";nw.Name="FontName";nw.Action="FontAction";nw.Level="FontLevel";nw.IsPinned="FontIsPinned";Object(r.a)(nw,"FontPickerLogProperties",null,[]);class lK{constructor(b,h,n,x,E,S,ma,Fa,$a,sb=null,Jb=null){this.zY=null;this.yZg=!1;this.lne=[];this.i8c=-1;this.Emd=!1;this.qVj=0;this.gkc=null;this.dVg=!1;this.Cca=b;this.K8a=h;this.xXg=Object(ja.a)(852,b);this.Sm=n;this.Wb=x;E&&(this.zY=new CF(E,x));this.CRj=S;this.yBj=ma;this.Mt=sb;this.ga=Fa;this.uqb={};this.Ma=$a;this.Oeg=Jb;$a&&($a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",
!1)||$a.$("EnqueueTasksWhenTaskMgrIsYielding"))&&ai.a.instance.cyc.CWR(()=>this.yZg=!0);$a&&(b=this.Ma.lb("CommandControlIdPairsForLoggingOverride")||"")&&0<=b.trim().length&&({Dv:this.gkc}=z.d(b));this.gkc||(this.gkc={})}get ZUi(){return!!window.appChrome&&!!appChrome.selectors}yTi(){-1!==this.i8c&&window.clearTimeout(this.i8c);this.i8c=window.setTimeout(()=>{for(this.i8c=-1;0<this.lne.length;){if(Ye.a.instance.Iv){this.yTi();break}const b=this.lne.shift();b&&this.executeCommand(b.cUj,b.nxj)}},0)}executeCommand(b,
h){if(Ye.a.instance.Iv){if(this.yZg){this.lne.push(new kK(b,h));this.yTi();return}w.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",b,h.modelType,Ia.a.toJSON(h.payload));if(this.Ma.$("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(h){const n=this.Sm.getCommandByExternalUxId(b),x=h.modelType;this.Oeg&&this.Oeg.tum(b,h);n?this.M2k(b,
n,x,h):this.N2k(b,x,h);this.fsk(h);this.iCm(b,h)}}N2k(b,h,n){switch(h){case "GalleryModel":case "PreviewGalleryModel":this.TDh(n,b)}}Bio(b,h,n,x,E){if(n.payload)switch(n.payload.type){case "CoauthorMenuPayload":b.MenuItemId=n.payload.coauthorId;break;case "ButtonPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=n.payload.commandValueId;this.qda();break;case "ButtonPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=n.payload.commandValueId;E=h.commandPreviewId;break;case "ButtonRevertPreviewPayload":b.MenuItemId=
h.menuItemId;b.CommandValueId=n.payload.commandValueId;E=h.commandRevertId;break;default:b.MenuItemId=h.menuItemId}else b.MenuItemId=h.menuItemId;b.SourceControlId=x;return E}Cio(b,h,n){if(h.payload)switch(h.payload.type){case "MenuOpenPayload":b=this.Sm.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case "MenuClosePayload":b=this.Sm.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":n.CommandId=h.payload.executedControl;n.ControlId=h.payload.executedControl;
n.ParentControlId=h.payload.parentControl;n.CloseAllMenus=!0;this.qda();break;case "TellMeSearchResultChangePayload":n.Value=h.payload.searchText;break;case "SmartLookupPayload":n.CommandValueId=h.payload.selectionContextJson}return b}M2k(b,h,n,x){var E=this.K3m(x,n),S=h.commandId;const ma={},Fa={};switch(n){case "SplitButtonModel":if(this.MJc(x.payload,Object(v.a)(this,this.Cjo,"updateSplitButtonMenuState"),E))return;ma.MenuItemId=h.menuItemId;this.QXf(x,ma);break;case "StatefulSplitButtonModel":if(this.MJc(x.payload,
Object(v.a)(this,this.Ljo,"updateStatefulSplitButtonMenuState"),E))return;n=x.payload.statefulData;E=x.payload.statefulMode;"color"===E?ma.Color=n:"icon"===E&&(n=this.Sm.getCommandByExternalUxId(n))&&(ma.MenuItemId=n.menuItemId);break;case "FileMenu":ma.MenuItemId=h.menuItemId;ma.SourceControlId=b;x.payload&&"FileMenuPageSwitchPayload"===x.payload.type&&this.bRl(S,x.payload,b);break;case "TellMe":S=this.Cio(S,x,ma);ma.SourceControlId=b;ma.Location=x.payload.location;break;case "ButtonModel":x.payload&&
"TabSwitchPayload"===x.payload.type?this.PSl(ma,x):S=this.Bio(ma,h,x,b,S);break;case "CompoundButtonModel":ma.MenuItemId=h.menuItemId;ma.CommandValueId=x.payload.commandValueId;ma.SourceControlId=b;this.QXf(x,ma);this.qda();break;case "ToggleButtonModel":case "InkButtonModel":ma.MenuItemId=h.menuItemId;ma.SourceControlId=b;this.QXf(x,ma);this.qda();break;case "FontPickerModel":switch(x.payload.type){case "MenuOpenPayload":return;case "MenuClosePayload":S=this.Sm.getCommandByExternalUxId("FontPickerMenuClose").commandId;
ma[aD.a.FontPickerId]=x.payload.launcherId;break;case "FontPickerFontSelectedPayload":n=x.payload.font;E=null;"string"===typeof n?(E=Uo.FontUtils.qNa(n),ma.CommandValueId=E,E=Uo.FontUtils.Fwd(E)):(n.data?(ma.CommandValueId=n.data.fontToApply,ma.MenuItemId=n.data.themeIndex,ma[aD.a.Formatting]=n.data):ma.CommandValueId=n.name,E=n);ma.SourceControlId=b;ma[aD.a.RequestUpdateMru]=E;Fa[nw.Name]=x.payload.nameToLog?x.payload.nameToLog:"string"===typeof n?Uo.FontUtils.OMd(n)?"*"+n:Uo.FontUtils.Uof(n)?"[EF]":
"[MF]":"";Fa[nw.IsPinned]=x.payload.isPinned;Fa[nw.Level]=x.payload.level;this.bwf();break;case "FontPickerFontInfoRequestedPayload":ma.CommandValueId=x.payload.font.name;ma[aD.a.Trigger]=x.payload.trigger;Fa[nw.Trigger]=x.payload.trigger;Fa[nw.Name]=x.payload.nameToLog;this.bwf();break;case "FontPickerFontPinningPayload":n=x.payload.isPinned;ma.CommandValueId=x.payload.fontKey;ma[aD.a.IsPinned]=n;Fa[nw.Name]=x.payload.nameToLog;Fa[nw.Action]=n?"pin":"unpin";Fa[nw.Level]=x.payload.level;this.bwf();
break;default:return}break;case "ComboBoxModel":var $a=x.payload.type;switch($a){case "MenuOpenPayload":case "MenuPopulatePayload":this.Rdc(x.payload.launcherId,E)&&(S={},S[x.payload.launcherId]=n,this.K8a.jUc(S,Mg.g(x.payload)),this.uqb[b]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":n=x.payload.newValue;if(!n)return;n.value?(ma[Ol.a.Value]=n.value,ma[Ol.a.IsFreeForm]=!0):(ma[Ol.a.Value]=n.text,ma.MenuItemId=n.key,ma.CommandValueId=n.commandValueId);
"ComboBoxPreviewPayload"===$a&&(S=h.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":S=h.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(x.payload.type){case "ZeroTermContextMenuClosePayload":n=Ia.a.ON(x.payload);for($a of n)ma[$a]=x.payload[$a];break;default:this.MJc(x.payload,Object(v.a)(this,this.ggo,"updateFlyoutAnchorMenuState"),E),ma.launcherId=x.payload.launcherId}break;case "InkFlyoutAnchorModel":this.MJc(x.payload,Object(v.a)(this,this.eho,"updateInkFlyoutAnchorMenuState"),
E);ma.launcherId=x.payload.launcherId;break;case "ColorPickerModel":switch(x.payload.type){case "ColorPickerPayload":ma[Jm.Color]=x.payload.selectedColorId;break;case "ColorPickerPreviewPayload":S=h.commandPreviewId;ma[Jm.Color]=x.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":S=h.commandRevertId;break;default:return}break;case "SpinButtonModel":ma[rc.a.Number]=x.payload.value;ma[rc.a.UnitType]=Jf.a.Jwb(x.payload.unitType.toLowerCase());ma[rc.a.Text]=x.payload.reservedValue;
break;case "SliderModel":ma[zc.Value]=x.payload.value;break;case "InsertTableModel":ma[ib.a.Rows]=x.payload.rows;ma[ib.a.Columns]=x.payload.columns;break;case "CheckboxModel":ma[Qf.a.On]=x.payload.checked;ma.MenuItemId=h.menuItemId;break;case "PreviewGalleryModel":if(this.MJc(x.payload,Object(v.a)(this,this.Mio,"updatePreviewGalleryMenuState"),E)){ma.launcherId=x.payload.launcherId;break}this.TDh(x,b);return;case "DocumentTitleModel":switch(x.payload.type){case "DocumentTitleRenamePayload":ma.getNewDocumentTitle=
x.payload.getNewDocumentTitle;break;case "MenuOpenPayload":S={};S[x.payload.launcherId]=n;this.K8a.jUc(S,Mg.g(x.payload));this.uqb[b]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":ma.MenuItemId=x.payload.url;this.qvm(x.payload.pageId);break;case "NewBlankDocumentModel":case "CustomTemplateModel":ma.MenuItemId=x.payload.assetId;ma.SourceControlId=b;this.rvm(x.payload.pageId);break;case "CoauthorGallery":ma.RenderTime=x.triggerTime;break;case "PeopleWell":ma.RenderTime=
x.triggerTime;break;case "SyncStatus":ma.SourceControlId=b;break;case "InputBoxModel":ma.Text=x.payload.newValue;break;case "PersonaButtonModel":ma.CommandValueId=x.payload.commandValueId;this.aSl(x.payload);break;default:return}S&&!this.isShadowMenuOpen(x.payload)&&(ma.CommandValueId||(ma.CommandValueId=ma.MenuItemId),h.legacyControlId&&(ma.LegacyId=h.legacyControlId),ma.SourceControlId||(ma.SqmControlId=b),this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&ma.launcherId&&(h=this.Sm.getCommandByExternalUxId(ma.launcherId))&&(ma.launcherCommandId=parseInt(h.commandId)),x.payload&&!ff.c(x.payload.PRIReadinessCheck)&&(ma.PRIReadinessCheck=x.payload.PRIReadinessCheck,this.dVg=!0),x.payload&&!ff.c(x.payload.shouldTakeFocus)&&(ma[Az.a.q2a]=x.payload.shouldTakeFocus),h=this.J6g(x,ma),ff.c(x.triggerTime)||(Fa.TriggerTime=x.triggerTime),x.payload&&!ff.c(x.payload.userActionKey)&&(Fa.userActionKey=x.payload.userActionKey),this.Ma&&this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",
!1)&&(n=x.payload&&!ff.c(x.payload.launcherId)?x.payload.launcherId:this.Tyl(b,S),Fa.ControlId=n),this.Ma&&this.Ma.$("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&x.payload&&(ff.c(x.payload.terminalParentControlId)||(Fa.TerminalParentControlId=x.payload.terminalParentControlId)),this.xXg.executeCommand(S,ma,this.getSelectedTabId(),h,!0,()=>{this.sqi(ma,b)},Fa,Mg.g(x.payload)))}Tyl(b,h){h=parseInt(h);h=pd.ActionManager.xWe(h)||pd.ActionManager.Sca(h)||"";return!ff.c(h)&&h in this.gkc?this.gkc[h]:
100<b.length?"":b}bwf(){this.Mt&&this.Mt.execute(b=>{b.Ovf("ModernFontPickerExperience")})}J6g(b,h){let n=2;b.payload&&"inputMethod"in b.payload&&b.payload.inputMethod&&(n=b.payload.inputMethod,h[Az.a.Qw]=n);return n}sqi(b,h){const n=Object(ja.a)(xd.AFrame,u.AFrameworkApplication.ua);if(this.Wb&&this.u1i(b)){if(!this.Wb.xg&&n){let x="null";if(b){const E=b.Value;delete b.Value;x=Ia.a.toJSON(b);ff.c(E)||(b.Value=E)}w.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",
h,x,n.J1a)}this.Wb.JHh()}(this.Wb&&this.Wb.xg&&this.Wb.xg.name!==xd.AFrame.gna&&n&&this.Wb.xg.name!==n.J1a||this.u1i(b))&&this.qxk(b)}u1i(b){return!!b&&!ff.c(b[Az.a.q2a])&&b[Az.a.q2a]}qxk(b){Az.a.Qw in b&&1===b[Az.a.Qw]&&oE.ShyRibbon.gab(1,0)}PSl(b,h){this.Cca.xl();if(this.CRj&&this.ga){const n={};n[RJ.a.r2f]=h.payload.tabId;this.ga.Xb(Ra.a.EXc,2,n,this.xea(h));ff.c(h.payload.inputMethod)||(this.ga.processAction(Ra.a.kPi,2),this.Emd||this.BWn(h.payload.tabId))}h=h.payload.tabId;b.NewContextId=h;b.NewContextCommand=
this.Sm.Jgf(h);w.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+h);if(this.Mt&&h){const n=h+"TabSwitchActivity";this.Mt.execute(x=>{x.Ovf(n)})}}MJc(b,h,n){const x=b.type;return"MenuClosePayload"===x?!0:"MenuOpenPayload"===x?(h(b,n),!0):!1}aSl(b){b=b.type;"MenuOpenPayload"===b?u.AFrameworkApplication.bfc=!0:"MenuClosePayload"===b&&(u.AFrameworkApplication.bfc=!1)}K3m(b,h){if(!b.payload||!b.payload.launcherId||"MenuOpenPayload"!==b.payload.type&&"MenuPopulatePayload"!==b.payload.type)return!1;
const n=b.payload.launcherId,x=this.Sm.getCommandByExternalUxId(n);return x&&x.populationProps?((b=this.K8a.tKf(x,h,b.payload))&&n in this.uqb&&delete this.uqb[n],b):!1}ggo(b,h){const n=b.launcherId;this.Rdc(n,h)&&(h=appChrome.selectors.getFlyoutAnchorMenuItems(n),this.Kgc(h,n,Mg.g(b)))}eho(b,h){const n=b.launcherId;this.Rdc(n,h)&&(h=Mg.i("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(n):appChrome.selectors.getFlyoutAnchorMenuItems(n),this.Kgc(h,n,Mg.g(b)))}Mio(b,h){const n=
b.launcherId;this.Rdc(n,h)&&(h=appChrome.selectors.getPreviewGalleryMenuItems(n),this.Kgc(h,n,Mg.g(b)))}Cjo(b,h){const n=b.launcherId;this.Rdc(n,h)&&(h=appChrome.selectors.getSplitButtonMenuItems(n),this.Kgc(h,n,Mg.g(b)))}Ljo(b,h){const n=b.launcherId;this.Rdc(n,h)&&(h=appChrome.selectors.getStatefulSplitButtonMenuItems(n),this.Kgc(h,n,Mg.g(b)))}getSelectedTabId(){return this.ZUi?appChrome.selectors.getSelectedTabId():null}Kgc(b,h,n){this.K8a.jUc(b,n);this.uqb[h]=new Date}Rdc(b,h){let n=!0;b in this.uqb&&
(n=this.uqb[b].getTime()<this.Cca.dma.getTime());return n&&!h&&this.ZUi}TDh(b,h){const n={};var x=b.payload.selectedGalleryId;const E=this.Sm.getCommandByExternalUxId(x);E&&(n.SourceControlId=x,n.MenuItemId=E.menuItemId,n.SqmControlId=h,E.legacyControlId&&(n.LegacyId=E.legacyControlId),b.payload&&!ff.c(b.payload.shouldTakeFocus)&&(n[Az.a.q2a]=b.payload.shouldTakeFocus),this.tBl(b.payload,n),x=this.J6g(b,n),this.xXg.executeCommand(E.commandId,n,this.getSelectedTabId(),x,!0,()=>{this.sqi(n,h)},this.xea(b),
Mg.g(b.payload)))}tBl(b,h){"CharacterGalleryPayload"===b.type&&(h.MenuItemId=b.character)}QXf(b,h){b.payload&&"toggled"in b.payload&&(h[Qf.a.On]=b.payload.toggled)}iCm(b,h){if("MenuOpen"===b){if(this.zY&&!("isShadowRendering"in h.payload&&h.payload.isShadowRendering))this.zY.onMenuOpen()}else if("MenuClose"===b&&this.zY)this.zY.onMenuClose()}qda(){this.zY&&this.zY.qEf()}xea(b){let h=null;ff.c(b.triggerTime)||(h={},h.TriggerTime=b.triggerTime);return h}bRl(b,h,n){if(this.yBj&&this.ga){const x={};x[PJ.a.pageId]=
n;this.ga.Xb(Ra.a.DXc,2,x)}this.Kgc(h.pageControlIdMap,b,Mg.g(h))}rvm(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(Ra.a.pPi,2);break;case "FileNewPage":this.ga.processAction(Ra.a.qPi,2)}}qvm(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(Ra.a.TOi,2);break;case "FileOpenPage":this.ga.processAction(Ra.a.UOi,2)}}isShadowMenuOpen(b){return!!b&&"MenuOpenPayload"===b.type&&b.isShadowRendering}BWn(b){if(u.AFrameworkApplication.K.$("TellMeHelpCoachMarkActivityEnabled")&&
"Help"===b)this.Mt.execute(h=>{h.logActivity("TellMeHelpCoachMarkActivity",null)}),this.Emd=!0;else{if(u.AFrameworkApplication.K.$("TellMe3TabSwitchCoachMarkActivityEnabled")&&(this.Mt.execute(h=>{h.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.qVj)){this.Emd=!0;return}u.AFrameworkApplication.K.$("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.ga.processAction(Ra.a.YJb,2)&&(this.Emd=!0)}}fsk(b){b&&b.payload&&b.payload.PRIReadinessCheck&&!this.dVg&&appChrome.PRIToastManager.dismissToast()}}
Object(r.a)(lK,"ReactExecuteCommandHandler",null,[]);class mK{constructor(){this.fileMenu=null}get Wlb(){return 0}get H_a(){return 0}get wCa(){return!1}ava(){}A$i(){}hZ(){return!1}nXi(){}M1(){return!1}SEa(b){return this.fileMenu&&this.fileMenu.kOa(b)?!0:!1}get Iga(){return!1}Ljb(){}ZMd(){return!1}get Cvd(){return null}set Cvd(b){}gda(){}Q9(){}Ehf(){return null}kKa(){}refresh(){}get controls(){return null}pbc(){return!1}wab(){}xl(){}get kE(){return null}set kE(b){}B2c(){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}
Object(r.a)(mK,"ReactRibbonExternal",null,[339,286,340]);class nK{constructor(b,h,n,x){this.Wb=b;this.ga=h;this.T3g=n;this.BTb=x}initialize(){this.ga.pa(Ra.a.G3d,Ld.a.frame,Object(v.a)(this,this.tRi,"ribbonMoveForwardAction"));this.ga.pa(Ra.a.F3d,Ld.a.frame,Object(v.a)(this,this.sRi,"ribbonMoveBackwardAction"));this.ga.pa(Ra.a.E3d,Ld.a.frame,Object(v.a)(this,this.pRi,"ribbonEscAction"));var b=Aj.a.Ulf(this.BTb,null,this.T3g,!1);b.LL=!0;this.nbc(b,Ra.a.G3d,Ra.a.F3d);b.bindAction(mc.KeyInputManager.mc(db.a.R3a,
0),Ra.a.E3d);b=this.Wb.pe(xd.AFrame.gna);b.LL=!0;this.nbc(b,Ra.a.JWa,Ra.a.JWa);sf.a.instance.mb(kb.a.Vw,this.T3g,Object(v.a)(this,this.FUm,"onRibbonMouseDown"));b=ln.a.instance;Mg.a("enterKeytipMode")&&b.uKn(this.BTb,()=>{appChrome.api.enterKeytipMode(!1)});Mg.a("exitKeytipMode")&&b.qKn(this.BTb,()=>{appChrome.api.exitKeytipMode();oE.ShyRibbon.gab(1,0)});u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.Wla&&(b=Object(ja.a)(de.FocusManager,this.Wb))&&b.Z5j(Object(v.a)(this,this.uQm,"onFocusScopeChanged"))}uQm(b,
h){if((b=Object(ja.a)(xd.AFrame,u.AFrameworkApplication.ua))&&h.$ri&&u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.Wla){const n=appChrome.selectors.getShyState();n.isActive&&h.$ri.name===b.J1a&&oE.ShyRibbon.gab(n.state,1)}}tRi(){return 4}sRi(){return 4}pRi(){Mg.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.Wla&&appChrome.selectors.getShyState().isActive&&oE.ShyRibbon.gab(1,0),this.Wb.Jg(xd.AFrame.Xp));return 4}nbc(b,h,n){const x=
mc.KeyInputManager.mc(db.a.fx,0),E=mc.KeyInputManager.mc(db.a.fx,4);b.Ar(x);b.Ar(E);b.bindAction(x,h);b.bindAction(E,n)}FUm(b){b.Ib&&b.Ib.target&&"input"!==b.Ib.target.tagName.toLowerCase()&&b.Ib.preventDefault();return!1}dispose(){this.ga.Vy(Ra.a.G3d,Ld.a.frame,Object(v.a)(this,this.tRi,"ribbonMoveForwardAction"));this.ga.Vy(Ra.a.F3d,Ld.a.frame,Object(v.a)(this,this.sRi,"ribbonMoveBackwardAction"));this.ga.Vy(Ra.a.E3d,Ld.a.frame,Object(v.a)(this,this.pRi,"ribbonEscAction"))}}Object(r.a)(nK,"ReactRibbonFocusManager",
null,[10]);class Ez{constructor(b,h,n,x,E,S,ma,Fa=null,$a=!0,sb=null,Jb=null){this.r6a=this.Ind=this.mje=this.Cca=null;this.$Yg=[];this.Ajd=null;this.cIa=b;this.Txe=h;this.BTb=n;this.Wb=x;this.ga=E;this.Sm=S;this.Cca=sb?sb:new jF(Yu.instance,this.Sm);this.Apc=ma;this.nXg=new mK;this.dIa=Fa;this.QFe=$a;new jK;this.KCg=Jb;cj.a.get_instance().sl(7,Object(v.a)(this,this.KLn,"setRibbonPostInteractiveReady"));cj.a.get_instance().sl(7,Object(v.a)(this,this.$ym,"logRibbonLoadedActivity"));cj.a.get_instance().sl(19,
Object(v.a)(this,this.Wtm,"logAppLoadedActivity"));u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&cj.a.get_instance().sl(7,Object(v.a)(this,this.oln,"registerSubComponentReporting"));cj.a.get_instance().sl(7,Object(v.a)(this,this.rbn,"queueSettingsDependentActions"))}initialize(b,h,n=null){this.QFe||this.KI(5);n?n.then(()=>{this.cOi()}).catch(()=>w.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):
iK.a.p1c(iK.a.p1c(aj.Task.WAA(this.$ji(b),this.Zji(Ez.Fxj)),()=>this.Zji(Ez.Ztj)),()=>this.$ji(h)).continueWith(()=>{this.cOi()},11)}dispose(){this.Hbo();this.r6a&&this.r6a.Xyh();this.Ajd&&this.Ajd.dispose();for(const b of this.$Yg)cj.a.get_instance().quk(b);u.AFrameworkApplication.ya.Vy(Ra.a.Zsn,Ld.a.frame,pd.ActionManager.Nf)}Zji(b){return Oa.a.instance.resolve("Common.ISharedDependencyLoader").n8b(u.AFrameworkApplication.vw(b,2))}$ji(b){return""===b?aj.Task.W9(!0):Oa.a.instance.resolve("Common.ISharedDependencyLoader").n8b(u.AFrameworkApplication.vw(b,
3))}a2l(){(this.dIa||this.Apc)&&appChrome.api.dispatch(this.YZh());this.CNn();Mg.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(u.AFrameworkApplication.r_);this.Cca.xl()}cOi(){this.a2l();this.QFe&&(appChrome.renderAppChrome(this.cIa,Mg.e()),this.KI(10));this.U5g();this.WSe();this.QFe&&this.KI(5);this.u6h()}u6h(){this.Wb&&this.ga&&this.BTb&&(this.Ajd=new nK(this.Wb,this.ga,this.cIa,this.BTb),this.Ajd.initialize())}get cYc(){return this.nXg}setCommandDefinitionMapping(){if(Mg.a("setCommandDefinitionMapping")){const b=
vP(this.Sm);appChrome.api.setCommandDefinitionMapping(b)}}registerOnShyRibbonStateChange(){u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.Wla&&Mg.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((b,h)=>{0===h&&this.tac()})}U5g(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const b=Object(ja.a)(jF,this.Cca);this.mje=new lK(this.Cca,b.mbc,this.Sm,this.Wb,this.Txe,Oa.a.instance.Pa("Common.IRibbonSQMInformation"),Oa.a.instance.Pa("Common.IFileMenuSQMInformation"),
u.AFrameworkApplication.ya,u.AFrameworkApplication.K,Oa.a.instance.Za("Common.ISystemInitiatedFeedback"),null);this.Cgk();this.bQl()}Cgk(){this.Ind=appChrome.api.bindCommandHandler((b,h)=>{this.mje.executeCommand(b,h)})}Hbo(){this.Ind&&(this.Ind(),this.Ind=null)}CNn(){appChrome.api.initializeLogger(new ml.a)}NAa(){return this.Cca?this.Cca.NAa():[]}tac(){oo.a.instance.Pd(()=>{let b=null;oo.a.instance.Pd(()=>{b=this.NAa()},"RB:GA");b&&0<b.length&&(this.Cca.dma=new Date,oo.a.instance.Pd(()=>{appChrome.api.dispatch(b)},
"RB:DA"));this.r6a&&oo.a.instance.Pd(()=>{this.r6a.yDi()},"RB:J")},"RB:PFSU")}M2c(){this.Cca.M2c()}DFb(){}UZj(b){b=[appChrome.actions.activateDeactivateContextualTab(b,!0),appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}setCurrentTab(b){b=[appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}YZh(){var b=u.AFrameworkApplication.K;const h=[];b.$("EnableTellMeForOneLineRibbonIsEnabled")?b.$("OcpsIsEnabled")&&Oa.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(n=>
{n.isFeatureEnabled("ConnectedServices",!0).then(x=>{x&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):h.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));h.push.apply(h,this.ZOh());b=new wP.a(this.Sm);this.dIa.WF&&(xP.a.R9n(this.dIa.WF),h.push.apply(h,b.YCd(this.dIa.WF)));if(this.dIa.vbj)for(const n of this.dIa.vbj)h.push(appChrome.actions.updateGallerySectionHiddenState(n.gJh,n.fHo,n.gJo));h.push.apply(h,b.XJh(this.dIa.xbj));
return h}ZOh(){const b=[];if(this.Apc&&this.Apc.WF){const n=this.Apc.WF;for(let x in n){var h=n[x];const E=this.Sm.pcf(x);if(E)for(let S of E)b.push(appChrome.actions.updateControlHiddenState(S,h))}}return b}OEa(b){b&&this.Cca.mbc.jUc(b,0)}tKf(b){this.Cca.mbc.tKf(this.Sm.getCommandByExternalUxId(b),appChrome.selectors.getModelType(b),{inputMethod:0})}GVk(){const b=u.AFrameworkApplication.K.$("ShareMenuIsEnabled")?"ShareMenu":"Share",h=u.AFrameworkApplication.K.appSettings;h&&appChrome.api.dispatch(this.xjo(b,
"Shared"===(h.SharingStatus||"")))}rbn(){u.AFrameworkApplication.K.yq(()=>{this.GVk()})}xjo(b,h){return appChrome.actions.updateSharingStatusIndicator(b,h)}hHl(b){return appChrome.actions.updateControlHiddenState(b,!1)}iHl(){return appChrome.actions.updateControlHiddenState("CopyLink",!1)}KI(b){cj.a.get_instance().KI(b);this.$Yg.push(b)}KLn(){Mg.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new hK,{postRibbonInteractiveReady:!0})))}WSe(){this.Apc&&
this.KCg&&(this.r6a=this.KCg.oZe(),this.nXg.fileMenu=this.r6a)}xom(b,h){this.r6a&&this.r6a.Mii(b,h)}JTf(b,h,n){if(1===n)return 32;this.aZi(!0);this.tac();u.AFrameworkApplication.ua.updateCommandUI();return 32}KTf(b,h,n){if(1===n)return 32;this.aZi(!1);this.VLn();this.tac();u.AFrameworkApplication.ua.updateCommandUI();return 32}VLn(){Ya.a.hPa(u.AFrameworkApplication.K.lb("IsSimplifiedRibbonOnCookieName"),"true",Ya.a.eNa)}aZi(b){Ya.a.hPa(u.AFrameworkApplication.K.lb("ReactRibbonMLRPreferenceCookieName"),
b.toString(),Ya.a.eNa)}$ym(){if(u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.aq){const b=Oa.a.instance.Za("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?(b.execute(h=>{h.logActivity("SingleRibbonModeActivity",null)}),u.AFrameworkApplication.eaa("d79fg304;61jba833")):"Multiline"===appChrome.selectors.getRibbonMode()&&(b.execute(h=>{h.logActivity("MultiRibbonModeActivity",null)}),u.AFrameworkApplication.eaa("69a7h198;dfd7j584"))}}Wtm(){const b=Ya.a.Lka(u.AFrameworkApplication.K.lb("VNextStyleOptOutCookieName"),
!1);b||u.AFrameworkApplication.F6("figcd484;g3d56671");window.setTimeout(()=>{const h=Oa.a.instance.Za("Common.ISystemInitiatedFeedback");h&&(u.AFrameworkApplication.K.$("Fluent2StyleIsEnabled")?(h.execute(n=>{n.logActivity("VNextStylesOn",null)}),h.execute(n=>{n.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):u.AFrameworkApplication.K.$("Fluent2StyleFGOnlyIsEnabled")&&b&&h.execute(n=>{n.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},
5E3)}oln(){cj.a.get_instance().sl(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",!1)});const b=appChrome.api.getRibbonSubComponentMappings();for(let n in b){var h=n;const x=b[n];if(x)for(const E of x)u.AFrameworkApplication.ya.V5(E)?appChrome.api.reportRibbonSubComponentBehaviorMapped(h):u.AFrameworkApplication.ya.nKn(E,this.RJk(h));else appChrome.api.reportRibbonSubComponentBehaviorMapped(h)}}RJk(b){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}bQl(){if(u.AFrameworkApplication.K&&
u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Mg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&u.AFrameworkApplication.fac.bMe){const b=u.AFrameworkApplication.fac.bMe,h=u.AFrameworkApplication.fac.v5g;h.payload||(h.payload={});const n=h.payload.launcherId?h.payload.launcherId:b;Ez.vRi.xb(n)?Ez.vRi.J(n)():"StatefulSplitButtonModel"===h.modelType?appChrome.PRIToastManager.dismissToast():
(h.payload.PRIReadinessCheck=!0,this.mje.executeCommand(b,h))}}}Ez.Fxj="common";Ez.Ztj="appChrome";Ez.vRi=new BF.a(da.a.pJc());Object(r.a)(Ez,"ReactRibbonUser",null,[755,137,10]);class aH extends Ez{constructor(b,h,n,x,E,S,ma,Fa,$a=null,sb=!0,Jb=null,Sb=null){super(b,h,x,E,S,ma,Fa,$a,sb,Jb,Sb);this.dad=null;this.dpb=n;this.dpb.execute(oc=>{this.dad=oc});this.dpb.execute(oc=>{this.Cca.kE=oc})}NAa(){return this.dad?(this.dad.clearCache(),super.NAa()):[]}DFb(b){if(!b)throw Error.argumentNull();this.dpb.execute(h=>
{b.kE=h})}}Object(r.a)(aH,"ReactRibbonUser",Ez,[]);var yP=d(957);class pE extends aH{constructor(b,h,n,x,E,S,ma,Fa,$a,sb=!0,Jb=null,Sb=null){super(h,b.Xza,x,Qe.AppFrame.qna,E.Ai,E.Ac,ma,Fa,$a,sb,Jb,Sb);if(void 0===b||null===b)throw Error.argumentNull("hostingAppFrame");this.Hqe=b;this.M8=S;E.qQa(()=>{this.gjo();u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayUIComponentsUntilAfterRibbon",!1)?cj.a.get_instance().sl(7,()=>{this.m6h()}):this.m6h()},null)}get Bof(){return!!u.AFrameworkApplication.K.appSettings.BootActivityNavigationId}m6h(){this.bIk();
this.oZe();this.ain()}gjo(){this.cIa.classList.add("FlexBoxLayout");this.Hqe.Qka().classList.add("cui-exth");this.Hqe.Qka().classList.add("FlexBoxLayout");this.Hqe.Qka().classList.add("ScrollableRibbon")}bIk(){u.AFrameworkApplication.ZP||this.PLk()}PLk(){if(!u.AFrameworkApplication.ZP){var b=(new ZJ(pE.ARj,this.M8)).H1k(),h=Aj.a.Ulf(Qe.AppFrame.zLa,null,b,!0);h.LL=!0;this.nbc(h,Ra.a.G3d,Ra.a.F3d);h.bindAction(mc.KeyInputManager.mc(db.a.R3a,0),Ra.a.E3d);tB(1,()=>{this.qrn(b)})}}qrn(b){const h=new fK;
appChrome.renderSharedHeader(b,h.OAa()).then(Object(v.a)(this,this.Y2e,"dismissFastViewHeader"))}XLi(){u.AFrameworkApplication.ua.Sb.Afi?appChrome.getHeaderApi().then(b=>{document.getElementById(u.AFrameworkApplication.bcb).classList.remove("Placeholder");return b.dismissPlaceholder()}):(new yP.a).Y2e()}Y2e(){this.Bof&&u.AFrameworkApplication.eaa("Microsoft.Office.Web.SessionSettings.IWacWordImprovedDeepLinkLoadSettings");this.Bof&&u.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?(cj.a.get_instance().sl(12,
Object(v.a)(this,this.XLi,"removeHeaderPlaceholder"),11),w.ULS.sendTraceTag(42316515,338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):this.XLi()}nbc(b,h,n){const x=mc.KeyInputManager.mc(db.a.fx,0),E=mc.KeyInputManager.mc(db.a.fx,4);b.Ar(x);b.Ar(E);b.bindAction(x,h);b.bindAction(E,n)}oZe(){const b=!!this.dIa&&"FileMenu"in this.dIa.xbj;u.AFrameworkApplication.ua.Sb.mMa&&!b&&tB(1,Object(v.a)(this,this.Pqn,"renderFileMenu"))}Pqn(){const b=[];if(u.AFrameworkApplication.K.$("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var h=
[Object.assign(new ZG,{label:CommonUIStrings.L_DiagnosticsSessionId,value:u.AFrameworkApplication.userSessionId}),Object.assign(new ZG,{label:CommonUIStrings.L_DiagnosticsBuild,value:u.AFrameworkApplication.buildVersion})];b.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",h))}b.push.apply(b,this.ZOh());h=document.createElement("div");document.body.appendChild(h);appChrome.renderFileMenu(h,b)}ain(){this.ga.pa(Ra.a.FPa,cc.a.view,Object(v.a)(this,this.FPa,"tabSwitch"));this.ga.pa(Ra.a.JTf,
cc.a.view,Object(v.a)(this,this.JTf,"ribbonModeToggledToMLR"));this.ga.pa(Ra.a.KTf,cc.a.view,Object(v.a)(this,this.KTf,"ribbonModeToggledToSLR"))}activateRibbonTab(b){this.UZj(b)}tac(){cj.a.get_instance().isCompleted(7)&&this.dad&&(ue.a.mark(4893),Nt.a.Lio(),super.tac(),ue.a.mark(4894))}FPa(b,h,n,x,E){if(2===E[Az.a.Qw]){if(n=Object(ja.a)(fi.a,h))x=Object(ja.a)(ew.a,n.view);else return w.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",
Object.getTypeName(h),b,Ia.a.join(E," ",":")),8;if(x&&""!==x.aI)Ee.a.Jla(h)&&Ee.a.rCb()||(this.Wb.Jg(x.aI),appChrome.selectors.getShyState().isActive&&oE.ShyRibbon.gab(0,1));else return w.ULS.sendTraceTag(38549529,338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",Object.getTypeName(n.view),b,Ia.a.join(E," ",":"),this.gul(n.view)),8}return 32}gul(b){return b?"is ContentEditableView: "+b.Cj+" is Editing View: "+b.jta+
" is FishbowlView: "+b.UBa+" is HtmlView: "+b.HZa+" is InteractiveView: "+b.Be+" is NavigationPaneView: "+b.mdi+" is PageView: "+b.Ji+" is WordNavigationPaneHeadingsView "+b.LPd:"null view"}}pE.ARj="WACRibbon";Object(r.a)(pE,"ReactRibbonUser",aH,[754,755,137,10]);class oK{constructor(b){this.$j=b}eHl(){return[l(Dh.a.q1f,this.$j.X3h,"Strikethrough"),l(Dh.a.I1f,this.$j.Y3h,"Subscript"),l(Dh.a.Q1f,this.$j.Z3h,"Superscript"),l(Dh.a.v9e,this.$j.O3h,"Format Painter"),l(Dh.a.l7h,this.$j.N3h,"Insert Footnote"),
l(Dh.a.g7h,this.$j.L3h,"Insert Endnote"),l(Dh.a.G_f,this.$j.V3h,"Show/Hide \u00b6"),l(Dh.a.$5f,this.$j.akf,"Undo"),l(Dh.a.lPf,this.$j.U3h,"Redo"),l(Dh.a.$Re,this.$j.H3h,"Bold"),l(Dh.a.jtf,this.$j.R3h,"Italic"),l(Dh.a.Z5f,this.$j.$3h,"Underline"),l(Dh.a.Pbo,this.$j.akf,"Undo"),l(Dh.a.tif,this.$j.P3h,"Grow Font Size"),l(Dh.a.I_f,this.$j.W3h,"Shrink Font Size"),l(Dh.a.g8k,this.$j.M3h,"Find"),l(Dh.a.rgh,this.$j.I3h,"Bullets"),l(Dh.a.sgh,this.$j.I3h,"Bullets"),l(Dh.a.kti,this.$j.T3h,"Numbering"),l(Dh.a.lti,
this.$j.T3h,"Numbering"),l(Dh.a.eyh,this.$j.K3h,"Dictate"),l(Dh.a.Fri,this.$j.S3h,"New Comment")]}gHl(){return[l(Dh.a.NOe,this.$j.lKd,"Align Left"),l(Dh.a.MOe,this.$j.kKd,"Align Center"),l(Dh.a.OOe,this.$j.mKd,"Align Right"),l(Dh.a.ttf,this.$j.nKd,"Justify"),l(Dh.a.y3f,this.$j.lKd,"Align Left"),l(Dh.a.w3f,this.$j.kKd,"Align Center"),l(Dh.a.z3f,this.$j.mKd,"Align Right"),l(Dh.a.x3f,this.$j.nKd,"Justify")]}bHl(){return[l(Dh.a.q1f,this.$j.X3h),l(Dh.a.I1f,this.$j.Y3h),l(Dh.a.Q1f,this.$j.Z3h),l(Dh.a.v9e,
this.$j.O3h),l(Dh.a.l7h,this.$j.N3h),l(Dh.a.g7h,this.$j.L3h),l(Dh.a.t8n,this.$j.PWl),l(Dh.a.tif,this.$j.P3h),l(Dh.a.I_f,this.$j.W3h),l(Dh.a.$Re,this.$j.H3h),l(Dh.a.jtf,this.$j.R3h),l(Dh.a.Z5f,this.$j.$3h),l(Dh.a.Uxh,this.$j.K3h),l(Dh.a.G_f,this.$j.V3h),l(Dh.a.Bmf,this.$j.MWl),l(Dh.a.Fri,this.$j.S3h),l(Dh.a.$5f,this.$j.akf),l(Dh.a.lPf,this.$j.U3h),l(Dh.a.g7k,this.$j.M3h)]}dHl(){return[l(Dh.a.NOe,this.$j.lKd),l(Dh.a.MOe,this.$j.kKd),l(Dh.a.OOe,this.$j.mKd),l(Dh.a.ttf,this.$j.nKd),l(Dh.a.y3f,this.$j.lKd),
l(Dh.a.w3f,this.$j.kKd),l(Dh.a.z3f,this.$j.mKd),l(Dh.a.x3f,this.$j.nKd)]}cHl(){return[l(Dh.a.ulf,this.$j.Q3h),l(Dh.a.X0e,this.$j.J3h)]}fHl(){return[l(Dh.a.ulf,this.$j.Q3h,"Increase Indent"),l(Dh.a.X0e,this.$j.J3h,"Decrease Indent")]}}Object(r.a)(oK,"ShortcutDiscoverySettings",null,[]);class pK{constructor(){this.xLg=V.a.h_a;this.$j=new KG.a(V.a.wl||V.a.ki);this.iUb=new oK(this.$j)}RFl(){let b=this.TFl();this.xLg&&(b=b.concat(this.UFl()));return b}SFl(){return this.Zff(this.iUb.cHl())}Mml(){let b=
this.Oml();this.xLg&&(b=b.concat(this.Pml()));return b}Nml(){return this.Ibf(this.iUb.fHl())}UFl(){return this.Zff(this.iUb.dHl())}TFl(){return this.Zff(this.iUb.bHl())}Pml(){return this.Ibf(this.iUb.gHl())}Oml(){return this.Ibf(this.iUb.eHl())}Zff(b){const h=[];b.forEach(n=>{h.push(appChrome.actions.setButtonSecondaryText(n.actionId,n.B0i))});return h}Ibf(b){const h=[];b.forEach(n=>{h.push(appChrome.actions.setControlCustomTooltip(n.actionId,this.mgf(n.label,n.B0i)))});return h}mgf(b,h){return b+
" ("+h+")"}}Object(r.a)(pK,"ShortcutActionHelper",null,[]);class qK extends pE{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd=null,Gd,vd){super(b,h,n,x,E,S,ma,Fa,$a,!1,Jb,gd);this.UFe=sb.Q6d();this.CTj=sb.oZf();this.$j=Sb;this.PZg=oc;this.QZg=Ic;this.Mt=Oa.a.instance.Za("Common.ISystemInitiatedFeedback");this.B1n();this.Hb=Gd;this.Zoe=vd}x2l(){w.ULS.sendTraceTag(587232785,306,50,"InitializeWordRibbon was reached");cj.a.get_instance().KI(5);const b=this.Bof&&u.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?
12:10;cj.a.get_instance().sl(b,Object(v.a)(this,this.q1l,"initializeFullRibbon"),11);u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnablePenMinutes",!1)&&this.v2j()}x3j(){this.Hb.$b(new We.a(5,1,u.AFrameworkApplication.K.rc("TickIntervalTimeForShortcutDiscovery",1E3),()=>{this.aHl()}))}v2j(){this.Hb.$b(new We.a(5,1,0,()=>{this.Zoe.execute(b=>{b.TKn()})}))}aHl(){const b=[],h=new pK;b.push(...h.RFl(),...h.Mml());null!=u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableHeadingDiscovery",
!1)&&b.push(...h.SFl(),...h.Nml());appChrome.api.dispatch(b)}Cil(){const b=[];this.PZg&&(b.push(appChrome.actions.setButtonSecondaryText(Dh.a.sxd,this.$j.LWl)),b.push(appChrome.actions.setButtonSecondaryText(Dh.a.Svd,this.$j.KWl)),b.push(appChrome.actions.setButtonSecondaryText(Dh.a.eZd,this.$j.NWl)));this.QZg&&b.push(appChrome.actions.setButtonSecondaryText(Dh.a.bZd,this.$j.OWl));return b}V9j(){this.Mt&&this.Mt.execute(b=>{b.logActivity("WordShyRibbon",null)});return 32}WOn(){this.Mt&&appChrome.api.isSmallDevice()?
this.Mt.execute(b=>{b.logActivity("ShyRibbonSmallScreenActivity",null)}):this.Mt.execute(b=>{b.logActivity("ShyRibbonNormalScreenActivity",null)});u.AFrameworkApplication.ya.gb(Ra.a.z$g,Ld.a.frame,Object(v.a)(this,this.V9j,"alwaysShowRibbonSurvey"),96)}q1l(){Dg.a.instance.Tf(si.a.y2l,(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(b=>{if(!u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerCleanupIsEnabled",!1)&&!u.AFrameworkApplication.K.$("CollabCornerCleanupIsEnabled")){var h=
u.AFrameworkApplication.K.$("ShareMenuIsEnabled"),n=h?"ShareTopBar":"Share";this.UFe?b.push(this.hHl(n)):b.push(appChrome.actions.removePeripheralControl(n));this.CTj?b.push(this.iHl()):b.push(appChrome.actions.removePeripheralControl("CopyLink"));h&&!this.UFe&&b.push(appChrome.actions.updateControlHiddenState("ShareMenu",!this.UFe))}this.dIa&&b.push.apply(b,this.YZh());(this.PZg||this.QZg)&&this.$j&&b.push.apply(b,this.Cil());u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableShortcutDiscovery",
!1)&&cj.a.get_instance().sl(7,()=>{this.x3j()});b.push(appChrome.actions.setControlCustomTooltip(Dh.a.$om,CommonUIStrings.l_LoopsLearnMoreTooltip));u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.Wla&&this.WOn();appChrome.api.isSmallDevice()&&u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.sI&&!u.AFrameworkApplication.ZP&&u.AFrameworkApplication.eaa("Microsoft.Office.Web.SessionSettings.IWacWordShyRibbonSettings");b.push.apply(b,this.NAa());b.push(appChrome.actions.setControlBehaviorAttached(!0));
const x=Oa.a.instance.resolve("WordEditor.IModeSwitcherControl");h=x.Ltl();u.AFrameworkApplication.Hf("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&(n=appChrome.selectors.getModeSwitcherMode())&&n!==h.activeMode&&w.ULS.sendTraceTag(527778651,306,15,`ModeSwitcher was initially rendered in the incorrect mode. Expected: ${h.activeMode}, Actual: ${n}`);(n="Suggest"===
h.activeMode)&&u.AFrameworkApplication.Hf("7aj80981;1e3dc950");u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowReviewTabInReviewMode",!1)&&n||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)&&"View"===h.activeMode?appChrome.getUpdateAppModeAndTabsActions(h).then(E=>{appChrome.api.dispatch(b.concat(E));x.Noi();this.A6h()}):(b.push(appChrome.actions.updateModeSwitcher(h)),appChrome.api.dispatch(b),
x.Noi(),this.A6h())})}A6h(){u.AFrameworkApplication.fac.Gbo();this.U5g();this.WSe();this.u6h();cj.a.get_instance().KI(7);Dg.a.instance.hja(si.a.ayc,si.a.Axn,(new Date).getTime())}B1n(){null!=u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("CollabCornerFloodgateSurveyFileSharedStatusIsEnabled")&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FileSharedStatusInSharePeripheralControl",!1)&&2===u.AFrameworkApplication.ut.x0i&&(this.q4=Oa.a.instance.Za("Common.App.HostNotification.EditNotificationEventSource"))&&
this.q4.execute(b=>{b.Rub(Object(v.a)(this,this.Taj,"triggerCollabCornerFileSharedStatusSurvey"))})}Taj(){const b=Oa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&window.setTimeout(()=>b.execute(h=>{h.logActivity("ToggleCollabCornerFileSharedStatusSurvey","CollabCornerFloodgateSurveyFileSharedStatusIsEnabled");this.q4&&this.q4.execute(n=>{n.y2d(Object(v.a)(this,this.Taj,"triggerCollabCornerFileSharedStatusSurvey"))})}),12E4)}OEa(b){if(b){const h=this.cQh();try{super.OEa(b)}finally{null===h||
void 0===h?void 0:h.dispose()}}}NAa(){const b=this.cQh();try{return super.NAa()}finally{null===b||void 0===b?void 0:b.dispose()}}cQh(){var b;let h=void 0;const n=null===(b=ob.App.Wj)||void 0===b?void 0:b.al;n&&(h=new Se.GraphTransaction(ob.App.Hai()&&ob.App.Kpf?0:2),h.set(n));return h}}Object(r.a)(qK,"ReactRibbonUser",pE,[]);var zP=d(1112);class rK extends WG{constructor(b,h,n,x,E,S,ma,Fa){super(b,h,n);b=!1;u.AFrameworkApplication.K.$("HidePasteTextOnlyInRibbonChrome")||(b=!x.lkb);this.Dte=u.AFrameworkApplication.K.$("PasteWithOptionsFromRibbon")&&
(V.a.n2||V.a.So&&b);this.Sm=E;this.HCe=S;this.Hb=ma;this.Zoe=Fa}fLk(b,h){const n=new eD(u.AFrameworkApplication.K,this.ga,this.Wb,this.Dte),x=new sP.a(n);return this.zLk(b,h,x,n)}zLk(b,h,n,x){var E=new XJ(new YJ(u.AFrameworkApplication.K,x),n);n=this.X1l(E);const S={};E.ekb(S);E=!V.a.n2;const ma=V.a.So||V.a.fj;var Fa=V.a.wl;u.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(Fa=V.a.ki||Fa);Fa=new KG.a(Fa);b=new qK(b,h,WordEditorIntl.WordEditorStrings,this.dpb,x,b,this.Sm,n,new TJ(S),
new zP.a(null),this.HCe,Fa,E,ma,new WJ,this.Hb,this.Zoe);b.x2l();return b}X1l(b){const h={};b.uZc(h);b.Y2c(h);return new UJ(null,h,"jewelWordEditor")}}Object(r.a)(rK,"WordEditorRibbonUserFactory",WG,[]);class bH{constructor(b,h){this.qz=b;this.Ifd=h}rKa(b,h,n,x=null,E=null){return this.Ifd.e1i(b)?this.Ifd.rKa(b,h,n,x,E):this.qz.rKa(b,h,n,x,E)}ZBa(b,h=null){return this.Ifd.e1i(b)?this.Ifd.ZBa(b):this.qz.ZBa(b,h)}}Object(r.a)(bH,"RootCuiUser",null,[243]);class sK extends bH{constructor(b,h){super(b,
h)}clearCache(){this.qz.clearCache()}}Object(r.a)(sK,"WordGeneralCuiUser",bH,[242,243]);class Wx extends mF{constructor(b,h,n){super(b,n);this.mH=h}z$e(b){const h=[],n=kh.a.instance.ib.kb,x=!!this.mH&&this.mH.lOc(Db.a.CUe.toString()),E=!!this.mH&&this.mH.lOc(Db.a.pHb.toString()),S=!x&&!n.H5b&&Wx.V1a.Woi(),ma=!!this.mH&&this.mH.lOc(Ra.a.newComment.toString())||!!sj.a.instance&&(3===sj.a.instance.mode||2===sj.a.instance.mode),Fa=n.nfi()&&u.AFrameworkApplication.ua.Sb.eOc,$a=3===b||V.a.ki||u.AFrameworkApplication.o9e;
b=$a&&Wx.v4e.sZ(n,b);$a&&h.push(this.Sm.OXa("ClipboardGroup")[0].externalUxGroupId);S&&(h.push(this.Sm.OXa("TextFormattingGroup")[0].externalUxGroupId),h.push(this.Sm.OXa("StylesGroup")[0].externalUxGroupId));x&&h.push(this.Sm.OXa("PictureToolsGroup")[0].externalUxGroupId);E&&h.push(this.Sm.OXa("TableToolsGroup")[0].externalUxGroupId);Fa&&h.push(this.Sm.OXa("EquationToolsGroup")[0].externalUxGroupId);ma&&h.push(this.Sm.OXa("CommentGroup")[0].externalUxGroupId);b&&h.push(this.Sm.OXa("ContextMenuGroup")[0].externalUxGroupId);
return h}static get v4e(){return null!=Wx.Wgg?Wx.Wgg:Wx.Wgg=Oa.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static get V1a(){return null!=Wx.Eog?Wx.Eog:Wx.Eog=Oa.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static vLc(b,h,n,x){b.ygk(()=>Wx.yab(h,n,x))}static yab(b,h,n){return new Wx(b,h,n)}}Object(r.a)(Wx,"WordReactFloatie",mF,[]);class cH{constructor(){this.Pba=this.vvc=this.W=null}get name(){return"WordEditor.UI"}init(){var b;this.W.resolve("WordEditor.UI.BusinessBarController").SJf();
const h=ob.App.Av.PH,n=ob.App.xa;Wx.vLc(n,this.W.resolve("Common.IReactContextualUILauncher"),h,this.W.resolve("Common.IExternalUICommandDefinitionMapping"));this.Pba=this.W.Pa("Box4.IContextMenuController");const x=new nJ(n,h,this.W.Za("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.PasteFloatieManager")),E={"floatie.gbFormatWithDesignerButton":!0,"floatie.gbMatchDocumentFormattingButton":!0,"floatie.gbUseSmartPasteButton":!0};switch(null===(b=u.AFrameworkApplication.K)||void 0===b?void 0:b.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",
0)){case 1:E["floatie.gbFormatWithDesignerButton"]=!1;break;case 2:E["floatie.gbMatchDocumentFormattingButton"]=!1;break;case 3:E["floatie.gbUseSmartPasteButton"]=!1}x.vLc("PasteFloatieData",null,E);this.W.resolve("WordEditor.UI.CuiActionBridge").initialize();(new KJ(n,h,this.W.Za("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.ExternalContentFloatieManager"))).vLc("ExternalContentFloatieData",[WordEditorIntl.WordEditorStrings],{});this.W.resolve("Box4.IGeneralCuiUser");cj.a.get_instance().sl(7,()=>
{this.vvc=this.W.resolve("WordEditor.UI.StatusBarUser");this.vvc.Vb()})}dispose(){this.vvc&&(this.vvc.dispose(),this.vvc=null);this.Pba&&(this.Pba.dispose(),this.Pba=null)}zc(b){this.W=b;b.ha("WordEditor.UI.BusinessBarController",()=>new rJ(b.resolve("CommonUI.IBusinessBar"),b.resolve("CommonUI.IBusinessBarEntryFactory"),u.AFrameworkApplication.ya,u.AFrameworkApplication.K)).as("WordEditor.IBusinessBarController").as("Wonca.IBusinessBarController").as("Box4.IBusinessBarController").singleInstance();
let h=V.a.wl;u.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(h=V.a.ki||h);b.ha("Box4.UI.ShortcutHintMapping",()=>new KG.a(h));const n=V.a.So||V.a.fj,x=u.AFrameworkApplication.K.$("PasteWithOptionsFromContextMenu")&&(V.a.n2||n),E=u.AFrameworkApplication.K.$("CatchUpActivityIsEnabled");b.ha("Box4.UI.AugLoopProofingErrorDetailHelper",()=>new Tj.a(Oa.a.instance.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),Oa.a.instance.resolve("Box4.Intent.IIntentRangeEditor"))).singleInstance();
b.ha("WordEditor.UI.EditSurfaceContextMenu",()=>new Kp(u.AFrameworkApplication.ya,b.resolve("Box4.UI.IProofingContextMenuSectionFactory"),b.resolve("Box4.Proofing.IErrorRangeEditor"),u.AFrameworkApplication.K,b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,E?b.Za("WordEditor.CatchUpActivity.ActivityAnnouncementManager").instance:null,b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.ILanguageReader"),
b.Pa("Box4.Intent.IIntentRangeEditor"),b.resolve("Box4.DictationCorrections.IDictationCorrectionContextMenuManager"),b.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),b.Za("Box4.IPresenceDataManager"),b.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Za("WordEditor.ContextualSearch.ISearchSuggestionManager"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader"),b.resolve("WordEditor.Designer.IDesignerControl"),b.resolve("WordEditor.Bookmark.FullBookmarkManager"),
x,n?b.resolve("Box4.UI.ShortcutHintMapping"):null,Oa.a.instance.Za("Common.IActionContextProvider"),Oa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"),b.resolve("Box4.IParagraphReader"),b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),b.Pa("WordEditor.Designer.Review.IReviewTraverser"))).as("Box4.UI.AEditSurfaceContextMenu").singleInstance();b.ha("Box4.ISelectionContextMenuProvider",()=>new Vx).singleInstance();b.ha("WordEditor.UI.CuiActionBridge",()=>new il(u.AFrameworkApplication.K)).as("Box4.UI.CuiActionBridge").singleInstance();
b.ha("WordEditor.UI.DialogFactory",()=>new JJ).as("WordEditor.UI.IDialogFactory").as("Box4.UI.IBox4DialogFactory").singleInstance();b.ha("Common.NonCanvasCuiUser",()=>new PI(de.FocusManager.instance())).as("Common.INonCanvasCuiUser").singleInstance();b.ha("WordEditor.UI.WordGeneralCuiUser",()=>new sK(b.resolve("Box4.IGeneralCuiUser"),b.resolve("Common.INonCanvasCuiUser"))).singleInstance();b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ha("WordEditor.UI.StatusBarUser",()=>new OJ(ob.App.xa.e1f,b.Za("Box4.IGeneralCuiUser"),
b.resolve("Box4.IFeatureHelper"),u.AFrameworkApplication.ya,u.AFrameworkApplication.K,ob.App.xa)).as("WordEditor.IStatusBarUser").singleInstance();b.ha("WordEditor.IWordEditorNavigationPaneContextMenu",()=>new kE).singleInstance();const S=b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ha("CommandUI.ReactRibbonRoot",()=>new jF(Yu.instance,b.resolve("Common.IExternalUICommandDefinitionMapping"),S)).singleInstance();const ma=b.Za("WordEditor.UI.WordGeneralCuiUser");b.ha("WordEditor.UI.WordEditorRibbonUserFactory",
()=>new rK(ma,u.AFrameworkApplication.ya,de.FocusManager.instance(),b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Common.IExternalUICommandDefinitionMapping"),b.resolve("CommandUI.ReactRibbonRoot"),u.AFrameworkApplication.uc,b.Za("Common.App.PenMinutesManager.IPenMinutesManager"))).as("Wonca.IRibbonUserFactory").singleInstance();b.ha("WordEditor.UI.ReactLanguageDialog",()=>new lE(b.resolve("Box4.UI.ILanguageEditor"),b.resolve("Box4.UI.ILanguageListHelper"))).as("Box4.UI.ILanguageDialog");
b.ha("WordEditor.UI.WordEditorRibbonSQMInformation",()=>new SJ(u.AFrameworkApplication.ya)).as("Common.IRibbonSQMInformation").singleInstance();b.ha("WordEditor.UI.WordEditorFileMenuSQMInformation",()=>new QJ(u.AFrameworkApplication.ya)).as("Common.IFileMenuSQMInformation").singleInstance();b.ha("WordEditor.UI.RulerUser",()=>new LJ).as("WordEditor.IRulerUser");b.ha("WordEditor.UI.RulerContextMenu",()=>new nA(u.AFrameworkApplication.ya,Oa.a.instance.Za("Common.IZoomManager"),Pq.a.instance)).as("WordEditor.IRulerContextMenu").singleInstance();
b.ha("Common.IReactContextualUILauncher",()=>new jJ(b.resolve("CommandUI.ReactRibbonRoot"),b.resolve("Common.IExternalUICommandDefinitionMapping"))).singleInstance();b.ha("Box4.IContextMenuController",()=>new oJ(b.resolve("Common.IReactContextualUILauncher"))).singleInstance()}static main(){u.AFrameworkApplication.Hf("5b6i5792;30d4f535");Xl.instance.IBh();Xl.instance.a5e();N.a.instance.Pc(new cH,6)}}Object(r.a)(cH,"WordEditorUIPackage",null,[1,2]);var AP=window.ExternalContentFloatieData={name:"CommandUI",
attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.ExternalContentFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"ExternalContentOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",
attrs:{Id:"ExternalContentFloatie.FlyoutAnchor",LabelText:"STR@L_DisplayAs",Image16by16:"IMAGEPATH@DisplayAs.png",Alt:"STR@L_DisplayAs",DisplayMode:"Medium",TemplateAlias:"ExternalContent"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msExternalContentOptionsButtons",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0xE188C0F7",
QueryCommand:"0xD46B64BD",Image16by16:"IMAGEPATH@EmbeddedContent.png",Alt:"STR@L_EmbeddedContent",LabelText:"STR@L_EmbeddedContent"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0xE36ACF00",QueryCommand:"0xB5FF507C",Image16by16:"IMGMAP@we@WebInsertHyperlink_16x16x32",Alt:"STR@L_Hyperlink",LabelText:"STR@L_Hyperlink"}}]}]}]}]}]}]}]}]}]}]}]},zB={};zB.Ghc=function(){function b(){return ma()&&(gd()||3<=(Sb()?Gd("version/"):0))}function h(){return 0<=window.navigator.userAgent.indexOf("Windows")}
function n(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function x(lf){lf=(new RegExp(lf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var mh=-1;null!=lf&&2<=lf.length&&(mh=parseFloat(lf[1]),isNaN(mh)&&(mh=-1));return mh}function E(){tK||(tK=!0,uK=x("Windows Phone"));return 8<=uK}function S(){return"function"==typeof navigator.msLaunchUri&&!n()&&!Ic()&&!Fa()}function ma(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function Fa(){return 0<=window.navigator.userAgent.indexOf("Edge/")}
function $a(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function sb(){return $a()?8==window.document.documentMode:!1}function Jb(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function Sb(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function oc(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Ic(){var lf=window.navigator.userAgent.toLowerCase();return 0<=lf.indexOf("android")&&
0<=lf.indexOf("chrome")}function gd(){return 3<=(Jb()?Gd("firefox/"):0)}function Gd(lf){var mh=window.navigator.userAgent.toLowerCase(),Sk=mh.indexOf(lf);return 0<=Sk?parseInt(mh.substring(Sk+lf.length,mh.length)):0}function vd(lf,mh,Sk,sk,yp){if(sk&&null!=mh)mh();else if(S())navigator.msLaunchUri(lf,mh,Sk);else if(!(oc()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&ma())||Fa())od(lf,mh,Sk);else if(oc()&&yp)a:{try{window.open(lf,
"_self")}catch(Rr){null!=Sk&&Sk();break a}null!=mh&&mh()}else ce(lf,mh,Sk)}function ce(lf,mh,Sk){var sk=document.getElementById("OICLinkTag");null==sk&&(sk=document.createElement("a"),sk.id="OICLinkTag",sk.style.visibility="hidden",sk.href="",0==(nq.Options&ow.SupportsTopTargetNavigation)||nq.NoBrowserModalDialogs?sk.target="_blank":sk.target="_top",document.body.appendChild(sk),null!=sk.addEventListener&&sk.addEventListener("click",function(yp){null!=yp.stopPropagation&&yp.stopPropagation()},!1));
try{sk.href=lf,sk.click()}catch(yp){null!=Sk&&Sk();return}null!=mh&&mh()}function od(lf,mh,Sk){var sk=document.getElementById("OICFrame");null==sk&&(sk=document.createElement("iframe"),sk.className="ObjectInDialog",sk.style.visibility="hidden",sk.src="about:blank",document.body.appendChild(sk),sk.id="OICFrame");try{sk.contentWindow.location.href=lf}catch(yp){null!=Sk&&Sk();return}null!=mh&&mh()}function Yd(lf){return 0!=(lf.Options&ow.SkipProtocolHandler)||sb()}function ne(lf){return lf===AB.ReadOnly||
lf===AB.ReadWrite}function Df(lf,mh,Sk,sk){var yp;try{var Rr=new ActiveXObject("SharePoint.OpenDocuments.4");return(yp=Rr.ViewDocument3(window.self,lf,mh,sk))?(gD(Fz.O14ActiveX),kp.None):kp.Failed}catch(Sr){}if(ow.O14Only===(Sk&ow.O14Only))return nq.DescriptiveUnattemptedEnums?kp.O14AttemptFailure:kp.Unattempted;try{return Rr=new ActiveXObject("SharePoint.OpenDocuments.3"),(yp=Rr.ViewDocument3(window.self,lf,mh,sk))?(gD(Fz.O12ActiveX),kp.None):kp.Failed}catch(Sr){}if(ow.O12UpOnly===(Sk&ow.O12UpOnly))return nq.DescriptiveUnattemptedEnums?
kp.O12UpOnlyFail:kp.Unattempted;try{return Rr=new ActiveXObject("SharePoint.OpenDocuments.2"),(yp=ne(mh)?Rr.ViewDocument2(window.self,lf,sk):Rr.EditDocument2(window.self,lf,sk))?(gD(Fz.O11ActiveX),kp.None):kp.Failed}catch(Sr){}return nq.DescriptiveUnattemptedEnums?kp.ActiveXUnattempted:kp.Unattempted}function Af(lf,mh,Sk,sk,yp){lf==dr.Visio&&Sk==AB.ReadWrite&&(Sk=AB.WriteOnly);lf=yp;sk=sk||n()&&!E();sk||(sk="",sk=ne(Sk)?sk+"ofv|ofc|":sk+"ofe|",lf+=gm(sk+"u|"));lf+=gm(mh);nq.NewTelemetryDataIsEnabled&&
(mh=-1!==lf.indexOf("?")?"&":"?",mh+=nq.SessionOrigin?"OR="+nq.SessionOrigin+"&":"",mh+=nq.ClickTime?"CT="+nq.ClickTime+"&":"",mh+=nq.CorrelationId?"CID="+nq.CorrelationId:"",mh="?"!=mh?mh:"",mh="&"!=mh.slice(-1)?mh:mh.slice(0,-1),lf+=gm(mh));mh=window.location.href;Sk=mh.toLowerCase().indexOf("&wdlor=");-1!=Sk?(Sk+=7,sk=mh.indexOf("&",Sk),mh=-1==sk?mh.substr(Sk):mh.substring(Sk,sk)):mh=void 0;if(null!=mh&&"undefined"!=typeof mh){Sk="";try{Sk=decodeURIComponent(mh)}catch(Rr){}0<Sk.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Sk)&&
(lf=lf+"|f|"+Sk)}return lf}function Wi(lf,mh,Sk,sk,yp,Rr){var Sr=DF(lf);if(null==Sr)return lC(nq.DescriptiveUnattemptedEnums?kp.ProtocolHandlerIsNull:kp.Unattempted,nq.Application),!1;lf=Af(lf,mh,Sk,sk,Sr);vd(lf,Ck,Rm,yp,Rr);return!0}function gm(lf){if(ma()&&oc()){var mh="";try{mh=decodeURI(lf)}catch(Sk){}if(mh==lf)return encodeURI(lf)}return lf}function Ck(){gD(Fz.ProtocolHandler)}function Rm(){nq.Options|=ow.SkipProtocolHandler;vK(nq,hD,iD)}function Qr(){null!=dH&&dH(Fz.RoamingProtocolHandler)}
function ls(){null!=eH&&eH(kp.ControlNeeded)}function pw(){var lf=document.getElementById("npSharePointPlugin");if(null==lf){lf="application/x-sharepoint";ma()&&3<=(Sb()?Gd("version/"):0)&&oA("application/x-sharepoint-webkit",!0)&&(lf="application/x-sharepoint-webkit");if(!oA(lf,!0))if(ma()&&oA("application/officelive",!0))lf="application/officelive";else return null;var mh=document.createElement("object");mh.id="npSharePointPlugin";mh.type=lf;mh.style.width="0px";mh.style.height="0px";mh.style.setProperty("visibility",
"hidden","");document.body.appendChild(mh);lf=document.getElementById("npSharePointPlugin")}return lf}function oA(lf,mh){var Sk=window.navigator.mimeTypes;if(null==Sk)return!1;lf=Sk[lf];return!lf||mh&&!lf.enabledPlugin?!1:!0}function xt(lf){try{if(null!=new ActiveXObject(lf))return!0}catch(mh){}return!1}function Gz(lf){switch(lf){case dr.OneNote:return"OneNote.Notebook";default:return""}}function DF(lf){if(lf!=dr.OneNote&&n()&&!E())return"office:";switch(lf){case dr.Excel:return"ms-excel:";case dr.OneNote:return"onenote:";
case dr.PowerPoint:return"ms-powerpoint:";case dr.Visio:return"ms-visio:";case dr.Word:return"ms-word:";case dr.Project:return"ms-project:";case dr.Publisher:return"ms-publisher:";case dr.Infopath:return"ms-infopath:";case dr.Access:return"ms-access:";default:return""}}function BP(lf){switch(lf){case dr.Excel:return"root\\office15\\excel.exe";case dr.PowerPoint:return"root\\office15\\powerpnt.exe";case dr.Visio:return"root\\office15\\visio.exe";case dr.Word:return"root\\office15\\winword.exe";case dr.Project:return"root\\office15\\winproj.exe";
case dr.Publisher:return"root\\office15\\mspub.exe";case dr.Infopath:return"root\\office15\\infopath.exe";case dr.Access:return"root\\office15\\msaccess.exe";default:return null}}function vK(lf,mh,Sk){nq=lf;hD=mh;iD=Sk;if(lf.DocumentUrl){var sk=Sk=mh=lf.DocumentUrl;try{sk=decodeURIComponent(lf.DocumentUrl)}catch(jD){}try{Sk=encodeURI(lf.DocumentUrl)}catch(jD){}mh=mh+""+lf.CorrelationIdForWinClient;sk+=lf.CorrelationIdForWinClient;Sk+=lf.CorrelationIdForWinClient;lf.Mode===AB.ReadWrite&&ow.CheckoutRequired===
(lf.Options&ow.CheckoutRequired)&&(lf.Mode=AB.ForceCheckout);ow.HostIsEditOnly===(lf.Options&ow.HostIsEditOnly)&&(lf.Mode=AB.WriteOnly);if(Yd(lf)?0:ma()&&(lf.Application==dr.OneNote||oA("application/x-sharepoint-protocolhandler",!1)||oA("application/x-sharepoint-webkit-protocolhandler",!1))||S()||Ic()||!(b()||gd()||"ActiveXObject"in window&&!n()||oc())||15<=EF())Wi(lf.Application,lf.EncodeUrl?Sk:mh,lf.Mode,lf.Application==dr.OneNote,lf.SilentExternalHandler,lf.NavigateUsingWindowOpen);else{var yp;
if(yp=sb())a:{var Rr=lf.EncodeUrl?mh:sk,Sr=lf.Mode,qE=Gz(lf.Application);try{yp=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,Rr,Sr,qE);break a}catch(jD){}yp=!1}if(yp)gD(Fz.O15ActiveX);else{if(b()||gd()){var Ks=lf.EncodeUrl?mh:sk;sk=lf.Mode;yp=Gz(lf.Application);Rr=pw();if(null==Rr)Ks=nq.DescriptiveUnattemptedEnums?kp.PluginIsNull:kp.Unattempted;else{Sr=!1;try{Sr=Rr.ViewDocument3(window.self,Ks,sk,yp)}catch(jD){}if(!Sr)try{Sr=ne(sk)?Rr.ViewDocument2(window.self,Ks,yp):
Rr.EditDocument2(window.self,Ks,yp)}catch(jD){}Sr?(gD(Fz.NpapiPlugin),Ks=kp.None):Ks=kp.Failed}}else{try{Ks=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=Ks&&Ks.SaveSSOCreds()}catch(jD){}Ks=Df(lf.EncodeUrl?mh:sk,lf.Mode,lf.Options,Gz(lf.Application))}if(Ks!=kp.None){if(sk=lf.CouldUseRoamingApps)wK||(wK=!0,xK=x("Windows NT")),sk=6.1<=xK&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&($a()||gd()||oc());if(sk&&lf.Application!=dr.OneNote){if(!zB.Ghc.$to()){lC(kp.ControlNeeded,nq.Application);return}if(lf.RoamingAppsLauncher){"undefined"==
typeof lf.RoamingAppsLauncher||null==lf.RoamingAppsLauncher?lC(nq.DescriptiveUnattemptedEnums?kp.RoamingLauncherIsNull:kp.Unattempted,nq.Application):"undefined"==typeof lf.RoamingBitsUrl||null==lf.RoamingBitsUrl?zB.Ghc.evo(lf.DocumentUrl,lf.RoamingAppsLauncher,lf.Application,lf.ApplicationParameters,hD,iD):zB.Ghc.poj(lf.DocumentUrl,lf.RoamingAppsLauncher,lf.RoamingApplicationExe,lf.ApplicationParameters,lf.RoamingPlatform,lf.RoamingBitsUrl,hD,iD);return}if(!lf.ContinueIfLauncherIsNull){lC(kp.LauncherNeeded,
nq.Application);return}}ow.NoProtocolHandlerFallback==(lf.Options&ow.NoProtocolHandlerFallback)||Yd(lf)||$a()||ma()&&!(nq.DescriptiveUnattemptedEnums?Ks>=kp.O14Unattempted&&Ks<=kp.DocumentUrlIsNull:Ks==kp.Unattempted)?lC(Ks,nq.Application):Wi(lf.Application,lf.EncodeUrl?Sk:mh,lf.Mode,lf.Application==dr.OneNote,lf.SilentExternalHandler,lf.NavigateUsingWindowOpen)}}}}else lC(nq.DescriptiveUnattemptedEnums?kp.DocumentUrlIsNull:kp.Unattempted,nq.Application)}function gD(lf){null!=hD&&hD(lf)}function lC(lf,
mh){"undefined"==typeof mh&&(mh=null);null!=iD&&iD(lf,mh)}function EF(){var lf=0;if(b()||gd()||oc()){var mh=pw();try{null!=mh&&(lf=mh.GetOfficeVersion())}catch(Sk){}}else xt("SharePoint.OpenDocuments.5")?lf=15:xt("SharePoint.OpenDocuments.4")?lf=14:xt("SharePoint.OpenDocuments.3")?lf=12:xt("SharePoint.OpenDocuments.2")&&(lf=11);return lf}function yK(){return ma()&&(oA("application/x-sharepoint",!0)||oA("application/x-sharepoint-webkit",!0))}var zK="",AK="",BK="",hD,iD,dH,eH,nq,wK,xK,tK,uK,AB={ReadWrite:0,
ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},ow={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},kp={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},Fz={Unknown:0,
NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},dr={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:AB,OpenDocumentOptions:ow,OpenDocumentFailureType:kp,OpenDocumentControl:Fz,OfficeApplication:dr,EditDocumentInClient:vK,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=
dr.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:EF,IsO14MacPluginInstalled:yK,
OfferOfficeInDialog:function(){return h()&&11>=EF()},OfferOfficeNoIntrusive:function(){return h()&&15>EF()},OfferMacOffice:function(){return ma()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!yK()},InstallRoamingControl:function(){Jb()?window.InstallTrigger.install({Office:{URL:AK}}):od(BK,null,null)},CanUseRoamingControl:function(){if(S())return!0;if(oc())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];
if(Jb()){var lf=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(lf);var mh=document.createEvent("Events");mh.initEvent("RoamingOfficeInstalled",!0,!1);lf.dispatchEvent(mh);return!!lf.getAttribute("installed")}if($a())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(Sk){}return!1},InitUrls:function(lf,mh,Sk){zK=lf;AK=Sk;BK=mh},LaunchRoamingApps:function(lf,mh,Sk,sk,yp,Rr){zB.Ghc.poj(lf,mh,BP(Sk),sk,"x86",zK,yp,Rr)},LaunchRoamingApps2:function(lf,
mh,Sk,sk,yp,Rr,Sr,qE){var Ks="";null!=sk&&(Ks+=" "+sk);null!=lf&&(Ks+=' "'+lf+'"');if(S()||oc())dH=Sr,eH=qE,Sr='office: "'+(Rr+'" "')+(Sk+'" "ROAMING"'),Sr+=' "'+mh+'"',Sr+=' "'+yp+'"',Sr+=" "+Ks,vd(Sr,Qr,ls,!1,!1);else if(Jb())lf=document.createElement("RoamingExtensionElement"),lf.setAttribute("cabUrl",Rr),lf.setAttribute("app",Sk),lf.setAttribute("licensingEntitlements",mh),lf.setAttribute("platform",yp),lf.setAttribute("args",Ks),document.documentElement.appendChild(lf),mh=document.createEvent("Events"),
mh.initEvent("RoamingOfficeLaunch",!0,!1),lf.dispatchEvent(mh),null!=Sr&&Sr(Fz.RoamingFFExtension);else if($a()){if(lf=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=lf)try{lf.HrConfigureSingle(Rr,Sk,mh,yp,Ks),null!=Sr&&Sr(Fz.RoamingActiveX)}catch(jD){}}else null!=qE&&qE(kp.Failed)},ShouldShowDialog:function(){return!n()},NavigateToUrlUsingClickingOnATag:ce,OpenDocumentWithProtocolHandler:Wi,OpenDocumentWithProtocolHandlerNoCallBack:function(lf,mh,Sk,sk){var yp=DF(lf);if(null==yp)return lC(nq.DescriptiveUnattemptedEnums?
kp.ProtocolHandlerNoCallbackIsNull:kp.Unattempted,nq.Application),!1;lf=Af(lf,mh,Sk,sk,yp);vd(lf,null,null,!1,!1);return!0}}}();zB.ClientUtils=zB.Ghc;var CP=d(1447);class FF{constructor(b,h,n){this.ga=b;this.KHj=h;this.I4=n}Vb(){this.ga.pa(Ra.a.tryMacOffice,Ld.a.frame,Object(v.a)(this,this.JWm,"onTryMacOffice"));this.ga.pa(Ra.a.lcj,Ld.a.frame,Object(v.a)(this,this.pzi,"onTryMacOfficeFromViewer"));this.ga.pa(Ra.a.kcj,Ld.a.frame,Object(v.a)(this,this.pzi,"onTryMacOfficeFromViewer"))}JWm(b,h,n,x,E){if(1===
n)return 32;E?(b=E.SourceControlId,"btnjTryMacOfficeForWordEditor"===b?rd.a.ym(Ec.a.NXa(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===b&&rd.a.ym(Ec.a.NXa(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.Oii();return 32}pzi(b,h,n){if(1===n)return 32;switch(b){case Ra.a.lcj:rd.a.ym(Ec.a.NXa(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Ra.a.kcj:rd.a.ym(Ec.a.NXa(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}Oii(){rd.a.ym(FF.EBm,
"_blank",void 0,"LaunchMacTrialWindow")}get s_c(){return this.KHj&&V.a.wl&&!V.a.nrf&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get ARn(){const b=this.s_c;b||u.AFrameworkApplication.km.yFn();return b}get zRn(){return this.s_c}static get EBm(){return Ec.a.c6("522401")}}Object(r.a)(FF,"MacOfficeOffer",null,[966]);class GF{constructor(b,h,n){this.ga=b;this.QHj=h;this.eR=null;(this.Ynd=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1))&&Oa.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(x=>{this.eR=x});this.I4=n}Vb(){this.ga.pa(Ra.a.tryOffice,Ld.a.frame,Object(v.a)(this,this.KWm,"onTryOffice"));this.ga.pa(Ra.a.B5f,Ld.a.frame,Object(v.a)(this,this.B5f,"tryOfficeThroughTellMe"));this.ga.pa(Ra.a.rcj,Ld.a.frame,Object(v.a)(this,this.scj,"tryOfficeThroughViewer"));this.ga.pa(Ra.a.qcj,Ld.a.frame,Object(v.a)(this,this.scj,"tryOfficeThroughViewer"))}KWm(b,h,n,x,E){if(this.Ynd&&1===n)return this.isFreemiumUpsellEnabled&&
this.t_c?32:8;2===n&&(E?(b=E.SourceControlId,"btnjTryOfficeForWordEditor"===b?rd.a.ym(Ec.a.NXa(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===b?rd.a.ym(Ec.a.NXa(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.wuf()):this.wuf());return 32}B5f(b,h,n,x,E){if(this.Ynd&&1===n)return this.isFreemiumUpsellEnabled&&this.t_c?32:8;2===n&&(E?(b=E.SourceControlId,rd.a.ym(Ec.a.c6("862405")+this.rBl(b),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):
rd.a.ym(Ec.a.c6("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}scj(b,h,n){if(this.Ynd&&1===n)return this.isFreemiumUpsellEnabled&&this.t_c?32:8;if(2===n)switch(b){case Ra.a.rcj:rd.a.ym(Ec.a.NXa(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Ra.a.qcj:rd.a.ym(Ec.a.NXa(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get WLm(){return this.t_c}get VLm(){return this.t_c&&MSOJS.ClientUtils.OfferOfficeInDialog()}get t_c(){return this.QHj&&!V.a.wl}get isFreemiumUpsellEnabled(){let b=
!1;this.eR&&(b=this.eR.isFreemiumUpsellEnabled());return b}wuf(b=null){let h=0;b&&(h=b);rd.a.ym(GF.uvl(h),"_blank",void 0,"LaunchOfficeOffer")}rBl(b){let h=0;switch(b){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":h=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":h=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":h=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":h=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":h=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":h=
6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":h=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":h=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":h=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":h=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":h=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":h=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":h=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":h=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":h=
20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":h=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":h=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":h=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":h=29}return 0===h?"":String.format("&pc={0:D}",h)}static uvl(b){if(V.a.ki)switch(b){case 1:return Ec.a.c6("393806");case 2:return Ec.a.c6("393810");case 3:return Ec.a.c6("393809");case 5:return Ec.a.c6("393805")}else if(V.a.FL)switch(b){case 1:return Ec.a.c6("521979");
case 3:return Ec.a.c6("521980");case 5:return Ec.a.c6("521978");case 2:return Ec.a.c6("522490")}else{if(2===b)return Ec.a.c6("517778");if(1===b)return Ec.a.NXa(30)}return Ec.a.c6("522402")}}Object(r.a)(GF,"OfficeTrialExperience",null,[965]);class CK{zc(b){b.register(GF,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").singleInstance().Xd(()=>new GF(u.AFrameworkApplication.ya,u.AFrameworkApplication.Pqf,u.AFrameworkApplication.lcid));b.register(FF,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").singleInstance().Xd(()=>
new FF(u.AFrameworkApplication.ya,u.AFrameworkApplication.Uci,u.AFrameworkApplication.lcid))}}Object(r.a)(CK,"OpenInClientConfiguration",null,[2]);var DP=d(1148);class Ny{constructor(b,h,n,x,E,S,ma){this.Zf=b;this.characterPropertiesEditor=h;this.QV=n;this.W6e=x;this.Hk=E;this.Rd=S;this.qLa=ma}M3l(b,h){var n;b=h.view;h=h.tk;if(!h||!this.Zf.Nai(h,!0)||this.W6e&&this.W6e.instance&&this.W6e.instance.vT(h))return 2;var x=Ny.eba?!Ny.nI.Lla(h):!0;this.QV&&x&&this.QV.xgc(h.node,db.a.Ks,h.cpBegin);x=h.node;
(null===(n=this.qLa)||void 0===n?0:n.replaceText)&&this.qLa.TCb(x)?(n=x.qa.NWa(h.cpBegin),this.qLa.replaceText(x,n,n,Et.a.UPc)):this.characterPropertiesEditor.Iea(h,E=>new Et.a(E));if(this.Rd.wg){n=new Se.GraphTransaction(15);try{n.Db(h.node),this.Hk.Hna(h.node,h.cpBegin,h.cpBegin+1,1)}finally{n&&n.dispose()}}x=h.node;n=h.cpEnd+1;" "===Cd.ParagraphReader.text(x).charAt(n)&&(x=Dd.a.createTextRange(x,n,n+1),this.characterPropertiesEditor.replaceTextRange(x,"\u00a0"));h=Dd.a.Uc(h.node,n);b.Cb.setSelection(Ae.SelectionFactory.Kn(h));
return 32}static get nI(){return null!=Ny.Djg?Ny.Djg:Ny.Djg=Oa.a.instance.resolve("Box4.IHyperlinkStrategy")}static get eba(){null==Ny.T0&&(Ny.T0=u.AFrameworkApplication.K?u.AFrameworkApplication.K.$("SplitHyperlinkFixWithEnterIsEnabled"):!1);return Ny.T0}}Ny.T0=null;Object(r.a)(Ny,"InsertLineBreakStrategy",null,[]);class Hu{static get eh(){return null!=Hu.Vmg?Hu.Vmg:Hu.Vmg=Oa.a.instance.resolve("Box4.IOutlineElementEditor")}static get Tg(){return Rl.ContextSetEditor.instance}static get Hk(){return null!=
Hu.fqg?Hu.fqg:Hu.fqg=Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Rd(){return null!=Hu.Kqg?Hu.Kqg:Hu.Kqg=Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static j4l(b,h,n,x,E){if(E&&E.hasProperty(ad.a.targetObject)){var S=h.view.ud.Nc.Eb(E.getValue(ad.a.targetObject));S=Dd.a.create(S)}else S=Hu.Tg.oS(h.tk,11);if(!S)return 8;b=u.AFrameworkApplication.ya.Qf(S,b,n,!0,x,E);if(32===b&&2===n){if(!h.view.Be)return 2;h=h.view;x=h.Cb.Rg;
if(x=Hu.Tg.oS(x,11)){n=new Lf.a;n.set(x.node);n.vd();if(E&&E.hasProperty(ad.a.targetObject))for(E=E.Og(ad.a.targetObject);!n.currentNode.id.equals(E)&&n.nc()&&(wf.OutlineElementNavigator.ae(n),11===n.Se););wf.OutlineElementNavigator.J2(n,!1,!1);E=Kd.SelectionEditor.jAa(n,!0);E=Cd.ParagraphReader.uu(E)?Ae.SelectionFactory.xe(E,0):Ae.SelectionFactory.ir(E);h.Cb.setSelection(E)}}return b}static DLd(b,h,n,x,E){b=b===Db.a.LLc;h=h.node;if(E&&E.hasProperty(ad.a.targetObject)&&!h.id.equals(E.Og(ad.a.targetObject)))return 2;
if(1===n)return 32;n=new md.GraphIterator;n.set(h);n.Bb(10);Hu.eh.XC(n,b,!0);Hu.Rd.wg&&(n=wf.OutlineElementNavigator.He(n),Hu.Hk.sJb(n,1));return 32}}Object(r.a)(Hu,"InsertOutlineElementStrategy",null,[]);class BB{constructor(b,h,n,x,E,S,ma,Fa,$a,sb){this.UX=h;this.OAj=b;this.Cw=S;this.kG=E;this.Kh=n;this.Lyj=x;this.Ok=ma;this.hb=Fa;this.hA=$a;this.Akc=sb}oJm(b,h,n,x,E){if(!h.view.Be)return 2;h=h.view;let S=null;h.Ji&&(S=h);const ma=h.Cb.Rg;var Fa=!0;let $a=!1,sb=null;if(!ma)return 2;const Jb=new Se.GraphTransaction(15);
Jb.Db(h.ud);let Sb=null;2===n&&(Sb=new Lf.a,Sb.set(ma.node),Sb.vd(),sb=new cy.a(Sb),wf.OutlineElementNavigator.ae(Sb),Fa=Kf.OutlineElementReader.isEmpty(Sb,!1),{s1i:Fa,Pjj:$a}=this.Lyj.t1i(Sb,Fa,Ig.a.gAb,-1,ma));b=u.AFrameworkApplication.ya.Qf(ma,b,n,!1,x,E);Fa&&32===b&&2===n&&($a||wf.OutlineElementNavigator.xCa(Sb,!1,!Kd.SelectionEditor.xf(ma),!1),$a&&sb&&sb.restore(Sb),this.Cw.freeze(),(n=Ae.SelectionFactory.wo(Sb.currentNode,!0))||w.ULS.sendTraceTag(591958035,324,15,"could not create selection for NewLineView."),
h.Cb.setSelection(n),this.Cw.qEa(),this.OAj.vi.xF());S&&(Fa||S.Naa(),S.editingView&&S.XN&&(S.editingView.cH=!0));fl.GrippersManager.instance.FLb(1);Jb.dispose();return b}MB(b,h,n){b=!1;if(Pd.ImageReader.I$(h)||Pd.ImageReader.pZa(h))h=this.FDk(h),b=!0;const x=h;if((h=Kd.SelectionEditor.xf(h))&&this.Ok.vh&&!this.Ok.Iem(x))return 2;if(1===n)return 32;const E=x.node,S=new md.GraphIterator;S.set(E);S.vd();wf.OutlineElementNavigator.ae(S);n=new Se.GraphTransaction(15);n.Ju(S);h?(this.Akc.instance&&this.Akc.instance.GEa(x),
Cd.ParagraphReader.oc(E)&&x.cpBegin===Cd.ParagraphReader.textLength(E)&&Ad.m(x)&&9===Cd.ParagraphReader.HAa(E)&&this.Cw.AEk(x),this.kG.XWf(S,!0,x,E),ec.ListReader.$h(S)&&!Kf.OutlineElementReader.isEmpty(S,!1)&&(h=Cd.ParagraphReader.Ym(S.currentNode))&&h.qa&&!h.qa.last.formatting&&BB.characterPropertiesEditor.lKa(h),this.UX&&this.UX.xgc(E,db.a.Ks,x.cpBegin),b&&(wf.OutlineElementNavigator.Rr(S,!1,!1),b=S.Rb(2),(b=this.hA.xe(b,0))&&this.hb.setSelection(b))):this.Kh.XC(S,!0,!0);n.dispose();ob.App.xa&&
ob.App.xa.updateCommandUI();return 32}FDk(b){if(Pd.ImageReader.I$(b))var h=Dd.a.Uc(b.node,b.cpBegin);else{h=Cd.ParagraphReader.qP(b.node);var n=h.properties.Og(ic.a.Fq);b=b.node.properties.getValue(ic.a.runId);n=BB.ubf(b,n,h.qa);h=Dd.a.Uc(h,n)}return h}static get characterPropertiesEditor(){return null!=BB.Cfg?BB.Cfg:BB.Cfg=Oa.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static $7e(b,h){let n=0;for(;n<h.length&&!(b<h[n]);)n++;return n}static ubf(b,h,n){let x=0;b=BB.$7e(b,h);let E=0;if(b===
h.length)E=n.length-1;else for(;E<n.length;){h=n.J(E);if(h.formatting&&h.formatting.Fe===b)break;E++}E<n.length&&(x=n.J(E).cp);return x}}Object(r.a)(BB,"NewLineStrategy",null,[]);class mC{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd,Gd){this.sm=null;this.aja=b;this.K9c=ma;this.Afd=new BB(this,h,n,x,E,S,Fa,Jb,Sb,gd);this.EHg=new Ny(Fa,$a,h,sb,oc,Ic,Gd)}get vi(){return this.sm||(this.sm=this.aja())}Vb(){const b=u.AFrameworkApplication.ya,h=Object(v.a)(this.Afd,this.Afd.MB,"newLine");b.gb(Db.a.enter,
cc.a.view,Object(v.a)(this.K9c.value,this.K9c.value.S1k,"enterView"),1124);b.gb(Db.a.y0i,cc.a.view,Object(v.a)(this.K9c.value,this.K9c.value.HPn,"shiftEnterView"),1124);b.pa(Db.a.MB,cc.a.view,Object(v.a)(this.Afd,this.Afd.oJm,"newLineView"));b.pa(Db.a.MB,cc.a.Wc,h);b.pa(Db.a.MB,cc.a.image,h);b.pa(Db.a.MB,cc.a.Fd,h);b.pa(Db.a.MB,cc.a.anchoredObject,h);b.pa(Db.a.MB,cc.a.embeddedFile,h);b.pa(Db.a.MB,cc.a.ink,h);b.pa(Db.a.MB,cc.a.paragraph,h);b.pa(Db.a.MB,cc.a.iFrame,h);b.pa(Db.a.MB,cc.a.unsupportedObject,
h);b.Vc(Db.a.MB,1124);b.gb(Db.a.ALd,cc.a.view,Object(v.a)(this.EHg,this.EHg.M3l,"insertLineBreakView"),1028);b.pa(Db.a.LLc,cc.a.view,Hu.j4l);b.pa(Db.a.LLc,cc.a.outlineElement,Hu.DLd);b.Vc(Db.a.LLc,1092)}static get instance(){return null!=mC.Hkg?mC.Hkg:mC.Hkg=mC.Fl()}static Fl(){return new mC(()=>Oa.a.instance.resolve("Box4.IUndoManager"),Oa.a.instance.Pa("Box4.IAutoCorrectScheduler"),Oa.a.instance.resolve("Box4.IOutlineElementEditor"),Oa.a.instance.resolve("Box4.List.ICursorMovementValidator"),Oa.a.instance.resolve("Box4.List.IListEditor"),
Oa.a.instance.resolve("Box4.IInsertionPointFormatting"),Oa.a.instance.Ye("Box4.Actors.IEnterViewStrategy"),Ai.a.instance,Oa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Oa.a.instance.Za("Box4.IExternalSelectionManager"),kh.a.instance,Oa.a.instance.resolve("Box4.ISelectionFactory"),Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Oa.a.instance.Za("Box4.IContentControlConverter"),Oa.a.instance.resolve("Box4.IBox4GraphWriter"))}}
Object(r.a)(mC,"EnterActor",null,[]);var fH=d(1362),gH=d(675);class zj{static get paragraphEditor(){return null!=zj.Dng?zj.Dng:zj.Dng=Oa.a.instance.resolve("Box4.IParagraphEditor")}static get FX(){return null!=zj.Sog?zj.Sog:zj.Sog=Oa.a.instance.Pa("Box4.ISpacingCommands")}static get nKb(){return null!=zj.cpg?zj.cpg:zj.cpg=Oa.a.instance.Pa("Box4.Styles.IWACStyleReader")}static get JT(){return null!=zj.Wlg?zj.Wlg:zj.Wlg=Oa.a.instance.Pa("Box4.ILineSpacingHelper")}static get Hk(){return null!=zj.nqg?
zj.nqg:zj.nqg=Oa.a.instance.Pa("Box4.TrackChange.ITrackChangeEditor")}static get Rd(){return null!=zj.Oqg?zj.Oqg:zj.Oqg=Oa.a.instance.Pa("Box4.TrackChange.ITrackChangeManager")}static get oO(){return Oa.a.instance.Pa("Box4.Settings.SpacingSettings")}static get Vm(){return Oa.a.instance.Pa("WordEditor.ClientPagination.IClientPaginationSettings")}static Vb(){var b,h,n,x;const E=u.AFrameworkApplication.ya;E.pa(Db.a.bvf,cc.a.view,Jl.a.yv);E.Vc(Db.a.bvf,1028);E.pa(Db.a.$B,cc.a.view,Jl.a.yv);E.pa(Db.a.$B,
cc.a.paragraph,zj.drd);E.Vc(Db.a.$B,1036);if(null===(b=zj.oO)||void 0===b?0:b.vta)E.pa(Db.a.jdc,cc.a.paragraph,zj.ebk),E.pa(Db.a.jdc,cc.a.view,Jl.a.yv),E.Vc(Db.a.jdc,1036);if(null===(h=zj.Vm)||void 0===h?0:h.iCa)E.pa(Db.a.wZc,cc.a.paragraph,zj.RPe),E.pa(Db.a.wZc,cc.a.view,Jl.a.yv);if(null===(n=zj.Vm)||void 0===n?0:n.iFa)E.pa(Db.a.YZc,cc.a.paragraph,zj.jQe),E.pa(Db.a.YZc,cc.a.view,Jl.a.yv);if(null===(x=zj.Vm)||void 0===x?0:x.Ita)E.pa(Db.a.vZc,cc.a.paragraph,zj.QPe),E.pa(Db.a.vZc,cc.a.view,Jl.a.yv);
E.pa(Db.a.vNe,cc.a.view,zj.g8j);E.Vc(Db.a.vNe,1036);E.pa(Db.a.XQf,cc.a.view,zj.sqn);E.Vc(Db.a.XQf,1036);E.pa(Db.a.uNe,cc.a.view,zj.f8j);E.Vc(Db.a.uNe,1036);E.pa(Db.a.WQf,cc.a.view,zj.rqn);E.Vc(Db.a.WQf,1036);E.pa(Db.a.dPa,cc.a.view,Jl.a.yv);E.pa(Db.a.dPa,cc.a.paragraph,zj.drd);E.Vc(Db.a.dPa,1036);E.pa(Db.a.cPa,cc.a.view,Jl.a.yv);E.pa(Db.a.cPa,cc.a.paragraph,zj.drd);E.Vc(Db.a.cPa,1036);E.pa(Db.a.r8d,cc.a.view,zj.q8d);E.pa(Db.a.r8d,cc.a.paragraph,zj.q8d);E.Vc(Db.a.r8d,1028);E.pa(Db.a.x0f,cc.a.view,
zj.q8d);E.pa(Db.a.x0f,cc.a.paragraph,zj.q8d);E.Vc(Db.a.x0f,1028);E.pa(Db.a.f8d,cc.a.view,Jl.a.yv);E.pa(Db.a.f8d,cc.a.paragraph,zj.Jbh);E.Vc(Db.a.f8d,1028);E.pa(Db.a.e8d,cc.a.view,Jl.a.yv);E.pa(Db.a.e8d,cc.a.paragraph,zj.Jbh);E.Vc(Db.a.e8d,1028)}static Jbh(b,h,n,x,E){if(1===n)return 32;b===Db.a.f8d?b=Db.a.dPa:b===Db.a.e8d&&(b=Db.a.cPa);return zj.drd(b,h,n,x,zj.Z0m(E))}static Z0m(b){var h=b.indexOf(",");const n=b.substring(0,h);b=b.substring(h+1,b.length);h=new fH.a;h.value=parseFloat(n);h.unit=parseInt(b);
return h}static q8d(b,h,n,x,E){if(2===n){h=E[rc.a.Text];n=E[rc.a.Number];E=E.Increment;x=new fH.a;let S=!1;""===h||E&&h===Box4Intl.Box4Strings.L_SpinnerAuto?(x.value=0,x.unit=ob.App.r6?2:4,S=!0):n||E||(x.value=0,x.unit=1,S=!0);S&&(u.AFrameworkApplication.ya.Xb(b===Db.a.r8d?Db.a.dPa:Db.a.cPa,2,x),ob.App.xa.updateCommandUI())}return 32}static drd(b,h,n,x,E){if(!({zx:n}=Jl.a.QYf(n,h)).returnValue)return n;h=h.node;switch(b){case Db.a.$B:zj.paragraphEditor.$B(h,new gH.a(2,E));break;case Db.a.dPa:b=new gH.a(E.unit,
E.value);zj.paragraphEditor.SIb(h,b);break;case Db.a.cPa:b=new gH.a(E.unit,E.value),zj.paragraphEditor.PIb(h,b)}x&&Bq.a.hlb&&(x.Jr|=Bq.a.Xcb(h));return 32}static g8j(b,h,n){if(1===n)return 32;w.ULS.sendTraceTag(588394561,340,50,"Add Space Before Paragraph option is clicked");b=zj.dYh(h);if(!b)return w.ULS.sendTraceTag(588367186,3018,10,"No style applied on the paragraph"),8;b=(b=b.ia(ic.a.Dj,240)/20)?b:zj.wPk;zj.FX.vga(1,b,4);return 32}static sqn(b,h,n){if(1===n)return 32;w.ULS.sendTraceTag(588394562,
340,50,"Remove Space Before Paragraph option is clicked");zj.FX.vga(1,0,4);return 32}static f8j(b,h,n){if(1===n)return 32;w.ULS.sendTraceTag(588394563,340,50,"Add Space After Paragraph option is clicked");b=zj.dYh(h);if(!b)return w.ULS.sendTraceTag(588367187,3018,10,"No style applied on the paragraph"),8;b=b.ia(ic.a.ra,240)/20;zj.FX.vga(0,b?b:12,4);return 32}static rqn(b,h,n){if(1===n)return 32;w.ULS.sendTraceTag(588394564,340,50,"Remove Space After Paragraph option is clicked");zj.FX.vga(0,0,4);
return 32}static RPe(b,h,n,x,E){if(2==n){if("boolean"!==typeof E)return 16;b=h.node;h=null;Of.a.instance.J(3)&&(h=b.Hz());zj.paragraphEditor.RPe(b,E);h&&zj.Hk.gM(b,h,zj.Rd.wg)}return 32}static jQe(b,h,n,x,E){if(2==n){if("boolean"!==typeof E)return 16;b=h.node;h=null;Of.a.instance.J(3)&&(h=b.Hz());zj.paragraphEditor.jQe(b,E);h&&zj.Hk.gM(b,h,zj.Rd.wg)}return 32}static QPe(b,h,n,x,E){if(2==n){if("boolean"!==typeof E)return 16;b=h.node;h=null;Of.a.instance.J(3)&&(h=b.Hz());zj.paragraphEditor.QPe(b,E);
h&&zj.Hk.gM(b,h,zj.Rd.wg)}return 32}static ebk(b,h,n,x,E){if(2==n){if("boolean"!==typeof E)return 16;b=new Map;b.set("Value",E.toString());ta.Health.instance.recordKpiUsage(Zh.a.oPc.m7n,0,Zh.a.vB,b);h=h.node;b=null;Of.a.instance.J(3)&&(b=h.Hz());h.hasProperty(ic.a.Qt)&&h.removeProperty(ic.a.Qt);zj.JT.RDd(h)!==E&&h.setValue(ic.a.Qt,E);(E=zj.JT.PFd(h,!0))&&E.Sj(4,!0);(E=zj.JT.PFd(h,!1))&&E.Sj(4,!0);b&&zj.Hk.gM(h,b,zj.Rd.wg)}return 32}static dYh(b){b=b.view;return b.Be&&(b=b.Cb)&&b.ib.kb?zj.nKb.yo(b.ib.kb.Qa.node):
null}}zj.wPk=12;Object(r.a)(zj,"SpacingActor",null,[]);class DK{process(){}}Object(r.a)(DK,"NoOpFormattingViewOperationFinishedStageProcessor",null,[32]);class EK{constructor(b){this.og=b}cIn(b,h){this.og.k_(b,h.cache.KG);this.og.Pv(b,h.cache.fontSize)}eLa(){return null}JAa(){return null}c3b(){return null}eT(){return null}}Object(r.a)(EK,"FormattingStewardBridge",null,[38]);class FK{zc(b){b.ha("Box4.Actors.IFormattingViewOperationFinishedStageProcessor",()=>new DK).singleInstance();b.ha("Box4.Actors.IFormattingStewardBridge",
()=>new EK(b.resolve("Box4.IFormattingEditor"))).singleInstance()}}Object(r.a)(FK,"WoncaActorsConfiguration",null,[2]);class GK{constructor(b,h,n,x,E,S,ma,Fa){this.ga=b;this.Svj=h;this.Rvj=n;this.Qug=x;this.KOj=E;this.jhd=S;this.POj=ma;this.QOj=Fa}get Ac(){return this.ga}Aik(b){this.Ac.bna(b,this.Svj,null,null)}yik(b){this.Ac.bna(b,this.Rvj,null,null)}u1(b,h,n){n?this.Ac.bna(b,this.Qug,h,null):this.Ac.Xb(this.Qug,2,h)}y1m(b,h){this.Ac.bna(b,this.jhd,h,null)}V6(b,h){this.Ac.bna(b,this.POj,h,null)}wib(b,
h){this.Ac.bna(b,this.QOj,h,null)}sJf(b,h=!1){const n=new qi.DictionaryPropertySet;n.setValue(ad.a.$T,b);n.setValue(ad.a.yCi,!0);n.setValue(ad.a.zZa,h);this.Ac.Xb(this.KOj,2,n)}}Object(r.a)(GK,"ClipboardCommands",null,[1334]);class HK{}Object(r.a)(HK,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",null,[1227]);class IK{constructor(b){this.ga=b}get Ac(){return this.ga}KYi(b,h,n){let x=0;b?1===b&&(x=Db.a.WYa):x=Db.a.VYa;b=new ax.a;b.unit=n;b.value=h;this.Ac.Xb(x,2,b)}b6d(b,h,n){let x=0;1===b?x=Db.a.mJb:
2===b?x=Db.a.Zjb:b||(x=Db.a.nJb);b=new ax.a;b.unit=n;b.value=h;this.Ac.Xb(x,2,b)}}Object(r.a)(IK,"IndentationCommands",null,[1270]);var HF;(function(b){b[b.unspecified=-1]="unspecified";b[b.none=0]="none";b[b.left=1]="left";b[b.center=2]="center";b[b.right=3]="right";b[b.inner=4]="inner";b[b.outer=5]="outer";b[b.both=6]="both";b[b.distribute=7]="distribute";b[b.margin=8]="margin";b[b.highKashida=9]="highKashida";b[b.lowKashida=10]="lowKashida";b[b.mediumKashida=11]="mediumKashida";b[b.numTab=12]=
"numTab";b[b.thaiDistribute=13]="thaiDistribute";b[b.start=14]="start";b[b.end=15]="end"})(HF||(HF={}));Object(r.b)("Justification",HF);class JK{constructor(b){this.iHa={};this.ga=b;this.G_l()}get Ac(){return this.ga}lD(b){b=this.iHa[HF[b]];void 0!==b&&null!==b&&this.Ac.processAction(b,2)}G_l(){this.iHa.left=Db.a.leftJustify;this.iHa.center=Db.a.centerJustify;this.iHa.right=Db.a.rightJustify;this.iHa.both=Db.a.fullJustify;this.iHa.lowKashida=Db.a.EDb;this.iHa.mediumKashida=Db.a.EDb;this.iHa.highKashida=
Db.a.EDb;this.iHa.distribute=Db.a.CDc;this.iHa.thaiDistribute=Db.a.TZc}}Object(r.a)(JK,"JustificationCommands",null,[1265]);class KK{constructor(b){this.ga=b}$B(b){this.ga.Xb(Db.a.$B,2,b)}jdc(b){this.ga.Xb(Db.a.jdc,2,b)}wZc(b){this.ga.Xb(Db.a.wZc,2,b)}YZc(b){this.ga.Xb(Db.a.YZc,2,b)}vZc(b){this.ga.Xb(Db.a.vZc,2,b)}vga(b,h,n){this.ga.Xb(b?Db.a.dPa:Db.a.cPa,2,Object.assign(new fH.a,{value:h,unit:n}))}}Object(r.a)(KK,"SpacingCommands",null,[1153]);class LK{constructor(b,h,n){this.Ac=b;this.bEc=h;this.mZk=
n;this.MXm=(x,E,S)=>{if(1===S)return this.bEc.ara?32:8;this.bEc.irm();this.mZk().GUn(this.bEc.zol());return 32}}Vb(){this.Ac.gb(Db.a.bib,cc.a.application,this.MXm,1028)}}Object(r.a)(LK,"EditorSettingsUIActor",null,[]);class MK extends Kc.a{constructor(b,h){super(!1,!1,!0);this.oZk=b;this.MMa=h;this.nZk=n=>{1!==n?w.ULS.sendTraceTag(527434075,340,50,"Editor Settings closed without changes"):(this.oZk.$do(),w.ULS.sendTraceTag(578869131,340,50,"Editor Settings updated"))}}GUn(b){Object(xu.__awaiter)(this,
void 0,void 0,function*(){var h=yield this.MMa.aEb;h={["id"]:"SettingsDialog",["uiLanguage"]:u.AFrameworkApplication.uiCulture,["selectedLanguage"]:vj.a.lg(u.AFrameworkApplication.lcid).name,["isGoalActive"]:!1,["isSubscription"]:h.YOc,["editorSettings"]:b};this.Zh(Box4Intl.Box4Strings.l_EditorSettings,this.nZk,h);w.ULS.sendTraceTag(578091235,340,50,"Editor settings dialog is opened.")})}}Object(r.a)(MK,"EditorSettingsDialog",Kc.a,[]);class NK{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic){this.Mrb=
this.Gsc=this.HNb=null;this.yGe=0;this.hse=!1;this.sa=new Ge.a;this.CNd=!1;this.bqb=null;this.cS=b;this.Cw=h;this.og=n;this.pu=x;this.fb=E;this.kG=S;this.Cf=ma;this.Vd=Fa;this.Ok=$a;this.wc=sb;this.Hd=Jb;this.Tm=Sb;this.xV=oc;this.tC=Ic}get L_k(){return this.wc?this.wc.isFeatureEnabled(44):!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled")}get w9e(){return null!=this.Iig?this.Iig:this.Iig=Oa.a.instance.resolve("Box4.IFormatPainterStrategy")}get gQ(){return this.hse}set gQ(b){this.hse!==
b&&(this.hse=this.CNd=b,this.sa.raiseEvent("FormatPainterBrushActiveStatusChanged"))}$4j(b){this.sa.addHandler("FormatPainterBrushActiveStatusChanged",b)}WJf(b){const h=b.Qa;w.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",h.contextId);this.reset();var n=h.node;b=this.jdi(b);if(this.w9e.FRn(h.contextId,b))try{this.Mrb=this.fb.cYa(n)}catch(x){throw w.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",x.message),x;}this.Gsc=this.tC.yo(n);n=Mh.FormattingReader.Ds(h);
n.Xm&&(this.HNb=Object(ja.a)(Zu.a,n.Xm.clone()));this.yGe=b?cc.a.paragraph:h.contextId}Zqd(b){if(b){const x=this.jdi(b);if(this.zNd)if(b=b.vN().Sy(),null===b||void 0===b?0:b.ul)this.u$a(b,x);else if(0==(null===b||void 0===b?void 0:b.length))w.ULS.sendTraceTag(529089953,354,50,"Attempt to apply format to non-graph-node context: {0}",b);else{if(b)for(var h=0;h<b.length;h++){var n=b.getContext(h);if(null===n||void 0===n?0:n.Rw){if(n)for(let E=0;E<n.length;E++)b.addContext(n.getContext(E))}else(null===
n||void 0===n?0:n.ul)?this.u$a(n,x):w.ULS.sendTraceTag(529089954,354,50,"Attempt to apply format to non-graph-node context: {0}",n.contextId)}}else for(h=0;h<b.length;h++)n=b.J(h),(null===n||void 0===n?0:n.ul)?this.u$a(n,x):w.ULS.sendTraceTag(22832068,354,50,"Attempt to apply format to non-graph-node context: {0}",n.contextId)}}hbh(b,h){if(h){var n=b.node,x=n.qa.last,E=this.Vd.lKa(n),S=E.Yf(E.Ob);this.ibh(E,h,null);Of.a.instance.J(3)&&this.Tm.XIb(n,x,b.cpBegin,b.cpEnd,S,E,this.Hd.wg)}}sbk(b,h,n){if(h||
n)0<Ad.g(b).length&&w.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.xV.m1(b,x=>{this.ibh(x,h,n)})}ibh(b,h,n){var x,E,S,ma;this.og.Fja(b);b.Xm&&b.Xm.removeProperty(ie.a.highlight);this.og.vVe(b);if(n){let Fa=n.Yh();if(null===(x=u.AFrameworkApplication.K)||void 0===x?0:x.$("StylesFlatteningCrashFixIsEnabled"))Fa=Hk.a.Cta(n)?null===(ma=null===(S=null===(E=this.tC)||void 0===E?void 0:E.Ip())||void 0===S?void 0:S.qW(Fa))||void 0===ma?void 0:ma.clone():Fa.clone(),Fa.Qg(...jo.a.PG());
this.ys(b,Fa)}this.ys(b,h)}ys(b,h){var n;if(h){var x=b.paragraph.Nc;if(x){var E=b.Xm;E=E?Object(ja.a)(Cs.a,E.clone()):Zu.a.fza(1179725);for(const ma of h.Mj())if(ma!==ic.a.Bx&&ma!==ic.a.fieldInstruction&&ma!==ie.a.xA&&ma!==ie.a.t6&&ma!==ic.a.ofb&&ma!==ie.a.eE&&ma!==ic.a.languageHint&&ma!==ic.a.noProof){if(ma===Th.a.kB){var S=h.ia(Th.a.kB,C.a.nil);if(S!==C.a.nil)if(S=x.Eb(S)){if(S=new st.a(S),S=this.tC.rF(S),S===Box4Intl.Box4Strings.L_StyleWordHyperlink)if(S=this.tC.Nx(b.paragraph).Lsa(S)){(null===
(n=u.AFrameworkApplication.K)||void 0===n?0:n.$("StylesFlatteningCrashFixIsEnabled"))?E.UH(S.Yh(),...jo.a.PG()):E.ys(S.Yh());continue}else w.ULS.sendTraceTag(589345875,354,50,"Applied Hyperlink style on formatting is not present in Style Set")}else w.ULS.sendTraceTag(589345876,354,50,"Applied character style on formatting is not present in Object Space")}E.setValue(ma,h.Og(ma))}E.Vla?h=x.KQ(E,!0):(x.Gu(E),h=E);b.Aj=h.id}}}jdi(b){return!b.VD&&b.Tc.contextId!==cc.a.endOfParagraph}reset(){this.Mrb=this.Gsc=
this.HNb=null;this.yGe=cc.a.none}u$a(b,h){if(b.contextId===cc.a.Wc||b.contextId===cc.a.Fd)var n=this.Ok.L$(b);else if(b.contextId===cc.a.paragraph)n=this.Ok.vOd(b);else if(b.contextId===cc.a.endOfParagraph)n=this.Ok.kNd(b);else{w.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",b.contextId);return}w.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",b.contextId);if(n)w.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{n=
Object(ja.a)(Tc.AParagraphNode,b.node);var x=!1;n&&(x=b.contextId===cc.a.Fd&&!!n&&!b.cpBegin&&b.cpEnd===this.fb.textLength(n));if(h=this.w9e.RPn(this.yGe,b.contextId,h,x))try{Cd.ParagraphReader.oc(n)?(this.Gsc&&this.cS.hM(this.Gsc,n,!0),this.pu.Abh(n,this.Mrb)):w.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",b.node.type)}catch(E){throw w.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",E.message),E;}x=b;b.contextId===
cc.a.paragraph?x=Dd.a.createTextRange(n,0,Cd.ParagraphReader.textLength(n)):b.contextId===cc.a.Wc&&(x=this.Cw.egf(b),x=kh.a.Xwb(x));if(x&&x.contextId===cc.a.Fd)try{this.sbk(x,this.HNb,h?null:this.Gsc)}catch(E){throw w.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",E.message),E;}if(b.contextId===cc.a.paragraph||b.contextId===cc.a.endOfParagraph){h=new md.GraphIterator;h.set(n);h.vd();h.kd(11);x=ec.ListReader.$h(h);const E=!Cd.ParagraphReader.textLength(n);w.ULS.sendTraceTag(22832067,
354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",x,E);x?(this.Cf.cD(h),h=h.currentNode,this.Cf.N$(h)&&(Ei.a.Zd.KL?this.hbh(b,this.HNb):this.kG.H5d(h,n,this.HNb))):this.L_k&&this.hbh(b,this.HNb)}}}get zNd(){null==this.bqb&&(u.AFrameworkApplication.Hf("0b2ac141;84eff841"),this.bqb=u.AFrameworkApplication.K?u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsFormatPainterBugFixFlightEnabled",!1):!1);return this.bqb}}Object(r.a)(NK,"FormatPainter",null,[1302]);var EP=
d(123);class nC{constructor(b,h,n,x,E,S,ma,Fa=!1,$a,sb,Jb){this.idd=!1;this.Noe=new Mp.a;this.bqb=null;this.fRl=()=>{this.mJ.gQ=!1;return 32};this.gRl=(Sb,oc,Ic)=>{Sb=!1;if(oc=this.sC.osa){switch(oc.contextId){case cc.a.Fd:case cc.a.paragraph:case cc.a.endOfParagraph:case cc.a.Wc:Sb=!0}Sb&&Kd.SelectionEditor.Ek(oc)&&Ad.b(oc)&&(this.ld.Yb(Gc.a.Mm,{["Reason"]:Mc.a.hBc}),Sb=!1);Sb&&Cd.ParagraphReader.KW(oc)&&(this.ld.Yb(Gc.a.Mm,{["Reason"]:Mc.a.pN}),Sb=!1)}if(1===Ic||!Sb)return Sb?32:8;6!==this.ga.yG?
(this.mJ.gQ?w.ULS.sendTraceTag(22832076,354,50,"User deactivated the Format Painter button"):(w.ULS.sendTraceTag(22832075,354,50,"User activated the Format Painter button"),this.mJ.WJf(this.sC.kb),this.idd||(this.Dh.RUa(this.Tej),(Ic=this.Dh.jb.uv)&&Ic.Ji&&Ic.r8g(this.Sej),this.idd=!0)),this.mJ.gQ=!this.mJ.gQ):(w.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),this.mJ.WJf(this.sC.kb),this.mJ.gQ=!1);return 32};this.eRl=(Sb,oc,Ic,gd,Gd)=>{if(6===this.ga.yG||this.mJ.gQ){w.ULS.sendTraceTag(22832078,
354,50,"User applied the Format Painter from command location: {0}",this.ga.yG);Sb=this.Dh.iq.fg("UserAction","FormatPainterApply");if(nC.Pb&&nC.Pb.Sw(126)){Gd=Gd?Gd.KeepBrushActive:!1;Ic=null;this.sC.kb&&2===this.sC.kb.trigger&&(Gd=Gd||this.mJ.CNd,this.mJ.CNd&&Kd.SelectionEditor.Km(this.sC.kb)&&(Ic=Kd.SelectionEditor.Q1(this.sC.kb.Qa,!1)))&&(Ic.trigger=2);this.mJ.CNd=!1;if(Gd||2!==this.sC.kb.trigger)oc=new Se.GraphTransaction(15),Ic&&Ic.Qa?(oc.set(Ic.Qa.node.Ti),this.hb.setSelection(Ic)):oc.set(this.sC.Z0b.Ti),
Ic=this.zNd?Ae.SelectionFactory.Kn(this.hb.Rg):this.sC.kb,this.mJ.Zqd(Ic),oc.dispose();this.mJ.gQ=Gd}else Gd=new Se.GraphTransaction(15),Gd.set(this.sC.Z0b.Ti),oc=this.zNd?Ae.SelectionFactory.Kn(this.hb.Rg):this.sC.kb,this.mJ.Zqd(oc),this.mJ.gQ=!1,Gd.dispose();Sb.stop()}return 32};this.Tej=()=>{this.DXd(this.mJ.gQ)};this.Sej=()=>{this.DXd(this.mJ.gQ)};this.Dh=b;this.Wb=h;this.ga=n;this.ld=x;this.sC=E;this.mJ=S;this.hb=ma;this.dHj=Fa;this.Xv=$a;this.Dw=sb;this.Tyj=Jb}get MDg(){return V.a.Vs||V.a.QOd?
"url("+this.GPh()+"), pointer":'url("'+this.GPh()+'"), pointer'}GPh(){return this.Dw?this.Xv.Csa(Gl.a.Sh("FormatPainterText.cur"),Gl.a.Sh("FormatPainterTextDarkMode.cur"),new EP.a(Bm.a.U1())):Gl.a.Sh("FormatPainterText.cur")}Vb(){const b=this.Wb.pe(Qe.AppFrame.iF);b.bindAction(mc.KeyInputManager.mc(db.a.R3a,0),Db.a.u9e);b.bindAction(mc.KeyInputManager.mc(db.a.Amb,6),Db.a.ICd);this.dHj||b.bindAction(mc.KeyInputManager.mc(db.a.Dmb,6),Db.a.rXa);this.ga.gb(Db.a.ICd,cc.a.view,this.gRl,1028);this.ga.gb(Db.a.rXa,
cc.a.view,this.eRl,1028);this.ga.gb(Db.a.u9e,cc.a.view,this.fRl,1028);this.mJ.$4j(()=>{this.I7f(this.mJ.gQ)});this.Dw&&this.Tyj.dqd(()=>{this.DXd(this.mJ.gQ)})}I7f(b){const h=this.Dh.iq.fg("UserAction","FormatPainterUpdateCursor");this.DXd(b);this.Dh.updateCommandUI();h.stop()}Rej(b,h){for(let n=0;n<b.length;n++)this.Qej(b[n],h);(b=this.Dh.jb.uv)&&b.Be&&this.Qej(b.Ug.editingElement,h)}Qej(b,h){b.style.cursor=h?this.MDg:""}DXd(b){const h=document.querySelectorAll(".OutlineElement");if(1<h.length){const n=
h[h.length-2].style.cursor===this.MDg;if(this.Dh.jb.isEditingAllowed||this.Dh.jb.Tx){if(b&&!n||!b&&n)this.Rej(h,b),this.ofj(b);b||!this.idd||this.Noe.count||(this.Dh.mNi(this.Tej),(b=this.Dh.jb.uv)&&b.Ji&&b.lpn(this.Sej),this.idd=!1)}else n&&(this.Rej(h,!1),this.ofj(!1))}}ofj(b){const h=this.Dh.jb.uv;h&&(b?this.Noe.add(h.ud.pn):this.Noe.remove(h.ud.pn))}static get Pb(){return null!=nC.Hhg?nC.Hhg:nC.Hhg=Oa.a.instance.Pa("Box4.IFeatureHelper")}get zNd(){null==this.bqb&&(u.AFrameworkApplication.Hf("0b2ac141;84eff841"),
this.bqb=u.AFrameworkApplication.K?u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsFormatPainterBugFixFlightEnabled",!1):!1);return this.bqb}}Object(r.a)(nC,"FormatPainterActor",null,[]);class Oy{constructor(b,h,n){this.Cm=n}S1k(b,h,n,x,E){var S;if(!({ve:n,selected:S,zx:$a}=this.C1i(h,n,!1)).returnValue)return $a;ue.a.mark(5013);var ma=Oy.Tg.kP(S);for(var Fa=0;Fa<ma.length;++Fa){if(!ma[Fa].Qd)continue;const sb=ma[Fa].iterator;sb.qo();if(gf.OutlineReader.rw(sb))return this.eDh(n,
sb)}ma=this.Yol();if(S.Rw||Kd.SelectionEditor.Ek(S)||Cd.ParagraphReader.gm(S)&&!Kd.SelectionEditor.p6(S)){if(Oy.Pb&&Oy.Pb.isFeatureEnabled(26)&&Rl.ContextSetEditor.instance.H_f(S).returnValue)return 8;var $a=this.fDh(h,n,b,x,E,ma)}else if(Kd.SelectionEditor.sk(S))$a=this.dDh(h,n,b,x,E,ma);else if(Kd.SelectionEditor.xf(S)){$a=new md.GraphIterator;$a.set(S.node);$a.Bb(10);Fa=nh.HyperlinkReader.NC(S,!1);if(0<Fa.length){if(!Fa[0].hyperlink)return w.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",
Fa[0].cpBegin,Fa[0].cpEnd),8;ob.App.Xyb(Fa[0].hyperlink.url);return 32}Fg.TableCellReader.GZ($a)&&($d.returnToContainingCell($a),Fg.TableCellReader.Uea($a)&&(Fa=new md.GraphIterator,Fa.fd($a),$d.returnToContainingRow(Fa),gf.OutlineReader.Mz($a,S,!1)&&al.a.gbi(Fa)&&0>=S.Fb&&(ma=Db.a.LLc,$d.returnToContainingTable($a),wf.OutlineElementNavigator.ae($a),E||(E=new qi.DictionaryPropertySet),E.lh(ad.a.targetObject,$a.currentNode.id))));$a=this.gDh(h,n,b,x,E,ma)}else Kd.SelectionEditor.p6(S)&&($a=u.AFrameworkApplication.ya.Qf(h,
Db.a.MB,2,!1,x,E));ue.a.mark(5014);return $a}C1i(b,h,n){let x=null,E=null;if(1===h)return{returnValue:!1,ve:x,selected:E,zx:32};if(!b.view.Be)return{returnValue:!1,ve:x,selected:E,zx:2};x=b.view;return(E=x.Cb.Rg)&&Oy.Zf.Nai(E,n)?this.Cm&&this.Cm.instance&&this.Cm.instance.vT(E)?{returnValue:!1,ve:x,selected:E,zx:4}:{returnValue:!0,ve:x,selected:E,zx:2}:{returnValue:!1,ve:x,selected:E,zx:2}}HPn(b,h,n,x,E){let S,ma;if(!({ve:n,selected:S,zx:ma}=this.C1i(h,n,!0)).returnValue)return ma;const Fa=Oy.Tg.kP(S);
for(let $a=0;$a<Fa.length;++$a){if(!Fa[$a].Qd)continue;const sb=Fa[$a].iterator;sb.qo();if(gf.OutlineReader.rw(sb))return this.eDh(n,sb)}S.Rw||Kd.SelectionEditor.Ek(S)?ma=this.fDh(h,n,b,x,E,Db.a.ALd):Kd.SelectionEditor.sk(S)?ma=this.dDh(h,n,b,x,E,Db.a.ALd):Kd.SelectionEditor.xf(S)?ma=this.gDh(h,n,b,x,E,Db.a.ALd):Kd.SelectionEditor.p6(S)&&(ma=u.AFrameworkApplication.ya.Qf(h,Db.a.MB,2,!1,x,E));return ma}eDh(b,h){b.Cb.setSelection(Ae.SelectionFactory.wo(h.currentNode,!1));return 32}fDh(b,h,n,x,E,S){const ma=
new Se.GraphTransaction(15);ma.zl=n;ma.Db(h.ud);h=new qi.DictionaryPropertySet;h.setValue(ad.a.GDc,!0);h=u.AFrameworkApplication.ya.Qf(b,Db.a.HG,2,!0,x,h);32===h&&(h=u.AFrameworkApplication.ya.Qf(b,S,2,!1,x,E));ma.dispose();return h}dDh(b,h,n,x,E,S){const ma=new Se.GraphTransaction(15);ma.zl=n;ma.Db(h.ud);h.Cb.setSelection(Kd.SelectionEditor.ak(h.Cb.ib.J(0),!1,!1));b=u.AFrameworkApplication.ya.Qf(b,S,2,!1,x,E);ma.dispose();return b}gDh(b,h,n,x,E,S){const ma=new Se.GraphTransaction(15,n);ma.zl=n;ma.Db(h.ud);
b=u.AFrameworkApplication.ya.Qf(b,S,2,!1,x,E);ma.dispose();return b}static get Tg(){return Rl.ContextSetEditor.instance}static get Zf(){return Ai.a.instance}static get Pb(){return null!=Oy.Dhg?Oy.Dhg:Oy.Dhg=Oa.a.instance.Pa("Box4.IFeatureHelper")}}Object(r.a)(Oy,"AEnterViewStrategy",null,[1336]);class OK extends Oy{constructor(b,h,n){super(b,h,n)}Yol(){return Db.a.MB}}Object(r.a)(OK,"EnterViewStrategy",Oy,[]);class hH{constructor(b){this.kl=this.transaction=null;this.ve=b;this.vBc=this.Tn=0}}Object(r.a)(hH,
"SelectAllArguments",null,[]);class pA{constructor(b,h,n,x){this.x3k=(E,S,ma,Fa,$a)=>S.view.Ji?this.Xbb(S,ma,this.e6i):this.gUi(E,S,ma,Fa,$a);this.NUc=(E,S)=>S.Tn?1===S.Tn?(S.ve.Cb.Z5d(S.kl,E),S.Tn=2,!0):2===S.Tn?(S.ve.Cb.ib.oWa=S.kl.oWa,this.vi.xF(),S.transaction.ODa(E),S.Tn=3,S.transaction.dispose(),ue.a.mark(5799),!0):!1:(S.transaction=this.Hc.Rc(2),S.transaction.Db(S.ve.ud),S.Tn=1,!0);this.gUi=(E,S,ma)=>{if(1===ma)return 32;if(!S.view.Be)return 2;E=S.view;return E.Cb&&E.Cb.ib&&E.Cb.ib.kb?this.e6i(E).inProgress?
1:32:8};this.e6i=E=>{u.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");this.Hse&&E.Ji&&w.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");E=new qq.a(null,this.D8m,new hH(E));E.ll("SelectAllInOutline");E.run();return E};this.D8m=(E,S)=>{if(!S.Tn)return S.kl=Ae.SelectionFactory.ABn(S.ve.Cb.ib.kb),S.transaction=this.Hc.Rc(2),S.transaction.Db(S.ve.ud),S.Tn=1,!0;if(1===S.Tn){if(!S.vBc)return S.ve.Cb.setSelection(S.kl.J(0),E),++S.vBc,!0;if(S.vBc<
S.kl.length)return S.ve.Cb.t3j(S.kl.J(S.vBc),E),++S.vBc,!0;S.Tn=2}return 2===S.Tn?(S.ve.Cb.ib.oWa=S.kl.oWa,this.vi.xF(),S.transaction.ODa(E),S.Tn=3,S.transaction.dispose(),!0):!1};this.xSb=b;this.nxa=h;this.Hc=n;this.Hse=x}get MZm(){return this.xSb}get vi(){return this.nxa.value}get zBn(){return this.Hse?this.x3k:this.gUi}Vb(){const b=u.AFrameworkApplication.ya;b.pa(Db.a.ova,Ld.a.frame,pA.F2i);b.pa(Db.a.BYf,Ld.a.frame,pA.F2i);b.gb(Db.a.Xbb,cc.a.view,this.zBn,2);b.gb(Db.a.XIa,cc.a.view,xd.AFrame.Bg,
100);b.gb(Db.a.izf,cc.a.view,pA.izf,4)}Xbb(b,h,n){if(1===h)return 32;if(!b.view.Be)return 2;h=b.view;if(!h.Cb)return 8;const x=h.Cb.ib;if(!x||!x.length)return 8;ue.a.mark(5798);ob.App.xa.jb.isEditingAllowed||ob.App.xa.jb.Tx||h.Ji?b=Kd.SelectionEditor.zef(x):(de.FocusManager.instance().YB(xd.AFrame.Xp),b=Ae.SelectionFactory.hUi(h.ud));if(!b)return 8;this.Hse&&!x.oWa&&w.ULS.sendTraceTag(39098305,324,50,"Progress selection start");n&&this.MZm.Lfb(Kd.SelectionEditor.HNh(b))?n=n(h):(n=new hH(h),n.kl=b,
n=new qq.a(null,this.NUc,n),n.ll("ExpandSelection"),n.run());return n.inProgress?1:32}static get V1a(){return null!=pA.Dog?pA.Dog:pA.Dog=Oa.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static izf(b,h,n){if(1===n)return 32;if(!h.view.Be)return 8;b=h.view;h=Ae.SelectionFactory.wo(b.root.graphNode,!0);if(!h)return 8;b.Cb.setSelection(h);return 32}static F2i(){var b=ob.App.xa.jb.uv;if(!b.Be)return 2;if(b.Be&&1!==ob.App.xa.state){ue.a.mark(4668);var h=b.Cb.ib.kb;if(!h&&u.AFrameworkApplication.K.$("ContextMenuOnSelectionFixIsEnabled"))return 2;
h=Kd.SelectionEditor.Pya(h);let n=h.x,x=h.y+h.height;if(!b.container)return 8;b=Sys.UI.DomElement.getBounds(b.container);if(h.y<b.y||h.y>b.y+b.height||h.x<b.x||h.x>b.x+b.width)n=b.x,x=b.y;pA.V1a.ova(new Sys.UI.Point(n,x),1);ue.a.mark(4669)}return 32}}Object(r.a)(pA,"SelectAllHandlers",null,[1160]);class PK{n5d(){}}Object(r.a)(PK,"FontNameFormattingStrategyNoop",null,[1303]);var FP=d(754);class IF{constructor(b,h,n,x,E,S){this.yeh=this.Ceh=null;this.qX=b;this.xeh=h;this.mhk=n;this.whk=x;this.Ceh=E;
this.yeh=S}}Object(r.a)(IF,"BookmarkHighlightContext",null,[]);class QK extends sg.a{constructor(){super()}get qla(){return!0}get nBb(){return 5}get oeb(){if(null!=this.spa)return this.spa;this.spa=[];this.spa.push(new bh.a(Eh.a.Qrd,Eh.a.Qrd));this.spa.push(new bh.a(Eh.a.dSe,Eh.a.dSe));this.spa.push(new bh.a(Eh.a.Vyc,Eh.a.Vyc));return this.spa}BNa(b,h){this.qla&&oo.a.instance.Pd(()=>{const n=this.Gy.SJa;var x=this.Gy.kQd;if(n)if(5===n.type){x=n.vF;if(n.eO&&n.eO.qX.includes(b))for(const E of h.h1a("*"))this.Gy.s1a(E);
x&&x.qX.includes(b)&&this.BZc(h,n.action,x,b)}else x&&5===x.type&&3===n.action&&x.vF.qX.includes(b)&&this.BZc(h,0,x.vF,b)},"BHA:OPHC")}e_a(b){return Object(pb.a)(IF,b)}ydb(b,h){if(b)for(let n of b.qX)h.add(n)}BZc(b,h,n,x){0===h&&b.htmlElement&&oo.a.instance.Pd(()=>{const E=b.h1a("*"),S=E.length,ma=Eh.a.Qrd;var Fa=x.id===n.Ceh,$a=x.id===n.yeh;let sb=!1;var Jb=0,Sb=[];let oc=Array(S);for(let Gd=0;Gd<S;Gd++){var Ic=E[Gd];const vd=pl.a(Ic);oc[Gd]=vd;const ce=Ic.classList;if(0!=oc[Gd]){const od=!ce.contains(Eh.a.ZH);
let Yd=hi.a.Eb(Ic,Eh.a.zvb);Yd&&Sb.push(...Yd);if(Fa){let ne;if((ne=hi.a.Eb(Ic,Eh.a.Srd))&&Yd&&1===ne.length&&1===Yd.length&&ne[0].equals(Yd[0]))continue;ne&&(Jb+=ne.length,1===vd?ce.add(Eh.a.dSe):ce.add(ma));if(Yd)for(let Df of Yd)this.DMd(n,Df)&&(Jb--,sb&&ce.add(Eh.a.Vyc));0!==Jb&&od&&ce.add(ma)}if(!Fa&&!$a&&n.whk.has(x.id))if((Ic=hi.a.Eb(Ic,Eh.a.zvb))&&sb){ce.add(ma);for(let ne of Ic)if(this.DMd(n,ne)){ce.add(Eh.a.Vyc);break}}else od&&ce.add(ma)}sb=!ce.contains(Eh.a.Lbb)}if($a&&!Fa){Fa=new Set;
for(var gd of Sb)this.DMd(n,gd)&&Fa.add(gd);sb=!1;for(Sb=0;0!==Fa.size&&Sb<S;Sb++){Jb=E[Sb];gd=Jb.classList;if(0!=oc[Sb])if($a=!1,Jb=hi.a.Eb(Jb,Eh.a.zvb)){for(let Gd of Jb)this.DMd(n,Gd)&&(Fa.delete(Gd),$a=!0);0!==Fa.size&&gd.add(ma);sb&&$a&&gd.add(Eh.a.Vyc)}else gd.contains(Eh.a.ZH)||gd.add(ma);sb=!gd.contains(Eh.a.Lbb)}}},"BHA:SPH")}DMd(b,h){for(let n of b.mhk)if(h.equals(n))return!0;return!1}}Object(r.a)(QK,"BookmarkHighlightActor",sg.a,[223]);var JF=d(1784),RK=d(1589);class KF{constructor(b,h,
n,x,E,S,ma,Fa,$a,sb){this.hg=b;this.aB=h;this.fb=E;this.FU=S;this.hj=ma;this.le=Fa;this.wc=sb;this.Ma=$a}lVf(b,h,n,x){const E=b.i5g(h);if(E){var S=Object(pb.a)(RK.a,b),ma=this.le.fg("WebServiceCall",String.format("SendGraphicsEditorRequest: ClosingDialog = {0} EditingExistingContent = {1}",S,n)),Fa=h.tk.node,$a=()=>{n||this.Dnn(h.tk,E.getId())};S=KF.Ofh();x=this.mgh(E.getId().toString(),Fa,x,n);try{b.pah(x,h)}catch(sb){w.ULS.sendTraceTag(572872463,3001,10,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Exception while trying to AppendUrlParameters. Exception: "+
sb.message);this.qp(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);return}this.hg.Lj(S,2,x.toString(),{},!0,0,sb=>{w.ULS.sendTraceTag(575522560,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Successfully created GraphicsEditorSession.");b.v0a(sb,E,()=>{this.qp(b.JGd())},$a,Fa,h,ma)},sb=>{const Jb=415===sb.data.mf;let Sb="";sb&&sb.data&&sb.data.qj&&"X-CorrelationId"in sb.data.qj&&sb.data.qj["X-CorrelationId"]&&(Sb=sb.data.qj["X-CorrelationId"]);b.Dma(`Graphics editor request failed. HttpStatus [${sb.data.mf}], ResponseData [${sb.data.Ee}], CorrelationId [${Sb}]`,
E,Fa,$a,()=>{this.qp(Jb?WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError:b.JGd())},ma,Jb)},null)}else this.qp(b.JGd())}dDn(b,h,n){return new Promise((x,E)=>{var S=b.tk.node;S.Bi();const ma=KF.Ofh();S=this.mgh(h.toString(),S,n,!1);S.Me(JF.a.mYe,"2");this.hg.Lj(ma,2,S.toString(),{},!0,0,Fa=>{w.ULS.sendTraceTag(575522563,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Successfully created.");x(Fa.data.Ee)},Fa=>{w.ULS.sendTraceTag(575522564,3001,10,`GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Request failed. HttpStatus ${Fa.data.mf}, ResponseData ${Fa.data.Ee}`);
this.qp(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);E(null)},null)})}mgh(b,h,n,x){const E=h.Bi(),S=new Ea.QueryStringBuilder("WordGraphicsEditorHandler.ashx");u.AFrameworkApplication.gja(S);S.Me(JF.a.strict,this.Mcm(h)?"true":"false");S.Me(Qi.a.nodeId,b);S.Me(Qi.a.cellId,E.Zl.toString());S.Me(Qi.a.fileId,E.Bs);S.Me(Qi.a.K1,n.toString());S.Me(JF.a.k3k,x?"true":"false");if(b=!!this.wc&&this.wc.isFeatureEnabled(51)){S.Me(Ve.a.jDi,b.toString());if(b=this.wc.isFeatureEnabled(96))S.Me(Ve.a.H2m,
b.toString()),S.Me(Ve.a.ignoreMalformedColors,this.wc.isFeatureEnabled(59).toString());this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.PictureTransparency",!1)&&S.Me(Ve.a.P2m,"true")}S.Me(Ve.a.Idh,"true");jl.a.instance.Lub(S);return S}Mcm(b){if(!this.aB)return!1;b=this.aB.gu(b);return!!b&&b.Og(ic.a.msf)}Dnn(b,h){b.cpBegin===b.cpEnd-1&&this.hj.Bbc(b.node,h,this.fb,this.FU)}qp(b){const h=new yd.StandardDialog;h.Ed=0;h.fy(ri.a.g4e,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,b,null,b===
WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError);ob.App.xa.updateCommandUI()}static Ofh(){const b=new Ea.QueryStringBuilder("WordGraphicsEditorHandler.ashx");u.AFrameworkApplication.gja(b);return b.toString()}}Object(r.a)(KF,"GraphicsEditorRequestManager",null,[628]);class SK extends cF{constructor(b,h){super(b,h);this.LLa=Db.a.insertHyperlink}hZa(b){null!=b&&0<b.length&&this.Ac.Xb(this.LLa,2,b[0])}Mlj(b,h,n){const x=vj.a.lg(u.AFrameworkApplication.lcid).name;return String.format(b,
u.AFrameworkApplication.lcid,x,u.AFrameworkApplication.buildVersion,h,ZC.Pee,n)+"&flipgrid=1&ted=1"}}Object(r.a)(SK,"InsertHubbleMediaHelper",cF,[]);class TK{constructor(b,h,n,x,E,S){this.ga=b;this.Ma=h;this.Rbd=n;this.G0=x;this.Z9c=E;this.Ok=S}Vb(){this.ga.gb(ub.a.Wzi,cc.a.Wc,this.fYm.bind(this),1028);this.ga.gb(ub.a.t7h,cc.a.Wc,this.b4l.bind(this),1028)}b4l(b,h,n,x,E){if(1!==n){if(null==E)return 16;if(!h.ul||!Kd.SelectionEditor.xf(h))return 2;b=this.Mol(E);E=E.OriginalUrl;u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1);this.Z9c.$ag(b,h,E)}return 32}arj(){u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("OnlineVideoFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Oa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("OnlineVideoInserted","OnlineVideoFloodgateIsEnabled")})},5E3)}Mol(b){const h=new Jp;h.MediaType=b.ContentType;h.Height=b.Height;h.Width=b.Width;h.IFrameHtml=b.Html;h.Title=b.Caption;h.Thumbnail=b.ThumbnailUrl;return h}fYm(b,h,n){var x,E;if(1!==n)h=B.a.TV(this.Ma.lb("UserId")).toString(),
h=this.G0.Mlj(this.Ma.appSettings.InsertVideoHubbleEndpoint,na.a.create().toString(),h),this.G0.LLa=ub.a.t7h,h=this.Rbd.NHc(h,!0),h.correlationId=na.a.create(),h.qfa=5,h.o7d(null,this.G0),Y.a.sendTelemetryEvent(Object.assign(new fa.a,{name:"Office.Word.Online.OnlineMedia",dataFields:[Object.assign(new ca.a,{name:"ActionId",int64:b})]})),this.arj();else if(!(h&&h.node&&js.a(h.node))||vs.a.wvd&&(null===(x=this.Ok)||void 0===x?0:x.bZ(h))||(null===(E=this.Ok)||void 0===E?0:E.ota(h)))return 2;return 32}}
Object(r.a)(TK,"OnlineMediaActor",null,[]);class UK extends aF{constructor(b,h,n,x=null,E=!1){super(b,h,n,x,E);this.Onc=null}get telemetryEventName(){return"Office.Word.Online.OnlineMediaDialog"}DGc(){const b={};b.insertMediaServiceEndpoint=this.Sbd;b.iFrameId="mediaiframe";return b}o7d(b,h){this.UOb=b;this.Onc=h;this.Fmc=!1;b={["id"]:"OnlineMediaDialog",["bodyControls"]:this.DGc(),["componentIsVisibleCallback"]:this.opj.bind(this)};this.Zh(this.UOb,null,b)}opj(){this.NZ=this.X1b(this.pj("mediaiframe"));
this.nG=this.Hhd.getInstance(this.NZ.contentWindow,this.Sbd);this.nG.xr(F.a.N6g,b=>{this.Tti(b,this.Onc.hZa.bind(this.Onc))});this.nG.xr(F.a.insert,b=>{this.qWd(b,this.Onc.hZa.bind(this.Onc))});this.nG.xr(F.a.JNh,this.Pvi.bind(this));this.nG.xr(F.a.getSessionId,this.Svi.bind(this));this.nG.xr(F.a.xLh,this.Ovi.bind(this));this.nG.xr(F.a.Msd,this.Dui.bind(this));this.Jjb(3)}Jjb(b){const h=[];h.push(Object.assign(new ca.a,{name:"DialogResult",string:YC[b]}));h.push(Object.assign(new ca.a,{name:"DialogMode",
string:this.Ydf()}));h.push(Object.assign(new ca.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new ca.a,{name:"Provider",string:uB[this.qfa]||"Unknown"}));Y.a.sendTelemetryEvent(Object.assign(new fa.a,{name:this.telemetryEventName,dataFields:h}))}}Object(r.a)(UK,"OnlineMediaDialog",aF,[]);class VK{constructor(b,h){this.Mre=b;this.G0=h}NHc(b,h=!1){return new UK(b,this.Mre,this.G0,null,h)}getInstance(){throw Error.notImplemented();}}Object(r.a)(VK,"OnlineMediaDialogFactory",
null,[629]);class WK extends yk{constructor(){super(1,3);this.Wv=Oa.a.instance.resolve("Common.IReactContextualUILauncher");this.u9i=!1}x2a(){u.AFrameworkApplication.ya.processAction(ub.a.dec,2)}Tzd(){this.qHh&&!this.Nu&&(this.Nu=this.BGa())}GAd(){if(this.Nu&&this.Nu.isVisible){var b=Object(ja.a)($k.Control,this.Nu.controls["ExternalContentFloatie.FlyoutAnchor"]);b.behavior.jw(b.bdb(),1,null)}b=document.getElementById("ExternalContentFloatieFlyout");if(null==b)w.ULS.shipAssertTag(555816415,324,!1,
"ExternalContentFloatieEventManger.onOnlyKeyPressed: externalContentFloatieUIElement is null.");else{var h=b.getBoundingClientRect();0<h.top&&h.bottom<window.innerHeight&&(h=b.getAttribute(qf.a.lrd)||"",qf.a.eL===h&&b.click())}}EZ(){return this.Wv.EZ}}Object(r.a)(WK,"ExternalContentFloatieManager",yk,[]);class rr{constructor(){rr.N1l()}get pc(){return null!=this.Arg?this.Arg:this.Arg=Oa.a.instance.resolve("Box4.Styles.IWACStyleReader")}get key(){return"FORMATTING_PARAGRAPH"}get hw(){return null}qgc(b){var h=
null;if(!Cd.ParagraphReader.wh(b))return{returnValue:!1,Sja:h};if((b=this.pc.yo(b.currentNode))&&2===this.pc.Ow(b)){const n=this.pc.tf(b);rr.eP.contains(n)&&(h=this.pc.rF(b),h=Object.assign(new yg.a,{IF:this.key,contentId:b.id,contentObject:h}))}return{returnValue:!!h,Sja:h}}Azb(b,h){let n=null;h&&b.contentId.equals(h.contentId)||(n=b.contentObject);return n}static N1l(){rr.eP=new Lm.a;rr.eP.add(jh.StyleReader.styleIdHeading1);rr.eP.add(jh.StyleReader.styleIdHeading2);rr.eP.add(jh.StyleReader.styleIdHeading3);
rr.eP.add(jh.StyleReader.uva);rr.eP.add(jh.StyleReader.yPa);rr.eP.add(jh.StyleReader.zPa);rr.eP.add(jh.StyleReader.Rec);rr.eP.add(jh.StyleReader.P2a);rr.eP.add(jh.StyleReader.wordStyleIdHeading1);rr.eP.add(jh.StyleReader.wordStyleIdHeading2);rr.eP.add(jh.StyleReader.wordStyleIdHeading3);rr.eP.add(jh.StyleReader.$3a);rr.eP.add(jh.StyleReader.a4a);rr.eP.add(jh.StyleReader.b4a);rr.eP.add(jh.StyleReader.lmb);rr.eP.add(jh.StyleReader.mmb);rr.eP.add(jh.StyleReader.c4a);rr.eP.add(jh.StyleReader.g4a);rr.eP.add(jh.StyleReader.whc)}}
rr.eP=null;Object(r.a)(rr,"ParagraphStyleDetailsProvider",null,[574,227]);class XK{constructor(b,h,n,x){this.GGa=b;this.AJj=h;this.IJj=n;this.JJj=x}FPf(){this.GGa.execute(b=>{b.ubc(this.AJj.value);b.ubc(new rr);b.ubc(this.JJj.value);b.a3(this.IJj.value)})}}Object(r.a)(XK,"AccessibilityActor",null,[]);class YK{constructor(b,h,n){this.ig=null;this.C_c=(x,E,S)=>{if(1===S)return 32;this.ig=this.ylc.value.lFk(this.Wb);if(!this.ig)return w.ULS.sendTraceTag(21233673,334,10,"AccessibilityHelpDialog failed to initialize"),
8;this.ig.nPa();return 32};this.S4g=x=>this.ig?this.ig.MSl(x):2;this.ga=b;this.ylc=h;this.Wb=n}Vb(){if(u.AFrameworkApplication.K.$("UIDiscoverabilityEnabled")){var b=mc.KeyInputManager.mc(db.a.zmb,5);this.Wb.pe(xd.AFrame.Xp).Ar(b);this.Wb.pe(xd.AFrame.Lp).bindAction(b,Ra.a.C_c);this.ga.pa(Ra.a.C_c,Ld.a.frame,this.C_c);this.ga.pa(Ra.a.gxc,Ld.a.frame,this.S4g);this.ga.pa(Ra.a.fxc,Ld.a.frame,this.S4g)}}}Object(r.a)(YK,"AccessibilityHelpDialogActor",null,[]);var GP=d(996),HP=d(1373);class ZK{constructor(b,
h){this.tEj=b.rc("WordHangForActionManagerThresholdTime",750);this.ga=h;this.Vsj=GP.a.lF(26,5,new HP.a)}b3(){this.ga.b3(this)}O6(){}N6(b){const h=+b.endTime-+b.startTime;if(h>this.tEj){let n="";switch(b.behavior){case 1:n="E";break;case 2:n="X";break;case 3:n="A"}(b=pd.ActionManager.Sca(b.actionId))&&b.length||(b="UnknownAction");this.Vsj.track(h,b+"_"+n)}}}Object(r.a)(ZK,"ActionHangDetector",null,[40]);var $K=d(1437),LF;(function(b){b[b.Unknown=0]="Unknown";b[b.Excel=1]="Excel";b[b.OneNote=2]="OneNote";
b[b.PowerPoint=3]="PowerPoint";b[b.Visio=4]="Visio";b[b.Word=5]="Word";b[b.Project=6]="Project";b[b.Publisher=7]="Publisher";b[b.Infopath=8]="Infopath";b[b.Access=9]="Access"})(LF||(LF={}));Object(r.b)("OfficeApplication",LF);var rE;(function(b){b[b.ReadWrite=0]="ReadWrite";b[b.ReadOnly=1]="ReadOnly";b[b.WriteOnly=2]="WriteOnly";b[b.ForceCheckout=3]="ForceCheckout";b[b.WriteLocalCopy=4]="WriteLocalCopy";b[b.OpenInBrowser=5]="OpenInBrowser"})(rE||(rE={}));Object(r.b)("OpenDocumentMode",rE);class aL extends mg{constructor(b){super(b,
void 0,u.AFrameworkApplication.AWa,new sc(b,!1))}get V_a(){return CommonUIStrings.l_DownLoadACopyDialogMessageWorkOffline}get g8b(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get $Pc(){return"DownloadCopyLink"}get buttonText(){return CommonUIStrings.l_DownloadACopyMin}get sCc(){return u.AFrameworkApplication.AWa?"UIFontDialogTextLarge":null}Wvf(){w.ULS.sendTraceTag(7690388,324,50,"Download a copy dialog displayed")}Xvf(){w.ULS.sendTraceTag(7690389,324,50,"Download a copy dialog clicked")}rQc(){w.ULS.sendTraceTag(19462214,
324,50,"Download a copy dialog button clicked");u.AFrameworkApplication.ya.processAction(Ra.a.hAh,2)}}Object(r.a)(aL,"DownloadACopyDialog",mg,[]);var bL=d(1684);const kD=b=>{for(let h=0;h<b.children.length;h++){const n=b.children[h];n.style.position="relative";n.style.top=(n.parentNode.offsetHeight-n.offsetHeight)/2+"px"}},MF=b=>b.Ib.keyCode===db.a.Ks||b.Ib.keyCode===db.a.nQa?(b.Af.click(),!0):!1,sE=(b,h,n,x,E,S,ma)=>{const Fa=document.createElement("a");Fa.className="ProtocolLaunchingDialogButtonAnchor";
Fa.className+=" OICDialog";Fa.id=b;Fa.setAttribute(qf.a.Ah,qf.a.n1);Fa.style.padding="0";Fa.style.margin="0";x&&cL(E,h,n,x,Fa);b=document.createElement("span");b.className="ProtocolLaunchingDialogButtonLabel";b.innerText=E;Fa.appendChild(b);Fa.tabIndex=0;S&&$e.a.instance.mb(kb.a.click,Fa,S);ma&&mc.KeyInputManager.instance.mb(kb.a.Bh,Fa,ma);return Fa},cL=(b,h,n,x,E)=>{var S=document.createElement("img");S.alt=b;S.className=Tg.getImageClassWithCluster(n,x);S.src=h;S.setAttribute(qf.a.Ah,qf.a.xz);b=
document.createElement("span");b.className="ProtocolLaunchingDialogImg32Container";b.appendChild(S);S=document.createElement("span");S.className="ProtocolLaunchingDialogIconContainer";S.appendChild(b);E.appendChild(S)};class NF{static get ug(){return Kc.a.Lx(NF.rl,CommonUIStrings.l_OICLaunchDialogTitle)}}NF.rl="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(r.a)(NF,"OICLaunchDialogHtml",null,[]);class dL extends Kc.a{constructor(b){super();this.tNb=this.lnb=null;this.HK=!1;this.Rp=b;this.ug=NF.ug;this.Ed=5;this.kg="OICLaunchDialog";this.showDialog("",Object(v.a)(this,this.jMm,"oicLaunchDialogResultHandler"));this.ZXi();this.m3("ProtocolLaunchingDialogTitle");4!==u.AFrameworkApplication.ua.Sb.dKa&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.mU(this.lnb);w.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}UT(){this.lnb=sE("BtnRichClient",this.Rp.DDc,this.Rp.eLc,this.Rp.blf,CommonUIStrings.l_OICLaunchRichClient,Object(v.a)(this,this.fyi,"onRichClientButtonClick"),MF);document.getElementById("OICLaunchRichClient").appendChild(this.lnb);kD(this.lnb);this.tNb=sE("BtnReturn",this.Rp.DDc,this.Rp.eLc,this.Rp.p5h,CommonUIStrings.l_OICReturnToOnlineClient,Object(v.a)(this,this.byi,"onReturnButtonClick"),
MF);document.getElementById("OICReturnToApp").appendChild(this.tNb);kD(this.tNb)}byi(){this.hide();this.Rp.Xbc();return!0}fyi(){w.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();u.AFrameworkApplication.ya.processAction(Ra.a.kIb,2);return!0}jMm(){this.Rp.Xbc()}dispose(){this.HK||(this.lnb&&($e.a.instance.sc(kb.a.click,this.lnb,Object(v.a)(this,this.fyi,"onRichClientButtonClick")),mc.KeyInputManager.instance.sc(kb.a.Bh,this.lnb,MF)),this.tNb&&($e.a.instance.sc(kb.a.click,
this.tNb,Object(v.a)(this,this.byi,"onReturnButtonClick")),mc.KeyInputManager.instance.sc(kb.a.Bh,this.tNb,MF)),super.dispose(),this.HK=!0)}}Object(r.a)(dL,"OICLaunchDialog",Kc.a,[]);class OF{static get ug(){return Kc.a.Lx(OF.rl,CommonUIStrings.l_OICDialogTitle)}}OF.rl="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(r.a)(OF,"ProtocolLaunchingDialogV2Html",null,[]);class eL extends Kc.a{constructor(b){super();this.sNb=this.IQa=null;this.HK=!1;this.$4a=null;this.Rp=b;this.ug=OF.ug;this.Ed=5;this.kg="ProtocolLaunchingDialog";this.Ynb="OICRetryDialog";u.AFrameworkApplication.uc.aBb&&u.AFrameworkApplication.uc.restart();u.AFrameworkApplication.uc.$b(new We.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(v.a)(this,this.HMf,"protocolLaunchingDialogResultHandler"));this.ZXi();this.m3("Issues");
this.KHh();w.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}UT(){const b=document.getElementById("Issues");if(b){cL("",this.Rp.DDc,this.Rp.eLc,this.Rp.blf,b);const h=document.createElement("span");h.className="WACDialogSectionTitle";h.innerText=5===this.Rp.Jzi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;b.appendChild(h);kD(b);b.style.display="none"}u.AFrameworkApplication.ua.Sb.f0h?
(this.sNb=sE("GiveFeedback",this.Rp.DDc,this.Rp.eLc,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(v.a)(this,this.cWd,"onGiveFeedbackClick"),Object(v.a)(this,this.Uvi,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.sNb),kD(this.sNb)):document.getElementById("ButtonGiveFeedback").style.display="none";0===u.AFrameworkApplication.ua.Sb.dKa||u.AFrameworkApplication.AUk?document.getElementById("ButtonEdit").style.display="none":(this.IQa=
sE("Edit",this.Rp.DDc,this.Rp.eLc,"",2===u.AFrameworkApplication.ua.Sb.jo?4===u.AFrameworkApplication.ua.Sb.dKa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===u.AFrameworkApplication.ua.Sb.dKa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(v.a)(this,this.tvi,"onEditClick"),Object(v.a)(this,this.wvi,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.IQa),kD(this.IQa));0===u.AFrameworkApplication.ua.Sb.dKa&&
!u.AFrameworkApplication.Pqf&&b&&(b.style.display="none")}LHh(){return this.$4a?(this.mU(this.$4a),!0):!1}KHh(){return this.IQa?(this.mU(this.IQa),!0):!1}wvi(b){return this.hEf(b,0)}Uvi(b){return this.hEf(b,2)}ayi(b){return this.hEf(b,1)}hEf(b,h){let n=!1;if(b.Ib.keyCode===db.a.Ks||b.Ib.keyCode===db.a.nQa)b.Af.click(),n=!0;else if(b.Ib.keyCode===Sys.UI.Key.down||b.Ib.keyCode===Sys.UI.Key.up)switch(h){case 1:n=this.KHh();break;case 0:n=this.LHh()}return n}tvi(){this.hide();4===u.AFrameworkApplication.ua.Sb.dKa?
(w.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Rp.Xbc()):(w.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Rp.HJc());return!0}cWd(){w.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}NFf(){fP.Redirect.showHelp("OICFailure");return!0}XWd(){w.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";u.AFrameworkApplication.ya.processAction(Ra.a.kIb,2);return!0}HMf(){this.Rp.Xbc()}switchToBackupMode(){var b=
document.getElementById("ProtocolLaunchingDialogTitle");if(b){b.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(b=document.getElementById("Issues"))b.style.display="block";(b=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!b.children.length&&(this.$4a=sE("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(v.a)(this,this.XWd,"onRetryOICClick"),Object(v.a)(this,this.ayi,"onRetryOICKeyUp")),b.appendChild(this.$4a),kD(this.$4a),this.IQa||this.LHh())}}dispose(){this.HK||(this.IQa&&
($e.a.instance.sc(kb.a.click,this.IQa,Object(v.a)(this,this.tvi,"onEditClick")),mc.KeyInputManager.instance.sc(kb.a.Bh,this.IQa,Object(v.a)(this,this.wvi,"onEditKeyUp"))),this.sNb&&($e.a.instance.sc(kb.a.click,this.sNb,Object(v.a)(this,this.cWd,"onGiveFeedbackClick")),mc.KeyInputManager.instance.sc(kb.a.Bh,this.sNb,Object(v.a)(this,this.Uvi,"onGiveFeedbackKeyUp"))),this.$4a&&($e.a.instance.sc(kb.a.click,this.$4a,Object(v.a)(this,this.XWd,"onRetryOICClick")),mc.KeyInputManager.instance.sc(kb.a.Bh,
this.$4a,Object(v.a)(this,this.ayi,"onRetryOICKeyUp"))),super.dispose(),this.HK=!0)}}Object(r.a)(eL,"ProtocolLaunchingDialog",Kc.a,[]);class PF extends yd.StandardDialog{constructor(b){super();this.Rp=b;this.kg="ProtocolLaunchingDialog";u.AFrameworkApplication.uc.aBb&&u.AFrameworkApplication.uc.restart();u.AFrameworkApplication.ua.Sb.f0h&&this.d1j(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(v.a)(this,this.cWd,"onGiveFeedbackClick"));PF.X1h?(this.Ed=12,this.We(1,CommonUIStrings.l_CloseFile),
this.We(2,CommonUIStrings.l_OICDialogContinueHere),this.We(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Ed=4,this.We(1,CommonUIStrings.l_OICDialogContinueHere),this.We(2,CommonUIStrings.l_OICDialogLaunchAgain));this.ahb(CommonUIStrings.l_OICDialog2ndTitle,5===this.Rp.Jzi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(v.a)(this,this.HMf,"protocolLaunchingDialogResultHandler"),null)}cWd(b){w.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");
this.Cvi(b)}XWd(){w.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");u.AFrameworkApplication.ya.processAction(Ra.a.kIb,2)}HMf(b){PF.X1h?3===b?this.UQi():2===b||0===b?this.continueEditing():1===b&&this.closeDocument():2===b?this.UQi():(1===b||0===b)&&this.continueEditing()}closeDocument(){w.ULS.sendTraceTag(577783557,211,50,"Closing the document");u.AFrameworkApplication.ya.Xb(Ra.a.close,2,dk.a)}UQi(){w.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(v.a)(this,this.XWd,
"onRetryOICClick"),0)}continueEditing(){4===u.AFrameworkApplication.ua.Sb.dKa||u.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&1===u.AFrameworkApplication.ua.mode?(w.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Rp.Xbc()):(w.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Rp.HJc())}static get X1h(){return u.AFrameworkApplication.K.$("OICDialogThreeActions")&&32===u.AFrameworkApplication.ya.processAction(Ra.a.close,
1)}}Object(r.a)(PF,"StandardProtocolLaunchingDialog",yd.StandardDialog,[]);class fL{}Object(r.a)(fL,"EditDocumentInClientParams",null,[]);class iH{static FAh(b,h,n,x,E,S,ma=!1,Fa=!1,$a="",sb=!1,Jb=!1,Sb=!1,oc="",Ic="",gd="",Gd=!1){const vd=new fL;vd.DocumentUrl=b;vd.Mode=h;vd.Options=n;vd.Application=x;vd.SilentExternalHandler=ma;vd.EncodeUrl=Fa;vd.CorrelationIdForWinClient=$a;vd.NavigateUsingWindowOpen=sb;vd.DescriptiveUnattemptedEnums=Jb;vd.NoBrowserModalDialogs=Sb;vd.SessionOrigin=oc;vd.CorrelationId=
Ic;vd.ClickTime=gd;vd.NewTelemetryDataIsEnabled=Gd;MSOJS.ClientUtils.EditDocumentInClient(vd,E,S)}}Object(r.a)(iH,"ClientUtils",null,[]);var IP=d(408),gL=d(920);class oC{constructor(b){this.gTa=this.Ylc=this.Wjc=null;this.inc=!1;this.ixe=this.iRg=null;this.V6c=this.l0=this.Bkd="";this.application=this.qy=0;this.p2n=this.c2f=!1;this.Hlo=b&&u.AFrameworkApplication.K.$("OICLaunchDialogIsEnabled");u.AFrameworkApplication.ya.V5(Ra.a.kIb)||u.AFrameworkApplication.ya.pa(Ra.a.kIb,Ld.a.frame,Object(v.a)(this,
this.Mwn,"retryOpenInClientAction"));this.f4i=!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("SilentExternalHandler")}get Jzi(){return this.qy}gNn(b,h="",n=""){this.l0=n||na.a.create().toString();this.Bkd=h||IP.a.BTh();this.V6c=b}Mwn(b,h,n){return h.contextId!==Ld.a.frame?2:1===n?32:this.kIb()}get options(){let b=0;u.AFrameworkApplication.Ktn&&(b|=1);u.AFrameworkApplication.Pzi&&(b|=4);this.i2n()&&(b|=64);return b}i2n(){return!(2===this.application&&u.AFrameworkApplication.K.$("IsEmbeddedScenario"))}get DDc(){return u.AFrameworkApplication.mr}get eLc(){return u.AFrameworkApplication.bQ}get p5h(){return""}get blf(){return""}get o2n(){return u.AFrameworkApplication.K.$("OneNoteMobileViewerIsEnabled")}get F5n(){return this.iRg||
(this.iRg=Oa.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.c2f||this.J2k()}Xbc(){this.p2n||this.bEh()}CIi(b){return this.Hlo&&V.a.ki?(new dL(this),32):this.Xnh(b)}Xnh(b){const h=({Alb:b}=this.dom(b)).returnValue;w.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===h,b);return h}begin(b,h,n,x,E,S){this.Wjc=b;this.Ylc=h;this.gTa=S;this.application=n;this.qy=x;return u.AFrameworkApplication.oAh?(this.Jii(),32):u.AFrameworkApplication.Kta&&!u.AFrameworkApplication.i4h?
(u.AFrameworkApplication.u_f(),8):this.Odh(E)}get iMm(){return!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}kIb(){this.iMm&&this.Ytm();return this.Xnh(this.inc)}lVi(){const b=new gL.a(F.a.openInClient);b.Values["ui-language"]=u.AFrameworkApplication.lcid.toString();b.Values[lA.a.Ruh]=u.AFrameworkApplication.userSessionId;return this.gTa.value.send(b)?32:8}Ytm(){ta.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new ab.a,{inStaging:!0}))}ODn(b){const h=new gL.a(F.a.soo);h.Values["ui-language"]=u.AFrameworkApplication.lcid.toString();h.Values[lA.a.Ruh]=u.AFrameworkApplication.userSessionId;h.Values[G.a.roo]=b;this.gTa.value.send(h)}dom(b){this.inc=b;this.ODn(5===this.qy?oC.SXm:oC.YXm);return 5===this.qy?this.com():this.gom()}com(){this.Sii();return{returnValue:32,Alb:"HostEditUrl,"}}gom(){let b;var h=b="";u.AFrameworkApplication.G7g&&(h="|f|"+u.AFrameworkApplication.userSessionId);
const n=u.AFrameworkApplication.K.$("IsAssignmentMode")&&u.AFrameworkApplication.K.$("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||u.AFrameworkApplication.SOc||V.a.vMa,x=u.AFrameworkApplication.K.$("UnattemptedEnumIsEnabled"),E=u.AFrameworkApplication.K.$("NoBrowserModalDialogs");if(u.AFrameworkApplication.ya.BUd){var S=u.AFrameworkApplication.ya.xea(3588168074);S&&this.gNn(S.epochClickTime,S.sessionOrigin,S.correlationId);this.yli()}if(u.AFrameworkApplication.mEi){b+="NewOrder,";S=
8;this.gTa&&this.gTa.value&&this.gTa.value.isEnabled()&&u.AFrameworkApplication.Wgc&&(b+="Post,",S=this.lVi());if(32===S)return{returnValue:S,Alb:b};w.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return u.AFrameworkApplication.ut.Gma?(w.ULS.shipAssertTag(5566816,211,!!u.AFrameworkApplication.ut.Gma),b+="HostUrl,",{returnValue:u.AFrameworkApplication.ua.K2(!0,u.AFrameworkApplication.ut.Gma),Alb:b}):this.Wjc?(w.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",
u.AFrameworkApplication.userSessionId),b+="DocUrl,",iH.FAh(this.Wjc,this.qy,this.options,this.application,Object(v.a)(this,this.vvi,"onEditInClientSuccess"),Object(v.a)(this,this.uvi,"onEditInClientFailure"),this.f4i,u.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,n,x,E,this.Bkd,this.l0,this.V6c,u.AFrameworkApplication.ya.BUd),{returnValue:32,Alb:b}):{returnValue:8,Alb:b}}b+="OldOrder,";if(!this.Wjc&&u.AFrameworkApplication.ut.Gma)return this.gTa&&this.gTa.value&&this.gTa.value.isEnabled()&&
u.AFrameworkApplication.Wgc?(b+="Post,",h=this.lVi()):(w.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),h=8),32!==h?(w.ULS.shipAssertTag(22595484,211,!!u.AFrameworkApplication.ut.Gma),b+="HostUrl,",{returnValue:u.AFrameworkApplication.ua.K2(!0,u.AFrameworkApplication.ut.Gma),Alb:b}):{returnValue:h,Alb:b};w.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",u.AFrameworkApplication.userSessionId);b+="DocUrl,";iH.FAh(this.Wjc,
this.qy,this.options,this.application,Object(v.a)(this,this.vvi,"onEditInClientSuccess"),Object(v.a)(this,this.uvi,"onEditInClientFailure"),this.f4i,u.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,n,x,E,this.Bkd,this.l0,this.V6c,u.AFrameworkApplication.ya.BUd);return{returnValue:32,Alb:b}}Lsn(b){u.AFrameworkApplication.km.setDw(8981,b)}vvi(b){this.Lsn(b);w.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===b&&MSOJS.ClientUtils.ShouldShowDialog()?(this.o2n||this.Sii(),this.yli()):
this.c2f||this.closeApplication()}uvi(b,h=0){w.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",b,h);if(5===b)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const n=!!this.Ylc&&!this.inc;let x=0;1===b&&(x=2);6<=b&&13>=b&&(x=1,1===h&&(this.c2f=!0));this.F5n.VLm?(w.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",x),bL.a.instance.QJk(this.inc?Object(v.a)(this,this.Cti,"oicErrorDialogHandlerCloseForced"):
Object(v.a)(this,this.Dti,"oicErrorDialogHandlerNoCloseForced"),n?Object(v.a)(this,this.twi,"onLaunchDownload"):null,this.oyh(!1)?Object(v.a)(this,this.XXl,"iHaveOfficeButtonHandler"):null,x,h)):(w.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",x),bL.a.instance.OJk(this.inc?Object(v.a)(this,this.Cti,"oicErrorDialogHandlerCloseForced"):Object(v.a)(this,this.Dti,"oicErrorDialogHandlerNoCloseForced"),n?Object(v.a)(this,this.twi,"onLaunchDownload"):null,x))}}yli(){try{const b=
[Object.assign(new ca.a,{name:"CorrelationId",string:this.l0}),Object.assign(new ca.a,{name:"SessionOrigin",string:this.Bkd}),Object.assign(new ca.a,{name:"ClickTime",string:this.V6c}),Object.assign(new ca.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];Pe.a("OpenInClientCompleted",!0,0,b)}catch(b){w.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+b.toString())}}Sii(){u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.zA&&u.AFrameworkApplication.K.$("StandardProtocolDialogIsEnabled")?
new PF(this):new eL(this)}Cti(){this.closeApplication()}Dti(){this.Xbc()}twi(){this.Jii()}XXl(){return this.oyh(!0)}oyh(b){const h=(V.a.PZa||V.a.Vs)&&!!u.AFrameworkApplication.syd;h&&b&&(rd.a.ym(u.AFrameworkApplication.syd,"_blank",void 0,"OpenInClient"),this.closeApplication());return h}}oC.YXm="OpenInDesktop";oC.SXm="OpenInBrowser";Object(r.a)(oC,"AOpenInClientOperation",null,[]);class jH extends oC{constructor(b,h,n=!1){super(n);this.AFj=b;this.zFj=h}get p5h(){return this.zFj}get blf(){return this.AFj}J2k(){u.AFrameworkApplication.ya.Xb(Ra.a.close,
2,dk.a)}bEh(){}Odh(b){return this.CIi(b)}Jii(){w.ULS.shipAssertTag(5566817,211,!!this.Ylc);u.AFrameworkApplication.A$?u.AFrameworkApplication.ua.K2(!0,this.Ylc):rd.a.ym(this.Ylc,void 0,void 0,"LaunchDownload")}HJc(){u.AFrameworkApplication.ua.Sb.HJc()}}Object(r.a)(jH,"OpenInClientOperation",oC,[]);class hL extends jH{constructor(){super("Word_32x32x32","EditInWordWebApp_32x32x32",!0);this.fmn=b=>{w.ULS.sendTraceTag(50857160,211,50,"Saving finished. Release lock before open in client");ob.App.A_.forceOutbound(this.$zi,
this.Btm,b)};this.Btm=b=>{w.ULS.sendTraceTag(50857161,211,15,"Lock release failed.");const h=new yd.StandardDialog;h.Ed=0;h.fy(ri.a.ico,CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.l_UnlockFailed,b?this.ztm:this.Atm)};this.ztm=()=>{u.AFrameworkApplication.ya.Xb(Ra.a.close,2,dk.c)};this.Atm=()=>{ob.App.xa.refreshDocument(null)};this.$zi=b=>{u.AFrameworkApplication.bfc=!0;w.ULS.sendTraceTag(50857162,211,50,"Saving finished. Ready to OpenWordClient with forceClose: {0}.",b);
this.CIi(b)}}ngk(b){ob.App.Wj.rNa.eQ||ob.App.rd.QA.io?(w.ULS.sendTraceTag(50857159,211,15,"Saving skipped due to document loading failure"),this.$zi(b)):aw.a.HP(4,!0,this.fmn,null,b)}Odh(b){this.ngk(b);return 32}bEh(){ob.App.xa.refreshDocument(null)}}Object(r.a)(hL,"OpenInWordOperation",jH,[]);const iL=(b,h)=>{w.ULS.sendTraceTag(41186076,306,50,"Toggling readonly recommended setting for the document.");b[Qf.a.On]=Nd.PageReader.instance.Eu(h);Nd.PageReader.instance.Eu(h)?b[Qf.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOn:
b[Qf.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOff},JP=(b,h,n,x,E)=>{if(!ob.App.xa||!ob.App.xa.jb||!u.AFrameworkApplication.Ep.Kcb)return 8;h=ob.App.xa.jb.Zc;if(!h)return 8;if(b===Db.a.G_d&&2===n){b=new Se.GraphTransaction(15);try{b.Db(h),Nd.PageReader.instance.r7n(h)}finally{b&&b.dispose()}iL(E,h)}return 32},KP=(b,h,n,x,E)=>{if(!ob.App.xa||!ob.App.xa.jb)return 8;b=ob.App.xa.jb.Zc;if(!b)return 8;E[Qf.a.Alt]=u.AFrameworkApplication.Ep.Kcb?"":CommonUIStrings.l_ProtectDocumentToolTip;
iL(E,b);return 32};class jL extends $K.a{constructor(b,h){super(b,h);this.mKg=!1;this.bxi=(n,x,E,S,ma)=>{if(x.contextId!==Ld.a.frame)return 2;if(!(ob.App.rAc||u.AFrameworkApplication.ut.Gma||u.AFrameworkApplication.Wgc||this.mKg))return w.ULS.sendTraceTag(50857163,211,15,"OIC entry is hidden"),this.mKg=!0,8;if(1===E)return Vh.SessionStatusManager.instance.Qj?8:32;x=!1;void 0!==ma&&null!==ma&&(x=ma);w.ULS.sendTraceTag(50857164,211,50,"OpenInClient begin. Expect saving starting soon.");return(new hL).begin(ob.App.rAc,
u.AFrameworkApplication.byb,LF.Word,n===Ra.a.PHf?rE.OpenInBrowser:rE.WriteOnly,x,new se.a(()=>this.EW))};this.yWk=n=>{this.Num();if(!u.AFrameworkApplication.SOc&&u.AFrameworkApplication.ua.Sb.IYf(Ra.a.downloadACopy.toString()))this.eva(!0,F.a.download,!0,{});else if(u.AFrameworkApplication.K.$("WordEditorDownloadACopyUiIsEnabled")){let x=u.AFrameworkApplication.byb;n&&n.FileDownloadUrl&&(x=n.FileDownloadUrl.toString());new aL(x)}else super.downloadACopy(0,null,2,null,null)};this.Zok=n=>{super.workflow(0,
null,2,null,n)};this.bS=Oa.a.instance.Za("Common.ISystemInitiatedFeedback")}Vb(){super.Vb();this.ga.pa(Db.a.openInClient,Ld.a.frame,this.bxi);u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OICExtendedTelemetryIsEnabled",!1)&&this.ga.Vc(Db.a.openInClient,12288);var b=this.ga;b.gb(Db.a.G_d,cc.a.application,JP,4);b.gb(Db.a.HNf,cc.a.application,KP,96);this.ga.pa(Ra.a.PHf,Ld.a.frame,this.bxi)}Ird(b){return nf.a.instance.Wya()?!0:ob.App.xa.JSi(1,
Qe.AppFrame.Kwk,b)}downloadACopy(b,h,n,x,E){if(2===n){if(!u.AFrameworkApplication.byb&&!u.AFrameworkApplication.ua.Sb.IYf(Ra.a.downloadACopy.toString()))return 8;aw.a.HP(2,!0,this.yWk,null,E);return 32}return super.downloadACopy(b,h,n,x,E)}Num(){u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.bS&&this.bS.execute(b=>b.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}workflow(b,
h,n,x,E){return 2===n?(aw.a.HP(13,!0,this.Zok,null,E),32):super.workflow(b,h,n,x,E)}}Object(r.a)(jL,"AppFrameCommandUIActor",$K.a,[]);class kL extends yd.StandardDialog{constructor(){super();this.Ed=0;this.ahb(CommonUIStrings.l_WheresTheSaveButtonDialogTitle,CommonUIStrings.l_WheresTheSaveButtonDialogMessage,"WheresTheSaveButtonDialogItem_32x32x32",CommonUIStrings.l_WheresTheSaveButtonDialogTitle,null,null)}}Object(r.a)(kL,"WheresTheSaveButtonDialog",yd.StandardDialog,[]);const LP=(b,h,n)=>{if(1===
n)return 32;new kL;return 32};var kH=d(557),QF=d(1344);class Tr extends zo.a{constructor(b,h,n,x,E,S){var ma,Fa,$a;super();this.Bvj=50;this.Cvj=56;this.rUg="px";this.quj="aria-label";this.AFa="BookmarkIndicator";this.fGg="HighlightBookmarkedContent";this.LEj="HighlightBookmark";this.NRa="wwaengidc";this.yhk="Bookmark_24";this.fb=b;this.gg=n;this.Kj=h;this.E4=x;this.oC=E;this.JZg=null===(ma=u.AFrameworkApplication.K)||void 0===ma?void 0:ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.QueryBookmarkIndicatorOnSplit",
!1);this.Gvj=null===(Fa=u.AFrameworkApplication.K)||void 0===Fa?void 0:Fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1);this.xvj=null===($a=u.AFrameworkApplication.K)||void 0===$a?void 0:$a.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkHighlightIsEnabled",!1);this.oC&&this.oC.MNe(this.fD.bind(this));this.yH=S}iQn(b){if(b.Tj){for(let h of b.Ag.Hi)if(this.JYf(h))return!0;return!1}return this.JYf(b.htmlElement)}AJb(b){let h=!1;u.AFrameworkApplication.Hf("bookmarks-core-ex;bookmarks-core-ex-cf");
this.Gvj&&(u.AFrameworkApplication.Hf("BookmarkIndicatorOnSplit;BookmarkIndicatorOnSplitcf"),this.JZg?oo.a.instance.Pd(()=>{h=this.iQn(b)},"BIA:SCIVE"):oo.a.instance.Pd(()=>{h=this.JYf(b.htmlElement)},"BIA:SCI"));return h}JYf(b){return Tr.$Fe?(b=b.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .BookmarkStart"))&&0<b.length?!0:!1:!1}Swb(b){const h=[];oo.a.instance.Pd(()=>{const n=b.Pvb(0,this.yH?this.Cvj:this.Bvj,this.zoom);h.push(this.iWa(b.S6,n,b.I3c[0].y-b.w$[0].y))},"BIA:CIs");
return h}iWa(b,h,n){const x=b.Ig.ownerDocument,E=$m.a.createElement(x,Pk.a.div);E.className=this.yH?Tr.Fvj:Tr.the;Tr.the;E.style.left=h+this.rUg;E.style.top=n+this.rUg;this.yH?(h=$m.a.createElement(x,Pk.a.div),Mg.a("renderIcon")&&appChrome.api.renderIcon(this.yhk,h),h.setAttribute("role","img"),h.setAttribute("alt","Bookmark")):(h=$m.a.createElement(x,Pk.a.SYa),h.src=Gl.a.Sh(Tr.v6c),h.alt="Bookmark");h.title="Bookmark";h.setAttribute(this.quj,"Bookmark");E.appendChild(h);b={context:new IF([],E,new Set,
new Set,null,null),TLm:b,container:E};this.yH||(this.Kj.mb(kb.a.sQ,h,this.onMouseEnter),this.Kj.mb(kb.a.iK,h,this.Ama));this.gg.jE(kb.a.click,E,this.k0a.bind(this),b);return E}slh(){const b=Object.assign(new tn.a,{action:1,type:5,vF:null,eO:this.j5a});this.j5a=null;this.E4.$G(b)}fD(b,h){this.j5a&&(h.Ubb.Af.classList.contains("BookmarkHighlightSelected")||this.slh())}onMouseEnter(b){if(null==b)return!1;b=b.Af;b.parentElement.classList.add(Tr.Aug);b.src=Gl.a.Sh(Tr.zvj);return!0}Ama(b){if(null==b)return!1;
b=b.Af;b.parentElement.classList.remove(Tr.Aug);b.src=Gl.a.Sh(Tr.v6c);return!0}k0a(b){this.n1a(this.fGg,this.LEj);if(null==b){var h=new Map;h.set("Source",this.AFa);h=Object.assign(new ab.a,{additionalValues:h});ta.Health.instance.recordKpiFailure(this.fGg,"Unable to highlight bookmarked content",!1,!0,h);return!1}u.AFrameworkApplication.Hf("bookmarks-highlight-ex;bookmarks-highlight-ex-cf");if(this.xvj){h=b.vp.context;if(Tr.cDb(h,this.j5a))return!0;h=this.vsl(b.vp.TLm,h,b.vp.container);b=Object.assign(new tn.a,
{action:0,type:5,vF:h,eO:this.j5a});this.j5a=h;this.E4.$G(b);return!0}return!1}vsl(b,h,n){h={Aeh:new Set,EIf:new Set,Deh:null,bSe:null};const x=this.fb.Mw(b.zb,!0,!1);let E=[];if(x)for(let S of x)E.push(S);this.r2j(b,h,E);h=new IF(E,n,h.Aeh,h.EIf,h.Deh,h.bSe);this.j5a&&this.j5a.qX===E&&(n.className+=String.format(" {0}",Tr.Avj),this.j5a=h);return h}r2j(b,h,n){u.AFrameworkApplication.Hf("BookmarkIndicatorOnSplit;BookmarkIndicatorOnSplitcf");if(this.JZg&&b.Tj){var x=new Set;for(let S of b.Ag.Hi)S.querySelectorAll("*").forEach(x.add,
x);b=Array.from(x.values())}else b=Array.prototype.slice.call(b.htmlElement.querySelectorAll("*"),0);let E=[];h.EIf.add(n[0].id);h.Deh=n[0].id;h.bSe=n[0].id;b.forEach(S=>{let ma=hi.a.Eb(S,Eh.a.Srd);if(ma)for(let Fa of ma)E.push(Fa),h.Aeh.add(Fa);if(!E.length)return!0;S=hi.a.Eb(S,Eh.a.zvb);if(!S)return!0;E=QF.a.l2d(E,S)});for(x=b=this.fb.Vg(n[n.length-1],!1,!0);E.length&&b;){h.EIf.add(b.id);h.bSe=b.id;n.push(b);for(let S of x.pD)S.htmlElement.querySelectorAll("."+Eh.a.aSe).forEach(ma=>{(ma=hi.a.Eb(ma,
Eh.a.zvb))&&(E=QF.a.l2d(E,ma))});x=b=this.fb.Vg(b,!1,!0)}}n1a(b,h){const n=new Map;n.set("Source",this.AFa);n.set("Action",h);ta.Health.instance.recordKpiUsage(b,0,this.NRa,n)}static cDb(b,h){return!!h&&!!b&&b.xeh===h.xeh}}Tr.Aug="WordBookmarkIndicatorContainerHovered";Tr.Avj="WordBookmarkIndicatorContainerSelected";Tr.v6c="BookmarkDefault.png";Tr.zvj="BookmarkHover.png";Tr.$Fe=!0;Tr.the="WordBookmarkIndicatorContainer";Tr.Fvj="WordBookmarkSvgIndicatorContainer";Object(r.a)(Tr,"BookmarkIndicatorActor",
zo.a,[614]);class lL{constructor(b,h,n,x,E,S,ma,Fa,$a,sb=null,Jb=null,Sb=null,oc=null,Ic=null,gd=null,Gd=null){this.D0="_";this.Wge="Bookmark";this.$uj=/^BOOKMARK\d+$/i;this.AFa="BookmarkRibbonOptions";this.vvj="BookmarkFloatieOptions";this.lyg="CreateBookmarkOnRange";this.myg="CreateBookmarkOnView";this.kyg="CreateBookmarkOnIP";this.rke="CreateBookmark";this.NRa="wwaengidc";this.a_g="ShowHideBookmarksOnDocument";this.yzg="DeleteBookmark";this.rzj="DeleteBookmarkAction";this.MTj="ShowHideBookmarks";
this.$Zg="ShowBookmarksFloatie";this.JTj="ShowBookmarksFloatieAction";this.YAg="EditBookmark";this.oAj="EditBookmarkAction";this.Xyc="BookmarksUsage";this.Chk="InsertTabSwitchActivity";this.H4l="Insert";this.RMb=b;this.ga=h;this.hb=n;this.ml=x;this.px=E;this.G4=S;this.Hc=ma;this.Wv=Fa;this.Mt=Jb;this.zug=$a;this.Ge=sb;this.n4=Ic;this.un=Sb;this.Yc=oc;this.UA=gd;this.Ok=Gd}get Py(){return this.px.value}Vb(){this.Rnf()&&(this.ga.pa(ub.a.LJa,cc.a.view,this.LJa.bind(this)),this.ga.gb(Ra.a.FPa,cc.a.application,
this.D9n.bind(this),96),this.ga.pa(ub.a.LJa,cc.a.Fd,this.bGk.bind(this)),this.ga.pa(ub.a.LJa,cc.a.Wc,this.aGk.bind(this)),this.ga.pa(ub.a.deleteBookmark,cc.a.view,this.deleteBookmark.bind(this)),this.ga.pa(ub.a.q4e,cc.a.view,this.NYk.bind(this)),this.ga.gb(ub.a.u2i,cc.a.view,this.kVn.bind(this),1028),this.ga.gb(ub.a.M_d,cc.a.application,this.M_d.bind(this),96),this.ga.gb(ub.a.c7d,cc.a.Wc,this.c7d.bind(this),1028),this.ga.gb(Db.a.KQd,cc.a.view,this.KQd.bind(this),1028),this.ga.gb(ub.a.iKd,cc.a.view,
this.iKd.bind(this),1028),this.ga.Vc(ub.a.LJa,1028))}D9n(b,h,n,x,E){return E&&E.NewContextId===this.H4l?(this.r8b(this.Chk),32):2}LJa(b,h,n,x,E){var S,ma;b=this.hb.Rg;if(!b||b.contextId===cc.a.anchoredObject)return 2;if(1===n)return Ee.a.Jla(h)||vs.a.wvd&&(null===(S=this.Ok)||void 0===S?0:S.bZ(b))||(null===(ma=this.Ok)||void 0===ma?0:ma.ota(b))?8:32;h=this.hb.ib.kb;if(!h||this.Ge.Km(h))return 2;this.yQc(E,"User is trying to create bookmark from UILocation : {0}");this.n1a(this.myg,this.rke);if(h&&
this.ml.ppd(this.JKa(),h))return this.r8b(this.Xyc),32;E=new Map;E.set("Source",this.AFa);E=Object.assign(new ab.a,{additionalValues:E});ta.Health.instance.recordKpiFailure(this.myg,"Unable to create bookmark",!1,!0,E);return 8}bGk(b,h,n,x,E){if(1===n)return 32;if(cc.a.Fd!==h.contextId)return 8;this.yQc(E,"User is trying to create bookmark from UILocation : {0}");b=this.hb.ib.kb;if(!b)return 2;this.n1a(this.lyg,this.rke);if(this.ml.ppd(this.JKa(),b))return this.r8b(this.Xyc),32;b=new Map;b.set("Source",
this.AFa);b=Object.assign(new ab.a,{additionalValues:b});ta.Health.instance.recordKpiFailure(this.lyg,"Unable to create bookmark for range",!1,!0,b);return 8}aGk(b,h,n,x,E){if(1===n)return 32;if(cc.a.Wc!==h.contextId)return 8;this.yQc(E,"User is trying to create bookmark from UILocation : {0}");b=this.hb.ib.kb;if(!b)return 2;this.Ge.Km(b)&&(h=b.Qa,this.Ge.Yfb(h)?(b=this.Ge.Q1(h,!1),b||(w.ULS.sendTraceTag(542921105,3029,50,"User is trying to create bookmark at EOP"),b=this.Ge.Q1(h,!0))):w.ULS.sendTraceTag(542921106,
3029,50,"Selection is not expandable to word. Bookmark will be added on IP"));this.n1a(this.kyg,this.rke);if(this.ml.ppd(this.JKa(),b))return this.r8b(this.Xyc),32;b=new Map;b.set("Source",this.AFa);b=Object.assign(new ab.a,{additionalValues:b});ta.Health.instance.recordKpiFailure(this.kyg,"Unable to create bookmark for IP",!1,!0,b);return 8}M_d(b,h,n,x,E){1===n&&32;E[Qf.a.On]=Tr.$Fe;return 32}kVn(b,h,n,x,E){if(1===n)return 32;this.n1a(this.a_g,this.MTj);(b=E[Qf.a.On])||w.ULS.sendTraceTag(556889756,
3029,50,"User hides bookmarks annotations on document");Tr.$Fe=b;b=ql.PageNavigator.instance.hT(this.Py);if(null!==b)return this.cWc(b),this.RMb.ZF({ShowBookmarks:"CheckboxModel"}),32;b=new Map;b.set("Source",this.AFa);b=Object.assign(new ab.a,{additionalValues:b});ta.Health.instance.recordKpiFailure(this.a_g,"Unable to show/hide bookmark on document",!1,!0,b);return 8}deleteBookmark(b,h,n,x,E){if(this.Rnf()){b=this.hb.ib.kb;if(!b)return 2;b=b.Qa;b=this.ml.jHc(b.node,b.cpBegin);if(1===n)return b?
32:8;this.yQc(E,"User is trying to delete bookmark from UILocation : {0}");this.Wv.EZ&&(w.ULS.sendTraceTag(545118155,3029,50,"Dismissing the bookmarks floatie"),this.Wv.Vu());this.n1a(this.yzg,this.rzj);b||w.ULS.sendTraceTag(545118156,3029,50,"Delete bookmark called for a context where there were no bookmarks.");if(b&&this.ml.qQf(b.id))return this.zug&&this.zug.slh(),this.r8b(this.Xyc),32;n=new Map;n.set("Source",this.AFa);n=Object.assign(new ab.a,{additionalValues:n});ta.Health.instance.recordKpiFailure(this.yzg,
"Unable to delete bookmark",!1,!0,n);return 8}return 2}NYk(b,h,n,x,E){u.AFrameworkApplication.Hf("bookmarks-edit-ex;bookmarks-edit-ex-cf");if(u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkEditNameIsEnabled",!1)){b=this.hb.ib.kb;if(!b)return 2;b=b.Qa;b=this.ml.jHc(b.node,b.cpBegin);if(1===n)return b?32:8;this.yQc(E,"User is trying to edit bookmark from UILocation : {0}");this.Wv.EZ&&(w.ULS.sendTraceTag(539762822,3029,50,"Dismissing the bookmarks floatie"),
this.Wv.Vu());this.n1a(this.YAg,this.oAj);b||w.ULS.sendTraceTag(539762823,3029,50,"Edit bookmark called for a context where there were no bookmarks.");if(b)return this.n4.value.OYk(h,b,this.ml),this.r8b(this.Xyc),32;h=new Map;h.set("Source",this.AFa);h=Object.assign(new ab.a,{additionalValues:h});ta.Health.instance.recordKpiFailure(this.YAg,"Unable to edit bookmark",!1,!0,h);return 8}return 2}yQc(b,h){b&&b.UILocation&&w.ULS.sendTraceTag(540386525,3029,50,h,b.UILocation)}c7d(b,h,n,x,E){u.AFrameworkApplication.Hf("bookmarks-floatie-ex;bookmarks-floatie-ex-cf");
if(u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksFloatie",!1)){1===n&&32;this.n1a(this.$Zg,this.JTj);if(h.contextId===cc.a.Wc)return b=Array(1),b.push("Bookmarks"),this.Wv.showFloatie(E.location,b,1),32;E=new Map;E.set("Source",this.vvj);E=Object.assign(new ab.a,{additionalValues:E});ta.Health.instance.recordKpiFailure(this.$Zg,"Unable to show bookmark floatie",!1,!0,E);return 8}return 2}KQd(b,h,n,x,E){let S;return 1===n?(oo.a.instance.Pd(()=>
{S=this.ga.Qf(h,Db.a.insertHyperlink,n,!0,x,E);32!==S&&(S=this.ga.Qf(h,ub.a.LJa,n,!0,x,E))},"BA:LFE"),S):8}iKd(b,h,n){var x;if(1===n)return 32;if(b=this.hb.ib.kb){b=b.Qa.node;if(h=this.zEh(b))return h.click(),32;w.ULS.sendTraceTag(539523265,3029,50,"No indicator found in current paragraph.");if(b=this.ml.jHc(b,0)){b=this.UA.vja.get(null===(x=b.id)||void 0===x?void 0:x.toString());x=ql.PageNavigator.instance.hT(this.Py).Nc.Eb(b);if(x=this.zEh(x))return x.click(),32;w.ULS.sendTraceTag(539523266,3029,
50,"No indicator found for the paragraph in previous paragraphs.")}else w.ULS.sendTraceTag(539523267,3029,50,"No bookmark found enclosing the content.")}return 2}zEh(b){let h;b=this.un.Uk(b).Ui(this.Yc.xd.Tb);b.X5b&&(b=b.htmlElement.querySelectorAll("div."+Tr.the),0<b.length&&(h=b[0]));return h}cWc(b){const h=kH.b(b);if(h){var n=this.Hc.Rc(2);try{for(n.Db(b);h.moveNext();){if(!Cd.ParagraphReader.wh(h.iterator))continue;const x=h.currentNode;this.UXk(x)&&this.G4.X4b(x,!0)}}finally{n&&n.dispose()}}}UXk(b){for(let n=
0;n<b.qa.length;n++){const x=b.qa.J(n);if(null!=x.Lh)for(let E=0;E<x.Lh.length;E++){var h=x.Lh.J(E);if(null!=h&&(h=b.Nc.Eb(h.kn).ia(ic.a.Rs,""),!B.a.nf(h)&&!h.startsWith(this.D0)))return!0}}}JKa(){var b=this.ml.qGc(!1);let h=[];for(let n=0;n<b.count;n++){let x=b.J(n).ia(ic.a.Rs,"");this.$uj.test(x)&&h.push(x)}return 0<h.length?(h.sort((n,x)=>n.localeCompare(x,void 0,{numeric:!0})),b=parseInt(h[h.length-1].substring(this.Wge.length)),this.Wge+(b+1)):this.Wge+1}n1a(b,h){const n=new Map;n.set("Source",
this.AFa);n.set("Action",h);ta.Health.instance.recordKpiUsage(b,0,this.NRa,n)}r8b(b){this.Rnf()&&this.Mt&&this.Mt.execute(h=>{h.logActivity(b,null)})}Rnf(){u.AFrameworkApplication.Hf("bookmarks-core-ex;bookmarks-core-ex-cf");return u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)}}Object(r.a)(lL,"BookmarkActor",null,[]);class mL{constructor(b,h,n){this.Ac=b;this.DTk=h;this.Sg=n;this.wWe=this.wWe.bind(this)}Vb(){this.Ac.pa(ub.a.ruf,
cc.a.view,this.wWe);this.Ac.gb(ub.a.O_d,cc.a.view,ah.a.JQ,96);this.Ac.gb(ub.a.Q_d,cc.a.view,ah.a.JQ,96);this.Ac.gb(ub.a.P_d,cc.a.view,ah.a.JQ,96);this.Ac.pa(ub.a.IXd,cc.a.view,ah.a.tF);this.Ac.pa(ub.a.KXd,cc.a.view,ah.a.tF);this.Ac.pa(ub.a.JXd,cc.a.view,ah.a.tF)}wWe(b,h,n,x,E){return 1===n?32:(b=this.Sg.m$(h.tk))?(E=3===E.Qw,this.DTk.value.Brh(this.oDl(b),this.LMl(b),E),32):2}oDl(b){const h=new qi.DictionaryPropertySet;h.setValue(wi.a.yC,this.Sg.kh(b));h.setValue(wi.a.Fx,this.Sg.hea(b));h.setValue(wi.a.ZV,
this.Sg.rzb(b));return h}LMl(b){const h=new qi.DictionaryPropertySet;h.setValue(ic.a.marginLeft,this.Sg.vL(b));h.setValue(ic.a.marginRight,this.Sg.wL(b));h.setValue(ic.a.Ko,this.Sg.Gv(b));return h}}Object(r.a)(mL,"ColumnsDialogActor",null,[]);class nL{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb){this.Zo=b;this.opa=h;this.og=n;this.hs=x;this.Qm=E;this.Vd=S;this.Hc=ma;this.Ie=Fa;this.ga=$a;this.eHj=sb;this.zue=Jb}get b$l(){return this.eHj}Vb(){this.ga.gb(Db.a.LZf,cc.a.view,this.n3l.bind(this),96);this.ga.gb(Db.a.NWc,
cc.a.view,this.NWc.bind(this),4)}n3l(b,h,n,x,E){b=this.Zo.getById(E);if(!b)return 8;h=b.contentControlNode;if(!h)return 8;if(h.ia(ic.a.E5,!1))return 2;n=this.Zo.Zkl(b);if(!n)return 8;x=this.Hc.Rc(7);x.Db(n.node);if(!this.b$l)return(E=b.uZd)||(E=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),this.Vd.replaceTextRange(n,E),this.frd(b),h.setValue(ic.a.E5,!0),x.dispose(),32;E=new qi.DictionaryPropertySet;E.setValue(ad.a.i0h,n);var S=h.ia(ic.a.TXe,"");S=this.opa.t_h(S);if(!S)return this.hs.replaceTextRange(n,
WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),this.frd(b),h.setValue(ic.a.E5,!0),x.dispose(),32;E.setValue(ad.a.Yhf,S);if(1<S.length&&!b.Vf)return x.dispose(),8;this.yEk(E);h.setValue(ic.a.E5,!0);x.dispose();return 32}NWc(b,h,n){var x=h.view.Be?h.view:null;if(!x||!x.Cb)return 8;h=x.Cb.ib.J(0);b=this.Qm.xsa(h.Qa,h.Tc,1);if(0==b.count)return 8;var E=this.Qm.xsa(h.Qa,h.Tc,3);h=new Aa.a;if(0<E.count){for(var S of E)h.add(S.id,S);for(S=b.count-1;0<=S;S--)h.xb(b.J(S).id)&&b.removeAt(S);
0==b.count&&(S=E.J(0),b.add(S))}for(S=0;S<b.count;S++)E=b.J(S),h.add(E.id,E);if(1===n){for(n=b.count-1;0<=n;n--)if(x=b.J(n),S=h.J(x.parentId),this.F$h(x,S))return 32;return 8}if(2===n){n=this.Hc.Rc(15);n.Db(x.ud);for(x=b.count-1;0<=x;x--)S=b.J(x),E=h.J(S.parentId),this.F$h(S,E)&&this.Zo.JHb(S.id);n.dispose();return 32}return 2}frd(b){const h=this.hs.XFd(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);h?this.zue&&(b=this.Ie.Nx(b.start.node).uh("Placeholder Text"))&&(this.og.Fja(h.formatting),this.og.gkb(h.formatting,
b)):w.ULS.sendTraceTag(20492441,368,15,"Unable to get a ChP at starting Ip of Content Control")}yEk(b){this.ga.Xb(Db.a.showPlaceholderGlossary,2,b)}F$h(b,h){return b.Pea&&b.ghm&&(!h||h.isEditable)}}Object(r.a)(nL,"ContentControlActor",null,[]);class tE{constructor(b){this.ga=b;this.primaryButtonText="Count me in";this.secondaryButtonText="Cancel";this.l8j=["We are gauging interest in a feature that would let you","customize your ribbon in Word on the web. Click below","to vote or comment on this idea, as well as follow it",
"status updates. Thank you."];this.I6n="Interested in this feature?"}Vb(){this.ga.pa(ub.a.B0e,cc.a.view,this.r6l.bind(this))}r6l(b,h,n){2===n&&(Object(Pe.c)(ub.a.B0e),b=new yd.StandardDialog,b.Ed=4,b.We(1,this.primaryButtonText),b.We(2,this.secondaryButtonText),b.sxc(this.l8j,null),b.Lv(this.I6n,null,0,this.K9));return 32}K9(b){1===b&&(Object(Pe.a)("CountMeIn_CustomizeRibbon",!0),B.a.RW(tE.Ehj)&&rd.a.ym(tE.Ehj))}}tE.Ehj="https://feedbackportal.microsoft.com/feedback/idea/974fe330-6613-ed11-b83e-000d3a4d92e4";
Object(r.a)(tE,"CustomizeRibbonActor",null,[]);var CB=d(1029);class lH extends Kc.a{constructor(b,h,n){super(!1,!1,!0);this.kNg=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,CB.a.QOe,CB.a.POe,CB.a.ROe];this.Tsg=[Box4Intl.Box4Strings.l_CustomTabDialogAlignLeft,Box4Intl.Box4Strings.l_CustomTabDialogAlignCenter,Box4Intl.Box4Strings.l_CustomTabDialogAlignRight];this.bec=()=>{new lH(this.ga,this.SHe,this.nlc)};this.Jtl=()=>{const x=[];for(let E of this.SHe)x.push(this.z3(E));return x};this.Jjo=x=>
{const E=new Set;this.cpa="";for(let S of x)if(""!==S.position){const ma=this.GTh(S.position);if(0>ma||22<ma){this.cpa=Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds;break}if(E.has(ma)){this.cpa=Box4Intl.Box4Strings.l_CustomTabDialogMultipleTabStopsSamePosition;break}else this._tabStops.push(this.Y6n(S)),E.add(ma)}else{this.cpa=Box4Intl.Box4Strings.l_CustomTabDialogEmptyPosition;break}""!==this.cpa&&(this._tabStops=[],this.SHe=x)};this.XNk=(x,E)=>{try{if(1===x){if(""!==this.cpa)throw Error.create(this.cpa);
E.DefaultTabStop&&(this.nlc=CB.a.WTf(E.DefaultTabStop),this.$mo(this.nlc));if(32!==this.ga.Xb(ub.a.wLb,2,{["tabStops"]:this._tabStops,["defaultTabStopLength"]:Jf.a.wF(this.nlc)}))throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogSaveError);}}catch(S){this.jva(S.message,this.bec)}};this.ga=b;this.SHe=h;this._tabStops=[];this.nlc=n;this.cpa="";b={["id"]:"CustomTabDialog",["bodyControls"]:this.DGc()};this.Zh(Box4Intl.Box4Strings.l_CustomTabDialogTitle,this.XNk,b)}z3(b){return{["position"]:b.position,
["alignment"]:b.alignment,["leader"]:b.leader}}GTh(b){return Math.floor(100*parseFloat(b))/100}Y6n(b){return new Rw.a(Jf.a.wF(this.GTh(b.position)),CB.a.YIl(b.alignment),CB.a.WIl(b.leader),1)}$mo(b){if(0>b||22<b)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds);var h={};if(32===this.ga.Xb(Db.a.jDa,2,h)){var n=h.marginLeft;const x=mf.a.Ni(h.marginRight,0);n=mf.a.Ni(n,0);h=mf.a.Ni(h.Ko,0);if(mf.a.t$(b,0,!1)>=h-x-n)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopMarginIndentCheck);
}}DGc(){return{["getInitState"]:this.Jtl,["updateState"]:this.Jjo,["validPositions"]:this.QXh(-Infinity,Infinity,"Position"),["validAlignments"]:this.BMh(this.Tsg,this.Tsg,"Alignment"),["validLeaders"]:this.BMh(this.kNg,this.kNg,"Leader"),["defaultTabStopSpinButtonProps"]:this.QXh(.01,22,"DefaultTabStops"),["defaultTabStopLength"]:this.nlc,["DefaultTabStop"]:"DefaultTabStop",["addButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogAddButton,["clearAllButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogClearAllButton,
["positionHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogPosition,["alignmentHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogAlignment,["leaderHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogLeader,["defaultTabStopText"]:Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStops,["addNewTabStopHeader"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopHeader,["addNewTabStopDescription"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopDescription,["deleteButtonTooltip"]:Box4Intl.Box4Strings.l_CustomTabDialogDeleteButtonTooltip}}QXh(b,
h,n){return{["type"]:"AppSpinButtonProps",["id"]:"CustomTabDialogSpinButtonPosition",["label"]:n,["unitType"]:"Inch",["validUnits"]:[Dz("Inch",3,b,h,.1)],["numberFormatInfo"]:TG()}}BMh(b,h,n){return{["type"]:"AppComboBoxProps",["id"]:"CustomTabDialogComboBox",["label"]:n,["options"]:xF(b,h)}}}Object(r.a)(lH,"CustomTabDialog",Kc.a,[]);class oL{constructor(b,h,n){this.b9b=(x,E,S,ma,Fa)=>{if(2!==S)return 8;if(!Fa)return 16;x=Fa.tabStop;Fa=Fa.value;if(!x)return 16;Pe.c(ub.a.b9b);Fa=new Rw.a(Fa,x.gba,
x.gma,x.s2f);E=E.node;this.Hwa.u1a(E,x);this.Hwa.uLd(E,Fa);return 32};this.jZc=(x,E,S,ma,Fa)=>{if(2===S){if(!Fa)return 16;this.Hwa.uLd(E.node,Fa);return 32}return 8};this.bHb=(x,E,S,ma,Fa)=>{x=this.Hwa.wIi(E.node);if(!("customTabs"in Fa))return Fa.customTabs=x,32;E=Fa.customTabs;if(!E||0>=E.length||!x||0>=x.length)return Fa.customTabs=null,32;S=[];for(let $a of E)for(let sb of x)if(sb.kEa===$a.kEa&&sb.s2f===$a.s2f&&sb.gba===$a.gba){S.push($a);break}Fa.customTabs=S;return 32};this.u1a=(x,E,S,ma,Fa)=>
{if(2===S){if(!Fa)return 16;Pe.c(ub.a.u1a);this.Hwa.u1a(E.node,Fa);return 32}return 8};this.KHb=(x,E)=>{this.Hwa.KHb(E.node);return 32};this.wLb=(x,E,S,ma,Fa)=>{if(2===S){if(!Fa)return 16;x=Fa.tabStops;S=Fa.defaultTabStopLength;E=E.node;ma=!1;let $a=this.Hwa.Srn(E,x);Fa.defaultTabStopLengthSaved||(ma=this.uJ.KGn(E,S),Fa.defaultTabStopLengthSaved=!0);$a&&Pe.d(ub.a.wLb,!0,void 0,void 0,void 0,void 0,[Object.assign(new ca.a,{name:"Custom Tab Stops Count",string:x.length.toString()})]);if(null==ma)return w.ULS.sendTraceTag(571479714,
3015,15,"Could not set Default Tab Stop Length."),16;ma&&(this.oXc&&this.oXc.O8h(),this.Rd.us(11,Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopTrackingAlert),Pe.d(ub.a.wLb,!0,void 0,void 0,void 0,void 0,[Object.assign(new ca.a,{name:"Default Tab Stop Length",string:S.toString()})]));return 32}return 8};this.H2i=(x,E,S)=>{if(2!==S)return 8;x={};if(32!==this.ga.Xb(ub.a.rL,2,x))return w.ULS.sendTraceTag(572072071,3015,15,"Could not read Default Tab Stop Length."),16;E={};if(32!==this.ga.Xb(Db.a.jDa,
2,E))return w.ULS.sendTraceTag(572072072,3015,15,"Could not read Section Properties."),16;x=CB.a.WTf(Jf.a.cC(x.defaultTabStop));S={};S.defaultTabStopLength=x;S.sectionPropertiesData=E;if(32!==this.ga.Xb(ub.a.J8f,2,S))return w.ULS.sendTraceTag(572072073,3015,15,"Could not validate Paragraphs against indents and default tab stop."),16;if(!S.isParagraphValid)return w.ULS.sendTraceTag(572072074,3015,15,"Could not open Custom Tab Stop Dialog since all selected paragraphs failed validation."),this.Hwa.jva(Box4Intl.Box4Strings.l_CustomTabDialogIndentError),
8;E={};if(32!==this.ga.Xb(ub.a.bHb,2,E))return w.ULS.sendTraceTag(572072075,3015,15,"Could not read Custom Tab Stops."),16;(E=E.customTabs)||(E=[]);E=CB.a.XIl(E);new lH(this.ga,E,x);Pe.c(ub.a.bec,!0);return 32};this.Pfm=(x,E,S,ma,Fa)=>{if(2!==S)return 8;if(!Fa)return 16;if(Fa.isParagraphValid)return 32;S={};if(32!==this.ga.Qf(E,Db.a.g1a,2,!1,null,S))return 16;x=Fa.sectionPropertiesData;E=Fa.defaultTabStopLength;var $a=S.Ts;ma=$a.wla;$a=1===$a.specialIndentType?$a.tA:$a.tA-$a.bba;const sb=x.marginLeft,
Jb=x.marginRight;S.isRtl?(S=mf.a.Ni(Math.max(Jb,Jb+ma),0),ma=mf.a.Ni(Math.max(sb,sb+$a),0)):(S=mf.a.Ni(Math.max(sb,sb+$a),0),ma=mf.a.Ni(Math.max(Jb,Jb+ma),0));x=mf.a.Ni(x.Ko,0);E=mf.a.t$(E,0,!1);Fa.isParagraphValid=E<x-S-ma;return 32};this.ga=b;this.Hwa=h;this.uJ=n}get Rd(){return null!=this.sqg?this.sqg:this.sqg=Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get oXc(){return null!=this.nog?this.nog:this.nog=Oa.a.instance.Pa("WordEditor.Actors.RenderParagraphsContainingTabs")}Vb(){const b=
ob.App.h3a.pwd(h=>T.OutlineElementGeneralizer.Hka(h.ib,!0),!0);this.ga.pa(ub.a.bHb,cc.a.view,b);this.ga.gb(ub.a.bHb,cc.a.paragraph,this.bHb,96);this.ga.pa(ub.a.u1a,cc.a.view,b);this.ga.gb(ub.a.u1a,cc.a.paragraph,this.u1a,96);this.ga.pa(ub.a.KHb,cc.a.view,b);this.ga.gb(ub.a.KHb,cc.a.paragraph,this.KHb,96);this.ga.pa(ub.a.jZc,cc.a.view,b);this.ga.gb(ub.a.jZc,cc.a.paragraph,this.jZc,96);this.ga.pa(ub.a.b9b,cc.a.view,b);this.ga.gb(ub.a.b9b,cc.a.paragraph,this.b9b,96);this.ga.pa(ub.a.wLb,cc.a.view,b);
this.ga.gb(ub.a.wLb,cc.a.paragraph,this.wLb,96);this.ga.pa(ub.a.J8f,cc.a.view,b);this.ga.gb(ub.a.J8f,cc.a.paragraph,this.Pfm,96);this.ga.pa(ub.a.bec,cc.a.view,this.H2i);this.ga.pa(ub.a.E7h,cc.a.view,this.H2i)}}Object(r.a)(oL,"CustomTabActor",null,[]);var MP=d(126),RF=d(627);class pL{constructor(b,h,n,x,E,S,ma,Fa,$a){this.ga=b;this.ood=n;this.EFa=(this.gUb=E)&&x;this.Do=S;this.sV=ma;this.Uyj=Fa;this.Dw=$a;this.nuj=h;this.gUb&&Mg.a("isSharedUXDarkModeOn")?(this.Do.yN=appChrome.api.isSharedUXDarkModeOn(),
this.Tli(!0)):this.Do.yN=!1;this.EFa?this.Aki(!0):this.Do.U2a=!1;u.AFrameworkApplication.rK(()=>{this.sSc()});this.EFa&&Mg.a("dispatch")&&appChrome.api.dispatch(this.Y7i([]))}Vb(){this.EFa&&(this.ga.pa(ub.a.n7n,cc.a.view,this.lOk.bind(this)),this.ga.pa(ub.a.i_c,cc.a.view,this.i_c.bind(this)),this.ga.gb(ub.a.EVc,cc.a.view,this.EVc.bind(this),96));this.gUb&&(this.ga.pa(ub.a.y6d,cc.a.view,this.y6d.bind(this)),this.ga.gb(ub.a.C0d,cc.a.view,this.C0d.bind(this),96))}g6l(b){if(!this.oRn(b))return!1;const h=
Zm.a.instance.Rc(2);try{h.Db(b.root);const n=md.GraphIterator.$a(b.root.graphNode),x=Oh.a.tq(n);for(;x.moveNext();){const E=Object(ja.a)(MP.a,x.currentNode);E&&E.oI(b.Tb,20,!0)}}finally{h&&h.dispose()}return!0}oRn(b){return b&&b.root&&b.Nr?b.Ji||b.Gpf||b.qbi||b.Cj:!1}Ntn(){let b=!1;this.ood.forEach(h=>{this.g6l(h)&&(b=!0)});return b}o7n(){w.ULS.sendTraceTag(570566656,3023,50,"Toggle Dark Mode for canvas fishbowl to {0} mode",this.Do.yN?"dark":"light");return this.Do.yN?RF.a.xxc(1):RF.a.FLi(1)}p4f(){const b=
this.Do.nda;w.ULS.sendTraceTag(571524678,3023,50,"Toggle canvas Dark Mode to {0} mode",b?"dark":"light");if(!this.Ntn()||(b?!RF.a.xxc(0):!RF.a.FLi(0)))return!1;this.Uyj.qcn(b);return!0}Y7i(b){b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",!this.Do.yN));b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackgroundStatusBar",this.sYh(!0)));try{WordRibbonStrings?b.push(appChrome.actions.setControlCustomTooltip("DarkModeSwitchBackgroundStatusBar",this.Do.U2a?
WordRibbonStrings.DarkModeSwitchBackgroundTooltipDark:WordRibbonStrings.DarkModeSwitchBackgroundTooltipLight)):w.ULS.sendTraceTag(527283228,3023,10,"Trying to access WordRibbonStrings when it's undefined")}catch(h){w.ULS.sendTraceTag(527282835,3023,10,h)}return b}lOk(){return this.p4f()?32:8}y6d(b,h,n){if(1===n)return 32;b=this.sV.fg("UserAction","sharedUXDarkModeToggle");if(Mg.a("toggleSharedUXDarkMode"))w.ULS.sendTraceTag(571524677,3023,50,"Requesting to toggle Dark Mode for the Shared UX."),appChrome.api.toggleSharedUXDarkMode(),
Mg.a("isSharedUXDarkModeOn")?this.Do.yN=appChrome.api.isSharedUXDarkModeOn():this.Do.yN=!this.Do.yN,w.ULS.sendTraceTag(529388308,3023,50,"User in new ribbonMode: {0}",this.Do.yN);else return 8;appChrome.getHeaderApi().then(x=>{x.hasOwnProperty("refreshThemeOverride")&&x.refreshThemeOverride()});this.o7n()||w.ULS.sendTraceTag(561553416,3023,15,"Failed to toggle Dark mode for Fishbowl");this.EFa&&!this.Do.U2a&&(this.p4f()||w.ULS.sendTraceTag(561553417,3023,15,"Failed to toggle Dark mode for Canvas"));
h={};h.DarkModeToggle=appChrome.selectors.getModelType("DarkModeToggle");ob.App.xa.ZF(h);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.Do.yN));this.EFa&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",!this.Do.yN));b.stop();w.ULS.sendTraceTag(555885377,3023,50,"{0}",b.ni);return 32}i_c(b,h,n){if(1===n)return 32;b=this.sV.fg("UserAction","sharedUXDarkModeSwitchBackground");w.ULS.sendTraceTag(561088148,
3023,50,"Requesting to toggle Dark Mode for the switch background UX.");this.Do.U2a=!this.Do.U2a;if(!this.p4f())return 8;h={};h.DarkModeSwitchBackground=this.Dw?"ButtonModel":"ToggleButtonModel";ob.App.xa.ZF(h);b.stop();w.ULS.sendTraceTag(555885378,3023,50,"{0}",b.ni);w.ULS.sendTraceTag(529388309,3023,50,"User in new canvasMode: {0}",this.Do.U2a);return 32}C0d(b,h,n,x,E){if(1===n)return 32;if(!E)return 2;Mg.a("isSharedUXDarkModeOn")&&(this.Do.yN=appChrome.api.isSharedUXDarkModeOn());E&&(E[Qf.a.On]=
this.Do.yN);return 32}EVc(b,h,n,x,E){if(1===n)return 32;if(!E)return 2;!this.Dw&&E&&(E[Qf.a.On]=this.Do.U2a);b=[];b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.Do.yN));this.EFa&&this.Y7i(b);b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackground",this.sYh(!1)));appChrome.api.dispatch(b);return 32}sYh(b){const h={};this.Do.U2a?b?h["default"]="MoonMonochromatic_16":(h["default"]="MoonMonochromatic_20",h.icon32="MoonMonochromatic_32"):b?h["default"]=
"SunMonochromatic_16":(h["default"]="SunMonochromatic_20",h.icon32="SunMonochromatic_32");return h}sSc(){this.gUb&&this.Tli(!1);this.EFa&&this.Aki(!1)}Tli(b){var h;w.ULS.sendTraceTag(561088149,3023,50,"Shared dark mode state. IsBoot: {0}; State: {1}; DefaultOn: {2}",b,this.Do.yN?"dark":"light",this.Do.Jza);b&&this.Do.yN!=(null===(h=this.nuj)||void 0===h?void 0:h.$("DarkModeIsOn"))&&w.ULS.sendTraceTag(522303360,3023,15,"Inconsistent dark mode value is found during boot. Dark mode toggle: {0}. DefaultOn: {1}.",
this.Do.yN?"dark":"light",this.Do.Jza)}Aki(b){w.ULS.sendTraceTag(561088150,3023,50,"Canvas dark mode state. IsBoot: {0}; State: {1}; DarkCanvasPreferred: {2}",b,this.Do.nda?"dark":"light",this.Do.kOk)}}Object(r.a)(pL,"DarkModeActor",null,[]);var qL=d(1541);class SF{constructor(){this.Height=this.Width=0}static construct(b,h){const n=new SF;n.Width=b;n.Height=h;return n}}Object(r.a)(SF,"ViewportInfo",null,[]);class mH extends Gp.a{constructor(){super();this.ContractVersion=0;this.World=this.EnhancementId=
this.DocumentContent=null;this.ScalingFactor=0;this.MobileViewportInfo=this.DesktopViewportInfo=null;this.MinParagraphCount=0;this.ContentCulture=null}Wl(){return 85}static construct(b,h,n,x,E,S,ma,Fa,$a,sb,Jb){const Sb=new mH;Sb.ContractVersion=b;Sb.DocumentContent=h;Sb.EnhancementId=n;Sb.World=x;Sb.ScalingFactor=E;Sb.DesktopViewportInfo=SF.construct(S,ma);Sb.MobileViewportInfo=SF.construct(Fa,$a);Sb.MinParagraphCount=sb;Sb.ContentCulture=Jb;return Sb}}Object(r.a)(mH,"SwayPreviewRequest",Gp.a,[]);
var rL=d(590);class lD{static get ug(){return Kc.a.Lx(lD.rl,WordEditorIntl.WordEditorStrings.L_DigitalPrintLearnMore,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogStyleLabel,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogPreviewLabel,lD.$yn,WordEditorIntl.WordEditorStrings.l_SavingStatus)}}lD.$yn=Gl.a.Sh("progress.gif");lD.rl="<div class='WACDialogRow digitalPrintDialogWrapper UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
Object(r.a)(lD,"DigitalPrintDialogHtml",null,[]);class Cv{constructor(b,h,n,x){this.fontFamily=b;this.RXc=h;this.fontWeight=n;this.fontStyle=x}}Object(r.a)(Cv,"FontInfo",null,[]);class Ur{constructor(b,h,n,x){this.styleName=b;this.title=h;this.H6n=n;this.IVl=x}}Object(r.a)(Ur,"StyleVisualInfo",null,[]);class pC extends Kc.a{constructor(b,h,n,x,E=!0){super();this.A4=this.Zn=this.mia=this.J0=this.Pad=this.D0g=this.gmd=this.JHe=this.KHe=this.bHe=this.DUb=this.lIa=this.W0=this.UTb=null;this.CKe=this.aDe=
!1;this.J$c=null;this.zXk=()=>{this.dTi(0)};this.yXk=(S,ma)=>{this.dTi(ma)};this.jzi=S=>{this.DRh(S)===Sys.UI.Key.enter&&(this.aHf(S),S.preventDefault(),S.stopPropagation())};this.Mvi=S=>{((S=S.rawEvent.relatedTarget)&&("digitalPrintLearnMoreLink"===S.id||S.id===Wf.a.s5c)||V.a.zk)&&this.lIa&&this.$Ib(this.lIa)};this.Nvi=S=>{const ma=this.DRh(S);ma!==Sys.UI.Key.tab&&ma!==Sys.UI.Key.left&&ma!==Sys.UI.Key.right&&ma!==Sys.UI.Key.up&&ma!==Sys.UI.Key.down||this.LSl(ma)||(S.preventDefault(),S.stopPropagation(),
this.DQm(ma))};this.fFf=()=>{this.CKe||(this.CKe=!0,w.ULS.sendTraceTag(25798020,382,50,"User has scrolled styles gallery"),af.a.removeHandler(this.W0,kb.a.scroll,this.fFf))};this.NFf=()=>{w.ULS.sendTraceTag(26005580,382,50,"Learn more click")};this.aHf=S=>{S.preventDefault();S.stopPropagation();u.AFrameworkApplication.ya.processAction(Db.a.myh,2);S.target?(S="button"===S.target.tagName.toLowerCase()?S.target:S.target.parentNode)&&S.id!==this.UTb&&(w.ULS.sendTraceTag(25231813,382,50,"DigitalPrintDialog.OnStyleGalleryItemClick style changed from {0} to {1}",
this.UTb,S.id),this.Mjh(S),this.sth()):w.ULS.sendTraceTag(24418077,382,10,"DigitalPrintDialog.OnStyleGalleryItemClick e.Target is null!")};this.jUk=S=>{const ma=(new Date).getTime()-this.Uzg;Dg.a.instance.Tf(si.a.lUk,ma);S?this.CDn():(w.ULS.sendTraceTag(25231814,382,50,"DigitalPrintDialog.DigitalPrintDialogHandler Dialog has been closed with the cancel button"),u.AFrameworkApplication.ya.processAction(Db.a.lyh,2))};this.ADn=()=>{this.vWn();try{const S=pC.Dzh.o4k(),ma=mH.construct(2,S,this.UTb,"VerticalWorld",
.3,1366,600,330,280,20,pC.Dzh.kOb.name);u.AFrameworkApplication.Ze.Lj(String.format("{0}/we/GetSwayPreview.ashx?{1}",ob.App.webServiceBase,u.AFrameworkApplication.rootQuerySignature),2,rL.b(ma),{"Content-Type":"application/json; charset=utf-8","Content-Encoding":"gzip"},!1,2,this.E6m,this.JEi,ma)}catch(S){w.ULS.sendTraceTag(25268375,382,10,"Failed to generate preview request. Exception: {0}",S.message)}};this.E6m=S=>{var ma=null;({group:ma}=wl.a.G7(S.data.Ee)).returnValue?(ma=ma.Responses[0],ma.Succeeded?
(this.pSd(S.data,si.a.B2n),this.lab(),this.QYi(this.JHe,ma.PreviewHtml),this.QYi(this.gmd,ma.PreviewHtmlMobile)):this.JEi(null)):w.ULS.sendTraceTag(25231816,382,10,"DigitalPrintDialog.PreviewSuccessCallback Preview response deserialization failed")};this.JEi=()=>{this.wWn();this.KHe.style.background="#E6E6E6";this.D0g.style.background="#E6E6E6"};this.ug=lD.ug;this.kg="DigitalPrintDialog";w.ULS.sendTraceTag(26005578,382,50,"Print to Web dialog has been opened and we initiated document force save");
this.YPj=WordEditorIntl.WordEditorStrings.L_DigitalPrintTransformSlab;this.UOb=WordEditorIntl.WordEditorStrings.L_DigitalPrintButtonTransform;this.kVj=n;this.Pmc=x;this.We(1,this.YPj);this.Zh(this.UOb,this.jUk,null);this.$0l();this.o1n();this.Uzg=(new Date).getTime();E&&aw.a.HP(14,!1,this.zXk,this.yXk,null);this.h2l();this.E_l();this.Sqm();this.Dvf();this.Jqm();this.sth()}get rsa(){return this.J$c}dTi(b){if(!this.aDe){const h=(new Date).getTime()-this.Uzg;Dg.a.instance.Tf(si.a.kUk,h);b?w.ULS.sendTraceTag(25548302,
382,15,String.format("We failed to save document with status code {0}",df.a[b])):w.ULS.sendTraceTag(25548301,382,50,"We saved document successfully");document.getElementById("digitalPrintSavingDiv").style.display="none";this.pVa.disabled=!1}}$0l(){this.DUb=document.getElementById("digitalPrintStatusMessageDiv");this.bHe=document.getElementById("digitalPrintStatusMessageIconDiv");this.KHe=document.getElementById("swayDesktopPreviewWrapperDiv");this.JHe=document.getElementById("swayDesktopPreviewHtmlHolder");
this.gmd=document.getElementById("swayMobilePreviewHtmlHolder");this.D0g=document.getElementById("swayMobilePreviewWrapperDiv");this.W0=document.getElementById("swayGallery");this.W0.setAttribute("tabindex","0");af.a.addHandler(this.W0,kb.a.scroll,this.fFf);this.W0.setAttribute(qf.a.Ah,qf.a.xch);this.J0=document.getElementById("digitalPrintLearnMoreLink");this.J0.href="https://go.microsoft.com/fwlink/?linkid=871972";af.a.addHandler(this.J0,kb.a.click,this.NFf);this.mia=new Qa.a;this.Pad=document.getElementById("homeWrapper");
this.m3("mainText");document.getElementById("mainText").innerText="OneDriveWOPI"===this.Pmc?WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionMSA:WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionAAD}h2l(){this.Zn=new Qa.a;this.Zn.add(new Ur("BokehV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBokeh,"swayLightProTitle swayBokehTitle","swayLightProHeading swayBokehHeading"));this.Zn.add(new Ur("Regency",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameRegency,
"swayVanillaTitle swayRegencyTitle","swayVanillaHeading swayRegencyHeading"));this.Zn.add(new Ur("PilarV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNamePilar,"swayVanillaTitle swayPilarTitle","swayVanillaHeading swayPilarHeading"));this.Zn.add(new Ur("Boutique",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBoutique,"swaySwirlTitle swayBoutiqueTitle","swaySwirlHeading swayBoutiqueHeading"));this.Zn.add(new Ur("Studio",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStudio,
"swaySimplicityTitle swayStudioTitle","swaySimplicityHeading swayStudioHeading"));this.Zn.add(new Ur("Sierra",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameSierra,"swaySwirlTitle swaySierraTitle","swaySwirlHeading swaySierraHeading"));this.Zn.add(new Ur("Fete",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFete,"swaySwirlTitle swayFeteTitle","swaySwirlHeading swayFeteHeading"));this.Zn.add(new Ur("CelestialV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCelestial,"swaySwirlTitle swayCelestialTitle",
"swaySwirlHeading swayCelestialHeading"));this.Zn.add(new Ur("TranquilV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameTranquil,"swayVanillaTitle swayTranquilTitle","swayVanillaHeading swayTranquilHeading"));this.Zn.add(new Ur("Midtown",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMidtown,"swayLightProTitle swayMidtownTitle","swayLightProHeading swayMidtownHeading"));this.Zn.add(new Ur("Lucent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameLucent,"swaySimplicityTitle swayLucentTitle",
"swaySimplicityHeading swayLucentHeading"));this.Zn.add(new Ur("AerialV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAerial,"swaySwirlTitle swayAerialTitle","swaySwirlHeading swayAerialHeading"));this.Zn.add(new Ur("StructureV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStructure,"swaySwirlTitle swayStructureTitle","swaySwirlHeading swayStructureHeading"));this.Zn.add(new Ur("Muse",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMuse,"swayLightProTitle swayMuseTitle",
"swayLightProHeading swayMuseHeading"));this.Zn.add(new Ur("Cinema",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCinema,"swaySimplicityTitle swayCinemaTitle","swaySimplicityHeading swayCinemaHeading"));this.Zn.add(new Ur("MegaV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMega,"swayVanillaTitle swayMegatitle","swayVanillaHeading swayVanillaHeading"));this.Zn.add(new Ur("ConvergenceV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameConvergence,"swayVanillaTitle swayConvergenceTitle",
"swayVanillaHeading swayConvergenceHeading"));this.Zn.add(new Ur("Alloy",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAlloy,"swayLightProTitle swayAlloyTitle","swayLightProHeading swayAlloyHeading"));this.Zn.add(new Ur("Fluent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFluent,"swaySimplicityTitle swayFluentTitle","swaySimplicityHeading swayFluentHeading"));this.Zn.add(new Ur("Aurora",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAurora,"swaySwirlTitle swayAuroraTitle",
"swaySwirlHeading swayAuroraHeading"));this.Zn.add(new Ur("Civic",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCivic,"swayLightProTitle swayCivicTitle","swayLightProHeading swayCivicHeading"));this.Zn.add(new Ur("Reflection",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameReflection,"swaySimplicityTitle swayReflectionTitle","swaySimplicityHeading swayReflectionHeading"))}E_l(){this.A4=new Qa.a;this.A4.add(new Cv("universc","universc","normal","normal"));this.A4.add(new Cv("Miller-Banner_Roman_WebTT",
"Miller-Banner_Roman_WebTT","normal","normal"));this.A4.add(new Cv("Miller-Banner_Italic_WebTT","Miller-Banner_Italic_WebTT","normal","italic"));this.A4.add(new Cv("Miller-Banner_Bold_Italic_WebTT","Miller-Banner_Bold_Italic_WebTT","bold","italic"));this.A4.add(new Cv("QuireSans-Thin","QuireSans-Thin","extrathin","normal"));this.A4.add(new Cv("Posterama-Regular","Posterama-Regular","normal","normal"));this.A4.add(new Cv("Heron_Serif-Regular_WebTT","Heron_Serif-Regular_WebTT","normal","normal"));this.A4.add(new Cv("Benton_Modern-Roman_WebTT",
"Benton_Modern-Roman_WebTT","normal","normal"));this.A4.add(new Cv("ArialNova","ArialNova","normal","normal"));this.A4.add(new Cv("TisaOffcSerifPro-Thin","TisaOffcSerifPro-Thin","normal","normal"));this.A4.add(new Cv("QuireSans-Regular","QuireSans-Regular","normal","normal"));this.A4.add(new Cv("RockwellNova","RockwellNova","normal","normal"));this.A4.add(new Cv("SabonNRegLT","SabonNRegLT","normal","normal"));this.A4.add(new Cv("DaytonaThin","DaytonaThin","100","normal"))}Sqm(){const b=document.createElement("style");
b.setAttribute("type","text/css");let h="";for(let n of this.A4)h+=String.format(this.kVj,n.fontFamily,n.RXc,n.fontWeight,n.fontStyle);b.innerText=h;this.Pad.appendChild(b)}Jqm(){const b=document.createElement("style");b.setAttribute("type","text/css");const h=String.format(".{0} {{ background: url({1}) no-repeat; }}","swayPreviewFrameBackground",Gl.a.Sh("SwayPreviewFrame.svg")),n=String.format("@media screen and (-ms-high-contrast: active) {{ .{0} {{ background: url({1}) no-repeat; -ms-high-contrast-adjust: none; }}}}",
"swayPreviewFrameBackground",Gl.a.Sh("SwayPreviewFrameHC.svg"));b.innerText=h+n;V.a.So&&(b.innerText+=".AppRtl .swayGallery { margin-right: -15px; }");this.Pad.appendChild(b)}DRh(b){return b?b.keyCode:window.event.keyCode}hide(){this.fQf();super.hide()}fQf(){if(this.W0&&!this.aDe){for(let b=0;b<this.mia.count;b++)af.a.removeHandler(this.mia.J(b),kb.a.click,this.aHf),af.a.removeHandler(this.mia.J(b),kb.a.Di,this.jzi);af.a.removeHandler(this.W0,kb.a.Di,this.Nvi);af.a.removeHandler(this.W0,kb.a.focus,
this.Mvi);af.a.removeHandler(this.J0,kb.a.click,this.NFf);this.CKe||af.a.removeHandler(this.W0,kb.a.scroll,this.fFf);this.aDe=!0}}Dvf(){const b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",Gl.a.nik());this.Pad.appendChild(b);for(let h of this.Zn)this.UIk(this.W0,h);this.mU(this.W0);this.Mjh(this.W0.firstChild);this.W0.firstChild.focus();af.a.addHandler(this.W0,kb.a.Di,this.Nvi);af.a.addHandler(this.W0,kb.a.focus,this.Mvi)}UIk(b,
h){const n=document.createElement("button");n.className="swayGalleryItem swayClip136x90 swayImageBorderButton";n.setAttribute(qf.a.B$a,qf.a.eL);n.setAttribute("title",h.title);n.setAttribute(qf.a.Ah,qf.a.Ach);n.id=h.styleName;b.appendChild(n);b=document.createElement("img");b.className=String.format("swayPublish_Sway{0}StyleBlank_136x90x32",h.styleName);b.src=Gl.a.Sh("swayPublish.png");b.setAttribute(qf.a.Ah,qf.a.xz);b.setAttribute("unselectable","on");b.setAttribute(qf.a.wz,qf.a.Ho);b.id=h.styleName+
"img";n.appendChild(b);b=document.createElement("label");b.innerText=h.title;b.className=h.H6n;b.setAttribute(qf.a.wz,qf.a.Ho);b.setAttribute("unselectable","on");b.setAttribute(qf.a.Ah,qf.a.xz);n.appendChild(b);const x=document.createElement("label");x.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintHeadingText;x.className=h.IVl;x.setAttribute(qf.a.wz,qf.a.Ho);b.setAttribute("unselectable","on");x.setAttribute(qf.a.Ah,qf.a.xz);n.appendChild(x);af.a.addHandler(n,kb.a.click,this.aHf);af.a.addHandler(n,
kb.a.Di,this.jzi);this.mia.add(n)}DQm(b){const h=this.rsa;this.eal(b,h,!u.AFrameworkApplication.isRtl)||this.gal(b,h,!u.AFrameworkApplication.isRtl)||this.bal(b,h)||this.cal(b,h)}LSl(b){return b===Sys.UI.Key.tab?(this.rsa&&this.rsa!==this.lIa&&(this.rsa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.J$c=this.lIa),!0):!1}eal(b,h,n){return b===Sys.UI.Key.right&&n||b===Sys.UI.Key.left&&!n?(b=(b=h.nextSibling)||this.W0.firstChild,this.$Ib(b),!0):!1}gal(b,h,n){return b===Sys.UI.Key.left&&
n||b===Sys.UI.Key.right&&!n?(b=(b=h.previousSibling)||this.W0.lastChild,this.$Ib(b),!0):!1}bal(b,h){return b===Sys.UI.Key.down?(b=this.mia.indexOf(h),h=b+2,h<this.mia.count?(b=this.mia.J(h))&&this.$Ib(b):(h=b%2+1,h=2<=h?0:h,(b=this.mia.J(h))&&this.$Ib(b)),!0):!1}cal(b,h){b===Sys.UI.Key.up&&(b=this.mia.indexOf(h),h=b-2,0<=h?(b=this.mia.J(h))&&this.$Ib(b):(h=b?20+b-1:this.mia.count-1,(b=this.mia.J(h))&&this.$Ib(b)))}$Ib(b){this.rsa&&this.rsa.id!==this.lIa.id&&(this.rsa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");
this.J$c=b;this.rsa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonFocused");this.rsa.focus()}o1n(){this.pVa.className="WACDialogButtonNormal swayPrintToWebButton";this.pVa.setAttribute("tabindex","0");this.gz.className="WACDialogButtonNormal swayCancelButton";this.gz.setAttribute("tabindex","0");this.pVa.disabled=!0}Mjh(b){this.rsa&&(this.rsa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.lIa&&(this.lIa.className=
"swayGalleryItem swayClip136x90 swayImageBorderButton",this.lIa.setAttribute(qf.a.B$a,qf.a.eL));this.UTb=b.id;this.lIa=b;this.lIa.setAttribute(qf.a.B$a,qf.a.Ho);this.J$c=b;this.rsa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonSelected")}sth(){Ye.a.instance.$b(new We.a(2,1,50,this.ADn))}QYi(b,h){b.innerHTML=h}CDn(){w.ULS.sendTraceTag(25231818,382,50,String.format("DigitalPrintDialog.SendPublishRequest Sending publish request for style {0}",
this.UTb));u.AFrameworkApplication.ya.processAction(Db.a.nyh,2);const b=String.format("{0}/we/SwayPublish.ashx?{1}&parentSessionId={2}&styleId={3}",ob.App.webServiceBase,u.AFrameworkApplication.rootQuerySignature,u.AFrameworkApplication.userSessionId,this.UTb);rd.a.openWindow(4,b)}pSd(b,h){Dg.a.instance.Tf(h,+b.uS-+b.TG)}wWn(){var b=WordEditorIntl.WordEditorStrings.L_DigitalPrintPreviewFailureMessage;this.lab();this.DUb.innerText=b;this.DUb.style.display="block"}vWn(){this.lab();this.bHe.style.display=
"block";this.DUb.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintGeneratingPreview;this.DUb.style.display="block"}lab(){this.KHe.style.background="";this.gmd.style.background="";Ke.a.YY(this.JHe);Ke.a.YY(this.gmd);this.DUb.style.display="none";this.bHe.style.display="none"}static get Dzh(){return null!=pC.Qgg?pC.Qgg:pC.Qgg=Oa.a.instance.Pa("Box4.DocumentContentExtractor.IDocumentContentExtractor")}}Object(r.a)(pC,"DigitalPrintDialog",Kc.a,[]);class nH{constructor(b,h){this._context=this.Pk=
null;this.Bie=0;this.S6c=!1;this.z_g=null;this.digitalPrint=(n,x,E,S,ma)=>{if(1===E)return u.AFrameworkApplication.fO?8:32;this.z_g=ma.SourceControlId;if(u.AFrameworkApplication.K.$("IsAnonymousUser"))return w.ULS.sendTraceTag(34373826,382,50,"DigitalPrintActor.DigitalPrint: Anonymous user tried to click on Print to Web feature."),this.iec(WordEditorIntl.WordEditorStrings.L_DigitalPrintSignInNeeded),32;this._context=x;if(nH.sem())return w.ULS.sendTraceTag(34373828,382,50,"DigitalPrintActor.DigitalPrint: MSA user clicked on Print to Web feature."),
this.mZe(),32;switch(this.Bie){case 1:w.ULS.sendTraceTag(34373829,382,50,"DigitalPrintActor.DigitalPrint: AAD user with Sway license clicked again on Print to Web feature.");this.mZe();break;case 2:w.ULS.sendTraceTag(34373830,382,50,"DigitalPrintActor.DigitalPrint: AAD user without Sway license clicked again on Print to Web feature.");this.iec(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense);break;case 0:this.S6c=!1,this.Pk=(new pn.a).create(),this.Pk.message=WordEditorIntl.WordEditorStrings.L_DigitalPrintCheckingSwayLicense,
this.Pk.jM(CommonUIStrings.l_DefaultDialogTitle,this.jtk,null),u.AFrameworkApplication.Ze.Lj(String.format("{0}/we/CheckSwayLicense.ashx?{1}",ob.App.webServiceBase,u.AFrameworkApplication.rootQuerySignature),2,null,null,!1,2,this.ltk,this.ktk,null)}return 32};this.jtk=()=>{this.S6c=!0;w.ULS.sendTraceTag(34373831,382,50,"DigitalPrintActor.CheckSwayLicenseCanceled: Canceling license check...")};this.ltk=n=>{if(!this.S6c){this.Pk.close();var x=null;this.pSd(n.data,si.a.A2n);({group:x}=wl.a.G7(n.data.Ee)).returnValue?
(n=x.Responses[0],w.ULS.sendTraceTag(34373832,382,50,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization succeeded. HasLicense: {0}, Succeeded: {1}",n.HasLicense,n.Succeeded),n.Succeeded?(this.Bie=n.HasLicense?1:2,2===this.Bie?this.iec(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense):this.mZe()):this.iec(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown)):(w.ULS.sendTraceTag(34373833,382,10,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization failed"),
this.iec(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))}};this.ktk=n=>{this.S6c||(this.Pk.close(),w.ULS.sendTraceTag(34373834,382,15,"DigitalPrintActor.CheckSwayLicenseFailCallback: CheckSwayLicense request failed!"),this.pSd(n.data,si.a.z2n),this.iec(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))};this.ga=b;this.n4=h}Vb(){u.AFrameworkApplication.protectFile?w.ULS.sendTraceTag(26093080,382,50,"Disabling Digital Print button because document has protection."):u.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&
u.AFrameworkApplication.K.$("DisablePrint")?w.ULS.sendTraceTag(26093081,382,50,"Disabling Digital Print button because print is disabled."):(this.ga.gb(Db.a.qyd,cc.a.view,this.digitalPrint,4),this.ga.gb(Db.a.myh,cc.a.view,pd.ActionManager.jZ,4),this.ga.gb(Db.a.nyh,cc.a.view,pd.ActionManager.jZ,4),this.ga.gb(Db.a.lyh,cc.a.view,pd.ActionManager.jZ,4),this.ga.gb(Ra.a.ryd,cc.a.view,pd.ActionManager.jZ,4))}mZe(){w.ULS.sendTraceTag(36824994,382,50,"DigitalPrintActor.CreateDigitalPrintDialog: Opening the DigitalPrintDialog. Button {0} clicked.",
this.z_g);new pC(this._context,this.ga,u.AFrameworkApplication.K.lb("SwayFontDownloadUrlTemplate"),u.AFrameworkApplication.K.lb("FileSource"))}iec(b){const h=new yd.StandardDialog;h.Ed=0;h.Bga(CommonUIStrings.l_DefaultDialogTitle,b,null)}pSd(b,h){Dg.a.instance.Tf(h,+b.uS-+b.TG)}static sem(){return"OneDriveWOPI"===u.AFrameworkApplication.K.lb("FileSource")}}Object(r.a)(nH,"DigitalPrintActor",null,[]);class sL{constructor(){this.t2g=null}Sli(){w.ULS.sendTraceTag(25007841,375,50,"Do not check for this critique type triggered")}Ccj(b){if(!b)return w.ULS.sendTraceTag(25007842,
375,15,"Error range is null"),!1;if(!this.fhi(b.errorDetails))return!1;this.t2g=Object(ja.a)(Ok.a,b.errorDetails).typeId;return!0}K6d(b){return this.fhi(b)?Object(ja.a)(Ok.a,b).typeId===this.t2g:!1}fhi(b){if(!b)return w.ULS.sendTraceTag(25007843,375,15,"No ErrorDetails found"),!1;b=Object(ja.a)(Ok.a,b);return b?b.token&&b.typeId?!0:(w.ULS.sendTraceTag(25007873,375,50,"Token is null: {0}",!b.token),!1):(w.ULS.sendTraceTag(25007872,375,50,"ErrorDetails is null"),!1)}}Object(r.a)(sL,"DoNotCheckThisCritiqueTypeStrategy",
null,[602]);class tL extends Kc.a{constructor(b,h,n){super(!1,!1,!0);this.Ac=b;this.zka=n;this.aAj="DocumentChoiceGroup";this.oBg="EmbededContent";this.HGg="HyperLink";this.Hve=n.x5a;b={["id"]:"ExternalContentDefaultSettingsDialog",["bodyControls"]:this.DGc()};this.Mvj=this.T3k.bind(this);this.We(1,WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogSave);this.Zh(WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogTitle,this.Mvj,b)}DGc(){const b=Array(2);b[0]=
{["key"]:this.oBg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryContent};b[1]={["key"]:this.HGg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryHyperLink};const h={};h.documentChoiceGroupProps={["id"]:this.aAj,["defaultSelectedKey"]:this.Hve?this.oBg:this.HGg,["label"]:WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogDescription,["options"]:b};h.learnMoreLinkText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMore;
h.learnMoreURL=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMoreUrl;h.externalContentDefaultSettingsDialogInformationText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogInformation;return h}T3k(b,h){1===b?(this.Hve!==h.isExternalContentSelected&&(b=h.isExternalContentSelected?ub.a.uKa:ub.a.acb,this.Ac.processAction(b,2),this.Hve=h.isExternalContentSelected,Y.a.sendTelemetryEvent(Object.assign(new fa.a,{name:"Office.Word.Online.ExternalContent.ExternalContentDefaultSettings",
dataFields:[Object.assign(new ca.a,{name:"ActionId",int64:b})]}))),this.zka.yzn(h.isExternalContentSelected)):0===b&&w.ULS.sendTraceTag(556565635,324,50,"Cancel Clicked in ExternalContentDefaultSettingsDialog")}}Object(r.a)(tL,"ExternalContentDefaultSettingsDialog",Kc.a,[]);class Vr{constructor(b,h,n,x,E){this.Wv=Oa.a.instance.resolve("Common.IReactContextualUILauncher");this.mnb=Qf.a.On;this.dec=()=>{const S=Array(1);S.push("ExternalContent");var ma=Oa.a.instance.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider").$Ka();
ma=Object.assign(new lF.a,{x:ma.x,y:ma.y});this.Wv.showFloatie(ma,S,1);return 32};this.hBb=()=>{this.Wv.EZ&&this.Wv.Vu();return 32};this.CGi=(S,ma,Fa,$a,sb)=>{if(ma="object"===typeof sb?sb:null)S===ub.a.eNf?(S=Vr.tSa!==ub.a.uKa&&Vr.tSa!==ub.a.acb,ma[this.mnb]=Vr.tSa===ub.a.uKa||S):S===ub.a.fNf&&(ma[this.mnb]=Vr.tSa===ub.a.acb);return 32};this.rEh=(S,ma,Fa)=>{1!==Fa&&(S===ub.a.acb&&Vr.tSa!==ub.a.acb?(w.ULS.sendTraceTag(575813832,324,50,"ExternalContentPasteHyperlinkOption clicked"),this.sm.undo()&&
(ma=new Go.a(1,u.AFrameworkApplication.isRtl),ma.aUc="ExternalContent",Vr.$bb.$Vc(ma))):S===ub.a.uKa&&Vr.tSa!==ub.a.uKa&&(w.ULS.sendTraceTag(575813833,324,50,"ExternalContentPasteEmbededWebContentOption clicked"),u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),this.gCg.jIi()),Vr.tSa=S);Y.a.sendTelemetryEvent(Object.assign(new fa.a,{name:"Office.Word.Online.ExternalContent.Floatie",dataFields:[Object.assign(new ca.a,{name:"behavior",string:Fa.toString()}),
Object.assign(new ca.a,{name:"ActionId",int64:S})]}));return 32};this.ga=b;this.sm=h;this.gCg=x;this.Upb=E;this.Lvj=this.U3k.bind(this);u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.gCg.bKi(()=>{this.reset()})}Vb(){this.ga.gb(ub.a.eNf,cc.a.view,this.CGi,97);this.ga.gb(ub.a.fNf,cc.a.view,this.CGi,97);this.ga.gb(ub.a.qEh,cc.a.view,this.Lvj,1028);this.ga.gb(ub.a.uKa,cc.a.view,this.rEh,1028);this.ga.gb(ub.a.acb,cc.a.view,this.rEh,1028);this.Upb||
(this.ga.gb(ub.a.dec,cc.a.view,this.dec,96),this.ga.gb(ub.a.hBb,cc.a.view,this.hBb,96))}QUn(b){new tL(this.ga,b,Vr.zka)}U3k(b,h,n){1!==n&&this.QUn(Vr.tSa);return 32}static get $bb(){return null!=Vr.ihg?Vr.ihg:Vr.ihg=Oa.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get zka(){Vr.Twa||(Vr.Twa=Oa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Vr.Twa}reset(){Vr.tSa=null!=Vr.zka?Vr.zka.x5a?ub.a.uKa:ub.a.acb:ub.a.uKa}}Vr.tSa=ub.a.uKa;Vr.Twa=null;
Object(r.a)(Vr,"ExternalContentActor",null,[]);class qC extends Mt{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb){super(b,h,n,x,E,S,ma,Fa,$a,sb,Jb);this.vAd=!1;this.THg=null;this.Upb=Sb}xWc(){this.vAd||(super.xWc(),this.vAd=!0)}$ae(){this.vAd&&(super.$ae(),qC.JAh&&this.THg&&qC.JAh.removeHandler(Ku.a.yya,this.THg),this.vAd=!1)}xLb(){if(this.Upb){this.Wv.EZ&&this.Wv.Vu();const b=new Go.a(0,u.AFrameworkApplication.isRtl);b.location=this.Exa.$Ka();this.showFloatie(null,b)}else this.Wv.EZ&&u.AFrameworkApplication.ya.processAction(ub.a.hBb,
2),u.AFrameworkApplication.ya.processAction(ub.a.dec,2);this.m7b=!1}Vu(b){!this.mte&&(b&&(this.Exa.dnf(),this.Ddj()),this.Wv.EZ||this.dHa)&&(this.dHa=!b,this.$ae(),this.Upb?this.Wv.Vu():u.AFrameworkApplication.ya.processAction(ub.a.hBb,2))}showFloatie(b,h){h||(h=new Go.a(0,u.AFrameworkApplication.isRtl));h.location||(h.location=this.Exa.$Ka());if(!h.location)return!1;this.dHa&&(this.dHa=!1,this.xWc());this.Upb?(b=Array(1),b.push("ExternalContent"),this.Wv.showFloatie(this.Exa.$Ka(),b,1)):u.AFrameworkApplication.ya.processAction(ub.a.dec,
2);return!0}JCc(){if(!this.m7b){const b=new We.a(3,1,this.rvh,()=>{this.xLb()},196);Ye.a.instance.$b(b);this.m7b=!0}}fga(){this.Upb?this.Wv.EZ&&this.Wv.Vu():u.AFrameworkApplication.ya.processAction(ub.a.hBb,2);this.JCc()}CIb(){this.Upb?this.Wv.EZ&&this.Wv.Vu():u.AFrameworkApplication.ya.processAction(ub.a.hBb,2);this.JCc()}static get JAh(){return null!=qC.Vgg?qC.Vgg:qC.Vgg=Oa.a.instance.resolve("Box4.IEditStateEventManager")}}Object(r.a)(qC,"ExternalContentFloatieEventManager",Mt,[]);class rC extends ou{constructor(b,
h,n,x,E){super(b,h,n,x,E)}Ahh(){if(!this.hb||!this.hb.ib||!this.hb.ib.kb)return w.ULS.sendTraceTag(575813836,307,15,"Selection is null when we try to calculate external content floatie position"),null;var b=this.hb.ib.kb.Qa,h=!b.cpBegin&&!b.cpEnd;let n=b.node;if(n&&h&&!n.pI){do n=this.vVh(n);while(n&&!n.pI&&Object(pb.a)(Tc.AParagraphNode,n)&&!n.characterData.trim().length)}let x="";const E=Object(ja.a)(Tc.AParagraphNode,n);E&&(x=E.characterData.length===b.cpBegin||h?E.characterData.trimEnd():E.characterData.substring(0,
b.cpBegin).trimEnd());h=E?x.length:b.cpBegin;b=Object.assign(new nu,{Cua:Object(ja.a)(62,(E?Object(ja.a)(62,E):Object(ja.a)(62,n))||b.node),cac:h});return this.Fcf(b)}CQh(b,h){let n=null;const x=Object(ja.a)(182,b.Cua.Ui(h.Tb));if(!x)return null;if(Object(pb.a)(Tc.AParagraphNode,b.Cua)){const E=Object(ja.a)(Tc.AParagraphNode,b.Cua);if(E.rP){if(b=Object(ja.a)(dx.a,Cd.ParagraphReader.jdb(E)))(b=Object(ja.a)(182,b.Ui(h.Tb)))&&(n=b.getBounds()),n&&(n.height+=rC.rHh,n.width-=rC.z$k);return n}h=Object(ja.a)(80,
x);if(!h)return null;try{if(n=this.wqa.UY(b.cac,h,0<b.cac,!1,!1,!1))n.height+=rC.rHh}catch(S){w.ULS.sendTraceTag(575813837,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",S),n=null}}n||(n=x.getBounds());return n}}rC.rHh=65;rC.z$k=100;Object(r.a)(rC,"ExternalContentFloatiePositionProvider",ou,[]);class uL{constructor(b,h,n,x,E,S){this.rSf=(ma,Fa,$a)=>{if(1===$a)return u.AFrameworkApplication.protectFile||u.AFrameworkApplication.fO||u.AFrameworkApplication.Pla||Vh.SessionStatusManager.instance.Qj?
8:32;if(ma===Db.a.print)ma=1;else if(ma===ub.a.PDc)ma=0;else if(ma===ub.a.$yd)ma=2;else return 8;return this.jzn(ma)};this.ga=b;this.n4=h;this.FPb=n;this.Mzj=x;this.hAg=E;this.bwj=S}Vb(){u.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&this.Mzj||u.AFrameworkApplication.fO?(document.body.classList.add("WACStopPrinting"),""!==this.hAg&&this.bwj.pVn(this.hAg)):(this.ga.pa(Db.a.print,cc.a.application,this.rSf),this.ga.pa(ub.a.PDc,cc.a.application,this.rSf),this.ga.pa(ub.a.$yd,cc.a.application,
this.rSf))}jzn(b){const h=u.AFrameworkApplication.rootQuerySignature;if(!h||""===h||ob.App.rd&&ob.App.rd.QA.io)return 8;this.FPb.FMd=!1;this.FPb.Ajj.start();aw.a.HP(5,!0,Object(v.a)(this.FPb,this.FPb.ptn,"requestFileDownload"),Object(v.a)(this.FPb,this.FPb.MFb,"onForceSaveFailed"),b);return 32}}Object(r.a)(uL,"FileDownloadActor",null,[]);class vL extends Lc{constructor(b,h=null){super(b,!0,h,!1)}get Akf(){return null}get V_a(){return u.AFrameworkApplication.AWa?CommonUIStrings.l_DownLoadACopyDialogMessage:
CommonUIStrings.l_PrintDialogDocumentIsPrinting}get g8b(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get rqd(){return null}}Object(r.a)(vL,"DownloadAsPdfDialog",Lc,[]);class Iu{constructor(){this._url=this.Ku=null;this.GTa=this.FTa=0;this.R9a=!1;this.makeRequest=()=>{u.AFrameworkApplication.Ze.Lj(this._url,1,null,null,!0,2,this.VFb,this.Dma,null)};this.VFb=b=>{Iu.LXc();const h=b.data.gga;let n=null;if(h)try{n=h.selectSingleNode("/docdata/status")}catch(x){}n&&
("InProgress"===n.text&&22>this.FTa++||"ServiceBusy"===n.text&&3>this.GTa++)?this.CDa(1E3*(this.FTa+this.GTa)):this.Ku(!0,n?n.text:null,b.data)};this.Dma=b=>{this.R9a?(Iu.Nxa||(Iu.v7a=new Date,Iu.Nxa=!0,Iu.YR=1),18E4>(new Date).getTime()-Iu.v7a.getTime()?this.retryOnFailure(4<=Iu.YR?2E4:1E3):this.qYa(b.data)):4>Iu.YR?this.retryOnFailure(2E3):this.qYa(b.data)}}send(b,h,n){this._url=b;this.Ku=h;this.R9a=n;this.makeRequest(null)}CDa(b){b=new We.a(2,1,b,this.makeRequest);u.AFrameworkApplication.uc.$b(b)}retryOnFailure(b){this.CDa(b);
Iu.YR++}qYa(b){this.Ku(!1,null,b)}static O9(b,h){(new Iu).send(b,h,!1)}static LXc(){Iu.Nxa=!1;Iu.YR=0}}Iu.v7a=null;Iu.Nxa=!1;Iu.YR=0;Object(r.a)(Iu,"ClientRequestWithRetry",null,[]);class wL extends mg{constructor(b){super(b,void 0,u.AFrameworkApplication.AWa)}get V_a(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady}get g8b(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLinkSuggestion}get $Pc(){return"DownloadOdtLink"}get buttonText(){return CommonUIStrings.l_Download}get sCc(){return u.AFrameworkApplication.AWa?
"UIFontDialogTextLarge":null}Wvf(){w.ULS.sendTraceTag(7628378,324,50,"ODT download dialog displayed")}Xvf(){w.ULS.sendTraceTag(7628379,324,50,"ODT download dialog link clicked")}rQc(){w.ULS.sendTraceTag(19462216,324,50,"ODT download dialog button clicked")}get JPc(){return NG.pti}get Cgb(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLearnMoreLinkText}get vpi(){return!u.AFrameworkApplication.AWa}}Object(r.a)(wL,"DownloadAsOdtDialog",mg,[]);class xL{constructor(b,h){this.q6a=this.BUa=
null;this.z2a=n=>{1===ob.App.xa.state||this.BUa||(this.BUa=(new pn.a).create(),n=n.customData,this.Ztm(n),1===n?this.BUa.message=this.oob.yP.isEnabled?u.AFrameworkApplication.AWa?CommonUIStrings.l_DirectPrintPreparingPDF:WordEditorIntl.WordEditorStrings.L_DirectPrintWait:WordEditorIntl.WordEditorStrings.l_PrintPDFWait:n?2===n&&(this.BUa.message=WordEditorIntl.WordEditorStrings.l_ConversionToODTWait):this.BUa.message=WordEditorIntl.WordEditorStrings.l_PrintPDFWait,this.BUa.jM(CommonUIStrings.l_DefaultDialogTitle,
this.cancelButton,null))};this.cancelButton=()=>{this.FMd=!0};this.nX=(n,x,E)=>{this.j1f("Success. Save and Conversion Complete.");E=new Ea.QueryStringBuilder(E.request.get_url());u.AFrameworkApplication.gja(E);E=E.toString();const S=this.Gtn(E);this.kka(S);2!==S&&this.oob.k7m();!n||x?this.r3(S):this.FMd?(this.FMd=!1,this.q6a=null):(this.q6a&&u.AFrameworkApplication.uc.ef(this.q6a),this.q6a=null,this.LVk(E,S))};this.FMd=!1;this.oob=b;this.Ajj=h.aNa("UserAction","WordEditorForceSaveAndPrint")}kka(b){this.BUa&&
(this.mum(b),this.BUa.close(),this.BUa=null)}r3(b){if(1!==ob.App.xa.state){this.jvm(b);const h=new yd.StandardDialog;h.Ed=0;h.We(1,CommonUIStrings.l_DialogClose);h.fy(0,"",1===b?WordEditorIntl.WordEditorStrings.l_PrintError:WordEditorIntl.WordEditorStrings.l_ConversionError,null,!0)}}wEl(b){switch(b){case 0:return"downloadpdf";case 1:return"printpdf";case 2:return"odt";default:return w.ULS.sendTraceTag(7628383,324,10,"Unknown request PDF type {0}",b),"printpdf"}}ptn(b){var h=u.AFrameworkApplication.rootQuerySignature;
h&&""!==h?(h="WordViewer/request."+this.O3k(b)+"?"+h+"&type="+this.wEl(b)+"&rndm="+na.a.create(),1===b&&this.oob.NTn()&&(h+="&useNamedAction=1"),u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("CustomFontReadModePDFIsEnabled")&&Uo.FontUtils.C6d()&&(1===b||!b)&&(0<Uo.FontUtils.dvh&&(h+="&cfcVer="+Uo.FontUtils.dvh),Uo.FontUtils.cvh&&(h+="&cfcUrl="+Uo.FontUtils.cvh),Uo.FontUtils.evh&&(h+="&cfcEncData="+Uo.FontUtils.evh)),Iu.O9(h,this.nX),this.q6a||(this.q6a=new We.a(2,1,500,this.z2a),this.q6a.customData=
b,u.AFrameworkApplication.uc.$b(this.q6a))):(this.j1f("failed. QuerySignature is empty."),this.r3(b))}O3k(b){return 2===b?"odt":"pdf"}MFb(){this.j1f("Failed. force save failed.")}Gtn(b){if(0<b.indexOf("&type=downloadpdf"))return 0;if(0<b.indexOf("&type=printpdf"))return 1;if(0<b.indexOf("&type=odt"))return 2;w.ULS.sendTraceTag(7628384,324,10,"Could not get requestType from uri:{0}",b);return 1}j1f(b){w.ULS.sendTraceTag(7628385,328,50,"stopping the perf counter for forcesave and print. [StoppingReason:{0}]",
b);this.Ajj.stop()}LVk(b,h){const n=new Qa.a;n.add("access_token");n.add("access_token_ttl");1!==ob.App.xa.state&&(1===h?this.oob.$Vn(b,n):h?2===h&&new wL(b):new vL(b))}dispose(){}Ztm(b){switch(b){case 0:w.ULS.sendTraceTag(38114782,203,50,"Download Attempt: Pdf");break;case 2:w.ULS.sendTraceTag(38114783,203,50,"Download Attempt: Odt");break;case 1:w.ULS.sendTraceTag(38114784,203,50,"Download Attempt: PrintPdf");break;default:w.ULS.sendTraceTag(38114785,203,15,"Download Attempt: {0}",b)}}mum(b){switch(b){case 0:w.ULS.sendTraceTag(38114786,
203,50,"Download Cancelled: Pdf");break;case 2:w.ULS.sendTraceTag(38114787,203,50,"Download Cancelled: Odt");break;case 1:w.ULS.sendTraceTag(38114816,203,50,"Download Cancelled: PrintPdf");break;default:w.ULS.sendTraceTag(38114817,203,15,"Download Cancelled: {0}",b)}}jvm(b){switch(b){case 0:w.ULS.sendTraceTag(38114818,203,15,"Download Failed: Pdf");break;case 2:w.ULS.sendTraceTag(38114819,203,15,"Download Failed: Odt");break;case 1:w.ULS.sendTraceTag(38114820,203,15,"Download Failed: PrintPdf");break;
default:w.ULS.sendTraceTag(38114821,203,15,"Download Failed: {0}",b)}}}Object(r.a)(xL,"FileDownloadManager",null,[]);class sC{get key(){return"LIST"}get hw(){return Box4Intl.Box4Strings.l_ListContentTitle}qgc(b){let h=null;const n=sC.hd.Es(b);if(!n)return{returnValue:!1,Sja:h};b=this.Cvl(b,n);h=Object.assign(new yg.a,{IF:this.key,contentId:b.listId,contentObject:b});return{returnValue:!0,Sja:h}}Azb(b,h){b=b.contentObject;const n=this.oul(b.uw),x=new qk.a;h?(h=h.contentObject,h.level!==b.level?(x.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,
b.level)),x.add(n)):h.id.equals(b.id)&&h.uw.listType===b.uw.listType||x.add(n)):(x.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),x.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,b.level)),x.add(n));return x.toArray().join(" ")}oul(b){let h="";const n=b.listStyle;if(!b.listType)h=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,b.fq);else if(1===b.listType)switch(n){case 1:h=this.tgh;break;case 2:h=this.imk;break;case 3:h=this.jmk;break;default:h=
this.tgh}return h}static get hd(){return null!=sC.lmg?sC.lmg:sC.lmg=Oa.a.instance.resolve("Box4.List.IListReader")}}Object(r.a)(sC,"ListDetailsProvider",null,[574,227]);class yL{constructor(){this.uw=this.listId=this.id=null;this.level=0}}Object(r.a)(yL,"ListItemInfo",null,[]);class zL extends sC{constructor(b){super();this.x4=b}get tgh(){return WoncaIntl.WoncaStrings.L_BulletStyle1}get imk(){return WoncaIntl.WoncaStrings.L_BulletStyle2}get jmk(){return WoncaIntl.WoncaStrings.L_BulletStyle3}Cvl(b,
h){const n=this.x4.Lw(b);return Object.assign(new yL,{id:b.currentNode.id,listId:new C.a(na.a.nil,n.listID),uw:h,level:n.level+1})}}Object(r.a)(zL,"FlatListDetailsProvider",sC,[]);class AL{constructor(b,h){this.ga=b;this.Cf=h}get pc(){return null!=this.wrg?this.wrg:this.wrg=Oa.a.instance.Pa("Box4.Styles.IWACStyleReader")}Vb(){}}Object(r.a)(AL,"FormattingActor",null,[]);var NP=d(1128),mD=d(1277),OP=d(1635);class BL{constructor(b,h,n,x,E,S,ma,Fa){this.Gb=b;this.CSj=h;this.Hc=n;this.rpb=x;this.nm=E;
this.Ma=S;this.wc=ma;this.BHj=Fa}v0a(b,h,n,x,E,S,ma){w.ULS.sendTraceTag(574358090,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ma.ni});this.rpb.then(()=>{this.CSj(b.data.Ee);w.ULS.sendTraceTag(574358091,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper load success: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ma.ni});ma.stop()})}Dma(b,h,n,x,E,S,ma){S.stop();E();ma?(this.n2m(h,n),w.ULS.sendTraceTag(574377989,
3001,15,"{0}",{["message"]:b,["id"]:Pd.ImageReader.kdb(h.Gb)})):w.ULS.sendTraceTag(574377990,3001,15,"{0}",{["message"]:b,["id"]:Pd.ImageReader.kdb(h.Gb)})}pah(b,h){b.Me(JF.a.mYe,"1");if(this.wc&&this.wc.isFeatureEnabled(51)){var n=this.nm.Xl(h.tk);n=this.nm.tl(n);b.Me(Ve.a.gq,mD.a[n]);5===n&&this.zak(b,h)}this.BHj&&b.Me(Ve.a.NKd,"true")}i5g(){return new OP.a(this.Gb.id,this.Gb)}JGd(){return WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError}n2m(b,h){const n=this.Hc.Rc(7,Db.a.jPl);n.Db(h);
b.Gb.setValue(ic.a.fph,!0);n.dispose()}zak(b,h){var n=h.tk;h=this.nm.Xl(n);var x=n.node;const E=(n=this.nm.MAa(h,x.Nc,!1))?this.nm.EAa(n):"";if(""===E)throw w.ULS.sendTraceTag(572555911,3001,10,"Could not find original dataBlobId on picture node."),Error.argumentNull("OriginalObjectDataBlobId");x=(x=this.nm.MAa(h,x.Nc,!0))?this.nm.EAa(x):"";b.Me(Ve.a.F$b,E);b.Me(Ve.a.Djj,x);n=n.ia(Th.a.sFh,"");""!==n&&b.Me(Ve.a.extension,n);b.Me(Ve.a.width,this.nm.nA(h).toString());b.Me(Ve.a.height,this.nm.zB(h).toString());
b.Me(Ve.a.eUc,this.nm.Cdb(h).toString());n=this.Ma.$("WordEditorImageCropIsEnabled");b.Me(Ve.a.uuh,n.toString());n&&(b.Me(Ve.a.top,this.nm.Xka(h).toString()),b.Me(Ve.a.bottom,this.nm.Uka(h).toString()),b.Me(Ve.a.left,this.nm.Vka(h).toString()),b.Me(Ve.a.right,this.nm.Wka(h).toString()));n=this.Ma.$("WordEditorImageRotateIsEnabled");b.Me(Ve.a.RRi,n.toString());n&&(b.Me(Ve.a.angle,this.nm.oZ(h).toString()),b.Me(Ve.a.flipH,this.nm.F3(h,ic.a.VJc,!1)?"true":"false"),b.Me(Ve.a.flipV,this.nm.F3(h,ic.a.dKc,
!1)?"true":"false"));b.Me(Ve.a.pBh,"true")}}Object(r.a)(BL,"GraphicsEditorDocumentXmlToJsonRequestHelper",null,[632]);class CL{constructor(){this.IGa=null}Agk(b){this.IGa=b}teardown(){null!=this.IGa&&(this.IGa.teardown(),this.IGa=null);this.YBe=null}getGraphicData(){return this.IGa?this.IGa.getGraphicData():null}hmn(){null!=this.YBe&&this.setGraphicData(this.YBe)}setGraphicData(b){this.YBe=b;if(this.IGa)try{this.IGa.setGraphicData(b)}catch(h){w.ULS.sendTraceTag(575522530,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: Exception {0} thrown from GraphicHost.",
h.toString())}else w.ULS.sendTraceTag(575522529,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: GraphicHost is null.")}hasEdits(){return this.IGa?this.IGa.hasEdits():!1}}Object(r.a)(CL,"GraphicsEditorGC2HostUser",null,[634]);var PP=d(1636),QP=d(1345),RP=d(597),SP=d(1430),TP=d(1043);class DL{constructor(b){this.preloadScript=this.loadScript=null;this.loadScript=h=>b.loadScript(h);this.preloadScript=h=>{b.preloadScript(h)}}}Object(r.a)(DL,"GC2ScriptLoader",null,[]);class oH{constructor(b,h,n){this.cje=
b;this._context=h;this.aIa=n}closeEditor(){this.cje&&(this.cje(),this.cje=null)}logActivity(b,h,n,x){Pe.a(b,h,n,x)}logTrace(b,h,n,x){w.ULS.sendTraceTag(575522531,3001,oH.LAm(h),x)}isEnabled(b){const h=u.AFrameworkApplication.K;switch(b){case "EqualSizingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSizingGuide",!1);case "AdjustHandles":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsAdjustHandles",!1);case "SpaceFirstLastPara":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextSpaceFirstLastPara",
!1);case "ModernFontPicker":return h.$("ModernFontPickerIsEnabled");case "SnapToAspectRatio":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.SnapToAspectRatio",!1);case "SVG":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsUseSVG",!1);case "ShapeLocksSchema":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShapeLocks",!1);default:return!1}}getFontPickerFonts(b){const h=`${Oa.a.instance.resolve("Box4.IFontServiceParser").nXa}/${"hier_officeFontsPreview.ttf"}`;
b("msofp_hier",h);b=Uo.FontUtils.e$e(()=>!1,()=>"",!0);return{commandId:"FontPicker",fonts:b.fonts.filter(n=>"premium"!==n.fontType),mruList:b.mruList,previewFontFamily:"msofp_hier_MSFontService"}}getFonts(b){const h=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",!1),n=h?"msofp_hier":"msofp",x=`${Oa.a.instance.resolve("Box4.IFontServiceParser").nXa}/${h?"hier_officeFontsPreview.ttf":"flat_officeFontsPreview.ttf"}`;b(n,x);Uo.FontUtils.P5g();Uo.FontUtils.p6g({});
b=Uo.FontUtils.d$e(()=>!1,(E,S)=>S).MenuSectionList;h&&0<b.length&&(b.pop(),b.push(this.kBk()));return b}kBk(){const b=Uo.FontUtils.e$e(()=>!1,()=>"").fonts.map((h,n)=>{const x=h.name;h=h.displayName;const E=Uo.FontUtils.Zla(x);return Object.assign(new aJ.a,{MenuItemId:Uo.FontUtils.cUi+n,CommandValueId:x,LabelText:h||x,Styles:{["optionText"]:{["fontFamily"]:h&&!E?"msofp_hier_MSFontService":"'Segoe UI',Tahoma,Sans-Serif;"}},AriaLabel:x})});return Object.assign(new Fh.a,{Title:CommonUIStrings.l_FontDropdownMenuSectionAll,
Id:"AllFontsDropdown",ControlList:b})}getPictureDataFromId(b){const h=this._context.tk;var n=Pd.ImageReader.Xl(h);if(this.ucm(n,h,b)&&(n=Pd.ImageReader.F3(n,ad.a.Ima,""),n.length))return Promise.resolve(n);n=new Ea.QueryStringBuilder("/we/GetImage.ashx?");n.fWb(h.node.Bi().Bs);n.Me(Ve.a.uxd,b);u.AFrameworkApplication.gja(n);n.Me(Qi.a.kmb,"1");jl.a.instance.Lub(n);n.Me(Ve.a.pvh,"true");const x=n.toString();return new Promise((E,S)=>{this.aIa.Lj(x,1,null,null,!1,2,ma=>{E(ma.data.Ee)},ma=>{S(ma.data.mf.toString())},
null)})}getPlaceholders(){const b={};b.PictureDownloading=Gl.a.Sh("progress.gif");b.PictureInvalid=Gl.a.Sh("CancelRequest.32x32x32.png");return b}getTheme(){const b=ql.PageNavigator.instance.gu(this._context.view.ud).properties.ia(ic.a.r$d,"");return 0===b.length?[]:b.split(" ").map(h=>ob.App.OYb[h])}static LAm(b){switch(b){case 0:return 10;case 1:return 15;case 2:return 50;case 3:return 100;case 4:return 200;default:return 50}}ucm(b,h,n){const x=h.node.Nc;h=Pd.ImageReader.UFd(b,x,!1);b=Pd.ImageReader.UFd(b,
x,!0);return n===h||n===b}}Object(r.a)(oH,"GraphicsEditorApp",null,[641]);class EL extends Kc.a{constructor(b,h,n,x,E){super(!1,!1,!0);this.closeEditor=()=>{this.Aph();this.dispose()};this.K9=S=>{this.Aph(2===S)};this.H6a=b;this.pEj=h;this.YGg=n;this._context=x;this.aIa=E}gVn(){return new Promise((b,h)=>{this.Zh(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle,this.K9,{["id"]:"GraphicsEditorDialog",["bootstrap"]:(n,x)=>this.Jhk(x),["onload"]:n=>{this.onLoad(n,b,h)},["editorDiscardText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogDiscardChanges,
["editorSaveText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogSave,["onReload"]:()=>{this.H6a.hmn()},["iFrameTitle"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle})})}onLoad(b,h,n){b?(this.H6a.Agk(b),h(b)):(w.ULS.sendTraceTag(573100169,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Null host"),n(null))}Jhk(b){const h=u.AFrameworkApplication.K,n=TP.a();n.loadScriptWithRetryHandler=b;const x=new oH(this.closeEditor,this._context,this.aIa),E={["bootConfig"]:Object.assign(new QP.a,
{scriptBaseUrl:fD.AppChromeOverrideUtilities.isEnabled?fD.AppChromeOverrideUtilities.GFd(u.AFrameworkApplication.lcid):u.AFrameworkApplication.r_+u.AFrameworkApplication.lcid+"/",isMLRRibbonMode:u.AFrameworkApplication.ua.Sb.Tdc}),["scriptLoader"]:new DL(new dynamicScriptLoader.DynamicScriptLoader(n)),["publicPath"]:u.AFrameworkApplication.r_,["appSettings"]:h.appSettings,["logger"]:new ml.a,["featureGateManager"]:Object.assign(new RP.a,{getBooleanFeatureGate:Object(v.a)(h,h.getBooleanFeatureGate,
"getBooleanFeatureGate"),getIntFeatureGate:Object(v.a)(h,h.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:Object(v.a)(h,h.getStringFeatureGate,"getStringFeatureGate")}),["app"]:x,["resolveScript"]:(S,ma)=>SP.a.resolveScript(S,ma)};h.$("DynamicBundlesIsEnabled")&&(E.dynamicBundlesPath=fD.AppChromeOverrideUtilities.isEnabled?fD.AppChromeOverrideUtilities.Dcc+"exp/":h.lb("StaticContentUrl")+"exp/");return new Promise((S,ma)=>{b("gc2",u.AFrameworkApplication.vw("gc2.js",5),"anonymous",5,
!1).then(()=>{S(E)}).catch(()=>{w.ULS.sendTraceTag(572915794,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Failed To Download Scripts");ma(null)})})}Aph(b){b=this.H6a.hasEdits()&&!b;this.pEj(b?this.H6a.getGraphicData():null,!!this.YGg,this.YGg,b)}}Object(r.a)(EL,"ReactGraphicsEditorDialog",Kc.a,[]);class FL{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd=!1){this.kJh=gd;this.rpb=this._context=null;this.hVn=(Gd,vd,ce,od,Yd)=>{const ne=!!Yd&&Object(pb.a)(C.a,Yd);try{if(1===ce){const Df=vd.view;
return this.hj.mda(vd)&&Df.features.j9d?32:8}this.YHj=4===(null===Yd||void 0===Yd?void 0:Yd.InputMethod)?!0:!1;ob.App.instance&&ob.App.instance.ACb&&(this.kJh||NP.a.E0b(()=>{this.kJh=!0}));w.ULS.sendTraceTag(573100171,3001,50,`Launch Graphics Editor dialog. Existing:${ne}`);performance.mark("LaunchStart");this._context=vd;this.rpb=(new EL(this.H6a,this.sEf,ne?Yd:null,vd,this.hg)).gVn().then(()=>{w.ULS.sendTraceTag(559424644,3001,50,`Graphics Editor dialog display success. Existing:${ne}`)}).catch(()=>
{this.Qyh()});if(!ne){const Df=gm=>{this.rpb.then(()=>{this.yyi(gm,!1)})};if(u.AFrameworkApplication.sessionStartInfoSettings&&"Automation"===u.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)return Df(JSON.stringify({elements:[]})),32;let Af=null;Af=ql.PageNavigator.instance.gu(vd.view.ud);const Wi=Af.properties.ia(ic.a.lJh,"");if(0<Wi.length)return Df(Wi),32;this.Fpe.dDn(vd,C.a.create(),na.a.create()).then(gm=>{const Ck=this.Hc.Rc(0,Db.a.AJc);Ck.Db(Af);Af.setValue(ic.a.lJh,gm);Ck.dispose();
Df(gm);return null}).catch(()=>{this.Qyh()})}return 32}catch(Df){return w.ULS.sendTraceTag(42328736,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",Df.toString(),ne),8}};this.LQl=(Gd,vd,ce,od,Yd)=>{if(!vd.view.features.j9d)return 32;w.ULS.sendTraceTag(574232200,3001,50,"Launch Graphics Editor: DoubleClick");this.GAh(Yd,vd);return 32};this.MQl=(Gd,vd,ce)=>{if(1===ce)return vd.view.features.j9d?32:8;if(2===ce){Gd=Pd.ImageReader.Xl(vd.tk);if(!Gd)return 2;w.ULS.sendTraceTag(574232201,
3001,50,"Launch Graphics Editor: ContextMenu");this.GAh(Gd,vd);return 32}return 2};this.yyi=(Gd,vd=!0)=>{this.H6a.setGraphicData(Gd);performance.mark("LaunchEnd");performance.measure("EditorLaunch","LaunchStart","LaunchEnd");Gd=performance.getEntriesByName("EditorLaunch");w.ULS.sendTraceTag(559424645,3001,50,`Graphics Editor dialog launched with data successfully set. Existing: ${vd} Duration: ${Gd[Gd.length-1].duration}`);performance.clearMarks("LaunchStart");performance.clearMarks("LaunchEnd");
performance.clearMeasures("EditorLaunch")};this.sEf=(Gd,vd,ce,od)=>{var Yd;this.H6a.teardown();if(vd&&this._context){var ne=this._context.view.Cb.Rg,Df=ne.node;ne.ul&&Cd.ParagraphReader.oc(Df)&&(ne=null===(Yd=this.ZO)||void 0===Yd?void 0:Yd.qF(Df),27==(null===ne||void 0===ne?void 0:ne.role)&&w.ULS.sendTraceTag(541446533,3016,50,"Editing Pull Quote using Graphics Editor. Has edits: {0}; {1}",od,od?" Everything deleted: "+(0==(null===Gd||void 0===Gd?void 0:Gd.json.length)):""))}if(od)if(w.ULS.sendTraceTag(541714E3,
3001,50,"GraphicsEditorActor: close dialog and save"),this._context)if(Gd)if(od=Gd.json,Yd=Gd.width,Df=Gd.height,od.length||vd)if(!od.length&&vd)if(vd=this._context.tk){vd=vd.node;if(Pd.ImageReader.m6(vd)){if(!this.hj.zmn(vd,new md.GraphIterator,Ai.a.instance,qL.DeleteActor.RVb)){w.ULS.sendTraceTag(588817116,3001,10,"Failed to remove anchored image.");return}}else if(!this.hj.Bbc(vd,ce,this.fb,this.FU)){w.ULS.sendTraceTag(572363225,3001,10,"Failed to remove inline image.");return}w.ULS.sendTraceTag(572363226,
3001,50,"Graphic removed thru dialog.")}else w.ULS.sendTraceTag(588886034,3001,10,"Context was in invalid state for removing existing content.");else ne=new PP.a(this._context,u.AFrameworkApplication.ua.BLa,!0,this.hj,this.Ma,ql.PageNavigator.instance),Gd=na.a.create(),ce=new RK.a(ne,od,this.dJ,this.sm,Gd,Zm.a.instance,vd,ce,this.hj,this.nm,Yd,Df,this.Ma,this.FU,this.wc,ob.App.instance.ACb,ob.App.instance.elf),this.Fpe.lVf(ce,this._context,vd,Gd),this.E3(),this.YHj&&this.A9n();else w.ULS.sendTraceTag(541714001,
3001,50,"Empty Json on new content creation when close dialog");else w.ULS.sendTraceTag(577868244,3001,10,"JSON was unexpectedly null and the model did change!");else w.ULS.sendTraceTag(590205069,3001,10,"GraphicsEditorActor: context cannot be null")};this.ga=b;this.Ma=h;this.Fpe=n;this.hj=x;this.dJ=E;this.sm=S;this.H6a=new CL;this.Hc=Fa;this.fb=$a;this.FU=sb;this.nm=Jb;this.wc=oc;this.hg=Sb;this.ZO=Ic}Vb(){let b=!0;this.Ma.$("GraphicsEditorActorRegistrationUpdateIsEnabled")||(b=this.wc&&this.wc.isFeatureEnabled(51));
b&&!V.a.zk&&(this.ga.gb(ub.a.graphicsEditor,cc.a.view,this.hVn,4),this.ga.gb(Db.a.r4e,cc.a.view,this.LQl,4),this.ga.gb(ub.a.IAh,cc.a.view,this.MQl,4))}Qyh(){const b=new yd.StandardDialog;b.Ed=0;b.fy(ri.a.g4e,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError,null);ob.App.xa.updateCommandUI()}GAh(b,h){var n=b.ia(Ji.a.d3,1);const x=b.ia(Th.a.wZ,0);n&&1!==x?b.ia(ic.a.fph,!1)?(h=new yd.StandardDialog,h.Ed=0,h.fy(ri.a.g4e,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,
WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError,null,!0),ob.App.xa.updateCommandUI(),w.ULS.sendTraceTag(521426528,3001,15,"{0}",{["message"]:"Graphic already known to have unsupported properties",["id"]:Pd.ImageReader.kdb(b)})):(this.ga.Xb(ub.a.graphicsEditor,2,b.id),this.rpb||(w.ULS.sendTraceTag(574997639,3001,10,"GraphicsEditorDialogInitialization promise was null!"),this.rpb=new Promise(E=>{E(null)})),n=na.a.create(),b=new BL(b,this.yyi,Zm.a.instance,this.rpb,this.nm,this.Ma,
this.wc,ob.App.instance.nta(this.nm.tl(b))),this.Fpe.lVf(b,h,!0,n)):w.ULS.sendTraceTag(573055959,3001,50,"Graphics Editor launch diverted since Box4 model is not ready!")}E3(){const b=Oa.a.instance.Za("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordWebDrawing","WordDrawingFloodgateIsEnabled")}):w.ULS.sendTraceTag(572352085,3001,10,"ISystemInitiatedFeedback was null")}A9n(){const b=Oa.a.instance.Za("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordPenNsatSurvey",
"WordPenNsatSurveyIsEnabled")}):w.ULS.sendTraceTag(520382472,3001,10,"ISystemInitiatedFeedback was null")}}Object(r.a)(FL,"GraphicsEditorActor",null,[]);var TF=d(529);class GL{constructor(b,h,n){this.NRa="wwaengidc";this.$7c="CreateLinkForHeading";this.Ayj="CreateLinkForHeadingAction";this.GAj="\ufffc";this.zRa=b;this.ga=h;this.fb=n}Vb(){this.ga.pa(ub.a.ZBc,cc.a.paragraph,this.q_e.bind(this));this.ga.pa(ub.a.ZBc,cc.a.Fd,this.q_e.bind(this));this.ga.pa(ub.a.ZBc,cc.a.Wc,this.q_e.bind(this));this.ga.Vc(ub.a.ZBc,
1028)}q_e(b,h,n){if(u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.HeadingDeeplinkIsEnabled",!1)){b=h.node;if(1===n)return this.Eci(b)?32:8;this.Yfn(this.$7c,this.Ayj);if(!this.Eci(b))return w.ULS.sendTraceTag(528815444,3029,50,"User is trying to create sharable link for a non-heading text"),8;n=b.getValue(ic.a.Mc);if(!n)return w.ULS.sendTraceTag(528815445,3029,10,"Word id does not exist for the paragraph"),n=new Map,n.set("Source",this.$7c),
n=Object.assign(new ab.a,{additionalValues:n}),ta.Health.instance.recordKpiFailure(this.$7c,"Unable to create sharable link as paragraph id is missing",!1,!0,n),8;n=String.format('{{"{0}":"{1}"}}',TF.a.heading,n);b={};b.nav=btoa(n);b.mode="copy";this.ga.Xb(Ra.a.icb,2,b);return 32}return 8}Eci(b){return!this.fb.oc(b)||this.fb.cNc(b)||this.fb.FNd(b)||b.Pr||""===b.characterData||b.characterData===this.GAj||!this.zRa.TEd(b)?!1:!0}Yfn(b,h){const n=new Map;n.set("Source",this.$7c);n.set("Action",h);ta.Health.instance.recordKpiUsage(b,
0,this.NRa,n)}}Object(r.a)(GL,"HeadingsActor",null,[]);class HL{nSn(b){return Cd.ParagraphReader.zra(this.ZPh(b))}oZc(b,h,n){if(b=Cd.ParagraphReader.jdb(this.ZPh(b)))h=b.De(h),Object(pb.a)(603,h)&&(Is.k(b)?h.TMn(n):h.oZc())}ZPh(b){return b&&b.ul&&b?b.node:null}}Object(r.a)(HL,"IFrameFocusStrategy",null,[604]);class IL{constructor(b){this.Ctb=null;this.nbd=b}Sli(){w.ULS.sendTraceTag(25007835,375,50,"Ignore all spelling error triggered")}Ccj(b){if(!b)return w.ULS.sendTraceTag(25007836,375,15,"Error range is null"),
!1;if(!b.errorDetails)return w.ULS.sendTraceTag(25007837,375,15,"No error detail found"),!1;if(!b.errorDetails.token)return w.ULS.sendTraceTag(25007838,375,50,"Ignore-all: Token is null and the ErrorDetails type is {0}",Object.getType(b.errorDetails).toString()),!1;this.Ctb=B.a.D$d(b.errorDetails.token,b.errorDetails.lcid);this.nbd.add(this.Ctb,b.errorDetails.lcid);return!0}K6d(b){return b?b.token?B.a.D$d(b.token,b.lcid)===this.Ctb:(w.ULS.sendTraceTag(25007840,375,15,"ErrorDetails Token is null"),
!1):(w.ULS.sendTraceTag(25007839,375,15,"ErrorDetails is null during ignore-all operation"),!1)}}Object(r.a)(IL,"IgnoreAllProofingErrorStrategy",null,[602]);var UP=d(1353),JL=d(541);class KL{constructor(b,h){this.filename=b;this.blob=h}}Object(r.a)(KL,"UploadBlobParameters",null,[]);class LL extends Yk{constructor(b,h,n,x,E,S,ma,Fa=null){super(b,h,n,null,E,S,!1);this.dJj="DragAndDrop";this.ICg="FileName";this.LCg=0;this.Z2g=null;this.Zbe=this.y_b=!1;this.SAg=x;this.GUg=Fa}get A2(){return this.dJj}get fileExtension(){return this.ICg}get fileSize(){return this.LCg}get Chj(){return this.Z2g}B0c(b){const h=
new KL(this.SAg.name,this.SAg);b.u7i(h);this.Z2g=b.P9a}AKa(b,h){this.GUg&&this.GUg();super.AKa(b,h)}dno(b){const h=!!b&&this.Vva(b.name,null)&&this.I8f(b,null);b&&(this.ICg=b.name,this.LCg=b.size);h||this.fSd();return h}}Object(r.a)(LL,"DragDropInsertImageUploader",Yk,[]);class yt{constructor(b,h,n,x,E){this.kTd=this.lTd=this.FTd=this.GTd=0;this.ga=null;this.Y3e=(S,ma,Fa)=>{if(ob.App.wyd)return 8;S=ma.node;return 1===Fa?S?32:2:2===Fa?(Fa=Pd.ImageReader.Xl(ma),ma=Pd.ImageReader.jIc(Fa,ma.node.Bi().Ad,
u.AFrameworkApplication.K,u.AFrameworkApplication.ua.BLa),qx(ma),32):2};this.u4l=(S,ma,Fa)=>{const $a=this.hj.mda(ma);if(2===Fa&&$a){if(Db.a.fQ===S||Db.a.jtd===S)u.AFrameworkApplication.Kta?u.AFrameworkApplication.u_f():this.vKk(ma);return 32}return 1!==Fa||Db.a.fQ!==S&&Db.a.jtd!==S?2:$a?32:2};this.OBb=(S,ma,Fa,$a,sb)=>this.hj.mda(ma)?1===Fa?32:this.hj.Nmf(ma,sb)?32:2:2;this.pMn=()=>{if(this.hb&&this.hb.ib&&this.hb.ib.kb){const S=this.hb.ib.kb.Qa;S&&this.hb.setSelection(Ae.SelectionFactory.xe(S.node,
S.cpBegin))}};this.vYk=(S,ma,Fa,$a,sb)=>{w.ULS.sendTraceTag(42530333,307,50,"Drag and drop local content");if((S=sb.DataTransfer)&&S.files&&0<S.files.length){w.ULS.sendTraceTag(578380440,307,50,String.format("{0} files to drop",S.files.length));for(Fa=0;Fa<S.files.length;Fa++)$a=S.files[Fa],0<=B.a.mh($a.type).indexOf("image")&&this.J3l($a,ma)&&($a=this.hb.ib.kb.Qa,this.hb.setSelection(Ae.SelectionFactory.xe($a.node,$a.cpBegin+1)));this.mFa();return 32}w.ULS.sendTraceTag(42530334,307,15,"Drag and drop local content not handled");
return 2};this.O2m=(S,ma,Fa,$a,sb)=>{if(2===Fa)return u.AFrameworkApplication.ya.Qf(ma.tk,S,Fa,!0,$a,sb);if(!ma.view.Be)return this.kac(!1),8;S=ma.view;if(!S.Cb)return this.kac(!1),8;S=yt.Tg.kP(S.Cb.Rg);if(1!==S.length)return this.kac(!1),8;if(this.kN(S[0]))return this.dym(),this.kac(!0),32;this.kac(!1);return 8};this.FPl=(S,ma,Fa)=>{if(!this.kN(ma))return 8;const $a=Pd.ImageReader.Xl(ma),sb=Pd.ImageReader.nA($a),Jb=Pd.ImageReader.zB($a);S=S===Db.a.eJd;w.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",
{["IsGrow"]:S});if(1===Fa)return this.Ue.k2||Pd.ImageReader.MZa($a)?2:S&&sb<this.lTd&&Jb<this.kTd||!S&&sb>this.GTd&&Jb>this.FTd?32:2;Fa=S?1.1:.9;this.setSize($a,ma,sb*Fa,Jb*Fa,!0);return 32};this.Sac=(S,ma,Fa,$a,sb)=>{if(!this.Gya(ma))return 8;S=Pd.ImageReader.Xl(ma);ma=Pd.ImageReader.hLa(S);Fa=Pd.ImageReader.gLa(S);if(0>=ma||0>=Fa)return 2;S=Pd.ImageReader.nA(S)/ma*100;sb.setValue(ad.a.dLc,S);return 32};this.w4b=(S,ma,Fa,$a,sb)=>{if(!this.Gya(ma))return 8;S=Pd.ImageReader.Xl(ma);if(1===Fa)return this.Ue.k2||
Pd.ImageReader.MZa(S)?2:32;w.ULS.sendTraceTag(20459937,322,50,"Change image scale.");Fa=sb.ia(ad.a.dLc,-1)/100;$a=sb.ia(ad.a.k5h,!1);const Jb=sb.ia(ad.a.Xkf,!0);sb=sb.ia(ad.a.Ykf,!0);if(0>=Fa)return yt.Lc.Yb(Gc.a.Mm,{["Reason"]:Mc.a.ZBb}),2;const Sb=Pd.ImageReader.hLa(S),oc=Pd.ImageReader.gLa(S),Ic=Pd.ImageReader.nA(S),gd=Pd.ImageReader.zB(S);if(0>=Sb||0>=oc)return yt.Lc.Yb(Gc.a.J_,{["Reason"]:Mc.a.ZBb}),2;$a?($a=Jb?Fa*Ic:Ic,Fa=sb?Fa*gd:gd):($a=Jb?Fa*Sb:Ic,Fa=sb?Fa*oc:gd);this.setSize(S,ma,$a,Fa);
Of.a.instance.J(4)&&ob.App.rd.Kp&&ob.App.rd.Jq.sG(ma.node);this.mFa();return 32};this.fHb=(S,ma,Fa,$a,sb)=>{if(!this.kN(ma))return 8;S=Pd.ImageReader.Xl(ma);S=Pd.ImageReader.zB(S);if(0>=S)return 2;sb.setValue(ad.a.iBa,S);return 32};this.iBa=(S,ma,Fa,$a,sb)=>{if(!this.Gya(ma))return 8;S=Pd.ImageReader.Xl(ma);if(1===Fa)return this.Ue.k2||Pd.ImageReader.MZa(S)?2:32;w.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");Fa=sb.ia(ad.a.iBa,0);sb=Pd.ImageReader.KZa(S);if(0>=Fa)return yt.Lc.Yb(Gc.a.Mm,
{["Reason"]:Mc.a.ZBb}),2;$a=Pd.ImageReader.hLa(S);const Jb=Pd.ImageReader.gLa(S),Sb=Pd.ImageReader.nA(S);var oc=Pd.ImageReader.zB(S);oc=Sb/oc;if(0>=$a||0>=Jb)if(yt.Lc.Yb(Gc.a.J_,{["Reason"]:Mc.a.ZBb}),this.B1i(S))return 2;this.setSize(S,ma,sb?Fa*oc:Sb,Fa);Of.a.instance.J(4)&&ob.App.rd.Kp&&ob.App.rd.Jq.sG(ma.node);ob.App.xa.updateCommandUI();return 32};this.gHb=(S,ma,Fa,$a,sb)=>{if(!this.kN(ma))return 8;S=Pd.ImageReader.Xl(ma);S=Pd.ImageReader.nA(S);if(0>=S)return 2;sb.setValue(ad.a.jBa,S);return 32};
this.jBa=(S,ma,Fa,$a,sb)=>{if(!this.Gya(ma))return 8;S=Pd.ImageReader.Xl(ma);if(1===Fa)return this.Ue.k2||Pd.ImageReader.MZa(S)?2:32;w.ULS.sendTraceTag(20459939,322,50,"Change image absolute width.");Fa=sb.ia(ad.a.jBa,0);sb=Pd.ImageReader.KZa(S);if(0>=Fa)return yt.Lc.Yb(Gc.a.Mm,{["Reason"]:Mc.a.ZBb}),2;$a=Pd.ImageReader.hLa(S);const Jb=Pd.ImageReader.gLa(S);var Sb=Pd.ImageReader.nA(S);const oc=Pd.ImageReader.zB(S);Sb=oc/Sb;if(0>=$a||0>=Jb)if(yt.Lc.Yb(Gc.a.J_,{["Reason"]:Mc.a.ZBb}),this.B1i(S))return 2;
this.setSize(S,ma,Fa,sb?Fa*Sb:oc);Of.a.instance.J(4)&&ob.App.rd.Kp&&ob.App.rd.Jq.sG(ma.node);ob.App.xa.updateCommandUI();return 32};this.iHb=(S,ma,Fa,$a,sb)=>{if(!this.kN(ma))return 8;S=Pd.ImageReader.Xl(ma);S=Pd.ImageReader.KZa(S);sb.setValue(ad.a.HW,S);return 32};this.HW=(S,ma,Fa,$a,sb)=>{if(!this.kN(ma))return 8;S=Pd.ImageReader.Xl(ma);if(1===Fa&&this.Ue.k2)return 2;Of.a.instance.J(4)&&ob.App.rd.Kp&&ob.App.rd.Jq.sG(ma.node);sb&&(ma=sb.ia(ad.a.HW,!0),w.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),
this.hj.LXi(S,ma),ob.App.xa.updateCommandUI());return 32};this.f1a=(S,ma,Fa,$a,sb)=>{if(!this.kN(ma))return 8;S=Pd.ImageReader.Xl(ma);S=Pd.ImageReader.tW(S);sb.setValue(ad.a.ueb,S);return 32};this.ueb=(S,ma,Fa,$a,sb)=>{if(!this.kN(ma))return 8;if(1===Fa)return this.Ue.k2?2:32;if(Of.a.instance.J(4)&&ob.App.rd.Kp&&(S=ma.node.ia(Ji.a.gK,Ll.a.Bq),S!==Ll.a.Bq&&(S=ob.App.rd.Jq.pdb(S),JL.CoauthLockEditor.getInstance().s2a(S))))return yt.Lc.Yb(Gc.a.Mm,{["Reason"]:Mc.a.UD}),2;S=Pd.ImageReader.Xl(ma);sb=sb.ia(ad.a.ueb,
null);this.hj.FIn(S,ma,sb);w.ULS.sendTraceTag(21297027,322,50,"Change image alt text.");this.Rd.us(13);return 32};this.e1a=(S,ma,Fa,$a,sb)=>{if(!this.kN(ma))return 8;S=Pd.ImageReader.Xl(ma);S=Pd.ImageReader.dLa(S);sb.setValue(ad.a.GW,S);return 32};this.GW=(S,ma,Fa,$a,sb)=>{if(!this.kN(ma))return 8;if(1===Fa)return this.Ue.k2?2:32;if(Of.a.instance.J(4)&&ob.App.rd.Kp&&(S=ma.node.ia(Ji.a.gK,Ll.a.Bq),S!==Ll.a.Bq&&(S=ob.App.rd.Jq.pdb(S),JL.CoauthLockEditor.getInstance().s2a(S))))return yt.Lc.Yb(Gc.a.Mm,
{["Reason"]:Mc.a.UD}),2;S=Pd.ImageReader.Xl(ma);sb=sb.ia(ad.a.GW,null);this.hj.EIn(S,ma,sb);w.ULS.sendTraceTag(21297029,322,50,"Change image alt text description.");this.Rd.us(13);return 32};this.hj=b;this.Cm=h;this.Rd=n;this.vi=x;this.hb=E}get Ue(){return Nd.PageReader.instance}get S9(){return this.Cm.instance}get Ac(){return this.ga}g2l(){this.GTd=mf.a.jn(1,0);this.FTd=mf.a.jn(1,1);this.lTd=mf.a.jn(1920,0);this.kTd=mf.a.jn(1280,1)}Vb(b){this.ga=b;const h=this.O2m,n=this.u4l,x=this.OBb,E=this.FPl;
b.gb(Db.a.fQ,cc.a.view,n,1284);b.pa(Db.a.OBb,cc.a.Wc,x);b.pa(Db.a.OBb,cc.a.image,x);b.Vc(Db.a.OBb,1284);b.gb(Db.a.jtd,cc.a.view,n,1284);b.gb(Db.a.CUe,cc.a.view,h,1028);this.Nq(b,Db.a.eJd,E);this.Nq(b,Db.a.K_f,E);this.Nq(b,Db.a.Sac,this.Sac);this.Nq(b,Db.a.fHb,this.fHb);this.Nq(b,Db.a.gHb,this.gHb);this.Nq(b,Db.a.f1a,this.f1a);this.Nq(b,Db.a.e1a,this.e1a);this.Nq(b,Db.a.w4b,this.w4b);this.Nq(b,Db.a.s5d,this.iBa);this.Nq(b,Db.a.t5d,this.jBa);this.Nq(b,Db.a.sZc,this.ueb);this.Nq(b,Db.a.YIb,this.GW);
this.Nq(b,Db.a.iHb,this.iHb);this.Nq(b,Db.a.HW,this.HW);this.Nq(b,Db.a.Y3e,this.Y3e);b.gb(Db.a.uAh,cc.a.view,this.vYk,4);b.Vc(Db.a.eJd,4);b.Vc(Db.a.K_f,4);b.Vc(Db.a.Sac,69);b.Vc(Db.a.fHb,69);b.Vc(Db.a.gHb,69);b.Vc(Db.a.iHb,69);b.Vc(Db.a.f1a,69);b.Vc(Db.a.e1a,69);b.Vc(Db.a.HW,4);b.Vc(Db.a.w4b,4);b.Vc(Db.a.s5d,4);b.Vc(Db.a.t5d,4);b.Vc(Db.a.sZc,4);b.Vc(Db.a.YIb,4);this.g2l()}Nq(b,h,n){b.pa(h,cc.a.image,n);b.pa(h,cc.a.Ryb,n);b.pa(h,cc.a.Fd,n);b.pa(h,cc.a.anchoredObject,n)}vKk(b){new Yk(b,Ye.a.instance,
u.AFrameworkApplication.K,null,this.vi,this.ga)}lno(b){return this.Ue.k2?(yt.Lc.Yb(Gc.a.Mm,{["Reason"]:Mc.a.compatMode}),!1):this.ga&&3!==this.ga.mode?(yt.Lc.Yb(Gc.a.Mm,{["Reason"]:Mc.a.S4k}),!1):yt.Zf.bZ(b)?(yt.Lc.Yb(Gc.a.Mm,{["Reason"]:Mc.a.UD}),!1):this.S9&&this.S9.vT(b)?(yt.Lc.Yb(Gc.a.Mm,{["Reason"]:Mc.a.externalSelection}),!1):!0}ycm(b){const h=Pd.ImageReader.Xl(b);return h&&5===Pd.ImageReader.tl(h)&&this.Eai(b,h)}Eai(b,h){(h=!Pd.ImageReader.n2b(h)&&!Pd.ImageReader.XNd(h))||yt.Lc.Yb(Gc.a.Mm,
{["Reason"]:Mc.a.mph});return h&&this.lno(b)}J3l(b,h){h=new LL(h,Ye.a.instance,u.AFrameworkApplication.K,b,this.vi,this.ga,this.hb,this.pMn);if(!h.dno(b))return ta.Health.instance.recordQosError("PictureDragDropInvalid",["ImageInsertFailed"],!0,!0,!1,!1,null),w.ULS.sendTraceTag(578380439,307,50,"The file is not supported"),!1;new Fm.a(document.body,Object(v.a)(h,h.v$b,"onUploadFrameInitialized"),Object(v.a)(h,h.Ova,"uploadResponseReceived"),u.AFrameworkApplication.K,!1,void 0,ek.a(u.AFrameworkApplication.K));
return!0}kN(b){return this.ycm(b)}Gya(b){const h=Pd.ImageReader.Xl(b);if(!h)return!1;const n=Oa.a.instance.Pa("Box4.IFeatureHelper"),x=Pd.ImageReader.tl(h);return 5===x||10===x||48===x||11===x||n&&n.isFeatureEnabled(51)&&4===x?this.Eai(b,h):!1}setSize(b,h,n,x,E=!1){Of.a.instance.J(4)&&ob.App.rd.Kp&&ob.App.rd.Jq.sG(h.node);const S=Pd.ImageReader.KZa(b);let ma=1;n>this.lTd?ma=this.lTd/n:n<this.GTd&&(ma=this.GTd/n);let Fa=1;x>this.kTd?Fa=this.kTd/x:x<this.FTd&&(Fa=this.FTd/x);if(S||E)ma=Math.min(ma,
Fa),Fa=Math.min(ma,Fa);1!==ma&&(n*=ma);1!==Fa&&(x*=Fa);this.A3e(b,h,n,x)}A3e(b,h,n,x){this.hj.tZi(b,h,n,x)}dym(){w.ULS.sendTraceTag(20459969,322,50,"PictureTools Tab enabled.")}mFa(){u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Oa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}B1i(b){const h=Pd.ImageReader.hLa(b);
b=Pd.ImageReader.gLa(b);return 0>=h||0>=b}kac(){}static get Tg(){return Rl.ContextSetEditor.instance}static get Zf(){return Ai.a.instance}static get Lc(){return vb.a.instance}}Object(r.a)(yt,"ImageActor",null,[]);var pH=d(1126),qH=d(1127),UF=d(680),ML=d(530),VP=d(483),WP=d(1432);class Xt extends yt{constructor(b,h,n,x,E,S,ma,Fa){super(b,h,x,S,ma);this.gOg=!1;this.F8=null;this.vrb=!1;this.Ehb=()=>{this.Dh.Fbc(this.Ehb);this.vrb=!1;const $a=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&
0<=Array.indexOf($a,"Picture")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Picture"))};this.Qv=($a,sb,Jb,Sb,oc)=>{if(!this.kN(sb))return 8;if(1===Jb)return this.Ue.k2?2:32;$a=parseInt(oc);w.ULS.sendTraceTag(593372312,322,50,"SetPictureStyle: "+$a);this.Vjd.ubn(sb,Pd.ImageReader.Xl(sb),$a);this.mQc(sb);this.mFa();return 32};this.i3d=($a,sb,Jb)=>{if(!this.kN(sb))return 8;w.ULS.sendTraceTag(593372311,322,50,"Applying Style Reset");$a=Pd.ImageReader.Xl(sb);if(1===Jb)return this.Ue.k2?2:32;
Jb=Pd.ImageReader.ldb($a);1===Jb?(Jb=new Se.GraphTransaction(15),Jb.Db(sb.node),Pd.ImageReader.n5b()?$a.setValue(ic.a.tGb,""):this.pJ.jnn($a),Jb.dispose(),this.Ltc.create($a,sb).Qv(vc.a.ZPi),this.mQc(sb)):2===Jb&&this.Ltc.create($a,sb).Qv(vc.a.ZPi);return 32};this.lRl=($a,sb,Jb,Sb,oc)=>{if(!this.kN(sb))return 8;$a=Pd.ImageReader.Xl(sb);if(1===Jb)return this.Ue.k2||Pd.ImageReader.a6b($a)?2:32;oc&&(this.pJ.A1c($a,sb),w.ULS.sendTraceTag(22381021,322,50,"Toggled Image Crop Mode"),ob.App.xa.updateCommandUI());
this.mFa();return 32};this.mRl=($a,sb,Jb,Sb,oc)=>{if(!this.kN(sb))return 8;if(1===Jb)return this.Ue.k2?2:32;$a=Pd.ImageReader.Xl(sb);if(oc){Jb=Pd.ImageReader.GMd(Pd.ImageReader.Xl(sb));w.ULS.sendTraceTag(22381022,322,50,"Applying New Image Cropping, isCanvas: "+Jb);Sb=oc.ia(ad.a.Aeb,0);const Ic=oc.ia(ad.a.xeb,0),gd=oc.ia(ad.a.yeb,0);oc=oc.ia(ad.a.zeb,0);const Gd=Pd.ImageReader.Xka($a),vd=Pd.ImageReader.Uka($a),ce=Pd.ImageReader.Vka($a),od=Pd.ImageReader.Wka($a);if(Sb===Gd&&Ic===vd&&gd===ce&&oc===
od)return w.ULS.sendTraceTag(23070480,322,50,"Cropping Properties were the same as before, no need to update."),32;Jb?(new pH.a($a,new qH.a)).uGn(Sb,Ic,gd,oc,this.fPm,sb):this.Vjd.jbn(sb,Pd.ImageReader.Xl(sb),Sb,Ic,gd,oc);this.mQc(sb);ob.App.xa.updateCommandUI()}return 32};this.mJd=($a,sb,Jb,Sb,oc)=>{if(!this.kN(sb))return 8;Sb=Pd.ImageReader.Xl(sb);if(1===Jb)return this.Ue.k2||Pd.ImageReader.a6b(Sb)?2:32;if(oc){w.ULS.sendTraceTag(22552775,322,50,"Getting New Image Cropping From Spinners on Format Picture Pane");
this.pJ.mta()||this.pJ.A1c(Sb,sb);switch($a){case ub.a.WKc:$a=oc.ia(ad.a.Aeb,-1);Jb=0;break;case ub.a.PKc:$a=oc.ia(ad.a.xeb,-1);Jb=1;break;case ub.a.QKc:$a=oc.ia(ad.a.yeb,-1);Jb=2;break;case ub.a.RKc:$a=oc.ia(ad.a.zeb,-1);Jb=3;break;default:return 8}this.pJ.Xgo($a,Jb);this.mQc(sb);ob.App.xa.updateCommandUI()}return 32};this.Pib=($a,sb,Jb,Sb,oc)=>{if(!this.kN(sb))return 8;Pd.ImageReader.Xl(sb);oc&&($a=this.pJ.mta(),oc.setValue(ad.a.mta,$a));return 32};this.Rac=($a,sb,Jb,Sb,oc)=>{if(!this.kN(sb))return 8;
sb=Pd.ImageReader.Xl(sb);if(oc){if(this.pJ.mta())({top:gd,bottom:Jb,left:$a,right:sb}=this.pJ.rml());else{Sb=mf.a.yf(Pd.ImageReader.nA(sb),0);var Ic=mf.a.yf(Pd.ImageReader.zB(sb),1);var gd=Math.max(Pd.ImageReader.Xka(sb),0);Jb=Math.max(Pd.ImageReader.Uka(sb),0);$a=Math.max(Pd.ImageReader.Vka(sb),0);sb=Math.max(Pd.ImageReader.Wka(sb),0);Sb=1E5*Sb/(1E5-($a+sb));Ic=1E5*Ic/(1E5-(gd+Jb));gd=Math.floor(gd*Ic/1E5);Jb=Math.floor(Jb*Ic/1E5);$a=Math.floor($a*Sb/1E5);sb=Math.floor(sb*Sb/1E5)}oc.setValue(ad.a.Aeb,
gd);oc.setValue(ad.a.xeb,Jb);oc.setValue(ad.a.yeb,$a);oc.setValue(ad.a.zeb,sb)}return 32};this.E3b=($a,sb,Jb,Sb,oc)=>{if(!this.kN(sb))return 8;if(1===Jb){if(this.Ue.k2)return 2;this.GAm();return 32}$a=Pd.ImageReader.Xl(sb);this.pJ.mta()&&this.pJ.A1c($a,sb);$a=oc.ia(ad.a.cEa,"");oc=oc.ia(ad.a.h4a,0);w.ULS.sendTraceTag(20459970,322,50,"SetWrapTextAction: {0}",{["Type"]:oc,["SourceControlId"]:$a});switch(oc){case 1:this.pJ.oNn(sb);break;case 8:this.pJ.n6d(sb,1,1);break;case 9:this.pJ.n6d(sb,1,3);break;
case 3:this.pJ.n6d(sb,2,void 0,!0);break;case 4:this.pJ.n6d(sb,2,void 0,!1)}this.mFa();ob.App.xa.updateCommandUI();return 32};this.hbc=($a,sb,Jb,Sb,oc)=>{if(!this.kN(sb))return 8;$a=Pd.ImageReader.Xl(sb);sb=Pd.ImageReader.I$(sb);Jb=Pd.ImageReader.n6($a);Sb=Pd.ImageReader.bJc($a);$a=Pd.ImageReader.Ev($a);return this.hbn(sb,Jb,Sb,$a,oc)?32:8};this.oRl=($a,sb,Jb,Sb,oc)=>{if(!this.Gya(sb))return 8;Sb=Pd.ImageReader.Xl(sb);if(1===Jb)return Vh.SessionStatusManager.instance.Qj?8:this.Ue.k2||Pd.ImageReader.c6b(Sb)?
2:32;this.pJ.mta()&&this.pJ.A1c(Sb,sb);if(oc){var Ic=oc.ia(ad.a.aLc,0);const gd=Pd.ImageReader.GMd(Sb);w.ULS.sendTraceTag(22052889,322,50,"SetImageRotateAction: {0}, isCanvas: {1}",Ic,gd);Jb=Pd.ImageReader.oZ(Sb);let Gd=Pd.ImageReader.$Ed(Sb),vd=Pd.ImageReader.Ozb(Sb);switch(Ic){case 0:Jb=oc.ia(ad.a.YJ,0);break;case 2:Jb-=90;Jb=bj.c(Jb);break;case 1:Jb+=90;Jb=bj.c(Jb);break;case 4:Gd=!Gd;break;case 3:vd=!vd;break;case 5:Jb+=oc.ia(ad.a.YJ,0),Jb=bj.c(Jb)}gd?(new pH.a(Sb,new qH.a)).PLn(Jb,Gd,vd,this.KUm,
sb):Ic?this.Ltc.create(Sb,sb).$Kn(Jb,Gd,vd):(oc=na.a.create(),Ic=new Se.GraphTransaction(15,Db.a.imageRotate),Ic.Db(sb.node),this.pJ.OIn(Sb,Jb),this.Vjd.qbn(sb,Pd.ImageReader.Xl(sb),Jb,oc),Ic.tCa(oc,1),Ic.zl=$a,Ic.dispose());this.mFa();this.mQc(sb);ob.App.xa.updateCommandUI()}return 32};this.hHb=($a,sb,Jb,Sb,oc)=>{if(!this.kN(sb))return 8;$a=Pd.ImageReader.Xl(sb);$a=Pd.ImageReader.oZ($a);if(0>$a)return 2;oc.setValue(ad.a.YJ,$a);return 32};this.KUm=($a,sb,Jb,Sb)=>{if($a){const oc=new Se.GraphTransaction(15,
Db.a.imageRotate);oc.Db(Sb.node);sb.setValue(ad.a.lYb,JSON.stringify(Jb));sb.setValue(ad.a.Bu,$a);this.pJ.w5d(sb,Jb.rotationAngle,Jb.g4b,Jb.lhc);this.ezb(sb);oc.dispose()}};this.wUm=($a,sb,Jb,Sb)=>{if($a){const oc=new Se.GraphTransaction(15);oc.Db(Sb.node);sb.setValue(ad.a.lYb,JSON.stringify(Jb));sb.setValue(ad.a.Bu,$a);this.pJ.g5d(sb,Jb.Pae,Jb.r2c);this.ezb(sb);oc.dispose()}};this.fPm=($a,sb,Jb,Sb)=>{if($a){const oc=new Se.GraphTransaction(15);oc.Db(Sb.node);sb.setValue(ad.a.lYb,JSON.stringify(Jb));
sb.setValue(ad.a.Bu,$a);this.pJ.IIn(sb,Math.round(Jb.yza*UF.a.Vab),Math.round(Jb.vza*UF.a.Vab),Math.round(Jb.wza*UF.a.Vab),Math.round(Jb.xza*UF.a.Vab));this.ezb(sb);oc.dispose()}};this.rUc=($a,sb,Jb,Sb,oc)=>{if(!this.Gya(sb))return 8;if(1===Jb)return 32;$a=sb.contextId===cc.a.view?Nd.PageReader.instance.aGd(sb):ql.PageNavigator.instance.gu(sb.node);if(!$a)return 8;Jb=Pd.ImageReader.Xl(sb);sb=this.vo.YUh(Bm.a.dT(sb),Jb);Xt.iDi.Ncc=sb;sb=Xt.iDi.RCd($a,ob.App.OYb);if(!sb)return 8;oc.MenuItems=sb;return 32};
this.o7=($a,sb,Jb,Sb,oc)=>{if(!this.Gya(sb))return 8;if((Sb=Pd.ImageReader.Xl(sb))&&Pd.ImageReader.Sx(Sb))return 2;if(1===Jb)return 32;if(2!==Jb)return 2;if(!oc)return w.ULS.sendTraceTag(571287758,322,10,"SetPictureBorderColor: actionData null"),8;Jb=new Se.GraphTransaction(15);Jb.Db(sb.node);const Ic=Xt.Ifc.Zya(sb.node,oc);this.vo.o7(Sb,oc,sb,Ic);this.ezb(Sb);Jb.dispose();$a==Db.a.DZc&&this.recentColors.g$a(oc);this.a5c();this.mFa();return 32};this.Efa=($a,sb,Jb)=>{if(!this.Gya(sb))return 8;if(1===
Jb)return 32;ob.App.xa.Vu();Xt.m5a=new Rv.a("PictureBorder",Db.a.DZc);Xt.m5a.E_c(0);return 32};this.wga=($a,sb,Jb,Sb,oc)=>{if(!this.Gya(sb))return 8;if(1===Jb)return 32;if(($a=Pd.ImageReader.Xl(sb))&&Pd.ImageReader.Sx($a))return 2;if(!oc)return w.ULS.sendTraceTag(571287759,322,10,"SetPictureBorderWeight: actionData null"),8;Jb=new Se.GraphTransaction(15);Jb.Db(sb.node);this.vo.wga($a,oc,sb);this.ezb($a);Jb.dispose();this.a5c();this.mFa();return 32};this.l2a=($a,sb,Jb,Sb,oc)=>{if(!this.Gya(sb))return 8;
if(1===Jb)return 32;if(($a=Pd.ImageReader.Xl(sb))&&Pd.ImageReader.Sx($a))return 2;if(!oc)return w.ULS.sendTraceTag(571287760,322,10,"SetPictureBorderStyle: actionData null"),8;Jb=new Se.GraphTransaction(15);Jb.Db(sb.node);this.vo.l2a($a,oc,sb);this.ezb($a);Jb.dispose();this.a5c();this.mFa();return 32};this.q2d=($a,sb,Jb)=>{if(!this.Gya(sb))return 8;if(1===Jb)return 32;$a=Pd.ImageReader.Xl(sb);Jb=new Se.GraphTransaction(15);Jb.Db(sb.node);Pd.ImageReader.Q3b($a)&&(this.vo.q2d($a),this.ezb($a));Jb.dispose();
this.a5c();this.mFa();return 32};this.pJ=b;this.Ltc=n;this.Vjd=E;this.Dh=Fa}get recentColors(){return null!=this.jog?this.jog:this.jog=Oa.a.instance.Pa("Box4.UI.RecentColorsSectionHandler")}get vo(){this.F8||(this.F8=new ML.a);return this.F8}Vb(b){super.Vb(b);this.Nq(b,Db.a.Qv,this.Qv);b.Vc(Db.a.Qv,4);this.Nq(b,Db.a.i3d,this.i3d);this.Nq(b,ub.a.$ce,this.E3b);b.Vc(ub.a.$ce,4);this.Nq(b,ub.a.ade,this.E3b);this.Nq(b,ub.a.bde,this.E3b);this.Nq(b,ub.a.cde,this.E3b);this.Nq(b,ub.a.dde,this.E3b);this.Nq(b,
ub.a.ede,this.E3b);this.Nq(b,ub.a.hbc,this.hbc);b.Vc(ub.a.hbc,101);this.Nq(b,ub.a.imageCrop,this.lRl);b.Vc(ub.a.imageCrop,4);this.Nq(b,ub.a.Pib,this.Pib);b.Vc(ub.a.Pib,101);this.Nq(b,ub.a.e5h,this.mRl);this.Nq(b,ub.a.WKc,this.mJd);this.Nq(b,ub.a.PKc,this.mJd);this.Nq(b,ub.a.QKc,this.mJd);this.Nq(b,ub.a.RKc,this.mJd);this.Nq(b,ub.a.kVc,this.Rac);b.Vc(ub.a.kVc,101);this.Nq(b,ub.a.X_d,this.Rac);b.Vc(ub.a.X_d,101);this.Nq(b,ub.a.Y_d,this.Rac);b.Vc(ub.a.Y_d,101);this.Nq(b,ub.a.Z_d,this.Rac);b.Vc(ub.a.Z_d,
101);this.Nq(b,Db.a.imageRotate,this.oRl);b.Vc(Db.a.imageRotate,4);this.Nq(b,Db.a.hHb,this.hHb);b.Vc(Db.a.hHb,101);this.Nq(b,Db.a.rUc,this.rUc);b.Vc(Db.a.rUc,4);this.Nq(b,Db.a.o7,this.o7);b.Vc(Db.a.o7,4);this.Nq(b,Db.a.DZc,this.o7);b.Vc(Db.a.DZc,4);this.Nq(b,Db.a.RHf,this.Efa);b.Vc(Db.a.RHf,4);this.Nq(b,Db.a.Kua,this.Kua.bind(this));b.Vc(Db.a.Kua,4);this.Nq(b,Db.a.wga,this.wga);b.Vc(Db.a.wga,4);this.Nq(b,Db.a.kHb,this.kHb.bind(this));b.Vc(Db.a.kHb,4);this.Nq(b,Db.a.l2a,this.l2a);b.Vc(Db.a.l2a,4);
this.Nq(b,Db.a.xCf,this.q2d);b.Vc(Db.a.xCf,4)}A3e(b,h,n,x){w.ULS.sendTraceTag(593372313,322,50,"Applying New Image Resize, isCanvas: "+Pd.ImageReader.GMd(b));this.pJ.mta()&&this.pJ.A1c(b,h);if(Pd.ImageReader.Sx(b)){b=na.a.create();const E=new Se.GraphTransaction(15);E.Db(h.node);this.Vjd.pbn(h,Pd.ImageReader.Xl(h),n,x,b);E.tCa(b,1);E.dispose()}else Pd.ImageReader.Xdc(b)?(new pH.a(b,new qH.a)).zLn(n,x,this.wUm,h):(super.A3e(b,h,n,x),this.Rd.us(13))}kN(b){if(!b.ul)return!1;var h=b.node;return(h=ob.App.instance&&
ob.App.instance.ACb?h instanceof em.a||h instanceof WP.a?h:null:Object(ja.a)(em.a,h))&&Is.l(h)?(yt.Lc.Yb(UP.a.Mm,{["Reason"]:KA.a.pN}),!1):super.kN(b)}kac(b){b&&(this.vrb?this.E3("SimplifyRibbonContextualCommandsUsageControl","DefaultContextTabBehaviour"):(this.Dh.SUa(this.Ehb),this.vrb=!0,this.E3("SimplifyRibbonContextualCommandsUsageTreatment","EnableAutoContextualTabSwitch")))}E3(b,h){const n=Oa.a.instance.Za("Common.ISystemInitiatedFeedback");n&&n.execute(x=>{x.logActivity(b,h)})}hbn(b,h,n,x,
E){return E?(E.Ubi=b,E.n6=h,E.MKb=n,E.Ws=x,E.h4a=Xt.ONl(E),!0):!1}mQc(b){Of.a.instance.J(4)&&ob.App.rd.Kp&&ob.App.rd.Jq.sG(b.node)}GAm(){this.gOg||(w.ULS.sendTraceTag(20459971,322,50,"Wrap Text UI enabled."),this.gOg=!0)}ezb(b){const h=VP.a.instance.lAd(b);this.pJ.u5d(b,h[0],h[1],h[2],h[3])}Kua(b,h,n,x,E){2===n&&(b=Pd.ImageReader.Xl(h),this.vo.Yqj(E,b));return 32}kHb(b,h,n,x,E){2===n&&(b=Pd.ImageReader.Xl(h),this.vo.Xqj(E,b));return 32}a5c(){u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$("PictureBorderFloodgateSurveyIsEnabled")&&
window.setTimeout(()=>{const b=Oa.a.instance.Za("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("PictureBorderApplied","PictureBorderFloodgateSurveyIsEnabled")})},5E3)}static get Ifc(){return null!=Xt.Xpg?Xt.Xpg:Xt.Xpg=Aq.a.instance}static get iDi(){Xt.JU||(Xt.JU=new sx.a("PictureBorder"),Xt.$Ya(Xt.JU));return Xt.JU}static ONl(b){if(b.Ubi)b=1;else switch(b.MKb){case 2:b=b.n6?3:4;break;case 1:b=1===b.Ws?8:3===b.Ws?9:2;break;case 0:b=5;break;case 3:b=6;break;case 4:b=7;break;default:b=
0}return b}static $Ya(b){b.Uca(3,Db.a.o7);b.Uca(4,Db.a.o7);b.Uca(5,Db.a.DZc);b.Uca(6,Db.a.o7);b.tWb(Br.a.instance,1)}}Xt.JU=null;Xt.m5a=null;Object(r.a)(Xt,"ImageActor",yt,[]);class tm{static get paragraphEditor(){return null!=tm.Gng?tm.Gng:tm.Gng=Oa.a.instance.resolve("Box4.IParagraphEditor")}static get Yx(){return null!=tm.Sng?tm.Sng:tm.Sng=Oa.a.instance.resolve("Box4.IParagraphIndentationReader")}static get a_(){return tm.paragraphEditor.np}static get vi(){return null!=tm.Yqg?tm.Yqg:tm.Yqg=Oa.a.instance.resolve("Box4.IUndoManager")}static Vb(){const b=
u.AFrameworkApplication.ya;b.pa(Db.a.XGb,cc.a.view,Jl.a.yv);b.pa(Db.a.XGb,cc.a.paragraph,tm.nja);b.Vc(Db.a.XGb,1036);b.pa(Db.a.Ixb,cc.a.view,Jl.a.yv);b.pa(Db.a.Ixb,cc.a.paragraph,tm.nja);b.Vc(Db.a.Ixb,1036);b.pa(Db.a.lbb,cc.a.view,Jl.a.yv);b.pa(Db.a.lbb,cc.a.paragraph,tm.nja);b.Vc(Db.a.lbb,1036);b.pa(Db.a.Abc,cc.a.view,Jl.a.yv);b.pa(Db.a.Abc,cc.a.paragraph,tm.nja);b.Vc(Db.a.Abc,1036);b.pa(Db.a.SWc,cc.a.view,Jl.a.yv);b.pa(Db.a.SWc,cc.a.paragraph,tm.nja);b.Vc(Db.a.SWc,1036);b.pa(Db.a.WYa,cc.a.view,
Jl.a.yv);b.pa(Db.a.WYa,cc.a.paragraph,tm.nja);b.Vc(Db.a.WYa,1036);b.pa(Db.a.Jeb,cc.a.view,Jl.a.yv);b.pa(Db.a.Jeb,cc.a.paragraph,tm.nja);b.Vc(Db.a.Jeb,1036);b.pa(Db.a.VYa,cc.a.view,Jl.a.yv);b.pa(Db.a.VYa,cc.a.paragraph,tm.nja);b.Vc(Db.a.VYa,1036);b.pa(Db.a.y5d,cc.a.view,tm.n8d);b.pa(Db.a.y5d,cc.a.paragraph,tm.n8d);b.Vc(Db.a.y5d,1028);b.pa(Db.a.PWf,cc.a.view,tm.n8d);b.pa(Db.a.PWf,cc.a.paragraph,tm.n8d);b.Vc(Db.a.PWf,1028);b.pa(Db.a.mJb,cc.a.view,Jl.a.yv);b.pa(Db.a.mJb,cc.a.paragraph,tm.nja);b.Vc(Db.a.mJb,
1036);b.pa(Db.a.Zjb,cc.a.view,Jl.a.yv);b.pa(Db.a.Zjb,cc.a.paragraph,tm.nja);b.Vc(Db.a.Zjb,1036);b.pa(Db.a.nJb,cc.a.view,Jl.a.yv);b.pa(Db.a.nJb,cc.a.paragraph,tm.nja);b.Vc(Db.a.nJb,1036);b.pa(Db.a.h8d,cc.a.view,Jl.a.yv);b.Vc(Db.a.h8d,1028);b.pa(Db.a.MZc,cc.a.view,Jl.a.yv);b.pa(Db.a.MZc,cc.a.paragraph,tm.nja);b.Vc(Db.a.MZc,1036);b.pa(Db.a.NZc,cc.a.view,Jl.a.yv);b.pa(Db.a.NZc,cc.a.paragraph,tm.nja);b.Vc(Db.a.NZc,1036)}static n8d(b,h,n,x,E){2===n&&""===E[rc.a.Text]&&(b=b===Db.a.y5d?Db.a.WYa:Db.a.VYa,
h=new ax.a,h.value=0,h.unit=ob.App.r6?2:1,u.AFrameworkApplication.ya.Xb(b,2,h),ob.App.xa.updateCommandUI());return 32}static nja(b,h,n,x,E){if(!({zx:n}=Jl.a.QYf(n,h)).returnValue)return n;h=h.node;switch(b){case Db.a.XGb:tm.a_.AMf(h,!0);break;case Db.a.Ixb:tm.a_.AMf(h,!1);break;case Db.a.lbb:tm.a_.lbb(h);break;case Db.a.Abc:tm.a_.Raa(h,0);break;case Db.a.SWc:tm.a_.Rjb(h,0);break;case Db.a.Jeb:case Db.a.WYa:n=new md.GraphIterator;n.set(h);n.Bb(11);let S=E.value;E=E.unit;b===Db.a.Jeb&&(S=(new Zj.a(E,
S)).gt+tm.Yx.pF(h).gt,E=1);tm.a_.mva(n,E,S);break;case Db.a.VYa:tm.a_.ZIb(h,E.unit,E.value);break;case Db.a.mJb:E?(b=(new Zj.a(E.unit,E.value)).gt,tm.a_.Raa(h,b)):tm.Yx.FEd(h).gt||tm.a_.Raa(h,gf.OutlineReader.rL(h));break;case Db.a.Zjb:E?(b=(new Zj.a(E.unit,E.value)).gt,tm.a_.Rjb(h,b)):tm.Yx.pF(h).gt||tm.a_.Rjb(h,gf.OutlineReader.rL(h));break;case Db.a.nJb:tm.a_.Raa(h,0);break;case Db.a.MZc:b=E;b=(new Zj.a(b.unit,b.value)).gt;tm.a_.GXf(h,1,b);break;case Db.a.NZc:b=E,b=(new Zj.a(b.unit,b.value)).gt,
tm.a_.GXf(h,2,b)}tm.vi.xF();x&&Bq.a.hlb&&(x.Jr|=Bq.a.Xcb(h));return 32}}Object(r.a)(tm,"IndentationActor",null,[]);var NL=d(316),XP=d(50),VF=d(448),OL=d(1172);class Rq{constructor(b){this.XSa=this.kya=this.Lrc=null;this.h4g=!1;this.i_d=h=>{if(this.kya)if(h===Ra.a.h_d)de.FocusManager.instance().getRegion(xd.AFrame.U0a).g9b();else if(h===Ra.a.g_d)de.FocusManager.instance().getRegion(xd.AFrame.U0a).e9b();else return 2;else return 2;return 32};this._frame=b}L_n(){if(this.h4g)this.Rii();else{const b=bc.a.create(u.AFrameworkApplication.K.lb("WopiBootstrapUrl"));
b.MV((h,n)=>{n.succeeded?(this.h4g=!0,this.Rii()):w.ULS.sendTraceTag(40436806,323,10,"Failed to download word.boot.js")});Eb.a.KS(b)}}Rii(){if(this.Lrc)w.ULS.sendTraceTag(38130908,323,10,"previewPanel: Tried to launch while already running");else{const b=this._frame.noa;this.kya=document.createElement("div");b.parentNode.insertBefore(this.kya,b);this.XSa=previewPanel.FactoryGlobal.getWordDocumentPanel(this,{fileName:u.AFrameworkApplication.K.lb("FileName"),reactRoot:this.kya});this.XSa.setWebpackPublicPath(u.AFrameworkApplication.r_);
this.XSa.renderDocumentPanel()}}sul(b){const h={};h.Container=b;h.BootstrapperUrl=u.AFrameworkApplication.K.lb("WopiBootstrapUrl");h.ApplicationUrl=this._frame.gmb;b={};b.HostName=u.AFrameworkApplication.K.lb("FileSource");b.HostSessionId=u.AFrameworkApplication.K.lb("HostSessionId");b.UserId=u.AFrameworkApplication.K.lb("UserId");b.DocumentClickTime=new Date(this._frame.bhb);b.SessionContext="";b.WdParams={};h.SessionInformation=b;b={};b.FileName=u.AFrameworkApplication.K.lb("FileName");b.FileGetUrl=
"";b.ReadOnly=!1;b.BundleInfo={MajorVersion:1,Url:""};h.WopiPrecheckInfo=b;h.ApplicationCustomSettings={WopiFallbackEnabled:!0,appFrameName:"PreviewPanelApplicationFrame",IsCore:!0,InAppDocumentPreview:!0};b={entryPoint:"WordEditorPreviewPanel"};b.userClickTime=this._frame.bhb;h.Diagnostics=b;b={};b.WopiSrc=u.AFrameworkApplication.K.lb("WopiSrc");b.AccessToken=u.AFrameworkApplication.K.lb("AccessToken");b.AccessTokenTtl=u.AFrameworkApplication.K.lb("AccessTokenTtl");h.WopiInfo=b;h.FnOnInitializeSuccess=
n=>{Rq.JV=n;this.XSa.setMaxPage(Rq.JV.GetPageCount());this.XSa.setCurrentPage(Rq.JV.GetCurrentPage());this.XSa.setPageControlVisible(!0);Rq.JV.RegisterEventHandler("PageChanged",x=>{this.XSa.setCurrentPage(x.newPage)});Rq.JV.RegisterEventHandler("BrowserEvent",x=>{27===x.keyCode?this.closeViewer():x.button&&1!==x.button||this.kya.click()});n=this._frame.bhb-(new Date).getTime();w.ULS.sendTraceTag(38355488,323,50,"previewPanel: Load finished - {0}",n);this.Vb();de.FocusManager.instance().nK(xd.AFrame.U0a,
!0);this.buildFocusRegion();this.oDa(de.FocusManager.instance().pe(xd.AFrame.U0a));this.kya.click()};h.FnOnInitializeFailure=(n,x)=>{w.ULS.sendTraceTag(38273185,323,10,"previewPanel: {1}: {0}",n.toString(),x.toString());this.closeViewer()};return h}buildFocusRegion(){const b=de.FocusManager.instance();var h=b.getRegion(xd.AFrame.U0a);h=[2,3];const n=b.pe(xd.AFrame.U0a),x=new ke.DOMFocusListing(()=>this.kya);x.uDa=!0;for(let E of h)x.Go(E);h=b.yja(()=>this.kya,n,x);h.oOa();h.dX=!0;h.QVa=!0;x.hy(x.bea)}Vb(){u.AFrameworkApplication.ya.pa(Ra.a.h_d,
Ld.a.frame,this.i_d);u.AFrameworkApplication.ya.pa(Ra.a.g_d,Ld.a.frame,this.i_d)}oDa(b){b.Ar(de.FocusManager.instance().uV);b.Ar(de.FocusManager.instance().vV);b.bindAction(de.FocusManager.instance().uV,Ra.a.h_d);b.bindAction(de.FocusManager.instance().vV,Ra.a.g_d)}loadViewer(b){b=this.sul(b);this.Lrc=Microsoft.Office.Word.Viewer.InitializeWopiPending(b);this.Lrc.Complete(b.WopiInfo)}closeViewer(){de.FocusManager.instance().GQ(xd.AFrame.U0a);Rq.JV&&(Rq.JV.Dispose(),Rq.JV=null,u.AFrameworkApplication.ya.Vy(Ra.a.h_d,
Ld.a.frame,this.i_d),u.AFrameworkApplication.ya.Vy(Ra.a.g_d,Ld.a.frame,this.i_d));this.Lrc&&(this.kya.parentNode.removeChild(this.kya),this.kya=this.Lrc=null)}printAction(){w.ULS.sendTraceTag(38355489,323,50,"previewPanel: Print Called");u.AFrameworkApplication.ya.processAction(Db.a.print,2)}downloadPdfAction(){w.ULS.sendTraceTag(38355490,323,50,"previewPanel: Download to PDF Called");u.AFrameworkApplication.ya.processAction(ub.a.PDc,2)}downloadCopyAction(){w.ULS.sendTraceTag(38355491,323,50,"previewPanel: Download Copy Called");
u.AFrameworkApplication.ya.processAction(Ra.a.downloadACopy,2)}zoomInAction(){if(Rq.JV){let b=Rq.JV.GetZoomLevel();b+=.2;Rq.JV.SetZoomLevel(b)}}zoomOutAction(){if(Rq.JV){let b=Rq.JV.GetZoomLevel();b-=.2;Rq.JV.SetZoomLevel(b)}}setPage(b){if(Rq.JV){const h=Rq.JV.GetPageCount();1>b?(Rq.JV.SetCurrentPage(1),this.XSa.setCurrentPage(1)):1<=b&&b<=h?Rq.JV.SetCurrentPage(b):(Rq.JV.SetCurrentPage(h),this.XSa.setCurrentPage(h))}}static getInstance(b){Rq.WBe||(Rq.WBe=new Rq(b));return Rq.WBe}}Rq.JV=null;Rq.WBe=
null;Object(r.a)(Rq,"PreviewPanelActor",null,[]);class Cq{static get gjj(){return null!=Cq.drg?Cq.drg:Cq.drg=u.AFrameworkApplication.K.lb("ClassicViewModePreferenceCookieName")}static Vb(b,h){b.gb(Db.a.xHb,Ld.a.frame,Cq.vkj,128);b.pa(Db.a.u9d,Ld.a.frame,Cq.vkj);Cq.xE=h;b.pa(ub.a.CPc,Ld.a.frame,Cq.CPc);b.pa(ub.a.EPc,Ld.a.frame,Cq.EPc);b.gb(ub.a.AVc,Ld.a.frame,Cq.AVc,96);b.gb(ub.a.OVc,Ld.a.frame,Cq.OVc,96)}static vkj(b,h,n){if(h.contextId!==Ld.a.frame)return 2;h=Kb.App.fm;switch(b){case Db.a.xHb:if(!h.gmb)return 8;
if(1===n)return Vh.SessionStatusManager.instance.Qj?8:32;b=(new Date).getTime();ai.a.instance.ahn(b);h.bhb=b;u.AFrameworkApplication.K.$("InAppDocumentPreviewIsEnabled")?aw.a.HP(3,!0,Cq.d6m,null,h):aw.a.HP(3,!0,Cq.nri,null,h);return 32;case Db.a.u9d:return 32;default:return 2}}static nri(b){VF.a()?Cq.AMl(b):Cq.$7i(b)}static AMl(b){const h={};h[G.a.lkf]=Cq.gjj;u.AFrameworkApplication.WP().execute(n=>{n.vv(F.a.mkf);n.vco(F.a.mkf);n.VB(F.a.mkf,x=>{Cq.Ork(x,b)});n.sendMessage(F.a.Bsl,h)})}static Ork(b,
h){b.Values[G.a.lkf]===Cq.gjj&&("true"===b.Values[G.a.v4h]?Cq.$7i(h):(Cq.Jfo(),Cq.I2n()))}static Jfo(){if("View"!==appChrome.selectors.getModeSwitcherMode()){const b={activeMode:"View"};u.AFrameworkApplication.Hf("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)?appChrome.dispatchUpdateAppModeAndTabsAction(b):appChrome.api.dispatch(appChrome.actions.updateModeSwitcher(b))}}static I2n(){u.AFrameworkApplication.Eu=
!0;ob.App.xa.C7(1);ob.App.xa.jb.uv&&ob.App.xa.jb.uv.Ji&&ob.App.xa.jb.uv.cmf();u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClassViewButtonBugFix",!1)&&ob.App.xa.updateCommandUI();OL.PageView.Vaj(u.AFrameworkApplication.K)}static $7i(b){try{const h=new Jc.a;let n,x;u.AFrameworkApplication.wjj?(n=ob.App.hostUrl,x=3):(n=b.gmb,x=1);b.bhb&&h.add(u.AFrameworkApplication.Tyf,b.bhb.toString());u.AFrameworkApplication.nof&&h.add(u.AFrameworkApplication.kYe,"1");u.AFrameworkApplication.$Te&&
h.add(u.AFrameworkApplication.DBk,"1");h.add(NL.a.s8f,NL.a.userSessionData);h.add(u.AFrameworkApplication.l_d,u.AFrameworkApplication.userSessionId);const E=u.AFrameworkApplication.K.lb(u.AFrameworkApplication.Zga);E&&h.add(u.AFrameworkApplication.bdj,E);w.ULS.sendTraceTag(573095942,324,100,"Navigate to view mode");VF.b(u.AFrameworkApplication.K)?VF.d("view",h,VF.c):(n=Ec.a.g7g(n,h),u.AFrameworkApplication.wjj?rd.a.ym(n,rd.a.poa(x),void 0,"AuthenticationLostDuringSession"):rd.a.openWindow(x,n,!1,
void 0,XP.a.ONi))}catch(h){}}static d6m(b){w.ULS.sendTraceTag(38355487,323,50,"previewPanel: init");(u.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("previewPanel"):Oa.a.instance.resolve("Common.IDynamicScriptLoaderProvider").tE.loadScript("previewPanel")).catch(()=>{w.ULS.sendTraceTag(38130907,323,10,"previewPanel: Failed to download script");Cq.nri(b)}).then(()=>{Rq.getInstance(b).L_n()})}static CPc(b,h,n){if(1===n)return 32;Cq.xE.RWi(1);ob.App.xa.updateCommandUI();
return 32}static EPc(b,h,n){if(1===n)return 32;Cq.xE.RWi(0);ob.App.xa.updateCommandUI();return 32}static AVc(b,h,n,x,E){if(1===n)return 32;E[Qf.a.On]=1===Cq.xE.Hx;return 32}static OVc(b,h,n,x,E){if(1===n)return 32;E[Qf.a.On]=!Cq.xE.Hx;return 32}}Cq.xE=null;Object(r.a)(Cq,"MainViewModeActor",null,[]);class PL{constructor(b,h,n){this.BCm=(x,E,S,ma,Fa)=>1===S?32:(x=this.Lk.m$(E.tk))?(Fa=3===Fa.Qw,this.n4.value.Fsh(this.pDl(x),this.FAb(x),Fa),32):2;this.ga=b;this.n4=h;this.Lk=n}Vb(){this.ga.pa(ub.a.vuf,
cc.a.view,this.BCm);this.ga.gb(ub.a.d0d,cc.a.view,ah.a.JQ,96);this.ga.gb(ub.a.a0d,cc.a.view,ah.a.JQ,96);this.ga.gb(ub.a.b0d,cc.a.view,ah.a.JQ,96);this.ga.gb(ub.a.c0d,cc.a.view,ah.a.JQ,96);this.ga.pa(ub.a.jTc,cc.a.view,ah.a.tF);this.ga.pa(ub.a.iTc,cc.a.view,ah.a.tF);this.ga.pa(ub.a.RXd,cc.a.view,ah.a.tF);this.ga.pa(ub.a.SXd,cc.a.view,ah.a.tF)}pDl(b){const h=new qi.DictionaryPropertySet;h.setValue(ic.a.marginTop,this.Lk.Zka(b));h.setValue(ic.a.marginBottom,this.Lk.Hsa(b));h.setValue(ic.a.marginLeft,
this.Lk.vL(b));h.setValue(ic.a.marginRight,this.Lk.wL(b));return h}FAb(b){const h=new qi.DictionaryPropertySet;h.setValue(ic.a.Ko,this.Lk.Gv(b));h.setValue(ic.a.Xx,this.Lk.oA(b));return h}}Object(r.a)(PL,"MarginsDialogActor",null,[]);class rH{constructor(b){this.B1c=(h,n,x)=>{if(1===x)return 32;h=u.AFrameworkApplication.ua;if(!h)return 32;h.Kyc();rH.zzn(h);return 32};this.ga=b}Vb(){this.ga.pa(ub.a.B1c,cc.a.view,this.B1c)}static zzn(b){const h=u.AFrameworkApplication.K.lb("ModernUxExperimentPreferenceCookieName");
var n=u.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");n=Ya.a.Lka(h,!n);Ya.a.hPa(h,(!n).toString(),Ya.a.eNa);n?w.ULS.sendTraceTag(576075457,340,50,"User is opting out of the modern ux experience"):w.ULS.sendTraceTag(576075458,340,50,"User is opting in to the modern ux experience");Pe.d(ub.a.B1c,!0,void 0,void 0,void 0,void 0,[Object.assign(new ca.a,{name:"ModernUxExperimentPreference",string:(!n).toString()})]);b.refreshDocument(null)}}Object(r.a)(rH,"ModernUxActor",null,[]);var YP=
d(1019),Wr=d(1632);class QL{constructor(b,h){this.Z7d=Jf.a.wF(1)/6;this.JE=b;this.Hd=h}get Sg(){return Pm.a.instance}Iwl(b){var h=ob.App.Aqf,n=h?1:3,x=u.AFrameworkApplication.numberFormat;let E=Wr.a.c_[b].Qqb;var S=Wr.a.c_[b].Oqb;var ma=Wr.a.c_[b]._marginLeft;b=Wr.a.c_[b].Pqb;E=h?Jf.a.jLb(E):Jf.a.cC(E);S=h?Jf.a.jLb(S):Jf.a.cC(S);ma=h?Jf.a.jLb(ma):Jf.a.cC(ma);b=h?Jf.a.jLb(b):Jf.a.cC(b);h=B.a.rAa(E,n,x);S=B.a.rAa(S,n,x);ma=B.a.rAa(ma,n,x);n=B.a.rAa(b,n,x);x={};x.top=h;x.bottom=S;x.left=ma;x.right=n;
return x}zCm(b){const h=WordRibbonStrings.PageMarginsTop,n=WordRibbonStrings.PageMarginsBottom,x=WordRibbonStrings.PageMarginsLeft,E=WordRibbonStrings.PageMarginsRight;b=this.Iwl(b);return[[h,b.top,n,b.bottom],[x,b.left,E,b.right]]}BTc(b){var h=ob.App.Aqf,n=h?1:3;const x=u.AFrameworkApplication.numberFormat;let E=Wr.a.$ma[b].Vpa;b=Wr.a.$ma[b].NHa;E=h?Jf.a.jLb(E):Jf.a.cC(E);b=h?Jf.a.jLb(b):Jf.a.cC(b);h=B.a.rAa(b,n,x);n=B.a.rAa(E,n,x);return String.format(WoncaIntl.WoncaStrings.L_PageSizeDescription,
h,n)}Vb(){const b=u.AFrameworkApplication.ya;b.gb(Db.a.bJb,cc.a.view,Object(v.a)(this,this.gLn,"setPredefinedMarginsView"),4);b.gb(Db.a.bPa,cc.a.view,Object(v.a)(this,this.hLn,"setPredefinedPageSizeView"),4);b.gb(Db.a.setOrientation,cc.a.view,Object(v.a)(this,this.zKn,"setOrientationView"),4);b.gb(Db.a.jDa,cc.a.view,Object(v.a)(this,this.jDa,"querySectionProperties"),96);b.pa(Db.a.j2a,cc.a.view,Object(v.a)(this,this.M5d,"setMarginView"));b.pa(Db.a.h2a,cc.a.view,Object(v.a)(this,this.M5d,"setMarginView"));
b.pa(Db.a.uga,cc.a.view,Object(v.a)(this,this.M5d,"setMarginView"));b.pa(Db.a.i2a,cc.a.view,Object(v.a)(this,this.M5d,"setMarginView"));b.pa(Db.a.oXf,cc.a.view,Object(v.a)(this,this.JYi,"setPaperSizeView"));b.pa(Db.a.nXf,cc.a.view,Object(v.a)(this,this.JYi,"setPaperSizeView"));b.pa(Db.a.Kjb,cc.a.view,Object(v.a)(this,this.Kjb,"setColumnsCount"));b.pa(Db.a.a5d,cc.a.view,Object(v.a)(this,this.a5d,"setColumnsWidths"));b.pa(Db.a.$4d,cc.a.view,Object(v.a)(this,this.$4d,"setColumnsSpaces"))}gLn(b,h,n,x,
E){if(1===n)return 32;if(n=this.Sg.m$(h.tk)){if(0<=E&&E<Wr.a.c_.length){h=new Se.GraphTransaction(15);h.Db(n);h.zl=b;b=Wr.a.c_[E].Qqb;x=Wr.a.c_[E].Oqb;const S=Wr.a.c_[E]._marginLeft;E=Wr.a.c_[E].Pqb;this.wYd(b,x,this.Sg.oA(n))&&this.wYd(S,E,this.Sg.Gv(n))?(this.JE.j2a(n,b),this.JE.h2a(n,x),this.JE.uga(n,S),this.JE.i2a(n,E),this.Hd.us(11)):this.jva(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage);h.dispose()}else return 2;return 32}w.ULS.sendTraceTag(520618525,3009,50,"wordSectionNode is null; context.nextContext = {0}",
h.tk);return 2}wYd(b,h,n){return n>=b+h+ob.App.Zva}hLn(b,h,n,x,E){if(1===n)return 32;if(n=this.Sg.m$(h.tk)){if(0<=E&&E<Wr.a.$ma.length)h=new Se.GraphTransaction(15),h.Db(n),h.zl=b,b=(x=this.Sg.$Nd(n))?Wr.a.$ma[E].Vpa:Wr.a.$ma[E].NHa,E=x?Wr.a.$ma[E].NHa:Wr.a.$ma[E].Vpa,this.wYd(this.Sg.Hsa(n),this.Sg.Zka(n),E)&&this.wYd(this.Sg.vL(n),this.Sg.wL(n),b)?(this.JE.mXf(n,b),this.JE.lXf(n,E),this.Hd.us(11)):this.jva(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage),h.dispose();else return 2;return 32}w.ULS.sendTraceTag(520618524,
3009,50,"wordSectionNode is null; context.nextContext = {0}",h.tk);return 2}zKn(b,h,n,x,E){if(1===n)return 32;if(n=this.Sg.m$(h.tk)){h=this.Sg.$Nd(n);x=new Se.GraphTransaction(15);x.Db(n);x.zl=b;this.JE.$Xi(n,E);if(E&&!h||!E&&h){b=this.Sg.Gv(n);E=this.Sg.oA(n);this.JE.mXf(n,E);this.JE.lXf(n,b);b=this.Sg.Zka(n);E=this.Sg.Hsa(n);const S=this.Sg.vL(n),ma=this.Sg.wL(n);h?(this.JE.j2a(n,u.AFrameworkApplication.isRtl?S:ma),this.JE.h2a(n,u.AFrameworkApplication.isRtl?ma:S),this.JE.uga(n,u.AFrameworkApplication.isRtl?
E:b),this.JE.i2a(n,u.AFrameworkApplication.isRtl?b:E)):(this.JE.j2a(n,u.AFrameworkApplication.isRtl?ma:S),this.JE.h2a(n,u.AFrameworkApplication.isRtl?S:ma),this.JE.uga(n,u.AFrameworkApplication.isRtl?Math.abs(b):E),this.JE.i2a(n,u.AFrameworkApplication.isRtl?E:b));this.Hd.us(11)}x.dispose();return 32}w.ULS.sendTraceTag(520618523,3009,50,"wordSectionNode is null; context.nextContext = {0}",h.tk);return 2}Kjb(b,h,n,x,E){if(1===n)return 32;n=this.Sg.m$(h.tk);if(!n)return w.ULS.sendTraceTag(520618522,
3009,50,"wordSectionNode is null; context.nextContext = {0}",h.tk),2;h=new Se.GraphTransaction(15);h.Db(n);h.zl=b;if(0>E||13<E)return 2;this.JE.UIb(n,E);h.dispose();return 32}a5d(b,h,n,x,E){if(1===n)return 32;n=this.Sg.m$(h.tk);if(!n)return w.ULS.sendTraceTag(520618521,3009,50,"wordSectionNode is null; context.nextContext = {0}",h.tk),2;h=new Se.GraphTransaction(15);h.Db(n);h.zl=b;b=E[0];if(720>b||9360<b)return 2;this.JE.hdc(n,E);h.dispose();return 32}$4d(b,h,n,x,E){if(1===n)return 32;n=this.Sg.m$(h.tk);
if(!n)return w.ULS.sendTraceTag(520618520,3009,50,"wordSectionNode is null; context.nextContext = {0}",h.tk),2;h=new Se.GraphTransaction(15);h.Db(n);h.zl=b;if(0>E||7920<E)return 2;this.JE.ZFn(n,E);h.dispose();return 32}jDa(b,h,n,x,E){if(b=this.Sg.m$(h.tk))return E.marginTop=this.Sg.Zka(b),E.marginBottom=this.Sg.Hsa(b),E.marginLeft=this.Sg.vL(b),E.marginRight=this.Sg.wL(b),E.Ko=this.Sg.Gv(b),E.Xx=this.Sg.oA(b),E.rta=this.Sg.$Nd(b),E.yC=this.Sg.kh(b),E.ZV=this.Sg.rzb(b),E.JEb=this.Hwl(E),E.fGb=this.zAl(E),
32;w.ULS.sendTraceTag(520618519,3009,50,"wordSectionNode is null; context.nextContext = {0}",h.tk);return 2}Hwl(b){let h=5;for(let n=0;n<Wr.a.c_.length;n++)if(Wr.a.c_[n].Qqb===b.marginTop&&Wr.a.c_[n].Oqb===b.marginBottom&&Wr.a.c_[n]._marginLeft===b.marginLeft&&Wr.a.c_[n].Pqb===b.marginRight){h=n;break}return h}zAl(b){let h=5;b=new YP.a(Math.min(b.Ko,b.Xx),Math.max(b.Ko,b.Xx));for(let n=0;n<Wr.a.$ma.length;n++)if(this.c_m(b,Wr.a.$ma[n])){h=n;break}return h}c_m(b,h){return Ub.a.P9h(b.NHa,Math.max(h.NHa-
this.Z7d,0),h.NHa+this.Z7d)&&Ub.a.P9h(b.Vpa,Math.max(h.Vpa-this.Z7d,0),h.Vpa+this.Z7d)}M5d(b,h,n,x,E){if(1===n)return 32;if(n=this.Sg.m$(h.tk)){h=new Se.GraphTransaction(15);h.Db(n);switch(b){case Db.a.j2a:this.JE.j2a(n,E);break;case Db.a.h2a:this.JE.h2a(n,E);break;case Db.a.uga:this.JE.uga(n,E);break;case Db.a.i2a:this.JE.i2a(n,E)}this.Hd.us(11);h.dispose();return 32}w.ULS.sendTraceTag(520618518,3009,50,"wordSectionNode is null; context.nextContext = {0}",h.tk);return 2}JYi(b,h,n,x,E){if(1===n)return 32;
if(n=this.Sg.m$(h.tk)){h=new Se.GraphTransaction(15);h.Db(n);let S=x=0;switch(b){case Db.a.oXf:S=E;this.JE.mXf(n,S);x=this.Sg.oA(n);break;case Db.a.nXf:x=E,this.JE.lXf(n,x),S=this.Sg.Gv(n)}this.JE.$Xi(n,x<S);this.Hd.us(11);h.dispose();return 32}w.ULS.sendTraceTag(520618517,3009,50,"wordSectionNode is null; context.nextContext = {0}",h.tk);return 2}jva(b){if(!Wf.a.kL){const h=new yd.StandardDialog;h.Ed=0;h.nU(CommonUIStrings.l_DefaultDialogTitle,b,null)}}}Object(r.a)(QL,"PageActor",null,[599]);class RL{constructor(b){this.ga=
b}get Ac(){return this.ga}L5d(b,h){let n=0;b?1===b?n=Db.a.uga:2===b?n=Db.a.i2a:3===b&&(n=Db.a.h2a):n=Db.a.j2a;this.Ac.Xb(n,2,h)}bPa(b,h){let n=0;1===b?n=Db.a.nXf:b||(n=Db.a.oXf);this.Ac.Xb(n,2,h)}hWf(b,h){let n=0;switch(b){case 0:n=Db.a.Kjb;break;case 1:n=Db.a.a5d;break;case 2:n=Db.a.$4d}this.Ac.Xb(n,2,h)}}Object(r.a)(RL,"PageCommands",null,[598]);class SL{constructor(b,h,n){this.b_m=(x,E,S,ma,Fa)=>1===S?32:(x=this.Lk.m$(E.tk))?(Fa=3===Fa.Qw,this.n4.value.jth(this.qDl(x),this.FAb(x),Fa),32):2;this.ga=
b;this.n4=h;this.Lk=n}Vb(){this.ga.pa(ub.a.xuf,cc.a.view,this.b_m);this.ga.gb(ub.a.s0d,cc.a.view,ah.a.JQ,96);this.ga.gb(ub.a.r0d,cc.a.view,ah.a.JQ,96);this.ga.pa(ub.a.VXd,cc.a.view,ah.a.tF);this.ga.pa(ub.a.UXd,cc.a.view,ah.a.tF)}qDl(b){const h=new qi.DictionaryPropertySet;h.setValue(ic.a.Ko,this.Lk.Gv(b));h.setValue(ic.a.Xx,this.Lk.oA(b));return h}FAb(b){const h=new qi.DictionaryPropertySet;h.setValue(ic.a.marginTop,Math.abs(this.Lk.Zka(b)));h.setValue(ic.a.marginBottom,Math.abs(this.Lk.Hsa(b)));
h.setValue(ic.a.marginLeft,this.Lk.vL(b));h.setValue(ic.a.marginRight,this.Lk.wL(b));return h}}Object(r.a)(SL,"PaperSizeDialogActor",null,[]);class nD{constructor(b,h,n,x,E=Oa.a.instance.Za("Box4.Settings.SpacingSettings")){this.ga=b;this.n4=h;this.K0=n;this.Vv=x;this.oO=null;E.execute(S=>this.oO=S)}Vb(){this.ga.gb(Db.a.W7b,cc.a.view,Object(v.a)(this,this.O_m,"paragraphDialogViewHandler"),1028);this.ga.pa(Db.a.W7b,cc.a.paragraph,Object(v.a)(this,this.N_m,"paragraphDialogHandler"));this.ga.gb(Db.a.D0d,
cc.a.view,ah.a.JQ,96);this.ga.gb(Db.a.$ac,cc.a.view,ah.a.JQ,96);this.ga.gb(Db.a.$_d,cc.a.view,ah.a.JQ,96);this.ga.gb(Db.a.xVc,cc.a.view,ah.a.JQ,96);this.ga.gb(Db.a.H2a,cc.a.view,ah.a.tF,96);this.ga.gb(Db.a.e0c,cc.a.view,ah.a.tF,96);this.ga.gb(Db.a.WXd,cc.a.view,ah.a.tF,96);this.ga.gb(Db.a.A$b,cc.a.view,ah.a.tF,96);this.ga.gb(Db.a.QXd,cc.a.view,ah.a.tF,96);this.ga.gb(Db.a.p8d,cc.a.view,ah.a.tF,96);this.ga.gb(Db.a.x0a,cc.a.view,ah.a.tF,96)}N_m(b,h,n,x,E){if(1===n)return 3===this.ga.mode||2===this.ga.mode?
32:8;b=h.node;h=this.acj(h);E=3===E.Qw;this.n4.value.HZb(this.CIc(b),this.FAb(h),E,this.Vv);return 32}O_m(b,h,n,x,E){b=h.view.Cb;if(!b||nD.Zf.z5b(b.Rg))return 8;if(nD.Tg.Wva(Cd.ParagraphReader.KW,b.Rg))return nD.Lc.Yb(Gc.a.zf,{["Reason"]:Mc.a.pN}),8;if(1===n)return 3===this.ga.mode||2===this.ga.mode?32:8;n=b.ib.kb;h=this.acj(h);E=3===E.Qw;if(1===n.length&&Kd.SelectionEditor.xf(n.J(0)))return n=n.J(0).node,this.n4.value.HZb(this.CIc(n),this.FAb(h),E,this.Vv),32;b=[];for(x=0;x<n.length;x++){const S=
n.J(x);(!x&&Kd.SelectionEditor.sk(S)||Cd.ParagraphReader.gm(S)||Kd.SelectionEditor.Ek(S))&&b.push(S.node)}if(!b.length)return 8;n=Array(b.length);for(x=0;x<b.length;x++)n[x]=this.CIc(b[x]);n=Gx.APropertySet.sRh(n);this.n4.value.HZb(n,this.FAb(h),E,this.Vv);return 32}CIc(b){var h,n,x,E;const S=new qi.DictionaryPropertySet;S.setValue(ad.a.Ws,Cd.ParagraphReader.Ev(b));const ma=this.K0.JAa(b);var Fa=ma.lineSpacing;S.setValue(ad.a.KZ,Fa.unit);S.setValue(ad.a.ta,Fa.value);Fa=ma.beforeSpacing;S.setValue(ad.a.YCa,
Fa.unit);S.setValue(ad.a.ZCa,Fa.value);Fa=ma.afterSpacing;S.setValue(ad.a.WCa,Fa.unit);S.setValue(ad.a.XCa,Fa.value);(null===(h=this.oO)||void 0===h?0:h.vta)&&S.setValue(ad.a.KTc,ma.Qt);(null===(n=this.Vv)||void 0===n?0:n.iCa)&&S.setValue(wi.a.Xh,Cd.ParagraphReader.Xh(b));(null===(x=this.Vv)||void 0===x?0:x.iFa)&&S.setValue(wi.a.vM,Cd.ParagraphReader.shc(b));(null===(E=this.Vv)||void 0===E?0:E.Ita)&&S.setValue(wi.a.keepTogether,Cd.ParagraphReader.keepTogether(b));return S}static get Zf(){return Ai.a.instance}static get Tg(){return Rl.ContextSetEditor.instance}static get Lc(){return vb.a.instance}}
Object(r.a)(nD,"AParagraphDialogActor",null,[]);class TL extends nD{constructor(b,h,n,x,E,S){super(b,h,n,S);this.Lk=x;this.ep=E;this.I1h=(ma,Fa,$a,sb,Jb)=>{const Sb=Fa.view.Cb,oc=Sb.ib.kb.Qa;return 1===$a&&Sb.ib.kb.VD&&Cd.ParagraphReader.cK(oc.node)&&!ec.ListReader.pr?8:ah.a.tF(ma,Fa,$a,sb,Jb)}}Vb(){super.Vb();this.ga.gb(Db.a.jHb,cc.a.view,ah.a.JQ,96);this.ga.gb(Db.a.lVc,cc.a.view,ah.a.JQ,96);this.ga.gb(Db.a.Yac,cc.a.view,ah.a.JQ,96);this.ga.gb(Db.a.E4b,cc.a.view,ah.a.tF,96);this.ga.gb(Db.a.$Kd,cc.a.view,
ah.a.tF,96);this.ga.gb(Db.a.Dec,cc.a.view,ah.a.tF,96);this.ga.gb(Db.a.o8d,cc.a.view,ah.a.tF,96);this.ga.gb(Db.a.Hma,cc.a.view,ah.a.tF,96);this.ga.gb(Db.a.y0a,cc.a.view,this.I1h,96);this.ga.gb(Db.a.XXd,cc.a.view,this.I1h,96);this.ga.gb(Db.a.s8d,cc.a.view,ah.a.tF,96);this.ga.gb(Db.a.E0d,cc.a.view,ah.a.JQ,96);this.ga.gb(Db.a.abc,cc.a.view,ah.a.JQ,96)}acj(b){return this.Lk.m$(b.tk)}CIc(b){const h=super.CIc(b);var n=this.ep.eT(b);const x=this.ep.pF(b);h.setValue(ad.a.xaa,1);h.setValue(ad.a.yaa,n.gt-x.gt);
n=this.ep.jYa(b);h.setValue(ad.a.wua,n.unit);h.setValue(ad.a.xua,n.value);b=this.ep.c3b(b);b.specialIndentType&&(h.setValue(ad.a.LI,b.specialIndentType),h.setValue(ad.a.aba,b.unit),h.setValue(ad.a.q_,b.value));return h}FAb(b){const h=new qi.DictionaryPropertySet;h.setValue(ic.a.Ko,this.Lk.Gv(b));h.setValue(ic.a.Xx,this.Lk.oA(b));h.setValue(ic.a.marginTop,Math.abs(this.Lk.Zka(b)));h.setValue(ic.a.marginBottom,Math.abs(this.Lk.Hsa(b)));h.setValue(ic.a.marginLeft,this.Lk.vL(b));h.setValue(ic.a.marginRight,
this.Lk.wL(b));return h}}Object(r.a)(TL,"ParagraphDialogActor",nD,[]);class UL extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.bOd=h}}Object(r.a)(UL,"AfterPasteEventArgs",Sys.EventArgs,[]);class VL{constructor(b){this.qse=this.xse=null;this.Z9c=b}get eCd(){return null!=this.tig?this.tig:this.tig=Oa.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}get p$l(){this.xse||(this.xse=!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate(Yq.a.jxh,
!1));return this.xse}get YMd(){this.qse||(this.qse=!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.$(Yq.a.qxh));return this.qse}r8m(b){if(b&&Kf.OutlineElementReader.Nh(b.psa)&&Kf.OutlineElementReader.Nh(b.ugb)){this.M8m(b);var h=new Lf.a;for(h.fd(b.psa);h&&h.currentNode;){const n=this.oGd(h),x=Cd.ParagraphReader.oc(n);x&&Cd.ParagraphReader.Cab(n)&&this.p8m(n);const E=h.currentNode.id===b.ugb.currentNode.id;x&&(this.p$l||this.YMd)&&n.Ti.lea(n.type).Z0d(new UL(n,E));if(E)break;wf.OutlineElementNavigator.Rr(h,
!1,!1)}}}p8m(b){w.ULS.sendTraceTag(590435214,307,50,"ProcessParagraphForExternalContent: Processing the pasted the external content (oEmbed) component via external paste flow.");const h=b.dac;b=Dd.a.Uc(b,0);fn.YMc(h)?this.eCd.dZd(b,h):this.Z9c.dZd(b,h)}M8m(b){if(b.psa.currentNode&&b.ugb.currentNode&&b.psa.currentNode.id===b.ugb.currentNode.id){const h=this.oGd(b.psa);Cd.ParagraphReader.oc(h)?this.u8m(h,b.A1m,b.z1m):w.ULS.sendTraceTag(590955995,307,50,"ProcessSinglePastedHyperlink: No paragraph node pasted.")}}u8m(b,
h,n){w.ULS.shipAssertTag(590956771,307,0<=h);w.ULS.shipAssertTag(590958592,307,0<=n);var x=Cd.ParagraphReader.text(b);if(""!==x){var E=Dd.a.createTextRange(b,h,n);E=nh.HyperlinkReader.NC(E,!1);if(1===E.length){const S=E[0];E=x.substring(h,n).trim();x=x.substring(S.cpBegin,S.cpEnd).trim();h=E===x;E=Dd.a.createTextRange(b,S.cpBegin,S.cpEnd);if(S.hyperlink&&h&&!nh.HyperlinkReader.xMa(x))b=S.hyperlink.url;else if(h)b=x;else{w.ULS.sendTraceTag(590958596,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because the pasted text is not equal to the pasted hyperlink display text");
return}fn.YMc(b)?this.eCd.JLa(E,b,!1):this.Z9c.JLa(E,b,!1)}else w.ULS.sendTraceTag(590958597,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because either no hyperlinks or more than one hyperlink got pasted  Hyperlinks pasted = {0}",E.length)}}oGd(b){const h=wf.OutlineElementNavigator.He(b);wf.OutlineElementNavigator.ae(b);return h}}Object(r.a)(VL,"PastedContentsProcessorPostMergeAfterPaste",null,[595]);class sH extends Qn{constructor(b,h,n,x,E,S,ma,Fa){super(x);this.IEe=7;this.dB=
this.vmc=null;this.Zqe=0;this.Wqe=b;this.Ok=h;this.Rm=n;this.le=E;this.Zsj=ma;this.pTa=Fa;this.V0=this.le.aNa("UserAction","WordIgnoreAll")}pYf(b){this.Wqe.Sli();this.vmc=this.Rm.Ska(b);this.pTa.X4h(this.vmc,null,!1);return this.Wqe.Ccj(this.vmc)?(this.V0.start(),this.dB=new Se.GraphTransaction(15),this.dB.Db(b.node),!0):!1}p_d(b){this.TGb(b.node);return!0}JUc(b){this.TGb(b);return!0}q_d(b){this.TGb(b.node)}b3f(b){this.dB.dispose();this.vmc.errorDetails.vlb(b.actionId);this.V0.stop();w.ULS.sendTraceTag(19779652,
324,50,String.format("Ignore-all succeeded. Actual ignored errors: {0}. Duration in milliseconds: {1}. Type: {2}",this.Zqe,this.V0.ni,this.vmc.errorDetails.proofingType));return!0}Bec(b,h){if(super.Bec(b,h))return!0;b=b.role;return 9===b||10===b||13===b||7===b||8===b}MVh(b){if(b&&b.type!==this.IEe){const h=md.GraphIterator.$a(b);return h.Bb(this.IEe)?h.kd(this.IEe):b}return b}wcm(b,h){return this.Wqe.K6d(h.errorDetails)&&!this.Ok.L$(Dd.a.createTextRange(b,h.begin,h.end))}TGb(b){if(b){var h=this.Rm.Y1(b,
n=>this.wcm(b,n));this.Zsj?this.Rm.cjb(b,h,!0):0<h.length&&(b.Sj(4,!0),this.Rm.oFb(b));this.Zqe+=h.length}}}Object(r.a)(sH,"IgnoreAllCallbackSteps",Qn,[]);class XL{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic){this.vVc=(gd,Gd,vd,ce,od)=>{if(1===vd)return 32;gd=this.zH.VXa(Gd.view.Cb.Rg);if(gd=vj.a.lg(gd))od[nl.a.LabelText]=gd.displayName;return 32};this.sla=(gd,Gd,vd,ce,od,Yd)=>{const ne=new sH(this.pFj,this.Ok,this.Rm,this.Ge,this.le,this.lV,0,this.pTa);return new Qd(gd,Gd,vd,ce,od,Yd,ne,this.ga,
this.hb,this.Ge,"IgnoreAllOperation")};this.Sxb=(gd,Gd,vd,ce,od,Yd)=>{const ne=new sH(this.Xzj,this.Ok,this.Rm,this.Ge,this.le,this.lV,1,this.pTa);return new Qd(gd,Gd,vd,ce,od,Yd,ne,this.ga,this.hb,this.Ge,"DoNotCheckThisCritiqueType")};this.ga=b;this.Ok=h;this.hb=n;this.Ge=x;this.Rm=S;this.zH=ma;this.le=Fa;this.pFj=$a;this.Xzj=sb;this.UQb=Jb.aOc;this.lV=Jb;this.pTa=Sb;this.Zse=oc;this.R4a=Ic}Vb(){this.Zse&&(Tj.a.Jy()?this.ga.gb(Db.a.sla,cc.a.Wc,this.sYl.bind(this),1028):this.ga.jS(Db.a.sla,cc.a.view,
this.sla,1028));this.UQb&&this.ga.jS(Db.a.Sxb,cc.a.view,this.Sxb,1028);this.ga.gb(ub.a.vVc,cc.a.view,this.vVc,96)}sYl(b,h,n,x,E){if(1===n)return 32;w.ULS.sendTraceTag(528023773,324,50,"Ignore All error triggered for AL");this.R4a.Bif(E?E:h,null,Rn.b.IgnoreAll);return 32}}Object(r.a)(XL,"ProofingActor",null,[]);var qA=d(1159),ZP=d(1634);class rA{constructor(b,h,n,x,E,S,ma,Fa,$a){this.Rp=this.hIa=this.Kld=this.Lld=null;this.sD=this.Yq=this.zp=0;this.y6a=this.x6a=!1;this.V8=this.iOb=this.hOb=this.gOb=
this.jOb=0;this.Jkd=null;this.Iba=this.nV=this.oq=this.PO=0;this.em=null;this.Fpb=0;this.hj=n;this._image=b;this._context=h;this.sdd=!1;(b=rA.oh.gu(h.node))&&b.Og(ic.a.msf)&&(this.sdd=!0);this.roc=x.$("ImageDataURLPresentationIsEnabled");this.lPj=x.$("WordOartPostRequestIsEnabled");this.Ma=x;this.Lq=E;this.le=S;this.Hd=ma;this.sm=Fa;this.dJ=$a;this.y1l()}y1l(){this.Rp="";this.zp=Pd.ImageReader.nA(this._image);this.Yq=Pd.ImageReader.zB(this._image);this.V8=Pd.ImageReader.Cdb(this._image);this.sD=Pd.ImageReader.oZ(this._image);
this.x6a=Pd.ImageReader.$Ed(this._image);this.y6a=Pd.ImageReader.Ozb(this._image);this.jOb=Math.max(Pd.ImageReader.Xka(this._image),0);this.gOb=Math.max(Pd.ImageReader.Uka(this._image),0);this.hOb=Math.max(Pd.ImageReader.Vka(this._image),0);this.iOb=Math.max(Pd.ImageReader.Wka(this._image),0);this.em=na.a.nil;this.hIa=null;this.Fpb=Pd.ImageReader.tl(this._image)}lsd(b,h){return(new ZP.a(this.Lq,this.Fpb,this.Ma,this.zp,this.Yq,this.sD,this.V8,this.jOb,this.gOb,this.hOb,this.iOb,this.x6a,this.y6a,
this.sdd)).build(this._context.node,this._image,b,h)}resize(b,h){this.Rp="Resize";this.E8d();ue.a.mark(this.K2b());this.zp=b;this.Yq=h;this.sendMessage(!1,Object(v.a)(this,this.v0a,"onRequestSuccess"))}Qv(b){this.Rp="Styles";this.E8d();ue.a.mark(this.K2b());this.V8=b;this.sendMessage(!1,Object(v.a)(this,this.v0a,"onRequestSuccess"))}$Kn(b,h,n){this.Rp="Rotation";this.E8d();this.sD=b;this.x6a=h;this.y6a=n;this.sendMessage(!1,Object(v.a)(this,this.v0a,"onRequestSuccess"))}ZKn(b,h){this.Rp="SwordRequestManager";
this.E8d();this.hIa=b;this.sD=h.angle;this.zp=h.width;this.Yq=h.height;this.V8=h.styleId;this.jOb=h.top;this.gOb=h.bottom;this.hOb=h.left;this.iOb=h.right;this.em=h.K1;this.sendMessage(!1,Object(v.a)(this,this.v0a,"onRequestSuccess"))}sendMessage(b,h){if(this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")){var n=this.Qab(n);const x=Pd.ImageReader.dla(this._image,this.Ma,this.Lq);x?qA.a.Xjb(this._image,x,4):this._image.setValue(Ji.a.DCd,!0);n.dispose()}this.l6i(b);ue.a.mark(this.K2b());b=
new Ea.QueryStringBuilder(this.lsd(b,!0));this.roc&&b.Me(Ve.a.pvh,"true");this.lPj?(n=new Ea.QueryStringBuilder("WordOart.ashx"),u.AFrameworkApplication.Ze.Lj(n.toString(),2,b.toString(),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!0,0,h,Object(v.a)(this,this.HGf,"onRequestFail"),null)):u.AFrameworkApplication.Ze.Lj(b.toString(),1,"",null,!0,0,h,Object(v.a)(this,this.HGf,"onRequestFail"),null)}Qab(b){b=this.em&&this.em!==na.a.nil?new Se.GraphTransaction(7,Db.a.imageRotate):
new Se.GraphTransaction(15);b.Db(this._context.node);return b}get Fnj(){const b=new Se.GraphTransaction(3);b.Db(this._context.node);return b}y3d(){this.uEc();this.Ezd();const b=this.Fnj;var h=Pd.ImageReader.uAa(this._image,this._context.node.Nc,this.Ma,this.Lq);this._image.setValue(Ji.a.DCd,!1);this._image.setValue(ad.a.XKc,h);this._image.setValue(ad.a.YJ,-1);this._image.setValue(Ji.a.d3,1);h=Pd.ImageReader.dla(this._image,this.Ma,this.Lq);this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&
(this._image.removeProperty(ad.a.xZd),this._image.removeProperty(ad.a.wZd),h&&qA.a.Xjb(this._image,h,3));b.dispose();rA.qp();this.hIa&&this.hIa()}HGf(b){if(5===this.Fpb){const h=Object.assign(new ab.a,{extendedProperties:new Map});h.extendedProperties.set("status",b.data.status.toString());h.extendedProperties.set("httpStatus",b.data.mf.toString());ta.Health.instance.recordQosError("PictureSwordRequestFailed",["ImageEditFailed"],!1,!0,!1,!1,h)}w.ULS.sendTraceTag(25182720,322,15,"Request failed: {0}. PlaceholderKind: {1}",
{["Status"]:b.data.status,["HttpStatus"]:b.data.mf,["Id"]:b.data.id,["ResponseData"]:b.data.Ee},mD.a[this.Fpb]);this.y3d()}l6i(b){this.le&&(b=String.format("Send Single {0} SWORD Request.",b?"PNG":"XML"),this.Lld=this.le.fg("WebServiceCall",b))}uEc(){this.Lld&&(this.Lld.stop(),this.Lld=null)}E8d(){if(this.le){const b=String.format("Send SWORD {0} Request. PlaceholderKind: {1}",this.Rp,mD.a[this.Fpb]);this.Kld=this.le.fg("WebServiceCall",b)}}Ezd(){this.Kld&&(this.Kld.stop(),this.Kld=null)}static get oh(){return ql.PageNavigator.instance}static qp(){const b=
new yd.StandardDialog;b.Ed=0;b.fy(ri.a.M2m,Box4Intl.Box4Strings.l_PictureStyleErrorTitle,Box4Intl.Box4Strings.l_PictureStyleError,null);ob.App.xa&&ob.App.xa.updateCommandUI()}}Object(r.a)(rA,"RenderedImageEditOperation",null,[626]);var tH=d(318),WF=d(521);class YL extends rA{constructor(b,h,n,x,E,S,ma,Fa,$a){super(b,h,n,x,E,S,ma,Fa,$a)}sendMessage(b,h){Object(tH.a)(()=>{let n;n=this.Qab(n);this._image.setValue(Ji.a.d3,0);n.dispose()});this.l6i(b);ue.a.mark(this.K2b());b=new Ea.QueryStringBuilder("WordOart.ashx");
this.ZGg=this.Ldb(!0,!1);b=new WF.a(b.toString(),2,this.Ldb(!1,!1),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!1,2,null,null,null,null,null,null,null,null,null,null,null,null,["Content-Type"],null,"text");u.AFrameworkApplication.Ze.send(b).qDa(h,n=>{this.HGf(n)})}v0a(b){try{const h=JSON.parse(b.data.GOa);this.oEj=h[Ve.a.zJc];this.GYj=h[Ve.a.width];this.EEj=h[Ve.a.height];this.ctg=h[Ve.a.Yxc];this.gmc=Array(4);this.gmc[0]=h[Ve.a.Bbb];this.gmc[1]=h[Ve.a.Cbb];this.gmc[2]=h[Ve.a.Dbb];
this.gmc[3]=h[Ve.a.Abb];this.sLg=void 0!==h[Ve.a.l7b]?"true"===h[Ve.a.l7b].toLowerCase():null;Object(tH.a)(()=>{this.O2c();this._context.node.Bi().contentReplicator.forceOutbound(()=>{this.J8k()},null,null)})}catch(h){w.ULS.sendTraceTag(526528851,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",h.message,this.Rp,Pd.ImageReader.tl(this._image)),this.y3d()}}nWd(){w.ULS.sendTraceTag(521175366,322,15,"onImageSuccess should not have been called")}O2c(){let b;
b=this.Qab(b);this._image.setValue(wi.a.Aea,this.oEj);this.ctg&&this._image.setValue(wi.a.Cqd,this.ctg);this._image.setValue(wi.a.TAa,this.GYj);this._image.setValue(wi.a.UAa,this.EEj);this._image.setValue(wi.a.vYa,this.gmc);this.vFj&&this._image.setValue(ad.a.t4b,this.vFj);qA.a.Xjb(this._image,this.ZGg,3);this._image.setValue(ic.a.ybb,this.ZGg);this.sLg?this._image.setValue(wi.a.rfb,this.sLg):this._image.removeProperty(wi.a.rfb);this.fuk();b.dispose()}fuk(){this._image.removeProperty(ad.a.Bu);this._image.removeProperty(ad.a.YJ);
this._image.removeProperty(ad.a.xZd);this._image.removeProperty(ad.a.wZd)}J8k(){this.dJ.PDa(this._context);if(this.em&&this.em!==na.a.nil){const b=this._context.node.Bi(),h=new C.a(this.em,1);this.sm.WYb(b,h)}this.Hd.us(13);this.uEc();this.Ezd();ue.a.mark(this.J2b());Object(tH.a)(()=>{let b;b=this.Qab(b);this._image.setValue(Ji.a.d3,1);b.dispose()});this.hIa&&this.hIa()}Ldb(b,h){b=new Ea.QueryStringBuilder(this.lsd(b,h));b.Me(Ve.a.NKd,"true");return b.toString()}K2b(){return 51511}J2b(){return 51512}}
Object(r.a)(YL,"RenderedGraphicEditOperation",rA,[]);class ZL extends rA{constructor(b,h,n,x,E,S,ma,Fa,$a,sb){super(b,h,n,x,E,S,ma,Fa,$a);this.eCg=null;this.nWd=Jb=>{const Sb=this.lsd(!0,!1);let oc;oc=this.Qab(oc);this._image.setValue(ic.a.Dqd,this.Jkd);var Ic=Oa.a.instance.Pa("Box4.IFeatureHelper");Ic&&Ic.isFeatureEnabled(51)&&this._image.setValue(ic.a.LAd,this.eCg);this.Ma.$("WordEditorImageRotateIsEnabled")&&this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.hj.w5d(this._image,
this.sD,this.x6a,this.y6a);const gd=Pd.ImageReader.dla(this._image,this.Ma,this.Lq),Gd=()=>{gd&&qA.a.Xjb(this._image,gd,3);qA.a.Xjb(this._image,Sb,3);this.hj.u5d(this._image,Jf.a.jF(this.PO),Jf.a.jF(this.nV),Jf.a.jF(this.oq),Jf.a.jF(this.Iba));this._image.setValue(ic.a.ybb,Sb);Pd.ImageReader.Sx(this._image)||this._image.setValue(ic.a.kBa,1);this.hj.g5d(this._image,this.zp,this.Yq);this.Ma.$("WordEditorImageRotateIsEnabled")&&!this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.hj.w5d(this._image,
this.sD,this.x6a,this.y6a);2===Jb.data.status&&Pd.ImageReader.FZ(Jb.data.Ee)&&(this._image.setValue(ad.a.Bu,Jb.data.Ee),Jb.data.request&&this._image.setValue(ad.a.t4b,qA.a.bFc("POST"===Jb.data.request.get_httpVerb()?Jb.data.request.get_body():Jb.data.request.get_url())));this.hIa&&this.hIa();this.dJ.PDa(this._context);if(this.em&&this.em!==na.a.nil){const vd=this._context.node.Bi(),ce=new C.a(this.em,1);this.sm.WYb(vd,ce)}this.Hd.us(13);this.uEc();this.Ezd();ue.a.mark(this.J2b())};if(this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&
this.em&&this.em!==na.a.nil&&(Ic=this._context.node.Bi())&&Ic.contentReplicator){oc.dispose();Ic.contentReplicator.forceOutbound(()=>{let vd;vd=this.Qab(vd);Gd();vd.dispose()},null,null);return}Gd();oc.dispose()};this.gDe=sb}K2b(){return 51511}J2b(){return 51512}v0a(b){try{var h=JSON.parse(b.data.Ee);const E=Sys.Net.XMLDOM("string"===typeof h[Ve.a.y$g]?h[Ve.a.y$g]:null);this.Jkd="string"===typeof h[Ve.a.Eqd]?h[Ve.a.Eqd]:null;const S=Oa.a.instance.Pa("Box4.IFeatureHelper");S&&S.isFeatureEnabled(51)&&
(this.eCg="string"===typeof h[Ve.a.K0b]?h[Ve.a.K0b]:null);V.a.zk&&E.setProperty("SelectionNamespaces","xmlns:mc='"+vc.a.S9j+"'");const ma=E.selectSingleNode("/mc:AlternateContent");if(!ma)throw kj.a.argument("Alternate content element could not be retrieved!");const Fa=ma.firstChild;if(!Fa)throw kj.a.argument("Alternate content choice element could not be retrieved!");const $a=Fa.firstChild;if(!$a)throw kj.a.argument("Drawing element could not be retrieved!");var n=$a.firstChild;if(!n)throw kj.a.argument("Inline element could not be retrieved!");
h=b=null;const sb=RegExp("effectExtent"),Jb=RegExp("extent");for(let oc of n.childNodes)-1!==oc.nodeName.search(sb)&&(b=oc),-1!==oc.nodeName.search(Jb)&&(h=oc);if(!b||!h)throw kj.a.argument("Effect extent or extent could not be retrieved!");this.PO=parseInt(b.selectSingleNode("@l").text);this.nV=parseInt(b.selectSingleNode("@r").text);this.oq=parseInt(b.selectSingleNode("@t").text);this.Iba=parseInt(b.selectSingleNode("@b").text);const Sb=bj.c(this.sD);if(45<=Sb&&135>=Sb||225<=Sb&&315>=Sb){const oc=
parseInt(h.selectSingleNode("@cx").text);var x=parseInt(h.selectSingleNode("@cy").text);n=oc/2;x/=2;this.PO-=n-x;this.nV+=n-x;this.oq-=x-n;this.Iba+=x-n}}catch(E){w.ULS.sendTraceTag(42079129,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",E.message,this.Rp,mD.a[this.gDe]);this.y3d();return}this.sendMessage(!0,this.nWd)}}Object(r.a)(ZL,"RenderedDrawingEditOperation",rA,[]);class $L extends rA{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb){super(b,h,n,x,E,S,ma,
Fa,$a);this.F8=null;this.nWd=Sb=>{const oc=this.lsd(!0,!1);let Ic;Ic=this.Qab(Ic);this._image.setValue(ic.a.tGb,this.Jkd);const gd=Pd.ImageReader.dla(this._image,this.Ma,this.Lq),Gd=()=>{gd&&qA.a.Xjb(this._image,gd,3);qA.a.Xjb(this._image,oc,3);this.hj.u5d(this._image,Jf.a.jF(this.PO),Jf.a.jF(this.nV),Jf.a.jF(this.oq),Jf.a.jF(this.Iba));this._image.setValue(ic.a.ybb,oc);Pd.ImageReader.Sx(this._image)||this._image.setValue(ic.a.kBa,1);this._image.setValue(ic.a.eUc,this.V8);this._image.setValue(ad.a.dZl,
-1);this.wc.isFeatureEnabled(96)&&Pd.ImageReader.Q3b(this._image)&&this.vo.q2d(this._image);this._image.setValue(Ji.a.DCd,!1);this.hj.g5d(this._image,this.zp,this.Yq);this.Ma.$("WordEditorImageRotateIsEnabled")&&this.hj.w5d(this._image,this.sD,this.x6a,this.y6a);this.Ma.$("WordEditorImageCropIsEnabled")&&this.hj.NWf(this._image,this.jOb,this.gOb,this.hOb,this.iOb);2===Sb.data.status&&Pd.ImageReader.FZ(Sb.data.Ee)&&(this._image.setValue(ad.a.Bu,Sb.data.Ee),Sb.data.request&&this._image.setValue(ad.a.t4b,
qA.a.bFc("POST"===Sb.data.request.get_httpVerb()?Sb.data.request.get_body():Sb.data.request.get_url())));this.hIa&&this.hIa();this.dJ.PDa(this._context);if(this.em&&this.em!==na.a.nil){const vd=this._context.node.Bi(),ce=new C.a(this.em,1);this.sm.WYb(vd,ce)}this.Hd.us(13);this.uEc();this.Ezd();ue.a.mark(this.J2b())};if(this.Ma.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.em&&this.em!==na.a.nil){const vd=this._context.node.Bi();if(vd&&vd.contentReplicator){Ic.dispose();vd.contentReplicator.forceOutbound(()=>
{let ce;ce=this.Qab(ce);Gd();ce.dispose()},null,null);return}}Gd();Ic.dispose()};this.gDe=sb;this.wc=Jb}K2b(){return 7988}J2b(){return 7989}get vo(){this.F8||(this.F8=new ML.a);return this.F8}v0a(b){try{const h=b.data.gga;this.Jkd=b.data.Ee;V.a.zk&&h.setProperty("SelectionNamespaces","xmlns:pic='"+vc.a.K2m+"'");const n=h.selectSingleNode("/pic:wordEdit/pic:spPr").nextSibling;this.PO=parseInt(n.selectSingleNode("@l").text);this.nV=parseInt(n.selectSingleNode("@r").text);this.oq=parseInt(n.selectSingleNode("@t").text);
this.Iba=parseInt(n.selectSingleNode("@b").text)}catch(h){b=Object.assign(new ab.a,{extendedProperties:new Map});b.extendedProperties.set("exception",h.message);b.extendedProperties.set("operation",this.Rp);ta.Health.instance.recordQosError("PictureSwordResponseInvalid",["ImageEditFailed"],!1,!0,!1,!1,b);w.ULS.sendTraceTag(25182691,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",h.message,this.Rp,mD.a[this.gDe]);this.y3d();return}this.uEc();ue.a.mark(this.J2b());
this.sendMessage(!0,this.nWd)}}Object(r.a)($L,"RenderedPictureEditOperation",rA,[]);class aM{constructor(b,h,n,x,E,S,ma,Fa){this.hj=b;this.Ma=h;this.Lq=n;this.le=x;this.Hd=E;this.sm=S;this.dJ=ma;this.wc=Fa}create(b,h){const n=Pd.ImageReader.tl(b);return Kb.App.instance.nta(n)?new YL(b,h,this.hj,this.Ma,this.Lq,this.le,this.Hd,this.sm,this.dJ):10===n||11===n||48===n||4===n?new ZL(b,h,this.hj,this.Ma,this.Lq,this.le,this.Hd,this.sm,this.dJ,n):5===n?new $L(b,h,this.hj,this.Ma,this.Lq,this.le,this.Hd,
this.sm,this.dJ,n,this.wc):null}}Object(r.a)(aM,"Factory",null,[593]);class bM{constructor(){this.HDc=b=>{const h=window.performance.now(),n=Hk.a.Mx();if(n){b=kH.a(b.customData,n);b=cn.a.Ir(b,n);var x=0,E=new Se.GraphTransaction(3);try{for(E.Db(n);b.moveNext();){if(!Cd.ParagraphReader.wh(b.iterator))continue;const S=b.currentNode;this.Uzh(S)&&(x++,S.Sj(4,!0));const ma=window.performance.now()-h;if(2500<x||100<ma){this.Asb=null;this.RVc(S);break}}}finally{E&&E.dispose()}}else sd.b(570450380,3018,10,
"PageContentNode not found")};this.Asb=null}O8h(){const b=Hk.a.Mx();this.cWc(b);this.RVc(null)}RVc(b){this.Asb&&(u.AFrameworkApplication.uc.ef(this.Asb),this.Asb=null);this.Asb=new We.a(1,1,1,this.HDc,198);this.Asb.customData=b;u.AFrameworkApplication.uc.$b(this.Asb)}cWc(b){const h=kH.b(b);if(h){var n=new Se.GraphTransaction(3);try{for(n.Db(b);h.moveNext();){if(!Cd.ParagraphReader.wh(h.iterator))continue;const x=h.currentNode;this.Uzh(x)&&x.Sj(4,!0)}}finally{n&&n.dispose()}}}Uzh(b){b=b.pD;for(let h of b)if(h.X5b)return 0<
h.sKb;return!1}}Object(r.a)(bM,"RenderParagraphsContainingTabs",null,[]);class cM{constructor(b,h){this.Sle=!0;this.$kc=null;this.eXk=()=>{this.$kc=null;this.Sle=!0;this.iIa&&this.iIa.jQa(!ob.App.XJ())};this.K3a=(n,x,E)=>{if(1===E)return 32;2===E&&(n=!1,ob.App.XJ()?this.Sle=!1:this.Sle?n=!0:this.sko(),this.iIa&&this.iIa.jQa(n));return 32};this.ga=b;this.iIa=h}Vb(){this.ga.gb(Ra.a.K3a,cc.a.application,this.K3a,1124)}sko(){this.$kc?u.AFrameworkApplication.uc.ef(this.$kc):this.$kc=new We.a(4,1,5E3,this.eXk);
u.AFrameworkApplication.uc.$b(this.$kc)}}Object(r.a)(cM,"SaveStatusActor",null,[]);class dM{constructor(b,h){this.evb=(n,x,E)=>{n=Hk.a.kDb(x);if(1===E||n)return n?8:32;this.n4.value.RFk(x);return 32};this.createNewStyle=(n,x,E)=>{n=Hk.a.kDb(x);if(1===E||n)return n?8:32;this.n4.value.AJk(x,this.ga);return 32};this.M1e=(n,x,E)=>{n=Hk.a.kDb(x)||this.rQn();if(1===E||n)return n?8:32;this.n4.value.M1e(x);return 32};this.ga=b;this.n4=h}get uUf(){return null!=this.xog?this.xog:this.xog=Oa.a.instance.Pa("Box4.ISaveStyleManager")}get Wtn(){return this.Vtn||
(this.Vtn=Oa.a.instance.Pa("Box4.IResetAndDeleteStyleManager"))}get Gj(){return null!=this.lpg?this.lpg:this.lpg=Oa.a.instance.Pa("Box4.Styles.StyleSettings")}get pc(){return null!=this.Jrg?this.Jrg:this.Jrg=Oa.a.instance.resolve("Box4.Styles.IWACStyleReader")}Vb(){this.ga.gb(Db.a.evb,cc.a.view,this.evb,1028);this.ga.gb(Db.a.createNewStyle,cc.a.view,this.createNewStyle,4);this.ga.gb(Db.a.Hxb,cc.a.view,this.M1e,4);this.ga.gb(Db.a.tUf,cc.a.view,this.Xzn.bind(this),4);this.ga.gb(Db.a.PSf,cc.a.view,this.QSf.bind(this),
4);this.ga.gb(Db.a.K1e,cc.a.view,this.jRk.bind(this),4)}Xzn(b,h,n){b=Hk.a.kDb(h)||this.wQn();if(1===n||b)return b?8:32;this.uUf.Wzn();return 32}QSf(b,h,n){b=Hk.a.kDb(h)||this.uQn();if(1===n||b)return b?8:32;this.Wtn.QSf();return 32}jRk(b,h,n){b=Hk.a.kDb(h)||this.qQn();if(1===n||b)return b?8:32;this.n4.value.iRk();return 32}qQn(){return"{}"===cD.a.$lb?!0:!1}uQn(){if(0==cD.a.I2.size)return!0;var b=cD.a.I2;const h=this.pc.Ip();let n=0;for(let x of b.values())b=h.uh(x),this.pc.me(b,h)||n++;return 0==
n?!0:!1}wQn(){var b=cD.a.$lb,h=cD.a.I2;const n=this.pc.Ip();if(0==h.size)return!0;if(!({Dv:b}=z.d(b)).returnValue)return w.ULS.sendTraceTag(526979992,3017,15,"Received null string during  deserialization: StylesActor."),!0;if(Object.keys(b).length!=h.size)return!1;for(let E of h.values()){h=n.uh(E);var x=b[E];if(null==x)return!1;if(x=Hk.a.iHd(x)){if(this.Gj.WW||(h=Hk.a.fHc(h,n)),Hk.a.ENc(h,x))return!1}else w.ULS.sendTraceTag(526979993,3017,15,"Received null style during de serialization: StylesActor.")}return!0}rQn(){var b=
Hk.a.Mx();if(!b)return sd.b(577368330,3018,15,"PageContentNode is null"),!0;b=(new Zv.WACStyleSet).SN(b);const h=b.tN;for(let x=0;x<h;x++){var n=b.ela(x);if(this.pc.isHidden(n)||!this.pc.me(n,b))continue;const E=this.pc.Ow(n);if(2===E||1===E)if(!n.hasProperty(ic.a.Gc)||2===E)if(n=n.ia(ic.a.ZE,null),!(n&&0<n.length))return!1}return!0}}Object(r.a)(dM,"StylesActor",null,[]);class XF{constructor(b){this.t9d=(h,n,x)=>{h=u.AFrameworkApplication.ua;if(1===x)return 1!==h.mode||Vh.SessionStatusManager.instance.Qj?
2:32;ta.Health.instance.recordKpiUsage("SwitchToClassicViewMode",0,XF.vB,null);const E={};E[G.a.lkf]=u.AFrameworkApplication.K.lb("ClassicViewModePreferenceCookieName");E[G.a.v4h]="true";u.AFrameworkApplication.WP().execute(S=>{S.sendMessage(F.a.R0n,E)});return u.AFrameworkApplication.ya.processAction(Db.a.xHb,2)};this.ga=b}Vb(){this.ga.pa(ub.a.t9d,cc.a.view,this.t9d)}}XF.vB="wwaengidc";Object(r.a)(XF,"SwitchToClassicViewModeActor",null,[]);class eM{constructor(b,h,n,x,E,S,ma,Fa,$a){this.angle=n;
this.styleId=x;this.width=b;this.height=h;this.top=E;this.bottom=S;this.left=ma;this.right=Fa;this.K1=$a}}Object(r.a)(eM,"SWordData",null,[]);class fM{constructor(b,h){this.Ml=this.CR=this.Pp=null;this.uDe=this.cSb=!1;this.PO=this.nV=this.Iba=this.oq=this.V8=this.Yq=this.zp=this.sD=0;this.em=null;this.nX=()=>{this.uDe=!1;this.cSb&&this.yEc()};this.nm=b;this.Ltc=h;this.t6h()}t6h(){this.nV=this.PO=this.Iba=this.oq=this.V8=this.Yq=this.zp=this.sD=-1;this.em=na.a.nil}yEc(){this.uDe||(this.uno(),this.PKk(),
this.cSb=!1)}PKk(){this.Ml=new eM(this.zp,this.Yq,this.sD,this.V8,this.oq,this.Iba,this.PO,this.nV,this.em);this.Ltc.create(this.CR,this.Pp).ZKn(this.nX,this.Ml);this.uDe=!0;let b;Object(pb.a)(3,this.CR)?b=mD.a[Pd.ImageReader.tl(this.CR)]:(w.ULS.sendTraceTag(42469523,322,50,"Unable to acquire PlaceholderKind because the image property set isn't of the type which contains information about the PlaceholderKind."),b="generic");w.ULS.sendTraceTag(23171277,322,50,"Sending request to SWord with width: {0}, height: {1}, angle: {2}, style: {3}, top: {4}, bottom: {5}, left: {6}, right: {7}, placeholderKind: {8}",
this.zp,this.Yq,this.sD,this.V8,this.oq,this.Iba,this.PO,this.nV,b);this.t6h()}uno(){this.zp=-1!==this.zp?this.zp:this.CR.ia(ad.a.jBa,-1);this.Yq=-1!==this.Yq?this.Yq:this.CR.ia(ad.a.iBa,-1);this.zp=-1!==this.zp?this.zp:this.nm.nA(this.CR);this.Yq=-1!==this.Yq?this.Yq:this.nm.zB(this.CR);this.sD=-1!==this.sD?this.sD:this.nm.oZ(this.CR);this.V8=-1!==this.V8?this.V8:this.nm.Cdb(this.CR);this.oq=-1!==this.oq?this.oq:this.nm.Xka(this.CR);this.Iba=-1!==this.Iba?this.Iba:this.nm.Uka(this.CR);this.PO=-1!==
this.PO?this.PO:this.nm.Vka(this.CR);this.nV=-1!==this.nV?this.nV:this.nm.Wka(this.CR)}qbn(b,h,n,x){this.Pp=b;this.sD=n;this.cSb=!0;this.CR=h;this.em=x;this.yEc()}pbn(b,h,n,x,E){this.Pp=b;this.cSb=!0;this.CR=h;this.em=E;this.CR.setValue(ad.a.jBa,n);this.CR.setValue(ad.a.iBa,x);this.yEc()}ubn(b,h,n){this.Pp=b;this.cSb=!0;this.CR=h;this.V8=n;this.yEc()}jbn(b,h,n,x,E,S){this.Pp=b;this.oq=n;this.Iba=x;this.PO=E;this.nV=S;this.cSb=!0;this.CR=h;h=b=0;({width:b,height:h}=this.nm.Nzb(this.CR));this.zp=b-
(E+S)/1E5*b;this.Yq=h-(n+x)/1E5*h;this.yEc()}}Object(r.a)(fM,"SWordRequestManager",null,[592]);class uE{constructor(b,h,n,x=null,E=null,S=null,ma=null,Fa=null,$a=null,sb=null){this.sm=null;this.y3g=!1;this.f3n=(Jb,Sb,oc,Ic,gd)=>{if(1===oc)return 32;const Gd=Jb===Db.a.CYf;if(!Sb.view.Be)return 2;const vd=Sb.view,ce=vd.Cb,od=ce.Rg;if(!od||uE.Zf.bZ(od))return 2;if(this.Cm&&this.Cm.instance&&this.Cm.instance.vT(od))return 4;Jb=null;var Yd=pd.ActionManager.eua;let ne=!1;var Df=Kd.SelectionEditor.xf(od);
if(od.Rw){if(ce.ib.rI&&(Yd=od.getContext(0),Jb=new md.GraphIterator,Jb.set(Yd.node),Jb.qo(),Yd=Gd?Db.a.SUf:Db.a.t4d),Yd=this.OHe.S6m(Yd),Yd===pd.ActionManager.eua){var Af=uE.Tg.oS(od,16);Af?(Gd&&(Yd=Db.a.oUd),Jb=new md.GraphIterator,Jb.set(Af.node),Jb.vd()):Yd=Gd?Db.a.HF:Db.a.zN}}else if(od.ul)if(Jb=new md.GraphIterator,Jb.set(od.node),Kd.SelectionEditor.Gt(Jb),gf.OutlineReader.jMa(od))Yd=Gd?Db.a.SUf:Db.a.t4d;else{if(this.Uqe&&this.Uqe.nSn(od))return this.Uqe.oZc(od,vd.Tb,Gd),32;Yd=Gd?this.OHe.bPl(Jb,
od,Yd,Sb):this.OHe.aPl(Jb,od,Yd,Sb);Kf.OutlineElementReader.Nh(Jb)&&od.contextId===cc.a.Wc&&(ne=Kf.OutlineElementReader.Mz(Jb,od,!1));Af=ec.ListReader.$h(Jb)&&ne;Yd!==pd.ActionManager.eua||Fg.TableCellReader.tMa(Jb)||Af||(this.y3g||(w.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.y3g=!0),u.AFrameworkApplication.ya.processAction(Db.a.P6h,2),this.n7h(Sb))}else return 2;if(!Gd&&Yd===pd.ActionManager.eua&&Fg.TableCellReader.tMa(Jb))if($d.returnToCell(Jb),Fg.TableCellReader.fMa(Jb)||
ag.TableReader.Qbi(Jb)&&Fg.TableCellReader.xci(Jb)){if(Yd=this.TZj(),!Yd)return 2}else Yd=Db.a.hri;if(Yd===pd.ActionManager.eua)return 2;switch(Yd){case Db.a.hri:case Db.a.oUd:Ic=Yd===Db.a.oUd;Df&&this.a0&&this.UX&&(Df=this.a0.K7e(od,-1,!0,db.a.fx))&&this.UX.rTi(Df);oc=32;$d.returnToCell(Jb);$d.moveToNextOrPreviousCell(Jb,Ic)&&(Df=!0,Ic=!1,gf.OutlineReader.sjf(Jb)||(Te.OutlineNavigator.mzf(Jb,!1),wf.OutlineElementNavigator.He(Jb),Cd.ParagraphReader.uu(Jb.currentNode)&&(Df=!1,Cd.ParagraphReader.textLength(Jb.currentNode)||
(Ic=!0)),Ic||$d.returnToCell(Jb)),Ic?Jb=Ae.SelectionFactory.xe(Jb.currentNode,0):(Jb=Ae.SelectionFactory.ir(Jb.currentNode),!Df&&Kd.SelectionEditor.sk(Jb.Tc)&&(Df=Jb.toArray(),Array.removeAt(Df,Df.length-1),Jb=new om.Selection(Df,Jb.Wf))),ce.setSelection(Jb));break;case Db.a.SUf:case Db.a.t4d:Yd===Db.a.t4d?Te.OutlineNavigator.Iqi(Jb,!1):Te.OutlineNavigator.Iqi(Jb,!0);ce.setSelection(Ae.SelectionFactory.ir(Jb.currentNode));oc=32;break;case Db.a.i0c:oc=u.AFrameworkApplication.ya.Qf(Sb,Yd,oc,!0,Ic,gd);
break;default:if(oc=u.AFrameworkApplication.ya.Qf(Sb,Yd,oc,!0,Ic,gd),!ne&&Df&&(Yd===Db.a.HF||Yd===Db.a.zN)){const Wi=Kd.SelectionEditor.Pya(ce.ib.kb).y;ob.App.rbc(()=>{this.SHm(ce,vd,Wi)})}}32===oc&&Sb.view.Be&&this.vi.xF();return oc};this.aja=b;this.OHe=h;this.Cm=n;this.a0=x;this.UX=E;this.RHe=S;this.xFa=ma;this.wc=Fa;this.Hc=$a;this.Uqe=sb}get vi(){return this.sm||(this.sm=this.aja())}Vb(){const b=u.AFrameworkApplication.ya,h=this.f3n;b.gb(Db.a.tab,cc.a.view,h,1124);b.gb(Db.a.CYf,cc.a.view,h,1124);
b.pa(Db.a.P6h,cc.a.view,pd.ActionManager.Nf)}SHm(b,h,n){if(b&&h){var x=b.ib.kb;Kd.SelectionEditor.Pya(x).y<n?(h=Kd.SelectionEditor.tFc(h,x,!1),h=Kd.SelectionEditor.nsa(h,{XB:!1,Us:!1,aE:!1,VF:!0})):h=Kd.SelectionEditor.BBd(h,x,!1);b.setSelection(h)}}TZj(){return Db.a.kZa}n7h(){}uRc(b,h,n){if(b&&h){var x=b.ib.kb;Kd.SelectionEditor.Pya(x).y<n?(h=Kd.SelectionEditor.tFc(h,x,!1),h=Kd.SelectionEditor.nsa(h,{XB:!1,Us:!1,aE:!1,VF:!0})):h=Kd.SelectionEditor.nsa(x,{XB:!1,Us:!1,aE:!1,VF:!0});b.setSelection(h)}}static get Zf(){return Ai.a.instance}static get Tg(){return Rl.ContextSetEditor.instance}}
Object(r.a)(uE,"TabActor",null,[]);class uH{constructor(b){this.xoc=b}get np(){return this.xoc}S6m(b){return b}bPl(b,h,n,x){const E=x.view,S=E.Cb.ib.kb;if(Fg.TableCellReader.tMa(b))return this.Nbi(b,x)?Db.a.HF:Db.a.oUd;wf.OutlineElementNavigator.ae(b);if(Kd.SelectionEditor.xf(h))Kf.OutlineElementReader.Mz(b,h,!1)&&this.E1i(b)?n=Db.a.XGb:Kd.SelectionEditor.qOc(E,S)&&this.np.Uvb(b)?n=Db.a.HF:Kd.SelectionEditor.qOc(E,S)&&(n=Db.a.HF);else if(Kd.SelectionEditor.Ek(h)){if(!this.np.Uvb(b))return n;Kd.SelectionEditor.sfb(h)?
n=Db.a.HF:Kd.SelectionEditor.Bgi(h)&&(n=this.E1i(b)?Db.a.XGb:Db.a.HF)}else this.np.Uvb(b)&&(n=Db.a.HF);return n}aPl(b,h,n,x){if(Fg.TableCellReader.GZ(b))return this.Nbi(b,x)?Db.a.zN:n;wf.OutlineElementNavigator.ae(b);if(Kd.SelectionEditor.xf(h))Kf.OutlineElementReader.Mz(b,h,!1)&&(!ec.ListReader.$h(b)&&Kf.OutlineElementReader.isEmpty(b,!1)?n=pd.ActionManager.eua:this.pQn(b)?n=Db.a.lbb:this.O0i(b)?n=Db.a.Ixb:this.np.fYb(b)&&(n=Db.a.zN));else if(Kd.SelectionEditor.Ek(h)){if(!this.np.fYb(b))return n;
Kd.SelectionEditor.sfb(h)?n=Db.a.zN:Kd.SelectionEditor.Bgi(h)&&(n=this.O0i(b)?Db.a.Ixb:Db.a.zN)}else this.np.fYb(b)&&(n=Db.a.zN);return n}E1i(b){return ec.ListReader.$h(b)?!1:0<Kf.OutlineElementReader.Z1(b)?!0:!1}O0i(b){if(ec.ListReader.$h(b))return!1;const h=Kf.OutlineElementReader.Z1(b);b=gf.OutlineReader.rL(b.currentNode);return h<b?!0:!1}pQn(b){return ec.ListReader.$h(b)?!1:0<Kf.OutlineElementReader.pF(b)?!0:!1}static lr(){return new uH(Ig.a.gAb)}Nbi(b,h){if(this.Mgm){h=h.view;const n=h.Cb.ib.kb,
x=new md.GraphIterator;x.fd(b);wf.OutlineElementNavigator.ae(x);if(ec.ListReader.$h(x)&&Kd.SelectionEditor.qOc(h,n))return!0}return!1}get Mgm(){var b;u.AFrameworkApplication.Hf("egdi3422;7g6fa693");return null===(b=u.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.QOEForListInTableIsEnabled",!1)}}Object(r.a)(uH,"TabActorPromoteDemoteStrategy",null,[615]);class tC extends uE{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc){super(b,h,n,x,E,S,ma,Fa,$a,sb);
this.RSc=(Ic,gd)=>{Ic=gd.property;!this.oXc||Ic!==ic.a.Ko&&Ic!==ic.a.marginLeft&&Ic!==ic.a.marginRight||this.oXc.O8h()};this.rL=(Ic,gd,Gd,vd,ce)=>{Ic=gf.OutlineReader.rL(this.bBl(gd));ce.defaultTabStop=Ic;return 32};this.eSb=Jb;this.ga=oc;this.HA();this.ga.pa(ub.a.rL,cc.a.view,this.rL)}get oXc(){return null!=this.mog?this.mog:this.mog=Oa.a.instance.Pa("WordEditor.Actors.RenderParagraphsContainingTabs")}HA(){this.eSb.al.Te(10).jp(this.RSc)}n7h(b){const h=b.view,n=h.Cb;b=n.Rg;if(this.xFa&&this.Hc){var x=
this.Hc.Rc(15);x.Db(b.node);b.contextId===cc.a.Fd&&u.AFrameworkApplication.ya.processAction(Db.a.HG,2);this.xFa.HLd(n.Rg);x.dispose();var E=Kd.SelectionEditor.Pya(n.ib.kb).y;ob.App.rbc(()=>{this.uRc(n,h,E)})}}bBl(b){return b.view.Cb.ib.kb.Qa.node}static get instance(){return null!=tC.qlg?tC.qlg:tC.qlg=tC.Fl()}static Fl(){return new tC(()=>Oa.a.instance.resolve("Box4.IUndoManager"),uH.lr(),Oa.a.instance.Za("Box4.IExternalSelectionManager"),Oa.a.instance.resolve("Box4.IAutoCorrectRules"),Oa.a.instance.resolve("Box4.IAutoCorrectScheduler"),
Oa.a.instance.Pa("Box4.ITabPresenterFactory"),Oa.a.instance.Pa("Box4.IBlobEditor"),Oa.a.instance.Pa("Box4.IFeatureHelper"),Oa.a.instance.Pa("Box4.Graph.GraphTransactionFactory"),Oa.a.instance.Pa("Box4.Actors.IIFrameFocusStrategy"),ob.App.Wj,Oa.a.instance.Pa("Box4.ITabRenderer"),u.AFrameworkApplication.ya)}}Object(r.a)(tC,"TabActor",uE,[]);class Ju{static get Qs(){return null!=Ju.Yeg?Ju.Yeg:Ju.Yeg=Oa.a.instance.resolve("Box4.IAppFrame")}static initialize(){Oq.a.M6b=Ju.Jhm;Oq.a.c3a=Ju.cqo}static Jhm(b){return!ag.TableReader.Jcm(b)}static Ehb(){Ju.Qs.Fbc(Ju.Ehb);
Ju.vrb=!1;const b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Table")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Table"))}static cqo(b){b&&(Pq.a.instance.kb.eCa||Pq.a.instance.kb.tw||Pq.a.instance.kb.qDb)&&(Ju.vrb?Ju.E3("SimplifyRibbonContextualCommandsUsageControl","DefaultContextTabBehaviour"):(Ju.Qs.SUa(Ju.Ehb),Ju.vrb=!0,Ju.E3("SimplifyRibbonContextualCommandsUsageTreatment","EnableAutoContextualTabSwitch")))}static E3(b,
h){const n=Oa.a.instance.Za("Common.ISystemInitiatedFeedback");n&&n.execute(x=>{x.logActivity(b,h)})}}Ju.vrb=!1;Object(r.a)(Ju,"TableActor",null,[]);var $P=d(889);class vH{C8k(b,h,n,x){return b?this.e7k(h,n,x):this.D8k(h,n,x)}qGh(b,h,n,x,E){return b?this.f8k(h,n,x,E):this.U7k(h,n,x,E)}R7k(b){let h=!1;var n=b.Wf?b.Ke.Tc:b.Ke.Qa;b=new md.GraphIterator;b.set(n.node);b.Bb(14);n=null;Fg.TableCellReader.M$(b)?Fg.TableCellReader.GCb(b)||(h=!0,n=$d.moveToNextRow(b)):n=$d.moveToNextColumn(b);return{returnValue:n,
jIm:h}}a8k(b){var h=b.Wf?b.Ke.Tc:b.Ke.Qa;const n=new md.GraphIterator;n.set(h.node);n.Bb(14);h=null;Fg.TableCellReader.Uea(n)?Fg.TableCellReader.Tea(n)||(h=new md.GraphIterator,h.set(b.Rya.node),h.Bb(14),b=al.a.xt(h),al.a.xt(n)>b?($d.moveToPreviousRow(n),$d.moveToLastColumn(n),h=n.currentNode):h=$d.moveToPreviousRow(n)):h=$d.moveToPreviousColumn(n);return h}DGh(b,h){var n=b.Wf?b.Ke.Tc:b.Ke.Qa;b=new md.GraphIterator;b.set(n.node);b.Bb(14);n=null;h?Fg.TableCellReader.Tea(b)||(n=$d.moveToPreviousRow(b)):
Fg.TableCellReader.GCb(b)||(n=$d.moveToNextRow(b));return n}DDb(b,h,n){for(;Fg.TableCellReader.qg(b);)if(h){if(n&&b.kta(1)||!n&&b.sta(1))return null;n?$d.moveToPreviousColumn(b):$d.moveToNextColumn(b)}else{if(Fg.TableCellReader.v2(b.currentNode)){const x=new md.GraphIterator;x.fd(b);if(this.DDb(x,!0,!0)||this.DDb(x,!0,!1)){b.fd(x);break}}else{if(!n&&$d.moveToControllingCell(b,2))break;if(n&&$d.moveToControllingCell(b))break}if(n&&Fg.TableCellReader.Tea(b)||!n&&Fg.TableCellReader.GCb(b))return null;
n?$d.moveToPreviousRow(b):$d.moveToNextRow(b)}return b.currentNode}W0b(b,h){if(!al.a.isTableRow(b))return null;b=md.GraphIterator.$a(b.currentNode);b.Bb(14);let n;const x=ag.TableReader.wA(b.origin);do n=h?$d.moveToPreviousRow(b):$d.moveToNextRow(b);while(x&&n&&al.a.aMa(b));return n}hhb(b,h,n,x,E){let S=null;wf.OutlineElementNavigator.ae(b);const ma=Kf.OutlineElementReader.isRtl(b.currentNode);if(n)if($d.returnToCell(b),h=Fg.TableCellReader.M$(b),n=Fg.TableCellReader.Uea(b),E||!ma&&n||ma&&x&&h)$d.returnToContainingRow(b),
(x=this.W0b(b,!0))?S=Ae.SelectionFactory.wo(x,!h):E&&(wf.OutlineElementNavigator.ae(b),E=new Lf.a,E.fd(b),(b=wf.OutlineElementNavigator.J2(E,!1,!1))&&(S=Ae.SelectionFactory.wo(b,!1)));else{do ma?$d.moveToNextColumn(b):$d.moveToPreviousColumn(b);while(Fg.TableCellReader.qg(b)&&!Fg.TableCellReader.Tea(b));Fg.TableCellReader.qg(b)||(S=Ae.SelectionFactory.wo(b.currentNode,!ma))}else Kf.OutlineElementReader.Mz(b,h,ma)||Kd.SelectionEditor.xf(h)||$d.returnToCell(b),S=Ae.SelectionFactory.wo(b.currentNode,
!ma);return S}ghb(b,h,n,x,E){let S=null;wf.OutlineElementNavigator.ae(b);const ma=Kf.OutlineElementReader.isRtl(b.currentNode);if(n)if($d.returnToCell(b),n=Fg.TableCellReader.M$(b),h=Fg.TableCellReader.Uea(b),E||!ma&&x&&n||ma&&!x&&h)$d.returnToContainingRow(b),(x=this.W0b(b,!1))?S=Ae.SelectionFactory.wo(x,h):(wf.OutlineElementNavigator.ae(b),x=new Lf.a,x.fd(b),(b=wf.OutlineElementNavigator.Rr(x,!1,!1))&&(S=Ae.SelectionFactory.wo(b,!0)));else{do ma?$d.moveToPreviousColumn(b):$d.moveToNextColumn(b);
while(Fg.TableCellReader.qg(b)&&!Fg.TableCellReader.M$(b));Fg.TableCellReader.qg(b)||(S=Ae.SelectionFactory.wo(b.currentNode,ma))}else Kf.OutlineElementReader.Mz(b,h,!ma)||Kd.SelectionEditor.xf(h)||$d.returnToCell(b),S=Ae.SelectionFactory.wo(b.currentNode,ma);return S}}Object(r.a)(vH,"ATableCellSelectionStrategy",null,[1343]);class gM extends vH{constructor(){super()}U7k(b,h,n,x){let E=b.kb,S=null;if(b.tw)if(h)if(2===E.Ke.wma&&!E.Wf&&E.Ke.Tc.equals(E.Rya))E=Ae.SelectionFactory.Gth(E.Rya.node,!1);
else{var ma=({jIm:b}=this.R7k(E)).returnValue;ma&&(Fg.TableCellReader.Or(ma)&&(ma=md.GraphIterator.$a(ma),ma.Bb(14),ma=!b&&this.DDb(ma,!0,!1)?ma.currentNode:b||$d.moveToNextRow(ma)?this.DDb(ma,!1,!1):null),ma&&(S=Ae.SelectionFactory.Kn(Z.TableNodeContext.create(ma),E.Wf)))}else E=b.mba,b=md.GraphIterator.$a(E.Ke.Tc.node),b.Bb(14),Fg.TableCellReader.PBa(b.currentNode)&&$d.moveToLastGhostCell(b,2),(ma=$d.moveToNextColumn(b))?(b=Fg.TableCellReader.v2(ma),Fg.TableCellReader.Or(ma)&&!b&&(ma=md.GraphIterator.$a(ma),
ma.Bb(14),ma=$d.moveToControllingCell(ma)),b?E=Ae.SelectionFactory.wo(E.Ke.Tc.node,!1):S=Ae.SelectionFactory.wo(ma,!0)):(ma=E.Ke.Tc.node,S=Ae.SelectionFactory.wo(ma,!1));else b=h&&E.Wf||!h&&!E.Gta?E.Ke.Tc:E.Ke.Qa,al.a.$la(b.node)&&(b=md.GraphIterator.$a(b.node),(ma=this.W0b(b,!1))?S=h?Ae.SelectionFactory.Kn(Z.TableNodeContext.create(ma),E.Wf):Ae.SelectionFactory.wo(ma,!0):E=Kd.SelectionEditor.ak(Ae.SelectionFactory.ir(b.currentNode),!1,!0));return S?S:x?Kd.SelectionEditor.V0b(E,!1,h,!0):Kd.SelectionEditor.nsa(E,
{XB:!h,Us:h,aE:n,VF:!0})}f8k(b,h,n,x){let E=b.kb;var S=null;if(b.tw)h?1===E.Ke.wma&&E.Wf&&E.Ke.Qa.equals(E.Rya)||(S=this.a8k(E),(S=this.oGh(E,S))||E.Wf&&(E=E.LFc())):(E=b.mba,S=Ae.SelectionFactory.wo(E.Ke.Qa.node,!0));else if(h){var ma=(E.Wf?E.Ke.Tc:E.Ke.Qa).node;b=md.GraphIterator.$a(ma);Kd.SelectionEditor.Gt(b);al.a.$la(ma)&&(E.Wf&&1===E.Ke.wma&&E.Gta?(S=al.a.mA(ma).toArray(),(S=this.oGh(E,0<=S.length-2?S[S.length-2]:null))||E.Wf&&(E=E.LFc())):(ma=this.W0b(b,!0))?S=Ae.SelectionFactory.Kn(Z.TableNodeContext.create(ma),
E.Wf):E=Ae.SelectionFactory.wo(b.currentNode,!0))}else S=Kd.SelectionEditor.ak(E,!0,!1);return S?S:x?Kd.SelectionEditor.V0b(E,!0,h,!0):Kd.SelectionEditor.lAa(E,{XB:!h,Us:h,aE:n,VF:!0})}oGh(b,h){if(!h)return null;var n=h;Fg.TableCellReader.Or(h)&&(n=md.GraphIterator.$a(h),n.Bb(14),n=this.DDb(n,!0,!0)?n.currentNode:Fg.TableCellReader.Dka(h));return n?Ae.SelectionFactory.Kn(Z.TableNodeContext.create(n),b.Wf):null}D8k(b,h,n){let x=h.kb,E=null;if(h.tw){var S=h.eW>h.mEa;if(n)if(2===h.length&&1===h.mba.Ke.wma&&
S)x=Kd.SelectionEditor.ak(x,!0,!1);else{if(h=this.DGh(x,!0))Fg.TableCellReader.Or(h)&&(h=md.GraphIterator.$a(h),h.Bb(14),h=this.DDb(h,!1,!0)),h&&(E=Ae.SelectionFactory.Kn(Z.TableNodeContext.create(h),x.Wf));E||x.Wf&&(x=x.LFc())}else S&&(x=h.mba)}else h=n&&x.Wf?x.Ke.Tc:x.Ke.Qa,al.a.$la(h.node)&&(h=md.GraphIterator.$a(h.node),(S=this.W0b(h,!0))?E=n?Ae.SelectionFactory.Kn(Z.TableNodeContext.create(S),x.Wf):Ae.SelectionFactory.wo(S,!0):n&&(x=Ae.SelectionFactory.wo(h.currentNode,!0)));return E?E:Kd.SelectionEditor.Rab(b,
x,!1,n,n)}e7k(b,h,n){let x=h.kb,E=null;if(h.tw){const S=h.eW<h.mEa;if(n)if(2===h.length&&1===h.mba.Ke.wma&&S)x=Kd.SelectionEditor.ak(x,!1,!1);else{if(h=this.DGh(x,!1))Fg.TableCellReader.Or(h)&&(h=md.GraphIterator.$a(h),h.Bb(14),h=this.DDb(h,!1,!1)),h&&(E=Ae.SelectionFactory.Kn(Z.TableNodeContext.create(h),x.Wf))}else S&&(x=h.mba)}else h=!n||x.Wf?x.Ke.Tc:x.Ke.Qa,al.a.$la(h.node)&&(h=md.GraphIterator.$a(h.node),(h=this.W0b(h,!1))&&(E=n?Ae.SelectionFactory.Kn(Z.TableNodeContext.create(h),x.Wf):Ae.SelectionFactory.wo(h,
x.Gta)));return E?E:Kd.SelectionEditor.Rab(b,x,!0,n,n)}}Object(r.a)(gM,"TableCellSelectionStrategy",vH,[]);class hM{constructor(b){this.jM=(h,n,x,E,S)=>{if(1===x)return 32;h=(new pn.a).create();n="";switch(S.DialogType){case "DirectPrintPreparingPDF":n=CommonUIStrings.l_DirectPrintPreparingPDF;S=CommonUIStrings.l_DefaultDialogTitle;break;default:S=CommonUIStrings.l_DefaultDialogTitle}h.message=n;h.jM(S,null,null);return 32};this.ga=b}Vb(){this.ga.gb(Db.a.jM,cc.a.view,this.jM,1028)}}Object(r.a)(hM,
"UIAutomationActor",null,[]);class iM{constructor(b,h,n,x){this.fb=b;this.xFa=h;this.ljc=n;this.B4=x}t5f(b,h,n){return this.ljc.Afm(h)?n?!0:b&&this.fb.wh(b)?(b=this.iw(b.currentNode),this.xFa.v7h(b),!0):!1:!1}Nif(b,h){return this.ljc.k2k(b,h)}Sif(b){b&&this.fb.wh(b)&&(b=this.iw(b.currentNode),this.xFa.HLd(b))}iw(b){return Dd.a.iw(b)}TDa(b,h,n){this.B4.nCi&&this.ljc.zai(n)&&(this.B4.TDa(b,h),b.setValue(ad.a.Pai,!0))}I5d(){}ANd(b){return this.ljc.ANd(b)}get yOd(){return this.ljc.yOd}$B(){}vga(){}b6d(){}get d2i(){return!1}}
Object(r.a)(iM,"WordEditorPasteStewardBridge",null,[591]);class jM{constructor(b){this.sa=new Ge.a;this.HSi="WordFileSaveAsButtonClicked";this.fqo=()=>{this.sa.raiseEvent(this.HSi,null);return 32};this.ga=b}Vb(){u.AFrameworkApplication.K.$("UseNewCommandForWordFileMenuSaveAs")&&this.ga.pa(ub.a.skj,Ld.a.frame,this.fqo)}Z6j(b){this.sa.addHandler(this.HSi,b)}}Object(r.a)(jM,"WordFileSaveAsActor",null,[]);class kM extends Ha{constructor(){super()}lyc(b,h,n,x,E,S,ma){return ba.a.gac(h,n,x,E,S,ma)}}Object(r.a)(kM,
"WordIndentationActorExtension",Ha,[]);class wH{constructor(){this.cdd=null}get name(){return"WordEditor.Actors"}init(){var b;cb.InteractiveViewManager.instance.editingView.q_b=!0;u.AFrameworkApplication.ya.pa(ub.a.epo,Ld.a.frame,LP);this.W.resolve("WordEditor.Actors.DeleteActor").Vb(u.AFrameworkApplication.ya);mC.instance.Vb();tm.Vb();Cq.Vb(u.AFrameworkApplication.ya,this.W.resolve("WordEditor.IMainViewModeManager"));zj.Vb();tC.instance.Vb();$P.a.Vb();this.W.resolve("WordEditor.Actors.ModeSwitcherControlActor").Vb(u.AFrameworkApplication.ya);
this.W.resolve("WordEditor.Actors.ExternalContentActor").Vb();this.W.resolve("WordEditor.OnlineMedia.OnlineMediaActor").Vb();u.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&this.W.resolve("Box4.Actors.FormatPainterActor").Vb();u.AFrameworkApplication.K.$("WordEditorAutoSaveImprovementIsEnabled")&&this.W.resolve("WordEditor.Actors.SaveStatusActor").Vb();u.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&u.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&(this.lV.GOd=
!0);u.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&this.W.resolve("WordEditor.Actors.ModernUxActor").Vb();u.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&this.W.resolve("WordEditor.Actors.SwitchToClassicViewModeActor").Vb();this.W.resolve("WordEditor.Actors.AppFrameCommandUIActor").Vb();this.W.resolve("Common.IOfficeTrialExperience").Vb();this.W.resolve("Common.IMacOfficeOffer").Vb();
this.W.resolve("WordEditor.Actors.MarginsDialogActor").Vb();this.W.resolve("WordEditor.Actors.PaperSizeDialogActor").Vb();this.W.resolve("WordEditor.Actors.ColumnsDialogActor").Vb();this.W.resolve("WordEditor.Actors.FileDownloadActor").Vb();this.W.resolve("WordEditor.Actors.StylesActor").Vb();(null===(b=u.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",!1))&&this.W.resolve("WordEditor.Actors.CustomizeRibbonActor").Vb();this.W.resolve("WordEditor.Actors.ParagraphDialogActor").Vb();
this.W.resolve("WordEditor.Actors.ProofingActor").Vb();this.W.resolve("WordEditor.Actors.PageActor").Vb();this.W.resolve("WordEditor.Actors.DarkModeActor").Vb();this.W.resolve("WordEditor.Actors.ImageActor").Vb(u.AFrameworkApplication.ya);this.W.resolve("WordEditor.Actors.FormattingActor").Vb();this.W.resolve("WordEditor.Actors.UIAutomationActor").Vb();this.W.resolve("WordEditor.Actors.ContentControlActor").Vb();this.W.resolve("WordEditor.Actors.CustomTabActor").Vb();this.W.resolve("WordEditor.Actors.BookmarkActor").Vb();
this.W.resolve("WordEditor.Actors.HeadingsActor").Vb();this.W.resolve("Box4.Indicator.IIndicatorManager").Yib(this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"));this.W.resolve("WordEditor.Actors.AccessibilityHelpDialogActor").Vb();this.W.resolve("WordEditor.Actors.AccessibilityActor").FPf();this.W.resolve("WordEditor.Actors.ISWordRequestManager");this.W.resolve("Box4.Actors.AutoCorrectActor").Vb();this.W.resolve("WordEditor.Actors.DigitalPrintActor").Vb();this.W.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager");
this.W.resolve("Box4.Actors.VisiMarkersActor").Vb();this.W.resolve("WordEditor.Actors.ExternalContentFloatieEventManager");this.W.resolve("WordEditor.Actors.ActionHangDetector").b3();this.W.resolve("WordEditor.Actors.WordFileSaveAsActor").Vb();u.AFrameworkApplication.K.$("GraphicsEditorActorRegistrationUpdateIsEnabled")?this.Ohn():this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Vb();this.E4.Xib(this.wvj);b=this.W.resolve("WordEditor.Bookmark.FullBookmarkManager");u.AFrameworkApplication.Hf("bookmarks-core-ex;bookmarks-core-ex-cf");
u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.bph(!1)&&ob.App.xa.jb.mCh();ob.App.xa.updateCommandUI();Ju.initialize()}dispose(){}Ohn(){this.wc.Yk.isCompleted?this.wc&&this.wc.isFeatureEnabled(51)&&this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Vb():this.wc.Yk.continueWith(()=>{this.wc&&this.wc.isFeatureEnabled(51)&&(this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Vb(),ob.App.xa.updateCommandUI())})}get Tfm(){if(null==this.cdd)if(this.wc)if(this.wc.Yk.isCompleted)this.cdd=
this.wc.isFeatureEnabled(33)&&this.wc.isFeatureEnabled(2);else return!1;else this.cdd=!1;return this.cdd}zc(b){var h;this.W=b;this.wc=b.Pa("Box4.IFeatureHelper");this.lV=this.W.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.lV.aOc=u.AFrameworkApplication.K.$("WordProofingSecondaryContextualMenuIsEnabled")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRightClickSecondaryMenuIsEnabled",!1);(new FK).zc(b);b.ha("Box4.IClipboardCommands",()=>new GK(u.AFrameworkApplication.ya,
Db.a.PSe,Db.a.$yc,Db.a.u1,Db.a.rJf,Db.a.paste,Db.a.V6,Db.a.wib)).singleInstance();b.ha("HtmlImport.IHtmlNormalizerSettings",()=>{const n=b.resolve("Common.IAppSettingsManager");return new mx(!0,n.$("SplitHyperlinkFixWithEnterIsEnabled"))}).singleInstance();b.ha("HtmlImport.IHtmlTranslatorSettings",()=>{const n=b.resolve("Common.IAppSettingsManager"),x=E=>!E.A5b;return new DP.a(n.$("ExternalPasteImprovementsEnabled"),n.$("PasteComplexTablesIsEnabled"),n.$("PasteTableCellMarginImprovementsIsEnabled")||
n.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImprovedHtmlTableCellMarginsHandlingIsEnabled",!1),n.$("WordWacQoEListBulletsLevelExternalPasteImprovementIsEnabled"),!0,void 0,void 0,void 0,void 0,void 0,void 0,!0,void 0,n.$("SupportCloudFontInExternalPasteIsEnabled"),!0,!0,!0,!0,!0,E=>E.A5b,()=>!1,x,x,x,x,void 0,()=>this.Tfm,E=>!E.A5b)}).singleInstance();b.ha("WordEditor.Actors.WordEditorPasteStewardBridge",()=>new iM(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobEditor"),b.resolve("Box4.Actors.IBox4PasteStewardUtils"),
b.resolve("Box4.IFormattingPropertyTransitStrategy"))).as("Box4.Actors.IBox4PasteStewardBridge").singleInstance();b.ha("WordEditor.Actors.PastedContentsProcessorPostMergeAfterPaste",()=>new VL(b.resolve("Wonca.ExternalContent.IExternalContentEditor"),b.resolve("Box4.IFeatureHelper"))).as("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste").singleInstance();b.ha("Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy",()=>new HK).as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").singleInstance();
b.ha("Box4.IIndentationCommands",()=>new IK(u.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.IJustificationCommands",()=>new JK(u.AFrameworkApplication.ya)).singleInstance();b.ha("Box4.ISpacingCommands",()=>new KK(u.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.IPageCommands",()=>new RL(u.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.Actors.StylesActor",()=>new dM(u.AFrameworkApplication.ya,b.Ye("WordEditor.UI.IDialogFactory"))).singleInstance();(null===(h=u.AFrameworkApplication.K)||
void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",!1))&&b.ha("WordEditor.Actors.CustomizeRibbonActor",()=>new tE(u.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.Actors.DigitalPrintActor",()=>new nH(u.AFrameworkApplication.ya,b.Ye("WordEditor.UI.IDialogFactory"))).singleInstance();b.ha("WordEditor.Actors.FileDownloadManager",()=>new xL(b.resolve("Common.App.DirectPrint.IDirectPrintManager"),new CP.a)).singleInstance();b.ha("WordEditor.Actors.FileDownloadActor",
()=>new uL(u.AFrameworkApplication.ya,b.Ye("WordEditor.UI.IDialogFactory"),b.resolve("WordEditor.Actors.FileDownloadManager"),u.AFrameworkApplication.K.$("DisablePrint"),u.AFrameworkApplication.K.lb("IrmPolicyDescription"),b.resolve("WordEditor.IBusinessBarController"))).singleInstance();b.ha("WordEditor.Actors.ParagraphDialogActor",()=>new TL(u.AFrameworkApplication.ya,b.Ye("Box4.UI.IBox4DialogFactory"),b.resolve("WordEditor.LineSpacingHelper"),Pm.a.instance,b.resolve("Box4.IParagraphIndentationReader"),
b.resolve("WordEditor.ClientPagination.IClientPaginationSettings"))).singleInstance();b.ha("WordEditor.Actors.MarginsDialogActor",()=>new PL(u.AFrameworkApplication.ya,b.Ye("WordEditor.UI.IDialogFactory"),Pm.a.instance)).singleInstance();b.ha("WordEditor.Actors.ColumnsDialogActor",()=>new mL(u.AFrameworkApplication.ya,b.Ye("WordEditor.UI.IDialogFactory"),Pm.a.instance)).singleInstance();b.ha("WordEditor.Actors.ModeSwitcherControlActor",()=>new yz.a(b.Za("Common.ISystemInitiatedFeedback"),FP.a.U1b())).as("WordEditor.IModeSwitcherControl").singleInstance();
b.ha("WordEditor.Actors.PaperSizeDialogActor",()=>new SL(u.AFrameworkApplication.ya,b.Ye("WordEditor.UI.IDialogFactory"),Pm.a.instance)).singleInstance();b.ha("WordEditor.Actors.IgnoreAllProofingErrorStrategy",()=>new IL(b.resolve("Box4.Proofing.IIgnoreAllKeywords"))).singleInstance();b.register(sL,"WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy").singleInstance();b.ha("WordEditor.Actors.ProofingActor",()=>new XL(u.AFrameworkApplication.ya,Ai.a.instance,Oa.a.instance.resolve("Box4.ISelectionManager"),
rs.a.instance,Of.a.instance,Oa.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),Oa.a.instance.resolve("Box4.ILanguageReader"),Oa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Oa.a.instance.resolve("WordEditor.Actors.IgnoreAllProofingErrorStrategy"),Oa.a.instance.resolve("WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy"),this.lV,Oa.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),u.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),Oa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).singleInstance();
(u.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("editorSettingsManager"):b.resolve("Common.IDynamicScriptLoaderProvider").tE.loadScript("EditorSettingsManager")).then(()=>{const n=b.resolve("Box4.Proofing.IEditorSettingsManagerActor");n.y_l();n.init();b.ha("Box4.Proofing.EditorSettingsUIActor",()=>new LK(u.AFrameworkApplication.ya,b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),()=>new MK(b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),b.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager")))).singleInstance();
u.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&u.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&this.W.resolve("Box4.Proofing.EditorSettingsUIActor").Vb()});b.ha("WordEditor.Actors.PageActor",()=>new QL(Oa.a.instance.resolve("Box4.IWordSectionEditor"),Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).as("WordEditor.IPageCommandStringBuilder").singleInstance();b.ha("WordEditor.Actors.DarkModeActor",()=>new pL(u.AFrameworkApplication.ya,u.AFrameworkApplication.K,
ob.App.sba,!!ob.App.instance&&ob.App.instance.MBa,!!ob.App.instance&&ob.App.instance.uOc,Oa.a.instance.resolve("Box4.IDarkModeState"),Oa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Oa.a.instance.resolve("Box4.DarkModeEventsManager"),!!ob.App.instance&&ob.App.instance.Rla)).singleInstance();b.ha("WordEditor.FlatListDetailsProvider",()=>new zL(b.resolve("WordEditor.IFlatListEditor")));b.ha("WordEditor.Actors.AccessibilityActor",()=>new XK(b.Za("Box4.Accessibility.IAccessibilityContextManager"),
b.Ye("WordEditor.FlatListDetailsProvider"),b.Ye("WordEditor.TrackChange.TrackChangeCpDetailsProvider"),b.Ye("WordEditor.TrackChange.TrackChangeStructuralDetailsProvider"))).singleInstance();b.ha("WordEditor.Actors.AppFrameCommandUIActor",()=>new jL(u.AFrameworkApplication.ya,b.Za("Postmessage.IHostPostmessenger"))).singleInstance();b.ha("WordEditor.Actors.ImageActor",()=>new Xt(b.resolve("WordEditor.IImageEditor"),b.Za("Box4.IExternalSelectionManager"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),
b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("WordEditor.Actors.ISWordRequestManager"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.IAppFrame"),u.AFrameworkApplication.K)).as("Box4.Actors.ImageActor").singleInstance();b.ha("WordEditor.Actors.WordFileSaveAsActor",()=>new jM(u.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.Actors.RenderedImageEditOperation.Factory",()=>new aM(b.resolve("WordEditor.IImageEditor"),u.AFrameworkApplication.K,
u.AFrameworkApplication.ua.BLa,Oa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IFeatureHelper"))).singleInstance();b.ha("WordEditor.Actors.DeleteActor",()=>new qL.DeleteActor(Oa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Oa.a.instance.Za("Box4.ContentControlConfigSettings"),Oa.a.instance.Za("Box4.IContentControlEditor"),
Oa.a.instance.resolve("Box4.IDynamicRangeEditor"),Oa.a.instance.Za("WordEditor.Bookmark.IBookmarkManager"),Oa.a.instance.resolve("Box4.IHyperlinkEditor"),Oa.a.instance.resolve("Box4.IHyperlinkStrategy"),Oa.a.instance.resolve("Box4.IParagraphReader"),Oa.a.instance.resolve("Box4.IParagraphIndentationReader"),Oa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Oa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();this.W.ha("WordEditor.Actors.SWordRequestManager",
()=>new fM(b.resolve("Box4.Images.IImageReader"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),u.AFrameworkApplication.K)).as("WordEditor.Actors.ISWordRequestManager").singleInstance();b.ha("WordEditor.Actors.TableCellSelectionStrategy",()=>new gM).as("Box4.ITableCellSelectionStrategy").singleInstance();u.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&b.ha("Box4.Actors.FormatPainter",()=>new NK(b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.IInsertionPointFormatting"),
b.resolve("Box4.IFormattingEditor"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.ICharacterPropertiesEditor"),Ai.a.instance,b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TextFormattingHelper"),b.resolve("Box4.Styles.IWACStyleReader"))).as("Box4.IFormatPainter").singleInstance();
b.ha("Box4.Actors.FormatPainterActor",()=>new nC(ob.App.xa,de.FocusManager.instance(),u.AFrameworkApplication.ya,vb.a.instance,Pq.a.instance,b.resolve("Box4.IFormatPainter"),b.resolve("Box4.ISelectionManager"),!0,b.resolve("Box4.ICssColorProvider"),!!ob.App.instance&&ob.App.instance.Rla,b.resolve("Box4.DarkModeEventsManager"))).singleInstance();b.ha("WordEditor.Actors.FormattingActor",()=>new AL(u.AFrameworkApplication.ya,b.resolve("Box4.List.IListReader"))).singleInstance();b.ha("WordEditor.Actors.UIAutomationActor",
()=>new hM(u.AFrameworkApplication.ya)).singleInstance();b.ha("WordEditor.Actors.SaveStatusActor",()=>new cM(u.AFrameworkApplication.ya,b.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"))).singleInstance();b.ha("Box4.Actors.IEnterViewStrategy",()=>new OK(b.Pa("Box4.IAutoCorrectScheduler"),b.Ye("Box4.IUndoManager"),b.Za("Box4.IExternalSelectionManager"))).singleInstance();b.ha("Box4.ISelectAllHandlers",()=>new pA(Nd.PageReader.instance,b.Ye("Box4.IUndoManager"),b.resolve("Box4.Graph.IGraphTransactionFactory"),
u.AFrameworkApplication.K.$("QoETinyWinsSelectAllEnabled"))).singleInstance();b.ha("WordEditor.Actors.ContentControlActor",()=>new nL(b.resolve("WordEditor.ContentControl.IContentControlManager"),b.resolve("WordEditor.ContentControl.IGlossaryNavigator"),b.resolve("Box4.IFormattingEditor"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlOperator"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),
b.resolve("Box4.Styles.IWACStyleReader"),u.AFrameworkApplication.ya,u.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),Of.a.instance.J(10))).singleInstance();b.ha("WordEditor.Actors.AccessibilityHelpDialogActor",()=>new YK(u.AFrameworkApplication.ya,b.Ye("WordEditor.UI.IDialogFactory"),de.FocusManager.instance())).singleInstance();b.ha("Box4.Actors.FontNameFormattingStrategyNoop",()=>new PK).as("Box4.Actors.IFontNameFormattingStrategy").singleInstance();b.ha("WordEditor.GraphicsEditor.GraphicsEditorRequestManager",
()=>new KF(u.AFrameworkApplication.Ze,ql.PageNavigator.instance,b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("WordEditor.IImageEditor"),Oa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),u.AFrameworkApplication.K,b.resolve("Box4.IFeatureHelper"))).as("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager").singleInstance();b.ha("WordEditor.Actors.GraphicsEditorActor",
()=>new FL(u.AFrameworkApplication.ya,u.AFrameworkApplication.K,b.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),b.resolve("WordEditor.IImageEditor"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("Box4.Images.IImageReader"),u.AFrameworkApplication.Ze,this.wc,b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).singleInstance();
b.ha("WordEditor.Actors.RenderParagraphsContainingTabs",()=>new bM).singleInstance();b.ha("WordEditor.Actors.CustomTabActor",()=>new oL(u.AFrameworkApplication.ya,b.resolve("WordEditor.ICustomTabStopUtility"),b.resolve("Box4.IOutlineEditor"))).singleInstance();b.ha("WordEditor.Actors.HeadingsActor",()=>new GL(b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),u.AFrameworkApplication.ya,b.resolve("Box4.IParagraphReader"))).singleInstance();b.ha("WordEditor.Actors.BookmarkActor",()=>
new lL(ob.App.xa,u.AFrameworkApplication.ya,kh.a.instance,b.resolve("WordEditor.Bookmark.FullBookmarkManager"),new se.a(()=>ob.App.xa.jb.Zc),this.W.resolve("Box4.Indicator.IIndicatorManager"),this.W.resolve("Box4.Graph.IGraphTransactionFactory"),this.W.resolve("Common.IReactContextualUILauncher"),this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"),rs.a.instance,this.W.Za("Common.ISystemInitiatedFeedback"),b.resolve("Box4.IOutlineElementNavigator"),cb.InteractiveViewManager.instance,this.W.Ye("WordEditor.UI.IDialogFactory"),
this.W.resolve("Box4.BookmarkParagraphMapping"),Ai.a.instance)).singleInstance();b.ha("WordEditor.Actors.BookmarkIndicatorActor",()=>{var n,x;return new Tr(b.resolve("Box4.IParagraphReader"),sf.a.instance,$e.a.instance,this.W.resolve("Box4.Highlight.IHighlightManager"),b.resolve("Box4.IInteractiveEventHandler"),null!==(x=null===(n=ob.App.instance)||void 0===n?void 0:n.yA)&&void 0!==x?x:!1)}).singleInstance();b.ha("Box4.Actors.IIFrameFocusStrategy",()=>new HL).singleInstance();b.ha("WordEditor.Actors.ExternalContentFloatiePositionProvider",
()=>new rC(kh.a.instance,b.resolve("Box4.ITextMetricsAdapter"),cb.InteractiveViewManager.instance,rd.a.getElementBounds,b.resolve("Box4.UI.ExternalContentFloatieManager"))).singleInstance();b.ha("WordEditor.Actors.ExternalContentActor",()=>new Vr(u.AFrameworkApplication.ya,b.resolve("Box4.IUndoManager"),u.AFrameworkApplication.K,b.resolve("Wonca.ExternalContent.IExternalContentEditor"),u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",
!1))).as("WordEditor.Actors.ExternalContentActor").singleInstance();b.ha("Box4.UI.ExternalContentFloatieManager",()=>new WK).as("Box4.UI.IFloatieManager").singleInstance();b.ha("WordEditor.Actors.ActionHangDetector",()=>new ZK(u.AFrameworkApplication.K,u.AFrameworkApplication.ya)).as("WordEditor.Actors.ActionHangDetector").singleInstance();b.ha("WordEditor.Actors.ExternalContentFloatieEventManager",()=>new qC(b.resolve("Box4.UI.ExternalContentFloatieManager"),b.resolve("Box4.IExternalContentFloatieEventSource"),
cb.InteractiveViewManager.instance,Mq.a.instance(),u.AFrameworkApplication.ua,b.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),ob.App.Wj.al.Te(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",!1))).singleInstance();
b.ha("Box4.Actors.WordIndentationActorExtension",()=>new kM).as("Box4.Actors.IIndentationActorExtension").singleInstance();u.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&(u.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IWacWordModernUxExperimentOneSettings"),u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&b.ha("WordEditor.Actors.ModernUxActor",()=>new rH(u.AFrameworkApplication.ya)).singleInstance());u.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&
b.ha("WordEditor.Actors.SwitchToClassicViewModeActor",()=>new XF(u.AFrameworkApplication.ya)).singleInstance();(new CK).zc(b);b.ha("WordEditor.OnlineMedia.OnlineMediaDialogFactory",()=>new VK(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("WordEditor.OnlineMedia.OnlineMediaDialogFactory").singleInstance();b.ha("WordEditor.OnlineMedia.InsertHubbleMediaHelper",()=>new SK(u.AFrameworkApplication.ya,b.resolve("Box4.Media.InsertMediaHelper"))).singleInstance();
b.ha("WordEditor.OnlineMedia.OnlineMediaActor",()=>new TK(u.AFrameworkApplication.ya,u.AFrameworkApplication.K,b.resolve("WordEditor.OnlineMedia.OnlineMediaDialogFactory"),b.resolve("WordEditor.OnlineMedia.InsertHubbleMediaHelper"),b.resolve("Wonca.ExternalContent.IExternalContentEditor"),Ai.a.instance)).singleInstance();this.wvj=new QK;this.E4=this.W.resolve("Box4.Highlight.IHighlightManager")}static main(){N.a.instance.Pc(new wH)}}Object(r.a)(wH,"WordEditorActorsPackage",null,[1,2]);class lM{constructor(b){this.bpc=
!1;this.Vvi=()=>{this.bpc=!0;this.Ps.qRf(this.Vvi)};this.Ps=b;this.Ps.CWb(this.Vvi)}}Object(r.a)(lM,"GraphFullyConnectedGetter",null,[631]);class Ef{constructor(){this.iNg=Object.assign(new mm.a,{})}x0j(b,h){let n;const x=b&1023;({value:n}=this.iNg.Dc(x,0)).returnValue||Ef.rOl().contains(x)||w.ULS.sendTraceTag(50942149,338,15,"Culture is not supported. LCID {0}; Key: {1}",b,x);n+=h;this.iNg.Z(x,n);return n}static rOl(){Ef.Xld||(Ef.Xld=new Pa.a,Ef.qc(0),Ef.qc(1),Ef.qc(2),Ef.qc(3),Ef.qc(4),Ef.qc(5),
Ef.qc(6),Ef.qc(7),Ef.qc(8),Ef.qc(9),Ef.qc(10),Ef.qc(11),Ef.qc(12),Ef.qc(13),Ef.qc(14),Ef.qc(15),Ef.qc(16),Ef.qc(17),Ef.qc(18),Ef.qc(19),Ef.qc(20),Ef.qc(21),Ef.qc(22),Ef.qc(23),Ef.qc(24),Ef.qc(25),Ef.qc(26),Ef.qc(27),Ef.qc(28),Ef.qc(29),Ef.qc(30),Ef.qc(31),Ef.qc(32),Ef.qc(33),Ef.qc(34),Ef.qc(35),Ef.qc(36),Ef.qc(37),Ef.qc(38),Ef.qc(39),Ef.qc(40),Ef.qc(41),Ef.qc(42),Ef.qc(43),Ef.qc(44),Ef.qc(45),Ef.qc(46),Ef.qc(47),Ef.qc(48),Ef.qc(49),Ef.qc(50),Ef.qc(51),Ef.qc(52),Ef.qc(53),Ef.qc(54),Ef.qc(55),Ef.qc(56),
Ef.qc(57),Ef.qc(58),Ef.qc(59),Ef.qc(60),Ef.qc(61),Ef.qc(62),Ef.qc(63),Ef.qc(64),Ef.qc(65),Ef.qc(66),Ef.qc(67),Ef.qc(68),Ef.qc(69),Ef.qc(70),Ef.qc(71),Ef.qc(72),Ef.qc(73),Ef.qc(74),Ef.qc(75),Ef.qc(76),Ef.qc(77),Ef.qc(78),Ef.qc(79),Ef.qc(80),Ef.qc(81),Ef.qc(82),Ef.qc(83),Ef.qc(84),Ef.qc(85),Ef.qc(86),Ef.qc(87),Ef.qc(88),Ef.qc(89),Ef.qc(90),Ef.qc(91),Ef.qc(92),Ef.qc(93),Ef.qc(94),Ef.qc(95),Ef.qc(96),Ef.qc(97),Ef.qc(98),Ef.qc(99),Ef.qc(100),Ef.qc(101),Ef.qc(102),Ef.qc(103),Ef.qc(104),Ef.qc(105),Ef.qc(106),
Ef.qc(107),Ef.qc(108),Ef.qc(109),Ef.qc(110),Ef.qc(111),Ef.qc(112),Ef.qc(113),Ef.qc(114),Ef.qc(115),Ef.qc(116),Ef.qc(117),Ef.qc(118),Ef.qc(119),Ef.qc(120),Ef.qc(121),Ef.qc(122),Ef.qc(124),Ef.qc(126),Ef.qc(127),Ef.qc(128),Ef.qc(129),Ef.qc(130),Ef.qc(131),Ef.qc(132),Ef.qc(133),Ef.qc(134),Ef.qc(135),Ef.qc(136),Ef.qc(140),Ef.qc(145),Ef.qc(146),Ef.qc(147));return Ef.Xld}static qc(b){Ef.Xld.add(b&1023)}}Ef.Xld=null;Object(r.a)(Ef,"LanguagePerParagraphModel",null,[]);class mM{constructor(){this.EZf=!1;this.ptd=
this.otd=this.lMb=0;this.Zgi=!0;this.Bso=0}}Object(r.a)(mM,"UpdateWordCountStateResult",null,[]);class nM extends Sys.EventArgs{constructor(b){super();this.isEnabled=b}}Object(r.a)(nM,"WordCountAvailabilityChangedEventArg",Sys.EventArgs,[]);class oM{constructor(){this.Pjh=this.Ojh=this.wordCount=-1;this.fyb=this.tfh=0;this.eyb=1;this.IBi=1033}}Object(r.a)(oM,"WordCountCache",null,[]);class pM extends Sys.EventArgs{constructor(b){super();this.state=b}}Object(r.a)(pM,"WordCountChangedEventArg",Sys.EventArgs,
[]);class qM{constructor(){this.rhc=this.Vya=0}}Object(r.a)(qM,"CharsCountResult",null,[]);class rM{constructor(){this.cp=0;this.thc=null;this.y5=this.z5=0}}Object(r.a)(rM,"TextChunkResult",null,[]);class sM{constructor(){this.hkj=this.z5=this.y5=this.wordCount=0}}Object(r.a)(sM,"WordCountStateForParagraph",null,[]);class xH{constructor(){this.Una=this.cQ=this.z5=this.y5=this.$Z=this.wordCount=0;this.currentNode=null;this.eW=-1;this.cp=0;this.HJf=[];this.eyb=this.fyb=this.oVa=this.CJf=this.DJf=0;
this.jH=this.sbi=!1;this.rmb=new Qa.a;this.n_a=new Qa.a}}Object(r.a)(xH,"WordCountState",null,[]);class oq{constructor(b,h,n,x,E,S){this.n_n=1E3;this.sa=new Ge.a;this.fub=null;this.xfe=0;this.sCj="\ue000";this.Olc=!1;this.Pke=this.Eke=this.w8c=0;this.Hyg=this.Pyg=null;this.Ake=this.zke=this.Jke=0;this.$A=h;this.DAj=new RegExp(Tc.AParagraphNode.tB,"g");this.hd=b;this.taskManager=x;this.Nn=n;this.DUa=S;this.dSa=E.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.jSj=E.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");
this.PPi()}get Olm(){return!!this.fub}get $Ja(){return this.Olc}set $Ja(b){this.Olc=b}get hpd(){return this.xfe}set hpd(b){this.xfe=b}get AMa(){return!this.xfe}get JC(){return this.w8c}get kxb(){return this.Eke}get pxb(){return this.Pke}get ONk(){return this.Pyg}get d0e(){return this.Hyg}get yCc(){return this.Jke}get wCc(){return this.zke}get WZb(){return this.Ake}CWb(b){this.sa.addHandler(oq.Hce,b)}qRf(b){this.sa.removeHandler(oq.Hce,b)}iOe(b){this.sa.addHandler(oq.F9f,b)}nqn(b){this.sa.removeHandler(oq.F9f,
b)}Xxd(){this.Wxd();this.PPi()}PPi(){this.Jke=this.Ake=this.zke=this.Pke=this.Eke=this.w8c=-1}s1e(){this.I8d(this.n_n)}t0c(){const b=new xH;b.sbi=!0;this.Wxd();this.C3e(b)}I8d(b,h=null){this.AMa&&(this.Olm&&(h=null,this.Wxd()),h||(h=new xH),b=new We.a(3,1,b,Object(v.a)(this,this.gXk,"doWordCountTask"),this.Y8i),b.customData=h,this.G4j(b))}Wxd(){this.fub&&(this.taskManager.ef(this.fub),this.fub=null)}vhj(b,h,n,x,E,S=!0,ma=-1,Fa=-1,$a=-1,sb=1033){const Jb=new mM;Jb.lMb=n;Jb.otd=E;Jb.ptd=x;if(!b.cp&&
h.X3c&&S&&!this.kWh(h))return oq.Mko(b,h.X3c),Jb.Zgi=!0,Jb;x=0<=Fa&&0<=$a?{Cd:Fa,endCp:$a}:void 0;n=this.bfl(h,x);x&&(Fa=x.Cd,$a=x.endCp);n=0<=$a?n.substring(0,$a):n;$a=0<=Fa&&0<=$a?n.substring(Fa,$a):n;x=b.cp>=Fa?b.cp:Fa;E=b.HJf||[];S=0<b.DJf?b.DJf:0;let Sb=0<b.CJf?b.CJf:0,oc=[];b.jH=!1;do{this.DUa.update();if(!b.sbi&&(Jb.lMb+oc.length/2>oq.Kpo||this.DUa.khb())){let Gd;E=(Gd=E).concat.apply(Gd,oc);b.cp=x;b.HJf=E;b.CJf=Sb;b.DJf=S;b.eW=ma;b.currentNode=h;this.I8d(oq.ato,b);Jb.EZf=!0;b.jH=!0;return Jb}if((!x||
x===Fa)&&0<n.length&&x<n.length){E.push(Hb.a.instance.fhf(n,x));var Ic=this.kWh(h);if(0<=ma&&!x&&Ic){b.wordCount+=1;Jb.lMb+=1;const Gd=this.hd.QN(Ic);Ic=this.$A.E9b(Gd,Ic);Ic=oq.cwd(Ic);b.z5+=Ic.Vya+1;b.y5+=Ic.Vya-Ic.rhc}}Ic=this.A_h(n,x,oq.Ntk);x=Ic.cp;let gd;oc=(gd=oc).concat.apply(gd,Ic.thc);S+=Ic.z5;Sb+=Ic.y5}while(-1!==x);b=this.DZj(b,E,oc,n,$a,Jb.lMb,Jb.otd,Jb.ptd,h,-1===ma,sb);Jb.lMb=b.wordCount;Jb.otd=b.y5;Jb.ptd=b.z5;Jb.Bso=b.hkj;return Jb}ozh(b,h){const n=Cd.ParagraphReader.textLength(h,
1);if(n){h=Ad.e(h);var x=0;for(let E=0;E<h.length;E++)if(this.veb&&5===h[E].ri&&b.cQ++,oq.VPn(h[E])){x++;break}h.length!==n?b.$Z++:b.$Z+=x}}N0i(b){this.hpd=this.tQn(b.oVa,b.wordCount)?1:0;return!!this.hpd}Azi(b){this.w8c=b.wordCount;this.Eke=b.cQ;this.Pke=b.Una;this.Ake=b.z5;this.zke=b.y5;this.Jke=b.$Z;this.Pyg=b.rmb;this.Hyg=b.n_a;this.cIi(b)}cIi(b){this.sa.raiseEvent(oq.Hce,new pM(b))}bIi(){this.sa.raiseEvent(oq.F9f,new nM(!1))}tQn(b,h){if(V.a.zk||V.a.Vs||V.a.UG)return!1;(h/=2)||(h=1);return(h?
b/h:0)>oq.GDm?!0:!1}get veb(){const b=!this.Cxf||1===this.Cxf&&this.jSj;return this.dSa&&b}XSh(b,h){let n=1033,x=0;b=h.Adf(b);h=new Ef;for(let E=0;E<b.length;E++){const S=h.x0j(b[E].lcid,b[E].end-b[E].begin);x<S&&(x=S,n=b[E].lcid)}return n}gXk(b){this.fub=null;this.C3e(b.customData)}DZj(b,h,n,x,E,S,ma,Fa,$a,sb,Jb){var Sb;h=(Sb=h).concat.apply(Sb,n);n=Hb.a.instance.B_h(h,x);b.wordCount+=n.wordCount;const oc=oq.cwd(E);E=oc.Vya-oc.rhc;Sb=oc.Vya;b.y5+=E;b.z5+=Sb;S+=n.wordCount;ma+=oc.Vya-oc.rhc;Fa+=oc.Vya;
b.oVa+=n.oVa;({MYk:h,U7n:x}=oq.CZj(h,x));b.fyb+=h;b.eyb+=x;b.n_a.add(Jb);b.rmb.add(n.wordCount);sb&&oq.Ymk(Sb,E,$a,n,h,x,Jb);b.cp=0;b.HJf=[];b=new sM;b.y5=ma;b.z5=Fa;b.wordCount=S;b.hkj=n.wordCount;return b}bfl(b,h){let n=this.Wrn(b);ob.App.qPa&&(n=Cd.ParagraphReader.Hyb(b,1,n,h));return this.knn(n)}Wrn(b){var h=Cd.ParagraphReader.text(b);b=Ad.e(b);if(0<b.length){h=h.split("");for(let x=0;x<b.length;++x){let E=!0;var n=!0;const S=b[x];if(1===S.ri)n=S,n=22!==n.kind&&2!==n.kind;else if(5===S.ri)E=!1;
else if(7===S.ri||10===S.ri)h[S.Ob.cp]=this.sCj,E=!1;if(E){if(S.Ob.cp>=h.length)return"";h[S.Ob.cp]=n?" ":"C"}}h=h.join("")}return h}knn(b){return b.replace(this.DAj,"")}A_h(b,h,n){const x=b.length-h<=n;var E=x?b.length:h+n;const S=new rM;if(E<h)return S.cp=-1,S;S.thc=Hb.a.instance.saf(b,h,E);E=oq.cwd(b.substr(h,E));S.z5=E.Vya;S.y5=E.Vya-E.rhc;if(!S.thc.length&&!x)return n===b.length-h?S:this.A_h(b,h,b.length-h);S.cp=x||!S.thc.length?-1:S.thc[S.thc.length-1].cp;return S}G4j(b){this.fub=b;this.taskManager.$b(this.fub)}kWh(b){if(b=
b.aW){const h=this.hd.QN(b);if(h&&h.qr)return b}return null}static VPn(b){return 11===b.ri}static Mko(b,h){b.wordCount+=h.wordCount;b.y5+=h.Ojh;b.z5+=h.Pjh;b.oVa+=h.tfh;b.fyb+=h.fyb;b.eyb+=h.eyb;b.n_a.add(h.IBi);b.rmb.add(h.wordCount)}static Ymk(b,h,n,x,E,S,ma){const Fa=new oM;Fa.wordCount=x.wordCount;Fa.Pjh=b;Fa.Ojh=h;Fa.tfh=x.oVa;Fa.fyb=E;Fa.eyb=S;Fa.IBi=ma;n.X3c=Fa}static cwd(b){const h=b.length,n=new qM;for(let E=0;E<h;E++){var x=b.charCodeAt(E);n.Vya++;if(55296<=x&&56319>=x&&(x=E+1<h?b.charCodeAt(E+
1):0,56320<=x&&57343>=x)){E++;continue}B.a.V$(b.charAt(E))&&n.rhc++}return n}static CZj(b,h){let n=0,x=0;for(let E=0;E<b.length;++E){const S=b[E],ma=S.AK;(3===ma||2===ma)&&S.cp<h.length&&(++n,B.a.I5b(h.charCodeAt(S.cp))&&++x)}return{MYk:x,U7n:n}}}oq.Hce="wctek";oq.F9f="wcac";oq.ato=1;oq.Ntk=400;oq.Kpo=90;oq.GDm=.1;Object(r.a)(oq,"WordCountManagerBase",null,[637]);class tM extends oq{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb){super(b,h,n,E,$a,sb);this.nIh=this.mmd=this.Kia=null;this.Cma=()=>{this.s1e()};
this.hb=x;this.ld=ma;this.Q0g=Fa;this.zH=Jb;this.hb.OD(this.Cma);this.Pte=$a.$("ReadingTimeIsEnabled")}get Y8i(){return 66}c2l(){if(this.Kia)return!0;if(!this.hb||!this.hb.ib)return this.ld&&(ob.App.KMd||u.AFrameworkApplication.Dk?this.ld.Yb("SelectionWordCountSelectionNullWhenAppExiting",{["Reason"]:"SelectionWordCount triggerred when app is exiting"}):this.ld.Yb("SelectionWordCountSelectionNullWhenAppAlive")),!1;const b=this.hb.ib.clone();this.Kia=b.vN(!0);if(!this.Kia||!this.Kia.Sy())return this.Wxd(),
!1;this.Q0g&&(this.mmd=this.Q0g.create(h=>b.vN(h),this.Nn));this.Kia.moveNext();return!0}get Cxf(){return 1}JCk(b){return b===cc.a.Fd||b===cc.a.paragraph?!0:this.veb&&(b===cc.a.Ryb||b===cc.a.image||b===cc.a.anchoredObject)}C3e(b){this.DUa.reset();if(this.c2l()){for(this.veb&&this.mmd&&(this.mmd.bXk(b,this.DUa)||this.I8d(1,b));this.Kia.current;){const x=-1===b.eW?0:b.eW;let E=0;var h=this.Kia.current;if(!this.JCk(h.contextId)){this.Kia.moveNext();continue}if(this.veb&&Pd.ImageReader.ifb(h)){b.cQ++;
this.Kia.moveNext();continue}if(!Cd.ParagraphReader.oc(h.node)){this.Kia.moveNext();continue}const S=h.node;if(this.$Ja&&this.nIh&&this.nIh.g2b(S))this.Kia.moveNext();else{if(this.veb&&h.Qd){var n=md.GraphIterator.$a(S);for(n.Rb(6);!n.nr;)Pd.ImageReader.qw(n.currentNode)&&b.cQ++,n.Vi(6)}n=this.Pte?this.XSh(S,this.zH):1033;h=this.vhj(b,S,0,0,0,this.ENd(h),x,h.cpBegin,h.cpEnd,n);if(h.Zgi&&(E+=1,100<E)){b.eW=x+1;this.I8d(1,b);return}if(h.EZf)return;this.ozh(b,S);this.Kia.moveNext()}}this.mmd=this.Kia=
null;this.N0i(b)?(this.w8c=-1,this.bIi()):this.Azi(b)}}ENd(b){let h=!1;b.contextId===cc.a.paragraph?h=!0:b.contextId===cc.a.Fd&&(h=b.cpEnd-b.cpBegin===b.node.characterData.length);return h}}Object(r.a)(tM,"SelectionWordCountManager",oq,[]);class YF{constructor(b,h){this.LQb=!1;this.rtb=null;b&&h&&(this.QUb=b(!1),this.Xc=h,this.QUb.moveNext())}bXk(b,h){if(!b||!this.QUb||!this.QUb.current)return!0;do{const n=this.QUb.current;if(n.contextId===cc.a.tableRow||n.contextId===cc.a.tableCell){for(this.rtb||
this.k2l(n.node);this.rtb.moveNext();)if(14===this.rtb.currentNode.type&&b.Una++,h.update(),h.khb())return!1;this.cFk(n,b);this.rtb=null}this.QUb.moveNext()}while(this.QUb.current);return!0}cFk(b,h){const n=this.Xc.pg(b.node);n.Bb(14);b.contextId===cc.a.tableRow&&(al.a.gbi(n)&&(this.LQb=!0),al.a.cOd(n)&&this.LQb&&(this.LQb=!1,h.Una++));b.contextId===cc.a.tableCell&&(Fg.TableCellReader.UMc(n)&&(this.LQb=!0),Fg.TableCellReader.fMa(n)&&this.LQb&&(this.LQb=!1,h.Una++))}k2l(b){this.rtb=cn.a.Vp(b);14===
b.type?this.rtb.Om(YF.mFc,b):this.rtb.Om(YF.mFc,null)}static mFc(b){return b.parentNode?!0:!1}}Object(r.a)(YF,"TableCountSelectionTraverser",null,[638]);class uM{constructor(b){this.dSa=b.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}create(b,h){return this.dSa?new YF(b,h):null}}Object(r.a)(uM,"TableCountSelectionTraverserFactory",null,[630]);class vM extends oq{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb){super(b,h,n,E,$a,sb);this.Mpo=Sb=>{if(Sb.nr)return!0;Sb=Sb.role;return 1===Sb||2===
Sb||this.veb&&6===Sb||3===Sb||4===Sb||5===Sb||!this.$Ja&&(7===Sb||8===Sb)};this.ga=x;this.hOj=S;this.SWj=ma;this.nyg=Fa;this.zH=Jb;this.ga.gb(ub.a.fkj,cc.a.application,pd.ActionManager.Nf,64);this.ga.gb(ub.a.gkj,cc.a.application,pd.ActionManager.Nf,64);this.Pte=$a.$("ReadingTimeIsEnabled")}get Y8i(){return 63}get Cxf(){return 0}C3e(b){this.DUa.reset();b.jH=!1;var h=this.hOj();Nd.PageReader.instance.Lfb(h)||(this.Xxd(),this.bIi());h=this.Nn.AAa(h,7,7).currentNode;var n=this.GIk(b.currentNode,h);h=
this.SWj(n,h);h.Om(this.Mpo,null);let x=n=0;for(var E=0;h.moveNext();)if(h.currentNode&&this.hd.N$(h.currentNode)){var S=this.hd.QN(h.currentNode);if(S.qr){var ma=this.hd.WXa(h.currentNode);if(ma&&(ma=ma.qa.last,Kb.App.qPa&&ma&&ma.Wh&&ma.ei))continue;b.wordCount+=1;if(S=this.$A.E9b(S,h.currentNode))S=oq.cwd(S),b.z5+=S.Vya+1,b.y5+=S.Vya-S.rhc;n+=1;x+=b.z5;E+=b.y5}}else if(this.veb&&h.currentNode&&Pd.ImageReader.qw(h.currentNode))b.cQ++;else if(this.veb&&h.currentNode&&ag.TableReader.XW(h.currentNode))b.Una++;
else if(h.currentNode&&Cd.ParagraphReader.oc(h.currentNode)){S=h.currentNode;ma=this.Pte?this.XSh(S,this.zH):1033;E=this.vhj(b,S,n,x,E,!0,-1,-1,-1,ma);if(E.EZf){b.jH=!0;u.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorWordCountPackageImageAndTableCountSettings");return}this.ozh(b,S);n=E.lMb;x=E.ptd;E=E.otd}this.N0i(b)?(this.Xxd(),this.Msn(),this.cIi(b)):this.Azi(b)}GIk(b,h){b?(b=this.nyg(b),b.Bb(7)):b=this.nyg(h);return b}Msn(){switch(this.hpd){case 1:this.ga.processAction(ub.a.fkj,
2);break;case 2:this.ga.processAction(ub.a.gkj,2)}}}Object(r.a)(vM,"TotalWordCountManager",oq,[]);class wM{constructor(){this.RUi=this.QUi=this.eVf=this.SUi=this.Y$i=this.Z$i=this.W$i=this.X$i=0}get eti(){return this.v2b(this.SUi,this.Z$i,"WC")}get oLm(){return this.v2b(this.QUi,this.W$i,"NumCharsNoSp")}get pLm(){return this.v2b(this.eVf,this.X$i,"NumCharsWithSp")}get uLm(){return this.v2b(this.RUi,this.Y$i,"NumParagraphs")}v2b(b,h,n){const x=this.E3c(h,n).toLocaleString();return 0<this.eVf?(b=this.K8f(b,
h,n),String.format(WordEditorIntl.WordEditorStrings.L_DocStatsDialogCountString,b.toLocaleString(),x)):x}K8f(b,h,n){b=this.E3c(b,n);return b>h?(w.ULS.sendTraceTag(22397767,338,15,"Sel>Total for {0}",n),h):b}E3c(b,h){0>b&&w.ULS.sendTraceTag(22397768,338,15,"{0}<0",h);return Math.max(b,0)}}Object(r.a)(wM,"DocumentStats",null,[]);class ZF{static kZe(b){return Kc.a.Lx(ZF.rl,WordEditorIntl.WordEditorStrings.L_DocStatsDialogWordsCount,b.eti,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsNoSpacesCount,
b.oLm,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsWithSpacesCount,b.pLm,WordEditorIntl.WordEditorStrings.L_DocStatsDialogParagraphsCount,b.uLm)}}ZF.rl="<table id='DocumentStatsTable' cellpadding=5 cellspacing=5 role='presentation' width='100%'> <tr role='presentation'> <td> <span id='WordCount' class='WACDialogSpan'>{0}</span> </td> <td style='text-align:right'> <span id='WordCountResult' class='WACDialogSpan'>{1}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharNoSpacesCount' class='WACDialogSpan'>{2}</span> </td> <td style='text-align:right'> <span id='CharNoSpacesCountResult' class='WACDialogSpan'>{3}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharWithSpacesCount' class='WACDialogSpan'>{4}</span> </td> <td style='text-align:right'> <span id='CharWithSpacesCountResult' class='WACDialogSpan'>{5}</span> </td> </tr> <tr role='presentation'> <td> <span id='ParagraphCount' class='WACDialogSpan'>{6}</span> </td> <td style='text-align:right'> <span id='ParagraphCountResult' class='WACDialogSpan'>{7}</span> </td> </tr> </table>";
Object(r.a)(ZF,"DocumentStatsDialogHtml",null,[]);class xM extends Kc.a{constructor(b){super();this.HK=!1;this.GXk=()=>{};this.wx=b}FUn(){this.kg="DocumentStatsDialog";this.ug=ZF.kZe(this.wx);this.Ed=0;this.showDialog(WordEditorIntl.WordEditorStrings.L_DocStatsDialogTitle,this.GXk);this.m3("DocumentStatsTable")}UT(){}dispose(){this.HK||(super.dispose(),this.HK=!0)}}Object(r.a)(xM,"DocumentStatsDialog",Kc.a,[]);class yM{constructor(b,h,n,x,E,S,ma,Fa,$a){this.Y_g=this.Inc=this.Olc=this.KQb=this.Xue=
!1;this.y$b=()=>{this.Rbe()};this.Fma=()=>{this.Rbe()};this.KMn=()=>{this.Y_g=!0;return 32};this.XNf=()=>this.Ps.AMa?32:8;this.PVc=(sb,Jb,Sb,oc,Ic)=>{if(1===Sb)return this.Ps.AMa?32:8;Ic[Qf.a.On]=this.etf;return 32};this.E$d=(sb,Jb,Sb)=>{if(1===Sb)return this.Ps.AMa?32:8;this.etf?this.QUk():this.A_k();ob.App.xa.ZF({ShowWordCount:"CheckboxModel"});return 32};this.rec=(sb,Jb,Sb)=>{if(1===Sb)return Ee.a.Jla(Jb)?8:this.Ps.AMa?32:8;if(this.Y_g)return u.AFrameworkApplication.ya.processAction(ub.a.NXd,2),
32;sb=this.le.fg("UserAction","Show Word Count Dialog");sb.start();this.Ps.t0c();this.bP.t0c();this.Ps.JC!==this.bP.JC?w.ULS.sendTraceTag(23188303,338,50,"Open Word Count Dialog with content selected"):w.ULS.sendTraceTag(523072473,338,50,"Open Word Count Dialog without content selected");Jb=this.gHk();(new xM(Jb)).FUn();sb.stop();return 32};this.bVc=(sb,Jb,Sb,oc,Ic)=>{Ic||w.ULS.sendTraceTag(23652428,338,10,String.format("{0}","actionData is null"));if(1===Sb)return 32;if(!this.Ps.AMa)return Ic[nl.a.Visible]=
!1,32;Ic[nl.a.Visible]=!0;this.etf?(sb=this.Ps.JC,0>sb?sb=WordEditorIntl.WordEditorStrings.l_WordCountCalculating:sb?(Jb=this.bP?this.bP.JC:-1,sb=0<Jb?this.EGl(sb,Jb):String.format(1===sb?WordEditorIntl.WordEditorStrings.l_WordCountResultSingularAccurate:WordEditorIntl.WordEditorStrings.l_WordCountResultAccurate,this.c4d(sb))):sb=String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultExact,this.c4d(sb))):sb=WordEditorIntl.WordEditorStrings.l_WordCountHidden;Ic[nl.a.LabelText]=sb;return 32};
this.gke=ma;this.hke=S;this.Ps=b;this.bP=h;this.wvc=n;this.MUj=E;this.bP.iOe(this.y$b);this.Ps.iOe(this.y$b);this.bP.CWb(this.Fma);this.Ps.CWb(this.Fma);this.le=Fa;this.$Ja=x;this.dSa=$a.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}get e1e(){return!V.a.p2}Vb(){const b=u.AFrameworkApplication.ya;b.pa(ub.a.E$d,cc.a.application,this.E$d);b.pa(ub.a.rec,cc.a.view,this.rec);b.gb(ub.a.PVc,cc.a.application,this.PVc,96);b.gb(ub.a.bVc,cc.a.application,this.bVc,96);b.gb(ub.a.XNf,cc.a.application,
this.XNf,96);b.pa(ub.a.GBh,cc.a.application,this.KMn)}get $Ja(){return this.Olc}set $Ja(b){this.Olc=b;this.Ps.$Ja=b;this.bP.$Ja=b}A_k(){this.Ps.AMa&&(this.B_i(!0),this.Rbe(),this.Ps.t0c())}gHk(){const b=new wM;b.Z$i=this.Ps.JC;b.X$i=this.Ps.WZb;b.W$i=this.Ps.wCc;b.Y$i=this.Ps.yCc;b.SUi=this.bP.JC;b.QUi=this.bP.wCc;b.eVf=this.bP.WZb;b.RUi=this.bP.yCc;return b}Sol(){return this.gke("WACWordCountEnabled",this.e1e)}k5d(b){this.hke("WACWordCountEnabled",b?"true":"false",Ya.a.eNa)}get etf(){this.KQb||(this.Xue=
this.Sol(),this.KQb=!0);return this.Xue}B_i(b){this.k5d(b);this.Xue=b;this.KQb=!0}QUk(){this.Ps.Xxd();this.bP.Xxd();this.B_i(!1);this.Rbe()}get MI(){return null!=this.Vog?this.Vog:this.Vog=(()=>this.wvc())()}Rbe(){this.Inc||(w.ULS.sendTraceTag(23188304,338,50,"Word count document stats: {0}",this.KMk()),this.Inc=!0);this.MI&&this.MI.FQ(this.MUj)}KMk(){const b={["words"]:this.Ps.JC,["charsWithSpaces"]:this.Ps.WZb,["charsWithNoSpaces"]:this.Ps.wCc,["paragraphs"]:this.Ps.yCc};this.dSa&&(b.images=this.Ps.kxb,
b.tables=this.Ps.pxb);return b}c4d(b){try{return b.toLocaleString()}catch(h){w.ULS.sendTraceTag(23652430,338,10,String.format("Error converting count to locale string, error: {1}, stacktrace: {2}",h.toString(),h.stack))}return b.toString()}EGl(b,h){h>b&&(w.ULS.sendTraceTag(23652432,338,10,String.format("Selection word count is greater than total word count.")),h=b);return String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultOnSelectionAccurate,this.c4d(h),this.c4d(b))}}Object(r.a)(yM,"WordCountActor",
null,[]);class zM extends Rt.a{constructor(b,h,n,x){super();this.Q2=(E,S)=>{if(S.property===ie.a.lo||S.property===ie.a.Un)E=S.node,S=Kb.App.fm.jb.Jc,S.Nr&&S.ud&&S.ud.Nc&&E.Nc&&E.Nc.id===S.ud.Nc.id&&this.QCh(E)};this.jxi=(E,S)=>{this.QCh(S.node)};this.PSm=(E,S)=>{S.property!==ad.a.Jv&&S.property!==ic.a.Qr||this.kX()};this.XVd=()=>{this.kX()};this.YU=b;this.Ps=h;this.No=n;this.dSa=x.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}Uy(){var b=this.No.Te(12);b.jp(this.Q2);b.rs(this.jxi);b.xv(this.jxi);
b=this.No.Te(22);b.jp(this.PSm);b.rs(this.XVd);b.xv(this.XVd);this.dSa&&this.ekn();this.YU.yna(this,7)}ekn(){var b=[19,14];for(let h of b)b=this.No.Te(h),b.rs(this.XVd),b.xv(this.XVd)}get index(){return 1}run(){this.Ps.s1e()}QCh(b){b.X3c=null;this.kX()}}Object(r.a)(zM,"WordCountAppEventCoordinator",Rt.a,[]);class yH{}yH.EZj="AccurateWordCountButton";Object(r.a)(yH,"WordCountConstants",null,[]);class AM{constructor(b,h){this.Ps=b;this.bP=h}getInstance(b){switch(b){case 1:return this.bP;case 0:return this.Ps;
default:return this.Ps}}}Object(r.a)(AM,"WordCountManagerFactory",null,[241]);class zH{constructor(){this.W=null}get name(){return"WordEditor.WordCount"}zc(b){this.W=b;const h=this.W.resolve("Common.IAppSettingsManager");this.W.ha("WordEditor.WordCount.ITableCountSelectionTraverserFactory",()=>new uM(h)).singleInstance();this.W.ha("WordEditor.WordCount.IWordCountManagerFactory",()=>{var n=new tp(10,rd.a.lf);const x=new vM(b.resolve("Box4.List.IListReader"),b.resolve("Box4.IListMarkerUtility"),new qm.a,
u.AFrameworkApplication.ya,u.AFrameworkApplication.uc,()=>Kb.App.fm.jb.Jc.ud,cn.a.Ir,md.GraphIterator.$a,h,n,Oa.a.instance.resolve("Box4.ILanguageReader"));n=new tM(Oa.a.instance.resolve("Box4.List.IListReader"),Oa.a.instance.resolve("Box4.IListMarkerUtility"),new qm.a,kh.a.instance,u.AFrameworkApplication.uc,Lw.a.instance,vb.a.instance,Oa.a.instance.resolve("WordEditor.WordCount.ITableCountSelectionTraverserFactory"),h,n,Oa.a.instance.resolve("Box4.ILanguageReader"));return new AM(x,n)}).singleInstance();
this.W.ha("WordEditor.WordCount.GraphFullyConnectedGetter",()=>new lM(this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0))).as("WordEditor.IGraphFullyConnectedGetter").singleInstance()}init(){const b=ob.App.xa.jb;b.fta?this.Dga():b.Zca(()=>{this.Dga()})}Dga(){if(ob.App.Wj){var b=ob.App.Wj.al;if(b){this.W.resolve("WordEditor.IGraphFullyConnectedGetter");var h=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0),n=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(1),
x=Oa.a.instance.resolve("Common.IAppSettingsManager");(new yM(h,n,()=>Oa.a.instance.Pa("WordEditor.IStatusBarUser"),this.Vnl(),yH.EZj,Ya.a.hPa,Ya.a.Lka,Oa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),x)).Vb();(new zM(xj.GraphTransactionManager.instance,h,b,x)).Uy();h.s1e()}else w.ULS.sendTraceTag(22425994,306,10,"Graph is null. Word Count will not be available")}else w.ULS.sendTraceTag(23967264,306,15,"TheNotebookManager is null. Word Count will not be available")}Vnl(){var b=
Kb.App.fm.jb;if(!b)return w.ULS.sendTraceTag(22611550,324,10,""),!1;b=b.Jc;if(!b)return w.ULS.sendTraceTag(22611552,324,10,""),!1;b=b.ud;return b?b.ia(ic.a.$Ja,!1):(w.ULS.sendTraceTag(22611554,324,10,""),!1)}dispose(){}static main(){N.a.instance.Pc(new zH)}}Object(r.a)(zH,"PackageManager",null,[1,2]);var aQ=d(1895);class BM{constructor(b){this.PEe=null;b.Za("Common.App.SearchCommon.SearchHostRuntime").execute(h=>{this.PEe=h})}ZWi(b){this.PEe&&this.PEe.ddf().handleDocumentContentAugloopAnnotation(b)}}
Object(r.a)(BM,"DocumentContentExtractionManager",null,[470]);class ih{}ih.fYn="mso_smartLookup";ih.channelId="SmartLookup";ih.eYn="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";ih.L4i="https://uci.edog.cdn.office.net/mirrored/smartlookup/";ih.M4i="https://uci.cdn.office.net/mirrored/smartlookup/";ih.dYn="https://hedwigtestserver.blob.core.windows.net/builds/";ih.cYn="http://localhost:8080/";ih.Y_c="current";ih.K4i="next";ih.u_m=2;ih.M$b=1;ih.oib=CommonUIStrings.L_SmartLookupPaneTitle;
ih.gy="InsightsTaskPane";ih.V2f="InsightsTaskPaneData";ih.zkf="InsightsContentFrame";ih.width=400;ih.hGm="ApplicationPropertiesRequest";ih.uGm="SelectionRequest";ih.oGm="PageRendered";ih.gGm="ApplicationProperties";ih.tGm="Selection";ih.wGm="Telemetry";ih.vGm="TakeFocus";ih.nGm="LostFocus";ih.kGm="Keyboard";ih.lGm="LegalAgreed";ih.zso="WordWac";ih.uXm="OneNoteWAC";ih.gJf="yes";ih.j9i="appCorrelationId";ih.R4n="clientCorrelationId";ih.k9i="message";ih.iji="Microsoft::Office::Insights::LegalAgreed";
Object(r.a)(ih,"InsightsConstants",null,[]);var vE=d(1561);class oD{}Object(r.a)(oD,"ActivityContractInfo",null,[]);class Ls{}Object(r.a)(Ls,"BrowserPaneDataField",null,[]);class pD{}Object(r.a)(pD,"BrowserPaneTelemetryEvent",null,[]);class rl{static MA(b,h){const n=new pD;n.eventName="Diagnostics";n.isActivity=!1;n.activityContract=Object.assign(new oD,{success:!0});const x=[],E=new Ls;E.name="Message";E.dataType=0;E.value=b;b=new Ls;b.name="Level";b.dataType=0;b.value=rl.getLevelString(h);Array.add(x,
E);Array.add(x,b);n.dataFields=x;rl.sendTelemetryEvent(n)}static fVi(b,h){const n=new pD;n.eventName=b;n.isActivity=!1;n.activityContract=Object.assign(new oD,{success:!0});b=[];const x=new Ls;x.name="AppCorrelationId";x.dataType=0;x.value=h;Array.add(b,x);n.dataFields=b;rl.sendTelemetryEvent(n)}static hDn(b,h,n,x,E,S){const ma=new pD;ma.eventName="LaunchPaneWithError";ma.isActivity=!1;ma.activityContract=Object.assign(new oD,{success:!0});const Fa=[],$a=new Ls;$a.name="IsNetworkConnected";$a.dataType=
0;$a.value=b?"true":"false";b=new Ls;b.name="IsHostruntimeAvailable";b.dataType=0;b.value=h?"true":"false";h=new Ls;h.name="EntryPoint";h.dataType=0;h.value=n;n=new Ls;n.name="RuntimeVersion";n.dataType=0;n.value=x;x=new Ls;x.name="IsFirstRelease";x.dataType=1;x.value=E?"true":"false";E=new Ls;E.name="IsZeroTerm";E.dataType=1;E.value=S?"true":"false";S=new Ls;S.name="IsClientSideRendering";S.dataType=1;S.value="false";Array.add(Fa,$a);Array.add(Fa,h);Array.add(Fa,b);Array.add(Fa,n);Array.add(Fa,x);
Array.add(Fa,E);Array.add(Fa,S);ma.dataFields=Fa;rl.sendTelemetryEvent(ma)}static hVf(b,h,n){const x=new pD;x.eventName="CDNDownloadLatency";x.isActivity=!0;x.activityContract=Object.assign(new oD,{duration:n,success:!0});n=[];const E=new Ls;E.name="CDNHostname";E.dataType=0;E.value=b;b=new Ls;b.name="Filename";b.dataType=0;b.value=h;Array.add(n,E);Array.add(n,b);x.dataFields=n;rl.sendTelemetryEvent(x,1)}static Tcc(b,h,n,x,E,S,ma,Fa){const $a=new pD;$a.eventName="LaunchPane";$a.isActivity=!0;$a.activityContract=
Object.assign(new oD,{duration:h,success:!0});h=[];const sb=new Ls;sb.name="AppCorrelationId";sb.dataType=0;sb.value=b;b=new Ls;b.name="EntryPoint";b.dataType=0;b.value=n;n=new Ls;n.name="IsServerSideRendering";n.dataType=1;n.value="true";const Jb=new Ls;Jb.name="UxVersion";Jb.dataType=0;Jb.value=x;x=new Ls;x.name="FeatureGates";x.dataType=0;x.value=E;E=new Ls;E.name="IsFirstRelease";E.dataType=1;E.value=S?"true":"false";S=new Ls;S.name="IsZeroTerm";S.dataType=1;S.value=ma?"true":"false";ma=new Ls;
ma.name="IsClientSideRendering";ma.dataType=1;ma.value=Fa?"true":"false";Array.add(h,sb);Array.add(h,b);Array.add(h,n);Array.add(h,Jb);Array.add(h,x);Array.add(h,E);Array.add(h,S);Array.add(h,ma);$a.dataFields=h;rl.sendTelemetryEvent($a)}static sendTelemetryEvent(b,h=2){if(b.isFeedbackActivity)rl.nvm(b.eventName);else{var n=-1<b.eventName.indexOf(rl.i9i)?b.eventName:rl.i9i+b.eventName,x=rl.anl(b.dataFields);b.isActivity?(b=Object.assign(new uh.a,{name:n,samplingPolicy:h,dataFields:x,succeeded:b.activityContract.success,
durationMs:b.activityContract.duration}),Y.a.sendActivityEvent(b)):(b=Object.assign(new fa.a,{name:n,samplingPolicy:h,dataFields:x}),Y.a.sendTelemetryEvent(b))}}static getLevelString(b){switch(b){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static anl(b){const h=[];if(b&&0<b.length)for(const n of b)(b=Wg.a.iea(n.name,n.value,rl.dEk(n.dataType)))&&Array.add(h,b);return h}static dEk(b){switch(b){case 0:return 2;case 1:return 1;case 2:return 3;case 3:return 4;default:return 0}}static nvm(b){const h=
Oa.a.instance.Pa("Common.ISystemInitiatedFeedback");h?h.logActivity(b,null):w.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}rl.i9i="Office.Insights.SmartLookup.";Object(r.a)(rl,"TelemetryUtils",null,[]);var qD;(function(b){b[b.other=0]="other";b[b.searchBoxSearch=1]="searchBoxSearch";b[b.searchBoxDictionary=2]="searchBoxDictionary";b[b.searchBoxQuickAnswer=3]="searchBoxQuickAnswer";b[b.smartLookupRibbon=4]="smartLookupRibbon";b[b.smartLookupContextMenu=5]="smartLookupContextMenu";
b[b.entity=6]="entity";b[b.dictionary=7]="dictionary";b[b.web=8]="web";b[b.pictures=9]="pictures";b[b.files=10]="files";b[b.bookmarks=11]="bookmarks";b[b.help=12]="help";b[b.chartRecommendation=13]="chartRecommendation";b[b.linkSkill=14]="linkSkill";b[b.searchBoxFindInDocument=15]="searchBoxFindInDocument";b[b.searchBoxEntity=16]="searchBoxEntity";b[b.searchSkill=17]="searchSkill";b[b.controlF=18]="controlF";b[b.ribbonFindButton=19]="ribbonFindButton";b[b.reuseSlides=20]="reuseSlides";b[b.data=21]=
"data";b[b.contextMenuDictionary=22]="contextMenuDictionary";b[b.contextMenuSearchSuggestion=23]="contextMenuSearchSuggestion";b[b.contextMenuSynonyms=24]="contextMenuSynonyms";b[b.contextMenuSearchBoxSearch=25]="contextMenuSearchBoxSearch";b[b.searchBoxSearchZeroTerm=26]="searchBoxSearchZeroTerm";b[b.contextMenuSearchZeroTerm=27]="contextMenuSearchZeroTerm";b[b.note=28]="note";b[b.smartLookupAutoLaunch=29]="smartLookupAutoLaunch";b[b.contextMenuSmartLookupInSubMenu=30]="contextMenuSmartLookupInSubMenu";
b[b.dataDisambiguate=31]="dataDisambiguate";b[b.linkFiles=32]="linkFiles";b[b.searchBoxNoteL2=33]="searchBoxNoteL2";b[b.contextMenuLaunchL2Document=34]="contextMenuLaunchL2Document";b[b.prefetch=99]="prefetch"})(qD||(qD={}));Object(r.b)("EntryPoint",qD);var Yt=d(1503),qw=d(1515);class Zt{static l6(b,h,n,x,E,S){if(1===n)return Vh.SessionStatusManager.instance.dK?32:8;if(E.value.gTn())return rl.MA("Skipping Serplet launch",10),32;h=S;if(!h)return 8;b=Zt.kzb();if(n=h.CommandValueId)try{h=z.a(n)}catch(ma){return w.ULS.sendTraceTag(594044173,
1313,15,"SmartLookup application interface [{0}] is not in proper format",n),8}n=h;h.selection||(h.neighborhood?n=Object.assign(new Yt.a,{selection:h}):(h=E.value.q2b(),n.selection=Object.assign(new qw.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength})));n.selection.clientDetectedLanguage=E.value.iRh();return Zt.G0b(S,null,n,b,0,E)}static G0b(b,h,n,x,E,S){const ma={};ma.controlId=b?b.SourceControlId:"shortcut";n&&(ma.entryPoint=qD[n.entryPoint]);w.ULS.sendTraceTag(594044172,
1303,50,Zt.ZS("Show insights",x,ma));h?S.value.xVn(h,x,E):n&&S.value.yVn(n,x,E);return 32}static ZS(b,h,n=null){b={["appCorrelationId"]:h,["message"]:b};if(n)for(let x in n)b[x]=n[x];return z.c(b)}static kzb(){return na.a.create().toString()}}Object(r.a)(Zt,"InvokingPaneUtils",null,[]);class CM{}Object(r.a)(CM,"LaunchDataInDoc",null,[]);var fv=d(1518);class AH{constructor(b,h,n,x,E,S,ma,Fa,$a){this.Rlc=this.Wad=this.Tv=null;this.nC=b;this.ga=h||u.AFrameworkApplication.ya;this.Mo=n;this.Wb=x;this.OKg=
Fa;this.Grc=E;this.Ma=S;this.Hb=ma;this.k1l();this.URa=new se.a(()=>new gn.a($a.value,Object(v.a)(this,this.bAb,"getMoreInfoEventReceived")))}Vb(){this.ga.pa(Ra.a.Z4l,Ld.a.frame,Object(v.a)(this,this.vVn,"showInsights"));this.ga.pa(Ra.a.$4l,Ld.a.frame,Object(v.a)(this,this.wVn,"showInsightsForTellMe"));this.ga.pa(Ra.a.definitions,Ld.a.frame,Object(v.a)(this,this.vUn,"showDefinitions"));this.ga.pa(Ra.a.o1e,Ld.a.frame,Object(v.a)(this,this.wUn,"showDefinitionsForTellMe"));this.ga.pa(Ra.a.c_f,Ld.a.frame,
Object(v.a)(this,this.c_f,"showInsightsForSuggestion"));this.OKg&&(this.ga.pa(Ra.a.Nea,Ld.a.frame,Object(v.a)(this,this.l6,"invokeSmartLookupPane")),this.ga.pa(Ra.a.fMc,Ld.a.frame,Object(v.a)(this,this.fMc,"invokeInDocSerplet")),this.ga.pa(Ra.a.kMd,Ld.a.frame,Object(v.a)(this,this.kMd,"invokeSerpletRibbon")),this.ga.pa(Ra.a.gMc,Ld.a.frame,Object(v.a)(this,this.gMc,"invokeSerpletContextMenu")),this.ga.pa(Ra.a.Anf,Ld.a.frame,Object(v.a)(this,this.Anf,"invokeSerpletTellMeZeroTerm")),this.ga.pa(Ra.a.znf,
Ld.a.frame,Object(v.a)(this,this.znf,"invokeSerpletTellMeNotes")),this.ga.pa(Ra.a.gMd,Ld.a.frame,Object(v.a)(this,this.gMd,"invokeImageSerpletContextMenu")),this.ga.pa(Ra.a.lMd,Ld.a.frame,Object(v.a)(this,this.lMd,"invokeSynonymsSerpletContextMenu")),this.ga.pa(Ra.a.fMd,Ld.a.frame,Object(v.a)(this,this.fMd,"invokeDictionarySerpletContextMenu")),this.ga.pa(Ra.a.nMd,Ld.a.frame,Object(v.a)(this,this.nMd,"invokeZeroTermSerpletContextMenu")),this.ga.pa(Ra.a.jMd,Ld.a.frame,Object(v.a)(this,this.jMd,"invokeSerpletBrowseFiles")),
this.ga.pa(Ra.a.hMd,Ld.a.frame,Object(v.a)(this,this.hMd,"invokeInDocSerpletWithLaunchData")),this.ga.pa(Ra.a.O0d,Ld.a.frame,Object(v.a)(this,this.O0d,"queryToggleSerplet")),this.ga.pa(Ra.a.x5d,Ld.a.frame,Object(v.a)(this,this.x5d,"setInDocSearchParameter")),u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",!1)&&(this.ga.pa(Ra.a.a9h,Ld.a.frame,Object(v.a)(this,this.F6l,"invokeSmartLookupPaneConversations")),this.ga.pa(Ra.a.dMd,Ld.a.frame,Object(v.a)(this,
this.dMd,"invokeAutoLaunchSearchRequest"))),this.Qin().continueWith(()=>{u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.updateCommandUI(!0)}))}w6g(){this.ga.gb(Ra.a.IBa,Ld.a.frame,Object(v.a)(this,this.IBa,"invokeFilesSerplet"),4);this.ga.gb(Ra.a.unf,Ld.a.frame,Object(v.a)(this,this.IBa,"invokeFilesSerplet"),4);this.ga.gb(Ra.a.V8h,Ld.a.frame,Object(v.a)(this,this.v6l,"invokeLinkFilesSerplet"),4);if(this.Ma.$("IsTellMeUpSellEnterpriseEnabled")&&this.Ma.$("SmartLookupTokenPrefetchIsEnabled")){const b=
We.a.F9(0,Object(v.a)(this,this.nEi,"prefetchToken"),0,177);this.Hb.$b(b)}}ENe(){Mg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&(this.ga.pa(Ra.a.IBa,Ld.a.frame,Object(v.a)(this,this.vnf,"invokeFilesSerpletUnavailable")),this.ga.pa(Ra.a.unf,Ld.a.frame,Object(v.a)(this,this.vnf,"invokeFilesSerpletUnavailable")),this.ga.pa(Ra.a.V8h,Ld.a.frame,Object(v.a)(this,this.vnf,"invokeFilesSerpletUnavailable")))}nEi(b){w.ULS.sendTraceTag(579352786,
1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",b.interval,!!b.data);this.rgc().then(h=>{let n=1;if(h)w.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),this.yVf("SmartLookupFiles: Token prefetch succeeded",!0),h=6E4*this.Ma.rc("SmartLookupTokenRenewalWaitDurationInMinutes",30);else{w.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.yVf("SmartLookupFiles: Token prefetch failed",!1);n=parseInt(b.data||
"1");if(n>this.Ma.rc("SmartLookupTokenRenewalRetryThreshold",5)){w.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.yVf("SmartLookupFiles: Token prefetch max retry count reached",!1);return}h=6E4*this.Ma.rc("SmartLookupTokenRetryWaitDurationInMinutes",10);n++}h=new We.a(3,1,h,Object(v.a)(this,this.nEi,"prefetchToken"),177);h.data=n.toString();this.Hb.$b(h)})}yVf(b="",h=!1){this.Grc.execute(n=>{n&&n.Gjb("PrefetchToken",h,0,"SmartLookup",b)})}rgc(){return this.Grc?
new Promise(b=>{this.Grc.execute(h=>{if(h){var n=Date.now();h.getToken("SmartLookup",this.Ma.lb("SmartLookupShredderServiceEndpoint")).then(x=>{b(!!x&&0<x.length);h.Gjb("TryGetTokenInternal",!!x&&0<x.length,Date.now()-n,"SmartLookup")})}else b(!1)})}):Promise.resolve(!1)}Qin(){const b=new Nb.a;if(this.Ma.$("BrowserSupportsInsightsPaneSSO"))this.w6g(),b.Gg(!0);else{if(!this.Grc)return w.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),b.Gg(!1),this.ENe(),b.task;this.Grc.execute(h=>
{h?h.getToken("SmartLookup",this.Ma.lb("SmartLookupShredderServiceEndpoint")).then(n=>{w.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!n&&0<n.length);n&&0<n.length?(this.w6g(),b.Gg(!0)):this.ENe()}):(w.ULS.sendTraceTag(587534912,1303,10,"Unable to resolve oAuthManager"),b.Gg(!1),this.ENe())})}return b.task}vVn(b,h,n,x,E){if(1===n)return u.AFrameworkApplication.ua&&u.AFrameworkApplication.K.$("OneNoteDelayLoadContextActivationManager")&&!u.AFrameworkApplication.wBc?8:this.nC.value.eci()?32:8;b=
Zt.kzb();h=this.nC.value.q2b();return this.OKg?(h=Object.assign(new qw.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength}),h=Object.assign(new Yt.a,{selection:h,userIntent:null,entryPoint:0,launchData:Object.assign(new fv.a,{landingTab:"All"})}),Zt.G0b(E,null,h,b,0,this.nC)):Zt.G0b(E,h,null,b,0,this.nC)}vUn(b,h,n,x,E){if(1===n)return this.nC.value.eci()?32:8;b=Zt.kzb();h=this.nC.value.q2b();return Zt.G0b(E,h,null,b,1,this.nC)}wVn(b,h,n,x,E){return 1===n?32:this.cEh(E,
0)}wUn(b,h,n,x,E){return 1===n?32:this.cEh(E,1)}cEh(b,h){const n=Zt.kzb(),x=b.CommandValueId;let E;try{E=z.a(x)}catch(S){return w.ULS.sendTraceTag(6295941,1303,15,Zt.ZS(String.format("Insights parameters [{0}] is not in proper format.",x),n)),8}return Zt.G0b(b,E,null,n,h,this.nC)}c_f(b,h,n,x,E){if(1===n)return 32;if(!E)return 8;b=E.query?E.query:"";h=Zt.kzb();n=new vE.a;n.neighborhood=b;n.mentionStart=0;n.mentionLength=b.length;return Zt.G0b(E,n,null,h,0,this.nC)}v6l(b,h,n,x){if(1===n)return Vh.SessionStatusManager.instance.dK?
32:8;const E=u.AFrameworkApplication.K.$("InsertFileLinkSerpletIsEnabled"),S=this.nC.value.SXa();return this.l6(b,h,n,x,Object.assign(new Yt.a,{selection:Object.assign(new qw.a,{neighborhood:S.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new fv.a,{landingTab:"File"}),entryPoint:E?32:10}))}IBa(b,h,n,x){if(1===n)return Vh.SessionStatusManager.instance.dK?32:8;const E=u.AFrameworkApplication.K.$("InvokeReuseSlidesSerpletIsEnabled"),S=this.nC.value.SXa();return this.l6(b,h,n,
x,Object.assign(new Yt.a,{selection:Object.assign(new qw.a,{neighborhood:S.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new fv.a,{landingTab:E?"Slide":"File"}),entryPoint:E?20:10}))}vnf(){return 2}fMc(b,h,n,x,E){if(1===n)return Vh.SessionStatusManager.instance.Qj?8:32;const S=this.nC.value.SXa();E=void 0===E||null===E?18:19;return this.l6(b,h,n,x,Object.assign(new Yt.a,{selection:Object.assign(new qw.a,{neighborhood:S.neighborhood,mentionStart:S.mentionStart,mentionLength:S.mentionLength}),
launchData:Object.assign(new fv.a,{landingTab:"Indoc"}),entryPoint:E}))}hMd(b,h,n,x,E){E=E.CommandValueId;if(!E||E&&this.Rlc&&E.query===this.Rlc.query&&E.matchCase===this.Rlc.matchCase&&E.matchWholeWordOnly===this.Rlc.matchWholeWordOnly)return 32;const S=this.nC.value.SXa();return this.l6(b,h,n,x,Object.assign(new Yt.a,{selection:Object.assign(new qw.a,{neighborhood:S.neighborhood,mentionStart:S.mentionStart,mentionLength:S.mentionLength}),launchData:Object.assign(new fv.a,{landingTab:"Indoc",data:Object.assign(new CM,
{type:4,query:E.query,matchCase:E.matchCase,matchWholeWord:E.matchWholeWordOnly})}),entryPoint:18}))}O0d(b,h,n,x,E){E&&(E[Qf.a.On]=this.nC.value.NCb);return 32}x5d(b,h,n,x,E){if(b=E.CommandValueId)this.Rlc=b;return 32}F6l(b,h,n){if(1===n)return Vh.SessionStatusManager.instance.dK?32:8;b=this.nC.value.SXa();b=Object.assign(new Yt.a,{selection:Object.assign(new qw.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new fv.a,{landingTab:"All"})});
this.nC.value.sQd(b);return 32}dMd(b,h,n){if(1===n)return Vh.SessionStatusManager.instance.dK?32:8;b=this.nC.value.SXa();b=Object.assign(new Yt.a,{selection:Object.assign(new qw.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new fv.a,{landingTab:"All",data:u.AFrameworkApplication.byb})});h=Zt.kzb();this.nC.value.LIb(b,h);return 32}kMd(b,h,n,x){if(1===n)return Vh.SessionStatusManager.instance.dK?32:8;const E=this.nC.value.kRh();return this.l6(b,
h,n,x,Object.assign(new Yt.a,{selection:Object.assign(new qw.a,{neighborhood:E.neighborhood,mentionStart:E.mentionStart,mentionLength:E.mentionLength}),entryPoint:4,launchData:Object.assign(new fv.a,{landingTab:"All"})}))}gMc(b,h,n,x){return this.l6(b,h,n,x,Object.assign(new Yt.a,{entryPoint:5,launchData:Object.assign(new fv.a,{landingTab:"All"})}))}Anf(b,h,n,x){if(1===n)return Vh.SessionStatusManager.instance.dK?32:8;const E=this.nC.value.SXa();return this.l6(b,h,n,x,Object.assign(new Yt.a,{selection:Object.assign(new qw.a,
{neighborhood:E.neighborhood,mentionStart:E.mentionStart,mentionLength:0}),launchData:Object.assign(new fv.a,{landingTab:"All"}),entryPoint:26}))}fMd(b,h,n,x){return 1===n?(b=this.nC.value.q2b())&&0<b.mentionLength?32:8:this.l6(b,h,n,x,Object.assign(new Yt.a,{entryPoint:22,launchData:Object.assign(new fv.a,{landingTab:"All"})}))}gMd(b,h,n,x){return this.l6(b,h,n,x,Object.assign(new Yt.a,{launchData:Object.assign(new fv.a,{landingTab:"Image"}),entryPoint:9}))}lMd(b,h,n,x){return this.l6(b,h,n,x,Object.assign(new Yt.a,
{launchData:Object.assign(new fv.a,{landingTab:"All"}),entryPoint:24}))}znf(b,h,n,x){return this.l6(b,h,n,x,Object.assign(new Yt.a,{launchData:Object.assign(new fv.a,{landingTab:"Notes"}),entryPoint:33}))}nMd(b,h,n,x){if(1===n)return Vh.SessionStatusManager.instance.dK?32:8;const E=this.nC.value.SXa();return this.l6(b,h,n,x,Object.assign(new Yt.a,{selection:Object.assign(new qw.a,{neighborhood:E.neighborhood,mentionStart:E.mentionStart,mentionLength:0}),launchData:Object.assign(new fv.a,{landingTab:"All"}),
entryPoint:27}))}l6(b,h,n,x,E){return Zt.l6(b,h,n,x,this.nC,E)}jMd(b,h,n){if(1===n)return 32;this.Tv||this.URa.value.fk("Browse File from Search pane",!0);if(!this.Wad||""===this.Wad)return w.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;rd.a.ym(this.Wad,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}bAb(b){this.Tv||3!==b.state||(this.Tv=b,this.Wad=this.Tv.Aaa)}k1l(){const b=this.Wb.pe(ih.gy);b.parent=xd.AFrame.Lp;b.Wca(Object(v.a)(this,this.Scc,
"sendIFrameTakeFocusMessage"));this.Mo.kS(ih.gy)}Scc(){document.activeElement.blur();u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.Qfb||(this.nC.value.HHn(),this.nC.value.fDn())}dispose(){this.nC.value&&this.nC.value.dispose()}}Object(r.a)(AH,"InsightsActor",null,[10]);const BH=b=>{b=b.split("-");return b[b.length-1]},cQ=()=>{var b=$F();if(b)return Promise.resolve(b);b=wE().replace("SearchWeb","searchweb");b=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?b+ih.K4i+"/":b+ih.Y_c+"/";b+="version.json";if(V.a.K$)return bQ(b);try{const h=new Sys.Net.WebRequest;h.set_httpVerb("GET");h.set_url(b);b={};b.method=h.get_httpVerb();return"function"!==typeof window.fetch?(rl.MA("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(h.getResolvedUrl(),b).then(n=>n.json()).catch(()=>{rl.MA("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(n=>{n=z.b(JSON.stringify(n));
return n.version?n.version:""},n=>{rl.MA("InsightsUtils - Failed to deserialize version: "+n.toString(),10);w.ULS.sendTraceTag(591971029,1303,15,"Insights: Failed to deserialize version: "+n.toString());return""}).then(n=>n)}catch(h){return rl.MA("InsightsUtils - Failed to download version.json: "+h.toString(),10),w.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+h.toString()),Promise.resolve("")}},bQ=b=>{const h=u.AFrameworkApplication.Ze;return new Promise(n=>{const x=
new WF.a(b,1,null,null,!0,2,null);h.send(x).qDa(E=>{E&&E.data?E.data.Ee||(rl.MA("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+E.data.mf,10),n("")):(rl.MA("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),n(""));try{const S=z.b(E.data.Ee);S.version&&n(S.version)}catch(S){rl.MA("InsightsUtils - Failed to deserialize version: "+S.toString(),10),n("")}},E=>{E&&E.data?rl.MA("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+
E.data.mf,10):rl.MA("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",10);n("")})})},aG=()=>u.AFrameworkApplication.K.$("SmartLookupEnableLocalOverride")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),bG=()=>{const b=wE();return aG()||u.AFrameworkApplication.K.lb("SmartLookupPRClientVersion")?b+$F()+"/":u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?b+ih.K4i:b+ih.Y_c},$F=()=>aG()?"dev":u.AFrameworkApplication.K.lb("SmartLookupPRClientVersion")?u.AFrameworkApplication.K.lb("SmartLookupPRClientVersion").split("/")[1]:u.AFrameworkApplication.K.lb("SmartLookupClientVersion"),CH=b=>{var h=3===u.AFrameworkApplication.ua.Sb.jo?"wordwac":2===u.AFrameworkApplication.ua.Sb.jo?"pptwac":"excelwac";var n=vj.a.lg(u.AFrameworkApplication.lcid);const x=n?n.name:"en-us";n=wE();const E=uC();h="main_ssr_wac.html?appName="+h+"&culture="+x;return"LOCAL"===E?
n+h:n+((""!==b?b:ih.Y_c)+"/")+h},dQ=b=>wE()+(""!==b?b:ih.Y_c)+"/scripts/microsoft.office.smartlookup.host.runtime.js",wE=()=>{switch(uC()){case "LOCAL":return ih.cYn;case "PR":const b=u.AFrameworkApplication.K.lb("SmartLookupPRClientVersion").split("/");return ih.dYn+b[0]+"/";case "INT":return ih.eYn;case "EDOG":return ih.L4i;default:return ih.M4i}},eQ=()=>{if(!u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(uC()){case "EDOG":return ih.L4i;
case "PROD":return ih.M4i;default:return""}},uC=()=>{if(u.AFrameworkApplication.K.$("SmartLookupEnableEdogSourceLocationOverride")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(u.AFrameworkApplication.K.$("SmartLookupEnableProdSourceLocationOverride")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(u.AFrameworkApplication.K.$("SmartLookupEnableIntSourceLocationOverride")||
u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",!1))return"INT";if(u.AFrameworkApplication.K.lb("SmartLookupPRClientVersion")&&u.AFrameworkApplication.K.lb("SmartLookupPRIntentSvc"))return"PR";if(aG())return"LOCAL";switch(Object(ja.a)(String,u.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",
!1)){let b=u.AFrameworkApplication.K.lb("UserPrincipalName");b=B.a.mh(b);const h=u.AFrameworkApplication.K.vu("SmartLookupINTEnabledForSKITeam")?u.AFrameworkApplication.K.AB("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(h,b))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},DM=()=>{let b;b=u.AFrameworkApplication.K.$("IntentSvcEnableEdogSourceLocationOverride")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",
!1)?"EDOG":u.AFrameworkApplication.K.$("IntentSvcEnableProdSourceLocationOverride")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",!1)?"PROD":u.AFrameworkApplication.K.$("IntentSvcEnableIntSourceLocationOverride")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":uC();const h=u.AFrameworkApplication.K.lb("IntentServiceEndpoint"),n=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",
!1);if("PROD"===b&&""!==h)return h+"searchendpointv2/";switch(b){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";case "PR":return u.AFrameworkApplication.K.lb("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(n?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(n?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+
"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}};class EM{sendTelemetryEvent(b){rl.sendTelemetryEvent(b)}}Object(r.a)(EM,"OtelTelemetrySink",null,[518]);class FM{}Object(r.a)(FM,"ApplicationProperties",null,[]);class GM{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(r.a)(GM,"CurrentDocumentProperties",null,[]);class HM{}Object(r.a)(HM,"EnterpriseUserInfo",null,[]);class IM{}Object(r.a)(IM,"FeatureGates",
null,[]);class DH{constructor(b,h){this.du=this.Ei=null;this.nni=!0;this.Ytb=h;this.jy=b;this.jy.execute(n=>{n.isFeatureEnabled("mso_sendASmile",!0).then(x=>{this.nni=x}).catch(x=>{rl.MA("SearchHelper - Failed to check if Feedback feature is enabled: "+x.toString(),15)})});b=DM();h=u.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(u.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")){this.du=
{};const n=this.OGl();if(n&&0<n.length)for(let x=0;x<n.length;x++){const E=n[x],S=this.ZGl(E);switch(S.toLowerCase()){case "true":this.du[E]=!0;break;case "false":this.du[E]=!1;break;default:this.du[E]=S}}this.du.EnableInDocumentSearch=h;this.du.EnableInDocumentSearchReplace=!0;this.du.EnableInDocumentParamLocalSearch=!0;this.du.EnableInDocumentQuerySuggest=h&&u.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",
!1);this.du.EnableInDocumentQuestionGeneration=h&&u.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1);this.du.EnableInDocumentGlobalEncoder=h&&u.AFrameworkApplication.K.$("SmartLookupEnableInDocumentGlobalEncoder")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentGlobalEncoder",!1);this.du.EnableInDocumentExperiment1=
h&&u.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.du.EnableInDocumentExperiment2=h&&u.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1);this.du.EnableInDocumentExperiment3=h&&u.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||
u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.du.EnableZeroTermAutoRefresh=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.du.EnableTap3SZeroTerm=u.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",!1);this.du.EnableLocalSearch=!0;
this.du.EnableInDocumentStickyFilters=!0;this.du.IntentServiceEndpoint=b;this.du.EnablePDFShredding=u.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.du.FilterNonPPTFilesForReuseSlides=u.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides");this.du.UXBundleVersion=$F();this.du.SmartLookupServicePath=bG();this.du.EnableAcronymSearch=!0;this.du.UseAltAnswerEndpoint1=
u.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.du.UseAltAnswerEndpoint2=u.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.du.UseAltAnswerEndpoint3=u.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",
!1);this.du.UseNextUXVersion=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.du.IgnoreNeighborhoodContext=u.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.du.ShowDebugInfo="INT"===uC();this.du.DebugCommands=u.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands","");this.du.ChangeGates=u.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",
"");this.du.QnaInMixSection=!0;this.du.EnableNoteSearch=u.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.du.EnableWikiL2=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.du.EnableFilteringOutRedundantKPE=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",
!1);this.du.EnableZeroTermEntitySuggestion=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.du.RankingModels=u.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.du.EnableClientSideRendering=!0}else this.Ei=new IM,this.Ei.EnableInDocumentSearch=h,this.Ei.EnableInDocumentSearchReplace=!0,this.Ei.EnableInDocumentParamLocalSearch=!0,this.Ei.EnableInDocumentQuerySuggest=h&&
u.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.Ei.EnableInDocumentQuestionGeneration=h&&u.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1),this.Ei.EnableInDocumentGlobalEncoder=h&&u.AFrameworkApplication.K.$("SmartLookupEnableInDocumentGlobalEncoder")||
u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentGlobalEncoder",!1),this.Ei.EnableInDocumentExperiment1=h&&u.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.Ei.EnableInDocumentExperiment2=h&&u.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",
!1),this.Ei.EnableInDocumentExperiment3=h&&u.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.Ei.EnableZeroTermAutoRefresh=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.Ei.EnableTap3SZeroTerm=u.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.Ei.EnableLocalSearch=!0,this.Ei.EnableInDocumentStickyFilters=!0,this.Ei.IntentServiceEndpoint=b,this.Ei.EnablePDFShredding=u.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.Ei.FilterNonPPTFilesForReuseSlides=u.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides"),this.Ei.UXBundleVersion=$F(),this.Ei.SmartLookupServicePath=bG(),this.Ei.EnableAcronymSearch=
!0,this.Ei.UseAltAnswerEndpoint1=u.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.Ei.UseAltAnswerEndpoint2=u.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.Ei.UseAltAnswerEndpoint3=u.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.Ei.UseNextUXVersion=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.Ei.IgnoreNeighborhoodContext=u.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.Ei.ShowDebugInfo="INT"===uC(),this.Ei.DebugCommands=u.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.Ei.ChangeGates=u.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.Ei.QnaInMixSection=!0,this.Ei.EnableNoteSearch=u.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.Ei.EnableWikiL2=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.Ei.EnableFilteringOutRedundantKPE=
u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.Ei.EnableZeroTermEntitySuggestion=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.Ei.RankingModels=u.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.Ei.EnableClientSideRendering=!0,this.Ei.SharedSerpletFeatureGate1=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",
!1),this.Ei.SharedSerpletFeatureGate2=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.Ei.SharedSerpletFeatureGate3=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.Ei.SharedSerpletFeatureGate4=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.Ei.SharedSerpletFeatureGate5=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",
!1),this.Ei.SharedSerpletFeatureGate6=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.Ei.SharedSerpletFeatureGate7=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.Ei.SharedSerpletFeatureGate8=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.Ei.SharedSerpletFeatureGate9=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",
!1),this.Ei.SharedSerpletFeatureGate10=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.Ei.SharedSerpletFeatureGate11=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.Ei.SharedSerpletFeatureGate12=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.Ei.SharedSerpletFeatureGate13=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",
!1),this.Ei.SharedSerpletFeatureGate14=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.Ei.SharedSerpletFeatureGate15=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.Ei.SharedSerpletFeatureGate16=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.Ei.SharedSerpletFeatureGate17=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",
!1),this.Ei.SharedSerpletFeatureGate18=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.Ei.SharedSerpletFeatureGate19=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.Ei.SharedSerpletFeatureGate20=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.Ei.SharedSerpletFeatureGate21=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",
!1),this.Ei.SharedSerpletFeatureGate22=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.Ei.SharedSerpletFeatureGate23=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.Ei.SharedSerpletFeatureGate24=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.Ei.SharedSerpletFeatureGate25=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",
!1),this.Ei.SharedSerpletFeatureGate26=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.Ei.SharedSerpletFeatureGate27=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.Ei.SharedSerpletFeatureGate28=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.Ei.SharedSerpletFeatureGate29=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",
!1),this.Ei.SharedSerpletFeatureGate30=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.Ei.SharedSerpletFeatureGate31=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.Ei.SharedSerpletFeatureGate32=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.Ei.SharedSerpletFeatureGate33=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",
!1),this.Ei.SharedSerpletFeatureGate34=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.Ei.SharedSerpletFeatureGate35=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.Ei.SharedSerpletFeatureGate36=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.Ei.SharedSerpletFeatureGate37=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",
!1),this.Ei.SharedSerpletFeatureGate38=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.Ei.SharedSerpletFeatureGate39=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.Ei.SharedSerpletFeatureGate40=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.Gqc=Oa.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");
this.DEb=!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableOAuthManager",!1);this.Ugb=DH.isEnterpriseUser();this.YMa=u.AFrameworkApplication.K.lb("SmartLookupShredderServiceEndpoint");this.sxf=Ec.a.b2(u.AFrameworkApplication.K.lb("AppCatalogUrl")||"");this.BBm=u.AFrameworkApplication.K.lb("UserPrincipalName");(this.Ugb||this.DEb)&&this.DXh()}ZGl(b){return u.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline."+
b,"")}OGl(){const b=u.AFrameworkApplication.K.lXa,h=u.AFrameworkApplication.K.AB("SmartLookupFlightKeywordList"),n=[];if(b&&h&&0<h.length)for(let E in b){var x={key:E,value:b[E]};x=x&&x.key?x.key:"";for(let S=0;S<h.length;S++)if(-1<x.toLowerCase().indexOf(h[S].toLowerCase())){const ma=x.split(".");ma&&4===ma.length&&Array.add(n,ma[ma.length-1])}}return n}ogf(b,h,n,x){return new Promise(E=>{this.Pim().then(S=>{const ma=new FM;ma.anid="";ma.applicationName=3===u.AFrameworkApplication.ua.Sb.jo?"WORD":
"POWERPNT";ma.applicationVersion=u.AFrameworkApplication.buildVersion;ma.appCorrelationId=b?b:Zt.kzb();ma.themePlatform="web";ma.lcid=u.AFrameworkApplication.lcid;ma.launchUtcTime=(new Date).toUTCString();u.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?ma.featureGates=z.c(this.du):ma.featureGates=z.c(this.Ei);var Fa=vj.a.lg(u.AFrameworkApplication.lcid);Fa=Fa?Fa.name:null;ma.market=BH(Fa);ma.uiLanguage=Fa;ma.sessionId=u.AFrameworkApplication.userSessionId;ma.themeId=n;ma.parentalControl="yes";
ma.processorOnlyMode=S;ma.isEditingAllowed=h.isEditingAllowed();ma.isFeedbackEnabled=this.nni;ma.isClientSideRendering=18===x||19===x||15===x;ma.disableClipboard=u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&u.AFrameworkApplication.fO&&!u.AFrameworkApplication.j0b;ma.accessToken=this.Ugb||this.DEb?this.DXh():"";S=new HM;S.CountryCode=BH(Fa);S.ServiceEndpoint=this.YMa;S.IsGoLocal=u.AFrameworkApplication.K.$("IsGoLocalEnvironment");
S.IsEnabled=this.Ugb;S.IsEnterpriseEnabled=this.Ugb;S.TenantRoot=this.sxf;S.Upn=this.BBm;ma.enterpriseUserInfo=S;S=new GM;S.filePath=u.AFrameworkApplication.K.lb("EditDocInClientUrl");S.docName=u.AFrameworkApplication.K.lb("FileName");S.author=99!==x?h.author():null;S.createdDate=99!==x?h.createdDate():null;ma.currentDocument=S;E(ma)})})}Pim(){return new Promise(b=>{this.jy?this.jy.execute(h=>{h.isFeatureEnabled(ih.fYn,!0).then(n=>{b(!n)}).catch(n=>{rl.MA("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+
n.toString(),10);b(!0)})}):b(!0)})}Z1m(b){this.Gqc&&(this.Ugb||this.DEb)&&this.CZh(this.YMa).then(h=>{b(h)})}DXh(){if("Dev Box"===u.AFrameworkApplication.K.lb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride)return window.SearchPaneShredderTokenOverride;const b=this.DEb?"Search":"SmartLookup";return this.Gqc?this.Gqc.GKl(b,this.YMa,this.DEb):""}CZh(b){if("Dev Box"===u.AFrameworkApplication.K.lb("StatusBarEnvironmentNameToUse")&&
void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride)return new Promise(n=>{n(window.SearchPaneShredderTokenOverride)});const h=this.DEb?"Search":"SmartLookup";return this.Gqc?this.Gqc.getToken(h,b,this.DEb):Promise.resolve("")}NIc(){return this.Ytb?this.Ytb.getVersion():""}Bpl(){return u.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?z.c(this.du):z.c(this.Ei)}static isEnterpriseUser(){const b=u.AFrameworkApplication.K.lb("SovereignEnvironmentName"),
h=u.AFrameworkApplication.K.$("IsTellMeUpSellEnterpriseEnabled");return(!b||!b.length)&&h}}Object(r.a)(DH,"SearchHelper",null,[471]);class vC{constructor(){vC._instance=""}getVersion(){return vC._instance}ONn(b){vC._instance=b}}vC._instance=null;Object(r.a)(vC,"SmartLookupVersion",null,[]);class JM{}Object(r.a)(JM,"ConfigurationProvider",null,[]);class rD{constructor(b){rD._instance=b}ddf(){return rD._instance}}rD._instance=null;Object(r.a)(rD,"SearchHostRuntime",null,[]);class EH{constructor(){this.dca=
this.WMb=this.W=null}get name(){return"Common.App.Insights"}zc(b){this.W=b;const h=Bh.a.Iq(Oa.a.instance.Za("Common.IEventEmitter<Common.IGetMoreInfoResult>")),n=u.AFrameworkApplication.K.$("SmartLookupEnableNativePane")||u.AFrameworkApplication.K.$("SmartLookupIsEnabled");b.register(AH,"Common.App.Insights.InsightsActor").singleInstance().Xd(()=>new AH(b.Ye("Common.App.Insights.IInsightsManager"),u.AFrameworkApplication.ya,ln.a.instance,de.FocusManager.instance(),b.Za("Common.App.SearchCommon.ISearchOAuthManager"),
u.AFrameworkApplication.K,Ye.a.instance,n,new se.a(()=>h.result)));b.register(470,"Common.App.Insights.IDocumentContentExtractionManager").singleInstance().Xd(()=>new BM(b));n&&(b.register(vC,"Common.App.Insights.SmartLookupVersion").singleInstance().Xd(()=>new vC),b.register(471,"Common.App.SearchCommon.ISearchHelper").singleInstance().Xd(()=>new DH(Oa.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Pa("Common.App.Insights.SmartLookupVersion"))))}init(){u.AFrameworkApplication.yZ&&
(this.WMb=this.W.Pa("Common.App.Insights.InsightsActor"),this.WMb.Vb())}iYk(){this.s5l()}s5l(){cQ().then(b=>{if(""!==b){const h=this.W.Pa("Common.App.Insights.SmartLookupVersion");h&&h.ONn(b)}this.azd();this.WMb=this.W.resolve("Common.App.Insights.InsightsActor");b=dQ(b);b=bc.a.create(b);b.MV((h,n)=>{n.succeeded?this.NOn()&&this.prefetchZeroTerm():rl.MA("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+n.WB,10);this.WMb.Vb()});Eb.a.KS(b)})}NOn(){const b=Object.assign(new JM,
{channelId:ih.channelId,approvedOriginPattern:aG()?"^(http)?://(localhost:8080)$":u.AFrameworkApplication.K.lb("SmartLookupApprovedOriginPattern")});var h=this.W.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const n=this.W.resolve("Common.App.SearchCommon.ISerpletExecutor"),x=this.W.resolve("Common.App.SearchCommon.IInsertContentExecutor"),E=new Qa.a;h&&E.add(h);n&&E.add(n);x&&E.add(x);h=DM();try{const S=new EM,ma=SmartLookupHostRuntime.setup(b,E.toArray(),!0,h,S);this.W.register(rD,
"Common.App.SearchCommon.SearchHostRuntime").singleInstance().Xd(()=>new rD(ma));return!0}catch(S){return rl.MA("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+S,10),!1}}prefetchZeroTerm(){if(u.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)){var b=Oa.a.instance.Pa("Common.App.SearchCommon.SearchHostRuntime");if(b){const h=
this.W.resolve("Common.App.SearchCommon.ISearchHelper"),n=this.W.resolve("Common.App.SearchCommon.IDocumentHelper");h.ogf(null,n,0,99).then(x=>{b.ddf().prefetchZeroTerm(x,u.AFrameworkApplication.userSessionId,bG(),!0,"Indoc",null)})}else rl.MA("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}azd(){var b=this.W.resolve("Common.App.SearchCommon.ISearchHelper");const h=CH(b.NIc());b=b.NIc();b=wE()+(""!==b?b:ih.Y_c)+"/scripts/microsoft.office.smartlookup.ssr.js";
const n=eQ();V.a.K$?this.hYk(h,b):(this.fYk(h,n),this.gYk(b,n))}fYk(b,h){const n=new Sys.Net.WebRequest;n.set_httpVerb("GET");const x={};x.method=n.get_httpVerb();n.set_url(b);const E=(new Date).getTime();try{window.fetch(n.getResolvedUrl(),x).then(()=>{""!==h&&rl.hVf(h,b,(new Date).getTime()-E);this.W.Pa("Common.App.Insights.SmartLookupVersion")})}catch(S){rl.MA("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+S.toString(),10)}}gYk(b,h){var n=new Sys.Net.WebRequest;
n.set_httpVerb("GET");const x={};x.method=n.get_httpVerb();n.set_url(b);let E=-1;if(u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))n=u.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),Ye.a.instance.$b(new We.a(5,1,n,()=>{const S=bc.a.create(b);S.ONe(()=>{E=Date.now()});S.MV((ma,Fa)=>{Fa.succeeded?""!==h&&rl.hVf(h,b,Date.now()-E):rl.MA("InsightsPackage - Failed to prefetch JS file.",
10)});Eb.a.KS(S)}));else{E=Date.now();try{window.fetch(n.getResolvedUrl(),x).then(()=>{""!==h&&rl.hVf(h,b,Date.now()-E)})}catch(S){rl.MA("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+S.toString(),10)}}}hYk(b,h){if(V.a.K$){var n=u.AFrameworkApplication.Ze;b=new WF.a(b,1,null,null,!0,2,null);n.send(b).qDa(x=>{x&&x.data?x.data.Ee?this.W.Pa("Common.App.Insights.SmartLookupVersion"):rl.MA("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+
x.data.mf,10):rl.MA("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},x=>{x&&x.data?rl.MA("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+x.data.mf,10):rl.MA("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});u.AFrameworkApplication.K.$("SmartLookupPrefetchJSIsEnabled")&&(h=new WF.a(h,1,null,null,!0,2,null),n.send(h).qDa(x=>{x&&x.data?x.data.Ee||rl.MA("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+
x.data.mf,10):rl.MA("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},x=>{x&&x.data?rl.MA("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+x.data.mf,10):rl.MA("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.WMb&&this.WMb.dispose()}}Object(r.a)(EH,"InsightsPackage",null,[1,2]);var KM=d(1545);class LM{constructor(){this.documentContentTableName=this.dataCenterEndpoint=
this.documentContentKey=null}}Object(r.a)(LM,"DocumentContentParams",null,[]);var cG=d(1785),FH=d(524),xE=d(723),Ms;(function(b){b.yQa="SearchProvider";b.CQa="TextSummarization"})(Ms||(Ms={}));Object(r.b)("WorkflowType",Ms);var $t;(function(b){b.Success="Success";b.dbg="Invoked";b.Error="Error";b.Timeout="Timeout";b.wqj="StaleAnnotation";b.Flj="AugloopLateResponse"})($t||($t={}));Object(r.b)("LogType",$t);class dG{constructor(b){this.Czh=b;this.PEf=this.PEf.bind(this);this.bTc=this.bTc.bind(this)}submitDocumentContentExtractionSignal(){return Object(xu.__awaiter)(this,
void 0,void 0,function*(){try{this.kBn=Date.now();this.Cjb=na.a.create().toString();this.logMessage({rE:Ms.yQa,logType:$t.dbg,success:!0,correlationId:this.Cjb,message:"[SearchProvider] workflow invoked"});var b=uC().toLowerCase();b="int"===b||"local"===b;yield this.activateAnnotation();const h=new eg.l({parentPath:["Signal",cG.SearchProviderSignal.getTypeName()],items:[{id:"SearchProvider",body:new cG.SearchProviderSignal({correlationId:this.Cjb,shouldUseIntEndpoint:b})}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:h});
this.YTi=window.setTimeout(()=>{this.onError(Ms.yQa,$t.Timeout,"[SearchProvider] request timed out")},1500)}catch(h){window.clearTimeout(this.YTi),this.onError(Ms.yQa,$t.Error,this.IOh(h))}})}generateDocumentSummary(){return Object(xu.__awaiter)(this,void 0,void 0,function*(){try{this.z5n=Date.now();if(!dG.e7b)return this.logMessage({rE:Ms.CQa,logType:$t.Error,success:!1,message:"[TextSummary] workflow disbled by flight"}),null;this.logMessage({rE:Ms.CQa,logType:$t.dbg,success:!0,message:"[TextSummary] workflow invoked"});
yield this.activateAnnotation();const b=new eg.l({parentPath:["Signal",xE.GenerateTextSummarySignal.getTypeName()],items:[{id:"TextSummarization",body:new xE.GenerateTextSummarySignal}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:b});this.O3f=window.setTimeout(()=>{this.onError(Ms.CQa,$t.Timeout,"[TextSummary] request timed out")},3E3);return new Promise(h=>{this.Wec=h})}catch(b){window.clearTimeout(this.O3f),this.onError(Ms.CQa,$t.Error,this.IOh(b))}})}static get e7b(){return u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.ContentCreationSummaryEnabled",
!1)}activateAnnotation(){return Object(xu.__awaiter)(this,void 0,void 0,function*(){if(!this.d5b){yield If.a.zn();var b=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation,h=[b(Object.assign(new FH.a,{annotationType:cG.SearchProviderAnnotation.getTypeName(),handler:this.PEf}))];dG.e7b&&h.push(b(Object.assign(new FH.a,{annotationType:xE.TextSummaryAnnotation.getTypeName(),handler:this.bTc})));yield Promise.all(h);this.d5b=!0}})}bTc(b){if(this.Wec)if(this.Fdi(b)){if(b=b.items[0],xE.TextSummaryAnnotation.typeGuard(b.body))if(window.clearTimeout(this.O3f),
b=b.body,b.status!==xE.Result.Success)this.onError(Ms.CQa,$t.Error,`[TextSummary] workflow failed with status: ${b.status}`);else this.logMessage({rE:Ms.CQa,logType:$t.Success,success:!0,message:"[TextSummary] workflow completed successfully"}),this.Wec(b.summary),this.Wec=null}else this.logMessage({rE:Ms.CQa,logType:$t.Error,success:!1,message:"[TextSummary] operation values invalid"});else window.clearTimeout(this.O3f),this.logMessage({rE:Ms.CQa,logType:$t.Error,success:!1,message:"[TextSummary] summary callback is not defined"})}PEf(b){if(this.Fdi(b)&&
(b=b.items[0],cG.SearchProviderAnnotation.typeGuard(b.body)))if(window.clearTimeout(this.YTi),(b=b.body)&&(b.docContentKey||b.dataCenterEndpoint||b.documentContentTableName))if(void 0===this.Cjb)this.logMessage({rE:Ms.yQa,logType:$t.Flj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] workflow results arrived after timeout",workflowExecutionTime:b.workflowExecutionTime});else if(this.Cjb!==b.correlationId)this.logMessage({rE:Ms.yQa,logType:$t.wqj,success:!1,correlationId:b.correlationId,
message:"[SearchProvider] current correlation Id is not the one pending",workflowExecutionTime:b.workflowExecutionTime});else{var h=this.Qrh(b.docContentKey,b.dataCenterEndpoint,b.documentContentTableName);this.logMessage({rE:Ms.yQa,logType:$t.Success,success:!0,correlationId:b.correlationId,message:"[SearchProvider] workflow completed successfully",workflowExecutionTime:b.workflowExecutionTime});this.Cjb=void 0;this.Czh.ZWi(h)}else this.onError(Ms.yQa,$t.Error,"[SearchProvider] annotation is empty or incorrect")}Fdi(b){return b&&
b.items&&0<b.items.length&&b.items[0].body}logMessage(b){var h=b.rE===Ms.yQa?this.kBn:this.z5n;const n=Date.now(),x=h?n-h:-1;h=[Object.assign(new ca.a,{name:"WorkflowType",string:b.rE}),Object.assign(new ca.a,{name:"LogType",string:b.logType}),Object.assign(new ca.a,{name:"CorrelationId",string:b.correlationId}),Object.assign(new ca.a,{name:"Message",string:b.message}),Object.assign(new ca.a,{name:"WorkflowExecutionTime",int64:b.workflowExecutionTime}),Object.assign(new ca.a,{name:"StartTime",int64:h}),
Object.assign(new ca.a,{name:"EndTime",int64:n}),Object.assign(new ca.a,{name:"Duration",int64:x})];Object(Pe.a)("AugloopSearchProviderData",b.success,x,h)}IOh(b){return`Error: ${b}, Message: ${b.message}, Stack: ${b.stack}`}Qrh(b="",h="",n=""){return Object.assign(new LM,{documentContentKey:b,dataCenterEndpoint:h,documentContentTableName:n})}onError(b,h,n){if(b===Ms.yQa){if(!this.Cjb)return;this.logMessage({rE:b,logType:h,success:!1,correlationId:this.Cjb,message:n});this.Cjb=void 0;this.T4k()}b===
Ms.CQa&&this.Wec&&(this.logMessage({rE:b,logType:h,success:!1,message:n}),this.Wec(null),this.Wec=null)}T4k(){this.Czh.ZWi(this.Qrh())}}Object(r.a)(dG,"AugloopSearchProviderManager",null,[]);class eG{constructor(){this.results=null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(r.a)(eG,"DocumentContentSearchResults",null,[]);class GH{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(b,h,n,x,E){this.selectRange(h,n,x,E)}search(){}searchV2(b,h){this.search(b,n=>{h(Object.assign(new eG,
{results:n,totalResultCount:n.length,hasTooManyResults:100<n.length}))})}searchWithParam(b,h){this.search(b.query,h)}searchWithParamV2(b,h){this.searchWithParam(b,n=>{h(Object.assign(new eG,{results:n,totalResultCount:n.length,hasTooManyResults:n.length>b.totalResultLimit}))})}highlight(){}highlightWithParam(b){this.highlight(b.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return new Promise(b=>
{b(null)})}getId(){return"DocumentContentExecutor"}}Object(r.a)(GH,"BaseDocumentContentExecutor",null,[906,279]);class DB{static get gEm(){return 50}static sGd(b){if(""===b)return"";let h=0,n="";try{const x=di.a.V1b(b);for(const E of x.ops)if(DB.zF(E))h||(n+=DB.kql(E.attributes.atmention.fullName)),h+=1;else{const S=E.insert?E.insert:"";" "!==S&&0<S.length&&(h=0,n+=S)}}catch(x){w.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return n}static nkl(b){b=
DB.sGd(b);return 0<b.length&&b.split(" ").length<=DB.gEm?b:null}static kql(b){let h="";b&&(b=b.split(" "),0<b.length&&(h=b[0]));return h}static zF(b){return!!b.attributes&&!!b.attributes.atmention}}Object(r.a)(DB,"BaseCommentSmartReplyHelpers",null,[]);class yE extends DB{constructor(){super()}static vzb(b,h,n=!1){if(!b)return null;b=b.text&&0<b.text.length?b.text[0]:"";h=!h||!h.Rf||""===h.Rf;return 0<b.length&&h&&!n?DB.nkl(b):null}}Object(r.a)(yE,"CommentSmartReplyHelpers",DB,[]);var gv=d(1427);
class fG{constructor(){this.query=null;this.matchWholeWordOnly=this.matchCase=!1;this.totalResultLimit=0}}Object(r.a)(fG,"DocumentContentSearchParams",null,[]);class HH{constructor(){this.subdocumentId=null;this.endParagraphOffset=this.endParagraphIndex=this.startParagraphOffset=this.startParagraphIndex=0}}Object(r.a)(HH,"DocumentSelection",null,[]);var zE=d(673);class IH{constructor(){this.zFc=this.HWe=0}}Object(r.a)(IH,"CommentFindResultIndexInfo",null,[]);const JH=(b,h)=>{var n=b.ib.kb;if(!n||
!n.length)return null;n=n.Qa;h=h.xe(n.node,n.gl);b.setSelection(h)};class MM{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=0}}Object(r.a)(MM,"DocumentContentSearchResult",null,[]);var fQ=d(1746);class NM{constructor(){this.Lyb=this.LWe=null}}Object(r.a)(NM,"CommentFindResults",null,[]);class OM{constructor(){this.end=this.begin=0}}Object(r.a)(OM,"FindResultOffset",
null,[]);class sA{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb){this.cie=this.Ku=this.doe=this.$z=null;this.Y1g=0;this.Kt=null;this.jkc=new Qa.a;this.gxg=null;this.CH=b;this.fb=h;this.Nsb=n;this.Aca=E;this.JPb=S;this.Tmc=ma;this.ii=Fa;this.ga=$a;this.hb=sb;this.hA=Jb}get Oja(){return this.gxg}initialize(){this.$z=os.FindManager.createInstance(this,this.Aca,KC.a.instance,!1,!0)}search(b,h){this.$z.xVa();this.yrf(b)?(this.Ku=h,this.Kt=new Qa.a,b=this.g_e(b),this.$z.find(b)):h(null)}searchV2(b,h){u.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IWacWordCommentsInFindPaneSettings");
this.$z.xVa();if(this.yrf(b)){this.Rbi()&&this.ga.Xb(Ra.a.x5d,2,{CommandValueId:b});this.cie=h;this.Y1g=b.totalResultLimit;this.Kt=new Qa.a;b=this.g_e(b);this.gxg=new mm.a;this.$z.find(b);h=this.Aca.xUc(b.text);h=this.Aca.pGb(h);b=this.JPb.Q2b(h.join("|"),b);h=this.ii.aT();for(let E=0;E<h.length;E++){const S=h[E];var n=yE.sGd(S.text[0]).split("\n");n=1===n.length?n[0]:n.join(" ");var x=this.Tmc.BJc(n,b);if(x)for(let ma of x)x=fQ.a.createInstance(ma.begin,ma.end,C.a.Of(S.objectId),E,32,!1),this.jkc.add(x),
this.Oja.xb(E)||this.Oja.add(E,Object.assign(new NM,{LWe:n,Lyb:[]}));else w.ULS.sendTraceTag(572343620,313,15,"commentTextIsNull: {0}, findRegexIsNull: {1}",!n,!b)}}else h(null)}get iGh(){null==this.doe&&(this.doe=os.FindManager.createInstance(this,this.Aca,KC.a.instance));return this.doe}Rbi(){var b;return null===(b=u.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}ONd(){var b;return null===(b=u.AFrameworkApplication.K)||
void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocHeaderFooterSearchOnWac",!1)}highlight(b){var h=this.yrf(b);b=h?this.g_e(b):null;var n={};this.Rbi()&&this.ga.Xb(ub.a.WNf,2,n);if(n[Qf.a.On]){if(h){h={};n={};var x={};this.ga.Xb(ub.a.U_d,2,h);this.ga.Xb(Ra.a.T_d,2,n);this.ga.Xb(Ra.a.V_d,2,x);if(b.text!=h.CommandValueId||b.matchCase!=n[Qf.a.On]||b.matchWholeWord!=x[Qf.a.On])JH(this.hb,this.hA),this.ga.Xb(Ra.a.findInDocument,2,{CommandValueId:b.text,MatchCase:b.matchCase,
MatchWholeWord:b.matchWholeWord})}}else n=this.iGh,n.xVa(),h&&n.find(b)}selectNextPrevHighlight(b){const h=this.iGh;return 0<h.Ej.Vga?(b?h.YHd():h.ZHd(),h.Ej.gMe-1):-1}g_e(b){let h=Hs.a.none;b.matchCase&&(h|=Hs.a.matchCase);b.matchWholeWordOnly&&(h|=Hs.a.wholeWordOnly);return jx.a.createQuery(b.query,h)}yrf(b){return b&&!!b.query&&0<b.query.length}p6d(){}T4d(){}reset(){}b8e(){}S0b(){if(this.Ku){var b=this.Rrh(this.Kt);this.Ku(b)}if(this.cie){b=new eG;const h=this.Kt.count+this.jkc.count>this.Y1g;
b.totalResultCount=this.Kt.count+this.jkc.count;b.hasTooManyResults=h;h||(this.Kt.uA(this.Kt.count,this.jkc),b.results=this.Rrh(this.Kt));this.cie(b);this.jkc.clear()}}Rrh(b){const h=[];var n=Object.assign(new zE.a,{Eeb:!1,Feb:this.ONd(),Geb:!0});n=this.fb.KXa(this.CH.value,n);for(let E of b){var x=E.begin;let S=E.end,ma;b=-1;let Fa=null,$a=0;if(32===E.type){Fa=sA.Knh;$a=3;b=n.count+E.peb;const sb=({begin:x,end:S}=KM.a.NLi(this.Oja.J(E.peb).LWe,x,S)).returnValue;ma=this.Nsb.m_e(sb,x,S,JC.a(E.type));
this.Oja.J(E.peb).LWe=sb;this.Oja.J(E.peb).Lyb.push(Object.assign(new OM,{begin:x,end:S}))}else{!this.ONd()||2!==E.type&&4!==E.type||($a=2===E.type?1:2,Fa=sA.Ejf);for(x=0;x<n.count;x++)if(n.J(x).id===E.nodeId){b=x;break}ma=this.Nsb.Owd(E)}0<=b&&(b=Object.assign(new MM,{snippet:ma.hYe,subdocumentId:Fa,subdocumentType:$a,startOffsetInSnippet:ma.hTf,endOffsetInSnippet:ma.eTf-1,paragraphIndex:b,startOffsetInParagraph:E.begin-ma.hTf,endOffsetInParagraph:E.end-ma.eTf-1}),h.push(b))}h.sort((E,S)=>E.paragraphIndex===
S.paragraphIndex?E.startOffsetInParagraph-S.startOffsetInParagraph:E.paragraphIndex-S.paragraphIndex);return h}update(){}BKa(b,h){switch(b){case 0:h&&0<h.length&&!this.Kt&&(w.ULS.sendTraceTag(570975814,313,15,"Results container list is null"),this.Kt=new Qa.a);for(let n of h)this.Kt.add(n)}}Yjb(){}dispose(){}}sA.Knh="Comment";sA.Ejf="HeaderFooter";Object(r.a)(sA,"WordDocumentSearchProcessor",null,[280,10,281]);class PM extends GH{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc){super();this.Ma=sb;this.STa=
null;this.Q2=(Ic,gd)=>{Ic=gd.node;gd=gd.property;this.VYf(Ic)&&gd===ie.a.lo&&this.UAb(Ic,3)};this.Cfa=(Ic,gd)=>{Ic=gd.node;!gd.Cof&&this.VYf(Ic)&&this.UAb(Ic,1)};this.Shb=(Ic,gd)=>{Ic=gd.node;this.VYf(Ic)&&this.UAb(Ic,2)};this.CH=b;this.fb=h;this.Yc=n;this.hb=x;this.hA=E;this.nl=Fa;this.Wb=$a;this.e9=S;this.pv=ma;this.ii=Jb;this.dGj=Sb;this.kXg=C.a.create();this.Q1d(this.Q2,this.Cfa,this.Shb);oc.execute(Ic=>{this.ckd=Ic})}get lO(){return!this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.NoCommentFocusOnFindSelection",
!1)}ONd(){var b;return null===(b=u.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocHeaderFooterSearchOnWac",!1)}submitDocumentContentExtractionSignal(){this.ckd&&this.ckd.submitDocumentContentExtractionSignal()}generateDocumentSummary(){return this.ckd?this.ckd.generateDocumentSummary():Promise.resolve(null)}getAllParagraphsInDocument(){var b=Object.assign(new zE.a,{Eeb:!1,Feb:!1,Geb:!0});const h=this.fb.KXa(this.CH.value,
b);b=new Qa.a;for(var n of h)b.add(this.iGd(n));for(let x of this.ii.aT())n=yE.sGd(x.text[0]).split("\n"),n=1===n.length?n[0]:n.join(" "),b.add(n);return b.toArray()}selectRange(b,h,n,x,E){const S=Date.now(),ma={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.n2a();if(0>b||0>h||0>n||0>x||b>n||b===n&&h>x)throw Error("Provided select range offsets incorrect");const Ic=Object.assign(new zE.a,{Eeb:!1,Feb:!1,Geb:!0}),gd=this.fb.KXa(this.CH.value,Ic);
if(n>=gd.count){const Gd=Oa.a.instance.resolve("Common.Comments.ICommentModel").aT(),vd=n-gd.count;if(vd<Gd.length){E=-1;if(this.e9.Oja.xb(vd)){const od=this.e9.Oja.J(vd).Lyb;for(var Fa=0;Fa<od.length;Fa++)if(od[Fa].begin===h){E=Fa;break}}this.STa=-1!==E?Object.assign(new IH,{HWe:vd,zFc:E}):null;const ce=Gd[vd];u.AFrameworkApplication.ya.processAction(ub.a.ES,2);u.AFrameworkApplication.ya.Xb(ub.a.L9,2,null);u.AFrameworkApplication.ya.Xb(ub.a.selectComment,2,Object.assign(new gv.a,{commentId:ce.id,
j3:2,lO:this.lO}))}}else{this.STa=null;var $a=gd.J(b),sb=gd.J(n);if(!this.EPd($a,h)||!this.EPd(sb,x))throw Error("Provided select range offsets incorrect");u.AFrameworkApplication.ya.processAction(ub.a.ES,2);this.y$i($a);var Jb=this.hA.xe($a,h);Fa=this.hA.MC(Jb,Dd.a.Uc(sb,x+1));if(E){const Gd=Fa.toArray();h=[];for(const vd of Gd)h.push(this.iGd(vd.node));h.join(" ").includes(E)||(ma.success=!1,ma.message="The text in clicked passage does not match the selected hit")}var Sb=this.nl.value.uv,oc=this.hb.ib.kb;
oc&&oc.equals(Fa)&&this.Yc.Ina(Sb,null);this.Yc.Ina(Sb,Fa);ma.duration=Date.now()-S;this.logMessage(ma)}}catch(Ic){ma.success=!1,ma.message=Ic.stack,ma.duration=Date.now()-S,this.logMessage(ma)}}search(b,h){this.n2a();this.e9.search(Object.assign(new fG,{query:b}),h)}searchV2(b,h){this.n2a();this.e9.searchV2(Object.assign(new fG,{query:b}),h)}selectNextPrevHighlight(b){this.n2a();return this.e9.selectNextPrevHighlight(b)}searchWithParam(b,h){this.n2a();this.e9.search(b,h)}searchWithParamV2(b,h){this.n2a();
this.e9.searchV2(b,h)}highlight(b){this.n2a();this.e9.highlight(Object.assign(new fG,{query:b}))}highlightWithParam(b){this.n2a();this.e9.highlight(b)}getRevision(){return this.kXg.toString()}getSelectedText(){const b=this.dGj.getSelectedText();return Object.assign(new qw.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:b.mentionLength})}getDocumentSelection(){var b=Object.assign(new zE.a,{Eeb:!1,Feb:this.ONd(),Geb:!0}),h=({qX:S}=this.AGl(b)).returnValue;if(h)return h;var n=
this.hb.ib.kb;if(!n||!n.length)return null;h=n.Qa;n=n.Tc;let x=-1,E=-1;var S=S||this.fb.KXa(this.CH.value,b);b=null;for(let ma=0;ma<S.count;ma++){const Fa=S.J(ma);-1===x&&h.node.id===Fa.id&&(x=ma,b=Fa);-1===E&&n.node.id===Fa.id&&(E=ma)}S=null;5===(null===b||void 0===b?void 0:b.Wza)&&(S=sA.Ejf);return Object.assign(new HH,{subdocumentId:S,startParagraphIndex:x,startParagraphOffset:h.gl,endParagraphIndex:E,endParagraphOffset:n.ot})}clearDocumentSelection(){JH(this.hb,this.hA)}selectRangeV2(b,h,n,x,
E,S){const ma=Date.now(),Fa={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.n2a();if(0>h||0>n||0>x||0>E||h>x||h===x&&n>E)throw Error("Provided select range offsets incorrect");const gd=Object.assign(new zE.a,{Eeb:!1,Feb:!0,Geb:!0}),Gd=this.fb.KXa(this.CH.value,gd);if(b==sA.Knh){const vd=Oa.a.instance.resolve("Common.Comments.ICommentModel").aT(),ce=x-Gd.count;if(ce<vd.length){S=-1;if(this.e9.Oja.xb(ce)){const Yd=this.e9.Oja.J(ce).Lyb;for(var $a=
0;$a<Yd.length;$a++)if(Yd[$a].begin===n){S=$a;break}}this.STa=-1!==S?Object.assign(new IH,{HWe:ce,zFc:S}):null;const od=vd[ce];u.AFrameworkApplication.ya.processAction(ub.a.ES,2);u.AFrameworkApplication.ya.Xb(ub.a.L9,2,null);u.AFrameworkApplication.ya.Xb(ub.a.selectComment,2,Object.assign(new gv.a,{commentId:od.id,j3:2,lO:this.lO}))}}else{this.STa=null;var sb=Gd.J(h),Jb=Gd.J(x);if(!this.EPd(sb,n)||!this.EPd(Jb,E))throw Error("Provided select range offsets incorrect");b==sA.Ejf?u.AFrameworkApplication.ya.Xb(ub.a.zgb,
2,new dz.a(sb)):u.AFrameworkApplication.ya.processAction(ub.a.ES,2);this.y$i(sb);var Sb=this.hA.xe(sb,n);$a=this.hA.MC(Sb,Dd.a.Uc(Jb,E+1));if(S){const vd=$a.toArray();n=[];for(const ce of vd)n.push(this.iGd(ce.node));n.join(" ").includes(S)||(Fa.success=!1,Fa.message="The text in clicked passage does not match the selected hit")}var oc=this.nl.value.uv,Ic=this.hb.ib.kb;(null===Ic||void 0===Ic?0:Ic.equals($a))&&this.Yc.Ina(oc,null);this.Yc.Ina(oc,$a);Fa.duration=Date.now()-ma;this.logMessage(Fa)}}catch(gd){Fa.success=
!1,Fa.message=gd.stack,Fa.duration=Date.now()-ma,this.logMessage(Fa)}}n2a(){this.Wb&&(this.Wb.xg&&this.Wb.xg.name===ih.gy||this.Wb.Jg(ih.gy))}ejo(){this.kXg=C.a.create()}iGd(b){if(b.lCb)return"";b=this.fb.text(b);return Tc.AParagraphNode.dU(b," ")}EPd(b,h){b=this.iGd(b);return h<b.length}UAb(b,h){switch(h){case 1:case 2:case 3:this.ejo()}}logMessage(b){const h=[Object.assign(new ca.a,{name:"Message",string:b.message})];Object(Pe.a)(b.activityName,b.success,b.duration,h)}VYf(b){return!b.lCb&&this.KNc(b)}KNc(b){const h=
this.CH.value;return!!h&&!!h.Ad&&!!b.Nc&&b.Nc.id.equals(h.Ad.id)}y$i(b){this.fb.cNc(b)?32===u.AFrameworkApplication.ya.Xb(ub.a.aib,2,new dz.a(b))&&u.AFrameworkApplication.ya.processAction(ub.a.X8e,2):u.AFrameworkApplication.ya.Xb(ub.a.L9,2,null)}Q1d(b,h,n){this.pv&&(this.pv.jp(b),this.pv.rs(h),this.pv.xv(n))}AGl(b){let h=null;var n=this.Wb?this.Wb.xg.name:"";if(!this.ii.Hs||n!==xd.AFrame.fr&&n!==xd.AFrame.qL)return{returnValue:null,qX:h};n=Array.indexOf(this.ii.aT(),this.ii.Hs);if(0>n)return{returnValue:null,
qX:h};h=this.fb.KXa(this.CH.value,b);var x=yE.sGd(this.ii.Hs.text[0]).split("\n");b=0;x=(1===x.length?x[0]:x.join(" ")).length-1;this.STa&&n===this.STa.HWe&&this.e9.Oja.xb(n)&&this.e9.Oja.J(n).Lyb.length>this.STa.zFc&&(b=this.e9.Oja.J(n).Lyb[this.STa.zFc].begin,x=this.e9.Oja.J(n).Lyb[this.STa.zFc].end);return{returnValue:Object.assign(new HH,{startParagraphIndex:h.count+n,startParagraphOffset:b,endParagraphIndex:h.count+n,endParagraphOffset:x,subdocumentId:"Comment"}),qX:h}}}Object(r.a)(PM,"WordDocumentContentExecutor",
GH,[]);class gG{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(r.a)(gG,"BaseDocumentHelper",null,[425]);class QM extends gG{constructor(b){super();this.Fcl=b}get Tyd(){const b=this.Fcl.instance;b&&b.loadDocumentProperty();return b}isEditingAllowed(){return ob.App.xa.jb.isEditingAllowed}author(){var b;return null===(b=this.Tyd)||void 0===b?void 0:b.author}createdDate(){var b;return null===(b=this.Tyd)||void 0===b?void 0:b.creationDate}}Object(r.a)(QM,"WordDocumentHelper",
gG,[]);class RM{constructor(b){this.Lmi=b}insertOnlinePicture(){}insertHtmlText(b){b&&this.wmf(b.htmlText)}getId(){return"InsertContentExecutor"}wmf(b){return this.executeCommand(Db.a.Eya,b)}executeCommand(b,h){const n=new qi.DictionaryPropertySet;n.setValue(ad.a.$T,h);n.setValue(ad.a.JDa,!1);h=this.Lmi.processAction(b,1);32===h&&(h=this.Lmi.Xb(b,2,n));return h}}Object(r.a)(RM,"WordInsertContentExecutor",null,[278,279]);class SM{constructor(b,h,n){this.alc="undefined";this.G6l=(x,E,S,ma,Fa)=>Zt.l6(x,
E,S,ma,this.nC,Fa);this.nC=b;this.ga=h||u.AFrameworkApplication.ya;this.Ma=n;this.PGj=(this.$v=!!u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.u6)&&!!this.Ma&&this.Ma.$("AutoOpenSearchPaneInDoublePortraitIsEnabled")}Vb(){this.ga.gb(ub.a.Cdh,Ld.a.frame,this.G6l,1028);this.PGj&&(this.alc=ob.App.xa.tu.getWindowMode(),this.rCh(this.alc),ob.App.xa.tu.registerBoundingWindowRectsChanged("SearchPane",(b,h)=>{h!==this.alc&&(this.alc=h,this.rCh(this.alc))}))}rCh(b){"DP"===b&&Cj.UISurfaces.Xt().then(h=>
{h.selectors.getTabbedTaskPaneCount()||this.ga.Xb(ub.a.Cdh,2,{SourceControlId:"smartlookupAuto"});return null})}}Object(r.a)(SM,"WordInsightsActor",null,[]);class sD{constructor(){this.LO=null}SXa(){return this.q2b()}kRh(){return this.q2b()}iRh(){return null}xVn(b,h,n){this.LO||(this.LO=this.zwd());this.LO.mO(b,h,n)}yVn(b,h,n){this.LO||(this.LO=this.zwd());this.LO.y3i(b,h,n)}LIb(b,h){this.LO||(this.LO=this.zwd());this.LO.LIb(b,h)}sQd(b){this.LO||(this.LO=this.zwd());this.LO.sQd(b)}fDn(){this.LO&&
this.LO.Scc()}HHn(){this.LO&&this.LO.m5d()}gTn(){var b=u.AFrameworkApplication.K.rc("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);b=window.performance.now()-sD.zii<=b;b||(sD.zii=window.performance.now());return b}dispose(){this.LO&&(this.LO.dispose(),this.LO=null)}get NCb(){return this.LO?this.LO.isVisible:!1}}sD.zii=0;Object(r.a)(sD,"InsightsManager",null,[927,10]);class AE{constructor(b,h,n,x,E,S=!0,ma=null,Fa=null){this.V3=this.ZM=this.aHa=null;this.ypc=!1;this.dca=null;this.Wb=h;this.aRb=
S;this.uAg=Fa?Fa:new gG;this.jy=ma;this.Mo=b;this.aRb&&(Oa.a.instance.Pa("Common.App.SearchCommon.SearchHostRuntime")&&(this.dca=Oa.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").ddf()),this.b9a=Oa.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.Ytb=this.b9a.NIc())}n0a(b){if(this.aRb){b=b.rawEvent;try{var h=z.a(b.data)}catch(n){w.ULS.sendTraceTag(595161728,1303,15,this.ZS("Message data from Serplet [{0}] failed to deserialize.",b.data));return}switch(h.actionType){case 101:b=
0;this.ZM&&(b=this.ZM.entryPoint);this.b9a.ogf(this.V3,this.uAg,this.p3b(),b).then(n=>{h.data=n;this.Aib(h)});break;case 118:h.data=this.ZM?this.ZM:Object.assign(new Yt.a,{selection:Object.assign(new qw.a,{neighborhood:this.aHa.neighborhood,mentionStart:this.aHa.mentionStart,mentionLength:this.aHa.mentionLength})});this.Aib(h);break;case 103:b=z.a(Object(ja.a)(String,h.data));rl.sendTelemetryEvent(b);break;case 206:this.b9a.CZh(h.data).then(n=>{h.data=n;this.Aib(h)});break;case 112:h.data.shiftPressed?
(V.a.fj&&document.activeElement.blur(),this.Mo.kJd(0,null,2,null,null),w.ULS.sendTraceTag(592545156,1303,50,this.ZS("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.Mo.IJc(0,null,2,null,null),w.ULS.sendTraceTag(592545155,1303,50,this.ZS("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.pla()}}}BYc(b){if(this.dca){var h=0;this.ZM&&(h=this.ZM.entryPoint);this.b9a.ogf(this.V3,this.uAg,this.p3b(),h).then(n=>{rl.fVi("SearchFromHost",this.V3);this.ZM.launchData||(this.ZM.launchData=
new fv.a);const x=bG();try{this.dca.search(this.ZM,n,u.AFrameworkApplication.userSessionId,x,b),this.b9a.Z1m(E=>{rl.fVi("SearchFromHostWithToken",this.V3);this.dca.searchAuthenticatedProviders(this.ZM,n,u.AFrameworkApplication.userSessionId,x,null,E)})}catch(E){rl.MA("BaseSmartLookupPane - Fail to search from host. Error: "+E,10)}}).catch(n=>{rl.MA("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+n.toString(),10)})}}Tcc(b){if(this.aRb){var h=rl,n=h.Tcc,x=this.V3;
b=Math.round(window.performance.now()-b);var E=this.ZM?qD[this.ZM.entryPoint]:"",S=this.b9a.NIc(),ma=this.b9a.Bpl(),Fa=this.ZM?this.ZM.entryPoint:0;n.call(h,x,b,E,S,ma,u.AFrameworkApplication.XOe,this.ypc,18===Fa||19===Fa||15===Fa)}}}Object(r.a)(AE,"BaseSmartLookupPane",null,[381,10]);class BE{constructor(b){this.messageType=null;this.messageType=b}}Object(r.a)(BE,"InsightsMessage",null,[]);class CE extends BE{constructor(b,h){super(b);this.messageContent=null;this.messageContent=h}}Object(r.a)(CE,
"InsightsMessageWithContent",BE,[]);class TM extends CE{constructor(b){super(ih.gGm,b)}}Object(r.a)(TM,"InsightsMessageAppProperties",CE,[]);class UM extends CE{constructor(b){super(ih.tGm,b)}}Object(r.a)(UM,"InsightsMessageSelection",CE,[]);class VM extends BE{constructor(){super(ih.vGm)}}Object(r.a)(VM,"InsightsMessageTakeFocus",BE,[]);class DE extends AE{constructor(b,h,n,x,E=null,S=null,ma=null,Fa=!0,$a=null,sb=null){super(h,n,E,S,ma,Fa,$a,sb);this.X6c=this.bA=this.hh=null;this.Ugd=!1;this.Tbd=
b;this.eoc=this.aRb?CH(this.Ytb):u.AFrameworkApplication.a5l;this.VY();this.OPf();this.xp=x;this.kzg=0}get isVisible(){return!1}VY(){this.hh=this.Tbd.nCc();u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.Qfb&&this.hh.pkn(b=>{b===this.hh&&(this.m5d(),this.Scc())});this.amf(this.hh.wPa.keh);this.hh.xl()}amf(b){b.style.overflow="hidden";const h=Vf.a.createElement("iframe");Sys.UI.DomElement.addCssClass(h,"InsightsPaneIFrame");h.setAttribute("Unselectable","off");this.bA=h;b.appendChild(this.bA);
this.bA.id=ih.zkf}OPf(){af.a.addHandler(this.bA,"load",Object(v.a)(this,this.Y9b,"onIFrameLoad"));af.a.addHandler(this.bA,"error",Object(v.a)(this,this.Nhb,"onIFrameError"));$addHandler(window,"message",Object(v.a)(this,this.n0a,"onIFrameMessage"))}i6f(){af.a.removeHandler(this.bA,"load",Object(v.a)(this,this.Y9b,"onIFrameLoad"));af.a.removeHandler(this.bA,"error",Object(v.a)(this,this.Nhb,"onIFrameError"));$removeHandler(window,"message",Object(v.a)(this,this.n0a,"onIFrameMessage"))}dispose(){this.bA&&
(this.i6f(),this.bA.parentNode.removeChild(this.bA),this.bA=null);this.hh&&(this.Tbd.Qxb(this.hh),this.hh=null)}mO(b,h,n){this.V3=h;this.X6c=null;this.kzg=n;this.ypc=!b.mentionLength;this.Ugd=!1;w.ULS.sendTraceTag(6295947,1303,50,this.ZS("Start to show Insights"));this.aHa=b;this.eoc&&this.eoc.length?this.bA.src=this.eoc:(this.bA.src=DE.Zsi,w.ULS.sendTraceTag(6295948,1303,15,this.ZS("The Insights URL config setting is null or empty")));this.xp.sendNotification(CommonUIStrings.l_InsightsPaneNotification,
!0);this.hh.YW||this.hh.TPf(Object(v.a)(this,this.DRm,"onInsightsTaskPaneHidden"));this.aRb&&this.BYc(!1);b=window.performance.now();this.Tbd.showTaskPane(this.hh);this.hh.xl();this.Tcc(b)}y3i(b,h,n){this.ZM=b;this.mO(Object.assign(new vE.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,n)}LIb(){}sQd(){}Scc(){this.bA.src===this.eoc&&this.Ugd&&(this.Wb.Jg(ih.gy),this.Aib(new VM))}m5d(){this.bA&&de.FocusManager.uK(this.bA.contentWindow)}U0e(){this.bA.src=
DE.Zsi;this.hh.jm()}pla(){this.Tbd.hideTaskPane(this.hh);this.U0e()}DRm(b){b===this.hh&&this.pla()}Y9b(){w.ULS.sendTraceTag(6295951,1303,50,this.ZS("The iframe is successfully loaded in Insights task pane"))}Nhb(){w.ULS.sendTraceTag(6295952,1303,15,this.ZS("The iframe failed to load in Insights task pane"))}n0a(b){const h=b.rawEvent;if(h.source===this.bA.contentWindow)if(this.aRb)super.n0a(b);else{let n;try{n=z.a(h.data)}catch(x){w.ULS.sendTraceTag(6295953,1303,15,this.ZS("Message data [{0}] failed to deserialize.",
h.data));return}if(ff.c(n.messageType))w.ULS.sendTraceTag(6295954,1303,15,this.ZS("Message data [{0}] is in wrong format.",h.data));else switch(n.messageType){case ih.hGm:this.Aib(new TM(this.Ztl()));break;case ih.uGm:this.Aib(new UM(this.aHa));break;case ih.oGm:this.Ugd=!0;this.m5d();this.Scc();w.ULS.sendTraceTag(6295955,1303,50,this.ZS("Insights pane rendering is completed"));break;case ih.wGm:b=n.messageContent;this.X6c=b.clientCorrelationId;this.V3!==b.appCorrelationId&&w.ULS.sendTraceTag(6403778,
1303,15,this.ZS("App correlation ID on client {0} does not match one on server {1}",this.V3,b.appCorrelationId));break;case ih.nGm:n.messageContent?(V.a.fj&&document.activeElement.blur(),this.Mo.kJd(0,null,2,null,null),w.ULS.sendTraceTag(6604741,1303,50,this.ZS("Insights UX lost focus through Ctrl + Shift + F6"))):(this.Mo.IJc(0,null,2,null,null),w.ULS.sendTraceTag(6604742,1303,50,this.ZS("Insights UX lost focus through Ctrl + F6")));break;case ih.kGm:n.messageContent.keyCode===db.a.R3a&&this.pla();
break;case ih.lGm:try{this.Ugd=!1,localStorage.setItem(ih.iji,"true")}catch(x){w.ULS.sendTraceTag(17961859,1303,10,this.ZS("Failed to SetItem in LocalStorage for LegalAgreed"))}}}}Ztl(){const b={anid:"00000000-0000-0000-0000-000000000000"};b.appCorrelationId=this.V3;3===u.AFrameworkApplication.ua.Sb.jo?b.applicationName=ih.zso:4===u.AFrameworkApplication.ua.Sb.jo&&(b.applicationName=ih.uXm);b.applicationVersion=u.AFrameworkApplication.buildVersion;var h=vj.a.lg(u.AFrameworkApplication.lcid);h=h?h.name:
null;b.market=BH(h);b.uiLanguage=h;b.sessionId=u.AFrameworkApplication.userSessionId;b.parentalControl=ih.gJf;b.clientType="user";b.legalAgreed=this.hvl();b.defaultDefineTab=1===this.kzg?"true":null;return b}ZS(b,...h){const n={};this.V3&&(n[ih.j9i]=this.V3);this.X6c&&(n[ih.R4n]=this.X6c);n[ih.k9i]=String.format.apply(null,[b].concat(h));return z.c(n)}p3b(){return 5}hvl(){try{const b=localStorage.getItem(ih.iji);return!!b&&"true"===b}catch(b){return w.ULS.sendTraceTag(17961860,1303,10,this.ZS("Failed to GetItem in LocalStorage for LegalAgreed")),
!1}}Aib(b){b=z.c(b);this.bA.contentWindow.postMessage(b,Ec.a.h$(this.eoc))}}DE.Zsi="about:blank";Object(r.a)(DE,"InsightsPane",AE,[]);class WM{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(r.a)(WM,"SmartLookupTaskPaneProps",null,[]);class XM{}Object(r.a)(XM,"ActionDescriptor",null,[]);class YM extends AE{constructor(b,h,n,x=null,E=null,S=null,ma=!0,Fa=null,$a=null){super(h,n,x,E,S,ma,Fa,$a);this.gIe=!!u.AFrameworkApplication.ua&&!!u.AFrameworkApplication.ua.Sb&&u.AFrameworkApplication.ua.Sb.Csf;
this.ou=this.WCe=!1;this.QKj=u.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.OKj=u.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",844);this.TKj=u.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",1366);this.SKj=u.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);ma||rl.MA("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",
10);this.WSa=b;this.MGg=CH(this.Ytb)}get isVisible(){return this.ou}LIb(b,h){this.ZM=b;this.aHa=b=Object.assign(new vE.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength});this.ypc=!b.mentionLength;this.V3=h;this.BYc(!1)}sQd(b){this.ZM=b;this.kec(Object.assign(new vE.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),!1)}mO(b,h){this.V3=h;this.kec(b,!0)}y3i(b,h,
n){this.ZM=b;this.mO(Object.assign(new vE.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,n)}pla(){this.Saa();this.WSa.hideTaskPane()}kec(b,h){Vh.SessionStatusManager.instance.dK&&this.dca?(this.aHa=b,this.ypc=!b.mentionLength,b=window.performance.now(),this.initialize(),this.isVisible?u.AFrameworkApplication.K.$("SmartLookupDisableRefreshPaneIsEnabled")?(this.WSa.updateTaskPane(null),h&&this.KDn()):(h&&this.BYc(!1),this.WCe=
!this.WCe,this.WSa.updateTaskPane(this.nB())):(h&&this.BYc(this.isVisible),this.WSa.showTaskPane(this.nB())),this.Tcc(b)):(this.WSa.showTaskPane(this.nB()),rl.hDn(Vh.SessionStatusManager.instance.dK,!!this.dca,this.ZM?qD[this.ZM.entryPoint]:"",this.b9a.NIc(),u.AFrameworkApplication.XOe,this.ypc))}KDn(){if(!this.ZM){const b=Object.assign(new qw.a,{neighborhood:this.aHa.neighborhood,mentionStart:this.aHa.mentionStart,mentionLength:this.aHa.mentionLength});this.ZM=Object.assign(new Yt.a,{selection:b,
userIntent:null,entryPoint:0,launchData:null})}this.BYc(this.isVisible)}pDn(){const b=new XM;b.transactionId=this.V3;b.actionType=15;b.channelId=ih.channelId;this.Aib(b)}n0a(b){const h=b.rawEvent;document.getElementById(ih.gy)&&h.source!==document.getElementById(ih.gy).contentWindow||(u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)?this.Idn(b):super.n0a(b))}Idn(b){const h=b.rawEvent;let n;try{n=z.b(h.data)}catch(x){w.ULS.sendTraceTag(545604257,
1303,15,this.ZS("Message data from Serplet [{0}] failed to deserialize.",h.data));return}switch(n.actionType){case 32:Ke.a.HAb()>=this.QKj?this.WSa.updateTaskPane(this.z_e(this.OKj)):Ke.a.HAb()>=this.TKj&&this.WSa.updateTaskPane(this.z_e(this.SKj));break;case 33:this.WSa.updateTaskPane(this.z_e(n.data));break;default:super.n0a(b)}}dispose(){}initialize(){this.VY();this.Aga()}VY(){this.WSa.nCc()}Aga(){const b=this.Wb.pe(ih.gy);b.parent=xd.AFrame.Lp;b.LL=!0}OHn(){this.Wb.Jg(ih.gy)}Saa(){this.c_a()&&
this.Wb.Jg(this.Wb.AS)}OPf(){$addHandler(window,"message",Object(v.a)(this,this.n0a,"onIFrameMessage"))}i6f(){$removeHandler(window,"message",Object(v.a)(this,this.n0a,"onIFrameMessage"))}c_a(){return!!this.Wb.xg&&this.Wb.xg.name===ih.gy}Aib(b){b=z.c(b);document.getElementById(ih.gy)&&document.getElementById(ih.gy).contentWindow.postMessage(b,Ec.a.h$(this.MGg))}ZS(b,...h){const n={};this.V3&&(n[ih.j9i]=this.V3);n[ih.k9i]=String.format.apply(null,[b].concat(h));return z.c(n)}p3b(){return Mg.a("isSharedUXDarkModeOn")&&
appChrome.api.isSharedUXDarkModeOn()?3:0}izi(){if(this.dca)this.dca.onPaneThemeChanged(this.p3b());return Mg.a("getTheme")?appChrome.api.getTheme():null}Scc(){}m5d(){document.getElementById(ih.gy)&&de.FocusManager.uK(document.getElementById(ih.gy).contentWindow)}Nhb(){rl.MA("ReactSmartLookupPane - Iframe component failed to load.",10)}Y9b(){u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||rl.MA("ReactSmartLookupPane - Onload detected no network.",
50)}nB(){var b=new WM;b.src=this.MGg;b.id=ih.gy;b.refreshPane=this.WCe;b.onError=Object(v.a)(this,this.Nhb,"onIFrameError");b.onLoad=Object(v.a)(this,this.Y9b,"onIFrameLoad");b.title=ih.oib;Vh.SessionStatusManager.instance.dK?this.dca||(b.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,b.errorType=1):(b.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,b.errorType=0);b=Object.assign(new sp.a,{title:ih.oib,hideHeader:!1,width:ih.width,location:ih.u_m,contentProps:b,
isModernPane:!0,onOpen:()=>{this.OHn();this.ou=!0;this.OPf();Mg.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(Object(v.a)(this,this.izi,"onThemeIdChanged"));u.AFrameworkApplication.ua.updateCommandUI();if(this.dca)this.dca.onPaneStateChanged(!0)},onClose:()=>{this.pDn();this.Saa();this.ou=!1;this.i6f();Mg.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(Object(v.a)(this,this.izi,"onThemeIdChanged"));u.AFrameworkApplication.ua.updateCommandUI();
if(this.dca)this.dca.onPaneStateChanged(!1)}});this.gIe&&(b.enableResize=!0,b.minResizeWidth=320,b.maxResizeWidth=920);return b}z_e(b){const h=this.nB();h.resizeWidth=b;return h}}Object(r.a)(YM,"ReactSmartLookupPane",AE,[]);class ZM{nCc(){const b=new Vn.CuiHelper(Gl.a.U$a,WordEditorIntl.WordEditorStrings);return Um.a.instance.B_e(ih.gy,ih.M$b,ih.width,ih.V2f,b)}showTaskPane(b){Um.a.instance.showTaskPane(b)}hideTaskPane(b){Um.a.instance.hideTaskPane(b)}Qxb(b){Um.a.instance.Qxb(ih.gy,b)}}Object(r.a)(ZM,
"WordInsightsPaneHandler",null,[319]);class $M{nCc(){Um.a.instance.PJa()}showTaskPane(b){Cj.UISurfaces.Xt().then(h=>{h.showTaskPane(ih.gy,b);return null})}updateTaskPane(b=null){Cj.UISurfaces.Xt().then(h=>{h.setSelectedTaskPane(ih.gy);b&&h.updateTaskPane(ih.gy,b);return null})}hideTaskPane(){Cj.UISurfaces.Xt().then(b=>{b.hideTaskPane(ih.gy,2);return null})}}Object(r.a)($M,"WordReactSmartLookupPaneHandler",null,[318]);class aN extends sD{constructor(b,h){super();this.Ms=b;this.hb=h}zwd(){const b=!!u.AFrameworkApplication.ua&&
!!u.AFrameworkApplication.ua.Sb&&u.AFrameworkApplication.K.$("SmartLookupEnableNativePane");return u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb&&u.AFrameworkApplication.ua.Sb.Drf?new YM(new $M,ln.a.instance,de.FocusManager.instance(),Oa.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Oa.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Oa.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Oa.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
Oa.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper")):new DE(new ZM,ln.a.instance,de.FocusManager.instance(),Oa.a.instance.resolve("Common.Utils.IAriaNotifier"),Oa.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Oa.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Oa.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Oa.a.instance.Za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Oa.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper"))}q2b(){return this.Ms.getSelectedText()}iRh(){if(!this.hb||
!this.hb.ib||1>this.hb.ib.length)return null;var b=this.hb.ib.kb.Qa;b=null==b?null:Mh.FormattingReader.Ds(b);return(b=null==b?null:vj.a.lg(Mh.FormattingReader.language(b)))?b.name:""}SXa(){return this.Ms.agf()}kRh(){return this.Ms.agf()}eci(){return this.Ms.U9l()}}Object(r.a)(aN,"WordInsightsManager",sD,[]);var gQ=d(172);class bN{}Object(r.a)(bN,"CommandMetadataResponse",null,[]);class wC{constructor(){this.Bkf=this.getAllIcons()}executeCommand(){}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){gQ.PrivacyDialogManager.d7d()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(b){const h=
new bN;b.iconNames&&(h.svgData=this.getCommandIconSvg(b.iconNames));if(!b.commandId||""===b.commandId)return h;try{h.label=appChrome.selectors.getControlLabel(b.commandId);if(h.svgData&&""!==h.svgData)return h;const n=appChrome.selectors.getControlIconSet(b.commandId),x=Array(2);x[0]=n["default"];x[1]=n.icon32;h.svgData=this.getCommandIconSvg(x)}catch(n){return null}return h}getCommandIconSvg(b){if(!this.Bkf)return"";for(let h=0;h<b.length;h++){const n=b[h];if(n in this.Bkf)return this.Bkf[n]}return""}getAllIcons(){return{}}createFeedbackPropertiesFromData(b){const h=
{SourceControlId:"GiveFeedback"};h.feedbackType="true"===b.IsPosFeedback?0:1;const n={};n.featureArea=wC.i5k;h.telemetryGroup=n;h.appData=b;return h}}wC.l3h="FA000000012";wC.queryPrefix="AssetID=";wC.i5k="SearchPane";Object(r.a)(wC,"BaseSerpletExecutor",null,[334,279]);class cN extends wC{constructor(b,h,n){super();this.ga=b;this.hb=h;this.hA=n}executeCommand(b){if(!b)throw Error("Missing commandData argument");switch(b.CommandId){case 0:this.ga.Xb(Db.a.TDb,2,null);break;case 1:this.ga.Xb(ub.a.XJb,
2,null);break;default:throw Error(`Unknown commandId requested: ${b.CommandId}`);}}browseFiles(){this.ga.Xb(Ra.a.jMd,2,null)}openHelpTaskPane(){}openFeedbackPane(b){this.ga.Xb(Ra.a.Gcc,2,this.createFeedbackPropertiesFromData(b))}openFindReplaceTaskPane(b){const h={};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Xb(Ra.a.Y7e,2,h)}openFindReplaceTaskPaneV2(b){b={CommandValueId:b.Query,MatchCase:b.MatchCase,MatchWholeWord:b.MatchWholeWordOnly};JH(this.hb,this.hA);this.ga.Xb(Ra.a.Y7e,2,b)}openFindTaskPane(b){const h=
{};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Xb(Ra.a.findInDocument,2,h)}openNavigationPane(){this.ga.Xb(ub.a.fec,2,null)}openSerpletTaskPane(){this.ga.Xb(Ra.a.a9h,2,null)}sendAutoLaunchSearchRequest(){this.ga.Xb(Ra.a.dMd,2,null)}getAllIcons(){const b={};for(const n of Object.keys(window))if(n.startsWith("word")){var h=window[n];h&&(h=h.icons,null!==h&&void 0!==h&&h.length&&h.forEach(x=>b[x.id]=JSON.stringify(x)))}return b}}Object(r.a)(cN,"WordSerpletExecutor",wC,[]);class dN extends EH{constructor(){super();
this.nAe=null;this.Ww=()=>{u.AFrameworkApplication.yZ&&(this.iYk(),If.a.zn().then(()=>this.nAe.resolve("WordEditor.Insights.IAugloopSearchProviderManager")))}}get name(){return"WordEditor.Insights"}init(){u.AFrameworkApplication.yZ&&(this.nAe.Pa("WordEditor.Insights.WordInsightsActor").Vb(),u.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&u.AFrameworkApplication.K.$("DownloadSmartLookupRuntimeDuringPkgInitIsEnabled")?u.AFrameworkApplication.K.yq(this.Ww):super.init())}zc(b){super.zc(b);
this.nAe=b;b.ha("Box4.Insights.Box4InsightsSelection",()=>new Hq.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").singleInstance();b.ha("WordEditor.Insights.WordInsertContentExecutor",()=>new RM(u.AFrameworkApplication.ya)).as("Common.App.SearchCommon.IInsertContentExecutor").singleInstance();b.ha("WordEditor.Insights.WordSerpletExecutor",()=>new cN(u.AFrameworkApplication.ya,kh.a.instance,b.resolve("Box4.ISelectionFactory"))).as("Common.App.SearchCommon.ISerpletExecutor").singleInstance();
b.ha("WordEditor.Insights.AugloopSearchProviderManager",()=>new dG(b.resolve("Common.App.Insights.IDocumentContentExtractionManager"))).as("WordEditor.Insights.IAugloopSearchProviderManager").singleInstance();b.ha("WordEditor.Insights.WordDocumentContentExecutor",()=>{const h=new sA(new se.a(()=>ob.App.xa?ob.App.xa.jb.Zc:null),b.resolve("Box4.IParagraphReader"),KM.a.instance,u.AFrameworkApplication.K,IB.a.instance,aQ.a.instance,b.resolve("Box4.Search.IFindManagerHelper"),b.resolve("Common.Comments.ICommentModel"),
u.AFrameworkApplication.ya,kh.a.instance,b.resolve("Box4.ISelectionFactory"));h.initialize();return new PM(new se.a(()=>ob.App.xa?ob.App.xa.jb.Zc:null),b.resolve("Box4.IParagraphReader"),cb.InteractiveViewManager.instance,kh.a.instance,b.resolve("Box4.ISelectionFactory"),h,ob.App.Wj.al.Te(12),new se.a(()=>ob.App.xa.jb),de.FocusManager.instance(),u.AFrameworkApplication.K,b.resolve("Common.Comments.ICommentModel"),b.resolve("Common.App.Insights.IInsightsSelection"),b.Za("WordEditor.Insights.IAugloopSearchProviderManager"))}).as("Common.App.SearchCommon.IDocumentContentExecutor").singleInstance();
b.ha("WordEditor.Insights.WordInsightsManager",()=>new aN(b.resolve("Common.App.Insights.IInsightsSelection"),b.resolve("Box4.ISelectionManager"))).as("Common.App.Insights.IInsightsManager").singleInstance();b.ha("WordEditor.Insights.WordInsightsActor",()=>new SM(b.Ye("Common.App.Insights.IInsightsManager"),u.AFrameworkApplication.ya,u.AFrameworkApplication.K)).singleInstance();b.ha("Common.App.SearchCommon.IDocumentHelper",()=>new QM(b.Za("WordEditor.Extension.DocumentProperties"))).singleInstance()}}
Object(r.a)(dN,"WordInsightsPackage",EH,[]);class hQ{}Object(r.a)(hQ,"ScalingStep",null,[]);class eN{constructor(b,h,n){this.Koc=!1;this.yO=null;this.Kvc=this.MQb=!1;this.YTa=[];this.f3d=x=>{this.c8&&this.c8!==x&&appChrome.api.dispatch(this.UWh(!1))};h.execute(x=>{this.yO=x});b.OD(Object(v.a)(this,this.iVm,"onProcessSetSelectionFinished"));this.Mt=n}W2b(b,h,n){const x=[];for(const E of b)x.push(appChrome.actions.addScalingStepInTab("Home",{type:h,controlId:E},n));return x}qVh(b){const h=[];for(let n=
0;4>n;n++)h.push(appChrome.actions.addScalingStepInTab("Home",{type:"DropPreviewItemFromGallery",controlId:b},2>n?0:void 0));h.push(appChrome.actions.addScalingStepInTab("Home",{type:"GalleryToFlyout",controlId:b},void 0));return h}UWh(b){const h=[];if(b)switch(this.c8){case "Image":h.push(appChrome.actions.removeControlScalingStepsFromTab("TextAlignmentAnchor","Home"));h.push(...this.qVh("PictureStyles"));h.push(...this.W2b("RotatePictureMenu PictureBorders PictureStyles CropPictureMenu WrapTextMenu EditPictureAltText".split(" "),
"DropLabel"));b=this.YTa.slice().reverse();b.push("TextAlignmentAnchor");h.push(...this.W2b(b,"MoveToOverflow"));break;case "Table":this.Kvc||h.push(...this.qVh("TableStyles"));h.push(...this.W2b(this.YTa,"DropLabel",this.Kvc?0:void 0));b=this.YTa.slice().reverse();h.push(...this.W2b(b,"MoveToOverflow"));break;case "Hyperlink":h.push(...this.W2b(["EditHyperlink","RemoveHyperlink"],"DropLabel")),b=this.YTa.slice().reverse(),h.push(...this.W2b(b,"MoveToOverflow"))}else for(const n of this.YTa)h.push(appChrome.actions.removeControlScalingStepsFromTab(n,
"Home"));return h}y2c(b){let h={};for(const n of b)try{h[n]=appChrome.selectors.getModelType(n)}catch(x){this.daa("Error","GetModelType failed for "+n)}ob.App.xa.GCd(h)}Rdo(b){if(0!==b.length){var h=[],n={},x=!1;for(const E of b)try{if(appChrome.selectors.isControlDefined(E))n[E]=appChrome.selectors.getModelType(E);else{x=!0;break}}catch(S){this.daa("Error","GetModelType failed for "+E);x=!0;break}if(x)this.c8=void 0,this.hbe(!1);else{if("Image"===this.c8&&!this.MQb)h.push(appChrome.actions.updateGroupHiddenState("Font",
!0)),this.MQb=!0;else if(this.MQb){h.push(appChrome.actions.updateGroupHiddenState("Font",!1));x=appChrome.selectors.getVisibleControlsInGroup("Font");for(const E of x)n[E]=appChrome.selectors.getModelType(E);this.MQb=!1}ob.App.xa.GCd(n);this.YTa=b;n=[];for(const E of b)appChrome.selectors.isControlDisabled(E)&&n.push(E);0<n.length&&this.daa("Disabled",n.join(","));0<this.YTa.length&&(h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),h.push(appChrome.actions.updateControlsInGroup("Adaptive",
this.YTa)),h.push(...this.UWh(!0)),this.Koc=!0);appChrome.api.dispatch(h)}}}hbe(b){if(b||this.Koc){var h=[];h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!b));this.Koc=b;if("Image"===this.c8||this.MQb){b=!b;h.push(appChrome.actions.updateGroupHiddenState("Font",!b));if(b){const n=appChrome.selectors.getVisibleControlsInGroup("Font");this.y2c(n)}this.MQb=!b}appChrome.api.dispatch(h)}}igc(){this.Koc&&this.Mt&&this.Mt.execute(b=>{b.logActivity("AdaptiveContextualGroupShown",null)})}iVm(b,
h){!u.AFrameworkApplication.ua.Sb.Tdc&&"Home"===appChrome.selectors.getSelectedTabId()&&this.yO&&h.kl&&h.kl.kb&&0!==h.kl.length?(b=()=>{let n=[],x=!1;var E=this.yO.contentType,S=appChrome.selectors.getActiveContextualTabIds();E.includes("Image")?(this.f3d("Image"),this.c8&&"Image"===this.c8?x=!0:(n="PictureStyles PictureBorders WrapTextMenu RotatePictureMenu CropPictureMenu PictureAbsoluteHeight PictureAbsoluteWidth LockAspectRatio EditPictureAltText FormatPictureOptions".split(" "),this.c8="Image")):
E.includes("Table")&&0<=S.indexOf("Table")?(E=!(Pq.a.instance.kb.eCa||Pq.a.instance.kb.tw||Pq.a.instance.kb.qDb),(S="Table"===this.c8&&E!==this.Kvc)?this.f3d("TableCellEdit"):this.f3d("Table"),!this.c8||"Table"!==this.c8||S?(E?(n=["SelectTableMenu","DeleteTableMenu","InsertTableMenu","AlignmentTableMenu"],this.Kvc=!0):(n="SelectTableMenu DeleteTableMenu InsertTableMenu AlignmentTableMenu MergeCells SplitCells TableDistributeMenu TableStyles ChangeColorsTable StyleOptionsTableMenu CellShading EditTableAltText BorderGallery TableBorderColor".split(" "),
this.Kvc=!1),this.c8="Table"):x=!0):E.includes("Hyperlink")&&(this.f3d("Hyperlink"),this.c8&&"Hyperlink"===this.c8?x=!0:(n=["EditHyperlink","RemoveHyperlink","CopyHyperlink","OpenHyperlink"],this.c8="Hyperlink"));x?this.Koc||(this.y2c(this.YTa),this.hbe(!0),this.igc()):0<n.length?(this.Rdo(n),this.igc()):this.hbe(!1)},"requestIdleCallback"in window?window.requestIdleCallback(b):window.requestAnimationFrame(b)):this.hbe(!1)}daa(b,h){b={Time:(new Date).getTime(),Event:b,Message:h,Scenario:"AdaptiveTabGroup"};
h=new uh.a;h.name="Events";h.dataFields=Wg.a.KJ(b);h.durationMs=window.performance.now();Y.a.MDa(h,"TellMeWAC.")}}Object(r.a)(eN,"AdaptiveTabGroupUpdater",null,[]);class fN{constructor(){this.W=null;this.eNm=()=>{u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAdaptiveTabGroupUpdater",!1)&&(this.W.ha("WordEditor.UI.AdaptiveTabGroupUpdater",()=>new eN(this.W.resolve("Box4.ISelectionManager"),this.W.Za("Common.IActionContextProvider"),this.W.Za("Common.ISystemInitiatedFeedback"))).singleInstance(),
this.W.resolve("WordEditor.UI.AdaptiveTabGroupUpdater"))}}get name(){return"WordEditor.RibbonIntelligence"}zc(b){this.W=b}init(){tB(1,this.eNm)}dispose(){}}Object(r.a)(fN,"PackageManager",null,[1,2]);const iQ=(b,h,n)=>1===n?32:2===n?(d.e(5).then(d.bind(null,1913)).then(x=>{x.createAndShowDevToolsMenu()}),32):2;class KH{constructor(){this.name="WordEditor.DevTools"}init(){if(window.g_wordDevToolsIsEnabled||u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DevToolsIsEnabled",
!1))u.AFrameworkApplication.ya.pa(ub.a.OZf,Ld.a.frame,iQ),null!==sessionStorage.getItem("devToolsRefresh")&&d.e(5).then(d.bind(null,1913))}dispose(){}zc(){}static main(){N.a.instance.Pc(new KH)}}Object(r.a)(KH,"WordDevToolsPackage",null,[1,2]);var yo=d(570);class LH{constructor(){this.underline=this.strikethrough=this.italic=this.highlight=this.fontColor=this.bold=null}}Object(r.a)(LH,"FormattingData",null,[]);class gN extends LH{constructor(){super();this.hyperlinkData=null}}Object(r.a)(gN,"RichContentCommandData",
LH,[]);class gi{constructor(){gi.Wi.add(ub.a.V2a);gi.Wi.add(ub.a.rKb);gi.Wi.add(ub.a.dfc);gi.Wi.add(ub.a.KX);gi.Wi.add(ub.a.rCf);gi.Wi.add(ub.a.rLf);gi.Wi.add(ub.a.deleteComment);gi.Wi.add(ub.a.UCc);gi.Wi.add(ub.a.A1e);gi.Wi.add(ub.a.v7d);gi.Wi.add(ub.a.XPa);gi.Wi.add(ub.a.OZf);gi.Wi.add(ub.a.XJb);gi.Wi.add(ub.a.UZf);gi.Wi.add(ub.a.PDc);gi.Wi.add(ub.a.$yd);gi.Wi.add(Db.a.qyd);gi.Wi.add(Db.a.openInClient);gi.Wi.add(Db.a.print);gi.Wi.add(Db.a.G_d);gi.Wi.add(Db.a.HNf);gi.Wi.add(Db.a.xHb);gi.Wi.add(Db.a.TDb);
gi.Wi.add(Ra.a.u$i);gi.Wi.add(Ra.a.tellMe);gi.Wi.add(Ra.a.e1c);gi.Wi.add(Ra.a.Gcc);gi.Wi.add(Ra.a.giveFeedback);gi.Wi.add(Ra.a.C_c);gi.Wi.add(Ra.a.GZf);gi.Wi.add(Ra.a.w9f);gi.Wi.add(Ra.a.icb);gi.Wi.add(Ra.a.newComment);gi.Wi.add(Ra.a.kWe);gi.Wi.add(Ra.a.LMa);gi.Wi.add(Ra.a.jSf);gi.Wi.add(Ra.a.iSf);gi.Wi.add(Ra.a.kSf);gi.Wi.add(Ra.a.ryd);gi.Wi.add(Ra.a.lja);gi.Wi.add(Ra.a.F_f);gi.Wi.add(Ra.a.N2i);gi.Wi.add(Ra.a.close);gi.Wi.add(Ra.a.B0d);gi.Wi.add(Ra.a.N_d);gi.Wi.add(Ra.a.YXd);gi.Wi.add(Ra.a.E7d);
gi.Wi.add(Ra.a.K7d);gi.Wi.add(Ra.a.QGb);gi.Wi.add(Ra.a.renameFile);gi.Wi.add(Ra.a.J4b);gi.Wi.add(Ra.a.t_f);gi.Wi.add(Ra.a.nec);gi.Wi.add(Ra.a.downloadACopy);gi.Wi.add(Ra.a.Acc);gi.Wi.add(Ra.a.LZd);gi.Wi.add(Ra.a.rHb);gi.Wi.add(Ra.a.$Gi);gi.Wi.add(Ra.a.Emh);gi.Wi.add(Ra.a.pud);gi.Wi.add(Ra.a.jWe);gi.Wi.add(Ra.a.Gmh);gi.Wi.add(Ra.a.Fmh);gi.Wi.add(Ra.a.kWe);gi.Wi.add(Ra.a.qud);gi.Wi.add(ub.a.jde);gi.Wi.add(ub.a.r$f);gi.Wi.add(ub.a.zoomToPageWidth);gi.Wi.add(ub.a.WUf);gi.Wi.add(ub.a.Nib);gi.Wi.add(ub.a.W0d);
gi.Wi.add(ub.a.eha);gi.Wi.add(Ra.a.Ieb);gi.Wi.add(Ra.a.hbb);gi.Wi.add(Ra.a.sec);gi.Wi.add(Ra.a.blj);gi.Wi.add(Ra.a.gHi);gi.Wi.add(Db.a.CGb);gi.Wi.add(Db.a.Efa)}}gi.Wi=new Set;Object(r.a)(gi,"CommentRibbonCommands",null,[]);class hN{constructor(b,h,n,x,E,S){this.vsi=b;this.ti=h;this.Yp=n;this.gr=x;this.gf=E;this.Y5n=S;this.CTb=null;this.nwa=new Aa.a(0);this.inb=new Aa.a(0);this.yhe=new Aa.a(0);this.iKe=!1;this.A0l();this.$kn()}X8l(b){return this.CTb&&this.Yp.Hy?!gi.Wi.has(b):!1}GJc(b,h,n){if(b===Ra.a.Bg)return 32;
if(!this.nwa.xb(b)&&!this.inb.xb(b)||!this.CTb)return 2;const x=this.inb.xb(b);var E=x?this.inb.J(b):this.nwa.J(b);const S=x?2:this.yhe.J(n);x||1!==S||(this.wbm(ob.App.xa.Yo.xg.name)||ob.App.xa.Yo.Jg(this.ti.en?xd.AFrame.fr:xd.AFrame.qL),ob.App.xa.updateCommandUI(!0));n=new gN;if(this.gr.wCb)switch(E){case 1:n.highlight={color:this.TVh(h.Color)};break;case 6:n.fontColor={color:this.TVh(h.Color)}}E=this.CTb.executeCommand(E,S,n);2===E&&x&&(b===Db.a.Pac?h[Qf.a.On]=!!n.bold:b===Db.a.Vac?h[Qf.a.On]=!!n.italic:
b===Db.a.gbc?h[Qf.a.On]=!!n.underline:b===Db.a.bbc?h[Qf.a.On]=!!n.strikethrough:b===Db.a.zX?h[Qf.a.On]=!!n.highlight:b===Db.a.Is&&(h[Qf.a.On]=!!n.fontColor));return 2===E?32:1===E?2:8}fin(b){this.CTb=b;this.CTb.registerSelectionChangeHandler(()=>{this.iKe||(this.iKe=!0,ob.App.xa.updateCommandUI(!0),this.iKe=!1)});this.CTb.registerKeypressHandler(h=>{if(h.shortKey)switch(h.key){case db.a.DMb:case db.a.Gee:case db.a.Lee:case db.a.DQa:ob.App.xa.updateCommandUI(!0)}h.key!==db.a.dC&&h.key!==db.a.K3||ob.App.xa.updateCommandUI(!0)})}$kn(){this.vsi.PKi(xd.AFrame.fr,
this);this.vsi.PKi(xd.AFrame.qL,this)}A0l(){this.nwa.Z(Db.a.bold,0);this.nwa.Z(Db.a.setItalic,3);this.nwa.Z(Db.a.strikethrough,4);this.nwa.Z(Db.a.underline,5);this.gr.wCb&&(this.nwa.Z(Db.a.zX,1),this.nwa.Z(Db.a.Gja,1),this.nwa.Z(Db.a.Is,6),this.nwa.Z(Db.a.B5,6),this.nwa.Z(Db.a.tga,6));this.inb.Z(Db.a.Pac,0);this.inb.Z(Db.a.Vac,3);this.inb.Z(Db.a.bbc,4);this.inb.Z(Db.a.gbc,5);this.yhe.Z(1,0);this.yhe.Z(2,1)}wbm(b){return b===xd.AFrame.fr||b===xd.AFrame.qL}TVh(b){return b?Eo.a.BC(this.Y5n.Zya(this.gf.ud,
b)):""}}Object(r.a)(hN,"CommentRibbonCommandHandler",null,[148,149]);class MH{constructor(){this.W=null}get name(){return"WordEditor.CommentsRibbonHandler"}init(){this.W.resolve("WordEditor.Comments.ICommentRibbonCommandHandler");this.W.resolve("WordEditor.Comments.CommentsState").oOf?this.W.resolve("WordEditor.Comments.CommentRibbonCommands"):this.W.resolve("WordEditor.Comments.WordCommentEventsActor").Zfa("OnCommentRenderedOnce",()=>{this.W.resolve("WordEditor.Comments.CommentRibbonCommands")})}dispose(){}zc(b){this.W=
b;this.W.ha("WordEditor.Comments.CommentRibbonCommandHandler",()=>new hN(this.W.Pa("Common.INonCanvasCuiUser"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("Common.Comments.ICommentModel"),this.W.resolve("WordEditor.Comments.CommentsSettings"),Kb.App.fm.jb.Jc,Aq.a.instance)).as("WordEditor.Comments.ICommentRibbonCommandHandler").singleInstance();this.W.ha("WordEditor.Comments.CommentRibbonCommands",()=>new gi).singleInstance()}static main(){N.a.instance.Pc(new MH)}}Object(r.a)(MH,
"PackageManager",null,[1,2]);var jQ=d(1540),iN=d(1552);class NH{get name(){return"Common.App.OAuth.OAuthPackage"}zc(b){b.register(142,"Common.App.OAuth.IOAuthManager").singleInstance().Xd(()=>new jQ.OAuthManager)}init(){const b=Oa.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Rao(b)}Rao(b){const h=u.AFrameworkApplication.K.lb("FileSource");if(u.AFrameworkApplication.K.$("IsO365ConsumerHost")||u.AFrameworkApplication.K.$("IsO365CommercialHost")||"WopiTest"===h){var n=R.a.JEk;if(n&&n.IsEnabled){var x=
n.Application,E=R.a.authority;if(void 0!==x&&null!==x&&x.length&&void 0!==E&&null!==E&&E.length){var S=iN.a[b.tha],ma=V.a.WE,Fa=b.RJ();try{var $a=new Map;void 0!==$a&&null!==$a?($a.set("SupportStatus",S),$a.set("Browser",ma),$a.set("AuthStrategy",Fa)):$a=null}catch(Jb){$a=null}ta.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",$a);var sb=rd.a.lf();b.aoa("Core",x).then(Jb=>{const Sb=Math.floor(rd.a.lf()-sb);S=iN.a[b.tha];ma=V.a.WE;Fa=b.RJ();w.ULS.sendTraceTag(562943369,3E3,
50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',Sb,Jb.IsSuccess,S,Jb.ErrorCode,h,ma,Fa);$a&&($a.set("SupportStatus",S),$a.set("Browser",ma),$a.set("AuthStrategy",Fa));var oc=Object.assign(new ab.a,{durationMs:Sb,extendedProperties:$a});if(Jb.IsSuccess){if(ta.Health.instance.recordKpiSuccess("WacCorePFT",oc),oc=n.Endpoint){var Ic=rd.a.lf();u.AFrameworkApplication.Ze.pWb(oc,
1,null,{["Authorization"]:"Bearer "+Jb.Token},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(gd=>{var Gd=Math.floor(rd.a.lf()-Ic),vd=null;gd.ho?gd="Canceled":gd.Ii?gd="Faulted":(vd=gd.result,gd=vd.succeeded?"Completed":"Failed");Gd={["TaskResult"]:gd,["BrowserTokenDurationMS"]:Sb,["BrowserValidationDurationMS"]:Gd};vd&&(Gd.HttpStatus=vd.args.data.mf,vd.succeeded&&(vd=z.a(vd.args.data.Ee),Gd.ServerValidationDurationMS=vd.ElapsedMilliseconds,Gd.ServerValidationResult=vd.ValidatedToken,
Gd.KMSI=vd.KMSI,Gd.Scopes=vd.Scopes,Gd.TokenExpirationS=Math.floor(parseInt(vd.Expiration)-(new Date).getTime()/1E3)));w.ULS.sendTraceTag(520632322,3E3,"Completed"===gd?50:15,Ia.a.toJSON(Gd))})}}else ta.Health.instance.recordKpiFailure("WacCorePFT",Jb.ErrorCode,!1,!1,oc)}).catch(Jb=>{var Sb=Math.floor(rd.a.lf()-sb);Sb=Object.assign(new ab.a,{durationMs:Sb,extendedProperties:$a});ta.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+Jb.toString(),!1,!1,Sb)})}}}}dispose(){}static main(){N.a.instance.Pc(new NH)}}
Object(r.a)(NH,"OAuthPackage",null,[1,2]);class jN{constructor(){this.akd=new Aa.a}Eao(b,h){if(!b)return w.ULS.sendTraceTag(40478031,306,10,"SDX AssetId is null."),!1;b=B.a.mh(b);if(this.akd.xb(b))return w.ULS.sendTraceTag(40478032,306,10,"ISdxPaneSuppressionHandler already registered for SDX AssetId: {0}.",b),!1;this.akd.Z(b,h);return!0}Yef(b){if(!b)return w.ULS.sendTraceTag(40478033,306,10,"SDX AssetId is null."),null;b=B.a.mh(b);return this.akd.xb(b)?this.akd.J(b):(w.ULS.sendTraceTag(40478034,
306,10,"ISdxPaneSuppressionHandler does not exist for SDX AssetId: {0}.",b),null)}}Object(r.a)(jN,"SdxPaneSuppressionManager",null,[]);class kN{constructor(b){this.Dye=0;this.TLj=b}khb(){return this.Dye>=this.TLj}reset(){this.Dye=0}update(){this.Dye++}}Object(r.a)(kN,"NodeCountBasedTaskYieldStrategy",null,[204]);class lN{constructor(){this.cZc=new Set}fkn(b){this.cZc.add(b)}Nco(b){this.cZc.delete(b)}nVm(){return()=>{this.cZc.forEach(b=>{b.onSessionClose()})}}oVm(){return()=>{this.cZc.forEach(b=>{b.onSessionConnect()})}}pVm(){return()=>
{this.cZc.forEach(b=>{b.onSessionDisconnect()})}}}Object(r.a)(lN,"AlSessionLifeEventNotifier",null,[152]);var OH=d(1366),mN=d(667),kQ=d(447);class nN{constructor(){this.token=null}}Object(r.a)(nN,"ReleaseAnnotationParameters",null,[]);class oN{constructor(){this.value=this.id=this.parentPath=null}}Object(r.a)(oN,"SetAnnotationMetadataParameters",null,[]);class pN{constructor(){this.id=this.parentPath=null;this.value=0}}Object(r.a)(pN,"SetAnnotationStateParameters",null,[]);var EE=d(1178),hG=d(321);
class qN extends Sys.EventArgs{constructor(b,h){super();this.annotation=b;this.q$a=h}}Object(r.a)(qN,"AnnotationLocalStateChangedEventArgs",Sys.EventArgs,[]);class PH{constructor(b){this.lPe=this.annotations=null;if(!b)w.ULS.sendTraceTag(41418884,389,10,"Null operation received!"),this.annotations=null;else if(b.items&&0<b.items.length){const h=PH.nGd(b.parentPath);this.annotations=Array(b.items.length);let n=0;for(const x of b.items){const E=Object.assign(new LI.a,{id:x.id,parentPath:h,content:x.body,
annotationType:vn.a.getTypeNameFor(x.body),parentRevId:b.parentRevId});this.annotations[n++]=E}this.lPe=vn.a.getTypeNameFor(b)}}static nGd(b){return b?b.join("\\"):""}}Object(r.a)(PH,"AnnotationOperation",null,[]);class QH extends Sys.EventArgs{constructor(b,h){super();this.annotationType=b;this.activated=h}}Object(r.a)(QH,"AnnotationActivationEventArgs",Sys.EventArgs,[]);class tD extends Sys.EventArgs{constructor(b,h){super();this.annotation=b;this.opType=h}}Object(r.a)(tD,"AnnotationOperationEventArgs",
Sys.EventArgs,[]);class RH{constructor(){this.newState=this.oldState=0;this.handlers=new Qa.a}}Object(r.a)(RH,"AnnotationResultStateUpdateData",null,[]);var lQ=d(958);class rN{constructor(){this.hPe=this.q$j=this.jPe=null}}Object(r.a)(rN,"AnnotationCallbacks",null,[]);class gt{constructor(b,h,n,x,E,S){this.MVb=null;this.Fsc=new Aa.a(0);this.Vwc=new Aa.a;this.R5c=new Aa.a;this.vhd=new Pa.a;this.qGf=null;this.Ih=b;this.bHa=h;this.xH=n;this.tD=x;this.xY=E;this.wc=S}Roo(b,h,n,x){this.tD.e5b(b)&&this.Ih.Pd(()=>
{if(!this.MVb){this.MVb=new Aa.a;var E=Cd.ParagraphReader.Mw(If.a.getRootNode(),!0,!0);for(const S of E)S&&(E=S.ia(ic.a.Mc,0))&&(this.MVb.add(E,S.id),this.Fsc.Z(S.id.toString(),E))}this.bHa.pGf(b,(S,ma)=>{if(S){var Fa=this.tD.ASh(b);S.contentDescriptor.Zu===Fa&&((Fa=this.zrl(S))?S.p$a?(Fa=this.TYe(S,Fa))&&(ma?n(ma,S.contentDescriptor):h(Fa,S.contentDescriptor)):x(S.contentDescriptor):this.QPk(S,Object.assign(new rN,{jPe:h,q$j:n,hPe:x})))}})},"PAS:FEPAOT")}zrl(b){if(3===b.contentDescriptor.Zu){let h;
return({value:h}=this.MVb.Dc(b.contentDescriptor.paragraphId)).returnValue?h:null}if(4===b.contentDescriptor.Zu)return C.a.nil;w.ULS.sendTraceTag(592525442,gt.Gi,15,"GetGraphNodeIdForAnnotationIfConnected: Unsupported content type");return null}Wbm(b,h){if(3===b.contentDescriptor.Zu)return h=this.xY.value.Eb(h).getValue(ic.a.mj),b.contentDescriptor.mj===h;if(4===b.contentDescriptor.Zu&&h===C.a.nil)return!0;w.ULS.sendTraceTag(592525443,gt.Gi,15,"IsGraphNodeValidForAnnotation: Unsupported content type");
return!1}QPk(b,h){if(3===b.contentDescriptor.Zu){const n=b.contentDescriptor.paragraphId;this.Vwc.xb(n)||this.Vwc.add(n,new Qa.a);this.Vwc.J(n).add(x=>{12===x.type&&this.MVb.add(n,x.id);b.p$a?(x=this.TYe(b,x.id))&&h.jPe(x,b.contentDescriptor):h.hPe(b.contentDescriptor)})}else if(4===b.contentDescriptor.Zu)if(b.p$a){const n=this.TYe(b,C.a.nil);n&&h.jPe(n,b.contentDescriptor)}else h.hPe(b.contentDescriptor);else w.ULS.sendTraceTag(592525444,gt.Gi,15,"DelayCallbackForAnnotation: Unsupported content type")}TYe(b,
h){if(this.Wbm(b,h)){if(h=this.tD.YJm(b.p$a,b.contentDescriptor,h.toString()))return this.R5c.Z(h.id,b.r1a),h}else this.wc.isFeatureEnabled(95)&&this.xH.zxc(b);return null}tgj(b,h){let n=this.tD.ODd(b);n&&(h===rg.a.getTypeName()?this.j$n(b,n):this.Y9n(b,n))}j$n(b,h){this.tD.e5b(b.annotationType)&&(this.xH.pOa(this.xY.value,h,b.annotationType),this.R5c.remove(b.id))}Y9n(b,h){if(this.tD.e5b(b.annotationType)){h=Object.assign(new lQ.a,{p$a:this.tD.u$j(b),contentDescriptor:h,annotationType:b.annotationType});
h=this.xH.addAnnotation(this.xY.value,h);this.R5c.Z(b.id,h);const n=this.tD.H_h(b.annotationType);n&&this.vhd.contains(n)&&(this.Ih.Pd(()=>{var x=Cd.ParagraphReader.Mw(If.a.getRootNode(),!0,!0);if(x&&0<x.count){const E=new Qa.a;for(const S of x)(x=gt.jGd(S))&&E.add(x);0<E.count&&this.xH.i7g(this.xY.value,n,E.toArray())}},"PAS:TAOCPA"),this.vhd.remove(n))}}Bma(b){if(this.MVb)if(b){var h=b.ia(ic.a.Mc,0);if(h&&(this.Fsc.Z(b.id.toString(),h),({value:h}=this.Vwc.Dc(h)).returnValue))for(const n of h)n(b)}else w.ULS.sendTraceTag(592525445,
gt.Gi,10,"OnParagraphNodeConnected: Invalid node")}mxi(b,h){if(b){var n=b.id.toString();b=b.ia(ic.a.Mc,0);var x=0;({value:x}=this.Fsc.Dc(n)).returnValue&&(3===h?(this.Vwc.remove(x),this.Fsc.remove(n)):2===h?this.Fsc.Z(n,b):w.ULS.sendTraceTag(592525447,gt.Gi,15,"OnParagraphNodeModified: Updating persisted annotation not supported for event"))}else w.ULS.sendTraceTag(592525446,gt.Gi,10,"UpdatePersistedAnnotations: Invalid node")}jEl(b){let h;return({value:h}=this.R5c.Dc(b)).returnValue?h:C.a.nil}Oko(b,
h,n){b?h?this.bHa.VUh(b,x=>{if(x){const ma=gt.jGd(h,n);if(ma){var E=Array(x.length),S=!1;for(let Fa=0;Fa<x.length;Fa++)if(S||ma!==x[Fa])E[Fa]=x[Fa];else{const $a=gt.jGd(h);if(!$a)return;S=!0;E[Fa]=$a;x[Fa]=$a}S&&this.xH.i7g(this.xY.value,b,E)}}}):w.ULS.sendTraceTag(588863697,gt.Gi,10,"UpdateWorkflowParagraphVersion: Invalid node"):w.ULS.sendTraceTag(588863696,gt.Gi,10,"UpdateWorkflowParagraphVersion: null workflowType")}VKn(b){b?this.vhd.add(b):w.ULS.sendTraceTag(588863698,gt.Gi,10,"SetPendingWorkflow: null workflowType")}jvk(b){b?
this.vhd.remove(b):w.ULS.sendTraceTag(588105731,gt.Gi,10,"ClearPendingWorkflow: null workflowType")}static jGd(b,h=0){if(!b)return null;h||(h=b.ia(ic.a.mj,0));b=Cd.ParagraphReader.iT(b);if(h&&b)return String.format("{0}{1}{2}",b,gt.g0m,h);w.ULS.sendTraceTag(588091606,gt.Gi,10,"GetParagraphVersion: Node with text id {0} and paragraph id {1}",h?"valid":"0",b?"valid":"0");return null}}gt.Gi=389;gt.g0m="-";Object(r.a)(gt,"PersistedAnnotationStorage",null,[197]);class sN{constructor(){this.config=this.token=
null}}Object(r.a)(sN,"UpdateAnnotationConfigParameters",null,[]);var tN=d(135),mQ=d(1158),uN=d(337),nQ=d(1376);class fj{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb=null,oc){this.V8a=oc;this.sa=new Ge.a;this.iwa=new Jc.a;this.R7=new Jc.a;this.uD=new Jc.a;this.sge=new Jc.a;this.tlc=new kf.a(da.a.Pj());this.aAe=new Qa.a;this.dNb=new Jc.a;this.oge=new Jc.a;this.S5c=new Jc.a;this.eNb=new Jc.a;this.Lic=new Jc.a;this.T5c=new Jc.a;this.a8c=new Jc.a;this.Gfd=[];this.Hfd=[];this.Iqc=null;this.ULj=new kf.a(da.a.Pj());
this.qge=new Map;this.LOb=new Map;this.Sjc=null;this.qha=new Jc.a;this.ACc=null;this.pNk=()=>{if(this.Gfd.length||this.Hfd.length)try{0<this.Gfd.length&&this.UCm(),0<this.Hfd.length&&this.kco()}finally{this.xvk()}else this.Hb.ef(this.Iqc),this.Iqc=null};this.tvk=()=>{const Ic=new Qa.a;for(const gd of this.uD.values)if(Ic.add(gd),Ic.count===fj.cMj)break;for(const gd of Ic)this.r_b(gd),this.IIb(gd,rg.a.getTypeName());this.uD.count||(this.Hb.ef(this.Sjc),this.Sjc=null)};this.PPm=(Ic,gd)=>{for(const Gd of gd.mk)Ic=
Gd.intent,!Ic.type&&this.nQn(Ic.intent,Gd.cpBegin,Gd.cpEnd,Gd.e8b)&&this.r_b(Ic.intent)};this.JGj=b.$("AugLoopAnnotationsAttachingIsEnabled");this.pSj=b.AB("SendReleaseMessageAnnotationList")||[];this.wc=sb;this.uFa=Sb;this.bHa=S;this.xH=ma;this.Ls=n;this.tD=Fa;this.E8=$a;this.xY=x;this.Ih=h;this.Hb=E;Oa.a.instance.resolve("Box4.ICharacterPropertiesEditor").Y5j(this.PPm);this.AL=Jb;this.Ulo=b.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfAnnotationStorageSuperTransaction",!1);
this.Rtj=b.getBooleanFeatureGate("Microsoft.Office.WordOnline.AnnotationProcessingStateIsEnabled",!1);this.wGj=b.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1);(this.ZHj=b.getBooleanFeatureGate("Microsoft.Office.WordOnline.PersonalDictionaryAnnotationStorageFix",!1))&&this.V8a&&this.bSl()}get XKi(){return this.eNb}set XKi(b){this.eNb=b}mb(b,h){w.ULS.sendTraceTag(41521862,fj.Gi,50,"New registration for annotation type: {0}.",h);this.addHandler(b,h);this.YLe(h).catch(n=>
{w.ULS.sendTraceTag(594396739,fj.Gi,10,"Failed to activate annotation type {0}: {1}",h,n.toString())})}addHandler(b,h){if(b&&h&&""!==h){var n=null;({value:n}=this.eNb.Dc(h,n)).returnValue?n.add(b):(n=new Qa.a,n.add(b),this.eNb.add(h,n))}else w.ULS.sendTraceTag(41521861,fj.Gi,10,"Invalid registration. Handler == null? {0} or annotationType == null? {1} or annotationType == empty? {2}.",!b,!h,""===h)}sc(b,h){w.ULS.sendTraceTag(41521863,fj.Gi,50,"Unregister handler for annotation type: {0}.",h);let n=
null;({value:n}=this.eNb.Dc(h,n)).returnValue&&(n.remove(b),n.count||(w.ULS.sendTraceTag(41521864,fj.Gi,50,"Unregister all handlers for annotation type: {0}.",h),this.eNb.remove(h),this.YMm(h)))}BZi(b){this.Ulo&&!this.ACc&&(this.ACc=this.AL.Rc(2),this.ACc.Db(b))}xvk(){var b;null===(b=this.ACc)||void 0===b?void 0:b.dispose();this.ACc=null}wrh(){this.Iqc||(this.Iqc=new We.a(4,2,100,this.pNk,141),this.Hb.$b(this.Iqc))}UCm(){let b;b=Array.dequeue(this.Gfd);const h=If.a.eIc(this.xY.value,b);if(h)if(h.Ti){this.BZi(h);
var n=null;if(({value:n}=this.Lic.Dc(b,n)).returnValue){this.Lic.remove(b);for(const x of n)this.VCm(h,x)}else w.ULS.sendTraceTag(50663568,fj.Gi,100,"MarkIntentForAnnotationTask: No annotations for given tile id.")}else this.ULj.add(b);else w.ULS.sendTraceTag(50436127,fj.Gi,15,"MarkIntentForAnnotationTask: Unable to get node from tileId.")}VCm(b,h){var n=h.content.range;n=new EE.a(0,n.start,n.start+n.length,C.a.create(),h,x=>{this.sge.Z(h.id,x.toString())});this.Ls.G8b(b,n);this.sa.Cea&&this.sa.raiseEvent(fj.M9b,
new tD(h,an.a.getTypeName()))}boi(b){const h=If.a.Jdb(b.parentPath);let n=null;({value:n}=this.Lic.Dc(h,n)).returnValue||(n=new Qa.a,this.Lic.add(h,n),this.Gfd.push(h));n.add(b);this.wrh()}XCm(b,h){this.Ih.Pd(()=>{let n;if(({value:n}=this.R7.Dc(b,n)).returnValue){var x=this.G1i(b);for(const E of n){let S;({value:S}=this.uD.Dc(E,S)).returnValue&&h(S)&&fj.XBb(S)&&(this.boi(S),x&&this.sa.raiseEvent(fj.M9b,new tD(S,rg.a.getTypeName())))}}},"AS:MIFAT")}lco(b,h){this.Ih.Pd(()=>{let n;if(({value:n}=this.R7.Dc(b,
n)).returnValue)for(const x of n){let E;({value:E}=this.uD.Dc(x,E)).returnValue&&h(E)&&fj.XBb(E)&&this.b6f(E)}},"AS:UIFAT")}dNm(b){var h=If.a.VJ(b);let n=null;if(({value:n}=this.iwa.Dc(h,n)).returnValue){h=0;for(var x=new Qa.a;n.count>h;){var E=n.J(h),S=null;({value:S}=this.uD.Dc(E,S)).returnValue&&fj.XBb(S)?this.tD.m_c(b,S)?this.r_b(S,!this.wc.isFeatureEnabled(95)):(E=S.content.range,S=new EE.a(0,E.start,E.start+E.length,C.a.create(),S),x.add(S),h++):h++}0<x.count&&this.Ls.Ixf(b,x)}}kco(){let b=
"";b=Array.dequeue(this.Hfd);const h=If.a.eIc(this.xY.value,b);if(h&&12===h.type){this.BZi(h);var n=null;({value:n}=this.T5c.Dc(b,n)).returnValue?(this.Ls.c6f(x=>n.contains(x.intent),h,0),this.T5c.remove(b)):w.ULS.sendTraceTag(50663570,fj.Gi,100,"UnmarkIntentForAnnotationsTask: No annotations for given tileId.")}else w.ULS.sendTraceTag(50436128,fj.Gi,15,"UnmarkIntentForAnnotationsTask: Unable to unmark ChPs in node")}b6f(b){let h;({value:h}=this.sge.Dc(b.id,h)).returnValue||(h=If.a.Jdb(b.parentPath));
this.sge.remove(b.id);var n=null;({value:n}=this.T5c.Dc(h,n)).returnValue||(n=new Qa.a,this.T5c.add(h,n),this.Hfd.push(h));n.add(b);this.wrh();n=null;({value:n}=this.Lic.Dc(h,n)).returnValue&&n.remove(b)}W1j(b){const h=b.id;var n=b.annotationType;const x=b.parentPath;if(this.tD.Jfb(b)){var E=If.a.qdb(this.xY.value,x);if(E&&(E=E.ia(ic.a.mj,0).toString(),b.parentRevId&&E!==b.parentRevId))return!1}E=null;({value:E}=this.R7.Dc(n,E)).returnValue||(E=new Qa.a,this.R7.add(n,E));E.add(h);n=null;({value:n}=
this.iwa.Dc(x,n)).returnValue||(n=new Qa.a,this.iwa.add(x,n));n.add(h);this.uD.add(h,b);this.Qoo(b);return!0}Qoo(b){let h=this.tD.lKh(b);if(0===h.length)this.Nyh(b);else{let n=!1;this.bHa.wTm(h,b.annotationType,(x,E)=>{this.uD.xb(b.id)?(E=this.tD.agb(b,If.a.hgl(b)),!x&&E?this.g7f(b,10,!1):x&&this.g7f(b,x),n||(this.Nyh(b),n=!0)):E.lPa=!0})}}Nyh(b){const h=fj.XBb(b);h&&this.boi(b);!h&&this.sa.Cea&&this.sa.raiseEvent(fj.M9b,new tD(b,an.a.getTypeName()))}bej(b,h,n){let x=!0;this.Ih.Pd(()=>{if(n.startsWith(If.a.Uxb)){var E=
b.id,S=null;if(h===rg.a.getTypeName())this.r_b(b);else if(({value:S}=this.uD.Dc(E,S)).returnValue)w.ULS.sendTraceTag(41418891,fj.Gi,50,"UpdateAnnotationsStorage: Updating storage for annotation {0} of type {1}.",E,b.annotationType),this.uD.Z(E,b);else if(!this.W1j(b)){x=!1;return}h===an.a.getTypeName()&&n!==If.a.Uxb&&this.aAe.add(b.annotationType)}this.IIb(b,h)},"AS:UAS");return x}pGn(b){if(b)for(const h of b)this.IIb(h,$C.a.getTypeName()),b=h.content,this.a8c.xb(b.categoryName)?this.a8c.Z(b.categoryName,
h):this.a8c.add(b.categoryName,h);else w.ULS.sendTraceTag(592802119,fj.Gi,10,"SetCritiqueCategoryCountAndSendToHandlers: critiqueCategoryCountAnnotations null")}x5j(b){this.sa.addHandler(fj.M9b,b)}F8g(b){this.sa.addHandler(fj.iui,b)}d5b(b){return this.dNb.xb(b)}w5j(b){this.sa.addHandler(fj.pVd,b)}spn(b){this.sa.removeHandler(fj.pVd,b)}G1i(b){return!If.a.nf(b)&&wB.a(b)&&this.sa.Cea}r_b(b,h=!0){if(this.uD.xb(b.id)){var n=this.uD.J(b.id);this.uD.remove(b.id);var x=null;({value:x}=this.iwa.Dc(b.parentPath,
x)).returnValue?(x.remove(b.id),fj.XBb(n)&&this.b6f(n)):w.ULS.sendTraceTag(50734169,fj.Gi,15,"DeleteAnnotationFromStorage: No annotations in given parent path");x=null;({value:x}=this.R7.Dc(b.annotationType,x)).returnValue?x.remove(b.id):w.ULS.sendTraceTag(50734170,fj.Gi,15,"DeleteAnnotationFromStorage: Annotation of this type does not exist in document");this.G1i(b.annotationType)?this.sa.raiseEvent(fj.M9b,new tD(n,rg.a.getTypeName())):this.IIb(b,rg.a.getTypeName());h&&this.E8.tgj(n,rg.a.getTypeName())}}R$e(b,
h,n=!1){const x=new Qa.a;var E;if(!({value:E}=this.R7.Dc(b,E)).returnValue)return x;for(const S of E)this.uD.xb(S)?(b=this.uD.J(S),(E=this.tD.ODd(b))&&(h.equals(E)||n&&h.overlaps(E))&&x.add(b)):w.ULS.sendTraceTag(577843217,fj.Gi,50,"GetAnnotationsByDescription: Annotation {0} exists in a cache but not in storage",S);return x}N9l(b){return vn.a.getTypeNameFor(b)===uN.a.getTypeName()}R$h(b){var h,n;return(null===(n=null===(h=this.V8a)||void 0===h?void 0:h.wSh)||void 0===n?void 0:n.call(h))===mQ.a.Ohc&&
b&&0===b.priority?this.V8a.h1c(b.context.substr(b.startInContext,b.range.length)):!1}k8m(b){this.Ih.Pd(()=>{w.ULS.u7(fj.Gi,100)&&w.ULS.sendTraceTag(41418894,fj.Gi,100,"Operation of type {0} with path {1} received",vn.a.getTypeNameFor(b),b.parentPath.join("\\"));try{const h=new PH(b);for(const n of h.annotations){h.lPe===an.a.getTypeName()&&wB.b(n,!1);if(this.N9l(n.content)&&this.R$h(n.content)){this.gQa(n,70);continue}const x=n.parentPath,E=h.lPe;E===rg.a.getTypeName()&&this.pLi(n,x);if(E===an.a.getTypeName()&&
wB.a(n.annotationType)){const ma=If.a.Jdb(x);if(n.content.isHotCritique&&this.wGj){this.LOb.set(ma,Date.now());continue}}const S=n.annotationType;if(If.a.nf(S)||S!==hE.a.getTypeName())if(!If.a.nf(S)&&wB.a(S)&&n.content&&0==n.content.priority&&tN.a.t2){const ma=If.a.Jdb(x);ma&&ma==tN.a.zel()&&w.ULS.sendTraceTag(539870169,fj.Gi,10,"Skipping the Spelling Error Annotation as Text Prediction is visible")}else E!==rg.a.getTypeName()&&this.tlc.contains(x)?w.ULS.sendTraceTag(41418897,fj.Gi,50,"ProcessOperation: Parent tile {0} for annotation {1} was deleted.",
x,n.id):this.$dj(n,x,E);else w.ULS.sendTraceTag(595342670,fj.Gi,50,"ProcessOperation: Skipping CritiqueCategoryCountAnnotation for Parent tile {0} since the counts are maintained locally.",x)}}catch(h){w.ULS.sendTraceTag(41418898,fj.Gi,10,"Exception occurred while processing annotations: Error Message {0}, Stack {1}",h.message,h.stack)}},"AS:PO")}Bmn(b){if(b&&b.annotationType&&this.tD.e5b(b.annotationType)){var h;if(({value:h}=this.R7.Dc(b.annotationType,h)).returnValue&&(b=this.tD.ODd(b)))for(const n of h){let x;
({value:x}=this.uD.Dc(n,x)).returnValue&&(h=this.tD.ODd(x))&&(b.equals(h)||b.overlaps(h))&&this.r_b(x)}}}IIb(b,h){this.Ih.Pd(()=>{let n=null;if(({value:n}=this.XKi.Dc(b.annotationType,n)).returnValue)for(const x of n)x.mI(b,h)},"AS:SATH")}svk(){w.ULS.sendTraceTag(50860999,fj.Gi,50,"ClearStorage: Initiated Clearing Storage");this.Sjc||(this.Sjc=new We.a(4,2,100,this.tvk,142),this.Hb.$b(this.Sjc))}activateAnnotation(b,h){let n;if(({value:n}=this.S5c.Dc(b,n)).returnValue){if(n.contains(h))return Promise.resolve(null);
n.add(h)}else{let x;this.S5c.add(b,(x=new Qa.a,x.add(h),x))}return this.YLe(b)}YLe(b){w.ULS.sendTraceTag(41521865,fj.Gi,50,"ActivateAnnotation: Activating annotation type {0}.",b);if(this.dNb.xb(b))return Promise.resolve(null);var h=null;if(({value:h}=this.oge.Dc(b,h)).returnValue)return h;this.$Zj(b);h=null;this.uFa&&(h=this.uFa());if(h){const n=new FH.a;n.annotationType=b;this.Rtj&&(this.qha.xb(b)||this.qha.Z(b,new RH),n.stateUpdateHandler=(x,E)=>{this.qha.J(b).oldState=x;this.qha.J(b).newState=
E;for(const S of this.qha.J(b).handlers)S(b,x,E)});h=h.activateAnnotation(n);this.oge.add(b,h);return h.then(x=>{this.oge.remove(b);this.dNb.add(b,x.token);this.aej(x.token,b);this.sa.raiseEvent(fj.pVd,new QH(b,!0));this.$Rl(b);return x})}return Promise.reject(Error.create("Error during annotation activation"))}$Rl(b){const h=this.tD.H_h(b);h&&this.bHa.VUh(h,n=>{if(this.E8.qGf){var x=Cd.ParagraphReader.Mw(If.a.getRootNode(),!0,!0);if(x&&0<x.count){let E=0;for(const S of x){x=gt.jGd(S);if(!x)continue;
let ma=!1;for(;E<n.length;){if(x===n[E]){ma=!0;break}E++}if(!ma){this.E8.qGf(h);break}E++}}}})}$Zj(b){this.E8.Roo(b,(h,n)=>{0<this.R$e(b,n,!0).count||this.bej(h,an.a.getTypeName(),h.parentPath)},(h,n)=>{if(3!==n.Zu)w.ULS.sendTraceTag(591541786,fj.Gi,15,"Annotation moved to unsupported location type: {0}",n.Zu);else if(h.Zu!==n.Zu)w.ULS.sendTraceTag(591541787,fj.Gi,15,"Location types are not equal. This is not currently supported. Old: {0} New: {1}",h.Zu,n.Zu);else{h=this.R$e(b,h);for(const E of h){const S=
E.content;h=If.a.qdb(this.xY.value,E.parentPath);if(!h){w.ULS.sendTraceTag(591541788,fj.Gi,15,"RegisterHandler.onPersistedAnnotationMoved: Unable to get node from tileId.");break}if(!this.Ls.c6f(ma=>ma.intent===S,h,0))break;var x=n.Wqa;x=new EE.a(0,x,x+n.Vqa,null,S);this.Ls.G8b(h,x)}}},h=>{for(const n of this.R$e(b,h))this.r_b(n,!1)})}releaseAnnotation(b,h){let n;if(({value:n}=this.S5c.Dc(b,n)).returnValue){n.contains(h)&&n.remove(h);if(0<n.count)return Promise.resolve(!1);this.S5c.remove(b)}w.ULS.sendTraceTag(593790408,
fj.Gi,50,"ReleaseAnnotation: Releasing annotation type {0}.",b);return this.qVi(b)}YMm(b){var h=null;if(({value:h}=this.R7.Dc(b,h)).returnValue){w.ULS.sendTraceTag(41418899,fj.Gi,50,"OnAllHandlersUnregistered: Purging all storage for annotation type {0}.",b);for(const n of h)if(h=null,({value:h}=this.uD.Dc(n,h)).returnValue){const x=h.parentPath;let E=null;({value:E}=this.iwa.Dc(x,E)).returnValue&&(E.remove(n),E.count||this.iwa.remove(x));this.uD.remove(n);fj.XBb(h)&&this.b6f(h)}this.R7.remove(b)}Array.contains(this.pSj,
b)&&this.qVi(b)}qVi(b){let h=null,n=null;this.uFa&&(n=this.uFa());if(n){if(({value:h}=this.dNb.Dc(b,h)).returnValue){const x=new nN;x.token=h;this.dNb.remove(b);this.sa.raiseEvent(fj.pVd,new QH(b,!1));return n.releaseAnnotation(x)}return Promise.resolve(!0)}return Promise.reject(Error.create("Error during annotation release"))}tji(){this.Ih.Pd(()=>{if(this.JGj){var b=If.a.getRootNode();if(b){var h=new Jc.a;Fn.e(b,n=>{var x=If.a.VJ(n),E=null;if(({value:E}=this.iwa.Dc(x,E)).returnValue)for(const S of E)x=
null,({value:x}=this.uD.Dc(S,x)).returnValue&&(x.parent=n,x.vNc=!0,x.oGb=2,h.xb(x.annotationType)||h.Z(x.annotationType,new Qa.a),h.J(x.annotationType).add(S),E=null,({value:E}=this.R7.Dc(x.annotationType,E)).returnValue&&E.remove(x.id));return!0},12);for(const n of this.R7.keys)if(b=null,({value:b}=this.R7.Dc(n,b)).returnValue)for(const x of b)if(b=null,({value:b}=this.uD.Dc(x,b)).returnValue){let E=null;b.parentPath===If.a.Uxb?(b.oGb=1,b.parent=null):({value:E}=this.uD.Dc(b.parentPath,E)).returnValue?
(b.oGb=3,b.parent=E):(b.oGb=0,b.parent=null,w.ULS.sendTraceTag(41554060,fj.Gi,15,"LinkAnnotations: Unknown annotation parent for annotation ID: {0}.",b.id));b.vNc=!0;h.xb(b.annotationType)||h.Z(b.annotationType,new Qa.a);h.J(b.annotationType).add(x)}else w.ULS.sendTraceTag(41997840,fj.Gi,15,"LinkAnnotations: Annotation object not found for the given annotation ID: {0}.",x);else w.ULS.sendTraceTag(41997841,fj.Gi,15,"LinkAnnotations: Annotations not found for the given annotation type: {0}.",n);this.R7=
h;this.aAe.clear()}else w.ULS.sendTraceTag(41554058,fj.Gi,10,"LinkAnnotations: There is no root node in the current document.")}else w.ULS.sendTraceTag(41554057,fj.Gi,50,"LinkAnnotations: Link annotations called but flags is not set.")},"AS:LA")}t$j(b){this.k8m(b)}kWm(b,h){this.Ih.Pd(()=>{const n=h?h+String.format("\\{0}",b.id):If.a.VJ(b);w.ULS.sendTraceTag(41418900,fj.Gi,50,"OnTileDeleted: Tile delete event received for tile {0}.",n);this.tlc.contains(n)||this.tlc.add(n);var x=null;if(({value:x}=
this.iwa.Dc(n,x)).returnValue){w.ULS.sendTraceTag(41418901,fj.Gi,100,"OnTileDeleted: Removing {0} annotations for tile {1} from storage.",x.count,n);for(const E of x)x=null,({value:x}=this.uD.Dc(E,x)).returnValue&&(this.IIb(x,rg.a.getTypeName()),this.sa.Cea&&this.sa.raiseEvent(fj.M9b,new tD(x,rg.a.getTypeName())),this.uD.remove(E));this.iwa.remove(n)}},"AS:OTD")}jWm(b){b=If.a.VJ(b);this.tlc.remove(b)&&w.ULS.sendTraceTag(41418902,fj.Gi,50,"OnTileAdded: Deleted tile {0} was re-added.",b)}Pio(b){if(b){w.ULS.sendTraceTag(50436131,
fj.Gi,50,"UpdateRangeForAnnotations: Updated ranges for annotations {0}",b.count);var h=new Jc.a;for(var n of b)b=null,({value:b}=h.Dc(n.parentPath,b)).returnValue||(b=new Jc.a,h.add(n.parentPath,b)),b.Z(n.id,n);for(const x of h){h=If.a.qdb(this.xY.value,x.key);if(!h){w.ULS.sendTraceTag(50436160,fj.Gi,10,"UpdateRangeForAnnotations: Unable to get node for the annotation");break}n=new hG.a([0]);for(let E=0,S=h.qa.length;E<S;E++)b=h.qa.J(E),b.mk&&n.O3a(b.mk,void 0,(ma,Fa)=>{if(Fa){var $a=null,sb=Fa.intent;
sb&&({value:$a}=x.value.Dc(sb.id,$a)).returnValue&&(sb=new mN.a,sb.start=Fa.Ob.cp,sb.length=ma.Ob.cp-sb.start,$a.content.range=sb,$a.lNa=!1)}})}}else w.ULS.sendTraceTag(50436130,fj.Gi,10,"UpdateRangeForAnnotations: annotations list null")}getAnnotationsByType(b){w.ULS.sendTraceTag(593049729,fj.Gi,50,"GetAnnotationsByType: Method called for type {0}.",b);return this.YLe(b).then(()=>{const h=new Qa.a;this.Ih.Pd(()=>{if(If.a.nf(b)||b!==hE.a.getTypeName()){this.aAe.contains(b)&&this.tji();var n=null;
if(({value:n}=this.R7.Dc(b,n)).returnValue){w.ULS.sendTraceTag(41418903,fj.Gi,50,"GetAnnotationsByType: Enumerating annotations of type {0}.",b);var x=new Qa.a;for(const E of n)n=null,({value:n}=this.uD.Dc(E,n)).returnValue&&(n.lNa&&x.add(n),h.add(n));x&&0<x.count&&fj.XBb(x.J(0))&&this.Pio(x)}}else for(x of this.a8c.values)h.add(x);h.count||w.ULS.sendTraceTag(41418904,fj.Gi,50,"GetAnnotationsByType: No annotations found for type {0}!",b)},"AS:GABT");return h},h=>{w.ULS.sendTraceTag(41418905,fj.Gi,
10,"Exception occurred while fetching annotations of type {0}: {1}",b,h);return null})}Lcb(b){let h=null;return({value:h}=this.uD.Dc(b,h)).returnValue?h:null}zKh(b){let h=null;if(this.iwa.xb(b))for(const n of this.iwa.J(b))if(b=this.Lcb(n))h||(h=new Qa.a),h.add(b);return h}dEb(b){return(b=this.Lcb(b))?(b.vNc||this.tji(),b):null}gQa(b,h){this.IMn(b,h);this.g7f(b,h);this.IIb(b,$C.a.getTypeName())}beo(b,h){this.Mho(b,h);this.WJn(b,If.a.ggl(b));this.IIb(b,$C.a.getTypeName())}ceo(b,h){b=this.tD.lKh(b);
for(const n of b)this.xH.W6f(this.xY.value,n,h)}IMn(b,h){let n=null;this.uFa&&(n=this.uFa());n&&(b=this.igl(b,h))&&n.setAnnotationState(b)}g7f(b,h,n=!0){if(b&&fj.O9h(b)){var x=this.Lcb(b.id);!b.content||x&&b.content===x.content||If.a.setAnnotationState(b,h);x&&x.content&&If.a.setAnnotationState(x,h);n&&this.sa.Cea&&(70===h||60===h)&&this.sa.raiseEvent(fj.iui,new qN(b,h))}}igl(b,h){let n=null;b&&(n=Object.assign(new pN,{id:b.id,value:h}),If.a.nf(b.parentPath)||(n.parentPath=b.parentPath.split("\\")));
return n}WJn(b,h){const n=this.uFa?this.uFa():null;n&&(b=this.fgl(b,h))&&n.setAnnotationMetadata(b)}Mho(b,h){if(b&&fj.O9h(b)){var n=this.Lcb(b.id);!b.content||n&&b.content==n.content||If.a.ZVi(b,h);n&&n.content&&If.a.ZVi(n,h)}}fgl(b,h){if(!b)return null;const n=new oN;n.id=b.id;n.value=h;If.a.nf(b.parentPath)||(n.parentPath=b.parentPath.split("\\"));return n}nQn(b,h,n,x){const E=b.content;if(this.tD.Jfb(b)&&E){const S=E.range.start+E.range.length;if(0<x&&S<=n||0>x&&S<=n+x)return!1;if(0<x&&E.range.start>=
h||0>x&&E.range.start>=n)return E.range.start+=x,!1}return!this.wc.isFeatureEnabled(65)&&E&&E.M_?(b=this.tD.agb(b,60),!(60===E.M_.state&&b)):!0}S5g(b,h){this.qha.xb(h)||this.qha.Z(h,new RH);this.qha.J(h).handlers.add(b);b(h,this.qha.J(h).oldState,this.qha.J(h).newState)}rLi(b,h){this.qha.xb(h)&&this.qha.J(h).handlers.contains(b)&&this.qha.J(h).handlers.remove(b)}static O9h(b){b=vn.a.getBaseTypesFor(b.content);return Array.contains(b,un.a.getTypeName())}static XBb(b){if(void 0===b.content||null===
b.content||""===If.a.Jdb(b.parentPath))return!1;const h=vn.a.getBaseTypesFor(b.content);return Array.contains(h,kQ.a.getTypeName())&&b.annotationType!==xo.RoleDetectionAnnotation.getTypeName()}aeo(b){b?(this.qge.AugLoop_Text_Critique=b,b=this.d5b("AugLoop_Text_Critique")?this.dNb.J("AugLoop_Text_Critique"):null,this.aej(b,"AugLoop_Text_Critique")):w.ULS.sendTraceTag(540615552,fj.Gi,50,"Annotation configuration could not be updated for annotation type: {0}.","AugLoop_Text_Critique")}aej(b,h){if(b&&
this.qge[h]){const n=new sN;n.token=b;n.config=this.qge[h];this.uFa&&(this.uFa().updateAnnotationConfig(n),w.ULS.sendTraceTag(540615553,fj.Gi,50,"Annotation configuration has been updated for annotation type: {0}.",h))}}pLi(b,h){let n=null;({value:n}=this.uD.Dc(b.id,n)).returnValue&&(b.annotationType=n.annotationType);h=If.a.Jdb(h);this.LOb.has(h)&&wB.a(b.annotationType)&&this.LOb.delete(h)}$dj(b,h,n){this.Bmn(b);this.bej(b,n,h)&&this.E8.tgj(b,n)}pOa(b){const h=b.parentPath,n=rg.a.getTypeName();this.pLi(b,
h);this.gQa(b,70);this.tlc.contains(h)||this.$dj(b,h,n)}nwl(b){const h=new Qa.a;b=this.R7.Dc(b).value;if(null===b)return h;for(const n of b)b=this.uD.Dc(n).value,null!==b&&h.push(b);return h}bSl(){Object(xu.__awaiter)(this,void 0,void 0,function*(){yield Object(nQ.b)();this.CLi()})}CLi(){const b=this.nwl(uN.a.getTypeName());for(const h of b)this.R$h(h.content)&&this.pOa(h)}}fj.Gi=389;fj.M9b="OnAnnotationOperation";fj.iui="OnAnnotationLocalStateChange";fj.pVd="OnAnnotationActivationChange";fj.cMj=
20;Object(r.a)(fj,"AnnotationStorage",null,[198]);class vN{constructor(){this.q4d=null;this.u_c=!1}}Object(r.a)(vN,"AugmentationLoopStateManager",null,[194]);var wN=d(245);class SH extends wN.a{constructor(){super();this.FileId=this.AugLoopSeedUrl=this.Authorization=this.OriginString=this.ExpectedEndRevisionId=null;this.AddSubDocumentKindTypeToPathIsEnabled=this.CheckOnDemandNodeVersionEnabled=this.AddDocumentKindTypeToPathIsEnabled=this.SeedBatchesInParallelIsEnabled=!1}Wl(){return 102}static construct(b,
h,n,x,E,S){const ma=new SH;ma.ExpectedEndRevisionId=b;ma.OriginString=h;ma.Authorization=n;ma.AugLoopSeedUrl=x;ma.FileId=E;ma.SeedBatchesInParallelIsEnabled=S;ma.AddDocumentKindTypeToPathIsEnabled=!0;ma.CheckOnDemandNodeVersionEnabled=!0;ma.AddSubDocumentKindTypeToPathIsEnabled=!0;return ma}}Object(r.a)(SH,"FullFileAugLoopSeedingRequest",wN.a,[]);class TH{constructor(){this.authToken=this.url=this.kAi=null}}Object(r.a)(TH,"ReseedingTaskInfo",null,[]);class sr{constructor(b,h,n,x,E,S){this.Oba=null;
this.ZDg=!1;this.SOb=null;this.ADe=0;this.MUc=(ma,Fa)=>{ma=Fa.t9;this.SOb&&tj.AT(ma,$a=>$a===this.SOb)&&(Fa.httpStatusCode!==ua.a.qD||Fa.gD||2!==Fa.$Jf?Fa.httpStatusCode!==ua.a.qD||Fa.gD||1!==Fa.$Jf?this.XQi(()=>{w.ULS.sendTraceTag(50861003,sr.Gi,10,"ProcessReplicationStatus: ForceInbound or pinning the lastest revision failed. HttpStatusCode: {0}, OperationResult: {1}, PinRevisionForAugLoopResponse: {2}, Correlation: {3}",Fa.httpStatusCode,Fa.gD,Fa.$Jf,Fa.Rt)}):(this.$M.u_c=!1,this.Oba.PHb(this.MUc),
this.Jf.svk(),w.ULS.sendTraceTag(50861002,sr.Gi,50,"ProcessReplicationStatus: Initiated Full File Seeding Request"),ma=Object(ja.a)(TH,this.SOb),this.jHi(Fa.kxn,ma.kAi,ma.url,ma.authToken)):this.XQi(()=>{w.ULS.sendTraceTag(50861001,sr.Gi,50,"Replication succeeded but failed to pin the latest revision on the server for the user")}))};this.Z5k=ma=>{if(void 0===ma||null===ma||void 0===ma.data||null===ma.data||void 0===ma.data.Ee||null===ma.data.Ee)w.ULS.sendTraceTag(41445393,sr.Gi,10,"FileSeedingSuccessCallback: args or args.Data or args.Data.ResponseData is null or Undefined");
else if(ma.data.mf!==ua.a.qD)w.ULS.sendTraceTag(41445394,sr.Gi,10,"FileSeedingSuccessCallback: Returned unexpected args.Data.HttpStatus code: {0}",ma.data.mf);else try{let Fa;({group:Fa}=wl.a.G7(ma.data.Ee)).returnValue?Fa.Responses&&Fa.Responses.length?(ma=null,Fa&&Fa.Responses&&Fa.Responses.length&&(ma=Fa.Responses[0])?(this.t8.Ulb(ma),ma.StatusCode?w.ULS.sendTraceTag(41445398,sr.Gi,10,"FileSeedingSuccessCallback: FullFileAugLoopSeedingResponse returned unexpected status code: {0}",ma.StatusCode):
w.ULS.sendTraceTag(41445399,sr.Gi,50,"FileSeedingSuccessCallback: FullFileAugLoopSeeding was successful and last revision seeded is {0}",ma.LastSeededRevisionId)):w.ULS.sendTraceTag(41445397,sr.Gi,10,"FileSeedingSuccessCallback: serverResponseGroup is null or serverResponseGroup.Responses is null or serverResponseGroup.Responses is empty or response is null")):w.ULS.sendTraceTag(41445396,sr.Gi,10,"FileSeedingSuccessCallback: responseGroup or responseGroup.Responses is null or empty"):w.ULS.sendTraceTag(41445395,
sr.Gi,10,"FileSeedingSuccessCallback received null or empty server response group")}catch(Fa){w.ULS.sendTraceTag(41445400,sr.Gi,10,"FileSeedingSuccessCallback: {0}",Fa.message)}};this.Y5k=ma=>{void 0===ma||null===ma||void 0===ma.data||null===ma.data||void 0===ma.data.Ee||null===ma.data.Ee?w.ULS.sendTraceTag(41445401,sr.Gi,10,"FileSeedingFailCallback: args or args.Data or args.Data.ResponseData is null or Undefined"):w.ULS.sendTraceTag(41445402,sr.Gi,10,"FileSeedingFailCallback: Editor Service token generation server request failed:{0}",
ma.data.mf)};this.Ouj=b.$("AugLoopServerSideSeedingIsEnabled");this.Muj=b.$("AugLoopReseedingIsEnabled");this.Nuj=b.$("AugLoopFFSSeedBatchesInParallelIsEnabled");this.POg=b.rc("MaxReseedingRetries",1);this.hg=h;this.Xad=n;this.$M=x;this.t8=E;this.Jf=S;ob.App.xa&&ob.App.xa.jb&&ob.App.xa.jb.Zc&&ob.App.xa.jb.Zc.contentReplicator&&(this.Oba=ob.App.xa.jb.Zc.contentReplicator)}D2l(b,h,n){if(this.Ouj){var x=this.$M.q4d;x&&x.trim().length?this.ZDg?this.Muj&&(w.ULS.sendTraceTag(50861E3,sr.Gi,50,"InitiateFullFileSeedingFlow: Initiated Reseeding Flow"),
this.ADe=0,this.Oba?(this.$M.u_c=!0,this.Oba.xWb(this.MUc),this.SOb=Object.assign(new TH,{kAi:b,url:h,authToken:n}),this.Oba.bE(null,null,this.SOb)):w.ULS.sendTraceTag(592814793,sr.Gi,50,"InitiateFullFileSeedingFlow: ContentReplicator is null")):(w.ULS.sendTraceTag(41445392,sr.Gi,50,"InitiateFullFileSeedingFlow: Initiated FullFileSeedingFlow"),this.jHi(x,b,h,n),this.ZDg=!0):w.ULS.sendTraceTag(41445391,sr.Gi,10,"InitiateFullFileSeedingFlow: Empty or Null SeedRevision. Unable to InitiateFullFileSeedingFlow.")}else w.ULS.sendTraceTag(41445390,
sr.Gi,50,"InitiateFullFileSeedingFlow: AugLoopServerSideSeeding BRS setting has been diabled. File will not be seeded to Augmentation Loop.")}XQi(b){this.ADe<this.POg?(w.ULS.sendTraceTag(594384E3,sr.Gi,50,"RetryReseeding: ForceInbound or pinning the latest revision failed. Reseeding retry #{0} of {1}",++this.ADe,this.POg),this.Oba.bE(null,null,this.SOb)):(this.$M.u_c=!1,this.Oba.PHb(this.MUc),b())}jHi(b,h,n,x){const E=SH.construct(b,h,x,n,u.AFrameworkApplication.rootQuerySignature,this.Nuj);w.ULS.sendTraceTag(595178454,
sr.Gi,50,"QueueFullFileSeedingRequest: Calling AddSeedRequestToRequestManager on Host store replicator load completion.");this.Xad.CBb.execute(()=>{this.r3j(E)})}r3j(b){w.ULS.sendTraceTag(595178453,sr.Gi,50,"InitiateFullFileSeedingFlow: Adding seed request to RequestManager");this.hg.Lj(ob.App.webServiceBase+"OneNote.ashx?perfTag=FullFileAugLoopSeed",2,rL.b(b),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,this.Z5k,this.Y5k,b);w.ULS.sendTraceTag(42016906,sr.Gi,50,"InitiateFullFileSeedingFlow: Added seed request to RequestManager")}}
sr.Gi=389;Object(r.a)(sr,"FullFileAugLoopSeedingService",null,[]);class xN{constructor(){}}Object(r.a)(xN,"RuntimeManagerInitializationTracker",null,[]);class yN{getAugLoopRuntimeManager(){return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager()}}Object(r.a)(yN,"AlFactoryWrapper",null,[196]);class zN{zn(){return If.a.zn()}}Object(r.a)(zN,"UtilsWrapper",null,[195]);var Jk=d(1885),UH=d(268);class tr{constructor(b,h,n,x,E){this.Ma=b;this.Cf=n;this.ep=x;this.Ie=E;this.Ela=this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.Augloop.IsCaptionDetectionEnabled",
!1)}static get Zd(){return bo.a.getInstance()}bIn(b,h){b.listType=this.fwl(h);b.outlineLevel=Cd.ParagraphReader.HAa(h);b.indentation=tr.odf(this.ep.eT(h));b.alignment=tr.C$e(Cd.ParagraphReader.Ev(h));b.isInsideTable=this.isInsideTable(h);b.isInsideTOC=h.Pr;b.rightIndentation=tr.odf(this.ep.jYa(h));var n=this.ep.c3b(h);b.specialIndentType=tr.AHl(n);b.specialIndentBy=tr.odf(n);b.listType!==Jk.e.NoList&&this.EJn(h,b);this.BMn(h,b);n=[];this.Ela&&(n=this.o7m(h));b.formattedRanges=this.jrl(h,n);this.Ela&&
null!=n&&(b.objectReferences=0<n.length?n:void 0)}jrl(b,h){var n=b.qa?b.qa.length:0,x=Mh.FormattingReader.Ds(Dd.a.create(b));let E=Zl.a.GG,S=0,ma=Zl.a.IJ/2;x&&(ma=Mh.FormattingReader.Ln(x,ie.a.fontSize,Zl.a.IJ)/2,E=Mh.FormattingReader.Ln(x,ie.a.font,Zl.a.GG),S=Mh.FormattingReader.language(x));x="Normal";var Fa=this.Ie.yo(b);Fa&&(x=Fa.getValue(Th.a.ja)||"Normal",Fa.hasProperty(ie.a.font)&&(E=Fa.getValue(ie.a.font)));if(n){--n;Fa=[];let gd=null,Gd=void 0,vd=null;this.Ela&&b.hasProperty(ie.a.Un)&&(vd=
b.getValue(ie.a.Un));const ce=b.properties.ia(ic.a.Mda,null);for(let od=0;od<n;od++){var $a=b.qa.J(od),sb=b.Nc,Jb=null;this.Ela&&(Jb=tr.dhf(b,vd,od));$a.Ff&&(gd=tr.ufo(sb,$a.Ff,gd));$a.hyperlink&&$a.hyperlink.url?Gd=$a.hyperlink.url:$a.vl&&(Gd=void 0);var Sb=b.qa.J(od+1).cp-1;sb=$a.cp;Sb=Sb-$a.cp+1;let Yd=!1,ne=!1,Df=!1,Af=ma,Wi=0,gm=0,Ck=x,Rm=void 0,Qr=S,ls=E,pw;if($a.formatting){var oc=$a.formatting;Yd=Mh.FormattingReader.Ln(oc,ie.a.bold,!1);ne=Mh.FormattingReader.Ln(oc,ie.a.italic,!1);Df=Mh.FormattingReader.Ln(oc,
ie.a.underline,!1);Af=Mh.FormattingReader.Ln(oc,ie.a.fontSize,2*ma)/2;Wi=Mh.FormattingReader.Ln(oc,Th.a.capitalization,0);gm=Mh.FormattingReader.Ln(oc,ie.a.fontColor,0);Qr=Mh.FormattingReader.language(oc)||S;ls=Mh.FormattingReader.Ln(oc,ie.a.font,E);Ck=x;var Ic=oc.Xm;Ic&&(Ic=Ic.ia(Th.a.kB,null))&&!Ic.equals(C.a.nil)&&oc.paragraph.Nc&&(oc=oc.paragraph.Nc.Eb(Ic))&&(Ck=(new st.a(oc)).getValue(Th.a.ja))}this.Ela&&(pw=this.Ief(Jb),null!=pw&&this.Q7g(h,Jb,pw,Fa.length,Jk.b.Inline));gd&&(Rm=0<gd.count);
$a={isDeleted:this.n$l(ce,$a,od,Gd),fontFamily:ls,fontWeight:Yd?Jk.d.Bold:Jk.d.Normal,fontSize:Af,italic:ne,underline:Df?Jk.h.SingleLine:Jk.h.None,capitalization:tr.jqh(Wi),color:gm,styleName:Ck,isFollowUp:Rm,languageId:tr.$ph(Qr),start:sb,length:Sb,link:Gd,isReference:tr.isReference($a)?!0:void 0,objectType:null!==pw&&void 0!==pw?pw:void 0};Jb=0<Fa.length?Fa[Fa.length-1]:void 0;tr.Dpk(Jb,$a)?Jb.length+=$a.length:Fa.push($a)}return Fa}return[{fontFamily:E,fontWeight:Jk.d.Normal,fontSize:ma,italic:!1,
underline:Jk.h.None,capitalization:tr.jqh(0),color:0,styleName:x,isFollowUp:void 0,languageId:tr.$ph(S),start:0,length:b.characterData.length}]}n$l(b,h,n,x){if(this.Jy()){if(h.blob||h.formatting&&h.formatting.cache&&h.formatting.cache.LCb||x)return!0;if(b&&n<b.length)return b[n]}return h.ei?!0:!1}Jy(){return!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}static Dpk(b,h){return!!b&&!!h&&b.start+b.length===h.start&&
b.isDeleted===h.isDeleted&&b.fontFamily===h.fontFamily&&b.fontWeight===h.fontWeight&&b.fontSize===h.fontSize&&b.italic===h.italic&&b.underline===h.underline&&b.capitalization===h.capitalization&&b.color===h.color&&b.highlightColor===h.highlightColor&&b.styleName===h.styleName&&void 0===b.link&&void 0===h.link&&b.languageId===h.languageId&&!b.isReference&&!h.isReference&&!b.isFollowUp&&!h.isFollowUp&&void 0===b.objectType&&void 0===h.objectType}fwl(b){const h=new md.GraphIterator;h.set(b);h.Bb(11);
h.kd(11);return(b=this.Cf.Es(h))?tr.XDk(b.listType):Jk.e.NoList}EJn(b,h){const n=this.Cf.jI(b);if(n){n.hasProperty(ic.a.listID)&&(h.listId=n.getValue(ic.a.listID).toString());const x=this.gSh(b,n,ie.a.font);b=this.gSh(b,n,ie.a.fontSize);x&&(h.bulletAndNumberFontFamily=x);b&&(h.bulletAndNumberFontSize=b)}}isInsideTable(b){const h=new md.GraphIterator;h.set(b);return h.Bb(14)}BMn(b,h){h.spacingBeforeParagraph=this.LXh(b,ic.a.Pfa,ic.a.Mma,ic.a.Dj);h.spacingAfterParagraph=this.LXh(b,ic.a.Ofa,ic.a.Lma,
ic.a.ra);h.lineSpacing=this.eLa(b)}LXh(b,h,n,x){if(Cd.ParagraphReader.Ln(b,h,!1))return 0;h=Cd.ParagraphReader.Ln(b,n,-1);if(0<=h)return h*UH.a.LTc/100;b=Cd.ParagraphReader.Ln(b,x,-1);return 0<=b?b/20:0}gSh(b,h,n){if(tr.Zd.KL){if(b=this.wol(b),null!=b&&null!=b.cache)return b.cache.getValue(n)}else if(h.hasProperty(n))return h.getValue(n)}wol(b){var h;b=null===(h=b.qa)||void 0===h?void 0:h.last;return null!=b&&b.Wh?b.formatting:(w.ULS.sendTraceTag(520680196,389,50,"EOP for list item does not have any formatting applied."),
null)}eLa(b){const h=Cd.ParagraphReader.Ln(b,ic.a.va,UH.a.va);b=Cd.ParagraphReader.Ln(b,ic.a.ta,UH.a.lineSpacing);switch(h){case 0:return b/240;case 1:return b/20;default:return 0}}static ufo(b,h,n){for(let x=0;x<h.length;x++){const E=h.J(x),S=E.Oj,ma=b.Eb(S);ma&&ma.ia(ic.a.AF,!1)&&(n||(n=new kf.a(new bg.a)),E.Oc?n.add(S):n.remove(S))}return n}static $ph(b){return(b=vj.a.lg(b))&&b.name?b.name.toLowerCase():void 0}static odf(b){return b?2===b.unit?Math.floor(mf.a.dwb(b.value)/20):Math.floor(b.value/
20):0}static AHl(b){if(!b)return Jk.g.Initial;switch(b.specialIndentType){case 1:return Jk.g.FirstLine;case 2:return Jk.g.Hanging;default:return Jk.g.Initial}}static jqh(b){switch(b){case 2:return Jk.c.AllCaps;case 1:return Jk.c.SmallCaps;default:return Jk.c.NoCaps}}static C$e(b){switch(b){case 1:return Jk.a.Left;case 3:return Jk.a.Right;case 2:return Jk.a.Center;case 6:return Jk.a.Justified;case 0:return Jk.a.None;default:return Jk.a.Other}}static XDk(b){switch(b){case 15:return Jk.e.Any;case 1:return Jk.e.Bullet;
case 42:return Jk.e.Invalid;case 13:return Jk.e.Lim;case 14:return Jk.e.Nil;case 16:return Jk.e.NoList;case 0:return Jk.e.Numbered;default:return Jk.e.Invalid}}static isReference(b){return b.blob&&(7===b.blob.ri||10===b.blob.ri)||b.Lh&&0<b.Lh.length||b.Ff&&0<b.Ff.length||b.Mb&&0<b.Mb.length?!0:!1}static dhf(b,h,n){return null==h?null:h[n]&&!h[n].equals(C.a.nil)&&b.Nc?b.Nc.Eb(h[n]):null}Ief(b){if(null==b)return null;if(b.hasProperty(ic.a.gq)){var h=b.getValue(ic.a.gq);if(tr.pDi.has(h))return tr.pDi.get(h)}if(b.hasProperty(ic.a.i1b)&&
null!=b.getValue(ic.a.i1b))return Jk.f.FootnoteEndnote;if(b.hasProperty(ic.a.pageBreak)&&b.getValue(ic.a.pageBreak))return Jk.f.PageBreak;if(b.hasProperty(ic.a.oDb)&&b.getValue(ic.a.oDb))return Jk.f.Tab;h=!1;b.hasProperty(ad.a.H$)?h=b.getValue(ad.a.H$):b.hasProperty(ic.a.Vea)&&(h=b.getValue(ic.a.Vea));return h&&b.hasProperty(ic.a.imageType)&&1==b.getValue(ic.a.imageType)?Jk.f.Image:null}static fcm(b){return b.hasProperty(ic.a.U3b)&&0<=b.getValue(ic.a.U3b)?!0:!1}$fi(b){return tr.X1n.has(b)}ath(b,h,
n,x){return null==b||null==h?(w.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: propertySet or objectType is undefined."),null):x===Jk.b.Inline&&null==n?(w.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Inline object does not have formattedRangeIndex defined."),null):x===Jk.b.Floating&&null!=n?(w.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Floating object has formattedRangeIndex defined."),null):0>n?(w.ULS.sendTraceTag(null,
389,10,"FormattingExtractor.CreateObjectReference: FormattedRangeIndex is a negative number."),null):tr.fcm(b)?null:this.$fi(h)?{referencedPath:["session","doc","main",b.id.toString()],formattedRangeIndex:n,anchorMode:null!==x&&void 0!==x?x:Jk.b.Unspecified,anchoredObjectType:x==Jk.b.Floating?h:void 0}:null}Q7g(b,h,n,x,E){h=this.ath(h,n,x,E);null!=h&&null!=b&&b.push(h)}o7m(b){const h=[];if(null==b)return w.ULS.sendTraceTag(null,389,10,"FormattingExtractor.ProcessAnchoredObjects: paragraphNode is null."),
h;let n=null;b.hasProperty(ic.a.l5)&&(n=b.getValue(ic.a.l5));if(null!=n)for(let x=0;x<n.length;++x){const E=tr.dhf(b,n,x),S=this.Ief(E);null!=S&&this.Q7g(h,E,S,null,Jk.b.Floating)}return h}kph(b){if(null==b||!b.hasProperty(ie.a.Un))return!1;const h=b.getValue(ie.a.Un);for(let x=0;x<h.length;x++){var n=tr.dhf(b,h,x);n=this.Ief(n);if(this.$fi(n))return!0}return!1}}tr.pDi=new Map([[5,Jk.f.Image],[11,Jk.f.TextBox],[7,Jk.f.Chart],[6,Jk.f.SmartArt],[10,Jk.f.Drawing],[2,Jk.f.EquationObject],[4,Jk.f.Ink],
[19,Jk.f.PageBreak],[23,Jk.f.FootnoteEndnote],[24,Jk.f.FootnoteEndnote],[35,Jk.f.FootnoteEndnoteReferenceMark],[36,Jk.f.FootnoteEndnoteReferenceMark],[0,Jk.f.Other]]);tr.X1n=new Set([Jk.f.Image,Jk.f.TextBox,Jk.f.Chart,Jk.f.SmartArt,Jk.f.Drawing,Jk.f.Ink]);Object(r.a)(tr,"FormattingExtractor",null,[192]);class AN extends Sys.EventArgs{constructor(b){super();this.O3b=b}}Object(r.a)(AN,"HasNodeEventsEventArgs",Sys.EventArgs,[]);class BN extends Sys.EventArgs{constructor(b){super();this.q6=b}}Object(r.a)(BN,
"IsCollectingNodeEventsEventArgs",Sys.EventArgs,[]);class CN{constructor(b,h,n){this.TRc=b;this.graphNode=h;this.fullPath=n}}Object(r.a)(CN,"NodeEvent",null,[210]);class DN{constructor(){this.mse=this.aqe=!1;this.vqb=null;this.sa=new Ge.a;this.v8=new Aa.a(0);this.A6a=new BF.a(da.a.Pj());this.grb=new BF.a(da.a.Pj());this.Ffd=[]}u8g(b){this.sa.addHandler("IsCollectingNodeEventsChangedKey",b)}Zuk(){this.v8=new Aa.a(0);this.O3b=!1}get O3b(){return this.aqe}set O3b(b){this.aqe!==b&&(this.aqe=b,this.sa.raiseEvent("HasNodeEventsChangedKey",
new AN(b),this))}get q6(){return this.mse}set q6(b){this.mse!==b&&(this.mse=b,this.sa.raiseEvent("IsCollectingNodeEventsChangedKey",new BN(b),this))}AIb(b,h){this.A6a.xb(b)||this.A6a.Z(b,h)}Jzn(b,h){this.grb.Z(b,h)}agl(b){let h=null;this.grb.xb(b)&&(h=this.grb.J(b),this.grb.remove(b));return h}E1d(b,h){if(b)if(this.q6){var n=3!==h&&4!==h&&5!==h||!this.A6a.xb(String.format("{0}",b.id))?If.a.VJ(b):this.A6a.J(String.format("{0}",b.id));if(({value:x}=this.v8.Dc(n)).returnValue)if(x||3!==h)if(5===x&&3===
h){if(b=n.split("\\").pop(),this.grb.xb(b)){var x=this.grb.J(b);x===n?(this.Iwf(n,h),this.v8.add(n,h)):(this.grb.Z(b,n),this.A6a.Z(b,x),this.kmi(n),this.v8.remove(n),this.Iwf(n,h),this.v8.add(x,5))}}else x&&(4!==x||0!==h&&3!==h&&5!==h)&&(this.Iwf(n,h),this.v8.add(n,h));else this.kmi(n),this.v8.remove(n);else this.HAm(n,h),this.Ffd.push(b),this.v8.add(n,h);this.O3b=0<this.v8.count}else w.ULS.sendTraceTag(593761369,389,15,"Can't record a node event if not in collecting mode.");else w.ULS.sendTraceTag(593761370,
389,15,"node is null.")}HAm(b,h){w.ULS.sendTraceTag(593761368,389,100,"Recording new event in queue for node {0} of kind {1}.",b,h)}Iwf(b,h){w.ULS.sendTraceTag(593761366,389,100,"Recording new event for node {0} of kind {1}.",b,h)}kmi(b){w.ULS.sendTraceTag(593761367,389,100,"Removing node {0} form _nodeIdEventKindMap.",b)}BBk(){let b=null;var h=!1;let n=null;for(;this.Ffd.length&&!h;){n=Array.dequeue(this.Ffd);if(!n)return w.ULS.sendTraceTag(593761365,389,15,"graphNode should not be null."),null;
this.A6a.xb(String.format("{0}",n.id))?(b=this.A6a.J(String.format("{0}",n.id)),this.A6a.remove(String.format("{0}",n.id)),this.Ffd.push(n)):b=If.a.VJ(n);h=this.v8.xb(b)}if(!h)return w.ULS.sendTraceTag(593761364,389,15,"NodeEventCollection is empty."),this.Zuk(),null;h=this.v8.J(b);this.v8.remove(b);this.O3b=0<this.v8.count;w.ULS.sendTraceTag(593761363,389,100,"Consuming new event for node {0} of kind {1}.",b,h);return new CN(h,n,b)}wgn(b){this.vqb=b}CBk(){if(!this.vqb)return null;for(var b=0;b<this.vqb.length;b++){var h=
this.vqb.J(b);h=If.a.VJ(h.node);if(this.v8.xb(h))return null}b=this.vqb;this.vqb=null;return b}qvk(){this.vqb=null}i_n(){this.q6=!0}Fam(b){return this.v8.xb(b.id.toString())}}Object(r.a)(DN,"NodeEventsCollection",null,[191]);var oQ=d(308);class EN extends Rt.a{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb){super();this.pbd=new rn.a;this.l6a=!1;this.cmc=null;this.Cfa=(Sb,oc)=>{(Sb=oc.node)&&this.t2a(Sb)&&(w.ULS.sendTraceTag(40253400,389,100,"New paragraph Connect event."),If.a.PRn(Sb,this.via.q6,this.nNb,
this.fSj)&&(this.via.E1d(Sb,0),this.cfj(Sb)));this.via.q6&&this.E8.Bma(Sb)};this.rui=(Sb,oc)=>{Sb=oc.node;this.via.AIb(String.format("{0}",Sb.id),If.a.VJ(Sb))};this.SFb=(Sb,oc)=>{(Sb=oc.node)&&this.t2a(Sb)&&(w.ULS.sendTraceTag(40253401,389,100,"New paragraph Disconnect event."),this.via.q6&&this.via.E1d(Sb,3));this.via.q6&&this.E8.mxi(Sb,3)};this.Q2=(Sb,oc)=>{Sb=oc.node;oc=oc.property;Sb&&this.huj.has(oc)&&this.t2a(Sb)&&(w.ULS.sendTraceTag(40253402,389,100,"New paragraph Modified event."),this.via.q6&&
(this.via.E1d(Sb,2),oc===ic.a.mj&&this.cfj(Sb)));this.via.q6&&oc===ic.a.Mc&&this.E8.mxi(Sb,2)};this.sui=(Sb,oc)=>{(Sb=oc.node)&&Cd.ParagraphReader.oc(Sb)&&!this.Glc.has(Sb)&&!this.mne.has(Sb)&&(this.Glc.add(Sb),this.kX())};this.oxi=(Sb,oc)=>{w.ULS.sendTraceTag(51389214,389,100,"Paragraph load event.");(Sb=oc.node)&&this.Jf.dNm(Sb)};this.ACf=()=>{this.v_c()?this.bU():this.l6a&&!this.via.q6&&this.fQa()};this.pv=h;this.via=n;this.fSj=ej.b(x.q4d);this.nNb=b.$("AugLoopOperationsAreEnabled");this.Jf=E;
this.E8=S;this.tD=ma;this.Hb=Fa;this.Ls=$a;this.xH=sb;this.Glc=new Set;this.mne=new Set;Jb.yna(this,7);this.huj=new Set([ie.a.lo,ie.a.bold,ie.a.italic,ie.a.underline,ie.a.font,ie.a.fontSize,ie.a.fontColor,Th.a.capitalization,ie.a.ai,ie.a.Un,ic.a.Pfa,ic.a.Mma,ic.a.Dj,ic.a.Ofa,ic.a.Lma,ic.a.ra,ic.a.va,ic.a.ta,ic.a.listID,ic.a.CQ,ic.a.ge,ic.a.vua,ic.a.Nv,ic.a.mj])}get index(){return 7}get YSc(){return this.cmc}set YSc(b){this.cmc=b;this.E8.qGf=b?()=>{this.cmc()}:null}init(){this.v_c()&&this.bU();this.via.u8g(this.ACf)}bU(){this.pv?
(this.l6a=!0,this.pv.rs(this.Cfa),this.pv.NV(this.rui),this.pv.xv(this.SFb),this.pv.jp(this.Q2),this.pv.b9g(this.oxi),this.pv.K5j(this.sui)):w.ULS.sendTraceTag(39403912,389,10,"RegisterEventHandlers: ParagraphNode event handlers can't be null.")}fQa(){this.pv?(this.l6a=!1,this.pv.dM(this.Cfa),this.pv.Haa(this.rui),this.pv.Iaa(this.SFb),this.pv.wX(this.Q2),this.pv.zNi(this.oxi),this.pv.ypn(this.sui)):w.ULS.sendTraceTag(39403913,389,10,"UnregisterEventHandlers: ParagraphNode event handlers can't be null.")}HKd(b){b&&
this.pbd.add(b.id,b.ia(ic.a.mj,0))}cfj(b){this.pbd.xb(b.id)?(this.E8.Oko(OH.a.V7d,b,this.pbd.J(b.id)),this.pbd.remove(b.id)):(this.E8.jvk(OH.a.V7d),this.YSc&&this.YSc())}t2a(b){const h=ob.App.xa.jb.Jc;return!!h&&h.Nr&&!!h.ud&&!!h.ud.Nc&&!!b&&!!b.Nc&&b.Nc.id===h.ud.Nc.id}run(){if(0!==this.Glc.size){var b=[];for(let h of this.Glc)b.push(h),this.mne.add(h),100<=b.length&&(this.kCh(b),b=[]);0<b.length&&this.kCh(b);this.Glc.clear()}}kCh(b){const h=new We.a(4,1,500,()=>{for(let n of b)this.mne.delete(n),
this.updateAnnotationRangeData(n)},158);this.Hb.$b(h)}updateAnnotationRangeData(b){var h=this.Ls.TXa(b,0,x=>this.rTn(x.intent));if(0<h.count)for(const x of h){h=this.E8.jEl(x.intent.id);var n=b.oka;const E=Cd.ParagraphReader.iT(b);x.end<x.begin||(n=oQ.a.iCc(E,n,x.begin,x.end-x.begin,x.begin,x.end-x.begin,b),this.xH.jQf(b.Nc,h,n))}}rTn(b){return!!b&&this.tD.Jfb(b)&&!!b.content}v_c(){return!this.l6a&&this.via.q6}}Object(r.a)(EN,"ParagraphNodeEventHandler",Rt.a,[188]);var pQ=d(966),FN=d(556);class iG extends FN.a{constructor(){super();
this.H_=Object.assign(new lh.a,{T_:iG.getTypeName(),B_:iG.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(r.a)(iG,"DeltaUpdateOperation",FN.a,[]);class GN{constructor(){this.referencedPath=null}}Object(r.a)(GN,"ItemReference",null,[]);class HN extends Po.a{constructor(){super();this.op=this.deltas=this.delta=this.parentPath=null}}Object(r.a)(HN,"ItemWithPath",Po.a,[]);var VH=d(946);class FE extends VH.a{constructor(){super();
this.prevParentPath=null;this.H_=Object.assign(new lh.a,{T_:FE.getTypeName(),B_:FE.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}}Object(r.a)(FE,"MoveOperation",VH.a,[]);class GE extends Bo.a{constructor(){super();this.selectedRanges=null;this.H_=Object.assign(new lh.a,{T_:GE.getTypeName(),B_:GE.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(r.a)(GE,"SelectionSignal",Bo.a,[]);class jG extends GE{constructor(){super();this.content=null;this.H_=Object.assign(new lh.a,{T_:jG.getTypeName(),B_:jG.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionContentSignal"}static getBaseTypes(){return["AugLoop_Text_SelectionSignal","AugLoop_Signals_Signal"]}}Object(r.a)(jG,"SelectionContentSignal",GE,[]);class IN{constructor(){this.range=this.tileReference=null}}Object(r.a)(IN,"TextTileRange",null,[]);var qQ=d(1604);class JN{constructor(b,
h,n,x,E,S,ma,Fa){this._augLoopRuntimeManager=this.t$c=null;this.RFe=!1;this.Lia=this.Tve=this.tkd=null;this.Q8k=()=>{if(ob.App.lostSession||Vh.SessionStatusManager.instance&&Vh.SessionStatusManager.instance.io)u.AFrameworkApplication.Hf("a596e684;c81e6109"),u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CloseALSession",!1)&&(augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().closeSession(),w.ULS.sendTraceTag(512623445,389,10,"TileView.firePreparedEventsForOperations: Closing AL session"),
this.Hb.ef(this.t$c));this.Ih.Pd(()=>{var $a;const sb=Pq.a.instance.osa;this.Jy()&&this.Irk(sb);for(this.Qvc.reset();this.KSa.O3b&&!this.Qvc.khb();){let oc;oc=this.KSa.BBk();if(!oc||!oc.graphNode){w.ULS.sendTraceTag(41719901,389,15,"FirePreparedEventsForOperations: nodeEvent or nodeEvent.GraphNode is null.");this.Qvc.update();continue}if(!this.yRn(oc)){w.ULS.sendTraceTag(41719902,389,50,"FirePreparedEventsForOperations: Node with id {0} was not processed.",oc.graphNode.id);this.Qvc.update();continue}const Ic=
oc.graphNode.id.toString();var Jb=-1,Sb=!0;sb&&Kd.SelectionEditor.xf(sb)&&Ic==sb.node.id.toString()&&(Jb=sb.cpBegin,Sb=!1);let gd=null;if(this.Osb.contains(Ic))switch(oc.TRc){case 3:this.Osb.remove(Ic);gd=3;break;default:gd=oc.TRc}else switch(oc.TRc){case 0:case 1:this.Osb.add(Ic);gd=0;break;case 2:this.Osb.add(Ic);gd=0;break;case 3:this.Osb.remove(Ic);gd=3;break;default:gd=oc.TRc}if(null!=gd){Jb=this.Lef(oc.graphNode,oc.fullPath,gd,Jb,Sb);if(4==gd||5==gd){if(Jb.prevParentPath.join()!==Jb.parentPath.join()){Sb=
Object.assign(new rg.a,{parentPath:Jb.prevParentPath,items:Jb.items});const Gd=Object.assign(new an.a,{parentPath:Jb.parentPath,items:Jb.items,prevId:Jb.prevId,nextId:Jb.nextId});this._augLoopRuntimeManager.submitOperation(Object.assign(new Np.a,{operation:Sb}));this._augLoopRuntimeManager.submitOperation(Object.assign(new Np.a,{operation:Gd}));oc.graphNode.type===bt.a.table&&this.bVi(oc.graphNode,Jb.parentPath).forEach(vd=>{this._augLoopRuntimeManager.submitOperation(Object.assign(new Np.a,{operation:vd}))})}}else this._augLoopRuntimeManager.submitOperation(Object.assign(new Np.a,
{operation:Jb}));if(this.o6c&&this.Lia&&this.Lia[0]==Ic)switch(gd){case 3:this.Lia=null;break;case 0:case 1:case 2:case 4:case 5:this.Lia[1]=null===($a=this.irb.eAb(oc.graphNode))||void 0===$a?void 0:$a.UGc(oc.graphNode)}w.ULS.sendTraceTag(40776388,389,100,"FirePreparedEventsForOperations: Operation with OpType {0} submitted for tileId {1}",vn.a.getTypeNameFor(Jb),Ic);switch(gd){case 0:case 4:case 5:this.Jf.jWm(oc.graphNode);break;case 3:this.Jf.kWm(oc.graphNode,Jb.parentPath.join("\\"))}}this.Qvc.update()}($a=
this.KSa.CBk())&&this.aPi($a)},"TV:FPEFO")};this.cna=($a,sb)=>{var Jb;if(sb.kl&&sb.kl.length){if(this.o6c)if($a=If.a.Myl(sb.kl),!$a)this.Lia=null;else if(!this.Lia||this.Lia[0]!=$a.id.toString()){const Sb=this.KSa.Fam($a)?null:null===(Jb=this.irb.eAb($a))||void 0===Jb?void 0:Jb.UGc($a);this.Lia=[$a.id.toString(),Sb]}this.RFe&&(this.pfi()?this.KSa.wgn(sb.kl.kb):this.sZi(!1))}};this.Ma=b;this.KSa=h;this.Hb=n;this.Qvc=x;this.Luj=this.Ma.$("AugLoopOperationsAreEnabled");this.Osb=new kf.a(da.a.Pj());this.Jf=
E;this.Ih=S;this.irb=ma;this.hb=Fa;this.GD=new se.a(()=>ob.App.xa.jb.Zc.Ad);this.o6c=this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",!1);this.hb.OD(this.cna);If.a.zn().then(()=>{this._augLoopRuntimeManager=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();u.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IWacBox4AugLoopTimeBasedYieldTraversalSettings");this.Ma.$("AugLoopAnnotationsIsEnabled")&&this._augLoopRuntimeManager.setAnnotationResultCallback(Object.assign(new qQ.a,
{handler:$a=>{this.Jf.t$j($a)}}));this.Luj&&this.KSa.i_n();this.Y_n()}).catch(()=>{})}Irk(b){const h=[],n=this.Jf.LOb.entries();for(let x=0;x<this.Jf.LOb.size;x++){const E=n.next();(2E3<=Date.now()-E.value[1]||b.node.id!=E.value[0])&&h.push(E.value[0])}h.forEach(x=>{this.Jf.LOb.delete(x);(x=If.a.eIc(this.GD.value,x))?this.B9n(x):w.ULS.sendTraceTag(520734497,389,50,"checkAndTriggerProofingForDelayedNodes: Stale node.")})}yRn(b){return 3===b.TRc||If.a.i2i(b.graphNode)}Y_n(){!this.t$c&&this.KSa.q6&&
(this.t$c=new We.a(4,2,this.Ma.rc("NodeEventsFiringInterval",500),this.Q8k,131),this.Hb.$b(this.t$c))}bVi(b,h){var n,x=[];const E=md.GraphIterator.$a(b),S=E.Hp();for(var ma=0;ma<S;ma++){let Fa=E.kI(ma);Fa.type===bt.a.outlineElement&&(Fa=wf.OutlineElementNavigator.He(E));const $a=Fa.id.toString(),sb=null===(n=this.irb.eAb(Fa))||void 0===n?void 0:n.Hwb(Fa);x.push(Object.assign(new Po.a,{body:sb,id:$a,revId:If.a.khf(Fa)}));E.kd(b.type)}h.push(b.id.toString());n=[];n.push(Object.assign(new an.a,{parentPath:h.slice(),
items:x,prevId:null}));for(x=0;x<S;x++)ma=E.kI(x),ma.type===bt.a.outlineElement&&(ma=wf.OutlineElementNavigator.He(E)),0<E.Hp()&&(n=n.concat(this.bVi(ma,h))),E.kd(b.type);h.pop();return n}jLa(b){return b.split("\\").slice(0,-1)}Lef(b,h,n,x=-1,E=!0){var S;let ma=null,Fa=null;const $a=b.id.toString();var sb=null;3!==n&&(sb=If.a.Ylk(b));if(sb)for(let Jb=0;Jb<sb.length;Jb++)if(sb[Jb]===$a){Fa=Jb+1<sb.length?sb[Jb+1]:null;ma=Jb?sb[Jb-1]:null;break}sb=null===(S=this.irb.eAb(b))||void 0===S?void 0:S.Hwb(b,
x,E);x=[Object.assign(new Po.a,{body:sb,id:$a,revId:If.a.khf(b)})];switch(n){case 0:case 1:return Object.assign(new an.a,{parentPath:this.jLa(h),items:x,prevId:ma,nextId:Fa});case 4:return Object.assign(new FE,{parentPath:this.jLa(If.a.VJ(b)),prevParentPath:this.jLa(h),items:x,prevId:ma,nextId:Fa});case 5:return n=this.KSa.agl($a),Object.assign(new FE,{parentPath:this.jLa(null!==n&&void 0!==n?n:If.a.VJ(b)),prevParentPath:this.jLa(h),items:x,prevId:ma,nextId:Fa});case 2:return Object.assign(new $C.a,
{parentPath:this.jLa(h),items:x});case 3:return Object.assign(new rg.a,{parentPath:this.jLa(h),items:x});default:return w.ULS.sendTraceTag(42084322,389,15,"Submitted unknown operation for NodeEventKind ${0}, tileId {1}",n,$a),Object.assign(new VH.a,{parentPath:this.jLa(h),items:x,prevId:ma,nextId:Fa})}}hLl(b){return this.Lia&&this.Lia[0]===b?this.Lia[1]:null}UDn(b){var h;if(!this.o6c)return w.ULS.sendTraceTag(545552581,389,10,"sendTile: autoreplace is not enabled"),!1;if(!If.a.i2i(b))return!1;const n=
b.id.toString();var x=this.Osb.contains(n)?2:0;x=this.Lef(b,If.a.VJ(b),x);this._augLoopRuntimeManager.submitOperation(Object.assign(new Np.a,{operation:x}));this.Osb.add(n);this.Lia=[n,null===(h=this.irb.eAb(b))||void 0===h?void 0:h.UGc(b)];return!0}RCn(b,h){var n;if(this.o6c){var x=b.id.toString(),E=this.jLa(If.a.VJ(b));h=[Object.assign(new HN,{id:x,revId:If.a.khf(b),parentPath:E,delta:h})];E=Object.assign(new iG,{parentPath:E,items:h});this._augLoopRuntimeManager.submitOperation(Object.assign(new Np.a,
{Szo:E}));w.ULS.sendTraceTag(545552583,389,50,"sendDeltaOperation: tileId {0}",x);this.Lia=[x,null===(n=this.irb.eAb(b))||void 0===n?void 0:n.UGc(b)]}else w.ULS.sendTraceTag(545552582,389,10,"sendDeltaOperation: autoreplace is not enabled")}qdk(b,h){if(b.tileReference.referencedPath.length!==h.tileReference.referencedPath.length||b.range.start!==h.range.start||b.range.length!==h.range.length)return!1;for(let n=0;n<b.tileReference.referencedPath.length;n++)if(b.tileReference.referencedPath[n]!==h.tileReference.referencedPath[n])return!1;
return!0}mdk(b,h){if(b.selectedRanges.length!==h.selectedRanges.length||b.content!==h.content)return!1;for(let n=0;n<b.selectedRanges.length;n++)if(!this.qdk(b.selectedRanges[n],h.selectedRanges[n]))return!1;return!0}aPi(b){var h;if(b){var n=new Qa.a,x="";for(let ma=0;ma<b.length;ma++){var E=b.J(ma),S=(null===(h=this.irb.eAb(E.node))||void 0===h?void 0:h.Hwb(E.node)).content;x+=S;S=E.cpBegin<S.length?E.cpBegin:-1;S=Object.assign(new mN.a,{start:S,length:E.cpEnd-E.cpBegin});const Fa=E.node.id.toString();
E=this.jLa(If.a.VJ(E.node));E.push(Fa);n.add(Object.assign(new IN,{range:S,tileReference:Object.assign(new GN,{referencedPath:E})}))}b=Object.assign(new jG,{selectedRanges:n.toArray(),content:x});this.Tve&&this.mdk(b,this.Tve)||(h=this.tkd?this.tkd:C.a.create().toString(),n=[Object.assign(new Po.a,{body:b,id:h})],this.tkd?h=Object.assign(new $C.a,{parentPath:["session","doc"],items:n}):(this.tkd=h,h=Object.assign(new an.a,{parentPath:["session","doc"],items:n})),this._augLoopRuntimeManager.submitOperation(Object.assign(new Np.a,
{operation:h})),this.Tve=b)}}vMn(b){this.pfi()&&this.sZi(b)}sZi(b){(this.RFe=b)?this.aPi(this.hb.ib.kb):this.KSa.qvk()}pfi(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableSendSelectionSignalToAugloop",!1)}B9n(b){b=this.Lef(b,If.a.VJ(b),2);this._augLoopRuntimeManager.submitOperation(Object.assign(new Np.a,{operation:b}))}Jy(){return!!u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}}Object(r.a)(JN,
"TileView",null,[190]);var kG=d(1731),lG;(function(b){b[b.none=0]="none";b[b.firstRow=32]="firstRow";b[b.lastRow=64]="lastRow";b[b.firstCol=128]="firstCol";b[b.lastCol=256]="lastCol";b[b.noHBand=512]="noHBand";b[b.noVBand=1024]="noVBand";b[b.nwCell=160]="nwCell";b[b.neCell=288]="neCell";b[b.swCell=192]="swCell";b[b.seCell=320]="seCell";b[b.defaultLook=1184]="defaultLook"})(lG||(lG={}));Object(r.b)("TableLookFlags",lG);class KN{Hwb(b){if(b)switch(b.type){case 14:return this.WLk(b);case 15:return new kG.TableRow;
case 16:return this.VLk(b)}else w.ULS.sendTraceTag(524149331,389,10,"ConvertNodeToTile: Node can't be null.")}WLk(b){var h=b.Fx||[];let n=0;for(let x=0;x<h.length;x++)n+=h[x];h=h.map((x,E)=>({columnId:E.toString(),widthPercent:0!=n?100*x/n:0}));return new kG.WordTable({columnDefs:h,tableLook:b.properties.ia(ic.a.tableLook,lG.defaultLook),complexTable:b.properties.ia(ic.a.complexTable,!1),floatingTable:b.properties.ia(ic.a.kbi,!1)})}VLk(b){return new kG.TableCell({rowspan:b.properties.ia(ic.a.rowSpan,
1),colspan:b.properties.ia(ic.a.colSpan,1),borderInfo:{topBorder:{color:b.properties.ia(ic.a.$2a,0),size:b.properties.ia(ic.a.Zkb,4),style:b.properties.ia(ic.a.JPa,"single")},leftBorder:{color:b.properties.ia(ic.a.Y2a,0),size:b.properties.ia(ic.a.Xkb,4),style:b.properties.ia(ic.a.HPa,"single")},rightBorder:{color:b.properties.ia(ic.a.Z2a,0),size:b.properties.ia(ic.a.Ykb,4),style:b.properties.ia(ic.a.IPa,"single")},bottomBorder:{color:b.properties.ia(ic.a.X2a,0),size:b.properties.ia(ic.a.Wkb,4),style:b.properties.ia(ic.a.GPa,
"single")}},verticalAlignment:b.properties.ia(ic.a.Mga,kG.TableCellVerticalAlignment.Top),ghostCell:b.properties.ia(ic.a.ghostCell,!1),renderCell:b.properties.ia(ic.a.renderCell,!1),skippedCell:b.properties.ia(ic.a.skippedCell,!1),fillColor:b.properties.ia(ie.a.NH,0),verticalMerge:b.properties.ia(wi.a.vMerge,null)})}UGc(b){return null===b||void 0===b?void 0:b.properties}}Object(r.a)(KN,"TableElementNodeToTileConverter",null,[189]);class LN{constructor(b,h,n){this.Jp=h;this.vva=n;this.nAd=!1;this.cmc=
null;this.$yi=(x,E)=>{this.Nua(E.node,0)};this.Wyi=(x,E)=>{x=E.node;this.vva.AIb(x.id.toString(),If.a.VJ(x))};this.azi=(x,E)=>{this.Nua(E.node,3)};this.tXd=(x,E)=>{this.Nua(E.node,2)};this.czi=(x,E)=>{this.Nua(E.node,0)};this.dzi=(x,E)=>{this.Nua(E.node,3)};this.bzi=(x,E)=>{x=E.node;this.vva.AIb(x.id.toString(),If.a.VJ(x))};this.uXd=(x,E)=>{this.Nua(E.node,2)};this.Yyi=(x,E)=>{this.Nua(E.node,0)};this.Xyi=(x,E)=>{x=E.node;this.vva.AIb(x.id.toString(),If.a.VJ(x))};this.Zyi=(x,E)=>{this.Nua(E.node,
3)};this.rXd=(x,E)=>{var S;x=E.node;if(E.property===ic.a.ghostCell){if(E=x.qg?x:null===(S=x.Vta)||void 0===S?void 0:S.controlCell){S=md.GraphIterator.$a(E);var ma=S.Hp();for(var Fa=0;Fa<ma;Fa++){S.kI(Fa);var $a=wf.OutlineElementNavigator.He(S);this.vva.AIb($a.id.toString(),String.format("{0}\\{1}",If.a.VJ(E),$a.id));this.Nua($a,4);S.kd(16)}}}else if(E.property===ie.a.rf){E=md.GraphIterator.$a(x);S=E.Hp();let sb=null;ma=[];for(Fa=0;Fa<S;Fa++){E.kI(Fa);$a=wf.OutlineElementNavigator.He(E);this.vva.Jzn($a.id.toString(),
String.format("{0}\\{1}",If.a.VJ(x),$a.id));if(14!==$a.type){if(sb=If.a.VJ($a))this.vva.AIb($a.id.toString(),sb),this.Nua($a,5)}else ma.push($a);E.kd(16)}sb&&ma.forEach(Jb=>{this.vva.AIb(Jb.id.toString(),String.format("{0}\\{1}",sb.split("\\").slice(0,-1).join("\\"),Jb.id));this.Nua(Jb,5)})}this.Nua(x,2)};this.ACf=()=>{this.v_c()?this.bU():this.nAd&&!this.vva.q6&&this.fQa()};this.nNb=b.$("AugLoopOperationsAreEnabled")}get YSc(){return this.cmc}init(){this.v_c()&&this.bU();this.vva.u8g(this.ACf)}bU(){const {L8i:b,
O9d:h,y8i:n}=this.JOh();if(b&&h&&n){this.nAd=!0;var x=this.Wyi,E=this.azi,S=this.tXd;b.rs(this.$yi);b.NV(x);b.xv(E);b.jp(S);x=this.bzi;E=this.dzi;S=this.uXd;h.rs(this.czi);h.NV(x);h.xv(E);h.jp(S);x=this.Xyi;E=this.Zyi;S=this.rXd;n.rs(this.Yyi);n.NV(x);n.xv(E);n.jp(S)}else w.ULS.sendTraceTag(524149329,389,10,"RegisterEventHandlers: TableNode event handlers can't be null.")}fQa(){const {L8i:b,O9d:h,y8i:n}=this.JOh();if(b&&h&&n){this.nAd=!1;var x=this.Wyi,E=this.azi,S=this.tXd;b.dM(this.$yi);b.Haa(x);
b.Iaa(E);b.wX(S);x=this.bzi;E=this.dzi;S=this.uXd;h.dM(this.czi);h.Haa(x);h.Iaa(E);h.wX(S);x=this.Xyi;E=this.Zyi;S=this.rXd;n.dM(this.Yyi);n.Haa(x);n.Iaa(E);n.wX(S)}else w.ULS.sendTraceTag(524149330,389,10,"UnregisterEventHandlers: TableNode event handlers can't be null.")}Nua(b,h){b&&this.t2a(b)&&this.vva.q6&&this.nNb&&this.vva.E1d(b,h)}JOh(){return{L8i:this.Jp.Te(14),O9d:this.Jp.Te(15),y8i:this.Jp.Te(16)}}t2a(b){const h=ob.App.xa.jb.Jc;return!!h&&h.Nr&&!!h.ud&&!!h.ud.Nc&&!!b&&!!b.Nc&&b.Nc.id===
h.ud.Nc.id}v_c(){return!this.nAd&&!!this.vva.q6}}Object(r.a)(LN,"TableNodeEventHandler",null,[188]);class MN{constructor(b,h){this.JBi=b;this.x3n=h}eAb(b){return b?14===b.type||15===b.type||16===b.type?this.x3n:12===b.type?this.JBi:null:null}}Object(r.a)(MN,"NodeToTileConverterHolder",null,[187]);class WH{get name(){return"Box4.AugmentationLoop"}zc(b){this.W=b;const h=this.W.resolve("Common.IAppSettingsManager"),n=h.$("AugLoopTaskUseTimeBasedYieldStrategy"),x=new DN,E=n?new tp(h.rc("AugLoopTaskAllowedRunTimeBeforeYielding",
10),rd.a.lf):new kN(h.rc("AugLoopTaskNodesToRunBeforeYielding",10));this.W.ha("Common.ICpuMeter",()=>oo.a.instance).singleInstance();this.W.ha("Box4.AugmentationLoop.AugmentationLoopStateManager",()=>new vN).as("Box4.AugmentationLoop.IAugmentationLoopStateManager").singleInstance();this.W.ha("Box4.AugmentationLoop.ParagraphNodeEventHandler",()=>new EN(h,ob.App.Wj.al.Te(12),x,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
this.W.resolve("Box4.AugmentationLoop.IPersistedAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),u.AFrameworkApplication.uc,this.W.resolve("Box4.Intent.IIntentRangeEditor"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).as("Box4.AugmentationLoop.INodeEventHandler<Box4.AParagraphNode>").singleInstance();If.a.J6d()&&this.W.ha("Box4.AugmentationLoop.TableNodeEventHandler",()=>new LN(h,ob.App.Wj.al,x)).singleInstance();
this.W.ha("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager",()=>new jN).singleInstance();this.W.ha("Box4.AugmentationLoop.IFormattingExtractor",()=>new tr(this.W.resolve("Common.IAppSettingsManager"),this.W.Pa("Box4.IFeatureHelper"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IParagraphIndentationReader"),this.W.resolve("Box4.Styles.IWACStyleReader"))).singleInstance();this.W.ha("Box4.AugmentationLoop.IAnnotationPolicies",()=>new OH.a(new se.a(()=>ob.App.xa.jb.Zc.Ad),this.W.resolve("Box4.Intent.IIntentRangeEditor"))).singleInstance();
this.W.ha("Box4.AugmentationLoop.IPersistedAnnotationStorage",()=>new gt(this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.IIntelligenceReader"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),new se.a(()=>ob.App.xa.jb.Zc.Ad),b.resolve("Box4.IFeatureHelper"))).singleInstance();const S=this.W.resolve("IRoamingDictionary");this.W.ha("Box4.AugmentationLoop.IAnnotationStorage",()=>new fj(this.W.resolve("Common.IAppSettingsManager"),this.W.resolve("Common.ICpuMeter"),
this.W.resolve("Box4.Intent.IIntentRangeEditor"),new se.a(()=>ob.App.xa.jb.Zc.Ad),u.AFrameworkApplication.uc,this.W.Pa("Box4.IIntelligenceReader"),this.W.Pa("Box4.IIntelligenceEditor"),this.W.Pa("Box4.AugmentationLoop.IAnnotationPolicies"),this.W.Pa("Box4.AugmentationLoop.IPersistedAnnotationStorage"),b.resolve("Box4.IFeatureHelper"),Zm.a.instance,()=>{try{return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager()}catch(ma){return w.ULS.sendTraceTag(50935320,389,10,"Unable to GetAugLoopRuntimeManager, most likely due to al bundle not being loaded: {0}",
ma),null}},S)).singleInstance();this.W.ha("Box4.AugmentationLoop.INodeToTileConverterHolder",()=>new MN(new pQ.a(this.W.resolve("Box4.AugmentationLoop.IFormattingExtractor")),new KN)).singleInstance();this.W.ha("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>",()=>new JN(h,x,u.AFrameworkApplication.uc,E,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),
this.W.resolve("Box4.ISelectionManager"))).singleInstance();w.ULS.sendTraceTag(39966347,389,50,"TileView<TextTile, AParagraphNode> registered.");this.W.ha("Box4.AugmentationLoop.IUtilsWrapper",()=>new zN).singleInstance();this.W.ha("Box4.AugmentationLoop.IAlFactoryWrapper",()=>new yN).singleInstance()}init(){if(u.AFrameworkApplication.K&&u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CloseALSession",!1)&&u.AFrameworkApplication.SY.BootFailed)w.ULS.sendTraceTag(512624089,
389,10,"Cannot initialize Box4 Augmentation Loop package: Boot Failure");else if(u.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled")){w.ULS.sendTraceTag(35190237,389,50,"Initializing Box4 Augmentation Loop package.");const b=new sr(this.W.resolve("Common.IAppSettingsManager"),u.AFrameworkApplication.Ze,ob.App.Tga,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),jl.a.instance,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage")),h=new lN;this.W.register(152,"Box4.AugmentationLoop.IAlSessionLifeEventNotifier").singleInstance().lmo(()=>
h);const n=If.a.uqm(this.W.resolve("Common.IDynamicScriptLoaderProvider").tE,this.W.resolve("Common.App.OAuth.IOAuthManager"),b,this.W.resolve("Common.ISharedDependencyLoader"),h);this.W.ha("Box4.AugmentationLoop.RuntimeManagerInitializationTracker",()=>new xN(n)).singleInstance();this.W.resolve("Box4.AugmentationLoop.ParagraphNodeEventHandler").init();If.a.J6d()&&this.W.resolve("Box4.AugmentationLoop.TableNodeEventHandler").init();this.W.resolve("Box4.IIntelligenceReader").init();this.W.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>")}}dispose(){}static main(b){N.a.instance.Pc(new WH,
0,b);w.ULS.sendTraceTag(35190238,389,50,"Box4 Augmentation Loop package registered.")}}Object(r.a)(WH,"Box4AugmentationLoopPackage",null,[1,2]);var mG=d(442),rQ=d(1105);class HE{constructor(b,h,n,x=null,E=null,S=null){this.xS=new rQ.a(h,x,E,S);this.Ob=b;this.Oc=n}get type(){return this.xS.type}get id(){return this.xS.id}get intent(){return this.xS.intent}Yf(b){return new HE(b,this.type,this.Oc,this.id,this.intent,this.xS.jua)}toString(){return String.format("Core = [{0}], IsStart = {1}",this.xS,this.Oc)}}
Object(r.a)(HE,"IntentObject",null,[79]);var NN=d(498);class EB{constructor(){this.Smc=new Do.a}Gpd(b,h,n,x,E=null,S=null,ma=null){b=b.R9(h,b.qa.e$n(h));b.mk||(b.mk=new NN.a(b));b.mk.add(new HE(b,n,x,E,S,ma));b.isFromErrorRangeSplit=!0}dMi(b){return b.Ob&&b.Ob.mk&&b.Ob.mk.eXc(h=>h===b,[b.type])?!0:!1}Jnn(b,h){if(b.type===h.type&&b.Oc&&!h.Oc&&b.Ob&&b.Ob.mk&&b.Ob.mk.contains(b)&&h.Ob&&h.Ob.mk&&h.Ob.mk.contains(h)){var n=[b.type];b.Ob.mk.eXc(x=>x===b,n);h.Ob.mk.eXc(x=>x===h,n)}}eno(b,h,n){if(!h)return!1;
n=new hG.a([n]);for(let x=0;x<b.length;x++){const E=b.J(x);if(!E.mk)continue;let S=!0;n.O3a(E.mk,void 0,ma=>{ma.id&&h.equals(ma.id)&&(S=!1)});if(!S)return!1}return!0}y5m(b,h,n,x){let E=null,S=null;h=new hG.a([h]);const ma=b.qa;for(let Fa=0;Fa<ma.length;Fa++){const $a=ma.J(Fa);if(!$a.mk)continue;let sb=!0;h.O3a($a.mk,void 0,(Jb,Sb)=>{if(Sb){var oc=Sb.Ob.cp<n,Ic=Jb.Ob.cp>x;oc&&Jb.Ob.cp<=n||Sb.Ob.cp>=x&&Ic||(oc&&Ic?sb=!1:oc?E=Jb:Ic?S=Sb:this.Jnn(Sb,Jb))}});if(!sb)return!1}if(E){if(!this.dMi(E))return!1;
this.Gpd(b,n,E.type,E.Oc,E.id,E.intent,E.xS.jua)}if(S){if(!this.dMi(S))return!1;this.Gpd(b,x,S.type,S.Oc,S.id,S.intent,S.xS.jua)}return!0}ZYf(b){let h;return u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TestBox4Ops",!1)?!1:({value:h}=this.Smc.Dc(b.type,h)).returnValue?h.ZYf(b):!0}WCm(b,h){if(this.ZYf(h)){var n=h.id,x=h.type,E=h.begin,S=h.end;if(({cpEnd:S}=EB.Iij(b,E,S)).returnValue){if(mG.a(x)){if(!this.eno(b.qa,n,x))return}else if(!this.y5m(b,x,E,S))return;this.Gpd(b,
E,x,!0,n,h.intent,h.xS.jua);this.Gpd(b,S,x,!1,n,h.intent,h.xS.jua)}}}mZd(b,h){ob.App.xa.v5e(b,()=>{const n=new Se.GraphTransaction(2);try{n.Db(b);const x=b.IX();try{const E=b.gZ();try{h()}finally{E&&E.dispose()}}finally{x&&x.dispose()}}finally{n&&n.dispose()}})}G8b(b,h){this.mZd(b,()=>{this.WCm(b,h)})}YCm(b,h){if(h.count){var n=new Pa.a,x=new mm.a;for(var E of h){var S=E.value;mG.a(E.key)||S.Sc((Fa,$a)=>Fa.begin!==$a.begin?Fa.begin-$a.begin:Fa.end-$a.end);if(EB.ino(S))for(var ma of S)S=ma.end,({cpEnd:S}=
EB.Iij(b,ma.begin,S)).returnValue&&(S=S!==ma.end?new EE.a(ma.type,ma.begin,S,ma.id,ma.intent,ma.xS.jua):ma,n.add(S.begin),n.add(S.end),EB.F1j(x,S))}b.Nzd(n);b=b.qa;for(n=0;n<b.length;n++){E=b.J(n);if(ma=E.mk)for(const $a of h.keys)ma.YMi($a);let Fa;({value:Fa}=x.Dc(E.cp,Fa)).returnValue||(Fa=null);if(Fa){ma||(ma=E.mk=new NN.a(E));for(const $a of Fa)ma.add($a.Yf(E))}E.isFromErrorRangeSplit=!0}}}Ixf(b,h){const n=new Do.a;for(const x of h){let E;({value:E}=n.Dc(x.type,E)).returnValue||(E=new Qa.a,n.Z(x.type,
E));E.add(x)}this.mZd(b,()=>{this.YCm(b,n)})}nco(b,h){b=b.qa;for(let n=0;n<b.length;n++){const x=b.J(n);x.mk&&x.mk.YMi(h)}}Bgc(b,h){this.mZd(b,()=>{this.nco(b,h)})}mco(b,h,n){let x=!1;h=h.qa;n=[n];for(let E=0;E<h.length;E++){const S=h.J(E);S.mk&&(x=S.mk.eXc(b,n)||x)}return x}c6f(b,h,n){let x=!1;this.mZd(h,()=>{x=this.mco(b,h,n)});return x}oRh(b,h,n,x){return!b||0>n||x>b.characterData.length||n>x?new Qa.a:this.TXa(b,h,E=>Math.max(E.begin,n)<=Math.min(E.end,x))}TXa(b,h,n){return EB.eul(b,h,n)}static eul(b,
h,n){const x=new Qa.a;b=b.qa;h=new hG.a([h]);if(!b)return x;for(let E=0;E<b.length;E++){const S=b.J(E);S.mk&&h.O3a(S.mk,void 0,(ma,Fa)=>{Fa&&(ma=new EE.a(Fa.type,Fa.Ob.cp,ma.Ob.cp,Fa.id,Fa.intent,Fa.xS.jua),n(ma)&&x.add(ma))})}return x}OHc(b,h){const n=new Qa.a;if(!EB.Vkm(b.contextId))return n;let x;const E=b.node;b.contextId!==cc.a.paragraph?(x=b.cpBegin,b=b.cpEnd):(x=0,b=E.characterData.length);n.addRange(this.oRh(E,h,x,b));return n}Qjn(b){this.Smc.xb(0)||this.Smc.Z(0,b)}static Iij(b,h,n){b=Cd.ParagraphReader.textLength(b);
if(h>=b)return{returnValue:!1,cpEnd:n};n>b&&(n=b);return{returnValue:!0,cpEnd:n}}static ino(b){if(!b.count)return!0;const h=new Lm.a,n=b.J(0).type,x=mG.a(n);let E=-1;for(const S of b){if(S.type!==n||(mG.c(S.type)?S.begin>S.end:S.begin>=S.end))return!1;if(x){b=S.id;if(!b||b.equals(C.a.nil)||h.contains(b))return!1;h.add(b)}else if(-1===E)E=S.end;else if(E>S.begin)return!1}return!0}static F1j(b,h){let n;({value:n}=b.Dc(h.begin,n)).returnValue||(n=new Qa.a,b.Z(h.begin,n));n.add(new HE(null,h.type,!0,
h.id,h.intent,h.xS.jua));({value:n}=b.Dc(h.end,n)).returnValue||(n=new Qa.a,b.Z(h.end,n));n.add(new HE(null,h.type,!1,h.id,h.intent,h.xS.jua))}static Vkm(b){return b===cc.a.Fd||b===cc.a.Wc||b===cc.a.paragraph}}Object(r.a)(EB,"IntentRangeEditor",null,[185]);class XH{constructor(){this.W=null}get name(){return"Box4.Intent"}zc(b){this.W=b;this.W.ha("Box4.Intent.IntentRangeEditor",()=>new EB).as("Box4.Intent.IIntentRangeEditor").singleInstance()}init(){this.W.resolve("Box4.IProofingManager")}dispose(){}static main(b){N.a.instance.Pc(new XH,
0,b)}}Object(r.a)(XH,"PackageManager",null,[1,2]);var uD=d(977),rw=d(1380);class YH{constructor(b){this.pBm=b;this.lBm=[]}get handler(){return this.pBm}get wka(){return this.lBm}}Object(r.a)(YH,"RegisteredListener",null,[]);class tA{constructor(b,h){this.type=0;this.payload=null;this.type=b;this.payload=h}}Object(r.a)(tA,"OfficeSharedCommentsEvent",null,[832]);class nG{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(r.a)(nG,"ViewContainerEvent",
null,[832]);class IE{constructor(b){this.exf=!1;this.nma=new Qa.a;this.RSd=b}pjn(b){b=new YH(b);this.nma.add(b)}zdj(b){for(let h=0;h<this.nma.count;++h)if(this.nma.J(h).handler===b){this.nma.removeAt(h);break}}QOa(b=!1){const h=()=>{if(u.AFrameworkApplication.Dk)w.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let E=0;E<this.nma.count;++E){const S=this.nma.J(E);for(;0<S.wka.length;){var n=Array.dequeue(S.wka);if(Object(pb.a)(nG,n)){var x=
S.handler;x(n)}else Object(pb.a)(tA,n)&&(x=S.handler,x(n.type,n.payload))}}};b?h():this.exf||(this.exf=!0,yo.a.h1(this.RSd,()=>{h();this.exf=!1},rw.a.O$k))}}Object(r.a)(IE,"GenericEventHost",null,[]);class xC{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=
0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(r.a)(xC,"BasicEventPayload",null,[869]);class ZH{constructor(b){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=b}}Object(r.a)(ZH,"CommentContextDetails",null,[]);class sQ{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(r.a)(sQ,"ContextChangeWithSelectedThreadIndex",
null,[869]);class ON{constructor(){this.tasks=this.comments=null}}Object(r.a)(ON,"LoadCommentsNoVirtualization",null,[869]);class PN extends IE{constructor(b){super(b);this.qXg=0}LLn(b){this.qXg=b}Xjn(b,h,n,x,E,S){b=new YH(b);S&&Array.enqueue(b.wka,this.hGk(S,this.qXg));S=h?h.length:0;Array.enqueue(b.wka,this.Grh(S,n,x,0));S&&Array.enqueue(b.wka,this.Bsh(h,E));this.nma.add(b);this.QOa()}Dgc(b){this.zdj(b)}NCn(b,h,n,x=0){this.MBb(this.Grh(b,h,n,x));this.QOa()}OCn(b,h,n){this.MBb(this.HGk(b,h,n));this.QOa()}iDn(b,
h){this.MBb(this.Bsh(b,h));this.QOa()}selectComment(b){this.MBb(this.Bth(b,6));this.QOa()}highlightComment(b){this.MBb(this.Bth(b,7));this.QOa()}l7f(b,h){this.MBb(this.GJk(b,h));this.QOa()}GKf(b,h){this.MBb(this.BLk(b,h));this.QOa()}hGk(b,h=0){const n=new xC;n.modelCapabilityFlags=b;n.richTextCapabilityFlags=h;return new tA(12,n)}Grh(b,h,n,x){const E=new xC;E.numberOfComments=b;E.numberOfThreads=h;E.contextDetails=Object.assign(new ZH(n),{nextPopulatedContextDetails:x});E.contextDrafts=null;E.rehydrationDrafts=
null;return new tA(0,E)}HGk(b,h,n){const x=new xC;x.comments=b;x.numberOfThreads=h;x.tasks=n;return new tA(2,x)}Bsh(b,h){const n=new ON;n.comments=b;n.tasks=h;return new tA(1,n)}Bth(b,h){const n=new xC;n.commentId="";b&&(n.commentId=b);return new tA(h,n)}GJk(b,h){const n=new xC;n.changes=[];n.contextDetails=Object.assign(new ZH(h),{nextPopulatedContextDetails:b});return new tA(10,n)}BLk(b,h){const n=new xC;n.commentId=b;n.smartReplies=h;return new tA(15,n)}MBb(b){for(let h=0;h<this.nma.count;++h)Array.enqueue(this.nma.J(h).wka,
b)}}Object(r.a)(PN,"OfficeSharedCommentsEventHost",IE,[861]);class QN{constructor(){this.AFe=this.wsg=!1;this.bS=this.Pm=this.uHg=this.FNg=this.nod=this.QSb=this.Z0g=this.fxg=this.tE=this.Suc=null}initialize(b,h,n,x=null,E=null,S=null,ma=null,Fa=null,$a=null,sb=null){this.tE=b;this.fxg=h;this.Z0g=n;this.QSb=x;this.nod=E;this.FNg=S;this.uHg=ma;this.Pm=Fa;this.wsg=!0;this.bS=$a;this.Suc=sb}LLd(b=null,h=null){if(!this.wsg)return w.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),
new Promise((n,x)=>{x(yo.a.GC(-2130915313))});if(this.AFe)return w.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>{});this.Suc||(u.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?this.Suc=appResourceLoader.loadChunk("sharedComments"):this.Suc=this.tE.loadScript("sharedComments"));return this.Suc.then(()=>{b&&b();this.AFe||(this.bS&&this.bS.execute(n=>{n.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate",
"InitializeFloodgateServiceInCommentsPane")}),h&&h(),sharedComments.instantiate(this.fxg,this.Z0g,this.QSb,this.nod,this.FNg,this.uHg,this.Pm));this.AFe=!0})}}Object(r.a)(QN,"CommentActivationManager",null,[901]);class RN extends IE{constructor(b){super(b)}Iln(b){this.pjn(b)}hdo(b){this.zdj(b)}g_i(b){b=this.DGk(b);for(let h=0;h<this.nma.count;++h)Array.enqueue(this.nma.J(h).wka,b);this.QOa(!0)}DGk(b){const h=new nG;h.eventType=3;h.viewContainerVisibilityState=b;return h}kal(){const b=this.AMk();for(let h=
0;h<this.nma.count;++h)Array.enqueue(this.nma.J(h).wka,b);this.QOa(!0)}AMk(){const b=new nG;b.eventType=2;return b}}Object(r.a)(RN,"ViewContainerEventHost",IE,[825]);class SN{constructor(){this.actionBehavior=this.actionType=0}}Object(r.a)(SN,"CommentUIActionPayload",null,[]);class TN{constructor(b,h){this.ga=b;this.Gmb=h;this.ric=new gc.a;for(let n of this.Gmb)this.ric.Z(n.value.canvasActionId,n.key),b=n.value,b.delayActionsUntilRegistration||this.pa(b)}pa(b){b.withFlags?this.ga.gb(b.canvasActionId,
b.canvasContextId,Object(v.a)(this,this.n5g,"actionHandler"),97):this.ga.pa(b.canvasActionId,b.canvasContextId,Object(v.a)(this,this.n5g,"actionHandler"))}lOa(b,h){this.Gmb.xb(b)&&(this.Gmb.J(b).delayActionsUntilRegistration&&this.pa(this.Gmb.J(b)),this.Gmb.J(b).registeredCallback=h)}n5g(b,h,n,x,E){if(this.ric.xb(b)){var S=this.ric.J(b);if(!this.Gmb.xb(S))return 8;const ma=this.Gmb.J(S);if(ma.preCallback){const Fa=ma.preCallback(b,h,n,x,E);if(2!==Fa)return Fa}if(!ma.registeredCallback)return 1===
n?8:2;S=Object.assign(new SN,{actionType:S});1===n&&(S.actionBehavior=1);S=ma.registeredCallback(S);return ma.postCallback?ma.postCallback(S,b,h,n,x,E):S?32:8}return 2}}Object(r.a)(TN,"OfficeSharedCommentsActionHost",null,[860]);var tQ=d(307),$H=d(1526),UN=d(491);class JE{constructor(b){this.E4=b;this.lac=new Aa.a;this.LYa=new Aa.a;this.v1l();this.DWl=[new bh.a(Eh.a.wnh,Eh.a.Pyk),new bh.a(Eh.a.vnh,Eh.a.Oyk),new bh.a(Eh.a.mnh,Eh.a.Fyk),new bh.a(Eh.a.lnh,Eh.a.Eyk),new bh.a(Eh.a.ynh,Eh.a.Ryk),new bh.a(Eh.a.xnh,
Eh.a.Qyk)]}s1a(b){this.E4.s1a(b);this.Omn(b)}Tqf(b,h){return!!b&&!!b.objectId&&h.contains(C.a.Of(b.objectId))}e_a(b){b=Object(ja.a)(220,b);return!!b&&!!b.objectId}Omn(b){for(let h of this.DWl)b.classList.remove(h.className,h.CJc);b.classList.remove(Eh.a.gKf,Eh.a.Anh,Eh.a.nnh,Eh.a.znh,JE.Yag)}v1l(){const b=new Aa.a,h=new Aa.a;b.add(0,null);b.add(1,Eh.a.vnh);b.add(2,Eh.a.wnh);b.add(3,Eh.a.Anh);h.add(0,null);h.add(1,Eh.a.lnh);h.add(2,Eh.a.mnh);h.add(3,Eh.a.nnh);this.LYa.Z(1,b);this.LYa.Z(2,h);this.LYa.Z(3,
h);this.lac.add(0,null);this.lac.add(1,Eh.a.xnh);this.lac.add(2,Eh.a.ynh);this.lac.add(3,Eh.a.znh)}}JE.Yag="CommentImportant";Object(r.a)(JE,"CommentHighlightUtils",null,[]);class aI{constructor(){this.qzd=0;this.swb=null}}Object(r.a)(aI,"CommentGuidsInElementInfo",null,[]);class VN{constructor(){this.r2h=!1;this.Pja=this.aGb=null;this.SNa=this.oBb=0}}Object(r.a)(VN,"HighlightInfoForElement",null,[]);class bI{constructor(){this.K5h=this.M5h=this.L5h=-1;this.G3h=[];this.QYb=[];this.mLc=this.nLc=-1;
this.q$h=!1}}Object(r.a)(bI,"HighlightInfoForElementsInPara",null,[]);class WN{constructor(){this.a6f=this.YFf=null}}Object(r.a)(WN,"OnAnchorMouseOutData",null,[]);class XN{constructor(b,h,n,x,E,S,ma,Fa){this.sje=b;this.X7=h;this.Kj=n;this.r0=x;this.ga=E;this.Hb=S;this.sj=ma;this.QSa=this.$i=null;this.vOm=$a=>{if(!this.$i||this.r0.PNd)return!0;if($a=$a.vp){if(this.$i.Rz&&$a[0].toString()===this.$i.Rz.objectId)return!0;this.QSa&&$a[0].equals(this.QSa.a6f[0])?this.Hb.ef(this.QSa.YFf):(this.QSa&&(this.Hb.ef(this.QSa.YFf),
this.ga.Xb(Ra.a.Jud,2,this.QSa.a6f)),this.$i.Yp.r$h($a[0])&&!this.sj.en||this.ga.Xb(Ra.a.GWe,2,$a));this.QSa=null}return!0};this.uOm=$a=>{if(this.r0.PNd)return!0;const sb=$a.vp;sb&&($a=new We.a(2,1,0,()=>{this.ga.Xb(Ra.a.Jud,2,sb);this.QSa=null}),this.Hb.$b($a),this.QSa=Object.assign(new WN,{YFf:$a,a6f:sb}));return!0};this.Oui=$a=>{const sb=new We.a(2,1,0,()=>{if(this.$i&&!this.$i.Yp.Hy){var Jb=$a.vp;if(!Jb)Jb=ob.App.xa.Yo.xg,this.$i.Rz&&(!Jb||Jb.name!==xd.AFrame.qL&&Jb.name!==xd.AFrame.fr)&&this.$i.clearSelection();
else if(!this.$i.Rz||Jb.toString()!==this.$i.Rz.objectId)if(Jb=this.$i.Yp.nZ(Jb.toString()))Jb=Object.assign(new gv.a,{commentId:Jb.id,lO:!1,j3:1}),this.ga.Xb(ub.a.selectComment,2,Jb)}});this.Hb.$b(sb);return!1};Fa.execute($a=>{this.$i=$a})}Pfh(b,h,n,x){const E=new bI,S=[],ma=this.X7.e_a(h)?h.objectId:null;for(let sb=0,Jb=b.length;sb<Jb;sb++){var Fa=b[sb],$a=mk.g(Fa);const Sb=mk.d(Fa);Fa=new Lm.a;const oc=new VN;if($a){const Ic=new UN.a(mk.c);$a=this.IFh($a,ma,Ic);0<$a.length&&(this.Igo($a,n,Fa,oc,
ma,x),S.push(Object.assign(new aI,{qzd:sb,swb:Ic})))}Sb&&($a=this.IFh(Sb,ma),0<$a.length&&(this.Kgo($a,n,Fa,oc,E,ma,x,sb),this.cfo(S,$a,sb,oc)));0<n.count&&this.Lgo(h,n,oc,x);this.afo(S,oc);E.G3h.push(oc)}return E}kbh(b,h,n){let x=!1;for(let E=0,S=b.length;E<S;E++){const ma=b[E],Fa=h.G3h[E],$a=pl.a(ma);if(1!==$a&&2!==$a&&3!==$a)continue;const sb=3===$a||2===$a&&-1!==ma.className.indexOf(Eh.a.FLa);this.X7.s1a(ma);this.A2j(ma,Fa,sb,x);this.t1j(ma,E,$a,Fa,h,n);this.u1j(ma,E,h,Fa);x=sb}}IFh(b,h,n=null){const x=
[];for(let E=0;E<b.length;E++)this.sje.D0i(b[E],b[E].toString()===h)&&(x.push(b[E]),n&&n.add(b[E]));return x}Igo(b,h,n,x,E,S){var ma;let Fa=!1,$a=!1;for(let Jb of b){h.add(Jb);n.add(Jb);var sb=Jb.toString();sb===E?(sb=S?1:2,x.SNa=sb,x.oBb=sb):this.Tqf(this.$i.Rz,h)&&(sb===(null===(ma=this.$i.Rz)||void 0===ma?void 0:ma.objectId)&&($a=!0),Fa=!0)}0<b.length&&!x.SNa&&(x.SNa=$a?1:3,x.oBb=Fa?1:3)}Kgo(b,h,n,x,E,S,ma,Fa){var $a,sb;const Jb=new UN.a(mk.c);ma=ma?1:2;let Sb=!1;for(let oc of b){const Ic=oc.toString();
h.contains(oc)||(Ic===S?E.K5h=Fa:(E.L5h=Fa,x.SNa=3,(null===($a=this.$i.Rz)||void 0===$a?void 0:$a.objectId)===Ic&&(E.M5h=Fa,x.SNa=1)),Jb.add(oc));Ic===(null===(sb=this.$i.Rz)||void 0===sb?void 0:sb.objectId)&&(Sb=!0);h.remove(oc);n.contains(oc)&&this.Jgo(x,oc,Ic,S,ma);Ic===S&&(x.SNa=ma)}0<b.length&&!x.SNa&&(x.SNa=Sb?1:3);0<Jb.count&&E.QYb.push(Object.assign(new aI,{qzd:Fa,swb:Jb}))}cfo(b,h,n,x){0!==b.length&&(h.forEach(E=>{for(let S=b.length-1;0<=S;S--){const ma=b[S];if(ma.swb.contains(E)){ma.qzd===
n&&(x.Pja?x.Pja.push(E):x.Pja=[E]);ma.swb.remove(E);break}}}),b=b.filter(E=>0<E.swb.count))}Lgo(b,h,n,x){var E,S;this.Tqf(b,h)?n.oBb=x?1:2:n.oBb||(n.oBb=null!=(null===(E=this.$i.Rz)||void 0===E?void 0:E.objectId)&&h.contains(C.a.Of(null===(S=this.$i.Rz)||void 0===S?void 0:S.objectId))?1:3);n.aGb||(n.aGb=[]);for(let ma of h)n.aGb.push(ma)}afo(b,h){if(0<b.length){h.Pja||(h.Pja=[]);for(let n of b[b.length-1].swb)h.Pja.push(n)}}Jgo(b,h,n,x,E){b.r2h=!0;b.aGb||(b.aGb=[]);b.aGb.push(h);n===x&&(b.oBb=E)}Tqf(b,
h){return!!b&&!!b.objectId&&h.contains(C.a.Of(b.objectId))}A2j(b,h,n,x){!h.SNa||n||x||((n=this.X7.lac.J(h.SNa))&&b.classList.add(n),h.r2h&&b.classList.add(Eh.a.gKf))}t1j(b,h,n,x,E,S){x=this.X7.LYa.J(n).J(x.oBb);h<E.K5h?x=S?this.X7.LYa.J(n).J(1):this.X7.LYa.J(n).J(2):h<E.L5h&&!x&&(x=h<E.M5h?this.X7.LYa.J(n).J(1):this.X7.LYa.J(n).J(3));x&&(h=E.q$h,b.classList.add(x),h&&b.classList.add(JE.Yag))}u1j(b,h,n,x){x.Pja||(x.Pja=this.kkl(h,n)||x.aGb);h=null;x.Pja&&0<x.Pja.length&&(this.Kj.mb(kb.a.iX,b,this.vOm,
x.Pja),this.Kj.mb(kb.a.rfa,b,this.uOm,x.Pja),h=x.Pja[0]);this.Kj.mb(kb.a.click,b,this.Oui,h);this.Kj.mb(kb.a.QI,b,this.Oui,h)}kkl(b,h){for(;0<h.QYb.length&&h.QYb[0].qzd===b;)h.QYb.splice(0,1);if(0<h.QYb.length){b=[];for(let n of h.QYb[0].swb)b.push(n);return b}return null}}Object(r.a)(XN,"AllMarkupModeHighlightChangeHandler",null,[178]);var YN=d(1438);class ZN extends YN.a{constructor(b){super(100,25);this.oic=new Aa.a(0);this.Etj=6E4;this.K$k=()=>{const h=this.oic.keys;if(h.length){var n="";for(let x=
0;x<h.length;x++)n+=h.J(x)+":"+this.oic.J(h.J(x))+";";this.ina(n);this.oic=new Aa.a(0)}};this.Rmb=new Qa.a;this.Rmb.add(1);this.Rmb.add(6);this.Rmb.add(2);this.Rmb.add(4);this.Rmb.add(10);this.Rmb.add(11);this.Xe=b;b.MOf&&window.setInterval(this.K$k,this.Etj)}pDa(b){this.Xe.gbo&&this.Xe.MOf&&(this.Rmb.contains(b)?this.Hen(b):this.ina(b+""))}Hen(b){this.oic.Z(b,this.oic.Ey(b,0)+1)}}Object(r.a)(ZN,"CommentActionInTypingRecorder",YN.a,[228]);class $N{static Ynn(b){b&&b.atmention&&delete b.atmention.isCurrentUser;
return b}}Object(r.a)($N,"DeltaFormatHelpers",null,[]);class cI{constructor(){this.optional=this.attributes=null}}Object(r.a)(cI,"Operation",null,[]);class dI extends cI{constructor(){super();this.insert=null}}Object(r.a)(dI,"DeltaOperation",cI,[]);class aO{constructor(){this.ops=null}}Object(r.a)(aO,"Delta",null,[]);var bO=d(509),eI=d(1160),fI=d(1691);class yC extends fI.ACommentFormatTranslator{constructor(b,h){super(b);this.Ie=h}g4f(b){const h=new di.a;for(let n=0;n<b.length;n++){const x=b[n];
x.lCb=!0;this.yak(h,x);h.Kea("\n")}return[h.cHc()]}W6n(b,h){b=di.a.V1b(b[0]);b=this.V5m(b);const n=new Qa.a;let x=0,E=null,S=null;for(;x<b.ops.length;){const ma=b.ops[x];E||(E=eI.a.instance.createInstance(393230),E.lCb=!0,E.lh(ic.a.Mc,Ub.a.JF()),h(E),E.qa.clear(),E.iva(""));"\n"===ma.insert?(S=this.vvf(E,S),this.$Nn(E),n.add(E),E=null):S=this.vrm(E,ma,S);x++}return n.toArray()}$Nn(b){if(Of.a.instance.J(6)){var h=b.xhh();for(let n=0;n<h;n++)b.wordRunProperties.Fq.Z(n,yC.tJm),b.wordRunProperties.Zs.Z(n,
yC.iCf)}}vvf(b,h){var n=b.Mzd();n.cp===b.characterData.length?n.Wh=!0:(n=Object.assign(new NB.a(b,b.characterData.length),{Wh:!0}),b.qa.add(n));n=b.qa.last;if(h){h=!!h.Bx;const x=this.Ioh(b,n,!h,h,null);n.formatting=x;h&&(b=this.Goh(b,n),n.oT=b.Aj);n.vl=!0;h=null}n.cp||n.formatting||(n.formatting=new yj.a(n,C.a.nil));return h}vrm(b,h,n){const x=b.Mzd(),E=!!h.attributes&&!!h.attributes.link,S=!!h.attributes&&!!h.attributes.atmention,ma=this.Ioh(b,x,E,S,h);x.formatting=ma;n&&(n.Bx&&(n=this.Goh(b,x),
x.oT=n.Aj),x.vl=!0,n=null);if(E||S)this.Wqm(x,b,h),n=x.hyperlink;b.iva(b.characterData+h.insert);return n}Goh(b,h){h=new yj.a(h,C.a.create());let n=this.Jwd();n.setValue(ic.a.lDb,!0);n=b.Nc.KQ(n);h.Aj=n.id;return h}Ioh(b,h,n,x,E){h=new yj.a(h,C.a.create());let S=eI.a.instance.createInstance(1179649);if(n||x)S.setValue(ie.a.xA,!0),S.setValue(ie.a.t6,!0),n&&this.SFn(b,S);this.Xe.uvb&&E&&E.attributes&&this.MLn(E.attributes,S);S=b.Nc.KQ(S);h.Aj=S.id;return h}SFn(b,h){Of.a.instance.J(8)&&(b=this.Ie.Nx(b))&&
(b=b.uh(jh.StyleReader.iMb))&&h.setValue(Th.a.kB,b.id)}MLn(b,h){this.dJb(b.weight>=di.a.Iyf,h,ie.a.bold,!0);this.dJb(b.italic,h,ie.a.italic,!0);this.dJb(b.underline,h,ie.a.underline,!0);this.dJb(b.underline,h,ie.a.underlineType,Zl.a.pLb);this.dJb(b.strikethrough,h,ie.a.strikethrough,!0);if(this.Xe.wCb){if(Eo.a.ZOc(b.highlight)){var n=Eo.a.ieb(b.highlight);this.dJb(!!b.highlight,h,ie.a.highlight,Eo.a.hga(n))}Eo.a.ZOc(b.color)&&(n=Eo.a.ieb(b.color),this.dJb(!!b.color,h,ie.a.fontColor,Eo.a.hga(n)))}}dJb(b,
h,n,x){b&&h.setValue(n,x)}Wqm(b,h,n){if(n.attributes&&n.attributes.atmention){var x=nh.HyperlinkReader.kLa(n.attributes.atmention.email);n=n.optional&&n.optional.atmention&&n.optional.atmention.contentId?n.optional.atmention.contentId:yC.pdl(1===n.attributes.atmention.resolveState);x=new bO.a(b,x,!0,void 0,void 0,void 0,n);this.vFk(x,h.Nc);b.hyperlink=x}else h=nh.HyperlinkReader.kLa(n.attributes.link),x=this.eIk(b.paragraph.qa.first),b.hyperlink=new bO.a(b,h,!1,x.Aj)}eIk(b){let h=this.tth();h=b.paragraph.Nc.KQ(h);
b=new yj.a(b,C.a.nil);b.Aj=h.id;return b}vFk(b,h){var n=String.format(' HYPERLINK "{0}"',b.url),x=b.Bx;const E=this.Jwd();E.setValue(ic.a.gq,15);E.setValue(ic.a.Bx,x);E.setValue(ic.a.sMa,!0);E.setValue(ic.a.fieldInstruction,n);b.Qqa(h.KQ(E).id);x=this.Jwd();x.setValue(ic.a.gq,47);x.setValue(ic.a.fieldInstruction,n);b.Qqa(h.KQ(x).id);n=this.Jwd();n.setValue(ic.a.gq,16);b.Qqa(h.KQ(n).id)}tth(){const b=eI.a.instance.createInstance(1179649);b.setValue(ie.a.xA,!0);b.setValue(ie.a.t6,!0);b.setValue(ie.a.isHidden,
!0);return b}Jwd(){const b=this.tth();b.setValue(ie.a.E7,!0);return b}V5m(b){const h=new Qa.a;for(let n=0;n<b.ops.length;n++){const x=b.ops[n];x.optional=$N.Ynn(x.optional);if(-1!==x.insert.indexOf("\n")&&"\n"!==x.insert){const E=x.insert.split("\n");for(let S=0;S<E.length;S++)if(n!==b.ops.length-1||S!==E.length-1||E[S])h.add(Object.assign(new dI,{insert:E[S],attributes:x.attributes,optional:x.optional})),S!==E.length-1&&h.add(Object.assign(new dI,{insert:"\n"}))}else h.add(x)}return Object.assign(new aO,
{ops:h.toArray()})}static pdl(b){return fI.ACommentFormatTranslator.aek+na.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+(b?"Z":"")}}yC.tJm=0;yC.iCf=0;Object(r.a)(yC,"CommentDeltaFormatTranslator",fI.ACommentFormatTranslator,[]);var uA=d(1511);class cO{constructor(b,h,n){this.ek=b;this.K=h;this.rS=n}get userPrincipalName(){return this.K.lb("UserPrincipalName")}xB(b){return this.ek.xB(b)}Z8l(b){b=this.ek.xB(b);return b?!b.done:(w.ULS.sendTraceTag(521426529,327,10,"CommentFilterActor : Comment Not in Model. "),
!1)}OMc(b){return this.ek.OMc(b)}isCurrentUserMentioned(b){var h,n;b=this.ek.akl(b);for(const x of b){b=di.a.V1b(x.text[0]);let E=0;for(;b.ops&&E<b.ops.length;){const S=null===(n=null===(h=b.ops[E])||void 0===h?void 0:h.attributes)||void 0===n?void 0:n.atmention;if(S&&S.email===this.userPrincipalName)return!0;E++}}return!1}ISc(){this.rS.fna("OnContentFilterUpdate")}}Object(r.a)(cO,"CommentFilterActor",null,[225]);var uQ=d(863),oG=d(591);class KE{constructor(b,h,n,x,E,S,ma,Fa,$a,sb){this.ii=b;this.Hb=
h;this.Ih=n;this.EQa=x;this.Xe=E;this.sj=S;this.f4=ma;this.Ch=Fa;this.sS=$a;this.lM=sb;this.Uob=null;this.JIe=0;this.xdd=!1;this.Qhd=0;this.ALb=this.V_c=this.jwg=this.tpc=this.aub=!1;this.updateViewportInfo=()=>{this.sS.xZf()&&this.Ch.updateViewportInfo(this.xdd,this.DHf)};this.yhb=()=>{this.Ch.eja.uta()&&(this.tbc(this.Ch.eja.Jc),this.Ch.eja.Ebc(this.yhb))};this.DHf=()=>{this.I3a();this.sS.CHf()};this.m1f=()=>{!this.aub&&this.sS.RYf()&&(this.Qhd=this.QKe.scrollTop,this.aub=!0,this.EQa.pDa(2))};this.kPf=
(Jb,Sb)=>{this.aub&&(Jb=this.QKe.scrollTop,Jb-this.Qhd?(this.tpc||Sb.vce||this.updatePosition(),this.tpc||1!==Sb.vce||this.I3a(),this.AOe(Jb),this.sS.yGf()):this.tpc=this.aub=!1)};this.QKe=this.Ch.zba;this.Qfa=oG.a.jYd;this.Js=this.Ch.Js;this.Ch.woh()}get uNd(){return this.sS.dsf()}get Qfa(){return this.Ch.Qfa}set Qfa(b){this.Ch.Qfa=b}get dch(){return"1"===this.Js.gE.style.opacity}Q_i(b){this.V_c||(this.V_c=!0,this.Ch.PDi(),this.Uob=b(this.Js.rBa,this.Ch.NMi,()=>{this.updatePosition()}),this.Ch.Zki(this.Uob),
this.sS.initialize(this.Uob,this),this.Ch.initialize(this.Uob,this.sS.Bhb),this.Ch.oKi(),this.Ch.K_i(),this.Ch.L_i(),this.Ch.P_i(this.sS.IRe,this.sS.dXd,this.sS.cXd),this.UPf())}c_c(){}G6d(){return this.Ch.I0i()}setInitialActiveContainerId(b,h,n=null){this.Ch.setInitialActiveContainerId(b,0,n)}updatePosition(){if(!this.ALb&&this.uNd&&this.ii.I3b()){var b=rd.a.lf()-this.JIe<oG.a.ygj;b||this.xdd||this.I3a(b)}}LQe(){this.I3a()}ROa(b,h,n){this.Ch.ROa(b,h,n)}deleteContainer(b,h,n=!1){this.Ch.deleteContainer(b,
h,()=>{this.ii.kjf()||this.Ch.Tjf();this.sS.LEf()},n)}addContainer(b,h,n){this.Ch.addContainer(b,h,n,this.Ch.gf,this.sS.cIc,this.sS.yDf)}CCi(b){this.ALb=!0;b();this.ALb=!1}rXc(b,h,n){this.Ch.rXc(b,h,n)}BYb(){this.Ch.BYb()}Tgj(){const b="1"===this.Js.gE.style.opacity;switch(!0){case b&&!this.ii.kjf():this.Ch.Tjf();break;case !b&&this.ii.kjf():this.Ch.pec()}}s4f(b=!0){this.sS.tZf&&this.Ch.G$i(b)}static eOh(b,h=null){const n=new Jc.a;for(let x of b)x.Rf||x.Qq!==Zk.a.beingCreated&&(!h||h(x))&&KE.l0j(n,
x.objectId,x);return n}static l0j(b,h,n){let x;({value:x}=b.Dc(h,x)).returnValue||(x=[],b.Z(h,x));x.push(n)}tbc(b){b&&(b.jja(()=>{this.updateViewportInfo()}),this.Qhd=this.QKe.scrollTop,b.m9g(this.m1f),b.n9g(this.kPf))}UPf(){this.Ch.gf?this.tbc(this.Ch.gf):this.Ch.eja?this.Ch.eja.vWb(this.yhb):w.ULS.sendTraceTag(523011085,327,15,"Workspace undefined, failed to register page view handlers")}AOe(b){this.Js.gE.style.top=b-this.Qhd+"px";this.tpc=!1}I3a(b=!1){b=new We.a(0,1,0,()=>{this.B3e()},129,void 0,
!b);this.Hb.$b(b);this.xdd=!0;this.tpc=this.aub;this.EQa.pDa(10)}kff(b){return this.Ch.jWa({contentAnchorPositions:b.contentAnchorPositions})}B3e(){this.xdd=!1;if(this.Js.rBa&&this.Uob&&this.ii.I3b()){this.Ch.$zd();var b=0;this.Ih.Pd(()=>{b=this.Ch.gEd()},"FCM:UP:GET");var h=null,n=null;this.Ih.Pd(()=>{const x=this.sS.LMh(b,this.Ch.gf);h=x.kzk;n=this.kff(x)},"FCM:UP:GP");this.Ih.Pd(()=>{this.aub?(this.Ch.sBh(n),this.aub=!1):this.Uob.emitEvent(3,n);this.f4.j1d()},"FCM:UP:RC");this.Uob.setFirstCommentRenderDone();
"0"===this.Js.gE.style.opacity&&0<h.count&&!this.sj.en&&this.Ih.Pd(()=>{this.Ch.pec()},"FCM:UP:SFC");this.Xe.gib&&!this.jwg&&0<h.count&&(yo.a.h1(this.Hb,this.Ch.Ali,rw.a.zli),this.jwg=!0);this.JIe=rd.a.lf();this.EQa.pDa(6)}else this.JIe=rd.a.lf()}}Object(r.a)(KE,"FloatingCommentManager",null,[168,169]);var Py;(function(b){b[b.MHo=0]="singleHint";b[b.rEo=1]="multiHint";b[b.AGo=2]="resolvedHint";b[b.sEo=3]="multiResolvedHint";b[b.entryPoint=4]="entryPoint";b[b.unknown=void 0]="unknown"})(Py||(Py={}));
Object(r.b)("CommentIconType",Py);d(1073);const vQ={[1]:"ShowAllCommentsSelected_16x16x32",[0]:"SharedCommentBubbleSelected_16x16x32",[2]:"MarkCommentDone1Selected_16x16x32",[3]:"ShowAllCommentsResolvedSelected_16x16x32",[4]:"NewComment_16x16x32",[Py.unknown]:""},wQ={[1]:"ShowAllCommentsHover_16x16x32",[0]:"SharedCommentBubbleHover_16x16x32",[2]:"MarkCommentDone1Hover_16x16x32",[3]:"ShowAllCommentsResolvedHover_16x16x32",[4]:"NewComment_16x16x32",[Py.unknown]:""},xQ={[1]:"ShowAllComments_16x16x32",
[0]:"SharedCommentBubble_16x16x32",[2]:"MarkCommentDone1_16x16x32",[3]:"ShowAllCommentsResolved_16x16x32",[4]:"NewComment_16x16x32",[Py.unknown]:""},Hz=(b,h)=>{h===Py.unknown&&dO(b);switch(b){case 1:return vQ[h];case 2:return wQ[h];case 3:return xQ[h];default:return""}},dO=b=>{w.ULS.sendTraceTag(545056465,327,15,`Unknown hint IconType with state : ${b}`)},FB=(b,h)=>{Mg.a("renderIcon")&&appChrome.api.renderIcon(b,h)};class cx{}cx.a4h=16;cx.QWl=1;cx.zlf=20;cx.Vkj=2;Object(r.a)(cx,"CommentIconConstants",
null,[]);class eO{constructor(){this.Eud=0;this.oyc=!1}}Object(r.a)(eO,"CommentHintCensus",null,[]);const GB=(b,h)=>{h===Py.unknown&&dO(b);switch(b){case 1:return yQ[h];case 2:return zQ[h];case 3:return AQ[h];default:return""}},AQ={[1]:"ShowAllComments_16",[0]:"SharedCommentBubble_16",[2]:"MarkCommentDone1_16",[3]:"ShowAllCommentsResolved_16",[4]:"NewComment_16",[Py.unknown]:""},zQ={[1]:"ShowAllCommentsHover_16",[0]:"SharedCommentBubbleHover_16",[2]:"MarkCommentDone1Hover_16",[3]:"ShowAllCommentsResolvedHover_16",
[4]:"NewComment_16",[Py.unknown]:""},yQ={[1]:"ShowAllCommentsSelected_16",[0]:"SharedCommentBubbleSelected_16",[2]:"MarkCommentDone1Selected_16",[3]:"ShowAllCommentsResolvedSelected_16",[4]:"NewComment_16",[Py.unknown]:""};class fO{constructor(b,h,n,x,E){this.ixg=b;this.PVb=n;this.Pzj=x;this.SVa=E;this.KIa=-1;this.rje=new Set(h)}get y(){if(-1!==this.KIa)return this.KIa;const b=Sys.UI.DomElement.getBounds(this.ixg),h=this.ixg.getClientRects();return this.KIa=0<h.length&&h[0]?this.Pzj?b.y/this.PVb+
cx.Vkj:Math.floor(h[0].height)/(2*this.PVb)+b.y/this.PVb-cx.a4h/2:0}get SYb(){return Array.from(this.rje)}e4j(b){this.rje=new Set([...this.rje,...b])}}Object(r.a)(fO,"HintInfo",null,[237]);class sw extends zo.a{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic){super();this.Xe=b;this.gg=h;this.Kj=n;this.xD=x;this.ga=E;this.ii=sb;this.Ioa=Jb;this.EQa=Sb;this.sj=oc;this.txj=Ic;this.lkc=new Map;this.S6a=this.e9a=null;this.Vfc={Xfc:-1,wCf:-1}}AJb(b){let h=!1;ob.App.qkj&&b.ic.Ji?oo.a.instance.Pd(()=>{h=
mk.m(b,!0)},"CHA:SCIVE"):oo.a.instance.Pd(()=>{h=mk.l(b.htmlElement,!0)},"CHA:SCI");return h}Swb(b){const h=this.zoom,n=b.S6,x=b.oBa,E=b.Pvb(1,cx.zlf,h);this.EQa.pDa(1);let S=[];x.forEach((ma,Fa)=>{const $a=b.w$[Fa].y/h,sb=Sb=>this.gIk(n,Sb,Sb.y-$a,E),Jb=()=>sw.ZJk(n);ma=this.Xe.xUd?this.tIk(this.vQh(ma,Fa),sb,Jb):this.sIk(this.vQh(ma,Fa),sb);S=S.concat(ma)});return S}sIk(b,h){const n=[];for(let x of b){b=h(x);for(let S of x.SYb)this.lkc.set(S.toString(),b);const E=this.Gef(x.SYb);this.Y6f(E,b);b.SVa=
x.SVa;n.push(b)}this.mBb(this.S6a);this.MYa(this.e9a);return n}tIk(b,h,n){n=n();const x=[];for(let E of b){b=h(E);for(let ma of E.SYb)this.lkc.set(ma.toString(),b);const S=this.Gef(E.SYb);this.Y6f(S,b);null==n.SVa&&(n.SVa=E.SVa);n.appendChild(b);x.push(b)}this.mBb(this.S6a);this.MYa(this.e9a);return[n]}RXk(b,h){b=null===b||void 0===b?void 0:b.querySelectorAll("."+sw.vAi);return 0<(null===b||void 0===b?void 0:b.length)&&b[0]&&(b=Array.from(b[0].querySelectorAll(sw.Syk)))?this.cBn(b,h):!1}cBn(b,h){let n=
0,x=b.length-1,E;for(;x>=n;){E=Math.floor((x-n)/2+n);const S=b[E];if(S.offsetTop>=h-2&&S.offsetTop<=h+2)return!0;S.offsetTop>h+2?x=E-1:n=E+1}return!1}Gef(b){var h,n;let x=0,E=0;for(let S of b)if(this.ii.erf(S)){if(this.Xe.contentFilterApiEnabled&&this.sj.en&&(b=this.ii.nZ(S.toString()),null===(n=(h=this.txj).isContentInFilteredContent)||void 0===n||!n.call(h,b.id)))continue;this.ii.r$h(S)?E+=1:x+=1}h=new eO;h.Eud=x+E;h.oyc=0===x;return h}Igc(b){if(b=this.lkc.get(b.objectId)){var h=mk.g(b);h=this.Gef(h);
this.Y6f(h,b)}}Y6f(b,h){let n,x;if(this.Xe.contentFilterApiEnabled&&0===b.Eud)h.style.display="none";else if(1===b.Eud?(n=b.oyc?2:0,x=b.oyc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleActiveLabel):1<=b.Eud&&(n=b.oyc?3:1,x=b.oyc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiActiveLabel),h.style.display="block",this.Xe.DJa){if(b=h.firstElementChild)this.JXi(b,
n),b.title=x+". "+b.title,FB(GB(3,n),b)}else if(b=h.firstElementChild)this.JXi(b,n),b.alt=x,b.className=Tg.getImageClassWithCluster(u.AFrameworkApplication.bQ,Hz(3,n))}JXi(b,h){b.title=WordEditorIntl.WordEditorStrings.L_CommentHintIcon_UserActionStatement;hi.a.Hl(b,sw.Dnh,h)}vQh(b,h){b=this.hIk(b,h);b.sort((n,x)=>n.y-x.y);return this.DFm(b)}hIk(b,h){const n=[],x=this.Xe.uq,E=this.zoom;b=mk.f(b,!0);for(let S=0,ma=b.length;S<ma;S++){const Fa=b[S],$a=mk.g(Fa);$a&&n.push(new fO(Fa,$a,E,x,h))}return n}DFm(b){let h=
null;const n=[];for(let x=0;x<b.length;x++)h&&Math.abs(b[x].y-h.y)<cx.a4h+cx.QWl?h.e4j(b[x].SYb):(h=b[x],n.push(h));return n}gIk(b,h,n,x){const E=b.Ig.ownerDocument,S=E.createElement("div");S.className=sw.Bnh;S.style.top=n+"px";S.style.left=x+"px";S.style.right="auto";S.style.zIndex="40";hi.a.Hl(S,Eh.a.LAc,h.SYb);this.Xe.DJa?(h=E.createElement("span"),this.H2c(h,S),FB(GB(3,0),h),this.HA(h,b)):(h=E.createElement("img"),this.H2c(h,S),h.src=u.AFrameworkApplication.mr,h.className=Tg.getImageClassWithCluster(u.AFrameworkApplication.bQ,
Hz(3,0)),h.alt=CommonUIStrings.l_CommentHintTooltip+WordEditorIntl.WordEditorStrings.L_AccHelpShortcutMsgToMoveFocusCommentToDocument,this.HA(h,b));return S}H2c(b,h){b.title=CommonUIStrings.l_CommentHintTooltip;b.setAttribute("role","button");h.appendChild(b)}HA(b,h){this.gg.jE(kb.a.click,b,this.XQm.bind(this),h);this.gg.mb(kb.a.KC,b,this.$Qm.bind(this));this.Kj.mb(kb.a.iX,b,this.bRm.bind(this));this.Kj.mb(this.Xe.DJa?kb.a.iK:kb.a.rfa,b,this.aRm.bind(this));this.xD.mb(b,this.ZQm.bind(this))}static ZJk(b){b=
b.Ig.ownerDocument.createElement("div");b.className=sw.vAi;return b}ZQm(){return!0}$Qm(){return!0}XQm(b){const h=mk.g(b.Bv.parentNode);b.eventName===kb.a.QI&&(this.Ioa.yVe(),this.ulh());this.ga.Xb(Ra.a.Cnh,2,h);return!0}bRm(b){this.CAa(this.S6a)!==b.Bv&&(b=mk.g(b.Bv.parentNode),this.ga.Xb(Ra.a.GWe,2,b));return!0}aRm(){this.ga.processAction(Ra.a.Jud,2);return!0}mBb(b){this.ulh();this.S6a=b;this.tbk()}tbk(){this.ubk(this.CAa(this.S6a),this.CAa(this.e9a))}MYa(b){this.Muk();this.e9a=b;if(b=this.CAa(this.e9a)){const h=
this.WEd(b);this.Xe.DJa?FB(GB(1,h),b):b.className=Tg.getImageClass(Hz(1,h))}}CAa(b){if(!b)return null;let h=null;if(b=this.ii.nZ(b))if(b=b.Rf?this.ii.xB(b.Rf):b)h=b.objectId;return h&&this.lkc.has(h)?this.lkc.get(h).firstChild:null}ulh(){this.Ouk(this.CAa(this.S6a),this.CAa(this.e9a))}Ouk(b,h){if(b){const n=this.WEd(b);h=b===h?1:3;this.Xe.DJa?FB(GB(h,n),b):b.className=Tg.getImageClass(Hz(h,n));this.S6a=null}}ubk(b,h){b&&(b.title=0<this.Vfc.wCf&&1<this.Vfc.Xfc?CommonUIStrings.l_CommentHintTooltip+
String.format(CommonUIStrings.l_CommentHintNthOfTotal,this.Vfc.wCf,this.Vfc.Xfc):CommonUIStrings.l_CommentHintTooltip,h!==b&&(h=this.WEd(b),this.Xe.DJa?FB(GB(2,h),b):b.className=Tg.getImageClass(Hz(2,h))))}Muk(){var b=this.CAa(this.S6a);const h=this.CAa(this.e9a);if(h){const n=this.WEd(h);b=b===h?2:3;this.Xe.DJa?FB(GB(b,n),h):h.className=Tg.getImageClass(Hz(b,n));this.e9a=null}}WEd(b){return hi.a.Eb(b,sw.Dnh)}}sw.Bnh="clip16x16 HintContainer";sw.Syk=".clip16x16.HintContainer";sw.vAi="OutlineElementHintMargin";
sw.Dnh="CommentIconType";Object(r.a)(sw,"CommentHintActor",zo.a,[219]);var gO=d(965);class hO extends gO.a{constructor(b,h,n,x,E,S,ma,Fa,$a,sb){super();this.ti=b;this.gr=h;this.ek=n;this.taskManager=x;this.dpd=E;this.rS=S;this.Ch=ma;this.getSelectedText=Fa;this.tso=$a;this.Ai=sb;this.uSc=()=>{};this.aWd=()=>{};this.Atg=!1;this.grk={[0]:()=>this.Ewh(),[1]:()=>this.tec.LQe(),[2]:()=>this.Ewh()};this.CHf=()=>{this.dpd.pDa(11)};this.IRe=Jb=>{if(this.gr.uvb)for(let Sb of mk.s)Jb.bindAction(mc.KeyInputManager.uF(Sb),
ub.a.oTe)};this.dXd=()=>{this.aWd()};this.cXd=(Jb,Sb)=>{if(Jb.name!==xd.AFrame.fr&&Sb){var oc=this.ek.Hs?this.ek.Hs.id:"";this.ti.CFb||(this.ti.CFb=yo.a.h1(this.taskManager,()=>{this.uSc(oc)}))}};this.Gyi=()=>{};this.Bhb=()=>{this.C2i()};this.yDf=(Jb,Sb)=>{0===Sb&&(this.rS.j1d(),this.dpd.pDa(0))};this.LEf=()=>{this.dpd.pDa(5)};this.cIc=Jb=>{let Sb=0;const oc=this.ek.aT();for(let Ic=0;Ic<oc.length;Ic++){if(oc[Ic].Rf||oc[Ic].done)continue;if((oc[Ic].Qq===Zk.a.beingCreated?oc[Ic].Cy.draftId:oc[Ic].id)===
Jb.contentId)break;const gd=this.Jw.getContentAnchorPosition(oc[Ic].id);!gd||4<Math.abs(Jb.anchorTop-gd.anchorTop)||Sb++}return Sb};this.bui=()=>{this.rS.j1d()};this.yGf=()=>{this.dpd.pDa(2)};this.C2i=()=>{if(!this.Atg&&this.Ch.zba){const Jb=this.Ch.zba.getElementsByClassName(sw.Bnh);for(let Sb=0;Sb<Jb.length;Sb++)Jb[Sb].style.opacity="1";this.Atg=!0}}}get tZf(){return this.sZ()}get E3e(){return this.tso.BXh()}initialize(b,h){this.Jw=b;this.tec=h;this.AWc()}NHn(b,h){this.aWd=b;this.uSc=h}UMh(b,h){return{YUa:this.Lkl(b,
h),containerContentByType:{}}}LMh(b,h){const n=KE.eOh(this.ek.aT(),this.ek.gta),x=[],E=mk.e(!0);var S=this.ek.aT();h=this.W7m(h,S,n);!h.oLf&&h.contentAnchorPosition&&(x.push(h.contentAnchorPosition),h.contentAnchorPosition=null);for(S=0;S<E.length;S++){const ma=E[S],Fa=mk.g(ma);if(Fa)for(let $a=0;$a<Fa.length;$a++){const sb=this.getContentAnchorPosition(b,n,ma,Fa[$a]);sb&&(x.push(sb),h.oLf&&h.contentAnchorPosition&&sb.contentId===h.oLf.id&&(x.push(h.contentAnchorPosition),h.contentAnchorPosition=
null))}}h.contentAnchorPosition&&x.splice(0,0,h.contentAnchorPosition);return{kzk:n,contentAnchorPositions:x}}dsf(){var b;return!(null===(b=this.Jw)||void 0===b||!b.getAreContainersEnabled())}sZ(){return this.ek.I3b()}RYf(){return this.sZ()}y_c(){return this.sZ()}xZf(){return this.Jw&&this.Ch.zba&&this.sZ()}vyi(b){0!==b&&this.uSc(this.ek.Hs?this.ek.Hs.id:"")}getContentAnchorPosition(b,h,n,x){let E=null;return({value:E}=h.Dc(x.toString(),E)).returnValue?(h=E[0])&&!h.Rf?Object.assign(Object.assign({},
new uQ.a),{anchorTop:(oG.a.iHc(n)-b)/this.Ch.dka,anchorLeft:0,containerContentType:0,contentId:h.id}):null:null}W7m(b,h,n){var x,E;const S={};"CREATE"===(null===(E=null===(x=this.ek.Hy)||void 0===x?void 0:x.Cy)||void 0===E?void 0:E.sessionType)&&(x=this.Ch.zba.querySelectorAll(mk.b),b=this.Ch.vKh((0<x.length?x[0]:null)||this.getSelectedText(),this.ek.Hy.Cy.draftId,0,b),S.oLf=this.wBl(h,n),S.contentAnchorPosition=b);return S}wBl(b,h){var n=Array.indexOf(b,this.ek.Hy);for(--n;-1<n;n--)if(h.xb(b[n].objectId))return b[n]}Lkl(b,
h){return this.LMh(b,h).contentAnchorPositions}AWc(){this.rS.Zfa("OnAfterTrackChangeMarkupViewChange",(b,h)=>{if(h)this.grk[h.Oi]()})}Ewh(){const b=mk.i();if(0!==b.length){var h=KE.eOh(this.ek.aT()),n=this.ek.MJ;for(let x=0;x<b.length;x++){const E=mk.g(b[x]);for(let S=0;S<E.length;S++){let ma;({value:ma}=h.Dc(E[S].toString(),ma)).returnValue&&(ma.forEach(Fa=>{var $a;Fa&&!Fa.Rf&&(this.tec.deleteContainer(Fa.id,0,!1),(null===($a=n.Rz)||void 0===$a?void 0:$a.id)===Fa.id&&n.clearSelection())}),this.Ai.Jg(xd.AFrame.Xp))}}}}}
Object(r.a)(hO,"CommentFloatingContainerActor",gO.a,[224]);class iO extends sg.a{constructor(b,h,n,x,E,S,ma,Fa,$a){super();this.MJj=b;this.p5a=h;this.sje=n;this.Ih=E;this.X7=Fa;this.f4=$a;this.$i=null;this.Oi=1;x.execute(sb=>{this.$i=sb});this.spa=[];this.mkc=new Xn.ScriptSharpLegacyMap;this.cin(S,ma);this.AWc()}get Qi(){return this.MJj.value}get commentEditor(){return this.p5a}get qla(){return!!this.$i}get nBb(){return 0}get oeb(){return this.spa}get gGg(){return this.mkc.xb(this.Oi)?this.mkc.J(this.Oi):
this.mkc.J(0)}e_a(b){return this.X7.e_a(b)}ydb(b,h){if(b=Object(ja.a)(220,b))for(let n of this.n8m(b))h.add(n)}BNa(b,h){this.qla&&this.Ih.Pd(()=>{this.nTm(b,h)},"CHA:OPHC")}nTm(b,h){if(this.$i.Yp.I3b()){var n=this.Gy.SJa,x=new kf.a(new bg.a),E=h.h1a("*"),S=this.okl(n),ma=!!n&&!n.action||!!S&&S===this.$i.Rz,Fa;this.Ih.Pd(()=>{this.sje.yzl(b.id,x,null===S||void 0===S?void 0:S.objectId)},"OPHC:GOI");this.Ih.Pd(()=>{Fa=this.gGg.Pfh(E,S,x,ma);Fa.q$h=this.o$h(n)&&0===n.action},"OPHC:BHI");this.Ih.Pd(()=>
{this.gGg.kbh(E,Fa,ma)},"OPHC:AH")}}okl(b){let h=null;!this.o$h(b)||0!==b.action&&2!==b.action||(h=this.Gy.SJa.vF);return h||this.$i.Rz}n8m(b){if(!b)return[];b=this.Qi.Eb(C.a.Of(b.objectId));return this.commentEditor.gGd(b,null)}nLi(){return!1}$G(b,h,n){this.qla&&(b=Object.assign(new tn.a,{action:b,type:0,vF:h,eO:n}),this.Gy.$G(b))}yVe(){this.qla&&(this.$G(3,this.$i.l4b,this.$i.l4b),this.$i.l4b=null)}cin(b,h){this.mkc.add(1,b);this.mkc.add(0,h)}AWc(){this.f4.Zfa("OnBeforeTrackChangeMarkupViewChange",
(b,h)=>{h&&h.gCf!==this.Oi&&(this.Oi=h.gCf)})}o$h(b){return b&&0===b.type}}Object(r.a)(iO,"CommentHighlightActor",sg.a,[222,223]);var BQ=d(982);class jO{constructor(b,h){this.Xyk=b;this.tDf=h}}Object(r.a)(jO,"CommentEndParaIdBeforeChangeInfo",null,[]);var pG=d(1558);class kO{constructor(b,h,n,x,E,S,ma,Fa){this.Juf=b;this.ti=h;this.ek=n;this.rS=x;this.Jp=E;this.ej=S;this.Myk=ma;this.gr=Fa;this.ynb=null;this.X7m=($a,sb)=>{($a=sb.commentNode)&&!mk.r($a)&&(sb=this.ek.Qaf($a),C.a.Dp(sb.p0c,sb.qEc)||this.Xej(sb,
$a)||this.okh(sb.$ya,sb.BJa,$a)||this.m7f($a))};this.pNm=($a,sb)=>{sb.property===ic.a.csa&&($a=mk.h(sb.node,C.a.nil),this.ynb=new jO(sb.node.id,$a))};this.xOm=($a,sb)=>{$a=sb.node;if(sb.property===ic.a.csa&&$a){var Jb=mk.k($a,C.a.nil);sb=mk.h($a,C.a.nil);var Sb=this.ynb?this.Ad.Eb(this.ynb.tDf):null;!mk.r($a)&&Jb&&!Jb.equals(sb)&&this.ynb&&$a.id.equals(this.ynb.Xyk)&&!Jb.equals(this.ynb.tDf)&&Sb&&Sb.isConnected&&this.$Me(this.ynb.tDf,$a.id);sb&&this.ti.Yw.xb(sb)&&(Jb=this.ti.Yw.J(sb),Jb.GYa&&(w.ULS.shipAssertTag(572835481,
327,!!Jb.VL,"Paranode with HasSpanningComment true should have non null OpenCommentObjIds"),Jb.VL&&Jb.VL.contains($a.id)&&(Jb.VL.remove($a.id),Jb.VL.count||(Jb.GYa=!1),this.ti.WT.xb($a.id)?this.ti.WT.J($a.id).remove(sb):w.ULS.sendTraceTag(572835482,327,15,"[OnPropertyChanged] OpenComment -> ParaNodes entry missing!"))))}};this.TSc=($a,sb)=>{$a=sb.node.id;this.ti.Yw.xb($a)&&this.con($a)};this.aNm=($a,sb)=>{sb&&sb.node&&this.SQa.xb(sb.node)&&($a=this.SQa.J(sb.node).iYd,this.SQa.xb($a)||($a=this.SQa.J(sb.node),
this.okh($a.i0e?$a.currentNode:$a.iYd,$a.i0e?$a.iYd:$a.currentNode,$a.commentNode)||this.m7f($a.commentNode)),this.SQa.remove(sb.node))};this.AOm=($a,sb)=>{const Jb=$a.Oj;if(!sb&&this.F8a.xb(Jb)){var Sb;(Sb=this.F8a).Z(Jb,Sb.J(Jb)&($a.Oc?-2:-3));this.F8a.J(Jb)||(this.m7f(this.Ad.Eb(Jb)),this.F8a.remove(Jb))}};this.SQa=new ea.a(new BQ.a);this.F8a=new BF.a(mk.c);this.rS.Zfa("OnCommentNodeAdded",this.X7m);this.gr.contentFilterApiEnabled?(this.rS.Zfa("OnCommentPaneOpen",this.V5l.bind(this)),this.rS.Zfa("OnCommentPaneClose",
this.U5l.bind(this)),this.rS.Zfa("OnContentFilterUpdate",this.ISc.bind(this))):["OnCommentPaneOpen","OnCommentPaneClose"].forEach($a=>{this.rS.Zfa($a,this.T5l.bind(this))});b=this.Jp.Te(12);b.xv(this.TSc);b.rs(this.aNm);this.Jp.Te(40).Pub(this.pNm);this.Jp.Te(40).jp(this.xOm);Fr.a.mOa(this.AOm)}get Py(){return this.Juf.value}get Ad(){return this.Py.Ad}yzl(b,h,n){if(this.W_m(b))for(let x of this.ti.Yw.J(b).VL)!this.D0i(x,n===x.toString())||h.add(x)}D0i(b,h){const n=this.Ad.Eb(b),x=mk.r(n);if(!n||x)return!1;
b=this.ek.nZ(b.toString());return!b||this.gr.contentFilterApiEnabled&&this.ti.en&&!this.Myk.isContentInFilteredContent(b.id)||!this.ti.en&&!this.ek.gta(b)&&!h?!1:!0}W_m(b){return this.C_m(b)}m7f(b){if(b){var h=td.a.gGd(b,null),n=new Pa.a;for(let x=1;x<h.length-1;x++)this.$Me(h[x].id,b.id),n.add(h[x]);pl.b(n)}}C_m(b){if(!this.ti.VW)return!1;let h=null;if(({value:h}=this.ti.Yw.Dc(b,h)).returnValue)return h.GYa;let n=!1;this.ej.Pd(()=>{const x=mk.e();for(let E=0;E<x.length;E++)n=this.jio(x[E],b,n);n||
(this.ti.Yw.add(b,new pG.a),this.ti.Yw.J(b).GYa=!1)},"CHORA:PHOC");return n}jio(b,h,n){b=mk.g(b);if(!b)return n;for(let x=0;x<b.length;x++){const E=this.Ad.Eb(b[x]);E&&!mk.r(E)&&(n=n||this.Brk(E,h))}return n}Brk(b,h){var n=this.ek.Qaf(b);if(this.Xej(n,b))return!1;var x=n.p0c;const E=n.qEc;n=n.$ya;if(x!==C.a.nil&&(x.equals(E)||x.equals(h)))return!1;for(x=Cd.ParagraphReader.Vg(n,!1);x&&!x.id.equals(E);){if(x.id.equals(h))return this.$Me(h,b.id),!0;x=Cd.ParagraphReader.Vg(x,!1)}return!1}$Me(b,h){this.ti.WT.xb(h)||
this.ti.WT.add(h,new kf.a(new bg.a));this.ti.WT.J(h).add(b);this.ti.Yw.xb(b)?this.ti.Yw.J(b).VL||(this.ti.Yw.J(b).VL=new kf.a(new bg.a)):this.ti.Yw.add(b,new pG.a(!0));this.ti.Yw.J(b).GYa=!0;this.ti.Yw.J(b).VL.add(h)}con(b){if(this.ti.Yw.J(b).VL)for(let h of this.ti.Yw.J(b).VL)this.ti.WT.xb(h)?this.ti.WT.J(h).remove(b):w.ULS.sendTraceTag(572835483,327,15,"[OnDisconnected] OpenComment -> ParaNodes entry missing!");this.ti.Yw.remove(b)}T5l(){const b=new Pa.a;for(let h of this.ek.aT())h.Rf||h.Qq===Zk.a.beingCreated||
this.ek.gta(h)||this.ek.o7f(h,b);pl.b(b)}V5l(){this.mnf("OnCommentPaneOpen")}ISc(){this.mnf("OnContentFilterUpdate")}U5l(){this.mnf("OnCommentPaneClose")}mnf(b){const h=new Pa.a;for(let n of this.ek.aT())n.Rf||n.Qq===Zk.a.beingCreated||this.ek.MJ.hih(b,n)||this.ek.o7f(n,h);pl.b(h)}Xej(b,h){let n=!1;if(!b.B8d||!b.Dzd){n=!0;if(!b.$ya||!b.BJa)return w.ULS.sendTraceTag(571025377,327,15,"Anchor para nodes missing, start={0}, end={1}",!b.$ya,!b.BJa),!0;b.B8d||this.SQa.xb(b.$ya)||this.SQa.add(b.$ya,{commentNode:h,
currentNode:b.$ya,iYd:b.BJa,i0e:!0});b.Dzd||this.SQa.xb(b.BJa)||this.SQa.add(b.BJa,{commentNode:h,currentNode:b.BJa,iYd:b.$ya,i0e:!1})}return n}okh(b,h,n){b=td.a.zsa(b,n.id,!0);h=td.a.zsa(h,n.id,!1);let x;b||({value:x}=this.F8a.Dc(n.id,x),this.F8a.Z(n.id,x&1));h||({value:x}=this.F8a.Dc(n.id,x),this.F8a.Z(n.id,x&2));return!b||!h}}Object(r.a)(kO,"CommentHighlightOnRestActor",null,[221]);class lO{constructor(b,h){this.$tb=b;this.Vha=h}getViewContainer(){return this.$tb}registerForViewContainerEvents(b){this.Vha.Iln(b)}unregisterForViewContainerEvents(b){this.Vha.hdo(b)}}
Object(r.a)(lO,"ViewContainerProvider",null,[826]);class gI{constructor(b,h,n,x){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=b;this.appLocale=h;this.uiCulture=n;this.dataCulture=x}}Object(r.a)(gI,"LocalizationDetails",null,[]);var CQ=d(1107),Dv=d(1485);class mO{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd,Gd,vd,ce,od,Yd,ne,Df,Af,Wi,gm,Ck,Rm,Qr,ls,pw,oA){this.sq=b;this.ek=h;this.TYb=n;this.aZ=x;this.gr=E;this.ti=S;this.aCd=ma;this.f4b=Fa;this.hq=
$a;this.Ac=sb;this.dynamicScriptLoader=Jb;this.wxn=Sb;this.Ai=oc;this.NWe=Ic;this.KWe=gd;this.t5g=Gd;this.Wno=vd;this.o_=ce;this.rS=od;this.bzn=Yd;this.c4k=ne;this.Bti=Df;this.Xno=Af;this.MAc=Wi;this.sS=gm;this.Ch=Ck;this.lM=Rm;this.YXe=Qr;this.D0a=ls;this.Lud=pw;this.vCk=oA;this.Vbd=this.eTa=null;this.qHg=!1;this.xze=[];this.pXg=this.rHg=!1;this.initialize=(xt,Gz)=>{this.v0l(Gz)};this.nOk=xt=>Eo.a.wYe(xt);this.BOm=()=>{this.B6h()};this.Dql=(xt,Gz,DF)=>{xt=Object.assign(Object.assign({},new CQ.a),
{containerPanel:xt,paneOpenedCallback:Gz,paneClosedCallback:DF,ulsLogger:new ml.a,canvasAndFcHostOffset:wacBoot.ShiftUtils.canvasAndFcOuterSurfaceOffset,isRtl:u.AFrameworkApplication.isRtl&&this.gr.gib,viewportInfo:this.Ch.Gbf(),destroyAllContainersCallback:()=>{this.ti.en||w.ULS.sendTraceTag(571342851,327,10,"The pane is not open but we are destroying the containers!")},featureGates:{deselectionEnabled:!0,floatingContainerVirtualizationEnabled:this.gr.bCd,synchronousContainerPositioningEnabled:!1,
trackChangeInSidetrackEnabled:this.gr.trackChangeInSidetrackEnabled,improveJumpingFixEnabled:!1,shouldInitialize:!this.gr.contentNavigationApiEnabled,scrollingPerfImprovementEnabled:!1,contentNavigationApiEnabled:this.gr.contentNavigationApiEnabled,contentFilterApiEnabled:this.gr.contentFilterApiEnabled}});this.gr.contentNavigationApiEnabled&&(xt.sidetrackContentNavigationApi=this.YXe,xt.featureGateApiSettings=this.sS.E3e,xt.telemetryDetails=this.Bti,this.gr.contentFilterApiEnabled&&(xt.contentFilterAPI=
this.vCk));return floatingContainerManager.FactoryGlobal.getFCManagerInstance(xt)};this.rQm=xt=>{2!==this.sq.mode&&3!==this.sq.mode&&this.ek.Hs&&xt===this.ek.Hs.id&&this.sq.clearSelection();ob.App.xa.updateCommandUI(!0)};this.Qui=(xt,Gz)=>{this.Ru("onCSCStart",window.performance.now());this.b$a&&!xt&&(this.HXm(),this.Ru("openInFishbowl",!0));this.TYb.f$a&&this.gr.Gxb&&this.Ac.processAction(Ra.a.newComment,2);Gz&&Gz();this.Ru("onCSCEnd",window.performance.now())};this.rS.Zfa("OnCommentInit",this.initialize);
this.rS.Zfa("OnCommentRenderedOnce",this.BOm);this.sS.NHn(()=>{},this.rQm)}get lGa(){return this.sq}get b$a(){return this.ti.b$a}Ru(b,h){this.D0a.Ru(uD.a.comments,b,h,!0)}v0l(b){if(this.ti.VW)b&&b.ACa&&b.ACa();else if(this.qHg)(null===b||void 0===b?0:b.ACa)&&this.xze.push(b.ACa);else{var h=this.gr.SJc;this.Ru("hasCommentOnBoot",h);h?this.MAc.logKpiUsage(Dv.a.Kud,0):Kq.a.z9b("canvas","floatingComments");this.qHg=!0;this.Ru("initInProgress",!0);this.ek.initialize(this.sq);this.TYb.initialize(this.sq,
null);this.TYb.M_i(this.sq);this.f4b.o1l(this.aZ.rMn);this.Ru("InitAMSetup",window.performance.now());Bh.a.Iq(this.c4k).continueWith(n=>{(this.eTa=n.result)||w.ULS.sendTraceTag(574734881,327,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");this.NWe.initialize(this.eTa);this.lGa.AWe.initialize(this.lGa,this.ek,this.eTa,this.NWe);this.t5g.initialize(this.dynamicScriptLoader,this.lGa.AWe,this.Bti,this.eTa,new lO(this.Wno,this.Xno),this.ySh(),"",this.NWe.BXh(),this.o_,ob.App.w6d);this.Ru("AMInitialized",
window.performance.now());this.gr.contentNavigationApiEnabled?(ob.App.Qyb?ob.App.Qyb:this.Ch.Tji()).then(()=>{this.Ru("FCMLoaded",window.performance.now());this.c_c();this.LLd(b)}):this.LLd(b)})}}Z4m(){var b;this.gr.wCb&&(null===(b=sharedComments.setDarkModeColorHandler)||void 0===b?void 0:b.call(sharedComments,this.nOk))}LLd(b){this.Vbd=this.t5g.LLd(void 0,this.Z4m.bind(this));this.zLc(b);this.ti.VW=!0;this.gr.Z_f&&this.KWe.initialize()}zLc(b){if(!this.ti.xBb){this.Ru("InitCSStart",window.performance.now());
var h=this.hq.fg("Task","InitiateCommentingSession");try{const n=this.hq.fg("Task","InitiateCommentingSession-UpdateModel");this.Lud.M0l();n.stop();this.Ru("initAtBoot",window.performance.now());this.gr.uq&&this.ek.I3b()&&w.ULS.sendTraceTag(574734882,327,50,String.format("Comments loaded into the model at {0}",rd.a.lf()));cj.a.get_instance().KI(12);w.ULS.sendTraceTag(574734883,327,50,"CommentRendered AppInitializationStatus was set");this.ti.xBb=!0;this.Vbd.then(()=>{this.Ru("SCLoaded",window.performance.now());
this.Ch.f1l();this.Ru("FCMInitiated",window.performance.now());if(this.gr.uq){let E=!1;if(this.b$a){var x=this.aZ.HDd(this.b$a);x?(u.AFrameworkApplication.Hf("3ge3g205;cha3g788"),x=this.aZ.IDd(x,0),x)?this.ek.gta(x)||(E=!0,this.IXm(x)):(E=!0,this.d0a()):E=!0}x=b?b.Hvi:null;this.gr.contentNavigationApiEnabled?this.Qui(E,x):this.Rqm(E,x)}b&&b.ACa&&b.ACa();for(let E of this.xze)E();this.rHg&&this.B6h();this.xze=[]})}catch(n){w.ULS.sendTraceTag(539567713,327,10,`Comments Initialization Failed: ${n}`)}finally{h.stop(),
this.Ru("InitCSEnd",window.performance.now())}this.Ac.processAction(Ra.a.knh,2)}}IXm(b){this.Ac.processAction(Ra.a.KX,2);this.sS.C2i();yo.a.h1(u.AFrameworkApplication.uc,()=>{this.aZ.selectComment(b,Object.assign(Object.assign({},new gv.a),{lO:!0,j3:1}));this.Ai.Jg(xd.AFrame.fr);w.ULS.sendTraceTag(574734912,327,50,"opened resolved deeplinked comment using pane, time since boot = {0}",(new Date).getTime()-u.AFrameworkApplication.SV)},rw.a.IBn);this.MAc.KB(Ra.a.EWe);u.AFrameworkApplication.Gl("Microsoft.Office.Web.SessionSettings.IWacWordLinkToCommentSettings")}d0a(){this.Ac.processAction(Ra.a.d0a,
2)}Rqm(b,h){(ob.App.Qyb?ob.App.Qyb:this.Ch.Tji()).then(()=>{this.Ru("FCMLoaded",window.performance.now());this.c_c();this.Qui(b,h)}).catch(n=>{w.ULS.sendTraceTag(574734913,327,15,"Failed to load floatingContainerManager script: "+n.toString())})}c_c(){this.lM.trackChangeInSidetrackEnabled?(this.aCd.c_c(),this.Ru("STSet",window.performance.now())):this.aCd.Q_i(this.Dql)}B6h(){this.pXg||(this.ti.VW&&this.Vbd?(this.Vbd.then(()=>{const b=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();
this.bzn.execute(h=>{b.registerSafelinksNavigator(h.tgc.bind(h))});this.wxn.execute(h=>{h.fin(b)})}),this.pXg=!0):(w.ULS.sendTraceTag(571618846,327,15,"[InitializeRichContentEditAPI] Shared comments runtime not yet loaded"),this.rHg=!0))}ySh(){return new gI(u.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,u.AFrameworkApplication.uiCulture,u.AFrameworkApplication.dataCulture)}HXm(){this.aZ.lUi(this.b$a,Object.assign(Object.assign({},new gv.a),{nZf:!1,IMc:!0}));this.MAc.KB(Ra.a.EWe)}}
Object(r.a)(mO,"CommentInitActor",null,[]);class qG{constructor(b,h,n,x,E,S,ma){this.gg=b;this.Kj=h;this.xD=n;this.ga=x;this.uxj=E;this.Ki=S;this.Xe=ma;this.gce=this.IRa=null}get zoom(){let b=1;this.Ki&&this.Ki.instance&&(b=this.Ki.instance.vj);return 0<b?b:1}t5k(b,h){if(!this.gce||!b.oBa||h>=b.oBa.length)return null;const n=this.zoom,x=b.S6,E=b.Pvb(1,cx.zlf,n);return this.rHk(b.oBa[h],x,(this.gce.y-b.w$[h].y)/n+cx.Vkj,E)}rHk(b,h,n,x){if(this.IRa)return(h=this.IRa.parentElement)&&h.removeChild(this.IRa),
this.IWi(b,this.IRa,n,x),this.IRa;const E=h.Ig.ownerDocument,S=E.createElement("div");S.className=qG.Kyk;this.IWi(b,S,n,x);this.Xe.DJa?(b=E.createElement("span"),this.H2c(b,S),FB(GB(3,4),b),this.xKi(b,h)):(b=E.createElement("img"),this.H2c(b,S),b.className=Tg.getImageClassWithCluster(u.AFrameworkApplication.bQ,Hz(3,4)),b.src=u.AFrameworkApplication.mr,b.alt=CommonUIStrings.l_CommentNewCommentButton,this.xKi(b,h));return this.IRa=S}H2c(b,h){b.title=CommonUIStrings.l_CommentNewCommentButton;b.setAttribute("role",
"button");h.appendChild(b)}xKi(b,h){this.gg.jE(kb.a.click,b,this.XPm.bind(this),h);this.gg.mb(kb.a.KC,b,this.ZPm.bind(this));this.Xe.DJa||(this.Kj.mb(kb.a.iX,b,this.aQm.bind(this)),this.Kj.mb(kb.a.rfa,b,this.$Pm.bind(this)));this.xD.mb(b,this.YPm.bind(this))}bKd(){if(this.IRa){const b=this.IRa.parentElement;b&&b.removeChild(this.IRa)}}IWi(b,h,n,x){this.uxj.RXk(b,n)?h.style.left=x+cx.zlf+"px":h.style.left=x+"px";h.style.top=n+"px";h.style.right="auto";h.style.display="block";h.style.position="absolute";
h.style.overflow="hidden";h.style.cursor="default";h.style.zIndex="40"}ZPm(){return!0}XPm(b){this.ga.yG=30;this.ga.processAction(Ra.a.newComment,2);b=b.Bv;this.Xe.DJa?FB(GB(3,4),b):b.className=Tg.getImageClassWithCluster(u.AFrameworkApplication.bQ,Hz(3,4));b=b.parentElement;(null===b||void 0===b?0:b.parentElement)&&b.parentElement.removeChild(b);return!0}aQm(b){b.Bv.className=Tg.getImageClassWithCluster(u.AFrameworkApplication.bQ,Hz(2,4));return!0}$Pm(b){b.Bv.className=Tg.getImageClassWithCluster(u.AFrameworkApplication.bQ,
Hz(3,4));return!0}YPm(){return!0}}qG.Kyk="clip16x16 EntryPointContainer";Object(r.a)(qG,"CommentMarginEntryPointActor",null,[]);var nO=d(449),DQ=d(26);class oO{constructor(b,h,n,x,E,S,ma){this.Juf=b;this.Som=h;this.Yp=n;this.ti=x;this.gr=E;this.IWe=S;this.MAc=ma;this.TFi=new Set;this.kEb=new Set;this.gYd=new qk.a;this.sda=this.GDd()}get Py(){return this.Juf.value}get Ad(){return this.Py.Ad}get cza(){return this.Som.value}GDd(){const b=new md.GraphIterator;b.set(this.Py);this.cza.Z_a(b);return b}M0l(){this.ti.xBb&&
w.ULS.sendTraceTag(523334300,327,15,"initializeCommentsAtBoot was called while the commenting session was already alive. [Call stack: {0}]",DQ.Debug.uXa());this.gr.contentNavigationApiEnabled||(this.gr.SJc&&this.K0l(),this.Yp.Nwi())}FNm(){this.Yp.Nwi();u.AFrameworkApplication.K.$("IsDocumentOwner")||Oa.a.instance.Za("Common.ISystemInitiatedFeedback").execute(b=>{b.logActivity("ShowTUIForCommentAwareness","")})}k3l(b){const h=[];for(let n of b)b=n.Oj.toString(),n.Oc&&(this.TFi.has(b)?w.ULS.sendTraceTag(523334301,
327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",n.Oj):(this.TFi.add(b),(b=this.n0j(n))&&h.push(b)));this.WQi();return h}n0j(b){var h=this.Ad.Eb(b.Oj);this.sda.Ci(h);if(40!==this.sda.Se||!h)return w.ULS.sendTraceTag(523334303,327,15,"[UpdateContent] Iterator is not at commentNode or CommentNode is null, commentnode is null: {0}, objId null: {1}",!h,!b.Oj),this.sda=39===this.sda.Se?this.sda:this.GDd(),null;h=this.Yp.owd(this.sda);let n;if(({index:n}=this.Yp.uae(h)).returnValue)if(this.Yp.wMe(h,
n),this.kEb.add(h.objectId),h.Rf)this.r8e(h);else return{contentId:h.id,containerContentType:0,W6:{Cd:b.Ob.cp,UL:b.paragraph.pn}};else this.gYd.add(h);return null}r8e(b){if(b.Rf){var h=this.Yp.xB(b.Rf);if(h&&h.Rf){const n=this.Yp.xB(h.Rf);n&&(n.Rf?w.ULS.sendTraceTag(523270216,327,10,"Multiple chain of replies parented to other replies"):(b.Rf=h.Rf,w.ULS.sendTraceTag(523270217,327,15,`Comment reply id pointing to another reply. objectid: ${b.objectId} parentObjectId: ${h.objectId}`)))}}}K0l(){const b=
new Aa.a(0),h=cn.a.Vp(this.Yp.gFa),n=new Set;this.gr.WYm&&!nO.a.isEnabled&&this.n2j(h,b);let x=this.GDd(),E=new Set;const S=new Set,ma=new Se.GraphTransaction(2);try{if(ma.Ju(x),x.Zp(1)){for(;h.moveNext();){if(!Cd.ParagraphReader.wh(h.iterator))continue;const $a=h.iterator.currentNode,sb=Cd.ParagraphReader.uzb($a);nO.a.isEnabled&&this.bDm($a,sb,b);n.add($a.id.toString());this.mFi(sb,S,x,E)}this.WQi();const Fa=this.pkl(n);0<Fa.length&&this.Kwn(Fa,n,x,S)}}finally{ma&&ma.dispose()}0==this.kEb.size&&
this.gr.SJc&&w.ULS.sendTraceTag(523334304,327,15,"Comments not loaded in model while graph has comments");uA.a.bxm(E,S,this.Ad)}mFi(b,h,n,x){for(let E of b)b=E.Oj.toString(),(this.gr.uq?!E.Oc:E.Oc)?h.has(b)||x.add(b):h.has(b)?w.ULS.sendTraceTag(523334305,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",E.Oj):(h.add(b),this.o0j(E,n))}Kwn(b,h,n,x){const E=this.HAl(b);uA.a.Csk(E);const S=new Set,ma=new Set;E.forEach($a=>{h.has($a.id.toString())||ma.has($a.id.toString())||(ma.add($a.id.toString()),
$a=Cd.ParagraphReader.uzb($a),w.ULS.sendTraceTag(523334306,327,50,`Retrying loading ${$a.length} CommentRangeObjects`),this.mFi($a,x,n,S))});const Fa=[];b.forEach($a=>{this.kEb.has($a)||Fa.push($a)});0<Fa.length&&(w.ULS.sendTraceTag(523334307,327,15,`Load Comments: ${Fa.length} Failed To Load on Retry: ${Fa.join(",")}`),this.MAc.logKpiFailure(Dv.a.Kud,"CommentsFailedToLoadOnRetry",{isInternal:!0},{name:Dv.a.Hud,isInternal:!0}))}HAl(b){const h=[];b.forEach(n=>{if(n=this.IWe.JMh(n))n=mk.k(n),(n=this.Ad.Eb(n))&&
n.Ti&&h.push(n)});return h}o0j(b,h){const n=this.Ad.Eb(b.Oj);h.Ci(n);40===h.Se&&n?(b=this.Yp.owd(h),({index:h}=this.Yp.uae(b)).returnValue?(this.Yp.wMe(b,h),this.kEb.add(b.objectId),b.Rf&&this.r8e(b)):this.gYd.add(b)):(w.ULS.sendTraceTag(523334336,327,15,"[UpdateContent] Iterator is not at commentNode, commentnode is null: {0}, objId null: {1}",!n,!b.Oj),39===h.Se||this.GDd())}pkl(b){let h=[];const n=this.IWe.jkl();if(this.kEb.size===n.length)return h;n.forEach(x=>{!this.kEb.has(x)&&uA.a.hlm(x,b,
this.IWe,this.Ad)&&h.push(x)});return h}WQi(){for(let b=0;b<this.gYd.length;b++){const h=this.gYd.J(b);let n;({index:n}=this.Yp.uae(h)).returnValue?(this.Yp.wMe(h,n),this.kEb.add(h.objectId),h.Rf&&this.r8e(h)):w.ULS.sendTraceTag(523334337,327,10,String.format("Orphaned Comment add on retry failed: CommentGuardID: {0}, DurableId: {1}, ParentId: {2}",h.sLa,h.cKa,h.Rf))}}n2j(b,h){b.Om(n=>{if(11===n.Se){var x=n.currentNode;const E=x.ia(Ji.a.QWe,null),S=x.ia(Ji.a.OWe,null);n=!!E&&0<E.length;const ma=!!S&&
0<S.length;n&&E.forEach($a=>{const sb=this.Ad.Eb($a);sb&&!mk.r(sb)&&h.add($a,0)});ma&&S.forEach($a=>{h.xb($a)&&h.remove($a)});(x=x.ia(ie.a.iL,null))&&x.forEach($a=>{const sb=this.Ad.Eb($a);Cd.ParagraphReader.oc(sb)&&!this.ti.Yw.xb($a)&&this.ti.Yw.add($a,new pG.a)});const Fa=h.keys;for(let $a=0;$a<Fa.length;$a++){x&&0<h.J(Fa.J($a))&&(this.ti.WT.xb(Fa.J($a))||this.ti.WT.add(Fa.J($a),new kf.a(new bg.a)),x.forEach(Jb=>{const Sb=this.Ad.Eb(Jb);Cd.ParagraphReader.oc(Sb)&&(this.ti.Yw.J(Jb).VL||(this.ti.Yw.J(Jb).VL=
new kf.a(new bg.a)),this.ti.WT.J(Fa.J($a)).add(Jb),this.ti.Yw.J(Jb).GYa=!0,this.ti.Yw.J(Jb).VL.add(Fa.J($a)))}));let sb;h.Z(sb=h.keys.J($a),h.J(sb)+1)}return n||ma}return!0},null)}bDm(b,h,n){b&&(this.grj(h,n),this.ti.Yw.xb(b.id)||this.ti.Yw.add(b.id,new pG.a),n.forEach((x,E)=>{0<E&&(this.ti.WT.xb(x)||this.ti.WT.add(x,new kf.a(new bg.a)),this.ti.Yw.J(b.id).VL||(this.ti.Yw.J(b.id).VL=new kf.a(new bg.a)),this.ti.WT.J(x).add(b.id),this.ti.Yw.J(b.id).GYa=!0,this.ti.Yw.J(b.id).VL.add(x));n.Z(x,E+1);return!0}))}grj(b,
h){b.forEach(n=>{if(n.Oc){const x=this.Ad.Eb(n.Oj);x&&!mk.r(x)&&h.Z(n.Oj,0)}else h.xb(n.Oj)&&h.remove(n.Oj)})}}Object(r.a)(oO,"CommentModelBootLoader",null,[218]);var EQ=d(993);class pO{constructor(b){this.Fnh=b;this.Xmc=null;this.wPg=void 0;this.xPg=null;this.Irc=new Map;this.Ime=new Map}zln(){EQ.a.mOa(this.$eo.bind(this))}$eo(b,h){let n=b.id.toString();var x=b.getValue(ic.a.ZD).toString();h?(this.Irc.delete(n),this.Ime.delete(x)):(this.Irc.set(n,b),this.Ime.set(x,b));0===this.Irc.size&&this.Xmc&&
(b=+new Date-+this.Xmc,this.Xmc=null,w.ULS.sendTraceTag(543506649,327,50,`All Nodes Disconnected. Duration between first Node connection and all nodes disconnections : ${b}`));h||this.wPg!==x||(h=+new Date-+this.xPg,w.ULS.sendTraceTag(541878464,327,15,`Deeplinked Comment added after deeplink navigation failed: ${h}`),x=new ab.a,x.durationMs=h,this.Fnh.logKpiFailure(Dv.a.Fud,"CommentFoundAfterDeeplinkAttempt",{isInternal:!0,additionalValues:x},{name:Dv.a.rnh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,
additionalValues:x}));this.Xmc||(this.Xmc=new Date)}set VGm(b){this.wPg=b;this.xPg=new Date;if(b=this.hkl(b))w.ULS.sendTraceTag(538789919,327,15,`Deeplinked Comment ${b.id} present but failed to load`),b=new ab.a,this.Fnh.logKpiFailure(Dv.a.Fud,"CommentPresentButFailedToLoad",{isInternal:!0},{name:Dv.a.rnh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:b})}jkl(){return[...this.Irc.keys()]}hkl(b){return this.Ime.get(b)}JMh(b){return this.Irc.get(b)}}Object(r.a)(pO,"CommentNodeTracker",
null,[]);class qO{constructor(b,h,n,x,E){this.CTf=b;this.Yp=h;this.aZ=n;this.MJ=x;this.ti=E;this.CTf.OKi(this)}get contentType(){return 0}oUi(b,h,n){0===h?(h=this.Yp.OMc(b),this.aZ.selectComment(h?this.Yp.Hy:this.Yp.xB(b),Object.assign(new gv.a,{lO:n||h,j3:1}))):this.MJ.clearSelection()}j1i(b){return this.ti.en||this.Yp.OMc(b.contentId)?!0:this.Yp.gta(this.Yp.xB(b.contentId))}}Object(r.a)(qO,"CommentReviewSuggestionContentActor",null,[217]);class rO{constructor(b){this.Lud=b;this.R1f=new Set([12])}get J7i(){return this.R1f}initialize(){}Yji(b){if(!Cd.ParagraphReader.oc(b.node))return[];
b=Cd.ParagraphReader.uzb(b.node);return this.Lud.k3l(b)}zui(){this.Lud.FNm()}}Object(r.a)(rO,"CommentReviewSuggestionContentProvider",null,[216]);var LE=d(1527);class ME{constructor(){this.commentId=null;this.pOc=!1}}Object(r.a)(ME,"CommentToSelectOnPaneLoadData",null,[]);class sO{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd){this.sq=b;this.Yp=h;this.bza=n;this.aZ=x;this.rS=E;this.ti=S;this.aCd=ma;this.gr=Fa;this.TYb=$a;this.WDb=sb;this.Ac=Jb;this.Kuf=Sb;this.Ai=oc;this.ej=Ic;this.Uyk=gd;this.Ac.pa(Ra.a.QJb,
Ld.a.frame,this.sq.QJb.bind(this.sq));this.Ac.pa(Ra.a.Yyd,Ld.a.frame,this.Yyd.bind(this));this.Ac.pa(Ra.a.BWe,Ld.a.frame,this.tOm.bind(this));this.Ac.pa(Ra.a.zyk,Ld.a.frame,this.sOm.bind(this));this.Ac.pa(Ra.a.Dri,Ld.a.frame,this.ISm.bind(this));this.Ac.pa(Ra.a.Kyh,Ld.a.frame,this.DPm.bind(this));this.Ac.pa(Ra.a.Cnh,Ld.a.frame,this.YQm.bind(this));this.Ac.gb(Ra.a.GWe,Ld.a.frame,this.dbk.bind(this),64);this.Ac.gb(Ra.a.Jud,Ld.a.frame,this.Pmn.bind(this),64);this.Ac.pa(ub.a.selectComment,Ld.a.frame,
this.aZ.FBn.bind(this.aZ));this.gr.vpm&&this.Ac.pa(ub.a.FQd,Ld.a.frame,this.FQd.bind(this));this.n6g(ub.a.UCc,!1);this.n6g(ub.a.A1e,!0);this.Ac.gb(ub.a.Mud,Ld.a.frame,this.Mud.bind(this),64);this.Ac.pa(ub.a.Lki,Ld.a.frame,pd.ActionManager.Nf);this.gr.uvb&&this.Ac.pa(ub.a.oTe,Ld.a.frame,this.Cmk.bind(this))}get ek(){return this.Yp}get mode(){return this.sq.mode}get Rz(){return this.sq.Rz}get Dz(){return this.gr.uq}get Qi(){return this.WDb.value}get Cb(){return this.Kuf.value}get MJ(){return this.sq}Yyd(b,
h,n,x,E){return E?E?(b=this.aZ.HDd(E.NavigationId))&&this.aZ.IDd(b,1)?32:8:(w.ULS.sendTraceTag(540160449,327,10,"ActionData could not be cast to dict: DoesCommentExist"),8):(w.ULS.sendTraceTag(540160448,327,10,"No action data: DoesCommentExist"),8)}tOm(b,h,n,x,E){E&&this.rS.fna("OnCommentInit",Object.assign(Object.assign({},new LE.a),{ACa:()=>{var S=this.aZ.HDd(E.NavigationId);if(S){var ma=this.aZ.IDd(S,1);ma?this.TYb.isVisible?(this.HYc(ma,1),this.Ai.YB(xd.AFrame.fr)):this.ek.gta(ma)?(S=mk.q(ma),
this.aZ.selectComment(ma,Object.assign(Object.assign({},new gv.a),{lO:!S,j3:1})),this.Ai.YB(xd.AFrame.qL)):(this.ti.en||this.Ac.processAction(Ra.a.KX,2),yo.a.h1(u.AFrameworkApplication.uc,()=>{this.HYc(ma,1)},rw.a.HYc)):this.Ac.processAction(Ra.a.d0a,2)}}}));return 32}sOm(b,h,n,x,E){E?(b=this.ek.RGc(E))?this.MJ.Q9b(b.id):w.ULS.sendTraceTag(540160450,327,10,"We were not able to find the comment referenced in the Activity Pane!"):this.MJ.Q9b(null);return 32}ISm(b,h,n,x,E){if(E){if(this.ti.xBb){for(b=
0;b<E.length;b++)this.ek.FWi(E[b]);this.sq.GHb()}else this.ek.j4j(E);this.nxm(E)}return 32}DPm(b,h,n,x,E){if(E)if(this.ti.xBb){for(b=0;b<E.length;b++)this.ek.FWi(E[b],!0);this.sq.GHb()}else this.ek.Yuk();return 32}YQm(b,h,n,x,E){this.Dz||this.ti.en||this.Ac.processAction(Ra.a.KX,2);if(E){b=null;if(!this.Rz||2!==this.mode&&3!==this.mode){if(!E)return 8;if(this.Dz)b=this.S6k(E);else for(h=0;h<E.length&&(b=this.ek.nZ(E[h].toString()),this.aCd.uNd&&(!b||b.done));h++);}else b=this.Rz;this.HYc(b,1);b&&
this.ti.VW&&this.Ai.Jg(this.Dz&&!this.ti.en?xd.AFrame.qL:xd.AFrame.fr)}else w.ULS.sendTraceTag(5017933,327,10,"We have hint but we couldn't find the paragraph that it belongs to!");return 32}dbk(b,h,n,x,E){var S;if(!E)return 32;if(E&&0<E.length){h=b=n=0;x=!1;for(let ma=0;ma<E.length;ma++)E[ma].toString()===(null===(S=this.Rz)||void 0===S?void 0:S.objectId)?(x=!0,b++):this.Yp.erf(E[ma])&&(x&&0===n&&(n=ma,h=b),b++);(S=this.Yp.nZ(E[n].toString()))?(this.bza.Vfc.wCf=h+1,this.bza.Vfc.Xfc=b,this.MJ.Q9b(S.id)):
(E=E[n],this.Qi.Eb(E)?w.ULS.sendTraceTag(540148256,327,10,`Comment Node with ObjectId ${E} has no corresponding comment in Model`):w.ULS.sendTraceTag(540148257,327,10,"Comment ObjectId:{0} is NOT in the model, but we are trying to hightlight!",E.toString()))}return 32}Pmn(){this.MJ.Q9b(null);return 32}n6g(b,h){this.Ac.pa(b,Ld.a.frame,(n,x,E)=>this.iPm(E,h))}FQd(b,h,n){2===n&&(b=this.ek.AL.Rc(7),b.Db(this.ek.gFa),h=new di.a,h.Kea(`${String.fromCodePoint(128077)} \n`),this.Yp.Ywb(kh.a.instance.ib.kb,
void 0,h),this.Uyk.bKd(),b.dispose());return 32}iPm(b,h=!1){if(2===b)b=this.ek.AL.Rc(15),b.Db(this.ek.gFa),this.ej.Pd(()=>{this.UCc(h)},"ECM:DAC"),b.dispose();else if(1===b&&!this.ek.I3b())return 2;return 32}UCc(b=!1){this.sq.mode=1;const h=this.ek.aT();for(let n of h)n.Qq===Zk.a.beingCreated||b&&!n.done||n.Rf||this.sq.deleteComment(n);this.Ai.Jg(xd.AFrame.Xp);0<(b?this.ek.aT().filter(n=>n.done):this.ek.aT()).length?w.ULS.sendTraceTag(540160454,327,10,"Not all comments were deleted. onlyDeleteResolved: {0}.",
b):w.ULS.sendTraceTag(540160455,327,50,"All comments were successfully deleted. onlyDeleteResolved: {0}.",b)}Mud(b,h,n){if(2===n)if(b=this.Ai.xg.name,b!==xd.AFrame.fr&&b!==xd.AFrame.qL){!this.Dz||this.ti.en?(this.ti.en||this.Ac.processAction(Ra.a.KX,2),this.Ai.Jg(xd.AFrame.fr)):this.Ai.Jg(xd.AFrame.qL);var x=this.Cb.ib.kb;if(!x||!x.Qa)return 2;b=x.Qa.cpBegin;h=x.Qa.node;x=!!this.Rz&&(Kd.SelectionEditor.Km(x)||x.JL)&&mk.p(this.Rz,h,this.Qi,b);b=!!this.Rz&&(2===this.mode||3===this.mode);if(x||b)return this.MJ.qUi(this.Rz.id,
!0),32;x=this.Dz&&!this.ti.en?this.ek.KMh(!0,!0):null;this.MJ.OBn(x)}else this.ek.Hs&&(this.sq.f4b.kUi(this.ek.Hs,!0),this.sq.f4b.MYa(null===(x=this.ek.Hs)||void 0===x?void 0:x.objectId)),this.Ai.Jg(xd.AFrame.Xp);return 32}Cmk(){return 4}nxm(b){const h=new Set;for(let n=0;n<b.length;n++){const x=this.ek.RGc(b[n]);x&&h.add(x.Rf?x.Rf:x.id)}w.ULS.sendTraceTag(540160456,327,50,"Threads with new comments: {0}",h.size.toString())}HYc(b,h){b?this.TYb&&!this.ti.VW?this.ti.vab=Object.assign(new ME,{commentId:b.id,
pOc:!1}):this.aZ.selectComment(b,Object.assign(new gv.a,{lO:!!h,j3:h})):w.ULS.sendTraceTag(5017932,327,10,"We were not able to find the comment in the model!")}S6k(b){let h=null,n=!1;for(let x=0;x<b.length;x++){const E=b[x].toString();if(this.ek.erf(b[x])){h||(h=E);if(n&&this.ek.Hs.objectId!==E)return this.ek.nZ(E);n=n||!!this.ek.Hs&&this.ek.Hs.objectId===E}}return h?this.ek.nZ(h):null}}Object(r.a)(sO,"CommentsActionManager",null,[]);var rG=d(1742),sG;(function(b){b[b.lzo=0]="commentDeeplink";b[b.catchUpActivity=
1]="catchUpActivity"})(sG||(sG={}));Object(r.b)("DeeplinkSource",sG);class tO{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc){this.ga=b;this.ii=h;this.nv=n;this.tje=x;this.IO=E;this.qZg=S;this.Wb=ma;this.sj=Fa;this.Xe=$a;this.zqb=sb;this.wje=Jb;this.DM=Sb;this.oGe=!1;this.rMn=Ic=>{if(this.Xe.uq&&!this.sj.en){const gd=new We.a(0,1,0,()=>{this.pWi(Ic)},136,void 0,!0);u.AFrameworkApplication.uc.$b(gd)}else this.pWi(Ic)};oc.execute(Ic=>{this.XM=Ic})}get Yp(){return this.ii}get Cb(){return this.zqb.value}tBh(b){let h=
b.Qq===Zk.a.beingCreated?b.Cy.draftId:b.id,n=null;b.Rf&&(h=b.Rf,n=()=>{this.qZg.selectComment(b.id)});this.IO.setInitialActiveContainerId(h,0,n)}FBn(b,h,n,x,E){if(!E.commentId)return 2;b=this.ii.xB(E.commentId);if(!b)return 2;this.Ejb(b,E);return 32}nUi(b,h){var n,x;if(b){var E=(null===(x=null===(n=this.ii.Hy)||void 0===n?void 0:n.Cy)||void 0===x?void 0:x.draftId)===b?this.ii.Hy:this.ii.xB(b);this.selectComment(E,h)}}selectComment(b,h){b&&this.Ejb(b,h)}lUi(b,h){var n=this.HDd(b);n&&((n=this.IDd(n,
0))?h.nZf?(this.sj.vab=Object.assign(new ME,{commentId:n.id,pOc:!0}),w.ULS.sendTraceTag(579608864,327,50,"Deep linking before comment pane fully loaded.")):(this.Ejb(n,Object.assign(new gv.a,{commentId:n.id,j3:1,lO:!0,IMc:!0})),this.Xe.uq&&void 0!==b&&null!==b&&this.tBh(n),yo.a.h1(u.AFrameworkApplication.uc,()=>{this.Wb.Jg(this.Xe.uq&&!this.sj.en?xd.AFrame.qL:xd.AFrame.fr)},rw.a.PHn),Dg.a.instance.Tf(si.a.Cvh,(new Date).getTime()),b=this.Xe.uq?"Deep linked discrete hosted comment":"Deep linked after comment pane fully loaded",
b+=", elapsed since boot: {0} ms",w.ULS.sendTraceTag(579608865,327,50,b,(new Date).getTime()-u.AFrameworkApplication.SV)):this.ga.processAction(Ra.a.d0a,2))}HDd(b){let h=null;var n=null;if(B.a.s6b(b))h=b;else if(({Dv:n}=z.d(b)).returnValue&&(b=n))return TF.a.comment in b&&(h=b[TF.a.comment]),h;h||(n=n?Object.keys(n):null,w.ULS.shipAssertTag(579608866,327,!1,"Unrecognized navigation id. {0}",n?n.join(","):"Not Json."));return h?h.toString():null}IDd(b,h){const n=this.ii.RGc(b),x=0===h;x&&this.DM.logKpiUsage(Dv.a.Fud,
0);if(!n){w.ULS.sendTraceTag(579608867,327,15,"Comment durableCommentId={0} not found for deep linking. Source: {1}",b,h);const E=new ca.a;E.name="DeepLinkSource";E.string=sG[h];this.DM.logActivity("CommentDeeplinkNotFound",{dataFields:[E]});x&&(h=new ab.a,h.extendedProperties=new Map([["ErrorLevel","warning"]]),this.DM.logKpiFailure(Dv.a.Fud,"CommentNotFound",{isIntentional:!1,isInternal:!0,additionalValues:h}),this.wje.VGm=b)}return n}pWi(b){this.oGe=!0;this.Cb.setSelection(b);this.oGe=!1}Ejb(b,
h){if(b){this.sj.CFb&&(u.AFrameworkApplication.uc.ef(this.sj.CFb),this.sj.CFb=null);var n=this.ii.Hs,x=this.Yp.iff(b),E=2===h.j3,S={};E&&(S.TriggeredByFindReplace=!0);if(this.sj.en)E&&(S.PaneAlreadyOpen=!0),Cj.UISurfaces.Xt().then(ma=>{ma.setSelectedTaskPane(rG.a.Nud);return null});else if(b.Qq!==Zk.a.beingCreated&&!this.Yp.gta(b))this.sj.VW?this.ga.processAction(ub.a.KX,2):this.sj.vab=Object.assign(new ME,{commentId:b.id,pOc:h.IMc}),E&&(S.OpeningPaneToSelect=!0);else if(this.Xe.uq){const ma=x.Qq===
Zk.a.beingCreated;ma?this.IO.ROa(x.Cy.draftId,0,h.lO):this.IO.ROa(x.id,0,h.lO);!ma&&E&&(S.SelectingDHC=!0)}yo.a.h1(u.AFrameworkApplication.uc,()=>{this.sj.VW&&(h.lO&&this.Wb.Jg(this.Xe.uq&&!this.sj.en?xd.AFrame.qL:xd.AFrame.fr),h.IMc&&this.Yp.gta(b)||!h.lO&&!h.j3||this.qZg.selectComment(b.id))},rw.a.CWf);E=this.Yp.iff(n);this.Xe.wra&&this.XM&&E&&E.id!==x.id&&this.XM.fireEvent(9,{comment:E});this.ii.selectComment(b);this.Xe.wra&&this.XM&&b.Qq===Zk.a.normal&&!b.Rf&&this.XM.fireEvent(8,{comment:b});
this.tje.highlightComment(b,!0);this.nv.$G(0,x,n);ob.App.xa.updateCommandUI(!0);0<Object.keys(S).length&&this.DM.KB(ub.a.selectComment,{customData:S})}}}Object(r.a)(tO,"CommentSelectionActor",null,[180]);class NE extends Bo.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new lh.a,{T_:NE.getTypeName(),B_:NE.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(r.a)(NE,"CommentSmartReplySignal",
Bo.a,[]);class tG extends un.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new lh.a,{T_:tG.getTypeName(),B_:tG.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(r.a)(tG,"SmartReply",un.a,[]);class uG{constructor(b){this.Hoa=b}GZb(b,h){return Object.assign(new as.a,{parentPath:["Signal",NE.getTypeName()],items:[Object.assign(new Po.a,
{body:Object.assign(new NE,{commentId:b,comment:h})})]})}GKf(b){const h=new Qa.a;if(b&&b.CommentId&&b.ResultSets&&0<b.ResultSets.length&&b.ResultSets[0].Documents&&0<b.ResultSets[0].Documents.length){for(const n of b.ResultSets[0].Documents)h.add(n.Caption);0<h.count&&this.Hoa.GKf(b.CommentId,h.toArray())}else w.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")}getTypeName(){return tG.getTypeName()}}Object(r.a)(uG,"BaseCommentSmartReplyProvider",null,[932]);class uO extends uG{constructor(b,
h,n,x){super(b);this.Jf=h;this.AJ=n;this.Puj=x}initialize(){this.AJ.zn().then(()=>{this.Jf.mb(this,uG.prototype.getTypeName.call(this))})}invoke(b,h){this.AJ.zn().then(()=>{this.Puj.getAugLoopRuntimeManager().submitOperation(Object.assign(new Np.a,{operation:this.GZb(b,h)}))})}mI(b,h){b&&vn.a.getTypeNameFor(b.content)===this.getTypeName()&&h===an.a.getTypeName()?this.GKf(b.content):w.ULS.sendTraceTag(579170963,327,10,"Invalid annotation event for smart replies")}}Object(r.a)(uO,"CommentSmartReplyProvider",
uG,[179]);class vO{constructor(b,h,n,x,E,S){this.Ma=b;this.wc=h;this.px=n;this.iwe=x;this.wje=E;this.lM=S;this.Gpb=!1;this.wje.zln();this.rxj=this.czl();this.MOf&&(af.a.addHandler(window.self,kb.a.h$g,()=>{this.Gpb=!0}),af.a.addHandler(window.self,kb.a.i$g,()=>{this.Gpb=!1}))}get Py(){return this.px?this.px.value:null}get cza(){return this.iwe.value}get gbo(){return this.Gpb}get SJc(){return 0<this.rxj}get uq(){return this.lM.uq}get aVk(){return!0}get cfk(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoPopulateShareTUIComment",
!1)}get gib(){return this.Ma.$("OutlineViewElementDisplayWrapperForDhcsIsEnabled")}get HKb(){return this.wc.isFeatureEnabled(125)&&!Kb.App.LNc}get TCn(){return this.wc.isFeatureEnabled(38)&&this.Ma.$("SendErrorReportOnCommentInboundCrashIsEnabled")}get xUd(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.newCommentEntryPointEnabled",!1)}get DJa(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentSVGIconsEnabled",!1)}get UVl(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.HiddenRibbonCommentFocusFixEnabled",
!1)}get p3d(){return this.wc.isFeatureEnabled(18)}get jnh(){return this.Ma.$("CommentAnchorHighlightOnIpSelectionIsEnabled")}get MOf(){return this.Ma.$("RecordCommentActionsInTypingIsEnabled")}get isi(){return this.Ma.$("NoHighlightWhenCommentDraftInProgressIsEnabled")}get Gxb(){return this.uq&&!this.SJc&&!this.Ma.lb("BootActivityNavigationId")&&V.a.Vs}get uvb(){return this.wc.isFeatureEnabled(6)}get cek(){return this.Ma.$("AtMentionUserFloodGateCampaignIsEnabled")}get Nyk(){return this.Ma.$("CommentFriendlyTimestampsIsEnabled")}get WUk(){return this.Ma.lb("DisabledChangeGatesInSharedComments")}get bCd(){return this.lM.bCd}get bKb(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordTrackChangesSimpleMarkupView",
!1)}get y$a(){return this.wc.isFeatureEnabled(15)}get Z_f(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartRepliesIsEnabled",!1)}get uX(){return this.Ma.lb("PresenceUserId")}get removePersonalInformation(){return Kb.App.Tce&&!!Nd.PageReader.instance&&Nd.PageReader.instance.rea(ob.App.xa.jb.Zc).removePersonalInformation}get wCb(){return this.wc.isFeatureEnabled(55)}get Obb(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableDurableIdForIdentification",
!1)}get tqm(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.SharedCommentsLivePersonaCardForWeb",!1)}get s4n(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",!1)}get ozk(){return this.Ma.$("CommentsTasksFpsIsEnabled")}get trackChangeInSidetrackEnabled(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.TCCardInSideTrack",!1)}get azk(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReactionsFPSEnabled",
!1)}get vpm(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.LikeSelectedContentFlotie",!1)}get contentNavigationApiEnabled(){return this.lM.contentNavigationApiEnabled}get WYm(){return this.wc.isFeatureEnabled(91)}get wra(){return this.Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentEventAPIEnabled",!1)}get contentFilterApiEnabled(){return this.lM.contentFilterApiEnabled}czl(){if(this.Py&&this.cza){const b=new md.GraphIterator;b.set(this.Py);this.cza.Z_a(b);let h=
0;39===b.Se&&(h=b.Hp());return h}return-1}}Object(r.a)(vO,"CommentsSettings",null,[]);var wO=d(1555);class xO{constructor(b){this.X7=b}Pfh(b,h,n){const x=new bI;h=this.X7.e_a(h)?h.objectId:null;if(!h)return x;h=C.a.Of(h);if(n.contains(h))return x.nLc=0,x.mLc=b.length,x;for(let S=0,ma=b.length;S<ma;S++){var E=b[S];n=mk.g(E);E=mk.d(E);n&&QF.a.cph(n,h)&&(x.nLc=S);if(E&&QF.a.cph(E,h)){x.mLc=S;break}}return x}kbh(b,h,n){const x=-1===h.nLc&&-1===h.mLc,E=-1<h.nLc?h.nLc:-1;h=-1<h.mLc?h.mLc:b.length;const S=
!x&&E===h;var ma=!1;for(let Fa=0;Fa<b.length;Fa++){const $a=b[Fa],sb=pl.a($a);if(1!==sb&&2!==sb&&3!==sb)continue;this.X7.s1a($a);if(x||Fa<E||Fa>h)continue;const Jb=3===sb||2===sb&&-1!==$a.className.indexOf(Eh.a.FLa),Sb=n?1:2;this.Zbk(Fa,E,h,Sb,Jb,ma,$a,S);if(Fa!==h||S)(ma=this.X7.LYa.J(sb).J(Sb))&&$a.classList.add(ma),ma=Jb}}Zbk(b,h,n,x,E,S,ma,Fa){b!==h&&b!==n||E||S||((b=this.X7.lac.J(x))&&ma.classList.add(b),Fa&&ma.classList.add(Eh.a.gKf))}}Object(r.a)(xO,"DefaultHighlightChangeHandler",null,[178]);
var vG;(function(b){b[b.success=0]="success";b[b.noSelection=1]="noSelection";b[b.invalidContent=2]="invalidContent"})(vG||(vG={}));Object(r.b)("AnchorCreationResult",vG);class yO{}Object(r.a)(yO,"EditorAnchorInfo",null,[209]);class Qy{constructor(b,h,n,x,E,S,ma,Fa){this.Wom=b;this.Kuf=h;this.ek=n;this.XYa=x;this.bza=E;this.Du=S;this.rS=ma;this.gr=Fa;this.hZg=null;this.XYa.Yib(this.bza);this.gr.contentFilterApiEnabled&&(this.rS.Zfa("OnCommentPaneOpen",this.Ugo.bind(this)),this.rS.Zfa("OnCommentPaneClose",
this.Tgo.bind(this)),this.rS.Zfa("OnContentFilterUpdate",this.ISc.bind(this)))}get Cb(){return this.Kuf.value}get Qi(){return this.Wom.value}initialize(){}o1l(b){this.hZg=b}dispose(){}MYa(b){this.bza.MYa(b)}mBb(b){this.bza.mBb(b)}highlightComment(b){this.kUi(b,!1);this.bza.MYa(b.objectId)}Igc(b){this.bza.Igc(b)}CAa(b){return this.bza.CAa(b)}ISc(){this.Cee("OnContentFilterUpdate")}Ugo(){this.Cee("OnCommentPaneOpen")}Tgo(){this.Cee("OnCommentPaneClose")}Cee(b){const h=[],n=new Set;for(let E of this.ek.aT())if(!E.Rf&&
E.Qq!==Zk.a.beingCreated&&!this.ek.MJ.hih(b,E)){var x=this.Uzl(E);n.has(x.id.toString())||(n.add(x.id.toString()),x=x.De(cb.InteractiveViewManager.instance.xd.Tb),h.push(x))}h.forEach(E=>{this.XYa.Jgc(E)})}Uzl(b){var h,n;const x=null===(h=this.Qi)||void 0===h?void 0:h.Eb(b.objectId);if(!x)return null;b=mk.k(x);h=null===(n=this.Qi)||void 0===n?void 0:n.Eb(b);return uA.a.gUh(h)}kUi(b,h){if(!b.Qq){var n=this.Qi.Eb(C.a.Of(b.objectId)),x=td.a.Z9(n,this.Qi,!0);n=td.a.Z9(n,this.Qi,!1);if(x&&n){const E=x.Ob.paragraph;
x=x.Ob.cp;if(this.rim(E,x))ob.App.xa.updateCommandUI(!0);else{x=Ae.SelectionFactory.xe(E,x);n=Dd.a.Uc(n.Ob.paragraph,n.Ob.cp);if(Qy.Zf.L$(x.Qa)||Qy.Zf.L$(n))b.l6b=!0,b.W_a();b=h?Ae.SelectionFactory.MC(x,n):x;this.hZg(b)}}}}Luk(){this.bza.mBb(null);this.bza.MYa(null)}tFk(){let b=new yO;return{returnValue:vG.success,anchor:b}}rim(b,h){if(b&&Object(pb.a)(OL.PageView,this.Du.xd)){var n=b.De(this.Du.xd.Tb);b=document.getElementById(Qe.AppFrame.fFa);if(n&&b){h=Md.a.qq(n,h);if(!h)return!1;h=h.y;n=Sys.UI.DomElement.getBounds(b).y;
b=b.offsetHeight;if(h>=n&&h<=n+b)return!0}}return!1}static get Zf(){return Ai.a.instance}static getInstance(){return Qy.Fl()}static Fl(){return Qy._instance||(Qy._instance=new Qy(new se.a(()=>ob.App.xa.jb.Zc.Ad),new se.a(()=>kh.a.instance),Oa.a.instance.resolve("WordEditor.Comments.IEditorCommentModel"),Oa.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,Oa.a.instance.resolve("WordEditor.Comments.CommentHintActor"),cb.InteractiveViewManager.instance,Oa.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),
Oa.a.instance.resolve("WordEditor.Comments.CommentsSettings")))}}Qy._instance=null;Object(r.a)(Qy,"EditorCommentHintManager",null,[176,177,10]);var HB=d(1889),FQ=d(1116);class Iz extends sj.a{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd,Gd,vd,ce,od,Yd,ne,Df,Af,Wi,gm,Ck){super(ma);this.zi=h;this.zqb=Fa;this.AWe=sb;this.Ioa=Jb;this.okc=Sb;this.IO=oc;this.Xe=Ic;this.xp=gd;this.znb=Gd;this.sj=vd;this.f4=ce;this.le=Yd;this.DM=ne;this.Ih=Df;this.sS=Wi;this.FWe=gm;this.d3h=this.e0g=this.bSa=null;this.yhb=
()=>{this.$va.uta()&&(this.GKi(this.$va.Jc),this.$va.Ebc(this.yhb))};this.qRc=Rm=>{2===Rm.mode?this.gC=1:1===Rm.mode&&(this.gC=0);this.ii.Hy&&0===this.gC?w.ULS.sendTraceTag(542914062,327,50,"Switch to read only mode while drafting a comment with drafting session type [{0}].",this.ii.Hy.Cy.sessionType):this.sj.VW&&(this.Dz||this.i0.isVisible)&&this.GHb()};this.LMm=()=>{this.sj.xBb?this.mode=0:this.gC=0};this.NCa=(Rm,Qr)=>{var ls;Rm=Qr.kl.kb;if((this.Dz||this.waa&&this.waa.isVisible)&&!this.znb.oGe&&
Rm){Qr=Kd.SelectionEditor.Km(Rm);var pw=Rm.JL;!this.Xe.xUd||null!==(ls=this.d3h)&&void 0!==ls&&ls.N9||(ls=this.Yp.mfb(this.ga,!1),1!==this.mode||Qr&&!pw||!ls?this.okc.bKd():this.fJk(Rm));2!==this.mode&&3!==this.mode&&this.Xe.jnh&&this.z$n(Rm,Qr,pw)}};this.zsk=()=>{if(this.ek&&this.ek.Hy&&(!ob.App.BMa||!ob.App.Bnf)){var Rm=this.ek.Hy;Rm.Cy.sessionType!==HB.a.metadata&&(w.ULS.sendTraceTag(545640771,327,15,`Draft Comment of type:${Rm.Qq} present on app shutdown`),(Rm=uA.a.qol(Rm))&&this.DM.logKpiFailure(Rm,
"CommentDraftLostOnAppShutdown",{isInternal:!0},{name:Dv.a.Hud,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}))}};this.UMm=()=>{if(this.sj.VW){var Rm=()=>!0;this.Dz&&!this.sj.en&&(Rm=Qr=>this.Yp.gta(Qr));Rm=this.Yp.yaf(Rm);this.GHb(Rm)}};this.ga=ma;this.gC=1===this.ga.mode?0:1;this.i0=E;this.ii=x;this.j8=S;this.Wb=$a;this.zkn();n.Xib(this.Ioa);(this.Xe.jnh||this.Xe.xUd)&&this.Cb.OD(this.NCa);b.CWR(()=>b.result.QA.TUa(this.LMm));u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.RUa(this.qRc);
this.f4.Zfa("OnAfterTrackChangeMarkupViewChange",this.UMm);u.AFrameworkApplication.rK&&u.AFrameworkApplication.rK(this.zsk);Ck.execute(Rm=>{this.XM=Rm});Af.execute(Rm=>{Rm.YCk.execute(Qr=>{this.d3h=Qr})})}zkn(){this.$va&&(this.$va.uta()?this.GKi(this.$va.Jc):this.$va.vWb(this.yhb))}GKi(b){b.jja(()=>{this.R_n()})}get $va(){var b;return null===(b=Kb.App.fm)||void 0===b?void 0:b.jb}get Cb(){return this.zqb.value}get ek(){return this.ii}get Yp(){return this.ii}get Dz(){return this.Xe.uq}get Sri(){return!0}get l4b(){return this.bSa}set l4b(b){this.bSa=
b}get mode(){return super.mode}set mode(b){b!==this.gC&&(super.mode=b,this.W_a())}get Rz(){return this.model&&this.model.Hs?this.model.Hs.Rf?this.model.xB(this.model.Hs.Rf):this.model.Hs:null}get Qi(){return this.zi.value}get E2i(){return!1}get removePersonalInformation(){return this.Xe.removePersonalInformation}GHb(b=null,h=null){const n=this.Yp,x=!this.gC,E=this.waa.Lyk,S=n.TFd();E.l7f(S?5:1,x);b=this.Xe.bKb&&b?b:n.Saf(this.Xe.bKb&&this.Dz&&!this.sj.en);E.OCn(b,S,n.VQa);this.S6f();h&&w.ULS.sendTraceTag(572281362,
327,50,h)}JSc(b,h,n=!1){this.sj.en?this.IO.Tgj():h?this.IO.deleteContainer(b.Qq===Zk.a.beingCreated?b.Cy.draftId:b.id,0,n):this.odn(b)}odn(b){const {a6n:h}=this.ii.Btl(b),n=this.j8.CAa(b.objectId);n&&this.IO.addContainer(b.id,n.parentElement,0,h)}uUi(b){const h=this.Rz;this.JYc();this.Ioa.$G(0,this.ii.Hs,h);this.Dz&&this.ii.Hs&&!this.sj.en&&this.IO.ROa(this.ii.Hs.id,0,1===b)}PBn(){const b=this.Rz;this.KYc();this.Ioa.$G(0,this.ii.Hs,b);this.Dz&&this.ii.Hs&&!this.sj.en&&this.IO.ROa(this.ii.Hs.id,0,
!1)}Igc(b){this.j8.Igc(b)}ZZk(b,h){this.IO.addContainer(b,null,0,h)}I1m(b){this.IO.CCi(b)}a_k(b,h){this.IO.rXc(b,h,0)}ego(){this.IO.LQe()}mUi(b){if(b&&(2!==this.mode||b.Qq===Zk.a.beingCreated)){var h=this.ii.Hs;h!==b&&(this.ii.selectComment(b),this.i0.isVisible?this.sj.VW?(this.i0.selectComment(b,1),this.Vha.selectComment(b.id)):this.sj.vab=Object.assign(new ME,{commentId:b.id,pOc:!1}):this.Dz&&!b.done&&(this.qUi(b.id,!1),this.Vha.selectComment(b.id)),!this.i0.isVisible&&this.Dz&&b.done||(this.f4b.MYa(b.objectId),
this.Ioa.$G(0,this.Rz,h)))}}zLc(){}f5e(){this.sj.xBb=!1}Cub(b){this.Xe.isi&&this.ii.Hs&&this.clearSelection();super.Cub(b);this.DM.logKpiUsage(Dv.a.MWe,0);this.S6f();if(this.Dz){const h=this.ii.rKl(b.draftId);this.ZZk(b.draftId,h)}}addReply(b,h){this.DM.logKpiUsage(Dv.a.Pud,0);super.addReply(b,h)}xra(b){this.Dz&&null!=b.Cy&&this.ii.ILi(b.Cy.draftId);super.xra(b);this.j8.MYa(b.objectId);w.ULS.sendTraceTag(50426376,327,50,"{0}:  added by user action.",mk.a(b));this.DM.logKpiUsage(Dv.a.pnh,0);this.Dsk(b);
uA.a.Ino(b,this.Qi,this.DM);this.DM.KB(ub.a.onh,{succeeded:!0,customData:{actionType:b.Rf?HB.a.reply:HB.a.create}})}xab(b){super.xab(b);this.DM.KB(ub.a.onh,{succeeded:!0,customData:{actionType:HB.a.edit}})}Dsk(b){if(b.Rf){var h=this.ii.iff(b);if(h.MWb&&h.NWb){var n=this.Qi.Eb(C.a.Of(h.NWb));h=h.NWb===h.MWb?null:this.Qi.Eb(C.a.Of(h.MWb));uA.a.kbg(n,b,!0);uA.a.kbg(h,b,!1)}}}VCc(b){super.VCc(b);this.Rz&&this.Rz.id===b.id&&(super.clearSelection(),this.Dz&&this.IO.BYb());if(this.Dz)if(mk.q(b)){var h=[];
let n=null;for(let x of this.model.aT())x!==b&&(x.Rf===b.Rf&&h.push(x),x.id===b.Rf&&(n=x));n&&n.id&&n.objectId&&!n.done&&this.Yp.AF(n.objectId)&&!this.Yp.nDi(n.objectId)&&!h.length&&this.JSc(n,!0)}else h=b.Qq===Zk.a.beingCreated,b.done||this.JSc(b,!0),h&&this.ii.ILi(b.Cy.draftId)}editComment(b,h){1===this.mode&&b&&(this.ii.ZDc(b,h),HB.a.edit===h.sessionType&&this.DM.logKpiUsage(Dv.a.unh,0),this.Xe.HKb&&3!==HB.a.sdf(h.sessionType)?this.znb.selectComment(b,Object.assign(new gv.a,{lO:!1,j3:0})):this.Xe.y$a||
this.znb.selectComment(b,Object.assign(new gv.a,{lO:!1,j3:0})))}r4d(b){this.Dz&&!this.sj.en||super.r4d(b)}deleteComment(b){b.Qq!==Zk.a.beingCreated&&this.Yp.Pwh(C.a.Of(b.objectId));this.bSa&&this.bSa.id===b.id&&(this.ii.Hs&&this.bSa.id===this.ii.Hs.id?this.bSa=null:this.Ioa.yVe());!this.ii.Hs||this.ii.Hs.id!==b.id&&this.ii.Hs.Rf!==b.id?this.ii.Hs&&this.Ioa.$G(0,this.ii.Hs,null):void 0===b.Rf||null===b.Rf?this.clearSelection():this.ii.selectComment(this.ii.xB(b.Rf));b.l6b&&w.ULS.sendTraceTag(556360779,
327,50,"The comment selected for deletion is currently locked: {0}.",mk.a(b));super.deleteComment(b);w.ULS.sendTraceTag(50426377,327,50,`${mk.a(b)} deleted by user action. DurableId: ${b.cKa}`)}awb(b,h){super.awb(b,h);this.Dz&&!this.sj.en&&h&&(this.ii.Hs&&this.ii.Hs.id===b.id&&this.clearSelection(),this.l4b&&this.l4b.id===b.id&&this.Ioa.yVe())}OBn(b=null){(b=this.Yp.fkl(b))?this.znb.selectComment(b,Object.assign(new gv.a,{lO:!0,j3:1})):this.uUi(1)}fJk(b){var h=b.Qa.node;let n=wf.OutlineElementNavigator.Uk(h);
this.Ih.Pd(()=>{const E=md.GraphIterator.$a(n);let S=null;do E.qo()&&(S=E.parentNode?wf.OutlineElementNavigator.Uk(E.parentNode):null)&&(n=S,E.set(n));while(S)},"ECM:FOOE");if(null===n||void 0===n?0:n.pD)for(var x of n.pD)if(x&&x instanceof vu.a){const E=FQ.a.eth(x);this.okc.gce=this.E5k(h,b);b=this.Nnk(E);if(h=this.okc.t5k(E,b))E.oBa[b].appendChild(h),x.ax(h);break}}E5k(b,h){let n;for(let x of b.pD)if(x&&x){n=x;break}b=h.Qa.gl;return 0>b||null===n||void 0===n||!n.eop?null:Md.a.UY(b,n,!1,!1)}Nnk(b){var h;
if(!b.w$||2>b.w$.length)return 0;let n=0;const x=null===(h=this.okc.gce)||void 0===h?void 0:h.y;for(h=1;h<b.w$.length;h++)if(x>=b.w$[h].y-2)n=h;else break;return n}W_a(){ob.App.BMa&&(ob.App.Xdb=2===this.mode||3===this.mode);1!==this.mode&&this.okc.bKd()}z$n(b,h,n){const x=this.Wb.xg;let E=null;if(h||n){h=b.Qa.cpBegin;b=b.Qa.node;if(this.Rz&&mk.p(this.Rz,b,this.Qi,h))return;E=this.Txl(b,h)}E?!this.Dz||this.sj.en?yo.a.h1(u.AFrameworkApplication.uc,()=>{this.mUi(E)},rw.a.HBn):this.mUi(E):!this.ii.Hs||
x&&x.name===xd.AFrame.qL||this.clearSelection()}Txl(b,h){let n=null;const x=this.model.aT();for(let E=x.length-1;0<=E;E--){const S=x[E];if(S.objectId&&!(S.Rf||this.Dz&&!this.waa.isVisible&&S.done)&&mk.p(S,b,this.Qi,h)){n=S;break}}return n}selectComment(b,h=1){this.znb.nUi(b,Object.assign(new gv.a,{lO:1===h,j3:h}))}qUi(b,h){const n=this.ii.xB(b);n?this.Dz&&!mk.q(n)&&n.Qq!==Zk.a.beingCreated&&this.IO.ROa(b,0,h):w.ULS.sendTraceTag(42332933,327,10,"Selected Comment isn't in the model.")}clearSelection(){const b=
this.model.Hs;this.Xe.wra&&this.XM&&b&&this.XM.fireEvent(9,{comment:b});super.clearSelection();this.Ioa.$G(1,b,b);this.Dz&&b&&this.IO.BYb()}Shm(){var b;return 500>(null===(b=this.e0g)||void 0===b?void 0:b.ni)}Q9b(b,h=1){if(!this.Xe.isi||!this.ii.Hy){var n=this.ii.xB(b),x=null;n||(x=this.bSa);var E=this.Shm(),S=!1;1===h&&this.Vha&&(E?S=!0:this.Vha.highlightComment(b));b?n?E?S=!0:this.j8.mBb(n.objectId):w.ULS.sendTraceTag(37323346,327,10,"Comment is NOT in the model, but we are trying to hightlight!"):
this.j8.mBb(null);n?E?S=!0:(this.bSa=n,this.Ioa.$G(2,n,x)):(this.bSa=null,this.Ioa.$G(3,null,x));S&&w.ULS.sendTraceTag(544532572,327,50,"Comment highlighting was skipped due to the user actively scrolling.")}}R_n(){this.le&&(this.e0g=this.le.fg("UserAction","StartScrollDetectionStopwatch"))}notify(b,h){this.xp.sendNotification(b,h)}S6f(){this.FWe.onContentChanged()}hih(b,h){var n,x;switch(b){case "OnCommentPaneOpen":case "OnCommentPaneClose":return this.Yp.gta(h)===this.FWe.isContentInFilteredContent(h.id);
case "OnContentFilterUpdate":return!(null===(x=(n=this.FWe).isContentInFilterUpdateDiff)||void 0===x?0:x.call(n,h.id));default:return!0}}static getInstance(){return Iz.Fl()}static Fl(){Iz.Kg||(Iz.Kg=new Iz(ob.App.jla(),new se.a(()=>ob.App.xa.jb.Zc.Ad),Oa.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance,Oa.a.instance.resolve("Common.Comments.ICommentModel"),Oa.a.instance.resolve("Common.Comments.ICommentPane"),Qy.getInstance(),u.AFrameworkApplication.ya,new se.a(()=>kh.a.instance),
de.FocusManager.instance(),Oa.a.instance.resolve("WordEditor.Comments.IWordEditorSharedCommentAPI"),Oa.a.instance.resolve("WordEditor.Comments.ICommentHighlightActor"),Oa.a.instance.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),Oa.a.instance.resolve("WordEditor.Comments.IFloatingCommentManager"),Oa.a.instance.resolve("WordEditor.Comments.CommentsSettings"),Oa.a.instance.resolve("Common.Utils.IAriaNotifier"),Oa.a.instance.resolve("WordEditor.Comments.ICommentSelectionActor"),Oa.a.instance.resolve("WordEditor.Comments.CommentsState"),
Oa.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),Kb.App.fm.jb.Jc,ob.App.xa.iq,Oa.a.instance.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),oo.a.instance,Oa.a.instance.Za("WordEditor.HeaderFooter.HeaderFooterControlOwner"),Oa.a.instance.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),Oa.a.instance.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),Oa.a.instance.Za("WordEditor.Extension.RichApiEventManager")),Iz.Kg.vJb=!0);return Iz.Kg}}
Iz.Kg=null;Object(r.a)(Iz,"EditorCommentManager",sj.a,[170,171,172,10]);var GQ=d(1679);class hI{constructor(b,h,n,x){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=b;this.body=h;this.confirmButton=n;this.cancelButton=x}}Object(r.a)(hI,"ViewContainerModalDialogStrings",null,[]);d(1448);class vD{constructor(b,h){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;
this.canvasActionId=b;this.canvasContextId=h}}Object(r.a)(vD,"CommentUIAction",null,[]);class zO{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd,Gd,vd){this.ga=b;this.gg=h;this.re=n;this.Wb=x;this.Mo=E;this.Dh=S;this.fP=ma;this.Hoa=Fa;this.nod=$a;this.OKe=sb;this.Hb=Jb;this.IO=Sb;this.Xe=oc;this.sj=Ic;this.znb=gd;this.f4=Gd;this.Rha=vd;this.tje=this.$i=null;this.lZg=this.Fsg=!1;this.stc=null;this.jVn=(ce,od,Yd)=>2!==Yd||this.sj.VW?1===Yd?32:2:(this.f4.fna("OnCommentInit",Object.assign(new LE.a,
{ACa:()=>{this.ga.processAction(Ra.a.KX,2)}})),32);this.Y5h=(ce,od,Yd)=>1!==Yd||this.sj.VW?2:8;this.j_j=(ce,od,Yd)=>{if(1===Yd)return!this.mfb()||this.f$a?8:this.sj.VW?2:32;if(!this.sj.VW)return this.f$a=!0,this.f4.fna("OnCommentInit",Object.assign(new LE.a,{ACa:()=>{this.uq||this.sj.en||this.ga.processAction(Ra.a.KX,2)}})),32;this.uq||this.sj.en||this.ga.processAction(Ra.a.KX,2);(this.uq||this.sj.en)&&this.Wb.Jg(this.sj.en?xd.AFrame.fr:xd.AFrame.qL);return 2};this.gQk=(ce,od,Yd)=>1===Yd&&Vh.SessionStatusManager.instance.Qj?
8:2;this.FUk=(ce,od,Yd,ne)=>1!==ne||(this.uq||this.isVisible)&&this.$i.model.Hs?ce||this.$i.model.Hs?32:8:8;this.leb=(ce,od,Yd,ne,Df)=>{if(1===Yd||!this.sj.en)return 32;if(!this.uq&&2===Yd&&(2===this.$i.mode||3===this.$i.mode))return Df=new hI(CommentPaneStrings.DiscardDialogTitle,CommentPaneStrings.DiscardDialogBody,CommentPaneStrings.DiscardDialogAbandon,CommentPaneStrings.DiscardDialogResume),this.nod.invokeModalConfirmationDialog(()=>{this.JOm(ce,od,Yd,ne)},()=>{this.NNm()},Df),32;this.dKd();
if(this.uq)return 32;Df&&this.rBh();return 32};this.rHb=(ce,od,Yd,ne,Df)=>{if(1===Yd)return 32;Df[Qf.a.On]=this.isVisible;return 32};this.ric=this.pFk()}get isVisible(){return this.sj.en}get f$a(){return this.Fsg}set f$a(b){this.Fsg=b}get xPn(){return"SharedCommentsTaskPaneProps"}get JTc(){return null}get Eri(){return null}get QS(){return this.Mo}get waa(){return null}get Lyk(){return this.Hoa}get uq(){try{return this.Xe.uq}catch(b){return!1}}ySh(){return new gI(u.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,
u.AFrameworkApplication.uiCulture,u.AFrameworkApplication.dataCulture)}pFk(){const b=new Do.a,h=new vD(Ra.a.newComment,Ld.a.frame);h.preCallback=this.j_j;const n=new vD(ub.a.rCf,Ld.a.frame),x=new vD(ub.a.rLf,Ld.a.frame),E=new vD(ub.a.deleteComment,Ld.a.frame);E.preCallback=this.gQk;E.postCallback=this.FUk;this.uq&&(n.preCallback=this.Y5h,x.preCallback=this.Y5h);const S=new vD(Ra.a.KX,Ld.a.frame);S.preCallback=this.jVn;b.Z(6,S);b.Z(0,h);b.Z(1,n);b.Z(2,x);b.Z(3,E);return b}M_i(b){this.lZg||(this.MVj=
this.HGd(),this.fP.PJa(),this.LOn(),this.HOn(b),this.lZg=!0)}HOn(b){this.$i=b;this.tje=b.f4b;this.$i.zDh=this.Hoa}initialize(b){this.M_i(b);this.Vb()}bmf(){this.stc&&this.Wb.Jg(xd.AFrame.fr);this.f$a&&!this.uq?(this.ga.processAction(Ra.a.newComment,2),this.f$a=!1):this.sj.vab&&yo.a.h1(u.AFrameworkApplication.uc,()=>{const b=this.sj.vab.commentId,h=this.sj.vab.pOc;this.ga.Xb(ub.a.selectComment,2,Object.assign(new gv.a,{commentId:b,j3:1,lO:!0,IMc:h}));h&&(yo.a.h1(u.AFrameworkApplication.uc,()=>{this.Wb.Jg(xd.AFrame.fr)},
rw.a.CWf),Dg.a.instance.Tf(si.a.Cvh,(new Date).getTime()));w.ULS.sendTraceTag(35149083,327,50,"Comment selected in shared comment pane after boot: {0}",(new Date).getTime()-u.AFrameworkApplication.SV);this.sj.vab=null},rw.a.GBn)}dispose(){}r3(){}selectComment(){this.isVisible||this.uq||this.i3i();this.Dh.updateCommandUI(!0)}Vb(){this.ga.pa(Ra.a.leb,Ld.a.frame,this.leb);this.ga.gb(Ra.a.rHb,Ld.a.frame,this.rHb,96)}W_a(){-1!==this.$i.mode&&(this.$i.mode||this.rBh())}rBh(){const b=this.$i,h=b.Yp,n=h.TFd(),
x=h.Saf(this.Xe.bKb&&this.Xe.uq&&!this.sj.en);this.Hoa.NCn(x.length,n,!b.mode,n?5:1);this.Hoa.iDn(x,h.VQa)}LOn(){const b=this.Wb.pe(xd.AFrame.fr);b.parent=xd.AFrame.Lp;b.LL=!0;b.ZSf=!0;b.Ugc=!0;b.Dub((h,n)=>{oG.a.gih(n.name)&&(this.sj.CFb=yo.a.h1(this.Hb,()=>{n.name!==xd.AFrame.qL&&2!==this.$i.mode&&3!==this.$i.mode&&(this.$i.clearSelection(),this.Dh.updateCommandUI(!0));this.sj.CFb=null},rw.a.yOm))});this.Mo.kS(xd.AFrame.fr);if(this.Xe.uvb)for(let h of mk.s)b.bindAction(mc.KeyInputManager.uF(h),
ub.a.oTe)}CHn(){this.stc&&this.OKe.kal()}ckh(){this.jCj&&this.CHn()}JOm(b,h,n,x){const E=this.$i,S=E.Yp.Hy;S&&S.Cy?E.AWe.endCommentSession(S.Cy.draftId):w.ULS.sendTraceTag(40130755,327,10,"Attempting to discard when there is no active draft!");this.leb(b,h,n,x,!0);yo.a.h1(this.Hb,()=>{this.Dh.updateCommandUI(!0)},rw.a.Hxn)}NNm(){this.stc&&this.Wb.Jg(xd.AFrame.fr);this.Dh.updateCommandUI(!0)}oDa(b){b.Ar(this.Wb.uV);b.Ar(this.Wb.vV)}QJb(b,h,n){if(1===n)return 32;this.i3i();return 32}i3i(){this.isVisible||
(this.sj.VW?(this.xVk(),this.sj.en=!0,this.f4.j1d(),this.Wb.kxc(xd.AFrame.fr),this.uq&&this.Xe.bKb&&this.$i.GHb(this.$i.model.yaf(()=>!0)),this.jCj=!0,Cj.UISurfaces.Xt().then(b=>{b.showTaskPane(rG.a.Nud,this.MVj);return null}).catch(()=>{w.ULS.sendTraceTag(559273377,327,10,"Error showing comment task pane.")}),this.$i.Q9b(null),this.Dh.updateCommandUI(!0),this.oDa(this.Wb.pe(xd.AFrame.fr)),this.f4.fna("OnCommentPaneOpen"),w.ULS.sendTraceTag(37007903,327,50,"New Comment Pane opened.")):this.f4.fna("OnCommentInit",
Object.assign(new LE.a,{ACa:()=>{this.sj.en||this.ga.processAction(Ra.a.KX,2)}})))}xVk(){this.ga.Xb(ub.a.L9,2,null);this.ga.Xb(ub.a.ES,2,null)}mfb(){return this.Rha.mfb(this.ga,!1)}Cub(){}show(){this.isVisible||this.ga.processAction(Ra.a.KX,2)}editComment(){return 2}dKd(){this.$i.paneClosing();this.sj.en=!1;if(this.uq&&this.Xe.bKb){const h=this.$i.model;this.$i.GHb(h.yaf(n=>h.gta(n)))}var b=de.FocusManager.instance();b.xg&&b.xg.name===xd.AFrame.fr&&b.Jg(this.uq&&(2===this.$i.mode||3===this.$i.mode||
this.$i.ek.Hs)?xd.AFrame.qL:b.AS);this.Mo.Hw(xd.AFrame.fr);this.Wb.ICc(xd.AFrame.fr);Cj.UISurfaces.Xt().then(h=>{h.hideTaskPane(rG.a.Nud,2);return null}).catch(()=>{w.ULS.sendTraceTag(559273378,327,10,"Error hiding Comment Pane.")});this.uq&&(b=this.$i.model.Hs)&&this.hfo(b);this.f4.fna("OnCommentPaneClose");w.ULS.sendTraceTag(572281360,327,50,"New Comment Pane closed.")}hfo(b){b.done?this.$i.clearSelection():this.znb.tBh(b)}bWm(b=null){this.OKe.g_i(3);this.bmf();if(b){this.ckh();af.a.IPf(b,[kb.a.contextMenu]);
const h=this.Wb.pe(xd.AFrame.fr);this.gg.Cpd(xd.AFrame.fr,b,h.Ugc)}}VTm(b){this.Mo.tG(xd.AFrame.fr);1!==b&&yo.a.h1(u.AFrameworkApplication.uc,()=>{this.Wb.YB(xd.AFrame.fr)},rw.a.CWf)}onTaskPaneClose(){this.sj.VW&&this.OKe.g_i(1)}HGd(){const b={type:this.xPn,xBo:this.ckh};return Object.assign(new sp.a,{title:WordEditorIntl.WordEditorStrings.L_Comments,contentProps:b,hideHeader:!1,width:300,location:2,onOpen:h=>{this.stc=h;this.bWm(h);this.IO.s4f(!0)},onClose:()=>{this.stc=null;this.ga.Xb(Ra.a.leb,
2,!0);this.Dh.updateCommandUI(!0);this.onTaskPaneClose();this.IO.s4f(!1)},onShow:h=>{this.VTm(h)}})}KX(){return 32}}Object(r.a)(zO,"OfficeSharedCommentPane",null,[10,166,167]);var HQ=d(1608);class AO{constructor(b,h){this.containerType="full-pane";this.identifier=null;this.ga=b;this.identifier=h}openView(){this.ga.processAction(Ra.a.QJb,2)}closeView(){this.ga.Xb(Ra.a.leb,2,!0)}invokeModalConfirmationDialog(b,h,n){const x=new yd.StandardDialog;n&&n.title&&n.body&&n.confirmButton&&n.cancelButton||(w.ULS.sendTraceTag(35678229,
327,10,"InvokeModalConfirmationDialog: No localized strings provided."),n=new hI("","","",""));x.Ed=1;x.We(1,n.confirmButton);x.We(0,n.cancelButton);x.Lv(n.title,n.body,1,E=>{1===E?b():h()})}}Object(r.a)(AO,"ViewContainerAPI",null,[164,165]);class BO{constructor(b,h,n){this.p8n=b;this.ti=h;this.wEa=n;this.fe=new Ge.a;this.p8n.execute(x=>{this.wEa.S1d("OnBeforeTrackChangeMarkupViewChange",(E,S)=>{S&&S.gCf!==x.Oi&&this.fe.raiseEvent("OnBeforeTrackChangeMarkupViewChange",S)});this.wEa.S1d("OnAfterTrackChangeMarkupViewChangeEventKey",
(E,S)=>{S&&S.Oi===x.Oi&&(wO.a.Oi=x.Oi,this.fe.raiseEvent("OnAfterTrackChangeMarkupViewChange",S))})})}Zfa(b,h){this.fe.addHandler(b,h)}fna(b,h){this.fe.raiseEvent(b,h)}j1d(){this.ti.oOf||(this.ti.oOf=!0,this.fe.raiseEvent("OnCommentRenderedOnce"))}}Object(r.a)(BO,"WordCommentEventsActor",null,[]);var wG=d(1739);class iI{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(r.a)(iI,"InitCommentSessionResult",null,
[]);class CO extends iI{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(r.a)(CO,"BeginDraftingHostResult",iI,[]);var IQ=d(1890),jI=d(991);class DO{constructor(b,h,n,x,E,S,ma,Fa,$a,sb,Jb,Sb,oc,Ic,gd){this.taskManager=b;this.Hoa=h;this.Wsj=n;this.k9n=x;this.KWe=E;this.gr=S;this.Qs=ma;this.Ai=Fa;this.o_=$a;this.Ac=sb;this.ej=Jb;this.aZ=Sb;this.ti=oc;this.Vyk=Ic;this.Tyk=gd;this.QSb=this.P4=this.qm=null;this.Bxj="WordWebCommitNewCommentActivity";this.Cxj="WordWebCommitTaskActivity";
this.yxj="WordWebCommentReactionActivity";this.xje=null}get Rha(){return this.P4}G5m(b){var h;const n=this.Rha.Hy,x=this.P4.aT();if(x&&n){const E=jI.a.dcb(null!==(h=n.authorId)&&void 0!==h?h:"");h=new wG.a(n.authorId,n.tXb,n.author,null!==E&&void 0!==E?E:"",!0);b.author=h;b.insertIndex=Array.indexOf(x,n);b.authorName=n.author;b.authorIdentity="";return null}return yo.a.GC(-2130915320)}initialize(b,h,n,x){this.qm=b;this.P4=h;this.QSb=n;this.xje=x}beginDraftingAsync(b){if(!b)return new Promise((x,E)=>
{E(yo.a.GC(-2130915327))});const h=new CO,n=HB.a.sdf(b.sessionType);return void 0===n||null===n?new Promise((x,E)=>{E(yo.a.GC(-2130915317))}):new Promise((x,E)=>{yo.a.h1(this.taskManager,()=>{if(1!==this.qm.mode)w.ULS.sendTraceTag(40130753,327,10,"Create InitCommentSession Failed. CommentingMode={0}",this.qm.mode),E(yo.a.GC(-2130915325));else{this.Ejh();try{switch(n){case 0:if(!this.qm.waa.mfb()){E(yo.a.GC(-2130915326));return}this.gr.xUd&&this.Vyk.bKd();w.ULS.sendTraceTag(553710798,327,50,`Creating comment for ${b.draftId}`);
this.qm.Cub(b);break;case 1:if(!b.threadId||""===b.threadId){E(yo.a.GC(-2130915324));return}if(this.gr.Z_f){let Fa=this.P4.xB(b.threadId);if(Fa){const $a=this.P4.FMh(Fa,!1),sb=yE.vzb(Fa,$a,Fa.authorId===this.gr.uX);sb&&this.KWe.invoke(b.threadId,sb)}else w.ULS.sendTraceTag(579170962,327,10,"Smart reply provider not invoked since comment is null",this.qm.mode)}this.qm.addReply(b.threadId,b);break;case 3:if(!b.threadId||""===b.threadId){E(yo.a.GC(-2130915324));return}var S=this.P4.xB(b.threadId);if(!S){E(yo.a.GC(-2130915323));
return}this.qm.editComment(S,b);break;case 2:if(!b.commentId||""===b.commentId){E(yo.a.GC(-2130915324));return}let ma=this.P4.xB(b.commentId);if(!ma){E(yo.a.GC(-2130915323));return}this.qm.editComment(ma,b)}}catch(ma){E(ma);this.MPi();w.ULS.sendTraceTag(553677466,327,10,`Drafting Exception ${ma} on Session ${n}`);return}(S=this.G5m(h))?E(S):x(h);this.MPi()}},rw.a.beginDraftingAsync)})}commit(b,h,n){const x=this.Rha.Hy;if(!x)throw yo.a.GC(-2130915320);var E=x.Cy;if(!E)throw yo.a.GC(-2130915320);const S=
HB.a.sdf(E.sessionType);if(void 0===S||null===S)throw yo.a.GC(-2130915317);if(b!==E.draftId)throw yo.a.GC(-2130915327);let ma=!1,Fa=!1;E=!1;switch(S){case 3:if(!n)throw yo.a.GC(-2130915327);break;case 0:this.ej.Pd(()=>{if(!this.qm.waa.mfb())throw yo.a.GC(-2130915326);x.text=[h];this.qm.Dz&&!this.ti.en?this.qm.I1m(()=>{this.qm.xra(x);this.qm.a_k(b,x.id)}):this.qm.xra(x);Fa=n&&null!=n.Task;ma=this.qm.Dz;yo.a.h1(this.taskManager,()=>{this.Ejb(x.id)},rw.a.Ejb)},"WESCA:C:C");break;case 1:this.ej.Pd(()=>
{x.text=[h];this.qm.xra(x);Fa=n&&null!=n.Task;ma=this.qm.Dz},"WESCA:C:R");break;case 2:this.ej.Pd(()=>{x.text=[h];this.qm.xab(x);this.qFi(ub.a.wum)},"WESCA:C:E");break;default:throw yo.a.GC(-2130915322);}n&&(n.Resolve&&(this.HWi(x,n.Resolve.isResolved),n.Resolve.isResolved&&!this.ti.en&&this.qm.notify(Box4Intl.Box4Strings.L_CommentResolved,!0)),n.Task&&this.qm.xzk(x,n.Task),n.Reaction&&(E=this.gr.azk,n.Reaction.isActive?this.qm.upd(x,n.Reaction.reactionType):this.qm.i2d(x,n.Reaction.reactionType)));
this.gr.ozk&&Fa&&this.o_.execute($a=>$a.logActivity(this.Cxj,"CommentsTasksFpsIsEnabled"));ma&&this.o_.execute($a=>{$a.logActivity(this.Bxj,"CommentsFpsIsEnabled")});E&&this.o_.execute($a=>{$a.logActivity(this.yxj,"CommentReactionsFpsIsEnabled")});return x.id}endCommentSession(b){const h=this.Rha.Hy;if(h){if(h.Cy&&h.Cy.draftId!==b)throw yo.a.GC(-2130915327);if(h.Qq===Zk.a.beingCreated)this.qm.deleteComment(h),!this.qm.Dz||h.Rf||this.ti.en||this.Ai.Jg(xd.AFrame.Xp);else{if(3!==this.qm.mode){w.ULS.sendTraceTag(33621450,
327,50,"CommentingMode != EditingComment at the time of ending a comment session");return}h.Qq=Zk.a.normal;h.NOa=IQ.a.succeeded;h.Cy=null;this.qm.dUe()}}this.Qs&&this.Qs.updateCommandUI(!0);this.Rha.TFd()||this.Hoa.l7f(1,!this.qm.mode)}deleteComment(b){(b=this.P4.xB(b))?(this.qm.deleteComment(b),this.qm.Dz&&!this.ti.en?b.Rf||this.Ai.Jg(xd.AFrame.Xp):this.Ai.YB(xd.AFrame.fr),this.k9n.jZf(b)&&this.qFi(ub.a.Lki)):w.ULS.sendTraceTag(594600902,327,15,"Comment to delete is not in the model.")}selectComment(b){this.Ejb(b,
0)}highlightComment(b){this.qm.Q9b(b,0)}setThreadResolvedState(b,h){(b=this.P4.xB(b))&&this.HWi(b,h)}HWi(b,h){if(b.Rf&&""!==b.Rf)throw yo.a.GC(-2130915321);this.qm.awb(b,h);h&&!this.ti.en&&this.Ai.Jg(xd.AFrame.Xp)}presentLinkToComment(b){var h=this.P4.xB(b);h?(h=this.Rha.iEd(h))?(b={["nav"]:btoa(`{"${TF.a.comment}":${h}}`),["mode"]:"copy"},this.Tyk.KB(ub.a.presentLinkToComment),this.Ac.Xb(Ra.a.icb,2,b)):w.ULS.sendTraceTag(578058146,327,10,"[LinkToComment] Invalid durableCommentId for commentId: {0}",
b):w.ULS.sendTraceTag(578401558,327,10,"[LinkToComment] Comment not found for Id {0}",b)}selectFirstThreadInNextCommentContext(){this.qm.uUi(0)}selectLastThreadInPreviousCommentContext(){this.qm.PBn()}registerForCommentEvents(b){const h=this.Rha.Saf(this.gr.bKb&&this.gr.uq&&!this.ti.en),n=this.Rha.VQa,x=this.Rha.TFd(),E=!this.qm.mode;this.Hoa.LLn(this.xje.WEl());this.xje.nxl().then(S=>{this.Hoa.Xjn(b,h,x,E,n,S);this.Hoa.l7f(x?5:1,E);this.Qs&&this.Qs.updateCommandUI(!0)})}unregisterForCommentEvents(b){this.Hoa.Dgc(b)}registerForAction(b,
h){this.Wsj.lOa(b,h)}unregisterForAction(){}checkAtMentionCapability(){return this.QSb?this.QSb.atMentionsEnabledAsync():(w.ULS.sendTraceTag(36475799,327,10,"AtMentionEnabled called before initialization."),new Promise(b=>{b(!1)}))}resolveSupported(){return!0}loadThreads(){w.ULS.sendTraceTag(40130754,327,10,"LoadThreads incorrectly called on unsupported platform.")}Ejh(){const b=this.qm.Dz&&!this.ti.en?xd.AFrame.qL:xd.AFrame.fr;if(b===xd.AFrame.fr){if(!this.ti.en)return;Cj.UISurfaces.Xt().then(h=>
{h.setSelectedTaskPane(rG.a.Nud);return null})}this.Ai.YB(b)}Ejb(b,h=1){this.Ejh();const n=this.gr.UVl?1===h||0===h:1===h;this.aZ.nUi(b,Object.assign(new gv.a,{j3:h,lO:n}))}MPi(){this.qm.waa.f$a&&(this.qm.waa.f$a=!1)}qFi(b){this.Ac.processAction(b,2)}}Object(r.a)(DO,"WordEditorSharedCommentAPI",null,[162,163]);class kI{constructor(b,h,n,x,E,S,ma=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=b;this.parentId=
h;this.commentBody=n;this.author=x;this.date=E;this.commentFlags=S;this.usersByReactionType=ma}}Object(r.a)(kI,"OfficeSharedCommentModel",null,[]);d(1593);class EO{constructor(b,h,n){this.Ma=b;this.Xe=h;this.WDb=n;this.K5g="AD";this.nkc=new Aa.a;this.AKe=new Aa.a;this.Fek=RegExp("(.*?)\\s*(\\[\\d+\\])$");this.hxg=new Lm.a}get userPrincipalName(){return this.Ma.lb("UserPrincipalName")}get T0a(){return this.Ma.lb("PresenceProvider")}get uX(){return this.Ma.lb("PresenceUserId")}get Qi(){return this.WDb.value}wsi(b){const h=
this.Fek.exec(b);return h?h[1]:b}AXh(b,h=!1){let n=0;b.done&&(n=b.Rf&&""!==b.Rf?n|4:n|8);b.pph&&(n|=2);h&&(n|=1);this.Xe.p3d&&this.jZf(b)&&(n|=16);b.Hqf&&(n|=32);this.PUl(b)||(n|=128);return n}PUl(b){return b?(b=this.Qi.Eb(b.objectId))?b.hasProperty(ic.a.C5):!1:!1}jZf(b){if(!b)return!1;if(void 0===b.authorId||null===b.authorId||""===b.authorId)return this.vwf(b.id,b.objectId,"Comment AuthorId null or empty"),!1;if(void 0===this.uX||null===this.uX||""===this.uX)return this.vwf(b.id,b.objectId,"PresenceUserId null or empty"),
!1;if(this.uX==b.authorId&&b.tXb==this.T0a)return!1;const h=this.NAd(b.authorId),n=this.NAd(this.uX);if(this.T0a===this.K5g&&h&&n&&h[0]!=this.userPrincipalName&&h[1]!=n[1])return!0;this.vwf(b.id,b.objectId,"Unknown");return!1}isCurrentUser(b){if(!b||void 0===b.authorId||null===b.authorId||""===b.authorId||void 0===this.uX||null===this.uX||""===this.uX)return!1;if(this.uX==b.authorId&&b.tXb==this.T0a)return!0;b=this.NAd(b.authorId);const h=this.NAd(this.uX);return this.T0a===this.K5g&&b&&h?b[0]==this.userPrincipalName||
b[1]==h[1]:!1}NAd(b){if(void 0===b||null===b)return null;b=b.split("::");return 3===b.length?b.slice(1,3):null}vwf(b,h,n){b&&!this.hxg.contains(b)&&(w.ULS.sendTraceTag(42824129,327,50,`No edit restriction for commentObjectId: ${h}; reason: ${n}`),this.hxg.add(b))}VIh(b,h){var n;if(!b)return null;const x=b.TOd;let E=!1;1===h&&(E=!0);h=b.author?this.wsi(b.author):"";const S=jI.a.dcb(null!==(n=b.authorId)&&void 0!==n?n:"");n=new wG.a(this.Xe.p3d&&b.authorId?b.authorId:"",b.tXb,h,null!==S&&void 0!==S?
S:"",this.isCurrentUser(b));return new kI(b.id?b.id:"",b.Rf?b.Rf:"",b.text&&b.text.length?b.text[0]:null,n,b.date||x?b.date:new Date,this.AXh(b,E),this.CXh(b.usersByReactionType))}wcl(b,h,n){const x=[],E=new Aa.a;if(!b)return this.Xe.p3d?x:null;for(let S of b)S.Qq!==Zk.a.beingCreated&&n(S)&&(S.id&&this.nkc.xb(S.id)?(b=this.nkc.J(S.id),b=this.vJk(S,b,h),x.push(b),E.Z(S.id,b)):S.id?(b=this.VIh(S,h),x.push(b),E.Z(S.id,b)):w.ULS.sendTraceTag(50667679,327,10,"CommentId should not be null"));this.nkc=E;
return x}lil(b,h,n){const x=[];for(let E of b)E.Qq!==Zk.a.beingCreated&&n(E)&&(E.id&&this.nkc.xb(E.id)?x.push(this.nkc.J(E.id)):E.id&&x.push(this.VIh(E,h)));return x}vJk(b,h,n){var x=b.TOd,E=1===n;n=b.Rf?b.Rf:"";const S=b.text&&b.text.length?b.text[0]:null,ma=b.author?this.wsi(b.author):"",Fa=this.Xe.p3d&&b.authorId?b.authorId:"",$a=b.tXb?b.tXb:"",sb=jI.a.dcb(Fa);x=b.date||x?b.date:new Date;E=this.AXh(b,E);const Jb=this.isCurrentUser(b),Sb=this.CXh(b.usersByReactionType);return h.parentId===n&&h.commentBody===
S&&h.author.DisplayName===ma&&h.author.UserId===Fa&&h.author.Provider===$a&&h.author.IsCurrentUser===Jb&&h.date===x&&h.commentFlags===E&&this.jdk(h.usersByReactionType,Sb)?h:(h=new wG.a(Fa,$a,ma,null!==sb&&void 0!==sb?sb:"",Jb),new kI(b.id,n,S,h,x,E,Sb))}jdk(b,h){if(!b&&!h)return!0;if(!h||!b)return!1;var n=Object.keys(b);if(n.length!==Object.keys(h).length)return!1;for(let x of n){if(!(x in h))return!1;n=b[x];const E=h[x];if(n.length!==E.length)return!1;for(let S=0;S<n.length;S++)if(!this.Yck(n[S],
E[S]))return!1}return!0}Yck(b,h){return b||h?b&&h&&b.UserId===h.UserId&&b.Provider===h.Provider&&b.Email===h.Email&&b.DisplayName===h.DisplayName&&b.IsCurrentUser===h.IsCurrentUser?!0:!1:!0}CXh(b){if(!b)return null;const h={},n=this.Ma.lb("PresenceUserId");for(let E of Object.keys(b)){const S=[];var x=b[E];for(let ma of x){x=ma.UserId===n;let Fa;this.AKe.xb(ma.UserId)?(Fa=this.AKe.J(ma.UserId),Fa.IsCurrentUser=x):(Fa=new wG.a(ma.UserId,ma.Provider,ma.DisplayName,ma.Email,x),this.AKe.add(ma.UserId,
Fa));S.push(Fa)}h[E]=S}return h}}Object(r.a)(EO,"WordEditorSharedCommentModelTranslator",null,[159]);class lI{constructor(){this.Pm=null;this.i6c=this.MUg=this.Jtg=this.Y0g=this.N3g=this.mQg=this.QWg=!1}BXh(){this.Pm||(w.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.rZi());return this.Pm}nxl(){return new Promise((b,h)=>{this.i6c?b(this.VSh()):this.dWi().then(()=>{b(this.VSh())}).catch(n=>{h(n)})})}VSh(){this.i6c||w.ULS.sendTraceTag(588292829,
327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let b;b=33;this.Jtg&&(b|=2);this.QWg&&(b|=8);this.N3g&&(b|=16);this.mQg&&(b|=4);this.Y0g&&(b|=64);this.MUg&&(b|=128);return b}}Object(r.a)(lI,"OfficeSharedCommentsAppCapabilities",null,[859]);class FO extends lI{constructor(b){super();this.eTa=null;this.Xe=b;this.RMn();this.rZi()}RMn(){this.Y0g=this.Xe.HKb;this.N3g=!1;this.MUg=this.mQg=this.QWg=!0}initialize(b){this.eTa=
b;this.dWi()}WEl(){let b=120;this.Xe.wCb&&(b|=1536);return b}rZi(){this.Pm={};this.Pm.LivePersonaPicker="true";this.Pm.PersonaColor="true";this.Pm.DiscreteHostedComments=this.Xe.aVk.toString();this.Pm.NewCommentButton="true";this.Pm.DisabledChangeGates="WebThemeIntegrationHighContrastFixes,"+this.Xe.WUk;this.Pm.CommentsFluentUI="true";this.Pm.CommentTasks=this.Xe.HKb.toString();this.Pm.CommentTasksFromReply=this.Pm.CommentTasks;this.Pm.CommentsFluentUIV2="true";this.Pm.CommentFriendlyTimestamps=this.Xe.Nyk.toString();
this.Pm.AtMentionFloodgateSurvey=this.Xe.cek.toString();this.Pm.HyperlinksInComments="true";this.Pm.NewModelState="true";this.Pm.LogDraftCommentIdPair="true";this.Pm.RichTextFormattingInWeb=this.Xe.uvb.toString();this.Pm.NoDiscardOnFocusLoss="true";this.Pm.NewResolvedCardDesignInWeb="true";this.Pm.RichContentEditIntegration="true";this.Pm.HyperlinksWithDisplayText="true";this.Pm.SmartReplies=this.Xe.Z_f.toString();this.Pm.NewBorderAndFocusLookInWeb="true";this.Pm.LinkToComment="true";this.Pm.TaskPaneWithNewInfrastructure=
"true";this.Pm.CommentReactions=this.Xe.y$a.toString();this.Pm.WebThemeIntegration="true";this.Pm.NewSelectionInteractions="true";this.Pm.QuillInitializationTelemetry="true";this.Pm.PersonaIconImageForWeb="true";this.Pm.HighlightsAndFontColorInWebComments=this.Xe.wCb.toString();this.Pm.TruncationUIWithReadMoreText="true";this.Pm.CtrlEnterTip="true";this.Pm.AtMentionHintMessage="true";this.Pm.LivePersonaCardForWeb=this.Xe.tqm.toString();this.Pm.TaskHistoryRecordIDs=this.Xe.s4n.toString();this.Pm.ContentNavigation=
this.Xe.contentNavigationApiEnabled.toString()}dWi(){return new Promise((b,h)=>{this.eTa?this.eTa.atMentionsEnabledAsync().then(n=>{this.Jtg=n;this.i6c=!0;b(this.i6c)}):(w.ULS.sendTraceTag(588292830,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),h(yo.a.GC(-2130915320)))})}}Object(r.a)(FO,"WordSharedCommentsAppCapabilities",lI,[158]);class xG{constructor(){this._initialized=!1;this.nzk={crewAlias:"webasynccollabeng",
featureName:"Comments",topLevelKpiName:Dv.a.h7e,vetoPillar:7};this.z4n={crewAlias:"webasynccollabeng",featureName:"Tasks",topLevelKpiName:HQ.a.h7e,vetoPillar:7}}get D0a(){return null!=this.ing?this.ing:this.ing=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}LV(b){this.D0a.LV(uD.a.comments,b,!0)}get name(){return"WordEditor.Comments"}zc(b){this.W=b;this.LV("CPConfigStart");b.ha("WordEditor.Comments.ICommentsUsageAndHealthLogger",()=>new gk.a(ta.Health.instance,new Lh.a,this.nzk)).as("WordEditor.Comments.ICommentsUsageAndHealthLogger").singleInstance();
b.ha("WordEditor.Comments.ITasksUsageAndHealthLogger",()=>new gk.a(ta.Health.instance,new Lh.a,this.z4n)).as("WordEditor.Comments.ITasksUsageAndHealthLogger").singleInstance();b.ha("WordEditor.Comments.CommentNodeTracker",()=>new pO(this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.CommentNodeTracker").singleInstance();b.ha("WordEditor.Comments.CommentsSettings",()=>new vO(u.AFrameworkApplication.K,this.W.resolve("Box4.IFeatureHelper"),new se.a(()=>ob.App.xa.jb.Zc),
new se.a(()=>$H.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"))).as("WordEditor.Comments.CommentsSettings").singleInstance();b.ha("WordEditor.Comments.CommentsState",()=>new wO.a).singleInstance();b.ha("WordEditor.Comments.WordCommentEventsActor",()=>new BO(b.Za("Box4.TrackChange.ITrackChangeManager"),b.resolve("WordEditor.Comments.CommentsState"),b.resolve("Box4.TrackChange.ITrackChangeEventsActor"))).singleInstance();
b.ha("WordEditor.Comments.WordEditorSharedCommentModelTranslator",()=>new EO(u.AFrameworkApplication.K,this.W.resolve("WordEditor.Comments.CommentsSettings"),new se.a(()=>ob.App.xa.jb.Zc.Ad))).as("WordEditor.Comments.IWordEditorSharedCommentModelTranslator").singleInstance();b.ha("WordEditor.Comments.CommentDeltaFormatTranslator",()=>new yC(b.resolve("WordEditor.Comments.CommentsSettings"),b.resolve("Box4.Styles.IWACStyleReader"))).as("WordEditor.Comments.ICommentFormatTranslator").singleInstance();
b.ha("Common.Comments.OfficeSharedCommentsEventHost",()=>new PN(u.AFrameworkApplication.uc)).as("Common.Comments.IOfficeSharedCommentsEventHost").singleInstance();b.ha("WordEditor.Comments.CommentActionInTypingRecorder",()=>new ZN(this.W.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentActionInTypingRecorder").singleInstance();b.ha("WordEditor.Comments.EditorCommentModel",GQ.a.getInstance).as("Common.Comments.ICommentModel").as("WordEditor.Comments.IWordEditorCommentModel").as("WordEditor.Comments.IEditorCommentModel").singleInstance();
b.ha("WordEditor.Comments.ICommentModelBootLoader",()=>new oO(new se.a(()=>ob.App.xa.jb.Zc),new se.a(()=>$H.a.instance),b.resolve("WordEditor.Comments.IEditorCommentModel"),b.resolve("WordEditor.Comments.CommentsState"),b.resolve("WordEditor.Comments.CommentsSettings"),b.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger")));b.ha("WordEditor.Comments.ICommentFilterActor",()=>new cO(b.resolve("WordEditor.Comments.IEditorCommentModel"),
u.AFrameworkApplication.K,b.resolve("WordEditor.Comments.WordCommentEventsActor"))).singleInstance();b.resolve("WordEditor.Comments.ICommentFilterActor");b.ha("WordEditor.Comments.CommentHighlightOnRestActor",()=>new kO(new se.a(()=>ob.App.xa.jb.Zc),b.resolve("WordEditor.Comments.CommentsState"),b.resolve("WordEditor.Comments.IEditorCommentModel"),b.resolve("WordEditor.Comments.WordCommentEventsActor"),b.resolve("Box4.INotebookManager").al,oo.a.instance,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),
b.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentHighlightOnRestActor").singleInstance();b.ha("WordEditor.Comments.CommentHighlightUtils",()=>new JE(b.resolve("Box4.Highlight.IHighlightManager"))).singleInstance();b.ha("WordEditor.Comments.DefaultHighlightChangeHandler",()=>new xO(b.resolve("WordEditor.Comments.CommentHighlightUtils"))).singleInstance();b.ha("WordEditor.Comments.AllMarkupModeHighlightChangeHandler",()=>new XN(b.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),
b.resolve("WordEditor.Comments.CommentHighlightUtils"),u.AFrameworkApplication.ua.C_,u.AFrameworkApplication.ua.sEa,u.AFrameworkApplication.ya,u.AFrameworkApplication.uc,b.resolve("WordEditor.Comments.CommentsState"),b.Za("WordEditor.Comments.IEditorCommentManager"))).singleInstance();b.ha("WordEditor.Comments.CommentHighlightActor",()=>new iO(new se.a(()=>ob.App.xa.jb.Zc.Ad),b.resolve("WordEditor.CommentsInteractive.ICommentEditor"),b.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),b.Za("WordEditor.Comments.IEditorCommentManager"),
oo.a.instance,b.resolve("WordEditor.Comments.AllMarkupModeHighlightChangeHandler"),b.resolve("WordEditor.Comments.DefaultHighlightChangeHandler"),b.resolve("WordEditor.Comments.CommentHighlightUtils"),b.resolve("WordEditor.Comments.WordCommentEventsActor"))).as("WordEditor.Comments.ICommentHighlightActor").singleInstance();b.ha("WordEditor.Comments.CommentHintActor",()=>new sw(b.resolve("WordEditor.Comments.CommentsSettings"),$e.a.instance,sf.a.instance,Lv.a.instance,u.AFrameworkApplication.ya,Fg.TableCellReader.Fdm,
$d.moveToLastRenderedCellOfTheRow,new qm.a,b.Za("Box4.ContentControlConfigSettings"),b.resolve("WordEditor.Comments.IEditorCommentModel"),b.resolve("WordEditor.Comments.ICommentHighlightActor"),b.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),b.resolve("WordEditor.Comments.CommentsState"),b.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.ICommentHintActor").singleInstance();b.ha("WordEditor.Comments.CommentMarginEntryPointActor",()=>new qG($e.a.instance,
sf.a.instance,Lv.a.instance,u.AFrameworkApplication.ya,b.resolve("WordEditor.Comments.ICommentHintActor"),b.Za("Common.IZoomManager"),b.resolve("WordEditor.Comments.CommentsSettings"))).singleInstance();b.ha("WordEditor.Comments.ViewContainerAPI",()=>new AO(u.AFrameworkApplication.ya,"OfficeSharedCommentPaneSurface")).as("WordEditor.Comments.IWordViewContainerAPI").singleInstance();b.ha("Common.Comments.CommentActivationManager",()=>new QN).as("Common.Comments.ICommentActivationManager").singleInstance();
b.ha("Common.Comments.ViewContainerEventHost",()=>new RN(u.AFrameworkApplication.uc,"OfficeSharedCommentPaneSurface")).as("Common.Comments.IViewContainerEventHost").singleInstance();b.ha("WordEditor.Comments.CommentSmartReplyProvider",()=>new uO(this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"))).as("Common.Comments.ICommentSmartReplyProvider").singleInstance();
b.ha("WordEditor.Comments.WordSharedCommentsAppCapabilities",()=>new FO(b.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.IWordSharedCommentsAppCapabilities").singleInstance();this.LV("CPConfigEnd")}init(){this.LV("CPInitStart");this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{try{this.Nm(),this.LV("CPInitEnd")}catch(b){throw w.ULS.jO(524300632,327,10,b,"Exception threw from Comments Package initialization in onAfterGraphFeaturesNodeLoaded: {0}",b),this.D0a.Ru(uD.a.comments,
"CPInitException",b,!0),b;}})}Nm(){if(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(16)){var b=this.W.resolve("WordEditor.Comments.CommentsSettings");this.LV("onAfterGFNLoadedStart");this.W.ha("WordEditor.Comments.OfficeSharedCommentPane",()=>new zO(u.AFrameworkApplication.ya,u.AFrameworkApplication.ua.Zy,u.AFrameworkApplication.ua.$y,u.AFrameworkApplication.ua.Yo,u.AFrameworkApplication.ua.gv,ob.App.xa,Um.a.instance,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),
this.W.resolve("Common.Comments.IViewContainerEventHost"),u.AFrameworkApplication.uc,this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),b,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"))).as("Common.Comments.ICommentPane").as("WordEditor.Comments.IOfficeSharedCommentPane").singleInstance();this.W.ha("Common.Comments.OfficeSharedCommentsActionHost",
()=>new TN(u.AFrameworkApplication.ya,this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane").ric)).as("Common.Comments.IOfficeSharedCommentsActionHost").singleInstance();this.W.ha("WordEditor.Comments.WordEditorSharedCommentAPI",()=>new DO(u.AFrameworkApplication.uc,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),this.W.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),
b,ob.App.xa,u.AFrameworkApplication.ua.Yo,this.W.Za("Common.ISystemInitiatedFeedback"),u.AFrameworkApplication.ya,oo.a.instance,this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.IWordEditorSharedCommentAPI").singleInstance();sj.a.factory=Iz.getInstance;this.W.ha("WordEditor.Comments.EditorCommentManager",
Iz.getInstance).as("Common.Comments.ICommentManagerCore").as("WordEditor.Comments.IEditorCommentManager").singleInstance();this.W.ha("WordEditor.Comments.CommentFloatingContainerActor",()=>new hO(this.W.resolve("WordEditor.Comments.CommentsState"),b,this.W.resolve("WordEditor.Comments.IEditorCommentModel"),u.AFrameworkApplication.uc,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),
()=>document.querySelector(`#${Qe.AppFrame.fFa} .${tQ.a.n_b}`),this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),u.AFrameworkApplication.ua.Yo)).as("WordEditor.Comments.ICommentFloatingContainerActor").singleInstance();var h=this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"),n=h.trackChangeInSidetrackEnabled;n&&this.W.resolve("WordEditor.Sidetrack.IFloatingContainerActorConsumer").sKi(this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"));this.W.ha("WordEditor.Comments.FloatingCommentManager",
()=>new KE(this.W.resolve("WordEditor.Comments.IEditorCommentModel"),u.AFrameworkApplication.uc,oo.a.instance,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),b,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),h)).singleInstance();this.W.ha("WordEditor.Comments.IFloatingCommentManager",()=>n?
this.W.resolve("WordEditor.Sidetrack.SidetrackManager"):this.W.resolve("WordEditor.Comments.FloatingCommentManager")).as("Box4.IFloatingObjectUpdater").singleInstance();this.W.ha("WordEditor.Comments.CommentSelectionActor",()=>new tO(u.AFrameworkApplication.ya,this.W.resolve("Common.Comments.ICommentModel"),this.W.resolve("WordEditor.Comments.ICommentHighlightActor"),Qy.getInstance(),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
u.AFrameworkApplication.ua.Yo,this.W.resolve("WordEditor.Comments.CommentsState"),b,new se.a(()=>kh.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.Za("WordEditor.Extension.RichApiEventManager"))).as("WordEditor.Comments.ICommentSelectionActor").singleInstance();this.W.ha("WordEditor.Comments.CommentInitActor",()=>new mO(this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),
this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),b,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),Qy.getInstance(),ob.App.xa.iq,u.AFrameworkApplication.ya,this.W.resolve("Common.IDynamicScriptLoaderProvider").tE,this.W.Za("WordEditor.Comments.ICommentRibbonCommandHandler"),u.AFrameworkApplication.ua.Yo,this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),
this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),this.W.resolve("Common.Comments.ICommentActivationManager"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.Za("Common.ISystemInitiatedFeedback"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.Za("Common.App.SafeLinks.ISafeLinksManager"),this.W.Za("Common.App.People.IExternalPeopleAPI"),this.W.resolve("Common.OfficeSharedCommentsTelemetry"),this.W.resolve("Common.Comments.IViewContainerEventHost"),
this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),h,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentNavigationAPI"),this.W.resolve("Box4.IPackageBootPerfLogger"),this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).singleInstance();this.W.ha("WordEditor.Comments.CommentsActionManager",
()=>new sO(this.W.resolve("WordEditor.Comments.EditorCommentManager"),this.W.resolve("WordEditor.Comments.EditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentHintActor"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),b,this.W.resolve("Common.Comments.ICommentPane"),new se.a(()=>ob.App.xa.jb.Zc.Ad),
u.AFrameworkApplication.ya,new se.a(()=>kh.a.instance),de.FocusManager.instance(),oo.a.instance,this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"))).as("WordEditor.Comments.CommentsActionManager").singleInstance();this.W.resolve("WordEditor.Comments.CommentInitActor");b.contentNavigationApiEnabled&&(this.W.ha("WordEditor.Comments.CommentContentProvider",()=>new rO(this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"))).singleInstance(),this.W.ha("WordEditor.Comments.CommentContentActor",
()=>new qO(this.W.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentManager"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.CommentsState"))).singleInstance(),this.W.resolve("WordEditor.Comments.CommentContentProvider"),this.W.resolve("WordEditor.Comments.CommentContentActor"));var x=b.uq,E=this.W.resolve("WordEditor.Comments.EditorCommentManager");
this.W.resolve("WordEditor.Comments.CommentsActionManager");E&&x&&(this.W.resolve("WordEditor.Comments.CommentsState").b$a=xG.jLh(),b.Gxb||this.W.resolve("WordEditor.Comments.WordCommentEventsActor").fna("OnCommentInit"));uA.a.Txm();b.SJc&&ob.App.xa.jb.mCh();sj.a.instance&&(b.Gxb||cj.a.get_instance().sl(4,()=>{this.zOm(x)},11).continueWith(()=>{this.J0l()}),this._initialized=!0);this.bin(this.W.Za("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}}J0l(){this.W.resolve("WordEditor.Comments.WordCommentEventsActor").fna("OnCommentInit")}zOm(b){b||
this.FOl()}FOl(){const b=xG.jLh();b&&(w.ULS.sendTraceTag(35149084,327,50,"Comment deep linking starts after boot: {0}",(new Date).getTime()-u.AFrameworkApplication.SV),this.W.resolve("WordEditor.Comments.WordCommentEventsActor").fna("OnCommentInit",Object.assign(new LE.a,{ACa:()=>{sj.a.instance.waa.isVisible||u.AFrameworkApplication.ya.processAction(Ra.a.KX,2);this.W.resolve("WordEditor.Comments.ICommentSelectionActor").lUi(b,Object.assign(new gv.a,{nZf:!0}))}})),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger").KB(Ra.a.EWe))}bin(b,
h,n){b&&b.execute(x=>{x.a3(new Mk(h,n))})}dispose(){this._initialized&&(sj.a.instance&&sj.a.instance.dispose(),this._initialized=!1)}static jLh(){return u.AFrameworkApplication.K.lb("BootActivityNavigationId")}}Object(r.a)(xG,"PackageManager",null,[1,2]);class GO{isComment(b){return td.a.isComment(b)}NMd(b){return td.a.NMd(b)}dof(b){return td.a.dof(b)}AEf(b,h){td.a.AEf(b,h)}EEf(b,h){td.a.EEf(b,h)}MZe(b){return td.a.MZe(b)}Z_a(b){return $H.a.instance.Z_a(b)}deleteComment(b,h){td.a.deleteComment(b,
h)}Sxd(b,h){td.a.Sxd(b,h)}bjb(b){td.a.bjb(b)}Z9(b,h,n){return td.a.Z9(b,h,n)}zsa(b,h,n){return td.a.zsa(b,h,n)}d3b(b,h){return td.a.d3b(b,h)}QGc(b,h,n,x=null){return td.a.QGc(b,h,n,x)}cWb(b,h,n,x){td.a.cWb(b,h,n,x)}tpd(b,h,n,x){return td.a.tpd(b,h,n,x)}get kCb(){return td.a.kCb}set kCb(b){td.a.kCb=b}s0a(b,h){td.a.s0a(b,h)}MWc(b){td.a.MWc(b)}sQf(b){td.a.sQf(b)}gGd(b,h){return td.a.gGd(b,h)}BEf(b,h){td.a.BEf(b,h)}DEf(b,h){td.a.DEf(b,h)}IVd(b,h,n,x,E,S){td.a.IVd(b,h,n,x,E,S)}A5e(b,h){td.a.A5e(b,h)}GUc(b,
h,n,x){return td.a.GUc(b,h,n,x)}KUc(b,h,n,x){return td.a.KUc(b,h,n,x)}}Object(r.a)(GO,"CommentEditorProxy",null,[157]);class HO{constructor(){this.W=null}get BKb(){return null!=this.zpg?this.zpg:this.zpg=(()=>this.W.Za("WordEditor.ITableEditor"))()}get D0a(){return null!=this.jng?this.jng:this.jng=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}LV(b){this.D0a.LV(uD.a.comments,b,!0)}get name(){return"WordEditor.CommentsInteractive"}zc(b){this.W=b;this.LV("CIPConfigStart");b.ha("WordEditor.CommentsInteractive.CommentEditorProxy",
()=>new GO).as("WordEditor.CommentsInteractive.ICommentEditor").singleInstance();this.LV("CIPConfigEnd")}init(){this.LV("CIPInitStart");this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Nm();this.LV("CIPInitEnd")})}Nm(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(16)&&this.VWl()}dispose(){}VWl(){Fr.a.mOa(td.a.EEf);bk.hqd(td.a.BEf);bk.Jxc(td.a.DEf);bk.Q5j(td.a.wOm);this.BKb.execute(b=>{b.$Ne(td.a.s0a)});ob.App.Wj.al.Te(39).jp(td.a.AEf);bk.Z4j(td.a.CNm);bk.S4j(td.a.VMm)}}Object(r.a)(HO,
"PackageManager",null,[1,2]);var JQ=d(1920),IO=d(1607);class mI{constructor(b,h,n,x,E,S,ma){this.yIa=b;this.Z8=h;this.b5=n;this.Xc=x;this.DDj=E;this.Hye=S;this.Lqb=ma;IO.a.P5j((Fa,$a)=>{this.Y3j($a.graphNode,$a.Ayk)});IO.a.t6j((Fa,$a)=>{this.EEk($a.graphNode,$a.Awk)})}mFd(){var b=this.DDj();const h=this.Xc.Ck();h.set(b);if(this.Z8.Vao(h))return h;h.set(b);ql.PageNavigator.instance.tQ(h);b=this.b5.YLk(h.currentNode);h.Ci(b);return h}tHd(b){const h=this.mFd();let n=null;this.Z8.wCd(h,x=>{this.b5.ZYh(x)===
b&&(n=x);return!n});return n}VYh(b){const h=this.mFd();let n=null;this.Z8.wCd(h,x=>{this.b5.l3b(x)===b&&(n=x);return!n});return n}rli(b,h,n){w.ULS.sendTraceTag(594928199,3003,50,"History Record Generated. [RecordType: {0}], [TaskID: {1}], [TaskCompletion: {2}]",b,h,n)}$Yh(){const b=this.mFd(),h=[];this.Z8.wCd(b,n=>{h.push(this.b5.ZYh(n));return!0});return h}Sab(b,h){if(!h.length)return this.Lqb&&w.ULS.sendTraceTag(42812043,3003,10,"A task must always have at least one history record."),null;const n=
this.mFd(),x=na.a.create().toString(),E=new qk.a;for(let S of h)E.add(S),this.rli(S.type,x,S.completion);h=this.yIa.DVf(E);this.b5.Sab(n.currentNode,x,b,h);this.Hye();return x}ef(b){(b=this.tHd(b))?(this.b5.ef(b),this.Hye()):this.Lqb&&w.ULS.sendTraceTag(51656714,3003,10,"DeleteTask : Unable to find task with given ID")}l3b(b){b=this.tHd(b);return b?this.b5.l3b(b):(this.Lqb&&w.ULS.sendTraceTag(42812044,3003,10,"GetTaskCommentAnchorId : Unable to find task with given ID"),null)}WYh(b){return this.b5.l3b(b)}YYh(b){b=
this.tHd(b);if(!b)return this.Lqb&&w.ULS.sendTraceTag(42812045,3003,10,"GetTaskHistory : Unable to find task with given ID"),null;b=this.b5.ggf(b);return this.yIa.v_b(b).toArray()}Hak(b,h){if(!h.length)return this.Lqb&&w.ULS.sendTraceTag(594928198,3003,10,"AppendTaskHistory : New records do not exist"),!1;const n=this.tHd(b);if(!n)return this.Lqb&&w.ULS.sendTraceTag(42812046,3003,10,"AppendTaskHistory : Unable to find task with given ID"),!1;const x=this.b5.ggf(n),E=this.yIa.v_b(x);for(let S of h)E.add(S),
this.rli(S.type,b,S.completion);b=this.yIa.DVf(E);b!==x&&(this.b5.tMn(n,b),this.Hye());return!0}Y3j(b,h){if(h=this.VYh(h)){const n=this.Xc.Ck();n.set(b);this.b5.$b(h.clone(),this.b5.B1k(h,n))}}eJi(b,h,n){if(h.xb(b))return h.J(b);const x=na.a.create().toString();h.add(b,x);n&&this.Lqb&&w.ULS.sendTraceTag(593281437,3003,10,"RecordIdFromMapOrGenerateNewIdAndAddToMap : Unexpectedly creating new id.");return x}EEk(b,h){const n=new mm.a;var x=this.Xc.Ck();x.set(b);x.Rb(38)&&this.Z8.wCd(x,E=>{const S=this.b5.l3b(E);
void 0!==S&&null!==S&&n.add(S,E);return!0});for(let E of h)if(b=null,({value:b}=n.Dc(E.key,b)).returnValue)if(E.value===E.key)b=this.VYh(E.key),this.b5.eNn(b,parseInt(E.key));else{b=this.b5.ggf(b);if(!b||""===b){w.ULS.sendTraceTag(595347466,3003,10,"CopyTaskNodesFromParentNode : History Records not found on taskNode on clipboard");break}b=this.yIa.v_b(b);x=new Jc.a;for(let S=0;S<b.length;S++){if(b.J(S).commentId){const ma=Number.parseInvariant(b.J(S).commentId);h.xb(ma)?b.J(S).commentId=h.J(ma).toString():
b.J(S).commentId=null}b.J(S).recordId=this.eJi(b.J(S).recordId,x,!1);-1===b.J(S).type&&(b.J(S).undoId=this.eJi(b.J(S).undoId,x,!0))}this.Sab(E.value,b.toArray())}}static lr(){return new mI(Oa.a.instance.resolve("WordEditor.Tasks.ITaskHistorySerialization"),Oa.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),Oa.a.instance.resolve("WordEditor.Tasks.ITaskEditor"),new qm.a,()=>ob.App.xa.jb.Zc,()=>{Oa.a.instance.Za("Common.Interface.IEditNotificationManager").execute(b=>{b.jzd()})},!0)}}Object(r.a)(mI,
"TaskActor",null,[155]);var KQ=d(1083);class JO{create(){return new KQ.a}}Object(r.a)(JO,"TaskContentNodeFactory",null,[200]);var LQ=d(1013);class KO{create(){return new LQ.a}}Object(r.a)(KO,"TaskNodeFactory",null,[200]);class OE{constructor(b,h,n,x,E,S){this.Z8=b;this.Hc=h;this.Xc=n;this.HVj=x;this.KVj=E;this.qNb=S}IKk(b,h,n){const x=this.KVj.create(1074135162);x.setValue(ic.a.taskId,b);x.setValue(ic.a.FKb,h);x.setValue(ic.a.Ava,n);return x}n3b(b){const h=this.Hc.Rc(4);h.Db(b);this.qNb();return h}ZYh(b){return this.Z8.rDb(b)?
b.getValue(ic.a.taskId):(w.ULS.sendTraceTag(42812047,3003,10,"Unexpected node type"),null)}l3b(b){return this.Z8.rDb(b)?b.hasProperty(ic.a.FKb)?b.getValue(ic.a.FKb):null:(w.ULS.sendTraceTag(42812048,3003,10,"Unexpected node type"),null)}ggf(b){return this.Z8.rDb(b)?b.getValue(ic.a.Ava):(w.ULS.sendTraceTag(42812049,3003,10,"Unexpected node type"),null)}YLk(b){if(7!==b.type)return w.ULS.sendTraceTag(42812050,3003,10,"Unexpected node type"),null;const h=this.n3b(b);try{const n=this.HVj.create(1074135161),
x=this.Xc.Ck();x.set(b);x.d1(n,38,OE.o4n);return n}finally{h&&h.dispose()}}Sab(b,h,n,x){if(!this.Z8.Bsf(b))return w.ULS.sendTraceTag(42812051,3003,10,"Unexpected node type"),null;const E=this.n3b(b);try{const S=this.IKk(h,n,x),ma=this.Xc.Ck();ma.set(b);ma.d1(S,1,new C.a(na.a.Yja(n.toString()),1));return S}finally{E&&E.dispose()}}ef(b){if(this.Z8.rDb(b))if(b.anchor&&b.anchor.Gp){var h=b.anchor.Gp.vr.node;if(this.Z8.Bsf(h)){var n=this.n3b(h);try{const x=this.Xc.Ck();x.set(h);x.Ci(b.anchor.node);x.Fg()}finally{n&&
n.dispose()}}else w.ULS.sendTraceTag(51656717,3003,10,"Task node unexpectedly parented to non-content node")}else w.ULS.sendTraceTag(51656716,3003,10,"Cannot delete an unlinked node");else w.ULS.sendTraceTag(51656715,3003,10,"Unexpected node type")}tMn(b,h){if(this.Z8.rDb(b)){var n=this.n3b(b);try{b.setValue(ic.a.Ava,h)}finally{n&&n.dispose()}}else w.ULS.sendTraceTag(42812052,3003,10,"Unexpected node type")}eNn(b,h){if(this.Z8.rDb(b)){var n=this.n3b(b);try{const x=b.hasProperty(ic.a.FKb)?b.getValue(ic.a.FKb):
null;void 0===x||null===x||x===h?b.lh(ic.a.FKb,h):w.ULS.sendTraceTag(595347464,3003,10,"TaskAnchorId is changed.")}finally{n&&n.dispose()}}else w.ULS.sendTraceTag(595347465,3003,10,"Unexpected node type")}B1k(b,h){if(!h.Zp(38)){const n=this.Xc.Ck();n.set(b);n.Bb(71);n.kd(71);b=Fn.a(n.currentNode,b.Bi().Nc,!0);h.Sf(b,38)}return h.Rb(38)}$b(b,h){if(this.Z8.Bsf(h)){var n=this.n3b(h);try{const x=this.Xc.Ck();x.set(h);x.Sf(b,1)}finally{n&&n.dispose()}}else w.ULS.sendTraceTag(595347463,3003,10,"Unexpected node type")}static lr(){return new OE(Oa.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),
new Zm.a,new qm.a,new JO,new KO,()=>{Kb.App.fm.jb.Zc.sF.p9(10)})}}OE.o4n=new C.a(na.a.Of("50f73b87-1d48-4f4a-94a3-4c20e2cf6387"),1);Object(r.a)(OE,"TaskEditor",null,[156]);class nI{constructor(b,h){this.px=b;this.DSb=h}rDb(b){return!!b&&72===b.type}Rjm(b){return!!b&&71===b.Se}Bsf(b){return!!b&&71===b.type}Vao(b){b.set(this.px.value);this.DSb.tQ(b);return!!b.Rb(38)}wCd(b,h){if(b&&h)if(this.Rjm(b))for(var n=!0,x=b.Rb(1);n&&x;)this.rDb(x)||w.ULS.sendTraceTag(42812055,3003,10,"Unexpected node type {0}",
x.type),n=h(x),x=b.wf(1);else w.ULS.sendTraceTag(42812054,3003,10,"Unexpected iterator type {0}",b.Se);else w.ULS.sendTraceTag(42812053,3003,10,"ForEachTaskInTaskContent : Invalid Input")}static lr(){return new nI(new se.a(()=>ob.App.xa.jb.Zc),ql.PageNavigator.instance)}}Object(r.a)(nI,"TaskNavigator",null,[154]);class LO{constructor(){this.W=null}get name(){return"WordEditor.Tasks"}init(){this.W.resolve("Box4.IFeatureHelper").Yk.continueWith(()=>{this.Nm()})}dispose(){}zc(b){this.W=b;b.ha("WordEditor.Tasks.JsonTaskHistorySerialization",
()=>new JQ.a).as("WordEditor.Tasks.ITaskHistorySerialization").singleInstance();b.ha("WordEditor.Tasks.TaskNavigator",()=>nI.lr()).as("WordEditor.Tasks.ITaskNavigator").singleInstance();b.ha("WordEditor.Tasks.TaskEditor",()=>OE.lr()).as("WordEditor.Tasks.ITaskEditor").singleInstance();b.ha("WordEditor.Tasks.TaskActor",()=>mI.lr()).as("WordEditor.Tasks.ITaskActor").singleInstance()}Nm(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(125)}}Object(r.a)(LO,"TasksPackage",null,[1,2]);class MO{constructor(){this.onResizeMiddleContainer=
this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(r.a)(MO,"TaskPaneGroupAppProps",null,[]);class NO{static Czk(b,h){de.FocusManager.YI()&&(sf.a.instance.sya(b,h,!1),dj.a.instance.sya(b,h,!1),u.AFrameworkApplication.ua.gv.kS(b))}}Object(r.a)(NO,"ReactTaskPaneManagerUtils",null,[]);class OO{constructor(){this.type=null}}Object(r.a)(OO,"SampleTaskPaneProps",
null,[]);var MQ=d(1605);class PO{constructor(){this.entry=null;this.show=!1}}Object(r.a)(PO,"AnimationBatchEntry",null,[]);var NQ=d(1099);class Ev{constructor(){this.ATg=[];this.BTg=[];this.Xia={};this.RFa=this.QFa=null;this.zmd=!1;this.zY=null;this.Cjd=this.ped=0;this.Jic=[];this.Nte=!!u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.Qfb;this.$v=!1}initialize(){this.zmd=!1;(this.$v=!!u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.u6)&&this.y_e()}A_e(b,h,n,x){h=this.vHd(h);w.ULS.sendTraceTag(4290588,
320,50,"Create new task pane.");this.y_e();const E=document.createElement("div");E.id=h;E.className=Ev.Aoo;E.style.width="0";this.Nte||(this.W0j(n,h,E),this.Xia[h]=b.A_e(h,n,x,E));return E}y_e(){this.zmd||this.$On()}W0j(b,h,n){let x=null,E=null;0===b?(x=this.QFa,E=this.ATg):1===b&&(x=this.RFa,E=this.BTg);if(x){b=!1;for(let S=0;S<E.length;S++)if(!b)E[S]===h&&(b=!0);else if(E[S]in this.Xia){this.P4l(x,n,this.Xia[E[S]]);return}x.appendChild(n)}}P4l(b,h,n){b.insertBefore(h,n.element)}kWk(b){b=this.vHd(b);
if(b in this.Xia){const h=this.Xia[b];h.element.parentNode.removeChild(h.element);delete this.Xia[b]}}N3i(b){b=this.vHd(b);b in this.Xia&&(b=this.Xia[b])&&!b.isVisible&&(this.Z2i(b,!0),this.M9g(b.position,!0,this.vhh(b,!0)),1===b.position&&1<Ia.a.count(this.Xia)&&this.vAm())}rWl(b){b=this.vHd(b);b in this.Xia&&(b=this.Xia[b])&&b.isVisible&&(this.Z2i(b,!1),this.M9g(b.position,!1,this.vhh(b,!1)))}PZb(b){if(this.zY)return this.zY;const h=document.createElement("div");document.body.appendChild(h);h&&
(this.zY=new CF(h,b));return this.zY}Z2i(b,h){b.element&&(b.isVisible=h,this.Jic.push(Object.assign(new PO,{entry:b,show:h})));0===b.position?this.ped+=h?1:-1:this.Cjd+=h?1:-1;1===this.Jic.length&&window.setTimeout(Object(v.a)(this,this.K_n,"startPaneAnimation"),0);this.$v&&b.element&&b.element.parentNode&&(0===b.position&&!this.ped||1===b.position&&!this.Cjd?(b.element.parentNode.style.minHeight="0px",b.element.parentNode.style.height="0px",b.element.parentNode.style.overflow="hidden"):(b.element.parentNode.style.minHeight=
"",b.element.parentNode.style.height="",b.element.parentNode.style.overflow=""))}K_n(){this.ixi();var b=tj.where(tj.asEnumerable(this.Jic),E=>0===E.entry.position),h=tj.where(b,E=>!E.show);if(tj.any(h)&&tj.Ct(h)!==tj.Ct(b)){for(var n of h)n.entry.element.style.width="0";b=tj.where(b,E=>E.show)}h=tj.where(tj.asEnumerable(this.Jic),E=>1===E.entry.position);n=tj.where(h,E=>!E.show);if(tj.any(n)&&tj.Ct(n)!==tj.Ct(h)){for(var x of n)x.entry.element.style.width="0";h=tj.where(h,E=>E.show)}for(let E of tj.concat(b,
h))b=E.entry,Wm.WacAirSpace.jU(b.element,so.a.a_f),x=new NQ.a(b.element),E.show?x.fPe(0,b.width):x.fPe(b.width,0),Wm.WacAirSpace.animate(x,null,null);this.Jic.length=0}ixi(){}vhh(b,h){let n=b.width;b=0===b.position?this.ped:this.Cjd;if(h&&1===b||!h&&!b)n+=1;return n}$On(){this.zmd||(this.QFa||(this.QFa=document.createElement("div"),this.QFa.id=Ev.yoo,this.QFa.className=Ev.rjj,Sys.UI.DomElement.addCssClass(this.QFa,"alignLeft"),u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.v6&&Sys.UI.DomElement.addCssClass(this.QFa,
"FlexBoxLayout"),this.Nte&&Sys.UI.DomElement.addCssClass(this.QFa,Ev.pjj),this.M7g(0,this.QFa)),this.RFa||(this.RFa=document.createElement("div"),this.RFa.id=Ev.zoo,this.RFa.className=Ev.rjj,Sys.UI.DomElement.addCssClass(this.RFa,"alignRight"),u.AFrameworkApplication.ua&&u.AFrameworkApplication.ua.Sb.v6&&Sys.UI.DomElement.addCssClass(this.RFa,"FlexBoxLayout"),this.Nte&&Sys.UI.DomElement.addCssClass(this.RFa,Ev.pjj),this.M7g(1,this.RFa)),this.gzi(this.QFa,this.RFa),this.zmd=!0)}gzi(){}wya(b,h){Array.add(1===
b?this.BTg:this.ATg,h)}vHd(b){return b+"-Entry"}vAm(){let b=0;for(const h of Ia.a.ON(this.Xia)){const n=Object(ja.a)(918,this.Xia[h]);n&&n.isVisible&&1===n.position&&b++}2===b?w.ULS.sendTraceTag(595179606,320,50,"2 simultaneous panes open"):2<b&&w.ULS.sendTraceTag(595179605,320,50,b+" simultaneous panes open")}}Ev.yoo="WACTaskPaneContainerLeft";Ev.zoo="WACTaskPaneContainerRight";Ev.rjj="WACTaskPaneContainer";Ev.Aoo="WACTaskPaneEntry";Ev.pjj="WACReactTaskPaneContainer";Object(r.a)(Ev,"BaseTaskPaneManager",
null,[919]);class oI extends Ev{constructor(b,h){super();this.vrc=this.urc=this.SKe=this.RKe=0;this.ga=b;this.cIg=h}M7g(b,h){const n=ob.App.xa.eC;n.parentNode&&(b?1===b&&(this.$v?((b=Object(eC.a)("FarPane"))&&b.appendChild(h),h.classList.add("regionComposer"),ob.App.xa.tu.registerBoundingWindowRectsChanged("farPane",(x,E)=>{"DP"===E||3===E?h.classList.add("DL"):h.classList.remove("DL")})):n.parentNode.insertBefore(h,n.nextSibling)):this.$v?((b=Object(eC.a)("NearPane"))&&b.appendChild(h),h.classList.add("regionComposer")):
n.parentNode.insertBefore(h,n))}M9g(b,h,n){this.$v||(h=h?n:-n,b?this.vrc+=h:this.urc+=h)}ixi(){if(!this.$v){var b=ob.App.xa.eC;Wm.WacAirSpace.jU(b,so.a.a_f);if(this.RKe!==this.urc){const h=new Wv.a(b);h.g$j(this.RKe,this.urc,this.cIg);Wm.WacAirSpace.animate(h,null,Object(v.a)(this,this.uIh,"forceInteractiveViewRefreshOutline"));this.RKe=this.urc}this.SKe!==this.vrc&&(b=new Wv.a(b),b.h$j(this.SKe,this.vrc,this.cIg),Wm.WacAirSpace.animate(b,null,Object(v.a)(this,this.uIh,"forceInteractiveViewRefreshOutline")),
this.SKe=this.vrc)}}uIh(){cb.InteractiveViewManager.instance.forEach(b=>{b.BCd()})}}Object(r.a)(oI,"TaskPaneManager",Ev,[]);class yG extends oI{constructor(b,h){super(b,h);this.uV=mc.KeyInputManager.mc(db.a.fx,0);this.vV=mc.KeyInputManager.mc(db.a.fx,4);this.EDe=this.grc=null;this.lNg="AccCheckerTaskPane";this.sa=new Ge.a;this.isPaneOpen=!1;this.Vee=this.Jne=null;this.wya(0,"SampleTaskPane");this.wya(0,Dm.a.kcb);this.wya(1,Dm.a.Ydk);this.wya(1,"CustomTaskPane");this.wya(1,Dm.a.Ymf);this.wya(1,xd.AFrame.fr);
this.wya(1,xd.AFrame.H5g);this.wya(1,xd.AFrame.C5g);this.wya(1,Dm.a.JCd);this.wya(1,Dm.a.fDc);this.wya(1,Dm.a.KEc);this.fIj=(this.ptg=!!u.AFrameworkApplication.ua&&!!u.AFrameworkApplication.ua.Sb)&&u.AFrameworkApplication.ua.Sb.Drf;this.fHj=Kb.App.yDb;this.mHj=this.ptg&&u.AFrameworkApplication.ua.Sb.eOc;this.initialize();b.gb(ub.a.r_f,cc.a.application,yG.r_f,96)}get Xai(){null==this.Vee&&(this.Vee=u.AFrameworkApplication.K?u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExternalContentFloatiePositionIsEnabled",
!1):!1);return this.Vee}get l3d(){if(!ob.App.xa||!ob.App.xa.eC)return null;this.EDe||(this.EDe=new CF(ob.App.xa.eC,de.FocusManager.instance()));return this.EDe}Vb(){}gzi(b,h){const n=ln.a.instance,x=de.FocusManager.instance(),E=ho.EventHandlerManager.instance,S=this;Cj.UISurfaces.Xt().then(ma=>{S.grc=S.PZb(x);let Fa;ma.renderTaskPaneGroups(b,h,(Fa=new MO,Fa.middleContainer=ob.App.xa.eC,Fa.onTabStripFocus=()=>{x.YB(Dm.a.ffc)},Fa.onOpen=($a,sb)=>{S.Erf($a)&&NO.Czk($a,sb);E.HMe(sb,"focus",S.VWh($a,x),
!0);var Jb=S.Bci($a),Sb=ma.selectors.getTabbedTaskPaneCount(Jb?1:2);Jb=Jb?Dm.a.z9d:Dm.a.ffc;1===Sb&&(n.tya(Jb),this.isPaneOpen=!0,this.KHi({isPaneOpen:this.isPaneOpen,tfc:sb}));sb=S.Hcf($a);if(Sb=x.pe(sb))Sb.eBc=Jb,S.pTn($a)&&(Sb.Ar(S.uV),Sb.Ar(S.vV)),n.mbi(sb)&&n.Hw(sb);this.Xai&&this.JAd&&this.JAd.Vu(!0)},Fa.onClose=($a,sb)=>{S.Erf($a);const Jb=S.Bci($a),Sb=Jb?Dm.a.z9d:Dm.a.ffc;ma.selectors.getTabbedTaskPaneCount(Jb?1:2)||(n.Hw(Sb),this.isPaneOpen=!1,this.KHi({isPaneOpen:this.isPaneOpen,tfc:sb}));
E.vQf(sb,"focus",S.VWh($a,x),!0);this.Xai&&this.JAd&&this.JAd.Vu(!0)},Fa.setFocusCallback=($a,sb)=>{S.Erf($a)&&sb&&($a=x.pe(S.Hcf($a)),$a.rvk(),$a.Wca(sb))},Fa.onOverflowMenuOpen=()=>{if(S.grc)S.grc.onMenuOpen()},Fa.onOverflowMenuClose=()=>{if(S.grc)S.grc.onMenuClose()},Fa.onShow=($a,sb)=>{2===sb&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{x.Jg($a)},0)})},Fa.onHide=($a,sb,Jb)=>{Jb&&1!==sb&&x.Jg(x.AS)},Fa.onResizeStart=()=>{if(ob.App.xa&&(ob.App.xa.eC.className=Qe.AppFrame.Y8f,S.l3d))S.l3d.onMenuOpen()},
Fa.onResizeEnd=()=>{if(ob.App.xa&&(Hm.a.Mei()||(ob.App.xa.eC.className+=" "+ob.App.xa.Tih),S.l3d))S.l3d.onMenuClose()},Fa));this.Aga(Dm.a.ffc,x,h,S);this.Aga(Dm.a.z9d,x,b,S);return null})}Aga(b,h,n,x){const E=h.pe(b);E.parent=xd.AFrame.Lp;E.LL=!0;sf.a.instance.sya(b,n,!1);dj.a.instance.sya(b,n,!1);b=new ke.DOMFocusListing(()=>n);b.Go(3);b.Go(2);b.Go(4);b.Go(1);h.yja(()=>n,E,b).dX=!0;E.Ar(x.uV);E.Ar(x.vV)}Hcf(b){return b===this.lNg?Dm.a.Q4g:b}VWh(b,h){return()=>{h.YB(this.Hcf(b))}}pTn(b){return b===
this.lNg?!1:!0}Zam(b){return b===Dm.a.kcb}Erf(b){return this.Zam(b)||b===Dm.a.Q4g||0<=b.indexOf("AppForOfficePanel")||b===Dm.a.JCd||b===Dm.a.Ymf&&this.fIj||b===Dm.a.fDc&&this.fHj||b===Dm.a.KEc&&this.mHj||b===MQ.a.Yyb?!0:!1}Bci(b){return b===Dm.a.kcb||"SampleTaskPane"===b}static MJl(){return new yG(u.AFrameworkApplication.ya,u.AFrameworkApplication.isRtl)}static r_f(b,h,n,x,E){if(1===n)return 32;Cj.UISurfaces.Xt().then(S=>{S.showTaskPane(E,Object.assign(new sp.a,{title:"Sample Task Pane",width:320,
location:2,contentProps:Object.assign(new OO,{type:"SampleTaskPaneProps"})}));return null});return 32}TIa(b){this.sa.addHandler("onPaneToggle",b)}kXc(b){this.sa.removeHandler("onPaneToggle",b)}KHi(b){this.sa.raiseEvent("onPaneToggle",b)}get JAd(){this.Jne||(this.Jne=Oa.a.instance.Pa("WordEditor.Actors.ExternalContentFloatieEventManager"));return this.Jne}}Object(r.a)(yG,"TaskPaneManager",oI,[153]);class QO{constructor(){this.fS=null}get name(){return"WordEditor.TaskPaneManager"}zc(){}init(){this.fS=
yG.MJl();this.fS.Vb();ob.App.xa.glb=this.fS}dispose(){}}Object(r.a)(QO,"PackageManager",null,[1,2]);class PE{constructor(b,h){this.iPk=2E3;this.l5g=null;this.UIf=b.JBi;this.maxLength=u.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MaxCanvasContextChars",this.iPk);h&&h.execute(n=>{this.l5g=n})}Baf(b){b=this.til(b,this.maxLength);return{semantic:Vp.ObjectSemantic.CanvasContext,type:Vp.ObjectSchemaType.WordCanvasContext,value:b}}til(b,h){try{return this.sil(b,h)}catch(n){return w.ULS.sendTraceTag(522725067,
1303,15,"Error processing selection for Canvas Context: {0}",n),null}}FGl(b,h){const n={UWa:[],fua:0,selection:{start:null,end:null},cursor:null,tiles:[]},x=b.length;for(let S=0;S<x;S++){const ma=b.J(S);var E=ma.node;if(!Cd.ParagraphReader.oc(E)||Array.contains(n.UWa,E.pn))continue;n.UWa.push(E.pn);const Fa=Cd.ParagraphReader.textLength(E);if(n.fua+Fa>h)break;E=this.UIf.Hwb(E);n.tiles.push(E);n.fua+=Fa;1!==x||n.cursor||(n.cursor=PE.Hml(ma,n.tiles.length-1));null===n.selection.start&&0===S&&(n.selection.start=
this.qZh(ma,!0,n.tiles.length-1));null===n.selection.end&&S===x-1&&(n.selection.end=this.qZh(ma,!1,n.tiles.length-1))}return n}Vxl(b,h,n){const x={s1c:[],$9i:[],fua:0};var E=b.J(0).node;let S=b.J(b.length-1).node;for(b=h;0<b&&(E||S);){var ma=PE.FFi(E,!0,b,n);if(E=ma.node)E=this.UIf.Hwb(E),x.s1c.push(E),b-=ma.fua,E=ma.node,n=ma.UWa;ma=PE.FFi(S,!1,b,n);if(S=ma.node)n=this.UIf.Hwb(S),x.$9i.push(n),b-=ma.fua,S=ma.node,n=ma.UWa}x.fua=h-b;return x}uil(b,h){let n=0;var x=this.FGl(b,h);const E={tiles:x.tiles,
selection:x.selection,cursor:x.cursor};n+=x.fua;x=x.UWa;n<h&&(b=this.Vxl(b,h-n,x),E.tiles.unshift.apply(E.tiles,b.s1c),E.tiles.push.apply(E.tiles,b.$9i),E.selection.start&&(E.selection.start.index+=b.s1c.length),E.selection.end&&(E.selection.end.index+=b.s1c.length),E.cursor&&(E.cursor.index+=b.s1c.length));return E}sil(b,h){var n;if(!b)return null;b=this.uil(b,h);return{contentType:null===(n=this.l5g)||void 0===n?void 0:n.contentType,formattedContext:b.tiles,selection:b.selection,cursor:b.cursor}}qZh(b,
h,n){if(b.contextId===cc.a.Fd||b.contextId===cc.a.paragraph||b.contextId===cc.a.Wc){if(h&&-1!==b.gl)return{index:n,offset:b.gl};if(!h&&-1!==b.ot)return{index:n,offset:b.ot}}return null}static Hml(b,h){return b.contextId===cc.a.Wc?{index:h,offset:b.gl}:null}static FFi(b,h,n,x){x={node:null,fua:0,UWa:x};if(!b||0>=n||!x.UWa)return x;do x.node=Cd.ParagraphReader.Vg(b,h,!1,!1),x.fua=x.node?Cd.ParagraphReader.textLength(x.node):0,b=x.node;while(x.node&&(Array.contains(x.UWa,x.node.pn)||!Cd.ParagraphReader.oc(x.node)||
!x.fua));x.node&&(x.fua>n?x.node=null:x.UWa.push(x.node.pn));return x}}Object(r.a)(PE,"Box4CanvasContextProvider",null,[118]);class pI{get name(){return"Box4.CanvasContext"}init(){}dispose(){}zc(b){b.ha("Box4.CanvasContext.Box4CanvasContextProvider",()=>new PE(b.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),b.Za("Common.IActionContextProvider"))).as("Box4.CanvasContext.ICanvasContextProvider").singleInstance()}static main(){N.a.instance.Pc(new pI)}}Object(r.a)(pI,"Box4CanvasContextPackage",
null,[1,2]);class RO{constructor(b,h){this.DE=null;this.ny={};this.Hb=b;this.kf=h;this.gLe=new Map}start(){this.DE=new We.a(0,2,3E4,this.Qyn.bind(this),216);this.Hb.$b(this.DE)}stop(){this.DE&&this.Hb.ef(this.DE)}d8g(b,h){this.gLe.set(b,h)}Qyn(){if(this.kf.io)w.ULS.sendTraceTag(520974675,306,50,"Session has been kicked out"),this.stop();else{var b=50;this.ny.ScanTime=Date.now();this.ny.NumWatchDogs=this.gLe.size;this.gLe.forEach((h,n)=>{h&&h.value?(h=h.value,this.ny[n]={["DidWatchDogRun"]:!0,["WatchDogStatus"]:h.rHm()},
h.Dlm()||(b=15)):(this.ny[n]={["DidWatchDogRun"]:!1,["WatchDogStatus"]:"No watchDog for the provided key"},b=15)});w.ULS.sendTraceTag(520974674,306,b,JSON.stringify(this.ny))}}}Object(r.a)(RO,"WatchDogManager",null,[22]);class qI{constructor(){this.W=this.cub=null}get name(){return"Box4.WatchDogManager.WatchDogManager"}init(){if(this.ohi){var b=u.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.StartTimeDelayForWatchDogManager",9E4);this.cub=this.W.resolve(this.name);b=new We.a(5,
1,b,this.cub.start.bind(this.cub),216);u.AFrameworkApplication.uc.$b(b);this.D4j()}}dispose(){this.cub&&this.cub.stop()}zc(b){this.ohi&&(this.W=b,b.ha(this.name,this.GMk.bind(this)).as("Box4.WatchDogManager.IWatchDogManager").singleInstance())}static main(){N.a.instance.Pc(new qI)}GMk(){return new RO(u.AFrameworkApplication.uc,this.W.resolve("Common.ISessionStatus")||Vh.SessionStatusManager.instance)}get ohi(){return u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WatchDogManagerIsEnabled",
!1)}D4j(){this.Lhm&&(ob.App.vs||ob.App.fn)&&this.cub.d8g("WordEditor.RunawayDataLossMonitorWatchDog",this.W.Ye("WordEditor.RunawayDataLossMonitorWatchDog"));this.Gdm&&this.cub.d8g("WordEditor.LastSavedToHostDetailsManagerWatchDog",this.W.Ye("WordEditor.LastSavedToHostDetailsManagerWatchDog"))}get Gdm(){return u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.LastSavedToHostDetailsWatchDogEnabled",!1)}get Lhm(){return u.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RunawayDataLossWatchDogEnabled",
!1)}}Object(r.a)(qI,"WatchDogManagerPackage",null,[1,2]);Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI.Controls.SearchBoxComponents");Type.registerNamespace("CommandUI.React");Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");Type.registerNamespace("B4CS");Type.registerNamespace("B4IE");Type.registerNamespace("B4Im");Type.registerNamespace("B4Intent");Type.registerNamespace("B4LE");Type.registerNamespace("B4NLE");
Type.registerNamespace("B4OLE");Type.registerNamespace("B4S");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TaE");Type.registerNamespace("B4UI");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4.AtMentions");Type.registerNamespace("Box4.AugmentationLoop");Type.registerNamespace("Box4.AugmentationLoop.TilingSchema");Type.registerNamespace("Box4.ClipArt");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");
Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.Media");Type.registerNamespace("Box4.Proofing");Type.registerNamespace("Box4.TaskPaneManager");Type.registerNamespace("Box4.WorkerShared");Type.registerNamespace("Box4.Workers");Type.registerNamespace("CanvasAtMentions");Type.registerNamespace("Common.App.CatchUpActivity");Type.registerNamespace("GC2");Type.registerNamespace("PUTSOMETHINGHERE");Type.registerNamespace("WEAc");Type.registerNamespace("WEB");Type.registerNamespace("WECX");
Type.registerNamespace("WEDCE");Type.registerNamespace("WEIE");Type.registerNamespace("WEIL");Type.registerNamespace("WELE");Type.registerNamespace("WENLE");Type.registerNamespace("WEOLE");Type.registerNamespace("WETaE");Type.registerNamespace("WEUI");Type.registerNamespace("Wac.Common");Type.registerNamespace("Wac.Common.Actors");Type.registerNamespace("Wac.Common.SendUsYourFile");Type.registerNamespace("Wonca.UI");Type.registerNamespace("WordEditor.AtMentions");Type.registerNamespace("WordEditor.CanvasContextualProvider");
Type.registerNamespace("WordEditor.CatchUpActivity");Type.registerNamespace("WordEditor.CatchUpActivity.NetworkShared");Type.registerNamespace("WordEditor.ContextualSearch");Type.registerNamespace("WordEditor.CritiqueCounts");Type.registerNamespace("WordEditor.Designer.Common");Type.registerNamespace("WordEditor.Designer.Common.AL");Type.registerNamespace("WordEditor.Designer.Common.Conditions");Type.registerNamespace("WordEditor.Designer.Common.Review");Type.registerNamespace("WordEditor.DocumentUnderstanding.RLM");
Type.registerNamespace("WordEditor.Embed");Type.registerNamespace("WordEditor.FindReplace");Type.registerNamespace("WordEditor.FootnoteEndnote");Type.registerNamespace("WordEditor.FootnoteEndnoteInteractive");Type.registerNamespace("WordEditor.Goals");Type.registerNamespace("WordEditor.GraphicsEditor");Type.registerNamespace("WordEditor.HeaderFooter");Type.registerNamespace("WordEditor.Insights");Type.registerNamespace("WordEditor.IntelligentPlaceholder");Type.registerNamespace("WordEditor.RibbonIntelligence");
Type.registerNamespace("WordEditor.Ruler");Type.registerNamespace("WordEditor.SendUsYourFile");Type.registerNamespace("WordEditor.SignalAggregator");Type.registerNamespace("WordEditor.TableStyle");Type.registerNamespace("WordEditor.TaskPaneManager");Type.registerNamespace("WordEditor.Tasks");Type.registerNamespace("WordEditor.WordCount");Type.registerNamespace("WordEditor.WorkerShared");Type.registerNamespace("WordEditor.Workers");Type.registerNamespace("Common.App.AccountSwitching");H.main();Type.registerNamespace("Common.App.WopiIdentity");
ia.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");nb.main();Type.registerNamespace("WordEditor.Comments");Type.registerNamespace("WordEditor.CommentsInteractive");Type.registerNamespace("Common.App.OAuth");NH.main();XH.main(!1);WH.main(!1);N.a.instance.Pc(new QO,0,!1);N.a.instance.Pc(new LO,0,!1);(b=>{const h=Oa.a.instance.Za("Box4.IPackageBootPerfLogger"),n=window.performance.now();h.execute(x=>{x.Ru(uD.a.comments,"CIPMain",n,!0)});N.a.instance.Pc(new HO,
0,b)})(!1);(b=>{const h=Oa.a.instance.Za("Box4.IPackageBootPerfLogger"),n=window.performance.now();h.execute(x=>{x.Ru(uD.a.comments,"CPMain",n,!0)});N.a.instance.Pc(new xG,0,b)})(!1);Vb.main();Fb.main();nc.main();KH.main();Type.registerNamespace("Common.App.AccessibilityHelpDialog");Type.registerNamespace("Common.App.ActivityAggregator");Oc.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("Common.App.CommandUIActors");
Type.registerNamespace("Common");ld.main();Type.registerNamespace("Common.App.WildFire");xc.main();Type.registerNamespace("Common.App.BrowserInfoLogger");uf.main();Type.registerNamespace("Common.App.HostNotification");Sg.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.FloatPane");Ff.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");Type.registerNamespace("Common.App.LivePersonaUtils");Tf.main();Type.registerNamespace("CNT");
ok.main();Type.registerNamespace("Common.App.NewAndOpen.Core");N.a.instance.Pc(new bl);Type.registerNamespace("Common.App.NewAndOpen.UX");N.a.instance.Pc(new Lj);Type.registerNamespace("Common.App.OneDriveFilePickerApi");Kg.main();Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SafeLinks");Type.registerNamespace("Common.App.SafeLinks");In.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");
Pf.main();Type.registerNamespace("Common.App.TaskPaneManager");Type.registerNamespace("CAUI");Vc.main();Type.registerNamespace("CADWLTR");Sd.main();Type.registerNamespace("Common.App.DirectPrint");N.a.instance.Pc(new jg);Type.registerNamespace("Common.App.SearchOAuthManager");zg.main();dd.main();kk.main();on.main();Bi.main();Qg.main();pi.main();N.a.instance.Pc(new Uj);Fd.main();he.main();jn.main();N.a.instance.Pc(new ll);Type.registerNamespace("Common.App.SaveStatus");N.a.instance.Pc(new Hj);Type.registerNamespace("Common.App.EventsCacheManager");
zp.main();Type.registerNamespace("CUIB");Xr.main();Type.registerNamespace("CommandUI.TaskPane");try{N.a.instance.Pc(new yf(ob.App.xa.jb))}catch(b){w.ULS.shipAssertTag(575930383,3016,!1,b.message)}Kn.main();Type.registerNamespace("Common.App.Insights");Vq;N.a.instance.Pc(new nm);Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.CommentsSmartReply");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AugmentationLoop.SDX");
cp("Begin");N.a.instance.Pc(new wj);try{N.a.instance.Pc(new $i(cj.a.get_instance(),ob.App.xa.jb,ob.App.xa.Sb))}catch(b){w.ULS.shipAssertTag(575930384,3016,!1,b.message)}Ep.main();N.a.instance.Pc(new va);vh.main();fp.main();yr.main();Rp.main();lt.main();Pu.main();Tv.main();wx.main();N.a.instance.Pc(new Gw);rt.main();Bx.main();tu.main();DA.main();pI.main();MH.main();N.a.instance.Pc(new EA);N.a.instance.Pc(new HA);Xz.main();KB.main();St.main();N.a.instance.Pc(new PA);N.a.instance.Pc(new Hp);zy;jB.main();
Bc.main();of.main();xA.main();zC;N.a.instance.Pc(new Ky);N.a.instance.Pc(new yv);Fj.main();UC.main();sB.main();N.a.instance.Pc(new eE);N.a.instance.Pc(new CI);Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=zz;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");FG.main();HG.main();IG.main();YO;cH.main();AP;window.MSOJS=
zB;wH.main();zH.main();N.a.instance.Pc(new dN);N.a.instance.Pc(new fN);(()=>Object(xu.__awaiter)(void 0,void 0,void 0,function*(){u.AFrameworkApplication.K.$("WPMPackageIsEnabled")&&(yield d.e(21).then(d.bind(null,1917)).then(b=>{b.initializeOnDemandPackage()}))}))();qI.main()},694:function(D,M,d){Object.defineProperty(M,"__esModule",{value:!0});var m=d(75);m.__exportStar(d(911),M);m.__exportStar(d(1182),M);m.__exportStar(d(912),M);m.__exportStar(d(1183),M);m.__exportStar(d(1184),M);m.__exportStar(d(1185),
M);D.exports.getChangeGateDictionary||Object.defineProperty(D.exports,"getChangeGateDictionary",{enumerable:!0,get:function(){return D.exports.PLh}});D.exports.getFeatureGateDictionary||Object.defineProperty(D.exports,"getFeatureGateDictionary",{enumerable:!0,get:function(){return D.exports.TOh}});D.exports.makeGetTypedFeatureGate||Object.defineProperty(D.exports,"makeGetTypedFeatureGate",{enumerable:!0,get:function(){return D.exports.Jni}});D.exports.makeTypedIsChangeGateEnabled||Object.defineProperty(D.exports,
"makeTypedIsChangeGateEnabled",{enumerable:!0,get:function(){return D.exports.Oni}})},840:function(D,M,d){function m(){return d(840)}function f(Qa){for(var yb=[],lb=1;lb<arguments.length;lb++)yb[lb-1]=arguments[lb];return f.W1c.apply(f,Object(ha.__spreadArray)([Qa,void 0],yb,!1))}function a(Qa){return l(Qa)&&"WorkerError"===Qa.name&&"object"===typeof Qa.info}function l(Qa){return null==Qa?!1:Qa instanceof Error?!0:"string"===typeof Qa.name&&"string"===typeof Qa.message&&(null==Qa.stack||"string"===
typeof Qa.stack)}function r(Qa){if(l(Qa))var yb=Qa;else{yb=Error;var lb="(non-Error object) ".concat;a:{var Eb=typeof Qa;switch(Eb){case "function":case "symbol":case "undefined":Qa="<".concat(Eb,">");break a;case "object":Qa=JSON.stringify(Qa);break a;default:Qa="".concat(Qa)}}yb=yb(lb.call("(non-Error object) ",Qa))}return yb}function w(Qa){var yb=Qa.name,lb=a(Qa)?Qa.Nfk:Qa.message,Eb=Qa.stack;a(Qa)?(Qa=Qa.info,Qa=Object(ha.__assign)(Object(ha.__assign)({},Qa),{error:Qa.error?w(Qa.error):void 0})):
Qa=void 0;return{name:yb,message:lb,stack:Eb,info:Qa}}function v(Qa){return l(Qa)?{Rea:!0,value:w(Qa)}:{Rea:!1,value:Qa}}function u(Qa){if("WorkerError"===Qa.name){var yb=Qa.message;var lb=Qa.info;lb=Object(ha.__assign)(Object(ha.__assign)({},lb),{error:lb.error?u(lb.error):void 0});yb=new Ca(yb,lb)}else(yb=Pa[Qa.name])?yb=new yb(Qa.message):(yb=Error(Qa.message),yb.name=Qa.name);null!=Qa.stack&&(yb.stack=Qa.stack);return yb}function z(Qa){return Qa.Rea?u(Qa.value):Qa.value}function B(){return"undefined"!==
typeof Blob&&"undefined"!==typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!==typeof Worker}function G(Qa){if(Xa)throw new TypeError("setConfig has already been called");Xa=Qa}function F(){var Qa=null!==Xa&&void 0!==Xa?Xa:{};return{createTimeout:Qa.createTimeout,createMode:Qa.createMode,importScriptUrls:Qa.importScriptUrls?Object(ha.__spreadArray)([],Qa.importScriptUrls,!0):void 0,typedWorkersUrl:Qa.typedWorkersUrl,typedWorkersName:Qa.typedWorkersName,clf:Qa.clf}}
function K(Qa){var yb,lb;return null!==(lb=null!==(yb=null===Qa||void 0===Qa?void 0:Qa.createTimeout)&&void 0!==yb?yb:null===Xa||void 0===Xa?void 0:Xa.createTimeout)&&void 0!==lb?lb:3E5}function N(Qa){var yb,lb;Qa=null!==(lb=null!==(yb=null===Qa||void 0===Qa?void 0:Qa.createMode)&&void 0!==yb?yb:null===Xa||void 0===Xa?void 0:Xa.createMode)&&void 0!==lb?lb:"Thread";return"ThreadOrLocal"===Qa?B()?"Thread":"Local":Qa}function H(Qa){setTimeout(function(){throw Qa;})}function J(){return"undefined"!==typeof self&&
"__typed_workers_thread"in self?self:void 0}function L(Qa){var yb=J();void 0!==yb?(Qa={kind:1,error:v(Qa)},yb.postMessage(Qa)):console.warn(Qa)}function I(Qa){var yb;try{(null!==(yb=null===Xa||void 0===Xa?void 0:Xa.yFo)&&void 0!==yb?yb:L)(Qa)}catch(lb){console.warn(Qa),H(lb)}}function R(Qa){var yb=J();void 0!==yb&&yb.postMessage({kind:2,stats:Qa})}function C(Qa){var yb;try{(null!==(yb=null===Xa||void 0===Xa?void 0:Xa.TEo)&&void 0!==yb?yb:R)(Qa)}catch(lb){H(lb)}}function P(Qa,yb){return Qa.then(function(lb){yb();
return lb},function(lb){yb();return Promise.reject(lb)})}function W(Qa,yb,lb){if(1073741824<Qa)return lb;var Eb=setTimeout(yb,Math.max(0,Qa));return{resolve:function(bc){clearTimeout(Eb);lb.resolve(bc)},reject:function(bc){clearTimeout(Eb);lb.reject(bc)}}}function X(){var Qa=Object.create(null);Qa.key=void 0;delete Qa.key;return Qa}function V(){try{return"function"===typeof Proxy&&!0===(new Proxy({},{get:function(){return!0}})).k}catch(Qa){return!1}}function Y(Qa,yb){var lb=X(),Eb=Ea("OfficeVSO:5592319_TypedWorkersProxyPromiseFix")?
function(bc,Pb){var Va;return"then"===Pb?void 0:null!==(Va=bc[Pb])&&void 0!==Va?Va:bc[Pb]=Qa(Pb)}:function(bc,Pb){var Va;return null!==(Va=bc[Pb])&&void 0!==Va?Va:bc[Pb]=Qa(Pb)};if(!yb)return new Proxy(lb,{get:Eb});yb.forEach(function(bc){return Eb(lb,bc)});return lb}function ca(Qa){throw Qa;}function fa(){return{status:"Pending",start:zb()}}function sa(Qa,yb,lb){"Pending"===Qa.status&&(Qa.status=yb,Qa.end=Math.max(Qa.start,null!==lb&&void 0!==lb?lb:zb()))}function ia(Qa,yb){function lb(Eb){sa(Qa,
a(Eb)&&"Timeout"===Eb.info.WY?"Timeout":"Error");throw Eb;}try{return yb().then(function(Eb){var bc;return null!==(bc=sa(Qa,"Success"))&&void 0!==bc?bc:Eb},lb)}catch(Eb){lb(Eb)}}function ea(Qa,yb,lb){var Eb,bc,Pb,Va=null!==(Eb=null===Qa||void 0===Qa?void 0:Qa.start)&&void 0!==Eb?Eb:Infinity;Eb=Va<yb?yb:Va>lb?lb:Va;Va=null!==(bc=null===Qa||void 0===Qa?void 0:Qa.end)&&void 0!==bc?bc:Infinity;lb=Va<yb?yb:Va>lb?lb:Va;return{status:null!==(Pb=null===Qa||void 0===Qa?void 0:Qa.status)&&void 0!==Pb?Pb:"Pending",
start:Math.round(1E3*(Eb-yb))/1E3,end:Math.round(1E3*(lb-yb))/1E3,duration:Math.round(1E3*(lb-Eb))/1E3}}function da(Qa,yb,lb){lb="def"in lb?lb:f(lb);var Eb=lb.def,bc=lb.args;return"function"!==typeof Eb?Promise.reject(new Ca("Loading an InsideScript to create a local worker is unimplemented",{WY:"InternalError",VC:{type:"Endpoint",aKb:"Inside",id:Qa.options.id}})):Promise.resolve().then(function(){return ia(yb.Wmf=fa(),function(){return Eb.apply(void 0,Object(ha.__spreadArray)([{config:F(),importTypedWorkers:m,
connection:Qa}],bc,!1)).then(function(){})})})}function ja(Qa,yb,lb,Eb,bc){var Pb=new MessageChannel,Va=Pb.port2,oa;return Promise.all([Eb({port:Pb.port1,options:Qa,createMode:yb}),ia(lb.Hwd=fa(),function(){return Oa.Hwd({port:Va,options:Qa,createMode:yb},function(pa){return bc(oa=pa)})})]).then(function(){return oa},function(pa){oa?oa.close("Force"):Va.close();return Promise.reject(pa)})}function Ga(Qa,yb,lb,Eb){return ja(Qa,"Local",yb,function(bc){return da(bc,yb,lb)},Eb)}function ya(Qa,yb,lb,Eb){yb.Rwd=
fa();try{var bc=new ab(Qa,lb)}catch(Pb){return sa(yb.Rwd,"Error"),Promise.reject(Pb)}sa(yb.Rwd,"Success");return ja(Qa,"Thread",yb,function(Pb){return bc.LZe(Pb,yb)},Eb).then(function(Pb){Pb.FTl()?bc.terminate():Pb.qMj=bc.terminate.bind(bc);return Pb},function(Pb){bc.terminate();return Promise.reject(Pb)})}function ta(Qa,yb,lb){void 0===lb&&(lb=function(){});var Eb=N(Qa),bc="local"in yb?"Local"===Eb?yb.local:yb.$5n:yb,Pb="Local"===Eb?Ga:ya,Va={id:Qa.id,createMode:Eb,H_e:fa()};yb=ia(Va.H_e,function(){return Pb({id:Qa.id,
createTimeout:Qa.createTimeout,createMode:Qa.createMode,importScriptUrls:Qa.importScriptUrls,clf:Qa.clf},Va,bc,lb)});return P(yb,function(){var oa=Va.createMode;var pa=Va.H_e,Ya=Va.Wmf,Ja=Va.Hwd,nb=Va.Rwd,Bb=pa.status,mb=pa.start;pa=pa.end;oa="Pending"!==Bb&&void 0!==pa?{id:Va.id,createMode:oa,H_e:{status:Bb,Nxo:mb,duration:Math.round(1E3*(pa-mb))/1E3},Rwd:"Thread"===oa?ea(nb,mb,pa):void 0,Hwd:ea(Ja,mb,pa),Wmf:ea(Ya,mb,pa)}:void 0;oa&&C(oa)})}function ua(Qa,yb){if(0===yb)importScripts.apply(void 0,
Qa);else for(var lb=0;lb<Qa.length;lb++)a:{for(var Eb=void 0,bc=Qa[lb],Pb=yb,Va=0;Va<=Pb;Va+=1)try{Eb=importScripts;if(0<Va){var oa=bc,pa=String(Va),Ya=oa.indexOf("?");if(0>Ya)var Ja="".concat(oa,"?").concat("retries","=").concat(pa);else{var nb=oa.slice(0,Ya+1),Bb=oa.slice(Ya+1).split("&");for(oa=0;oa<Bb.length&&("="!==Bb[oa][7]||"retries"!==Bb[oa].slice(0,7));oa+=1);Bb[oa]="".concat("retries","=").concat(pa);Ja=nb+Bb.join("&")}}else Ja=bc;Eb(Ja);break a}catch(mb){Eb=mb}throw Eb;}}function Sa(){return"undefined"!==
typeof WorkerGlobalScope}function ka(){return self.name}d.r(M);var ha=d(75),Ca=function(Qa){function yb(lb,Eb){var bc=this.constructor,Pb;var Va=Qa.call(this,"".concat(lb,"; info = ").concat(JSON.stringify(Object(ha.__assign)(Object(ha.__assign)({},Eb),{error:null===(Pb=Eb.error)||void 0===Pb?void 0:Pb.message}))))||this;Va.Nfk=lb;Va.info=Eb;Va.name="WorkerError";lb=bc.prototype;Object.getPrototypeOf(Va)!==lb&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(Va,lb):Va.__proto__=lb);return Va}Object(ha.__extends)(yb,
Qa);return yb}(Error),Pa={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError},Xa;f.W1c=function(Qa,yb){for(var lb=[],Eb=2;Eb<arguments.length;Eb++)lb[Eb-2]=arguments[Eb];return{def:Qa,args:lb,transferables:null!==yb&&void 0!==yb?yb:[]}};var qa=d(694),Ea=Object(qa.makeTypedIsChangeGateEnabled)(["OfficeVSO:WINum_CGExample","OfficeVSO:5592319_TypedWorkersProxyPromiseFix"]);Object(qa.makeGetTypedFeatureGate)({"Microsoft.Office.Shared.FGExample":!0});var Ia,na=-1,Na=function(){function Qa(yb,
lb){function Eb(){var Ya;return null===(Ya=Va.onClose)||void 0===Ya?void 0:Ya.call(Va)}var bc,Pb,Va=this;this.VC=yb;this.port=lb;this.isClosed=!1;this.exports={};this.t2c=X();var oa=(bc={},bc[0]=this.rWd.bind(this),bc[1]=this.onResult.bind(this),bc[2]=function(Ya){var Ja;Ya=Ya.Dcl;null===(Ja=Va.qRm)||void 0===Ja?void 0:Ja.call(Va,Y(Va.AKk.bind(Va),Ya),Y(Va.gGk.bind(Va),Ya))},bc[3]=Eb,bc),pa=(Pb={},Pb[0]=this.lVm.bind(this),Pb[1]=this.xyi.bind(this),Pb[2]=Eb,Pb[3]=Eb,Pb);this.port.onmessage=function(Ya){Ya=
Ya.data;return oa[Ya.kind](Ya)};this.port.onmessageerror=function(Ya){Ya=Ya.data;return pa[Ya.kind](Ya)}}Qa.prototype.oHn=function(yb){this.exports=yb;if(null!==Ia&&void 0!==Ia?Ia:Ia=V())yb=void 0;else{for(var lb=X();null!=yb;){for(var Eb=0,bc=Object.getOwnPropertyNames(yb);Eb<bc.length;Eb++){var Pb=bc[Eb];try{"function"===typeof yb[Pb]&&(lb[Pb]=!0)}catch(Va){}}yb=Object.getPrototypeOf(yb)}yb=Object.getOwnPropertyNames(lb)}this.port.postMessage({kind:2,Dcl:yb})};Qa.prototype.close=function(){if(!this.isClosed){this.isClosed=
!0;this.port.postMessage({kind:3});this.port.close();for(var yb in this.t2c){var lb=this.t2c[yb],Eb=lb.reject;lb=lb.mZ;var bc={WY:"Connection",VC:this.VC,mZ:lb};lb=new Ca("Importing Endpoint closed while waiting for ".concat(lb," result"),bc);Eb(lb)}}};Qa.prototype.rWd=function(yb){var lb=this,Eb=yb.lda,bc=yb.mZ,Pb=yb.args;yb=Promise.resolve().then(function(){var Va=lb.exports[bc];if(Va)return Va.apply(lb.exports,Pb);Va={WY:"Connection",VC:lb.VC,lda:Eb,mZ:bc};throw new Ca("Exporting Endpoint received a ".concat(0<=
Eb?"call":"post"," to unknown function ").concat(bc),Va);});0<=Eb?yb.then(function(Va){return lb.sVf(Eb,bc,!0,Va)},function(Va){return lb.sVf(Eb,bc,!1,Va)}):yb.catch(function(Va){Va=r(Va);Va={WY:"UnhandledError",VC:lb.VC,error:Va,lda:Eb,mZ:bc};I(new Ca("Exporting Endpoint's ".concat(bc," implementation threw or rejected"),Va))})};Qa.prototype.sVf=function(yb,lb,Eb,bc){bc=v(bc);yb={kind:1,lda:yb,mZ:lb,Obm:Eb,GQi:bc};try{this.port.postMessage(yb,void 0)}catch(Pb){this.xyi(yb,r(Pb))}};Qa.prototype.xyi=
function(yb,lb){var Eb=yb.lda,bc=yb.mZ;yb=yb.GQi;var Pb=lb?"Exporting Endpoint failed to send ".concat(bc," result"):"Importing Endpoint failed to deserialize ".concat(bc," result");lb=new Ca(Pb,{WY:"MessageError",VC:this.VC,error:lb,lda:Eb,mZ:bc});yb.Rea?I(lb):this.sVf(Eb,bc,!1,lb)};Qa.prototype.S9d=function(yb){var lb=this.t2c[yb];lb&&delete this.t2c[yb];return lb};Qa.prototype.IFn=function(yb,lb,Eb,bc){var Pb=this;return 1073741824<Eb?bc:W(Eb,function(){var Va=Pb.S9d(yb);if(Va){var oa={WY:"Timeout",
VC:Pb.VC,timeout:Eb,lda:yb,mZ:lb};Va.reject(new Ca("Importing Endpoint's call to ".concat(lb," timed out"),oa))}},bc)};Qa.prototype.FCn=function(yb,lb,Eb,bc){var Pb=this;return new Promise(function(Va,oa){var pa=na+=1,Ya={kind:0,lda:pa,mZ:yb,args:lb};Pb.t2c[pa]=Object(ha.__assign)(Object(ha.__assign)({},Pb.IFn(pa,yb,Eb,{resolve:Va,reject:oa})),{mZ:yb});try{Pb.port.postMessage(Ya,bc)}catch(Ja){if(Va=Pb.S9d(pa))oa=r(Ja),pa={WY:"MessageError",VC:Pb.VC,error:oa,lda:pa,mZ:yb},Va.reject(new Ca("Importing Endpoint failed to send call to ".concat(yb),
pa))}})};Qa.prototype.wDn=function(yb,lb,Eb,bc){lb={kind:0,lda:-1,mZ:yb,args:lb};try{this.port.postMessage(lb,bc)}catch(Pb){bc=r(Pb),bc={WY:"MessageError",VC:this.VC,error:bc,lda:-1,mZ:yb},Eb(new Ca("Importing Endpoint failed to post to ".concat(yb),bc))}};Qa.prototype.lVm=function(yb){var lb,Eb=yb.lda;yb=yb.mZ;var bc={WY:"MessageError",VC:this.VC,lda:Eb,mZ:yb};yb=new Ca("Exporting Endpoint failed to deserialize ".concat(0<=Eb?"call":"post"," to ").concat(yb),bc);Eb=0<=Eb?this.S9d(Eb):void 0;(null!==
(lb=null===Eb||void 0===Eb?void 0:Eb.reject)&&void 0!==lb?lb:I)(yb)};Qa.prototype.onResult=function(yb){var lb=yb.lda,Eb=yb.mZ,bc=yb.Obm;yb=yb.GQi;0<=lb?(Eb=this.S9d(lb))&&(bc?Eb.resolve:Eb.reject)(z(yb)):(bc={WY:"InternalError",VC:this.VC,lda:lb,mZ:Eb},I(new Ca("Exporting Endpoint sent a result for a post to ".concat(Eb),bc)))};Qa.prototype.AKk=function(yb){function lb(){for(var bc=[],Pb=0;Pb<arguments.length;Pb++)bc[Pb]=arguments[Pb];return lb.W1c.apply(lb,Object(ha.__spreadArray)([void 0],bc,!1))}
var Eb=this;lb.W1c=function(bc){for(var Pb,Va,oa,pa=[],Ya=1;Ya<arguments.length;Ya++)pa[Ya-1]=arguments[Ya];Eb.isClosed||(Ya=null!==(oa=null!==(Pb=lb.Exi)&&void 0!==Pb?Pb:null===(Va=Eb.szl)||void 0===Va?void 0:Va.call(Eb))&&void 0!==oa?oa:ca,Eb.wDn(yb,pa,Ya,bc))};return lb};Qa.prototype.gGk=function(yb){function lb(){for(var bc=[],Pb=0;Pb<arguments.length;Pb++)bc[Pb]=arguments[Pb];return lb.W1c.apply(lb,Object(ha.__spreadArray)([void 0],bc,!1))}var Eb=this;lb.W1c=function(bc){for(var Pb,Va,oa,pa=
[],Ya=1;Ya<arguments.length;Ya++)pa[Ya-1]=arguments[Ya];if(Eb.isClosed)return Pb={WY:"Connection",VC:Eb.VC,mZ:yb},Promise.reject(new Ca("".concat(Eb.VC.aKb," Endpoint's call.").concat(yb," called after close"),Pb));Ya=null!==(oa=null!==(Pb=lb.MTe)&&void 0!==Pb?Pb:null===(Va=Eb.qil)||void 0===Va?void 0:Va.call(Eb))&&void 0!==oa?oa:Infinity;return Eb.FCn(yb,pa,Ya,bc)};lb.MTe=void 0;return lb};return Qa}(),Oa=function(){function Qa(yb,lb,Eb){function bc(Pb){return function(){var Va="Outside"===yb.aKb?
"inside":"outside",oa={WY:"Connection",VC:yb};throw new Ca("".concat(yb.aKb," Endpoint's ").concat(Pb," referenced before the ").concat(Va," Endpoint started"),oa);}}this.MTe=Infinity;this.Exi=ca;this.fbd=yb;this._state=lb;this.createMode=Eb;Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:bc("post")},call:{configurable:!0,enumerable:!1,get:bc("call")}})}Qa.jyg=function(yb,lb,Eb){var bc=lb.port,Pb=lb.options;lb=lb.createMode;var Va={type:"Endpoint",aKb:yb,id:null===Pb||void 0===
Pb?void 0:Pb.id};try{var oa=new Na(Va,bc);var pa=new Qa(Va,oa,lb)}catch(Ya){return Promise.reject(Ya)}return(new Promise(function(Ya,Ja){var nb;oa.qil=function(){return pa.MTe};oa.szl=function(){return pa.Exi};oa.qRm=function(Vb,mc){Object.defineProperties(pa,{post:{configurable:!0,enumerable:!1,writable:!1,value:Vb},call:{configurable:!0,enumerable:!1,writable:!1,value:mc}});mb.resolve()};oa.onClose=function(){return pa.close("Force")};var Bb=K(Pb),mb=W(Bb,function(){var Vb="Outside"===yb?"inside":
"outside",mc={WY:"Timeout",VC:Va,timeout:Bb};Vb=new Ca("".concat(yb," Endpoint timed out waiting for the ").concat(Vb," to start"),mc);mb.reject(Vb)},{resolve:Ya,reject:Ja});pa.b7c=function(){mb.resolve()};try{var Qb=Eb(pa)}catch(Vb){return mb.reject(Vb)}null===(nb=pa._state)||void 0===nb?void 0:nb.oHn(Qb)})).then(function(){pa.b7c=void 0;return pa},function(Ya){pa.b7c=void 0;pa.close();return Promise.reject(Ya)})};Qa.prototype.FTl=function(){return void 0===this._state};Qa.prototype.close=function(yb){var lb;
if(this._state){if(this.b7c)if("Force"===yb)this.b7c();else{var Eb={WY:"Connection",VC:this.fbd};throw new Ca("".concat(this.fbd.aKb," Endpoint's close called during creation"),Eb);}yb=this._state;this._state=void 0;try{yb.close(),null===(Eb=this.qMj)||void 0===Eb?void 0:Eb.call(this),null===(lb=this.onClose)||void 0===lb?void 0:lb.call(this)}catch(bc){Eb={WY:"Connection",VC:this.fbd,error:r(bc)},I(new Ca("".concat(this.fbd.aKb," Endpoint's close threw an error"),Eb))}}};Qa.Hwd=function(yb,lb){void 0===
lb&&(lb=function(){});return Qa.jyg("Outside",yb,lb)};Qa.LZe=function(yb,lb){return Qa.jyg("Inside",yb,lb)};return Qa}(),Ra=-1,ab=function(){function Qa(yb,lb){var Eb;try{var bc=void 0;var Pb="def"in lb?lb:f(lb),Va=Pb.def,oa=Pb.args,pa=Pb.transferables;if("function"!==typeof Va)var Ya=[Va,oa,pa,void 0];else{var Ja="__generatedInsideInit".concat(Ra+=1),nb="var ".concat(Ja," = ").concat(Va.toString(),";");Ya=[{scriptUrl:void 0,insideInitName:Ja},oa,pa,nb]}this.script=Ya[0];this.args=Ya[1];this.transferables=
Ya[2];bc=Ya[3];this.Nrd=URL.createObjectURL(new Blob(void 0===bc?['!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return f})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return s})),r.d(t,"__createBinding",(function(){return d})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return y})),r.d(t,"__read",(function(){return v})),r.d(t,"__spread",(function(){return _})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__spreadArray",(function(){return b})),r.d(t,"__await",(function(){return h})),r.d(t,"__asyncGenerator",(function(){return m})),r.d(t,"__asyncDelegator",(function(){return w})),r.d(t,"__asyncValues",(function(){return O})),r.d(t,"__makeTemplateObject",(function(){return j})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return P})),r.d(t,"__classPrivateFieldGet",(function(){return T})),r.d(t,"__classPrivateFieldSet",(function(){return x})),r.d(t,"__classPrivateFieldIn",(function(){return E}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var d=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||d(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function b(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof h?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function w(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:h(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function j(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var G=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&d(t,e,r);return G(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function E(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function i(){return"undefined"==typeof __get_feature_gate_dictionary_variable?o:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return"undefined"==typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t;return null===(t=o()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function S(e,t){var r,n={kind:0,error:e?void 0:i(r=a(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return S(!0)}),(function(e){return S(!1,e)}))}catch(e){S(!1,e)}}}]);']:
[bc,"\n\n",'!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return f})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return s})),r.d(t,"__createBinding",(function(){return d})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return y})),r.d(t,"__read",(function(){return v})),r.d(t,"__spread",(function(){return _})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__spreadArray",(function(){return b})),r.d(t,"__await",(function(){return h})),r.d(t,"__asyncGenerator",(function(){return m})),r.d(t,"__asyncDelegator",(function(){return w})),r.d(t,"__asyncValues",(function(){return O})),r.d(t,"__makeTemplateObject",(function(){return j})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return P})),r.d(t,"__classPrivateFieldGet",(function(){return T})),r.d(t,"__classPrivateFieldSet",(function(){return x})),r.d(t,"__classPrivateFieldIn",(function(){return E}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var d=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||d(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function b(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof h?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function w(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:h(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function j(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var G=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&d(t,e,r);return G(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function E(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function i(){return"undefined"==typeof __get_feature_gate_dictionary_variable?o:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return"undefined"==typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t;return null===(t=o()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function S(e,t){var r,n={kind:0,error:e?void 0:i(r=a(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return S(!0)}),(function(e){return S(!1,e)}))}catch(e){S(!1,e)}}}]);'],
{type:"application/javascript"}));lb={};null!=yb.id&&(lb.name=yb.id);this.worker=new Worker(this.Nrd,lb)}catch(Bb){throw null===(Eb=this.worker)||void 0===Eb?void 0:Eb.terminate(),this.jRi(),Bb;}}Qa.prototype.jRi=function(){void 0!==this.Nrd&&(URL.revokeObjectURL(this.Nrd),this.Nrd=void 0)};Qa.prototype.LZe=function(yb,lb){var Eb=this,bc=yb.port,Pb=yb.options,Va={type:"Thread",aKb:"Outside",id:Pb.id},oa=this.worker;yb=new Promise(function(pa,Ya){Eb.vZb={resolve:pa,reject:Ya};pa={config:F(),port:bc,
options:Pb,script:Eb.script,args:Eb.args,featureGateDictionary:Object(qa.getFeatureGateDictionary)(),Xyo:Object(qa.getChangeGateDictionary)()};oa.postMessage(pa,Object(ha.__spreadArray)([bc],Eb.transferables,!0));oa.onerror=function(Ja){Ja.preventDefault();if(l(Ja.error))if(a(Ja.error))var nb=Ja.error;else nb={WY:"UnhandledError",VC:Va,error:Ja.error},nb=new Ca("".concat("worker.onerror"," received an unhandled error"),nb);else null==Ja.message?(nb={WY:"UnhandledError",VC:Va},nb=new Ca("".concat("worker.onerror",
" received a non-error (worker script fetch probably failed)"),nb)):(nb={WY:"UnhandledError",VC:Va},Ja="".concat(Ja.message," at ").concat(Ja.filename,":").concat(Ja.lineno,":").concat(Ja.colno),nb=new Ca("".concat("worker.onerror"," received an unhandled error: ").concat(Ja),nb));Eb.vZb?Eb.vZb.reject(nb):I(nb)};oa.onmessage=function(Ja){var nb,Bb;Ja=Ja.data;switch(Ja.kind){case 0:return lb.Wmf=Ja.$w,void 0===Ja.error?null===(nb=Eb.vZb)||void 0===nb?void 0:nb.resolve():null===(Bb=Eb.vZb)||void 0===
Bb?void 0:Bb.reject(z(Ja.error));case 1:return I(z(Ja.error));case 2:return C(Ja.stats)}}});return P(yb,function(){return void(Eb.vZb=void 0)})};Qa.prototype.terminate=function(){var yb;if(this.worker){var lb=this.worker;this.worker=void 0;null===(yb=this.vZb)||void 0===yb?void 0:yb.resolve();lb.terminate();this.jRi()}};return Qa}(),zb="undefined"!==typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};d.d(M,"WorkerError",
function(){return Ca});d.d(M,"isThreadingSupported",function(){return B});d.d(M,"setConfig",function(){return G});d.d(M,"dispatchWorkerError",function(){return I});d.d(M,"paramInsideDef",function(){return f});d.d(M,"Endpoint",function(){return Oa});d.d(M,"createWorker",function(){return ta});d.d(M,"importScriptsWithRetry",function(){return ua});d.d(M,"isWorkerThread",function(){return Sa});d.d(M,"workerName",function(){return ka})},911:function(D,M,d){function m(){return"undefined"===typeof __get_feature_gate_dictionary_variable?
l:__get_feature_gate_dictionary_variable()}function f(r,w){var v;return null!==(v=m()[r])&&void 0!==v?v:w}Object.defineProperty(M,"__esModule",{value:!0});M.xWf=M.getIntFeatureGate=M.FTh=M.getBooleanFeatureGate=M.getStringFeatureGate=M.TOh=void 0;var a=d(995),l={};M.TOh=m;M.getStringFeatureGate=f;M.getBooleanFeatureGate=function(r,w){var v;r=null===(v=f(r))||void 0===v?void 0:v.trim().toLowerCase();return"true"===r?!0:"false"===r?!1:w};M.FTh=function(r,w){var v;r=null===(v=f(r))||void 0===v?void 0:
v.trim().toLowerCase();if(void 0===r)return w;if("infinity"===r||"+infinity"===r)return Infinity;if("-infinity"===r)return-Infinity;v=parseFloat(r);return isNaN(v)?w:v};M.getIntFeatureGate=function(r,w){var v;r=null===(v=f(r))||void 0===v?void 0:v.trim();if(void 0===r)return w;v=parseInt(r,10);return isNaN(v)?w:v};M.xWf=function(r){var w=a.globalThis.Esj;a.globalThis.Esj=r;return w}},912:function(D,M,d){function m(){return"undefined"===typeof __get_change_gate_dictionary_variable?{}:__get_change_gate_dictionary_variable()}
Object.defineProperty(M,"__esModule",{value:!0});M.fWf=M.isChangeGateEnabled=M.PLh=void 0;var f=d(995);M.PLh=m;M.isChangeGateEnabled=function(a){var l;return null!==(l=m()[a])&&void 0!==l?l:!0};M.fWf=function(a){var l=f.globalThis.Dsj;f.globalThis.Dsj=a;return l}},923:function(D,M,d){d.d(M,"a",function(){return m});D=d(0);class m{constructor(){this.method=this.api=0}}Object(D.a)(m,"Message",null,[])},995:function(D,M,d){Object.defineProperty(M,"__esModule",{value:!0});M.globalThis=void 0;D=d(1179);
M.globalThis=D}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/16261146/wdjs/WordEditorDS.box4.dll1.js.map